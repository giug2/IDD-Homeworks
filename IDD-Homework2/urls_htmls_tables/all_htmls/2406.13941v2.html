<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture</title>
<!--Generated on Wed Oct  9 04:10:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.13941v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S1" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background and Motivation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.SS1" title="In 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>DLRM Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.SS2" title="In 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>UPMEM PIM Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.SS3" title="In 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Motivation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Design Details</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS1" title="In 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Embedding Table Partitioning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS2" title="In 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Non-Uniform EMT Partitioning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS3" title="In 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Cache-Aware Non-Uniform Partitioning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.SS1" title="In 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.SS2" title="In 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Effectiveness of UpDLRM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.SS3" title="In 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Latency breakdown</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.SS4" title="In 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Sensitivity Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S5" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S6" title="In UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sitian Chen<sup class="ltx_sup" id="id10.10.id1"><span class="ltx_text ltx_font_italic" id="id10.10.id1.1">1</span></sup>, Haobin Tan<sup class="ltx_sup" id="id11.11.id2">2</sup>, Amelie Chi Zhou<math alttext="{}^{1^{*}}" class="ltx_Math" display="inline" id="id3.3.m3.1"><semantics id="id3.3.m3.1a"><msup id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mi id="id3.3.m3.1.1a" xref="id3.3.m3.1.1.cmml"></mi><msup id="id3.3.m3.1.1.1" xref="id3.3.m3.1.1.1.cmml"><mn id="id3.3.m3.1.1.1.2" xref="id3.3.m3.1.1.1.2.cmml">1</mn><mo id="id3.3.m3.1.1.1.3" xref="id3.3.m3.1.1.1.3.cmml">∗</mo></msup></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><apply id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1"><apply id="id3.3.m3.1.1.1.cmml" xref="id3.3.m3.1.1.1"><csymbol cd="ambiguous" id="id3.3.m3.1.1.1.1.cmml" xref="id3.3.m3.1.1.1">superscript</csymbol><cn id="id3.3.m3.1.1.1.2.cmml" type="integer" xref="id3.3.m3.1.1.1.2">1</cn><times id="id3.3.m3.1.1.1.3.cmml" xref="id3.3.m3.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">{}^{1^{*}}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">start_FLOATSUPERSCRIPT 1 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yusen Li<sup class="ltx_sup" id="id12.12.id3">3</sup>, Pavan Balaji<sup class="ltx_sup" id="id13.13.id4">4</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.9.4"><sup class="ltx_sup" id="id9.9.4.1">1</sup>Hong Kong Baptist University <sup class="ltx_sup" id="id9.9.4.2">2</sup>Shenzhen University  <sup class="ltx_sup" id="id9.9.4.3">3</sup>Nankai University <sup class="ltx_sup" id="id9.9.4.4">4</sup>Meta</span><span class="ltx_text ltx_affiliation_country" id="id14.14.id1"></span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id15.id1">Deep Learning Recommendation Models (DLRMs) have gained popularity in recommendation systems due to their effectiveness in handling large-scale recommendation tasks. The embedding layers of DLRMs have become the performance bottleneck due to their intensive needs on memory capacity and memory bandwidth. In this paper, we propose <em class="ltx_emph ltx_font_italic" id="id15.id1.1">UpDLRM</em>, which utilizes real-world processing-in-memory (PIM) hardware, UPMEM DPU, to boost the memory bandwidth and reduce recommendation latency.
The parallel nature of the DPU memory can provide high aggregated bandwidth for the large number of irregular memory accesses in embedding lookups, thus offering great potential to reduce the inference latency. To fully utilize the DPU memory bandwidth, we further studied the embedding table partitioning problem to achieve good workload-balance and efficient data caching.
Evaluations using real-world datasets show that, UpDLRM achieves much lower inference time for DLRM compared to both CPU-only and CPU-GPU hybrid counterparts.</p>
</div>
<div class="ltx_acknowledgements">*Corresponding author: Amelie Chi Zhou
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>61st ACM/IEEE Design Automation Conference; June 23–27, 2024; San Francisco, CA, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>61st ACM/IEEE Design Automation Conference (DAC ’24), June 23–27, 2024, San Francisco, CA, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3649329.3658266</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0601-1/24/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span></span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Deep Learning Recommendation Models (DLRMs) have become widely utilized for click-through rate (CTR) prediction and news rankings <cite class="ltx_cite ltx_citemacro_citep">(Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib14" title="">2019</a>; Covington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib6" title="">2016</a>)</cite>. According to Meta, DLRM models account for more than 60% of their AI inference cycles in production, making them a primary target for optimization <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib8" title="">2020</a>)</cite>.
However, performance optimization for DLRMs is challenging, mainly due to their intensive needs on memory capacity and bandwidth <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib20" title="">2023</a>)</cite>:
<span class="ltx_text ltx_font_bold" id="S1.p1.1.1">1)</span> The number of parameters in DLRMs is much larger than traditional deep learning models due to the <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">embedding layers</em> which map high-dimensional categorical features (e.g., user IDs) to lower-dimensional dense vectors. The categorical features are encoded using embedding tables which can be very large in real-world scenarios (e.g., 10s of GBs).
<span class="ltx_text ltx_font_bold" id="S1.p1.1.3">2)</span> During inference, DLRMs perform multiple <em class="ltx_emph ltx_font_italic" id="S1.p1.1.4">embedding lookups</em> and <em class="ltx_emph ltx_font_italic" id="S1.p1.1.5">reductions</em>, requiring frequent and irregular memory accesses. These contribute significantly to the memory footprint and introduce memory bottlenecks, leading to increased latency.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Due to the limited memory capacity of GPUs, existing studies mainly adopt CPU-GPU hybrid architecture for DLRM inference, where the embedding tables (EMTs) are stored in CPU memories and GPUs are employed for highly parallel computations <cite class="ltx_cite ltx_citemacro_citep">(Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib14" title="">2019</a>; Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite>. Some recent work proposed to load popular data into limited GPU memory to further reduced data access latency <cite class="ltx_cite ltx_citemacro_citep">(Adnan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib5" title="">2021</a>)</cite>.
However, the hybrid architecture introduces unavoidable communication between CPUs and GPUs, and may cause GPU stalls due to the memory bottleneck of CPUs.
Since DLRM inference is less compute-intensive compared to training, recent studies <cite class="ltx_cite ltx_citemacro_citep">(Jain et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib9" title="">2023</a>)</cite> found it is possible to make real-time recommendations at scale based on only CPUs. However, memory is still a major performance bottleneck and workload-aware pre-processing (e.g., prefetching, caching) are needed to reduce inference latency <cite class="ltx_cite ltx_citemacro_citep">(Jain et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib9" title="">2023</a>)</cite>.
In this paper, we proposed to boost the memory bandwidth of CPUs using real-world processing-in-memory (PIM) hardware, UPMEM DPU <cite class="ltx_cite ltx_citemacro_citep">(upm, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib3" title="">2023a</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">UPMEM DPU is equipped with dedicated processing units connected closely to memory cells (details in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.SS2" title="2.2. UPMEM PIM Architecture ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">2.2</span></a>). We propose to store the large EMTs using DPU memory and perform costly memory lookups and reductions using DPUs. This design offers two compelling benefits.
<em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">First</em>, by offloading the memory-bound embedding operations to DPUs, we can reduce the resource contention on CPU memory bandwidth and hence accelerate the inference time. <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">Second</em>, the parallel nature of DPU memory banks allows for efficient processing of multiple embedding lookups and reductions simultaneously, further accelerating the inference time.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">There exist several design issues for efficiently utilizing DPUs. Since the capacity of each DPU memory bank (MRAM) is limited to 64MB, it is usually necessary to partition an EMT onto multiple DPUs.
When partitioning EMTs, we have to jointly consider the architectural features of DPUs and the memory access patterns of embedding operations to efficiently utilize the DPU memory bandwidth. <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">First</em>, UPMEM DIMM does not support inter-DPU communication directly. Data movement across DPUs has to go through CPU memory. Thus, when partitioning EMTs, we should avoid frequent inter-DPU data exchange. <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">Second</em>, each DPU core supports multi-threads and pipeline execution. We should fully utilize this hardware feature to improve the efficiency of DPU-supported embedding operations.
<em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">Third</em>, the popularities of items differ in real-world datasets <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite>. Thus, when items in EMTs are partitioned onto different DPUs, we have to consider the aggregated access frequency of each partition to achieve workload balance.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose <em class="ltx_emph ltx_font_italic" id="S1.p5.1.1">UpDLRM</em>, which utilizes UPMEM PIM architecture to accelerate the memory-intensive embedding layers of DLRM, in order to achieve low inference time. Considering the above mentioned design issues, we study the EMT partitioning problem at three different levels. First, we consider the EMT partitioning only consider the hardware features, in order to fully utilize the memory bandwidth and maximize the throughput for embedding lookup operations (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS1" title="3.1. Embedding Table Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Second, we take the imbalanced data access frequencies into account, and proposed non-uniform EMT partitioning to achieve workload balance among DPUs. This ensures efficient utilization of DPU resources and minimizes embedding layer processing time (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS2" title="3.2. Non-Uniform EMT Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
Third, we further consider the co-occurrence feature of multiple items in real recommendation systems, and adopt existing caching technique <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite> to further reduce memory traffic. To deal with the workload imbalance problem introduced by data caching, we proposed a cache-aware partitioning method that jointly balance the memory accesses on cache storage and regular EMT storage (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS3" title="3.3. Cache-Aware Non-Uniform Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3.3</span></a>).
Evaluations on six real-world datasets and four DLRM implementations using different hardware architectures have demonstrated the effectiveness of UpDLRM on optimizing the inference time. Overall, it achieved up to 4.6x speedup on inference time compared to the other comparisons.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background and Motivation</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>DLRM Model</h3>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S2.F1.g1" src="x1.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Architecture of DLRMs</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.F1" title="Figure 1 ‣ 2.1. DLRM Model ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">1</span></a> shows the structure of DLRMs.
The bottom-FC layers process “dense” inputs that are usually continuous attributes (e.g., age, price, rating) to generate dense features. The embedding layers handle “sparse” inputs that are usually categorical features (e.g., user ID, gender, location) encoded using one-hot or multi-hot to generate embeddings.
Each embedding layer contains a large embedding table (EMT) responsible for storing feature vectors of a specific category.
After obtaining the dense and sparse features, they are concatenated and fed into the top FC layer to predict the CTR.
The embedding layer is the main component that causes high memory capacity and bandwidth requirements of DLRMs.
</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1"><em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.1.1">Memory Capacity Requirement:</em> The EMTs are essentially lookup tables, where each row in the table represents the embedding vector associated with a specific value of the category. Hence the size of a EMT is determined by the number of distinct values in a categorical feature. For example, consider the category being user ID. The number of users in a commercial recommendation system can easily reach billions (e.g., over 3 billions in Meta <cite class="ltx_cite ltx_citemacro_citep">(Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib15" title="">2020</a>)</cite>). Assume the number of users is one billion and the embedding dimension is 20. The size of the table is <math alttext="10^{9}*20*4" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><msup id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml"><mn id="S2.SS1.p2.1.m1.1.1.2.2" xref="S2.SS1.p2.1.m1.1.1.2.2.cmml">10</mn><mn id="S2.SS1.p2.1.m1.1.1.2.3" xref="S2.SS1.p2.1.m1.1.1.2.3.cmml">9</mn></msup><mo id="S2.SS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.1.m1.1.1.1.cmml">∗</mo><mn id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">20</mn><mo id="S2.SS1.p2.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.1.m1.1.1.1.cmml">∗</mo><mn id="S2.SS1.p2.1.m1.1.1.4" xref="S2.SS1.p2.1.m1.1.1.4.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><times id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1"></times><apply id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1.2">superscript</csymbol><cn id="S2.SS1.p2.1.m1.1.1.2.2.cmml" type="integer" xref="S2.SS1.p2.1.m1.1.1.2.2">10</cn><cn id="S2.SS1.p2.1.m1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.1.1.2.3">9</cn></apply><cn id="S2.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.1.1.3">20</cn><cn id="S2.SS1.p2.1.m1.1.1.4.cmml" type="integer" xref="S2.SS1.p2.1.m1.1.1.4">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">10^{9}*20*4</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT ∗ 20 ∗ 4</annotation></semantics></math>bytes, namely 80GB. Since there are usually many categories considered in real-world recommendation systems, the memory consumption of EMTs is substantial.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1"><em class="ltx_emph ltx_font_italic" id="S2.SS1.p3.1.1">Memory Bandwidth Requirement:</em> During DLRM inference, the embedding layer takes the input categorical values (indices) and performs <em class="ltx_emph ltx_font_italic" id="S2.SS1.p3.1.2">a lookup operation</em> in the EMT to retrieve corresponding embedding vectors. This operation requires fetching embedding vectors from different memory locations based on the input indices, which can result in frequent memory accesses and require high bandwidth to sustain the data transfer rates.
In real-world scenarios, the popularity of different categorical values can vary significantly <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite>. This can lead to imbalanced accesses to different memory locations in the EMTs.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>UPMEM PIM Architecture</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The UPMEM PIM architecture is the first real-world PIM system commercialized in 2019 <cite class="ltx_cite ltx_citemacro_citep">(upm, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib3" title="">2023a</a>; Devaux, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib7" title="">2019</a>)</cite>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.F3" title="Figure 3 ‣ 2.3. Motivation ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3</span></a> plots the architecture of UPMEM’s PIM system.
A UPMEM module consists of a standard DDR4 DIMM module that incorporates 8-16 PIM chips. Each chip comprises 8 processing cores known as DRAM Processing Units (DPUs). Each DPU has exclusive access to specific memory components, including a 64-MB DRAM bank MRAM, a 24-KB instruction memory IRAM, and a 64-KB scratchpad memory WRAM. The MRAM can be accessed by the host CPU for transferring input data (main memory to MRAM) and retrieving results (MRAM to main memory). These data transfers can occur concurrently if the buffers transferred to and from all MRAM banks are of the same size. Otherwise, the transfers happen sequentially. It’s important to note that inter-DPU communication relies on the host CPU.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Different from RRAM-based PIM architectures <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib12" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib20" title="">2023</a>)</cite>, which perform arithmetic operations using NOR gates within the RRAM arrays, UPMEM’s PIM is the first “real” process in memory hardware that contains dedicated processing units, namely DPUs. Each DPU is a multi-threaded 32-bit RISC core with its own specific ISA <cite class="ltx_cite ltx_citemacro_citep">(upm, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib4" title="">2023b</a>)</cite> to facilitate data transfers between the MRAM and the WRAM. The maximum MRAM-WRAM bandwidth per DPU can achieve approximately 800 MB/s <cite class="ltx_cite ltx_citemacro_citep">(upm, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib3" title="">2023a</a>)</cite>. All DPUs in the UPMEM module function together as a parallel co-processor to the host CPU.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Motivation</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Embedding layers are the primary performance bottlenecks of DLRM inference due to their high requirements on memory capacity and memory bandwidth. The PIM architecture can be utilized to alleviate the memory bandwidth bottleneck and process embedding data near memory.
Additionally, the UPMEM technical paper <cite class="ltx_cite ltx_citemacro_citep">(upm, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib3" title="">2023a</a>)</cite> indicates that the total cost of ownership (TCO) gain for the PIM platform is estimated to be around 10x, with a potential reduction of 60% in energy consumption. Thus, studying PIM-accelerated DLRM inference could potentially lead to cost- and energy-efficient solution to industry.
In this paper, we propose to store the large embedding tables in the MRAM of DPUs and perform lookup operations using near memory DPU cores.
Since each DPU MRAM has a limited capacity of 64MB, an EMT that is larger than 64MB has to be partitioned first to fit in the DPU memory. The partitioning has to consider several design issues as discussed next.</p>
</div>
<figure class="ltx_figure" id="S2.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S2.F3.1" style="width:78.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="674" id="S2.F3.1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.1.1.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F3.1.2.2" style="font-size:90%;">UPMEM’s PIM architecture</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S2.F3.2" style="width:78.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="718" id="S2.F3.2.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.2.1.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S2.F3.2.2.2" style="font-size:90%;">MRAM read latency</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Design Details</h2>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="S3.F4.g1" src="x4.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Pre-processing and forward propagation stages of our DPU-based DLRM implementation</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F6.1" style="width:95.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="635" id="S3.F6.1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.1.1.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S3.F6.1.2.2" style="font-size:90%;">Proportion of partitions being accessed</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F6.2" style="width:95.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="635" id="S3.F6.2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.2.1.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S3.F6.2.2.2" style="font-size:90%;">Access pattern w/ and w/o cache using Movie</span></figcaption>
</figure>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Embedding Table Partitioning</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.4">We partition each embedding table into tiles smaller than 64MB to fit in the DPU memories.
To simplify the problem, let’s first consider uniform partitioning, namely all tiles have the same number of rows (denoted as <math alttext="N_{r}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>) and columns (denoted as <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>).
Assume each feature value is represented using 32-bit data, we have <math alttext="N_{r}*N_{c}*" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1b"><msub id="S3.SS1.p1.3.m3.1.1"><mi id="S3.SS1.p1.3.m3.1.1.2">N</mi><mi id="S3.SS1.p1.3.m3.1.1.3">r</mi></msub><mo id="S3.SS1.p1.3.m3.1.2" lspace="0.222em" rspace="0.222em">∗</mo><msub id="S3.SS1.p1.3.m3.1.3"><mi id="S3.SS1.p1.3.m3.1.3.2">N</mi><mi id="S3.SS1.p1.3.m3.1.3.3">c</mi></msub><mo id="S3.SS1.p1.3.m3.1.4" lspace="0.222em">∗</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">N_{r}*N_{c}*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∗ italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∗</annotation></semantics></math>4B<math alttext="\leq 64" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"></mi><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">≤</mo><mn id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><leq id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></leq><csymbol cd="latexml" id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">absent</csymbol><cn id="S3.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\leq 64</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">≤ 64</annotation></semantics></math>MB.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F4" title="Figure 4 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>, during the forward propagation, given a batch of embedding table indices and offsets (multi-hot vectors), the corresponding feature data are fetched from DPUs and transferred back to CPU.
The feature data fetching in stage 2 contains two steps. First, the multi-hot lookup operation searches in DPU MRAMs for corresponding feature data specified by IDX and OFFSET.
Second, multiple vectors are returned and aggregated within DPU to utilize its computation power.
Due to EMT partitioning, the aggregated embedding vectors are only partial results and need to be transferred back to the CPU to generate final feature vectors. We study the time spent on embedding layers as the sum of CPU-DPU communication time (stage 1), embedding lookup time (stage 2) and DPU-CPU communication time (stage 3).</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">Each embedding lookup operation reads <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑁</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>*4 bytes of data from MRAM at the same time. We study the performance of each memory access on MRAM as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.F3" title="Figure 3 ‣ 2.3. Motivation ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3</span></a>. Note that each MRAM read has to be 8 bytes aligned and can be 2,048 bytes maximum. Interestingly, we found that when the size of data increases from 8B to 32B, the latency increases rather slowly. After 32B, the latency increases more dramatically. The partitioning approach should carefully consider this feature when deciding the tile size. That is, we prefer to have <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑁</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>*4B <math alttext="\leq" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mo id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><leq id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\leq</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">≤</annotation></semantics></math> 32B, namely <math alttext="N_{c}\leq 8" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><msub id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2.cmml">N</mi><mi id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">≤</mo><mn id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><leq id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1"></leq><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">𝑁</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">𝑐</ci></apply><cn id="S3.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">N_{c}\leq 8</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ≤ 8</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.13">Multiple DPUs perform lookup operations concurrently. Assuming balanced distribution of memory accesses in the dataset, uniform EMT partitioning can result in the same <em class="ltx_emph ltx_font_italic" id="S3.SS1.p4.13.6">embedding lookup time</em> on each DPU. Approximately, we can estimate the lookup time on each DPU as
<math alttext="T_{lkp}=\frac{N_{r}}{R}*" class="ltx_math_unparsed" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1b"><msub id="S3.SS1.p4.1.m1.1.1"><mi id="S3.SS1.p4.1.m1.1.1.2">T</mi><mrow id="S3.SS1.p4.1.m1.1.1.3"><mi id="S3.SS1.p4.1.m1.1.1.3.2">l</mi><mo id="S3.SS1.p4.1.m1.1.1.3.1">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3">k</mi><mo id="S3.SS1.p4.1.m1.1.1.3.1a">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3.4">p</mi></mrow></msub><mo id="S3.SS1.p4.1.m1.1.2">=</mo><mfrac id="S3.SS1.p4.1.m1.1.3"><msub id="S3.SS1.p4.1.m1.1.3.2"><mi id="S3.SS1.p4.1.m1.1.3.2.2">N</mi><mi id="S3.SS1.p4.1.m1.1.3.2.3">r</mi></msub><mi id="S3.SS1.p4.1.m1.1.3.3">R</mi></mfrac><mo id="S3.SS1.p4.1.m1.1.4" lspace="0.222em">∗</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">T_{lkp}=\frac{N_{r}}{R}*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_l italic_k italic_p end_POSTSUBSCRIPT = divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_R end_ARG ∗</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.SS1.p4.3.2">batch_size<math alttext="*" class="ltx_Math" display="inline" id="S3.SS1.p4.2.1.m1.1"><semantics id="S3.SS1.p4.2.1.m1.1a"><mo id="S3.SS1.p4.2.1.m1.1.1" xref="S3.SS1.p4.2.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.1.m1.1b"><times id="S3.SS1.p4.2.1.m1.1.1.cmml" xref="S3.SS1.p4.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.1.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.1.m1.1d">∗</annotation></semantics></math>Avg_Red<math alttext="*{t_{a}}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.2.m2.1"><semantics id="S3.SS1.p4.3.2.m2.1a"><mrow id="S3.SS1.p4.3.2.m2.1.1" xref="S3.SS1.p4.3.2.m2.1.1.cmml"><mi id="S3.SS1.p4.3.2.m2.1.1.2" xref="S3.SS1.p4.3.2.m2.1.1.2.cmml"></mi><mo id="S3.SS1.p4.3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.3.2.m2.1.1.1.cmml">∗</mo><msub id="S3.SS1.p4.3.2.m2.1.1.3" xref="S3.SS1.p4.3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.3.2.m2.1.1.3.2" xref="S3.SS1.p4.3.2.m2.1.1.3.2.cmml">t</mi><mi id="S3.SS1.p4.3.2.m2.1.1.3.3" xref="S3.SS1.p4.3.2.m2.1.1.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.2.m2.1b"><apply id="S3.SS1.p4.3.2.m2.1.1.cmml" xref="S3.SS1.p4.3.2.m2.1.1"><times id="S3.SS1.p4.3.2.m2.1.1.1.cmml" xref="S3.SS1.p4.3.2.m2.1.1.1"></times><csymbol cd="latexml" id="S3.SS1.p4.3.2.m2.1.1.2.cmml" xref="S3.SS1.p4.3.2.m2.1.1.2">absent</csymbol><apply id="S3.SS1.p4.3.2.m2.1.1.3.cmml" xref="S3.SS1.p4.3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p4.3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.3.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.p4.3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.3.2.m2.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.2.m2.1c">*{t_{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.2.m2.1d">∗ italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></span>, where <math alttext="t_{a}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m2.1"><semantics id="S3.SS1.p4.4.m2.1a"><msub id="S3.SS1.p4.4.m2.1.1" xref="S3.SS1.p4.4.m2.1.1.cmml"><mi id="S3.SS1.p4.4.m2.1.1.2" xref="S3.SS1.p4.4.m2.1.1.2.cmml">t</mi><mi id="S3.SS1.p4.4.m2.1.1.3" xref="S3.SS1.p4.4.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m2.1b"><apply id="S3.SS1.p4.4.m2.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m2.1.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m2.1.1.2.cmml" xref="S3.SS1.p4.4.m2.1.1.2">𝑡</ci><ci id="S3.SS1.p4.4.m2.1.1.3.cmml" xref="S3.SS1.p4.4.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m2.1c">t_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m2.1d">italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> represents the memory access time indicated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.F3" title="Figure 3 ‣ 2.3. Motivation ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3</span></a> and <span class="ltx_text ltx_font_italic" id="S3.SS1.p4.13.7">Avg_Red</span> represents the average reduction in the number of active features (ones) in the multi-hot encoding.
Similarly, the <em class="ltx_emph ltx_font_italic" id="S3.SS1.p4.13.8">communication time</em> for transferring indices from CPU to DPU memory can be estimated as <math alttext="T_{c-comm}=\frac{N_{r}}{R}*" class="ltx_math_unparsed" display="inline" id="S3.SS1.p4.5.m3.1"><semantics id="S3.SS1.p4.5.m3.1a"><mrow id="S3.SS1.p4.5.m3.1b"><msub id="S3.SS1.p4.5.m3.1.1"><mi id="S3.SS1.p4.5.m3.1.1.2">T</mi><mrow id="S3.SS1.p4.5.m3.1.1.3"><mi id="S3.SS1.p4.5.m3.1.1.3.2">c</mi><mo id="S3.SS1.p4.5.m3.1.1.3.1">−</mo><mrow id="S3.SS1.p4.5.m3.1.1.3.3"><mi id="S3.SS1.p4.5.m3.1.1.3.3.2">c</mi><mo id="S3.SS1.p4.5.m3.1.1.3.3.1">⁢</mo><mi id="S3.SS1.p4.5.m3.1.1.3.3.3">o</mi><mo id="S3.SS1.p4.5.m3.1.1.3.3.1a">⁢</mo><mi id="S3.SS1.p4.5.m3.1.1.3.3.4">m</mi><mo id="S3.SS1.p4.5.m3.1.1.3.3.1b">⁢</mo><mi id="S3.SS1.p4.5.m3.1.1.3.3.5">m</mi></mrow></mrow></msub><mo id="S3.SS1.p4.5.m3.1.2">=</mo><mfrac id="S3.SS1.p4.5.m3.1.3"><msub id="S3.SS1.p4.5.m3.1.3.2"><mi id="S3.SS1.p4.5.m3.1.3.2.2">N</mi><mi id="S3.SS1.p4.5.m3.1.3.2.3">r</mi></msub><mi id="S3.SS1.p4.5.m3.1.3.3">R</mi></mfrac><mo id="S3.SS1.p4.5.m3.1.4" lspace="0.222em">∗</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m3.1c">T_{c-comm}=\frac{N_{r}}{R}*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m3.1d">italic_T start_POSTSUBSCRIPT italic_c - italic_c italic_o italic_m italic_m end_POSTSUBSCRIPT = divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_R end_ARG ∗</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.SS1.p4.7.4">batch_size<math alttext="*" class="ltx_Math" display="inline" id="S3.SS1.p4.6.3.m1.1"><semantics id="S3.SS1.p4.6.3.m1.1a"><mo id="S3.SS1.p4.6.3.m1.1.1" xref="S3.SS1.p4.6.3.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.3.m1.1b"><times id="S3.SS1.p4.6.3.m1.1.1.cmml" xref="S3.SS1.p4.6.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.3.m1.1c">*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.3.m1.1d">∗</annotation></semantics></math>Avg_Red<math alttext="*{t_{c}}" class="ltx_Math" display="inline" id="S3.SS1.p4.7.4.m2.1"><semantics id="S3.SS1.p4.7.4.m2.1a"><mrow id="S3.SS1.p4.7.4.m2.1.1" xref="S3.SS1.p4.7.4.m2.1.1.cmml"><mi id="S3.SS1.p4.7.4.m2.1.1.2" xref="S3.SS1.p4.7.4.m2.1.1.2.cmml"></mi><mo id="S3.SS1.p4.7.4.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.7.4.m2.1.1.1.cmml">∗</mo><msub id="S3.SS1.p4.7.4.m2.1.1.3" xref="S3.SS1.p4.7.4.m2.1.1.3.cmml"><mi id="S3.SS1.p4.7.4.m2.1.1.3.2" xref="S3.SS1.p4.7.4.m2.1.1.3.2.cmml">t</mi><mi id="S3.SS1.p4.7.4.m2.1.1.3.3" xref="S3.SS1.p4.7.4.m2.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.4.m2.1b"><apply id="S3.SS1.p4.7.4.m2.1.1.cmml" xref="S3.SS1.p4.7.4.m2.1.1"><times id="S3.SS1.p4.7.4.m2.1.1.1.cmml" xref="S3.SS1.p4.7.4.m2.1.1.1"></times><csymbol cd="latexml" id="S3.SS1.p4.7.4.m2.1.1.2.cmml" xref="S3.SS1.p4.7.4.m2.1.1.2">absent</csymbol><apply id="S3.SS1.p4.7.4.m2.1.1.3.cmml" xref="S3.SS1.p4.7.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.7.4.m2.1.1.3.1.cmml" xref="S3.SS1.p4.7.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p4.7.4.m2.1.1.3.2.cmml" xref="S3.SS1.p4.7.4.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.p4.7.4.m2.1.1.3.3.cmml" xref="S3.SS1.p4.7.4.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.4.m2.1c">*{t_{c}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.7.4.m2.1d">∗ italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math></span>, where <math alttext="t_{c}" class="ltx_Math" display="inline" id="S3.SS1.p4.8.m4.1"><semantics id="S3.SS1.p4.8.m4.1a"><msub id="S3.SS1.p4.8.m4.1.1" xref="S3.SS1.p4.8.m4.1.1.cmml"><mi id="S3.SS1.p4.8.m4.1.1.2" xref="S3.SS1.p4.8.m4.1.1.2.cmml">t</mi><mi id="S3.SS1.p4.8.m4.1.1.3" xref="S3.SS1.p4.8.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m4.1b"><apply id="S3.SS1.p4.8.m4.1.1.cmml" xref="S3.SS1.p4.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.1.1.1.cmml" xref="S3.SS1.p4.8.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.8.m4.1.1.2.cmml" xref="S3.SS1.p4.8.m4.1.1.2">𝑡</ci><ci id="S3.SS1.p4.8.m4.1.1.3.cmml" xref="S3.SS1.p4.8.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m4.1c">t_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.8.m4.1d">italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> represents the time to transfer one value from CPU to DPU. The time for transferring partial results from DPU to CPU memory can be estimated as <math alttext="T_{d-comm}=N_{c}*" class="ltx_math_unparsed" display="inline" id="S3.SS1.p4.9.m5.1"><semantics id="S3.SS1.p4.9.m5.1a"><mrow id="S3.SS1.p4.9.m5.1b"><msub id="S3.SS1.p4.9.m5.1.1"><mi id="S3.SS1.p4.9.m5.1.1.2">T</mi><mrow id="S3.SS1.p4.9.m5.1.1.3"><mi id="S3.SS1.p4.9.m5.1.1.3.2">d</mi><mo id="S3.SS1.p4.9.m5.1.1.3.1">−</mo><mrow id="S3.SS1.p4.9.m5.1.1.3.3"><mi id="S3.SS1.p4.9.m5.1.1.3.3.2">c</mi><mo id="S3.SS1.p4.9.m5.1.1.3.3.1">⁢</mo><mi id="S3.SS1.p4.9.m5.1.1.3.3.3">o</mi><mo id="S3.SS1.p4.9.m5.1.1.3.3.1a">⁢</mo><mi id="S3.SS1.p4.9.m5.1.1.3.3.4">m</mi><mo id="S3.SS1.p4.9.m5.1.1.3.3.1b">⁢</mo><mi id="S3.SS1.p4.9.m5.1.1.3.3.5">m</mi></mrow></mrow></msub><mo id="S3.SS1.p4.9.m5.1.2">=</mo><msub id="S3.SS1.p4.9.m5.1.3"><mi id="S3.SS1.p4.9.m5.1.3.2">N</mi><mi id="S3.SS1.p4.9.m5.1.3.3">c</mi></msub><mo id="S3.SS1.p4.9.m5.1.4" lspace="0.222em">∗</mo></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m5.1c">T_{d-comm}=N_{c}*</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.9.m5.1d">italic_T start_POSTSUBSCRIPT italic_d - italic_c italic_o italic_m italic_m end_POSTSUBSCRIPT = italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∗</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.SS1.p4.10.5">batch_size<math alttext="*t_{d}" class="ltx_Math" display="inline" id="S3.SS1.p4.10.5.m1.1"><semantics id="S3.SS1.p4.10.5.m1.1a"><mrow id="S3.SS1.p4.10.5.m1.1.1" xref="S3.SS1.p4.10.5.m1.1.1.cmml"><mi id="S3.SS1.p4.10.5.m1.1.1.2" xref="S3.SS1.p4.10.5.m1.1.1.2.cmml"></mi><mo id="S3.SS1.p4.10.5.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.10.5.m1.1.1.1.cmml">∗</mo><msub id="S3.SS1.p4.10.5.m1.1.1.3" xref="S3.SS1.p4.10.5.m1.1.1.3.cmml"><mi id="S3.SS1.p4.10.5.m1.1.1.3.2" xref="S3.SS1.p4.10.5.m1.1.1.3.2.cmml">t</mi><mi id="S3.SS1.p4.10.5.m1.1.1.3.3" xref="S3.SS1.p4.10.5.m1.1.1.3.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.5.m1.1b"><apply id="S3.SS1.p4.10.5.m1.1.1.cmml" xref="S3.SS1.p4.10.5.m1.1.1"><times id="S3.SS1.p4.10.5.m1.1.1.1.cmml" xref="S3.SS1.p4.10.5.m1.1.1.1"></times><csymbol cd="latexml" id="S3.SS1.p4.10.5.m1.1.1.2.cmml" xref="S3.SS1.p4.10.5.m1.1.1.2">absent</csymbol><apply id="S3.SS1.p4.10.5.m1.1.1.3.cmml" xref="S3.SS1.p4.10.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.10.5.m1.1.1.3.1.cmml" xref="S3.SS1.p4.10.5.m1.1.1.3">subscript</csymbol><ci id="S3.SS1.p4.10.5.m1.1.1.3.2.cmml" xref="S3.SS1.p4.10.5.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p4.10.5.m1.1.1.3.3.cmml" xref="S3.SS1.p4.10.5.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.5.m1.1c">*t_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.10.5.m1.1d">∗ italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math></span>, where <math alttext="t_{d}" class="ltx_Math" display="inline" id="S3.SS1.p4.11.m6.1"><semantics id="S3.SS1.p4.11.m6.1a"><msub id="S3.SS1.p4.11.m6.1.1" xref="S3.SS1.p4.11.m6.1.1.cmml"><mi id="S3.SS1.p4.11.m6.1.1.2" xref="S3.SS1.p4.11.m6.1.1.2.cmml">t</mi><mi id="S3.SS1.p4.11.m6.1.1.3" xref="S3.SS1.p4.11.m6.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m6.1b"><apply id="S3.SS1.p4.11.m6.1.1.cmml" xref="S3.SS1.p4.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.11.m6.1.1.1.cmml" xref="S3.SS1.p4.11.m6.1.1">subscript</csymbol><ci id="S3.SS1.p4.11.m6.1.1.2.cmml" xref="S3.SS1.p4.11.m6.1.1.2">𝑡</ci><ci id="S3.SS1.p4.11.m6.1.1.3.cmml" xref="S3.SS1.p4.11.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m6.1c">t_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.11.m6.1d">italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> represents the time to transfer one value from DPU to CPU. Thus, to minimize the time on embedding layers, we aim to find a good tradeoff between <math alttext="N_{r}" class="ltx_Math" display="inline" id="S3.SS1.p4.12.m7.1"><semantics id="S3.SS1.p4.12.m7.1a"><msub id="S3.SS1.p4.12.m7.1.1" xref="S3.SS1.p4.12.m7.1.1.cmml"><mi id="S3.SS1.p4.12.m7.1.1.2" xref="S3.SS1.p4.12.m7.1.1.2.cmml">N</mi><mi id="S3.SS1.p4.12.m7.1.1.3" xref="S3.SS1.p4.12.m7.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m7.1b"><apply id="S3.SS1.p4.12.m7.1.1.cmml" xref="S3.SS1.p4.12.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.12.m7.1.1.1.cmml" xref="S3.SS1.p4.12.m7.1.1">subscript</csymbol><ci id="S3.SS1.p4.12.m7.1.1.2.cmml" xref="S3.SS1.p4.12.m7.1.1.2">𝑁</ci><ci id="S3.SS1.p4.12.m7.1.1.3.cmml" xref="S3.SS1.p4.12.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m7.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.12.m7.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS1.p4.13.m8.1"><semantics id="S3.SS1.p4.13.m8.1a"><msub id="S3.SS1.p4.13.m8.1.1" xref="S3.SS1.p4.13.m8.1.1.cmml"><mi id="S3.SS1.p4.13.m8.1.1.2" xref="S3.SS1.p4.13.m8.1.1.2.cmml">N</mi><mi id="S3.SS1.p4.13.m8.1.1.3" xref="S3.SS1.p4.13.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m8.1b"><apply id="S3.SS1.p4.13.m8.1.1.cmml" xref="S3.SS1.p4.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.13.m8.1.1.1.cmml" xref="S3.SS1.p4.13.m8.1.1">subscript</csymbol><ci id="S3.SS1.p4.13.m8.1.1.2.cmml" xref="S3.SS1.p4.13.m8.1.1.2">𝑁</ci><ci id="S3.SS1.p4.13.m8.1.1.3.cmml" xref="S3.SS1.p4.13.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m8.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.13.m8.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> to achieve the following goal:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min T_{c-comm}+T_{lkp}+T_{d-comm}" class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mrow id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.2.1" xref="S3.E1.m1.1.1.2.1.cmml">min</mi><mo id="S3.E1.m1.1.1.2a" lspace="0.167em" xref="S3.E1.m1.1.1.2.cmml">⁡</mo><msub id="S3.E1.m1.1.1.2.2" xref="S3.E1.m1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.2.2.2" xref="S3.E1.m1.1.1.2.2.2.cmml">T</mi><mrow id="S3.E1.m1.1.1.2.2.3" xref="S3.E1.m1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.2.2.3.2.cmml">c</mi><mo id="S3.E1.m1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.2.2.3.1.cmml">−</mo><mrow id="S3.E1.m1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.2.2.3.3.cmml"><mi id="S3.E1.m1.1.1.2.2.3.3.2" xref="S3.E1.m1.1.1.2.2.3.3.2.cmml">c</mi><mo id="S3.E1.m1.1.1.2.2.3.3.1" xref="S3.E1.m1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.2.2.3.3.3" xref="S3.E1.m1.1.1.2.2.3.3.3.cmml">o</mi><mo id="S3.E1.m1.1.1.2.2.3.3.1a" xref="S3.E1.m1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.2.2.3.3.4" xref="S3.E1.m1.1.1.2.2.3.3.4.cmml">m</mi><mo id="S3.E1.m1.1.1.2.2.3.3.1b" xref="S3.E1.m1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.2.2.3.3.5" xref="S3.E1.m1.1.1.2.2.3.3.5.cmml">m</mi></mrow></mrow></msub></mrow><mo id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">+</mo><msub id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">T</mi><mrow id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.2" xref="S3.E1.m1.1.1.3.3.2.cmml">l</mi><mo id="S3.E1.m1.1.1.3.3.1" xref="S3.E1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.3.3" xref="S3.E1.m1.1.1.3.3.3.cmml">k</mi><mo id="S3.E1.m1.1.1.3.3.1a" xref="S3.E1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.3.3.4" xref="S3.E1.m1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo id="S3.E1.m1.1.1.1a" xref="S3.E1.m1.1.1.1.cmml">+</mo><msub id="S3.E1.m1.1.1.4" xref="S3.E1.m1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.4.2" xref="S3.E1.m1.1.1.4.2.cmml">T</mi><mrow id="S3.E1.m1.1.1.4.3" xref="S3.E1.m1.1.1.4.3.cmml"><mi id="S3.E1.m1.1.1.4.3.2" xref="S3.E1.m1.1.1.4.3.2.cmml">d</mi><mo id="S3.E1.m1.1.1.4.3.1" xref="S3.E1.m1.1.1.4.3.1.cmml">−</mo><mrow id="S3.E1.m1.1.1.4.3.3" xref="S3.E1.m1.1.1.4.3.3.cmml"><mi id="S3.E1.m1.1.1.4.3.3.2" xref="S3.E1.m1.1.1.4.3.3.2.cmml">c</mi><mo id="S3.E1.m1.1.1.4.3.3.1" xref="S3.E1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.4.3.3.3" xref="S3.E1.m1.1.1.4.3.3.3.cmml">o</mi><mo id="S3.E1.m1.1.1.4.3.3.1a" xref="S3.E1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.4.3.3.4" xref="S3.E1.m1.1.1.4.3.3.4.cmml">m</mi><mo id="S3.E1.m1.1.1.4.3.3.1b" xref="S3.E1.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.4.3.3.5" xref="S3.E1.m1.1.1.4.3.3.5.cmml">m</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><plus id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"></plus><apply id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"><min id="S3.E1.m1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.2.1"></min><apply id="S3.E1.m1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.2.2.2">𝑇</ci><apply id="S3.E1.m1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.2.2.3"><minus id="S3.E1.m1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.2.2.3.1"></minus><ci id="S3.E1.m1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.2.2.3.2">𝑐</ci><apply id="S3.E1.m1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.2.2.3.3"><times id="S3.E1.m1.1.1.2.2.3.3.1.cmml" xref="S3.E1.m1.1.1.2.2.3.3.1"></times><ci id="S3.E1.m1.1.1.2.2.3.3.2.cmml" xref="S3.E1.m1.1.1.2.2.3.3.2">𝑐</ci><ci id="S3.E1.m1.1.1.2.2.3.3.3.cmml" xref="S3.E1.m1.1.1.2.2.3.3.3">𝑜</ci><ci id="S3.E1.m1.1.1.2.2.3.3.4.cmml" xref="S3.E1.m1.1.1.2.2.3.3.4">𝑚</ci><ci id="S3.E1.m1.1.1.2.2.3.3.5.cmml" xref="S3.E1.m1.1.1.2.2.3.3.5">𝑚</ci></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝑇</ci><apply id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3"><times id="S3.E1.m1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.1"></times><ci id="S3.E1.m1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.2">𝑙</ci><ci id="S3.E1.m1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.3.3.3">𝑘</ci><ci id="S3.E1.m1.1.1.3.3.4.cmml" xref="S3.E1.m1.1.1.3.3.4">𝑝</ci></apply></apply><apply id="S3.E1.m1.1.1.4.cmml" xref="S3.E1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.4.2">𝑇</ci><apply id="S3.E1.m1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.4.3"><minus id="S3.E1.m1.1.1.4.3.1.cmml" xref="S3.E1.m1.1.1.4.3.1"></minus><ci id="S3.E1.m1.1.1.4.3.2.cmml" xref="S3.E1.m1.1.1.4.3.2">𝑑</ci><apply id="S3.E1.m1.1.1.4.3.3.cmml" xref="S3.E1.m1.1.1.4.3.3"><times id="S3.E1.m1.1.1.4.3.3.1.cmml" xref="S3.E1.m1.1.1.4.3.3.1"></times><ci id="S3.E1.m1.1.1.4.3.3.2.cmml" xref="S3.E1.m1.1.1.4.3.3.2">𝑐</ci><ci id="S3.E1.m1.1.1.4.3.3.3.cmml" xref="S3.E1.m1.1.1.4.3.3.3">𝑜</ci><ci id="S3.E1.m1.1.1.4.3.3.4.cmml" xref="S3.E1.m1.1.1.4.3.3.4">𝑚</ci><ci id="S3.E1.m1.1.1.4.3.3.5.cmml" xref="S3.E1.m1.1.1.4.3.3.5">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\min T_{c-comm}+T_{lkp}+T_{d-comm}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">roman_min italic_T start_POSTSUBSCRIPT italic_c - italic_c italic_o italic_m italic_m end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_l italic_k italic_p end_POSTSUBSCRIPT + italic_T start_POSTSUBSCRIPT italic_d - italic_c italic_o italic_m italic_m end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.21">s.t.,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{r}*N_{c}=\frac{R*C}{N_{dpu}}\leq 1.6*10^{7}" class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mrow id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml"><msub id="S3.E2.m1.1.1.2.2" xref="S3.E2.m1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.2.2.2" xref="S3.E2.m1.1.1.2.2.2.cmml">N</mi><mi id="S3.E2.m1.1.1.2.2.3" xref="S3.E2.m1.1.1.2.2.3.cmml">r</mi></msub><mo id="S3.E2.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.2.1.cmml">∗</mo><msub id="S3.E2.m1.1.1.2.3" xref="S3.E2.m1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.2.3.2" xref="S3.E2.m1.1.1.2.3.2.cmml">N</mi><mi id="S3.E2.m1.1.1.2.3.3" xref="S3.E2.m1.1.1.2.3.3.cmml">c</mi></msub></mrow><mo id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">=</mo><mfrac id="S3.E2.m1.1.1.4" xref="S3.E2.m1.1.1.4.cmml"><mrow id="S3.E2.m1.1.1.4.2" xref="S3.E2.m1.1.1.4.2.cmml"><mi id="S3.E2.m1.1.1.4.2.2" xref="S3.E2.m1.1.1.4.2.2.cmml">R</mi><mo id="S3.E2.m1.1.1.4.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.4.2.1.cmml">∗</mo><mi id="S3.E2.m1.1.1.4.2.3" xref="S3.E2.m1.1.1.4.2.3.cmml">C</mi></mrow><msub id="S3.E2.m1.1.1.4.3" xref="S3.E2.m1.1.1.4.3.cmml"><mi id="S3.E2.m1.1.1.4.3.2" xref="S3.E2.m1.1.1.4.3.2.cmml">N</mi><mrow id="S3.E2.m1.1.1.4.3.3" xref="S3.E2.m1.1.1.4.3.3.cmml"><mi id="S3.E2.m1.1.1.4.3.3.2" xref="S3.E2.m1.1.1.4.3.3.2.cmml">d</mi><mo id="S3.E2.m1.1.1.4.3.3.1" xref="S3.E2.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.4.3.3.3" xref="S3.E2.m1.1.1.4.3.3.3.cmml">p</mi><mo id="S3.E2.m1.1.1.4.3.3.1a" xref="S3.E2.m1.1.1.4.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.4.3.3.4" xref="S3.E2.m1.1.1.4.3.3.4.cmml">u</mi></mrow></msub></mfrac><mo id="S3.E2.m1.1.1.5" xref="S3.E2.m1.1.1.5.cmml">≤</mo><mrow id="S3.E2.m1.1.1.6" xref="S3.E2.m1.1.1.6.cmml"><mn id="S3.E2.m1.1.1.6.2" xref="S3.E2.m1.1.1.6.2.cmml">1.6</mn><mo id="S3.E2.m1.1.1.6.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.6.1.cmml">∗</mo><msup id="S3.E2.m1.1.1.6.3" xref="S3.E2.m1.1.1.6.3.cmml"><mn id="S3.E2.m1.1.1.6.3.2" xref="S3.E2.m1.1.1.6.3.2.cmml">10</mn><mn id="S3.E2.m1.1.1.6.3.3" xref="S3.E2.m1.1.1.6.3.3.cmml">7</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><and id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1"></and><apply id="S3.E2.m1.1.1b.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"></eq><apply id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"><times id="S3.E2.m1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.2.1"></times><apply id="S3.E2.m1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.2.2.2">𝑁</ci><ci id="S3.E2.m1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.2.2.3">𝑟</ci></apply><apply id="S3.E2.m1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.2.3.2">𝑁</ci><ci id="S3.E2.m1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.E2.m1.1.1.4.cmml" xref="S3.E2.m1.1.1.4"><divide id="S3.E2.m1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.4"></divide><apply id="S3.E2.m1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.4.2"><times id="S3.E2.m1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.4.2.1"></times><ci id="S3.E2.m1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.4.2.2">𝑅</ci><ci id="S3.E2.m1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.4.2.3">𝐶</ci></apply><apply id="S3.E2.m1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.4.3.1.cmml" xref="S3.E2.m1.1.1.4.3">subscript</csymbol><ci id="S3.E2.m1.1.1.4.3.2.cmml" xref="S3.E2.m1.1.1.4.3.2">𝑁</ci><apply id="S3.E2.m1.1.1.4.3.3.cmml" xref="S3.E2.m1.1.1.4.3.3"><times id="S3.E2.m1.1.1.4.3.3.1.cmml" xref="S3.E2.m1.1.1.4.3.3.1"></times><ci id="S3.E2.m1.1.1.4.3.3.2.cmml" xref="S3.E2.m1.1.1.4.3.3.2">𝑑</ci><ci id="S3.E2.m1.1.1.4.3.3.3.cmml" xref="S3.E2.m1.1.1.4.3.3.3">𝑝</ci><ci id="S3.E2.m1.1.1.4.3.3.4.cmml" xref="S3.E2.m1.1.1.4.3.3.4">𝑢</ci></apply></apply></apply></apply><apply id="S3.E2.m1.1.1c.cmml" xref="S3.E2.m1.1.1"><leq id="S3.E2.m1.1.1.5.cmml" xref="S3.E2.m1.1.1.5"></leq><share href="https://arxiv.org/html/2406.13941v2#S3.E2.m1.1.1.4.cmml" id="S3.E2.m1.1.1d.cmml" xref="S3.E2.m1.1.1"></share><apply id="S3.E2.m1.1.1.6.cmml" xref="S3.E2.m1.1.1.6"><times id="S3.E2.m1.1.1.6.1.cmml" xref="S3.E2.m1.1.1.6.1"></times><cn id="S3.E2.m1.1.1.6.2.cmml" type="float" xref="S3.E2.m1.1.1.6.2">1.6</cn><apply id="S3.E2.m1.1.1.6.3.cmml" xref="S3.E2.m1.1.1.6.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.6.3.1.cmml" xref="S3.E2.m1.1.1.6.3">superscript</csymbol><cn id="S3.E2.m1.1.1.6.3.2.cmml" type="integer" xref="S3.E2.m1.1.1.6.3.2">10</cn><cn id="S3.E2.m1.1.1.6.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.6.3.3">7</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">N_{r}*N_{c}=\frac{R*C}{N_{dpu}}\leq 1.6*10^{7}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∗ italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = divide start_ARG italic_R ∗ italic_C end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d italic_p italic_u end_POSTSUBSCRIPT end_ARG ≤ 1.6 ∗ 10 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N_{c}=2k,\quad 1\leq k\leq 4" class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.3.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.cmml">N</mi><mi id="S3.E3.m1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">2</mn><mo id="S3.E3.m1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml">k</mi></mrow></mrow><mo id="S3.E3.m1.2.2.2.3" rspace="1.167em" xref="S3.E3.m1.2.2.3a.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml"><mn id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml">1</mn><mo id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.3.cmml">≤</mo><mi id="S3.E3.m1.2.2.2.2.4" xref="S3.E3.m1.2.2.2.2.4.cmml">k</mi><mo id="S3.E3.m1.2.2.2.2.5" xref="S3.E3.m1.2.2.2.2.5.cmml">≤</mo><mn id="S3.E3.m1.2.2.2.2.6" xref="S3.E3.m1.2.2.2.2.6.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.3a.cmml" xref="S3.E3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"></eq><apply id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2">𝑁</ci><ci id="S3.E3.m1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1"></times><cn id="S3.E3.m1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.3.2">2</cn><ci id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"><and id="S3.E3.m1.2.2.2.2a.cmml" xref="S3.E3.m1.2.2.2.2"></and><apply id="S3.E3.m1.2.2.2.2b.cmml" xref="S3.E3.m1.2.2.2.2"><leq id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3"></leq><cn id="S3.E3.m1.2.2.2.2.2.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.2">1</cn><ci id="S3.E3.m1.2.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.2.4">𝑘</ci></apply><apply id="S3.E3.m1.2.2.2.2c.cmml" xref="S3.E3.m1.2.2.2.2"><leq id="S3.E3.m1.2.2.2.2.5.cmml" xref="S3.E3.m1.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2406.13941v2#S3.E3.m1.2.2.2.2.4.cmml" id="S3.E3.m1.2.2.2.2d.cmml" xref="S3.E3.m1.2.2.2.2"></share><cn id="S3.E3.m1.2.2.2.2.6.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.6">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">N_{c}=2k,\quad 1\leq k\leq 4</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 2 italic_k , 1 ≤ italic_k ≤ 4</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.20">where <math alttext="N_{dpu}" class="ltx_Math" display="inline" id="S3.SS1.p4.14.m1.1"><semantics id="S3.SS1.p4.14.m1.1a"><msub id="S3.SS1.p4.14.m1.1.1" xref="S3.SS1.p4.14.m1.1.1.cmml"><mi id="S3.SS1.p4.14.m1.1.1.2" xref="S3.SS1.p4.14.m1.1.1.2.cmml">N</mi><mrow id="S3.SS1.p4.14.m1.1.1.3" xref="S3.SS1.p4.14.m1.1.1.3.cmml"><mi id="S3.SS1.p4.14.m1.1.1.3.2" xref="S3.SS1.p4.14.m1.1.1.3.2.cmml">d</mi><mo id="S3.SS1.p4.14.m1.1.1.3.1" xref="S3.SS1.p4.14.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.14.m1.1.1.3.3" xref="S3.SS1.p4.14.m1.1.1.3.3.cmml">p</mi><mo id="S3.SS1.p4.14.m1.1.1.3.1a" xref="S3.SS1.p4.14.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.14.m1.1.1.3.4" xref="S3.SS1.p4.14.m1.1.1.3.4.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.14.m1.1b"><apply id="S3.SS1.p4.14.m1.1.1.cmml" xref="S3.SS1.p4.14.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.14.m1.1.1.1.cmml" xref="S3.SS1.p4.14.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.14.m1.1.1.2.cmml" xref="S3.SS1.p4.14.m1.1.1.2">𝑁</ci><apply id="S3.SS1.p4.14.m1.1.1.3.cmml" xref="S3.SS1.p4.14.m1.1.1.3"><times id="S3.SS1.p4.14.m1.1.1.3.1.cmml" xref="S3.SS1.p4.14.m1.1.1.3.1"></times><ci id="S3.SS1.p4.14.m1.1.1.3.2.cmml" xref="S3.SS1.p4.14.m1.1.1.3.2">𝑑</ci><ci id="S3.SS1.p4.14.m1.1.1.3.3.cmml" xref="S3.SS1.p4.14.m1.1.1.3.3">𝑝</ci><ci id="S3.SS1.p4.14.m1.1.1.3.4.cmml" xref="S3.SS1.p4.14.m1.1.1.3.4">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.14.m1.1c">N_{dpu}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.14.m1.1d">italic_N start_POSTSUBSCRIPT italic_d italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> represents the number of DPUs used to stored EMTs. <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.p4.15.m2.1"><semantics id="S3.SS1.p4.15.m2.1a"><mi id="S3.SS1.p4.15.m2.1.1" xref="S3.SS1.p4.15.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.15.m2.1b"><ci id="S3.SS1.p4.15.m2.1.1.cmml" xref="S3.SS1.p4.15.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.15.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.15.m2.1d">italic_R</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p4.16.m3.1"><semantics id="S3.SS1.p4.16.m3.1a"><mi id="S3.SS1.p4.16.m3.1.1" xref="S3.SS1.p4.16.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.16.m3.1b"><ci id="S3.SS1.p4.16.m3.1.1.cmml" xref="S3.SS1.p4.16.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.16.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.16.m3.1d">italic_C</annotation></semantics></math> represent the number of rows and columns of the EMT, respectively. Both <math alttext="N_{dpu}" class="ltx_Math" display="inline" id="S3.SS1.p4.17.m4.1"><semantics id="S3.SS1.p4.17.m4.1a"><msub id="S3.SS1.p4.17.m4.1.1" xref="S3.SS1.p4.17.m4.1.1.cmml"><mi id="S3.SS1.p4.17.m4.1.1.2" xref="S3.SS1.p4.17.m4.1.1.2.cmml">N</mi><mrow id="S3.SS1.p4.17.m4.1.1.3" xref="S3.SS1.p4.17.m4.1.1.3.cmml"><mi id="S3.SS1.p4.17.m4.1.1.3.2" xref="S3.SS1.p4.17.m4.1.1.3.2.cmml">d</mi><mo id="S3.SS1.p4.17.m4.1.1.3.1" xref="S3.SS1.p4.17.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.17.m4.1.1.3.3" xref="S3.SS1.p4.17.m4.1.1.3.3.cmml">p</mi><mo id="S3.SS1.p4.17.m4.1.1.3.1a" xref="S3.SS1.p4.17.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.17.m4.1.1.3.4" xref="S3.SS1.p4.17.m4.1.1.3.4.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.17.m4.1b"><apply id="S3.SS1.p4.17.m4.1.1.cmml" xref="S3.SS1.p4.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.17.m4.1.1.1.cmml" xref="S3.SS1.p4.17.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.17.m4.1.1.2.cmml" xref="S3.SS1.p4.17.m4.1.1.2">𝑁</ci><apply id="S3.SS1.p4.17.m4.1.1.3.cmml" xref="S3.SS1.p4.17.m4.1.1.3"><times id="S3.SS1.p4.17.m4.1.1.3.1.cmml" xref="S3.SS1.p4.17.m4.1.1.3.1"></times><ci id="S3.SS1.p4.17.m4.1.1.3.2.cmml" xref="S3.SS1.p4.17.m4.1.1.3.2">𝑑</ci><ci id="S3.SS1.p4.17.m4.1.1.3.3.cmml" xref="S3.SS1.p4.17.m4.1.1.3.3">𝑝</ci><ci id="S3.SS1.p4.17.m4.1.1.3.4.cmml" xref="S3.SS1.p4.17.m4.1.1.3.4">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.17.m4.1c">N_{dpu}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.17.m4.1d">italic_N start_POSTSUBSCRIPT italic_d italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="R*C" class="ltx_Math" display="inline" id="S3.SS1.p4.18.m5.1"><semantics id="S3.SS1.p4.18.m5.1a"><mrow id="S3.SS1.p4.18.m5.1.1" xref="S3.SS1.p4.18.m5.1.1.cmml"><mi id="S3.SS1.p4.18.m5.1.1.2" xref="S3.SS1.p4.18.m5.1.1.2.cmml">R</mi><mo id="S3.SS1.p4.18.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.18.m5.1.1.1.cmml">∗</mo><mi id="S3.SS1.p4.18.m5.1.1.3" xref="S3.SS1.p4.18.m5.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.18.m5.1b"><apply id="S3.SS1.p4.18.m5.1.1.cmml" xref="S3.SS1.p4.18.m5.1.1"><times id="S3.SS1.p4.18.m5.1.1.1.cmml" xref="S3.SS1.p4.18.m5.1.1.1"></times><ci id="S3.SS1.p4.18.m5.1.1.2.cmml" xref="S3.SS1.p4.18.m5.1.1.2">𝑅</ci><ci id="S3.SS1.p4.18.m5.1.1.3.cmml" xref="S3.SS1.p4.18.m5.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.18.m5.1c">R*C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.18.m5.1d">italic_R ∗ italic_C</annotation></semantics></math> are fixed inputs to the problem.
The constraints greatly reduce the solution space of the problem. Thus we can simply search for the best <math alttext="N_{r}" class="ltx_Math" display="inline" id="S3.SS1.p4.19.m6.1"><semantics id="S3.SS1.p4.19.m6.1a"><msub id="S3.SS1.p4.19.m6.1.1" xref="S3.SS1.p4.19.m6.1.1.cmml"><mi id="S3.SS1.p4.19.m6.1.1.2" xref="S3.SS1.p4.19.m6.1.1.2.cmml">N</mi><mi id="S3.SS1.p4.19.m6.1.1.3" xref="S3.SS1.p4.19.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.19.m6.1b"><apply id="S3.SS1.p4.19.m6.1.1.cmml" xref="S3.SS1.p4.19.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.19.m6.1.1.1.cmml" xref="S3.SS1.p4.19.m6.1.1">subscript</csymbol><ci id="S3.SS1.p4.19.m6.1.1.2.cmml" xref="S3.SS1.p4.19.m6.1.1.2">𝑁</ci><ci id="S3.SS1.p4.19.m6.1.1.3.cmml" xref="S3.SS1.p4.19.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.19.m6.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.19.m6.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS1.p4.20.m7.1"><semantics id="S3.SS1.p4.20.m7.1a"><msub id="S3.SS1.p4.20.m7.1.1" xref="S3.SS1.p4.20.m7.1.1.cmml"><mi id="S3.SS1.p4.20.m7.1.1.2" xref="S3.SS1.p4.20.m7.1.1.2.cmml">N</mi><mi id="S3.SS1.p4.20.m7.1.1.3" xref="S3.SS1.p4.20.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.20.m7.1b"><apply id="S3.SS1.p4.20.m7.1.1.cmml" xref="S3.SS1.p4.20.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.20.m7.1.1.1.cmml" xref="S3.SS1.p4.20.m7.1.1">subscript</csymbol><ci id="S3.SS1.p4.20.m7.1.1.2.cmml" xref="S3.SS1.p4.20.m7.1.1.2">𝑁</ci><ci id="S3.SS1.p4.20.m7.1.1.3.cmml" xref="S3.SS1.p4.20.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.20.m7.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.20.m7.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> exhaustively.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Non-Uniform EMT Partitioning</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In the above discussion, we assume balanced distribution of memory accesses in a dataset, which is usually not true in real-world applications.
We study the data access patterns of EMTs using three real-world datasets Goodreads <cite class="ltx_cite ltx_citemacro_citep">(Wan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib18" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib19" title="">2019</a>)</cite>, Movie <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib16" title="">2019</a>)</cite> and Twitch <cite class="ltx_cite ltx_citemacro_citep">(Rappaz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib17" title="">2021</a>)</cite>.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F6" title="Figure 6 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">6</span></a> shows the total number of accesses per row block when dividing the rows into 8 blocks. Clearly, the three datasets all show imbalanced access distributions. The most popular block has 340 times higher number of accesses compared to the least popular block.
This will lead to workload imbalance problem to DPUs and make the uniform partitioning no longer optimal.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">To accommodate this, we propose a non-uniform EMT partitioning method that considers the imbalanced data access pattern in real datasets.
Specifically, consider using the same number of DPUs as the uniform partitioning, our non-uniform partitioning cuts an EMT into tiles of varying sizes and stores each tile in a separate DPU. DPUs used to store the same EMT collectively form a group as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F4" title="Figure 4 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>.
The goal is to achieve optimal workload balance among DPUs. We adopt a greedy method to achieve this goal. Specifically, by profiling the historical user-item access trace, we can obtain the access frequencies of all items. Consider each DPU as a bin, the problem of assigning each row to DPUs is a classical Bin-Packing problem with a fixed number of bins. We first order items according to their frequencies and then iteratively assign each row to the bin with the lowest total frequency unless the bin is full (64MB capacity). Note that we adopt the same <math alttext="N_{c}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑁</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> as optimized in uniform partitioning.
The complexity of the algorithm is hence <math alttext="O(R)" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.2.2" xref="S3.SS2.p2.2.m2.1.2.2.cmml">O</mi><mo id="S3.SS2.p2.2.m2.1.2.1" xref="S3.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.1.2.3.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mo id="S3.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">R</mi><mo id="S3.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.2.cmml" xref="S3.SS2.p2.2.m2.1.2"><times id="S3.SS2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.2.1"></times><ci id="S3.SS2.p2.2.m2.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.2.2">𝑂</ci><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">O(R)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_O ( italic_R )</annotation></semantics></math>. One could batch items when doing the assignment to reduce algorithm complexity.
Consider the Movie dataset which has a skewed item access frequency as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F6" title="Figure 6 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">6</span></a>.
When partitioning the EMT into 8 row blocks with our non-uniform algorithm, it can be observed from Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F6" title="Figure 6 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">6</span></a> that the number of accesses per partition is much more balanced (i.e., w/o cache).</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.4.1.1">Algorithm 1</span> </span> Cache-Aware Non-Uniform Partitioning</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><math alttext="N_{dpu}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" mathsize="70%" xref="alg1.l1.m1.1.1.2.cmml">N</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" mathsize="70%" xref="alg1.l1.m1.1.1.3.2.cmml">d</mi><mo id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.3" mathsize="70%" xref="alg1.l1.m1.1.1.3.3.cmml">p</mi><mo id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.4" mathsize="70%" xref="alg1.l1.m1.1.1.3.4.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑁</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑑</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑝</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">N_{dpu}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_N start_POSTSUBSCRIPT italic_d italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l1.2" style="font-size:70%;">: The number of DPUs/partitions;</span>
<br class="ltx_break"/><math alttext="obj\_freq" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" mathsize="70%" xref="alg1.l1.m2.1.1.2.cmml">o</mi><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.3" mathsize="70%" xref="alg1.l1.m2.1.1.3.cmml">b</mi><mo id="alg1.l1.m2.1.1.1a" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.4" mathsize="70%" xref="alg1.l1.m2.1.1.4.cmml">j</mi><mo id="alg1.l1.m2.1.1.1b" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.5" mathsize="70%" mathvariant="normal" xref="alg1.l1.m2.1.1.5.cmml">_</mi><mo id="alg1.l1.m2.1.1.1c" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.6" mathsize="70%" xref="alg1.l1.m2.1.1.6.cmml">f</mi><mo id="alg1.l1.m2.1.1.1d" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.7" mathsize="70%" xref="alg1.l1.m2.1.1.7.cmml">r</mi><mo id="alg1.l1.m2.1.1.1e" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.8" mathsize="70%" xref="alg1.l1.m2.1.1.8.cmml">e</mi><mo id="alg1.l1.m2.1.1.1f" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.9" mathsize="70%" xref="alg1.l1.m2.1.1.9.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><times id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></times><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑜</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑏</ci><ci id="alg1.l1.m2.1.1.4.cmml" xref="alg1.l1.m2.1.1.4">𝑗</ci><ci id="alg1.l1.m2.1.1.5.cmml" xref="alg1.l1.m2.1.1.5">_</ci><ci id="alg1.l1.m2.1.1.6.cmml" xref="alg1.l1.m2.1.1.6">𝑓</ci><ci id="alg1.l1.m2.1.1.7.cmml" xref="alg1.l1.m2.1.1.7">𝑟</ci><ci id="alg1.l1.m2.1.1.8.cmml" xref="alg1.l1.m2.1.1.8">𝑒</ci><ci id="alg1.l1.m2.1.1.9.cmml" xref="alg1.l1.m2.1.1.9">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">obj\_freq</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l1.3" style="font-size:70%;">: The item access frequency trace;</span>
<br class="ltx_break"/><math alttext="cache\_res" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" mathsize="70%" xref="alg1.l1.m3.1.1.2.cmml">c</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.3" mathsize="70%" xref="alg1.l1.m3.1.1.3.cmml">a</mi><mo id="alg1.l1.m3.1.1.1a" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.4" mathsize="70%" xref="alg1.l1.m3.1.1.4.cmml">c</mi><mo id="alg1.l1.m3.1.1.1b" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.5" mathsize="70%" xref="alg1.l1.m3.1.1.5.cmml">h</mi><mo id="alg1.l1.m3.1.1.1c" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.6" mathsize="70%" xref="alg1.l1.m3.1.1.6.cmml">e</mi><mo id="alg1.l1.m3.1.1.1d" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.7" mathsize="70%" mathvariant="normal" xref="alg1.l1.m3.1.1.7.cmml">_</mi><mo id="alg1.l1.m3.1.1.1e" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.8" mathsize="70%" xref="alg1.l1.m3.1.1.8.cmml">r</mi><mo id="alg1.l1.m3.1.1.1f" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.9" mathsize="70%" xref="alg1.l1.m3.1.1.9.cmml">e</mi><mo id="alg1.l1.m3.1.1.1g" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.10" mathsize="70%" xref="alg1.l1.m3.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><times id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></times><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑐</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑎</ci><ci id="alg1.l1.m3.1.1.4.cmml" xref="alg1.l1.m3.1.1.4">𝑐</ci><ci id="alg1.l1.m3.1.1.5.cmml" xref="alg1.l1.m3.1.1.5">ℎ</ci><ci id="alg1.l1.m3.1.1.6.cmml" xref="alg1.l1.m3.1.1.6">𝑒</ci><ci id="alg1.l1.m3.1.1.7.cmml" xref="alg1.l1.m3.1.1.7">_</ci><ci id="alg1.l1.m3.1.1.8.cmml" xref="alg1.l1.m3.1.1.8">𝑟</ci><ci id="alg1.l1.m3.1.1.9.cmml" xref="alg1.l1.m3.1.1.9">𝑒</ci><ci id="alg1.l1.m3.1.1.10.cmml" xref="alg1.l1.m3.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">cache\_res</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_c italic_a italic_c italic_h italic_e _ italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg1.l1.4" style="font-size:70%;">: A list of cached partial sums generated by GRACE </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="alg1.l1.5.1" style="font-size:70%;">(</span>Ye et al<span class="ltx_text">.</span><span class="ltx_text" id="alg1.l1.6.2.1.1" style="font-size:70%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a><span class="ltx_text" id="alg1.l1.7.3" style="font-size:70%;">)</span></cite><span class="ltx_text" id="alg1.l1.8" style="font-size:70%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><math alttext="assigned\_part" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" mathsize="70%" xref="alg1.l2.m1.1.1.2.cmml">a</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3" mathsize="70%" xref="alg1.l2.m1.1.1.3.cmml">s</mi><mo id="alg1.l2.m1.1.1.1a" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.4" mathsize="70%" xref="alg1.l2.m1.1.1.4.cmml">s</mi><mo id="alg1.l2.m1.1.1.1b" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.5" mathsize="70%" xref="alg1.l2.m1.1.1.5.cmml">i</mi><mo id="alg1.l2.m1.1.1.1c" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.6" mathsize="70%" xref="alg1.l2.m1.1.1.6.cmml">g</mi><mo id="alg1.l2.m1.1.1.1d" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.7" mathsize="70%" xref="alg1.l2.m1.1.1.7.cmml">n</mi><mo id="alg1.l2.m1.1.1.1e" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.8" mathsize="70%" xref="alg1.l2.m1.1.1.8.cmml">e</mi><mo id="alg1.l2.m1.1.1.1f" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.9" mathsize="70%" xref="alg1.l2.m1.1.1.9.cmml">d</mi><mo id="alg1.l2.m1.1.1.1g" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.10" mathsize="70%" mathvariant="normal" xref="alg1.l2.m1.1.1.10.cmml">_</mi><mo id="alg1.l2.m1.1.1.1h" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.11" mathsize="70%" xref="alg1.l2.m1.1.1.11.cmml">p</mi><mo id="alg1.l2.m1.1.1.1i" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.12" mathsize="70%" xref="alg1.l2.m1.1.1.12.cmml">a</mi><mo id="alg1.l2.m1.1.1.1j" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.13" mathsize="70%" xref="alg1.l2.m1.1.1.13.cmml">r</mi><mo id="alg1.l2.m1.1.1.1k" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.14" mathsize="70%" xref="alg1.l2.m1.1.1.14.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><times id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></times><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑎</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑠</ci><ci id="alg1.l2.m1.1.1.4.cmml" xref="alg1.l2.m1.1.1.4">𝑠</ci><ci id="alg1.l2.m1.1.1.5.cmml" xref="alg1.l2.m1.1.1.5">𝑖</ci><ci id="alg1.l2.m1.1.1.6.cmml" xref="alg1.l2.m1.1.1.6">𝑔</ci><ci id="alg1.l2.m1.1.1.7.cmml" xref="alg1.l2.m1.1.1.7">𝑛</ci><ci id="alg1.l2.m1.1.1.8.cmml" xref="alg1.l2.m1.1.1.8">𝑒</ci><ci id="alg1.l2.m1.1.1.9.cmml" xref="alg1.l2.m1.1.1.9">𝑑</ci><ci id="alg1.l2.m1.1.1.10.cmml" xref="alg1.l2.m1.1.1.10">_</ci><ci id="alg1.l2.m1.1.1.11.cmml" xref="alg1.l2.m1.1.1.11">𝑝</ci><ci id="alg1.l2.m1.1.1.12.cmml" xref="alg1.l2.m1.1.1.12">𝑎</ci><ci id="alg1.l2.m1.1.1.13.cmml" xref="alg1.l2.m1.1.1.13">𝑟</ci><ci id="alg1.l2.m1.1.1.14.cmml" xref="alg1.l2.m1.1.1.14">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">assigned\_part</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_a italic_s italic_s italic_i italic_g italic_n italic_e italic_d _ italic_p italic_a italic_r italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l2.2" style="font-size:70%;">: Assigned partition of each item.
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text" id="alg1.l3.2" style="font-size:70%;">Sort </span><math alttext="obj\_freq" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="70%" xref="alg1.l3.m1.1.1.2.cmml">o</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.3" mathsize="70%" xref="alg1.l3.m1.1.1.3.cmml">b</mi><mo id="alg1.l3.m1.1.1.1a" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.4" mathsize="70%" xref="alg1.l3.m1.1.1.4.cmml">j</mi><mo id="alg1.l3.m1.1.1.1b" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.5" mathsize="70%" mathvariant="normal" xref="alg1.l3.m1.1.1.5.cmml">_</mi><mo id="alg1.l3.m1.1.1.1c" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.6" mathsize="70%" xref="alg1.l3.m1.1.1.6.cmml">f</mi><mo id="alg1.l3.m1.1.1.1d" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.7" mathsize="70%" xref="alg1.l3.m1.1.1.7.cmml">r</mi><mo id="alg1.l3.m1.1.1.1e" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.8" mathsize="70%" xref="alg1.l3.m1.1.1.8.cmml">e</mi><mo id="alg1.l3.m1.1.1.1f" xref="alg1.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.9" mathsize="70%" xref="alg1.l3.m1.1.1.9.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><times id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></times><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑜</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑏</ci><ci id="alg1.l3.m1.1.1.4.cmml" xref="alg1.l3.m1.1.1.4">𝑗</ci><ci id="alg1.l3.m1.1.1.5.cmml" xref="alg1.l3.m1.1.1.5">_</ci><ci id="alg1.l3.m1.1.1.6.cmml" xref="alg1.l3.m1.1.1.6">𝑓</ci><ci id="alg1.l3.m1.1.1.7.cmml" xref="alg1.l3.m1.1.1.7">𝑟</ci><ci id="alg1.l3.m1.1.1.8.cmml" xref="alg1.l3.m1.1.1.8">𝑒</ci><ci id="alg1.l3.m1.1.1.9.cmml" xref="alg1.l3.m1.1.1.9">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">obj\_freq</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l3.3" style="font-size:70%;"> in descending order;
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><math alttext="p\_id=0" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" mathsize="70%" xref="alg1.l4.m1.1.1.2.2.cmml">p</mi><mo id="alg1.l4.m1.1.1.2.1" xref="alg1.l4.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.3" mathsize="70%" mathvariant="normal" xref="alg1.l4.m1.1.1.2.3.cmml">_</mi><mo id="alg1.l4.m1.1.1.2.1a" xref="alg1.l4.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.4" mathsize="70%" xref="alg1.l4.m1.1.1.2.4.cmml">i</mi><mo id="alg1.l4.m1.1.1.2.1b" xref="alg1.l4.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.5" mathsize="70%" xref="alg1.l4.m1.1.1.2.5.cmml">d</mi></mrow><mo id="alg1.l4.m1.1.1.1" mathsize="70%" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" mathsize="70%" xref="alg1.l4.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><times id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1"></times><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑝</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">_</ci><ci id="alg1.l4.m1.1.1.2.4.cmml" xref="alg1.l4.m1.1.1.2.4">𝑖</ci><ci id="alg1.l4.m1.1.1.2.5.cmml" xref="alg1.l4.m1.1.1.2.5">𝑑</ci></apply><cn id="alg1.l4.m1.1.1.3.cmml" type="integer" xref="alg1.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">p\_id=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_p _ italic_i italic_d = 0</annotation></semantics></math><span class="ltx_text" id="alg1.l4.2" style="font-size:70%;">;
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><math alttext="part\_count" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" mathsize="70%" xref="alg1.l5.m1.1.1.2.cmml">p</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3" mathsize="70%" xref="alg1.l5.m1.1.1.3.cmml">a</mi><mo id="alg1.l5.m1.1.1.1a" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.4" mathsize="70%" xref="alg1.l5.m1.1.1.4.cmml">r</mi><mo id="alg1.l5.m1.1.1.1b" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.5" mathsize="70%" xref="alg1.l5.m1.1.1.5.cmml">t</mi><mo id="alg1.l5.m1.1.1.1c" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.6" mathsize="70%" mathvariant="normal" xref="alg1.l5.m1.1.1.6.cmml">_</mi><mo id="alg1.l5.m1.1.1.1d" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.7" mathsize="70%" xref="alg1.l5.m1.1.1.7.cmml">c</mi><mo id="alg1.l5.m1.1.1.1e" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.8" mathsize="70%" xref="alg1.l5.m1.1.1.8.cmml">o</mi><mo id="alg1.l5.m1.1.1.1f" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.9" mathsize="70%" xref="alg1.l5.m1.1.1.9.cmml">u</mi><mo id="alg1.l5.m1.1.1.1g" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.10" mathsize="70%" xref="alg1.l5.m1.1.1.10.cmml">n</mi><mo id="alg1.l5.m1.1.1.1h" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.11" mathsize="70%" xref="alg1.l5.m1.1.1.11.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><times id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></times><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑝</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑎</ci><ci id="alg1.l5.m1.1.1.4.cmml" xref="alg1.l5.m1.1.1.4">𝑟</ci><ci id="alg1.l5.m1.1.1.5.cmml" xref="alg1.l5.m1.1.1.5">𝑡</ci><ci id="alg1.l5.m1.1.1.6.cmml" xref="alg1.l5.m1.1.1.6">_</ci><ci id="alg1.l5.m1.1.1.7.cmml" xref="alg1.l5.m1.1.1.7">𝑐</ci><ci id="alg1.l5.m1.1.1.8.cmml" xref="alg1.l5.m1.1.1.8">𝑜</ci><ci id="alg1.l5.m1.1.1.9.cmml" xref="alg1.l5.m1.1.1.9">𝑢</ci><ci id="alg1.l5.m1.1.1.10.cmml" xref="alg1.l5.m1.1.1.10">𝑛</ci><ci id="alg1.l5.m1.1.1.11.cmml" xref="alg1.l5.m1.1.1.11">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">part\_count</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l5.2" style="font-size:70%;"> counts the current size of each partition; </span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l6.3" style="font-size:70%;">for</span><span class="ltx_text" id="alg1.l6.4" style="font-size:70%;"> </span><math alttext="list" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" mathsize="70%" xref="alg1.l6.m1.1.1.2.cmml">l</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3" mathsize="70%" xref="alg1.l6.m1.1.1.3.cmml">i</mi><mo id="alg1.l6.m1.1.1.1a" xref="alg1.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.4" mathsize="70%" xref="alg1.l6.m1.1.1.4.cmml">s</mi><mo id="alg1.l6.m1.1.1.1b" xref="alg1.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.5" mathsize="70%" xref="alg1.l6.m1.1.1.5.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><times id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></times><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑙</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑖</ci><ci id="alg1.l6.m1.1.1.4.cmml" xref="alg1.l6.m1.1.1.4">𝑠</ci><ci id="alg1.l6.m1.1.1.5.cmml" xref="alg1.l6.m1.1.1.5">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">list</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_l italic_i italic_s italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l6.5" style="font-size:70%;"> in </span><math alttext="cache\_res" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" mathsize="70%" xref="alg1.l6.m2.1.1.2.cmml">c</mi><mo id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.3" mathsize="70%" xref="alg1.l6.m2.1.1.3.cmml">a</mi><mo id="alg1.l6.m2.1.1.1a" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.4" mathsize="70%" xref="alg1.l6.m2.1.1.4.cmml">c</mi><mo id="alg1.l6.m2.1.1.1b" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.5" mathsize="70%" xref="alg1.l6.m2.1.1.5.cmml">h</mi><mo id="alg1.l6.m2.1.1.1c" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.6" mathsize="70%" xref="alg1.l6.m2.1.1.6.cmml">e</mi><mo id="alg1.l6.m2.1.1.1d" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.7" mathsize="70%" mathvariant="normal" xref="alg1.l6.m2.1.1.7.cmml">_</mi><mo id="alg1.l6.m2.1.1.1e" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.8" mathsize="70%" xref="alg1.l6.m2.1.1.8.cmml">r</mi><mo id="alg1.l6.m2.1.1.1f" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.9" mathsize="70%" xref="alg1.l6.m2.1.1.9.cmml">e</mi><mo id="alg1.l6.m2.1.1.1g" xref="alg1.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.10" mathsize="70%" xref="alg1.l6.m2.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><times id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"></times><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑐</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑎</ci><ci id="alg1.l6.m2.1.1.4.cmml" xref="alg1.l6.m2.1.1.4">𝑐</ci><ci id="alg1.l6.m2.1.1.5.cmml" xref="alg1.l6.m2.1.1.5">ℎ</ci><ci id="alg1.l6.m2.1.1.6.cmml" xref="alg1.l6.m2.1.1.6">𝑒</ci><ci id="alg1.l6.m2.1.1.7.cmml" xref="alg1.l6.m2.1.1.7">_</ci><ci id="alg1.l6.m2.1.1.8.cmml" xref="alg1.l6.m2.1.1.8">𝑟</ci><ci id="alg1.l6.m2.1.1.9.cmml" xref="alg1.l6.m2.1.1.9">𝑒</ci><ci id="alg1.l6.m2.1.1.10.cmml" xref="alg1.l6.m2.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">cache\_res</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_c italic_a italic_c italic_h italic_e _ italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg1.l6.6" style="font-size:70%;">  </span><span class="ltx_text ltx_font_bold" id="alg1.l6.7" style="font-size:70%;">do</span><span class="ltx_text" id="alg1.l6.8" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l6.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Cache hit
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.2.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg1.l7.3" style="font-size:70%;">    </span><math alttext="benefit=list[-1]" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" mathsize="70%" xref="alg1.l7.m1.1.1.3.2.cmml">b</mi><mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.3" mathsize="70%" xref="alg1.l7.m1.1.1.3.3.cmml">e</mi><mo id="alg1.l7.m1.1.1.3.1a" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.4" mathsize="70%" xref="alg1.l7.m1.1.1.3.4.cmml">n</mi><mo id="alg1.l7.m1.1.1.3.1b" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.5" mathsize="70%" xref="alg1.l7.m1.1.1.3.5.cmml">e</mi><mo id="alg1.l7.m1.1.1.3.1c" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.6" mathsize="70%" xref="alg1.l7.m1.1.1.3.6.cmml">f</mi><mo id="alg1.l7.m1.1.1.3.1d" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.7" mathsize="70%" xref="alg1.l7.m1.1.1.3.7.cmml">i</mi><mo id="alg1.l7.m1.1.1.3.1e" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.8" mathsize="70%" xref="alg1.l7.m1.1.1.3.8.cmml">t</mi></mrow><mo id="alg1.l7.m1.1.1.2" mathsize="70%" xref="alg1.l7.m1.1.1.2.cmml">=</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.3" mathsize="70%" xref="alg1.l7.m1.1.1.1.3.cmml">l</mi><mo id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.1.4" mathsize="70%" xref="alg1.l7.m1.1.1.1.4.cmml">i</mi><mo id="alg1.l7.m1.1.1.1.2a" xref="alg1.l7.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.1.5" mathsize="70%" xref="alg1.l7.m1.1.1.1.5.cmml">s</mi><mo id="alg1.l7.m1.1.1.1.2b" xref="alg1.l7.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.1.6" mathsize="70%" xref="alg1.l7.m1.1.1.1.6.cmml">t</mi><mo id="alg1.l7.m1.1.1.1.2c" xref="alg1.l7.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.2.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l7.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.1a" mathsize="70%" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">−</mo><mn id="alg1.l7.m1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="alg1.l7.m1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l7.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"></eq><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><times id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑏</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑒</ci><ci id="alg1.l7.m1.1.1.3.4.cmml" xref="alg1.l7.m1.1.1.3.4">𝑛</ci><ci id="alg1.l7.m1.1.1.3.5.cmml" xref="alg1.l7.m1.1.1.3.5">𝑒</ci><ci id="alg1.l7.m1.1.1.3.6.cmml" xref="alg1.l7.m1.1.1.3.6">𝑓</ci><ci id="alg1.l7.m1.1.1.3.7.cmml" xref="alg1.l7.m1.1.1.3.7">𝑖</ci><ci id="alg1.l7.m1.1.1.3.8.cmml" xref="alg1.l7.m1.1.1.3.8">𝑡</ci></apply><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><ci id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">𝑙</ci><ci id="alg1.l7.m1.1.1.1.4.cmml" xref="alg1.l7.m1.1.1.1.4">𝑖</ci><ci id="alg1.l7.m1.1.1.1.5.cmml" xref="alg1.l7.m1.1.1.1.5">𝑠</ci><ci id="alg1.l7.m1.1.1.1.6.cmml" xref="alg1.l7.m1.1.1.1.6">𝑡</ci><apply id="alg1.l7.m1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l7.m1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><minus id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"></minus><cn id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l7.m1.1.1.1.1.1.1.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">benefit=list[-1]</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_b italic_e italic_n italic_e italic_f italic_i italic_t = italic_l italic_i italic_s italic_t [ - 1 ]</annotation></semantics></math><span class="ltx_text" id="alg1.l7.4" style="font-size:70%;">;
</span><span class="ltx_text" id="alg1.l7.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Reduced memory access estimated by GRACE
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:70%;">    </span><math alttext="p\_id" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" mathsize="70%" xref="alg1.l8.m1.1.1.2.cmml">p</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3" mathsize="70%" mathvariant="normal" xref="alg1.l8.m1.1.1.3.cmml">_</mi><mo id="alg1.l8.m1.1.1.1a" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.4" mathsize="70%" xref="alg1.l8.m1.1.1.4.cmml">i</mi><mo id="alg1.l8.m1.1.1.1b" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.5" mathsize="70%" xref="alg1.l8.m1.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><times id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></times><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑝</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">_</ci><ci id="alg1.l8.m1.1.1.4.cmml" xref="alg1.l8.m1.1.1.4">𝑖</ci><ci id="alg1.l8.m1.1.1.5.cmml" xref="alg1.l8.m1.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">p\_id</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_p _ italic_i italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l8.3" style="font-size:70%;"> </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mo id="alg1.l8.m2.1.1" mathsize="70%" stretchy="false" xref="alg1.l8.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.l8.4" style="font-size:70%;"> The partition with the lowest </span><math alttext="part\_count" class="ltx_Math" display="inline" id="alg1.l8.m3.1"><semantics id="alg1.l8.m3.1a"><mrow id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml"><mi id="alg1.l8.m3.1.1.2" mathsize="70%" xref="alg1.l8.m3.1.1.2.cmml">p</mi><mo id="alg1.l8.m3.1.1.1" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.3" mathsize="70%" xref="alg1.l8.m3.1.1.3.cmml">a</mi><mo id="alg1.l8.m3.1.1.1a" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.4" mathsize="70%" xref="alg1.l8.m3.1.1.4.cmml">r</mi><mo id="alg1.l8.m3.1.1.1b" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.5" mathsize="70%" xref="alg1.l8.m3.1.1.5.cmml">t</mi><mo id="alg1.l8.m3.1.1.1c" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.6" mathsize="70%" mathvariant="normal" xref="alg1.l8.m3.1.1.6.cmml">_</mi><mo id="alg1.l8.m3.1.1.1d" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.7" mathsize="70%" xref="alg1.l8.m3.1.1.7.cmml">c</mi><mo id="alg1.l8.m3.1.1.1e" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.8" mathsize="70%" xref="alg1.l8.m3.1.1.8.cmml">o</mi><mo id="alg1.l8.m3.1.1.1f" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.9" mathsize="70%" xref="alg1.l8.m3.1.1.9.cmml">u</mi><mo id="alg1.l8.m3.1.1.1g" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.10" mathsize="70%" xref="alg1.l8.m3.1.1.10.cmml">n</mi><mo id="alg1.l8.m3.1.1.1h" xref="alg1.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m3.1.1.11" mathsize="70%" xref="alg1.l8.m3.1.1.11.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><apply id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1"><times id="alg1.l8.m3.1.1.1.cmml" xref="alg1.l8.m3.1.1.1"></times><ci id="alg1.l8.m3.1.1.2.cmml" xref="alg1.l8.m3.1.1.2">𝑝</ci><ci id="alg1.l8.m3.1.1.3.cmml" xref="alg1.l8.m3.1.1.3">𝑎</ci><ci id="alg1.l8.m3.1.1.4.cmml" xref="alg1.l8.m3.1.1.4">𝑟</ci><ci id="alg1.l8.m3.1.1.5.cmml" xref="alg1.l8.m3.1.1.5">𝑡</ci><ci id="alg1.l8.m3.1.1.6.cmml" xref="alg1.l8.m3.1.1.6">_</ci><ci id="alg1.l8.m3.1.1.7.cmml" xref="alg1.l8.m3.1.1.7">𝑐</ci><ci id="alg1.l8.m3.1.1.8.cmml" xref="alg1.l8.m3.1.1.8">𝑜</ci><ci id="alg1.l8.m3.1.1.9.cmml" xref="alg1.l8.m3.1.1.9">𝑢</ci><ci id="alg1.l8.m3.1.1.10.cmml" xref="alg1.l8.m3.1.1.10">𝑛</ci><ci id="alg1.l8.m3.1.1.11.cmml" xref="alg1.l8.m3.1.1.11">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">part\_count</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m3.1d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l8.5" style="font-size:70%;"> value and enough cache capacity;
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:70%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l9.3" style="font-size:70%;">for</span><span class="ltx_text" id="alg1.l9.4" style="font-size:70%;"> </span><math alttext="index" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" mathsize="70%" xref="alg1.l9.m1.1.1.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3" mathsize="70%" xref="alg1.l9.m1.1.1.3.cmml">n</mi><mo id="alg1.l9.m1.1.1.1a" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.4" mathsize="70%" xref="alg1.l9.m1.1.1.4.cmml">d</mi><mo id="alg1.l9.m1.1.1.1b" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.5" mathsize="70%" xref="alg1.l9.m1.1.1.5.cmml">e</mi><mo id="alg1.l9.m1.1.1.1c" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.6" mathsize="70%" xref="alg1.l9.m1.1.1.6.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><times id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></times><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑖</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑛</ci><ci id="alg1.l9.m1.1.1.4.cmml" xref="alg1.l9.m1.1.1.4">𝑑</ci><ci id="alg1.l9.m1.1.1.5.cmml" xref="alg1.l9.m1.1.1.5">𝑒</ci><ci id="alg1.l9.m1.1.1.6.cmml" xref="alg1.l9.m1.1.1.6">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">index</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_i italic_n italic_d italic_e italic_x</annotation></semantics></math><span class="ltx_text" id="alg1.l9.5" style="font-size:70%;"> in </span><math alttext="list" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" mathsize="70%" xref="alg1.l9.m2.1.1.2.cmml">l</mi><mo id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.3" mathsize="70%" xref="alg1.l9.m2.1.1.3.cmml">i</mi><mo id="alg1.l9.m2.1.1.1a" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.4" mathsize="70%" xref="alg1.l9.m2.1.1.4.cmml">s</mi><mo id="alg1.l9.m2.1.1.1b" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.5" mathsize="70%" xref="alg1.l9.m2.1.1.5.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><times id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"></times><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑙</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑖</ci><ci id="alg1.l9.m2.1.1.4.cmml" xref="alg1.l9.m2.1.1.4">𝑠</ci><ci id="alg1.l9.m2.1.1.5.cmml" xref="alg1.l9.m2.1.1.5">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">list</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_l italic_i italic_s italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l9.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l9.7" style="font-size:70%;">do</span><span class="ltx_text" id="alg1.l9.8" style="font-size:70%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.2" style="font-size:70%;">       </span><math alttext="assigned\_part[index]=p\_id" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.3" mathsize="70%" xref="alg1.l10.m1.1.1.1.3.cmml">a</mi><mo id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.4" mathsize="70%" xref="alg1.l10.m1.1.1.1.4.cmml">s</mi><mo id="alg1.l10.m1.1.1.1.2a" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.5" mathsize="70%" xref="alg1.l10.m1.1.1.1.5.cmml">s</mi><mo id="alg1.l10.m1.1.1.1.2b" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.6" mathsize="70%" xref="alg1.l10.m1.1.1.1.6.cmml">i</mi><mo id="alg1.l10.m1.1.1.1.2c" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.7" mathsize="70%" xref="alg1.l10.m1.1.1.1.7.cmml">g</mi><mo id="alg1.l10.m1.1.1.1.2d" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.8" mathsize="70%" xref="alg1.l10.m1.1.1.1.8.cmml">n</mi><mo id="alg1.l10.m1.1.1.1.2e" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.9" mathsize="70%" xref="alg1.l10.m1.1.1.1.9.cmml">e</mi><mo id="alg1.l10.m1.1.1.1.2f" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.10" mathsize="70%" xref="alg1.l10.m1.1.1.1.10.cmml">d</mi><mo id="alg1.l10.m1.1.1.1.2g" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.11" mathsize="70%" mathvariant="normal" xref="alg1.l10.m1.1.1.1.11.cmml">_</mi><mo id="alg1.l10.m1.1.1.1.2h" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.12" mathsize="70%" xref="alg1.l10.m1.1.1.1.12.cmml">p</mi><mo id="alg1.l10.m1.1.1.1.2i" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.13" mathsize="70%" xref="alg1.l10.m1.1.1.1.13.cmml">a</mi><mo id="alg1.l10.m1.1.1.1.2j" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.14" mathsize="70%" xref="alg1.l10.m1.1.1.1.14.cmml">r</mi><mo id="alg1.l10.m1.1.1.1.2k" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.15" mathsize="70%" xref="alg1.l10.m1.1.1.1.15.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.2l" xref="alg1.l10.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l10.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.3" mathsize="70%" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">n</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1a" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l10.m1.1.1.1.1.1.1.4.cmml">d</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1b" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l10.m1.1.1.1.1.1.1.5.cmml">e</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1c" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.6" mathsize="70%" xref="alg1.l10.m1.1.1.1.1.1.1.6.cmml">x</mi></mrow><mo id="alg1.l10.m1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l10.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l10.m1.1.1.2" mathsize="70%" xref="alg1.l10.m1.1.1.2.cmml">=</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" mathsize="70%" xref="alg1.l10.m1.1.1.3.2.cmml">p</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.3" mathsize="70%" mathvariant="normal" xref="alg1.l10.m1.1.1.3.3.cmml">_</mi><mo id="alg1.l10.m1.1.1.3.1a" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.4" mathsize="70%" xref="alg1.l10.m1.1.1.3.4.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.1b" xref="alg1.l10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.5" mathsize="70%" xref="alg1.l10.m1.1.1.3.5.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></eq><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3">𝑎</ci><ci id="alg1.l10.m1.1.1.1.4.cmml" xref="alg1.l10.m1.1.1.1.4">𝑠</ci><ci id="alg1.l10.m1.1.1.1.5.cmml" xref="alg1.l10.m1.1.1.1.5">𝑠</ci><ci id="alg1.l10.m1.1.1.1.6.cmml" xref="alg1.l10.m1.1.1.1.6">𝑖</ci><ci id="alg1.l10.m1.1.1.1.7.cmml" xref="alg1.l10.m1.1.1.1.7">𝑔</ci><ci id="alg1.l10.m1.1.1.1.8.cmml" xref="alg1.l10.m1.1.1.1.8">𝑛</ci><ci id="alg1.l10.m1.1.1.1.9.cmml" xref="alg1.l10.m1.1.1.1.9">𝑒</ci><ci id="alg1.l10.m1.1.1.1.10.cmml" xref="alg1.l10.m1.1.1.1.10">𝑑</ci><ci id="alg1.l10.m1.1.1.1.11.cmml" xref="alg1.l10.m1.1.1.1.11">_</ci><ci id="alg1.l10.m1.1.1.1.12.cmml" xref="alg1.l10.m1.1.1.1.12">𝑝</ci><ci id="alg1.l10.m1.1.1.1.13.cmml" xref="alg1.l10.m1.1.1.1.13">𝑎</ci><ci id="alg1.l10.m1.1.1.1.14.cmml" xref="alg1.l10.m1.1.1.1.14">𝑟</ci><ci id="alg1.l10.m1.1.1.1.15.cmml" xref="alg1.l10.m1.1.1.1.15">𝑡</ci><apply id="alg1.l10.m1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l10.m1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1"><times id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">𝑛</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.4">𝑑</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.5">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.6">𝑥</ci></apply></apply></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑝</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">_</ci><ci id="alg1.l10.m1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.3.4">𝑖</ci><ci id="alg1.l10.m1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">assigned\_part[index]=p\_id</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_a italic_s italic_s italic_i italic_g italic_n italic_e italic_d _ italic_p italic_a italic_r italic_t [ italic_i italic_n italic_d italic_e italic_x ] = italic_p _ italic_i italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l10.3" style="font-size:70%;">;
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg1.l11.2" style="font-size:70%;">       </span><math alttext="part\_count[p\_id]+=obj\_freq[index]" class="ltx_Math" display="inline" id="alg1.l11.m1.2"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.3" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.3.cmml">p</mi><mo id="alg1.l11.m1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.4" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.4.cmml">a</mi><mo id="alg1.l11.m1.1.1.1.1.2a" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.5" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.5.cmml">r</mi><mo id="alg1.l11.m1.1.1.1.1.2b" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.6" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.6.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.2c" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.7" mathsize="70%" mathvariant="normal" xref="alg1.l11.m1.1.1.1.1.7.cmml">_</mi><mo id="alg1.l11.m1.1.1.1.1.2d" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.8" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.8.cmml">c</mi><mo id="alg1.l11.m1.1.1.1.1.2e" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.9" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.9.cmml">o</mi><mo id="alg1.l11.m1.1.1.1.1.2f" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.10" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.10.cmml">u</mi><mo id="alg1.l11.m1.1.1.1.1.2g" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.11" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.11.cmml">n</mi><mo id="alg1.l11.m1.1.1.1.1.2h" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.12" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.12.cmml">t</mi><mo id="alg1.l11.m1.1.1.1.1.2i" xref="alg1.l11.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l11.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.1.1.1.3" mathsize="70%" mathvariant="normal" xref="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml">_</mi><mo id="alg1.l11.m1.1.1.1.1.1.1.1.1a" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.4.cmml">i</mi><mo id="alg1.l11.m1.1.1.1.1.1.1.1.1b" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.5.cmml">d</mi></mrow><mo id="alg1.l11.m1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l11.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l11.m1.1.1.1.3" mathsize="70%" rspace="0em" xref="alg1.l11.m1.1.1.1.3.cmml">+</mo></mrow><mo id="alg1.l11.m1.2.2.3" lspace="0em" mathsize="70%" xref="alg1.l11.m1.2.2.3.cmml">=</mo><mrow id="alg1.l11.m1.2.2.2" xref="alg1.l11.m1.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.3" mathsize="70%" xref="alg1.l11.m1.2.2.2.3.cmml">o</mi><mo id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.4" mathsize="70%" xref="alg1.l11.m1.2.2.2.4.cmml">b</mi><mo id="alg1.l11.m1.2.2.2.2a" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.5" mathsize="70%" xref="alg1.l11.m1.2.2.2.5.cmml">j</mi><mo id="alg1.l11.m1.2.2.2.2b" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.6" mathsize="70%" mathvariant="normal" xref="alg1.l11.m1.2.2.2.6.cmml">_</mi><mo id="alg1.l11.m1.2.2.2.2c" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.7" mathsize="70%" xref="alg1.l11.m1.2.2.2.7.cmml">f</mi><mo id="alg1.l11.m1.2.2.2.2d" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.8" mathsize="70%" xref="alg1.l11.m1.2.2.2.8.cmml">r</mi><mo id="alg1.l11.m1.2.2.2.2e" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.9" mathsize="70%" xref="alg1.l11.m1.2.2.2.9.cmml">e</mi><mo id="alg1.l11.m1.2.2.2.2f" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.10" mathsize="70%" xref="alg1.l11.m1.2.2.2.10.cmml">q</mi><mo id="alg1.l11.m1.2.2.2.2g" xref="alg1.l11.m1.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l11.m1.2.2.2.1.1" xref="alg1.l11.m1.2.2.2.1.2.cmml"><mo id="alg1.l11.m1.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l11.m1.2.2.2.1.2.1.cmml">[</mo><mrow id="alg1.l11.m1.2.2.2.1.1.1" xref="alg1.l11.m1.2.2.2.1.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.1.1.1.2" mathsize="70%" xref="alg1.l11.m1.2.2.2.1.1.1.2.cmml">i</mi><mo id="alg1.l11.m1.2.2.2.1.1.1.1" xref="alg1.l11.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.1.1.1.3" mathsize="70%" xref="alg1.l11.m1.2.2.2.1.1.1.3.cmml">n</mi><mo id="alg1.l11.m1.2.2.2.1.1.1.1a" xref="alg1.l11.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.1.1.1.4" mathsize="70%" xref="alg1.l11.m1.2.2.2.1.1.1.4.cmml">d</mi><mo id="alg1.l11.m1.2.2.2.1.1.1.1b" xref="alg1.l11.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.1.1.1.5" mathsize="70%" xref="alg1.l11.m1.2.2.2.1.1.1.5.cmml">e</mi><mo id="alg1.l11.m1.2.2.2.1.1.1.1c" xref="alg1.l11.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.1.1.1.6" mathsize="70%" xref="alg1.l11.m1.2.2.2.1.1.1.6.cmml">x</mi></mrow><mo id="alg1.l11.m1.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l11.m1.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><eq id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2.3"></eq><apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"><csymbol cd="latexml" id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1">limit-from</csymbol><apply id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.2"></times><ci id="alg1.l11.m1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.3">𝑝</ci><ci id="alg1.l11.m1.1.1.1.1.4.cmml" xref="alg1.l11.m1.1.1.1.1.4">𝑎</ci><ci id="alg1.l11.m1.1.1.1.1.5.cmml" xref="alg1.l11.m1.1.1.1.1.5">𝑟</ci><ci id="alg1.l11.m1.1.1.1.1.6.cmml" xref="alg1.l11.m1.1.1.1.1.6">𝑡</ci><ci id="alg1.l11.m1.1.1.1.1.7.cmml" xref="alg1.l11.m1.1.1.1.1.7">_</ci><ci id="alg1.l11.m1.1.1.1.1.8.cmml" xref="alg1.l11.m1.1.1.1.1.8">𝑐</ci><ci id="alg1.l11.m1.1.1.1.1.9.cmml" xref="alg1.l11.m1.1.1.1.1.9">𝑜</ci><ci id="alg1.l11.m1.1.1.1.1.10.cmml" xref="alg1.l11.m1.1.1.1.1.10">𝑢</ci><ci id="alg1.l11.m1.1.1.1.1.11.cmml" xref="alg1.l11.m1.1.1.1.1.11">𝑛</ci><ci id="alg1.l11.m1.1.1.1.1.12.cmml" xref="alg1.l11.m1.1.1.1.1.12">𝑡</ci><apply id="alg1.l11.m1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l11.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.3">_</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.5">𝑑</ci></apply></apply></apply><plus id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3"></plus></apply><apply id="alg1.l11.m1.2.2.2.cmml" xref="alg1.l11.m1.2.2.2"><times id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"></times><ci id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.3">𝑜</ci><ci id="alg1.l11.m1.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.4">𝑏</ci><ci id="alg1.l11.m1.2.2.2.5.cmml" xref="alg1.l11.m1.2.2.2.5">𝑗</ci><ci id="alg1.l11.m1.2.2.2.6.cmml" xref="alg1.l11.m1.2.2.2.6">_</ci><ci id="alg1.l11.m1.2.2.2.7.cmml" xref="alg1.l11.m1.2.2.2.7">𝑓</ci><ci id="alg1.l11.m1.2.2.2.8.cmml" xref="alg1.l11.m1.2.2.2.8">𝑟</ci><ci id="alg1.l11.m1.2.2.2.9.cmml" xref="alg1.l11.m1.2.2.2.9">𝑒</ci><ci id="alg1.l11.m1.2.2.2.10.cmml" xref="alg1.l11.m1.2.2.2.10">𝑞</ci><apply id="alg1.l11.m1.2.2.2.1.2.cmml" xref="alg1.l11.m1.2.2.2.1.1"><csymbol cd="latexml" id="alg1.l11.m1.2.2.2.1.2.1.cmml" xref="alg1.l11.m1.2.2.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l11.m1.2.2.2.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.1.1.1"><times id="alg1.l11.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.1"></times><ci id="alg1.l11.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.2">𝑖</ci><ci id="alg1.l11.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.3">𝑛</ci><ci id="alg1.l11.m1.2.2.2.1.1.1.4.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.4">𝑑</ci><ci id="alg1.l11.m1.2.2.2.1.1.1.5.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.5">𝑒</ci><ci id="alg1.l11.m1.2.2.2.1.1.1.6.cmml" xref="alg1.l11.m1.2.2.2.1.1.1.6">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">part\_count[p\_id]+=obj\_freq[index]</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.2d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t [ italic_p _ italic_i italic_d ] + = italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q [ italic_i italic_n italic_d italic_e italic_x ]</annotation></semantics></math><span class="ltx_text" id="alg1.l11.3" style="font-size:70%;">;
    </span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg1.l12.2" style="font-size:70%;">    </span><math alttext="part\_count[p\_id]-=benefit" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.3" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.3.cmml">p</mi><mo id="alg1.l12.m1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.4" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.4.cmml">a</mi><mo id="alg1.l12.m1.1.1.1.1.2a" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.5" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.5.cmml">r</mi><mo id="alg1.l12.m1.1.1.1.1.2b" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.6" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.6.cmml">t</mi><mo id="alg1.l12.m1.1.1.1.1.2c" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.7" mathsize="70%" mathvariant="normal" xref="alg1.l12.m1.1.1.1.1.7.cmml">_</mi><mo id="alg1.l12.m1.1.1.1.1.2d" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.8" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.8.cmml">c</mi><mo id="alg1.l12.m1.1.1.1.1.2e" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.9" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.9.cmml">o</mi><mo id="alg1.l12.m1.1.1.1.1.2f" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.10" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.10.cmml">u</mi><mo id="alg1.l12.m1.1.1.1.1.2g" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.11" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.11.cmml">n</mi><mo id="alg1.l12.m1.1.1.1.1.2h" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.12" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.12.cmml">t</mi><mo id="alg1.l12.m1.1.1.1.1.2i" xref="alg1.l12.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l12.m1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l12.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.1.3" mathsize="70%" mathvariant="normal" xref="alg1.l12.m1.1.1.1.1.1.1.1.3.cmml">_</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.1.1a" xref="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.1.1.1.4.cmml">i</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.1.1b" xref="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l12.m1.1.1.1.1.1.1.1.5.cmml">d</mi></mrow><mo id="alg1.l12.m1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l12.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l12.m1.1.1.1.3" mathsize="70%" rspace="0em" xref="alg1.l12.m1.1.1.1.3.cmml">−</mo></mrow><mo id="alg1.l12.m1.1.1.2" lspace="0em" mathsize="70%" xref="alg1.l12.m1.1.1.2.cmml">=</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" mathsize="70%" xref="alg1.l12.m1.1.1.3.2.cmml">b</mi><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.3" mathsize="70%" xref="alg1.l12.m1.1.1.3.3.cmml">e</mi><mo id="alg1.l12.m1.1.1.3.1a" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.4" mathsize="70%" xref="alg1.l12.m1.1.1.3.4.cmml">n</mi><mo id="alg1.l12.m1.1.1.3.1b" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.5" mathsize="70%" xref="alg1.l12.m1.1.1.3.5.cmml">e</mi><mo id="alg1.l12.m1.1.1.3.1c" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.6" mathsize="70%" xref="alg1.l12.m1.1.1.3.6.cmml">f</mi><mo id="alg1.l12.m1.1.1.3.1d" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.7" mathsize="70%" xref="alg1.l12.m1.1.1.3.7.cmml">i</mi><mo id="alg1.l12.m1.1.1.3.1e" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.8" mathsize="70%" xref="alg1.l12.m1.1.1.3.8.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"></eq><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><csymbol cd="latexml" id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1">limit-from</csymbol><apply id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1"><times id="alg1.l12.m1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.2"></times><ci id="alg1.l12.m1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.3">𝑝</ci><ci id="alg1.l12.m1.1.1.1.1.4.cmml" xref="alg1.l12.m1.1.1.1.1.4">𝑎</ci><ci id="alg1.l12.m1.1.1.1.1.5.cmml" xref="alg1.l12.m1.1.1.1.1.5">𝑟</ci><ci id="alg1.l12.m1.1.1.1.1.6.cmml" xref="alg1.l12.m1.1.1.1.1.6">𝑡</ci><ci id="alg1.l12.m1.1.1.1.1.7.cmml" xref="alg1.l12.m1.1.1.1.1.7">_</ci><ci id="alg1.l12.m1.1.1.1.1.8.cmml" xref="alg1.l12.m1.1.1.1.1.8">𝑐</ci><ci id="alg1.l12.m1.1.1.1.1.9.cmml" xref="alg1.l12.m1.1.1.1.1.9">𝑜</ci><ci id="alg1.l12.m1.1.1.1.1.10.cmml" xref="alg1.l12.m1.1.1.1.1.10">𝑢</ci><ci id="alg1.l12.m1.1.1.1.1.11.cmml" xref="alg1.l12.m1.1.1.1.1.11">𝑛</ci><ci id="alg1.l12.m1.1.1.1.1.12.cmml" xref="alg1.l12.m1.1.1.1.1.12">𝑡</ci><apply id="alg1.l12.m1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l12.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1"><times id="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.3">_</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.5">𝑑</ci></apply></apply></apply><minus id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3"></minus></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><times id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></times><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝑏</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑒</ci><ci id="alg1.l12.m1.1.1.3.4.cmml" xref="alg1.l12.m1.1.1.3.4">𝑛</ci><ci id="alg1.l12.m1.1.1.3.5.cmml" xref="alg1.l12.m1.1.1.3.5">𝑒</ci><ci id="alg1.l12.m1.1.1.3.6.cmml" xref="alg1.l12.m1.1.1.3.6">𝑓</ci><ci id="alg1.l12.m1.1.1.3.7.cmml" xref="alg1.l12.m1.1.1.3.7">𝑖</ci><ci id="alg1.l12.m1.1.1.3.8.cmml" xref="alg1.l12.m1.1.1.3.8">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">part\_count[p\_id]-=benefit</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t [ italic_p _ italic_i italic_d ] - = italic_b italic_e italic_n italic_e italic_f italic_i italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l12.3" style="font-size:70%;">;
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.2.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l13.3" style="font-size:70%;">for</span><span class="ltx_text" id="alg1.l13.4" style="font-size:70%;"> </span><math alttext="index" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" mathsize="70%" xref="alg1.l13.m1.1.1.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3" mathsize="70%" xref="alg1.l13.m1.1.1.3.cmml">n</mi><mo id="alg1.l13.m1.1.1.1a" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.4" mathsize="70%" xref="alg1.l13.m1.1.1.4.cmml">d</mi><mo id="alg1.l13.m1.1.1.1b" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.5" mathsize="70%" xref="alg1.l13.m1.1.1.5.cmml">e</mi><mo id="alg1.l13.m1.1.1.1c" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.6" mathsize="70%" xref="alg1.l13.m1.1.1.6.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><times id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></times><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑖</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑛</ci><ci id="alg1.l13.m1.1.1.4.cmml" xref="alg1.l13.m1.1.1.4">𝑑</ci><ci id="alg1.l13.m1.1.1.5.cmml" xref="alg1.l13.m1.1.1.5">𝑒</ci><ci id="alg1.l13.m1.1.1.6.cmml" xref="alg1.l13.m1.1.1.6">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">index</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_i italic_n italic_d italic_e italic_x</annotation></semantics></math><span class="ltx_text" id="alg1.l13.5" style="font-size:70%;"> in </span><math alttext="obj\_freq" class="ltx_Math" display="inline" id="alg1.l13.m2.1"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mi id="alg1.l13.m2.1.1.2" mathsize="70%" xref="alg1.l13.m2.1.1.2.cmml">o</mi><mo id="alg1.l13.m2.1.1.1" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.3" mathsize="70%" xref="alg1.l13.m2.1.1.3.cmml">b</mi><mo id="alg1.l13.m2.1.1.1a" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.4" mathsize="70%" xref="alg1.l13.m2.1.1.4.cmml">j</mi><mo id="alg1.l13.m2.1.1.1b" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.5" mathsize="70%" mathvariant="normal" xref="alg1.l13.m2.1.1.5.cmml">_</mi><mo id="alg1.l13.m2.1.1.1c" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.6" mathsize="70%" xref="alg1.l13.m2.1.1.6.cmml">f</mi><mo id="alg1.l13.m2.1.1.1d" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.7" mathsize="70%" xref="alg1.l13.m2.1.1.7.cmml">r</mi><mo id="alg1.l13.m2.1.1.1e" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.8" mathsize="70%" xref="alg1.l13.m2.1.1.8.cmml">e</mi><mo id="alg1.l13.m2.1.1.1f" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.9" mathsize="70%" xref="alg1.l13.m2.1.1.9.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><times id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1.1"></times><ci id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2">𝑜</ci><ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">𝑏</ci><ci id="alg1.l13.m2.1.1.4.cmml" xref="alg1.l13.m2.1.1.4">𝑗</ci><ci id="alg1.l13.m2.1.1.5.cmml" xref="alg1.l13.m2.1.1.5">_</ci><ci id="alg1.l13.m2.1.1.6.cmml" xref="alg1.l13.m2.1.1.6">𝑓</ci><ci id="alg1.l13.m2.1.1.7.cmml" xref="alg1.l13.m2.1.1.7">𝑟</ci><ci id="alg1.l13.m2.1.1.8.cmml" xref="alg1.l13.m2.1.1.8">𝑒</ci><ci id="alg1.l13.m2.1.1.9.cmml" xref="alg1.l13.m2.1.1.9">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">obj\_freq</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l13.6" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l13.7" style="font-size:70%;">do</span><span class="ltx_text" id="alg1.l13.8" style="font-size:70%;"> </span><span class="ltx_text" id="alg1.l13.1" style="font-size:70%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Cache miss
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg1.l14.2" style="font-size:70%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l14.3" style="font-size:70%;">if</span><span class="ltx_text" id="alg1.l14.4" style="font-size:70%;"> </span><math alttext="index\notin cache\_res" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" mathsize="70%" xref="alg1.l14.m1.1.1.2.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.2.1" xref="alg1.l14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.3" mathsize="70%" xref="alg1.l14.m1.1.1.2.3.cmml">n</mi><mo id="alg1.l14.m1.1.1.2.1a" xref="alg1.l14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.4" mathsize="70%" xref="alg1.l14.m1.1.1.2.4.cmml">d</mi><mo id="alg1.l14.m1.1.1.2.1b" xref="alg1.l14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.5" mathsize="70%" xref="alg1.l14.m1.1.1.2.5.cmml">e</mi><mo id="alg1.l14.m1.1.1.2.1c" xref="alg1.l14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.2.6" mathsize="70%" xref="alg1.l14.m1.1.1.2.6.cmml">x</mi></mrow><mo id="alg1.l14.m1.1.1.1" mathsize="70%" xref="alg1.l14.m1.1.1.1.cmml">∉</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" mathsize="70%" xref="alg1.l14.m1.1.1.3.2.cmml">c</mi><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.3" mathsize="70%" xref="alg1.l14.m1.1.1.3.3.cmml">a</mi><mo id="alg1.l14.m1.1.1.3.1a" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.4" mathsize="70%" xref="alg1.l14.m1.1.1.3.4.cmml">c</mi><mo id="alg1.l14.m1.1.1.3.1b" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.5" mathsize="70%" xref="alg1.l14.m1.1.1.3.5.cmml">h</mi><mo id="alg1.l14.m1.1.1.3.1c" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.6" mathsize="70%" xref="alg1.l14.m1.1.1.3.6.cmml">e</mi><mo id="alg1.l14.m1.1.1.3.1d" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.7" mathsize="70%" mathvariant="normal" xref="alg1.l14.m1.1.1.3.7.cmml">_</mi><mo id="alg1.l14.m1.1.1.3.1e" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.8" mathsize="70%" xref="alg1.l14.m1.1.1.3.8.cmml">r</mi><mo id="alg1.l14.m1.1.1.3.1f" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.9" mathsize="70%" xref="alg1.l14.m1.1.1.3.9.cmml">e</mi><mo id="alg1.l14.m1.1.1.3.1g" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.10" mathsize="70%" xref="alg1.l14.m1.1.1.3.10.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><notin id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></notin><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><times id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2.1"></times><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝑖</ci><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑛</ci><ci id="alg1.l14.m1.1.1.2.4.cmml" xref="alg1.l14.m1.1.1.2.4">𝑑</ci><ci id="alg1.l14.m1.1.1.2.5.cmml" xref="alg1.l14.m1.1.1.2.5">𝑒</ci><ci id="alg1.l14.m1.1.1.2.6.cmml" xref="alg1.l14.m1.1.1.2.6">𝑥</ci></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><times id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></times><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝑐</ci><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑎</ci><ci id="alg1.l14.m1.1.1.3.4.cmml" xref="alg1.l14.m1.1.1.3.4">𝑐</ci><ci id="alg1.l14.m1.1.1.3.5.cmml" xref="alg1.l14.m1.1.1.3.5">ℎ</ci><ci id="alg1.l14.m1.1.1.3.6.cmml" xref="alg1.l14.m1.1.1.3.6">𝑒</ci><ci id="alg1.l14.m1.1.1.3.7.cmml" xref="alg1.l14.m1.1.1.3.7">_</ci><ci id="alg1.l14.m1.1.1.3.8.cmml" xref="alg1.l14.m1.1.1.3.8">𝑟</ci><ci id="alg1.l14.m1.1.1.3.9.cmml" xref="alg1.l14.m1.1.1.3.9">𝑒</ci><ci id="alg1.l14.m1.1.1.3.10.cmml" xref="alg1.l14.m1.1.1.3.10">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">index\notin cache\_res</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_i italic_n italic_d italic_e italic_x ∉ italic_c italic_a italic_c italic_h italic_e _ italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg1.l14.5" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l14.6" style="font-size:70%;">then</span><span class="ltx_text" id="alg1.l14.7" style="font-size:70%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg1.l15.2" style="font-size:70%;">       </span><math alttext="p\_id" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" mathsize="70%" xref="alg1.l15.m1.1.1.2.cmml">p</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.3" mathsize="70%" mathvariant="normal" xref="alg1.l15.m1.1.1.3.cmml">_</mi><mo id="alg1.l15.m1.1.1.1a" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.4" mathsize="70%" xref="alg1.l15.m1.1.1.4.cmml">i</mi><mo id="alg1.l15.m1.1.1.1b" xref="alg1.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.5" mathsize="70%" xref="alg1.l15.m1.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><times id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></times><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑝</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">_</ci><ci id="alg1.l15.m1.1.1.4.cmml" xref="alg1.l15.m1.1.1.4">𝑖</ci><ci id="alg1.l15.m1.1.1.5.cmml" xref="alg1.l15.m1.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">p\_id</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_p _ italic_i italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l15.3" style="font-size:70%;"> </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l15.m2.1"><semantics id="alg1.l15.m2.1a"><mo id="alg1.l15.m2.1.1" mathsize="70%" stretchy="false" xref="alg1.l15.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><ci id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m2.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.l15.4" style="font-size:70%;"> The partition with the lowest </span><math alttext="part\_count" class="ltx_Math" display="inline" id="alg1.l15.m3.1"><semantics id="alg1.l15.m3.1a"><mrow id="alg1.l15.m3.1.1" xref="alg1.l15.m3.1.1.cmml"><mi id="alg1.l15.m3.1.1.2" mathsize="70%" xref="alg1.l15.m3.1.1.2.cmml">p</mi><mo id="alg1.l15.m3.1.1.1" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.3" mathsize="70%" xref="alg1.l15.m3.1.1.3.cmml">a</mi><mo id="alg1.l15.m3.1.1.1a" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.4" mathsize="70%" xref="alg1.l15.m3.1.1.4.cmml">r</mi><mo id="alg1.l15.m3.1.1.1b" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.5" mathsize="70%" xref="alg1.l15.m3.1.1.5.cmml">t</mi><mo id="alg1.l15.m3.1.1.1c" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.6" mathsize="70%" mathvariant="normal" xref="alg1.l15.m3.1.1.6.cmml">_</mi><mo id="alg1.l15.m3.1.1.1d" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.7" mathsize="70%" xref="alg1.l15.m3.1.1.7.cmml">c</mi><mo id="alg1.l15.m3.1.1.1e" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.8" mathsize="70%" xref="alg1.l15.m3.1.1.8.cmml">o</mi><mo id="alg1.l15.m3.1.1.1f" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.9" mathsize="70%" xref="alg1.l15.m3.1.1.9.cmml">u</mi><mo id="alg1.l15.m3.1.1.1g" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.10" mathsize="70%" xref="alg1.l15.m3.1.1.10.cmml">n</mi><mo id="alg1.l15.m3.1.1.1h" xref="alg1.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m3.1.1.11" mathsize="70%" xref="alg1.l15.m3.1.1.11.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m3.1b"><apply id="alg1.l15.m3.1.1.cmml" xref="alg1.l15.m3.1.1"><times id="alg1.l15.m3.1.1.1.cmml" xref="alg1.l15.m3.1.1.1"></times><ci id="alg1.l15.m3.1.1.2.cmml" xref="alg1.l15.m3.1.1.2">𝑝</ci><ci id="alg1.l15.m3.1.1.3.cmml" xref="alg1.l15.m3.1.1.3">𝑎</ci><ci id="alg1.l15.m3.1.1.4.cmml" xref="alg1.l15.m3.1.1.4">𝑟</ci><ci id="alg1.l15.m3.1.1.5.cmml" xref="alg1.l15.m3.1.1.5">𝑡</ci><ci id="alg1.l15.m3.1.1.6.cmml" xref="alg1.l15.m3.1.1.6">_</ci><ci id="alg1.l15.m3.1.1.7.cmml" xref="alg1.l15.m3.1.1.7">𝑐</ci><ci id="alg1.l15.m3.1.1.8.cmml" xref="alg1.l15.m3.1.1.8">𝑜</ci><ci id="alg1.l15.m3.1.1.9.cmml" xref="alg1.l15.m3.1.1.9">𝑢</ci><ci id="alg1.l15.m3.1.1.10.cmml" xref="alg1.l15.m3.1.1.10">𝑛</ci><ci id="alg1.l15.m3.1.1.11.cmml" xref="alg1.l15.m3.1.1.11">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m3.1c">part\_count</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m3.1d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l15.5" style="font-size:70%;"> value and enough EMT capacity;
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text" id="alg1.l16.2" style="font-size:70%;">       </span><math alttext="assigned\_part[index]=p\_id" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.3" mathsize="70%" xref="alg1.l16.m1.1.1.1.3.cmml">a</mi><mo id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.4" mathsize="70%" xref="alg1.l16.m1.1.1.1.4.cmml">s</mi><mo id="alg1.l16.m1.1.1.1.2a" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.5" mathsize="70%" xref="alg1.l16.m1.1.1.1.5.cmml">s</mi><mo id="alg1.l16.m1.1.1.1.2b" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.6" mathsize="70%" xref="alg1.l16.m1.1.1.1.6.cmml">i</mi><mo id="alg1.l16.m1.1.1.1.2c" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.7" mathsize="70%" xref="alg1.l16.m1.1.1.1.7.cmml">g</mi><mo id="alg1.l16.m1.1.1.1.2d" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.8" mathsize="70%" xref="alg1.l16.m1.1.1.1.8.cmml">n</mi><mo id="alg1.l16.m1.1.1.1.2e" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.9" mathsize="70%" xref="alg1.l16.m1.1.1.1.9.cmml">e</mi><mo id="alg1.l16.m1.1.1.1.2f" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.10" mathsize="70%" xref="alg1.l16.m1.1.1.1.10.cmml">d</mi><mo id="alg1.l16.m1.1.1.1.2g" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.11" mathsize="70%" mathvariant="normal" xref="alg1.l16.m1.1.1.1.11.cmml">_</mi><mo id="alg1.l16.m1.1.1.1.2h" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.12" mathsize="70%" xref="alg1.l16.m1.1.1.1.12.cmml">p</mi><mo id="alg1.l16.m1.1.1.1.2i" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.13" mathsize="70%" xref="alg1.l16.m1.1.1.1.13.cmml">a</mi><mo id="alg1.l16.m1.1.1.1.2j" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.14" mathsize="70%" xref="alg1.l16.m1.1.1.1.14.cmml">r</mi><mo id="alg1.l16.m1.1.1.1.2k" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.15" mathsize="70%" xref="alg1.l16.m1.1.1.1.15.cmml">t</mi><mo id="alg1.l16.m1.1.1.1.2l" xref="alg1.l16.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.2.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l16.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.1.1.1.3" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml">n</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.1a" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.1.4.cmml">d</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.1b" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.1.5.cmml">e</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.1c" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.1.1.1.1.6" mathsize="70%" xref="alg1.l16.m1.1.1.1.1.1.1.6.cmml">x</mi></mrow><mo id="alg1.l16.m1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l16.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l16.m1.1.1.2" mathsize="70%" xref="alg1.l16.m1.1.1.2.cmml">=</mo><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" mathsize="70%" xref="alg1.l16.m1.1.1.3.2.cmml">p</mi><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.3" mathsize="70%" mathvariant="normal" xref="alg1.l16.m1.1.1.3.3.cmml">_</mi><mo id="alg1.l16.m1.1.1.3.1a" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.4" mathsize="70%" xref="alg1.l16.m1.1.1.3.4.cmml">i</mi><mo id="alg1.l16.m1.1.1.3.1b" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.5" mathsize="70%" xref="alg1.l16.m1.1.1.3.5.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><eq id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2"></eq><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><ci id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3">𝑎</ci><ci id="alg1.l16.m1.1.1.1.4.cmml" xref="alg1.l16.m1.1.1.1.4">𝑠</ci><ci id="alg1.l16.m1.1.1.1.5.cmml" xref="alg1.l16.m1.1.1.1.5">𝑠</ci><ci id="alg1.l16.m1.1.1.1.6.cmml" xref="alg1.l16.m1.1.1.1.6">𝑖</ci><ci id="alg1.l16.m1.1.1.1.7.cmml" xref="alg1.l16.m1.1.1.1.7">𝑔</ci><ci id="alg1.l16.m1.1.1.1.8.cmml" xref="alg1.l16.m1.1.1.1.8">𝑛</ci><ci id="alg1.l16.m1.1.1.1.9.cmml" xref="alg1.l16.m1.1.1.1.9">𝑒</ci><ci id="alg1.l16.m1.1.1.1.10.cmml" xref="alg1.l16.m1.1.1.1.10">𝑑</ci><ci id="alg1.l16.m1.1.1.1.11.cmml" xref="alg1.l16.m1.1.1.1.11">_</ci><ci id="alg1.l16.m1.1.1.1.12.cmml" xref="alg1.l16.m1.1.1.1.12">𝑝</ci><ci id="alg1.l16.m1.1.1.1.13.cmml" xref="alg1.l16.m1.1.1.1.13">𝑎</ci><ci id="alg1.l16.m1.1.1.1.14.cmml" xref="alg1.l16.m1.1.1.1.14">𝑟</ci><ci id="alg1.l16.m1.1.1.1.15.cmml" xref="alg1.l16.m1.1.1.1.15">𝑡</ci><apply id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l16.m1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">𝑛</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.4">𝑑</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.5">𝑒</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.6">𝑥</ci></apply></apply></apply><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><times id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></times><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝑝</ci><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">_</ci><ci id="alg1.l16.m1.1.1.3.4.cmml" xref="alg1.l16.m1.1.1.3.4">𝑖</ci><ci id="alg1.l16.m1.1.1.3.5.cmml" xref="alg1.l16.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">assigned\_part[index]=p\_id</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_a italic_s italic_s italic_i italic_g italic_n italic_e italic_d _ italic_p italic_a italic_r italic_t [ italic_i italic_n italic_d italic_e italic_x ] = italic_p _ italic_i italic_d</annotation></semantics></math><span class="ltx_text" id="alg1.l16.3" style="font-size:70%;">;
</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text" id="alg1.l17.2" style="font-size:70%;">       </span><math alttext="part\_count[p\_id]+=obj\_freq[index]" class="ltx_Math" display="inline" id="alg1.l17.m1.2"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.3" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.3.cmml">p</mi><mo id="alg1.l17.m1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.4" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.4.cmml">a</mi><mo id="alg1.l17.m1.1.1.1.1.2a" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.5" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.5.cmml">r</mi><mo id="alg1.l17.m1.1.1.1.1.2b" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.6" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.6.cmml">t</mi><mo id="alg1.l17.m1.1.1.1.1.2c" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.7" mathsize="70%" mathvariant="normal" xref="alg1.l17.m1.1.1.1.1.7.cmml">_</mi><mo id="alg1.l17.m1.1.1.1.1.2d" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.8" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.8.cmml">c</mi><mo id="alg1.l17.m1.1.1.1.1.2e" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.9" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.9.cmml">o</mi><mo id="alg1.l17.m1.1.1.1.1.2f" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.10" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.10.cmml">u</mi><mo id="alg1.l17.m1.1.1.1.1.2g" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.11" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.11.cmml">n</mi><mo id="alg1.l17.m1.1.1.1.1.2h" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.12" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.12.cmml">t</mi><mo id="alg1.l17.m1.1.1.1.1.2i" xref="alg1.l17.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.2.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l17.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.2" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.3" mathsize="70%" mathvariant="normal" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml">_</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1a" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.4" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.1.1.1.4.cmml">i</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1b" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.5" mathsize="70%" xref="alg1.l17.m1.1.1.1.1.1.1.1.5.cmml">d</mi></mrow><mo id="alg1.l17.m1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l17.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l17.m1.1.1.1.3" mathsize="70%" rspace="0em" xref="alg1.l17.m1.1.1.1.3.cmml">+</mo></mrow><mo id="alg1.l17.m1.2.2.3" lspace="0em" mathsize="70%" xref="alg1.l17.m1.2.2.3.cmml">=</mo><mrow id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.2.cmml"><mi id="alg1.l17.m1.2.2.2.3" mathsize="70%" xref="alg1.l17.m1.2.2.2.3.cmml">o</mi><mo id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.4" mathsize="70%" xref="alg1.l17.m1.2.2.2.4.cmml">b</mi><mo id="alg1.l17.m1.2.2.2.2a" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.5" mathsize="70%" xref="alg1.l17.m1.2.2.2.5.cmml">j</mi><mo id="alg1.l17.m1.2.2.2.2b" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.6" mathsize="70%" mathvariant="normal" xref="alg1.l17.m1.2.2.2.6.cmml">_</mi><mo id="alg1.l17.m1.2.2.2.2c" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.7" mathsize="70%" xref="alg1.l17.m1.2.2.2.7.cmml">f</mi><mo id="alg1.l17.m1.2.2.2.2d" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.8" mathsize="70%" xref="alg1.l17.m1.2.2.2.8.cmml">r</mi><mo id="alg1.l17.m1.2.2.2.2e" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.9" mathsize="70%" xref="alg1.l17.m1.2.2.2.9.cmml">e</mi><mo id="alg1.l17.m1.2.2.2.2f" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.10" mathsize="70%" xref="alg1.l17.m1.2.2.2.10.cmml">q</mi><mo id="alg1.l17.m1.2.2.2.2g" xref="alg1.l17.m1.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l17.m1.2.2.2.1.1" xref="alg1.l17.m1.2.2.2.1.2.cmml"><mo id="alg1.l17.m1.2.2.2.1.1.2" maxsize="70%" minsize="70%" xref="alg1.l17.m1.2.2.2.1.2.1.cmml">[</mo><mrow id="alg1.l17.m1.2.2.2.1.1.1" xref="alg1.l17.m1.2.2.2.1.1.1.cmml"><mi id="alg1.l17.m1.2.2.2.1.1.1.2" mathsize="70%" xref="alg1.l17.m1.2.2.2.1.1.1.2.cmml">i</mi><mo id="alg1.l17.m1.2.2.2.1.1.1.1" xref="alg1.l17.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.1.1.1.3" mathsize="70%" xref="alg1.l17.m1.2.2.2.1.1.1.3.cmml">n</mi><mo id="alg1.l17.m1.2.2.2.1.1.1.1a" xref="alg1.l17.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.1.1.1.4" mathsize="70%" xref="alg1.l17.m1.2.2.2.1.1.1.4.cmml">d</mi><mo id="alg1.l17.m1.2.2.2.1.1.1.1b" xref="alg1.l17.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.1.1.1.5" mathsize="70%" xref="alg1.l17.m1.2.2.2.1.1.1.5.cmml">e</mi><mo id="alg1.l17.m1.2.2.2.1.1.1.1c" xref="alg1.l17.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m1.2.2.2.1.1.1.6" mathsize="70%" xref="alg1.l17.m1.2.2.2.1.1.1.6.cmml">x</mi></mrow><mo id="alg1.l17.m1.2.2.2.1.1.3" maxsize="70%" minsize="70%" xref="alg1.l17.m1.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><eq id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.3"></eq><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><csymbol cd="latexml" id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1">limit-from</csymbol><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"></times><ci id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3">𝑝</ci><ci id="alg1.l17.m1.1.1.1.1.4.cmml" xref="alg1.l17.m1.1.1.1.1.4">𝑎</ci><ci id="alg1.l17.m1.1.1.1.1.5.cmml" xref="alg1.l17.m1.1.1.1.1.5">𝑟</ci><ci id="alg1.l17.m1.1.1.1.1.6.cmml" xref="alg1.l17.m1.1.1.1.1.6">𝑡</ci><ci id="alg1.l17.m1.1.1.1.1.7.cmml" xref="alg1.l17.m1.1.1.1.1.7">_</ci><ci id="alg1.l17.m1.1.1.1.1.8.cmml" xref="alg1.l17.m1.1.1.1.1.8">𝑐</ci><ci id="alg1.l17.m1.1.1.1.1.9.cmml" xref="alg1.l17.m1.1.1.1.1.9">𝑜</ci><ci id="alg1.l17.m1.1.1.1.1.10.cmml" xref="alg1.l17.m1.1.1.1.1.10">𝑢</ci><ci id="alg1.l17.m1.1.1.1.1.11.cmml" xref="alg1.l17.m1.1.1.1.1.11">𝑛</ci><ci id="alg1.l17.m1.1.1.1.1.12.cmml" xref="alg1.l17.m1.1.1.1.1.12">𝑡</ci><apply id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l17.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3">_</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.5.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.5">𝑑</ci></apply></apply></apply><plus id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"></plus></apply><apply id="alg1.l17.m1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2"><times id="alg1.l17.m1.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2"></times><ci id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.3">𝑜</ci><ci id="alg1.l17.m1.2.2.2.4.cmml" xref="alg1.l17.m1.2.2.2.4">𝑏</ci><ci id="alg1.l17.m1.2.2.2.5.cmml" xref="alg1.l17.m1.2.2.2.5">𝑗</ci><ci id="alg1.l17.m1.2.2.2.6.cmml" xref="alg1.l17.m1.2.2.2.6">_</ci><ci id="alg1.l17.m1.2.2.2.7.cmml" xref="alg1.l17.m1.2.2.2.7">𝑓</ci><ci id="alg1.l17.m1.2.2.2.8.cmml" xref="alg1.l17.m1.2.2.2.8">𝑟</ci><ci id="alg1.l17.m1.2.2.2.9.cmml" xref="alg1.l17.m1.2.2.2.9">𝑒</ci><ci id="alg1.l17.m1.2.2.2.10.cmml" xref="alg1.l17.m1.2.2.2.10">𝑞</ci><apply id="alg1.l17.m1.2.2.2.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1"><csymbol cd="latexml" id="alg1.l17.m1.2.2.2.1.2.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l17.m1.2.2.2.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.1"><times id="alg1.l17.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1"></times><ci id="alg1.l17.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.2">𝑖</ci><ci id="alg1.l17.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.3">𝑛</ci><ci id="alg1.l17.m1.2.2.2.1.1.1.4.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.4">𝑑</ci><ci id="alg1.l17.m1.2.2.2.1.1.1.5.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.5">𝑒</ci><ci id="alg1.l17.m1.2.2.2.1.1.1.6.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.6">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">part\_count[p\_id]+=obj\_freq[index]</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.2d">italic_p italic_a italic_r italic_t _ italic_c italic_o italic_u italic_n italic_t [ italic_p _ italic_i italic_d ] + = italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q [ italic_i italic_n italic_d italic_e italic_x ]</annotation></semantics></math><span class="ltx_text" id="alg1.l17.3" style="font-size:70%;">;
    </span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l18.2" style="font-size:70%;">return</span><span class="ltx_text" id="alg1.l18.3" style="font-size:70%;"> </span><math alttext="assigned\_part" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2" mathsize="70%" xref="alg1.l18.m1.1.1.2.cmml">a</mi><mo id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3" mathsize="70%" xref="alg1.l18.m1.1.1.3.cmml">s</mi><mo id="alg1.l18.m1.1.1.1a" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.4" mathsize="70%" xref="alg1.l18.m1.1.1.4.cmml">s</mi><mo id="alg1.l18.m1.1.1.1b" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.5" mathsize="70%" xref="alg1.l18.m1.1.1.5.cmml">i</mi><mo id="alg1.l18.m1.1.1.1c" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.6" mathsize="70%" xref="alg1.l18.m1.1.1.6.cmml">g</mi><mo id="alg1.l18.m1.1.1.1d" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.7" mathsize="70%" xref="alg1.l18.m1.1.1.7.cmml">n</mi><mo id="alg1.l18.m1.1.1.1e" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.8" mathsize="70%" xref="alg1.l18.m1.1.1.8.cmml">e</mi><mo id="alg1.l18.m1.1.1.1f" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.9" mathsize="70%" xref="alg1.l18.m1.1.1.9.cmml">d</mi><mo id="alg1.l18.m1.1.1.1g" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.10" mathsize="70%" mathvariant="normal" xref="alg1.l18.m1.1.1.10.cmml">_</mi><mo id="alg1.l18.m1.1.1.1h" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.11" mathsize="70%" xref="alg1.l18.m1.1.1.11.cmml">p</mi><mo id="alg1.l18.m1.1.1.1i" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.12" mathsize="70%" xref="alg1.l18.m1.1.1.12.cmml">a</mi><mo id="alg1.l18.m1.1.1.1j" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.13" mathsize="70%" xref="alg1.l18.m1.1.1.13.cmml">r</mi><mo id="alg1.l18.m1.1.1.1k" xref="alg1.l18.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.14" mathsize="70%" xref="alg1.l18.m1.1.1.14.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><times id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"></times><ci id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">𝑎</ci><ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">𝑠</ci><ci id="alg1.l18.m1.1.1.4.cmml" xref="alg1.l18.m1.1.1.4">𝑠</ci><ci id="alg1.l18.m1.1.1.5.cmml" xref="alg1.l18.m1.1.1.5">𝑖</ci><ci id="alg1.l18.m1.1.1.6.cmml" xref="alg1.l18.m1.1.1.6">𝑔</ci><ci id="alg1.l18.m1.1.1.7.cmml" xref="alg1.l18.m1.1.1.7">𝑛</ci><ci id="alg1.l18.m1.1.1.8.cmml" xref="alg1.l18.m1.1.1.8">𝑒</ci><ci id="alg1.l18.m1.1.1.9.cmml" xref="alg1.l18.m1.1.1.9">𝑑</ci><ci id="alg1.l18.m1.1.1.10.cmml" xref="alg1.l18.m1.1.1.10">_</ci><ci id="alg1.l18.m1.1.1.11.cmml" xref="alg1.l18.m1.1.1.11">𝑝</ci><ci id="alg1.l18.m1.1.1.12.cmml" xref="alg1.l18.m1.1.1.12">𝑎</ci><ci id="alg1.l18.m1.1.1.13.cmml" xref="alg1.l18.m1.1.1.13">𝑟</ci><ci id="alg1.l18.m1.1.1.14.cmml" xref="alg1.l18.m1.1.1.14">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">assigned\_part</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_a italic_s italic_s italic_i italic_g italic_n italic_e italic_d _ italic_p italic_a italic_r italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l18.4" style="font-size:70%;">;
</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Cache-Aware Non-Uniform Partitioning</h3>
<figure class="ltx_figure" id="S3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="328" id="S3.F7.g1" src="x7.png" width="663"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.2.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S3.F7.3.2" style="font-size:90%;">Example of cache-aware partitioning</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Existing studies <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>; Kal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib10" title="">2021</a>)</cite> leverage the power-law distribution of item access frequencies to cache the partial sum of popular items to reduce memory traffic and accelerate DLRM inference.
For example, the recent GRACE <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite> algorithm takes the <em class="ltx_emph ltx_font_italic" id="S3.SS3.p1.1.1">co-occurrences</em> of popular items into account, and adopts a graph-based algorithm to identify frequently accessed item combinations. These combinations’ partial sums are cached to reduce memory traffic.
The caching techniques have already demonstrated effectiveness on reducing DLRM inference latency. However, when applied to our DPU-based DLRM, they further exacerbate the workload imbalance problem among DPUs.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F6" title="Figure 6 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">6</span></a>, when partitioning the Movie dataset using our non-uniform algorithm with GRACE-based caching, the total number of memory accesses is reduced by 40% compared to without caching, while the access pattern is much imbalanced across DPUs.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.15">To address this issue, we propose cache-aware non-uniform partitioning as shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#alg1" title="Algorithm 1 ‣ 3.2. Non-Uniform EMT Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>.
The function takes three inputs, including <math alttext="N_{dpu}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">N</mi><mrow id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">d</mi><mo id="S3.SS3.p2.1.m1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">p</mi><mo id="S3.SS3.p2.1.m1.1.1.3.1a" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.1.m1.1.1.3.4" xref="S3.SS3.p2.1.m1.1.1.3.4.cmml">u</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑁</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><times id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑑</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑝</ci><ci id="S3.SS3.p2.1.m1.1.1.3.4.cmml" xref="S3.SS3.p2.1.m1.1.1.3.4">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">N_{dpu}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_d italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="obj\_freq" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">o</mi><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">b</mi><mo id="S3.SS3.p2.2.m2.1.1.1a" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.4" xref="S3.SS3.p2.2.m2.1.1.4.cmml">j</mi><mo id="S3.SS3.p2.2.m2.1.1.1b" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.5" mathvariant="normal" xref="S3.SS3.p2.2.m2.1.1.5.cmml">_</mi><mo id="S3.SS3.p2.2.m2.1.1.1c" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.6" xref="S3.SS3.p2.2.m2.1.1.6.cmml">f</mi><mo id="S3.SS3.p2.2.m2.1.1.1d" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.7" xref="S3.SS3.p2.2.m2.1.1.7.cmml">r</mi><mo id="S3.SS3.p2.2.m2.1.1.1e" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.8" xref="S3.SS3.p2.2.m2.1.1.8.cmml">e</mi><mo id="S3.SS3.p2.2.m2.1.1.1f" xref="S3.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.9" xref="S3.SS3.p2.2.m2.1.1.9.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><times id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></times><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑜</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑏</ci><ci id="S3.SS3.p2.2.m2.1.1.4.cmml" xref="S3.SS3.p2.2.m2.1.1.4">𝑗</ci><ci id="S3.SS3.p2.2.m2.1.1.5.cmml" xref="S3.SS3.p2.2.m2.1.1.5">_</ci><ci id="S3.SS3.p2.2.m2.1.1.6.cmml" xref="S3.SS3.p2.2.m2.1.1.6">𝑓</ci><ci id="S3.SS3.p2.2.m2.1.1.7.cmml" xref="S3.SS3.p2.2.m2.1.1.7">𝑟</ci><ci id="S3.SS3.p2.2.m2.1.1.8.cmml" xref="S3.SS3.p2.2.m2.1.1.8">𝑒</ci><ci id="S3.SS3.p2.2.m2.1.1.9.cmml" xref="S3.SS3.p2.2.m2.1.1.9">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">obj\_freq</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q</annotation></semantics></math> which records the access frequency history of different items, and <math alttext="cache\_res" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">c</mi><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">a</mi><mo id="S3.SS3.p2.3.m3.1.1.1a" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.4" xref="S3.SS3.p2.3.m3.1.1.4.cmml">c</mi><mo id="S3.SS3.p2.3.m3.1.1.1b" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.5" xref="S3.SS3.p2.3.m3.1.1.5.cmml">h</mi><mo id="S3.SS3.p2.3.m3.1.1.1c" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.6" xref="S3.SS3.p2.3.m3.1.1.6.cmml">e</mi><mo id="S3.SS3.p2.3.m3.1.1.1d" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.7" mathvariant="normal" xref="S3.SS3.p2.3.m3.1.1.7.cmml">_</mi><mo id="S3.SS3.p2.3.m3.1.1.1e" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.8" xref="S3.SS3.p2.3.m3.1.1.8.cmml">r</mi><mo id="S3.SS3.p2.3.m3.1.1.1f" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.9" xref="S3.SS3.p2.3.m3.1.1.9.cmml">e</mi><mo id="S3.SS3.p2.3.m3.1.1.1g" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.10" xref="S3.SS3.p2.3.m3.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><times id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></times><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑎</ci><ci id="S3.SS3.p2.3.m3.1.1.4.cmml" xref="S3.SS3.p2.3.m3.1.1.4">𝑐</ci><ci id="S3.SS3.p2.3.m3.1.1.5.cmml" xref="S3.SS3.p2.3.m3.1.1.5">ℎ</ci><ci id="S3.SS3.p2.3.m3.1.1.6.cmml" xref="S3.SS3.p2.3.m3.1.1.6">𝑒</ci><ci id="S3.SS3.p2.3.m3.1.1.7.cmml" xref="S3.SS3.p2.3.m3.1.1.7">_</ci><ci id="S3.SS3.p2.3.m3.1.1.8.cmml" xref="S3.SS3.p2.3.m3.1.1.8">𝑟</ci><ci id="S3.SS3.p2.3.m3.1.1.9.cmml" xref="S3.SS3.p2.3.m3.1.1.9">𝑒</ci><ci id="S3.SS3.p2.3.m3.1.1.10.cmml" xref="S3.SS3.p2.3.m3.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">cache\_res</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_c italic_a italic_c italic_h italic_e _ italic_r italic_e italic_s</annotation></semantics></math> which is a cache list containing partial sums generated by existing caching technique <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite>. A cache list of {<math alttext="a,b,c" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.3"><semantics id="S3.SS3.p2.4.m4.3a"><mrow id="S3.SS3.p2.4.m4.3.4.2" xref="S3.SS3.p2.4.m4.3.4.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">a</mi><mo id="S3.SS3.p2.4.m4.3.4.2.1" xref="S3.SS3.p2.4.m4.3.4.1.cmml">,</mo><mi id="S3.SS3.p2.4.m4.2.2" xref="S3.SS3.p2.4.m4.2.2.cmml">b</mi><mo id="S3.SS3.p2.4.m4.3.4.2.2" xref="S3.SS3.p2.4.m4.3.4.1.cmml">,</mo><mi id="S3.SS3.p2.4.m4.3.3" xref="S3.SS3.p2.4.m4.3.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.3b"><list id="S3.SS3.p2.4.m4.3.4.1.cmml" xref="S3.SS3.p2.4.m4.3.4.2"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑎</ci><ci id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2">𝑏</ci><ci id="S3.SS3.p2.4.m4.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3">𝑐</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.3c">a,b,c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.3d">italic_a , italic_b , italic_c</annotation></semantics></math>} means that items <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_a</annotation></semantics></math>, <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_b</annotation></semantics></math> and <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_c</annotation></semantics></math> frequently co-exist in the same sample, so that partial sums <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_a</annotation></semantics></math>, <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><mi id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><ci id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">italic_b</annotation></semantics></math>, <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">italic_c</annotation></semantics></math>, <math alttext="a+b" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><mrow id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mi id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.11.m11.1.1.1" xref="S3.SS3.p2.11.m11.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><plus id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1.1"></plus><ci id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">𝑎</ci><ci id="S3.SS3.p2.11.m11.1.1.3.cmml" xref="S3.SS3.p2.11.m11.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">a+b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">italic_a + italic_b</annotation></semantics></math>, <math alttext="a+c" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m12.1"><semantics id="S3.SS3.p2.12.m12.1a"><mrow id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml"><mi id="S3.SS3.p2.12.m12.1.1.2" xref="S3.SS3.p2.12.m12.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.12.m12.1.1.1" xref="S3.SS3.p2.12.m12.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.12.m12.1.1.3" xref="S3.SS3.p2.12.m12.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><apply id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1"><plus id="S3.SS3.p2.12.m12.1.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1.1"></plus><ci id="S3.SS3.p2.12.m12.1.1.2.cmml" xref="S3.SS3.p2.12.m12.1.1.2">𝑎</ci><ci id="S3.SS3.p2.12.m12.1.1.3.cmml" xref="S3.SS3.p2.12.m12.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">a+c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m12.1d">italic_a + italic_c</annotation></semantics></math>, <math alttext="b+c" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m13.1"><semantics id="S3.SS3.p2.13.m13.1a"><mrow id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml"><mi id="S3.SS3.p2.13.m13.1.1.2" xref="S3.SS3.p2.13.m13.1.1.2.cmml">b</mi><mo id="S3.SS3.p2.13.m13.1.1.1" xref="S3.SS3.p2.13.m13.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.13.m13.1.1.3" xref="S3.SS3.p2.13.m13.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><apply id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1"><plus id="S3.SS3.p2.13.m13.1.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1.1"></plus><ci id="S3.SS3.p2.13.m13.1.1.2.cmml" xref="S3.SS3.p2.13.m13.1.1.2">𝑏</ci><ci id="S3.SS3.p2.13.m13.1.1.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">b+c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m13.1d">italic_b + italic_c</annotation></semantics></math> and <math alttext="a+b+c" class="ltx_Math" display="inline" id="S3.SS3.p2.14.m14.1"><semantics id="S3.SS3.p2.14.m14.1a"><mrow id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml"><mi id="S3.SS3.p2.14.m14.1.1.2" xref="S3.SS3.p2.14.m14.1.1.2.cmml">a</mi><mo id="S3.SS3.p2.14.m14.1.1.1" xref="S3.SS3.p2.14.m14.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.14.m14.1.1.3" xref="S3.SS3.p2.14.m14.1.1.3.cmml">b</mi><mo id="S3.SS3.p2.14.m14.1.1.1a" xref="S3.SS3.p2.14.m14.1.1.1.cmml">+</mo><mi id="S3.SS3.p2.14.m14.1.1.4" xref="S3.SS3.p2.14.m14.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><apply id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1"><plus id="S3.SS3.p2.14.m14.1.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1.1"></plus><ci id="S3.SS3.p2.14.m14.1.1.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2">𝑎</ci><ci id="S3.SS3.p2.14.m14.1.1.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3">𝑏</ci><ci id="S3.SS3.p2.14.m14.1.1.4.cmml" xref="S3.SS3.p2.14.m14.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">a+b+c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.14.m14.1d">italic_a + italic_b + italic_c</annotation></semantics></math> are cached to reduce the memory traffic. We divide each MRAM capacity into two parts: one storing embedding vectors and the other storing the cached partial sums.
Initially, we sort <math alttext="obj\_freq" class="ltx_Math" display="inline" id="S3.SS3.p2.15.m15.1"><semantics id="S3.SS3.p2.15.m15.1a"><mrow id="S3.SS3.p2.15.m15.1.1" xref="S3.SS3.p2.15.m15.1.1.cmml"><mi id="S3.SS3.p2.15.m15.1.1.2" xref="S3.SS3.p2.15.m15.1.1.2.cmml">o</mi><mo id="S3.SS3.p2.15.m15.1.1.1" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.3" xref="S3.SS3.p2.15.m15.1.1.3.cmml">b</mi><mo id="S3.SS3.p2.15.m15.1.1.1a" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.4" xref="S3.SS3.p2.15.m15.1.1.4.cmml">j</mi><mo id="S3.SS3.p2.15.m15.1.1.1b" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.5" mathvariant="normal" xref="S3.SS3.p2.15.m15.1.1.5.cmml">_</mi><mo id="S3.SS3.p2.15.m15.1.1.1c" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.6" xref="S3.SS3.p2.15.m15.1.1.6.cmml">f</mi><mo id="S3.SS3.p2.15.m15.1.1.1d" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.7" xref="S3.SS3.p2.15.m15.1.1.7.cmml">r</mi><mo id="S3.SS3.p2.15.m15.1.1.1e" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.8" xref="S3.SS3.p2.15.m15.1.1.8.cmml">e</mi><mo id="S3.SS3.p2.15.m15.1.1.1f" xref="S3.SS3.p2.15.m15.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p2.15.m15.1.1.9" xref="S3.SS3.p2.15.m15.1.1.9.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m15.1b"><apply id="S3.SS3.p2.15.m15.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1"><times id="S3.SS3.p2.15.m15.1.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1.1"></times><ci id="S3.SS3.p2.15.m15.1.1.2.cmml" xref="S3.SS3.p2.15.m15.1.1.2">𝑜</ci><ci id="S3.SS3.p2.15.m15.1.1.3.cmml" xref="S3.SS3.p2.15.m15.1.1.3">𝑏</ci><ci id="S3.SS3.p2.15.m15.1.1.4.cmml" xref="S3.SS3.p2.15.m15.1.1.4">𝑗</ci><ci id="S3.SS3.p2.15.m15.1.1.5.cmml" xref="S3.SS3.p2.15.m15.1.1.5">_</ci><ci id="S3.SS3.p2.15.m15.1.1.6.cmml" xref="S3.SS3.p2.15.m15.1.1.6">𝑓</ci><ci id="S3.SS3.p2.15.m15.1.1.7.cmml" xref="S3.SS3.p2.15.m15.1.1.7">𝑟</ci><ci id="S3.SS3.p2.15.m15.1.1.8.cmml" xref="S3.SS3.p2.15.m15.1.1.8">𝑒</ci><ci id="S3.SS3.p2.15.m15.1.1.9.cmml" xref="S3.SS3.p2.15.m15.1.1.9">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m15.1c">obj\_freq</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.15.m15.1d">italic_o italic_b italic_j _ italic_f italic_r italic_e italic_q</annotation></semantics></math> in descending order. That is, items with higher frequencies are ranked in front. To decide the partition of an item, we first look for it in the cache list (Line 4). If it exists in the list, we store the item in a partition with the minimum total frequency and has enough capacity for cache storage (Line 5-10). If the item does not exist in cache list, we store it in the EMT part of MRAM storage (Line 12-15). With this greedy algorithm, we aim to balance the combined number of memory accesses (EMT+cache) per partition.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F7" title="Figure 7 ‣ 3.3. Cache-Aware Non-Uniform Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates an example of our cache-aware partitioning algorithm. Consider a sample request to look up indices 1, 4 and 5. The system checks the cache index to determine if the indices are stored in the cache space. For example, in our scenario, indices 4 and 5 are stored in DPU0’s cache space, allowing us to read the MRAM once to obtain the partial sum 4 + 5. This helps to reduce the number of memory accesses from two to one. Index 1 is not stored in the cache space, so we retrieve its embedding vector from the EMT space. Ultimately, each DPU returns a partial sum to the CPU (e.g., 4+5 and 1). We combine and aggregate these partial sums using CPU to obtain final results.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">In the above design, one parameter is the cache capacity. The cache space and EMT space share the 64MB MRAM size. The larger share for cache space, the higher reduction can be obtained on embedding lookup time. For example, using GoodReads dataset and varying the cache capacity to 40%, 70% and 100% of the required storage size of cache list, our cache-aware non-uniform partitioning is able to reduce the embedding lookup time by 17%, 22% and 26%, respectively, compared to that of without caching. The downside of storing large cache list is that it requires larger memory capacity. By default, we set the cache capacity to 100% of the required size.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Evaluation</h2>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.3.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.4.2" style="font-size:90%;">Workload Configurations</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.1" style="width:433.6pt;height:101.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-52.0pt,12.2pt) scale(0.806509101725673,0.806509101725673) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1">Category</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Workload</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">Avg.Reduction</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.1.1.1.1">
<math alttext="\#" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.m1.1.1" mathvariant="normal" xref="S4.T1.1.1.1.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\#</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">#</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Items</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.1.2.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.1.1.2.1.1.1">Low Hot</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.2.1.2">AmazonClothes(clo) <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib16" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.2.1.3">52.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.2.1.4">2,685,059</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.3.2">
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.3.2.1">AmazonHome(home) <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib16" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.3.2.2">67.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.3.2.3">1,301,225</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.1.4.3.1" rowspan="2"><span class="ltx_text" id="S4.T1.1.1.4.3.1.1">Medium Hot</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.4.3.2">MetaFBGEMM1(meta1) <cite class="ltx_cite ltx_citemacro_citep">(met, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib2" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.4.3.3">107.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.4.3.4">5,783,210</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.5.4">
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.4.1">MetaFBGEMM2(meta2) <cite class="ltx_cite ltx_citemacro_citep">(met, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib2" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.4.2">188.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.5.4.3">5,999,981</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.1.6.5.1" rowspan="2"><span class="ltx_text" id="S4.T1.1.1.6.5.1.1">High Hot</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.6.5.2">GoodReads(read) <cite class="ltx_cite ltx_citemacro_citep">(Wan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib18" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib19" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.6.5.3">245.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.6.5.4">2,360,650</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.1.1.7.6.1">GoodReads2(read2) <cite class="ltx_cite ltx_citemacro_citep">(Wan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib18" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib19" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.1.1.7.6.2">374.08</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.1.1.7.6.3">2,360,650</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Setup</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Workloads.</span> We adopt Meta’s deep learning recommendation model (DLRM) <cite class="ltx_cite ltx_citemacro_citep">(Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib14" title="">2019</a>)</cite> with six real-world datasets<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2" title="">https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2</a>
<br class="ltx_break"/><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://mengtingwan.github.io/data/goodreads.html" title="">https://mengtingwan.github.io/data/goodreads.html</a></span></span></span>, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.T1" title="Table 1 ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>. The datasets can be categorized into three groups, namely low hot, medium hot and high hot, according to the average reduction frequency of the dataset. In our experiments, we duplicate each dataset to form eight EMTs and each embedding vector has 32 dimensions. To measure inference performance, we conduct a sampling of 12,800 inferences in each set of experiments. The batch size is set to 64.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Comparisons.</span> We compare UpDLRM with three other open-source DLRM implementations, as detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.T2" title="Table 2 ‣ 4.1. Experimental Setup ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">2</span></a>.
DLRM-CPU is the CPU-only implementation that adopts CPU for both EMT storage and parallel computations. DLRM-Hybrid and FAE <cite class="ltx_cite ltx_citemacro_citep">(Adnan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib5" title="">2021</a>)</cite> are two implementations based on the CPU-GPU hybrid architecture. In the hybrid architecture, CPU is used to store EMTs and perform embedding lookups, while the GPU manages CTR computation. Embedding lookup results are communicated to the GPU via PCI-e. The FAE approach differs from DLRM-Hybrid in that it involves placing a subset of highly accessed item embedding vectors in a cache space, such as the GPU memory, to accelerate DLRM inference time.
Our UpDLRM implementation is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F4" title="Figure 4 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>, where cache-aware EMT partitioning is used in the pre-process stage. We adopt two UPMEM modules, totalling 256 DPUs. Each DPU employs 14 tasklets.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.3.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.4.2" style="font-size:90%;">Specifics of evaluated hardware architectures</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T2.1" style="width:433.6pt;height:81.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-70.9pt,13.3pt) scale(0.753669727203772,0.753669727203772) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.1.1.1">Implementation</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.1.2.1">Architecture</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.1.3.1">CPU core</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.1.4.1">Memory</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3.2.1">DLRM-CPU <cite class="ltx_cite ltx_citemacro_citep">(Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib14" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3.2.2">Intel Xeon(R) Silver 4110(2.10GHz)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3.2.3">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.2.4">128GB</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.4.3.1">DLRM-Hybrid <cite class="ltx_cite ltx_citemacro_citep">(Adnan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib5" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.4.3.2">Intel Xeon(R) Silver 4110(2.10GHz)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.4.3.3">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4.3.4">128GB</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.5.4.1">FAE <cite class="ltx_cite ltx_citemacro_citep">(Adnan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib5" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.5.4.2">NVIDIA GeForce GTX 1080 Ti</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.5.4.3">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.4.4">11GB</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T2.1.1.6.5.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.6.5.1.1">UpDLRM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.6.5.2">Intel Xeon(R) Silver 4110(2.10GHz)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.6.5.3">32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6.5.4">128GB</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.1.1.1.1">UPMEM DPU(350MHz) <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><times id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">×</annotation></semantics></math> 256</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.1.1.1.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.1.1.1.3">16GB</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="192" id="S4.F8.g1" src="x8.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F8.2.1.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text" id="S4.F8.3.2" style="font-size:90%;">Inference performance speedup of compared approaches over that of DLRM-CPU</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="233" id="S4.F9.g1" src="x9.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F9.2.1.1" style="font-size:90%;">Figure 9</span>. </span><span class="ltx_text" id="S4.F9.3.2" style="font-size:90%;">Performance speedup of embedding layers obtained by three partitioning methods over DLRM-CPU</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Effectiveness of UpDLRM</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F8" title="Figure 8 ‣ 4.1. Experimental Setup ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">8</span></a> illustrates the performance of the compared implementations on the six datasets, in terms of inference time speedup compared to that of DLRM-CPU.
Overall, UpDLRM obtains the best speedup performance among all comparisons for all datasets. Specifically, UpDLRM accelerate the inference time by 1.9x-3.2x, 2.2x-4.6x and 1.1x-2.3x compared to DLRM-CPU, DLRM-Hybrid and FAE, respectively. Especially, it obtains higher speedup when the average reduction of the dataset is high. A larger average reduction represents a higher number of embedding lookup operations in a dataset. Thus, the results demonstrate that our DPU-based architecture is effective on improving the performance of embedding layers.
Unsurprisingly, FAE outperforms DLRM-CPU and DLRM-Hybrid, demonstrating the effectiveness of its caching technique.
DLRM-Hybrid performs the worst among all, mainly due to the fact that significant time is required by the CPU to execute embedding lookups, leading to GPUs waiting for the embedding results before proceeding with CTR computation.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.6">To learn the improvements obtained by UpDLRM in details, we further perform comparative evaluation of the three proposed EMT partitioning methods, namely uniform (U), non-uniform (NU) and cache-aware (CA), using the six datasets. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F9" title="Figure 9 ‣ 4.1. Experimental Setup ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">9</span></a> illustrates the performance speedup of the embedding layer obtained by the three methods compared to DLRM-CPU. The number of columns per partition (i.e., <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑁</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>) is fixed to 2, 4 or 8 for different partitioning methods.
We have the following observations: 1) Under the same <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">N</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑁</ci><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> value, CA partitioning obtains larger speedup compared to U and NU for High Hot datasets. This explains the good performance of UpDLRM under High Hot in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F8" title="Figure 8 ‣ 4.1. Experimental Setup ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">8</span></a>.
2) The three partitioning methods perform almost the same for the “clo” dataset. This is because the item access pattern in this dataset is quite balanced, and the cache rate is low.
3) There’s no universally good choice of <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">N</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑁</ci><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> for different datasets. For example, <math alttext="N_{c}=4" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><msub id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2.2" xref="S4.SS2.p2.4.m4.1.1.2.2.cmml">N</mi><mi id="S4.SS2.p2.4.m4.1.1.2.3" xref="S4.SS2.p2.4.m4.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><eq id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></eq><apply id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2.2">𝑁</ci><ci id="S4.SS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.2.3">𝑐</ci></apply><cn id="S4.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p2.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">N_{c}=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 4</annotation></semantics></math> works the best for the first three datasets while <math alttext="N_{c}=8" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><msub id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">N</mi><mi id="S4.SS2.p2.5.m5.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><eq id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></eq><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">𝑁</ci><ci id="S4.SS2.p2.5.m5.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.1.1.2.3">𝑐</ci></apply><cn id="S4.SS2.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">N_{c}=8</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 8</annotation></semantics></math> is optimal for the latter three. Recall that a large <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">N</mi><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝑁</ci><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> value leads to higher DPU-CPU communication time but lower embedding lookup time and CPU-DPU communication time, as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS1" title="3.1. Embedding Table Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3.1</span></a>. UpDLRM can automatically achieve good balance between the two for different datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Latency breakdown</h3>
<figure class="ltx_figure" id="S4.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F11.3" style="width:95.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="718" id="S4.F11.1.g1" src="x10.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F11.3.3.2.1" style="font-size:90%;">Figure 10</span>. </span><span class="ltx_text" id="S4.F11.3.2.1" style="font-size:90%;">Latency breakdown of embedding layers with three partitioning methods using Goodreads. <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.F11.3.2.1.m1.1"><semantics id="S4.F11.3.2.1.m1.1b"><msub id="S4.F11.3.2.1.m1.1.1" xref="S4.F11.3.2.1.m1.1.1.cmml"><mi id="S4.F11.3.2.1.m1.1.1.2" xref="S4.F11.3.2.1.m1.1.1.2.cmml">N</mi><mi id="S4.F11.3.2.1.m1.1.1.3" xref="S4.F11.3.2.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F11.3.2.1.m1.1c"><apply id="S4.F11.3.2.1.m1.1.1.cmml" xref="S4.F11.3.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F11.3.2.1.m1.1.1.1.cmml" xref="S4.F11.3.2.1.m1.1.1">subscript</csymbol><ci id="S4.F11.3.2.1.m1.1.1.2.cmml" xref="S4.F11.3.2.1.m1.1.1.2">𝑁</ci><ci id="S4.F11.3.2.1.m1.1.1.3.cmml" xref="S4.F11.3.2.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F11.3.2.1.m1.1d">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.F11.3.2.1.m1.1e">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is fixed at 2, 4 or 8.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F11.4" style="width:95.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="598" id="S4.F11.4.g1" src="x11.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F11.4.1.1.1" style="font-size:90%;">Figure 11</span>. </span><span class="ltx_text" id="S4.F11.4.2.2" style="font-size:90%;">The DPU lookup time under varying average reduction frequencies and lookup data sizes (8B to 128B).</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To study the performance of each component of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.F4" title="Figure 4 ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>, we further breakdown the latency of UpDLRM into three parts, namely CPU-DPU communication time (stage 1), DPU lookup time (stage 2) and DPU-CPU communication time (stage 3).
Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F11" title="Figure 11 ‣ 4.3. Latency breakdown ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">11</span></a> shows the breakdown results when using uniform (U), non-uniform (NU) and cache-aware (CA) partitioning in pre-process stage of UpDLRM. <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑁</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is fixed at 2, 4 and 8. We have the following observations.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">First, comparing different partitioning methods, CA reduces the ratio of DPU lookup time in the embedding time from 71%-77% to 43%-52%, compared to the other partitioning methods. This means that the partial sum caching together with the cache-aware partitioning are effective on reducing the embedding lookup time in UpDLRM. With the ratio of embedding lookup time decreases to below 50%, it means the bottleneck effect of the embedding operations has been greatly mitigated.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.3">Second, comparing the same partitioning method under different <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑁</ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> values, the CPU-DPU communication time increases and DPU-CPU communication time decreases with the increase of <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">N</mi><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑁</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. For example, for CA, the CPU-DPU time ration reduces from 31%-21% and DPU-CPU time ratio increases from 17%-35% when <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><msub id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">N</mi><mi id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑁</ci><ci id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> increases from 2 to 8. This is consistent with our analysis of UpDLRM performance in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S3.SS1" title="3.1. Embedding Table Partitioning ‣ 3. Design Details ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3.1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Sensitivity Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F8" title="Figure 8 ‣ 4.1. Experimental Setup ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">8</span></a>, we have observed better performance of UpDLRM for datasets with higher average reduction.
To better study the potential of UpDLRM, we create a set of synthetic datasets with balanced item access patterns and varying average reduction frequencies ranging from 50 to 300. We vary <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝑁</ci><ci id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> from 2, 4, …, to 32, thus resulting in varying data sizes of 8B, 16B, …, to 128B. These sizes correspond to the amount of data loaded from MRAM per lookup. We set batch size to 64 samples.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S4.F11" title="Figure 11 ‣ 4.3. Latency breakdown ‣ 4. Evaluation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">11</span></a> shows the DPU lookup time results under different configurations.
We have the following observations.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">First, under the same lookup data size, the DPU lookup time increases almost linearly with the increase of average reduction frequency. For example, when the lookup data size is 8B, the DPU lookup time increases from 406us to 1786us. When the data size gets larger, the increase of DPU lookup time with the increase of average reduction becomes rather stable. For example, when the lookup data size is 64B, the DPU lookup time increases from 456us to 787us when the average reduction increases from 50 to 200, and remains almost unchanged when the average reduction continues to increase to 300. This is because we employ 14 tasklets in one DPU, and the pipeline in high hot scenarios effectively masks the MRAM read latency, resulting in a comparable latency. The results demonstrate that, the embedding lookup performance of UpDLRM is quite scalable with the increase of average reduction frequency.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">Second, given a fixed average reduction frequency, the DPU lookup time greatly reduces when the lookup data size increases from 8B to 32B. Recall our previous observation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#S2.F3" title="Figure 3 ‣ 2.3. Motivation ‣ 2. Background and Motivation ‣ UpDLRM: Accelerating Personalized Recommendation using Real-World PIM Architecture"><span class="ltx_text ltx_ref_tag">3</span></a>, the MRAM access latency remains almost unchanged when the access data size varies between 8B and 32B. With larger per lookup data size, less number of lookup operations is needed and thus lower lookup time can be obtained. When the access data size increases to larger than 32B, the per lookup latency also increases, thus hinders the reduction of DPU lookup time.
Thus, in previous experiments, we only set <math alttext="N_{c}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><msub id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝑁</ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">N_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> to 2, 4 and 8 to study the performance of UpDLRM.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">PIMPR <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib20" title="">2023</a>)</cite> utilizes ReRAM crossbar, using NOR gates within the ReRAM arrays to maintain the Computing-In-Memory capability, to enhance DLRM acceleration. However, its hardware structure differs from UPMEM PIM, the first commercial processing-in-memory chip. RecNMP <cite class="ltx_cite ltx_citemacro_citep">(Ke et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib11" title="">2020</a>)</cite> implements near-memory processing of the embedding vector around specialized DIMMs to expand the accelerator’s memory space to tens of GBs. These studies are orthogonal to ours due to the different hardware architectures.
EVStore <cite class="ltx_cite ltx_citemacro_citep">(Kurniawan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib13" title="">2023</a>)</cite> implements a three-degree cache method to store popular items. It utilizes mixed precision datatype to cache a larger number of embedding vectors and leverages the similarity between embedding vectors to further enhance the cache hit rate. In addition, GRACE <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib21" title="">2023</a>)</cite> and SPACE <cite class="ltx_cite ltx_citemacro_citep">(Kal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13941v2#bib.bib10" title="">2021</a>)</cite> leverage hot items to reduce memory access, caching the hot embedding vector and partial sum in a cache space. However, they do not consider scenarios involving allocating the hot embedding vector in multiple cache spaces, such as caching in multiple DPUs, potentially leading to workload imbalance. UpDLRM introduces a cache allocation method across multiple cache spaces and addresses the workload imbalance issue arising after caching. Note that, although we adopt GRACE to generate cache list in this paper, UpDLRM does not rely on GRACE and can work with any other caching technique.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This paper proposes <em class="ltx_emph ltx_font_italic" id="S6.p1.1.1">UpDLRM</em>, which utilizes real-world processing-in-memory (PIM) hardware, UPMEM DPU, to boost the memory bandwidth and reduce recommendation latency. The parallel nature of the DPU memory can provide high aggregated bandwidth for the large number of irregular memory accesses in embedding lookups, thus offering great potential to reduce the inference latency of DLRMs. To fully utilize the DPU memory bandwidth, we further studied the embedding table partitioning problem to achieve good workload-balance and efficient data caching.
Evaluations using real-world datasets show that, UpDLRM achieves up to 4.6x speedup in terms of inference performance compared to both CPU-only and CPU-GPU hybrid counterparts. In the future, we plan to work on designing a DPU-GPU heterogeneous system to further optimize the inference time of DLRM systems.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work is supported by National Natural Science Foundation of China (62172282, 62293510, 62293513, 62272252, 62272253), Guangdong Natural Science Foundation 2022A1515010122, Shenzhen Science and Technology Foundation RCYX20221008092908029, and a startup grant of HKBU.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">met (2022)</span>
<span class="ltx_bibblock">
2022.

</span>
<span class="ltx_bibblock">Meta Research. Embedding Lookup Synthetic Dataset.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/dlrm_datasets" title="">https://github.com/facebookresearch/dlrm_datasets</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">upm (2023a)</span>
<span class="ltx_bibblock">
2023a.

</span>
<span class="ltx_bibblock">Introducing the most advanced Processing In Memory product.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.upmem.com/" title="">https://www.upmem.com/</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">upm (2023b)</span>
<span class="ltx_bibblock">
2023b.

</span>
<span class="ltx_bibblock">UPMEM User Manual.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://sdk.upmem.com/2023.1.0/index.html" title="">https://sdk.upmem.com/2023.1.0/index.html</a>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Adnan et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Muhammad Adnan et al<span class="ltx_text" id="bib.bib5.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">Accelerating recommendation system training by leveraging popular choices.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.4.1">arXiv preprint arXiv:2103.00686</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington et al<span class="ltx_text" id="bib.bib6.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.4.1">RecSys’16</em>. 191–198.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devaux (2019)</span>
<span class="ltx_bibblock">
Fabrice Devaux. 2019.

</span>
<span class="ltx_bibblock">The true processing in memory accelerator. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">HCS’19</em>. IEEE Computer Society, 1–24.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Udit Gupta et al<span class="ltx_text" id="bib.bib8.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">The architectural implications of facebook’s dnn-based personalized recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.1">HPCA’20</em>. IEEE, 488–501.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jain et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Rishabh Jain et al<span class="ltx_text" id="bib.bib9.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Optimizing CPU Performance for Recommendation Systems At-Scale. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.4.1">ISCA’23</em>. Article 77, 15 pages.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kal et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Hongju Kal et al<span class="ltx_text" id="bib.bib10.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">Space: locality-aware processing in heterogeneous memory for personalized recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.4.1">ISCA’21</em>. IEEE, 679–691.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Liu Ke et al<span class="ltx_text" id="bib.bib11.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Recnmp: Accelerating personalized recommendation with near-memory processing. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.4.1">ISCA’20</em>. IEEE, 790–803.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Heewoo Kim et al<span class="ltx_text" id="bib.bib12.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">RecPIM: A PIM-Enabled DRAM-RRAM Hybrid Memory System For Recommendation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.4.1">ISLPED’23</em>. 1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kurniawan et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Daniar H Kurniawan et al<span class="ltx_text" id="bib.bib13.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">EVStore: Storage and Caching Capabilities for Scaling Embedding Tables in Deep Recommendation Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.1">Proceedings of the 28th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 2</em>. 281–294.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naumov et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Maxim Naumov et al<span class="ltx_text" id="bib.bib14.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Deep learning recommendation model for personalization and recommendation systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.4.1">arXiv preprint arXiv:1906.00091</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naumov et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Maxim Naumov et al<span class="ltx_text" id="bib.bib15.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Deep learning training in facebook data centers: Design of scale-up and scale-out systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.4.1">arXiv preprint arXiv:2003.09518</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jianmo Ni et al<span class="ltx_text" id="bib.bib16.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Justifying recommendations using distantly-labeled reviews and fine-grained aspects. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.1">EMNLP-IJCNLP’19</em>. 188–197.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rappaz et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jérémie Rappaz et al<span class="ltx_text" id="bib.bib17.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">Recommendation on live-streaming platforms: Dynamic availability and repeat consumption. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.4.1">RecSys’21</em>. 390–399.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Mengting Wan et al<span class="ltx_text" id="bib.bib18.3.1">.</span> 2018.

</span>
<span class="ltx_bibblock">Item recommendation on monotonic behavior chains. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.1">RecSys’18</em>. 86–94.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Mengting Wan et al<span class="ltx_text" id="bib.bib19.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Fine-grained spoiler detection from large-scale review corpora.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.4.1">arXiv preprint arXiv:1905.13416</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Tao Yang et al<span class="ltx_text" id="bib.bib20.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">PIMPR: PIM-based Personalized Recommendation with Heterogeneous Memory Hierarchy. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.1">DATE’23</em>. 1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Haojie Ye et al<span class="ltx_text" id="bib.bib21.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">GRACE: A Scalable Graph-Based Approach to Accelerating Recommendation Model Inference. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.4.1">ASPLOS’23</em>. 282–301.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  9 04:10:37 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
