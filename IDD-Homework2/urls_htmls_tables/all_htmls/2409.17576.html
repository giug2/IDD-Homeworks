<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>"ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition</title>
<!--Generated on Thu Sep 26 06:43:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.17576v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S1" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S2" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS1" title='In 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Diffusion Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS2" title='In 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><math alttext="\text{ID}^{3}" class="ltx_Math" display="inline"><semantics><msup><mtext>ID</mtext><mn>3</mn></msup><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">superscript</csymbol><ci><mtext>ID</mtext></ci><cn type="integer">3</cn></apply></annotation-xml><annotation encoding="application/x-tex">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> as Conditional Diffusion Models</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS2.SSS1" title='In 3.2 "ID"³ as Conditional Diffusion Models ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Identity Conditioning Signal</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS2.SSS2" title='In 3.2 "ID"³ as Conditional Diffusion Models ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Face Attribute Conditioning Signal</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS3" title='In 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Optimization Objective</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS4" title='In 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>ID-Preserving Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.SS5" title='In 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Synthetic Dataset Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS1" title='In 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS1.SSS0.Px1" title='In 4.1 Dataset ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title">Training Dataset:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS2" title='In 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS3" title='In 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Performance Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS3.SSS1" title='In 4.3 Performance Evaluation ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Qualitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS3.SSS2" title='In 4.3 Performance Evaluation ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Quantitative Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.SS3.SSS2.Px1" title='In 4.3.2 Quantitative Results ‣ 4.3 Performance Evaluation ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title">Ablation study.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S5" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A1" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix A</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A2" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Appendix B</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A3" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>An Illustration of the Dataset Generating Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A4" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A4.SS0.SSS0.Px1" title='In Appendix D Related Work ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title">Face Recognition.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A5" title='In "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Ablation Study (ii)</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<br class="ltx_break"/>
</div>
<h1 class="ltx_title ltx_title_document">
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="id1.m1.1"><semantics id="id1.m1.1b"><msup id="id1.m1.1.1" xref="id1.m1.1.1.cmml"><mtext id="id1.m1.1.1.2" xref="id1.m1.1.1.2a.cmml">ID</mtext><mn id="id1.m1.1.1.3" xref="id1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id1.m1.1c"><apply id="id1.m1.1.1.cmml" xref="id1.m1.1.1"><csymbol cd="ambiguous" id="id1.m1.1.1.1.cmml" xref="id1.m1.1.1">superscript</csymbol><ci id="id1.m1.1.1.2a.cmml" xref="id1.m1.1.1.2"><mtext id="id1.m1.1.1.2.cmml" xref="id1.m1.1.1.2">ID</mtext></ci><cn id="id1.m1.1.1.3.cmml" type="integer" xref="id1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.m1.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="id1.m1.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shen Li<sup class="ltx_sup" id="id7.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  Jianqing Xu<sup class="ltx_sup" id="id8.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Tencent Youtu Lab
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break"/>Jiaying Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Miao Xiong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ailin Deng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiazhen Ji
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Tencent Youtu Lab
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break"/>Yuge Huang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Tencent Youtu Lab
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenjie Feng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shouhong Ding
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Tencent Youtu Lab
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bryan Hooi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National University of Singapore
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.3">Synthetic face recognition (SFR) aims to generate synthetic face datasets that mimic the distribution of real face data, which allows for training face recognition models in a privacy-preserving manner. Despite the remarkable potential of diffusion models in image generation, current diffusion-based SFR models struggle with generalization to real-world faces. To address this limitation, we outline three key objectives for SFR: (1) promoting diversity across identities (inter-class diversity), (2) ensuring diversity within each identity by injecting various facial attributes (intra-class diversity), and (3) maintaining identity consistency within each identity group (intra-class identity preservation). Inspired by these goals, we introduce a diffusion-fueled SFR model termed <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="id4.1.m1.1"><semantics id="id4.1.m1.1a"><msup id="id4.1.m1.1.1" xref="id4.1.m1.1.1.cmml"><mtext id="id4.1.m1.1.1.2" xref="id4.1.m1.1.1.2a.cmml">ID</mtext><mn id="id4.1.m1.1.1.3" xref="id4.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id4.1.m1.1b"><apply id="id4.1.m1.1.1.cmml" xref="id4.1.m1.1.1"><csymbol cd="ambiguous" id="id4.1.m1.1.1.1.cmml" xref="id4.1.m1.1.1">superscript</csymbol><ci id="id4.1.m1.1.1.2a.cmml" xref="id4.1.m1.1.1.2"><mtext id="id4.1.m1.1.1.2.cmml" xref="id4.1.m1.1.1.2">ID</mtext></ci><cn id="id4.1.m1.1.1.3.cmml" type="integer" xref="id4.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="id4.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="id5.2.m2.1"><semantics id="id5.2.m2.1a"><msup id="id5.2.m2.1.1" xref="id5.2.m2.1.1.cmml"><mtext id="id5.2.m2.1.1.2" xref="id5.2.m2.1.1.2a.cmml">ID</mtext><mn id="id5.2.m2.1.1.3" xref="id5.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id5.2.m2.1b"><apply id="id5.2.m2.1.1.cmml" xref="id5.2.m2.1.1"><csymbol cd="ambiguous" id="id5.2.m2.1.1.1.cmml" xref="id5.2.m2.1.1">superscript</csymbol><ci id="id5.2.m2.1.1.2a.cmml" xref="id5.2.m2.1.1.2"><mtext id="id5.2.m2.1.1.2.cmml" xref="id5.2.m2.1.1.2">ID</mtext></ci><cn id="id5.2.m2.1.1.3.cmml" type="integer" xref="id5.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="id5.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> employs an ID-preserving loss to generate diverse yet identity-consistent facial appearances. Theoretically, we show that minimizing this loss is equivalent to maximizing the lower bound of an adjusted conditional log-likelihood over ID-preserving data. This equivalence motivates an ID-preserving sampling algorithm, which operates over an adjusted gradient vector field, enabling the generation of fake face recognition datasets that approximate the distribution of real-world faces. Extensive experiments across five challenging benchmarks validate the advantages of <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="id6.3.m3.1"><semantics id="id6.3.m3.1a"><msup id="id6.3.m3.1.1" xref="id6.3.m3.1.1.cmml"><mtext id="id6.3.m3.1.1.2" xref="id6.3.m3.1.1.2a.cmml">ID</mtext><mn id="id6.3.m3.1.1.3" xref="id6.3.m3.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id6.3.m3.1b"><apply id="id6.3.m3.1.1.cmml" xref="id6.3.m3.1.1"><csymbol cd="ambiguous" id="id6.3.m3.1.1.1.cmml" xref="id6.3.m3.1.1">superscript</csymbol><ci id="id6.3.m3.1.1.2a.cmml" xref="id6.3.m3.1.1.2"><mtext id="id6.3.m3.1.1.2.cmml" xref="id6.3.m3.1.1.2">ID</mtext></ci><cn id="id6.3.m3.1.1.3.cmml" type="integer" xref="id6.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.3.m3.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="id6.3.m3.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>Equal first authors. The order was determined by <span class="ltx_text ltx_font_typewriter" id="footnotex1.1">numpy.random.rand()</span>.</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the introduction of various regulations restricting the use of large-scale facial data in recent years,
such as GDPR,
synthetic-based face recognition (SFR) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite> has received widespread attention from the academic community <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Qiu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>; <span class="ltx_text" style="font-size:90%;">Wood et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>; <span class="ltx_text" style="font-size:90%;">Wang et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>. The goal of SFR is to generate synthetic face datasets that mimic the distribution of real face images, and use it to train a face recognition (FR) model such that the model can recognize real face images as effectively as possible.
</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">There exist numerous efforts to address SFR, which can be categorized into <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">GAN</span>-based models and <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">diffusion</span> models. GAN-based models utilize adversarial training to learn to generate synthetic data for FR training. Recently, with the empirical advantages of diffusion models over GANs, many works have attempted to use diffusion models to generate synthetic face data in place of authentic data. However, the reported results by these state-of-the-art (SoTA) SFR generative models <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Bae et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>; <span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>; <span class="ltx_text" style="font-size:90%;">Kolf et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>; <span class="ltx_text" style="font-size:90%;">Qiu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>; <span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite> show significant degradation in the verification accuracy in comparison to FR models trained by authentic data.
We deduce the degradation might be due to two reasons. First, while previous works adopt diffusion models, they operate in the original score vector field without injecting the direction with regards to identity information, which makes them unable to guarantee identity-preserving sampling. Second, they fail to consider the structure of face manifold in terms of diversity during sampling.
</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We thus argue that the crux of SFR is to automatically generate a training dataset that has the following characteristics:
(i) <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S1.p3.1.1">inter-class diversity</em>: the training dataset covers sufficiently many distinct identities; (ii) <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S1.p3.1.2">intra-class diversity</em>: each identity has diverse face samples with various facial attributes such as poses, ages, etc; (iii) <em class="ltx_emph ltx_font_bold ltx_font_italic" id="S1.p3.1.3">intra-class identity preservation</em>: samples within each class should be identity-consistent.
Also note that, critically, the SFR dataset generation process should be fully automated without manual filtering or introducing auxiliary real face samples.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.5">To this end, in this paper, we propose a novel <span class="ltx_text ltx_font_bold" id="S1.p4.5.1">ID</span>entity-preserving-yet-<span class="ltx_text ltx_font_bold" id="S1.p4.5.2">D</span>iversified <span class="ltx_text ltx_font_bold" id="S1.p4.5.3">D</span>iffusion generative model termed <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><msup id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mtext id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2a.cmml">ID</mtext><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">superscript</csymbol><ci id="S1.p4.1.m1.1.1.2a.cmml" xref="S1.p4.1.m1.1.1.2"><mtext id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">ID</mtext></ci><cn id="S1.p4.1.m1.1.1.3.cmml" type="integer" xref="S1.p4.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and a sampling algorithm for inference.
Jointly leveraging identity and face attributes as conditioning signals,
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><msup id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mtext id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2a.cmml">ID</mtext><mn id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">superscript</csymbol><ci id="S1.p4.2.m2.1.1.2a.cmml" xref="S1.p4.2.m2.1.1.2"><mtext id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">ID</mtext></ci><cn id="S1.p4.2.m2.1.1.3.cmml" type="integer" xref="S1.p4.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> can synthesize diversified face images that conform to desired attributes while preserving intra-class identity.
Specifically, <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><msup id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mtext id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2a.cmml">ID</mtext><mn id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.3.m3.1.1.1.cmml" xref="S1.p4.3.m3.1.1">superscript</csymbol><ci id="S1.p4.3.m3.1.1.2a.cmml" xref="S1.p4.3.m3.1.1.2"><mtext id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2">ID</mtext></ci><cn id="S1.p4.3.m3.1.1.3.cmml" type="integer" xref="S1.p4.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> generates a new sample based upon two conditioning signals: a target face embedding and a specific set of face attributes. The target face embedding enforces identity preservation while face attributes enrich intra-class diversity.
To optimize <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><msup id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><mtext id="S1.p4.4.m4.1.1.2" xref="S1.p4.4.m4.1.1.2a.cmml">ID</mtext><mn id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1">superscript</csymbol><ci id="S1.p4.4.m4.1.1.2a.cmml" xref="S1.p4.4.m4.1.1.2"><mtext id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1.2">ID</mtext></ci><cn id="S1.p4.4.m4.1.1.3.cmml" type="integer" xref="S1.p4.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, we propose a new loss function that involves an explicit term to preserve identity. Theoretically, we show that with the addition of this term, minimizing the proposed loss function is equivalent to maximizing the lower bound of the likelihood of an adjusted conditional data log-likelihood.
Consequently, this theoretical analysis motivates a new ID-preserving sampling algorithm that generates desired synthetic face images.
To generate an SFR dataset, we further propose a new dataset-generating algorithm.
This algorithm ensures inter-class diversity by solving the Tammes problem <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Tammes</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">1930</span></a>)</cite>, which maximally separates identity embeddings on the face manifold. In the meantime, it encourages intra-class diversity by perturbing identity embeddings randomly within prescribed areas. It works in conjunction with identity embeddings and diverse attributes to ensure inter-/intra-class diversity while preserving identity.
Extensive experiments show that <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><msup id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><mtext id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2a.cmml">ID</mtext><mn id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1">superscript</csymbol><ci id="S1.p4.5.m5.1.1.2a.cmml" xref="S1.p4.5.m5.1.1.2"><mtext id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2">ID</mtext></ci><cn id="S1.p4.5.m5.1.1.3.cmml" type="integer" xref="S1.p4.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> outperforms other existing methods in multiple challenging benchmarks.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To sum up, our major contributions are listed as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.2.1">Model with Theoretical Guarantees</span>:
We propose <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><msup id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mtext id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">superscript</csymbol><ci id="S1.I1.i1.p1.1.m1.1.1.2a.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2"><mtext id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2">ID</mtext></ci><cn id="S1.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, an identity-preserving-yet-diversified diffusion model for SFR.
Theoretically, optimizing <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><msup id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml"><mtext id="S1.I1.i1.p1.2.m2.1.1.2" xref="S1.I1.i1.p1.2.m2.1.1.2a.cmml">ID</mtext><mn id="S1.I1.i1.p1.2.m2.1.1.3" xref="S1.I1.i1.p1.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><apply id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.2.m2.1.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">superscript</csymbol><ci id="S1.I1.i1.p1.2.m2.1.1.2a.cmml" xref="S1.I1.i1.p1.2.m2.1.1.2"><mtext id="S1.I1.i1.p1.2.m2.1.1.2.cmml" xref="S1.I1.i1.p1.2.m2.1.1.2">ID</mtext></ci><cn id="S1.I1.i1.p1.2.m2.1.1.3.cmml" type="integer" xref="S1.I1.i1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> is equivalent to shifting the original data likelihood to cover ID-preserving data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Algorithm Design</span>: Motivated by this theoretical equivalence, we design a novel sampling algorithm for face image generation, together with a face dataset-generating algorithm, which effectively generates fake face datasets that approximate real-world faces.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.2.1">Effectiveness</span>: Compared with SoTA SFR approaches, <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><msup id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mtext id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S1.I1.i3.p1.1.m1.1.1.3" xref="S1.I1.i3.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1">superscript</csymbol><ci id="S1.I1.i3.p1.1.m1.1.1.2a.cmml" xref="S1.I1.i3.p1.1.m1.1.1.2"><mtext id="S1.I1.i3.p1.1.m1.1.1.2.cmml" xref="S1.I1.i3.p1.1.m1.1.1.2">ID</mtext></ci><cn id="S1.I1.i3.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> improves SFR performance by <math alttext="\sim 2.4\%" class="ltx_Math" display="inline" id="S1.I1.i3.p1.2.m2.1"><semantics id="S1.I1.i3.p1.2.m2.1a"><mrow id="S1.I1.i3.p1.2.m2.1.1" xref="S1.I1.i3.p1.2.m2.1.1.cmml"><mi id="S1.I1.i3.p1.2.m2.1.1.2" xref="S1.I1.i3.p1.2.m2.1.1.2.cmml"></mi><mo id="S1.I1.i3.p1.2.m2.1.1.1" xref="S1.I1.i3.p1.2.m2.1.1.1.cmml">∼</mo><mrow id="S1.I1.i3.p1.2.m2.1.1.3" xref="S1.I1.i3.p1.2.m2.1.1.3.cmml"><mn id="S1.I1.i3.p1.2.m2.1.1.3.2" xref="S1.I1.i3.p1.2.m2.1.1.3.2.cmml">2.4</mn><mo id="S1.I1.i3.p1.2.m2.1.1.3.1" xref="S1.I1.i3.p1.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.2.m2.1b"><apply id="S1.I1.i3.p1.2.m2.1.1.cmml" xref="S1.I1.i3.p1.2.m2.1.1"><csymbol cd="latexml" id="S1.I1.i3.p1.2.m2.1.1.1.cmml" xref="S1.I1.i3.p1.2.m2.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S1.I1.i3.p1.2.m2.1.1.2.cmml" xref="S1.I1.i3.p1.2.m2.1.1.2">absent</csymbol><apply id="S1.I1.i3.p1.2.m2.1.1.3.cmml" xref="S1.I1.i3.p1.2.m2.1.1.3"><csymbol cd="latexml" id="S1.I1.i3.p1.2.m2.1.1.3.1.cmml" xref="S1.I1.i3.p1.2.m2.1.1.3.1">percent</csymbol><cn id="S1.I1.i3.p1.2.m2.1.1.3.2.cmml" type="float" xref="S1.I1.i3.p1.2.m2.1.1.3.2">2.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.2.m2.1c">\sim 2.4\%</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.2.m2.1d">∼ 2.4 %</annotation></semantics></math> on average across five challenging benchmarks.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem Formulation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The scope of this paper is synthetic-based face recognition (SFR), which focuses on generating high-quality training data (i.e., face images) for FR models.
Generally, we aim to address SFR by generating face images that conform to diverse facial attributes while preserving identity within each class, in a fully automated manner.
Technically, we break down this objective into the following two research questions (RQs) to be answered:</p>
</div>
<div class="ltx_para" id="S2.p2">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">RQ1</span>: How can we effectively train a SFR generative model that preserves identity within each class, while boosting inter-class and intra-class diversity?</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">RQ2</span>: Once the generative model is trained, what sampling strategy can be employed to generate a synthetic face dataset that enables state-of-the-art face recognition models to perform well on real face benchmarks?</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S2.p2.1">The rest of the paper aims to answer these two questions, respectively, in order to improve synthetic face recognition performance.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text" id="S2.F1.6.3" style="font-size:90%;">The forward pass of <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S2.F1.4.1.m1.1"><semantics id="S2.F1.4.1.m1.1b"><msup id="S2.F1.4.1.m1.1.1" xref="S2.F1.4.1.m1.1.1.cmml"><mtext id="S2.F1.4.1.m1.1.1.2" xref="S2.F1.4.1.m1.1.1.2a.cmml">ID</mtext><mn id="S2.F1.4.1.m1.1.1.3" xref="S2.F1.4.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S2.F1.4.1.m1.1c"><apply id="S2.F1.4.1.m1.1.1.cmml" xref="S2.F1.4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.4.1.m1.1.1.1.cmml" xref="S2.F1.4.1.m1.1.1">superscript</csymbol><ci id="S2.F1.4.1.m1.1.1.2a.cmml" xref="S2.F1.4.1.m1.1.1.2"><mtext id="S2.F1.4.1.m1.1.1.2.cmml" xref="S2.F1.4.1.m1.1.1.2">ID</mtext></ci><cn id="S2.F1.4.1.m1.1.1.3.cmml" type="integer" xref="S2.F1.4.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.4.1.m1.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.4.1.m1.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> in terms of loss computation. Given an image, its face attributes, and its face embedding, <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S2.F1.5.2.m2.1"><semantics id="S2.F1.5.2.m2.1b"><msup id="S2.F1.5.2.m2.1.1" xref="S2.F1.5.2.m2.1.1.cmml"><mtext id="S2.F1.5.2.m2.1.1.2" xref="S2.F1.5.2.m2.1.1.2a.cmml">ID</mtext><mn id="S2.F1.5.2.m2.1.1.3" xref="S2.F1.5.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S2.F1.5.2.m2.1c"><apply id="S2.F1.5.2.m2.1.1.cmml" xref="S2.F1.5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F1.5.2.m2.1.1.1.cmml" xref="S2.F1.5.2.m2.1.1">superscript</csymbol><ci id="S2.F1.5.2.m2.1.1.2a.cmml" xref="S2.F1.5.2.m2.1.1.2"><mtext id="S2.F1.5.2.m2.1.1.2.cmml" xref="S2.F1.5.2.m2.1.1.2">ID</mtext></ci><cn id="S2.F1.5.2.m2.1.1.3.cmml" type="integer" xref="S2.F1.5.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.5.2.m2.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.5.2.m2.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> obtains the image’s noised version after <math alttext="t" class="ltx_Math" display="inline" id="S2.F1.6.3.m3.1"><semantics id="S2.F1.6.3.m3.1b"><mi id="S2.F1.6.3.m3.1.1" xref="S2.F1.6.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F1.6.3.m3.1c"><ci id="S2.F1.6.3.m3.1.1.cmml" xref="S2.F1.6.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.3.m3.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F1.6.3.m3.1e">italic_t</annotation></semantics></math> diffusion steps and employs a denoising network to denoise it.
This denoising process is conditioned on the predicted attributes and the ID embedding.
Optimization proceeds by minimizing a loss function comprised of a denoising term, a one-step reconstruction term, an inner-product term, and a constant.
</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">We propose <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><msup id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mtext id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.p1.1.m1.1.1.2a.cmml" xref="S3.p1.1.m1.1.1.2"><mtext id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">ID</mtext></ci><cn id="S3.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, a conditional diffusion model that generates diverse yet identity-preserving face images. <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><msup id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mtext id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2a.cmml">ID</mtext><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.p1.2.m2.1.1.2a.cmml" xref="S3.p1.2.m2.1.1.2"><mtext id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">ID</mtext></ci><cn id="S3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> solves RQ1 by introducing two conditioning signals (identity embeddings and face attributes) into a diffusion model which is trained using a novel loss function.
The loss function, together with identity embeddings, ensures intra-class identity preservation,
while generation upon various face attributes give rise to intra-/inter-class diversity of face appearances.
Our theoretical result regarding this loss function leads to an ID-preserving sampling algorithm and, further, an effective dataset-generating algorithm.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.4"><span class="ltx_text ltx_font_bold" id="S3.p2.4.1">Notations.</span> Throughout the rest of the the paper, we let <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">caligraphic_D</annotation></semantics></math> denote a real face dataset that contains face images <math alttext="\mathbf{x}_{0}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><msub id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml"><mi id="S3.p2.2.m2.1.1.2.2" xref="S3.p2.2.m2.1.1.2.2.cmml">𝐱</mi><mn id="S3.p2.2.m2.1.1.2.3" xref="S3.p2.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2" xref="S3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml"><mi id="S3.p2.2.m2.1.1.3.3.2" xref="S3.p2.2.m2.1.1.3.3.2.cmml">H</mi><mo id="S3.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.p2.2.m2.1.1.3.3.3" xref="S3.p2.2.m2.1.1.3.3.3.cmml">W</mi><mo id="S3.p2.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.p2.2.m2.1.1.3.3.4" xref="S3.p2.2.m2.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><in id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></in><apply id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.2.2">𝐱</ci><cn id="S3.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.p2.2.m2.1.1.2.3">0</cn></apply><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3"><times id="S3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.p2.2.m2.1.1.3.3.1"></times><ci id="S3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.p2.2.m2.1.1.3.3.2">𝐻</ci><ci id="S3.p2.2.m2.1.1.3.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3.3">𝑊</ci><cn id="S3.p2.2.m2.1.1.3.3.4.cmml" type="integer" xref="S3.p2.2.m2.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathbf{x}_{0}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. Let <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">bold_y</annotation></semantics></math> denote a desired identity embedding and <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">bold_s</annotation></semantics></math> be face attributes.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Diffusion Models</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">We build up our generative model, <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msup id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mtext id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.1.1.2"><mtext id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">ID</mtext></ci><cn id="S3.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, upon denoising diffusion probabilistic models (diffusion models for short)  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Ho et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">2020</span></a>; <span class="ltx_text" style="font-size:90%;">Song et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>; <span class="ltx_text" style="font-size:90%;">Rombach et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>)</cite>
as they empirically exhibit SoTA performance in the field of image generation.
Diffusion models can be seen as a hierarchical VAE whose optimization objective is to minimize the KL divergence between the true data distribution and the model distribution <math alttext="p_{\bm{\theta}}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">p_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, which is equivalent to minimizing the expected negative log-likelihood (NLL), <math alttext="\mathbb{E}_{\mathbf{x}\sim\mathcal{D}}[-\log p_{\bm{\theta}}(\mathbf{x})]" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.2"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml"><msub id="S3.SS1.p1.3.m3.2.2.3" xref="S3.SS1.p1.3.m3.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.2.2.3.2" xref="S3.SS1.p1.3.m3.2.2.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.3.m3.2.2.3.3" xref="S3.SS1.p1.3.m3.2.2.3.3.cmml"><mi id="S3.SS1.p1.3.m3.2.2.3.3.2" xref="S3.SS1.p1.3.m3.2.2.3.3.2.cmml">𝐱</mi><mo id="S3.SS1.p1.3.m3.2.2.3.3.1" xref="S3.SS1.p1.3.m3.2.2.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.2.3.3.3" xref="S3.SS1.p1.3.m3.2.2.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.SS1.p1.3.m3.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1" xref="S3.SS1.p1.3.m3.2.2.1.2.cmml"><mo id="S3.SS1.p1.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.2.2.1.1.1a" rspace="0.167em" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml">−</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml"><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.1.cmml">log</mi><mo id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2a" lspace="0.167em" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.cmml">⁡</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.3.cmml">𝜽</mi></msub></mrow><mo id="S3.SS1.p1.3.m3.2.2.1.1.1.2.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1.1.2.3.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml"><mo id="S3.SS1.p1.3.m3.2.2.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.3.m3.2.2.1.1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.3.m3.2.2.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2"><times id="S3.SS1.p1.3.m3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2"></times><apply id="S3.SS1.p1.3.m3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.2.3.2">𝔼</ci><apply id="S3.SS1.p1.3.m3.2.2.3.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3.3"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.2.2.3.3.1.cmml" xref="S3.SS1.p1.3.m3.2.2.3.3.1">similar-to</csymbol><ci id="S3.SS1.p1.3.m3.2.2.3.3.2.cmml" xref="S3.SS1.p1.3.m3.2.2.3.3.2">𝐱</ci><ci id="S3.SS1.p1.3.m3.2.2.3.3.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3.3.3">𝒟</ci></apply></apply><apply id="S3.SS1.p1.3.m3.2.2.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.2.2.1.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><minus id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"></minus><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2"><times id="S3.SS1.p1.3.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.1"></times><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2"><log id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.1"></log><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.2">𝑝</ci><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.2.2.3">𝜽</ci></apply></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">\mathbb{E}_{\mathbf{x}\sim\mathcal{D}}[-\log p_{\bm{\theta}}(\mathbf{x})]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.2d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ caligraphic_D end_POSTSUBSCRIPT [ - roman_log italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x ) ]</annotation></semantics></math>. However, directly minimizing the expected NLL is intractable,
therefore diffusion models instead minimize its evidence lower bound (ELBO), where the ELBO term can further simply to a denoising task with several model assumptions:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\log p(\mathbf{x})&amp;\geq\underbrace{\mathbb{E}_{q(\mathbf{x}_{1:T}%
|\mathbf{x}_{0})}\left[\log\frac{p(\mathbf{x}_{0:T})}{q(\mathbf{x}_{1:T}|%
\mathbf{x}_{0})}\right]}_{\text{ELBO}}\\
&amp;=\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[-\frac{1}{2}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{1},1)\right\rVert_{2%
}^{2}\right]-\frac{1}{T-1}\sum_{t=2}^{T}{\mu_{t}\left\lVert\mathbf{x}_{0}-\hat%
{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t)\right\rVert_{2}^{2}}\end{split}" class="ltx_Math" display="block" id="S3.E1.m1.56"><semantics id="S3.E1.m1.56a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E1.m1.56.56.4" rowspacing="0pt" xref="S3.E1.m1.54.54.2.cmml"><mtr id="S3.E1.m1.56.56.4a" xref="S3.E1.m1.54.54.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.56.56.4b" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.5.5.5.5.5" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.5.5.5.5.5.7" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">log</mi><mo id="S3.E1.m1.5.5.5.5.5.7a" lspace="0.167em" xref="S3.E1.m1.54.54.2a.cmml">⁡</mo><mi id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml">p</mi></mrow><mo id="S3.E1.m1.5.5.5.5.5.6" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.5.5.5.8" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.3.3.3.3.3.3" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">(</mo><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">𝐱</mi><mo id="S3.E1.m1.5.5.5.5.5.5" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.56.56.4c" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.8.8.8.8.3" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.8.8.8.8.3.4" xref="S3.E1.m1.54.54.2a.cmml"></mi><mo id="S3.E1.m1.6.6.6.6.1.1" xref="S3.E1.m1.6.6.6.6.1.1.cmml">≥</mo><munder id="S3.E1.m1.8.8.8.8.3.5" xref="S3.E1.m1.54.54.2.cmml"><munder accentunder="true" id="S3.E1.m1.7.7.7.7.2.2" xref="S3.E1.m1.7.7.7.7.2.2.cmml"><mrow id="S3.E1.m1.7.7.7.7.2.2.4" xref="S3.E1.m1.7.7.7.7.2.2.4.cmml"><msub id="S3.E1.m1.7.7.7.7.2.2.4.6" xref="S3.E1.m1.7.7.7.7.2.2.4.6.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.4.6.2" xref="S3.E1.m1.7.7.7.7.2.2.4.6.2.cmml">𝔼</mi><mrow id="S3.E1.m1.7.7.7.7.2.2.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.1.1.1.3" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.3.cmml">q</mi><mo id="S3.E1.m1.7.7.7.7.2.2.1.1.1.2" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.2" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.cmml"><mn id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E1.m1.7.7.7.7.2.2.4.5" xref="S3.E1.m1.7.7.7.7.2.2.4.5.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.4.4.1" xref="S3.E1.m1.7.7.7.7.2.2.4.4.2.cmml"><mo id="S3.E1.m1.7.7.7.7.2.2.4.4.1.2" xref="S3.E1.m1.7.7.7.7.2.2.4.4.2.1.cmml">[</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.4.4.1.1" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.1.cmml">log</mi><mo id="S3.E1.m1.7.7.7.7.2.2.4.4.1.1a" lspace="0.167em" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.cmml">⁡</mo><mfrac id="S3.E1.m1.7.7.7.7.2.2.3.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.cmml"><mrow id="S3.E1.m1.7.7.7.7.2.2.2.2.1" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.2.2.1.3" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.3.cmml">p</mi><mo id="S3.E1.m1.7.7.7.7.2.2.2.2.1.2" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.2" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.cmml"><mn id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.2" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.2.cmml">0</mn><mo id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.3" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.7.7.7.7.2.2.3.3.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.3.3.2.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.3.cmml">q</mi><mo id="S3.E1.m1.7.7.7.7.2.2.3.3.2.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.cmml"><mo id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.2" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.cmml"><msub id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.2.cmml">𝐱</mi><mrow id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.cmml"><mn id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.2.cmml">1</mn><mo id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.1.cmml">:</mo><mi id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.1" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.2" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.2.cmml">𝐱</mi><mn id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.3" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.3" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.7.7.7.7.2.2.4.4.1.3" xref="S3.E1.m1.7.7.7.7.2.2.4.4.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.7.7.7.7.2.2.5" xref="S3.E1.m1.7.7.7.7.2.2.5.cmml">⏟</mo></munder><mtext id="S3.E1.m1.8.8.8.8.3.3.1" xref="S3.E1.m1.8.8.8.8.3.3.1a.cmml">ELBO</mtext></munder></mrow></mtd></mtr><mtr id="S3.E1.m1.56.56.4d" xref="S3.E1.m1.54.54.2.cmml"><mtd id="S3.E1.m1.56.56.4e" xref="S3.E1.m1.54.54.2a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.56.56.4f" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.56.56.4.54.46.46" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.56.56.4.54.46.46.47" xref="S3.E1.m1.54.54.2a.cmml"></mi><mo id="S3.E1.m1.9.9.9.1.1.1" xref="S3.E1.m1.9.9.9.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.55.55.3.53.45.45.45.1.3" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.10.10.10.2.2.2" xref="S3.E1.m1.10.10.10.2.2.2.cmml">𝔼</mi><mrow id="S3.E1.m1.11.11.11.3.3.3.1" xref="S3.E1.m1.11.11.11.3.3.3.1.cmml"><mi id="S3.E1.m1.11.11.11.3.3.3.1.3" xref="S3.E1.m1.11.11.11.3.3.3.1.3.cmml">q</mi><mo id="S3.E1.m1.11.11.11.3.3.3.1.2" xref="S3.E1.m1.11.11.11.3.3.3.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.11.11.11.3.3.3.1.1.1" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.cmml"><mo id="S3.E1.m1.11.11.11.3.3.3.1.1.1.2" stretchy="false" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.cmml"><msub id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.cmml"><mi id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.2" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.3" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.1" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.2" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.3" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E1.m1.11.11.11.3.3.3.1.1.1.3" stretchy="false" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E1.m1.55.55.3.53.45.45.45.1.2" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.12.12.12.4.4.4" xref="S3.E1.m1.54.54.2a.cmml">[</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1a" xref="S3.E1.m1.54.54.2a.cmml">−</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mfrac id="S3.E1.m1.14.14.14.6.6.6" xref="S3.E1.m1.14.14.14.6.6.6.cmml"><mn id="S3.E1.m1.14.14.14.6.6.6.2" xref="S3.E1.m1.14.14.14.6.6.6.2.cmml">1</mn><mn id="S3.E1.m1.14.14.14.6.6.6.3" xref="S3.E1.m1.14.14.14.6.6.6.3.cmml">2</mn></mfrac><mo id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.2" lspace="0em" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><msubsup id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo fence="true" id="S3.E1.m1.15.15.15.7.7.7" rspace="0em" stretchy="true" xref="S3.E1.m1.54.54.2a.cmml">∥</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.16.16.16.8.8.8" xref="S3.E1.m1.16.16.16.8.8.8.cmml">𝐱</mi><mn id="S3.E1.m1.17.17.17.9.9.9.1" xref="S3.E1.m1.17.17.17.9.9.9.1.cmml">0</mn></msub><mo id="S3.E1.m1.18.18.18.10.10.10" xref="S3.E1.m1.18.18.18.10.10.10.cmml">−</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.54.54.2.cmml"><mover accent="true" id="S3.E1.m1.19.19.19.11.11.11" xref="S3.E1.m1.19.19.19.11.11.11.cmml"><mi id="S3.E1.m1.19.19.19.11.11.11.2" xref="S3.E1.m1.19.19.19.11.11.11.2.cmml">𝐱</mi><mo id="S3.E1.m1.19.19.19.11.11.11.1" xref="S3.E1.m1.19.19.19.11.11.11.1.cmml">^</mo></mover><mi id="S3.E1.m1.20.20.20.12.12.12.1" xref="S3.E1.m1.20.20.20.12.12.12.1.cmml">𝜽</mi></msub><mo id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><mrow id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.21.21.21.13.13.13" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">(</mo><msub id="S3.E1.m1.55.55.3.53.45.45.45.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.22.22.22.14.14.14" xref="S3.E1.m1.22.22.22.14.14.14.cmml">𝐱</mi><mn id="S3.E1.m1.23.23.23.15.15.15.1" xref="S3.E1.m1.23.23.23.15.15.15.1.cmml">1</mn></msub><mo id="S3.E1.m1.24.24.24.16.16.16" xref="S3.E1.m1.54.54.2a.cmml">,</mo><mn id="S3.E1.m1.25.25.25.17.17.17" xref="S3.E1.m1.25.25.25.17.17.17.cmml">1</mn><mo id="S3.E1.m1.26.26.26.18.18.18" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">)</mo></mrow></mrow></mrow><mo fence="true" id="S3.E1.m1.27.27.27.19.19.19" lspace="0em" rspace="0em" stretchy="true" xref="S3.E1.m1.54.54.2a.cmml">∥</mo></mrow><mn id="S3.E1.m1.28.28.28.20.20.20.1" xref="S3.E1.m1.28.28.28.20.20.20.1.cmml">2</mn><mn id="S3.E1.m1.29.29.29.21.21.21.1" xref="S3.E1.m1.29.29.29.21.21.21.1.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E1.m1.30.30.30.22.22.22" xref="S3.E1.m1.54.54.2a.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.31.31.31.23.23.23" xref="S3.E1.m1.31.31.31.23.23.23.cmml">−</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2" xref="S3.E1.m1.54.54.2.cmml"><mfrac id="S3.E1.m1.32.32.32.24.24.24" xref="S3.E1.m1.32.32.32.24.24.24.cmml"><mn id="S3.E1.m1.32.32.32.24.24.24.2" xref="S3.E1.m1.32.32.32.24.24.24.2.cmml">1</mn><mrow id="S3.E1.m1.32.32.32.24.24.24.3" xref="S3.E1.m1.32.32.32.24.24.24.3.cmml"><mi id="S3.E1.m1.32.32.32.24.24.24.3.2" xref="S3.E1.m1.32.32.32.24.24.24.3.2.cmml">T</mi><mo id="S3.E1.m1.32.32.32.24.24.24.3.1" xref="S3.E1.m1.32.32.32.24.24.24.3.1.cmml">−</mo><mn id="S3.E1.m1.32.32.32.24.24.24.3.3" xref="S3.E1.m1.32.32.32.24.24.24.3.3.cmml">1</mn></mrow></mfrac><mo id="S3.E1.m1.56.56.4.54.46.46.46.2.2" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1" xref="S3.E1.m1.54.54.2.cmml"><munderover id="S3.E1.m1.56.56.4.54.46.46.46.2.1.2" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.33.33.33.25.25.25" movablelimits="false" xref="S3.E1.m1.33.33.33.25.25.25.cmml">∑</mo><mrow id="S3.E1.m1.34.34.34.26.26.26.1" xref="S3.E1.m1.34.34.34.26.26.26.1.cmml"><mi id="S3.E1.m1.34.34.34.26.26.26.1.2" xref="S3.E1.m1.34.34.34.26.26.26.1.2.cmml">t</mi><mo id="S3.E1.m1.34.34.34.26.26.26.1.1" xref="S3.E1.m1.34.34.34.26.26.26.1.1.cmml">=</mo><mn id="S3.E1.m1.34.34.34.26.26.26.1.3" xref="S3.E1.m1.34.34.34.26.26.26.1.3.cmml">2</mn></mrow><mi id="S3.E1.m1.35.35.35.27.27.27.1" xref="S3.E1.m1.35.35.35.27.27.27.1.cmml">T</mi></munderover><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.3" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.36.36.36.28.28.28" xref="S3.E1.m1.36.36.36.28.28.28.cmml">μ</mi><mi id="S3.E1.m1.37.37.37.29.29.29.1" xref="S3.E1.m1.37.37.37.29.29.29.1.cmml">t</mi></msub><mo id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.2" lspace="0em" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><msubsup id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo fence="true" id="S3.E1.m1.38.38.38.30.30.30" rspace="0em" stretchy="true" xref="S3.E1.m1.54.54.2a.cmml">∥</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.39.39.39.31.31.31" xref="S3.E1.m1.39.39.39.31.31.31.cmml">𝐱</mi><mn id="S3.E1.m1.40.40.40.32.32.32.1" xref="S3.E1.m1.40.40.40.32.32.32.1.cmml">0</mn></msub><mo id="S3.E1.m1.41.41.41.33.33.33" xref="S3.E1.m1.41.41.41.33.33.33.cmml">−</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><msub id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.54.54.2.cmml"><mover accent="true" id="S3.E1.m1.42.42.42.34.34.34" xref="S3.E1.m1.42.42.42.34.34.34.cmml"><mi id="S3.E1.m1.42.42.42.34.34.34.2" xref="S3.E1.m1.42.42.42.34.34.34.2.cmml">𝐱</mi><mo id="S3.E1.m1.42.42.42.34.34.34.1" xref="S3.E1.m1.42.42.42.34.34.34.1.cmml">^</mo></mover><mi id="S3.E1.m1.43.43.43.35.35.35.1" xref="S3.E1.m1.43.43.43.35.35.35.1.cmml">𝜽</mi></msub><mo id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.54.54.2a.cmml">⁢</mo><mrow id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mo id="S3.E1.m1.44.44.44.36.36.36" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">(</mo><msub id="S3.E1.m1.56.56.4.54.46.46.46.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.54.54.2.cmml"><mi id="S3.E1.m1.45.45.45.37.37.37" xref="S3.E1.m1.45.45.45.37.37.37.cmml">𝐱</mi><mi id="S3.E1.m1.46.46.46.38.38.38.1" xref="S3.E1.m1.46.46.46.38.38.38.1.cmml">t</mi></msub><mo id="S3.E1.m1.47.47.47.39.39.39" xref="S3.E1.m1.54.54.2a.cmml">,</mo><mi id="S3.E1.m1.48.48.48.40.40.40" xref="S3.E1.m1.48.48.48.40.40.40.cmml">t</mi><mo id="S3.E1.m1.49.49.49.41.41.41" stretchy="false" xref="S3.E1.m1.54.54.2a.cmml">)</mo></mrow></mrow></mrow><mo fence="true" id="S3.E1.m1.50.50.50.42.42.42" lspace="0em" stretchy="true" xref="S3.E1.m1.54.54.2a.cmml">∥</mo></mrow><mn id="S3.E1.m1.51.51.51.43.43.43.1" xref="S3.E1.m1.51.51.51.43.43.43.1.cmml">2</mn><mn id="S3.E1.m1.52.52.52.44.44.44.1" xref="S3.E1.m1.52.52.52.44.44.44.1.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.56b"><apply id="S3.E1.m1.54.54.2.cmml" xref="S3.E1.m1.56.56.4"><and id="S3.E1.m1.54.54.2a.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></and><apply id="S3.E1.m1.54.54.2b.cmml" xref="S3.E1.m1.56.56.4"><geq id="S3.E1.m1.6.6.6.6.1.1.cmml" xref="S3.E1.m1.6.6.6.6.1.1"></geq><apply id="S3.E1.m1.54.54.2.4.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.54.54.2.4.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></times><apply id="S3.E1.m1.54.54.2.4.2.cmml" xref="S3.E1.m1.56.56.4"><log id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></log><ci id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">𝑝</ci></apply><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">𝐱</ci></apply><apply id="S3.E1.m1.54.54.2.6.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.6.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">subscript</csymbol><apply id="S3.E1.m1.7.7.7.7.2.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2"><ci id="S3.E1.m1.7.7.7.7.2.2.5.cmml" xref="S3.E1.m1.7.7.7.7.2.2.5">⏟</ci><apply id="S3.E1.m1.7.7.7.7.2.2.4.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4"><times id="S3.E1.m1.7.7.7.7.2.2.4.5.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.5"></times><apply id="S3.E1.m1.7.7.7.7.2.2.4.6.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.4.6.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.6">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.4.6.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.6.2">𝔼</ci><apply id="S3.E1.m1.7.7.7.7.2.2.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1"><times id="S3.E1.m1.7.7.7.7.2.2.1.1.1.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.2"></times><ci id="S3.E1.m1.7.7.7.7.2.2.1.1.1.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.3">𝑞</ci><apply id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.2">𝐱</ci><apply id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3"><ci id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.1">:</ci><cn id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.2">𝐱</ci><cn id="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.7.7.7.7.2.2.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S3.E1.m1.7.7.7.7.2.2.4.4.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.7.7.2.2.4.4.2.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.1"><log id="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.4.4.1.1.1"></log><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3"><divide id="S3.E1.m1.7.7.7.7.2.2.3.3.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3"></divide><apply id="S3.E1.m1.7.7.7.7.2.2.2.2.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1"><times id="S3.E1.m1.7.7.7.7.2.2.2.2.1.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.2"></times><ci id="S3.E1.m1.7.7.7.7.2.2.2.2.1.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.3">𝑝</ci><apply id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.2">𝐱</ci><apply id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3"><ci id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.1">:</ci><cn id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.2">0</cn><ci id="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.2.2.1.1.1.1.3.3">𝑇</ci></apply></apply></apply><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2"><times id="S3.E1.m1.7.7.7.7.2.2.3.3.2.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.2"></times><ci id="S3.E1.m1.7.7.7.7.2.2.3.3.2.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.3">𝑞</ci><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.2">𝐱</ci><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3"><ci id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.1">:</ci><cn id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.2.cmml" type="integer" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.2">1</cn><ci id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.2">𝐱</ci><cn id="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.7.7.7.7.2.2.3.3.2.1.1.1.3.3">0</cn></apply></apply></apply></apply></apply></apply></apply></apply><ci id="S3.E1.m1.8.8.8.8.3.3.1a.cmml" xref="S3.E1.m1.8.8.8.8.3.3.1"><mtext id="S3.E1.m1.8.8.8.8.3.3.1.cmml" mathsize="70%" xref="S3.E1.m1.8.8.8.8.3.3.1">ELBO</mtext></ci></apply></apply><apply id="S3.E1.m1.54.54.2c.cmml" xref="S3.E1.m1.56.56.4"><eq id="S3.E1.m1.9.9.9.1.1.1.cmml" xref="S3.E1.m1.9.9.9.1.1.1"></eq><share href="https://arxiv.org/html/2409.17576v1#S3.E1.m1.54.54.2.6.cmml" id="S3.E1.m1.54.54.2d.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></share><apply id="S3.E1.m1.54.54.2.2.cmml" xref="S3.E1.m1.56.56.4"><minus id="S3.E1.m1.31.31.31.23.23.23.cmml" xref="S3.E1.m1.31.31.31.23.23.23"></minus><apply id="S3.E1.m1.53.53.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.53.53.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></times><apply id="S3.E1.m1.53.53.1.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">subscript</csymbol><ci id="S3.E1.m1.10.10.10.2.2.2.cmml" xref="S3.E1.m1.10.10.10.2.2.2">𝔼</ci><apply id="S3.E1.m1.11.11.11.3.3.3.1.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1"><times id="S3.E1.m1.11.11.11.3.3.3.1.2.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.2"></times><ci id="S3.E1.m1.11.11.11.3.3.3.1.3.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.3">𝑞</ci><apply id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.2">𝐱</ci><cn id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.3.cmml" type="integer" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.2.3">1</cn></apply><apply id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.2">𝐱</ci><cn id="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.11.11.11.3.3.3.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S3.E1.m1.53.53.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="latexml" id="S3.E1.m1.53.53.1.1.1.1.2.1.cmml" xref="S3.E1.m1.56.56.4">delimited-[]</csymbol><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><minus id="S3.E1.m1.13.13.13.5.5.5.cmml" xref="S3.E1.m1.56.56.4"></minus><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.53.53.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"></times><apply id="S3.E1.m1.14.14.14.6.6.6.cmml" xref="S3.E1.m1.14.14.14.6.6.6"><divide id="S3.E1.m1.14.14.14.6.6.6.1.cmml" xref="S3.E1.m1.14.14.14.6.6.6"></divide><cn id="S3.E1.m1.14.14.14.6.6.6.2.cmml" type="integer" xref="S3.E1.m1.14.14.14.6.6.6.2">1</cn><cn id="S3.E1.m1.14.14.14.6.6.6.3.cmml" type="integer" xref="S3.E1.m1.14.14.14.6.6.6.3">2</cn></apply><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4">superscript</csymbol><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="latexml" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.56.56.4">delimited-∥∥</csymbol><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><minus id="S3.E1.m1.18.18.18.10.10.10.cmml" xref="S3.E1.m1.18.18.18.10.10.10"></minus><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><ci id="S3.E1.m1.16.16.16.8.8.8.cmml" xref="S3.E1.m1.16.16.16.8.8.8">𝐱</ci><cn id="S3.E1.m1.17.17.17.9.9.9.1.cmml" type="integer" xref="S3.E1.m1.17.17.17.9.9.9.1">0</cn></apply><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"></times><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><apply id="S3.E1.m1.19.19.19.11.11.11.cmml" xref="S3.E1.m1.19.19.19.11.11.11"><ci id="S3.E1.m1.19.19.19.11.11.11.1.cmml" xref="S3.E1.m1.19.19.19.11.11.11.1">^</ci><ci id="S3.E1.m1.19.19.19.11.11.11.2.cmml" xref="S3.E1.m1.19.19.19.11.11.11.2">𝐱</ci></apply><ci id="S3.E1.m1.20.20.20.12.12.12.1.cmml" xref="S3.E1.m1.20.20.20.12.12.12.1">𝜽</ci></apply><interval closure="open" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"><apply id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.53.53.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><ci id="S3.E1.m1.22.22.22.14.14.14.cmml" xref="S3.E1.m1.22.22.22.14.14.14">𝐱</ci><cn id="S3.E1.m1.23.23.23.15.15.15.1.cmml" type="integer" xref="S3.E1.m1.23.23.23.15.15.15.1">1</cn></apply><cn id="S3.E1.m1.25.25.25.17.17.17.cmml" type="integer" xref="S3.E1.m1.25.25.25.17.17.17">1</cn></interval></apply></apply></apply><cn id="S3.E1.m1.28.28.28.20.20.20.1.cmml" type="integer" xref="S3.E1.m1.28.28.28.20.20.20.1">2</cn></apply><cn id="S3.E1.m1.29.29.29.21.21.21.1.cmml" type="integer" xref="S3.E1.m1.29.29.29.21.21.21.1">2</cn></apply></apply></apply></apply></apply><apply id="S3.E1.m1.54.54.2.2.2.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.54.54.2.2.2.2.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></times><apply id="S3.E1.m1.32.32.32.24.24.24.cmml" xref="S3.E1.m1.32.32.32.24.24.24"><divide id="S3.E1.m1.32.32.32.24.24.24.1.cmml" xref="S3.E1.m1.32.32.32.24.24.24"></divide><cn id="S3.E1.m1.32.32.32.24.24.24.2.cmml" type="integer" xref="S3.E1.m1.32.32.32.24.24.24.2">1</cn><apply id="S3.E1.m1.32.32.32.24.24.24.3.cmml" xref="S3.E1.m1.32.32.32.24.24.24.3"><minus id="S3.E1.m1.32.32.32.24.24.24.3.1.cmml" xref="S3.E1.m1.32.32.32.24.24.24.3.1"></minus><ci id="S3.E1.m1.32.32.32.24.24.24.3.2.cmml" xref="S3.E1.m1.32.32.32.24.24.24.3.2">𝑇</ci><cn id="S3.E1.m1.32.32.32.24.24.24.3.3.cmml" type="integer" xref="S3.E1.m1.32.32.32.24.24.24.3.3">1</cn></apply></apply><apply id="S3.E1.m1.54.54.2.2.2.1.cmml" xref="S3.E1.m1.56.56.4"><apply id="S3.E1.m1.54.54.2.2.2.1.2.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.2.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">superscript</csymbol><apply id="S3.E1.m1.54.54.2.2.2.1.2.2.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.2.2.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">subscript</csymbol><sum id="S3.E1.m1.33.33.33.25.25.25.cmml" xref="S3.E1.m1.33.33.33.25.25.25"></sum><apply id="S3.E1.m1.34.34.34.26.26.26.1.cmml" xref="S3.E1.m1.34.34.34.26.26.26.1"><eq id="S3.E1.m1.34.34.34.26.26.26.1.1.cmml" xref="S3.E1.m1.34.34.34.26.26.26.1.1"></eq><ci id="S3.E1.m1.34.34.34.26.26.26.1.2.cmml" xref="S3.E1.m1.34.34.34.26.26.26.1.2">𝑡</ci><cn id="S3.E1.m1.34.34.34.26.26.26.1.3.cmml" type="integer" xref="S3.E1.m1.34.34.34.26.26.26.1.3">2</cn></apply></apply><ci id="S3.E1.m1.35.35.35.27.27.27.1.cmml" xref="S3.E1.m1.35.35.35.27.27.27.1">𝑇</ci></apply><apply id="S3.E1.m1.54.54.2.2.2.1.1.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.54.54.2.2.2.1.1.2.cmml" xref="S3.E1.m1.5.5.5.5.5.7a"></times><apply id="S3.E1.m1.54.54.2.2.2.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">subscript</csymbol><ci id="S3.E1.m1.36.36.36.28.28.28.cmml" xref="S3.E1.m1.36.36.36.28.28.28">𝜇</ci><ci id="S3.E1.m1.37.37.37.29.29.29.1.cmml" xref="S3.E1.m1.37.37.37.29.29.29.1">𝑡</ci></apply><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">superscript</csymbol><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.5.5.7a">subscript</csymbol><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="latexml" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.56.56.4">delimited-∥∥</csymbol><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><minus id="S3.E1.m1.41.41.41.33.33.33.cmml" xref="S3.E1.m1.41.41.41.33.33.33"></minus><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><ci id="S3.E1.m1.39.39.39.31.31.31.cmml" xref="S3.E1.m1.39.39.39.31.31.31">𝐱</ci><cn id="S3.E1.m1.40.40.40.32.32.32.1.cmml" type="integer" xref="S3.E1.m1.40.40.40.32.32.32.1">0</cn></apply><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><times id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"></times><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><apply id="S3.E1.m1.42.42.42.34.34.34.cmml" xref="S3.E1.m1.42.42.42.34.34.34"><ci id="S3.E1.m1.42.42.42.34.34.34.1.cmml" xref="S3.E1.m1.42.42.42.34.34.34.1">^</ci><ci id="S3.E1.m1.42.42.42.34.34.34.2.cmml" xref="S3.E1.m1.42.42.42.34.34.34.2">𝐱</ci></apply><ci id="S3.E1.m1.43.43.43.35.35.35.1.cmml" xref="S3.E1.m1.43.43.43.35.35.35.1">𝜽</ci></apply><interval closure="open" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.56.56.4"><apply id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4"><csymbol cd="ambiguous" id="S3.E1.m1.54.54.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.56.56.4">subscript</csymbol><ci id="S3.E1.m1.45.45.45.37.37.37.cmml" xref="S3.E1.m1.45.45.45.37.37.37">𝐱</ci><ci id="S3.E1.m1.46.46.46.38.38.38.1.cmml" xref="S3.E1.m1.46.46.46.38.38.38.1">𝑡</ci></apply><ci id="S3.E1.m1.48.48.48.40.40.40.cmml" xref="S3.E1.m1.48.48.48.40.40.40">𝑡</ci></interval></apply></apply></apply><cn id="S3.E1.m1.51.51.51.43.43.43.1.cmml" type="integer" xref="S3.E1.m1.51.51.51.43.43.43.1">2</cn></apply><cn id="S3.E1.m1.52.52.52.44.44.44.1.cmml" type="integer" xref="S3.E1.m1.52.52.52.44.44.44.1">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.56c">\begin{split}\log p(\mathbf{x})&amp;\geq\underbrace{\mathbb{E}_{q(\mathbf{x}_{1:T}%
|\mathbf{x}_{0})}\left[\log\frac{p(\mathbf{x}_{0:T})}{q(\mathbf{x}_{1:T}|%
\mathbf{x}_{0})}\right]}_{\text{ELBO}}\\
&amp;=\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[-\frac{1}{2}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{1},1)\right\rVert_{2%
}^{2}\right]-\frac{1}{T-1}\sum_{t=2}^{T}{\mu_{t}\left\lVert\mathbf{x}_{0}-\hat%
{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t)\right\rVert_{2}^{2}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.56d">start_ROW start_CELL roman_log italic_p ( bold_x ) end_CELL start_CELL ≥ under⏟ start_ARG blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_p ( bold_x start_POSTSUBSCRIPT 0 : italic_T end_POSTSUBSCRIPT ) end_ARG start_ARG italic_q ( bold_x start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_ARG ] end_ARG start_POSTSUBSCRIPT ELBO end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , 1 ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] - divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.22">where
<math alttext="\mu_{t}:=\frac{T-1}{2\sigma_{q}^{2}(t)}\cdot\frac{\bar{\alpha}_{t-1}(1-\alpha_%
{t})^{2}}{(1-\bar{\alpha_{t}})^{2}},\bar{\alpha}_{t}=\prod_{\tau=1}^{t}{\alpha%
_{\tau}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m1.5"><semantics id="S3.SS1.p1.4.m1.5a"><mrow id="S3.SS1.p1.4.m1.5.5.2" xref="S3.SS1.p1.4.m1.5.5.3.cmml"><mrow id="S3.SS1.p1.4.m1.4.4.1.1" xref="S3.SS1.p1.4.m1.4.4.1.1.cmml"><msub id="S3.SS1.p1.4.m1.4.4.1.1.2" xref="S3.SS1.p1.4.m1.4.4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m1.4.4.1.1.2.2" xref="S3.SS1.p1.4.m1.4.4.1.1.2.2.cmml">μ</mi><mi id="S3.SS1.p1.4.m1.4.4.1.1.2.3" xref="S3.SS1.p1.4.m1.4.4.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m1.4.4.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.4.m1.4.4.1.1.1.cmml">:=</mo><mrow id="S3.SS1.p1.4.m1.4.4.1.1.3" xref="S3.SS1.p1.4.m1.4.4.1.1.3.cmml"><mfrac id="S3.SS1.p1.4.m1.1.1" xref="S3.SS1.p1.4.m1.1.1.cmml"><mrow id="S3.SS1.p1.4.m1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m1.1.1.3.2" xref="S3.SS1.p1.4.m1.1.1.3.2.cmml">T</mi><mo id="S3.SS1.p1.4.m1.1.1.3.1" xref="S3.SS1.p1.4.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m1.1.1.3.3" xref="S3.SS1.p1.4.m1.1.1.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.4.m1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.cmml"><mn id="S3.SS1.p1.4.m1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.1.3.cmml">2</mn><mo id="S3.SS1.p1.4.m1.1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.SS1.p1.4.m1.1.1.1.4" xref="S3.SS1.p1.4.m1.1.1.1.4.cmml"><mi id="S3.SS1.p1.4.m1.1.1.1.4.2.2" xref="S3.SS1.p1.4.m1.1.1.1.4.2.2.cmml">σ</mi><mi id="S3.SS1.p1.4.m1.1.1.1.4.2.3" xref="S3.SS1.p1.4.m1.1.1.1.4.2.3.cmml">q</mi><mn id="S3.SS1.p1.4.m1.1.1.1.4.3" xref="S3.SS1.p1.4.m1.1.1.1.4.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.4.m1.1.1.1.2a" xref="S3.SS1.p1.4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.4.m1.1.1.1.5.2" xref="S3.SS1.p1.4.m1.1.1.1.cmml"><mo id="S3.SS1.p1.4.m1.1.1.1.5.2.1" stretchy="false" xref="S3.SS1.p1.4.m1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.4.m1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p1.4.m1.1.1.1.5.2.2" stretchy="false" xref="S3.SS1.p1.4.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.SS1.p1.4.m1.4.4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.4.m1.4.4.1.1.3.1.cmml">⋅</mo><mfrac id="S3.SS1.p1.4.m1.3.3" xref="S3.SS1.p1.4.m1.3.3.cmml"><mrow id="S3.SS1.p1.4.m1.2.2.1" xref="S3.SS1.p1.4.m1.2.2.1.cmml"><msub id="S3.SS1.p1.4.m1.2.2.1.3" xref="S3.SS1.p1.4.m1.2.2.1.3.cmml"><mover accent="true" id="S3.SS1.p1.4.m1.2.2.1.3.2" xref="S3.SS1.p1.4.m1.2.2.1.3.2.cmml"><mi id="S3.SS1.p1.4.m1.2.2.1.3.2.2" xref="S3.SS1.p1.4.m1.2.2.1.3.2.2.cmml">α</mi><mo id="S3.SS1.p1.4.m1.2.2.1.3.2.1" xref="S3.SS1.p1.4.m1.2.2.1.3.2.1.cmml">¯</mo></mover><mrow id="S3.SS1.p1.4.m1.2.2.1.3.3" xref="S3.SS1.p1.4.m1.2.2.1.3.3.cmml"><mi id="S3.SS1.p1.4.m1.2.2.1.3.3.2" xref="S3.SS1.p1.4.m1.2.2.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.4.m1.2.2.1.3.3.1" xref="S3.SS1.p1.4.m1.2.2.1.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m1.2.2.1.3.3.3" xref="S3.SS1.p1.4.m1.2.2.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.4.m1.2.2.1.2" xref="S3.SS1.p1.4.m1.2.2.1.2.cmml">⁢</mo><msup id="S3.SS1.p1.4.m1.2.2.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.cmml"><mrow id="S3.SS1.p1.4.m1.2.2.1.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.4.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml"><mn id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.1" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.2" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.2.cmml">α</mi><mi id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.3" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS1.p1.4.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS1.p1.4.m1.2.2.1.1.3" xref="S3.SS1.p1.4.m1.2.2.1.1.3.cmml">2</mn></msup></mrow><msup id="S3.SS1.p1.4.m1.3.3.2" xref="S3.SS1.p1.4.m1.3.3.2.cmml"><mrow id="S3.SS1.p1.4.m1.3.3.2.1.1" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.cmml"><mo id="S3.SS1.p1.4.m1.3.3.2.1.1.2" stretchy="false" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.4.m1.3.3.2.1.1.1" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.cmml"><mn id="S3.SS1.p1.4.m1.3.3.2.1.1.1.2" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.4.m1.3.3.2.1.1.1.1" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.cmml"><msub id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.2" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.2.cmml">α</mi><mi id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.3" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.1" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S3.SS1.p1.4.m1.3.3.2.1.1.3" stretchy="false" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.cmml">)</mo></mrow><mn id="S3.SS1.p1.4.m1.3.3.2.3" xref="S3.SS1.p1.4.m1.3.3.2.3.cmml">2</mn></msup></mfrac></mrow></mrow><mo id="S3.SS1.p1.4.m1.5.5.2.3" xref="S3.SS1.p1.4.m1.5.5.3a.cmml">,</mo><mrow id="S3.SS1.p1.4.m1.5.5.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.cmml"><msub id="S3.SS1.p1.4.m1.5.5.2.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.2.cmml"><mover accent="true" id="S3.SS1.p1.4.m1.5.5.2.2.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2.cmml"><mi id="S3.SS1.p1.4.m1.5.5.2.2.2.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2.2.cmml">α</mi><mo id="S3.SS1.p1.4.m1.5.5.2.2.2.2.1" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.SS1.p1.4.m1.5.5.2.2.2.3" xref="S3.SS1.p1.4.m1.5.5.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m1.5.5.2.2.1" rspace="0.111em" xref="S3.SS1.p1.4.m1.5.5.2.2.1.cmml">=</mo><mrow id="S3.SS1.p1.4.m1.5.5.2.2.3" xref="S3.SS1.p1.4.m1.5.5.2.2.3.cmml"><msubsup id="S3.SS1.p1.4.m1.5.5.2.2.3.1" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.cmml"><mo id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.2.cmml">∏</mo><mrow id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.cmml"><mi id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.2" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.2.cmml">τ</mi><mo id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.1" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.3" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.4.m1.5.5.2.2.3.1.3" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.3.cmml">t</mi></msubsup><msub id="S3.SS1.p1.4.m1.5.5.2.2.3.2" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2.cmml"><mi id="S3.SS1.p1.4.m1.5.5.2.2.3.2.2" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2.2.cmml">α</mi><mi id="S3.SS1.p1.4.m1.5.5.2.2.3.2.3" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2.3.cmml">τ</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.5b"><apply id="S3.SS1.p1.4.m1.5.5.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.5.5.3a.cmml" xref="S3.SS1.p1.4.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.4.m1.4.4.1.1.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1"><csymbol cd="latexml" id="S3.SS1.p1.4.m1.4.4.1.1.1.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.1">assign</csymbol><apply id="S3.SS1.p1.4.m1.4.4.1.1.2.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.4.4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m1.4.4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.2.2">𝜇</ci><ci id="S3.SS1.p1.4.m1.4.4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.4.m1.4.4.1.1.3.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.3"><ci id="S3.SS1.p1.4.m1.4.4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m1.4.4.1.1.3.1">⋅</ci><apply id="S3.SS1.p1.4.m1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1"><divide id="S3.SS1.p1.4.m1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1"></divide><apply id="S3.SS1.p1.4.m1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.1.1.3"><minus id="S3.SS1.p1.4.m1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m1.1.1.3.1"></minus><ci id="S3.SS1.p1.4.m1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m1.1.1.3.2">𝑇</ci><cn id="S3.SS1.p1.4.m1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.1.1.3.3">1</cn></apply><apply id="S3.SS1.p1.4.m1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1"><times id="S3.SS1.p1.4.m1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.2"></times><cn id="S3.SS1.p1.4.m1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.1.1.1.3">2</cn><apply id="S3.SS1.p1.4.m1.1.1.1.4.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.1.1.4.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4">superscript</csymbol><apply id="S3.SS1.p1.4.m1.1.1.1.4.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.1.1.4.2.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.4.m1.1.1.1.4.2.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4.2.2">𝜎</ci><ci id="S3.SS1.p1.4.m1.1.1.1.4.2.3.cmml" xref="S3.SS1.p1.4.m1.1.1.1.4.2.3">𝑞</ci></apply><cn id="S3.SS1.p1.4.m1.1.1.1.4.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.1.1.1.4.3">2</cn></apply><ci id="S3.SS1.p1.4.m1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1">𝑡</ci></apply></apply><apply id="S3.SS1.p1.4.m1.3.3.cmml" xref="S3.SS1.p1.4.m1.3.3"><divide id="S3.SS1.p1.4.m1.3.3.3.cmml" xref="S3.SS1.p1.4.m1.3.3"></divide><apply id="S3.SS1.p1.4.m1.2.2.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1"><times id="S3.SS1.p1.4.m1.2.2.1.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.2"></times><apply id="S3.SS1.p1.4.m1.2.2.1.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.2.2.1.3.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3">subscript</csymbol><apply id="S3.SS1.p1.4.m1.2.2.1.3.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.2"><ci id="S3.SS1.p1.4.m1.2.2.1.3.2.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.2.1">¯</ci><ci id="S3.SS1.p1.4.m1.2.2.1.3.2.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.2.2">𝛼</ci></apply><apply id="S3.SS1.p1.4.m1.2.2.1.3.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.3"><minus id="S3.SS1.p1.4.m1.2.2.1.3.3.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.3.1"></minus><ci id="S3.SS1.p1.4.m1.2.2.1.3.3.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.3.3.2">𝑡</ci><cn id="S3.SS1.p1.4.m1.2.2.1.3.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.2.2.1.3.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.4.m1.2.2.1.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.2.2.1.1.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1"><minus id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.1"></minus><cn id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.2">1</cn><apply id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.2">𝛼</ci><ci id="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.4.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply><cn id="S3.SS1.p1.4.m1.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.2.2.1.1.3">2</cn></apply></apply><apply id="S3.SS1.p1.4.m1.3.3.2.cmml" xref="S3.SS1.p1.4.m1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.3.3.2.2.cmml" xref="S3.SS1.p1.4.m1.3.3.2">superscript</csymbol><apply id="S3.SS1.p1.4.m1.3.3.2.1.1.1.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1"><minus id="S3.SS1.p1.4.m1.3.3.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.1"></minus><cn id="S3.SS1.p1.4.m1.3.3.2.1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.2">1</cn><apply id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3"><ci id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.1">¯</ci><apply id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.2">𝛼</ci><ci id="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.4.m1.3.3.2.1.1.1.3.2.3">𝑡</ci></apply></apply></apply><cn id="S3.SS1.p1.4.m1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.3.3.2.3">2</cn></apply></apply></apply></apply><apply id="S3.SS1.p1.4.m1.5.5.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2"><eq id="S3.SS1.p1.4.m1.5.5.2.2.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.1"></eq><apply id="S3.SS1.p1.4.m1.5.5.2.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.5.5.2.2.2.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.4.m1.5.5.2.2.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2"><ci id="S3.SS1.p1.4.m1.5.5.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2.1">¯</ci><ci id="S3.SS1.p1.4.m1.5.5.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2.2.2">𝛼</ci></apply><ci id="S3.SS1.p1.4.m1.5.5.2.2.2.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.4.m1.5.5.2.2.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3"><apply id="S3.SS1.p1.4.m1.5.5.2.2.3.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.5.5.2.2.3.1.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1">superscript</csymbol><apply id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1">subscript</csymbol><csymbol cd="latexml" id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.2">product</csymbol><apply id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3"><eq id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.1"></eq><ci id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.2">𝜏</ci><cn id="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.4.m1.5.5.2.2.3.1.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.4.m1.5.5.2.2.3.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.5.5.2.2.3.2.1.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.4.m1.5.5.2.2.3.2.2.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2.2">𝛼</ci><ci id="S3.SS1.p1.4.m1.5.5.2.2.3.2.3.cmml" xref="S3.SS1.p1.4.m1.5.5.2.2.3.2.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.5c">\mu_{t}:=\frac{T-1}{2\sigma_{q}^{2}(t)}\cdot\frac{\bar{\alpha}_{t-1}(1-\alpha_%
{t})^{2}}{(1-\bar{\alpha_{t}})^{2}},\bar{\alpha}_{t}=\prod_{\tau=1}^{t}{\alpha%
_{\tau}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m1.5d">italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT := divide start_ARG italic_T - 1 end_ARG start_ARG 2 italic_σ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_t ) end_ARG ⋅ divide start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG ( 1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∏ start_POSTSUBSCRIPT italic_τ = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math>.
Specifically, given a sample <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m2.1"><semantics id="S3.SS1.p1.5.m2.1a"><msub id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml"><mi id="S3.SS1.p1.5.m2.1.1.2" xref="S3.SS1.p1.5.m2.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.5.m2.1.1.3" xref="S3.SS1.p1.5.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><apply id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m2.1.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m2.1.1.2.cmml" xref="S3.SS1.p1.5.m2.1.1.2">𝐱</ci><cn id="S3.SS1.p1.5.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> (or interchangeably, <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m3.1"><semantics id="S3.SS1.p1.6.m3.1a"><mi id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.1b"><ci id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m3.1d">bold_x</annotation></semantics></math>) from the image distribution, a sequence <math alttext="\mathbf{x}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m4.1"><semantics id="S3.SS1.p1.7.m4.1a"><msub id="S3.SS1.p1.7.m4.1.1" xref="S3.SS1.p1.7.m4.1.1.cmml"><mi id="S3.SS1.p1.7.m4.1.1.2" xref="S3.SS1.p1.7.m4.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.7.m4.1.1.3" xref="S3.SS1.p1.7.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m4.1b"><apply id="S3.SS1.p1.7.m4.1.1.cmml" xref="S3.SS1.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m4.1.1.1.cmml" xref="S3.SS1.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m4.1.1.2.cmml" xref="S3.SS1.p1.7.m4.1.1.2">𝐱</ci><cn id="S3.SS1.p1.7.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.7.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m4.1c">\mathbf{x}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m4.1d">bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{x}_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m5.1"><semantics id="S3.SS1.p1.8.m5.1a"><msub id="S3.SS1.p1.8.m5.1.1" xref="S3.SS1.p1.8.m5.1.1.cmml"><mi id="S3.SS1.p1.8.m5.1.1.2" xref="S3.SS1.p1.8.m5.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.8.m5.1.1.3" xref="S3.SS1.p1.8.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m5.1b"><apply id="S3.SS1.p1.8.m5.1.1.cmml" xref="S3.SS1.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m5.1.1.1.cmml" xref="S3.SS1.p1.8.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m5.1.1.2.cmml" xref="S3.SS1.p1.8.m5.1.1.2">𝐱</ci><cn id="S3.SS1.p1.8.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p1.8.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m5.1c">\mathbf{x}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m5.1d">bold_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m6.1"><semantics id="S3.SS1.p1.9.m6.1a"><msub id="S3.SS1.p1.9.m6.1.1" xref="S3.SS1.p1.9.m6.1.1.cmml"><mi id="S3.SS1.p1.9.m6.1.1.2" xref="S3.SS1.p1.9.m6.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.9.m6.1.1.3" xref="S3.SS1.p1.9.m6.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m6.1b"><apply id="S3.SS1.p1.9.m6.1.1.cmml" xref="S3.SS1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m6.1.1.1.cmml" xref="S3.SS1.p1.9.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m6.1.1.2.cmml" xref="S3.SS1.p1.9.m6.1.1.2">𝐱</ci><ci id="S3.SS1.p1.9.m6.1.1.3.cmml" xref="S3.SS1.p1.9.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m6.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m6.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> of noisy images is produced by progressively adding Gaussian noise according to a variance schedule <math alttext="\alpha_{1},...,\alpha_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m7.3"><semantics id="S3.SS1.p1.10.m7.3a"><mrow id="S3.SS1.p1.10.m7.3.3.2" xref="S3.SS1.p1.10.m7.3.3.3.cmml"><msub id="S3.SS1.p1.10.m7.2.2.1.1" xref="S3.SS1.p1.10.m7.2.2.1.1.cmml"><mi id="S3.SS1.p1.10.m7.2.2.1.1.2" xref="S3.SS1.p1.10.m7.2.2.1.1.2.cmml">α</mi><mn id="S3.SS1.p1.10.m7.2.2.1.1.3" xref="S3.SS1.p1.10.m7.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.10.m7.3.3.2.3" xref="S3.SS1.p1.10.m7.3.3.3.cmml">,</mo><mi id="S3.SS1.p1.10.m7.1.1" mathvariant="normal" xref="S3.SS1.p1.10.m7.1.1.cmml">…</mi><mo id="S3.SS1.p1.10.m7.3.3.2.4" xref="S3.SS1.p1.10.m7.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.10.m7.3.3.2.2" xref="S3.SS1.p1.10.m7.3.3.2.2.cmml"><mi id="S3.SS1.p1.10.m7.3.3.2.2.2" xref="S3.SS1.p1.10.m7.3.3.2.2.2.cmml">α</mi><mi id="S3.SS1.p1.10.m7.3.3.2.2.3" xref="S3.SS1.p1.10.m7.3.3.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m7.3b"><list id="S3.SS1.p1.10.m7.3.3.3.cmml" xref="S3.SS1.p1.10.m7.3.3.2"><apply id="S3.SS1.p1.10.m7.2.2.1.1.cmml" xref="S3.SS1.p1.10.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m7.2.2.1.1.1.cmml" xref="S3.SS1.p1.10.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m7.2.2.1.1.2.cmml" xref="S3.SS1.p1.10.m7.2.2.1.1.2">𝛼</ci><cn id="S3.SS1.p1.10.m7.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.10.m7.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.10.m7.1.1.cmml" xref="S3.SS1.p1.10.m7.1.1">…</ci><apply id="S3.SS1.p1.10.m7.3.3.2.2.cmml" xref="S3.SS1.p1.10.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m7.3.3.2.2.1.cmml" xref="S3.SS1.p1.10.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m7.3.3.2.2.2.cmml" xref="S3.SS1.p1.10.m7.3.3.2.2.2">𝛼</ci><ci id="S3.SS1.p1.10.m7.3.3.2.2.3.cmml" xref="S3.SS1.p1.10.m7.3.3.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m7.3c">\alpha_{1},...,\alpha_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m7.3d">italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_α start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>. This process is called the forward diffusion process <math alttext="q(\mathbf{x}_{t}|\mathbf{x}_{t-1})" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m8.1"><semantics id="S3.SS1.p1.11.m8.1a"><mrow id="S3.SS1.p1.11.m8.1.1" xref="S3.SS1.p1.11.m8.1.1.cmml"><mi id="S3.SS1.p1.11.m8.1.1.3" xref="S3.SS1.p1.11.m8.1.1.3.cmml">q</mi><mo id="S3.SS1.p1.11.m8.1.1.2" xref="S3.SS1.p1.11.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.11.m8.1.1.1.1" xref="S3.SS1.p1.11.m8.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.11.m8.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.11.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.11.m8.1.1.1.1.1" xref="S3.SS1.p1.11.m8.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.11.m8.1.1.1.1.1.2" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.11.m8.1.1.1.1.1.2.2" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.11.m8.1.1.1.1.1.2.3" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS1.p1.11.m8.1.1.1.1.1.1" xref="S3.SS1.p1.11.m8.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS1.p1.11.m8.1.1.1.1.1.3" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m8.1.1.1.1.1.3.2" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.2" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.1" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.3" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS1.p1.11.m8.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.11.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m8.1b"><apply id="S3.SS1.p1.11.m8.1.1.cmml" xref="S3.SS1.p1.11.m8.1.1"><times id="S3.SS1.p1.11.m8.1.1.2.cmml" xref="S3.SS1.p1.11.m8.1.1.2"></times><ci id="S3.SS1.p1.11.m8.1.1.3.cmml" xref="S3.SS1.p1.11.m8.1.1.3">𝑞</ci><apply id="S3.SS1.p1.11.m8.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.11.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.11.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.11.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.11.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m8.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m8.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.2">𝐱</ci><apply id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3"><minus id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.1"></minus><ci id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m8.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m8.1c">q(\mathbf{x}_{t}|\mathbf{x}_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m8.1d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.
At the final time step, <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m9.1"><semantics id="S3.SS1.p1.12.m9.1a"><msub id="S3.SS1.p1.12.m9.1.1" xref="S3.SS1.p1.12.m9.1.1.cmml"><mi id="S3.SS1.p1.12.m9.1.1.2" xref="S3.SS1.p1.12.m9.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.12.m9.1.1.3" xref="S3.SS1.p1.12.m9.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m9.1b"><apply id="S3.SS1.p1.12.m9.1.1.cmml" xref="S3.SS1.p1.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m9.1.1.1.cmml" xref="S3.SS1.p1.12.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m9.1.1.2.cmml" xref="S3.SS1.p1.12.m9.1.1.2">𝐱</ci><ci id="S3.SS1.p1.12.m9.1.1.3.cmml" xref="S3.SS1.p1.12.m9.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m9.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m9.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> is assumed to be pure Gaussian noise: <math alttext="\mathbf{x}_{T}\sim\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m10.2"><semantics id="S3.SS1.p1.13.m10.2a"><mrow id="S3.SS1.p1.13.m10.2.3" xref="S3.SS1.p1.13.m10.2.3.cmml"><msub id="S3.SS1.p1.13.m10.2.3.2" xref="S3.SS1.p1.13.m10.2.3.2.cmml"><mi id="S3.SS1.p1.13.m10.2.3.2.2" xref="S3.SS1.p1.13.m10.2.3.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.13.m10.2.3.2.3" xref="S3.SS1.p1.13.m10.2.3.2.3.cmml">T</mi></msub><mo id="S3.SS1.p1.13.m10.2.3.1" xref="S3.SS1.p1.13.m10.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p1.13.m10.2.3.3" xref="S3.SS1.p1.13.m10.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m10.2.3.3.2" xref="S3.SS1.p1.13.m10.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS1.p1.13.m10.2.3.3.1" xref="S3.SS1.p1.13.m10.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.13.m10.2.3.3.3.2" xref="S3.SS1.p1.13.m10.2.3.3.3.1.cmml"><mo id="S3.SS1.p1.13.m10.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.13.m10.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p1.13.m10.1.1" xref="S3.SS1.p1.13.m10.1.1.cmml">0</mn><mo id="S3.SS1.p1.13.m10.2.3.3.3.2.2" xref="S3.SS1.p1.13.m10.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.13.m10.2.2" xref="S3.SS1.p1.13.m10.2.2.cmml">I</mi><mo id="S3.SS1.p1.13.m10.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p1.13.m10.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m10.2b"><apply id="S3.SS1.p1.13.m10.2.3.cmml" xref="S3.SS1.p1.13.m10.2.3"><csymbol cd="latexml" id="S3.SS1.p1.13.m10.2.3.1.cmml" xref="S3.SS1.p1.13.m10.2.3.1">similar-to</csymbol><apply id="S3.SS1.p1.13.m10.2.3.2.cmml" xref="S3.SS1.p1.13.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m10.2.3.2.1.cmml" xref="S3.SS1.p1.13.m10.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.13.m10.2.3.2.2.cmml" xref="S3.SS1.p1.13.m10.2.3.2.2">𝐱</ci><ci id="S3.SS1.p1.13.m10.2.3.2.3.cmml" xref="S3.SS1.p1.13.m10.2.3.2.3">𝑇</ci></apply><apply id="S3.SS1.p1.13.m10.2.3.3.cmml" xref="S3.SS1.p1.13.m10.2.3.3"><times id="S3.SS1.p1.13.m10.2.3.3.1.cmml" xref="S3.SS1.p1.13.m10.2.3.3.1"></times><ci id="S3.SS1.p1.13.m10.2.3.3.2.cmml" xref="S3.SS1.p1.13.m10.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS1.p1.13.m10.2.3.3.3.1.cmml" xref="S3.SS1.p1.13.m10.2.3.3.3.2"><cn id="S3.SS1.p1.13.m10.1.1.cmml" type="integer" xref="S3.SS1.p1.13.m10.1.1">0</cn><ci id="S3.SS1.p1.13.m10.2.2.cmml" xref="S3.SS1.p1.13.m10.2.2">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m10.2c">\mathbf{x}_{T}\sim\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m10.2d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , italic_I )</annotation></semantics></math>. The objective is to train a denoising network <math alttext="\hat{\mathbf{x}}_{\bm{\theta}}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m11.1"><semantics id="S3.SS1.p1.14.m11.1a"><msub id="S3.SS1.p1.14.m11.1.1" xref="S3.SS1.p1.14.m11.1.1.cmml"><mover accent="true" id="S3.SS1.p1.14.m11.1.1.2" xref="S3.SS1.p1.14.m11.1.1.2.cmml"><mi id="S3.SS1.p1.14.m11.1.1.2.2" xref="S3.SS1.p1.14.m11.1.1.2.2.cmml">𝐱</mi><mo id="S3.SS1.p1.14.m11.1.1.2.1" xref="S3.SS1.p1.14.m11.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.14.m11.1.1.3" xref="S3.SS1.p1.14.m11.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m11.1b"><apply id="S3.SS1.p1.14.m11.1.1.cmml" xref="S3.SS1.p1.14.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m11.1.1.1.cmml" xref="S3.SS1.p1.14.m11.1.1">subscript</csymbol><apply id="S3.SS1.p1.14.m11.1.1.2.cmml" xref="S3.SS1.p1.14.m11.1.1.2"><ci id="S3.SS1.p1.14.m11.1.1.2.1.cmml" xref="S3.SS1.p1.14.m11.1.1.2.1">^</ci><ci id="S3.SS1.p1.14.m11.1.1.2.2.cmml" xref="S3.SS1.p1.14.m11.1.1.2.2">𝐱</ci></apply><ci id="S3.SS1.p1.14.m11.1.1.3.cmml" xref="S3.SS1.p1.14.m11.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m11.1c">\hat{\mathbf{x}}_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m11.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> that is able to predict the original image from the noisy image <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m12.1"><semantics id="S3.SS1.p1.15.m12.1a"><msub id="S3.SS1.p1.15.m12.1.1" xref="S3.SS1.p1.15.m12.1.1.cmml"><mi id="S3.SS1.p1.15.m12.1.1.2" xref="S3.SS1.p1.15.m12.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.15.m12.1.1.3" xref="S3.SS1.p1.15.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m12.1b"><apply id="S3.SS1.p1.15.m12.1.1.cmml" xref="S3.SS1.p1.15.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m12.1.1.1.cmml" xref="S3.SS1.p1.15.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m12.1.1.2.cmml" xref="S3.SS1.p1.15.m12.1.1.2">𝐱</ci><ci id="S3.SS1.p1.15.m12.1.1.3.cmml" xref="S3.SS1.p1.15.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m12.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m12.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m13.1"><semantics id="S3.SS1.p1.16.m13.1a"><mi id="S3.SS1.p1.16.m13.1.1" xref="S3.SS1.p1.16.m13.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m13.1b"><ci id="S3.SS1.p1.16.m13.1.1.cmml" xref="S3.SS1.p1.16.m13.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m13.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m13.1d">italic_t</annotation></semantics></math>.
To sample a new image, we sample <math alttext="\mathbf{x}_{T}\sim\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m14.2"><semantics id="S3.SS1.p1.17.m14.2a"><mrow id="S3.SS1.p1.17.m14.2.3" xref="S3.SS1.p1.17.m14.2.3.cmml"><msub id="S3.SS1.p1.17.m14.2.3.2" xref="S3.SS1.p1.17.m14.2.3.2.cmml"><mi id="S3.SS1.p1.17.m14.2.3.2.2" xref="S3.SS1.p1.17.m14.2.3.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.17.m14.2.3.2.3" xref="S3.SS1.p1.17.m14.2.3.2.3.cmml">T</mi></msub><mo id="S3.SS1.p1.17.m14.2.3.1" xref="S3.SS1.p1.17.m14.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p1.17.m14.2.3.3" xref="S3.SS1.p1.17.m14.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.17.m14.2.3.3.2" xref="S3.SS1.p1.17.m14.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS1.p1.17.m14.2.3.3.1" xref="S3.SS1.p1.17.m14.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.17.m14.2.3.3.3.2" xref="S3.SS1.p1.17.m14.2.3.3.3.1.cmml"><mo id="S3.SS1.p1.17.m14.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.17.m14.2.3.3.3.1.cmml">(</mo><mn id="S3.SS1.p1.17.m14.1.1" xref="S3.SS1.p1.17.m14.1.1.cmml">0</mn><mo id="S3.SS1.p1.17.m14.2.3.3.3.2.2" xref="S3.SS1.p1.17.m14.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.17.m14.2.2" xref="S3.SS1.p1.17.m14.2.2.cmml">I</mi><mo id="S3.SS1.p1.17.m14.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p1.17.m14.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m14.2b"><apply id="S3.SS1.p1.17.m14.2.3.cmml" xref="S3.SS1.p1.17.m14.2.3"><csymbol cd="latexml" id="S3.SS1.p1.17.m14.2.3.1.cmml" xref="S3.SS1.p1.17.m14.2.3.1">similar-to</csymbol><apply id="S3.SS1.p1.17.m14.2.3.2.cmml" xref="S3.SS1.p1.17.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m14.2.3.2.1.cmml" xref="S3.SS1.p1.17.m14.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.17.m14.2.3.2.2.cmml" xref="S3.SS1.p1.17.m14.2.3.2.2">𝐱</ci><ci id="S3.SS1.p1.17.m14.2.3.2.3.cmml" xref="S3.SS1.p1.17.m14.2.3.2.3">𝑇</ci></apply><apply id="S3.SS1.p1.17.m14.2.3.3.cmml" xref="S3.SS1.p1.17.m14.2.3.3"><times id="S3.SS1.p1.17.m14.2.3.3.1.cmml" xref="S3.SS1.p1.17.m14.2.3.3.1"></times><ci id="S3.SS1.p1.17.m14.2.3.3.2.cmml" xref="S3.SS1.p1.17.m14.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS1.p1.17.m14.2.3.3.3.1.cmml" xref="S3.SS1.p1.17.m14.2.3.3.3.2"><cn id="S3.SS1.p1.17.m14.1.1.cmml" type="integer" xref="S3.SS1.p1.17.m14.1.1">0</cn><ci id="S3.SS1.p1.17.m14.2.2.cmml" xref="S3.SS1.p1.17.m14.2.2">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m14.2c">\mathbf{x}_{T}\sim\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m14.2d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , italic_I )</annotation></semantics></math> and iteratively denoise it, producing a sequence <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m15.1"><semantics id="S3.SS1.p1.18.m15.1a"><msub id="S3.SS1.p1.18.m15.1.1" xref="S3.SS1.p1.18.m15.1.1.cmml"><mi id="S3.SS1.p1.18.m15.1.1.2" xref="S3.SS1.p1.18.m15.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.18.m15.1.1.3" xref="S3.SS1.p1.18.m15.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m15.1b"><apply id="S3.SS1.p1.18.m15.1.1.cmml" xref="S3.SS1.p1.18.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m15.1.1.1.cmml" xref="S3.SS1.p1.18.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m15.1.1.2.cmml" xref="S3.SS1.p1.18.m15.1.1.2">𝐱</ci><ci id="S3.SS1.p1.18.m15.1.1.3.cmml" xref="S3.SS1.p1.18.m15.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m15.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m15.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{x}_{T-1}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m16.1"><semantics id="S3.SS1.p1.19.m16.1a"><msub id="S3.SS1.p1.19.m16.1.1" xref="S3.SS1.p1.19.m16.1.1.cmml"><mi id="S3.SS1.p1.19.m16.1.1.2" xref="S3.SS1.p1.19.m16.1.1.2.cmml">𝐱</mi><mrow id="S3.SS1.p1.19.m16.1.1.3" xref="S3.SS1.p1.19.m16.1.1.3.cmml"><mi id="S3.SS1.p1.19.m16.1.1.3.2" xref="S3.SS1.p1.19.m16.1.1.3.2.cmml">T</mi><mo id="S3.SS1.p1.19.m16.1.1.3.1" xref="S3.SS1.p1.19.m16.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.19.m16.1.1.3.3" xref="S3.SS1.p1.19.m16.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m16.1b"><apply id="S3.SS1.p1.19.m16.1.1.cmml" xref="S3.SS1.p1.19.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m16.1.1.1.cmml" xref="S3.SS1.p1.19.m16.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m16.1.1.2.cmml" xref="S3.SS1.p1.19.m16.1.1.2">𝐱</ci><apply id="S3.SS1.p1.19.m16.1.1.3.cmml" xref="S3.SS1.p1.19.m16.1.1.3"><minus id="S3.SS1.p1.19.m16.1.1.3.1.cmml" xref="S3.SS1.p1.19.m16.1.1.3.1"></minus><ci id="S3.SS1.p1.19.m16.1.1.3.2.cmml" xref="S3.SS1.p1.19.m16.1.1.3.2">𝑇</ci><cn id="S3.SS1.p1.19.m16.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.19.m16.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m16.1c">\mathbf{x}_{T-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m16.1d">bold_x start_POSTSUBSCRIPT italic_T - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="\mathbf{x}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.20.m17.1"><semantics id="S3.SS1.p1.20.m17.1a"><msub id="S3.SS1.p1.20.m17.1.1" xref="S3.SS1.p1.20.m17.1.1.cmml"><mi id="S3.SS1.p1.20.m17.1.1.2" xref="S3.SS1.p1.20.m17.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.20.m17.1.1.3" xref="S3.SS1.p1.20.m17.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m17.1b"><apply id="S3.SS1.p1.20.m17.1.1.cmml" xref="S3.SS1.p1.20.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m17.1.1.1.cmml" xref="S3.SS1.p1.20.m17.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m17.1.1.2.cmml" xref="S3.SS1.p1.20.m17.1.1.2">𝐱</ci><cn id="S3.SS1.p1.20.m17.1.1.3.cmml" type="integer" xref="S3.SS1.p1.20.m17.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m17.1c">\mathbf{x}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.20.m17.1d">bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.21.m18.1"><semantics id="S3.SS1.p1.21.m18.1a"><msub id="S3.SS1.p1.21.m18.1.1" xref="S3.SS1.p1.21.m18.1.1.cmml"><mi id="S3.SS1.p1.21.m18.1.1.2" xref="S3.SS1.p1.21.m18.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.21.m18.1.1.3" xref="S3.SS1.p1.21.m18.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m18.1b"><apply id="S3.SS1.p1.21.m18.1.1.cmml" xref="S3.SS1.p1.21.m18.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m18.1.1.1.cmml" xref="S3.SS1.p1.21.m18.1.1">subscript</csymbol><ci id="S3.SS1.p1.21.m18.1.1.2.cmml" xref="S3.SS1.p1.21.m18.1.1.2">𝐱</ci><cn id="S3.SS1.p1.21.m18.1.1.3.cmml" type="integer" xref="S3.SS1.p1.21.m18.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m18.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.21.m18.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.
The final image, <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.22.m19.1"><semantics id="S3.SS1.p1.22.m19.1a"><msub id="S3.SS1.p1.22.m19.1.1" xref="S3.SS1.p1.22.m19.1.1.cmml"><mi id="S3.SS1.p1.22.m19.1.1.2" xref="S3.SS1.p1.22.m19.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.22.m19.1.1.3" xref="S3.SS1.p1.22.m19.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m19.1b"><apply id="S3.SS1.p1.22.m19.1.1.cmml" xref="S3.SS1.p1.22.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m19.1.1.1.cmml" xref="S3.SS1.p1.22.m19.1.1">subscript</csymbol><ci id="S3.SS1.p1.22.m19.1.1.2.cmml" xref="S3.SS1.p1.22.m19.1.1.2">𝐱</ci><cn id="S3.SS1.p1.22.m19.1.1.3.cmml" type="integer" xref="S3.SS1.p1.22.m19.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m19.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.22.m19.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, should resemble the training data.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Although the naive diffusion models are powerful in generating images, they do not deliver the promise of generating face images of the same identity (i.e. identity preservation) without direct corresponding information;
nor are they aware of diverse desired facial attributes during inference. To achieve <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.1.1">intra-class diversity</em> and <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.1.2">intra-class identity preservation</em>, we would like to gain control of generating desired identities, each of which exhibits various attributes, including poses, ages and background variations. Hence, our aim is to design a diffusion model that conditions on specific identities and attributes throughout the generation of face images.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.SS2.1.m1.1"><semantics id="S3.SS2.1.m1.1b"><msup id="S3.SS2.1.m1.1.1" xref="S3.SS2.1.m1.1.1.cmml"><mtext id="S3.SS2.1.m1.1.1.2" xref="S3.SS2.1.m1.1.1.2a.cmml">ID</mtext><mn id="S3.SS2.1.m1.1.1.3" xref="S3.SS2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.1.m1.1c"><apply id="S3.SS2.1.m1.1.1.cmml" xref="S3.SS2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.1.m1.1.1.1.cmml" xref="S3.SS2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.1.m1.1.1.2a.cmml" xref="S3.SS2.1.m1.1.1.2"><mtext id="S3.SS2.1.m1.1.1.2.cmml" xref="S3.SS2.1.m1.1.1.2">ID</mtext></ci><cn id="S3.SS2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.m1.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.1.m1.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> as Conditional Diffusion Models</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">We propose a conditional diffusion model, ID<sup class="ltx_sup" id="S3.SS2.p1.3.1">3</sup> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S2.F1" title='Figure 1 ‣ 2 Problem Formulation ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">1</span></a> for details). Specifically, we extend the denoising network by conditioning it on two sources of signals: identity signals <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_y</annotation></semantics></math> and face attribute signals <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_s</annotation></semantics></math>. The identity signals capture discernible faces in generated images, whereas face attribute signals specify the identity-irrelevant attributes, including poses, ages, etc.
We introduce how to obtain these two conditioning signals, respectively, in the next two subsections.
</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Identity Conditioning Signal</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.11">To obtain identity conditioning signals, we assume access to a pretrained face recognition model <math alttext="f_{\bm{\phi}}:\mathbb{R}^{H\times W\times 3}\mapsto\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.1.m1.1.1.2.3" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.3.cmml">ϕ</mi></msub><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><msup id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.2.cmml">H</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1.cmml">×</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.3.cmml">W</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1.cmml">×</mo><mn id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.4" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.4.cmml">3</mn></mrow></msup><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">↦</mo><msup id="S3.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml">𝕊</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1">:</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.3">bold-italic-ϕ</ci></apply><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1">maps-to</csymbol><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3"><times id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.1"></times><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.2">𝐻</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.3">𝑊</ci><cn id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.4.cmml" type="integer" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.3.4">3</cn></apply></apply><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2">𝕊</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3"><minus id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.1"></minus><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">f_{\bm{\phi}}:\mathbb{R}^{H\times W\times 3}\mapsto\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT : blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT ↦ blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, which maps the domain of face images to a feature space <math alttext="\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msup id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝕊</mi><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝕊</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><minus id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1"></minus><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">𝑑</ci><cn id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. This mapping <math alttext="f_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><msub id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.3.m3.1.1.3" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">f_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is parameterized by the learnable parameter <math alttext="\bm{\phi}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.4.m4.1.1" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">\bm{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">bold_italic_ϕ</annotation></semantics></math>, which is obtained by training the model on a real face dataset in the face recognition task. We follow the latest advancement of face recognition by setting the output space to be a unit hypersphere <math alttext="\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msup id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">𝕊</mi><mrow id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">𝕊</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3"><minus id="S3.SS2.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.1"></minus><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2">𝑑</ci><cn id="S3.SS2.SSS1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, given a face image <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><msub id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml">𝐱</mi><mn id="S3.SS2.SSS1.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2">𝐱</ci><cn id="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> drawn from the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m7.1"><semantics id="S3.SS2.SSS1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.1b"><ci id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m7.1d">caligraphic_D</annotation></semantics></math>, we obtain its identity embedding <math alttext="\mathbf{y}\in\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.8.m8.1"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mrow id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p1.8.m8.1.1.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml">𝐲</mi><mo id="S3.SS2.SSS1.p1.8.m8.1.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.8.m8.1.1.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.8.m8.1.1.3.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.2.cmml">𝕊</mi><mrow id="S3.SS2.SSS1.p1.8.m8.1.1.3.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><apply id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1"><in id="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.1"></in><ci id="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.2">𝐲</ci><apply id="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.2">𝕊</ci><apply id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3"><minus id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.1"></minus><ci id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.2">𝑑</ci><cn id="S3.SS2.SSS1.p1.8.m8.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">\mathbf{y}\in\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m8.1d">bold_y ∈ blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> by feeding it into a face recognition model <math alttext="f_{\bm{\phi}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.9.m9.1"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><msub id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p1.9.m9.1.1.2" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.9.m9.1.1.3" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><apply id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">f_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.9.m9.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>: <math alttext="\mathbf{y}=f_{\bm{\phi}}(\mathbf{x}_{0})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.10.m10.1"><semantics id="S3.SS2.SSS1.p1.10.m10.1a"><mrow id="S3.SS2.SSS1.p1.10.m10.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml">𝐲</mi><mo id="S3.SS2.SSS1.p1.10.m10.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.10.m10.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.10.m10.1.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.3" mathvariant="bold-italic" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.SS2.SSS1.p1.10.m10.1.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.1b"><apply id="S3.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1"><eq id="S3.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2"></eq><ci id="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.3">𝐲</ci><apply id="S3.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1"><times id="S3.SS2.SSS1.p1.10.m10.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.2"></times><apply id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.2">𝐱</ci><cn id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.1c">\mathbf{y}=f_{\bm{\phi}}(\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.10.m10.1d">bold_y = italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>, which serves as the identity conditioning signals for ID<sup class="ltx_sup" id="S3.SS2.SSS1.p1.11.1">3</sup>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Face Attribute Conditioning Signal</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.3">Face attributes capture identity-irrelevant information about face images, such as age, face poses, etc. To obtain face attribute as conditioning signals, we employ pretrained attribute predictors <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Serengil and Ozpinar</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>)</cite> which output these attributes when given a face image as input. The pretrained attribute predictors are a collection of ad-hoc domain experts in age estimation and pose estimation. After obtaining each of these attribute values, <math alttext="\mathbf{s}_{\text{age}}\in[0,100]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.2"><semantics id="S3.SS2.SSS2.p1.1.m1.2a"><mrow id="S3.SS2.SSS2.p1.1.m1.2.3" xref="S3.SS2.SSS2.p1.1.m1.2.3.cmml"><msub id="S3.SS2.SSS2.p1.1.m1.2.3.2" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.2.3.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.2.cmml">𝐬</mi><mtext id="S3.SS2.SSS2.p1.1.m1.2.3.2.3" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.3a.cmml">age</mtext></msub><mo id="S3.SS2.SSS2.p1.1.m1.2.3.1" xref="S3.SS2.SSS2.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS2.SSS2.p1.1.m1.2.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS2.SSS2.p1.1.m1.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.cmml">100</mn><mo id="S3.SS2.SSS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.2b"><apply id="S3.SS2.SSS2.p1.1.m1.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3"><in id="S3.SS2.SSS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.1"></in><apply id="S3.SS2.SSS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.2">𝐬</ci><ci id="S3.SS2.SSS2.p1.1.m1.2.3.2.3a.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.3"><mtext id="S3.SS2.SSS2.p1.1.m1.2.3.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.1.m1.2.3.2.3">age</mtext></ci></apply><interval closure="closed" id="S3.SS2.SSS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.3.3.2"><cn id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS2.p1.1.m1.1.1">0</cn><cn id="S3.SS2.SSS2.p1.1.m1.2.2.cmml" type="integer" xref="S3.SS2.SSS2.p1.1.m1.2.2">100</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.2c">\mathbf{s}_{\text{age}}\in[0,100]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.2d">bold_s start_POSTSUBSCRIPT age end_POSTSUBSCRIPT ∈ [ 0 , 100 ]</annotation></semantics></math>, <math alttext="\mathbf{s}_{\text{pose}}\in[-90^{\circ},90^{\circ}]^{3}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.2"><semantics id="S3.SS2.SSS2.p1.2.m2.2a"><mrow id="S3.SS2.SSS2.p1.2.m2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.cmml"><msub id="S3.SS2.SSS2.p1.2.m2.2.2.4" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.2.2.4.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.2.cmml">𝐬</mi><mtext id="S3.SS2.SSS2.p1.2.m2.2.2.4.3" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.3a.cmml">pose</mtext></msub><mo id="S3.SS2.SSS2.p1.2.m2.2.2.3" xref="S3.SS2.SSS2.p1.2.m2.2.2.3.cmml">∈</mo><msup id="S3.SS2.SSS2.p1.2.m2.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.cmml"><mrow id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.3.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.3.cmml">[</mo><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1a" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml">−</mo><msup id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml"><mn id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.2.cmml">90</mn><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.3.cmml">∘</mo></msup></mrow><mo id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.4" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.3.cmml">,</mo><msup id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.cmml"><mn id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.2.cmml">90</mn><mo id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.3.cmml">∘</mo></msup><mo id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.3.cmml">]</mo></mrow><mn id="S3.SS2.SSS2.p1.2.m2.2.2.2.4" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.4.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.2b"><apply id="S3.SS2.SSS2.p1.2.m2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2"><in id="S3.SS2.SSS2.p1.2.m2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.3"></in><apply id="S3.SS2.SSS2.p1.2.m2.2.2.4.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.2.4.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.2.2.4.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.2">𝐬</ci><ci id="S3.SS2.SSS2.p1.2.m2.2.2.4.3a.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.3"><mtext id="S3.SS2.SSS2.p1.2.m2.2.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.2.m2.2.2.4.3">pose</mtext></ci></apply><apply id="S3.SS2.SSS2.p1.2.m2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2">superscript</csymbol><interval closure="closed" id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1"><minus id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1"></minus><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2">superscript</csymbol><cn id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.2">90</cn><compose id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.3"></compose></apply></apply><apply id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2">superscript</csymbol><cn id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.2.cmml" type="integer" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.2">90</cn><compose id="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.2.2.2.3"></compose></apply></interval><cn id="S3.SS2.SSS2.p1.2.m2.2.2.2.4.cmml" type="integer" xref="S3.SS2.SSS2.p1.2.m2.2.2.2.4">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.2c">\mathbf{s}_{\text{pose}}\in[-90^{\circ},90^{\circ}]^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.2d">bold_s start_POSTSUBSCRIPT pose end_POSTSUBSCRIPT ∈ [ - 90 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT , 90 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, we concatenate them as the overall attribute <math alttext="\mathbf{s}=[\mathbf{s}_{\text{age}},\mathbf{s}_{\text{pose}}]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.2"><semantics id="S3.SS2.SSS2.p1.3.m3.2a"><mrow id="S3.SS2.SSS2.p1.3.m3.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.2.2.4" xref="S3.SS2.SSS2.p1.3.m3.2.2.4.cmml">𝐬</mi><mo id="S3.SS2.SSS2.p1.3.m3.2.2.3" xref="S3.SS2.SSS2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml"><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">[</mo><msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml">𝐬</mi><mtext id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml">age</mtext></msub><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.4" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2.cmml">𝐬</mi><mtext id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3a.cmml">pose</mtext></msub><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.2b"><apply id="S3.SS2.SSS2.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2"><eq id="S3.SS2.SSS2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.3"></eq><ci id="S3.SS2.SSS2.p1.3.m3.2.2.4.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.4">𝐬</ci><interval closure="closed" id="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2">𝐬</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3">age</mtext></ci></apply><apply id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2">𝐬</ci><ci id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3a.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3"><mtext id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3">pose</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.2c">\mathbf{s}=[\mathbf{s}_{\text{age}},\mathbf{s}_{\text{pose}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.2d">bold_s = [ bold_s start_POSTSUBSCRIPT age end_POSTSUBSCRIPT , bold_s start_POSTSUBSCRIPT pose end_POSTSUBSCRIPT ]</annotation></semantics></math> which is then fed into the diffusion model as conditioning signals.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Optimization Objective</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.8">Now the denoising network in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E1" title='Equation 1 ‣ 3.1 Diffusion Models ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">1</span></a>) becomes <math alttext="\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t,\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.4"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.4" xref="S3.SS3.p1.1.m1.4.4.cmml"><msub id="S3.SS3.p1.1.m1.4.4.3" xref="S3.SS3.p1.1.m1.4.4.3.cmml"><mover accent="true" id="S3.SS3.p1.1.m1.4.4.3.2" xref="S3.SS3.p1.1.m1.4.4.3.2.cmml"><mi id="S3.SS3.p1.1.m1.4.4.3.2.2" xref="S3.SS3.p1.1.m1.4.4.3.2.2.cmml">𝐱</mi><mo id="S3.SS3.p1.1.m1.4.4.3.2.1" xref="S3.SS3.p1.1.m1.4.4.3.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.1.m1.4.4.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.cmml">𝜽</mi></msub><mo id="S3.SS3.p1.1.m1.4.4.2" xref="S3.SS3.p1.1.m1.4.4.2.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.4.4.1.1" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml"><mo id="S3.SS3.p1.1.m1.4.4.1.1.2" stretchy="false" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml">(</mo><msub id="S3.SS3.p1.1.m1.4.4.1.1.1" xref="S3.SS3.p1.1.m1.4.4.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.4.4.1.1.1.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p1.1.m1.4.4.1.1.1.3" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.1.m1.4.4.1.1.3" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml">,</mo><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">t</mi><mo id="S3.SS3.p1.1.m1.4.4.1.1.4" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml">,</mo><mi id="S3.SS3.p1.1.m1.2.2" xref="S3.SS3.p1.1.m1.2.2.cmml">𝐲</mi><mo id="S3.SS3.p1.1.m1.4.4.1.1.5" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml">,</mo><mi id="S3.SS3.p1.1.m1.3.3" xref="S3.SS3.p1.1.m1.3.3.cmml">𝐬</mi><mo id="S3.SS3.p1.1.m1.4.4.1.1.6" stretchy="false" xref="S3.SS3.p1.1.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4"><times id="S3.SS3.p1.1.m1.4.4.2.cmml" xref="S3.SS3.p1.1.m1.4.4.2"></times><apply id="S3.SS3.p1.1.m1.4.4.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3">subscript</csymbol><apply id="S3.SS3.p1.1.m1.4.4.3.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.2"><ci id="S3.SS3.p1.1.m1.4.4.3.2.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.2.1">^</ci><ci id="S3.SS3.p1.1.m1.4.4.3.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.2.2">𝐱</ci></apply><ci id="S3.SS3.p1.1.m1.4.4.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3">𝜽</ci></apply><vector id="S3.SS3.p1.1.m1.4.4.1.2.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1"><apply id="S3.SS3.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2">𝐱</ci><ci id="S3.SS3.p1.1.m1.4.4.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3">𝑡</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑡</ci><ci id="S3.SS3.p1.1.m1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2">𝐲</ci><ci id="S3.SS3.p1.1.m1.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3">𝐬</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t,\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.4d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , bold_y , bold_s )</annotation></semantics></math> that takes as input the noised <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝐱</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_t</annotation></semantics></math>, and the conditioning signals <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">bold_y</annotation></semantics></math> and <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">bold_s</annotation></semantics></math>. To optimize <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><msup id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mtext id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2a.cmml">ID</mtext><mn id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2a.cmml" xref="S3.SS3.p1.6.m6.1.1.2"><mtext id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">ID</mtext></ci><cn id="S3.SS3.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.p1.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, we construct a training objective upon the ELBO of <math alttext="\log p(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.3"><semantics id="S3.SS3.p1.7.m7.3a"><mrow id="S3.SS3.p1.7.m7.3.3" xref="S3.SS3.p1.7.m7.3.3.cmml"><mrow id="S3.SS3.p1.7.m7.3.3.3" xref="S3.SS3.p1.7.m7.3.3.3.cmml"><mi id="S3.SS3.p1.7.m7.3.3.3.1" xref="S3.SS3.p1.7.m7.3.3.3.1.cmml">log</mi><mo id="S3.SS3.p1.7.m7.3.3.3a" lspace="0.167em" xref="S3.SS3.p1.7.m7.3.3.3.cmml">⁡</mo><mi id="S3.SS3.p1.7.m7.3.3.3.2" xref="S3.SS3.p1.7.m7.3.3.3.2.cmml">p</mi></mrow><mo id="S3.SS3.p1.7.m7.3.3.2" xref="S3.SS3.p1.7.m7.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.p1.7.m7.3.3.1.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.cmml"><mo id="S3.SS3.p1.7.m7.3.3.1.1.2" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.7.m7.3.3.1.1.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.7.m7.3.3.1.1.1.2" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.SS3.p1.7.m7.3.3.1.1.1.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p1.7.m7.3.3.1.1.1.3.2" xref="S3.SS3.p1.7.m7.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">𝐲</mi><mo id="S3.SS3.p1.7.m7.3.3.1.1.1.3.2.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p1.7.m7.2.2" xref="S3.SS3.p1.7.m7.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS3.p1.7.m7.3.3.1.1.3" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.3b"><apply id="S3.SS3.p1.7.m7.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3"><times id="S3.SS3.p1.7.m7.3.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2"></times><apply id="S3.SS3.p1.7.m7.3.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3.3"><log id="S3.SS3.p1.7.m7.3.3.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.3.1"></log><ci id="S3.SS3.p1.7.m7.3.3.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.3.2">𝑝</ci></apply><apply id="S3.SS3.p1.7.m7.3.3.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2">𝐱</ci><list id="S3.SS3.p1.7.m7.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.3.2"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝐲</ci><ci id="S3.SS3.p1.7.m7.2.2.cmml" xref="S3.SS3.p1.7.m7.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.3c">\log p(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.3d">roman_log italic_p ( bold_x | bold_y , bold_s )</annotation></semantics></math>, ensuring that <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><msup id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mtext id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2a.cmml">ID</mtext><mn id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2a.cmml" xref="S3.SS3.p1.8.m8.1.1.2"><mtext id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">ID</mtext></ci><cn id="S3.SS3.p1.8.m8.1.1.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> generates identity-preserving yet diversified faces:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\bm{\theta}}\mathbb{E}_{(\mathbf{x}_{0},\mathbf{y},\mathbf{s})\sim%
\mathcal{D}^{\prime}}\bigg{[}\mathcal{L}_{\bm{\theta},\bm{\phi}}(\mathbf{x}_{0%
},\mathbf{y},\mathbf{s})\bigg{]}" class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.8.8.3" xref="S3.E2.m1.8.8.3.cmml"><munder id="S3.E2.m1.8.8.3.1" xref="S3.E2.m1.8.8.3.1.cmml"><mi id="S3.E2.m1.8.8.3.1.2" xref="S3.E2.m1.8.8.3.1.2.cmml">min</mi><mi id="S3.E2.m1.8.8.3.1.3" xref="S3.E2.m1.8.8.3.1.3.cmml">𝜽</mi></munder><mo id="S3.E2.m1.8.8.3a" lspace="0.167em" xref="S3.E2.m1.8.8.3.cmml">⁡</mo><msub id="S3.E2.m1.8.8.3.2" xref="S3.E2.m1.8.8.3.2.cmml"><mi id="S3.E2.m1.8.8.3.2.2" xref="S3.E2.m1.8.8.3.2.2.cmml">𝔼</mi><mrow id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mrow id="S3.E2.m1.3.3.3.3.1" xref="S3.E2.m1.3.3.3.3.2.cmml"><mo id="S3.E2.m1.3.3.3.3.1.2" stretchy="false" xref="S3.E2.m1.3.3.3.3.2.cmml">(</mo><msub id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.2" xref="S3.E2.m1.3.3.3.3.1.1.2.cmml">𝐱</mi><mn id="S3.E2.m1.3.3.3.3.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.3.3.3.3.1.3" xref="S3.E2.m1.3.3.3.3.2.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝐲</mi><mo id="S3.E2.m1.3.3.3.3.1.4" xref="S3.E2.m1.3.3.3.3.2.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">𝐬</mi><mo id="S3.E2.m1.3.3.3.3.1.5" stretchy="false" xref="S3.E2.m1.3.3.3.3.2.cmml">)</mo></mrow><mo id="S3.E2.m1.3.3.3.4" xref="S3.E2.m1.3.3.3.4.cmml">∼</mo><msup id="S3.E2.m1.3.3.3.5" xref="S3.E2.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.3.5.2" xref="S3.E2.m1.3.3.3.5.2.cmml">𝒟</mi><mo id="S3.E2.m1.3.3.3.5.3" xref="S3.E2.m1.3.3.3.5.3.cmml">′</mo></msup></mrow></msub></mrow><mo id="S3.E2.m1.8.8.2" xref="S3.E2.m1.8.8.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1" xref="S3.E2.m1.8.8.1.2.cmml"><mo id="S3.E2.m1.8.8.1.1.2" maxsize="210%" minsize="210%" xref="S3.E2.m1.8.8.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.8.8.1.1.1" xref="S3.E2.m1.8.8.1.1.1.cmml"><msub id="S3.E2.m1.8.8.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.8.8.1.1.1.3.2" xref="S3.E2.m1.8.8.1.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E2.m1.5.5.2.4" xref="S3.E2.m1.5.5.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">𝜽</mi><mo id="S3.E2.m1.5.5.2.4.1" xref="S3.E2.m1.5.5.2.3.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E2.m1.5.5.2.2" mathvariant="bold-italic" xref="S3.E2.m1.5.5.2.2.cmml">ϕ</mi></mrow></msub><mo id="S3.E2.m1.8.8.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.8.8.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.E2.m1.8.8.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.8.8.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">𝐲</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.4" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">𝐬</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.5" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.3" maxsize="210%" minsize="210%" xref="S3.E2.m1.8.8.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><times id="S3.E2.m1.8.8.2.cmml" xref="S3.E2.m1.8.8.2"></times><apply id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.3"><apply id="S3.E2.m1.8.8.3.1.cmml" xref="S3.E2.m1.8.8.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3.1.1.cmml" xref="S3.E2.m1.8.8.3.1">subscript</csymbol><min id="S3.E2.m1.8.8.3.1.2.cmml" xref="S3.E2.m1.8.8.3.1.2"></min><ci id="S3.E2.m1.8.8.3.1.3.cmml" xref="S3.E2.m1.8.8.3.1.3">𝜽</ci></apply><apply id="S3.E2.m1.8.8.3.2.cmml" xref="S3.E2.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3.2.1.cmml" xref="S3.E2.m1.8.8.3.2">subscript</csymbol><ci id="S3.E2.m1.8.8.3.2.2.cmml" xref="S3.E2.m1.8.8.3.2.2">𝔼</ci><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.4">similar-to</csymbol><vector id="S3.E2.m1.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.1"><apply id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2">𝐱</ci><cn id="S3.E2.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S3.E2.m1.3.3.3.3.1.1.3">0</cn></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝐲</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝐬</ci></vector><apply id="S3.E2.m1.3.3.3.5.cmml" xref="S3.E2.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.5.1.cmml" xref="S3.E2.m1.3.3.3.5">superscript</csymbol><ci id="S3.E2.m1.3.3.3.5.2.cmml" xref="S3.E2.m1.3.3.3.5.2">𝒟</ci><ci id="S3.E2.m1.3.3.3.5.3.cmml" xref="S3.E2.m1.3.3.3.5.3">′</ci></apply></apply></apply></apply><apply id="S3.E2.m1.8.8.1.2.cmml" xref="S3.E2.m1.8.8.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.8.8.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1"><times id="S3.E2.m1.8.8.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.2"></times><apply id="S3.E2.m1.8.8.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.3.2">ℒ</ci><list id="S3.E2.m1.5.5.2.3.cmml" xref="S3.E2.m1.5.5.2.4"><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝜽</ci><ci id="S3.E2.m1.5.5.2.2.cmml" xref="S3.E2.m1.5.5.2.2">bold-italic-ϕ</ci></list></apply><vector id="S3.E2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1"><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2">𝐱</ci><cn id="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝐲</ci><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝐬</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\min_{\bm{\theta}}\mathbb{E}_{(\mathbf{x}_{0},\mathbf{y},\mathbf{s})\sim%
\mathcal{D}^{\prime}}\bigg{[}\mathcal{L}_{\bm{\theta},\bm{\phi}}(\mathbf{x}_{0%
},\mathbf{y},\mathbf{s})\bigg{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">roman_min start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) ∼ caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ caligraphic_L start_POSTSUBSCRIPT bold_italic_θ , bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.9">Here, <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m1.1"><semantics id="S3.SS3.p1.9.m1.1a"><mi id="S3.SS3.p1.9.m1.1.1" xref="S3.SS3.p1.9.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m1.1b"><ci id="S3.SS3.p1.9.m1.1.1.cmml" xref="S3.SS3.p1.9.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m1.1d">bold_italic_θ</annotation></semantics></math> is the learnable parameter of the denoising network and the datapoint-wise loss is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{\bm{\theta},\bm{\phi}}(\mathbf{x}_{0},\mathbf{y},%
\mathbf{s})\\
=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}-\underbrace{\lambda_{t}\kappa_{\mathbf{x}_{0}}\mathbf{y}^{T}f%
_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term%
}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[\underbrace{%
\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}\right\rVert_{2%
}^{2}}_{\text{one-step reconstruction term}}\right]+C\end{split}" class="ltx_Math" display="block" id="S3.E3.m1.35"><semantics id="S3.E3.m1.35a"><mtable displaystyle="true" id="S3.E3.m1.35.35.6" rowspacing="0pt" xref="S3.E3.m1.32.32.3.cmml"><mtr id="S3.E3.m1.35.35.6a" xref="S3.E3.m1.32.32.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.35.35.6b" xref="S3.E3.m1.32.32.3.cmml"><mrow id="S3.E3.m1.33.33.4.30.11.11" xref="S3.E3.m1.32.32.3.cmml"><msub id="S3.E3.m1.33.33.4.30.11.11.13" xref="S3.E3.m1.32.32.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">ℒ</mi><mrow id="S3.E3.m1.2.2.2.2.2.2.1.4" xref="S3.E3.m1.2.2.2.2.2.2.1.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.2.2.1.1.cmml">𝜽</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.4.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E3.m1.2.2.2.2.2.2.1.2" mathvariant="bold-italic" xref="S3.E3.m1.2.2.2.2.2.2.1.2.cmml">ϕ</mi></mrow></msub><mo id="S3.E3.m1.33.33.4.30.11.11.12" xref="S3.E3.m1.32.32.3.cmml">⁢</mo><mrow id="S3.E3.m1.33.33.4.30.11.11.11.1" xref="S3.E3.m1.32.32.3.cmml"><mo id="S3.E3.m1.3.3.3.3.3.3" stretchy="false" xref="S3.E3.m1.32.32.3.cmml">(</mo><msub id="S3.E3.m1.33.33.4.30.11.11.11.1.1" xref="S3.E3.m1.32.32.3.cmml"><mi id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml">𝐱</mi><mn id="S3.E3.m1.5.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml">0</mn></msub><mo id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.32.32.3.cmml">,</mo><mi id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.7.7.7.7.7.7.cmml">𝐲</mi><mo id="S3.E3.m1.8.8.8.8.8.8" xref="S3.E3.m1.32.32.3.cmml">,</mo><mi id="S3.E3.m1.9.9.9.9.9.9" xref="S3.E3.m1.9.9.9.9.9.9.cmml">𝐬</mi><mo id="S3.E3.m1.10.10.10.10.10.10" stretchy="false" xref="S3.E3.m1.32.32.3.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.35.35.6c" xref="S3.E3.m1.32.32.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.35.35.6d" xref="S3.E3.m1.32.32.3.cmml"><mrow id="S3.E3.m1.35.35.6.32.21.21" xref="S3.E3.m1.32.32.3.cmml"><mi id="S3.E3.m1.35.35.6.32.21.21.22" xref="S3.E3.m1.32.32.3.cmml"></mi><mo id="S3.E3.m1.11.11.11.1.1.1" xref="S3.E3.m1.11.11.11.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.35.35.6.32.21.21.21" xref="S3.E3.m1.32.32.3.cmml"><mrow id="S3.E3.m1.34.34.5.31.20.20.20.1" xref="S3.E3.m1.32.32.3.cmml"><msub id="S3.E3.m1.34.34.5.31.20.20.20.1.3" xref="S3.E3.m1.32.32.3.cmml"><mi id="S3.E3.m1.12.12.12.2.2.2" xref="S3.E3.m1.12.12.12.2.2.2.cmml">𝔼</mi><mrow id="S3.E3.m1.13.13.13.3.3.3.1" xref="S3.E3.m1.13.13.13.3.3.3.1.cmml"><mi id="S3.E3.m1.13.13.13.3.3.3.1.4" xref="S3.E3.m1.13.13.13.3.3.3.1.4.cmml">t</mi><mo id="S3.E3.m1.13.13.13.3.3.3.1.3" xref="S3.E3.m1.13.13.13.3.3.3.1.3.cmml">∼</mo><mrow id="S3.E3.m1.13.13.13.3.3.3.1.5" xref="S3.E3.m1.13.13.13.3.3.3.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.13.13.13.3.3.3.1.5.2" xref="S3.E3.m1.13.13.13.3.3.3.1.5.2.cmml">𝒰</mi><mo id="S3.E3.m1.13.13.13.3.3.3.1.5.1" xref="S3.E3.m1.13.13.13.3.3.3.1.5.1.cmml">⁢</mo><mrow id="S3.E3.m1.13.13.13.3.3.3.1.5.3.2" xref="S3.E3.m1.13.13.13.3.3.3.1.5.3.1.cmml"><mo id="S3.E3.m1.13.13.13.3.3.3.1.5.3.2.1" stretchy="false" xref="S3.E3.m1.13.13.13.3.3.3.1.5.3.1.cmml">[</mo><mn id="S3.E3.m1.13.13.13.3.3.3.1.1" xref="S3.E3.m1.13.13.13.3.3.3.1.1.cmml">2</mn><mo id="S3.E3.m1.13.13.13.3.3.3.1.5.3.2.2" xref="S3.E3.m1.13.13.13.3.3.3.1.5.3.1.cmml">,</mo><mi id="S3.E3.m1.13.13.13.3.3.3.1.2" xref="S3.E3.m1.13.13.13.3.3.3.1.2.cmml">T</mi><mo id="S3.E3.m1.13.13.13.3.3.3.1.5.3.2.3" stretchy="false" xref="S3.E3.m1.13.13.13.3.3.3.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="S3.E3.m1.34.34.5.31.20.20.20.1.2" xref="S3.E3.m1.32.32.3.cmml">⁢</mo><mrow id="S3.E3.m1.34.34.5.31.20.20.20.1.1.1" xref="S3.E3.m1.32.32.3.cmml"><mo id="S3.E3.m1.14.14.14.4.4.4" maxsize="210%" minsize="210%" xref="S3.E3.m1.32.32.3.cmml">[</mo><mrow id="S3.E3.m1.34.34.5.31.20.20.20.1.1.1.1" xref="S3.E3.m1.32.32.3.cmml"><munder id="S3.E3.m1.34.34.5.31.20.20.20.1.1.1.1.1" xref="S3.E3.m1.32.32.3.cmml"><munder accentunder="true" id="S3.E3.m1.15.15.15.5.5.5" xref="S3.E3.m1.15.15.15.5.5.5.cmml"><mrow id="S3.E3.m1.15.15.15.5.5.5.2" xref="S3.E3.m1.15.15.15.5.5.5.2.cmml"><msub id="S3.E3.m1.15.15.15.5.5.5.2.4" xref="S3.E3.m1.15.15.15.5.5.5.2.4.cmml"><mi id="S3.E3.m1.15.15.15.5.5.5.2.4.2" xref="S3.E3.m1.15.15.15.5.5.5.2.4.2.cmml">μ</mi><mi id="S3.E3.m1.15.15.15.5.5.5.2.4.3" xref="S3.E3.m1.15.15.15.5.5.5.2.4.3.cmml">t</mi></msub><mo id="S3.E3.m1.15.15.15.5.5.5.2.3" lspace="0em" xref="S3.E3.m1.15.15.15.5.5.5.2.3.cmml">⁢</mo><msubsup id="S3.E3.m1.15.15.15.5.5.5.2.2" xref="S3.E3.m1.15.15.15.5.5.5.2.2.cmml"><mrow id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.2.cmml"><mo fence="true" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.2.1.cmml">∥</mo><mrow id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.cmml"><msub id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.2" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.1" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.cmml"><mi id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.2" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.1" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="S3.E3.m1.15.15.15.5.5.5.1.1.1.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.cmml"><mo id="S3.E3.m1.15.15.15.5.5.5.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.cmml">(</mo><mi id="S3.E3.m1.15.15.15.5.5.5.1.1.1.1" xref="S3.E3.m1.15.15.15.5.5.5.1.1.1.1.cmml">t</mi><mo id="S3.E3.m1.15.15.15.5.5.5.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.3.cmml">2</mn><mn id="S3.E3.m1.15.15.15.5.5.5.2.2.3" xref="S3.E3.m1.15.15.15.5.5.5.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E3.m1.15.15.15.5.5.5.3" xref="S3.E3.m1.15.15.15.5.5.5.3.cmml">⏟</mo></munder><mtext id="S3.E3.m1.16.16.16.6.6.6.1" xref="S3.E3.m1.16.16.16.6.6.6.1a.cmml">denoising term</mtext></munder><mo id="S3.E3.m1.17.17.17.7.7.7" xref="S3.E3.m1.17.17.17.7.7.7.cmml">−</mo><munder id="S3.E3.m1.34.34.5.31.20.20.20.1.1.1.1.2" xref="S3.E3.m1.32.32.3.cmml"><munder accentunder="true" id="S3.E3.m1.18.18.18.8.8.8" xref="S3.E3.m1.18.18.18.8.8.8.cmml"><mrow id="S3.E3.m1.18.18.18.8.8.8.2" xref="S3.E3.m1.18.18.18.8.8.8.2.cmml"><msub id="S3.E3.m1.18.18.18.8.8.8.2.4" xref="S3.E3.m1.18.18.18.8.8.8.2.4.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.4.2" xref="S3.E3.m1.18.18.18.8.8.8.2.4.2.cmml">λ</mi><mi id="S3.E3.m1.18.18.18.8.8.8.2.4.3" xref="S3.E3.m1.18.18.18.8.8.8.2.4.3.cmml">t</mi></msub><mo id="S3.E3.m1.18.18.18.8.8.8.2.3" xref="S3.E3.m1.18.18.18.8.8.8.2.3.cmml">⁢</mo><msub id="S3.E3.m1.18.18.18.8.8.8.2.5" xref="S3.E3.m1.18.18.18.8.8.8.2.5.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.5.2" xref="S3.E3.m1.18.18.18.8.8.8.2.5.2.cmml">κ</mi><msub id="S3.E3.m1.18.18.18.8.8.8.2.5.3" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.5.3.2" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3.2.cmml">𝐱</mi><mn id="S3.E3.m1.18.18.18.8.8.8.2.5.3.3" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3.3.cmml">0</mn></msub></msub><mo id="S3.E3.m1.18.18.18.8.8.8.2.3a" xref="S3.E3.m1.18.18.18.8.8.8.2.3.cmml">⁢</mo><msup id="S3.E3.m1.18.18.18.8.8.8.2.6" xref="S3.E3.m1.18.18.18.8.8.8.2.6.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.6.2" xref="S3.E3.m1.18.18.18.8.8.8.2.6.2.cmml">𝐲</mi><mi id="S3.E3.m1.18.18.18.8.8.8.2.6.3" xref="S3.E3.m1.18.18.18.8.8.8.2.6.3.cmml">T</mi></msup><mo id="S3.E3.m1.18.18.18.8.8.8.2.3b" xref="S3.E3.m1.18.18.18.8.8.8.2.3.cmml">⁢</mo><msub id="S3.E3.m1.18.18.18.8.8.8.2.7" xref="S3.E3.m1.18.18.18.8.8.8.2.7.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.7.2" xref="S3.E3.m1.18.18.18.8.8.8.2.7.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.E3.m1.18.18.18.8.8.8.2.7.3" mathvariant="bold-italic" xref="S3.E3.m1.18.18.18.8.8.8.2.7.3.cmml">ϕ</mi></msub><mo id="S3.E3.m1.18.18.18.8.8.8.2.3c" xref="S3.E3.m1.18.18.18.8.8.8.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.18.18.18.8.8.8.2.2.1" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml"><mo id="S3.E3.m1.18.18.18.8.8.8.2.2.1.2" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml">(</mo><msubsup id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml"><mover accent="true" id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.cmml"><mi id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.2" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.1" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.3" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.3.cmml">0</mn><mrow id="S3.E3.m1.18.18.18.8.8.8.1.1.1.3" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml"><mo id="S3.E3.m1.18.18.18.8.8.8.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml">(</mo><mi id="S3.E3.m1.18.18.18.8.8.8.1.1.1.1" xref="S3.E3.m1.18.18.18.8.8.8.1.1.1.1.cmml">t</mi><mo id="S3.E3.m1.18.18.18.8.8.8.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.18.18.18.8.8.8.2.2.1.3" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.18.18.18.8.8.8.3" xref="S3.E3.m1.18.18.18.8.8.8.3.cmml">⏟</mo></munder><mtext id="S3.E3.m1.19.19.19.9.9.9.1" xref="S3.E3.m1.19.19.19.9.9.9.1a.cmml">inner-product term</mtext></munder></mrow><mo id="S3.E3.m1.20.20.20.10.10.10" maxsize="210%" minsize="210%" xref="S3.E3.m1.32.32.3.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.21.21.21.11.11.11" xref="S3.E3.m1.21.21.21.11.11.11.cmml">+</mo><mrow id="S3.E3.m1.35.35.6.32.21.21.21.2" xref="S3.E3.m1.32.32.3.cmml"><msub id="S3.E3.m1.35.35.6.32.21.21.21.2.3" xref="S3.E3.m1.32.32.3.cmml"><mi id="S3.E3.m1.22.22.22.12.12.12" xref="S3.E3.m1.22.22.22.12.12.12.cmml">𝔼</mi><mrow id="S3.E3.m1.23.23.23.13.13.13.1" xref="S3.E3.m1.23.23.23.13.13.13.1.cmml"><mi id="S3.E3.m1.23.23.23.13.13.13.1.3" xref="S3.E3.m1.23.23.23.13.13.13.1.3.cmml">q</mi><mo id="S3.E3.m1.23.23.23.13.13.13.1.2" xref="S3.E3.m1.23.23.23.13.13.13.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.23.23.23.13.13.13.1.1.1" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.cmml"><mo id="S3.E3.m1.23.23.23.13.13.13.1.1.1.2" stretchy="false" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.cmml"><msub id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.cmml"><mi id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.2" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.3" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.1" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.1.cmml">|</mo><msub id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.cmml"><mi id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.2" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.3" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E3.m1.23.23.23.13.13.13.1.1.1.3" stretchy="false" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E3.m1.35.35.6.32.21.21.21.2.2" xref="S3.E3.m1.32.32.3.cmml">⁢</mo><mrow id="S3.E3.m1.35.35.6.32.21.21.21.2.1.1" xref="S3.E3.m1.32.32.3.cmml"><mo id="S3.E3.m1.24.24.24.14.14.14" xref="S3.E3.m1.32.32.3.cmml">[</mo><munder id="S3.E3.m1.35.35.6.32.21.21.21.2.1.1.1" xref="S3.E3.m1.32.32.3.cmml"><munder accentunder="true" id="S3.E3.m1.25.25.25.15.15.15" xref="S3.E3.m1.25.25.25.15.15.15.cmml"><mrow id="S3.E3.m1.25.25.25.15.15.15.2" xref="S3.E3.m1.25.25.25.15.15.15.2.cmml"><mfrac id="S3.E3.m1.25.25.25.15.15.15.2.4" xref="S3.E3.m1.25.25.25.15.15.15.2.4.cmml"><mn id="S3.E3.m1.25.25.25.15.15.15.2.4.2" xref="S3.E3.m1.25.25.25.15.15.15.2.4.2.cmml">1</mn><mn id="S3.E3.m1.25.25.25.15.15.15.2.4.3" xref="S3.E3.m1.25.25.25.15.15.15.2.4.3.cmml">2</mn></mfrac><mo id="S3.E3.m1.25.25.25.15.15.15.2.3" lspace="0em" xref="S3.E3.m1.25.25.25.15.15.15.2.3.cmml">⁢</mo><msubsup id="S3.E3.m1.25.25.25.15.15.15.2.2" xref="S3.E3.m1.25.25.25.15.15.15.2.2.cmml"><mrow id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.2.cmml"><mo fence="true" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.2.1.cmml">∥</mo><mrow id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.cmml"><msub id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.2" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.1" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.cmml"><mi id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.2" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.1" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="S3.E3.m1.25.25.25.15.15.15.1.1.1.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.cmml"><mo id="S3.E3.m1.25.25.25.15.15.15.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.cmml">(</mo><mn id="S3.E3.m1.25.25.25.15.15.15.1.1.1.1" xref="S3.E3.m1.25.25.25.15.15.15.1.1.1.1.cmml">1</mn><mo id="S3.E3.m1.25.25.25.15.15.15.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.3.cmml">2</mn><mn id="S3.E3.m1.25.25.25.15.15.15.2.2.3" xref="S3.E3.m1.25.25.25.15.15.15.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.E3.m1.25.25.25.15.15.15.3" xref="S3.E3.m1.25.25.25.15.15.15.3.cmml">⏟</mo></munder><mtext id="S3.E3.m1.26.26.26.16.16.16.1" xref="S3.E3.m1.26.26.26.16.16.16.1a.cmml">one-step reconstruction term</mtext></munder><mo id="S3.E3.m1.27.27.27.17.17.17" xref="S3.E3.m1.32.32.3.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.21.21.21.11.11.11a" xref="S3.E3.m1.21.21.21.11.11.11.cmml">+</mo><mi id="S3.E3.m1.29.29.29.19.19.19" xref="S3.E3.m1.29.29.29.19.19.19.cmml">C</mi></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.35b"><apply id="S3.E3.m1.32.32.3.cmml" xref="S3.E3.m1.35.35.6"><eq id="S3.E3.m1.11.11.11.1.1.1.cmml" xref="S3.E3.m1.11.11.11.1.1.1"></eq><apply id="S3.E3.m1.30.30.1.1.cmml" xref="S3.E3.m1.35.35.6"><times id="S3.E3.m1.30.30.1.1.2.cmml" xref="S3.E3.m1.35.35.6"></times><apply id="S3.E3.m1.30.30.1.1.3.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.30.30.1.1.3.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">ℒ</ci><list id="S3.E3.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.4"><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1">𝜽</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.2">bold-italic-ϕ</ci></list></apply><vector id="S3.E3.m1.30.30.1.1.1.2.cmml" xref="S3.E3.m1.35.35.6"><apply id="S3.E3.m1.30.30.1.1.1.1.1.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.30.30.1.1.1.1.1.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4">𝐱</ci><cn id="S3.E3.m1.5.5.5.5.5.5.1.cmml" type="integer" xref="S3.E3.m1.5.5.5.5.5.5.1">0</cn></apply><ci id="S3.E3.m1.7.7.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7.7.7">𝐲</ci><ci id="S3.E3.m1.9.9.9.9.9.9.cmml" xref="S3.E3.m1.9.9.9.9.9.9">𝐬</ci></vector></apply><apply id="S3.E3.m1.32.32.3.3.cmml" xref="S3.E3.m1.35.35.6"><plus id="S3.E3.m1.21.21.21.11.11.11.cmml" xref="S3.E3.m1.21.21.21.11.11.11"></plus><apply id="S3.E3.m1.31.31.2.2.1.cmml" xref="S3.E3.m1.35.35.6"><times id="S3.E3.m1.31.31.2.2.1.2.cmml" xref="S3.E3.m1.35.35.6"></times><apply id="S3.E3.m1.31.31.2.2.1.3.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.31.31.2.2.1.3.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><ci id="S3.E3.m1.12.12.12.2.2.2.cmml" xref="S3.E3.m1.12.12.12.2.2.2">𝔼</ci><apply id="S3.E3.m1.13.13.13.3.3.3.1.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1"><csymbol cd="latexml" id="S3.E3.m1.13.13.13.3.3.3.1.3.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.3">similar-to</csymbol><ci id="S3.E3.m1.13.13.13.3.3.3.1.4.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.4">𝑡</ci><apply id="S3.E3.m1.13.13.13.3.3.3.1.5.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.5"><times id="S3.E3.m1.13.13.13.3.3.3.1.5.1.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.5.1"></times><ci id="S3.E3.m1.13.13.13.3.3.3.1.5.2.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.5.2">𝒰</ci><interval closure="closed" id="S3.E3.m1.13.13.13.3.3.3.1.5.3.1.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.5.3.2"><cn id="S3.E3.m1.13.13.13.3.3.3.1.1.cmml" type="integer" xref="S3.E3.m1.13.13.13.3.3.3.1.1">2</cn><ci id="S3.E3.m1.13.13.13.3.3.3.1.2.cmml" xref="S3.E3.m1.13.13.13.3.3.3.1.2">𝑇</ci></interval></apply></apply></apply><apply id="S3.E3.m1.31.31.2.2.1.1.2.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="latexml" id="S3.E3.m1.31.31.2.2.1.1.2.1.cmml" xref="S3.E3.m1.35.35.6">delimited-[]</csymbol><apply id="S3.E3.m1.31.31.2.2.1.1.1.1.cmml" xref="S3.E3.m1.35.35.6"><minus id="S3.E3.m1.17.17.17.7.7.7.cmml" xref="S3.E3.m1.17.17.17.7.7.7"></minus><apply id="S3.E3.m1.31.31.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.31.31.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.cmml" xref="S3.E3.m1.15.15.15.5.5.5"><ci id="S3.E3.m1.15.15.15.5.5.5.3.cmml" xref="S3.E3.m1.15.15.15.5.5.5.3">⏟</ci><apply id="S3.E3.m1.15.15.15.5.5.5.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2"><times id="S3.E3.m1.15.15.15.5.5.5.2.3.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.3"></times><apply id="S3.E3.m1.15.15.15.5.5.5.2.4.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.4.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.4">subscript</csymbol><ci id="S3.E3.m1.15.15.15.5.5.5.2.4.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.4.2">𝜇</ci><ci id="S3.E3.m1.15.15.15.5.5.5.2.4.3.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.4.3">𝑡</ci></apply><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.2.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2">superscript</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2">subscript</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.2.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1"><minus id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.1"></minus><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.2">𝐱</ci><cn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.2.3">0</cn></apply><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2"><ci id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.1.1.1.3.2.3">0</cn></apply><ci id="S3.E3.m1.15.15.15.5.5.5.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.5.5.5.1.1.1.1">𝑡</ci></apply></apply></apply><cn id="S3.E3.m1.15.15.15.5.5.5.2.2.1.3.cmml" type="integer" xref="S3.E3.m1.15.15.15.5.5.5.2.2.1.3">2</cn></apply><cn id="S3.E3.m1.15.15.15.5.5.5.2.2.3.cmml" type="integer" xref="S3.E3.m1.15.15.15.5.5.5.2.2.3">2</cn></apply></apply></apply><ci id="S3.E3.m1.16.16.16.6.6.6.1a.cmml" xref="S3.E3.m1.16.16.16.6.6.6.1"><mtext id="S3.E3.m1.16.16.16.6.6.6.1.cmml" mathsize="70%" xref="S3.E3.m1.16.16.16.6.6.6.1">denoising term</mtext></ci></apply><apply id="S3.E3.m1.31.31.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.31.31.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><apply id="S3.E3.m1.18.18.18.8.8.8.cmml" xref="S3.E3.m1.18.18.18.8.8.8"><ci id="S3.E3.m1.18.18.18.8.8.8.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.3">⏟</ci><apply id="S3.E3.m1.18.18.18.8.8.8.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2"><times id="S3.E3.m1.18.18.18.8.8.8.2.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.3"></times><apply id="S3.E3.m1.18.18.18.8.8.8.2.4.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.4.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.4">subscript</csymbol><ci id="S3.E3.m1.18.18.18.8.8.8.2.4.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.4.2">𝜆</ci><ci id="S3.E3.m1.18.18.18.8.8.8.2.4.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.4.3">𝑡</ci></apply><apply id="S3.E3.m1.18.18.18.8.8.8.2.5.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.5.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5">subscript</csymbol><ci id="S3.E3.m1.18.18.18.8.8.8.2.5.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5.2">𝜅</ci><apply id="S3.E3.m1.18.18.18.8.8.8.2.5.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.5.3.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3">subscript</csymbol><ci id="S3.E3.m1.18.18.18.8.8.8.2.5.3.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3.2">𝐱</ci><cn id="S3.E3.m1.18.18.18.8.8.8.2.5.3.3.cmml" type="integer" xref="S3.E3.m1.18.18.18.8.8.8.2.5.3.3">0</cn></apply></apply><apply id="S3.E3.m1.18.18.18.8.8.8.2.6.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.6"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.6.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.6">superscript</csymbol><ci id="S3.E3.m1.18.18.18.8.8.8.2.6.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.6.2">𝐲</ci><ci id="S3.E3.m1.18.18.18.8.8.8.2.6.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.6.3">𝑇</ci></apply><apply id="S3.E3.m1.18.18.18.8.8.8.2.7.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.7"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.7.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.7">subscript</csymbol><ci id="S3.E3.m1.18.18.18.8.8.8.2.7.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.7.2">𝑓</ci><ci id="S3.E3.m1.18.18.18.8.8.8.2.7.3.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.7.3">bold-italic-ϕ</ci></apply><apply id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1">superscript</csymbol><apply id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1">subscript</csymbol><apply id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2"><ci id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.1">^</ci><ci id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.18.18.18.8.8.8.2.2.1.1.2.3">0</cn></apply><ci id="S3.E3.m1.18.18.18.8.8.8.1.1.1.1.cmml" xref="S3.E3.m1.18.18.18.8.8.8.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="S3.E3.m1.19.19.19.9.9.9.1a.cmml" xref="S3.E3.m1.19.19.19.9.9.9.1"><mtext id="S3.E3.m1.19.19.19.9.9.9.1.cmml" mathsize="70%" xref="S3.E3.m1.19.19.19.9.9.9.1">inner-product term</mtext></ci></apply></apply></apply></apply><apply id="S3.E3.m1.32.32.3.3.2.cmml" xref="S3.E3.m1.35.35.6"><times id="S3.E3.m1.32.32.3.3.2.2.cmml" xref="S3.E3.m1.35.35.6"></times><apply id="S3.E3.m1.32.32.3.3.2.3.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.32.32.3.3.2.3.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><ci id="S3.E3.m1.22.22.22.12.12.12.cmml" xref="S3.E3.m1.22.22.22.12.12.12">𝔼</ci><apply id="S3.E3.m1.23.23.23.13.13.13.1.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1"><times id="S3.E3.m1.23.23.23.13.13.13.1.2.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.2"></times><ci id="S3.E3.m1.23.23.23.13.13.13.1.3.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.3">𝑞</ci><apply id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.1.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.1.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.2.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.2">𝐱</ci><cn id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.1.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.2.cmml" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.2">𝐱</ci><cn id="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.23.23.23.13.13.13.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S3.E3.m1.32.32.3.3.2.1.2.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="latexml" id="S3.E3.m1.32.32.3.3.2.1.2.1.cmml" xref="S3.E3.m1.35.35.6">delimited-[]</csymbol><apply id="S3.E3.m1.32.32.3.3.2.1.1.1.cmml" xref="S3.E3.m1.35.35.6"><csymbol cd="ambiguous" id="S3.E3.m1.32.32.3.3.2.1.1.1.1.cmml" xref="S3.E3.m1.35.35.6">subscript</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.cmml" xref="S3.E3.m1.25.25.25.15.15.15"><ci id="S3.E3.m1.25.25.25.15.15.15.3.cmml" xref="S3.E3.m1.25.25.25.15.15.15.3">⏟</ci><apply id="S3.E3.m1.25.25.25.15.15.15.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2"><times id="S3.E3.m1.25.25.25.15.15.15.2.3.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.3"></times><apply id="S3.E3.m1.25.25.25.15.15.15.2.4.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.4"><divide id="S3.E3.m1.25.25.25.15.15.15.2.4.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.4"></divide><cn id="S3.E3.m1.25.25.25.15.15.15.2.4.2.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.4.2">1</cn><cn id="S3.E3.m1.25.25.25.15.15.15.2.4.3.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.4.3">2</cn></apply><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.25.15.15.15.2.2.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2">superscript</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2">subscript</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.2.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1"><minus id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.1"></minus><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.2">𝐱</ci><cn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.2.3">0</cn></apply><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2"><ci id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.1.1.1.3.2.3">0</cn></apply><cn id="S3.E3.m1.25.25.25.15.15.15.1.1.1.1.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.1.1.1.1">1</cn></apply></apply></apply><cn id="S3.E3.m1.25.25.25.15.15.15.2.2.1.3.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.2.1.3">2</cn></apply><cn id="S3.E3.m1.25.25.25.15.15.15.2.2.3.cmml" type="integer" xref="S3.E3.m1.25.25.25.15.15.15.2.2.3">2</cn></apply></apply></apply><ci id="S3.E3.m1.26.26.26.16.16.16.1a.cmml" xref="S3.E3.m1.26.26.26.16.16.16.1"><mtext id="S3.E3.m1.26.26.26.16.16.16.1.cmml" mathsize="70%" xref="S3.E3.m1.26.26.26.16.16.16.1">one-step reconstruction term</mtext></ci></apply></apply></apply><ci id="S3.E3.m1.29.29.29.19.19.19.cmml" xref="S3.E3.m1.29.29.29.19.19.19">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.35c">\begin{split}\mathcal{L}_{\bm{\theta},\bm{\phi}}(\mathbf{x}_{0},\mathbf{y},%
\mathbf{s})\\
=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}-\underbrace{\lambda_{t}\kappa_{\mathbf{x}_{0}}\mathbf{y}^{T}f%
_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term%
}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[\underbrace{%
\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}\right\rVert_{2%
}^{2}}_{\text{one-step reconstruction term}}\right]+C\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.35d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT bold_italic_θ , bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) end_CELL end_ROW start_ROW start_CELL = blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ under⏟ start_ARG italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT denoising term end_POSTSUBSCRIPT - under⏟ start_ARG italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ under⏟ start_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT one-step reconstruction term end_POSTSUBSCRIPT ] + italic_C end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.14">where <math alttext="\hat{\mathbf{x}}_{0}^{(t)}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m1.1"><semantics id="S3.SS3.p1.10.m1.1a"><msubsup id="S3.SS3.p1.10.m1.1.2" xref="S3.SS3.p1.10.m1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.10.m1.1.2.2.2" xref="S3.SS3.p1.10.m1.1.2.2.2.cmml"><mi id="S3.SS3.p1.10.m1.1.2.2.2.2" xref="S3.SS3.p1.10.m1.1.2.2.2.2.cmml">𝐱</mi><mo id="S3.SS3.p1.10.m1.1.2.2.2.1" xref="S3.SS3.p1.10.m1.1.2.2.2.1.cmml">^</mo></mover><mn id="S3.SS3.p1.10.m1.1.2.2.3" xref="S3.SS3.p1.10.m1.1.2.2.3.cmml">0</mn><mrow id="S3.SS3.p1.10.m1.1.1.1.3" xref="S3.SS3.p1.10.m1.1.2.cmml"><mo id="S3.SS3.p1.10.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.10.m1.1.2.cmml">(</mo><mi id="S3.SS3.p1.10.m1.1.1.1.1" xref="S3.SS3.p1.10.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p1.10.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.10.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m1.1b"><apply id="S3.SS3.p1.10.m1.1.2.cmml" xref="S3.SS3.p1.10.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m1.1.2.1.cmml" xref="S3.SS3.p1.10.m1.1.2">superscript</csymbol><apply id="S3.SS3.p1.10.m1.1.2.2.cmml" xref="S3.SS3.p1.10.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m1.1.2.2.1.cmml" xref="S3.SS3.p1.10.m1.1.2">subscript</csymbol><apply id="S3.SS3.p1.10.m1.1.2.2.2.cmml" xref="S3.SS3.p1.10.m1.1.2.2.2"><ci id="S3.SS3.p1.10.m1.1.2.2.2.1.cmml" xref="S3.SS3.p1.10.m1.1.2.2.2.1">^</ci><ci id="S3.SS3.p1.10.m1.1.2.2.2.2.cmml" xref="S3.SS3.p1.10.m1.1.2.2.2.2">𝐱</ci></apply><cn id="S3.SS3.p1.10.m1.1.2.2.3.cmml" type="integer" xref="S3.SS3.p1.10.m1.1.2.2.3">0</cn></apply><ci id="S3.SS3.p1.10.m1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m1.1c">\hat{\mathbf{x}}_{0}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the denoising network that takes as input the conditioning signals <math alttext="\mathbf{y},\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m2.2"><semantics id="S3.SS3.p1.11.m2.2a"><mrow id="S3.SS3.p1.11.m2.2.3.2" xref="S3.SS3.p1.11.m2.2.3.1.cmml"><mi id="S3.SS3.p1.11.m2.1.1" xref="S3.SS3.p1.11.m2.1.1.cmml">𝐲</mi><mo id="S3.SS3.p1.11.m2.2.3.2.1" xref="S3.SS3.p1.11.m2.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.11.m2.2.2" xref="S3.SS3.p1.11.m2.2.2.cmml">𝐬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m2.2b"><list id="S3.SS3.p1.11.m2.2.3.1.cmml" xref="S3.SS3.p1.11.m2.2.3.2"><ci id="S3.SS3.p1.11.m2.1.1.cmml" xref="S3.SS3.p1.11.m2.1.1">𝐲</ci><ci id="S3.SS3.p1.11.m2.2.2.cmml" xref="S3.SS3.p1.11.m2.2.2">𝐬</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m2.2c">\mathbf{y},\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m2.2d">bold_y , bold_s</annotation></semantics></math>, the time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m3.1"><semantics id="S3.SS3.p1.12.m3.1a"><mi id="S3.SS3.p1.12.m3.1.1" xref="S3.SS3.p1.12.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m3.1b"><ci id="S3.SS3.p1.12.m3.1.1.cmml" xref="S3.SS3.p1.12.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m3.1d">italic_t</annotation></semantics></math> and the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m4.1"><semantics id="S3.SS3.p1.13.m4.1a"><mi id="S3.SS3.p1.13.m4.1.1" xref="S3.SS3.p1.13.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m4.1b"><ci id="S3.SS3.p1.13.m4.1.1.cmml" xref="S3.SS3.p1.13.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m4.1d">italic_t</annotation></semantics></math>-step noisified image <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m5.1"><semantics id="S3.SS3.p1.14.m5.1a"><msub id="S3.SS3.p1.14.m5.1.1" xref="S3.SS3.p1.14.m5.1.1.cmml"><mi id="S3.SS3.p1.14.m5.1.1.2" xref="S3.SS3.p1.14.m5.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p1.14.m5.1.1.3" xref="S3.SS3.p1.14.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m5.1b"><apply id="S3.SS3.p1.14.m5.1.1.cmml" xref="S3.SS3.p1.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m5.1.1.1.cmml" xref="S3.SS3.p1.14.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m5.1.1.2.cmml" xref="S3.SS3.p1.14.m5.1.1.2">𝐱</ci><ci id="S3.SS3.p1.14.m5.1.1.3.cmml" xref="S3.SS3.p1.14.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m5.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m5.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{x}}_{0}^{(t)}:=\hat{\mathbf{x}}_{\bm{\theta}}(%
\mathbf{x}_{t},t,\mathbf{y},\mathbf{s})." class="ltx_Math" display="inline" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msubsup id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.3.2.2.1" xref="S3.E4.m1.5.5.1.1.3.2.2.1.cmml">^</mo></mover><mn id="S3.E4.m1.5.5.1.1.3.2.3" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml">0</mn><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">t</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.5.5.1.1.2" lspace="0.278em" rspace="0.278em" xref="S3.E4.m1.5.5.1.1.2.cmml">:=</mo><mrow id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.5.5.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.3.2.cmml"><mi id="S3.E4.m1.5.5.1.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.1.3.2.2.cmml">𝐱</mi><mo id="S3.E4.m1.5.5.1.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.5.5.1.1.1.3.3" xref="S3.E4.m1.5.5.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="S3.E4.m1.5.5.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E4.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.5.5.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.4" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">𝐲</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.5" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">𝐬</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.6" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" lspace="0em" xref="S3.E4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2">assign</csymbol><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3">subscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"><ci id="S3.E4.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.1">^</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">𝐱</ci></apply><cn id="S3.E4.m1.5.5.1.1.3.2.3.cmml" type="integer" xref="S3.E4.m1.5.5.1.1.3.2.3">0</cn></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><times id="S3.E4.m1.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.2"></times><apply id="S3.E4.m1.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.5.5.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.3.2"><ci id="S3.E4.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3.2.1">^</ci><ci id="S3.E4.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.1.3.2.2">𝐱</ci></apply><ci id="S3.E4.m1.5.5.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.3.3">𝜽</ci></apply><vector id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1"><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝐲</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝐬</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\displaystyle\hat{\mathbf{x}}_{0}^{(t)}:=\hat{\mathbf{x}}_{\bm{\theta}}(%
\mathbf{x}_{t},t,\mathbf{y},\mathbf{s}).</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT := over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , bold_y , bold_s ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.26">Symbolically, <math alttext="\hat{\mathbf{x}}_{0}^{(t)}" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m1.1"><semantics id="S3.SS3.p1.15.m1.1a"><msubsup id="S3.SS3.p1.15.m1.1.2" xref="S3.SS3.p1.15.m1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.15.m1.1.2.2.2" xref="S3.SS3.p1.15.m1.1.2.2.2.cmml"><mi id="S3.SS3.p1.15.m1.1.2.2.2.2" xref="S3.SS3.p1.15.m1.1.2.2.2.2.cmml">𝐱</mi><mo id="S3.SS3.p1.15.m1.1.2.2.2.1" xref="S3.SS3.p1.15.m1.1.2.2.2.1.cmml">^</mo></mover><mn id="S3.SS3.p1.15.m1.1.2.2.3" xref="S3.SS3.p1.15.m1.1.2.2.3.cmml">0</mn><mrow id="S3.SS3.p1.15.m1.1.1.1.3" xref="S3.SS3.p1.15.m1.1.2.cmml"><mo id="S3.SS3.p1.15.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.15.m1.1.2.cmml">(</mo><mi id="S3.SS3.p1.15.m1.1.1.1.1" xref="S3.SS3.p1.15.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p1.15.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.15.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m1.1b"><apply id="S3.SS3.p1.15.m1.1.2.cmml" xref="S3.SS3.p1.15.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m1.1.2.1.cmml" xref="S3.SS3.p1.15.m1.1.2">superscript</csymbol><apply id="S3.SS3.p1.15.m1.1.2.2.cmml" xref="S3.SS3.p1.15.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m1.1.2.2.1.cmml" xref="S3.SS3.p1.15.m1.1.2">subscript</csymbol><apply id="S3.SS3.p1.15.m1.1.2.2.2.cmml" xref="S3.SS3.p1.15.m1.1.2.2.2"><ci id="S3.SS3.p1.15.m1.1.2.2.2.1.cmml" xref="S3.SS3.p1.15.m1.1.2.2.2.1">^</ci><ci id="S3.SS3.p1.15.m1.1.2.2.2.2.cmml" xref="S3.SS3.p1.15.m1.1.2.2.2.2">𝐱</ci></apply><cn id="S3.SS3.p1.15.m1.1.2.2.3.cmml" type="integer" xref="S3.SS3.p1.15.m1.1.2.2.3">0</cn></apply><ci id="S3.SS3.p1.15.m1.1.1.1.1.cmml" xref="S3.SS3.p1.15.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m1.1c">\hat{\mathbf{x}}_{0}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the denoised image predicted by the denoising network when given the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.16.m2.1"><semantics id="S3.SS3.p1.16.m2.1a"><mi id="S3.SS3.p1.16.m2.1.1" xref="S3.SS3.p1.16.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m2.1b"><ci id="S3.SS3.p1.16.m2.1.1.cmml" xref="S3.SS3.p1.16.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.16.m2.1d">italic_t</annotation></semantics></math>-step noisified <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.17.m3.1"><semantics id="S3.SS3.p1.17.m3.1a"><msub id="S3.SS3.p1.17.m3.1.1" xref="S3.SS3.p1.17.m3.1.1.cmml"><mi id="S3.SS3.p1.17.m3.1.1.2" xref="S3.SS3.p1.17.m3.1.1.2.cmml">𝐱</mi><mi id="S3.SS3.p1.17.m3.1.1.3" xref="S3.SS3.p1.17.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m3.1b"><apply id="S3.SS3.p1.17.m3.1.1.cmml" xref="S3.SS3.p1.17.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m3.1.1.1.cmml" xref="S3.SS3.p1.17.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.17.m3.1.1.2.cmml" xref="S3.SS3.p1.17.m3.1.1.2">𝐱</ci><ci id="S3.SS3.p1.17.m3.1.1.3.cmml" xref="S3.SS3.p1.17.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m3.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.17.m3.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the time <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.18.m4.1"><semantics id="S3.SS3.p1.18.m4.1a"><mi id="S3.SS3.p1.18.m4.1.1" xref="S3.SS3.p1.18.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m4.1b"><ci id="S3.SS3.p1.18.m4.1.1.cmml" xref="S3.SS3.p1.18.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.18.m4.1d">italic_t</annotation></semantics></math> and the associated conditioning signals <math alttext="\mathbf{y},\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS3.p1.19.m5.2"><semantics id="S3.SS3.p1.19.m5.2a"><mrow id="S3.SS3.p1.19.m5.2.3.2" xref="S3.SS3.p1.19.m5.2.3.1.cmml"><mi id="S3.SS3.p1.19.m5.1.1" xref="S3.SS3.p1.19.m5.1.1.cmml">𝐲</mi><mo id="S3.SS3.p1.19.m5.2.3.2.1" xref="S3.SS3.p1.19.m5.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.19.m5.2.2" xref="S3.SS3.p1.19.m5.2.2.cmml">𝐬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m5.2b"><list id="S3.SS3.p1.19.m5.2.3.1.cmml" xref="S3.SS3.p1.19.m5.2.3.2"><ci id="S3.SS3.p1.19.m5.1.1.cmml" xref="S3.SS3.p1.19.m5.1.1">𝐲</ci><ci id="S3.SS3.p1.19.m5.2.2.cmml" xref="S3.SS3.p1.19.m5.2.2">𝐬</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m5.2c">\mathbf{y},\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.19.m5.2d">bold_y , bold_s</annotation></semantics></math>.
The coefficients,
<math alttext="\kappa_{\mathbf{x}_{0}}" class="ltx_Math" display="inline" id="S3.SS3.p1.20.m6.1"><semantics id="S3.SS3.p1.20.m6.1a"><msub id="S3.SS3.p1.20.m6.1.1" xref="S3.SS3.p1.20.m6.1.1.cmml"><mi id="S3.SS3.p1.20.m6.1.1.2" xref="S3.SS3.p1.20.m6.1.1.2.cmml">κ</mi><msub id="S3.SS3.p1.20.m6.1.1.3" xref="S3.SS3.p1.20.m6.1.1.3.cmml"><mi id="S3.SS3.p1.20.m6.1.1.3.2" xref="S3.SS3.p1.20.m6.1.1.3.2.cmml">𝐱</mi><mn id="S3.SS3.p1.20.m6.1.1.3.3" xref="S3.SS3.p1.20.m6.1.1.3.3.cmml">0</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m6.1b"><apply id="S3.SS3.p1.20.m6.1.1.cmml" xref="S3.SS3.p1.20.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m6.1.1.1.cmml" xref="S3.SS3.p1.20.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.20.m6.1.1.2.cmml" xref="S3.SS3.p1.20.m6.1.1.2">𝜅</ci><apply id="S3.SS3.p1.20.m6.1.1.3.cmml" xref="S3.SS3.p1.20.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m6.1.1.3.1.cmml" xref="S3.SS3.p1.20.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.20.m6.1.1.3.2.cmml" xref="S3.SS3.p1.20.m6.1.1.3.2">𝐱</ci><cn id="S3.SS3.p1.20.m6.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.20.m6.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m6.1c">\kappa_{\mathbf{x}_{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.20.m6.1d">italic_κ start_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.21.m7.1"><semantics id="S3.SS3.p1.21.m7.1a"><msub id="S3.SS3.p1.21.m7.1.1" xref="S3.SS3.p1.21.m7.1.1.cmml"><mi id="S3.SS3.p1.21.m7.1.1.2" xref="S3.SS3.p1.21.m7.1.1.2.cmml">λ</mi><mi id="S3.SS3.p1.21.m7.1.1.3" xref="S3.SS3.p1.21.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.21.m7.1b"><apply id="S3.SS3.p1.21.m7.1.1.cmml" xref="S3.SS3.p1.21.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.21.m7.1.1.1.cmml" xref="S3.SS3.p1.21.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.21.m7.1.1.2.cmml" xref="S3.SS3.p1.21.m7.1.1.2">𝜆</ci><ci id="S3.SS3.p1.21.m7.1.1.3.cmml" xref="S3.SS3.p1.21.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.21.m7.1c">\lambda_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.21.m7.1d">italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are scalars depending on <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS3.p1.22.m8.1"><semantics id="S3.SS3.p1.22.m8.1a"><msub id="S3.SS3.p1.22.m8.1.1" xref="S3.SS3.p1.22.m8.1.1.cmml"><mi id="S3.SS3.p1.22.m8.1.1.2" xref="S3.SS3.p1.22.m8.1.1.2.cmml">𝐱</mi><mn id="S3.SS3.p1.22.m8.1.1.3" xref="S3.SS3.p1.22.m8.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.22.m8.1b"><apply id="S3.SS3.p1.22.m8.1.1.cmml" xref="S3.SS3.p1.22.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m8.1.1.1.cmml" xref="S3.SS3.p1.22.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.22.m8.1.1.2.cmml" xref="S3.SS3.p1.22.m8.1.1.2">𝐱</ci><cn id="S3.SS3.p1.22.m8.1.1.3.cmml" type="integer" xref="S3.SS3.p1.22.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.22.m8.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.22.m8.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.23.m9.1"><semantics id="S3.SS3.p1.23.m9.1a"><mi id="S3.SS3.p1.23.m9.1.1" xref="S3.SS3.p1.23.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.23.m9.1b"><ci id="S3.SS3.p1.23.m9.1.1.cmml" xref="S3.SS3.p1.23.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.23.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.23.m9.1d">italic_t</annotation></semantics></math>, respectively, and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.p1.24.m10.1"><semantics id="S3.SS3.p1.24.m10.1a"><mi id="S3.SS3.p1.24.m10.1.1" xref="S3.SS3.p1.24.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.24.m10.1b"><ci id="S3.SS3.p1.24.m10.1.1.cmml" xref="S3.SS3.p1.24.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.24.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.24.m10.1d">italic_C</annotation></semantics></math> is a constant that does not depend on the learnable parameters <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p1.25.m11.1"><semantics id="S3.SS3.p1.25.m11.1a"><mi id="S3.SS3.p1.25.m11.1.1" xref="S3.SS3.p1.25.m11.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.25.m11.1b"><ci id="S3.SS3.p1.25.m11.1.1.cmml" xref="S3.SS3.p1.25.m11.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.25.m11.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.25.m11.1d">bold_italic_θ</annotation></semantics></math>. The specific value of <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.p1.26.m12.1"><semantics id="S3.SS3.p1.26.m12.1a"><mi id="S3.SS3.p1.26.m12.1.1" xref="S3.SS3.p1.26.m12.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.26.m12.1b"><ci id="S3.SS3.p1.26.m12.1.1.cmml" xref="S3.SS3.p1.26.m12.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.26.m12.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.26.m12.1d">italic_C</annotation></semantics></math> will be elaborated in Appendix A.</p>
</div>
<figure class="ltx_figure" id="S3.SS3.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_float ltx_figure_panel ltx_minipage ltx_align_middle" id="algorithm1" style="width:208.1pt;">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.10">
<div class="ltx_listingline" id="algorithm1.2.2">
<span class="ltx_text" id="algorithm1.2.2.2" style="font-size:90%;">
<span class="ltx_text" id="algorithm1.2.2.2.1"><span class="ltx_text ltx_font_bold" id="algorithm1.2.2.2.1.1">Input:</span> </span>The training face images <math alttext="\mathbf{x}_{0}\sim\mathcal{D}" class="ltx_Math" display="inline" id="algorithm1.1.1.1.m1.1"><semantics id="algorithm1.1.1.1.m1.1a"><mrow id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml"><msub id="algorithm1.1.1.1.m1.1.1.2" xref="algorithm1.1.1.1.m1.1.1.2.cmml"><mi id="algorithm1.1.1.1.m1.1.1.2.2" xref="algorithm1.1.1.1.m1.1.1.2.2.cmml">𝐱</mi><mn id="algorithm1.1.1.1.m1.1.1.2.3" xref="algorithm1.1.1.1.m1.1.1.2.3.cmml">0</mn></msub><mo id="algorithm1.1.1.1.m1.1.1.1" xref="algorithm1.1.1.1.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.1.1.1.m1.1.1.3" xref="algorithm1.1.1.1.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.1b"><apply id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1"><csymbol cd="latexml" id="algorithm1.1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1.1">similar-to</csymbol><apply id="algorithm1.1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.1.1.2.1.cmml" xref="algorithm1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.1.1.1.m1.1.1.2.2.cmml" xref="algorithm1.1.1.1.m1.1.1.2.2">𝐱</ci><cn id="algorithm1.1.1.1.m1.1.1.2.3.cmml" type="integer" xref="algorithm1.1.1.1.m1.1.1.2.3">0</cn></apply><ci id="algorithm1.1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.1.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.1c">\mathbf{x}_{0}\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ caligraphic_D</annotation></semantics></math>; The pretrained face recognition model <math alttext="f_{\bm{\phi}}(\cdot)" class="ltx_Math" display="inline" id="algorithm1.2.2.2.m2.1"><semantics id="algorithm1.2.2.2.m2.1a"><mrow id="algorithm1.2.2.2.m2.1.2" xref="algorithm1.2.2.2.m2.1.2.cmml"><msub id="algorithm1.2.2.2.m2.1.2.2" xref="algorithm1.2.2.2.m2.1.2.2.cmml"><mi id="algorithm1.2.2.2.m2.1.2.2.2" xref="algorithm1.2.2.2.m2.1.2.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="algorithm1.2.2.2.m2.1.2.2.3" mathvariant="bold-italic" xref="algorithm1.2.2.2.m2.1.2.2.3.cmml">ϕ</mi></msub><mo id="algorithm1.2.2.2.m2.1.2.1" xref="algorithm1.2.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="algorithm1.2.2.2.m2.1.2.3.2" xref="algorithm1.2.2.2.m2.1.2.cmml"><mo id="algorithm1.2.2.2.m2.1.2.3.2.1" stretchy="false" xref="algorithm1.2.2.2.m2.1.2.cmml">(</mo><mo id="algorithm1.2.2.2.m2.1.1" lspace="0em" rspace="0em" xref="algorithm1.2.2.2.m2.1.1.cmml">⋅</mo><mo id="algorithm1.2.2.2.m2.1.2.3.2.2" stretchy="false" xref="algorithm1.2.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.2.m2.1b"><apply id="algorithm1.2.2.2.m2.1.2.cmml" xref="algorithm1.2.2.2.m2.1.2"><times id="algorithm1.2.2.2.m2.1.2.1.cmml" xref="algorithm1.2.2.2.m2.1.2.1"></times><apply id="algorithm1.2.2.2.m2.1.2.2.cmml" xref="algorithm1.2.2.2.m2.1.2.2"><csymbol cd="ambiguous" id="algorithm1.2.2.2.m2.1.2.2.1.cmml" xref="algorithm1.2.2.2.m2.1.2.2">subscript</csymbol><ci id="algorithm1.2.2.2.m2.1.2.2.2.cmml" xref="algorithm1.2.2.2.m2.1.2.2.2">𝑓</ci><ci id="algorithm1.2.2.2.m2.1.2.2.3.cmml" xref="algorithm1.2.2.2.m2.1.2.2.3">bold-italic-ϕ</ci></apply><ci id="algorithm1.2.2.2.m2.1.1.cmml" xref="algorithm1.2.2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.2.m2.1c">f_{\bm{\phi}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.2.m2.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm1.3.3">
<span class="ltx_text" id="algorithm1.3.3.1" style="font-size:90%;">
</span><span class="ltx_text" id="algorithm1.3.3.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="algorithm1.3.3.2.1">Output:</span> </span><span class="ltx_text" id="algorithm1.3.3.3" style="font-size:90%;">
The denoising network </span><math alttext="\hat{\mathbf{x}}_{\bm{\theta}}" class="ltx_Math" display="inline" id="algorithm1.3.3.m1.1"><semantics id="algorithm1.3.3.m1.1a"><msub id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml"><mover accent="true" id="algorithm1.3.3.m1.1.1.2" xref="algorithm1.3.3.m1.1.1.2.cmml"><mi id="algorithm1.3.3.m1.1.1.2.2" mathsize="90%" xref="algorithm1.3.3.m1.1.1.2.2.cmml">𝐱</mi><mo id="algorithm1.3.3.m1.1.1.2.1" mathsize="90%" xref="algorithm1.3.3.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm1.3.3.m1.1.1.3" mathsize="90%" xref="algorithm1.3.3.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><apply id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">subscript</csymbol><apply id="algorithm1.3.3.m1.1.1.2.cmml" xref="algorithm1.3.3.m1.1.1.2"><ci id="algorithm1.3.3.m1.1.1.2.1.cmml" xref="algorithm1.3.3.m1.1.1.2.1">^</ci><ci id="algorithm1.3.3.m1.1.1.2.2.cmml" xref="algorithm1.3.3.m1.1.1.2.2">𝐱</ci></apply><ci id="algorithm1.3.3.m1.1.1.3.cmml" xref="algorithm1.3.3.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">\hat{\mathbf{x}}_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.3.3.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.11">
<span class="ltx_text" id="algorithm1.10.11.1" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.4.4">
<span class="ltx_text" id="algorithm1.4.4.1" style="font-size:90%;">Initialize </span><math alttext="\mathcal{D}^{\prime}\leftarrow\emptyset" class="ltx_Math" display="inline" id="algorithm1.4.4.m1.1"><semantics id="algorithm1.4.4.m1.1a"><mrow id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><msup id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.4.4.m1.1.1.2.2" mathsize="90%" xref="algorithm1.4.4.m1.1.1.2.2.cmml">𝒟</mi><mo id="algorithm1.4.4.m1.1.1.2.3" mathsize="90%" xref="algorithm1.4.4.m1.1.1.2.3.cmml">′</mo></msup><mo id="algorithm1.4.4.m1.1.1.1" mathsize="90%" stretchy="false" xref="algorithm1.4.4.m1.1.1.1.cmml">←</mo><mi id="algorithm1.4.4.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="algorithm1.4.4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><ci id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1.1">←</ci><apply id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.1.1.2.1.cmml" xref="algorithm1.4.4.m1.1.1.2">superscript</csymbol><ci id="algorithm1.4.4.m1.1.1.2.2.cmml" xref="algorithm1.4.4.m1.1.1.2.2">𝒟</ci><ci id="algorithm1.4.4.m1.1.1.2.3.cmml" xref="algorithm1.4.4.m1.1.1.2.3">′</ci></apply><emptyset id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">\mathcal{D}^{\prime}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m1.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← ∅</annotation></semantics></math><span class="ltx_text" id="algorithm1.4.4.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.5.5">
<span class="ltx_text ltx_font_bold" id="algorithm1.5.5.2" style="font-size:90%;">for</span><span class="ltx_text" id="algorithm1.5.5.3" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm1.5.5.1" style="font-size:90%;"><math alttext="\mathbf{x}_{0}\sim\mathcal{D}" class="ltx_Math" display="inline" id="algorithm1.5.5.1.m1.1"><semantics id="algorithm1.5.5.1.m1.1a"><mrow id="algorithm1.5.5.1.m1.1.1" xref="algorithm1.5.5.1.m1.1.1.cmml"><msub id="algorithm1.5.5.1.m1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.2.cmml"><mi id="algorithm1.5.5.1.m1.1.1.2.2" xref="algorithm1.5.5.1.m1.1.1.2.2.cmml">𝐱</mi><mn id="algorithm1.5.5.1.m1.1.1.2.3" xref="algorithm1.5.5.1.m1.1.1.2.3.cmml">0</mn></msub><mo id="algorithm1.5.5.1.m1.1.1.1" xref="algorithm1.5.5.1.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.5.5.1.m1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.1b"><apply id="algorithm1.5.5.1.m1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1"><csymbol cd="latexml" id="algorithm1.5.5.1.m1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1">similar-to</csymbol><apply id="algorithm1.5.5.1.m1.1.1.2.cmml" xref="algorithm1.5.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.5.5.1.m1.1.1.2.1.cmml" xref="algorithm1.5.5.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.5.5.1.m1.1.1.2.2.cmml" xref="algorithm1.5.5.1.m1.1.1.2.2">𝐱</ci><cn id="algorithm1.5.5.1.m1.1.1.2.3.cmml" type="integer" xref="algorithm1.5.5.1.m1.1.1.2.3">0</cn></apply><ci id="algorithm1.5.5.1.m1.1.1.3.cmml" xref="algorithm1.5.5.1.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1c">\mathbf{x}_{0}\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ caligraphic_D</annotation></semantics></math></em><span class="ltx_text" id="algorithm1.5.5.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm1.5.5.5" style="font-size:90%;">do</span><span class="ltx_text" id="algorithm1.5.5.6" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm1.10.12">
<span class="ltx_text" id="algorithm1.10.12.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.10.12.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm1.10.12.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm1.6.6">
<span class="ltx_text" id="algorithm1.6.6.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.6.6.2" style="font-size:90%;">   </span><math alttext="\mathbf{y}\leftarrow f_{\bm{\phi}}(\mathbf{x}_{0})" class="ltx_Math" display="inline" id="algorithm1.6.6.m1.1"><semantics id="algorithm1.6.6.m1.1a"><mrow id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml"><mi id="algorithm1.6.6.m1.1.1.3" mathsize="90%" xref="algorithm1.6.6.m1.1.1.3.cmml">𝐲</mi><mo id="algorithm1.6.6.m1.1.1.2" mathsize="90%" stretchy="false" xref="algorithm1.6.6.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.6.6.m1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.cmml"><msub id="algorithm1.6.6.m1.1.1.1.3" xref="algorithm1.6.6.m1.1.1.1.3.cmml"><mi id="algorithm1.6.6.m1.1.1.1.3.2" mathsize="90%" xref="algorithm1.6.6.m1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="algorithm1.6.6.m1.1.1.1.3.3" mathsize="90%" mathvariant="bold-italic" xref="algorithm1.6.6.m1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="algorithm1.6.6.m1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.6.6.m1.1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.1.1.cmml"><mo id="algorithm1.6.6.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm1.6.6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.6.6.m1.1.1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.6.6.m1.1.1.1.1.1.1.2" mathsize="90%" xref="algorithm1.6.6.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="algorithm1.6.6.m1.1.1.1.1.1.1.3" mathsize="90%" xref="algorithm1.6.6.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="algorithm1.6.6.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="algorithm1.6.6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1"><ci id="algorithm1.6.6.m1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.2">←</ci><ci id="algorithm1.6.6.m1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.3">𝐲</ci><apply id="algorithm1.6.6.m1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1"><times id="algorithm1.6.6.m1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.2"></times><apply id="algorithm1.6.6.m1.1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.3.1.cmml" xref="algorithm1.6.6.m1.1.1.1.3">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.1.3.2.cmml" xref="algorithm1.6.6.m1.1.1.1.3.2">𝑓</ci><ci id="algorithm1.6.6.m1.1.1.1.3.3.cmml" xref="algorithm1.6.6.m1.1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="algorithm1.6.6.m1.1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.2">𝐱</ci><cn id="algorithm1.6.6.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="algorithm1.6.6.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\mathbf{y}\leftarrow f_{\bm{\phi}}(\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m1.1d">bold_y ← italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm1.6.6.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_text" id="algorithm1.7.7.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.7.7.2" style="font-size:90%;">   </span><math alttext="\mathbf{s}\leftarrow\operatorname{AttributePredictor}(\mathbf{x}_{0})" class="ltx_Math" display="inline" id="algorithm1.7.7.m1.2"><semantics id="algorithm1.7.7.m1.2a"><mrow id="algorithm1.7.7.m1.2.2" xref="algorithm1.7.7.m1.2.2.cmml"><mi id="algorithm1.7.7.m1.2.2.3" mathsize="90%" xref="algorithm1.7.7.m1.2.2.3.cmml">𝐬</mi><mo id="algorithm1.7.7.m1.2.2.2" mathsize="90%" stretchy="false" xref="algorithm1.7.7.m1.2.2.2.cmml">←</mo><mrow id="algorithm1.7.7.m1.2.2.1.1" xref="algorithm1.7.7.m1.2.2.1.2.cmml"><mi id="algorithm1.7.7.m1.1.1" mathsize="90%" xref="algorithm1.7.7.m1.1.1.cmml">AttributePredictor</mi><mo id="algorithm1.7.7.m1.2.2.1.1a" xref="algorithm1.7.7.m1.2.2.1.2.cmml">⁡</mo><mrow id="algorithm1.7.7.m1.2.2.1.1.1" xref="algorithm1.7.7.m1.2.2.1.2.cmml"><mo id="algorithm1.7.7.m1.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm1.7.7.m1.2.2.1.2.cmml">(</mo><msub id="algorithm1.7.7.m1.2.2.1.1.1.1" xref="algorithm1.7.7.m1.2.2.1.1.1.1.cmml"><mi id="algorithm1.7.7.m1.2.2.1.1.1.1.2" mathsize="90%" xref="algorithm1.7.7.m1.2.2.1.1.1.1.2.cmml">𝐱</mi><mn id="algorithm1.7.7.m1.2.2.1.1.1.1.3" mathsize="90%" xref="algorithm1.7.7.m1.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="algorithm1.7.7.m1.2.2.1.1.1.3" maxsize="90%" minsize="90%" xref="algorithm1.7.7.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.2b"><apply id="algorithm1.7.7.m1.2.2.cmml" xref="algorithm1.7.7.m1.2.2"><ci id="algorithm1.7.7.m1.2.2.2.cmml" xref="algorithm1.7.7.m1.2.2.2">←</ci><ci id="algorithm1.7.7.m1.2.2.3.cmml" xref="algorithm1.7.7.m1.2.2.3">𝐬</ci><apply id="algorithm1.7.7.m1.2.2.1.2.cmml" xref="algorithm1.7.7.m1.2.2.1.1"><ci id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">AttributePredictor</ci><apply id="algorithm1.7.7.m1.2.2.1.1.1.1.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm1.7.7.m1.2.2.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1.2">𝐱</ci><cn id="algorithm1.7.7.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="algorithm1.7.7.m1.2.2.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.2c">\mathbf{s}\leftarrow\operatorname{AttributePredictor}(\mathbf{x}_{0})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m1.2d">bold_s ← roman_AttributePredictor ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm1.7.7.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.8.8">
<span class="ltx_text" id="algorithm1.8.8.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm1.8.8.2" style="font-size:90%;">   </span><math alttext="\mathcal{D}^{\prime}\leftarrow\mathcal{D}^{\prime}\cup\{(\mathbf{x}_{0},%
\mathbf{y},\mathbf{s})\}" class="ltx_Math" display="inline" id="algorithm1.8.8.m1.3"><semantics id="algorithm1.8.8.m1.3a"><mrow id="algorithm1.8.8.m1.3.3" xref="algorithm1.8.8.m1.3.3.cmml"><msup id="algorithm1.8.8.m1.3.3.3" xref="algorithm1.8.8.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.8.8.m1.3.3.3.2" mathsize="90%" xref="algorithm1.8.8.m1.3.3.3.2.cmml">𝒟</mi><mo id="algorithm1.8.8.m1.3.3.3.3" mathsize="90%" xref="algorithm1.8.8.m1.3.3.3.3.cmml">′</mo></msup><mo id="algorithm1.8.8.m1.3.3.2" mathsize="90%" stretchy="false" xref="algorithm1.8.8.m1.3.3.2.cmml">←</mo><mrow id="algorithm1.8.8.m1.3.3.1" xref="algorithm1.8.8.m1.3.3.1.cmml"><msup id="algorithm1.8.8.m1.3.3.1.3" xref="algorithm1.8.8.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.8.8.m1.3.3.1.3.2" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.3.2.cmml">𝒟</mi><mo id="algorithm1.8.8.m1.3.3.1.3.3" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.3.3.cmml">′</mo></msup><mo id="algorithm1.8.8.m1.3.3.1.2" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.2.cmml">∪</mo><mrow id="algorithm1.8.8.m1.3.3.1.1.1" xref="algorithm1.8.8.m1.3.3.1.1.2.cmml"><mo id="algorithm1.8.8.m1.3.3.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.2.cmml">{</mo><mrow id="algorithm1.8.8.m1.3.3.1.1.1.1.1" xref="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml"><mo id="algorithm1.8.8.m1.3.3.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.2" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.3" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="algorithm1.8.8.m1.3.3.1.1.1.1.1.3" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="algorithm1.8.8.m1.1.1" mathsize="90%" xref="algorithm1.8.8.m1.1.1.cmml">𝐲</mi><mo id="algorithm1.8.8.m1.3.3.1.1.1.1.1.4" mathsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="algorithm1.8.8.m1.2.2" mathsize="90%" xref="algorithm1.8.8.m1.2.2.cmml">𝐬</mi><mo id="algorithm1.8.8.m1.3.3.1.1.1.1.1.5" maxsize="90%" minsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow><mo id="algorithm1.8.8.m1.3.3.1.1.1.3" maxsize="90%" minsize="90%" xref="algorithm1.8.8.m1.3.3.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.3b"><apply id="algorithm1.8.8.m1.3.3.cmml" xref="algorithm1.8.8.m1.3.3"><ci id="algorithm1.8.8.m1.3.3.2.cmml" xref="algorithm1.8.8.m1.3.3.2">←</ci><apply id="algorithm1.8.8.m1.3.3.3.cmml" xref="algorithm1.8.8.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.3.3.3.1.cmml" xref="algorithm1.8.8.m1.3.3.3">superscript</csymbol><ci id="algorithm1.8.8.m1.3.3.3.2.cmml" xref="algorithm1.8.8.m1.3.3.3.2">𝒟</ci><ci id="algorithm1.8.8.m1.3.3.3.3.cmml" xref="algorithm1.8.8.m1.3.3.3.3">′</ci></apply><apply id="algorithm1.8.8.m1.3.3.1.cmml" xref="algorithm1.8.8.m1.3.3.1"><union id="algorithm1.8.8.m1.3.3.1.2.cmml" xref="algorithm1.8.8.m1.3.3.1.2"></union><apply id="algorithm1.8.8.m1.3.3.1.3.cmml" xref="algorithm1.8.8.m1.3.3.1.3"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.3.3.1.3.1.cmml" xref="algorithm1.8.8.m1.3.3.1.3">superscript</csymbol><ci id="algorithm1.8.8.m1.3.3.1.3.2.cmml" xref="algorithm1.8.8.m1.3.3.1.3.2">𝒟</ci><ci id="algorithm1.8.8.m1.3.3.1.3.3.cmml" xref="algorithm1.8.8.m1.3.3.1.3.3">′</ci></apply><set id="algorithm1.8.8.m1.3.3.1.1.2.cmml" xref="algorithm1.8.8.m1.3.3.1.1.1"><vector id="algorithm1.8.8.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1"><apply id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.2">𝐱</ci><cn id="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="algorithm1.8.8.m1.3.3.1.1.1.1.1.1.3">0</cn></apply><ci id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1">𝐲</ci><ci id="algorithm1.8.8.m1.2.2.cmml" xref="algorithm1.8.8.m1.2.2">𝐬</ci></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.3c">\mathcal{D}^{\prime}\leftarrow\mathcal{D}^{\prime}\cup\{(\mathbf{x}_{0},%
\mathbf{y},\mathbf{s})\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.3d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∪ { ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) }</annotation></semantics></math><span class="ltx_text" id="algorithm1.8.8.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.13">
<span class="ltx_text" id="algorithm1.10.13.1" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.14">
</div>
<div class="ltx_listingline" id="algorithm1.9.9">
<span class="ltx_text" id="algorithm1.9.9.1" style="font-size:90%;">Solve Eq. (</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E2" style="font-size:90%;" title='Equation 2 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a><span class="ltx_text" id="algorithm1.9.9.2" style="font-size:90%;">) using batched Backpropagation algorithm with </span><math alttext="\mathcal{D}^{\prime}" class="ltx_Math" display="inline" id="algorithm1.9.9.m1.1"><semantics id="algorithm1.9.9.m1.1a"><msup id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.9.9.m1.1.1.2" mathsize="90%" xref="algorithm1.9.9.m1.1.1.2.cmml">𝒟</mi><mo id="algorithm1.9.9.m1.1.1.3" mathsize="90%" xref="algorithm1.9.9.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><apply id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1">superscript</csymbol><ci id="algorithm1.9.9.m1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.2">𝒟</ci><ci id="algorithm1.9.9.m1.1.1.3.cmml" xref="algorithm1.9.9.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">\mathcal{D}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.9.9.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_text ltx_font_bold" id="algorithm1.10.10.1" style="font-size:90%;">return</span><span class="ltx_text" id="algorithm1.10.10.2" style="font-size:90%;"> </span><math alttext="\hat{\mathbf{x}}_{\bm{\theta}}" class="ltx_Math" display="inline" id="algorithm1.10.10.m1.1"><semantics id="algorithm1.10.10.m1.1a"><msub id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mover accent="true" id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml"><mi id="algorithm1.10.10.m1.1.1.2.2" mathsize="90%" xref="algorithm1.10.10.m1.1.1.2.2.cmml">𝐱</mi><mo id="algorithm1.10.10.m1.1.1.2.1" mathsize="90%" xref="algorithm1.10.10.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm1.10.10.m1.1.1.3" mathsize="90%" xref="algorithm1.10.10.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">subscript</csymbol><apply id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2"><ci id="algorithm1.10.10.m1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.2.1">^</ci><ci id="algorithm1.10.10.m1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.2.2">𝐱</ci></apply><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\hat{\mathbf{x}}_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm1.10.10.3" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.14.1.1">Algorithm 1</span> </span>Training Algorithm</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_float ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="algorithm2" style="width:208.1pt;">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm2.13">
<div class="ltx_listingline" id="algorithm2.4.4">
<span class="ltx_text" id="algorithm2.4.4.1" style="font-size:90%;">
</span><span class="ltx_text" id="algorithm2.4.4.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="algorithm2.4.4.2.1">Input:</span> </span><span class="ltx_text" id="algorithm2.4.4.3" style="font-size:90%;">
Denoising network </span><math alttext="\hat{\mathbf{x}}_{\bm{\theta}}" class="ltx_Math" display="inline" id="algorithm2.1.1.m1.1"><semantics id="algorithm2.1.1.m1.1a"><msub id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml"><mover accent="true" id="algorithm2.1.1.m1.1.1.2" xref="algorithm2.1.1.m1.1.1.2.cmml"><mi id="algorithm2.1.1.m1.1.1.2.2" mathsize="90%" xref="algorithm2.1.1.m1.1.1.2.2.cmml">𝐱</mi><mo id="algorithm2.1.1.m1.1.1.2.1" mathsize="90%" xref="algorithm2.1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm2.1.1.m1.1.1.3" mathsize="90%" xref="algorithm2.1.1.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><apply id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">subscript</csymbol><apply id="algorithm2.1.1.m1.1.1.2.cmml" xref="algorithm2.1.1.m1.1.1.2"><ci id="algorithm2.1.1.m1.1.1.2.1.cmml" xref="algorithm2.1.1.m1.1.1.2.1">^</ci><ci id="algorithm2.1.1.m1.1.1.2.2.cmml" xref="algorithm2.1.1.m1.1.1.2.2">𝐱</ci></apply><ci id="algorithm2.1.1.m1.1.1.3.cmml" xref="algorithm2.1.1.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">\hat{\mathbf{x}}_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.1.1.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm2.4.4.4" style="font-size:90%;">;
recognition model </span><math alttext="f_{\bm{\phi}}" class="ltx_Math" display="inline" id="algorithm2.2.2.m2.1"><semantics id="algorithm2.2.2.m2.1a"><msub id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><mi id="algorithm2.2.2.m2.1.1.2" mathsize="90%" xref="algorithm2.2.2.m2.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="algorithm2.2.2.m2.1.1.3" mathsize="90%" mathvariant="bold-italic" xref="algorithm2.2.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2">𝑓</ci><ci id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">f_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.2.2.m2.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm2.4.4.5" style="font-size:90%;">; conditioning signals </span><math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="algorithm2.3.3.m3.1"><semantics id="algorithm2.3.3.m3.1a"><mi id="algorithm2.3.3.m3.1.1" mathsize="90%" xref="algorithm2.3.3.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.1b"><ci id="algorithm2.3.3.m3.1.1.cmml" xref="algorithm2.3.3.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.3.3.m3.1d">bold_y</annotation></semantics></math><span class="ltx_text" id="algorithm2.4.4.6" style="font-size:90%;"> and </span><math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="algorithm2.4.4.m4.1"><semantics id="algorithm2.4.4.m4.1a"><mi id="algorithm2.4.4.m4.1.1" mathsize="90%" xref="algorithm2.4.4.m4.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m4.1b"><ci id="algorithm2.4.4.m4.1.1.cmml" xref="algorithm2.4.4.m4.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m4.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.4.4.m4.1d">bold_s</annotation></semantics></math><span class="ltx_text" id="algorithm2.4.4.7" style="font-size:90%;">.</span>
</div>
<div class="ltx_listingline" id="algorithm2.5.5">
<span class="ltx_text" id="algorithm2.5.5.1" style="font-size:90%;">
</span><span class="ltx_text" id="algorithm2.5.5.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="algorithm2.5.5.2.1">Output:</span> </span><span class="ltx_text" id="algorithm2.5.5.3" style="font-size:90%;">A generated face </span><math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="algorithm2.5.5.m1.1"><semantics id="algorithm2.5.5.m1.1a"><msub id="algorithm2.5.5.m1.1.1" xref="algorithm2.5.5.m1.1.1.cmml"><mi id="algorithm2.5.5.m1.1.1.2" mathsize="90%" xref="algorithm2.5.5.m1.1.1.2.cmml">𝐱</mi><mn id="algorithm2.5.5.m1.1.1.3" mathsize="90%" xref="algorithm2.5.5.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m1.1b"><apply id="algorithm2.5.5.m1.1.1.cmml" xref="algorithm2.5.5.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.1.cmml" xref="algorithm2.5.5.m1.1.1">subscript</csymbol><ci id="algorithm2.5.5.m1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1.2">𝐱</ci><cn id="algorithm2.5.5.m1.1.1.3.cmml" type="integer" xref="algorithm2.5.5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.5.5.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.13.14">
<span class="ltx_text" id="algorithm2.13.14.1" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm2.7.7">
<math alttext="\mathbf{x}_{T}\leftarrow" class="ltx_Math" display="inline" id="algorithm2.6.6.m1.1"><semantics id="algorithm2.6.6.m1.1a"><mrow id="algorithm2.6.6.m1.1.1" xref="algorithm2.6.6.m1.1.1.cmml"><msub id="algorithm2.6.6.m1.1.1.2" xref="algorithm2.6.6.m1.1.1.2.cmml"><mi id="algorithm2.6.6.m1.1.1.2.2" mathsize="90%" xref="algorithm2.6.6.m1.1.1.2.2.cmml">𝐱</mi><mi id="algorithm2.6.6.m1.1.1.2.3" mathsize="90%" xref="algorithm2.6.6.m1.1.1.2.3.cmml">T</mi></msub><mo id="algorithm2.6.6.m1.1.1.1" mathsize="90%" stretchy="false" xref="algorithm2.6.6.m1.1.1.1.cmml">←</mo><mi id="algorithm2.6.6.m1.1.1.3" xref="algorithm2.6.6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m1.1b"><apply id="algorithm2.6.6.m1.1.1.cmml" xref="algorithm2.6.6.m1.1.1"><ci id="algorithm2.6.6.m1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1.1">←</ci><apply id="algorithm2.6.6.m1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.6.6.m1.1.1.2.1.cmml" xref="algorithm2.6.6.m1.1.1.2">subscript</csymbol><ci id="algorithm2.6.6.m1.1.1.2.2.cmml" xref="algorithm2.6.6.m1.1.1.2.2">𝐱</ci><ci id="algorithm2.6.6.m1.1.1.2.3.cmml" xref="algorithm2.6.6.m1.1.1.2.3">𝑇</ci></apply><csymbol cd="latexml" id="algorithm2.6.6.m1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m1.1c">\mathbf{x}_{T}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm2.6.6.m1.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ←</annotation></semantics></math><span class="ltx_text" id="algorithm2.7.7.1" style="font-size:90%;"> sample from </span><math alttext="\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="algorithm2.7.7.m2.2"><semantics id="algorithm2.7.7.m2.2a"><mrow id="algorithm2.7.7.m2.2.3" xref="algorithm2.7.7.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.7.7.m2.2.3.2" mathsize="90%" xref="algorithm2.7.7.m2.2.3.2.cmml">𝒩</mi><mo id="algorithm2.7.7.m2.2.3.1" xref="algorithm2.7.7.m2.2.3.1.cmml">⁢</mo><mrow id="algorithm2.7.7.m2.2.3.3.2" xref="algorithm2.7.7.m2.2.3.3.1.cmml"><mo id="algorithm2.7.7.m2.2.3.3.2.1" maxsize="90%" minsize="90%" xref="algorithm2.7.7.m2.2.3.3.1.cmml">(</mo><mn id="algorithm2.7.7.m2.1.1" mathsize="90%" xref="algorithm2.7.7.m2.1.1.cmml">0</mn><mo id="algorithm2.7.7.m2.2.3.3.2.2" mathsize="90%" xref="algorithm2.7.7.m2.2.3.3.1.cmml">,</mo><mi id="algorithm2.7.7.m2.2.2" mathsize="90%" xref="algorithm2.7.7.m2.2.2.cmml">I</mi><mo id="algorithm2.7.7.m2.2.3.3.2.3" maxsize="90%" minsize="90%" xref="algorithm2.7.7.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m2.2b"><apply id="algorithm2.7.7.m2.2.3.cmml" xref="algorithm2.7.7.m2.2.3"><times id="algorithm2.7.7.m2.2.3.1.cmml" xref="algorithm2.7.7.m2.2.3.1"></times><ci id="algorithm2.7.7.m2.2.3.2.cmml" xref="algorithm2.7.7.m2.2.3.2">𝒩</ci><interval closure="open" id="algorithm2.7.7.m2.2.3.3.1.cmml" xref="algorithm2.7.7.m2.2.3.3.2"><cn id="algorithm2.7.7.m2.1.1.cmml" type="integer" xref="algorithm2.7.7.m2.1.1">0</cn><ci id="algorithm2.7.7.m2.2.2.cmml" xref="algorithm2.7.7.m2.2.2">𝐼</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m2.2c">\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.7.7.m2.2d">caligraphic_N ( 0 , italic_I )</annotation></semantics></math><span class="ltx_text" id="algorithm2.7.7.2" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm2.9.9">
<span class="ltx_text ltx_font_bold" id="algorithm2.9.9.3" style="font-size:90%;">for</span><span class="ltx_text" id="algorithm2.9.9.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm2.9.9.2" style="font-size:90%;"><math alttext="t\leftarrow T" class="ltx_Math" display="inline" id="algorithm2.8.8.1.m1.1"><semantics id="algorithm2.8.8.1.m1.1a"><mrow id="algorithm2.8.8.1.m1.1.1" xref="algorithm2.8.8.1.m1.1.1.cmml"><mi id="algorithm2.8.8.1.m1.1.1.2" xref="algorithm2.8.8.1.m1.1.1.2.cmml">t</mi><mo id="algorithm2.8.8.1.m1.1.1.1" stretchy="false" xref="algorithm2.8.8.1.m1.1.1.1.cmml">←</mo><mi id="algorithm2.8.8.1.m1.1.1.3" xref="algorithm2.8.8.1.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.1.m1.1b"><apply id="algorithm2.8.8.1.m1.1.1.cmml" xref="algorithm2.8.8.1.m1.1.1"><ci id="algorithm2.8.8.1.m1.1.1.1.cmml" xref="algorithm2.8.8.1.m1.1.1.1">←</ci><ci id="algorithm2.8.8.1.m1.1.1.2.cmml" xref="algorithm2.8.8.1.m1.1.1.2">𝑡</ci><ci id="algorithm2.8.8.1.m1.1.1.3.cmml" xref="algorithm2.8.8.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.1.m1.1c">t\leftarrow T</annotation><annotation encoding="application/x-llamapun" id="algorithm2.8.8.1.m1.1d">italic_t ← italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm2.9.9.2.1">to</span> <math alttext="1" class="ltx_Math" display="inline" id="algorithm2.9.9.2.m2.1"><semantics id="algorithm2.9.9.2.m2.1a"><mn id="algorithm2.9.9.2.m2.1.1" xref="algorithm2.9.9.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.2.m2.1b"><cn id="algorithm2.9.9.2.m2.1.1.cmml" type="integer" xref="algorithm2.9.9.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="algorithm2.9.9.2.m2.1d">1</annotation></semantics></math></em><span class="ltx_text" id="algorithm2.9.9.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm2.9.9.6" style="font-size:90%;">do</span><span class="ltx_text" id="algorithm2.9.9.7" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm2.13.15">
<span class="ltx_text" id="algorithm2.13.15.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm2.13.15.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm2.13.15.3" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm2.10.10">
<span class="ltx_text" id="algorithm2.10.10.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm2.10.10.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm2.10.10.3" style="font-size:90%;">Compute the score function </span><math alttext="\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="algorithm2.10.10.m1.3"><semantics id="algorithm2.10.10.m1.3a"><mrow id="algorithm2.10.10.m1.3.3" xref="algorithm2.10.10.m1.3.3.cmml"><mrow id="algorithm2.10.10.m1.3.3.3" xref="algorithm2.10.10.m1.3.3.3.cmml"><mrow id="algorithm2.10.10.m1.3.3.3.1" xref="algorithm2.10.10.m1.3.3.3.1.cmml"><mo id="algorithm2.10.10.m1.3.3.3.1.1" mathsize="90%" rspace="0.167em" xref="algorithm2.10.10.m1.3.3.3.1.1.cmml">∇</mo><mi id="algorithm2.10.10.m1.3.3.3.1.2" mathsize="90%" xref="algorithm2.10.10.m1.3.3.3.1.2.cmml">log</mi></mrow><mo id="algorithm2.10.10.m1.3.3.3a" lspace="0.167em" xref="algorithm2.10.10.m1.3.3.3.cmml">⁡</mo><mover accent="true" id="algorithm2.10.10.m1.3.3.3.2" xref="algorithm2.10.10.m1.3.3.3.2.cmml"><mi id="algorithm2.10.10.m1.3.3.3.2.2" mathsize="90%" xref="algorithm2.10.10.m1.3.3.3.2.2.cmml">p</mi><mo id="algorithm2.10.10.m1.3.3.3.2.1" mathsize="90%" xref="algorithm2.10.10.m1.3.3.3.2.1.cmml">~</mo></mover></mrow><mo id="algorithm2.10.10.m1.3.3.2" xref="algorithm2.10.10.m1.3.3.2.cmml">⁢</mo><mrow id="algorithm2.10.10.m1.3.3.1.1" xref="algorithm2.10.10.m1.3.3.1.1.1.cmml"><mo id="algorithm2.10.10.m1.3.3.1.1.2" maxsize="90%" minsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.cmml">(</mo><mrow id="algorithm2.10.10.m1.3.3.1.1.1" xref="algorithm2.10.10.m1.3.3.1.1.1.cmml"><msub id="algorithm2.10.10.m1.3.3.1.1.1.2" xref="algorithm2.10.10.m1.3.3.1.1.1.2.cmml"><mi id="algorithm2.10.10.m1.3.3.1.1.1.2.2" mathsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="algorithm2.10.10.m1.3.3.1.1.1.2.3" mathsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="algorithm2.10.10.m1.3.3.1.1.1.1" mathsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="algorithm2.10.10.m1.3.3.1.1.1.3.2" xref="algorithm2.10.10.m1.3.3.1.1.1.3.1.cmml"><mi id="algorithm2.10.10.m1.1.1" mathsize="90%" xref="algorithm2.10.10.m1.1.1.cmml">𝐲</mi><mo id="algorithm2.10.10.m1.3.3.1.1.1.3.2.1" mathsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="algorithm2.10.10.m1.2.2" mathsize="90%" xref="algorithm2.10.10.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="algorithm2.10.10.m1.3.3.1.1.3" maxsize="90%" minsize="90%" xref="algorithm2.10.10.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m1.3b"><apply id="algorithm2.10.10.m1.3.3.cmml" xref="algorithm2.10.10.m1.3.3"><times id="algorithm2.10.10.m1.3.3.2.cmml" xref="algorithm2.10.10.m1.3.3.2"></times><apply id="algorithm2.10.10.m1.3.3.3.cmml" xref="algorithm2.10.10.m1.3.3.3"><apply id="algorithm2.10.10.m1.3.3.3.1.cmml" xref="algorithm2.10.10.m1.3.3.3.1"><ci id="algorithm2.10.10.m1.3.3.3.1.1.cmml" xref="algorithm2.10.10.m1.3.3.3.1.1">∇</ci><log id="algorithm2.10.10.m1.3.3.3.1.2.cmml" xref="algorithm2.10.10.m1.3.3.3.1.2"></log></apply><apply id="algorithm2.10.10.m1.3.3.3.2.cmml" xref="algorithm2.10.10.m1.3.3.3.2"><ci id="algorithm2.10.10.m1.3.3.3.2.1.cmml" xref="algorithm2.10.10.m1.3.3.3.2.1">~</ci><ci id="algorithm2.10.10.m1.3.3.3.2.2.cmml" xref="algorithm2.10.10.m1.3.3.3.2.2">𝑝</ci></apply></apply><apply id="algorithm2.10.10.m1.3.3.1.1.1.cmml" xref="algorithm2.10.10.m1.3.3.1.1"><csymbol cd="latexml" id="algorithm2.10.10.m1.3.3.1.1.1.1.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.1">conditional</csymbol><apply id="algorithm2.10.10.m1.3.3.1.1.1.2.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.3.3.1.1.1.2.1.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.2">subscript</csymbol><ci id="algorithm2.10.10.m1.3.3.1.1.1.2.2.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.2.2">𝐱</ci><ci id="algorithm2.10.10.m1.3.3.1.1.1.2.3.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.2.3">𝑡</ci></apply><list id="algorithm2.10.10.m1.3.3.1.1.1.3.1.cmml" xref="algorithm2.10.10.m1.3.3.1.1.1.3.2"><ci id="algorithm2.10.10.m1.1.1.cmml" xref="algorithm2.10.10.m1.1.1">𝐲</ci><ci id="algorithm2.10.10.m1.2.2.cmml" xref="algorithm2.10.10.m1.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m1.3c">\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.10.10.m1.3d">∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math><span class="ltx_text" id="algorithm2.10.10.4" style="font-size:90%;"> as in Eq. (</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E7" style="font-size:90%;" title='Equation 7 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">7</span></a><span class="ltx_text" id="algorithm2.10.10.5" style="font-size:90%;">);
</span>
</div>
<div class="ltx_listingline" id="algorithm2.11.11">
<span class="ltx_text" id="algorithm2.11.11.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm2.11.11.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm2.11.11.3" style="font-size:90%;">Draw a Gaussian sample </span><math alttext="\epsilon\sim\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="algorithm2.11.11.m1.2"><semantics id="algorithm2.11.11.m1.2a"><mrow id="algorithm2.11.11.m1.2.3" xref="algorithm2.11.11.m1.2.3.cmml"><mi id="algorithm2.11.11.m1.2.3.2" mathsize="90%" xref="algorithm2.11.11.m1.2.3.2.cmml">ϵ</mi><mo id="algorithm2.11.11.m1.2.3.1" mathsize="90%" xref="algorithm2.11.11.m1.2.3.1.cmml">∼</mo><mrow id="algorithm2.11.11.m1.2.3.3" xref="algorithm2.11.11.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.11.11.m1.2.3.3.2" mathsize="90%" xref="algorithm2.11.11.m1.2.3.3.2.cmml">𝒩</mi><mo id="algorithm2.11.11.m1.2.3.3.1" xref="algorithm2.11.11.m1.2.3.3.1.cmml">⁢</mo><mrow id="algorithm2.11.11.m1.2.3.3.3.2" xref="algorithm2.11.11.m1.2.3.3.3.1.cmml"><mo id="algorithm2.11.11.m1.2.3.3.3.2.1" maxsize="90%" minsize="90%" xref="algorithm2.11.11.m1.2.3.3.3.1.cmml">(</mo><mn id="algorithm2.11.11.m1.1.1" mathsize="90%" xref="algorithm2.11.11.m1.1.1.cmml">0</mn><mo id="algorithm2.11.11.m1.2.3.3.3.2.2" mathsize="90%" xref="algorithm2.11.11.m1.2.3.3.3.1.cmml">,</mo><mi id="algorithm2.11.11.m1.2.2" mathsize="90%" xref="algorithm2.11.11.m1.2.2.cmml">I</mi><mo id="algorithm2.11.11.m1.2.3.3.3.2.3" maxsize="90%" minsize="90%" xref="algorithm2.11.11.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.m1.2b"><apply id="algorithm2.11.11.m1.2.3.cmml" xref="algorithm2.11.11.m1.2.3"><csymbol cd="latexml" id="algorithm2.11.11.m1.2.3.1.cmml" xref="algorithm2.11.11.m1.2.3.1">similar-to</csymbol><ci id="algorithm2.11.11.m1.2.3.2.cmml" xref="algorithm2.11.11.m1.2.3.2">italic-ϵ</ci><apply id="algorithm2.11.11.m1.2.3.3.cmml" xref="algorithm2.11.11.m1.2.3.3"><times id="algorithm2.11.11.m1.2.3.3.1.cmml" xref="algorithm2.11.11.m1.2.3.3.1"></times><ci id="algorithm2.11.11.m1.2.3.3.2.cmml" xref="algorithm2.11.11.m1.2.3.3.2">𝒩</ci><interval closure="open" id="algorithm2.11.11.m1.2.3.3.3.1.cmml" xref="algorithm2.11.11.m1.2.3.3.3.2"><cn id="algorithm2.11.11.m1.1.1.cmml" type="integer" xref="algorithm2.11.11.m1.1.1">0</cn><ci id="algorithm2.11.11.m1.2.2.cmml" xref="algorithm2.11.11.m1.2.2">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.m1.2c">\epsilon\sim\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.11.11.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , italic_I )</annotation></semantics></math><span class="ltx_text" id="algorithm2.11.11.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm2.12.12">
<span class="ltx_text" id="algorithm2.12.12.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm2.12.12.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm2.12.12.3" style="font-size:90%;">Perform the update: </span><math alttext="\mathbf{x}_{t-1}\leftarrow\mathbf{x}_{t}+\gamma\nabla\log\tilde{p}(\mathbf{x}_%
{t}|\mathbf{y},\mathbf{s})+\sqrt{2\gamma}\epsilon" class="ltx_Math" display="inline" id="algorithm2.12.12.m1.3"><semantics id="algorithm2.12.12.m1.3a"><mrow id="algorithm2.12.12.m1.3.3" xref="algorithm2.12.12.m1.3.3.cmml"><msub id="algorithm2.12.12.m1.3.3.3" xref="algorithm2.12.12.m1.3.3.3.cmml"><mi id="algorithm2.12.12.m1.3.3.3.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.3.2.cmml">𝐱</mi><mrow id="algorithm2.12.12.m1.3.3.3.3" xref="algorithm2.12.12.m1.3.3.3.3.cmml"><mi id="algorithm2.12.12.m1.3.3.3.3.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.3.3.2.cmml">t</mi><mo id="algorithm2.12.12.m1.3.3.3.3.1" mathsize="90%" xref="algorithm2.12.12.m1.3.3.3.3.1.cmml">−</mo><mn id="algorithm2.12.12.m1.3.3.3.3.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="algorithm2.12.12.m1.3.3.2" mathsize="90%" stretchy="false" xref="algorithm2.12.12.m1.3.3.2.cmml">←</mo><mrow id="algorithm2.12.12.m1.3.3.1" xref="algorithm2.12.12.m1.3.3.1.cmml"><msub id="algorithm2.12.12.m1.3.3.1.3" xref="algorithm2.12.12.m1.3.3.1.3.cmml"><mi id="algorithm2.12.12.m1.3.3.1.3.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.3.2.cmml">𝐱</mi><mi id="algorithm2.12.12.m1.3.3.1.3.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.3.3.cmml">t</mi></msub><mo id="algorithm2.12.12.m1.3.3.1.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.2.cmml">+</mo><mrow id="algorithm2.12.12.m1.3.3.1.1" xref="algorithm2.12.12.m1.3.3.1.1.cmml"><mi id="algorithm2.12.12.m1.3.3.1.1.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.3.cmml">γ</mi><mo id="algorithm2.12.12.m1.3.3.1.1.2" lspace="0.167em" xref="algorithm2.12.12.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="algorithm2.12.12.m1.3.3.1.1.4" xref="algorithm2.12.12.m1.3.3.1.1.4.cmml"><mrow id="algorithm2.12.12.m1.3.3.1.1.4.1" xref="algorithm2.12.12.m1.3.3.1.1.4.1.cmml"><mo id="algorithm2.12.12.m1.3.3.1.1.4.1.1" mathsize="90%" rspace="0.167em" xref="algorithm2.12.12.m1.3.3.1.1.4.1.1.cmml">∇</mo><mi id="algorithm2.12.12.m1.3.3.1.1.4.1.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.4.1.2.cmml">log</mi></mrow><mo id="algorithm2.12.12.m1.3.3.1.1.4a" lspace="0.167em" xref="algorithm2.12.12.m1.3.3.1.1.4.cmml">⁡</mo><mover accent="true" id="algorithm2.12.12.m1.3.3.1.1.4.2" xref="algorithm2.12.12.m1.3.3.1.1.4.2.cmml"><mi id="algorithm2.12.12.m1.3.3.1.1.4.2.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.4.2.2.cmml">p</mi><mo id="algorithm2.12.12.m1.3.3.1.1.4.2.1" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.4.2.1.cmml">~</mo></mover></mrow><mo id="algorithm2.12.12.m1.3.3.1.1.2a" xref="algorithm2.12.12.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="algorithm2.12.12.m1.3.3.1.1.1.1" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.cmml"><mo id="algorithm2.12.12.m1.3.3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="algorithm2.12.12.m1.3.3.1.1.1.1.1" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.cmml"><msub id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.cmml"><mi id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="algorithm2.12.12.m1.3.3.1.1.1.1.1.1" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.2" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="algorithm2.12.12.m1.1.1" mathsize="90%" xref="algorithm2.12.12.m1.1.1.cmml">𝐲</mi><mo id="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.2.1" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="algorithm2.12.12.m1.2.2" mathsize="90%" xref="algorithm2.12.12.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="algorithm2.12.12.m1.3.3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm2.12.12.m1.3.3.1.2a" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.2.cmml">+</mo><mrow id="algorithm2.12.12.m1.3.3.1.4" xref="algorithm2.12.12.m1.3.3.1.4.cmml"><msqrt id="algorithm2.12.12.m1.3.3.1.4.2" xref="algorithm2.12.12.m1.3.3.1.4.2.cmml"><mrow id="algorithm2.12.12.m1.3.3.1.4.2.2" xref="algorithm2.12.12.m1.3.3.1.4.2.2.cmml"><mn id="algorithm2.12.12.m1.3.3.1.4.2.2.2" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.4.2.2.2.cmml">2</mn><mo id="algorithm2.12.12.m1.3.3.1.4.2.2.1" xref="algorithm2.12.12.m1.3.3.1.4.2.2.1.cmml">⁢</mo><mi id="algorithm2.12.12.m1.3.3.1.4.2.2.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.4.2.2.3.cmml">γ</mi></mrow></msqrt><mo id="algorithm2.12.12.m1.3.3.1.4.1" xref="algorithm2.12.12.m1.3.3.1.4.1.cmml">⁢</mo><mi id="algorithm2.12.12.m1.3.3.1.4.3" mathsize="90%" xref="algorithm2.12.12.m1.3.3.1.4.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.m1.3b"><apply id="algorithm2.12.12.m1.3.3.cmml" xref="algorithm2.12.12.m1.3.3"><ci id="algorithm2.12.12.m1.3.3.2.cmml" xref="algorithm2.12.12.m1.3.3.2">←</ci><apply id="algorithm2.12.12.m1.3.3.3.cmml" xref="algorithm2.12.12.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.3.3.3.1.cmml" xref="algorithm2.12.12.m1.3.3.3">subscript</csymbol><ci id="algorithm2.12.12.m1.3.3.3.2.cmml" xref="algorithm2.12.12.m1.3.3.3.2">𝐱</ci><apply id="algorithm2.12.12.m1.3.3.3.3.cmml" xref="algorithm2.12.12.m1.3.3.3.3"><minus id="algorithm2.12.12.m1.3.3.3.3.1.cmml" xref="algorithm2.12.12.m1.3.3.3.3.1"></minus><ci id="algorithm2.12.12.m1.3.3.3.3.2.cmml" xref="algorithm2.12.12.m1.3.3.3.3.2">𝑡</ci><cn id="algorithm2.12.12.m1.3.3.3.3.3.cmml" type="integer" xref="algorithm2.12.12.m1.3.3.3.3.3">1</cn></apply></apply><apply id="algorithm2.12.12.m1.3.3.1.cmml" xref="algorithm2.12.12.m1.3.3.1"><plus id="algorithm2.12.12.m1.3.3.1.2.cmml" xref="algorithm2.12.12.m1.3.3.1.2"></plus><apply id="algorithm2.12.12.m1.3.3.1.3.cmml" xref="algorithm2.12.12.m1.3.3.1.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.3.3.1.3.1.cmml" xref="algorithm2.12.12.m1.3.3.1.3">subscript</csymbol><ci id="algorithm2.12.12.m1.3.3.1.3.2.cmml" xref="algorithm2.12.12.m1.3.3.1.3.2">𝐱</ci><ci id="algorithm2.12.12.m1.3.3.1.3.3.cmml" xref="algorithm2.12.12.m1.3.3.1.3.3">𝑡</ci></apply><apply id="algorithm2.12.12.m1.3.3.1.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1"><times id="algorithm2.12.12.m1.3.3.1.1.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.2"></times><ci id="algorithm2.12.12.m1.3.3.1.1.3.cmml" xref="algorithm2.12.12.m1.3.3.1.1.3">𝛾</ci><apply id="algorithm2.12.12.m1.3.3.1.1.4.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4"><apply id="algorithm2.12.12.m1.3.3.1.1.4.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.1"><ci id="algorithm2.12.12.m1.3.3.1.1.4.1.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.1.1">∇</ci><log id="algorithm2.12.12.m1.3.3.1.1.4.1.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.1.2"></log></apply><apply id="algorithm2.12.12.m1.3.3.1.1.4.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.2"><ci id="algorithm2.12.12.m1.3.3.1.1.4.2.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.2.1">~</ci><ci id="algorithm2.12.12.m1.3.3.1.1.4.2.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.4.2.2">𝑝</ci></apply></apply><apply id="algorithm2.12.12.m1.3.3.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="algorithm2.12.12.m1.3.3.1.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.1">conditional</csymbol><apply id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.2.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.2">𝐱</ci><ci id="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.3.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.2.3">𝑡</ci></apply><list id="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.1.cmml" xref="algorithm2.12.12.m1.3.3.1.1.1.1.1.3.2"><ci id="algorithm2.12.12.m1.1.1.cmml" xref="algorithm2.12.12.m1.1.1">𝐲</ci><ci id="algorithm2.12.12.m1.2.2.cmml" xref="algorithm2.12.12.m1.2.2">𝐬</ci></list></apply></apply><apply id="algorithm2.12.12.m1.3.3.1.4.cmml" xref="algorithm2.12.12.m1.3.3.1.4"><times id="algorithm2.12.12.m1.3.3.1.4.1.cmml" xref="algorithm2.12.12.m1.3.3.1.4.1"></times><apply id="algorithm2.12.12.m1.3.3.1.4.2.cmml" xref="algorithm2.12.12.m1.3.3.1.4.2"><root id="algorithm2.12.12.m1.3.3.1.4.2a.cmml" xref="algorithm2.12.12.m1.3.3.1.4.2"></root><apply id="algorithm2.12.12.m1.3.3.1.4.2.2.cmml" xref="algorithm2.12.12.m1.3.3.1.4.2.2"><times id="algorithm2.12.12.m1.3.3.1.4.2.2.1.cmml" xref="algorithm2.12.12.m1.3.3.1.4.2.2.1"></times><cn id="algorithm2.12.12.m1.3.3.1.4.2.2.2.cmml" type="integer" xref="algorithm2.12.12.m1.3.3.1.4.2.2.2">2</cn><ci id="algorithm2.12.12.m1.3.3.1.4.2.2.3.cmml" xref="algorithm2.12.12.m1.3.3.1.4.2.2.3">𝛾</ci></apply></apply><ci id="algorithm2.12.12.m1.3.3.1.4.3.cmml" xref="algorithm2.12.12.m1.3.3.1.4.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.m1.3c">\mathbf{x}_{t-1}\leftarrow\mathbf{x}_{t}+\gamma\nabla\log\tilde{p}(\mathbf{x}_%
{t}|\mathbf{y},\mathbf{s})+\sqrt{2\gamma}\epsilon</annotation><annotation encoding="application/x-llamapun" id="algorithm2.12.12.m1.3d">bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ← bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ ∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) + square-root start_ARG 2 italic_γ end_ARG italic_ϵ</annotation></semantics></math><span class="ltx_text" id="algorithm2.12.12.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm2.13.16">
<span class="ltx_text" id="algorithm2.13.16.1" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm2.13.13">
<span class="ltx_text ltx_font_bold" id="algorithm2.13.13.1" style="font-size:90%;">return</span><span class="ltx_text" id="algorithm2.13.13.2" style="font-size:90%;"> </span><math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="algorithm2.13.13.m1.1"><semantics id="algorithm2.13.13.m1.1a"><msub id="algorithm2.13.13.m1.1.1" xref="algorithm2.13.13.m1.1.1.cmml"><mi id="algorithm2.13.13.m1.1.1.2" mathsize="90%" xref="algorithm2.13.13.m1.1.1.2.cmml">𝐱</mi><mn id="algorithm2.13.13.m1.1.1.3" mathsize="90%" xref="algorithm2.13.13.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.m1.1b"><apply id="algorithm2.13.13.m1.1.1.cmml" xref="algorithm2.13.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.1.cmml" xref="algorithm2.13.13.m1.1.1">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.2.cmml" xref="algorithm2.13.13.m1.1.1.2">𝐱</ci><cn id="algorithm2.13.13.m1.1.1.3.cmml" type="integer" xref="algorithm2.13.13.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.13.13.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm2.13.13.3" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm2.17.1.1">Algorithm 2</span> </span>ID-Preserving Sampling Alg.</figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To summarize, our proposed loss function consists of four terms: the one-step reconstruction term, the denoising term, the inner-product term, and a constant. Intuitively, the denoising term, along with the one-step reconstruction term, aims to improve the generative quality by denoising the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_t</annotation></semantics></math>-step noisified face images while the inner-product term encourages the face embedding of the denoisified images to get close to the groundtruth identity embedding. To understand this loss function systematically, we theoretically find that minimizing this proposed loss function is equivalent to the maximization of the lower bound of an adjusted conditional log-likelihood over identity-preserving face images, which further leads us to an ID-preserving sampling algorithm.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.1.1.1">Theorem 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.3"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.3.3">Minimizing <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.1.m1.1d">caligraphic_L</annotation></semantics></math> with regard to <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.2.m2.1"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml">𝛉</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1">𝛉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.2.m2.1d">bold_italic_θ</annotation></semantics></math> is equivalent to minimizing the upper bound of an adjusted conditional data negative log-likelihood <math alttext="-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.3.m3.3"><semantics id="S3.Thmtheorem1.p1.3.3.m3.3a"><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.cmml"><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3a" rspace="0.167em" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.cmml">−</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.cmml"><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.1.cmml">log</mi><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3a" lspace="0.167em" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.cmml">⁡</mo><mover accent="true" id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.2.cmml">p</mi><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.cmml"><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.2" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.2" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml">𝐲</mi><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.2.1" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Thmtheorem1.p1.3.3.m3.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.3" stretchy="false" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.3b"><apply id="S3.Thmtheorem1.p1.3.3.m3.3.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3"><minus id="S3.Thmtheorem1.p1.3.3.m3.3.3.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3"></minus><apply id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1"><times id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.2"></times><apply id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3"><log id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.1"></log><apply id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2"><ci id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.1">~</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.3.2.2">𝑝</ci></apply></apply><apply id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.2">𝐱</ci><list id="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.3.3.1.1.1.1.3.2"><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1">𝐲</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.2.2">𝐬</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.3c">-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.3.m3.3d">- roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math>, i.e.:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\bm{\theta}}\mathcal{L}(\mathbf{x}_{0},\mathbf{y},\mathbf{s})\geq-\log%
\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="block" id="S3.E5.m1.6"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.cmml"><mrow id="S3.E5.m1.5.5.1.3" xref="S3.E5.m1.5.5.1.3.cmml"><munder id="S3.E5.m1.5.5.1.3.1" xref="S3.E5.m1.5.5.1.3.1.cmml"><mi id="S3.E5.m1.5.5.1.3.1.2" xref="S3.E5.m1.5.5.1.3.1.2.cmml">min</mi><mi id="S3.E5.m1.5.5.1.3.1.3" xref="S3.E5.m1.5.5.1.3.1.3.cmml">𝜽</mi></munder><mo id="S3.E5.m1.5.5.1.3a" lspace="0.167em" xref="S3.E5.m1.5.5.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.3.2" xref="S3.E5.m1.5.5.1.3.2.cmml">ℒ</mi></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.2.cmml"><mo id="S3.E5.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.cmml">(</mo><msub id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.E5.m1.5.5.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.2.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝐲</mi><mo id="S3.E5.m1.5.5.1.1.1.4" xref="S3.E5.m1.5.5.1.1.2.cmml">,</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">𝐬</mi><mo id="S3.E5.m1.5.5.1.1.1.5" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.3" xref="S3.E5.m1.6.6.3.cmml">≥</mo><mrow id="S3.E5.m1.6.6.2" xref="S3.E5.m1.6.6.2.cmml"><mo id="S3.E5.m1.6.6.2a" rspace="0.167em" xref="S3.E5.m1.6.6.2.cmml">−</mo><mrow id="S3.E5.m1.6.6.2.1" xref="S3.E5.m1.6.6.2.1.cmml"><mrow id="S3.E5.m1.6.6.2.1.3" xref="S3.E5.m1.6.6.2.1.3.cmml"><mi id="S3.E5.m1.6.6.2.1.3.1" xref="S3.E5.m1.6.6.2.1.3.1.cmml">log</mi><mo id="S3.E5.m1.6.6.2.1.3a" lspace="0.167em" xref="S3.E5.m1.6.6.2.1.3.cmml">⁡</mo><mover accent="true" id="S3.E5.m1.6.6.2.1.3.2" xref="S3.E5.m1.6.6.2.1.3.2.cmml"><mi id="S3.E5.m1.6.6.2.1.3.2.2" xref="S3.E5.m1.6.6.2.1.3.2.2.cmml">p</mi><mo id="S3.E5.m1.6.6.2.1.3.2.1" xref="S3.E5.m1.6.6.2.1.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.E5.m1.6.6.2.1.2" xref="S3.E5.m1.6.6.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.2.1.1.1" xref="S3.E5.m1.6.6.2.1.1.1.1.cmml"><mo id="S3.E5.m1.6.6.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.6.6.2.1.1.1.1" xref="S3.E5.m1.6.6.2.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.2.1.1.1.1.2" xref="S3.E5.m1.6.6.2.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.E5.m1.6.6.2.1.1.1.1.1" xref="S3.E5.m1.6.6.2.1.1.1.1.1.cmml">|</mo><mrow id="S3.E5.m1.6.6.2.1.1.1.1.3.2" xref="S3.E5.m1.6.6.2.1.1.1.1.3.1.cmml"><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">𝐲</mi><mo id="S3.E5.m1.6.6.2.1.1.1.1.3.2.1" xref="S3.E5.m1.6.6.2.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">𝐬</mi></mrow></mrow><mo id="S3.E5.m1.6.6.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6"><geq id="S3.E5.m1.6.6.3.cmml" xref="S3.E5.m1.6.6.3"></geq><apply id="S3.E5.m1.5.5.1.cmml" xref="S3.E5.m1.5.5.1"><times id="S3.E5.m1.5.5.1.2.cmml" xref="S3.E5.m1.5.5.1.2"></times><apply id="S3.E5.m1.5.5.1.3.cmml" xref="S3.E5.m1.5.5.1.3"><apply id="S3.E5.m1.5.5.1.3.1.cmml" xref="S3.E5.m1.5.5.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.3.1.1.cmml" xref="S3.E5.m1.5.5.1.3.1">subscript</csymbol><min id="S3.E5.m1.5.5.1.3.1.2.cmml" xref="S3.E5.m1.5.5.1.3.1.2"></min><ci id="S3.E5.m1.5.5.1.3.1.3.cmml" xref="S3.E5.m1.5.5.1.3.1.3">𝜽</ci></apply><ci id="S3.E5.m1.5.5.1.3.2.cmml" xref="S3.E5.m1.5.5.1.3.2">ℒ</ci></apply><vector id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1"><apply id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.2">𝐱</ci><cn id="S3.E5.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.5.5.1.1.1.1.3">0</cn></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐲</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝐬</ci></vector></apply><apply id="S3.E5.m1.6.6.2.cmml" xref="S3.E5.m1.6.6.2"><minus id="S3.E5.m1.6.6.2.2.cmml" xref="S3.E5.m1.6.6.2"></minus><apply id="S3.E5.m1.6.6.2.1.cmml" xref="S3.E5.m1.6.6.2.1"><times id="S3.E5.m1.6.6.2.1.2.cmml" xref="S3.E5.m1.6.6.2.1.2"></times><apply id="S3.E5.m1.6.6.2.1.3.cmml" xref="S3.E5.m1.6.6.2.1.3"><log id="S3.E5.m1.6.6.2.1.3.1.cmml" xref="S3.E5.m1.6.6.2.1.3.1"></log><apply id="S3.E5.m1.6.6.2.1.3.2.cmml" xref="S3.E5.m1.6.6.2.1.3.2"><ci id="S3.E5.m1.6.6.2.1.3.2.1.cmml" xref="S3.E5.m1.6.6.2.1.3.2.1">~</ci><ci id="S3.E5.m1.6.6.2.1.3.2.2.cmml" xref="S3.E5.m1.6.6.2.1.3.2.2">𝑝</ci></apply></apply><apply id="S3.E5.m1.6.6.2.1.1.1.1.cmml" xref="S3.E5.m1.6.6.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.2.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E5.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1.2">𝐱</ci><list id="S3.E5.m1.6.6.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.2.1.1.1.1.3.2"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝐲</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝐬</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\min_{\bm{\theta}}\mathcal{L}(\mathbf{x}_{0},\mathbf{y},\mathbf{s})\geq-\log%
\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.6d">roman_min start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT caligraphic_L ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) ≥ - roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.Thmtheorem1.p1.4"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem1.p1.4.1">where</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})\propto p(\mathbf{x}|\mathbf{y},%
\mathbf{s})\cdot p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}" class="ltx_Math" display="block" id="S3.E6.m1.8"><semantics id="S3.E6.m1.8a"><mrow id="S3.E6.m1.8.8" xref="S3.E6.m1.8.8.cmml"><mrow id="S3.E6.m1.6.6.1" xref="S3.E6.m1.6.6.1.cmml"><mover accent="true" id="S3.E6.m1.6.6.1.3" xref="S3.E6.m1.6.6.1.3.cmml"><mi id="S3.E6.m1.6.6.1.3.2" xref="S3.E6.m1.6.6.1.3.2.cmml">p</mi><mo id="S3.E6.m1.6.6.1.3.1" xref="S3.E6.m1.6.6.1.3.1.cmml">~</mo></mover><mo id="S3.E6.m1.6.6.1.2" xref="S3.E6.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.cmml"><mo id="S3.E6.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.6.6.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.E6.m1.6.6.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.cmml">|</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.1.3.1.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐲</mi><mo id="S3.E6.m1.6.6.1.1.1.1.3.2.1" xref="S3.E6.m1.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.E6.m1.6.6.1.1.1.3" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.4" xref="S3.E6.m1.8.8.4.cmml">∝</mo><mrow id="S3.E6.m1.8.8.3" xref="S3.E6.m1.8.8.3.cmml"><mrow id="S3.E6.m1.7.7.2.1" xref="S3.E6.m1.7.7.2.1.cmml"><mrow id="S3.E6.m1.7.7.2.1.1" xref="S3.E6.m1.7.7.2.1.1.cmml"><mi id="S3.E6.m1.7.7.2.1.1.3" xref="S3.E6.m1.7.7.2.1.1.3.cmml">p</mi><mo id="S3.E6.m1.7.7.2.1.1.2" xref="S3.E6.m1.7.7.2.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.2.1.1.1.1" xref="S3.E6.m1.7.7.2.1.1.1.1.1.cmml"><mo id="S3.E6.m1.7.7.2.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.7.7.2.1.1.1.1.1" xref="S3.E6.m1.7.7.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.2.1.1.1.1.1.2" xref="S3.E6.m1.7.7.2.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.E6.m1.7.7.2.1.1.1.1.1.1" xref="S3.E6.m1.7.7.2.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.E6.m1.7.7.2.1.1.1.1.1.3.2" xref="S3.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml"><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐲</mi><mo id="S3.E6.m1.7.7.2.1.1.1.1.1.3.2.1" xref="S3.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">𝐬</mi></mrow></mrow><mo id="S3.E6.m1.7.7.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E6.m1.7.7.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.2.1.2" rspace="0.222em" xref="S3.E6.m1.7.7.2.1.2.cmml">⋅</mo><mi id="S3.E6.m1.7.7.2.1.3" xref="S3.E6.m1.7.7.2.1.3.cmml">p</mi></mrow><mo id="S3.E6.m1.8.8.3.3" xref="S3.E6.m1.8.8.3.3.cmml">⁢</mo><msup id="S3.E6.m1.8.8.3.2" xref="S3.E6.m1.8.8.3.2.cmml"><mrow id="S3.E6.m1.8.8.3.2.1.1" xref="S3.E6.m1.8.8.3.2.1.2.cmml"><mo id="S3.E6.m1.8.8.3.2.1.1.2" stretchy="false" xref="S3.E6.m1.8.8.3.2.1.2.cmml">(</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">𝐲</mi><mo id="S3.E6.m1.8.8.3.2.1.1.3" xref="S3.E6.m1.8.8.3.2.1.2.cmml">,</mo><mrow id="S3.E6.m1.8.8.3.2.1.1.1" xref="S3.E6.m1.8.8.3.2.1.1.1.cmml"><mi id="S3.E6.m1.8.8.3.2.1.1.1.2" xref="S3.E6.m1.8.8.3.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="S3.E6.m1.8.8.3.2.1.1.1.1" xref="S3.E6.m1.8.8.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E6.m1.8.8.3.2.1.1.1.3" xref="S3.E6.m1.8.8.3.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.E6.m1.8.8.3.2.1.1.4" stretchy="false" xref="S3.E6.m1.8.8.3.2.1.2.cmml">)</mo></mrow><mfrac id="S3.E6.m1.8.8.3.2.3" xref="S3.E6.m1.8.8.3.2.3.cmml"><mrow id="S3.E6.m1.8.8.3.2.3.2" xref="S3.E6.m1.8.8.3.2.3.2.cmml"><mstyle displaystyle="false" id="S3.E6.m1.8.8.3.2.3.2.1" xref="S3.E6.m1.8.8.3.2.3.2.1.cmml"><msubsup id="S3.E6.m1.8.8.3.2.3.2.1a" xref="S3.E6.m1.8.8.3.2.3.2.1.cmml"><mo id="S3.E6.m1.8.8.3.2.3.2.1.2.2" xref="S3.E6.m1.8.8.3.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.8.8.3.2.3.2.1.2.3" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.cmml"><mi id="S3.E6.m1.8.8.3.2.3.2.1.2.3.2" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.2.cmml">t</mi><mo id="S3.E6.m1.8.8.3.2.3.2.1.2.3.1" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.8.8.3.2.3.2.1.2.3.3" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="S3.E6.m1.8.8.3.2.3.2.1.3" xref="S3.E6.m1.8.8.3.2.3.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="S3.E6.m1.8.8.3.2.3.2.2" xref="S3.E6.m1.8.8.3.2.3.2.2.cmml"><mi id="S3.E6.m1.8.8.3.2.3.2.2.2" xref="S3.E6.m1.8.8.3.2.3.2.2.2.cmml">λ</mi><mi id="S3.E6.m1.8.8.3.2.3.2.2.3" xref="S3.E6.m1.8.8.3.2.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E6.m1.8.8.3.2.3.3" xref="S3.E6.m1.8.8.3.2.3.3.cmml"><mi id="S3.E6.m1.8.8.3.2.3.3.2" xref="S3.E6.m1.8.8.3.2.3.3.2.cmml">T</mi><mo id="S3.E6.m1.8.8.3.2.3.3.1" xref="S3.E6.m1.8.8.3.2.3.3.1.cmml">−</mo><mn id="S3.E6.m1.8.8.3.2.3.3.3" xref="S3.E6.m1.8.8.3.2.3.3.3.cmml">1</mn></mrow></mfrac></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.8b"><apply id="S3.E6.m1.8.8.cmml" xref="S3.E6.m1.8.8"><csymbol cd="latexml" id="S3.E6.m1.8.8.4.cmml" xref="S3.E6.m1.8.8.4">proportional-to</csymbol><apply id="S3.E6.m1.6.6.1.cmml" xref="S3.E6.m1.6.6.1"><times id="S3.E6.m1.6.6.1.2.cmml" xref="S3.E6.m1.6.6.1.2"></times><apply id="S3.E6.m1.6.6.1.3.cmml" xref="S3.E6.m1.6.6.1.3"><ci id="S3.E6.m1.6.6.1.3.1.cmml" xref="S3.E6.m1.6.6.1.3.1">~</ci><ci id="S3.E6.m1.6.6.1.3.2.cmml" xref="S3.E6.m1.6.6.1.3.2">𝑝</ci></apply><apply id="S3.E6.m1.6.6.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.6.6.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.2">𝐱</ci><list id="S3.E6.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐲</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝐬</ci></list></apply></apply><apply id="S3.E6.m1.8.8.3.cmml" xref="S3.E6.m1.8.8.3"><times id="S3.E6.m1.8.8.3.3.cmml" xref="S3.E6.m1.8.8.3.3"></times><apply id="S3.E6.m1.7.7.2.1.cmml" xref="S3.E6.m1.7.7.2.1"><ci id="S3.E6.m1.7.7.2.1.2.cmml" xref="S3.E6.m1.7.7.2.1.2">⋅</ci><apply id="S3.E6.m1.7.7.2.1.1.cmml" xref="S3.E6.m1.7.7.2.1.1"><times id="S3.E6.m1.7.7.2.1.1.2.cmml" xref="S3.E6.m1.7.7.2.1.1.2"></times><ci id="S3.E6.m1.7.7.2.1.1.3.cmml" xref="S3.E6.m1.7.7.2.1.1.3">𝑝</ci><apply id="S3.E6.m1.7.7.2.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.2.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.7.7.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.2.1.1.1.1.1.2">𝐱</ci><list id="S3.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.2.1.1.1.1.1.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐲</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝐬</ci></list></apply></apply><ci id="S3.E6.m1.7.7.2.1.3.cmml" xref="S3.E6.m1.7.7.2.1.3">𝑝</ci></apply><apply id="S3.E6.m1.8.8.3.2.cmml" xref="S3.E6.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.3.2.2.cmml" xref="S3.E6.m1.8.8.3.2">superscript</csymbol><interval closure="open" id="S3.E6.m1.8.8.3.2.1.2.cmml" xref="S3.E6.m1.8.8.3.2.1.1"><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝐲</ci><apply id="S3.E6.m1.8.8.3.2.1.1.1.cmml" xref="S3.E6.m1.8.8.3.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.8.8.3.2.1.1.1.1.cmml" xref="S3.E6.m1.8.8.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.8.8.3.2.1.1.1.2.cmml" xref="S3.E6.m1.8.8.3.2.1.1.1.2">𝐬</ci><ci id="S3.E6.m1.8.8.3.2.1.1.1.3.cmml" xref="S3.E6.m1.8.8.3.2.1.1.1.3">𝐱</ci></apply></interval><apply id="S3.E6.m1.8.8.3.2.3.cmml" xref="S3.E6.m1.8.8.3.2.3"><divide id="S3.E6.m1.8.8.3.2.3.1.cmml" xref="S3.E6.m1.8.8.3.2.3"></divide><apply id="S3.E6.m1.8.8.3.2.3.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2"><apply id="S3.E6.m1.8.8.3.2.3.2.1.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.3.2.3.2.1.1.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1">superscript</csymbol><apply id="S3.E6.m1.8.8.3.2.3.2.1.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.3.2.3.2.1.2.1.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1">subscript</csymbol><sum id="S3.E6.m1.8.8.3.2.3.2.1.2.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1.2.2"></sum><apply id="S3.E6.m1.8.8.3.2.3.2.1.2.3.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3"><eq id="S3.E6.m1.8.8.3.2.3.2.1.2.3.1.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.1"></eq><ci id="S3.E6.m1.8.8.3.2.3.2.1.2.3.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.2">𝑡</ci><cn id="S3.E6.m1.8.8.3.2.3.2.1.2.3.3.cmml" type="integer" xref="S3.E6.m1.8.8.3.2.3.2.1.2.3.3">2</cn></apply></apply><ci id="S3.E6.m1.8.8.3.2.3.2.1.3.cmml" xref="S3.E6.m1.8.8.3.2.3.2.1.3">𝑇</ci></apply><apply id="S3.E6.m1.8.8.3.2.3.2.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.3.2.3.2.2.1.cmml" xref="S3.E6.m1.8.8.3.2.3.2.2">subscript</csymbol><ci id="S3.E6.m1.8.8.3.2.3.2.2.2.cmml" xref="S3.E6.m1.8.8.3.2.3.2.2.2">𝜆</ci><ci id="S3.E6.m1.8.8.3.2.3.2.2.3.cmml" xref="S3.E6.m1.8.8.3.2.3.2.2.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.8.8.3.2.3.3.cmml" xref="S3.E6.m1.8.8.3.2.3.3"><minus id="S3.E6.m1.8.8.3.2.3.3.1.cmml" xref="S3.E6.m1.8.8.3.2.3.3.1"></minus><ci id="S3.E6.m1.8.8.3.2.3.3.2.cmml" xref="S3.E6.m1.8.8.3.2.3.3.2">𝑇</ci><cn id="S3.E6.m1.8.8.3.2.3.3.3.cmml" type="integer" xref="S3.E6.m1.8.8.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.8c">\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})\propto p(\mathbf{x}|\mathbf{y},%
\mathbf{s})\cdot p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.8d">over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s ) ∝ italic_p ( bold_x | bold_y , bold_s ) ⋅ italic_p ( bold_y , bold_s | bold_x ) start_POSTSUPERSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S3.SS3.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.SS3.1.p1">
<p class="ltx_p" id="S3.SS3.1.p1.1">The proof can be found in Appendix A.
∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.3"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.3.1">Remark.</span> We have just shown that our proposed loss is the upper bound of an adjusted conditional negative data log-likelihood.
This adjusted likelihood <math alttext="\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.3"><semantics id="S3.SS3.p3.1.m1.3a"><mrow id="S3.SS3.p3.1.m1.3.3" xref="S3.SS3.p3.1.m1.3.3.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.3.3.3" xref="S3.SS3.p3.1.m1.3.3.3.cmml"><mi id="S3.SS3.p3.1.m1.3.3.3.2" xref="S3.SS3.p3.1.m1.3.3.3.2.cmml">p</mi><mo id="S3.SS3.p3.1.m1.3.3.3.1" xref="S3.SS3.p3.1.m1.3.3.3.1.cmml">~</mo></mover><mo id="S3.SS3.p3.1.m1.3.3.2" xref="S3.SS3.p3.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS3.p3.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS3.p3.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.3.3.1.1.1.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.SS3.p3.1.m1.3.3.1.1.1.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p3.1.m1.3.3.1.1.1.3.2" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">𝐲</mi><mo id="S3.SS3.p3.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p3.1.m1.2.2" xref="S3.SS3.p3.1.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS3.p3.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS3.p3.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.3b"><apply id="S3.SS3.p3.1.m1.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3"><times id="S3.SS3.p3.1.m1.3.3.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2"></times><apply id="S3.SS3.p3.1.m1.3.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3.3"><ci id="S3.SS3.p3.1.m1.3.3.3.1.cmml" xref="S3.SS3.p3.1.m1.3.3.3.1">~</ci><ci id="S3.SS3.p3.1.m1.3.3.3.2.cmml" xref="S3.SS3.p3.1.m1.3.3.3.2">𝑝</ci></apply><apply id="S3.SS3.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.2">𝐱</ci><list id="S3.SS3.p3.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐲</ci><ci id="S3.SS3.p3.1.m1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.3c">\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.3d">over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math> can be factorized into the original likelihood <math alttext="p(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.3"><semantics id="S3.SS3.p3.2.m2.3a"><mrow id="S3.SS3.p3.2.m2.3.3" xref="S3.SS3.p3.2.m2.3.3.cmml"><mi id="S3.SS3.p3.2.m2.3.3.3" xref="S3.SS3.p3.2.m2.3.3.3.cmml">p</mi><mo id="S3.SS3.p3.2.m2.3.3.2" xref="S3.SS3.p3.2.m2.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.p3.2.m2.3.3.1.1" xref="S3.SS3.p3.2.m2.3.3.1.1.1.cmml"><mo id="S3.SS3.p3.2.m2.3.3.1.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.2.m2.3.3.1.1.1" xref="S3.SS3.p3.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.3.3.1.1.1.2" xref="S3.SS3.p3.2.m2.3.3.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.SS3.p3.2.m2.3.3.1.1.1.1" xref="S3.SS3.p3.2.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p3.2.m2.3.3.1.1.1.3.2" xref="S3.SS3.p3.2.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">𝐲</mi><mo id="S3.SS3.p3.2.m2.3.3.1.1.1.3.2.1" xref="S3.SS3.p3.2.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS3.p3.2.m2.3.3.1.1.3" stretchy="false" xref="S3.SS3.p3.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.3b"><apply id="S3.SS3.p3.2.m2.3.3.cmml" xref="S3.SS3.p3.2.m2.3.3"><times id="S3.SS3.p3.2.m2.3.3.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2"></times><ci id="S3.SS3.p3.2.m2.3.3.3.cmml" xref="S3.SS3.p3.2.m2.3.3.3">𝑝</ci><apply id="S3.SS3.p3.2.m2.3.3.1.1.1.cmml" xref="S3.SS3.p3.2.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p3.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.3.3.1.1.1.2">𝐱</ci><list id="S3.SS3.p3.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.3.3.1.1.1.3.2"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐲</ci><ci id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.3c">p(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.3d">italic_p ( bold_x | bold_y , bold_s )</annotation></semantics></math> and a reversed likelihood <math alttext="p(\mathbf{y},\mathbf{s}|\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.2"><semantics id="S3.SS3.p3.3.m3.2a"><mrow id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml"><mi id="S3.SS3.p3.3.m3.2.2.3" xref="S3.SS3.p3.3.m3.2.2.3.cmml">p</mi><mo id="S3.SS3.p3.3.m3.2.2.2" xref="S3.SS3.p3.3.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p3.3.m3.2.2.1.1" xref="S3.SS3.p3.3.m3.2.2.1.2.cmml"><mo id="S3.SS3.p3.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">𝐲</mi><mo id="S3.SS3.p3.3.m3.2.2.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.2.cmml">,</mo><mrow id="S3.SS3.p3.3.m3.2.2.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.2" xref="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="S3.SS3.p3.3.m3.2.2.1.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.SS3.p3.3.m3.2.2.1.1.4" stretchy="false" xref="S3.SS3.p3.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.2b"><apply id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2"><times id="S3.SS3.p3.3.m3.2.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2.2"></times><ci id="S3.SS3.p3.3.m3.2.2.3.cmml" xref="S3.SS3.p3.3.m3.2.2.3">𝑝</ci><interval closure="open" id="S3.SS3.p3.3.m3.2.2.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝐲</ci><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.2">𝐬</ci><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.3">𝐱</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.2c">p(\mathbf{y},\mathbf{s}|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.2d">italic_p ( bold_y , bold_s | bold_x )</annotation></semantics></math> with some positive power.
We term it as “adjusted” since the original likelihood is discounted by the reversed likelihood.
Intuitively, the reversed likelihood shifts the original likelihood such that the adjusted likelihood covers ID-preserving data, which is attributed to the inner-product term we introduce into the loss function in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E2" title='Equation 2 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>ID-Preserving Sampling</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.4">Theorem <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.Thmtheorem1" title='Theorem 3.1. ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3.1</span></a> provides insights for designing a novel sampling algorithm in the spirit of Langevin dynamics applied on the adjusted conditional likelihood <math alttext="\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.3"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3" xref="S3.SS4.p1.1.m1.3.3.cmml"><mover accent="true" id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.cmml"><mi id="S3.SS4.p1.1.m1.3.3.3.2" xref="S3.SS4.p1.1.m1.3.3.3.2.cmml">p</mi><mo id="S3.SS4.p1.1.m1.3.3.3.1" xref="S3.SS4.p1.1.m1.3.3.3.1.cmml">~</mo></mover><mo id="S3.SS4.p1.1.m1.3.3.2" xref="S3.SS4.p1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS4.p1.1.m1.3.3.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS4.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.1.m1.3.3.1.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml"><msub id="S3.SS4.p1.1.m1.3.3.1.1.1.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml"><mi id="S3.SS4.p1.1.m1.3.3.1.1.1.2.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.1.m1.3.3.1.1.1.2.3" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS4.p1.1.m1.3.3.1.1.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS4.p1.1.m1.3.3.1.1.1.3.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">𝐲</mi><mo id="S3.SS4.p1.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS4.p1.1.m1.2.2" xref="S3.SS4.p1.1.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS4.p1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><apply id="S3.SS4.p1.1.m1.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3"><times id="S3.SS4.p1.1.m1.3.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2"></times><apply id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3"><ci id="S3.SS4.p1.1.m1.3.3.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.3.1">~</ci><ci id="S3.SS4.p1.1.m1.3.3.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.3.2">𝑝</ci></apply><apply id="S3.SS4.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS4.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.2">𝐱</ci><ci id="S3.SS4.p1.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.3">𝑡</ci></apply><list id="S3.SS4.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝐲</ci><ci id="S3.SS4.p1.1.m1.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.3d">over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math>. We note that Langevin dynamics can generate new samples from a probability density <math alttext="p" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_p</annotation></semantics></math> by virtue of its score function (i.e., the gradient of the logarithm of the probability density w.r.t. the sample, <math alttext="\nabla_{\mathbf{x}}{\log p}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mrow id="S3.SS4.p1.3.m3.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.cmml"><msub id="S3.SS4.p1.3.m3.1.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.1.cmml"><mo id="S3.SS4.p1.3.m3.1.1.1.1.2" xref="S3.SS4.p1.3.m3.1.1.1.1.2.cmml">∇</mo><mi id="S3.SS4.p1.3.m3.1.1.1.1.3" xref="S3.SS4.p1.3.m3.1.1.1.1.3.cmml">𝐱</mi></msub><mi id="S3.SS4.p1.3.m3.1.1.1.2" xref="S3.SS4.p1.3.m3.1.1.1.2.cmml">log</mi></mrow><mo id="S3.SS4.p1.3.m3.1.1a" lspace="0.167em" xref="S3.SS4.p1.3.m3.1.1.cmml">⁡</mo><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><apply id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1"><apply id="S3.SS4.p1.3.m3.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1.2">∇</ci><ci id="S3.SS4.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1.3">𝐱</ci></apply><log id="S3.SS4.p1.3.m3.1.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.1.2"></log></apply><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\nabla_{\mathbf{x}}{\log p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">∇ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT roman_log italic_p</annotation></semantics></math>). Motivated by this observation, we aim to find the score function of the adjusted likelihood for sample generation. Specifically, taking the logarithm and the gradient w.r.t. <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">bold_x</annotation></semantics></math> on both sides of Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E6" title='Equation 6 ‣ Theorem 3.1. ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">6</span></a>) yields</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})=\nabla\log p(\mathbf{x}|%
\mathbf{y},\mathbf{s})+\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\nabla\log p(%
\mathbf{y},\mathbf{s}|\mathbf{x})" class="ltx_Math" display="block" id="S3.E7.m1.8"><semantics id="S3.E7.m1.8a"><mrow id="S3.E7.m1.8.8" xref="S3.E7.m1.8.8.cmml"><mrow id="S3.E7.m1.6.6.1" xref="S3.E7.m1.6.6.1.cmml"><mrow id="S3.E7.m1.6.6.1.3" xref="S3.E7.m1.6.6.1.3.cmml"><mrow id="S3.E7.m1.6.6.1.3.1" xref="S3.E7.m1.6.6.1.3.1.cmml"><mo id="S3.E7.m1.6.6.1.3.1.1" rspace="0.167em" xref="S3.E7.m1.6.6.1.3.1.1.cmml">∇</mo><mi id="S3.E7.m1.6.6.1.3.1.2" xref="S3.E7.m1.6.6.1.3.1.2.cmml">log</mi></mrow><mo id="S3.E7.m1.6.6.1.3a" lspace="0.167em" xref="S3.E7.m1.6.6.1.3.cmml">⁡</mo><mover accent="true" id="S3.E7.m1.6.6.1.3.2" xref="S3.E7.m1.6.6.1.3.2.cmml"><mi id="S3.E7.m1.6.6.1.3.2.2" xref="S3.E7.m1.6.6.1.3.2.2.cmml">p</mi><mo id="S3.E7.m1.6.6.1.3.2.1" xref="S3.E7.m1.6.6.1.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.E7.m1.6.6.1.2" xref="S3.E7.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.6.6.1.1.1" xref="S3.E7.m1.6.6.1.1.1.1.cmml"><mo id="S3.E7.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E7.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.6.6.1.1.1.1" xref="S3.E7.m1.6.6.1.1.1.1.cmml"><mi id="S3.E7.m1.6.6.1.1.1.1.2" xref="S3.E7.m1.6.6.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.E7.m1.6.6.1.1.1.1.1" xref="S3.E7.m1.6.6.1.1.1.1.1.cmml">|</mo><mrow id="S3.E7.m1.6.6.1.1.1.1.3.2" xref="S3.E7.m1.6.6.1.1.1.1.3.1.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝐲</mi><mo id="S3.E7.m1.6.6.1.1.1.1.3.2.1" xref="S3.E7.m1.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.E7.m1.6.6.1.1.1.3" stretchy="false" xref="S3.E7.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.8.8.4" xref="S3.E7.m1.8.8.4.cmml">=</mo><mrow id="S3.E7.m1.8.8.3" xref="S3.E7.m1.8.8.3.cmml"><mrow id="S3.E7.m1.7.7.2.1" xref="S3.E7.m1.7.7.2.1.cmml"><mrow id="S3.E7.m1.7.7.2.1.3" xref="S3.E7.m1.7.7.2.1.3.cmml"><mrow id="S3.E7.m1.7.7.2.1.3.1" xref="S3.E7.m1.7.7.2.1.3.1.cmml"><mo id="S3.E7.m1.7.7.2.1.3.1.1" rspace="0.167em" xref="S3.E7.m1.7.7.2.1.3.1.1.cmml">∇</mo><mi id="S3.E7.m1.7.7.2.1.3.1.2" xref="S3.E7.m1.7.7.2.1.3.1.2.cmml">log</mi></mrow><mo id="S3.E7.m1.7.7.2.1.3a" lspace="0.167em" xref="S3.E7.m1.7.7.2.1.3.cmml">⁡</mo><mi id="S3.E7.m1.7.7.2.1.3.2" xref="S3.E7.m1.7.7.2.1.3.2.cmml">p</mi></mrow><mo id="S3.E7.m1.7.7.2.1.2" xref="S3.E7.m1.7.7.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.7.7.2.1.1.1" xref="S3.E7.m1.7.7.2.1.1.1.1.cmml"><mo id="S3.E7.m1.7.7.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.7.7.2.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.7.7.2.1.1.1.1" xref="S3.E7.m1.7.7.2.1.1.1.1.cmml"><mi id="S3.E7.m1.7.7.2.1.1.1.1.2" xref="S3.E7.m1.7.7.2.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.E7.m1.7.7.2.1.1.1.1.1" xref="S3.E7.m1.7.7.2.1.1.1.1.1.cmml">|</mo><mrow id="S3.E7.m1.7.7.2.1.1.1.1.3.2" xref="S3.E7.m1.7.7.2.1.1.1.1.3.1.cmml"><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">𝐲</mi><mo id="S3.E7.m1.7.7.2.1.1.1.1.3.2.1" xref="S3.E7.m1.7.7.2.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">𝐬</mi></mrow></mrow><mo id="S3.E7.m1.7.7.2.1.1.1.3" stretchy="false" xref="S3.E7.m1.7.7.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.8.8.3.3" xref="S3.E7.m1.8.8.3.3.cmml">+</mo><mrow id="S3.E7.m1.8.8.3.2" xref="S3.E7.m1.8.8.3.2.cmml"><mfrac id="S3.E7.m1.8.8.3.2.3" xref="S3.E7.m1.8.8.3.2.3.cmml"><mrow id="S3.E7.m1.8.8.3.2.3.2" xref="S3.E7.m1.8.8.3.2.3.2.cmml"><msubsup id="S3.E7.m1.8.8.3.2.3.2.1" xref="S3.E7.m1.8.8.3.2.3.2.1.cmml"><mo id="S3.E7.m1.8.8.3.2.3.2.1.2.2" xref="S3.E7.m1.8.8.3.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.8.8.3.2.3.2.1.2.3" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.cmml"><mi id="S3.E7.m1.8.8.3.2.3.2.1.2.3.2" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.8.8.3.2.3.2.1.2.3.1" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.8.8.3.2.3.2.1.2.3.3" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="S3.E7.m1.8.8.3.2.3.2.1.3" xref="S3.E7.m1.8.8.3.2.3.2.1.3.cmml">T</mi></msubsup><msub id="S3.E7.m1.8.8.3.2.3.2.2" xref="S3.E7.m1.8.8.3.2.3.2.2.cmml"><mi id="S3.E7.m1.8.8.3.2.3.2.2.2" xref="S3.E7.m1.8.8.3.2.3.2.2.2.cmml">λ</mi><mi id="S3.E7.m1.8.8.3.2.3.2.2.3" xref="S3.E7.m1.8.8.3.2.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E7.m1.8.8.3.2.3.3" xref="S3.E7.m1.8.8.3.2.3.3.cmml"><mi id="S3.E7.m1.8.8.3.2.3.3.2" xref="S3.E7.m1.8.8.3.2.3.3.2.cmml">T</mi><mo id="S3.E7.m1.8.8.3.2.3.3.1" xref="S3.E7.m1.8.8.3.2.3.3.1.cmml">−</mo><mn id="S3.E7.m1.8.8.3.2.3.3.3" xref="S3.E7.m1.8.8.3.2.3.3.3.cmml">1</mn></mrow></mfrac><mo id="S3.E7.m1.8.8.3.2.2" lspace="0.167em" xref="S3.E7.m1.8.8.3.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.8.8.3.2.4" xref="S3.E7.m1.8.8.3.2.4.cmml"><mrow id="S3.E7.m1.8.8.3.2.4.1" xref="S3.E7.m1.8.8.3.2.4.1.cmml"><mo id="S3.E7.m1.8.8.3.2.4.1.1" rspace="0.167em" xref="S3.E7.m1.8.8.3.2.4.1.1.cmml">∇</mo><mi id="S3.E7.m1.8.8.3.2.4.1.2" xref="S3.E7.m1.8.8.3.2.4.1.2.cmml">log</mi></mrow><mo id="S3.E7.m1.8.8.3.2.4a" lspace="0.167em" xref="S3.E7.m1.8.8.3.2.4.cmml">⁡</mo><mi id="S3.E7.m1.8.8.3.2.4.2" xref="S3.E7.m1.8.8.3.2.4.2.cmml">p</mi></mrow><mo id="S3.E7.m1.8.8.3.2.2a" xref="S3.E7.m1.8.8.3.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.8.8.3.2.1.1" xref="S3.E7.m1.8.8.3.2.1.2.cmml"><mo id="S3.E7.m1.8.8.3.2.1.1.2" stretchy="false" xref="S3.E7.m1.8.8.3.2.1.2.cmml">(</mo><mi id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml">𝐲</mi><mo id="S3.E7.m1.8.8.3.2.1.1.3" xref="S3.E7.m1.8.8.3.2.1.2.cmml">,</mo><mrow id="S3.E7.m1.8.8.3.2.1.1.1" xref="S3.E7.m1.8.8.3.2.1.1.1.cmml"><mi id="S3.E7.m1.8.8.3.2.1.1.1.2" xref="S3.E7.m1.8.8.3.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="S3.E7.m1.8.8.3.2.1.1.1.1" xref="S3.E7.m1.8.8.3.2.1.1.1.1.cmml">|</mo><mi id="S3.E7.m1.8.8.3.2.1.1.1.3" xref="S3.E7.m1.8.8.3.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.E7.m1.8.8.3.2.1.1.4" stretchy="false" xref="S3.E7.m1.8.8.3.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.8b"><apply id="S3.E7.m1.8.8.cmml" xref="S3.E7.m1.8.8"><eq id="S3.E7.m1.8.8.4.cmml" xref="S3.E7.m1.8.8.4"></eq><apply id="S3.E7.m1.6.6.1.cmml" xref="S3.E7.m1.6.6.1"><times id="S3.E7.m1.6.6.1.2.cmml" xref="S3.E7.m1.6.6.1.2"></times><apply id="S3.E7.m1.6.6.1.3.cmml" xref="S3.E7.m1.6.6.1.3"><apply id="S3.E7.m1.6.6.1.3.1.cmml" xref="S3.E7.m1.6.6.1.3.1"><ci id="S3.E7.m1.6.6.1.3.1.1.cmml" xref="S3.E7.m1.6.6.1.3.1.1">∇</ci><log id="S3.E7.m1.6.6.1.3.1.2.cmml" xref="S3.E7.m1.6.6.1.3.1.2"></log></apply><apply id="S3.E7.m1.6.6.1.3.2.cmml" xref="S3.E7.m1.6.6.1.3.2"><ci id="S3.E7.m1.6.6.1.3.2.1.cmml" xref="S3.E7.m1.6.6.1.3.2.1">~</ci><ci id="S3.E7.m1.6.6.1.3.2.2.cmml" xref="S3.E7.m1.6.6.1.3.2.2">𝑝</ci></apply></apply><apply id="S3.E7.m1.6.6.1.1.1.1.cmml" xref="S3.E7.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.6.6.1.1.1.1.1.cmml" xref="S3.E7.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.6.6.1.1.1.1.2.cmml" xref="S3.E7.m1.6.6.1.1.1.1.2">𝐱</ci><list id="S3.E7.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E7.m1.6.6.1.1.1.1.3.2"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝐲</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝐬</ci></list></apply></apply><apply id="S3.E7.m1.8.8.3.cmml" xref="S3.E7.m1.8.8.3"><plus id="S3.E7.m1.8.8.3.3.cmml" xref="S3.E7.m1.8.8.3.3"></plus><apply id="S3.E7.m1.7.7.2.1.cmml" xref="S3.E7.m1.7.7.2.1"><times id="S3.E7.m1.7.7.2.1.2.cmml" xref="S3.E7.m1.7.7.2.1.2"></times><apply id="S3.E7.m1.7.7.2.1.3.cmml" xref="S3.E7.m1.7.7.2.1.3"><apply id="S3.E7.m1.7.7.2.1.3.1.cmml" xref="S3.E7.m1.7.7.2.1.3.1"><ci id="S3.E7.m1.7.7.2.1.3.1.1.cmml" xref="S3.E7.m1.7.7.2.1.3.1.1">∇</ci><log id="S3.E7.m1.7.7.2.1.3.1.2.cmml" xref="S3.E7.m1.7.7.2.1.3.1.2"></log></apply><ci id="S3.E7.m1.7.7.2.1.3.2.cmml" xref="S3.E7.m1.7.7.2.1.3.2">𝑝</ci></apply><apply id="S3.E7.m1.7.7.2.1.1.1.1.cmml" xref="S3.E7.m1.7.7.2.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.7.7.2.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.7.7.2.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.2.1.1.1.1.2">𝐱</ci><list id="S3.E7.m1.7.7.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.7.7.2.1.1.1.1.3.2"><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝐲</ci><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝐬</ci></list></apply></apply><apply id="S3.E7.m1.8.8.3.2.cmml" xref="S3.E7.m1.8.8.3.2"><times id="S3.E7.m1.8.8.3.2.2.cmml" xref="S3.E7.m1.8.8.3.2.2"></times><apply id="S3.E7.m1.8.8.3.2.3.cmml" xref="S3.E7.m1.8.8.3.2.3"><divide id="S3.E7.m1.8.8.3.2.3.1.cmml" xref="S3.E7.m1.8.8.3.2.3"></divide><apply id="S3.E7.m1.8.8.3.2.3.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2"><apply id="S3.E7.m1.8.8.3.2.3.2.1.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.3.2.3.2.1.1.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1">superscript</csymbol><apply id="S3.E7.m1.8.8.3.2.3.2.1.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.3.2.3.2.1.2.1.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1">subscript</csymbol><sum id="S3.E7.m1.8.8.3.2.3.2.1.2.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1.2.2"></sum><apply id="S3.E7.m1.8.8.3.2.3.2.1.2.3.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3"><eq id="S3.E7.m1.8.8.3.2.3.2.1.2.3.1.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.1"></eq><ci id="S3.E7.m1.8.8.3.2.3.2.1.2.3.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.2">𝑡</ci><cn id="S3.E7.m1.8.8.3.2.3.2.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.8.8.3.2.3.2.1.2.3.3">2</cn></apply></apply><ci id="S3.E7.m1.8.8.3.2.3.2.1.3.cmml" xref="S3.E7.m1.8.8.3.2.3.2.1.3">𝑇</ci></apply><apply id="S3.E7.m1.8.8.3.2.3.2.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.3.2.3.2.2.1.cmml" xref="S3.E7.m1.8.8.3.2.3.2.2">subscript</csymbol><ci id="S3.E7.m1.8.8.3.2.3.2.2.2.cmml" xref="S3.E7.m1.8.8.3.2.3.2.2.2">𝜆</ci><ci id="S3.E7.m1.8.8.3.2.3.2.2.3.cmml" xref="S3.E7.m1.8.8.3.2.3.2.2.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.8.8.3.2.3.3.cmml" xref="S3.E7.m1.8.8.3.2.3.3"><minus id="S3.E7.m1.8.8.3.2.3.3.1.cmml" xref="S3.E7.m1.8.8.3.2.3.3.1"></minus><ci id="S3.E7.m1.8.8.3.2.3.3.2.cmml" xref="S3.E7.m1.8.8.3.2.3.3.2">𝑇</ci><cn id="S3.E7.m1.8.8.3.2.3.3.3.cmml" type="integer" xref="S3.E7.m1.8.8.3.2.3.3.3">1</cn></apply></apply><apply id="S3.E7.m1.8.8.3.2.4.cmml" xref="S3.E7.m1.8.8.3.2.4"><apply id="S3.E7.m1.8.8.3.2.4.1.cmml" xref="S3.E7.m1.8.8.3.2.4.1"><ci id="S3.E7.m1.8.8.3.2.4.1.1.cmml" xref="S3.E7.m1.8.8.3.2.4.1.1">∇</ci><log id="S3.E7.m1.8.8.3.2.4.1.2.cmml" xref="S3.E7.m1.8.8.3.2.4.1.2"></log></apply><ci id="S3.E7.m1.8.8.3.2.4.2.cmml" xref="S3.E7.m1.8.8.3.2.4.2">𝑝</ci></apply><interval closure="open" id="S3.E7.m1.8.8.3.2.1.2.cmml" xref="S3.E7.m1.8.8.3.2.1.1"><ci id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5">𝐲</ci><apply id="S3.E7.m1.8.8.3.2.1.1.1.cmml" xref="S3.E7.m1.8.8.3.2.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.8.8.3.2.1.1.1.1.cmml" xref="S3.E7.m1.8.8.3.2.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.8.8.3.2.1.1.1.2.cmml" xref="S3.E7.m1.8.8.3.2.1.1.1.2">𝐬</ci><ci id="S3.E7.m1.8.8.3.2.1.1.1.3.cmml" xref="S3.E7.m1.8.8.3.2.1.1.1.3">𝐱</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.8c">\nabla\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})=\nabla\log p(\mathbf{x}|%
\mathbf{y},\mathbf{s})+\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\nabla\log p(%
\mathbf{y},\mathbf{s}|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.8d">∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s ) = ∇ roman_log italic_p ( bold_x | bold_y , bold_s ) + divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG ∇ roman_log italic_p ( bold_y , bold_s | bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.8">Then, our ID-preserving sampling algorithm first draws a Gaussian sample <math alttext="\mathbf{x}_{T}\sim\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m1.2"><semantics id="S3.SS4.p1.5.m1.2a"><mrow id="S3.SS4.p1.5.m1.2.3" xref="S3.SS4.p1.5.m1.2.3.cmml"><msub id="S3.SS4.p1.5.m1.2.3.2" xref="S3.SS4.p1.5.m1.2.3.2.cmml"><mi id="S3.SS4.p1.5.m1.2.3.2.2" xref="S3.SS4.p1.5.m1.2.3.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.5.m1.2.3.2.3" xref="S3.SS4.p1.5.m1.2.3.2.3.cmml">T</mi></msub><mo id="S3.SS4.p1.5.m1.2.3.1" xref="S3.SS4.p1.5.m1.2.3.1.cmml">∼</mo><mrow id="S3.SS4.p1.5.m1.2.3.3" xref="S3.SS4.p1.5.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.5.m1.2.3.3.2" xref="S3.SS4.p1.5.m1.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS4.p1.5.m1.2.3.3.1" xref="S3.SS4.p1.5.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS4.p1.5.m1.2.3.3.3.2" xref="S3.SS4.p1.5.m1.2.3.3.3.1.cmml"><mo id="S3.SS4.p1.5.m1.2.3.3.3.2.1" stretchy="false" xref="S3.SS4.p1.5.m1.2.3.3.3.1.cmml">(</mo><mn id="S3.SS4.p1.5.m1.1.1" xref="S3.SS4.p1.5.m1.1.1.cmml">0</mn><mo id="S3.SS4.p1.5.m1.2.3.3.3.2.2" xref="S3.SS4.p1.5.m1.2.3.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.5.m1.2.2" xref="S3.SS4.p1.5.m1.2.2.cmml">I</mi><mo id="S3.SS4.p1.5.m1.2.3.3.3.2.3" stretchy="false" xref="S3.SS4.p1.5.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m1.2b"><apply id="S3.SS4.p1.5.m1.2.3.cmml" xref="S3.SS4.p1.5.m1.2.3"><csymbol cd="latexml" id="S3.SS4.p1.5.m1.2.3.1.cmml" xref="S3.SS4.p1.5.m1.2.3.1">similar-to</csymbol><apply id="S3.SS4.p1.5.m1.2.3.2.cmml" xref="S3.SS4.p1.5.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m1.2.3.2.1.cmml" xref="S3.SS4.p1.5.m1.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.5.m1.2.3.2.2.cmml" xref="S3.SS4.p1.5.m1.2.3.2.2">𝐱</ci><ci id="S3.SS4.p1.5.m1.2.3.2.3.cmml" xref="S3.SS4.p1.5.m1.2.3.2.3">𝑇</ci></apply><apply id="S3.SS4.p1.5.m1.2.3.3.cmml" xref="S3.SS4.p1.5.m1.2.3.3"><times id="S3.SS4.p1.5.m1.2.3.3.1.cmml" xref="S3.SS4.p1.5.m1.2.3.3.1"></times><ci id="S3.SS4.p1.5.m1.2.3.3.2.cmml" xref="S3.SS4.p1.5.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS4.p1.5.m1.2.3.3.3.1.cmml" xref="S3.SS4.p1.5.m1.2.3.3.3.2"><cn id="S3.SS4.p1.5.m1.1.1.cmml" type="integer" xref="S3.SS4.p1.5.m1.1.1">0</cn><ci id="S3.SS4.p1.5.m1.2.2.cmml" xref="S3.SS4.p1.5.m1.2.2">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m1.2c">\mathbf{x}_{T}\sim\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m1.2d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∼ caligraphic_N ( 0 , italic_I )</annotation></semantics></math>. Afterwards, sequentially, the algorithm performs the following update for <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m2.1"><semantics id="S3.SS4.p1.6.m2.1a"><mi id="S3.SS4.p1.6.m2.1.1" xref="S3.SS4.p1.6.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m2.1b"><ci id="S3.SS4.p1.6.m2.1.1.cmml" xref="S3.SS4.p1.6.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m2.1d">italic_t</annotation></semantics></math> iterating from <math alttext="T" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m3.1"><semantics id="S3.SS4.p1.7.m3.1a"><mi id="S3.SS4.p1.7.m3.1.1" xref="S3.SS4.p1.7.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m3.1b"><ci id="S3.SS4.p1.7.m3.1.1.cmml" xref="S3.SS4.p1.7.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m3.1d">italic_T</annotation></semantics></math> backwards to <math alttext="1" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m4.1"><semantics id="S3.SS4.p1.8.m4.1a"><mn id="S3.SS4.p1.8.m4.1.1" xref="S3.SS4.p1.8.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m4.1b"><cn id="S3.SS4.p1.8.m4.1.1.cmml" type="integer" xref="S3.SS4.p1.8.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m4.1d">1</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{t-1}\leftarrow\mathbf{x}_{t}+\gamma\nabla\log\tilde{p}(\mathbf{x}_%
{t}|\mathbf{y},\mathbf{s})+\sqrt{2\gamma}\epsilon" class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><msub id="S3.Ex1.m1.3.3.3" xref="S3.Ex1.m1.3.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.2" xref="S3.Ex1.m1.3.3.3.2.cmml">𝐱</mi><mrow id="S3.Ex1.m1.3.3.3.3" xref="S3.Ex1.m1.3.3.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.2" xref="S3.Ex1.m1.3.3.3.3.2.cmml">t</mi><mo id="S3.Ex1.m1.3.3.3.3.1" xref="S3.Ex1.m1.3.3.3.3.1.cmml">−</mo><mn id="S3.Ex1.m1.3.3.3.3.3" xref="S3.Ex1.m1.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex1.m1.3.3.2" stretchy="false" xref="S3.Ex1.m1.3.3.2.cmml">←</mo><mrow id="S3.Ex1.m1.3.3.1" xref="S3.Ex1.m1.3.3.1.cmml"><msub id="S3.Ex1.m1.3.3.1.3" xref="S3.Ex1.m1.3.3.1.3.cmml"><mi id="S3.Ex1.m1.3.3.1.3.2" xref="S3.Ex1.m1.3.3.1.3.2.cmml">𝐱</mi><mi id="S3.Ex1.m1.3.3.1.3.3" xref="S3.Ex1.m1.3.3.1.3.3.cmml">t</mi></msub><mo id="S3.Ex1.m1.3.3.1.2" xref="S3.Ex1.m1.3.3.1.2.cmml">+</mo><mrow id="S3.Ex1.m1.3.3.1.1" xref="S3.Ex1.m1.3.3.1.1.cmml"><mi id="S3.Ex1.m1.3.3.1.1.3" xref="S3.Ex1.m1.3.3.1.1.3.cmml">γ</mi><mo id="S3.Ex1.m1.3.3.1.1.2" lspace="0.167em" xref="S3.Ex1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.3.3.1.1.4" xref="S3.Ex1.m1.3.3.1.1.4.cmml"><mrow id="S3.Ex1.m1.3.3.1.1.4.1" xref="S3.Ex1.m1.3.3.1.1.4.1.cmml"><mo id="S3.Ex1.m1.3.3.1.1.4.1.1" rspace="0.167em" xref="S3.Ex1.m1.3.3.1.1.4.1.1.cmml">∇</mo><mi id="S3.Ex1.m1.3.3.1.1.4.1.2" xref="S3.Ex1.m1.3.3.1.1.4.1.2.cmml">log</mi></mrow><mo id="S3.Ex1.m1.3.3.1.1.4a" lspace="0.167em" xref="S3.Ex1.m1.3.3.1.1.4.cmml">⁡</mo><mover accent="true" id="S3.Ex1.m1.3.3.1.1.4.2" xref="S3.Ex1.m1.3.3.1.1.4.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.4.2.2" xref="S3.Ex1.m1.3.3.1.1.4.2.2.cmml">p</mi><mo id="S3.Ex1.m1.3.3.1.1.4.2.1" xref="S3.Ex1.m1.3.3.1.1.4.2.1.cmml">~</mo></mover></mrow><mo id="S3.Ex1.m1.3.3.1.1.2a" xref="S3.Ex1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.Ex1.m1.3.3.1.1.1.1.1.2.3" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.Ex1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.Ex1.m1.3.3.1.1.1.1.1.3.2" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝐲</mi><mo id="S3.Ex1.m1.3.3.1.1.1.1.1.3.2.1" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.2a" xref="S3.Ex1.m1.3.3.1.2.cmml">+</mo><mrow id="S3.Ex1.m1.3.3.1.4" xref="S3.Ex1.m1.3.3.1.4.cmml"><msqrt id="S3.Ex1.m1.3.3.1.4.2" xref="S3.Ex1.m1.3.3.1.4.2.cmml"><mrow id="S3.Ex1.m1.3.3.1.4.2.2" xref="S3.Ex1.m1.3.3.1.4.2.2.cmml"><mn id="S3.Ex1.m1.3.3.1.4.2.2.2" xref="S3.Ex1.m1.3.3.1.4.2.2.2.cmml">2</mn><mo id="S3.Ex1.m1.3.3.1.4.2.2.1" xref="S3.Ex1.m1.3.3.1.4.2.2.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.4.2.2.3" xref="S3.Ex1.m1.3.3.1.4.2.2.3.cmml">γ</mi></mrow></msqrt><mo id="S3.Ex1.m1.3.3.1.4.1" xref="S3.Ex1.m1.3.3.1.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.3.3.1.4.3" xref="S3.Ex1.m1.3.3.1.4.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><ci id="S3.Ex1.m1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.2">←</ci><apply id="S3.Ex1.m1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.2">𝐱</ci><apply id="S3.Ex1.m1.3.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3"><minus id="S3.Ex1.m1.3.3.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1"></minus><ci id="S3.Ex1.m1.3.3.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.2">𝑡</ci><cn id="S3.Ex1.m1.3.3.3.3.3.cmml" type="integer" xref="S3.Ex1.m1.3.3.3.3.3">1</cn></apply></apply><apply id="S3.Ex1.m1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.1"><plus id="S3.Ex1.m1.3.3.1.2.cmml" xref="S3.Ex1.m1.3.3.1.2"></plus><apply id="S3.Ex1.m1.3.3.1.3.cmml" xref="S3.Ex1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.3.2.cmml" xref="S3.Ex1.m1.3.3.1.3.2">𝐱</ci><ci id="S3.Ex1.m1.3.3.1.3.3.cmml" xref="S3.Ex1.m1.3.3.1.3.3">𝑡</ci></apply><apply id="S3.Ex1.m1.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1"><times id="S3.Ex1.m1.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.2"></times><ci id="S3.Ex1.m1.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.3">𝛾</ci><apply id="S3.Ex1.m1.3.3.1.1.4.cmml" xref="S3.Ex1.m1.3.3.1.1.4"><apply id="S3.Ex1.m1.3.3.1.1.4.1.cmml" xref="S3.Ex1.m1.3.3.1.1.4.1"><ci id="S3.Ex1.m1.3.3.1.1.4.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.4.1.1">∇</ci><log id="S3.Ex1.m1.3.3.1.1.4.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.4.1.2"></log></apply><apply id="S3.Ex1.m1.3.3.1.1.4.2.cmml" xref="S3.Ex1.m1.3.3.1.1.4.2"><ci id="S3.Ex1.m1.3.3.1.1.4.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.4.2.1">~</ci><ci id="S3.Ex1.m1.3.3.1.1.4.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.4.2.2">𝑝</ci></apply></apply><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.Ex1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.2.3">𝑡</ci></apply><list id="S3.Ex1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1.1.1.3.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐲</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝐬</ci></list></apply></apply><apply id="S3.Ex1.m1.3.3.1.4.cmml" xref="S3.Ex1.m1.3.3.1.4"><times id="S3.Ex1.m1.3.3.1.4.1.cmml" xref="S3.Ex1.m1.3.3.1.4.1"></times><apply id="S3.Ex1.m1.3.3.1.4.2.cmml" xref="S3.Ex1.m1.3.3.1.4.2"><root id="S3.Ex1.m1.3.3.1.4.2a.cmml" xref="S3.Ex1.m1.3.3.1.4.2"></root><apply id="S3.Ex1.m1.3.3.1.4.2.2.cmml" xref="S3.Ex1.m1.3.3.1.4.2.2"><times id="S3.Ex1.m1.3.3.1.4.2.2.1.cmml" xref="S3.Ex1.m1.3.3.1.4.2.2.1"></times><cn id="S3.Ex1.m1.3.3.1.4.2.2.2.cmml" type="integer" xref="S3.Ex1.m1.3.3.1.4.2.2.2">2</cn><ci id="S3.Ex1.m1.3.3.1.4.2.2.3.cmml" xref="S3.Ex1.m1.3.3.1.4.2.2.3">𝛾</ci></apply></apply><ci id="S3.Ex1.m1.3.3.1.4.3.cmml" xref="S3.Ex1.m1.3.3.1.4.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\mathbf{x}_{t-1}\leftarrow\mathbf{x}_{t}+\gamma\nabla\log\tilde{p}(\mathbf{x}_%
{t}|\mathbf{y},\mathbf{s})+\sqrt{2\gamma}\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ← bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ ∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) + square-root start_ARG 2 italic_γ end_ARG italic_ϵ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.11">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\underbrace{\nabla%
\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})}_{\text{original likelihood score%
}}+\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\underbrace{\nabla\log p(\mathbf{y},%
\mathbf{s}|\mathbf{x}_{t})}_{\text{reversed likelihood score}}" class="ltx_Math" display="block" id="S3.E8.m1.8"><semantics id="S3.E8.m1.8a"><mrow id="S3.E8.m1.8.8" xref="S3.E8.m1.8.8.cmml"><mrow id="S3.E8.m1.8.8.1" xref="S3.E8.m1.8.8.1.cmml"><mrow id="S3.E8.m1.8.8.1.3" xref="S3.E8.m1.8.8.1.3.cmml"><mrow id="S3.E8.m1.8.8.1.3.1" xref="S3.E8.m1.8.8.1.3.1.cmml"><mo id="S3.E8.m1.8.8.1.3.1.1" rspace="0.167em" xref="S3.E8.m1.8.8.1.3.1.1.cmml">∇</mo><mi id="S3.E8.m1.8.8.1.3.1.2" xref="S3.E8.m1.8.8.1.3.1.2.cmml">log</mi></mrow><mo id="S3.E8.m1.8.8.1.3a" lspace="0.167em" xref="S3.E8.m1.8.8.1.3.cmml">⁡</mo><mover accent="true" id="S3.E8.m1.8.8.1.3.2" xref="S3.E8.m1.8.8.1.3.2.cmml"><mi id="S3.E8.m1.8.8.1.3.2.2" xref="S3.E8.m1.8.8.1.3.2.2.cmml">p</mi><mo id="S3.E8.m1.8.8.1.3.2.1" xref="S3.E8.m1.8.8.1.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.E8.m1.8.8.1.2" xref="S3.E8.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.8.8.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.cmml"><mo id="S3.E8.m1.8.8.1.1.1.2" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.8.8.1.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.cmml"><msub id="S3.E8.m1.8.8.1.1.1.1.2" xref="S3.E8.m1.8.8.1.1.1.1.2.cmml"><mi id="S3.E8.m1.8.8.1.1.1.1.2.2" xref="S3.E8.m1.8.8.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E8.m1.8.8.1.1.1.1.2.3" xref="S3.E8.m1.8.8.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E8.m1.8.8.1.1.1.1.1" xref="S3.E8.m1.8.8.1.1.1.1.1.cmml">|</mo><mrow id="S3.E8.m1.8.8.1.1.1.1.3.2" xref="S3.E8.m1.8.8.1.1.1.1.3.1.cmml"><mi id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml">𝐲</mi><mo id="S3.E8.m1.8.8.1.1.1.1.3.2.1" xref="S3.E8.m1.8.8.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E8.m1.7.7" xref="S3.E8.m1.7.7.cmml">𝐬</mi></mrow></mrow><mo id="S3.E8.m1.8.8.1.1.1.3" stretchy="false" xref="S3.E8.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.8.8.2" xref="S3.E8.m1.8.8.2.cmml">=</mo><mrow id="S3.E8.m1.8.8.3" xref="S3.E8.m1.8.8.3.cmml"><munder id="S3.E8.m1.8.8.3.2" xref="S3.E8.m1.8.8.3.2.cmml"><munder accentunder="true" id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml"><mrow id="S3.E8.m1.3.3.3" xref="S3.E8.m1.3.3.3.cmml"><mrow id="S3.E8.m1.3.3.3.5" xref="S3.E8.m1.3.3.3.5.cmml"><mrow id="S3.E8.m1.3.3.3.5.1" xref="S3.E8.m1.3.3.3.5.1.cmml"><mo id="S3.E8.m1.3.3.3.5.1.1" rspace="0.167em" xref="S3.E8.m1.3.3.3.5.1.1.cmml">∇</mo><mi id="S3.E8.m1.3.3.3.5.1.2" xref="S3.E8.m1.3.3.3.5.1.2.cmml">log</mi></mrow><mo id="S3.E8.m1.3.3.3.5a" lspace="0.167em" xref="S3.E8.m1.3.3.3.5.cmml">⁡</mo><mi id="S3.E8.m1.3.3.3.5.2" xref="S3.E8.m1.3.3.3.5.2.cmml">p</mi></mrow><mo id="S3.E8.m1.3.3.3.4" xref="S3.E8.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.3.3.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml"><mo id="S3.E8.m1.3.3.3.3.1.2" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml"><msub id="S3.E8.m1.3.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.3.1.1.2.cmml"><mi id="S3.E8.m1.3.3.3.3.1.1.2.2" xref="S3.E8.m1.3.3.3.3.1.1.2.2.cmml">𝐱</mi><mi id="S3.E8.m1.3.3.3.3.1.1.2.3" xref="S3.E8.m1.3.3.3.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E8.m1.3.3.3.3.1.1.1" xref="S3.E8.m1.3.3.3.3.1.1.1.cmml">|</mo><mrow id="S3.E8.m1.3.3.3.3.1.1.3.2" xref="S3.E8.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝐲</mi><mo id="S3.E8.m1.3.3.3.3.1.1.3.2.1" xref="S3.E8.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.E8.m1.3.3.3.3.1.3" stretchy="false" xref="S3.E8.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.3.3.4" xref="S3.E8.m1.3.3.4.cmml">⏟</mo></munder><mtext id="S3.E8.m1.8.8.3.2.2" xref="S3.E8.m1.8.8.3.2.2a.cmml">original likelihood score</mtext></munder><mo id="S3.E8.m1.8.8.3.1" xref="S3.E8.m1.8.8.3.1.cmml">+</mo><mrow id="S3.E8.m1.8.8.3.3" xref="S3.E8.m1.8.8.3.3.cmml"><mfrac id="S3.E8.m1.8.8.3.3.2" xref="S3.E8.m1.8.8.3.3.2.cmml"><mrow id="S3.E8.m1.8.8.3.3.2.2" xref="S3.E8.m1.8.8.3.3.2.2.cmml"><msubsup id="S3.E8.m1.8.8.3.3.2.2.1" xref="S3.E8.m1.8.8.3.3.2.2.1.cmml"><mo id="S3.E8.m1.8.8.3.3.2.2.1.2.2" xref="S3.E8.m1.8.8.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.8.8.3.3.2.2.1.2.3" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.cmml"><mi id="S3.E8.m1.8.8.3.3.2.2.1.2.3.2" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.2.cmml">t</mi><mo id="S3.E8.m1.8.8.3.3.2.2.1.2.3.1" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.8.8.3.3.2.2.1.2.3.3" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.3.cmml">2</mn></mrow><mi id="S3.E8.m1.8.8.3.3.2.2.1.3" xref="S3.E8.m1.8.8.3.3.2.2.1.3.cmml">T</mi></msubsup><msub id="S3.E8.m1.8.8.3.3.2.2.2" xref="S3.E8.m1.8.8.3.3.2.2.2.cmml"><mi id="S3.E8.m1.8.8.3.3.2.2.2.2" xref="S3.E8.m1.8.8.3.3.2.2.2.2.cmml">λ</mi><mi id="S3.E8.m1.8.8.3.3.2.2.2.3" xref="S3.E8.m1.8.8.3.3.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E8.m1.8.8.3.3.2.3" xref="S3.E8.m1.8.8.3.3.2.3.cmml"><mi id="S3.E8.m1.8.8.3.3.2.3.2" xref="S3.E8.m1.8.8.3.3.2.3.2.cmml">T</mi><mo id="S3.E8.m1.8.8.3.3.2.3.1" xref="S3.E8.m1.8.8.3.3.2.3.1.cmml">−</mo><mn id="S3.E8.m1.8.8.3.3.2.3.3" xref="S3.E8.m1.8.8.3.3.2.3.3.cmml">1</mn></mrow></mfrac><mo id="S3.E8.m1.8.8.3.3.1" lspace="0.167em" xref="S3.E8.m1.8.8.3.3.1.cmml">⁢</mo><munder id="S3.E8.m1.8.8.3.3.3" xref="S3.E8.m1.8.8.3.3.3.cmml"><munder accentunder="true" id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml"><mrow id="S3.E8.m1.5.5.2" xref="S3.E8.m1.5.5.2.cmml"><mrow id="S3.E8.m1.5.5.2.4" xref="S3.E8.m1.5.5.2.4.cmml"><mrow id="S3.E8.m1.5.5.2.4.1" xref="S3.E8.m1.5.5.2.4.1.cmml"><mo id="S3.E8.m1.5.5.2.4.1.1" rspace="0.167em" xref="S3.E8.m1.5.5.2.4.1.1.cmml">∇</mo><mi id="S3.E8.m1.5.5.2.4.1.2" xref="S3.E8.m1.5.5.2.4.1.2.cmml">log</mi></mrow><mo id="S3.E8.m1.5.5.2.4a" lspace="0.167em" xref="S3.E8.m1.5.5.2.4.cmml">⁡</mo><mi id="S3.E8.m1.5.5.2.4.2" xref="S3.E8.m1.5.5.2.4.2.cmml">p</mi></mrow><mo id="S3.E8.m1.5.5.2.3" xref="S3.E8.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.2.2.1" xref="S3.E8.m1.5.5.2.2.2.cmml"><mo id="S3.E8.m1.5.5.2.2.1.2" stretchy="false" xref="S3.E8.m1.5.5.2.2.2.cmml">(</mo><mi id="S3.E8.m1.4.4.1.1" xref="S3.E8.m1.4.4.1.1.cmml">𝐲</mi><mo id="S3.E8.m1.5.5.2.2.1.3" xref="S3.E8.m1.5.5.2.2.2.cmml">,</mo><mrow id="S3.E8.m1.5.5.2.2.1.1" xref="S3.E8.m1.5.5.2.2.1.1.cmml"><mi id="S3.E8.m1.5.5.2.2.1.1.2" xref="S3.E8.m1.5.5.2.2.1.1.2.cmml">𝐬</mi><mo fence="false" id="S3.E8.m1.5.5.2.2.1.1.1" xref="S3.E8.m1.5.5.2.2.1.1.1.cmml">|</mo><msub id="S3.E8.m1.5.5.2.2.1.1.3" xref="S3.E8.m1.5.5.2.2.1.1.3.cmml"><mi id="S3.E8.m1.5.5.2.2.1.1.3.2" xref="S3.E8.m1.5.5.2.2.1.1.3.2.cmml">𝐱</mi><mi id="S3.E8.m1.5.5.2.2.1.1.3.3" xref="S3.E8.m1.5.5.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E8.m1.5.5.2.2.1.4" stretchy="false" xref="S3.E8.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.5.5.3" xref="S3.E8.m1.5.5.3.cmml">⏟</mo></munder><mtext id="S3.E8.m1.8.8.3.3.3.2" xref="S3.E8.m1.8.8.3.3.3.2a.cmml">reversed likelihood score</mtext></munder></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.8b"><apply id="S3.E8.m1.8.8.cmml" xref="S3.E8.m1.8.8"><eq id="S3.E8.m1.8.8.2.cmml" xref="S3.E8.m1.8.8.2"></eq><apply id="S3.E8.m1.8.8.1.cmml" xref="S3.E8.m1.8.8.1"><times id="S3.E8.m1.8.8.1.2.cmml" xref="S3.E8.m1.8.8.1.2"></times><apply id="S3.E8.m1.8.8.1.3.cmml" xref="S3.E8.m1.8.8.1.3"><apply id="S3.E8.m1.8.8.1.3.1.cmml" xref="S3.E8.m1.8.8.1.3.1"><ci id="S3.E8.m1.8.8.1.3.1.1.cmml" xref="S3.E8.m1.8.8.1.3.1.1">∇</ci><log id="S3.E8.m1.8.8.1.3.1.2.cmml" xref="S3.E8.m1.8.8.1.3.1.2"></log></apply><apply id="S3.E8.m1.8.8.1.3.2.cmml" xref="S3.E8.m1.8.8.1.3.2"><ci id="S3.E8.m1.8.8.1.3.2.1.cmml" xref="S3.E8.m1.8.8.1.3.2.1">~</ci><ci id="S3.E8.m1.8.8.1.3.2.2.cmml" xref="S3.E8.m1.8.8.1.3.2.2">𝑝</ci></apply></apply><apply id="S3.E8.m1.8.8.1.1.1.1.cmml" xref="S3.E8.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.8.8.1.1.1.1.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.1">conditional</csymbol><apply id="S3.E8.m1.8.8.1.1.1.1.2.cmml" xref="S3.E8.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E8.m1.8.8.1.1.1.1.2.2">𝐱</ci><ci id="S3.E8.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.E8.m1.8.8.1.1.1.1.2.3">𝑡</ci></apply><list id="S3.E8.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E8.m1.8.8.1.1.1.1.3.2"><ci id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6">𝐲</ci><ci id="S3.E8.m1.7.7.cmml" xref="S3.E8.m1.7.7">𝐬</ci></list></apply></apply><apply id="S3.E8.m1.8.8.3.cmml" xref="S3.E8.m1.8.8.3"><plus id="S3.E8.m1.8.8.3.1.cmml" xref="S3.E8.m1.8.8.3.1"></plus><apply id="S3.E8.m1.8.8.3.2.cmml" xref="S3.E8.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.3.2.1.cmml" xref="S3.E8.m1.8.8.3.2">subscript</csymbol><apply id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3"><ci id="S3.E8.m1.3.3.4.cmml" xref="S3.E8.m1.3.3.4">⏟</ci><apply id="S3.E8.m1.3.3.3.cmml" xref="S3.E8.m1.3.3.3"><times id="S3.E8.m1.3.3.3.4.cmml" xref="S3.E8.m1.3.3.3.4"></times><apply id="S3.E8.m1.3.3.3.5.cmml" xref="S3.E8.m1.3.3.3.5"><apply id="S3.E8.m1.3.3.3.5.1.cmml" xref="S3.E8.m1.3.3.3.5.1"><ci id="S3.E8.m1.3.3.3.5.1.1.cmml" xref="S3.E8.m1.3.3.3.5.1.1">∇</ci><log id="S3.E8.m1.3.3.3.5.1.2.cmml" xref="S3.E8.m1.3.3.3.5.1.2"></log></apply><ci id="S3.E8.m1.3.3.3.5.2.cmml" xref="S3.E8.m1.3.3.3.5.2">𝑝</ci></apply><apply id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E8.m1.3.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E8.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2.2">𝐱</ci><ci id="S3.E8.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E8.m1.3.3.3.3.1.1.2.3">𝑡</ci></apply><list id="S3.E8.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐲</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝐬</ci></list></apply></apply></apply><ci id="S3.E8.m1.8.8.3.2.2a.cmml" xref="S3.E8.m1.8.8.3.2.2"><mtext id="S3.E8.m1.8.8.3.2.2.cmml" mathsize="70%" xref="S3.E8.m1.8.8.3.2.2">original likelihood score</mtext></ci></apply><apply id="S3.E8.m1.8.8.3.3.cmml" xref="S3.E8.m1.8.8.3.3"><times id="S3.E8.m1.8.8.3.3.1.cmml" xref="S3.E8.m1.8.8.3.3.1"></times><apply id="S3.E8.m1.8.8.3.3.2.cmml" xref="S3.E8.m1.8.8.3.3.2"><divide id="S3.E8.m1.8.8.3.3.2.1.cmml" xref="S3.E8.m1.8.8.3.3.2"></divide><apply id="S3.E8.m1.8.8.3.3.2.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2"><apply id="S3.E8.m1.8.8.3.3.2.2.1.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.3.3.2.2.1.1.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1">superscript</csymbol><apply id="S3.E8.m1.8.8.3.3.2.2.1.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.3.3.2.2.1.2.1.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1">subscript</csymbol><sum id="S3.E8.m1.8.8.3.3.2.2.1.2.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1.2.2"></sum><apply id="S3.E8.m1.8.8.3.3.2.2.1.2.3.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3"><eq id="S3.E8.m1.8.8.3.3.2.2.1.2.3.1.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.1"></eq><ci id="S3.E8.m1.8.8.3.3.2.2.1.2.3.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.2">𝑡</ci><cn id="S3.E8.m1.8.8.3.3.2.2.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.8.8.3.3.2.2.1.2.3.3">2</cn></apply></apply><ci id="S3.E8.m1.8.8.3.3.2.2.1.3.cmml" xref="S3.E8.m1.8.8.3.3.2.2.1.3">𝑇</ci></apply><apply id="S3.E8.m1.8.8.3.3.2.2.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.3.3.2.2.2.1.cmml" xref="S3.E8.m1.8.8.3.3.2.2.2">subscript</csymbol><ci id="S3.E8.m1.8.8.3.3.2.2.2.2.cmml" xref="S3.E8.m1.8.8.3.3.2.2.2.2">𝜆</ci><ci id="S3.E8.m1.8.8.3.3.2.2.2.3.cmml" xref="S3.E8.m1.8.8.3.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E8.m1.8.8.3.3.2.3.cmml" xref="S3.E8.m1.8.8.3.3.2.3"><minus id="S3.E8.m1.8.8.3.3.2.3.1.cmml" xref="S3.E8.m1.8.8.3.3.2.3.1"></minus><ci id="S3.E8.m1.8.8.3.3.2.3.2.cmml" xref="S3.E8.m1.8.8.3.3.2.3.2">𝑇</ci><cn id="S3.E8.m1.8.8.3.3.2.3.3.cmml" type="integer" xref="S3.E8.m1.8.8.3.3.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.8.8.3.3.3.cmml" xref="S3.E8.m1.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.8.8.3.3.3.1.cmml" xref="S3.E8.m1.8.8.3.3.3">subscript</csymbol><apply id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5"><ci id="S3.E8.m1.5.5.3.cmml" xref="S3.E8.m1.5.5.3">⏟</ci><apply id="S3.E8.m1.5.5.2.cmml" xref="S3.E8.m1.5.5.2"><times id="S3.E8.m1.5.5.2.3.cmml" xref="S3.E8.m1.5.5.2.3"></times><apply id="S3.E8.m1.5.5.2.4.cmml" xref="S3.E8.m1.5.5.2.4"><apply id="S3.E8.m1.5.5.2.4.1.cmml" xref="S3.E8.m1.5.5.2.4.1"><ci id="S3.E8.m1.5.5.2.4.1.1.cmml" xref="S3.E8.m1.5.5.2.4.1.1">∇</ci><log id="S3.E8.m1.5.5.2.4.1.2.cmml" xref="S3.E8.m1.5.5.2.4.1.2"></log></apply><ci id="S3.E8.m1.5.5.2.4.2.cmml" xref="S3.E8.m1.5.5.2.4.2">𝑝</ci></apply><interval closure="open" id="S3.E8.m1.5.5.2.2.2.cmml" xref="S3.E8.m1.5.5.2.2.1"><ci id="S3.E8.m1.4.4.1.1.cmml" xref="S3.E8.m1.4.4.1.1">𝐲</ci><apply id="S3.E8.m1.5.5.2.2.1.1.cmml" xref="S3.E8.m1.5.5.2.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.2.2.1.1.1.cmml" xref="S3.E8.m1.5.5.2.2.1.1.1">conditional</csymbol><ci id="S3.E8.m1.5.5.2.2.1.1.2.cmml" xref="S3.E8.m1.5.5.2.2.1.1.2">𝐬</ci><apply id="S3.E8.m1.5.5.2.2.1.1.3.cmml" xref="S3.E8.m1.5.5.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.2.2.1.1.3.1.cmml" xref="S3.E8.m1.5.5.2.2.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.2.2.1.1.3.2.cmml" xref="S3.E8.m1.5.5.2.2.1.1.3.2">𝐱</ci><ci id="S3.E8.m1.5.5.2.2.1.1.3.3.cmml" xref="S3.E8.m1.5.5.2.2.1.1.3.3">𝑡</ci></apply></apply></interval></apply></apply><ci id="S3.E8.m1.8.8.3.3.3.2a.cmml" xref="S3.E8.m1.8.8.3.3.3.2"><mtext id="S3.E8.m1.8.8.3.3.3.2.cmml" mathsize="70%" xref="S3.E8.m1.8.8.3.3.3.2">reversed likelihood score</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.8c">\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\underbrace{\nabla%
\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})}_{\text{original likelihood score%
}}+\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\underbrace{\nabla\log p(\mathbf{y},%
\mathbf{s}|\mathbf{x}_{t})}_{\text{reversed likelihood score}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.8d">∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) = under⏟ start_ARG ∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) end_ARG start_POSTSUBSCRIPT original likelihood score end_POSTSUBSCRIPT + divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG under⏟ start_ARG ∇ roman_log italic_p ( bold_y , bold_s | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT reversed likelihood score end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.12">Note that the original likelihood score in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>) can be evaluated by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_%
{t},t,\mathbf{y},\mathbf{s})-\frac{\mathbf{x}_{t}}{\sqrt{\bar{\alpha}_{t}}}\right)" class="ltx_Math" display="block" id="S3.Ex2.m1.7"><semantics id="S3.Ex2.m1.7a"><mrow id="S3.Ex2.m1.7.7" xref="S3.Ex2.m1.7.7.cmml"><mrow id="S3.Ex2.m1.6.6.1" xref="S3.Ex2.m1.6.6.1.cmml"><mrow id="S3.Ex2.m1.6.6.1.3" xref="S3.Ex2.m1.6.6.1.3.cmml"><mrow id="S3.Ex2.m1.6.6.1.3.1" xref="S3.Ex2.m1.6.6.1.3.1.cmml"><mo id="S3.Ex2.m1.6.6.1.3.1.1" rspace="0.167em" xref="S3.Ex2.m1.6.6.1.3.1.1.cmml">∇</mo><mi id="S3.Ex2.m1.6.6.1.3.1.2" xref="S3.Ex2.m1.6.6.1.3.1.2.cmml">log</mi></mrow><mo id="S3.Ex2.m1.6.6.1.3a" lspace="0.167em" xref="S3.Ex2.m1.6.6.1.3.cmml">⁡</mo><mi id="S3.Ex2.m1.6.6.1.3.2" xref="S3.Ex2.m1.6.6.1.3.2.cmml">p</mi></mrow><mo id="S3.Ex2.m1.6.6.1.2" xref="S3.Ex2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m1.6.6.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.cmml"><mo id="S3.Ex2.m1.6.6.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.cmml"><msub id="S3.Ex2.m1.6.6.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.Ex2.m1.6.6.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.cmml">|</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.3.2" xref="S3.Ex2.m1.6.6.1.1.1.1.3.1.cmml"><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">𝐲</mi><mo id="S3.Ex2.m1.6.6.1.1.1.1.3.2.1" xref="S3.Ex2.m1.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.Ex2.m1.6.6.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.7.7.3" xref="S3.Ex2.m1.7.7.3.cmml">=</mo><mrow id="S3.Ex2.m1.7.7.2" xref="S3.Ex2.m1.7.7.2.cmml"><mfrac id="S3.Ex2.m1.7.7.2.3" xref="S3.Ex2.m1.7.7.2.3.cmml"><msqrt id="S3.Ex2.m1.7.7.2.3.2" xref="S3.Ex2.m1.7.7.2.3.2.cmml"><msub id="S3.Ex2.m1.7.7.2.3.2.2" xref="S3.Ex2.m1.7.7.2.3.2.2.cmml"><mover accent="true" id="S3.Ex2.m1.7.7.2.3.2.2.2" xref="S3.Ex2.m1.7.7.2.3.2.2.2.cmml"><mi id="S3.Ex2.m1.7.7.2.3.2.2.2.2" xref="S3.Ex2.m1.7.7.2.3.2.2.2.2.cmml">α</mi><mo id="S3.Ex2.m1.7.7.2.3.2.2.2.1" xref="S3.Ex2.m1.7.7.2.3.2.2.2.1.cmml">¯</mo></mover><mi id="S3.Ex2.m1.7.7.2.3.2.2.3" xref="S3.Ex2.m1.7.7.2.3.2.2.3.cmml">t</mi></msub></msqrt><msqrt id="S3.Ex2.m1.7.7.2.3.3" xref="S3.Ex2.m1.7.7.2.3.3.cmml"><mrow id="S3.Ex2.m1.7.7.2.3.3.2" xref="S3.Ex2.m1.7.7.2.3.3.2.cmml"><mn id="S3.Ex2.m1.7.7.2.3.3.2.2" xref="S3.Ex2.m1.7.7.2.3.3.2.2.cmml">1</mn><mo id="S3.Ex2.m1.7.7.2.3.3.2.1" xref="S3.Ex2.m1.7.7.2.3.3.2.1.cmml">−</mo><msub id="S3.Ex2.m1.7.7.2.3.3.2.3" xref="S3.Ex2.m1.7.7.2.3.3.2.3.cmml"><mover accent="true" id="S3.Ex2.m1.7.7.2.3.3.2.3.2" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2.cmml"><mi id="S3.Ex2.m1.7.7.2.3.3.2.3.2.2" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2.2.cmml">α</mi><mo id="S3.Ex2.m1.7.7.2.3.3.2.3.2.1" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2.1.cmml">¯</mo></mover><mi id="S3.Ex2.m1.7.7.2.3.3.2.3.3" xref="S3.Ex2.m1.7.7.2.3.3.2.3.3.cmml">t</mi></msub></mrow></msqrt></mfrac><mo id="S3.Ex2.m1.7.7.2.2" xref="S3.Ex2.m1.7.7.2.2.cmml">⁢</mo><mrow id="S3.Ex2.m1.7.7.2.1.1" xref="S3.Ex2.m1.7.7.2.1.1.1.cmml"><mo id="S3.Ex2.m1.7.7.2.1.1.2" xref="S3.Ex2.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.7.7.2.1.1.1" xref="S3.Ex2.m1.7.7.2.1.1.1.cmml"><mrow id="S3.Ex2.m1.7.7.2.1.1.1.1" xref="S3.Ex2.m1.7.7.2.1.1.1.1.cmml"><msub id="S3.Ex2.m1.7.7.2.1.1.1.1.3" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.cmml"><mi id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.2" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.2.cmml">𝐱</mi><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.1" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.Ex2.m1.7.7.2.1.1.1.1.3.3" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.2" xref="S3.Ex2.m1.7.7.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.3" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">t</mi><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.4" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml">𝐲</mi><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.5" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2.m1.5.5" xref="S3.Ex2.m1.5.5.cmml">𝐬</mi><mo id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.6" stretchy="false" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.7.7.2.1.1.1.2" xref="S3.Ex2.m1.7.7.2.1.1.1.2.cmml">−</mo><mfrac id="S3.Ex2.m1.7.7.2.1.1.1.3" xref="S3.Ex2.m1.7.7.2.1.1.1.3.cmml"><msub id="S3.Ex2.m1.7.7.2.1.1.1.3.2" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2.cmml"><mi id="S3.Ex2.m1.7.7.2.1.1.1.3.2.2" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S3.Ex2.m1.7.7.2.1.1.1.3.2.3" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2.3.cmml">t</mi></msub><msqrt id="S3.Ex2.m1.7.7.2.1.1.1.3.3" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.cmml"><msub id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.cmml"><mover accent="true" id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.cmml"><mi id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.2" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.2.cmml">α</mi><mo id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.1" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.1.cmml">¯</mo></mover><mi id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.3" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.3.cmml">t</mi></msub></msqrt></mfrac></mrow><mo id="S3.Ex2.m1.7.7.2.1.1.3" xref="S3.Ex2.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.7b"><apply id="S3.Ex2.m1.7.7.cmml" xref="S3.Ex2.m1.7.7"><eq id="S3.Ex2.m1.7.7.3.cmml" xref="S3.Ex2.m1.7.7.3"></eq><apply id="S3.Ex2.m1.6.6.1.cmml" xref="S3.Ex2.m1.6.6.1"><times id="S3.Ex2.m1.6.6.1.2.cmml" xref="S3.Ex2.m1.6.6.1.2"></times><apply id="S3.Ex2.m1.6.6.1.3.cmml" xref="S3.Ex2.m1.6.6.1.3"><apply id="S3.Ex2.m1.6.6.1.3.1.cmml" xref="S3.Ex2.m1.6.6.1.3.1"><ci id="S3.Ex2.m1.6.6.1.3.1.1.cmml" xref="S3.Ex2.m1.6.6.1.3.1.1">∇</ci><log id="S3.Ex2.m1.6.6.1.3.1.2.cmml" xref="S3.Ex2.m1.6.6.1.3.1.2"></log></apply><ci id="S3.Ex2.m1.6.6.1.3.2.cmml" xref="S3.Ex2.m1.6.6.1.3.2">𝑝</ci></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.6.6.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.2.2">𝐱</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.2.3">𝑡</ci></apply><list id="S3.Ex2.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.3.2"><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝐲</ci><ci id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">𝐬</ci></list></apply></apply><apply id="S3.Ex2.m1.7.7.2.cmml" xref="S3.Ex2.m1.7.7.2"><times id="S3.Ex2.m1.7.7.2.2.cmml" xref="S3.Ex2.m1.7.7.2.2"></times><apply id="S3.Ex2.m1.7.7.2.3.cmml" xref="S3.Ex2.m1.7.7.2.3"><divide id="S3.Ex2.m1.7.7.2.3.1.cmml" xref="S3.Ex2.m1.7.7.2.3"></divide><apply id="S3.Ex2.m1.7.7.2.3.2.cmml" xref="S3.Ex2.m1.7.7.2.3.2"><root id="S3.Ex2.m1.7.7.2.3.2a.cmml" xref="S3.Ex2.m1.7.7.2.3.2"></root><apply id="S3.Ex2.m1.7.7.2.3.2.2.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.3.2.2.1.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2">subscript</csymbol><apply id="S3.Ex2.m1.7.7.2.3.2.2.2.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2.2"><ci id="S3.Ex2.m1.7.7.2.3.2.2.2.1.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2.2.1">¯</ci><ci id="S3.Ex2.m1.7.7.2.3.2.2.2.2.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2.2.2">𝛼</ci></apply><ci id="S3.Ex2.m1.7.7.2.3.2.2.3.cmml" xref="S3.Ex2.m1.7.7.2.3.2.2.3">𝑡</ci></apply></apply><apply id="S3.Ex2.m1.7.7.2.3.3.cmml" xref="S3.Ex2.m1.7.7.2.3.3"><root id="S3.Ex2.m1.7.7.2.3.3a.cmml" xref="S3.Ex2.m1.7.7.2.3.3"></root><apply id="S3.Ex2.m1.7.7.2.3.3.2.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2"><minus id="S3.Ex2.m1.7.7.2.3.3.2.1.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.1"></minus><cn id="S3.Ex2.m1.7.7.2.3.3.2.2.cmml" type="integer" xref="S3.Ex2.m1.7.7.2.3.3.2.2">1</cn><apply id="S3.Ex2.m1.7.7.2.3.3.2.3.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.3.3.2.3.1.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3">subscript</csymbol><apply id="S3.Ex2.m1.7.7.2.3.3.2.3.2.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2"><ci id="S3.Ex2.m1.7.7.2.3.3.2.3.2.1.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2.1">¯</ci><ci id="S3.Ex2.m1.7.7.2.3.3.2.3.2.2.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3.2.2">𝛼</ci></apply><ci id="S3.Ex2.m1.7.7.2.3.3.2.3.3.cmml" xref="S3.Ex2.m1.7.7.2.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.Ex2.m1.7.7.2.1.1.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1"><minus id="S3.Ex2.m1.7.7.2.1.1.1.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.2"></minus><apply id="S3.Ex2.m1.7.7.2.1.1.1.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1"><times id="S3.Ex2.m1.7.7.2.1.1.1.1.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.2"></times><apply id="S3.Ex2.m1.7.7.2.1.1.1.1.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2"><ci id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.1">^</ci><ci id="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.2.2">𝐱</ci></apply><ci id="S3.Ex2.m1.7.7.2.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.3.3">𝜽</ci></apply><vector id="S3.Ex2.m1.7.7.2.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1"><apply id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">𝑡</ci><ci id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.4">𝐲</ci><ci id="S3.Ex2.m1.5.5.cmml" xref="S3.Ex2.m1.5.5">𝐬</ci></vector></apply><apply id="S3.Ex2.m1.7.7.2.1.1.1.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3"><divide id="S3.Ex2.m1.7.7.2.1.1.1.3.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3"></divide><apply id="S3.Ex2.m1.7.7.2.1.1.1.3.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.1.1.1.3.2.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex2.m1.7.7.2.1.1.1.3.2.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2.2">𝐱</ci><ci id="S3.Ex2.m1.7.7.2.1.1.1.3.2.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.Ex2.m1.7.7.2.1.1.1.3.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3"><root id="S3.Ex2.m1.7.7.2.1.1.1.3.3a.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3"></root><apply id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2">subscript</csymbol><apply id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2"><ci id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.1.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.1">¯</ci><ci id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.2.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.2.2">𝛼</ci></apply><ci id="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.3.cmml" xref="S3.Ex2.m1.7.7.2.1.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.7c">\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_%
{t},t,\mathbf{y},\mathbf{s})-\frac{\mathbf{x}_{t}}{\sqrt{\bar{\alpha}_{t}}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.7d">∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) = divide start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG start_ARG square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , bold_y , bold_s ) - divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.13">and the reversed likelihood score is given by a scaled inner product:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})=\kappa_{\mathbf{x}_{t}}%
\mathbf{y}^{T}{\nabla f_{\bm{\phi}}(\mathbf{x}_{t})}" class="ltx_Math" display="block" id="S3.Ex3.m1.3"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml"><mrow id="S3.Ex3.m1.2.2.1" xref="S3.Ex3.m1.2.2.1.cmml"><mrow id="S3.Ex3.m1.2.2.1.3" xref="S3.Ex3.m1.2.2.1.3.cmml"><mrow id="S3.Ex3.m1.2.2.1.3.1" xref="S3.Ex3.m1.2.2.1.3.1.cmml"><mo id="S3.Ex3.m1.2.2.1.3.1.1" rspace="0.167em" xref="S3.Ex3.m1.2.2.1.3.1.1.cmml">∇</mo><mi id="S3.Ex3.m1.2.2.1.3.1.2" xref="S3.Ex3.m1.2.2.1.3.1.2.cmml">log</mi></mrow><mo id="S3.Ex3.m1.2.2.1.3a" lspace="0.167em" xref="S3.Ex3.m1.2.2.1.3.cmml">⁡</mo><mi id="S3.Ex3.m1.2.2.1.3.2" xref="S3.Ex3.m1.2.2.1.3.2.cmml">p</mi></mrow><mo id="S3.Ex3.m1.2.2.1.2" xref="S3.Ex3.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.2.2.1.1.1" xref="S3.Ex3.m1.2.2.1.1.2.cmml"><mo id="S3.Ex3.m1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">𝐲</mi><mo id="S3.Ex3.m1.2.2.1.1.1.3" xref="S3.Ex3.m1.2.2.1.1.2.cmml">,</mo><mrow id="S3.Ex3.m1.2.2.1.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex3.m1.2.2.1.1.1.1.2" xref="S3.Ex3.m1.2.2.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="S3.Ex3.m1.2.2.1.1.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.1.1.cmml">|</mo><msub id="S3.Ex3.m1.2.2.1.1.1.1.3" xref="S3.Ex3.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.2.2.1.1.1.1.3.2" xref="S3.Ex3.m1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S3.Ex3.m1.2.2.1.1.1.1.3.3" xref="S3.Ex3.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.Ex3.m1.2.2.1.1.1.4" stretchy="false" xref="S3.Ex3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.3.3.3" xref="S3.Ex3.m1.3.3.3.cmml">=</mo><mrow id="S3.Ex3.m1.3.3.2" xref="S3.Ex3.m1.3.3.2.cmml"><msub id="S3.Ex3.m1.3.3.2.3" xref="S3.Ex3.m1.3.3.2.3.cmml"><mi id="S3.Ex3.m1.3.3.2.3.2" xref="S3.Ex3.m1.3.3.2.3.2.cmml">κ</mi><msub id="S3.Ex3.m1.3.3.2.3.3" xref="S3.Ex3.m1.3.3.2.3.3.cmml"><mi id="S3.Ex3.m1.3.3.2.3.3.2" xref="S3.Ex3.m1.3.3.2.3.3.2.cmml">𝐱</mi><mi id="S3.Ex3.m1.3.3.2.3.3.3" xref="S3.Ex3.m1.3.3.2.3.3.3.cmml">t</mi></msub></msub><mo id="S3.Ex3.m1.3.3.2.2" xref="S3.Ex3.m1.3.3.2.2.cmml">⁢</mo><msup id="S3.Ex3.m1.3.3.2.4" xref="S3.Ex3.m1.3.3.2.4.cmml"><mi id="S3.Ex3.m1.3.3.2.4.2" xref="S3.Ex3.m1.3.3.2.4.2.cmml">𝐲</mi><mi id="S3.Ex3.m1.3.3.2.4.3" xref="S3.Ex3.m1.3.3.2.4.3.cmml">T</mi></msup><mo id="S3.Ex3.m1.3.3.2.2a" lspace="0.167em" xref="S3.Ex3.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.3.3.2.5" xref="S3.Ex3.m1.3.3.2.5.cmml"><mo id="S3.Ex3.m1.3.3.2.5.1" rspace="0.167em" xref="S3.Ex3.m1.3.3.2.5.1.cmml">∇</mo><msub id="S3.Ex3.m1.3.3.2.5.2" xref="S3.Ex3.m1.3.3.2.5.2.cmml"><mi id="S3.Ex3.m1.3.3.2.5.2.2" xref="S3.Ex3.m1.3.3.2.5.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="S3.Ex3.m1.3.3.2.5.2.3" mathvariant="bold-italic" xref="S3.Ex3.m1.3.3.2.5.2.3.cmml">ϕ</mi></msub></mrow><mo id="S3.Ex3.m1.3.3.2.2b" xref="S3.Ex3.m1.3.3.2.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.3.3.2.1.1" xref="S3.Ex3.m1.3.3.2.1.1.1.cmml"><mo id="S3.Ex3.m1.3.3.2.1.1.2" stretchy="false" xref="S3.Ex3.m1.3.3.2.1.1.1.cmml">(</mo><msub id="S3.Ex3.m1.3.3.2.1.1.1" xref="S3.Ex3.m1.3.3.2.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.2.1.1.1.2" xref="S3.Ex3.m1.3.3.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.Ex3.m1.3.3.2.1.1.1.3" xref="S3.Ex3.m1.3.3.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex3.m1.3.3.2.1.1.3" stretchy="false" xref="S3.Ex3.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3"><eq id="S3.Ex3.m1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3"></eq><apply id="S3.Ex3.m1.2.2.1.cmml" xref="S3.Ex3.m1.2.2.1"><times id="S3.Ex3.m1.2.2.1.2.cmml" xref="S3.Ex3.m1.2.2.1.2"></times><apply id="S3.Ex3.m1.2.2.1.3.cmml" xref="S3.Ex3.m1.2.2.1.3"><apply id="S3.Ex3.m1.2.2.1.3.1.cmml" xref="S3.Ex3.m1.2.2.1.3.1"><ci id="S3.Ex3.m1.2.2.1.3.1.1.cmml" xref="S3.Ex3.m1.2.2.1.3.1.1">∇</ci><log id="S3.Ex3.m1.2.2.1.3.1.2.cmml" xref="S3.Ex3.m1.2.2.1.3.1.2"></log></apply><ci id="S3.Ex3.m1.2.2.1.3.2.cmml" xref="S3.Ex3.m1.2.2.1.3.2">𝑝</ci></apply><interval closure="open" id="S3.Ex3.m1.2.2.1.1.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1"><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">𝐲</ci><apply id="S3.Ex3.m1.2.2.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex3.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.2">𝐬</ci><apply id="S3.Ex3.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.3.2">𝐱</ci><ci id="S3.Ex3.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply><apply id="S3.Ex3.m1.3.3.2.cmml" xref="S3.Ex3.m1.3.3.2"><times id="S3.Ex3.m1.3.3.2.2.cmml" xref="S3.Ex3.m1.3.3.2.2"></times><apply id="S3.Ex3.m1.3.3.2.3.cmml" xref="S3.Ex3.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.2.3.1.cmml" xref="S3.Ex3.m1.3.3.2.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.2.3.2.cmml" xref="S3.Ex3.m1.3.3.2.3.2">𝜅</ci><apply id="S3.Ex3.m1.3.3.2.3.3.cmml" xref="S3.Ex3.m1.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.2.3.3.1.cmml" xref="S3.Ex3.m1.3.3.2.3.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.2.3.3.2.cmml" xref="S3.Ex3.m1.3.3.2.3.3.2">𝐱</ci><ci id="S3.Ex3.m1.3.3.2.3.3.3.cmml" xref="S3.Ex3.m1.3.3.2.3.3.3">𝑡</ci></apply></apply><apply id="S3.Ex3.m1.3.3.2.4.cmml" xref="S3.Ex3.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.2.4.1.cmml" xref="S3.Ex3.m1.3.3.2.4">superscript</csymbol><ci id="S3.Ex3.m1.3.3.2.4.2.cmml" xref="S3.Ex3.m1.3.3.2.4.2">𝐲</ci><ci id="S3.Ex3.m1.3.3.2.4.3.cmml" xref="S3.Ex3.m1.3.3.2.4.3">𝑇</ci></apply><apply id="S3.Ex3.m1.3.3.2.5.cmml" xref="S3.Ex3.m1.3.3.2.5"><ci id="S3.Ex3.m1.3.3.2.5.1.cmml" xref="S3.Ex3.m1.3.3.2.5.1">∇</ci><apply id="S3.Ex3.m1.3.3.2.5.2.cmml" xref="S3.Ex3.m1.3.3.2.5.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.2.5.2.1.cmml" xref="S3.Ex3.m1.3.3.2.5.2">subscript</csymbol><ci id="S3.Ex3.m1.3.3.2.5.2.2.cmml" xref="S3.Ex3.m1.3.3.2.5.2.2">𝑓</ci><ci id="S3.Ex3.m1.3.3.2.5.2.3.cmml" xref="S3.Ex3.m1.3.3.2.5.2.3">bold-italic-ϕ</ci></apply></apply><apply id="S3.Ex3.m1.3.3.2.1.1.1.cmml" xref="S3.Ex3.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.2.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.2.1.1">subscript</csymbol><ci id="S3.Ex3.m1.3.3.2.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.2.1.1.1.2">𝐱</ci><ci id="S3.Ex3.m1.3.3.2.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.2.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})=\kappa_{\mathbf{x}_{t}}%
\mathbf{y}^{T}{\nabla f_{\bm{\phi}}(\mathbf{x}_{t})}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.3d">∇ roman_log italic_p ( bold_y , bold_s | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_κ start_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∇ italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.10">See Appendix B for the derivation of the above equations. As such, our ID-preserving sampling algorithm performs sampling by searching a trajectory in the vector field <math alttext="\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m1.3"><semantics id="S3.SS4.p1.9.m1.3a"><mrow id="S3.SS4.p1.9.m1.3.3" xref="S3.SS4.p1.9.m1.3.3.cmml"><mrow id="S3.SS4.p1.9.m1.3.3.3" xref="S3.SS4.p1.9.m1.3.3.3.cmml"><mrow id="S3.SS4.p1.9.m1.3.3.3.1" xref="S3.SS4.p1.9.m1.3.3.3.1.cmml"><mo id="S3.SS4.p1.9.m1.3.3.3.1.1" rspace="0.167em" xref="S3.SS4.p1.9.m1.3.3.3.1.1.cmml">∇</mo><mi id="S3.SS4.p1.9.m1.3.3.3.1.2" xref="S3.SS4.p1.9.m1.3.3.3.1.2.cmml">log</mi></mrow><mo id="S3.SS4.p1.9.m1.3.3.3a" lspace="0.167em" xref="S3.SS4.p1.9.m1.3.3.3.cmml">⁡</mo><mover accent="true" id="S3.SS4.p1.9.m1.3.3.3.2" xref="S3.SS4.p1.9.m1.3.3.3.2.cmml"><mi id="S3.SS4.p1.9.m1.3.3.3.2.2" xref="S3.SS4.p1.9.m1.3.3.3.2.2.cmml">p</mi><mo id="S3.SS4.p1.9.m1.3.3.3.2.1" xref="S3.SS4.p1.9.m1.3.3.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.SS4.p1.9.m1.3.3.2" xref="S3.SS4.p1.9.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS4.p1.9.m1.3.3.1.1" xref="S3.SS4.p1.9.m1.3.3.1.1.1.cmml"><mo id="S3.SS4.p1.9.m1.3.3.1.1.2" stretchy="false" xref="S3.SS4.p1.9.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.9.m1.3.3.1.1.1" xref="S3.SS4.p1.9.m1.3.3.1.1.1.cmml"><msub id="S3.SS4.p1.9.m1.3.3.1.1.1.2" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2.cmml"><mi id="S3.SS4.p1.9.m1.3.3.1.1.1.2.2" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.9.m1.3.3.1.1.1.2.3" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS4.p1.9.m1.3.3.1.1.1.1" xref="S3.SS4.p1.9.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS4.p1.9.m1.3.3.1.1.1.3.2" xref="S3.SS4.p1.9.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS4.p1.9.m1.1.1" xref="S3.SS4.p1.9.m1.1.1.cmml">𝐲</mi><mo id="S3.SS4.p1.9.m1.3.3.1.1.1.3.2.1" xref="S3.SS4.p1.9.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS4.p1.9.m1.2.2" xref="S3.SS4.p1.9.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS4.p1.9.m1.3.3.1.1.3" stretchy="false" xref="S3.SS4.p1.9.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m1.3b"><apply id="S3.SS4.p1.9.m1.3.3.cmml" xref="S3.SS4.p1.9.m1.3.3"><times id="S3.SS4.p1.9.m1.3.3.2.cmml" xref="S3.SS4.p1.9.m1.3.3.2"></times><apply id="S3.SS4.p1.9.m1.3.3.3.cmml" xref="S3.SS4.p1.9.m1.3.3.3"><apply id="S3.SS4.p1.9.m1.3.3.3.1.cmml" xref="S3.SS4.p1.9.m1.3.3.3.1"><ci id="S3.SS4.p1.9.m1.3.3.3.1.1.cmml" xref="S3.SS4.p1.9.m1.3.3.3.1.1">∇</ci><log id="S3.SS4.p1.9.m1.3.3.3.1.2.cmml" xref="S3.SS4.p1.9.m1.3.3.3.1.2"></log></apply><apply id="S3.SS4.p1.9.m1.3.3.3.2.cmml" xref="S3.SS4.p1.9.m1.3.3.3.2"><ci id="S3.SS4.p1.9.m1.3.3.3.2.1.cmml" xref="S3.SS4.p1.9.m1.3.3.3.2.1">~</ci><ci id="S3.SS4.p1.9.m1.3.3.3.2.2.cmml" xref="S3.SS4.p1.9.m1.3.3.3.2.2">𝑝</ci></apply></apply><apply id="S3.SS4.p1.9.m1.3.3.1.1.1.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS4.p1.9.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS4.p1.9.m1.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.9.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2.2">𝐱</ci><ci id="S3.SS4.p1.9.m1.3.3.1.1.1.2.3.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.2.3">𝑡</ci></apply><list id="S3.SS4.p1.9.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.9.m1.3.3.1.1.1.3.2"><ci id="S3.SS4.p1.9.m1.1.1.cmml" xref="S3.SS4.p1.9.m1.1.1">𝐲</ci><ci id="S3.SS4.p1.9.m1.2.2.cmml" xref="S3.SS4.p1.9.m1.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m1.3c">\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m1.3d">∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math> that can maximize the adjusted conditional likelihood <math alttext="\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.SS4.p1.10.m2.3"><semantics id="S3.SS4.p1.10.m2.3a"><mrow id="S3.SS4.p1.10.m2.3.3" xref="S3.SS4.p1.10.m2.3.3.cmml"><mover accent="true" id="S3.SS4.p1.10.m2.3.3.3" xref="S3.SS4.p1.10.m2.3.3.3.cmml"><mi id="S3.SS4.p1.10.m2.3.3.3.2" xref="S3.SS4.p1.10.m2.3.3.3.2.cmml">p</mi><mo id="S3.SS4.p1.10.m2.3.3.3.1" xref="S3.SS4.p1.10.m2.3.3.3.1.cmml">~</mo></mover><mo id="S3.SS4.p1.10.m2.3.3.2" xref="S3.SS4.p1.10.m2.3.3.2.cmml">⁢</mo><mrow id="S3.SS4.p1.10.m2.3.3.1.1" xref="S3.SS4.p1.10.m2.3.3.1.1.1.cmml"><mo id="S3.SS4.p1.10.m2.3.3.1.1.2" stretchy="false" xref="S3.SS4.p1.10.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.10.m2.3.3.1.1.1" xref="S3.SS4.p1.10.m2.3.3.1.1.1.cmml"><msub id="S3.SS4.p1.10.m2.3.3.1.1.1.2" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2.cmml"><mi id="S3.SS4.p1.10.m2.3.3.1.1.1.2.2" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.10.m2.3.3.1.1.1.2.3" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS4.p1.10.m2.3.3.1.1.1.1" xref="S3.SS4.p1.10.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS4.p1.10.m2.3.3.1.1.1.3.2" xref="S3.SS4.p1.10.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS4.p1.10.m2.1.1" xref="S3.SS4.p1.10.m2.1.1.cmml">𝐲</mi><mo id="S3.SS4.p1.10.m2.3.3.1.1.1.3.2.1" xref="S3.SS4.p1.10.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS4.p1.10.m2.2.2" xref="S3.SS4.p1.10.m2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.SS4.p1.10.m2.3.3.1.1.3" stretchy="false" xref="S3.SS4.p1.10.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m2.3b"><apply id="S3.SS4.p1.10.m2.3.3.cmml" xref="S3.SS4.p1.10.m2.3.3"><times id="S3.SS4.p1.10.m2.3.3.2.cmml" xref="S3.SS4.p1.10.m2.3.3.2"></times><apply id="S3.SS4.p1.10.m2.3.3.3.cmml" xref="S3.SS4.p1.10.m2.3.3.3"><ci id="S3.SS4.p1.10.m2.3.3.3.1.cmml" xref="S3.SS4.p1.10.m2.3.3.3.1">~</ci><ci id="S3.SS4.p1.10.m2.3.3.3.2.cmml" xref="S3.SS4.p1.10.m2.3.3.3.2">𝑝</ci></apply><apply id="S3.SS4.p1.10.m2.3.3.1.1.1.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS4.p1.10.m2.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS4.p1.10.m2.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m2.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.10.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2.2">𝐱</ci><ci id="S3.SS4.p1.10.m2.3.3.1.1.1.2.3.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.2.3">𝑡</ci></apply><list id="S3.SS4.p1.10.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.10.m2.3.3.1.1.1.3.2"><ci id="S3.SS4.p1.10.m2.1.1.cmml" xref="S3.SS4.p1.10.m2.1.1">𝐲</ci><ci id="S3.SS4.p1.10.m2.2.2.cmml" xref="S3.SS4.p1.10.m2.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m2.3c">\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.10.m2.3d">over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math>. See Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#algorithm2" title='Algorithm 2 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a> for the specific procedure.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.1">Remark.</span> Our proposed adjusted likelihood score differs from the original score by adding an extra scaled reversed likelihood score in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>). Consequently, as shown in Figure 2
, the resulting vector field differs from the original vector field, which leads to different Langevin sampling trajectories and thus different sampling quality.</p>
</div>
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S3.F2.5" style="width:156.1pt;">
<figure class="ltx_float ltx_figure_panel ltx_minipage ltx_align_middle" id="algorithm3" style="width:260.2pt;">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm3.20">
<div class="ltx_listingline" id="algorithm3.3.3">
<span class="ltx_text" id="algorithm3.3.3.3" style="font-size:90%;">
<span class="ltx_text" id="algorithm3.3.3.3.1"><span class="ltx_text ltx_font_bold" id="algorithm3.3.3.3.1.1">Input:</span> </span>
Denoising network <math alttext="\hat{\mathbf{x}}_{\bm{\theta}}" class="ltx_Math" display="inline" id="algorithm3.1.1.1.m1.1"><semantics id="algorithm3.1.1.1.m1.1a"><msub id="algorithm3.1.1.1.m1.1.1" xref="algorithm3.1.1.1.m1.1.1.cmml"><mover accent="true" id="algorithm3.1.1.1.m1.1.1.2" xref="algorithm3.1.1.1.m1.1.1.2.cmml"><mi id="algorithm3.1.1.1.m1.1.1.2.2" xref="algorithm3.1.1.1.m1.1.1.2.2.cmml">𝐱</mi><mo id="algorithm3.1.1.1.m1.1.1.2.1" xref="algorithm3.1.1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm3.1.1.1.m1.1.1.3" xref="algorithm3.1.1.1.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.1.1.1.m1.1b"><apply id="algorithm3.1.1.1.m1.1.1.cmml" xref="algorithm3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.1.1.1.m1.1.1.1.cmml" xref="algorithm3.1.1.1.m1.1.1">subscript</csymbol><apply id="algorithm3.1.1.1.m1.1.1.2.cmml" xref="algorithm3.1.1.1.m1.1.1.2"><ci id="algorithm3.1.1.1.m1.1.1.2.1.cmml" xref="algorithm3.1.1.1.m1.1.1.2.1">^</ci><ci id="algorithm3.1.1.1.m1.1.1.2.2.cmml" xref="algorithm3.1.1.1.m1.1.1.2.2">𝐱</ci></apply><ci id="algorithm3.1.1.1.m1.1.1.3.cmml" xref="algorithm3.1.1.1.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.1.1.1.m1.1c">\hat{\mathbf{x}}_{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.1.1.1.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>;
recognition model <math alttext="f_{\bm{\phi}}" class="ltx_Math" display="inline" id="algorithm3.2.2.2.m2.1"><semantics id="algorithm3.2.2.2.m2.1a"><msub id="algorithm3.2.2.2.m2.1.1" xref="algorithm3.2.2.2.m2.1.1.cmml"><mi id="algorithm3.2.2.2.m2.1.1.2" xref="algorithm3.2.2.2.m2.1.1.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="algorithm3.2.2.2.m2.1.1.3" mathvariant="bold-italic" xref="algorithm3.2.2.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.2.2.2.m2.1b"><apply id="algorithm3.2.2.2.m2.1.1.cmml" xref="algorithm3.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.2.2.2.m2.1.1.1.cmml" xref="algorithm3.2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm3.2.2.2.m2.1.1.2.cmml" xref="algorithm3.2.2.2.m2.1.1.2">𝑓</ci><ci id="algorithm3.2.2.2.m2.1.1.3.cmml" xref="algorithm3.2.2.2.m2.1.1.3">bold-italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.2.2.2.m2.1c">f_{\bm{\phi}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.2.2.2.m2.1d">italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>; the number of identities <math alttext="N" class="ltx_Math" display="inline" id="algorithm3.3.3.3.m3.1"><semantics id="algorithm3.3.3.3.m3.1a"><mi id="algorithm3.3.3.3.m3.1.1" xref="algorithm3.3.3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm3.3.3.3.m3.1b"><ci id="algorithm3.3.3.3.m3.1.1.cmml" xref="algorithm3.3.3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.3.3.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="algorithm3.3.3.3.m3.1d">italic_N</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm3.4.4">
<span class="ltx_text" id="algorithm3.4.4.1" style="font-size:90%;">
</span><span class="ltx_text" id="algorithm3.4.4.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="algorithm3.4.4.2.1">Output:</span> </span><span class="ltx_text" id="algorithm3.4.4.3" style="font-size:90%;">A synthetic dataset </span><math alttext="\mathcal{D}_{\text{syn}}" class="ltx_Math" display="inline" id="algorithm3.4.4.m1.1"><semantics id="algorithm3.4.4.m1.1a"><msub id="algorithm3.4.4.m1.1.1" xref="algorithm3.4.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.4.4.m1.1.1.2" mathsize="90%" xref="algorithm3.4.4.m1.1.1.2.cmml">𝒟</mi><mtext id="algorithm3.4.4.m1.1.1.3" mathsize="90%" xref="algorithm3.4.4.m1.1.1.3a.cmml">syn</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.4.4.m1.1b"><apply id="algorithm3.4.4.m1.1.1.cmml" xref="algorithm3.4.4.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.4.4.m1.1.1.1.cmml" xref="algorithm3.4.4.m1.1.1">subscript</csymbol><ci id="algorithm3.4.4.m1.1.1.2.cmml" xref="algorithm3.4.4.m1.1.1.2">𝒟</ci><ci id="algorithm3.4.4.m1.1.1.3a.cmml" xref="algorithm3.4.4.m1.1.1.3"><mtext id="algorithm3.4.4.m1.1.1.3.cmml" mathsize="63%" xref="algorithm3.4.4.m1.1.1.3">syn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.4.4.m1.1c">\mathcal{D}_{\text{syn}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.4.4.m1.1d">caligraphic_D start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.4.4.4" style="font-size:90%;">.</span>
</div>
<div class="ltx_listingline" id="algorithm3.20.21">
<span class="ltx_text" id="algorithm3.20.21.1" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm3.5.5">
<math alttext="\mathcal{D}_{\text{syn}}\leftarrow\emptyset" class="ltx_Math" display="inline" id="algorithm3.5.5.m1.1"><semantics id="algorithm3.5.5.m1.1a"><mrow id="algorithm3.5.5.m1.1.1" xref="algorithm3.5.5.m1.1.1.cmml"><msub id="algorithm3.5.5.m1.1.1.2" xref="algorithm3.5.5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.5.5.m1.1.1.2.2" mathsize="90%" xref="algorithm3.5.5.m1.1.1.2.2.cmml">𝒟</mi><mtext id="algorithm3.5.5.m1.1.1.2.3" mathsize="90%" xref="algorithm3.5.5.m1.1.1.2.3a.cmml">syn</mtext></msub><mo id="algorithm3.5.5.m1.1.1.1" mathsize="90%" stretchy="false" xref="algorithm3.5.5.m1.1.1.1.cmml">←</mo><mi id="algorithm3.5.5.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="algorithm3.5.5.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.5.5.m1.1b"><apply id="algorithm3.5.5.m1.1.1.cmml" xref="algorithm3.5.5.m1.1.1"><ci id="algorithm3.5.5.m1.1.1.1.cmml" xref="algorithm3.5.5.m1.1.1.1">←</ci><apply id="algorithm3.5.5.m1.1.1.2.cmml" xref="algorithm3.5.5.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m1.1.1.2.1.cmml" xref="algorithm3.5.5.m1.1.1.2">subscript</csymbol><ci id="algorithm3.5.5.m1.1.1.2.2.cmml" xref="algorithm3.5.5.m1.1.1.2.2">𝒟</ci><ci id="algorithm3.5.5.m1.1.1.2.3a.cmml" xref="algorithm3.5.5.m1.1.1.2.3"><mtext id="algorithm3.5.5.m1.1.1.2.3.cmml" mathsize="63%" xref="algorithm3.5.5.m1.1.1.2.3">syn</mtext></ci></apply><emptyset id="algorithm3.5.5.m1.1.1.3.cmml" xref="algorithm3.5.5.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.5.5.m1.1c">\mathcal{D}_{\text{syn}}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="algorithm3.5.5.m1.1d">caligraphic_D start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT ← ∅</annotation></semantics></math><span class="ltx_text" id="algorithm3.5.5.1" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.6.6">
<span class="ltx_text" id="algorithm3.6.6.1" style="font-size:90%;">Generate </span><math alttext="\mathbf{w}_{1},...,\mathbf{w}_{N}\in\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="algorithm3.6.6.m1.3"><semantics id="algorithm3.6.6.m1.3a"><mrow id="algorithm3.6.6.m1.3.3" xref="algorithm3.6.6.m1.3.3.cmml"><mrow id="algorithm3.6.6.m1.3.3.2.2" xref="algorithm3.6.6.m1.3.3.2.3.cmml"><msub id="algorithm3.6.6.m1.2.2.1.1.1" xref="algorithm3.6.6.m1.2.2.1.1.1.cmml"><mi id="algorithm3.6.6.m1.2.2.1.1.1.2" mathsize="90%" xref="algorithm3.6.6.m1.2.2.1.1.1.2.cmml">𝐰</mi><mn id="algorithm3.6.6.m1.2.2.1.1.1.3" mathsize="90%" xref="algorithm3.6.6.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="algorithm3.6.6.m1.3.3.2.2.3" mathsize="90%" xref="algorithm3.6.6.m1.3.3.2.3.cmml">,</mo><mi id="algorithm3.6.6.m1.1.1" mathsize="90%" mathvariant="normal" xref="algorithm3.6.6.m1.1.1.cmml">…</mi><mo id="algorithm3.6.6.m1.3.3.2.2.4" mathsize="90%" xref="algorithm3.6.6.m1.3.3.2.3.cmml">,</mo><msub id="algorithm3.6.6.m1.3.3.2.2.2" xref="algorithm3.6.6.m1.3.3.2.2.2.cmml"><mi id="algorithm3.6.6.m1.3.3.2.2.2.2" mathsize="90%" xref="algorithm3.6.6.m1.3.3.2.2.2.2.cmml">𝐰</mi><mi id="algorithm3.6.6.m1.3.3.2.2.2.3" mathsize="90%" xref="algorithm3.6.6.m1.3.3.2.2.2.3.cmml">N</mi></msub></mrow><mo id="algorithm3.6.6.m1.3.3.3" mathsize="90%" xref="algorithm3.6.6.m1.3.3.3.cmml">∈</mo><msup id="algorithm3.6.6.m1.3.3.4" xref="algorithm3.6.6.m1.3.3.4.cmml"><mi id="algorithm3.6.6.m1.3.3.4.2" mathsize="90%" xref="algorithm3.6.6.m1.3.3.4.2.cmml">𝕊</mi><mrow id="algorithm3.6.6.m1.3.3.4.3" xref="algorithm3.6.6.m1.3.3.4.3.cmml"><mi id="algorithm3.6.6.m1.3.3.4.3.2" mathsize="90%" xref="algorithm3.6.6.m1.3.3.4.3.2.cmml">d</mi><mo id="algorithm3.6.6.m1.3.3.4.3.1" mathsize="90%" xref="algorithm3.6.6.m1.3.3.4.3.1.cmml">−</mo><mn id="algorithm3.6.6.m1.3.3.4.3.3" mathsize="90%" xref="algorithm3.6.6.m1.3.3.4.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.6.6.m1.3b"><apply id="algorithm3.6.6.m1.3.3.cmml" xref="algorithm3.6.6.m1.3.3"><in id="algorithm3.6.6.m1.3.3.3.cmml" xref="algorithm3.6.6.m1.3.3.3"></in><list id="algorithm3.6.6.m1.3.3.2.3.cmml" xref="algorithm3.6.6.m1.3.3.2.2"><apply id="algorithm3.6.6.m1.2.2.1.1.1.cmml" xref="algorithm3.6.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm3.6.6.m1.2.2.1.1.1.1.cmml" xref="algorithm3.6.6.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm3.6.6.m1.2.2.1.1.1.2.cmml" xref="algorithm3.6.6.m1.2.2.1.1.1.2">𝐰</ci><cn id="algorithm3.6.6.m1.2.2.1.1.1.3.cmml" type="integer" xref="algorithm3.6.6.m1.2.2.1.1.1.3">1</cn></apply><ci id="algorithm3.6.6.m1.1.1.cmml" xref="algorithm3.6.6.m1.1.1">…</ci><apply id="algorithm3.6.6.m1.3.3.2.2.2.cmml" xref="algorithm3.6.6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.6.6.m1.3.3.2.2.2.1.cmml" xref="algorithm3.6.6.m1.3.3.2.2.2">subscript</csymbol><ci id="algorithm3.6.6.m1.3.3.2.2.2.2.cmml" xref="algorithm3.6.6.m1.3.3.2.2.2.2">𝐰</ci><ci id="algorithm3.6.6.m1.3.3.2.2.2.3.cmml" xref="algorithm3.6.6.m1.3.3.2.2.2.3">𝑁</ci></apply></list><apply id="algorithm3.6.6.m1.3.3.4.cmml" xref="algorithm3.6.6.m1.3.3.4"><csymbol cd="ambiguous" id="algorithm3.6.6.m1.3.3.4.1.cmml" xref="algorithm3.6.6.m1.3.3.4">superscript</csymbol><ci id="algorithm3.6.6.m1.3.3.4.2.cmml" xref="algorithm3.6.6.m1.3.3.4.2">𝕊</ci><apply id="algorithm3.6.6.m1.3.3.4.3.cmml" xref="algorithm3.6.6.m1.3.3.4.3"><minus id="algorithm3.6.6.m1.3.3.4.3.1.cmml" xref="algorithm3.6.6.m1.3.3.4.3.1"></minus><ci id="algorithm3.6.6.m1.3.3.4.3.2.cmml" xref="algorithm3.6.6.m1.3.3.4.3.2">𝑑</ci><cn id="algorithm3.6.6.m1.3.3.4.3.3.cmml" type="integer" xref="algorithm3.6.6.m1.3.3.4.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.6.6.m1.3c">\mathbf{w}_{1},...,\mathbf{w}_{N}\in\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.6.6.m1.3d">bold_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_w start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ∈ blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.6.6.2" style="font-size:90%;"> by solving the Tammes problem; </span>
</div>
<div class="ltx_listingline" id="algorithm3.8.8">
<span class="ltx_text ltx_font_bold" id="algorithm3.8.8.3" style="font-size:90%;">for</span><span class="ltx_text" id="algorithm3.8.8.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm3.8.8.2" style="font-size:90%;"><math alttext="i\leftarrow 1" class="ltx_Math" display="inline" id="algorithm3.7.7.1.m1.1"><semantics id="algorithm3.7.7.1.m1.1a"><mrow id="algorithm3.7.7.1.m1.1.1" xref="algorithm3.7.7.1.m1.1.1.cmml"><mi id="algorithm3.7.7.1.m1.1.1.2" xref="algorithm3.7.7.1.m1.1.1.2.cmml">i</mi><mo id="algorithm3.7.7.1.m1.1.1.1" stretchy="false" xref="algorithm3.7.7.1.m1.1.1.1.cmml">←</mo><mn id="algorithm3.7.7.1.m1.1.1.3" xref="algorithm3.7.7.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.7.7.1.m1.1b"><apply id="algorithm3.7.7.1.m1.1.1.cmml" xref="algorithm3.7.7.1.m1.1.1"><ci id="algorithm3.7.7.1.m1.1.1.1.cmml" xref="algorithm3.7.7.1.m1.1.1.1">←</ci><ci id="algorithm3.7.7.1.m1.1.1.2.cmml" xref="algorithm3.7.7.1.m1.1.1.2">𝑖</ci><cn id="algorithm3.7.7.1.m1.1.1.3.cmml" type="integer" xref="algorithm3.7.7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.7.7.1.m1.1c">i\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="algorithm3.7.7.1.m1.1d">italic_i ← 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm3.8.8.2.1">to</span> <math alttext="N" class="ltx_Math" display="inline" id="algorithm3.8.8.2.m2.1"><semantics id="algorithm3.8.8.2.m2.1a"><mi id="algorithm3.8.8.2.m2.1.1" xref="algorithm3.8.8.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm3.8.8.2.m2.1b"><ci id="algorithm3.8.8.2.m2.1.1.cmml" xref="algorithm3.8.8.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.8.8.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="algorithm3.8.8.2.m2.1d">italic_N</annotation></semantics></math></em><span class="ltx_text" id="algorithm3.8.8.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm3.8.8.6" style="font-size:90%;">do</span><span class="ltx_text" id="algorithm3.8.8.7" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm3.9.9">
<span class="ltx_text" id="algorithm3.9.9.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.9.9.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm3.9.9.3" style="font-size:90%;">
Generate </span><math alttext="s_{1i},...,s_{mi}\sim\mathcal{U}[lb,ub)" class="ltx_Math" display="inline" id="algorithm3.9.9.m1.5"><semantics id="algorithm3.9.9.m1.5a"><mrow id="algorithm3.9.9.m1.5.5" xref="algorithm3.9.9.m1.5.5.cmml"><mrow id="algorithm3.9.9.m1.3.3.2.2" xref="algorithm3.9.9.m1.3.3.2.3.cmml"><msub id="algorithm3.9.9.m1.2.2.1.1.1" xref="algorithm3.9.9.m1.2.2.1.1.1.cmml"><mi id="algorithm3.9.9.m1.2.2.1.1.1.2" mathsize="90%" xref="algorithm3.9.9.m1.2.2.1.1.1.2.cmml">s</mi><mrow id="algorithm3.9.9.m1.2.2.1.1.1.3" xref="algorithm3.9.9.m1.2.2.1.1.1.3.cmml"><mn id="algorithm3.9.9.m1.2.2.1.1.1.3.2" mathsize="90%" xref="algorithm3.9.9.m1.2.2.1.1.1.3.2.cmml">1</mn><mo id="algorithm3.9.9.m1.2.2.1.1.1.3.1" xref="algorithm3.9.9.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm3.9.9.m1.2.2.1.1.1.3.3" mathsize="90%" xref="algorithm3.9.9.m1.2.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="algorithm3.9.9.m1.3.3.2.2.3" mathsize="90%" xref="algorithm3.9.9.m1.3.3.2.3.cmml">,</mo><mi id="algorithm3.9.9.m1.1.1" mathsize="90%" mathvariant="normal" xref="algorithm3.9.9.m1.1.1.cmml">…</mi><mo id="algorithm3.9.9.m1.3.3.2.2.4" mathsize="90%" xref="algorithm3.9.9.m1.3.3.2.3.cmml">,</mo><msub id="algorithm3.9.9.m1.3.3.2.2.2" xref="algorithm3.9.9.m1.3.3.2.2.2.cmml"><mi id="algorithm3.9.9.m1.3.3.2.2.2.2" mathsize="90%" xref="algorithm3.9.9.m1.3.3.2.2.2.2.cmml">s</mi><mrow id="algorithm3.9.9.m1.3.3.2.2.2.3" xref="algorithm3.9.9.m1.3.3.2.2.2.3.cmml"><mi id="algorithm3.9.9.m1.3.3.2.2.2.3.2" mathsize="90%" xref="algorithm3.9.9.m1.3.3.2.2.2.3.2.cmml">m</mi><mo id="algorithm3.9.9.m1.3.3.2.2.2.3.1" xref="algorithm3.9.9.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm3.9.9.m1.3.3.2.2.2.3.3" mathsize="90%" xref="algorithm3.9.9.m1.3.3.2.2.2.3.3.cmml">i</mi></mrow></msub></mrow><mo id="algorithm3.9.9.m1.5.5.5" mathsize="90%" xref="algorithm3.9.9.m1.5.5.5.cmml">∼</mo><mrow id="algorithm3.9.9.m1.5.5.4" xref="algorithm3.9.9.m1.5.5.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.9.9.m1.5.5.4.4" mathsize="90%" xref="algorithm3.9.9.m1.5.5.4.4.cmml">𝒰</mi><mo id="algorithm3.9.9.m1.5.5.4.3" xref="algorithm3.9.9.m1.5.5.4.3.cmml">⁢</mo><mrow id="algorithm3.9.9.m1.5.5.4.2.2" xref="algorithm3.9.9.m1.5.5.4.2.3.cmml"><mo id="algorithm3.9.9.m1.5.5.4.2.2.3" maxsize="90%" minsize="90%" xref="algorithm3.9.9.m1.5.5.4.2.3.cmml">[</mo><mrow id="algorithm3.9.9.m1.4.4.3.1.1.1" xref="algorithm3.9.9.m1.4.4.3.1.1.1.cmml"><mi id="algorithm3.9.9.m1.4.4.3.1.1.1.2" mathsize="90%" xref="algorithm3.9.9.m1.4.4.3.1.1.1.2.cmml">l</mi><mo id="algorithm3.9.9.m1.4.4.3.1.1.1.1" xref="algorithm3.9.9.m1.4.4.3.1.1.1.1.cmml">⁢</mo><mi id="algorithm3.9.9.m1.4.4.3.1.1.1.3" mathsize="90%" xref="algorithm3.9.9.m1.4.4.3.1.1.1.3.cmml">b</mi></mrow><mo id="algorithm3.9.9.m1.5.5.4.2.2.4" mathsize="90%" xref="algorithm3.9.9.m1.5.5.4.2.3.cmml">,</mo><mrow id="algorithm3.9.9.m1.5.5.4.2.2.2" xref="algorithm3.9.9.m1.5.5.4.2.2.2.cmml"><mi id="algorithm3.9.9.m1.5.5.4.2.2.2.2" mathsize="90%" xref="algorithm3.9.9.m1.5.5.4.2.2.2.2.cmml">u</mi><mo id="algorithm3.9.9.m1.5.5.4.2.2.2.1" xref="algorithm3.9.9.m1.5.5.4.2.2.2.1.cmml">⁢</mo><mi id="algorithm3.9.9.m1.5.5.4.2.2.2.3" mathsize="90%" xref="algorithm3.9.9.m1.5.5.4.2.2.2.3.cmml">b</mi></mrow><mo id="algorithm3.9.9.m1.5.5.4.2.2.5" maxsize="90%" minsize="90%" xref="algorithm3.9.9.m1.5.5.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.9.9.m1.5b"><apply id="algorithm3.9.9.m1.5.5.cmml" xref="algorithm3.9.9.m1.5.5"><csymbol cd="latexml" id="algorithm3.9.9.m1.5.5.5.cmml" xref="algorithm3.9.9.m1.5.5.5">similar-to</csymbol><list id="algorithm3.9.9.m1.3.3.2.3.cmml" xref="algorithm3.9.9.m1.3.3.2.2"><apply id="algorithm3.9.9.m1.2.2.1.1.1.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm3.9.9.m1.2.2.1.1.1.1.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm3.9.9.m1.2.2.1.1.1.2.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1.2">𝑠</ci><apply id="algorithm3.9.9.m1.2.2.1.1.1.3.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1.3"><times id="algorithm3.9.9.m1.2.2.1.1.1.3.1.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1.3.1"></times><cn id="algorithm3.9.9.m1.2.2.1.1.1.3.2.cmml" type="integer" xref="algorithm3.9.9.m1.2.2.1.1.1.3.2">1</cn><ci id="algorithm3.9.9.m1.2.2.1.1.1.3.3.cmml" xref="algorithm3.9.9.m1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="algorithm3.9.9.m1.1.1.cmml" xref="algorithm3.9.9.m1.1.1">…</ci><apply id="algorithm3.9.9.m1.3.3.2.2.2.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.9.9.m1.3.3.2.2.2.1.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2">subscript</csymbol><ci id="algorithm3.9.9.m1.3.3.2.2.2.2.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2.2">𝑠</ci><apply id="algorithm3.9.9.m1.3.3.2.2.2.3.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2.3"><times id="algorithm3.9.9.m1.3.3.2.2.2.3.1.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2.3.1"></times><ci id="algorithm3.9.9.m1.3.3.2.2.2.3.2.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2.3.2">𝑚</ci><ci id="algorithm3.9.9.m1.3.3.2.2.2.3.3.cmml" xref="algorithm3.9.9.m1.3.3.2.2.2.3.3">𝑖</ci></apply></apply></list><apply id="algorithm3.9.9.m1.5.5.4.cmml" xref="algorithm3.9.9.m1.5.5.4"><times id="algorithm3.9.9.m1.5.5.4.3.cmml" xref="algorithm3.9.9.m1.5.5.4.3"></times><ci id="algorithm3.9.9.m1.5.5.4.4.cmml" xref="algorithm3.9.9.m1.5.5.4.4">𝒰</ci><interval closure="closed-open" id="algorithm3.9.9.m1.5.5.4.2.3.cmml" xref="algorithm3.9.9.m1.5.5.4.2.2"><apply id="algorithm3.9.9.m1.4.4.3.1.1.1.cmml" xref="algorithm3.9.9.m1.4.4.3.1.1.1"><times id="algorithm3.9.9.m1.4.4.3.1.1.1.1.cmml" xref="algorithm3.9.9.m1.4.4.3.1.1.1.1"></times><ci id="algorithm3.9.9.m1.4.4.3.1.1.1.2.cmml" xref="algorithm3.9.9.m1.4.4.3.1.1.1.2">𝑙</ci><ci id="algorithm3.9.9.m1.4.4.3.1.1.1.3.cmml" xref="algorithm3.9.9.m1.4.4.3.1.1.1.3">𝑏</ci></apply><apply id="algorithm3.9.9.m1.5.5.4.2.2.2.cmml" xref="algorithm3.9.9.m1.5.5.4.2.2.2"><times id="algorithm3.9.9.m1.5.5.4.2.2.2.1.cmml" xref="algorithm3.9.9.m1.5.5.4.2.2.2.1"></times><ci id="algorithm3.9.9.m1.5.5.4.2.2.2.2.cmml" xref="algorithm3.9.9.m1.5.5.4.2.2.2.2">𝑢</ci><ci id="algorithm3.9.9.m1.5.5.4.2.2.2.3.cmml" xref="algorithm3.9.9.m1.5.5.4.2.2.2.3">𝑏</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.9.9.m1.5c">s_{1i},...,s_{mi}\sim\mathcal{U}[lb,ub)</annotation><annotation encoding="application/x-llamapun" id="algorithm3.9.9.m1.5d">italic_s start_POSTSUBSCRIPT 1 italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_m italic_i end_POSTSUBSCRIPT ∼ caligraphic_U [ italic_l italic_b , italic_u italic_b )</annotation></semantics></math><span class="ltx_text" id="algorithm3.9.9.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.11.11">
<span class="ltx_text" id="algorithm3.11.11.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.11.11.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm3.11.11.3" style="font-size:90%;">Calculate </span><math alttext="\mathbf{Y}_{i}" class="ltx_Math" display="inline" id="algorithm3.10.10.m1.1"><semantics id="algorithm3.10.10.m1.1a"><msub id="algorithm3.10.10.m1.1.1" xref="algorithm3.10.10.m1.1.1.cmml"><mi id="algorithm3.10.10.m1.1.1.2" mathsize="90%" xref="algorithm3.10.10.m1.1.1.2.cmml">𝐘</mi><mi id="algorithm3.10.10.m1.1.1.3" mathsize="90%" xref="algorithm3.10.10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.10.10.m1.1b"><apply id="algorithm3.10.10.m1.1.1.cmml" xref="algorithm3.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.10.10.m1.1.1.1.cmml" xref="algorithm3.10.10.m1.1.1">subscript</csymbol><ci id="algorithm3.10.10.m1.1.1.2.cmml" xref="algorithm3.10.10.m1.1.1.2">𝐘</ci><ci id="algorithm3.10.10.m1.1.1.3.cmml" xref="algorithm3.10.10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.10.10.m1.1c">\mathbf{Y}_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.10.10.m1.1d">bold_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.11.11.4" style="font-size:90%;"> by solving the optimization problem </span><math alttext="\mathbf{P}_{i}" class="ltx_Math" display="inline" id="algorithm3.11.11.m2.1"><semantics id="algorithm3.11.11.m2.1a"><msub id="algorithm3.11.11.m2.1.1" xref="algorithm3.11.11.m2.1.1.cmml"><mi id="algorithm3.11.11.m2.1.1.2" mathsize="90%" xref="algorithm3.11.11.m2.1.1.2.cmml">𝐏</mi><mi id="algorithm3.11.11.m2.1.1.3" mathsize="90%" xref="algorithm3.11.11.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.11.11.m2.1b"><apply id="algorithm3.11.11.m2.1.1.cmml" xref="algorithm3.11.11.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.11.11.m2.1.1.1.cmml" xref="algorithm3.11.11.m2.1.1">subscript</csymbol><ci id="algorithm3.11.11.m2.1.1.2.cmml" xref="algorithm3.11.11.m2.1.1.2">𝐏</ci><ci id="algorithm3.11.11.m2.1.1.3.cmml" xref="algorithm3.11.11.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.11.11.m2.1c">\mathbf{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.11.11.m2.1d">bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.11.11.5" style="font-size:90%;"> in Eq. (</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E9" style="font-size:90%;" title='Equation 9 ‣ 3.5 Synthetic Dataset Generation ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">9</span></a><span class="ltx_text" id="algorithm3.11.11.6" style="font-size:90%;">);
</span>
</div>
<div class="ltx_listingline" id="algorithm3.12.12">
<span class="ltx_text" id="algorithm3.12.12.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.12.12.2" style="font-size:90%;">   </span><math alttext="\mathbf{y}_{i1}^{*},...,\mathbf{y}_{im}^{*}\leftarrow\operatorname{unpack}(%
\mathbf{Y}_{i})" class="ltx_Math" display="inline" id="algorithm3.12.12.m1.5"><semantics id="algorithm3.12.12.m1.5a"><mrow id="algorithm3.12.12.m1.5.5" xref="algorithm3.12.12.m1.5.5.cmml"><mrow id="algorithm3.12.12.m1.4.4.2.2" xref="algorithm3.12.12.m1.4.4.2.3.cmml"><msubsup id="algorithm3.12.12.m1.3.3.1.1.1" xref="algorithm3.12.12.m1.3.3.1.1.1.cmml"><mi id="algorithm3.12.12.m1.3.3.1.1.1.2.2" mathsize="90%" xref="algorithm3.12.12.m1.3.3.1.1.1.2.2.cmml">𝐲</mi><mrow id="algorithm3.12.12.m1.3.3.1.1.1.2.3" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.cmml"><mi id="algorithm3.12.12.m1.3.3.1.1.1.2.3.2" mathsize="90%" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.2.cmml">i</mi><mo id="algorithm3.12.12.m1.3.3.1.1.1.2.3.1" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.1.cmml">⁢</mo><mn id="algorithm3.12.12.m1.3.3.1.1.1.2.3.3" mathsize="90%" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.3.cmml">1</mn></mrow><mo id="algorithm3.12.12.m1.3.3.1.1.1.3" mathsize="90%" xref="algorithm3.12.12.m1.3.3.1.1.1.3.cmml">∗</mo></msubsup><mo id="algorithm3.12.12.m1.4.4.2.2.3" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.3.cmml">,</mo><mi id="algorithm3.12.12.m1.2.2" mathsize="90%" mathvariant="normal" xref="algorithm3.12.12.m1.2.2.cmml">…</mi><mo id="algorithm3.12.12.m1.4.4.2.2.4" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.3.cmml">,</mo><msubsup id="algorithm3.12.12.m1.4.4.2.2.2" xref="algorithm3.12.12.m1.4.4.2.2.2.cmml"><mi id="algorithm3.12.12.m1.4.4.2.2.2.2.2" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.2.2.2.2.cmml">𝐲</mi><mrow id="algorithm3.12.12.m1.4.4.2.2.2.2.3" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.cmml"><mi id="algorithm3.12.12.m1.4.4.2.2.2.2.3.2" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.2.cmml">i</mi><mo id="algorithm3.12.12.m1.4.4.2.2.2.2.3.1" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm3.12.12.m1.4.4.2.2.2.2.3.3" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.3.cmml">m</mi></mrow><mo id="algorithm3.12.12.m1.4.4.2.2.2.3" mathsize="90%" xref="algorithm3.12.12.m1.4.4.2.2.2.3.cmml">∗</mo></msubsup></mrow><mo id="algorithm3.12.12.m1.5.5.4" mathsize="90%" stretchy="false" xref="algorithm3.12.12.m1.5.5.4.cmml">←</mo><mrow id="algorithm3.12.12.m1.5.5.3.1" xref="algorithm3.12.12.m1.5.5.3.2.cmml"><mi id="algorithm3.12.12.m1.1.1" mathsize="90%" xref="algorithm3.12.12.m1.1.1.cmml">unpack</mi><mo id="algorithm3.12.12.m1.5.5.3.1a" xref="algorithm3.12.12.m1.5.5.3.2.cmml">⁡</mo><mrow id="algorithm3.12.12.m1.5.5.3.1.1" xref="algorithm3.12.12.m1.5.5.3.2.cmml"><mo id="algorithm3.12.12.m1.5.5.3.1.1.2" maxsize="90%" minsize="90%" xref="algorithm3.12.12.m1.5.5.3.2.cmml">(</mo><msub id="algorithm3.12.12.m1.5.5.3.1.1.1" xref="algorithm3.12.12.m1.5.5.3.1.1.1.cmml"><mi id="algorithm3.12.12.m1.5.5.3.1.1.1.2" mathsize="90%" xref="algorithm3.12.12.m1.5.5.3.1.1.1.2.cmml">𝐘</mi><mi id="algorithm3.12.12.m1.5.5.3.1.1.1.3" mathsize="90%" xref="algorithm3.12.12.m1.5.5.3.1.1.1.3.cmml">i</mi></msub><mo id="algorithm3.12.12.m1.5.5.3.1.1.3" maxsize="90%" minsize="90%" xref="algorithm3.12.12.m1.5.5.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.12.12.m1.5b"><apply id="algorithm3.12.12.m1.5.5.cmml" xref="algorithm3.12.12.m1.5.5"><ci id="algorithm3.12.12.m1.5.5.4.cmml" xref="algorithm3.12.12.m1.5.5.4">←</ci><list id="algorithm3.12.12.m1.4.4.2.3.cmml" xref="algorithm3.12.12.m1.4.4.2.2"><apply id="algorithm3.12.12.m1.3.3.1.1.1.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.3.3.1.1.1.1.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1">superscript</csymbol><apply id="algorithm3.12.12.m1.3.3.1.1.1.2.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.3.3.1.1.1.2.1.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1">subscript</csymbol><ci id="algorithm3.12.12.m1.3.3.1.1.1.2.2.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1.2.2">𝐲</ci><apply id="algorithm3.12.12.m1.3.3.1.1.1.2.3.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3"><times id="algorithm3.12.12.m1.3.3.1.1.1.2.3.1.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.1"></times><ci id="algorithm3.12.12.m1.3.3.1.1.1.2.3.2.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.2">𝑖</ci><cn id="algorithm3.12.12.m1.3.3.1.1.1.2.3.3.cmml" type="integer" xref="algorithm3.12.12.m1.3.3.1.1.1.2.3.3">1</cn></apply></apply><times id="algorithm3.12.12.m1.3.3.1.1.1.3.cmml" xref="algorithm3.12.12.m1.3.3.1.1.1.3"></times></apply><ci id="algorithm3.12.12.m1.2.2.cmml" xref="algorithm3.12.12.m1.2.2">…</ci><apply id="algorithm3.12.12.m1.4.4.2.2.2.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.4.4.2.2.2.1.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2">superscript</csymbol><apply id="algorithm3.12.12.m1.4.4.2.2.2.2.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.4.4.2.2.2.2.1.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2">subscript</csymbol><ci id="algorithm3.12.12.m1.4.4.2.2.2.2.2.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.2.2">𝐲</ci><apply id="algorithm3.12.12.m1.4.4.2.2.2.2.3.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3"><times id="algorithm3.12.12.m1.4.4.2.2.2.2.3.1.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.1"></times><ci id="algorithm3.12.12.m1.4.4.2.2.2.2.3.2.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.2">𝑖</ci><ci id="algorithm3.12.12.m1.4.4.2.2.2.2.3.3.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.2.3.3">𝑚</ci></apply></apply><times id="algorithm3.12.12.m1.4.4.2.2.2.3.cmml" xref="algorithm3.12.12.m1.4.4.2.2.2.3"></times></apply></list><apply id="algorithm3.12.12.m1.5.5.3.2.cmml" xref="algorithm3.12.12.m1.5.5.3.1"><ci id="algorithm3.12.12.m1.1.1.cmml" xref="algorithm3.12.12.m1.1.1">unpack</ci><apply id="algorithm3.12.12.m1.5.5.3.1.1.1.cmml" xref="algorithm3.12.12.m1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.5.5.3.1.1.1.1.cmml" xref="algorithm3.12.12.m1.5.5.3.1.1.1">subscript</csymbol><ci id="algorithm3.12.12.m1.5.5.3.1.1.1.2.cmml" xref="algorithm3.12.12.m1.5.5.3.1.1.1.2">𝐘</ci><ci id="algorithm3.12.12.m1.5.5.3.1.1.1.3.cmml" xref="algorithm3.12.12.m1.5.5.3.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.12.12.m1.5c">\mathbf{y}_{i1}^{*},...,\mathbf{y}_{im}^{*}\leftarrow\operatorname{unpack}(%
\mathbf{Y}_{i})</annotation><annotation encoding="application/x-llamapun" id="algorithm3.12.12.m1.5d">bold_y start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , … , bold_y start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ← roman_unpack ( bold_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm3.12.12.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.13.13">
<span class="ltx_text" id="algorithm3.13.13.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.13.13.2" style="font-size:90%;">   </span><math alttext="\mathbf{s}_{i1},...,\mathbf{s}_{im}\leftarrow" class="ltx_Math" display="inline" id="algorithm3.13.13.m1.3"><semantics id="algorithm3.13.13.m1.3a"><mrow id="algorithm3.13.13.m1.3.3" xref="algorithm3.13.13.m1.3.3.cmml"><mrow id="algorithm3.13.13.m1.3.3.2.2" xref="algorithm3.13.13.m1.3.3.2.3.cmml"><msub id="algorithm3.13.13.m1.2.2.1.1.1" xref="algorithm3.13.13.m1.2.2.1.1.1.cmml"><mi id="algorithm3.13.13.m1.2.2.1.1.1.2" mathsize="90%" xref="algorithm3.13.13.m1.2.2.1.1.1.2.cmml">𝐬</mi><mrow id="algorithm3.13.13.m1.2.2.1.1.1.3" xref="algorithm3.13.13.m1.2.2.1.1.1.3.cmml"><mi id="algorithm3.13.13.m1.2.2.1.1.1.3.2" mathsize="90%" xref="algorithm3.13.13.m1.2.2.1.1.1.3.2.cmml">i</mi><mo id="algorithm3.13.13.m1.2.2.1.1.1.3.1" xref="algorithm3.13.13.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="algorithm3.13.13.m1.2.2.1.1.1.3.3" mathsize="90%" xref="algorithm3.13.13.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="algorithm3.13.13.m1.3.3.2.2.3" mathsize="90%" xref="algorithm3.13.13.m1.3.3.2.3.cmml">,</mo><mi id="algorithm3.13.13.m1.1.1" mathsize="90%" mathvariant="normal" xref="algorithm3.13.13.m1.1.1.cmml">…</mi><mo id="algorithm3.13.13.m1.3.3.2.2.4" mathsize="90%" xref="algorithm3.13.13.m1.3.3.2.3.cmml">,</mo><msub id="algorithm3.13.13.m1.3.3.2.2.2" xref="algorithm3.13.13.m1.3.3.2.2.2.cmml"><mi id="algorithm3.13.13.m1.3.3.2.2.2.2" mathsize="90%" xref="algorithm3.13.13.m1.3.3.2.2.2.2.cmml">𝐬</mi><mrow id="algorithm3.13.13.m1.3.3.2.2.2.3" xref="algorithm3.13.13.m1.3.3.2.2.2.3.cmml"><mi id="algorithm3.13.13.m1.3.3.2.2.2.3.2" mathsize="90%" xref="algorithm3.13.13.m1.3.3.2.2.2.3.2.cmml">i</mi><mo id="algorithm3.13.13.m1.3.3.2.2.2.3.1" xref="algorithm3.13.13.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm3.13.13.m1.3.3.2.2.2.3.3" mathsize="90%" xref="algorithm3.13.13.m1.3.3.2.2.2.3.3.cmml">m</mi></mrow></msub></mrow><mo id="algorithm3.13.13.m1.3.3.3" mathsize="90%" stretchy="false" xref="algorithm3.13.13.m1.3.3.3.cmml">←</mo><mi id="algorithm3.13.13.m1.3.3.4" xref="algorithm3.13.13.m1.3.3.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.13.13.m1.3b"><apply id="algorithm3.13.13.m1.3.3.cmml" xref="algorithm3.13.13.m1.3.3"><ci id="algorithm3.13.13.m1.3.3.3.cmml" xref="algorithm3.13.13.m1.3.3.3">←</ci><list id="algorithm3.13.13.m1.3.3.2.3.cmml" xref="algorithm3.13.13.m1.3.3.2.2"><apply id="algorithm3.13.13.m1.2.2.1.1.1.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm3.13.13.m1.2.2.1.1.1.1.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm3.13.13.m1.2.2.1.1.1.2.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1.2">𝐬</ci><apply id="algorithm3.13.13.m1.2.2.1.1.1.3.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1.3"><times id="algorithm3.13.13.m1.2.2.1.1.1.3.1.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1.3.1"></times><ci id="algorithm3.13.13.m1.2.2.1.1.1.3.2.cmml" xref="algorithm3.13.13.m1.2.2.1.1.1.3.2">𝑖</ci><cn id="algorithm3.13.13.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="algorithm3.13.13.m1.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm3.13.13.m1.1.1.cmml" xref="algorithm3.13.13.m1.1.1">…</ci><apply id="algorithm3.13.13.m1.3.3.2.2.2.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.13.13.m1.3.3.2.2.2.1.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2">subscript</csymbol><ci id="algorithm3.13.13.m1.3.3.2.2.2.2.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2.2">𝐬</ci><apply id="algorithm3.13.13.m1.3.3.2.2.2.3.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2.3"><times id="algorithm3.13.13.m1.3.3.2.2.2.3.1.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2.3.1"></times><ci id="algorithm3.13.13.m1.3.3.2.2.2.3.2.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2.3.2">𝑖</ci><ci id="algorithm3.13.13.m1.3.3.2.2.2.3.3.cmml" xref="algorithm3.13.13.m1.3.3.2.2.2.3.3">𝑚</ci></apply></apply></list><csymbol cd="latexml" id="algorithm3.13.13.m1.3.3.4.cmml" xref="algorithm3.13.13.m1.3.3.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.13.13.m1.3c">\mathbf{s}_{i1},...,\mathbf{s}_{im}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm3.13.13.m1.3d">bold_s start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ←</annotation></semantics></math><span class="ltx_text" id="algorithm3.13.13.3" style="font-size:90%;"> generate different attributes;</span>
</div>
<div class="ltx_listingline" id="algorithm3.14.14">
<span class="ltx_text" id="algorithm3.14.14.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.14.14.2" style="font-size:90%;">   </span><math alttext="\mathcal{D}_{i}\leftarrow\emptyset" class="ltx_Math" display="inline" id="algorithm3.14.14.m1.1"><semantics id="algorithm3.14.14.m1.1a"><mrow id="algorithm3.14.14.m1.1.1" xref="algorithm3.14.14.m1.1.1.cmml"><msub id="algorithm3.14.14.m1.1.1.2" xref="algorithm3.14.14.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.14.14.m1.1.1.2.2" mathsize="90%" xref="algorithm3.14.14.m1.1.1.2.2.cmml">𝒟</mi><mi id="algorithm3.14.14.m1.1.1.2.3" mathsize="90%" xref="algorithm3.14.14.m1.1.1.2.3.cmml">i</mi></msub><mo id="algorithm3.14.14.m1.1.1.1" mathsize="90%" stretchy="false" xref="algorithm3.14.14.m1.1.1.1.cmml">←</mo><mi id="algorithm3.14.14.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="algorithm3.14.14.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.14.14.m1.1b"><apply id="algorithm3.14.14.m1.1.1.cmml" xref="algorithm3.14.14.m1.1.1"><ci id="algorithm3.14.14.m1.1.1.1.cmml" xref="algorithm3.14.14.m1.1.1.1">←</ci><apply id="algorithm3.14.14.m1.1.1.2.cmml" xref="algorithm3.14.14.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.14.14.m1.1.1.2.1.cmml" xref="algorithm3.14.14.m1.1.1.2">subscript</csymbol><ci id="algorithm3.14.14.m1.1.1.2.2.cmml" xref="algorithm3.14.14.m1.1.1.2.2">𝒟</ci><ci id="algorithm3.14.14.m1.1.1.2.3.cmml" xref="algorithm3.14.14.m1.1.1.2.3">𝑖</ci></apply><emptyset id="algorithm3.14.14.m1.1.1.3.cmml" xref="algorithm3.14.14.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.14.14.m1.1c">\mathcal{D}_{i}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="algorithm3.14.14.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← ∅</annotation></semantics></math><span class="ltx_text" id="algorithm3.14.14.3" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.16.16">
<span class="ltx_text" id="algorithm3.16.16.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.16.16.4" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="algorithm3.16.16.5" style="font-size:90%;">for</span><span class="ltx_text" id="algorithm3.16.16.6" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="algorithm3.16.16.2" style="font-size:90%;"><math alttext="j\leftarrow 1" class="ltx_Math" display="inline" id="algorithm3.15.15.1.m1.1"><semantics id="algorithm3.15.15.1.m1.1a"><mrow id="algorithm3.15.15.1.m1.1.1" xref="algorithm3.15.15.1.m1.1.1.cmml"><mi id="algorithm3.15.15.1.m1.1.1.2" xref="algorithm3.15.15.1.m1.1.1.2.cmml">j</mi><mo id="algorithm3.15.15.1.m1.1.1.1" stretchy="false" xref="algorithm3.15.15.1.m1.1.1.1.cmml">←</mo><mn id="algorithm3.15.15.1.m1.1.1.3" xref="algorithm3.15.15.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.15.15.1.m1.1b"><apply id="algorithm3.15.15.1.m1.1.1.cmml" xref="algorithm3.15.15.1.m1.1.1"><ci id="algorithm3.15.15.1.m1.1.1.1.cmml" xref="algorithm3.15.15.1.m1.1.1.1">←</ci><ci id="algorithm3.15.15.1.m1.1.1.2.cmml" xref="algorithm3.15.15.1.m1.1.1.2">𝑗</ci><cn id="algorithm3.15.15.1.m1.1.1.3.cmml" type="integer" xref="algorithm3.15.15.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.15.15.1.m1.1c">j\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="algorithm3.15.15.1.m1.1d">italic_j ← 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm3.16.16.2.1">to</span> <math alttext="m" class="ltx_Math" display="inline" id="algorithm3.16.16.2.m2.1"><semantics id="algorithm3.16.16.2.m2.1a"><mi id="algorithm3.16.16.2.m2.1.1" xref="algorithm3.16.16.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm3.16.16.2.m2.1b"><ci id="algorithm3.16.16.2.m2.1.1.cmml" xref="algorithm3.16.16.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.16.16.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="algorithm3.16.16.2.m2.1d">italic_m</annotation></semantics></math></em><span class="ltx_text" id="algorithm3.16.16.7" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="algorithm3.16.16.8" style="font-size:90%;">do</span><span class="ltx_text" id="algorithm3.16.16.9" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="algorithm3.20.22">
<span class="ltx_text" id="algorithm3.20.22.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.20.22.2" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.20.22.3" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm3.20.22.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="algorithm3.17.17">
<span class="ltx_text" id="algorithm3.17.17.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.17.17.2" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.17.17.3" style="font-size:90%;">   </span><math alttext="\mathbf{x}_{0}\leftarrow\text{Alg.}~{}\ref{alg:test_alg}(\hat{\mathbf{x}}_{\bm%
{\theta}},f_{\bm{\phi}},\operatorname{norm}(\mathbf{y}^{*}_{ij}),\mathbf{s}_{%
ij})" class="ltx_Math" display="inline" id="algorithm3.17.17.m1.5"><semantics id="algorithm3.17.17.m1.5a"><mrow id="algorithm3.17.17.m1.5.5" xref="algorithm3.17.17.m1.5.5.cmml"><msub id="algorithm3.17.17.m1.5.5.6" xref="algorithm3.17.17.m1.5.5.6.cmml"><mi id="algorithm3.17.17.m1.5.5.6.2" mathsize="90%" xref="algorithm3.17.17.m1.5.5.6.2.cmml">𝐱</mi><mn id="algorithm3.17.17.m1.5.5.6.3" mathsize="90%" xref="algorithm3.17.17.m1.5.5.6.3.cmml">0</mn></msub><mo id="algorithm3.17.17.m1.5.5.5" mathsize="90%" stretchy="false" xref="algorithm3.17.17.m1.5.5.5.cmml">←</mo><mrow id="algorithm3.17.17.m1.5.5.4" xref="algorithm3.17.17.m1.5.5.4.cmml"><mtext id="algorithm3.17.17.m1.5.5.4.6" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.6a.cmml">Alg.</mtext><mo id="algorithm3.17.17.m1.5.5.4.5" lspace="0.300em" xref="algorithm3.17.17.m1.5.5.4.5.cmml">⁢</mo><mtext class="ltx_mathvariant_italic" id="algorithm3.17.17.m1.5.5.4.7" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.7c.cmml"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2409.17576v1#algorithm2" style="font-size:90%;" title='Algorithm 2 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a></mtext><mo id="algorithm3.17.17.m1.5.5.4.5a" xref="algorithm3.17.17.m1.5.5.4.5.cmml">⁢</mo><mrow id="algorithm3.17.17.m1.5.5.4.4.4" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml"><mo id="algorithm3.17.17.m1.5.5.4.4.4.5" maxsize="90%" minsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml">(</mo><msub id="algorithm3.17.17.m1.2.2.1.1.1.1" xref="algorithm3.17.17.m1.2.2.1.1.1.1.cmml"><mover accent="true" id="algorithm3.17.17.m1.2.2.1.1.1.1.2" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2.cmml"><mi id="algorithm3.17.17.m1.2.2.1.1.1.1.2.2" mathsize="90%" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mo id="algorithm3.17.17.m1.2.2.1.1.1.1.2.1" mathsize="90%" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm3.17.17.m1.2.2.1.1.1.1.3" mathsize="90%" xref="algorithm3.17.17.m1.2.2.1.1.1.1.3.cmml">𝜽</mi></msub><mo id="algorithm3.17.17.m1.5.5.4.4.4.6" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml">,</mo><msub id="algorithm3.17.17.m1.3.3.2.2.2.2" xref="algorithm3.17.17.m1.3.3.2.2.2.2.cmml"><mi id="algorithm3.17.17.m1.3.3.2.2.2.2.2" mathsize="90%" xref="algorithm3.17.17.m1.3.3.2.2.2.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="algorithm3.17.17.m1.3.3.2.2.2.2.3" mathsize="90%" mathvariant="bold-italic" xref="algorithm3.17.17.m1.3.3.2.2.2.2.3.cmml">ϕ</mi></msub><mo id="algorithm3.17.17.m1.5.5.4.4.4.7" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml">,</mo><mrow id="algorithm3.17.17.m1.4.4.3.3.3.3.1" xref="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml"><mi id="algorithm3.17.17.m1.1.1" mathsize="90%" xref="algorithm3.17.17.m1.1.1.cmml">norm</mi><mo id="algorithm3.17.17.m1.4.4.3.3.3.3.1a" xref="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml">⁡</mo><mrow id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1" xref="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml"><mo id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.2" maxsize="90%" minsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml">(</mo><msubsup id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.cmml"><mi id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.2" mathsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.2.cmml">𝐲</mi><mrow id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.cmml"><mi id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.2" mathsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.1" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.3" mathsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.3.cmml">j</mi></mrow><mo id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.3" mathsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.3" maxsize="90%" minsize="90%" xref="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml">)</mo></mrow></mrow><mo id="algorithm3.17.17.m1.5.5.4.4.4.8" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml">,</mo><msub id="algorithm3.17.17.m1.5.5.4.4.4.4" xref="algorithm3.17.17.m1.5.5.4.4.4.4.cmml"><mi id="algorithm3.17.17.m1.5.5.4.4.4.4.2" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.4.4.2.cmml">𝐬</mi><mrow id="algorithm3.17.17.m1.5.5.4.4.4.4.3" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.cmml"><mi id="algorithm3.17.17.m1.5.5.4.4.4.4.3.2" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.2.cmml">i</mi><mo id="algorithm3.17.17.m1.5.5.4.4.4.4.3.1" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.1.cmml">⁢</mo><mi id="algorithm3.17.17.m1.5.5.4.4.4.4.3.3" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.3.cmml">j</mi></mrow></msub><mo id="algorithm3.17.17.m1.5.5.4.4.4.9" maxsize="90%" minsize="90%" xref="algorithm3.17.17.m1.5.5.4.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.17.17.m1.5b"><apply id="algorithm3.17.17.m1.5.5.cmml" xref="algorithm3.17.17.m1.5.5"><ci id="algorithm3.17.17.m1.5.5.5.cmml" xref="algorithm3.17.17.m1.5.5.5">←</ci><apply id="algorithm3.17.17.m1.5.5.6.cmml" xref="algorithm3.17.17.m1.5.5.6"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.5.5.6.1.cmml" xref="algorithm3.17.17.m1.5.5.6">subscript</csymbol><ci id="algorithm3.17.17.m1.5.5.6.2.cmml" xref="algorithm3.17.17.m1.5.5.6.2">𝐱</ci><cn id="algorithm3.17.17.m1.5.5.6.3.cmml" type="integer" xref="algorithm3.17.17.m1.5.5.6.3">0</cn></apply><apply id="algorithm3.17.17.m1.5.5.4.cmml" xref="algorithm3.17.17.m1.5.5.4"><times id="algorithm3.17.17.m1.5.5.4.5.cmml" xref="algorithm3.17.17.m1.5.5.4.5"></times><ci id="algorithm3.17.17.m1.5.5.4.6a.cmml" xref="algorithm3.17.17.m1.5.5.4.6"><mtext id="algorithm3.17.17.m1.5.5.4.6.cmml" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.6">Alg.</mtext></ci><ci id="algorithm3.17.17.m1.5.5.4.7c.cmml" xref="algorithm3.17.17.m1.5.5.4.7"><mtext class="ltx_mathvariant_italic" id="algorithm3.17.17.m1.5.5.4.7.cmml" mathsize="90%" xref="algorithm3.17.17.m1.5.5.4.7"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2409.17576v1#algorithm2" style="font-size:90%;" title='Algorithm 2 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a></mtext></ci><vector id="algorithm3.17.17.m1.5.5.4.4.5.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4"><apply id="algorithm3.17.17.m1.2.2.1.1.1.1.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.2.2.1.1.1.1.1.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1">subscript</csymbol><apply id="algorithm3.17.17.m1.2.2.1.1.1.1.2.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2"><ci id="algorithm3.17.17.m1.2.2.1.1.1.1.2.1.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2.1">^</ci><ci id="algorithm3.17.17.m1.2.2.1.1.1.1.2.2.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1.2.2">𝐱</ci></apply><ci id="algorithm3.17.17.m1.2.2.1.1.1.1.3.cmml" xref="algorithm3.17.17.m1.2.2.1.1.1.1.3">𝜽</ci></apply><apply id="algorithm3.17.17.m1.3.3.2.2.2.2.cmml" xref="algorithm3.17.17.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.3.3.2.2.2.2.1.cmml" xref="algorithm3.17.17.m1.3.3.2.2.2.2">subscript</csymbol><ci id="algorithm3.17.17.m1.3.3.2.2.2.2.2.cmml" xref="algorithm3.17.17.m1.3.3.2.2.2.2.2">𝑓</ci><ci id="algorithm3.17.17.m1.3.3.2.2.2.2.3.cmml" xref="algorithm3.17.17.m1.3.3.2.2.2.2.3">bold-italic-ϕ</ci></apply><apply id="algorithm3.17.17.m1.4.4.3.3.3.3.2.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1"><ci id="algorithm3.17.17.m1.1.1.cmml" xref="algorithm3.17.17.m1.1.1">norm</ci><apply id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.1.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1">subscript</csymbol><apply id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.1.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1">superscript</csymbol><ci id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.2.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.2">𝐲</ci><times id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.3.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.2.3"></times></apply><apply id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3"><times id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.1.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.1"></times><ci id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.2.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.2">𝑖</ci><ci id="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.3.cmml" xref="algorithm3.17.17.m1.4.4.3.3.3.3.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="algorithm3.17.17.m1.5.5.4.4.4.4.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4"><csymbol cd="ambiguous" id="algorithm3.17.17.m1.5.5.4.4.4.4.1.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4">subscript</csymbol><ci id="algorithm3.17.17.m1.5.5.4.4.4.4.2.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4.2">𝐬</ci><apply id="algorithm3.17.17.m1.5.5.4.4.4.4.3.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3"><times id="algorithm3.17.17.m1.5.5.4.4.4.4.3.1.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.1"></times><ci id="algorithm3.17.17.m1.5.5.4.4.4.4.3.2.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.2">𝑖</ci><ci id="algorithm3.17.17.m1.5.5.4.4.4.4.3.3.cmml" xref="algorithm3.17.17.m1.5.5.4.4.4.4.3.3">𝑗</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.17.17.m1.5c">\mathbf{x}_{0}\leftarrow\text{Alg.}~{}\ref{alg:test_alg}(\hat{\mathbf{x}}_{\bm%
{\theta}},f_{\bm{\phi}},\operatorname{norm}(\mathbf{y}^{*}_{ij}),\mathbf{s}_{%
ij})</annotation><annotation encoding="application/x-llamapun" id="algorithm3.17.17.m1.5d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← Alg. ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT , roman_norm ( bold_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) , bold_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="algorithm3.17.17.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.18.18">
<span class="ltx_text" id="algorithm3.18.18.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.18.18.2" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.18.18.3" style="font-size:90%;">   </span><math alttext="\mathcal{D}_{i}\leftarrow\mathcal{D}_{i}\cup\{(\mathbf{x}_{0},i)\}" class="ltx_Math" display="inline" id="algorithm3.18.18.m1.2"><semantics id="algorithm3.18.18.m1.2a"><mrow id="algorithm3.18.18.m1.2.2" xref="algorithm3.18.18.m1.2.2.cmml"><msub id="algorithm3.18.18.m1.2.2.3" xref="algorithm3.18.18.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.18.18.m1.2.2.3.2" mathsize="90%" xref="algorithm3.18.18.m1.2.2.3.2.cmml">𝒟</mi><mi id="algorithm3.18.18.m1.2.2.3.3" mathsize="90%" xref="algorithm3.18.18.m1.2.2.3.3.cmml">i</mi></msub><mo id="algorithm3.18.18.m1.2.2.2" mathsize="90%" stretchy="false" xref="algorithm3.18.18.m1.2.2.2.cmml">←</mo><mrow id="algorithm3.18.18.m1.2.2.1" xref="algorithm3.18.18.m1.2.2.1.cmml"><msub id="algorithm3.18.18.m1.2.2.1.3" xref="algorithm3.18.18.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.18.18.m1.2.2.1.3.2" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.3.2.cmml">𝒟</mi><mi id="algorithm3.18.18.m1.2.2.1.3.3" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.3.3.cmml">i</mi></msub><mo id="algorithm3.18.18.m1.2.2.1.2" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.2.cmml">∪</mo><mrow id="algorithm3.18.18.m1.2.2.1.1.1" xref="algorithm3.18.18.m1.2.2.1.1.2.cmml"><mo id="algorithm3.18.18.m1.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.2.cmml">{</mo><mrow id="algorithm3.18.18.m1.2.2.1.1.1.1.1" xref="algorithm3.18.18.m1.2.2.1.1.1.1.2.cmml"><mo id="algorithm3.18.18.m1.2.2.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.cmml"><mi id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.2" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="algorithm3.18.18.m1.2.2.1.1.1.1.1.3" mathsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="algorithm3.18.18.m1.1.1" mathsize="90%" xref="algorithm3.18.18.m1.1.1.cmml">i</mi><mo id="algorithm3.18.18.m1.2.2.1.1.1.1.1.4" maxsize="90%" minsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow><mo id="algorithm3.18.18.m1.2.2.1.1.1.3" maxsize="90%" minsize="90%" xref="algorithm3.18.18.m1.2.2.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.18.18.m1.2b"><apply id="algorithm3.18.18.m1.2.2.cmml" xref="algorithm3.18.18.m1.2.2"><ci id="algorithm3.18.18.m1.2.2.2.cmml" xref="algorithm3.18.18.m1.2.2.2">←</ci><apply id="algorithm3.18.18.m1.2.2.3.cmml" xref="algorithm3.18.18.m1.2.2.3"><csymbol cd="ambiguous" id="algorithm3.18.18.m1.2.2.3.1.cmml" xref="algorithm3.18.18.m1.2.2.3">subscript</csymbol><ci id="algorithm3.18.18.m1.2.2.3.2.cmml" xref="algorithm3.18.18.m1.2.2.3.2">𝒟</ci><ci id="algorithm3.18.18.m1.2.2.3.3.cmml" xref="algorithm3.18.18.m1.2.2.3.3">𝑖</ci></apply><apply id="algorithm3.18.18.m1.2.2.1.cmml" xref="algorithm3.18.18.m1.2.2.1"><union id="algorithm3.18.18.m1.2.2.1.2.cmml" xref="algorithm3.18.18.m1.2.2.1.2"></union><apply id="algorithm3.18.18.m1.2.2.1.3.cmml" xref="algorithm3.18.18.m1.2.2.1.3"><csymbol cd="ambiguous" id="algorithm3.18.18.m1.2.2.1.3.1.cmml" xref="algorithm3.18.18.m1.2.2.1.3">subscript</csymbol><ci id="algorithm3.18.18.m1.2.2.1.3.2.cmml" xref="algorithm3.18.18.m1.2.2.1.3.2">𝒟</ci><ci id="algorithm3.18.18.m1.2.2.1.3.3.cmml" xref="algorithm3.18.18.m1.2.2.1.3.3">𝑖</ci></apply><set id="algorithm3.18.18.m1.2.2.1.1.2.cmml" xref="algorithm3.18.18.m1.2.2.1.1.1"><interval closure="open" id="algorithm3.18.18.m1.2.2.1.1.1.1.2.cmml" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1"><apply id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.2">𝐱</ci><cn id="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="algorithm3.18.18.m1.2.2.1.1.1.1.1.1.3">0</cn></apply><ci id="algorithm3.18.18.m1.1.1.cmml" xref="algorithm3.18.18.m1.1.1">𝑖</ci></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.18.18.m1.2c">\mathcal{D}_{i}\leftarrow\mathcal{D}_{i}\cup\{(\mathbf{x}_{0},i)\}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.18.18.m1.2d">caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∪ { ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_i ) }</annotation></semantics></math><span class="ltx_text" id="algorithm3.18.18.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.19.19">
<span class="ltx_text" id="algorithm3.19.19.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.19.19.2" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.19.19.3" style="font-size:90%;">   </span><math alttext="\mathcal{D}_{\text{syn}}\leftarrow\mathcal{D}_{\text{syn}}\cup\mathcal{D}_{i}" class="ltx_Math" display="inline" id="algorithm3.19.19.m1.1"><semantics id="algorithm3.19.19.m1.1a"><mrow id="algorithm3.19.19.m1.1.1" xref="algorithm3.19.19.m1.1.1.cmml"><msub id="algorithm3.19.19.m1.1.1.2" xref="algorithm3.19.19.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.19.19.m1.1.1.2.2" mathsize="90%" xref="algorithm3.19.19.m1.1.1.2.2.cmml">𝒟</mi><mtext id="algorithm3.19.19.m1.1.1.2.3" mathsize="90%" xref="algorithm3.19.19.m1.1.1.2.3a.cmml">syn</mtext></msub><mo id="algorithm3.19.19.m1.1.1.1" mathsize="90%" stretchy="false" xref="algorithm3.19.19.m1.1.1.1.cmml">←</mo><mrow id="algorithm3.19.19.m1.1.1.3" xref="algorithm3.19.19.m1.1.1.3.cmml"><msub id="algorithm3.19.19.m1.1.1.3.2" xref="algorithm3.19.19.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.19.19.m1.1.1.3.2.2" mathsize="90%" xref="algorithm3.19.19.m1.1.1.3.2.2.cmml">𝒟</mi><mtext id="algorithm3.19.19.m1.1.1.3.2.3" mathsize="90%" xref="algorithm3.19.19.m1.1.1.3.2.3a.cmml">syn</mtext></msub><mo id="algorithm3.19.19.m1.1.1.3.1" mathsize="90%" xref="algorithm3.19.19.m1.1.1.3.1.cmml">∪</mo><msub id="algorithm3.19.19.m1.1.1.3.3" xref="algorithm3.19.19.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.19.19.m1.1.1.3.3.2" mathsize="90%" xref="algorithm3.19.19.m1.1.1.3.3.2.cmml">𝒟</mi><mi id="algorithm3.19.19.m1.1.1.3.3.3" mathsize="90%" xref="algorithm3.19.19.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.19.19.m1.1b"><apply id="algorithm3.19.19.m1.1.1.cmml" xref="algorithm3.19.19.m1.1.1"><ci id="algorithm3.19.19.m1.1.1.1.cmml" xref="algorithm3.19.19.m1.1.1.1">←</ci><apply id="algorithm3.19.19.m1.1.1.2.cmml" xref="algorithm3.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.1.1.2.1.cmml" xref="algorithm3.19.19.m1.1.1.2">subscript</csymbol><ci id="algorithm3.19.19.m1.1.1.2.2.cmml" xref="algorithm3.19.19.m1.1.1.2.2">𝒟</ci><ci id="algorithm3.19.19.m1.1.1.2.3a.cmml" xref="algorithm3.19.19.m1.1.1.2.3"><mtext id="algorithm3.19.19.m1.1.1.2.3.cmml" mathsize="63%" xref="algorithm3.19.19.m1.1.1.2.3">syn</mtext></ci></apply><apply id="algorithm3.19.19.m1.1.1.3.cmml" xref="algorithm3.19.19.m1.1.1.3"><union id="algorithm3.19.19.m1.1.1.3.1.cmml" xref="algorithm3.19.19.m1.1.1.3.1"></union><apply id="algorithm3.19.19.m1.1.1.3.2.cmml" xref="algorithm3.19.19.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.1.1.3.2.1.cmml" xref="algorithm3.19.19.m1.1.1.3.2">subscript</csymbol><ci id="algorithm3.19.19.m1.1.1.3.2.2.cmml" xref="algorithm3.19.19.m1.1.1.3.2.2">𝒟</ci><ci id="algorithm3.19.19.m1.1.1.3.2.3a.cmml" xref="algorithm3.19.19.m1.1.1.3.2.3"><mtext id="algorithm3.19.19.m1.1.1.3.2.3.cmml" mathsize="63%" xref="algorithm3.19.19.m1.1.1.3.2.3">syn</mtext></ci></apply><apply id="algorithm3.19.19.m1.1.1.3.3.cmml" xref="algorithm3.19.19.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.1.1.3.3.1.cmml" xref="algorithm3.19.19.m1.1.1.3.3">subscript</csymbol><ci id="algorithm3.19.19.m1.1.1.3.3.2.cmml" xref="algorithm3.19.19.m1.1.1.3.3.2">𝒟</ci><ci id="algorithm3.19.19.m1.1.1.3.3.3.cmml" xref="algorithm3.19.19.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.19.19.m1.1c">\mathcal{D}_{\text{syn}}\leftarrow\mathcal{D}_{\text{syn}}\cup\mathcal{D}_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.19.19.m1.1d">caligraphic_D start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT ← caligraphic_D start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT ∪ caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.19.19.4" style="font-size:90%;">;
</span>
</div>
<div class="ltx_listingline" id="algorithm3.20.23">
<span class="ltx_text" id="algorithm3.20.23.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.20.23.2" style="font-size:90%;">   </span><span class="ltx_text" id="algorithm3.20.23.3" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm3.20.24">
<span class="ltx_text" id="algorithm3.20.24.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="algorithm3.20.24.2" style="font-size:90%;">   </span>
</div>
<div class="ltx_listingline" id="algorithm3.20.25">
<span class="ltx_text" id="algorithm3.20.25.1" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="algorithm3.20.26">
</div>
<div class="ltx_listingline" id="algorithm3.20.20">
<span class="ltx_text ltx_font_bold" id="algorithm3.20.20.1" style="font-size:90%;">return</span><span class="ltx_text" id="algorithm3.20.20.2" style="font-size:90%;"> </span><math alttext="\mathcal{D}_{\text{syn}}" class="ltx_Math" display="inline" id="algorithm3.20.20.m1.1"><semantics id="algorithm3.20.20.m1.1a"><msub id="algorithm3.20.20.m1.1.1" xref="algorithm3.20.20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.20.20.m1.1.1.2" mathsize="90%" xref="algorithm3.20.20.m1.1.1.2.cmml">𝒟</mi><mtext id="algorithm3.20.20.m1.1.1.3" mathsize="90%" xref="algorithm3.20.20.m1.1.1.3a.cmml">syn</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.20.20.m1.1b"><apply id="algorithm3.20.20.m1.1.1.cmml" xref="algorithm3.20.20.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.1.cmml" xref="algorithm3.20.20.m1.1.1">subscript</csymbol><ci id="algorithm3.20.20.m1.1.1.2.cmml" xref="algorithm3.20.20.m1.1.1.2">𝒟</ci><ci id="algorithm3.20.20.m1.1.1.3a.cmml" xref="algorithm3.20.20.m1.1.1.3"><mtext id="algorithm3.20.20.m1.1.1.3.cmml" mathsize="63%" xref="algorithm3.20.20.m1.1.1.3">syn</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.20.20.m1.1c">\mathcal{D}_{\text{syn}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.20.20.m1.1d">caligraphic_D start_POSTSUBSCRIPT syn end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="algorithm3.20.20.3" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm3.24.1.1">Algorithm 3</span> </span>Synthetic Dataset Generation</figcaption>
</figure>
<br class="ltx_break ltx_break"/><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="736" id="S3.F2.1.g1" src="extracted/5880644/sec/show2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text" id="S3.F2.5.4.2" style="font-size:90%;">Qualitative comparison of face images generated by the adjusted score function <math alttext="\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.F2.4.3.1.m1.3"><semantics id="S3.F2.4.3.1.m1.3b"><mrow id="S3.F2.4.3.1.m1.3.3" xref="S3.F2.4.3.1.m1.3.3.cmml"><mrow id="S3.F2.4.3.1.m1.3.3.3" xref="S3.F2.4.3.1.m1.3.3.3.cmml"><mrow id="S3.F2.4.3.1.m1.3.3.3.1" xref="S3.F2.4.3.1.m1.3.3.3.1.cmml"><mo id="S3.F2.4.3.1.m1.3.3.3.1.1" rspace="0.167em" xref="S3.F2.4.3.1.m1.3.3.3.1.1.cmml">∇</mo><mi id="S3.F2.4.3.1.m1.3.3.3.1.2" xref="S3.F2.4.3.1.m1.3.3.3.1.2.cmml">log</mi></mrow><mo id="S3.F2.4.3.1.m1.3.3.3b" lspace="0.167em" xref="S3.F2.4.3.1.m1.3.3.3.cmml">⁡</mo><mover accent="true" id="S3.F2.4.3.1.m1.3.3.3.2" xref="S3.F2.4.3.1.m1.3.3.3.2.cmml"><mi id="S3.F2.4.3.1.m1.3.3.3.2.2" xref="S3.F2.4.3.1.m1.3.3.3.2.2.cmml">p</mi><mo id="S3.F2.4.3.1.m1.3.3.3.2.1" xref="S3.F2.4.3.1.m1.3.3.3.2.1.cmml">~</mo></mover></mrow><mo id="S3.F2.4.3.1.m1.3.3.2" xref="S3.F2.4.3.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.F2.4.3.1.m1.3.3.1.1" xref="S3.F2.4.3.1.m1.3.3.1.1.1.cmml"><mo id="S3.F2.4.3.1.m1.3.3.1.1.2" stretchy="false" xref="S3.F2.4.3.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.F2.4.3.1.m1.3.3.1.1.1" xref="S3.F2.4.3.1.m1.3.3.1.1.1.cmml"><msub id="S3.F2.4.3.1.m1.3.3.1.1.1.2" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2.cmml"><mi id="S3.F2.4.3.1.m1.3.3.1.1.1.2.2" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.F2.4.3.1.m1.3.3.1.1.1.2.3" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.F2.4.3.1.m1.3.3.1.1.1.1" xref="S3.F2.4.3.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.F2.4.3.1.m1.3.3.1.1.1.3.2" xref="S3.F2.4.3.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.F2.4.3.1.m1.1.1" xref="S3.F2.4.3.1.m1.1.1.cmml">𝐲</mi><mo id="S3.F2.4.3.1.m1.3.3.1.1.1.3.2.1" xref="S3.F2.4.3.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.F2.4.3.1.m1.2.2" xref="S3.F2.4.3.1.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.F2.4.3.1.m1.3.3.1.1.3" stretchy="false" xref="S3.F2.4.3.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.4.3.1.m1.3c"><apply id="S3.F2.4.3.1.m1.3.3.cmml" xref="S3.F2.4.3.1.m1.3.3"><times id="S3.F2.4.3.1.m1.3.3.2.cmml" xref="S3.F2.4.3.1.m1.3.3.2"></times><apply id="S3.F2.4.3.1.m1.3.3.3.cmml" xref="S3.F2.4.3.1.m1.3.3.3"><apply id="S3.F2.4.3.1.m1.3.3.3.1.cmml" xref="S3.F2.4.3.1.m1.3.3.3.1"><ci id="S3.F2.4.3.1.m1.3.3.3.1.1.cmml" xref="S3.F2.4.3.1.m1.3.3.3.1.1">∇</ci><log id="S3.F2.4.3.1.m1.3.3.3.1.2.cmml" xref="S3.F2.4.3.1.m1.3.3.3.1.2"></log></apply><apply id="S3.F2.4.3.1.m1.3.3.3.2.cmml" xref="S3.F2.4.3.1.m1.3.3.3.2"><ci id="S3.F2.4.3.1.m1.3.3.3.2.1.cmml" xref="S3.F2.4.3.1.m1.3.3.3.2.1">~</ci><ci id="S3.F2.4.3.1.m1.3.3.3.2.2.cmml" xref="S3.F2.4.3.1.m1.3.3.3.2.2">𝑝</ci></apply></apply><apply id="S3.F2.4.3.1.m1.3.3.1.1.1.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.F2.4.3.1.m1.3.3.1.1.1.1.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.1">conditional</csymbol><apply id="S3.F2.4.3.1.m1.3.3.1.1.1.2.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.4.3.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.F2.4.3.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2.2">𝐱</ci><ci id="S3.F2.4.3.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.2.3">𝑡</ci></apply><list id="S3.F2.4.3.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.F2.4.3.1.m1.3.3.1.1.1.3.2"><ci id="S3.F2.4.3.1.m1.1.1.cmml" xref="S3.F2.4.3.1.m1.1.1">𝐲</ci><ci id="S3.F2.4.3.1.m1.2.2.cmml" xref="S3.F2.4.3.1.m1.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.3.1.m1.3d">\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.F2.4.3.1.m1.3e">∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math> and the original score function <math alttext="\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="S3.F2.5.4.2.m2.3"><semantics id="S3.F2.5.4.2.m2.3b"><mrow id="S3.F2.5.4.2.m2.3.3" xref="S3.F2.5.4.2.m2.3.3.cmml"><mrow id="S3.F2.5.4.2.m2.3.3.3" xref="S3.F2.5.4.2.m2.3.3.3.cmml"><mrow id="S3.F2.5.4.2.m2.3.3.3.1" xref="S3.F2.5.4.2.m2.3.3.3.1.cmml"><mo id="S3.F2.5.4.2.m2.3.3.3.1.1" rspace="0.167em" xref="S3.F2.5.4.2.m2.3.3.3.1.1.cmml">∇</mo><mi id="S3.F2.5.4.2.m2.3.3.3.1.2" xref="S3.F2.5.4.2.m2.3.3.3.1.2.cmml">log</mi></mrow><mo id="S3.F2.5.4.2.m2.3.3.3b" lspace="0.167em" xref="S3.F2.5.4.2.m2.3.3.3.cmml">⁡</mo><mi id="S3.F2.5.4.2.m2.3.3.3.2" xref="S3.F2.5.4.2.m2.3.3.3.2.cmml">p</mi></mrow><mo id="S3.F2.5.4.2.m2.3.3.2" xref="S3.F2.5.4.2.m2.3.3.2.cmml">⁢</mo><mrow id="S3.F2.5.4.2.m2.3.3.1.1" xref="S3.F2.5.4.2.m2.3.3.1.1.1.cmml"><mo id="S3.F2.5.4.2.m2.3.3.1.1.2" stretchy="false" xref="S3.F2.5.4.2.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.F2.5.4.2.m2.3.3.1.1.1" xref="S3.F2.5.4.2.m2.3.3.1.1.1.cmml"><msub id="S3.F2.5.4.2.m2.3.3.1.1.1.2" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2.cmml"><mi id="S3.F2.5.4.2.m2.3.3.1.1.1.2.2" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.F2.5.4.2.m2.3.3.1.1.1.2.3" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.F2.5.4.2.m2.3.3.1.1.1.1" xref="S3.F2.5.4.2.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.F2.5.4.2.m2.3.3.1.1.1.3.2" xref="S3.F2.5.4.2.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.F2.5.4.2.m2.1.1" xref="S3.F2.5.4.2.m2.1.1.cmml">𝐲</mi><mo id="S3.F2.5.4.2.m2.3.3.1.1.1.3.2.1" xref="S3.F2.5.4.2.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.F2.5.4.2.m2.2.2" xref="S3.F2.5.4.2.m2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="S3.F2.5.4.2.m2.3.3.1.1.3" stretchy="false" xref="S3.F2.5.4.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.5.4.2.m2.3c"><apply id="S3.F2.5.4.2.m2.3.3.cmml" xref="S3.F2.5.4.2.m2.3.3"><times id="S3.F2.5.4.2.m2.3.3.2.cmml" xref="S3.F2.5.4.2.m2.3.3.2"></times><apply id="S3.F2.5.4.2.m2.3.3.3.cmml" xref="S3.F2.5.4.2.m2.3.3.3"><apply id="S3.F2.5.4.2.m2.3.3.3.1.cmml" xref="S3.F2.5.4.2.m2.3.3.3.1"><ci id="S3.F2.5.4.2.m2.3.3.3.1.1.cmml" xref="S3.F2.5.4.2.m2.3.3.3.1.1">∇</ci><log id="S3.F2.5.4.2.m2.3.3.3.1.2.cmml" xref="S3.F2.5.4.2.m2.3.3.3.1.2"></log></apply><ci id="S3.F2.5.4.2.m2.3.3.3.2.cmml" xref="S3.F2.5.4.2.m2.3.3.3.2">𝑝</ci></apply><apply id="S3.F2.5.4.2.m2.3.3.1.1.1.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1"><csymbol cd="latexml" id="S3.F2.5.4.2.m2.3.3.1.1.1.1.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.1">conditional</csymbol><apply id="S3.F2.5.4.2.m2.3.3.1.1.1.2.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.5.4.2.m2.3.3.1.1.1.2.1.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2">subscript</csymbol><ci id="S3.F2.5.4.2.m2.3.3.1.1.1.2.2.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2.2">𝐱</ci><ci id="S3.F2.5.4.2.m2.3.3.1.1.1.2.3.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.2.3">𝑡</ci></apply><list id="S3.F2.5.4.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.F2.5.4.2.m2.3.3.1.1.1.3.2"><ci id="S3.F2.5.4.2.m2.1.1.cmml" xref="S3.F2.5.4.2.m2.1.1">𝐲</ci><ci id="S3.F2.5.4.2.m2.2.2.cmml" xref="S3.F2.5.4.2.m2.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.4.2.m2.3d">\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.4.2.m2.3e">∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s )</annotation></semantics></math>.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Synthetic Dataset Generation</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">In terms of the second question (<span class="ltx_text ltx_font_bold" id="S3.SS5.p1.1.1">RQ2</span>): after training ID<sup class="ltx_sup" id="S3.SS5.p1.1.2">3</sup>, with what sampling strategy is it possible to generate a synthetic face dataset on which SoTA face recognition models can be trained and perform well on challenging benchmarks?</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.10">Our proposed dataset-generating algorithm goes as follows:
given <math alttext="N" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">italic_N</annotation></semantics></math> target identities,
we generate <math alttext="N" class="ltx_Math" display="inline" id="S3.SS5.p2.2.m2.1"><semantics id="S3.SS5.p2.2.m2.1a"><mi id="S3.SS5.p2.2.m2.1.1" xref="S3.SS5.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.2.m2.1b"><ci id="S3.SS5.p2.2.m2.1.1.cmml" xref="S3.SS5.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.2.m2.1d">italic_N</annotation></semantics></math> anchor embeddings distributed on the sphere: <math alttext="\mathbf{w}_{1},\mathbf{w}_{2},...,\mathbf{w}_{N}\in\mathbb{S}^{d-1}" class="ltx_Math" display="inline" id="S3.SS5.p2.3.m3.4"><semantics id="S3.SS5.p2.3.m3.4a"><mrow id="S3.SS5.p2.3.m3.4.4" xref="S3.SS5.p2.3.m3.4.4.cmml"><mrow id="S3.SS5.p2.3.m3.4.4.3.3" xref="S3.SS5.p2.3.m3.4.4.3.4.cmml"><msub id="S3.SS5.p2.3.m3.2.2.1.1.1" xref="S3.SS5.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS5.p2.3.m3.2.2.1.1.1.2" xref="S3.SS5.p2.3.m3.2.2.1.1.1.2.cmml">𝐰</mi><mn id="S3.SS5.p2.3.m3.2.2.1.1.1.3" xref="S3.SS5.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS5.p2.3.m3.4.4.3.3.4" xref="S3.SS5.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS5.p2.3.m3.3.3.2.2.2" xref="S3.SS5.p2.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS5.p2.3.m3.3.3.2.2.2.2" xref="S3.SS5.p2.3.m3.3.3.2.2.2.2.cmml">𝐰</mi><mn id="S3.SS5.p2.3.m3.3.3.2.2.2.3" xref="S3.SS5.p2.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS5.p2.3.m3.4.4.3.3.5" xref="S3.SS5.p2.3.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS5.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS5.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS5.p2.3.m3.4.4.3.3.6" xref="S3.SS5.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS5.p2.3.m3.4.4.3.3.3" xref="S3.SS5.p2.3.m3.4.4.3.3.3.cmml"><mi id="S3.SS5.p2.3.m3.4.4.3.3.3.2" xref="S3.SS5.p2.3.m3.4.4.3.3.3.2.cmml">𝐰</mi><mi id="S3.SS5.p2.3.m3.4.4.3.3.3.3" xref="S3.SS5.p2.3.m3.4.4.3.3.3.3.cmml">N</mi></msub></mrow><mo id="S3.SS5.p2.3.m3.4.4.4" xref="S3.SS5.p2.3.m3.4.4.4.cmml">∈</mo><msup id="S3.SS5.p2.3.m3.4.4.5" xref="S3.SS5.p2.3.m3.4.4.5.cmml"><mi id="S3.SS5.p2.3.m3.4.4.5.2" xref="S3.SS5.p2.3.m3.4.4.5.2.cmml">𝕊</mi><mrow id="S3.SS5.p2.3.m3.4.4.5.3" xref="S3.SS5.p2.3.m3.4.4.5.3.cmml"><mi id="S3.SS5.p2.3.m3.4.4.5.3.2" xref="S3.SS5.p2.3.m3.4.4.5.3.2.cmml">d</mi><mo id="S3.SS5.p2.3.m3.4.4.5.3.1" xref="S3.SS5.p2.3.m3.4.4.5.3.1.cmml">−</mo><mn id="S3.SS5.p2.3.m3.4.4.5.3.3" xref="S3.SS5.p2.3.m3.4.4.5.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m3.4b"><apply id="S3.SS5.p2.3.m3.4.4.cmml" xref="S3.SS5.p2.3.m3.4.4"><in id="S3.SS5.p2.3.m3.4.4.4.cmml" xref="S3.SS5.p2.3.m3.4.4.4"></in><list id="S3.SS5.p2.3.m3.4.4.3.4.cmml" xref="S3.SS5.p2.3.m3.4.4.3.3"><apply id="S3.SS5.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS5.p2.3.m3.2.2.1.1.1.2">𝐰</ci><cn id="S3.SS5.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS5.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS5.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS5.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS5.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS5.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS5.p2.3.m3.3.3.2.2.2.2">𝐰</ci><cn id="S3.SS5.p2.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS5.p2.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS5.p2.3.m3.1.1.cmml" xref="S3.SS5.p2.3.m3.1.1">…</ci><apply id="S3.SS5.p2.3.m3.4.4.3.3.3.cmml" xref="S3.SS5.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS5.p2.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS5.p2.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS5.p2.3.m3.4.4.3.3.3.2">𝐰</ci><ci id="S3.SS5.p2.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS5.p2.3.m3.4.4.3.3.3.3">𝑁</ci></apply></list><apply id="S3.SS5.p2.3.m3.4.4.5.cmml" xref="S3.SS5.p2.3.m3.4.4.5"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m3.4.4.5.1.cmml" xref="S3.SS5.p2.3.m3.4.4.5">superscript</csymbol><ci id="S3.SS5.p2.3.m3.4.4.5.2.cmml" xref="S3.SS5.p2.3.m3.4.4.5.2">𝕊</ci><apply id="S3.SS5.p2.3.m3.4.4.5.3.cmml" xref="S3.SS5.p2.3.m3.4.4.5.3"><minus id="S3.SS5.p2.3.m3.4.4.5.3.1.cmml" xref="S3.SS5.p2.3.m3.4.4.5.3.1"></minus><ci id="S3.SS5.p2.3.m3.4.4.5.3.2.cmml" xref="S3.SS5.p2.3.m3.4.4.5.3.2">𝑑</ci><cn id="S3.SS5.p2.3.m3.4.4.5.3.3.cmml" type="integer" xref="S3.SS5.p2.3.m3.4.4.5.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m3.4c">\mathbf{w}_{1},\mathbf{w}_{2},...,\mathbf{w}_{N}\in\mathbb{S}^{d-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.3.m3.4d">bold_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_w start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ∈ blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> as uniformly as possible in the sense that each pair of the embeddings are maximally separated on the unit sphere<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_tag ltx_tag_note">*</span>This is known as the Tammes problem <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Tammes</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">1930</span></a>)</cite> for which there exists no exact solution for hypersphere <math alttext="\mathbb{S}^{d-1},d&gt;3" class="ltx_Math" display="inline" id="footnote1.m1.2"><semantics id="footnote1.m1.2b"><mrow id="footnote1.m1.2.2" xref="footnote1.m1.2.2.cmml"><mrow id="footnote1.m1.2.2.1.1" xref="footnote1.m1.2.2.1.2.cmml"><msup id="footnote1.m1.2.2.1.1.1" xref="footnote1.m1.2.2.1.1.1.cmml"><mi id="footnote1.m1.2.2.1.1.1.2" xref="footnote1.m1.2.2.1.1.1.2.cmml">𝕊</mi><mrow id="footnote1.m1.2.2.1.1.1.3" xref="footnote1.m1.2.2.1.1.1.3.cmml"><mi id="footnote1.m1.2.2.1.1.1.3.2" xref="footnote1.m1.2.2.1.1.1.3.2.cmml">d</mi><mo id="footnote1.m1.2.2.1.1.1.3.1" xref="footnote1.m1.2.2.1.1.1.3.1.cmml">−</mo><mn id="footnote1.m1.2.2.1.1.1.3.3" xref="footnote1.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="footnote1.m1.2.2.1.1.2" xref="footnote1.m1.2.2.1.2.cmml">,</mo><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">d</mi></mrow><mo id="footnote1.m1.2.2.2" xref="footnote1.m1.2.2.2.cmml">&gt;</mo><mn id="footnote1.m1.2.2.3" xref="footnote1.m1.2.2.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.2c"><apply id="footnote1.m1.2.2.cmml" xref="footnote1.m1.2.2"><gt id="footnote1.m1.2.2.2.cmml" xref="footnote1.m1.2.2.2"></gt><list id="footnote1.m1.2.2.1.2.cmml" xref="footnote1.m1.2.2.1.1"><apply id="footnote1.m1.2.2.1.1.1.cmml" xref="footnote1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="footnote1.m1.2.2.1.1.1.1.cmml" xref="footnote1.m1.2.2.1.1.1">superscript</csymbol><ci id="footnote1.m1.2.2.1.1.1.2.cmml" xref="footnote1.m1.2.2.1.1.1.2">𝕊</ci><apply id="footnote1.m1.2.2.1.1.1.3.cmml" xref="footnote1.m1.2.2.1.1.1.3"><minus id="footnote1.m1.2.2.1.1.1.3.1.cmml" xref="footnote1.m1.2.2.1.1.1.3.1"></minus><ci id="footnote1.m1.2.2.1.1.1.3.2.cmml" xref="footnote1.m1.2.2.1.1.1.3.2">𝑑</ci><cn id="footnote1.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="footnote1.m1.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑑</ci></list><cn id="footnote1.m1.2.2.3.cmml" type="integer" xref="footnote1.m1.2.2.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.2d">\mathbb{S}^{d-1},d&gt;3</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.2e">blackboard_S start_POSTSUPERSCRIPT italic_d - 1 end_POSTSUPERSCRIPT , italic_d &gt; 3</annotation></semantics></math>. However, one can use the optimization technique introduced in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Mettes et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">2019</span></a>)</cite>.</span></span></span>. For each anchor <math alttext="\mathbf{w}_{i}" class="ltx_Math" display="inline" id="S3.SS5.p2.4.m4.1"><semantics id="S3.SS5.p2.4.m4.1a"><msub id="S3.SS5.p2.4.m4.1.1" xref="S3.SS5.p2.4.m4.1.1.cmml"><mi id="S3.SS5.p2.4.m4.1.1.2" xref="S3.SS5.p2.4.m4.1.1.2.cmml">𝐰</mi><mi id="S3.SS5.p2.4.m4.1.1.3" xref="S3.SS5.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.4.m4.1b"><apply id="S3.SS5.p2.4.m4.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.4.m4.1.1.1.cmml" xref="S3.SS5.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p2.4.m4.1.1.2.cmml" xref="S3.SS5.p2.4.m4.1.1.2">𝐰</ci><ci id="S3.SS5.p2.4.m4.1.1.3.cmml" xref="S3.SS5.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.4.m4.1c">\mathbf{w}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.4.m4.1d">bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we would like to generate <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p2.5.m5.1"><semantics id="S3.SS5.p2.5.m5.1a"><mi id="S3.SS5.p2.5.m5.1.1" xref="S3.SS5.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.5.m5.1b"><ci id="S3.SS5.p2.5.m5.1.1.cmml" xref="S3.SS5.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.5.m5.1d">italic_m</annotation></semantics></math> identity embeddings perturbed around <math alttext="\mathbf{w}_{i}" class="ltx_Math" display="inline" id="S3.SS5.p2.6.m6.1"><semantics id="S3.SS5.p2.6.m6.1a"><msub id="S3.SS5.p2.6.m6.1.1" xref="S3.SS5.p2.6.m6.1.1.cmml"><mi id="S3.SS5.p2.6.m6.1.1.2" xref="S3.SS5.p2.6.m6.1.1.2.cmml">𝐰</mi><mi id="S3.SS5.p2.6.m6.1.1.3" xref="S3.SS5.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.6.m6.1b"><apply id="S3.SS5.p2.6.m6.1.1.cmml" xref="S3.SS5.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.6.m6.1.1.1.cmml" xref="S3.SS5.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS5.p2.6.m6.1.1.2.cmml" xref="S3.SS5.p2.6.m6.1.1.2">𝐰</ci><ci id="S3.SS5.p2.6.m6.1.1.3.cmml" xref="S3.SS5.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.6.m6.1c">\mathbf{w}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.6.m6.1d">bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> while ensuring that these <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p2.7.m7.1"><semantics id="S3.SS5.p2.7.m7.1a"><mi id="S3.SS5.p2.7.m7.1.1" xref="S3.SS5.p2.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.7.m7.1b"><ci id="S3.SS5.p2.7.m7.1.1.cmml" xref="S3.SS5.p2.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.7.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.7.m7.1d">italic_m</annotation></semantics></math> identity embeddings get close to but different than <math alttext="\mathbf{w}_{i}" class="ltx_Math" display="inline" id="S3.SS5.p2.8.m8.1"><semantics id="S3.SS5.p2.8.m8.1a"><msub id="S3.SS5.p2.8.m8.1.1" xref="S3.SS5.p2.8.m8.1.1.cmml"><mi id="S3.SS5.p2.8.m8.1.1.2" xref="S3.SS5.p2.8.m8.1.1.2.cmml">𝐰</mi><mi id="S3.SS5.p2.8.m8.1.1.3" xref="S3.SS5.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.8.m8.1b"><apply id="S3.SS5.p2.8.m8.1.1.cmml" xref="S3.SS5.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.8.m8.1.1.1.cmml" xref="S3.SS5.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS5.p2.8.m8.1.1.2.cmml" xref="S3.SS5.p2.8.m8.1.1.2">𝐰</ci><ci id="S3.SS5.p2.8.m8.1.1.3.cmml" xref="S3.SS5.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.8.m8.1c">\mathbf{w}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.8.m8.1d">bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, to find these <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p2.9.m9.1"><semantics id="S3.SS5.p2.9.m9.1a"><mi id="S3.SS5.p2.9.m9.1.1" xref="S3.SS5.p2.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.9.m9.1b"><ci id="S3.SS5.p2.9.m9.1.1.cmml" xref="S3.SS5.p2.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.9.m9.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.9.m9.1d">italic_m</annotation></semantics></math> identity embeddings, we solve the following optimization problem <math alttext="\mathbf{P}_{i}" class="ltx_Math" display="inline" id="S3.SS5.p2.10.m10.1"><semantics id="S3.SS5.p2.10.m10.1a"><msub id="S3.SS5.p2.10.m10.1.1" xref="S3.SS5.p2.10.m10.1.1.cmml"><mi id="S3.SS5.p2.10.m10.1.1.2" xref="S3.SS5.p2.10.m10.1.1.2.cmml">𝐏</mi><mi id="S3.SS5.p2.10.m10.1.1.3" xref="S3.SS5.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.10.m10.1b"><apply id="S3.SS5.p2.10.m10.1.1.cmml" xref="S3.SS5.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.10.m10.1.1.1.cmml" xref="S3.SS5.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS5.p2.10.m10.1.1.2.cmml" xref="S3.SS5.p2.10.m10.1.1.2">𝐏</ci><ci id="S3.SS5.p2.10.m10.1.1.3.cmml" xref="S3.SS5.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.10.m10.1c">\mathbf{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.10.m10.1d">bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\mathbf{y}_{ij},j=1,...,m}\left\lVert\begin{bmatrix}-\mathbf{w}_{i}^{T}-%
\end{bmatrix}\operatorname{norm}\Bigg{(}\underbrace{\begin{bmatrix}|&amp;|&amp;\cdots&amp;%
|\\
\mathbf{y}_{i1}&amp;\mathbf{y}_{i2}&amp;...&amp;\mathbf{y}_{im}\\
|&amp;|&amp;\cdots&amp;|\end{bmatrix}}_{\mathbf{Y}_{i}}\Bigg{)}-\begin{bmatrix}\nu_{i1},%
\nu_{i2},...\nu_{im}\end{bmatrix}\right\rVert_{2}^{2}" class="ltx_math_unparsed" display="block" id="S3.E9.m1.9"><semantics id="S3.E9.m1.9a"><mrow id="S3.E9.m1.9b"><munder id="S3.E9.m1.9.10"><mi id="S3.E9.m1.9.10.2">min</mi><mrow id="S3.E9.m1.8.8.5.5"><mrow id="S3.E9.m1.7.7.4.4.1"><mrow id="S3.E9.m1.7.7.4.4.1.1.1"><msub id="S3.E9.m1.7.7.4.4.1.1.1.1"><mi id="S3.E9.m1.7.7.4.4.1.1.1.1.2">𝐲</mi><mrow id="S3.E9.m1.7.7.4.4.1.1.1.1.3"><mi id="S3.E9.m1.7.7.4.4.1.1.1.1.3.2">i</mi><mo id="S3.E9.m1.7.7.4.4.1.1.1.1.3.1">⁢</mo><mi id="S3.E9.m1.7.7.4.4.1.1.1.1.3.3">j</mi></mrow></msub><mo id="S3.E9.m1.7.7.4.4.1.1.1.2">,</mo><mi id="S3.E9.m1.4.4.1.1">j</mi></mrow><mo id="S3.E9.m1.7.7.4.4.1.2">=</mo><mn id="S3.E9.m1.7.7.4.4.1.3">1</mn></mrow><mo id="S3.E9.m1.8.8.5.5.3">,</mo><mrow id="S3.E9.m1.8.8.5.5.2.2"><mi id="S3.E9.m1.5.5.2.2" mathvariant="normal">…</mi><mo id="S3.E9.m1.8.8.5.5.2.2.1">,</mo><mi id="S3.E9.m1.6.6.3.3">m</mi></mrow></mrow></munder><msubsup id="S3.E9.m1.9.11"><mrow id="S3.E9.m1.9.11.2.2"><mo fence="true" id="S3.E9.m1.9.11.2.2.1" lspace="0em" rspace="0em" stretchy="true">∥</mo><mrow id="S3.E9.m1.1.1.3"><mo id="S3.E9.m1.1.1.3.1">[</mo><mtable displaystyle="true" id="S3.E9.m1.1.1.1.1"><mtr id="S3.E9.m1.1.1.1.1a"><mtd id="S3.E9.m1.1.1.1.1b"><mrow id="S3.E9.m1.1.1.1.1.1.1.1"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.2"><mo id="S3.E9.m1.1.1.1.1.1.1.1.2a">−</mo><msubsup id="S3.E9.m1.1.1.1.1.1.1.1.2.2"><mi id="S3.E9.m1.1.1.1.1.1.1.1.2.2.2.2">𝐰</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.2.2.2.3">i</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.2.2.3">T</mi></msubsup></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.3">−</mo></mrow></mtd></mtr></mtable><mo id="S3.E9.m1.1.1.3.2" rspace="0.167em">]</mo></mrow><mi id="S3.E9.m1.9.9">norm</mi><mrow id="S3.E9.m1.9.11.2.2.2"><mo id="S3.E9.m1.9.11.2.2.2.1" maxsize="260%" minsize="260%">(</mo><munder id="S3.E9.m1.9.11.2.2.2.2"><munder accentunder="true" id="S3.E9.m1.2.2"><mrow id="S3.E9.m1.2.2.1.3"><mo id="S3.E9.m1.2.2.1.3.1">[</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E9.m1.2.2.1.1.1.1" rowspacing="0pt"><mtr id="S3.E9.m1.2.2.1.1.1.1a"><mtd id="S3.E9.m1.2.2.1.1.1.1b"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.1.1.1" stretchy="false">|</mo></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1c"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.1.2.1" stretchy="false">|</mo></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1d"><mi id="S3.E9.m1.2.2.1.1.1.1.1.3.1" mathvariant="normal">⋯</mi></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1e"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.1.4.1" stretchy="false">|</mo></mtd></mtr><mtr id="S3.E9.m1.2.2.1.1.1.1f"><mtd id="S3.E9.m1.2.2.1.1.1.1g"><msub id="S3.E9.m1.2.2.1.1.1.1.2.1.1"><mi id="S3.E9.m1.2.2.1.1.1.1.2.1.1.2">𝐲</mi><mrow id="S3.E9.m1.2.2.1.1.1.1.2.1.1.3"><mi id="S3.E9.m1.2.2.1.1.1.1.2.1.1.3.2">i</mi><mo id="S3.E9.m1.2.2.1.1.1.1.2.1.1.3.1">⁢</mo><mn id="S3.E9.m1.2.2.1.1.1.1.2.1.1.3.3">1</mn></mrow></msub></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1h"><msub id="S3.E9.m1.2.2.1.1.1.1.2.2.1"><mi id="S3.E9.m1.2.2.1.1.1.1.2.2.1.2">𝐲</mi><mrow id="S3.E9.m1.2.2.1.1.1.1.2.2.1.3"><mi id="S3.E9.m1.2.2.1.1.1.1.2.2.1.3.2">i</mi><mo id="S3.E9.m1.2.2.1.1.1.1.2.2.1.3.1">⁢</mo><mn id="S3.E9.m1.2.2.1.1.1.1.2.2.1.3.3">2</mn></mrow></msub></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1i"><mi id="S3.E9.m1.2.2.1.1.1.1.2.3.1" mathvariant="normal">…</mi></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1j"><msub id="S3.E9.m1.2.2.1.1.1.1.2.4.1"><mi id="S3.E9.m1.2.2.1.1.1.1.2.4.1.2">𝐲</mi><mrow id="S3.E9.m1.2.2.1.1.1.1.2.4.1.3"><mi id="S3.E9.m1.2.2.1.1.1.1.2.4.1.3.2">i</mi><mo id="S3.E9.m1.2.2.1.1.1.1.2.4.1.3.1">⁢</mo><mi id="S3.E9.m1.2.2.1.1.1.1.2.4.1.3.3">m</mi></mrow></msub></mtd></mtr><mtr id="S3.E9.m1.2.2.1.1.1.1k"><mtd id="S3.E9.m1.2.2.1.1.1.1l"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.3.1.1" stretchy="false">|</mo></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1m"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.3.2.1" stretchy="false">|</mo></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1n"><mi id="S3.E9.m1.2.2.1.1.1.1.3.3.1" mathvariant="normal">⋯</mi></mtd><mtd id="S3.E9.m1.2.2.1.1.1.1o"><mo fence="false" id="S3.E9.m1.2.2.1.1.1.1.3.4.1" stretchy="false">|</mo></mtd></mtr></mtable><mo id="S3.E9.m1.2.2.1.3.2">]</mo></mrow><mo id="S3.E9.m1.2.2.2">⏟</mo></munder><msub id="S3.E9.m1.9.11.2.2.2.2.2"><mi id="S3.E9.m1.9.11.2.2.2.2.2.2">𝐘</mi><mi id="S3.E9.m1.9.11.2.2.2.2.2.3">i</mi></msub></munder><mo id="S3.E9.m1.9.11.2.2.2.3" maxsize="260%" minsize="260%">)</mo></mrow><mo id="S3.E9.m1.9.11.2.2.3">−</mo><mrow id="S3.E9.m1.3.3.3"><mo id="S3.E9.m1.3.3.3.1">[</mo><mtable displaystyle="true" id="S3.E9.m1.3.3.1.1"><mtr id="S3.E9.m1.3.3.1.1a"><mtd id="S3.E9.m1.3.3.1.1b"><mrow id="S3.E9.m1.3.3.1.1.3.3.3.3.3"><msub id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.2">ν</mi><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.3"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.3.2">i</mi><mo id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.3.1">⁢</mo><mn id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.3.3">1</mn></mrow></msub><mo id="S3.E9.m1.3.3.1.1.3.3.3.3.3.4">,</mo><msub id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2"><mi id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.2">ν</mi><mrow id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.3"><mi id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.3.2">i</mi><mo id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.3.1">⁢</mo><mn id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.3.3">2</mn></mrow></msub><mo id="S3.E9.m1.3.3.1.1.3.3.3.3.3.5">,</mo><mrow id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3"><mi id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.2" mathvariant="normal">…</mi><mo id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.1">⁢</mo><msub id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3"><mi id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3.2">ν</mi><mrow id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3.3"><mi id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3.3.2">i</mi><mo id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3.3.1">⁢</mo><mi id="S3.E9.m1.3.3.1.1.3.3.3.3.3.3.3.3.3">m</mi></mrow></msub></mrow></mrow></mtd></mtr></mtable><mo id="S3.E9.m1.3.3.3.2">]</mo></mrow><mo fence="true" id="S3.E9.m1.9.11.2.2.4" lspace="0em" stretchy="true">∥</mo></mrow><mn id="S3.E9.m1.9.11.2.3">2</mn><mn id="S3.E9.m1.9.11.3">2</mn></msubsup></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.9c">\min_{\mathbf{y}_{ij},j=1,...,m}\left\lVert\begin{bmatrix}-\mathbf{w}_{i}^{T}-%
\end{bmatrix}\operatorname{norm}\Bigg{(}\underbrace{\begin{bmatrix}|&amp;|&amp;\cdots&amp;%
|\\
\mathbf{y}_{i1}&amp;\mathbf{y}_{i2}&amp;...&amp;\mathbf{y}_{im}\\
|&amp;|&amp;\cdots&amp;|\end{bmatrix}}_{\mathbf{Y}_{i}}\Bigg{)}-\begin{bmatrix}\nu_{i1},%
\nu_{i2},...\nu_{im}\end{bmatrix}\right\rVert_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.9d">roman_min start_POSTSUBSCRIPT bold_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT , italic_j = 1 , … , italic_m end_POSTSUBSCRIPT ∥ [ start_ARG start_ROW start_CELL - bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT - end_CELL end_ROW end_ARG ] roman_norm ( under⏟ start_ARG [ start_ARG start_ROW start_CELL | end_CELL start_CELL | end_CELL start_CELL ⋯ end_CELL start_CELL | end_CELL end_ROW start_ROW start_CELL bold_y start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT end_CELL start_CELL bold_y start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT end_CELL start_CELL … end_CELL start_CELL bold_y start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL | end_CELL start_CELL | end_CELL start_CELL ⋯ end_CELL start_CELL | end_CELL end_ROW end_ARG ] end_ARG start_POSTSUBSCRIPT bold_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - [ start_ARG start_ROW start_CELL italic_ν start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT , italic_ν start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT , … italic_ν start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ] ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p2.14">where the operator <math alttext="\operatorname{norm}" class="ltx_Math" display="inline" id="S3.SS5.p2.11.m1.1"><semantics id="S3.SS5.p2.11.m1.1a"><mi id="S3.SS5.p2.11.m1.1.1" xref="S3.SS5.p2.11.m1.1.1.cmml">norm</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.11.m1.1b"><ci id="S3.SS5.p2.11.m1.1.1.cmml" xref="S3.SS5.p2.11.m1.1.1">norm</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.11.m1.1c">\operatorname{norm}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.11.m1.1d">roman_norm</annotation></semantics></math> is column-wise normalization which normalizes each column of <math alttext="\mathbf{Y}_{i}" class="ltx_Math" display="inline" id="S3.SS5.p2.12.m2.1"><semantics id="S3.SS5.p2.12.m2.1a"><msub id="S3.SS5.p2.12.m2.1.1" xref="S3.SS5.p2.12.m2.1.1.cmml"><mi id="S3.SS5.p2.12.m2.1.1.2" xref="S3.SS5.p2.12.m2.1.1.2.cmml">𝐘</mi><mi id="S3.SS5.p2.12.m2.1.1.3" xref="S3.SS5.p2.12.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.12.m2.1b"><apply id="S3.SS5.p2.12.m2.1.1.cmml" xref="S3.SS5.p2.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.12.m2.1.1.1.cmml" xref="S3.SS5.p2.12.m2.1.1">subscript</csymbol><ci id="S3.SS5.p2.12.m2.1.1.2.cmml" xref="S3.SS5.p2.12.m2.1.1.2">𝐘</ci><ci id="S3.SS5.p2.12.m2.1.1.3.cmml" xref="S3.SS5.p2.12.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.12.m2.1c">\mathbf{Y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.12.m2.1d">bold_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into a unit vector, and the desired similarity scores <math alttext="\nu_{i1},\nu_{i2},...,\nu_{im}" class="ltx_Math" display="inline" id="S3.SS5.p2.13.m3.4"><semantics id="S3.SS5.p2.13.m3.4a"><mrow id="S3.SS5.p2.13.m3.4.4.3" xref="S3.SS5.p2.13.m3.4.4.4.cmml"><msub id="S3.SS5.p2.13.m3.2.2.1.1" xref="S3.SS5.p2.13.m3.2.2.1.1.cmml"><mi id="S3.SS5.p2.13.m3.2.2.1.1.2" xref="S3.SS5.p2.13.m3.2.2.1.1.2.cmml">ν</mi><mrow id="S3.SS5.p2.13.m3.2.2.1.1.3" xref="S3.SS5.p2.13.m3.2.2.1.1.3.cmml"><mi id="S3.SS5.p2.13.m3.2.2.1.1.3.2" xref="S3.SS5.p2.13.m3.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS5.p2.13.m3.2.2.1.1.3.1" xref="S3.SS5.p2.13.m3.2.2.1.1.3.1.cmml">⁢</mo><mn id="S3.SS5.p2.13.m3.2.2.1.1.3.3" xref="S3.SS5.p2.13.m3.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS5.p2.13.m3.4.4.3.4" xref="S3.SS5.p2.13.m3.4.4.4.cmml">,</mo><msub id="S3.SS5.p2.13.m3.3.3.2.2" xref="S3.SS5.p2.13.m3.3.3.2.2.cmml"><mi id="S3.SS5.p2.13.m3.3.3.2.2.2" xref="S3.SS5.p2.13.m3.3.3.2.2.2.cmml">ν</mi><mrow id="S3.SS5.p2.13.m3.3.3.2.2.3" xref="S3.SS5.p2.13.m3.3.3.2.2.3.cmml"><mi id="S3.SS5.p2.13.m3.3.3.2.2.3.2" xref="S3.SS5.p2.13.m3.3.3.2.2.3.2.cmml">i</mi><mo id="S3.SS5.p2.13.m3.3.3.2.2.3.1" xref="S3.SS5.p2.13.m3.3.3.2.2.3.1.cmml">⁢</mo><mn id="S3.SS5.p2.13.m3.3.3.2.2.3.3" xref="S3.SS5.p2.13.m3.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.SS5.p2.13.m3.4.4.3.5" xref="S3.SS5.p2.13.m3.4.4.4.cmml">,</mo><mi id="S3.SS5.p2.13.m3.1.1" mathvariant="normal" xref="S3.SS5.p2.13.m3.1.1.cmml">…</mi><mo id="S3.SS5.p2.13.m3.4.4.3.6" xref="S3.SS5.p2.13.m3.4.4.4.cmml">,</mo><msub id="S3.SS5.p2.13.m3.4.4.3.3" xref="S3.SS5.p2.13.m3.4.4.3.3.cmml"><mi id="S3.SS5.p2.13.m3.4.4.3.3.2" xref="S3.SS5.p2.13.m3.4.4.3.3.2.cmml">ν</mi><mrow id="S3.SS5.p2.13.m3.4.4.3.3.3" xref="S3.SS5.p2.13.m3.4.4.3.3.3.cmml"><mi id="S3.SS5.p2.13.m3.4.4.3.3.3.2" xref="S3.SS5.p2.13.m3.4.4.3.3.3.2.cmml">i</mi><mo id="S3.SS5.p2.13.m3.4.4.3.3.3.1" xref="S3.SS5.p2.13.m3.4.4.3.3.3.1.cmml">⁢</mo><mi id="S3.SS5.p2.13.m3.4.4.3.3.3.3" xref="S3.SS5.p2.13.m3.4.4.3.3.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.13.m3.4b"><list id="S3.SS5.p2.13.m3.4.4.4.cmml" xref="S3.SS5.p2.13.m3.4.4.3"><apply id="S3.SS5.p2.13.m3.2.2.1.1.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.13.m3.2.2.1.1.1.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS5.p2.13.m3.2.2.1.1.2.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1.2">𝜈</ci><apply id="S3.SS5.p2.13.m3.2.2.1.1.3.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1.3"><times id="S3.SS5.p2.13.m3.2.2.1.1.3.1.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1.3.1"></times><ci id="S3.SS5.p2.13.m3.2.2.1.1.3.2.cmml" xref="S3.SS5.p2.13.m3.2.2.1.1.3.2">𝑖</ci><cn id="S3.SS5.p2.13.m3.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS5.p2.13.m3.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS5.p2.13.m3.3.3.2.2.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS5.p2.13.m3.3.3.2.2.1.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS5.p2.13.m3.3.3.2.2.2.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2.2">𝜈</ci><apply id="S3.SS5.p2.13.m3.3.3.2.2.3.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2.3"><times id="S3.SS5.p2.13.m3.3.3.2.2.3.1.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2.3.1"></times><ci id="S3.SS5.p2.13.m3.3.3.2.2.3.2.cmml" xref="S3.SS5.p2.13.m3.3.3.2.2.3.2">𝑖</ci><cn id="S3.SS5.p2.13.m3.3.3.2.2.3.3.cmml" type="integer" xref="S3.SS5.p2.13.m3.3.3.2.2.3.3">2</cn></apply></apply><ci id="S3.SS5.p2.13.m3.1.1.cmml" xref="S3.SS5.p2.13.m3.1.1">…</ci><apply id="S3.SS5.p2.13.m3.4.4.3.3.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS5.p2.13.m3.4.4.3.3.1.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS5.p2.13.m3.4.4.3.3.2.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3.2">𝜈</ci><apply id="S3.SS5.p2.13.m3.4.4.3.3.3.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3.3"><times id="S3.SS5.p2.13.m3.4.4.3.3.3.1.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3.3.1"></times><ci id="S3.SS5.p2.13.m3.4.4.3.3.3.2.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3.3.2">𝑖</ci><ci id="S3.SS5.p2.13.m3.4.4.3.3.3.3.cmml" xref="S3.SS5.p2.13.m3.4.4.3.3.3.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.13.m3.4c">\nu_{i1},\nu_{i2},...,\nu_{im}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.13.m3.4d">italic_ν start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT , italic_ν start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT , … , italic_ν start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT</annotation></semantics></math> are randomly generated from a continuous uniform distribution <math alttext="\mathcal{U}[lb,ub)" class="ltx_Math" display="inline" id="S3.SS5.p2.14.m4.2"><semantics id="S3.SS5.p2.14.m4.2a"><mrow id="S3.SS5.p2.14.m4.2.2" xref="S3.SS5.p2.14.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p2.14.m4.2.2.4" xref="S3.SS5.p2.14.m4.2.2.4.cmml">𝒰</mi><mo id="S3.SS5.p2.14.m4.2.2.3" xref="S3.SS5.p2.14.m4.2.2.3.cmml">⁢</mo><mrow id="S3.SS5.p2.14.m4.2.2.2.2" xref="S3.SS5.p2.14.m4.2.2.2.3.cmml"><mo id="S3.SS5.p2.14.m4.2.2.2.2.3" stretchy="false" xref="S3.SS5.p2.14.m4.2.2.2.3.cmml">[</mo><mrow id="S3.SS5.p2.14.m4.1.1.1.1.1" xref="S3.SS5.p2.14.m4.1.1.1.1.1.cmml"><mi id="S3.SS5.p2.14.m4.1.1.1.1.1.2" xref="S3.SS5.p2.14.m4.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS5.p2.14.m4.1.1.1.1.1.1" xref="S3.SS5.p2.14.m4.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p2.14.m4.1.1.1.1.1.3" xref="S3.SS5.p2.14.m4.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.SS5.p2.14.m4.2.2.2.2.4" xref="S3.SS5.p2.14.m4.2.2.2.3.cmml">,</mo><mrow id="S3.SS5.p2.14.m4.2.2.2.2.2" xref="S3.SS5.p2.14.m4.2.2.2.2.2.cmml"><mi id="S3.SS5.p2.14.m4.2.2.2.2.2.2" xref="S3.SS5.p2.14.m4.2.2.2.2.2.2.cmml">u</mi><mo id="S3.SS5.p2.14.m4.2.2.2.2.2.1" xref="S3.SS5.p2.14.m4.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS5.p2.14.m4.2.2.2.2.2.3" xref="S3.SS5.p2.14.m4.2.2.2.2.2.3.cmml">b</mi></mrow><mo id="S3.SS5.p2.14.m4.2.2.2.2.5" stretchy="false" xref="S3.SS5.p2.14.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.14.m4.2b"><apply id="S3.SS5.p2.14.m4.2.2.cmml" xref="S3.SS5.p2.14.m4.2.2"><times id="S3.SS5.p2.14.m4.2.2.3.cmml" xref="S3.SS5.p2.14.m4.2.2.3"></times><ci id="S3.SS5.p2.14.m4.2.2.4.cmml" xref="S3.SS5.p2.14.m4.2.2.4">𝒰</ci><interval closure="closed-open" id="S3.SS5.p2.14.m4.2.2.2.3.cmml" xref="S3.SS5.p2.14.m4.2.2.2.2"><apply id="S3.SS5.p2.14.m4.1.1.1.1.1.cmml" xref="S3.SS5.p2.14.m4.1.1.1.1.1"><times id="S3.SS5.p2.14.m4.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.14.m4.1.1.1.1.1.1"></times><ci id="S3.SS5.p2.14.m4.1.1.1.1.1.2.cmml" xref="S3.SS5.p2.14.m4.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS5.p2.14.m4.1.1.1.1.1.3.cmml" xref="S3.SS5.p2.14.m4.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.SS5.p2.14.m4.2.2.2.2.2.cmml" xref="S3.SS5.p2.14.m4.2.2.2.2.2"><times id="S3.SS5.p2.14.m4.2.2.2.2.2.1.cmml" xref="S3.SS5.p2.14.m4.2.2.2.2.2.1"></times><ci id="S3.SS5.p2.14.m4.2.2.2.2.2.2.cmml" xref="S3.SS5.p2.14.m4.2.2.2.2.2.2">𝑢</ci><ci id="S3.SS5.p2.14.m4.2.2.2.2.2.3.cmml" xref="S3.SS5.p2.14.m4.2.2.2.2.2.3">𝑏</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.14.m4.2c">\mathcal{U}[lb,ub)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.14.m4.2d">caligraphic_U [ italic_l italic_b , italic_u italic_b )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="195" id="S3.F3.g1" src="extracted/5880644/Fig/show3.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text" id="S3.F3.2.1" style="font-size:90%;">Uncurated samples generated by <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S3.F3.2.1.m1.1"><semantics id="S3.F3.2.1.m1.1b"><msup id="S3.F3.2.1.m1.1.1" xref="S3.F3.2.1.m1.1.1.cmml"><mtext id="S3.F3.2.1.m1.1.1.2" xref="S3.F3.2.1.m1.1.1.2a.cmml">ID</mtext><mn id="S3.F3.2.1.m1.1.1.3" xref="S3.F3.2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.F3.2.1.m1.1c"><apply id="S3.F3.2.1.m1.1.1.cmml" xref="S3.F3.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.2.1.m1.1.1.1.cmml" xref="S3.F3.2.1.m1.1.1">superscript</csymbol><ci id="S3.F3.2.1.m1.1.1.2a.cmml" xref="S3.F3.2.1.m1.1.1.2"><mtext id="S3.F3.2.1.m1.1.1.2.cmml" xref="S3.F3.2.1.m1.1.1.2">ID</mtext></ci><cn id="S3.F3.2.1.m1.1.1.3.cmml" type="integer" xref="S3.F3.2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.1.m1.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.2.1.m1.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> (<span class="ltx_text ltx_font_bold" id="S3.F3.2.1.1">Top</span>) and those by IDiff-Face (<span class="ltx_text ltx_font_bold" id="S3.F3.2.1.2">Bottom</span>).
</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.9">After solving Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E9" title='Equation 9 ‣ 3.5 Synthetic Dataset Generation ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">9</span></a>), we are able to retrieve the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><mi id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">italic_m</annotation></semantics></math> optimal unnormalized vector <math alttext="\mathbf{y}_{i1}^{*},...,\mathbf{y}_{im}^{*}" class="ltx_Math" display="inline" id="S3.SS5.p3.2.m2.3"><semantics id="S3.SS5.p3.2.m2.3a"><mrow id="S3.SS5.p3.2.m2.3.3.2" xref="S3.SS5.p3.2.m2.3.3.3.cmml"><msubsup id="S3.SS5.p3.2.m2.2.2.1.1" xref="S3.SS5.p3.2.m2.2.2.1.1.cmml"><mi id="S3.SS5.p3.2.m2.2.2.1.1.2.2" xref="S3.SS5.p3.2.m2.2.2.1.1.2.2.cmml">𝐲</mi><mrow id="S3.SS5.p3.2.m2.2.2.1.1.2.3" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.cmml"><mi id="S3.SS5.p3.2.m2.2.2.1.1.2.3.2" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.2.cmml">i</mi><mo id="S3.SS5.p3.2.m2.2.2.1.1.2.3.1" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.1.cmml">⁢</mo><mn id="S3.SS5.p3.2.m2.2.2.1.1.2.3.3" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS5.p3.2.m2.2.2.1.1.3" xref="S3.SS5.p3.2.m2.2.2.1.1.3.cmml">∗</mo></msubsup><mo id="S3.SS5.p3.2.m2.3.3.2.3" xref="S3.SS5.p3.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS5.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS5.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS5.p3.2.m2.3.3.2.4" xref="S3.SS5.p3.2.m2.3.3.3.cmml">,</mo><msubsup id="S3.SS5.p3.2.m2.3.3.2.2" xref="S3.SS5.p3.2.m2.3.3.2.2.cmml"><mi id="S3.SS5.p3.2.m2.3.3.2.2.2.2" xref="S3.SS5.p3.2.m2.3.3.2.2.2.2.cmml">𝐲</mi><mrow id="S3.SS5.p3.2.m2.3.3.2.2.2.3" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.cmml"><mi id="S3.SS5.p3.2.m2.3.3.2.2.2.3.2" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.2.cmml">i</mi><mo id="S3.SS5.p3.2.m2.3.3.2.2.2.3.1" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.2.m2.3.3.2.2.2.3.3" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.3.cmml">m</mi></mrow><mo id="S3.SS5.p3.2.m2.3.3.2.2.3" xref="S3.SS5.p3.2.m2.3.3.2.2.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.3b"><list id="S3.SS5.p3.2.m2.3.3.3.cmml" xref="S3.SS5.p3.2.m2.3.3.2"><apply id="S3.SS5.p3.2.m2.2.2.1.1.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS5.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS5.p3.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1.2.2">𝐲</ci><apply id="S3.SS5.p3.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3"><times id="S3.SS5.p3.2.m2.2.2.1.1.2.3.1.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.1"></times><ci id="S3.SS5.p3.2.m2.2.2.1.1.2.3.2.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.2">𝑖</ci><cn id="S3.SS5.p3.2.m2.2.2.1.1.2.3.3.cmml" type="integer" xref="S3.SS5.p3.2.m2.2.2.1.1.2.3.3">1</cn></apply></apply><times id="S3.SS5.p3.2.m2.2.2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.2.2.1.1.3"></times></apply><ci id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1">…</ci><apply id="S3.SS5.p3.2.m2.3.3.2.2.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.3.3.2.2.1.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS5.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS5.p3.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.2.2">𝐲</ci><apply id="S3.SS5.p3.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3"><times id="S3.SS5.p3.2.m2.3.3.2.2.2.3.1.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.1"></times><ci id="S3.SS5.p3.2.m2.3.3.2.2.2.3.2.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.2">𝑖</ci><ci id="S3.SS5.p3.2.m2.3.3.2.2.2.3.3.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.2.3.3">𝑚</ci></apply></apply><times id="S3.SS5.p3.2.m2.3.3.2.2.3.cmml" xref="S3.SS5.p3.2.m2.3.3.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.3c">\mathbf{y}_{i1}^{*},...,\mathbf{y}_{im}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.2.m2.3d">bold_y start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , … , bold_y start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. These <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p3.3.m3.1"><semantics id="S3.SS5.p3.3.m3.1a"><mi id="S3.SS5.p3.3.m3.1.1" xref="S3.SS5.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.3.m3.1b"><ci id="S3.SS5.p3.3.m3.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.3.m3.1d">italic_m</annotation></semantics></math> vectors are then normalized, yielding <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p3.4.m4.1"><semantics id="S3.SS5.p3.4.m4.1a"><mi id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><ci id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.4.m4.1d">italic_m</annotation></semantics></math> identity embeddings: <math alttext="\operatorname{norm}(\mathbf{y}_{ij}^{*})" class="ltx_Math" display="inline" id="S3.SS5.p3.5.m5.2"><semantics id="S3.SS5.p3.5.m5.2a"><mrow id="S3.SS5.p3.5.m5.2.2.1" xref="S3.SS5.p3.5.m5.2.2.2.cmml"><mi id="S3.SS5.p3.5.m5.1.1" xref="S3.SS5.p3.5.m5.1.1.cmml">norm</mi><mo id="S3.SS5.p3.5.m5.2.2.1a" xref="S3.SS5.p3.5.m5.2.2.2.cmml">⁡</mo><mrow id="S3.SS5.p3.5.m5.2.2.1.1" xref="S3.SS5.p3.5.m5.2.2.2.cmml"><mo id="S3.SS5.p3.5.m5.2.2.1.1.2" stretchy="false" xref="S3.SS5.p3.5.m5.2.2.2.cmml">(</mo><msubsup id="S3.SS5.p3.5.m5.2.2.1.1.1" xref="S3.SS5.p3.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS5.p3.5.m5.2.2.1.1.1.2.2" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.2.cmml">𝐲</mi><mrow id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.cmml"><mi id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.2" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.1" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.3" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.3.cmml">j</mi></mrow><mo id="S3.SS5.p3.5.m5.2.2.1.1.1.3" xref="S3.SS5.p3.5.m5.2.2.1.1.1.3.cmml">∗</mo></msubsup><mo id="S3.SS5.p3.5.m5.2.2.1.1.3" stretchy="false" xref="S3.SS5.p3.5.m5.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.5.m5.2b"><apply id="S3.SS5.p3.5.m5.2.2.2.cmml" xref="S3.SS5.p3.5.m5.2.2.1"><ci id="S3.SS5.p3.5.m5.1.1.cmml" xref="S3.SS5.p3.5.m5.1.1">norm</ci><apply id="S3.SS5.p3.5.m5.2.2.1.1.1.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1">superscript</csymbol><apply id="S3.SS5.p3.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.5.m5.2.2.1.1.1.2.1.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p3.5.m5.2.2.1.1.1.2.2.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.2">𝐲</ci><apply id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3"><times id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.1.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.1"></times><ci id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.2.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.3.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.2.3.3">𝑗</ci></apply></apply><times id="S3.SS5.p3.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS5.p3.5.m5.2.2.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.5.m5.2c">\operatorname{norm}(\mathbf{y}_{ij}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.5.m5.2d">roman_norm ( bold_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math>, for <math alttext="j=1,...,m" class="ltx_Math" display="inline" id="S3.SS5.p3.6.m6.3"><semantics id="S3.SS5.p3.6.m6.3a"><mrow id="S3.SS5.p3.6.m6.3.4" xref="S3.SS5.p3.6.m6.3.4.cmml"><mi id="S3.SS5.p3.6.m6.3.4.2" xref="S3.SS5.p3.6.m6.3.4.2.cmml">j</mi><mo id="S3.SS5.p3.6.m6.3.4.1" xref="S3.SS5.p3.6.m6.3.4.1.cmml">=</mo><mrow id="S3.SS5.p3.6.m6.3.4.3.2" xref="S3.SS5.p3.6.m6.3.4.3.1.cmml"><mn id="S3.SS5.p3.6.m6.1.1" xref="S3.SS5.p3.6.m6.1.1.cmml">1</mn><mo id="S3.SS5.p3.6.m6.3.4.3.2.1" xref="S3.SS5.p3.6.m6.3.4.3.1.cmml">,</mo><mi id="S3.SS5.p3.6.m6.2.2" mathvariant="normal" xref="S3.SS5.p3.6.m6.2.2.cmml">…</mi><mo id="S3.SS5.p3.6.m6.3.4.3.2.2" xref="S3.SS5.p3.6.m6.3.4.3.1.cmml">,</mo><mi id="S3.SS5.p3.6.m6.3.3" xref="S3.SS5.p3.6.m6.3.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.6.m6.3b"><apply id="S3.SS5.p3.6.m6.3.4.cmml" xref="S3.SS5.p3.6.m6.3.4"><eq id="S3.SS5.p3.6.m6.3.4.1.cmml" xref="S3.SS5.p3.6.m6.3.4.1"></eq><ci id="S3.SS5.p3.6.m6.3.4.2.cmml" xref="S3.SS5.p3.6.m6.3.4.2">𝑗</ci><list id="S3.SS5.p3.6.m6.3.4.3.1.cmml" xref="S3.SS5.p3.6.m6.3.4.3.2"><cn id="S3.SS5.p3.6.m6.1.1.cmml" type="integer" xref="S3.SS5.p3.6.m6.1.1">1</cn><ci id="S3.SS5.p3.6.m6.2.2.cmml" xref="S3.SS5.p3.6.m6.2.2">…</ci><ci id="S3.SS5.p3.6.m6.3.3.cmml" xref="S3.SS5.p3.6.m6.3.3">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.6.m6.3c">j=1,...,m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.6.m6.3d">italic_j = 1 , … , italic_m</annotation></semantics></math>. Then, the resulting identity embeddings, along with face attributes, are fed into our generative models to generate face images.
Finally, the entire dataset is generated by solving each <math alttext="\mathbf{P}_{i},i=1,...,N" class="ltx_Math" display="inline" id="S3.SS5.p3.7.m7.5"><semantics id="S3.SS5.p3.7.m7.5a"><mrow id="S3.SS5.p3.7.m7.5.5.2" xref="S3.SS5.p3.7.m7.5.5.3.cmml"><mrow id="S3.SS5.p3.7.m7.4.4.1.1" xref="S3.SS5.p3.7.m7.4.4.1.1.cmml"><mrow id="S3.SS5.p3.7.m7.4.4.1.1.1.1" xref="S3.SS5.p3.7.m7.4.4.1.1.1.2.cmml"><msub id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.cmml"><mi id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.2" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml">𝐏</mi><mi id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.3" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS5.p3.7.m7.4.4.1.1.1.1.2" xref="S3.SS5.p3.7.m7.4.4.1.1.1.2.cmml">,</mo><mi id="S3.SS5.p3.7.m7.1.1" xref="S3.SS5.p3.7.m7.1.1.cmml">i</mi></mrow><mo id="S3.SS5.p3.7.m7.4.4.1.1.2" xref="S3.SS5.p3.7.m7.4.4.1.1.2.cmml">=</mo><mn id="S3.SS5.p3.7.m7.4.4.1.1.3" xref="S3.SS5.p3.7.m7.4.4.1.1.3.cmml">1</mn></mrow><mo id="S3.SS5.p3.7.m7.5.5.2.3" xref="S3.SS5.p3.7.m7.5.5.3a.cmml">,</mo><mrow id="S3.SS5.p3.7.m7.5.5.2.2.2" xref="S3.SS5.p3.7.m7.5.5.2.2.1.cmml"><mi id="S3.SS5.p3.7.m7.2.2" mathvariant="normal" xref="S3.SS5.p3.7.m7.2.2.cmml">…</mi><mo id="S3.SS5.p3.7.m7.5.5.2.2.2.1" xref="S3.SS5.p3.7.m7.5.5.2.2.1.cmml">,</mo><mi id="S3.SS5.p3.7.m7.3.3" xref="S3.SS5.p3.7.m7.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.7.m7.5b"><apply id="S3.SS5.p3.7.m7.5.5.3.cmml" xref="S3.SS5.p3.7.m7.5.5.2"><csymbol cd="ambiguous" id="S3.SS5.p3.7.m7.5.5.3a.cmml" xref="S3.SS5.p3.7.m7.5.5.2.3">formulae-sequence</csymbol><apply id="S3.SS5.p3.7.m7.4.4.1.1.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1"><eq id="S3.SS5.p3.7.m7.4.4.1.1.2.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.2"></eq><list id="S3.SS5.p3.7.m7.4.4.1.1.1.2.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1"><apply id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.1.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.2">𝐏</ci><ci id="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.3.cmml" xref="S3.SS5.p3.7.m7.4.4.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS5.p3.7.m7.1.1.cmml" xref="S3.SS5.p3.7.m7.1.1">𝑖</ci></list><cn id="S3.SS5.p3.7.m7.4.4.1.1.3.cmml" type="integer" xref="S3.SS5.p3.7.m7.4.4.1.1.3">1</cn></apply><list id="S3.SS5.p3.7.m7.5.5.2.2.1.cmml" xref="S3.SS5.p3.7.m7.5.5.2.2.2"><ci id="S3.SS5.p3.7.m7.2.2.cmml" xref="S3.SS5.p3.7.m7.2.2">…</ci><ci id="S3.SS5.p3.7.m7.3.3.cmml" xref="S3.SS5.p3.7.m7.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.7.m7.5c">\mathbf{P}_{i},i=1,...,N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.7.m7.5d">bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i = 1 , … , italic_N</annotation></semantics></math>, which yields <math alttext="N" class="ltx_Math" display="inline" id="S3.SS5.p3.8.m8.1"><semantics id="S3.SS5.p3.8.m8.1a"><mi id="S3.SS5.p3.8.m8.1.1" xref="S3.SS5.p3.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.8.m8.1b"><ci id="S3.SS5.p3.8.m8.1.1.cmml" xref="S3.SS5.p3.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.8.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.8.m8.1d">italic_N</annotation></semantics></math> identities, each with <math alttext="m" class="ltx_Math" display="inline" id="S3.SS5.p3.9.m9.1"><semantics id="S3.SS5.p3.9.m9.1a"><mi id="S3.SS5.p3.9.m9.1.1" xref="S3.SS5.p3.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.9.m9.1b"><ci id="S3.SS5.p3.9.m9.1.1.cmml" xref="S3.SS5.p3.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.9.m9.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.9.m9.1d">italic_m</annotation></semantics></math> face images. The entire algorithm is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#algorithm3" title='Algorithm 3 ‣ Figure 2 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">In this section, we verify the effectiveness of ID<sup class="ltx_sup" id="S4.p1.2.1">3</sup> through empirical evaluation of the face dataset that ID<sup class="ltx_sup" id="S4.p1.2.2">3</sup> generates, and verify the performance of the SoTA face recognition model trained on this dataset in comparison with other baseline methods.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Training Dataset:</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.2">We train our proposed ID<sup class="ltx_sup" id="S4.SS1.SSS0.Px1.p1.2.1">3</sup> on FFHQ <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Karras et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">2019</span></a>)</cite> dataset.
The FFHQ (FaceForensics++) dataset is a large-scale dataset used for benchmarking and evaluating the performance of deep learning models in the field of face forensics. It is an extension of the original FaceForensics dataset, which was designed to facilitate the development and comparison of methods for detecting and preventing face manipulation and deepfakes. In order to compare with DCFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Kim et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>, we also train ID<sup class="ltx_sup" id="S4.SS1.SSS0.Px1.p1.2.2">3</sup> on CASIA-WebFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Yi et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">2014</span></a>)</cite>. The CASIA-WebFace dataset is used for face verification and face recognition tasks. This dataset contains 494,414 face images of 10,575 real identities collected from the web.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px1.p2.1.1">Benchmarks:</span>
The performance of face recognition models is evaluated on various benchmark datasets: LFW  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Huang et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">2008</span></a>)</cite>, CFP-FP  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Sengupta et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">2016</span></a>)</cite>, CPLFW <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Zheng and Deng</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">2018</span></a>)</cite>, AgeDB <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Moschoglou et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">2017</span></a>)</cite> and CALFW <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Zheng et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">2017</span></a>)</cite>.
They are used to measure the impact of different factors on face image, such as pose changes and age variations.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.7">For our ID<sup class="ltx_sup" id="S4.SS2.p1.7.1">3</sup>,
we implement the denoising network with a U-net architecture
and the projection module with a three-layer perceptron (hidden-layer size <math alttext="(512,256,768)" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.3"><semantics id="S4.SS2.p1.2.m2.3a"><mrow id="S4.SS2.p1.2.m2.3.4.2" xref="S4.SS2.p1.2.m2.3.4.1.cmml"><mo id="S4.SS2.p1.2.m2.3.4.2.1" stretchy="false" xref="S4.SS2.p1.2.m2.3.4.1.cmml">(</mo><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">512</mn><mo id="S4.SS2.p1.2.m2.3.4.2.2" xref="S4.SS2.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">256</mn><mo id="S4.SS2.p1.2.m2.3.4.2.3" xref="S4.SS2.p1.2.m2.3.4.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.3.3" xref="S4.SS2.p1.2.m2.3.3.cmml">768</mn><mo id="S4.SS2.p1.2.m2.3.4.2.4" stretchy="false" xref="S4.SS2.p1.2.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.3b"><vector id="S4.SS2.p1.2.m2.3.4.1.cmml" xref="S4.SS2.p1.2.m2.3.4.2"><cn id="S4.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1">512</cn><cn id="S4.SS2.p1.2.m2.2.2.cmml" type="integer" xref="S4.SS2.p1.2.m2.2.2">256</cn><cn id="S4.SS2.p1.2.m2.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.3.3">768</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.3c">(512,256,768)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.3d">( 512 , 256 , 768 )</annotation></semantics></math>) with ReLU activation.
All models are implemented with PyTorch and trained from scratch using 8 NVIDIA Tesla V100 GPUs.
Specifically, we set <math alttext="\lambda_{t}\kappa_{\mathbf{x}_{t}}=0.5\cdot(1-1/(1+\exp{(-t/T)})" class="ltx_math_unparsed" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1b"><msub id="S4.SS2.p1.3.m3.1.2"><mi id="S4.SS2.p1.3.m3.1.2.2">λ</mi><mi id="S4.SS2.p1.3.m3.1.2.3">t</mi></msub><msub id="S4.SS2.p1.3.m3.1.3"><mi id="S4.SS2.p1.3.m3.1.3.2">κ</mi><msub id="S4.SS2.p1.3.m3.1.3.3"><mi id="S4.SS2.p1.3.m3.1.3.3.2">𝐱</mi><mi id="S4.SS2.p1.3.m3.1.3.3.3">t</mi></msub></msub><mo id="S4.SS2.p1.3.m3.1.4">=</mo><mn id="S4.SS2.p1.3.m3.1.5">0.5</mn><mo id="S4.SS2.p1.3.m3.1.6" lspace="0.222em" rspace="0.222em">⋅</mo><mrow id="S4.SS2.p1.3.m3.1.7"><mo id="S4.SS2.p1.3.m3.1.7.1" stretchy="false">(</mo><mn id="S4.SS2.p1.3.m3.1.7.2">1</mn><mo id="S4.SS2.p1.3.m3.1.7.3">−</mo><mn id="S4.SS2.p1.3.m3.1.7.4">1</mn><mo id="S4.SS2.p1.3.m3.1.7.5">/</mo><mrow id="S4.SS2.p1.3.m3.1.7.6"><mo id="S4.SS2.p1.3.m3.1.7.6.1" stretchy="false">(</mo><mn id="S4.SS2.p1.3.m3.1.7.6.2">1</mn><mo id="S4.SS2.p1.3.m3.1.7.6.3">+</mo><mi id="S4.SS2.p1.3.m3.1.1">exp</mi><mrow id="S4.SS2.p1.3.m3.1.7.6.4"><mo id="S4.SS2.p1.3.m3.1.7.6.4.1" stretchy="false">(</mo><mo id="S4.SS2.p1.3.m3.1.7.6.4.2" lspace="0em">−</mo><mi id="S4.SS2.p1.3.m3.1.7.6.4.3">t</mi><mo id="S4.SS2.p1.3.m3.1.7.6.4.4">/</mo><mi id="S4.SS2.p1.3.m3.1.7.6.4.5">T</mi><mo id="S4.SS2.p1.3.m3.1.7.6.4.6" stretchy="false">)</mo></mrow><mo id="S4.SS2.p1.3.m3.1.7.6.5" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\lambda_{t}\kappa_{\mathbf{x}_{t}}=0.5\cdot(1-1/(1+\exp{(-t/T)})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT = 0.5 ⋅ ( 1 - 1 / ( 1 + roman_exp ( - italic_t / italic_T ) )</annotation></semantics></math> for the loss coefficients in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E3" title='Equation 3 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3</span></a>),
and use <math alttext="T=1,000" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.2"><semantics id="S4.SS2.p1.4.m4.2a"><mrow id="S4.SS2.p1.4.m4.2.3" xref="S4.SS2.p1.4.m4.2.3.cmml"><mi id="S4.SS2.p1.4.m4.2.3.2" xref="S4.SS2.p1.4.m4.2.3.2.cmml">T</mi><mo id="S4.SS2.p1.4.m4.2.3.1" xref="S4.SS2.p1.4.m4.2.3.1.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.2.3.3.2" xref="S4.SS2.p1.4.m4.2.3.3.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">1</mn><mo id="S4.SS2.p1.4.m4.2.3.3.2.1" xref="S4.SS2.p1.4.m4.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.2.2" xref="S4.SS2.p1.4.m4.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.2b"><apply id="S4.SS2.p1.4.m4.2.3.cmml" xref="S4.SS2.p1.4.m4.2.3"><eq id="S4.SS2.p1.4.m4.2.3.1.cmml" xref="S4.SS2.p1.4.m4.2.3.1"></eq><ci id="S4.SS2.p1.4.m4.2.3.2.cmml" xref="S4.SS2.p1.4.m4.2.3.2">𝑇</ci><list id="S4.SS2.p1.4.m4.2.3.3.1.cmml" xref="S4.SS2.p1.4.m4.2.3.3.2"><cn id="S4.SS2.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1">1</cn><cn id="S4.SS2.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS2.p1.4.m4.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.2c">T=1,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.2d">italic_T = 1 , 000</annotation></semantics></math> for the diffusion model;
training batch size is set to <math alttext="16" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><cn id="S4.SS2.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">16</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">16</annotation></semantics></math> and the total training steps <math alttext="500,000" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.2"><semantics id="S4.SS2.p1.6.m6.2a"><mrow id="S4.SS2.p1.6.m6.2.3.2" xref="S4.SS2.p1.6.m6.2.3.1.cmml"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">500</mn><mo id="S4.SS2.p1.6.m6.2.3.2.1" xref="S4.SS2.p1.6.m6.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.2b"><list id="S4.SS2.p1.6.m6.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.3.2"><cn id="S4.SS2.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS2.p1.6.m6.1.1">500</cn><cn id="S4.SS2.p1.6.m6.2.2.cmml" type="integer" xref="S4.SS2.p1.6.m6.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.2c">500,000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.2d">500 , 000</annotation></semantics></math>.
We directly use a pre-trained face recognition (FR) model sourced from pSp <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Richardson et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>)</cite> as the identity feature extractor.
Throughout the entire training process, these pre-trained models are frozen.
In addition, we set # of identity embeddings <math alttext="m=25" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">m</mi><mo id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><eq id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1"></eq><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑚</ci><cn id="S4.SS2.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS2.p1.7.m7.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">m=25</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_m = 25</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E9" title='Equation 9 ‣ 3.5 Synthetic Dataset Generation ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">9</span></a>) for each ID and match their embeddings with randomly selected attributes as conditioning signals for the diffusion model.
For face recognition,
we use LResNet50-IR <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Deng et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">2019</span></a>)</cite>, a variant of ResNet <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">He et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">2016</span></a>)</cite>, as the backbone framework and follow the original configurations.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text" id="S4.T1.2.1" style="font-size:90%;">SoTA Comparison. Face verification accuracy (%) of LResNet50-IR on different benchmarks when trained on synthetic datasets from ID<sup class="ltx_sup" id="S4.T1.2.1.1">3</sup> and state-of-the-art SFR generative models. For fairness, all methods generate face datasets of 10K identities each of which has 50 face images.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.4">
<tr class="ltx_tr" id="S4.T1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.2">Training set</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.3">LFW</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.4">CFP-FP</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.5">CP-LFW</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.6">AgeDB</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T1.4.3.7">CA-LFW</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S4.T1.4.3.8">Average</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.1">ID-Net</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.3">84.83</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.4">70.43</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.5">67.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.6">63.58</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.7">71.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.8">71.53</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.1">DigiFace</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.3">88.07</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.4">70.99</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.5">66.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.6">60.92</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.7">69.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.5.8">71.19</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.1">SFace</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.3">91.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.4">73.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.5">73.42</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.6">69.87</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.6.7">76.92</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.6.8">76.95</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.1">SynFace</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.3">91.93</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.4">75.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.5">70.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.6">61.63</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.7.7">74.73</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.8">74.75</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.1">IDiff-Face</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.3">97.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.4">82.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.5">76.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.6">78.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.8.7">86.32</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.8.8">84.09</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.1">
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S4.T1.3.1.1.m1.1"><semantics id="S4.T1.3.1.1.m1.1a"><msup id="S4.T1.3.1.1.m1.1.1" xref="S4.T1.3.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.3.1.1.m1.1.1.2" xref="S4.T1.3.1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S4.T1.3.1.1.m1.1.1.3" xref="S4.T1.3.1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.m1.1b"><apply id="S4.T1.3.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.1.1.m1.1.1.1.cmml" xref="S4.T1.3.1.1.m1.1.1">superscript</csymbol><ci id="S4.T1.3.1.1.m1.1.1.2a.cmml" xref="S4.T1.3.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.3.1.1.m1.1.1.2.cmml" xref="S4.T1.3.1.1.m1.1.1.2">ID</mtext></ci><cn id="S4.T1.3.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.3.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.1.1"> (Ours)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.2">FFHQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.3.1">97.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.4.1">85.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.5"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.5.1">77.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.6"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.6.1">83.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.1.7"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.7.1">89.30</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.1.8"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.8.1">86.50</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.9">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.1">DCFace</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.2">FFHQ+CASIA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.9.3.1">98.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.4">85.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.5">82.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.6">89.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.9.7"><span class="ltx_text ltx_font_bold" id="S4.T1.4.9.7.1">91.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.9.8">89.56</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.1">
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S4.T1.4.2.1.m1.1"><semantics id="S4.T1.4.2.1.m1.1a"><msup id="S4.T1.4.2.1.m1.1.1" xref="S4.T1.4.2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.4.2.1.m1.1.1.2" xref="S4.T1.4.2.1.m1.1.1.2a.cmml">ID</mtext><mn id="S4.T1.4.2.1.m1.1.1.3" xref="S4.T1.4.2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.1.m1.1b"><apply id="S4.T1.4.2.1.m1.1.1.cmml" xref="S4.T1.4.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.4.2.1.m1.1.1.1.cmml" xref="S4.T1.4.2.1.m1.1.1">superscript</csymbol><ci id="S4.T1.4.2.1.m1.1.1.2a.cmml" xref="S4.T1.4.2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.4.2.1.m1.1.1.2.cmml" xref="S4.T1.4.2.1.m1.1.1.2">ID</mtext></ci><cn id="S4.T1.4.2.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.4.2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.2.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.1.1"> (Ours)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.2">CASIA</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.3">97.68</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.4.1">86.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.5.1">82.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.6.1">91.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.2.7">90.73</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.2.8"><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.8.1">89.80</span></td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Performance Evaluation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We test the performance of the face recognition model trained on synthetic face data generated by ID<sup class="ltx_sup" id="S4.SS3.p1.1.1">3</sup> and compare against SoTA SFR generative models, including IDiff-Face <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>, ID-Net <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Kolf et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>, DigiFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Bae et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>,
SFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>)</cite>, SynFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Qiu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>)</cite> and DCFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Kim et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Qualitative Results</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.3">Here, we illustrate a collection of face images generated by ID<sup class="ltx_sup" id="S4.SS3.SSS1.p1.3.1">3</sup> as qualitative evaluation.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.F3" title='Figure 3 ‣ 3.5 Synthetic Dataset Generation ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3</span></a> shows the results for randomly sampled identities (IDs) under various attribute conditions;
Obviously, when comparing different identities (inter-class),
the essential intrinsic key information of each identity is still retained and can be easily identified. Also, different samples of each identity (intra-class) exhibit distinct diversity, stemming from variations in similarity scores (<math alttext="\nu_{ij}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.2.m2.1"><semantics id="S4.SS3.SSS1.p1.2.m2.1a"><msub id="S4.SS3.SSS1.p1.2.m2.1.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p1.2.m2.1.1.2" xref="S4.SS3.SSS1.p1.2.m2.1.1.2.cmml">ν</mi><mrow id="S4.SS3.SSS1.p1.2.m2.1.1.3" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S4.SS3.SSS1.p1.2.m2.1.1.3.1" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.2.m2.1b"><apply id="S4.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.2">𝜈</ci><apply id="S4.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3"><times id="S4.SS3.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS3.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p1.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.2.m2.1c">\nu_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.2.m2.1d">italic_ν start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>’s) and differences in face attributes as conditioning signals.
In terms of the effect of our proposed adjusted score and the original score on the sampling algorithm, we observe that the face images generated by our proposed ID<sup class="ltx_sup" id="S4.SS3.SSS1.p1.3.2">3</sup> exhibits much better quality and identity preservation than those generated by the original score function, as shown in Figure 2.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Quantitative Results</h4>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text" id="S4.T2.20.10" style="font-size:90%;">Ablation Study. Face verification accuracy (%) of LResNet50-IR when trained on synthetic datasets from ID<sup class="ltx_sup" id="S4.T2.20.10.1">3</sup> and other model variants. ID<sup class="ltx_sup" id="S4.T2.20.10.2">3</sup>-<math alttext="[lb,ub]" class="ltx_Math" display="inline" id="S4.T2.13.3.m3.2"><semantics id="S4.T2.13.3.m3.2b"><mrow id="S4.T2.13.3.m3.2.2.2" xref="S4.T2.13.3.m3.2.2.3.cmml"><mo id="S4.T2.13.3.m3.2.2.2.3" stretchy="false" xref="S4.T2.13.3.m3.2.2.3.cmml">[</mo><mrow id="S4.T2.13.3.m3.1.1.1.1" xref="S4.T2.13.3.m3.1.1.1.1.cmml"><mi id="S4.T2.13.3.m3.1.1.1.1.2" xref="S4.T2.13.3.m3.1.1.1.1.2.cmml">l</mi><mo id="S4.T2.13.3.m3.1.1.1.1.1" xref="S4.T2.13.3.m3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.T2.13.3.m3.1.1.1.1.3" xref="S4.T2.13.3.m3.1.1.1.1.3.cmml">b</mi></mrow><mo id="S4.T2.13.3.m3.2.2.2.4" xref="S4.T2.13.3.m3.2.2.3.cmml">,</mo><mrow id="S4.T2.13.3.m3.2.2.2.2" xref="S4.T2.13.3.m3.2.2.2.2.cmml"><mi id="S4.T2.13.3.m3.2.2.2.2.2" xref="S4.T2.13.3.m3.2.2.2.2.2.cmml">u</mi><mo id="S4.T2.13.3.m3.2.2.2.2.1" xref="S4.T2.13.3.m3.2.2.2.2.1.cmml">⁢</mo><mi id="S4.T2.13.3.m3.2.2.2.2.3" xref="S4.T2.13.3.m3.2.2.2.2.3.cmml">b</mi></mrow><mo id="S4.T2.13.3.m3.2.2.2.5" stretchy="false" xref="S4.T2.13.3.m3.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.3.m3.2c"><interval closure="closed" id="S4.T2.13.3.m3.2.2.3.cmml" xref="S4.T2.13.3.m3.2.2.2"><apply id="S4.T2.13.3.m3.1.1.1.1.cmml" xref="S4.T2.13.3.m3.1.1.1.1"><times id="S4.T2.13.3.m3.1.1.1.1.1.cmml" xref="S4.T2.13.3.m3.1.1.1.1.1"></times><ci id="S4.T2.13.3.m3.1.1.1.1.2.cmml" xref="S4.T2.13.3.m3.1.1.1.1.2">𝑙</ci><ci id="S4.T2.13.3.m3.1.1.1.1.3.cmml" xref="S4.T2.13.3.m3.1.1.1.1.3">𝑏</ci></apply><apply id="S4.T2.13.3.m3.2.2.2.2.cmml" xref="S4.T2.13.3.m3.2.2.2.2"><times id="S4.T2.13.3.m3.2.2.2.2.1.cmml" xref="S4.T2.13.3.m3.2.2.2.2.1"></times><ci id="S4.T2.13.3.m3.2.2.2.2.2.cmml" xref="S4.T2.13.3.m3.2.2.2.2.2">𝑢</ci><ci id="S4.T2.13.3.m3.2.2.2.2.3.cmml" xref="S4.T2.13.3.m3.2.2.2.2.3">𝑏</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.3.m3.2d">[lb,ub]</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.3.m3.2e">[ italic_l italic_b , italic_u italic_b ]</annotation></semantics></math> represents an ID<sup class="ltx_sup" id="S4.T2.20.10.3">3</sup> variant using <math alttext="lb" class="ltx_Math" display="inline" id="S4.T2.15.5.m5.1"><semantics id="S4.T2.15.5.m5.1b"><mrow id="S4.T2.15.5.m5.1.1" xref="S4.T2.15.5.m5.1.1.cmml"><mi id="S4.T2.15.5.m5.1.1.2" xref="S4.T2.15.5.m5.1.1.2.cmml">l</mi><mo id="S4.T2.15.5.m5.1.1.1" xref="S4.T2.15.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.T2.15.5.m5.1.1.3" xref="S4.T2.15.5.m5.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.5.m5.1c"><apply id="S4.T2.15.5.m5.1.1.cmml" xref="S4.T2.15.5.m5.1.1"><times id="S4.T2.15.5.m5.1.1.1.cmml" xref="S4.T2.15.5.m5.1.1.1"></times><ci id="S4.T2.15.5.m5.1.1.2.cmml" xref="S4.T2.15.5.m5.1.1.2">𝑙</ci><ci id="S4.T2.15.5.m5.1.1.3.cmml" xref="S4.T2.15.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.5.m5.1d">lb</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.5.m5.1e">italic_l italic_b</annotation></semantics></math> and <math alttext="ub" class="ltx_Math" display="inline" id="S4.T2.16.6.m6.1"><semantics id="S4.T2.16.6.m6.1b"><mrow id="S4.T2.16.6.m6.1.1" xref="S4.T2.16.6.m6.1.1.cmml"><mi id="S4.T2.16.6.m6.1.1.2" xref="S4.T2.16.6.m6.1.1.2.cmml">u</mi><mo id="S4.T2.16.6.m6.1.1.1" xref="S4.T2.16.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.T2.16.6.m6.1.1.3" xref="S4.T2.16.6.m6.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.16.6.m6.1c"><apply id="S4.T2.16.6.m6.1.1.cmml" xref="S4.T2.16.6.m6.1.1"><times id="S4.T2.16.6.m6.1.1.1.cmml" xref="S4.T2.16.6.m6.1.1.1"></times><ci id="S4.T2.16.6.m6.1.1.2.cmml" xref="S4.T2.16.6.m6.1.1.2">𝑢</ci><ci id="S4.T2.16.6.m6.1.1.3.cmml" xref="S4.T2.16.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.6.m6.1d">ub</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.6.m6.1e">italic_u italic_b</annotation></semantics></math> as lower- and upper-bound for sampling <math alttext="\nu_{ij}" class="ltx_Math" display="inline" id="S4.T2.17.7.m7.1"><semantics id="S4.T2.17.7.m7.1b"><msub id="S4.T2.17.7.m7.1.1" xref="S4.T2.17.7.m7.1.1.cmml"><mi id="S4.T2.17.7.m7.1.1.2" xref="S4.T2.17.7.m7.1.1.2.cmml">ν</mi><mrow id="S4.T2.17.7.m7.1.1.3" xref="S4.T2.17.7.m7.1.1.3.cmml"><mi id="S4.T2.17.7.m7.1.1.3.2" xref="S4.T2.17.7.m7.1.1.3.2.cmml">i</mi><mo id="S4.T2.17.7.m7.1.1.3.1" xref="S4.T2.17.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.17.7.m7.1.1.3.3" xref="S4.T2.17.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.17.7.m7.1c"><apply id="S4.T2.17.7.m7.1.1.cmml" xref="S4.T2.17.7.m7.1.1"><csymbol cd="ambiguous" id="S4.T2.17.7.m7.1.1.1.cmml" xref="S4.T2.17.7.m7.1.1">subscript</csymbol><ci id="S4.T2.17.7.m7.1.1.2.cmml" xref="S4.T2.17.7.m7.1.1.2">𝜈</ci><apply id="S4.T2.17.7.m7.1.1.3.cmml" xref="S4.T2.17.7.m7.1.1.3"><times id="S4.T2.17.7.m7.1.1.3.1.cmml" xref="S4.T2.17.7.m7.1.1.3.1"></times><ci id="S4.T2.17.7.m7.1.1.3.2.cmml" xref="S4.T2.17.7.m7.1.1.3.2">𝑖</ci><ci id="S4.T2.17.7.m7.1.1.3.3.cmml" xref="S4.T2.17.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.7.m7.1d">\nu_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.7.m7.1e">italic_ν start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>’s.
ID<sup class="ltx_sup" id="S4.T2.20.10.4">3</sup>-random denotes a model variant that randomly sets anchors on the unit hypersphere for sample generation. ID<sup class="ltx_sup" id="S4.T2.20.10.5">3</sup>-w/o-attribute denotes one that does not use attributes as conditioning signals. ID<sup class="ltx_sup" id="S4.T2.20.10.6">3</sup>-w/o-reversed denotes one that removes the reversed likelihood score from Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>) in the proposed ID-preserving sampling algorithm.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.26">
<tr class="ltx_tr" id="S4.T2.26.7">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.2">LFW</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.3">CFP-FP</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.4">CP-LFW</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.5">AgeDB</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" id="S4.T2.26.7.6">CA-LFW</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S4.T2.26.7.7">Average</td>
</tr>
<tr class="ltx_tr" id="S4.T2.21.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.1">ID<sup class="ltx_sup" id="S4.T2.21.1.1.1">3</sup>-w/o-reversed</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.2">78.82</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.3">62.68</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.4">61.83</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.5">58.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.21.1.6">63.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.21.1.7">65.05</td>
</tr>
<tr class="ltx_tr" id="S4.T2.22.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.1"><math alttext="\text{ID}^{3}\text{-w/o-attribute}" class="ltx_Math" display="inline" id="S4.T2.22.2.1.m1.1"><semantics id="S4.T2.22.2.1.m1.1a"><mrow id="S4.T2.22.2.1.m1.1.1" xref="S4.T2.22.2.1.m1.1.1.cmml"><msup id="S4.T2.22.2.1.m1.1.1.2" xref="S4.T2.22.2.1.m1.1.1.2.cmml"><mtext id="S4.T2.22.2.1.m1.1.1.2.2" xref="S4.T2.22.2.1.m1.1.1.2.2a.cmml">ID</mtext><mn id="S4.T2.22.2.1.m1.1.1.2.3" xref="S4.T2.22.2.1.m1.1.1.2.3.cmml">3</mn></msup><mo id="S4.T2.22.2.1.m1.1.1.1" xref="S4.T2.22.2.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.T2.22.2.1.m1.1.1.3" xref="S4.T2.22.2.1.m1.1.1.3a.cmml">-w/o-attribute</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.22.2.1.m1.1b"><apply id="S4.T2.22.2.1.m1.1.1.cmml" xref="S4.T2.22.2.1.m1.1.1"><times id="S4.T2.22.2.1.m1.1.1.1.cmml" xref="S4.T2.22.2.1.m1.1.1.1"></times><apply id="S4.T2.22.2.1.m1.1.1.2.cmml" xref="S4.T2.22.2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.22.2.1.m1.1.1.2.1.cmml" xref="S4.T2.22.2.1.m1.1.1.2">superscript</csymbol><ci id="S4.T2.22.2.1.m1.1.1.2.2a.cmml" xref="S4.T2.22.2.1.m1.1.1.2.2"><mtext id="S4.T2.22.2.1.m1.1.1.2.2.cmml" xref="S4.T2.22.2.1.m1.1.1.2.2">ID</mtext></ci><cn id="S4.T2.22.2.1.m1.1.1.2.3.cmml" type="integer" xref="S4.T2.22.2.1.m1.1.1.2.3">3</cn></apply><ci id="S4.T2.22.2.1.m1.1.1.3a.cmml" xref="S4.T2.22.2.1.m1.1.1.3"><mtext id="S4.T2.22.2.1.m1.1.1.3.cmml" xref="S4.T2.22.2.1.m1.1.1.3">-w/o-attribute</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.2.1.m1.1c">\text{ID}^{3}\text{-w/o-attribute}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.22.2.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT -w/o-attribute</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.2">97.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.3">85.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.4">81.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.5">87.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.22.2.6">89.48</td>
<td class="ltx_td ltx_align_center" id="S4.T2.22.2.7">88.27</td>
</tr>
<tr class="ltx_tr" id="S4.T2.23.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.1"><math alttext="\text{ID}^{3}\text{-}[0.7,0.9]" class="ltx_Math" display="inline" id="S4.T2.23.3.1.m1.2"><semantics id="S4.T2.23.3.1.m1.2a"><mrow id="S4.T2.23.3.1.m1.2.3" xref="S4.T2.23.3.1.m1.2.3.cmml"><msup id="S4.T2.23.3.1.m1.2.3.2" xref="S4.T2.23.3.1.m1.2.3.2.cmml"><mtext id="S4.T2.23.3.1.m1.2.3.2.2" xref="S4.T2.23.3.1.m1.2.3.2.2a.cmml">ID</mtext><mn id="S4.T2.23.3.1.m1.2.3.2.3" xref="S4.T2.23.3.1.m1.2.3.2.3.cmml">3</mn></msup><mo id="S4.T2.23.3.1.m1.2.3.1" xref="S4.T2.23.3.1.m1.2.3.1.cmml">⁢</mo><mtext id="S4.T2.23.3.1.m1.2.3.3" xref="S4.T2.23.3.1.m1.2.3.3a.cmml">-</mtext><mo id="S4.T2.23.3.1.m1.2.3.1a" xref="S4.T2.23.3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.T2.23.3.1.m1.2.3.4.2" xref="S4.T2.23.3.1.m1.2.3.4.1.cmml"><mo id="S4.T2.23.3.1.m1.2.3.4.2.1" stretchy="false" xref="S4.T2.23.3.1.m1.2.3.4.1.cmml">[</mo><mn id="S4.T2.23.3.1.m1.1.1" xref="S4.T2.23.3.1.m1.1.1.cmml">0.7</mn><mo id="S4.T2.23.3.1.m1.2.3.4.2.2" xref="S4.T2.23.3.1.m1.2.3.4.1.cmml">,</mo><mn id="S4.T2.23.3.1.m1.2.2" xref="S4.T2.23.3.1.m1.2.2.cmml">0.9</mn><mo id="S4.T2.23.3.1.m1.2.3.4.2.3" stretchy="false" xref="S4.T2.23.3.1.m1.2.3.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.23.3.1.m1.2b"><apply id="S4.T2.23.3.1.m1.2.3.cmml" xref="S4.T2.23.3.1.m1.2.3"><times id="S4.T2.23.3.1.m1.2.3.1.cmml" xref="S4.T2.23.3.1.m1.2.3.1"></times><apply id="S4.T2.23.3.1.m1.2.3.2.cmml" xref="S4.T2.23.3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.T2.23.3.1.m1.2.3.2.1.cmml" xref="S4.T2.23.3.1.m1.2.3.2">superscript</csymbol><ci id="S4.T2.23.3.1.m1.2.3.2.2a.cmml" xref="S4.T2.23.3.1.m1.2.3.2.2"><mtext id="S4.T2.23.3.1.m1.2.3.2.2.cmml" xref="S4.T2.23.3.1.m1.2.3.2.2">ID</mtext></ci><cn id="S4.T2.23.3.1.m1.2.3.2.3.cmml" type="integer" xref="S4.T2.23.3.1.m1.2.3.2.3">3</cn></apply><ci id="S4.T2.23.3.1.m1.2.3.3a.cmml" xref="S4.T2.23.3.1.m1.2.3.3"><mtext id="S4.T2.23.3.1.m1.2.3.3.cmml" xref="S4.T2.23.3.1.m1.2.3.3">-</mtext></ci><interval closure="closed" id="S4.T2.23.3.1.m1.2.3.4.1.cmml" xref="S4.T2.23.3.1.m1.2.3.4.2"><cn id="S4.T2.23.3.1.m1.1.1.cmml" type="float" xref="S4.T2.23.3.1.m1.1.1">0.7</cn><cn id="S4.T2.23.3.1.m1.2.2.cmml" type="float" xref="S4.T2.23.3.1.m1.2.2">0.9</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.3.1.m1.2c">\text{ID}^{3}\text{-}[0.7,0.9]</annotation><annotation encoding="application/x-llamapun" id="S4.T2.23.3.1.m1.2d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT - [ 0.7 , 0.9 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.2">97.28</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.3">84.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.4">81.48</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.5">86.25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.23.3.6">89.63</td>
<td class="ltx_td ltx_align_center" id="S4.T2.23.3.7">87.78</td>
</tr>
<tr class="ltx_tr" id="S4.T2.24.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.1"><math alttext="\text{ID}^{3}\text{-}[0.5,0.7]" class="ltx_Math" display="inline" id="S4.T2.24.4.1.m1.2"><semantics id="S4.T2.24.4.1.m1.2a"><mrow id="S4.T2.24.4.1.m1.2.3" xref="S4.T2.24.4.1.m1.2.3.cmml"><msup id="S4.T2.24.4.1.m1.2.3.2" xref="S4.T2.24.4.1.m1.2.3.2.cmml"><mtext id="S4.T2.24.4.1.m1.2.3.2.2" xref="S4.T2.24.4.1.m1.2.3.2.2a.cmml">ID</mtext><mn id="S4.T2.24.4.1.m1.2.3.2.3" xref="S4.T2.24.4.1.m1.2.3.2.3.cmml">3</mn></msup><mo id="S4.T2.24.4.1.m1.2.3.1" xref="S4.T2.24.4.1.m1.2.3.1.cmml">⁢</mo><mtext id="S4.T2.24.4.1.m1.2.3.3" xref="S4.T2.24.4.1.m1.2.3.3a.cmml">-</mtext><mo id="S4.T2.24.4.1.m1.2.3.1a" xref="S4.T2.24.4.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.T2.24.4.1.m1.2.3.4.2" xref="S4.T2.24.4.1.m1.2.3.4.1.cmml"><mo id="S4.T2.24.4.1.m1.2.3.4.2.1" stretchy="false" xref="S4.T2.24.4.1.m1.2.3.4.1.cmml">[</mo><mn id="S4.T2.24.4.1.m1.1.1" xref="S4.T2.24.4.1.m1.1.1.cmml">0.5</mn><mo id="S4.T2.24.4.1.m1.2.3.4.2.2" xref="S4.T2.24.4.1.m1.2.3.4.1.cmml">,</mo><mn id="S4.T2.24.4.1.m1.2.2" xref="S4.T2.24.4.1.m1.2.2.cmml">0.7</mn><mo id="S4.T2.24.4.1.m1.2.3.4.2.3" stretchy="false" xref="S4.T2.24.4.1.m1.2.3.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.24.4.1.m1.2b"><apply id="S4.T2.24.4.1.m1.2.3.cmml" xref="S4.T2.24.4.1.m1.2.3"><times id="S4.T2.24.4.1.m1.2.3.1.cmml" xref="S4.T2.24.4.1.m1.2.3.1"></times><apply id="S4.T2.24.4.1.m1.2.3.2.cmml" xref="S4.T2.24.4.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.T2.24.4.1.m1.2.3.2.1.cmml" xref="S4.T2.24.4.1.m1.2.3.2">superscript</csymbol><ci id="S4.T2.24.4.1.m1.2.3.2.2a.cmml" xref="S4.T2.24.4.1.m1.2.3.2.2"><mtext id="S4.T2.24.4.1.m1.2.3.2.2.cmml" xref="S4.T2.24.4.1.m1.2.3.2.2">ID</mtext></ci><cn id="S4.T2.24.4.1.m1.2.3.2.3.cmml" type="integer" xref="S4.T2.24.4.1.m1.2.3.2.3">3</cn></apply><ci id="S4.T2.24.4.1.m1.2.3.3a.cmml" xref="S4.T2.24.4.1.m1.2.3.3"><mtext id="S4.T2.24.4.1.m1.2.3.3.cmml" xref="S4.T2.24.4.1.m1.2.3.3">-</mtext></ci><interval closure="closed" id="S4.T2.24.4.1.m1.2.3.4.1.cmml" xref="S4.T2.24.4.1.m1.2.3.4.2"><cn id="S4.T2.24.4.1.m1.1.1.cmml" type="float" xref="S4.T2.24.4.1.m1.1.1">0.5</cn><cn id="S4.T2.24.4.1.m1.2.2.cmml" type="float" xref="S4.T2.24.4.1.m1.2.2">0.7</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.4.1.m1.2c">\text{ID}^{3}\text{-}[0.5,0.7]</annotation><annotation encoding="application/x-llamapun" id="S4.T2.24.4.1.m1.2d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT - [ 0.5 , 0.7 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.2">97.38</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.3">85.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.4">81.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.5">86.63</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.24.4.6">90.13</td>
<td class="ltx_td ltx_align_center" id="S4.T2.24.4.7">88.05</td>
</tr>
<tr class="ltx_tr" id="S4.T2.25.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.1"><math alttext="\text{ID}^{3}\text{-random}" class="ltx_Math" display="inline" id="S4.T2.25.5.1.m1.1"><semantics id="S4.T2.25.5.1.m1.1a"><mrow id="S4.T2.25.5.1.m1.1.1" xref="S4.T2.25.5.1.m1.1.1.cmml"><msup id="S4.T2.25.5.1.m1.1.1.2" xref="S4.T2.25.5.1.m1.1.1.2.cmml"><mtext id="S4.T2.25.5.1.m1.1.1.2.2" xref="S4.T2.25.5.1.m1.1.1.2.2a.cmml">ID</mtext><mn id="S4.T2.25.5.1.m1.1.1.2.3" xref="S4.T2.25.5.1.m1.1.1.2.3.cmml">3</mn></msup><mo id="S4.T2.25.5.1.m1.1.1.1" xref="S4.T2.25.5.1.m1.1.1.1.cmml">⁢</mo><mtext id="S4.T2.25.5.1.m1.1.1.3" xref="S4.T2.25.5.1.m1.1.1.3a.cmml">-random</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.25.5.1.m1.1b"><apply id="S4.T2.25.5.1.m1.1.1.cmml" xref="S4.T2.25.5.1.m1.1.1"><times id="S4.T2.25.5.1.m1.1.1.1.cmml" xref="S4.T2.25.5.1.m1.1.1.1"></times><apply id="S4.T2.25.5.1.m1.1.1.2.cmml" xref="S4.T2.25.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.25.5.1.m1.1.1.2.1.cmml" xref="S4.T2.25.5.1.m1.1.1.2">superscript</csymbol><ci id="S4.T2.25.5.1.m1.1.1.2.2a.cmml" xref="S4.T2.25.5.1.m1.1.1.2.2"><mtext id="S4.T2.25.5.1.m1.1.1.2.2.cmml" xref="S4.T2.25.5.1.m1.1.1.2.2">ID</mtext></ci><cn id="S4.T2.25.5.1.m1.1.1.2.3.cmml" type="integer" xref="S4.T2.25.5.1.m1.1.1.2.3">3</cn></apply><ci id="S4.T2.25.5.1.m1.1.1.3a.cmml" xref="S4.T2.25.5.1.m1.1.1.3"><mtext id="S4.T2.25.5.1.m1.1.1.3.cmml" xref="S4.T2.25.5.1.m1.1.1.3">-random</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.5.1.m1.1c">\text{ID}^{3}\text{-random}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.25.5.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT -random</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.2">96.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.3">80.81</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.4">78.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.5">85.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.25.5.6">87.57</td>
<td class="ltx_td ltx_align_center" id="S4.T2.25.5.7">85.59</td>
</tr>
<tr class="ltx_tr" id="S4.T2.26.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.1">
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S4.T2.26.6.1.m1.1"><semantics id="S4.T2.26.6.1.m1.1a"><msup id="S4.T2.26.6.1.m1.1.1" xref="S4.T2.26.6.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.26.6.1.m1.1.1.2" xref="S4.T2.26.6.1.m1.1.1.2a.cmml">ID</mtext><mn id="S4.T2.26.6.1.m1.1.1.3" xref="S4.T2.26.6.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T2.26.6.1.m1.1b"><apply id="S4.T2.26.6.1.m1.1.1.cmml" xref="S4.T2.26.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.26.6.1.m1.1.1.1.cmml" xref="S4.T2.26.6.1.m1.1.1">superscript</csymbol><ci id="S4.T2.26.6.1.m1.1.1.2a.cmml" xref="S4.T2.26.6.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.26.6.1.m1.1.1.2.cmml" xref="S4.T2.26.6.1.m1.1.1.2">ID</mtext></ci><cn id="S4.T2.26.6.1.m1.1.1.3.cmml" type="integer" xref="S4.T2.26.6.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.26.6.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.26.6.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.1.1"> (Ours)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.2"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.2.1">97.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.3.1">86.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.4"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.4.1">82.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.5"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.5.1">91.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.26.6.6"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.6.1">90.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.26.6.7"><span class="ltx_text ltx_font_bold" id="S4.T2.26.6.7.1">89.80</span></td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">We compare the accuracies of FR models trained on the synthetic face datasets generated by different generative models and demonstrate the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.T1" title='Table 1 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.7">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.T1" title='Table 1 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">1</span></a>, ID<sup class="ltx_sup" id="S4.SS3.SSS2.p2.7.1">3</sup> demonstrates consistent superior performance,
achieving the highest average accuracy of <math alttext="86.50\%" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.2.m2.1"><semantics id="S4.SS3.SSS2.p2.2.m2.1a"><mrow id="S4.SS3.SSS2.p2.2.m2.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.cmml"><mn id="S4.SS3.SSS2.p2.2.m2.1.1.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml">86.50</mn><mo id="S4.SS3.SSS2.p2.2.m2.1.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.2.m2.1b"><apply id="S4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS3.SSS2.p2.2.m2.1.1.2">86.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.2.m2.1c">86.50\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.2.m2.1d">86.50 %</annotation></semantics></math>,
and outperforms other baselines in all benchmarks,
notably scoring <math alttext="83.78\%" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.3.m3.1"><semantics id="S4.SS3.SSS2.p2.3.m3.1a"><mrow id="S4.SS3.SSS2.p2.3.m3.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.cmml"><mn id="S4.SS3.SSS2.p2.3.m3.1.1.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml">83.78</mn><mo id="S4.SS3.SSS2.p2.3.m3.1.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.3.m3.1b"><apply id="S4.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.1">percent</csymbol><cn id="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml" type="float" xref="S4.SS3.SSS2.p2.3.m3.1.1.2">83.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.3.m3.1c">83.78\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.3.m3.1d">83.78 %</annotation></semantics></math> in AgeDB and <math alttext="85.00\%" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.4.m4.1"><semantics id="S4.SS3.SSS2.p2.4.m4.1a"><mrow id="S4.SS3.SSS2.p2.4.m4.1.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.cmml"><mn id="S4.SS3.SSS2.p2.4.m4.1.1.2" xref="S4.SS3.SSS2.p2.4.m4.1.1.2.cmml">85.00</mn><mo id="S4.SS3.SSS2.p2.4.m4.1.1.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.4.m4.1b"><apply id="S4.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1.1">percent</csymbol><cn id="S4.SS3.SSS2.p2.4.m4.1.1.2.cmml" type="float" xref="S4.SS3.SSS2.p2.4.m4.1.1.2">85.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.4.m4.1c">85.00\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.4.m4.1d">85.00 %</annotation></semantics></math> in CFP-FP. This demonstrates the effectiveness of ID<sup class="ltx_sup" id="S4.SS3.SSS2.p2.7.2">3</sup> in gaining pose and age control.
Other methods, while effective to varying degrees, attain average scores below <math alttext="86.50\%" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.6.m6.1"><semantics id="S4.SS3.SSS2.p2.6.m6.1a"><mrow id="S4.SS3.SSS2.p2.6.m6.1.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.cmml"><mn id="S4.SS3.SSS2.p2.6.m6.1.1.2" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.cmml">86.50</mn><mo id="S4.SS3.SSS2.p2.6.m6.1.1.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.6.m6.1b"><apply id="S4.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.1">percent</csymbol><cn id="S4.SS3.SSS2.p2.6.m6.1.1.2.cmml" type="float" xref="S4.SS3.SSS2.p2.6.m6.1.1.2">86.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.6.m6.1c">86.50\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.6.m6.1d">86.50 %</annotation></semantics></math> and
are inferior to ID<sup class="ltx_sup" id="S4.SS3.SSS2.p2.7.3">3</sup>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.2">It is worth mentioning that ID<sup class="ltx_sup" id="S4.SS3.SSS2.p3.2.1">3</sup>, apart from using real data during training, does not introduce any real images as auxiliary data during the sampling phase. The synthetic data is directly used in the training of the face recognition model without undergoing any secondary or manual filtering. Additionally, when training the face recognition model using the synthetic data, no real images are introduced as auxiliary data. On the other hand, DCFace, as described and reported in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Kim et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite>, introduces real face images as auxiliary data during the training phase for face recognition. This helps enhance the diversity of the training data and leads to slightly better results than ID<sup class="ltx_sup" id="S4.SS3.SSS2.p3.2.2">3</sup> in the two benchmarks.</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Ablation study.</h5>
<div class="ltx_para" id="S4.SS3.SSS2.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS2.Px1.p1.7">We further investigate the impact of each contributing component of ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.1">3</sup> in generating a synthetic face dataset on SFR. This includes three ablation studies shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S4.T2" title='Table 2 ‣ 4.3.2 Quantitative Results ‣ 4.3 Performance Evaluation ‣ 4 Experiments ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">2</span></a>: the effect of the reversed likelihood score in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>) on ID-preserving sampling algorithm (ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.2">3</sup> vs. ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.3">3</sup>-w/o-reversed), the effect of using anchors in ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.4">3</sup> (ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.5">3</sup> vs. ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p1.7.6">3</sup>-random),
and the effect of lower- and upper-bound of Uniform distribution for sampling <math alttext="\nu_{ij}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.Px1.p1.7.m7.1"><semantics id="S4.SS3.SSS2.Px1.p1.7.m7.1a"><msub id="S4.SS3.SSS2.Px1.p1.7.m7.1.1" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.2" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.2.cmml">ν</mi><mrow id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.2" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.2.cmml">i</mi><mo id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.1" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.3" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.7.m7.1b"><apply id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.2">𝜈</ci><apply id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3"><times id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.1"></times><ci id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.2">𝑖</ci><ci id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.7.m7.1c">\nu_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.Px1.p1.7.m7.1d">italic_ν start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>’s.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.Px1.p2">
<p class="ltx_p" id="S4.SS3.SSS2.Px1.p2.4">In the first study, we compare ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p2.4.1">3</sup> with ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p2.4.2">3</sup>-w/o-reversed, which removes the reversed likelihood score from Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>) in the proposed ID-preserving sampling algorithm. We observed ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p2.4.3">3</sup> consistently outperforms ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p2.4.4">3</sup>-w/o-reversed with large margins. This suggests the necessity of the inner-product term in the proposed loss function Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E3" title='Equation 3 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3</span></a>) and the reversed likelihood score in the adjusted likelihood score Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E8" title='Equation 8 ‣ 3.4 ID-Preserving Sampling ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.Px1.p3">
<p class="ltx_p" id="S4.SS3.SSS2.Px1.p3.3">In the second study (cf. Appendix E), an appropriate smaller value of <math alttext="lb" class="ltx_Math" display="inline" id="S4.SS3.SSS2.Px1.p3.1.m1.1"><semantics id="S4.SS3.SSS2.Px1.p3.1.m1.1a"><mrow id="S4.SS3.SSS2.Px1.p3.1.m1.1.1" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.2" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.2.cmml">l</mi><mo id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.1" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.3" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p3.1.m1.1b"><apply id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1"><times id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.1"></times><ci id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.2">𝑙</ci><ci id="S4.SS3.SSS2.Px1.p3.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p3.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p3.1.m1.1c">lb</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.Px1.p3.1.m1.1d">italic_l italic_b</annotation></semantics></math>, if not exceeding a certain range, can increase the intra-class diversity, resulting in more diverse intra-class face images. This aligns with our objective of increasing intra-class diversity in the generated data to enhance the effectiveness of SFR. As per the constraints of Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E9" title='Equation 9 ‣ 3.5 Synthetic Dataset Generation ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">9</span></a>), each generated identity embedding <math alttext="\mathbf{y}_{ij}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.Px1.p3.2.m2.1"><semantics id="S4.SS3.SSS2.Px1.p3.2.m2.1a"><msub id="S4.SS3.SSS2.Px1.p3.2.m2.1.1" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.2" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.2.cmml">𝐲</mi><mrow id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.2" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.2.cmml">i</mi><mo id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.1" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.3" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p3.2.m2.1b"><apply id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.2">𝐲</ci><apply id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3"><times id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS2.Px1.p3.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p3.2.m2.1c">\mathbf{y}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.Px1.p3.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> maintains the same identity as the anchor <math alttext="\mathbf{w}_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.Px1.p3.3.m3.1"><semantics id="S4.SS3.SSS2.Px1.p3.3.m3.1a"><msub id="S4.SS3.SSS2.Px1.p3.3.m3.1.1" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.2" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1.2.cmml">𝐰</mi><mi id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.3" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p3.3.m3.1b"><apply id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1.2">𝐰</ci><ci id="S4.SS3.SSS2.Px1.p3.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p3.3.m3.1c">\mathbf{w}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.Px1.p3.3.m3.1d">bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. This, along with our proposed inner-product term in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#S3.E3" title='Equation 3 ‣ 3.3 Optimization Objective ‣ 3 Methodology ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">3</span></a>), ensures consistent intra-class identities while introducing a significant amount of diversity.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.Px1.p4">
<p class="ltx_p" id="S4.SS3.SSS2.Px1.p4.6">In the third study, we demonstrate how effective it is to use maximally-separated anchors in ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.1">3</sup> as compared to ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.2">3</sup>-random that randomly sets anchors on the unit hypersphere for sample generation. Clearly, ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.3">3</sup>-random does not yield as good results as ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.4">3</sup>. This is because the random sampling method only introduces one identity signal per ID, while the model requires a combination of attributes and identity signals. Attribute signals can only control explicit attributes, whereas identity signals control implicit properties. Introducing only one identity signal per identity implies insufficient intra-class diversity. Additionally, ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.5">3</sup>-random fails to regularize the relationship among different identities, leading to inadequate diversity among classes or aliasing issues with different identity signals. The identity signals obtained using ID<sup class="ltx_sup" id="S4.SS3.SSS2.Px1.p4.6.6">3</sup> resolves the problem of aliasing between identity signals across classes, effectively improving intra-/inter-class diversity.</p>
</div>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.3">We have proposed <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><msup id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mtext id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2a.cmml">ID</mtext><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">superscript</csymbol><ci id="S5.p1.1.m1.1.1.2a.cmml" xref="S5.p1.1.m1.1.1.2"><mtext id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">ID</mtext></ci><cn id="S5.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, an identity-preserving-yet-diversified diffusion generative model for SFR.
Our theoretical analysis regarding the training of <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S5.p1.2.m2.1"><semantics id="S5.p1.2.m2.1a"><msup id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mtext id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2a.cmml">ID</mtext><mn id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">superscript</csymbol><ci id="S5.p1.2.m2.1.1.2a.cmml" xref="S5.p1.2.m2.1.1.2"><mtext id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">ID</mtext></ci><cn id="S5.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> induces a new ID-preserving sampling algorithm and further, a dataset-generating algorithm that generates identity-preserving face images with inter-/intra-class diversity.
Extensive experiments show that <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S5.p1.3.m3.1"><semantics id="S5.p1.3.m3.1a"><msup id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml"><mtext id="S5.p1.3.m3.1.1.2" xref="S5.p1.3.m3.1.1.2a.cmml">ID</mtext><mn id="S5.p1.3.m3.1.1.3" xref="S5.p1.3.m3.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><apply id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p1.3.m3.1.1.1.cmml" xref="S5.p1.3.m3.1.1">superscript</csymbol><ci id="S5.p1.3.m3.1.1.2a.cmml" xref="S5.p1.3.m3.1.1.2"><mtext id="S5.p1.3.m3.1.1.2.cmml" xref="S5.p1.3.m3.1.1.2">ID</mtext></ci><cn id="S5.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.3.m3.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> outperforms existing methods in challenging multiple benchmarks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.2"><span class="ltx_text ltx_font_bold" id="S5.p2.2.1">Limitations.</span>
While <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><msup id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mtext id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2a.cmml">ID</mtext><mn id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">superscript</csymbol><ci id="S5.p2.1.m1.1.1.2a.cmml" xref="S5.p2.1.m1.1.1.2"><mtext id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">ID</mtext></ci><cn id="S5.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, designed for the sake of privacy protection, achieves SoTA performance in SFR, there remains clear margins as compared to the FR performance when training with real-world face datasets such as MS1M. This suggests that the fake face dataset generated by <math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><msup id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mtext id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2a.cmml">ID</mtext><mn id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1">superscript</csymbol><ci id="S5.p2.2.m2.1.1.2a.cmml" xref="S5.p2.2.m2.1.1.2"><mtext id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">ID</mtext></ci><cn id="S5.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.p2.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> does not fully approximate the real-world faces. Future work might include closing this gap.


<span class="ltx_text" id="S5.p2.2.2" style="font-size:90%;"></span></p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.5.5.1" style="font-size:90%;">Bae et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.7.1" style="font-size:90%;">
Gwangbin Bae, Martin de La Gorce, Tadas Baltrušaitis, Charlie Hewitt, Dong Chen, Julien Valentin, Roberto Cipolla, and Jingjing Shen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.8.1" style="font-size:90%;">Digiface-1m: 1 million digital face images for face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib1.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision</em><span class="ltx_text" id="bib.bib1.11.3" style="font-size:90%;">, pages 3526–3535, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.5.5.1" style="font-size:90%;">Boutros et al. (2022)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.7.1" style="font-size:90%;">
Fadi Boutros, Marco Huber, Patrick Siebke, Tim Rieber, and Naser Damer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.8.1" style="font-size:90%;">Sface: Privacy-friendly and accurate face recognition using synthetic data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib2.10.2" style="font-size:90%;">2022 IEEE International Joint Conference on Biometrics (IJCB)</em><span class="ltx_text" id="bib.bib2.11.3" style="font-size:90%;">, pages 1–11. IEEE, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.5.5.1" style="font-size:90%;">Boutros et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.7.1" style="font-size:90%;">
Fadi Boutros, Jonas Henry Grebe, Arjan Kuijper, and Naser Damer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.8.1" style="font-size:90%;">Idiff-face: Synthetic-based face recognition through fizzy identity-conditioned diffusion model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib3.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span class="ltx_text" id="bib.bib3.11.3" style="font-size:90%;">, pages 19650–19661, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.5.5.1" style="font-size:90%;">Deng et al. (2019)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">
Jiankang Deng, Jia Guo, Niannan Xue, and Stefanos Zafeiriou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.8.1" style="font-size:90%;">Arcface: Additive angular margin loss for deep face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib4.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em><span class="ltx_text" id="bib.bib4.11.3" style="font-size:90%;">, pages 4690–4699, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.5.5.1" style="font-size:90%;">Deng et al. (2020)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">
Yu Deng, Jiaolong Yang, Dong Chen, Fang Wen, and Xin Tong.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.8.1" style="font-size:90%;">Disentangled and controllable face image generation via 3d imitative-contrastive learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib5.10.2" style="font-size:90%;">IEEE Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib5.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.5.5.1" style="font-size:90%;">Guo et al. (2016)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.7.1" style="font-size:90%;">
Yandong Guo, Lei Zhang, Yuxiao Hu, Xiaodong He, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.8.1" style="font-size:90%;">Ms-celeb-1m: A dataset and benchmark for large-scale face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib6.10.2" style="font-size:90%;">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part III 14</em><span class="ltx_text" id="bib.bib6.11.3" style="font-size:90%;">, pages 87–102. Springer, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.5.5.1" style="font-size:90%;">Hasnat et al. (2017)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.7.1" style="font-size:90%;">
Md Abul Hasnat, Julien Bohné, Jonathan Milgram, Stéphane Gentric, and Liming Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.8.1" style="font-size:90%;">von mises-fisher mixture model-based deep learning: Application to face verification.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.9.1" style="font-size:90%;">arXiv preprint arXiv:1706.04264</em><span class="ltx_text" id="bib.bib7.10.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.5.5.1" style="font-size:90%;">He et al. (2016)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.8.1" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib8.10.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</em><span class="ltx_text" id="bib.bib8.11.3" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.5.5.1" style="font-size:90%;">Ho et al. (2020)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.7.1" style="font-size:90%;">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.8.1" style="font-size:90%;">Denoising diffusion probabilistic models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib9.10.2" style="font-size:90%;">, 33:6840–6851, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.5.5.1" style="font-size:90%;">Huang et al. (2008)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.7.1" style="font-size:90%;">
Gary B Huang, Marwan Mattar, Tamara Berg, and Eric Learned-Miller.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.8.1" style="font-size:90%;">Labeled faces in the wild: A database forstudying face recognition in unconstrained environments.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib10.10.2" style="font-size:90%;">Workshop on faces in’Real-Life’Images: detection, alignment, and recognition</em><span class="ltx_text" id="bib.bib10.11.3" style="font-size:90%;">, 2008.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.5.5.1" style="font-size:90%;">Karras et al. (2019)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.7.1" style="font-size:90%;">
Tero Karras, Samuli Laine, and Timo Aila.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.8.1" style="font-size:90%;">A style-based generator architecture for generative adversarial networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib11.10.2" style="font-size:90%;">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib11.11.3" style="font-size:90%;">, pages 4396–4405, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.5.5.1" style="font-size:90%;">Karras et al. (2020)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">
Tero Karras, Miika Aittala, Janne Hellsten, Samuli Laine, Jaakko Lehtinen, and Timo Aila.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.8.1" style="font-size:90%;">Training generative adversarial networks with limited data.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.9.1" style="font-size:90%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib12.10.2" style="font-size:90%;">, 33:12104–12114, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.5.5.1" style="font-size:90%;">Kim et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">
Minchul Kim, Feng Liu, Anil Jain, and Xiaoming Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.8.1" style="font-size:90%;">Dcface: Synthetic face generation with dual condition diffusion model, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.5.5.1" style="font-size:90%;">Kolf et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">
Jan Niklas Kolf, Tim Rieber, Jurek Elliesen, Fadi Boutros, Arjan Kuijper, and Naser Damer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.8.1" style="font-size:90%;">Identity-driven three-player generative adversarial network for synthetic-based face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib14.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib14.11.3" style="font-size:90%;">, pages 806–816, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.5.5.1" style="font-size:90%;">Li et al. (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">
Shen Li, Jianqing Xu, Xiaqing Xu, Pengcheng Shen, Shaoxin Li, and Bryan Hooi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.8.1" style="font-size:90%;">Spherical confidence learning for face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib15.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib15.11.3" style="font-size:90%;">, pages 15629–15637, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.5.5.1" style="font-size:90%;">Lin et al. (2018)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.7.1" style="font-size:90%;">
Jianxin Lin, Yingce Xia, Tao Qin, Zhibo Chen, and Tie-Yan Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.8.1" style="font-size:90%;">Conditional image-to-image translation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib16.10.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</em><span class="ltx_text" id="bib.bib16.11.3" style="font-size:90%;">, pages 5524–5532, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.4.4.1" style="font-size:90%;">Luo (2022)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.6.1" style="font-size:90%;">
Calvin Luo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">Understanding diffusion models: A unified perspective, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.5.5.1" style="font-size:90%;">Mettes et al. (2019)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.7.1" style="font-size:90%;">
Pascal Mettes, Elise van der Pol, and Cees G M Snoek.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.8.1" style="font-size:90%;">Hyperspherical prototype networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib18.10.2" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib18.11.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.5.5.1" style="font-size:90%;">Moschoglou et al. (2017)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">
Stylianos Moschoglou, Athanasios Papaioannou, Christos Sagonas, Jiankang Deng, Irene Kotsia, and Stefanos Zafeiriou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.8.1" style="font-size:90%;">Agedb: the first manually collected, in-the-wild age database.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib19.10.2" style="font-size:90%;">proceedings of the IEEE conference on computer vision and pattern recognition workshops</em><span class="ltx_text" id="bib.bib19.11.3" style="font-size:90%;">, pages 51–59, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.5.5.1" style="font-size:90%;">Qiu et al. (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">
Haibo Qiu, Baosheng Yu, Dihong Gong, Zhifeng Li, Wei Liu, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.8.1" style="font-size:90%;">Synface: Face recognition with synthetic data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib20.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span class="ltx_text" id="bib.bib20.11.3" style="font-size:90%;">, pages 10880–10890, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.5.5.1" style="font-size:90%;">Richardson et al. (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.7.1" style="font-size:90%;">
Elad Richardson, Yuval Alaluf, Or Patashnik, Yotam Nitzan, Yaniv Azar, Stav Shapiro, and Daniel Cohen-Or.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.8.1" style="font-size:90%;">Encoding in style: a stylegan encoder for image-to-image translation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib21.10.2" style="font-size:90%;">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib21.11.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.5.5.1" style="font-size:90%;">Rombach et al. (2022)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.7.1" style="font-size:90%;">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.8.1" style="font-size:90%;">High-resolution image synthesis with latent diffusion models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib22.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib22.11.3" style="font-size:90%;">, pages 10684–10695, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.5.5.1" style="font-size:90%;">Sengupta et al. (2016)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.7.1" style="font-size:90%;">
Soumyadip Sengupta, Jun-Cheng Chen, Carlos Castillo, Vishal M Patel, Rama Chellappa, and David W Jacobs.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.8.1" style="font-size:90%;">Frontal to profile face verification in the wild.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib23.10.2" style="font-size:90%;">2016 IEEE winter conference on applications of computer vision (WACV)</em><span class="ltx_text" id="bib.bib23.11.3" style="font-size:90%;">, pages 1–9. IEEE, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.4.4.1" style="font-size:90%;">Serengil and Ozpinar (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.6.1" style="font-size:90%;">
Sefik Ilkin Serengil and Alper Ozpinar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.7.1" style="font-size:90%;">Hyperextended lightface: A facial attribute analysis framework.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.8.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib24.9.2" style="font-size:90%;">2021 International Conference on Engineering and Emerging Technologies (ICEET)</em><span class="ltx_text" id="bib.bib24.10.3" style="font-size:90%;">, pages 1–4. IEEE, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.5.5.1" style="font-size:90%;">Song et al. (2020)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.7.1" style="font-size:90%;">
Jiaming Song, Chenlin Meng, and Stefano Ermon.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.8.1" style="font-size:90%;">Denoising diffusion implicit models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.9.1" style="font-size:90%;">arXiv preprint arXiv:2010.02502</em><span class="ltx_text" id="bib.bib25.10.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.5.5.1" style="font-size:90%;">Song et al. (2022)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.7.1" style="font-size:90%;">
Jiaming Song, Chenlin Meng, and Stefano Ermon.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.8.1" style="font-size:90%;">Denoising diffusion implicit models, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.4.4.1" style="font-size:90%;">Tammes (1930)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.6.1" style="font-size:90%;">
Pieter Merkus Lambertus Tammes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">On the origin of number and arrangement of the places of exit on the surface of pollen-grains.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.8.1" style="font-size:90%;">Recueil des travaux botaniques néerlandais</em><span class="ltx_text" id="bib.bib27.9.2" style="font-size:90%;">, 27(1):1–84, 1930.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.5.5.1" style="font-size:90%;">Wang et al. (2018)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.7.1" style="font-size:90%;">
Hao Wang, Yitong Wang, Zheng Zhou, Xing Ji, Dihong Gong, Jingchao Zhou, Zhifeng Li, and Wei Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.8.1" style="font-size:90%;">Cosface: Large margin cosine loss for deep face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib28.10.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</em><span class="ltx_text" id="bib.bib28.11.3" style="font-size:90%;">, pages 5265–5274, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.5.5.1" style="font-size:90%;">Wang et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">
Wenqing Wang, Lingqing Zhang, Chi-Man Pun, and Jiu-Cheng Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.8.1" style="font-size:90%;">Boosting face recognition performance with synthetic data and limited real data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib29.10.2" style="font-size:90%;">ICASSP 2023 - 2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em><span class="ltx_text" id="bib.bib29.11.3" style="font-size:90%;">, pages 1–5, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.5.5.1" style="font-size:90%;">Wood et al. (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.7.1" style="font-size:90%;">
Erroll Wood, Tadas Baltrušaitis, Charlie Hewitt, Sebastian Dziadzio, Thomas J Cashman, and Jamie Shotton.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.8.1" style="font-size:90%;">Fake it till you make it: face analysis in the wild using synthetic data alone.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib30.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</em><span class="ltx_text" id="bib.bib30.11.3" style="font-size:90%;">, pages 3681–3691, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.5.5.1" style="font-size:90%;">Xu et al. (2023)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.7.1" style="font-size:90%;">
Jianqing Xu, Shen Li, Ailin Deng, Miao Xiong, Jiaying Wu, Jiaxiang Wu, Shouhong Ding, and Bryan Hooi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.8.1" style="font-size:90%;">Probabilistic knowledge distillation of face ensembles.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib31.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em><span class="ltx_text" id="bib.bib31.11.3" style="font-size:90%;">, pages 3489–3498, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.5.5.1" style="font-size:90%;">Yi et al. (2014)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.7.1" style="font-size:90%;">
Dong Yi, Zhen Lei, Shengcai Liao, and Stan Z. Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.8.1" style="font-size:90%;">Learning face representation from scratch, 2014.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.4.4.1" style="font-size:90%;">Zheng and Deng (2018)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.6.1" style="font-size:90%;">
Tianyue Zheng and Weihong Deng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.7.1" style="font-size:90%;">Cross-pose lfw: A database for studying cross-pose face recognition in unconstrained environments.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.8.1" style="font-size:90%;">Beijing University of Posts and Telecommunications, Tech. Rep</em><span class="ltx_text" id="bib.bib33.9.2" style="font-size:90%;">, 5(7), 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.5.5.1" style="font-size:90%;">Zheng et al. (2017)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.7.1" style="font-size:90%;">
Tianyue Zheng, Weihong Deng, and Jiani Hu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.8.1" style="font-size:90%;">Cross-age lfw: A database for studying cross-age face recognition in unconstrained environments.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.9.1" style="font-size:90%;">arXiv preprint arXiv:1708.08197</em><span class="ltx_text" id="bib.bib34.10.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.5.5.1" style="font-size:90%;">Zhu et al. (2021)</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.7.1" style="font-size:90%;">
Zheng Zhu, Guan Huang, Jiankang Deng, Yun Ye, Junjie Huang, Xinze Chen, Jiagang Zhu, Tian Yang, Jiwen Lu, Dalong Du, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.8.1" style="font-size:90%;">Webface260m: A benchmark unveiling the power of million-scale deep face recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib35.10.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span class="ltx_text" id="bib.bib35.11.3" style="font-size:90%;">, pages 10492–10502, 2021.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix ltx_centering" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">
<math alttext="\text{ID}^{3}" class="ltx_Math" display="inline" id="Ax1.1.m1.1"><semantics id="Ax1.1.m1.1b"><msup id="Ax1.1.m1.1.1" xref="Ax1.1.m1.1.1.cmml"><mtext id="Ax1.1.m1.1.1.2" xref="Ax1.1.m1.1.1.2a.cmml">ID</mtext><mn id="Ax1.1.m1.1.1.3" xref="Ax1.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="Ax1.1.m1.1c"><apply id="Ax1.1.m1.1.1.cmml" xref="Ax1.1.m1.1.1"><csymbol cd="ambiguous" id="Ax1.1.m1.1.1.1.cmml" xref="Ax1.1.m1.1.1">superscript</csymbol><ci id="Ax1.1.m1.1.1.2a.cmml" xref="Ax1.1.m1.1.1.2"><mtext id="Ax1.1.m1.1.1.2.cmml" xref="Ax1.1.m1.1.1.2">ID</mtext></ci><cn id="Ax1.1.m1.1.1.3.cmml" type="integer" xref="Ax1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.1.m1.1d">\text{ID}^{3}</annotation><annotation encoding="application/x-llamapun" id="Ax1.1.m1.1e">ID start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition</h2>
</section>
<section class="ltx_appendix" id="Ax2">
<h2 class="ltx_title ltx_title_appendix">Supplementary Material</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix A</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We first present a lemma (Lemma A.1) that will be further used to prove Theorem <math alttext="3.1" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mn id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">3.1</mn><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><cn id="A1.p1.1.m1.1.1.cmml" type="float" xref="A1.p1.1.m1.1.1">3.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">3.1</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">3.1</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="A1.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="A1.Thmtheorem1.1.1.1">Lemma A.1</span></span><span class="ltx_text ltx_font_bold" id="A1.Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="A1.Thmtheorem1.p1">
<p class="ltx_p" id="A1.Thmtheorem1.p1.4"><span class="ltx_text ltx_font_italic" id="A1.Thmtheorem1.p1.4.4">Given any two conditional probability density functions, <math alttext="p(a|b)" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.1.1.m1.1"><semantics id="A1.Thmtheorem1.p1.1.1.m1.1a"><mrow id="A1.Thmtheorem1.p1.1.1.m1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">p</mi><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml"><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.1.1.m1.1b"><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1"><times id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.2"></times><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3">𝑝</ci><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.1.1.m1.1c">p(a|b)</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.1.1.m1.1d">italic_p ( italic_a | italic_b )</annotation></semantics></math> and <math alttext="p(b|a)" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.2.2.m2.1"><semantics id="A1.Thmtheorem1.p1.2.2.m2.1a"><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">p</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.2" stretchy="false" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml">b</mi><mo fence="false" id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.3" stretchy="false" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.2.2.m2.1b"><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1"><times id="A1.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.2"></times><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3">𝑝</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2">𝑏</ci><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.2.2.m2.1c">p(b|a)</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.2.2.m2.1d">italic_p ( italic_b | italic_a )</annotation></semantics></math>, and a positive scalar <math alttext="w&gt;0" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.3.3.m3.1"><semantics id="A1.Thmtheorem1.p1.3.3.m3.1a"><mrow id="A1.Thmtheorem1.p1.3.3.m3.1.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1.2" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">w</mi><mo id="A1.Thmtheorem1.p1.3.3.m3.1.1.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.1.cmml">&gt;</mo><mn id="A1.Thmtheorem1.p1.3.3.m3.1.1.3" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.3.3.m3.1b"><apply id="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1"><gt id="A1.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.1"></gt><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.2">𝑤</ci><cn id="A1.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.3.3.m3.1c">w&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.3.3.m3.1d">italic_w &gt; 0</annotation></semantics></math>, there exists another conditional probability density function <math alttext="\tilde{p}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.4.4.m4.1"><semantics id="A1.Thmtheorem1.p1.4.4.m4.1a"><mover accent="true" id="A1.Thmtheorem1.p1.4.4.m4.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.1.2" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">p</mi><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.4.4.m4.1b"><apply id="A1.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1"><ci id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1">~</ci><ci id="A1.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.4.4.m4.1c">\tilde{p}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.4.4.m4.1d">over~ start_ARG italic_p end_ARG</annotation></semantics></math> such that</span></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{p}(a|b)=\frac{1}{Z_{b,w}}p(a|b)p(b|a)^{w},\text{where }Z_{b,w}=\int{p(a%
|b)p(b|a)^{w}}da." class="ltx_Math" display="block" id="A1.E1.m1.5"><semantics id="A1.E1.m1.5a"><mrow id="A1.E1.m1.5.5.1"><mrow id="A1.E1.m1.5.5.1.1.2" xref="A1.E1.m1.5.5.1.1.3.cmml"><mrow id="A1.E1.m1.5.5.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.cmml"><mrow id="A1.E1.m1.5.5.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.1.cmml"><mover accent="true" id="A1.E1.m1.5.5.1.1.1.1.1.3" xref="A1.E1.m1.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E1.m1.5.5.1.1.1.1.1.3.2" xref="A1.E1.m1.5.5.1.1.1.1.1.3.2.cmml">p</mi><mo id="A1.E1.m1.5.5.1.1.1.1.1.3.1" xref="A1.E1.m1.5.5.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="A1.E1.m1.5.5.1.1.1.1.1.2" xref="A1.E1.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E1.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.E1.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E1.m1.5.5.1.1.1.1.4" xref="A1.E1.m1.5.5.1.1.1.1.4.cmml">=</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.3" xref="A1.E1.m1.5.5.1.1.1.1.3.cmml"><mfrac id="A1.E1.m1.2.2" xref="A1.E1.m1.2.2.cmml"><mn id="A1.E1.m1.2.2.4" xref="A1.E1.m1.2.2.4.cmml">1</mn><msub id="A1.E1.m1.2.2.2" xref="A1.E1.m1.2.2.2.cmml"><mi id="A1.E1.m1.2.2.2.4" xref="A1.E1.m1.2.2.2.4.cmml">Z</mi><mrow id="A1.E1.m1.2.2.2.2.2.4" xref="A1.E1.m1.2.2.2.2.2.3.cmml"><mi id="A1.E1.m1.1.1.1.1.1.1" xref="A1.E1.m1.1.1.1.1.1.1.cmml">b</mi><mo id="A1.E1.m1.2.2.2.2.2.4.1" xref="A1.E1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E1.m1.2.2.2.2.2.2" xref="A1.E1.m1.2.2.2.2.2.2.cmml">w</mi></mrow></msub></mfrac><mo id="A1.E1.m1.5.5.1.1.1.1.3.3" xref="A1.E1.m1.5.5.1.1.1.1.3.3.cmml">⁢</mo><mi id="A1.E1.m1.5.5.1.1.1.1.3.4" xref="A1.E1.m1.5.5.1.1.1.1.3.4.cmml">p</mi><mo id="A1.E1.m1.5.5.1.1.1.1.3.3a" xref="A1.E1.m1.5.5.1.1.1.1.3.3.cmml">⁢</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.2.1.1" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E1.m1.5.5.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.2" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.3" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.3.cmml">b</mi></mrow><mo id="A1.E1.m1.5.5.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E1.m1.5.5.1.1.1.1.3.3b" xref="A1.E1.m1.5.5.1.1.1.1.3.3.cmml">⁢</mo><mi id="A1.E1.m1.5.5.1.1.1.1.3.5" xref="A1.E1.m1.5.5.1.1.1.1.3.5.cmml">p</mi><mo id="A1.E1.m1.5.5.1.1.1.1.3.3c" xref="A1.E1.m1.5.5.1.1.1.1.3.3.cmml">⁢</mo><msup id="A1.E1.m1.5.5.1.1.1.1.3.2" xref="A1.E1.m1.5.5.1.1.1.1.3.2.cmml"><mrow id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.cmml"><mo id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.2" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.cmml"><mi id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.2" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.2.cmml">b</mi><mo fence="false" id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.1" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.1.cmml">|</mo><mi id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.3" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.3.cmml">a</mi></mrow><mo id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.3" stretchy="false" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.cmml">)</mo></mrow><mi id="A1.E1.m1.5.5.1.1.1.1.3.2.3" xref="A1.E1.m1.5.5.1.1.1.1.3.2.3.cmml">w</mi></msup></mrow></mrow><mo id="A1.E1.m1.5.5.1.1.2.3" xref="A1.E1.m1.5.5.1.1.3a.cmml">,</mo><mrow id="A1.E1.m1.5.5.1.1.2.2" xref="A1.E1.m1.5.5.1.1.2.2.cmml"><mrow id="A1.E1.m1.5.5.1.1.2.2.4" xref="A1.E1.m1.5.5.1.1.2.2.4.cmml"><mtext class="ltx_mathvariant_italic" id="A1.E1.m1.5.5.1.1.2.2.4.2" xref="A1.E1.m1.5.5.1.1.2.2.4.2a.cmml">where </mtext><mo id="A1.E1.m1.5.5.1.1.2.2.4.1" xref="A1.E1.m1.5.5.1.1.2.2.4.1.cmml">⁢</mo><msub id="A1.E1.m1.5.5.1.1.2.2.4.3" xref="A1.E1.m1.5.5.1.1.2.2.4.3.cmml"><mi id="A1.E1.m1.5.5.1.1.2.2.4.3.2" xref="A1.E1.m1.5.5.1.1.2.2.4.3.2.cmml">Z</mi><mrow id="A1.E1.m1.4.4.2.4" xref="A1.E1.m1.4.4.2.3.cmml"><mi id="A1.E1.m1.3.3.1.1" xref="A1.E1.m1.3.3.1.1.cmml">b</mi><mo id="A1.E1.m1.4.4.2.4.1" xref="A1.E1.m1.4.4.2.3.cmml">,</mo><mi id="A1.E1.m1.4.4.2.2" xref="A1.E1.m1.4.4.2.2.cmml">w</mi></mrow></msub></mrow><mo id="A1.E1.m1.5.5.1.1.2.2.3" rspace="0.111em" xref="A1.E1.m1.5.5.1.1.2.2.3.cmml">=</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.2" xref="A1.E1.m1.5.5.1.1.2.2.2.cmml"><mo id="A1.E1.m1.5.5.1.1.2.2.2.3" xref="A1.E1.m1.5.5.1.1.2.2.2.3.cmml">∫</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.2.2" xref="A1.E1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.4" xref="A1.E1.m1.5.5.1.1.2.2.2.2.4.cmml">p</mi><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.3" xref="A1.E1.m1.5.5.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.cmml"><mo id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.2" stretchy="false" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.cmml"><mi id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.2" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.1" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.3" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.3" stretchy="false" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.3a" xref="A1.E1.m1.5.5.1.1.2.2.2.2.3.cmml">⁢</mo><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.5" xref="A1.E1.m1.5.5.1.1.2.2.2.2.5.cmml">p</mi><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.3b" xref="A1.E1.m1.5.5.1.1.2.2.2.2.3.cmml">⁢</mo><msup id="A1.E1.m1.5.5.1.1.2.2.2.2.2" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.cmml"><mrow id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.2" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.2.cmml">b</mi><mo fence="false" id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.1" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.3" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.3.cmml">a</mi></mrow><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.2.3" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml">w</mi></msup><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.3c" lspace="0em" xref="A1.E1.m1.5.5.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="A1.E1.m1.5.5.1.1.2.2.2.2.6" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6.cmml"><mo id="A1.E1.m1.5.5.1.1.2.2.2.2.6.1" rspace="0em" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6.1.cmml">𝑑</mo><mi id="A1.E1.m1.5.5.1.1.2.2.2.2.6.2" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6.2.cmml">a</mi></mrow></mrow></mrow></mrow></mrow><mo id="A1.E1.m1.5.5.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E1.m1.5b"><apply id="A1.E1.m1.5.5.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A1.E1.m1.5.5.1.1.3a.cmml" xref="A1.E1.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E1.m1.5.5.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1"><eq id="A1.E1.m1.5.5.1.1.1.1.4.cmml" xref="A1.E1.m1.5.5.1.1.1.1.4"></eq><apply id="A1.E1.m1.5.5.1.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1"><times id="A1.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.2"></times><apply id="A1.E1.m1.5.5.1.1.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.3"><ci id="A1.E1.m1.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.3.1">~</ci><ci id="A1.E1.m1.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><apply id="A1.E1.m1.5.5.1.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3"><times id="A1.E1.m1.5.5.1.1.1.1.3.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.3"></times><apply id="A1.E1.m1.2.2.cmml" xref="A1.E1.m1.2.2"><divide id="A1.E1.m1.2.2.3.cmml" xref="A1.E1.m1.2.2"></divide><cn id="A1.E1.m1.2.2.4.cmml" type="integer" xref="A1.E1.m1.2.2.4">1</cn><apply id="A1.E1.m1.2.2.2.cmml" xref="A1.E1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.E1.m1.2.2.2.3.cmml" xref="A1.E1.m1.2.2.2">subscript</csymbol><ci id="A1.E1.m1.2.2.2.4.cmml" xref="A1.E1.m1.2.2.2.4">𝑍</ci><list id="A1.E1.m1.2.2.2.2.2.3.cmml" xref="A1.E1.m1.2.2.2.2.2.4"><ci id="A1.E1.m1.1.1.1.1.1.1.cmml" xref="A1.E1.m1.1.1.1.1.1.1">𝑏</ci><ci id="A1.E1.m1.2.2.2.2.2.2.cmml" xref="A1.E1.m1.2.2.2.2.2.2">𝑤</ci></list></apply></apply><ci id="A1.E1.m1.5.5.1.1.1.1.3.4.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.4">𝑝</ci><apply id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.2">𝑎</ci><ci id="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.2.1.1.1.3">𝑏</ci></apply><ci id="A1.E1.m1.5.5.1.1.1.1.3.5.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.5">𝑝</ci><apply id="A1.E1.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E1.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2">superscript</csymbol><apply id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.1">conditional</csymbol><ci id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.2">𝑏</ci><ci id="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2.1.1.1.3">𝑎</ci></apply><ci id="A1.E1.m1.5.5.1.1.1.1.3.2.3.cmml" xref="A1.E1.m1.5.5.1.1.1.1.3.2.3">𝑤</ci></apply></apply></apply><apply id="A1.E1.m1.5.5.1.1.2.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2"><eq id="A1.E1.m1.5.5.1.1.2.2.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.3"></eq><apply id="A1.E1.m1.5.5.1.1.2.2.4.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4"><times id="A1.E1.m1.5.5.1.1.2.2.4.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.1"></times><ci id="A1.E1.m1.5.5.1.1.2.2.4.2a.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.2"><mtext class="ltx_mathvariant_italic" id="A1.E1.m1.5.5.1.1.2.2.4.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.2">where </mtext></ci><apply id="A1.E1.m1.5.5.1.1.2.2.4.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.3"><csymbol cd="ambiguous" id="A1.E1.m1.5.5.1.1.2.2.4.3.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.3">subscript</csymbol><ci id="A1.E1.m1.5.5.1.1.2.2.4.3.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.4.3.2">𝑍</ci><list id="A1.E1.m1.4.4.2.3.cmml" xref="A1.E1.m1.4.4.2.4"><ci id="A1.E1.m1.3.3.1.1.cmml" xref="A1.E1.m1.3.3.1.1">𝑏</ci><ci id="A1.E1.m1.4.4.2.2.cmml" xref="A1.E1.m1.4.4.2.2">𝑤</ci></list></apply></apply><apply id="A1.E1.m1.5.5.1.1.2.2.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2"><int id="A1.E1.m1.5.5.1.1.2.2.2.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.3"></int><apply id="A1.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2"><times id="A1.E1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.3"></times><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.4.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.4">𝑝</ci><apply id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.2">𝑎</ci><ci id="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.1.1.1.1.1.3">𝑏</ci></apply><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.5.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.5">𝑝</ci><apply id="A1.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E1.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2">superscript</csymbol><apply id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.2">𝑏</ci><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.1.1.1.3">𝑎</ci></apply><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.2.3">𝑤</ci></apply><apply id="A1.E1.m1.5.5.1.1.2.2.2.2.6.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6"><csymbol cd="latexml" id="A1.E1.m1.5.5.1.1.2.2.2.2.6.1.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6.1">differential-d</csymbol><ci id="A1.E1.m1.5.5.1.1.2.2.2.2.6.2.cmml" xref="A1.E1.m1.5.5.1.1.2.2.2.2.6.2">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E1.m1.5c">\tilde{p}(a|b)=\frac{1}{Z_{b,w}}p(a|b)p(b|a)^{w},\text{where }Z_{b,w}=\int{p(a%
|b)p(b|a)^{w}}da.</annotation><annotation encoding="application/x-llamapun" id="A1.E1.m1.5d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b ) = divide start_ARG 1 end_ARG start_ARG italic_Z start_POSTSUBSCRIPT italic_b , italic_w end_POSTSUBSCRIPT end_ARG italic_p ( italic_a | italic_b ) italic_p ( italic_b | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , where italic_Z start_POSTSUBSCRIPT italic_b , italic_w end_POSTSUBSCRIPT = ∫ italic_p ( italic_a | italic_b ) italic_p ( italic_b | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT italic_d italic_a .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.1)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="A1.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.1.p1">
<p class="ltx_p" id="A1.1.p1.2">To show this result is equivalent to showing <math alttext="\tilde{p}(a|b)\propto p(a|b)\cdot p(b|a)^{w},w&gt;0" class="ltx_Math" display="inline" id="A1.1.p1.1.m1.2"><semantics id="A1.1.p1.1.m1.2a"><mrow id="A1.1.p1.1.m1.2.2.2" xref="A1.1.p1.1.m1.2.2.3.cmml"><mrow id="A1.1.p1.1.m1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.cmml"><mrow id="A1.1.p1.1.m1.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="A1.1.p1.1.m1.1.1.1.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.1.p1.1.m1.1.1.1.1.1.3.2" xref="A1.1.p1.1.m1.1.1.1.1.1.3.2.cmml">p</mi><mo id="A1.1.p1.1.m1.1.1.1.1.1.3.1" xref="A1.1.p1.1.m1.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="A1.1.p1.1.m1.1.1.1.1.1.2" xref="A1.1.p1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.1.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.4" xref="A1.1.p1.1.m1.1.1.1.1.4.cmml">∝</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.3.cmml"><mrow id="A1.1.p1.1.m1.1.1.1.1.2.1" xref="A1.1.p1.1.m1.1.1.1.1.2.1.cmml"><mrow id="A1.1.p1.1.m1.1.1.1.1.2.1.1" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.cmml"><mi id="A1.1.p1.1.m1.1.1.1.1.2.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.3.cmml">p</mi><mo id="A1.1.p1.1.m1.1.1.1.1.2.1.1.2" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mo id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.2" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.2.1.2" rspace="0.222em" xref="A1.1.p1.1.m1.1.1.1.1.2.1.2.cmml">⋅</mo><mi id="A1.1.p1.1.m1.1.1.1.1.2.1.3" xref="A1.1.p1.1.m1.1.1.1.1.2.1.3.cmml">p</mi></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.3.3" xref="A1.1.p1.1.m1.1.1.1.1.3.3.cmml">⁢</mo><msup id="A1.1.p1.1.m1.1.1.1.1.3.2" xref="A1.1.p1.1.m1.1.1.1.1.3.2.cmml"><mrow id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.cmml"><mo id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.2" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.cmml">(</mo><mrow id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.cmml"><mi id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.2" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.2.cmml">b</mi><mo fence="false" id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.1" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.3" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.3.cmml">a</mi></mrow><mo id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.3" stretchy="false" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.cmml">)</mo></mrow><mi id="A1.1.p1.1.m1.1.1.1.1.3.2.3" xref="A1.1.p1.1.m1.1.1.1.1.3.2.3.cmml">w</mi></msup></mrow></mrow><mo id="A1.1.p1.1.m1.2.2.2.3" xref="A1.1.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="A1.1.p1.1.m1.2.2.2.2" xref="A1.1.p1.1.m1.2.2.2.2.cmml"><mi id="A1.1.p1.1.m1.2.2.2.2.2" xref="A1.1.p1.1.m1.2.2.2.2.2.cmml">w</mi><mo id="A1.1.p1.1.m1.2.2.2.2.1" xref="A1.1.p1.1.m1.2.2.2.2.1.cmml">&gt;</mo><mn id="A1.1.p1.1.m1.2.2.2.2.3" xref="A1.1.p1.1.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.1.m1.2b"><apply id="A1.1.p1.1.m1.2.2.3.cmml" xref="A1.1.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="A1.1.p1.1.m1.2.2.3a.cmml" xref="A1.1.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.1.p1.1.m1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.1.m1.1.1.1.1.4.cmml" xref="A1.1.p1.1.m1.1.1.1.1.4">proportional-to</csymbol><apply id="A1.1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1"><times id="A1.1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.2"></times><apply id="A1.1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.3"><ci id="A1.1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.3.1">~</ci><ci id="A1.1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><apply id="A1.1.p1.1.m1.1.1.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3"><times id="A1.1.p1.1.m1.1.1.1.1.3.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.3"></times><apply id="A1.1.p1.1.m1.1.1.1.1.2.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1"><ci id="A1.1.p1.1.m1.1.1.1.1.2.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.2">⋅</ci><apply id="A1.1.p1.1.m1.1.1.1.1.2.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1"><times id="A1.1.p1.1.m1.1.1.1.1.2.1.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.2"></times><ci id="A1.1.p1.1.m1.1.1.1.1.2.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.3">𝑝</ci><apply id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.2">𝑎</ci><ci id="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.1.1.1.1.3">𝑏</ci></apply></apply><ci id="A1.1.p1.1.m1.1.1.1.1.2.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.2.1.3">𝑝</ci></apply><apply id="A1.1.p1.1.m1.1.1.1.1.3.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.1.p1.1.m1.1.1.1.1.3.2.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2">superscript</csymbol><apply id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1"><csymbol cd="latexml" id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.1.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.2.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.2">𝑏</ci><ci id="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2.1.1.1.3">𝑎</ci></apply><ci id="A1.1.p1.1.m1.1.1.1.1.3.2.3.cmml" xref="A1.1.p1.1.m1.1.1.1.1.3.2.3">𝑤</ci></apply></apply></apply><apply id="A1.1.p1.1.m1.2.2.2.2.cmml" xref="A1.1.p1.1.m1.2.2.2.2"><gt id="A1.1.p1.1.m1.2.2.2.2.1.cmml" xref="A1.1.p1.1.m1.2.2.2.2.1"></gt><ci id="A1.1.p1.1.m1.2.2.2.2.2.cmml" xref="A1.1.p1.1.m1.2.2.2.2.2">𝑤</ci><cn id="A1.1.p1.1.m1.2.2.2.2.3.cmml" type="integer" xref="A1.1.p1.1.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.1.m1.2c">\tilde{p}(a|b)\propto p(a|b)\cdot p(b|a)^{w},w&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.1.m1.2d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b ) ∝ italic_p ( italic_a | italic_b ) ⋅ italic_p ( italic_b | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_w &gt; 0</annotation></semantics></math>, which is equivalent to showing that, for any <math alttext="b=b_{0}" class="ltx_Math" display="inline" id="A1.1.p1.2.m2.1"><semantics id="A1.1.p1.2.m2.1a"><mrow id="A1.1.p1.2.m2.1.1" xref="A1.1.p1.2.m2.1.1.cmml"><mi id="A1.1.p1.2.m2.1.1.2" xref="A1.1.p1.2.m2.1.1.2.cmml">b</mi><mo id="A1.1.p1.2.m2.1.1.1" xref="A1.1.p1.2.m2.1.1.1.cmml">=</mo><msub id="A1.1.p1.2.m2.1.1.3" xref="A1.1.p1.2.m2.1.1.3.cmml"><mi id="A1.1.p1.2.m2.1.1.3.2" xref="A1.1.p1.2.m2.1.1.3.2.cmml">b</mi><mn id="A1.1.p1.2.m2.1.1.3.3" xref="A1.1.p1.2.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.2.m2.1b"><apply id="A1.1.p1.2.m2.1.1.cmml" xref="A1.1.p1.2.m2.1.1"><eq id="A1.1.p1.2.m2.1.1.1.cmml" xref="A1.1.p1.2.m2.1.1.1"></eq><ci id="A1.1.p1.2.m2.1.1.2.cmml" xref="A1.1.p1.2.m2.1.1.2">𝑏</ci><apply id="A1.1.p1.2.m2.1.1.3.cmml" xref="A1.1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.2.m2.1.1.3.1.cmml" xref="A1.1.p1.2.m2.1.1.3">subscript</csymbol><ci id="A1.1.p1.2.m2.1.1.3.2.cmml" xref="A1.1.p1.2.m2.1.1.3.2">𝑏</ci><cn id="A1.1.p1.2.m2.1.1.3.3.cmml" type="integer" xref="A1.1.p1.2.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.2.m2.1c">b=b_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.2.m2.1d">italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{p}(a|b=b_{0})\propto p(a|b=b_{0})\cdot p(b=b_{0}|a)^{w},w&gt;0" class="ltx_Math" display="block" id="A1.E2.m1.2"><semantics id="A1.E2.m1.2a"><mrow id="A1.E2.m1.2.2.2" xref="A1.E2.m1.2.2.3.cmml"><mrow id="A1.E2.m1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.cmml"><mrow id="A1.E2.m1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.cmml"><mover accent="true" id="A1.E2.m1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.3.cmml"><mi id="A1.E2.m1.1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.1.3.2.cmml">p</mi><mo id="A1.E2.m1.1.1.1.1.1.3.1" xref="A1.E2.m1.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="A1.E2.m1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E2.m1.1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E2.m1.1.1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E2.m1.1.1.1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E2.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.E2.m1.1.1.1.1.1.1.1.1.2.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.E2.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.E2.m1.1.1.1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="A1.E2.m1.1.1.1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E2.m1.1.1.1.1.4" xref="A1.E2.m1.1.1.1.1.4.cmml">∝</mo><mrow id="A1.E2.m1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.3.cmml"><mrow id="A1.E2.m1.1.1.1.1.2.1" xref="A1.E2.m1.1.1.1.1.2.1.cmml"><mrow id="A1.E2.m1.1.1.1.1.2.1.1" xref="A1.E2.m1.1.1.1.1.2.1.1.cmml"><mi id="A1.E2.m1.1.1.1.1.2.1.1.3" xref="A1.E2.m1.1.1.1.1.2.1.1.3.cmml">p</mi><mo id="A1.E2.m1.1.1.1.1.2.1.1.2" xref="A1.E2.m1.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A1.E2.m1.1.1.1.1.2.1.1.1.1" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mo id="A1.E2.m1.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mrow id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.cmml"><mi id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.2" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.1" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.3" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">=</mo><msub id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E2.m1.1.1.1.1.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E2.m1.1.1.1.1.2.1.2" rspace="0.222em" xref="A1.E2.m1.1.1.1.1.2.1.2.cmml">⋅</mo><mi id="A1.E2.m1.1.1.1.1.2.1.3" xref="A1.E2.m1.1.1.1.1.2.1.3.cmml">p</mi></mrow><mo id="A1.E2.m1.1.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.3.3.cmml">⁢</mo><msup id="A1.E2.m1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.3.2.cmml"><mrow id="A1.E2.m1.1.1.1.1.3.2.1.1" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.cmml"><mo id="A1.E2.m1.1.1.1.1.3.2.1.1.2" stretchy="false" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.cmml">(</mo><mrow id="A1.E2.m1.1.1.1.1.3.2.1.1.1" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.cmml"><mi id="A1.E2.m1.1.1.1.1.3.2.1.1.1.2" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.2.cmml">b</mi><mo id="A1.E2.m1.1.1.1.1.3.2.1.1.1.1" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.1.cmml">=</mo><mrow id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.cmml"><msub id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.cmml"><mi id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.2" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.2.cmml">b</mi><mn id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.3" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.3.cmml">0</mn></msub><mo fence="false" id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.1" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.1.cmml">|</mo><mi id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.3.cmml">a</mi></mrow></mrow><mo id="A1.E2.m1.1.1.1.1.3.2.1.1.3" stretchy="false" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.cmml">)</mo></mrow><mi id="A1.E2.m1.1.1.1.1.3.2.3" xref="A1.E2.m1.1.1.1.1.3.2.3.cmml">w</mi></msup></mrow></mrow><mo id="A1.E2.m1.2.2.2.3" xref="A1.E2.m1.2.2.3a.cmml">,</mo><mrow id="A1.E2.m1.2.2.2.2" xref="A1.E2.m1.2.2.2.2.cmml"><mi id="A1.E2.m1.2.2.2.2.2" xref="A1.E2.m1.2.2.2.2.2.cmml">w</mi><mo id="A1.E2.m1.2.2.2.2.1" xref="A1.E2.m1.2.2.2.2.1.cmml">&gt;</mo><mn id="A1.E2.m1.2.2.2.2.3" xref="A1.E2.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E2.m1.2b"><apply id="A1.E2.m1.2.2.3.cmml" xref="A1.E2.m1.2.2.2"><csymbol cd="ambiguous" id="A1.E2.m1.2.2.3a.cmml" xref="A1.E2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E2.m1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.4.cmml" xref="A1.E2.m1.1.1.1.1.4">proportional-to</csymbol><apply id="A1.E2.m1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1"><times id="A1.E2.m1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2"></times><apply id="A1.E2.m1.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.3"><ci id="A1.E2.m1.1.1.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.3.1">~</ci><ci id="A1.E2.m1.1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1"><eq id="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E2.m1.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="A1.E2.m1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.3"><times id="A1.E2.m1.1.1.1.1.3.3.cmml" xref="A1.E2.m1.1.1.1.1.3.3"></times><apply id="A1.E2.m1.1.1.1.1.2.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1"><ci id="A1.E2.m1.1.1.1.1.2.1.2.cmml" xref="A1.E2.m1.1.1.1.1.2.1.2">⋅</ci><apply id="A1.E2.m1.1.1.1.1.2.1.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1"><times id="A1.E2.m1.1.1.1.1.2.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.2"></times><ci id="A1.E2.m1.1.1.1.1.2.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.3">𝑝</ci><apply id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1"><eq id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.1"></eq><apply id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.3.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E2.m1.1.1.1.1.2.1.1.1.1.1.3.3">0</cn></apply></apply></apply><ci id="A1.E2.m1.1.1.1.1.2.1.3.cmml" xref="A1.E2.m1.1.1.1.1.2.1.3">𝑝</ci></apply><apply id="A1.E2.m1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.3.2.2.cmml" xref="A1.E2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="A1.E2.m1.1.1.1.1.3.2.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1"><eq id="A1.E2.m1.1.1.1.1.3.2.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.1"></eq><ci id="A1.E2.m1.1.1.1.1.3.2.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.2">𝑏</ci><apply id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.1">conditional</csymbol><apply id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.1.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.2.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.2">𝑏</ci><cn id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.3.cmml" type="integer" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.2.3">0</cn></apply><ci id="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.3.cmml" xref="A1.E2.m1.1.1.1.1.3.2.1.1.1.3.3">𝑎</ci></apply></apply><ci id="A1.E2.m1.1.1.1.1.3.2.3.cmml" xref="A1.E2.m1.1.1.1.1.3.2.3">𝑤</ci></apply></apply></apply><apply id="A1.E2.m1.2.2.2.2.cmml" xref="A1.E2.m1.2.2.2.2"><gt id="A1.E2.m1.2.2.2.2.1.cmml" xref="A1.E2.m1.2.2.2.2.1"></gt><ci id="A1.E2.m1.2.2.2.2.2.cmml" xref="A1.E2.m1.2.2.2.2.2">𝑤</ci><cn id="A1.E2.m1.2.2.2.2.3.cmml" type="integer" xref="A1.E2.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E2.m1.2c">\tilde{p}(a|b=b_{0})\propto p(a|b=b_{0})\cdot p(b=b_{0}|a)^{w},w&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.E2.m1.2d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ∝ italic_p ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ⋅ italic_p ( italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_w &gt; 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.1.p1.6">Note that <math alttext="\tilde{p}(a|b=b_{0})" class="ltx_Math" display="inline" id="A1.1.p1.3.m1.1"><semantics id="A1.1.p1.3.m1.1a"><mrow id="A1.1.p1.3.m1.1.1" xref="A1.1.p1.3.m1.1.1.cmml"><mover accent="true" id="A1.1.p1.3.m1.1.1.3" xref="A1.1.p1.3.m1.1.1.3.cmml"><mi id="A1.1.p1.3.m1.1.1.3.2" xref="A1.1.p1.3.m1.1.1.3.2.cmml">p</mi><mo id="A1.1.p1.3.m1.1.1.3.1" xref="A1.1.p1.3.m1.1.1.3.1.cmml">~</mo></mover><mo id="A1.1.p1.3.m1.1.1.2" xref="A1.1.p1.3.m1.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.3.m1.1.1.1.1" xref="A1.1.p1.3.m1.1.1.1.1.1.cmml"><mo id="A1.1.p1.3.m1.1.1.1.1.2" stretchy="false" xref="A1.1.p1.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.3.m1.1.1.1.1.1" xref="A1.1.p1.3.m1.1.1.1.1.1.cmml"><mrow id="A1.1.p1.3.m1.1.1.1.1.1.2" xref="A1.1.p1.3.m1.1.1.1.1.1.2.cmml"><mi id="A1.1.p1.3.m1.1.1.1.1.1.2.2" xref="A1.1.p1.3.m1.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.1.p1.3.m1.1.1.1.1.1.2.1" xref="A1.1.p1.3.m1.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.1.p1.3.m1.1.1.1.1.1.2.3" xref="A1.1.p1.3.m1.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.1.p1.3.m1.1.1.1.1.1.1" xref="A1.1.p1.3.m1.1.1.1.1.1.1.cmml">=</mo><msub id="A1.1.p1.3.m1.1.1.1.1.1.3" xref="A1.1.p1.3.m1.1.1.1.1.1.3.cmml"><mi id="A1.1.p1.3.m1.1.1.1.1.1.3.2" xref="A1.1.p1.3.m1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.1.p1.3.m1.1.1.1.1.1.3.3" xref="A1.1.p1.3.m1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.1.p1.3.m1.1.1.1.1.3" stretchy="false" xref="A1.1.p1.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.3.m1.1b"><apply id="A1.1.p1.3.m1.1.1.cmml" xref="A1.1.p1.3.m1.1.1"><times id="A1.1.p1.3.m1.1.1.2.cmml" xref="A1.1.p1.3.m1.1.1.2"></times><apply id="A1.1.p1.3.m1.1.1.3.cmml" xref="A1.1.p1.3.m1.1.1.3"><ci id="A1.1.p1.3.m1.1.1.3.1.cmml" xref="A1.1.p1.3.m1.1.1.3.1">~</ci><ci id="A1.1.p1.3.m1.1.1.3.2.cmml" xref="A1.1.p1.3.m1.1.1.3.2">𝑝</ci></apply><apply id="A1.1.p1.3.m1.1.1.1.1.1.cmml" xref="A1.1.p1.3.m1.1.1.1.1"><eq id="A1.1.p1.3.m1.1.1.1.1.1.1.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.1"></eq><apply id="A1.1.p1.3.m1.1.1.1.1.1.2.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.1.p1.3.m1.1.1.1.1.1.2.1.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.1.p1.3.m1.1.1.1.1.1.2.2.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.1.p1.3.m1.1.1.1.1.1.2.3.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.1.p1.3.m1.1.1.1.1.1.3.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.3.m1.1.1.1.1.1.3.1.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.1.p1.3.m1.1.1.1.1.1.3.2.cmml" xref="A1.1.p1.3.m1.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.1.p1.3.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.1.p1.3.m1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.3.m1.1c">\tilde{p}(a|b=b_{0})</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.3.m1.1d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> is a function of <math alttext="a" class="ltx_Math" display="inline" id="A1.1.p1.4.m2.1"><semantics id="A1.1.p1.4.m2.1a"><mi id="A1.1.p1.4.m2.1.1" xref="A1.1.p1.4.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.4.m2.1b"><ci id="A1.1.p1.4.m2.1.1.cmml" xref="A1.1.p1.4.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.4.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.4.m2.1d">italic_a</annotation></semantics></math>, i.e. there exists a function <math alttext="f_{b_{0},w}" class="ltx_Math" display="inline" id="A1.1.p1.5.m3.2"><semantics id="A1.1.p1.5.m3.2a"><msub id="A1.1.p1.5.m3.2.3" xref="A1.1.p1.5.m3.2.3.cmml"><mi id="A1.1.p1.5.m3.2.3.2" xref="A1.1.p1.5.m3.2.3.2.cmml">f</mi><mrow id="A1.1.p1.5.m3.2.2.2.2" xref="A1.1.p1.5.m3.2.2.2.3.cmml"><msub id="A1.1.p1.5.m3.2.2.2.2.1" xref="A1.1.p1.5.m3.2.2.2.2.1.cmml"><mi id="A1.1.p1.5.m3.2.2.2.2.1.2" xref="A1.1.p1.5.m3.2.2.2.2.1.2.cmml">b</mi><mn id="A1.1.p1.5.m3.2.2.2.2.1.3" xref="A1.1.p1.5.m3.2.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.1.p1.5.m3.2.2.2.2.2" xref="A1.1.p1.5.m3.2.2.2.3.cmml">,</mo><mi id="A1.1.p1.5.m3.1.1.1.1" xref="A1.1.p1.5.m3.1.1.1.1.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.5.m3.2b"><apply id="A1.1.p1.5.m3.2.3.cmml" xref="A1.1.p1.5.m3.2.3"><csymbol cd="ambiguous" id="A1.1.p1.5.m3.2.3.1.cmml" xref="A1.1.p1.5.m3.2.3">subscript</csymbol><ci id="A1.1.p1.5.m3.2.3.2.cmml" xref="A1.1.p1.5.m3.2.3.2">𝑓</ci><list id="A1.1.p1.5.m3.2.2.2.3.cmml" xref="A1.1.p1.5.m3.2.2.2.2"><apply id="A1.1.p1.5.m3.2.2.2.2.1.cmml" xref="A1.1.p1.5.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.1.p1.5.m3.2.2.2.2.1.1.cmml" xref="A1.1.p1.5.m3.2.2.2.2.1">subscript</csymbol><ci id="A1.1.p1.5.m3.2.2.2.2.1.2.cmml" xref="A1.1.p1.5.m3.2.2.2.2.1.2">𝑏</ci><cn id="A1.1.p1.5.m3.2.2.2.2.1.3.cmml" type="integer" xref="A1.1.p1.5.m3.2.2.2.2.1.3">0</cn></apply><ci id="A1.1.p1.5.m3.1.1.1.1.cmml" xref="A1.1.p1.5.m3.1.1.1.1">𝑤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.5.m3.2c">f_{b_{0},w}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.5.m3.2d">italic_f start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="p(b=b_{0}|a)^{w}:=f_{b_{0},w}(a)" class="ltx_Math" display="inline" id="A1.1.p1.6.m4.4"><semantics id="A1.1.p1.6.m4.4a"><mrow id="A1.1.p1.6.m4.4.4" xref="A1.1.p1.6.m4.4.4.cmml"><mrow id="A1.1.p1.6.m4.4.4.1" xref="A1.1.p1.6.m4.4.4.1.cmml"><mi id="A1.1.p1.6.m4.4.4.1.3" xref="A1.1.p1.6.m4.4.4.1.3.cmml">p</mi><mo id="A1.1.p1.6.m4.4.4.1.2" xref="A1.1.p1.6.m4.4.4.1.2.cmml">⁢</mo><msup id="A1.1.p1.6.m4.4.4.1.1" xref="A1.1.p1.6.m4.4.4.1.1.cmml"><mrow id="A1.1.p1.6.m4.4.4.1.1.1.1" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.cmml"><mo id="A1.1.p1.6.m4.4.4.1.1.1.1.2" stretchy="false" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.6.m4.4.4.1.1.1.1.1" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.cmml"><mi id="A1.1.p1.6.m4.4.4.1.1.1.1.1.2" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.2.cmml">b</mi><mo id="A1.1.p1.6.m4.4.4.1.1.1.1.1.1" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.1.cmml">=</mo><mrow id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.cmml"><msub id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.cmml"><mi id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.2" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.2.cmml">b</mi><mn id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.3" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.3.cmml">0</mn></msub><mo fence="false" id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.1" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.3" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.3.cmml">a</mi></mrow></mrow><mo id="A1.1.p1.6.m4.4.4.1.1.1.1.3" rspace="0.278em" stretchy="false" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.1.p1.6.m4.4.4.1.1.3" xref="A1.1.p1.6.m4.4.4.1.1.3.cmml">w</mi></msup></mrow><mo id="A1.1.p1.6.m4.4.4.2" rspace="0.278em" xref="A1.1.p1.6.m4.4.4.2.cmml">:=</mo><mrow id="A1.1.p1.6.m4.4.4.3" xref="A1.1.p1.6.m4.4.4.3.cmml"><msub id="A1.1.p1.6.m4.4.4.3.2" xref="A1.1.p1.6.m4.4.4.3.2.cmml"><mi id="A1.1.p1.6.m4.4.4.3.2.2" xref="A1.1.p1.6.m4.4.4.3.2.2.cmml">f</mi><mrow id="A1.1.p1.6.m4.2.2.2.2" xref="A1.1.p1.6.m4.2.2.2.3.cmml"><msub id="A1.1.p1.6.m4.2.2.2.2.1" xref="A1.1.p1.6.m4.2.2.2.2.1.cmml"><mi id="A1.1.p1.6.m4.2.2.2.2.1.2" xref="A1.1.p1.6.m4.2.2.2.2.1.2.cmml">b</mi><mn id="A1.1.p1.6.m4.2.2.2.2.1.3" xref="A1.1.p1.6.m4.2.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.1.p1.6.m4.2.2.2.2.2" xref="A1.1.p1.6.m4.2.2.2.3.cmml">,</mo><mi id="A1.1.p1.6.m4.1.1.1.1" xref="A1.1.p1.6.m4.1.1.1.1.cmml">w</mi></mrow></msub><mo id="A1.1.p1.6.m4.4.4.3.1" xref="A1.1.p1.6.m4.4.4.3.1.cmml">⁢</mo><mrow id="A1.1.p1.6.m4.4.4.3.3.2" xref="A1.1.p1.6.m4.4.4.3.cmml"><mo id="A1.1.p1.6.m4.4.4.3.3.2.1" stretchy="false" xref="A1.1.p1.6.m4.4.4.3.cmml">(</mo><mi id="A1.1.p1.6.m4.3.3" xref="A1.1.p1.6.m4.3.3.cmml">a</mi><mo id="A1.1.p1.6.m4.4.4.3.3.2.2" stretchy="false" xref="A1.1.p1.6.m4.4.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.6.m4.4b"><apply id="A1.1.p1.6.m4.4.4.cmml" xref="A1.1.p1.6.m4.4.4"><csymbol cd="latexml" id="A1.1.p1.6.m4.4.4.2.cmml" xref="A1.1.p1.6.m4.4.4.2">assign</csymbol><apply id="A1.1.p1.6.m4.4.4.1.cmml" xref="A1.1.p1.6.m4.4.4.1"><times id="A1.1.p1.6.m4.4.4.1.2.cmml" xref="A1.1.p1.6.m4.4.4.1.2"></times><ci id="A1.1.p1.6.m4.4.4.1.3.cmml" xref="A1.1.p1.6.m4.4.4.1.3">𝑝</ci><apply id="A1.1.p1.6.m4.4.4.1.1.cmml" xref="A1.1.p1.6.m4.4.4.1.1"><csymbol cd="ambiguous" id="A1.1.p1.6.m4.4.4.1.1.2.cmml" xref="A1.1.p1.6.m4.4.4.1.1">superscript</csymbol><apply id="A1.1.p1.6.m4.4.4.1.1.1.1.1.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1"><eq id="A1.1.p1.6.m4.4.4.1.1.1.1.1.1.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.1"></eq><ci id="A1.1.p1.6.m4.4.4.1.1.1.1.1.2.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.2">𝑏</ci><apply id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.1.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.1.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.2.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.2">𝑏</ci><cn id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.3.cmml" xref="A1.1.p1.6.m4.4.4.1.1.1.1.1.3.3">𝑎</ci></apply></apply><ci id="A1.1.p1.6.m4.4.4.1.1.3.cmml" xref="A1.1.p1.6.m4.4.4.1.1.3">𝑤</ci></apply></apply><apply id="A1.1.p1.6.m4.4.4.3.cmml" xref="A1.1.p1.6.m4.4.4.3"><times id="A1.1.p1.6.m4.4.4.3.1.cmml" xref="A1.1.p1.6.m4.4.4.3.1"></times><apply id="A1.1.p1.6.m4.4.4.3.2.cmml" xref="A1.1.p1.6.m4.4.4.3.2"><csymbol cd="ambiguous" id="A1.1.p1.6.m4.4.4.3.2.1.cmml" xref="A1.1.p1.6.m4.4.4.3.2">subscript</csymbol><ci id="A1.1.p1.6.m4.4.4.3.2.2.cmml" xref="A1.1.p1.6.m4.4.4.3.2.2">𝑓</ci><list id="A1.1.p1.6.m4.2.2.2.3.cmml" xref="A1.1.p1.6.m4.2.2.2.2"><apply id="A1.1.p1.6.m4.2.2.2.2.1.cmml" xref="A1.1.p1.6.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.1.p1.6.m4.2.2.2.2.1.1.cmml" xref="A1.1.p1.6.m4.2.2.2.2.1">subscript</csymbol><ci id="A1.1.p1.6.m4.2.2.2.2.1.2.cmml" xref="A1.1.p1.6.m4.2.2.2.2.1.2">𝑏</ci><cn id="A1.1.p1.6.m4.2.2.2.2.1.3.cmml" type="integer" xref="A1.1.p1.6.m4.2.2.2.2.1.3">0</cn></apply><ci id="A1.1.p1.6.m4.1.1.1.1.cmml" xref="A1.1.p1.6.m4.1.1.1.1">𝑤</ci></list></apply><ci id="A1.1.p1.6.m4.3.3.cmml" xref="A1.1.p1.6.m4.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.6.m4.4c">p(b=b_{0}|a)^{w}:=f_{b_{0},w}(a)</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.6.m4.4d">italic_p ( italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT := italic_f start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT ( italic_a )</annotation></semantics></math>.
Let</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Z_{b_{0},w}:=\int p(a|b=b_{0})f_{b_{0},w}(a)da" class="ltx_Math" display="block" id="A1.E3.m1.6"><semantics id="A1.E3.m1.6a"><mrow id="A1.E3.m1.6.6" xref="A1.E3.m1.6.6.cmml"><msub id="A1.E3.m1.6.6.3" xref="A1.E3.m1.6.6.3.cmml"><mi id="A1.E3.m1.6.6.3.2" xref="A1.E3.m1.6.6.3.2.cmml">Z</mi><mrow id="A1.E3.m1.2.2.2.2" xref="A1.E3.m1.2.2.2.3.cmml"><msub id="A1.E3.m1.2.2.2.2.1" xref="A1.E3.m1.2.2.2.2.1.cmml"><mi id="A1.E3.m1.2.2.2.2.1.2" xref="A1.E3.m1.2.2.2.2.1.2.cmml">b</mi><mn id="A1.E3.m1.2.2.2.2.1.3" xref="A1.E3.m1.2.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.E3.m1.2.2.2.2.2" xref="A1.E3.m1.2.2.2.3.cmml">,</mo><mi id="A1.E3.m1.1.1.1.1" xref="A1.E3.m1.1.1.1.1.cmml">w</mi></mrow></msub><mo id="A1.E3.m1.6.6.2" lspace="0.278em" rspace="0.111em" xref="A1.E3.m1.6.6.2.cmml">:=</mo><mrow id="A1.E3.m1.6.6.1" xref="A1.E3.m1.6.6.1.cmml"><mo id="A1.E3.m1.6.6.1.2" xref="A1.E3.m1.6.6.1.2.cmml">∫</mo><mrow id="A1.E3.m1.6.6.1.1" xref="A1.E3.m1.6.6.1.1.cmml"><mi id="A1.E3.m1.6.6.1.1.3" xref="A1.E3.m1.6.6.1.1.3.cmml">p</mi><mo id="A1.E3.m1.6.6.1.1.2" xref="A1.E3.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.E3.m1.6.6.1.1.1.1" xref="A1.E3.m1.6.6.1.1.1.1.1.cmml"><mo id="A1.E3.m1.6.6.1.1.1.1.2" stretchy="false" xref="A1.E3.m1.6.6.1.1.1.1.1.cmml">(</mo><mrow id="A1.E3.m1.6.6.1.1.1.1.1" xref="A1.E3.m1.6.6.1.1.1.1.1.cmml"><mrow id="A1.E3.m1.6.6.1.1.1.1.1.2" xref="A1.E3.m1.6.6.1.1.1.1.1.2.cmml"><mi id="A1.E3.m1.6.6.1.1.1.1.1.2.2" xref="A1.E3.m1.6.6.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.E3.m1.6.6.1.1.1.1.1.2.1" xref="A1.E3.m1.6.6.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.E3.m1.6.6.1.1.1.1.1.2.3" xref="A1.E3.m1.6.6.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.E3.m1.6.6.1.1.1.1.1.1" xref="A1.E3.m1.6.6.1.1.1.1.1.1.cmml">=</mo><msub id="A1.E3.m1.6.6.1.1.1.1.1.3" xref="A1.E3.m1.6.6.1.1.1.1.1.3.cmml"><mi id="A1.E3.m1.6.6.1.1.1.1.1.3.2" xref="A1.E3.m1.6.6.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.E3.m1.6.6.1.1.1.1.1.3.3" xref="A1.E3.m1.6.6.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E3.m1.6.6.1.1.1.1.3" stretchy="false" xref="A1.E3.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E3.m1.6.6.1.1.2a" xref="A1.E3.m1.6.6.1.1.2.cmml">⁢</mo><msub id="A1.E3.m1.6.6.1.1.4" xref="A1.E3.m1.6.6.1.1.4.cmml"><mi id="A1.E3.m1.6.6.1.1.4.2" xref="A1.E3.m1.6.6.1.1.4.2.cmml">f</mi><mrow id="A1.E3.m1.4.4.2.2" xref="A1.E3.m1.4.4.2.3.cmml"><msub id="A1.E3.m1.4.4.2.2.1" xref="A1.E3.m1.4.4.2.2.1.cmml"><mi id="A1.E3.m1.4.4.2.2.1.2" xref="A1.E3.m1.4.4.2.2.1.2.cmml">b</mi><mn id="A1.E3.m1.4.4.2.2.1.3" xref="A1.E3.m1.4.4.2.2.1.3.cmml">0</mn></msub><mo id="A1.E3.m1.4.4.2.2.2" xref="A1.E3.m1.4.4.2.3.cmml">,</mo><mi id="A1.E3.m1.3.3.1.1" xref="A1.E3.m1.3.3.1.1.cmml">w</mi></mrow></msub><mo id="A1.E3.m1.6.6.1.1.2b" xref="A1.E3.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.E3.m1.6.6.1.1.5.2" xref="A1.E3.m1.6.6.1.1.cmml"><mo id="A1.E3.m1.6.6.1.1.5.2.1" stretchy="false" xref="A1.E3.m1.6.6.1.1.cmml">(</mo><mi id="A1.E3.m1.5.5" xref="A1.E3.m1.5.5.cmml">a</mi><mo id="A1.E3.m1.6.6.1.1.5.2.2" stretchy="false" xref="A1.E3.m1.6.6.1.1.cmml">)</mo></mrow><mo id="A1.E3.m1.6.6.1.1.2c" lspace="0em" xref="A1.E3.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.E3.m1.6.6.1.1.6" xref="A1.E3.m1.6.6.1.1.6.cmml"><mo id="A1.E3.m1.6.6.1.1.6.1" rspace="0em" xref="A1.E3.m1.6.6.1.1.6.1.cmml">𝑑</mo><mi id="A1.E3.m1.6.6.1.1.6.2" xref="A1.E3.m1.6.6.1.1.6.2.cmml">a</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E3.m1.6b"><apply id="A1.E3.m1.6.6.cmml" xref="A1.E3.m1.6.6"><csymbol cd="latexml" id="A1.E3.m1.6.6.2.cmml" xref="A1.E3.m1.6.6.2">assign</csymbol><apply id="A1.E3.m1.6.6.3.cmml" xref="A1.E3.m1.6.6.3"><csymbol cd="ambiguous" id="A1.E3.m1.6.6.3.1.cmml" xref="A1.E3.m1.6.6.3">subscript</csymbol><ci id="A1.E3.m1.6.6.3.2.cmml" xref="A1.E3.m1.6.6.3.2">𝑍</ci><list id="A1.E3.m1.2.2.2.3.cmml" xref="A1.E3.m1.2.2.2.2"><apply id="A1.E3.m1.2.2.2.2.1.cmml" xref="A1.E3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E3.m1.2.2.2.2.1.1.cmml" xref="A1.E3.m1.2.2.2.2.1">subscript</csymbol><ci id="A1.E3.m1.2.2.2.2.1.2.cmml" xref="A1.E3.m1.2.2.2.2.1.2">𝑏</ci><cn id="A1.E3.m1.2.2.2.2.1.3.cmml" type="integer" xref="A1.E3.m1.2.2.2.2.1.3">0</cn></apply><ci id="A1.E3.m1.1.1.1.1.cmml" xref="A1.E3.m1.1.1.1.1">𝑤</ci></list></apply><apply id="A1.E3.m1.6.6.1.cmml" xref="A1.E3.m1.6.6.1"><int id="A1.E3.m1.6.6.1.2.cmml" xref="A1.E3.m1.6.6.1.2"></int><apply id="A1.E3.m1.6.6.1.1.cmml" xref="A1.E3.m1.6.6.1.1"><times id="A1.E3.m1.6.6.1.1.2.cmml" xref="A1.E3.m1.6.6.1.1.2"></times><ci id="A1.E3.m1.6.6.1.1.3.cmml" xref="A1.E3.m1.6.6.1.1.3">𝑝</ci><apply id="A1.E3.m1.6.6.1.1.1.1.1.cmml" xref="A1.E3.m1.6.6.1.1.1.1"><eq id="A1.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.1"></eq><apply id="A1.E3.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.E3.m1.6.6.1.1.1.1.1.2.1.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E3.m1.6.6.1.1.1.1.1.2.2.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.E3.m1.6.6.1.1.1.1.1.2.3.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.E3.m1.6.6.1.1.1.1.1.3.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E3.m1.6.6.1.1.1.1.1.3.1.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E3.m1.6.6.1.1.1.1.1.3.2.cmml" xref="A1.E3.m1.6.6.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.E3.m1.6.6.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E3.m1.6.6.1.1.1.1.1.3.3">0</cn></apply></apply><apply id="A1.E3.m1.6.6.1.1.4.cmml" xref="A1.E3.m1.6.6.1.1.4"><csymbol cd="ambiguous" id="A1.E3.m1.6.6.1.1.4.1.cmml" xref="A1.E3.m1.6.6.1.1.4">subscript</csymbol><ci id="A1.E3.m1.6.6.1.1.4.2.cmml" xref="A1.E3.m1.6.6.1.1.4.2">𝑓</ci><list id="A1.E3.m1.4.4.2.3.cmml" xref="A1.E3.m1.4.4.2.2"><apply id="A1.E3.m1.4.4.2.2.1.cmml" xref="A1.E3.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.E3.m1.4.4.2.2.1.1.cmml" xref="A1.E3.m1.4.4.2.2.1">subscript</csymbol><ci id="A1.E3.m1.4.4.2.2.1.2.cmml" xref="A1.E3.m1.4.4.2.2.1.2">𝑏</ci><cn id="A1.E3.m1.4.4.2.2.1.3.cmml" type="integer" xref="A1.E3.m1.4.4.2.2.1.3">0</cn></apply><ci id="A1.E3.m1.3.3.1.1.cmml" xref="A1.E3.m1.3.3.1.1">𝑤</ci></list></apply><ci id="A1.E3.m1.5.5.cmml" xref="A1.E3.m1.5.5">𝑎</ci><apply id="A1.E3.m1.6.6.1.1.6.cmml" xref="A1.E3.m1.6.6.1.1.6"><csymbol cd="latexml" id="A1.E3.m1.6.6.1.1.6.1.cmml" xref="A1.E3.m1.6.6.1.1.6.1">differential-d</csymbol><ci id="A1.E3.m1.6.6.1.1.6.2.cmml" xref="A1.E3.m1.6.6.1.1.6.2">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E3.m1.6c">Z_{b_{0},w}:=\int p(a|b=b_{0})f_{b_{0},w}(a)da</annotation><annotation encoding="application/x-llamapun" id="A1.E3.m1.6d">italic_Z start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT := ∫ italic_p ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) italic_f start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT ( italic_a ) italic_d italic_a</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.1.p1.12">Then,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{p(a|b=b_{0})\cdot p(b=b_{0}|a)^{w}}{Z_{b_{0},w}}=\frac{p(a|b=b_{0})\cdot
f%
_{b_{0},w}(a)}{Z_{b_{0},w}}" class="ltx_Math" display="block" id="A1.E4.m1.10"><semantics id="A1.E4.m1.10a"><mrow id="A1.E4.m1.10.11" xref="A1.E4.m1.10.11.cmml"><mfrac id="A1.E4.m1.4.4" xref="A1.E4.m1.4.4.cmml"><mrow id="A1.E4.m1.2.2.2" xref="A1.E4.m1.2.2.2.cmml"><mrow id="A1.E4.m1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.cmml"><mrow id="A1.E4.m1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.3.cmml">p</mi><mo id="A1.E4.m1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E4.m1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E4.m1.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.E4.m1.1.1.1.1.1.1.1.1.2.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.E4.m1.1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="A1.E4.m1.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E4.m1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.1.1.1.1.2" rspace="0.222em" xref="A1.E4.m1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E4.m1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.3.cmml">p</mi></mrow><mo id="A1.E4.m1.2.2.2.3" xref="A1.E4.m1.2.2.2.3.cmml">⁢</mo><msup id="A1.E4.m1.2.2.2.2" xref="A1.E4.m1.2.2.2.2.cmml"><mrow id="A1.E4.m1.2.2.2.2.1.1" xref="A1.E4.m1.2.2.2.2.1.1.1.cmml"><mo id="A1.E4.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E4.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E4.m1.2.2.2.2.1.1.1" xref="A1.E4.m1.2.2.2.2.1.1.1.cmml"><mi id="A1.E4.m1.2.2.2.2.1.1.1.2" xref="A1.E4.m1.2.2.2.2.1.1.1.2.cmml">b</mi><mo id="A1.E4.m1.2.2.2.2.1.1.1.1" xref="A1.E4.m1.2.2.2.2.1.1.1.1.cmml">=</mo><mrow id="A1.E4.m1.2.2.2.2.1.1.1.3" xref="A1.E4.m1.2.2.2.2.1.1.1.3.cmml"><msub id="A1.E4.m1.2.2.2.2.1.1.1.3.2" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2.cmml"><mi id="A1.E4.m1.2.2.2.2.1.1.1.3.2.2" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2.2.cmml">b</mi><mn id="A1.E4.m1.2.2.2.2.1.1.1.3.2.3" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2.3.cmml">0</mn></msub><mo fence="false" id="A1.E4.m1.2.2.2.2.1.1.1.3.1" xref="A1.E4.m1.2.2.2.2.1.1.1.3.1.cmml">|</mo><mi id="A1.E4.m1.2.2.2.2.1.1.1.3.3" xref="A1.E4.m1.2.2.2.2.1.1.1.3.3.cmml">a</mi></mrow></mrow><mo id="A1.E4.m1.2.2.2.2.1.1.3" stretchy="false" xref="A1.E4.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="A1.E4.m1.2.2.2.2.3" xref="A1.E4.m1.2.2.2.2.3.cmml">w</mi></msup></mrow><msub id="A1.E4.m1.4.4.4" xref="A1.E4.m1.4.4.4.cmml"><mi id="A1.E4.m1.4.4.4.4" xref="A1.E4.m1.4.4.4.4.cmml">Z</mi><mrow id="A1.E4.m1.4.4.4.2.2.2" xref="A1.E4.m1.4.4.4.2.2.3.cmml"><msub id="A1.E4.m1.4.4.4.2.2.2.1" xref="A1.E4.m1.4.4.4.2.2.2.1.cmml"><mi id="A1.E4.m1.4.4.4.2.2.2.1.2" xref="A1.E4.m1.4.4.4.2.2.2.1.2.cmml">b</mi><mn id="A1.E4.m1.4.4.4.2.2.2.1.3" xref="A1.E4.m1.4.4.4.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.E4.m1.4.4.4.2.2.2.2" xref="A1.E4.m1.4.4.4.2.2.3.cmml">,</mo><mi id="A1.E4.m1.3.3.3.1.1.1" xref="A1.E4.m1.3.3.3.1.1.1.cmml">w</mi></mrow></msub></mfrac><mo id="A1.E4.m1.10.11.1" xref="A1.E4.m1.10.11.1.cmml">=</mo><mfrac id="A1.E4.m1.10.10" xref="A1.E4.m1.10.10.cmml"><mrow id="A1.E4.m1.8.8.4" xref="A1.E4.m1.8.8.4.cmml"><mrow id="A1.E4.m1.8.8.4.4" xref="A1.E4.m1.8.8.4.4.cmml"><mrow id="A1.E4.m1.8.8.4.4.1" xref="A1.E4.m1.8.8.4.4.1.cmml"><mi id="A1.E4.m1.8.8.4.4.1.3" xref="A1.E4.m1.8.8.4.4.1.3.cmml">p</mi><mo id="A1.E4.m1.8.8.4.4.1.2" xref="A1.E4.m1.8.8.4.4.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.8.8.4.4.1.1.1" xref="A1.E4.m1.8.8.4.4.1.1.1.1.cmml"><mo id="A1.E4.m1.8.8.4.4.1.1.1.2" stretchy="false" xref="A1.E4.m1.8.8.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.E4.m1.8.8.4.4.1.1.1.1" xref="A1.E4.m1.8.8.4.4.1.1.1.1.cmml"><mrow id="A1.E4.m1.8.8.4.4.1.1.1.1.2" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.cmml"><mi id="A1.E4.m1.8.8.4.4.1.1.1.1.2.2" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.E4.m1.8.8.4.4.1.1.1.1.2.1" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.1.cmml">|</mo><mi id="A1.E4.m1.8.8.4.4.1.1.1.1.2.3" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.E4.m1.8.8.4.4.1.1.1.1.1" xref="A1.E4.m1.8.8.4.4.1.1.1.1.1.cmml">=</mo><msub id="A1.E4.m1.8.8.4.4.1.1.1.1.3" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3.cmml"><mi id="A1.E4.m1.8.8.4.4.1.1.1.1.3.2" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3.2.cmml">b</mi><mn id="A1.E4.m1.8.8.4.4.1.1.1.1.3.3" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E4.m1.8.8.4.4.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E4.m1.8.8.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.8.8.4.4.2" rspace="0.222em" xref="A1.E4.m1.8.8.4.4.2.cmml">⋅</mo><msub id="A1.E4.m1.8.8.4.4.3" xref="A1.E4.m1.8.8.4.4.3.cmml"><mi id="A1.E4.m1.8.8.4.4.3.2" xref="A1.E4.m1.8.8.4.4.3.2.cmml">f</mi><mrow id="A1.E4.m1.6.6.2.2.2.2" xref="A1.E4.m1.6.6.2.2.2.3.cmml"><msub id="A1.E4.m1.6.6.2.2.2.2.1" xref="A1.E4.m1.6.6.2.2.2.2.1.cmml"><mi id="A1.E4.m1.6.6.2.2.2.2.1.2" xref="A1.E4.m1.6.6.2.2.2.2.1.2.cmml">b</mi><mn id="A1.E4.m1.6.6.2.2.2.2.1.3" xref="A1.E4.m1.6.6.2.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.E4.m1.6.6.2.2.2.2.2" xref="A1.E4.m1.6.6.2.2.2.3.cmml">,</mo><mi id="A1.E4.m1.5.5.1.1.1.1" xref="A1.E4.m1.5.5.1.1.1.1.cmml">w</mi></mrow></msub></mrow><mo id="A1.E4.m1.8.8.4.5" xref="A1.E4.m1.8.8.4.5.cmml">⁢</mo><mrow id="A1.E4.m1.8.8.4.6.2" xref="A1.E4.m1.8.8.4.cmml"><mo id="A1.E4.m1.8.8.4.6.2.1" stretchy="false" xref="A1.E4.m1.8.8.4.cmml">(</mo><mi id="A1.E4.m1.7.7.3.3" xref="A1.E4.m1.7.7.3.3.cmml">a</mi><mo id="A1.E4.m1.8.8.4.6.2.2" stretchy="false" xref="A1.E4.m1.8.8.4.cmml">)</mo></mrow></mrow><msub id="A1.E4.m1.10.10.6" xref="A1.E4.m1.10.10.6.cmml"><mi id="A1.E4.m1.10.10.6.4" xref="A1.E4.m1.10.10.6.4.cmml">Z</mi><mrow id="A1.E4.m1.10.10.6.2.2.2" xref="A1.E4.m1.10.10.6.2.2.3.cmml"><msub id="A1.E4.m1.10.10.6.2.2.2.1" xref="A1.E4.m1.10.10.6.2.2.2.1.cmml"><mi id="A1.E4.m1.10.10.6.2.2.2.1.2" xref="A1.E4.m1.10.10.6.2.2.2.1.2.cmml">b</mi><mn id="A1.E4.m1.10.10.6.2.2.2.1.3" xref="A1.E4.m1.10.10.6.2.2.2.1.3.cmml">0</mn></msub><mo id="A1.E4.m1.10.10.6.2.2.2.2" xref="A1.E4.m1.10.10.6.2.2.3.cmml">,</mo><mi id="A1.E4.m1.9.9.5.1.1.1" xref="A1.E4.m1.9.9.5.1.1.1.cmml">w</mi></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E4.m1.10b"><apply id="A1.E4.m1.10.11.cmml" xref="A1.E4.m1.10.11"><eq id="A1.E4.m1.10.11.1.cmml" xref="A1.E4.m1.10.11.1"></eq><apply id="A1.E4.m1.4.4.cmml" xref="A1.E4.m1.4.4"><divide id="A1.E4.m1.4.4.5.cmml" xref="A1.E4.m1.4.4"></divide><apply id="A1.E4.m1.2.2.2.cmml" xref="A1.E4.m1.2.2.2"><times id="A1.E4.m1.2.2.2.3.cmml" xref="A1.E4.m1.2.2.2.3"></times><apply id="A1.E4.m1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1"><ci id="A1.E4.m1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.2">⋅</ci><apply id="A1.E4.m1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1"><times id="A1.E4.m1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.2"></times><ci id="A1.E4.m1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.3">𝑝</ci><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1"><eq id="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E4.m1.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><ci id="A1.E4.m1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.3">𝑝</ci></apply><apply id="A1.E4.m1.2.2.2.2.cmml" xref="A1.E4.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E4.m1.2.2.2.2.2.cmml" xref="A1.E4.m1.2.2.2.2">superscript</csymbol><apply id="A1.E4.m1.2.2.2.2.1.1.1.cmml" xref="A1.E4.m1.2.2.2.2.1.1"><eq id="A1.E4.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.1"></eq><ci id="A1.E4.m1.2.2.2.2.1.1.1.2.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.2">𝑏</ci><apply id="A1.E4.m1.2.2.2.2.1.1.1.3.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3"><csymbol cd="latexml" id="A1.E4.m1.2.2.2.2.1.1.1.3.1.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3.1">conditional</csymbol><apply id="A1.E4.m1.2.2.2.2.1.1.1.3.2.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E4.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="A1.E4.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2.2">𝑏</ci><cn id="A1.E4.m1.2.2.2.2.1.1.1.3.2.3.cmml" type="integer" xref="A1.E4.m1.2.2.2.2.1.1.1.3.2.3">0</cn></apply><ci id="A1.E4.m1.2.2.2.2.1.1.1.3.3.cmml" xref="A1.E4.m1.2.2.2.2.1.1.1.3.3">𝑎</ci></apply></apply><ci id="A1.E4.m1.2.2.2.2.3.cmml" xref="A1.E4.m1.2.2.2.2.3">𝑤</ci></apply></apply><apply id="A1.E4.m1.4.4.4.cmml" xref="A1.E4.m1.4.4.4"><csymbol cd="ambiguous" id="A1.E4.m1.4.4.4.3.cmml" xref="A1.E4.m1.4.4.4">subscript</csymbol><ci id="A1.E4.m1.4.4.4.4.cmml" xref="A1.E4.m1.4.4.4.4">𝑍</ci><list id="A1.E4.m1.4.4.4.2.2.3.cmml" xref="A1.E4.m1.4.4.4.2.2.2"><apply id="A1.E4.m1.4.4.4.2.2.2.1.cmml" xref="A1.E4.m1.4.4.4.2.2.2.1"><csymbol cd="ambiguous" id="A1.E4.m1.4.4.4.2.2.2.1.1.cmml" xref="A1.E4.m1.4.4.4.2.2.2.1">subscript</csymbol><ci id="A1.E4.m1.4.4.4.2.2.2.1.2.cmml" xref="A1.E4.m1.4.4.4.2.2.2.1.2">𝑏</ci><cn id="A1.E4.m1.4.4.4.2.2.2.1.3.cmml" type="integer" xref="A1.E4.m1.4.4.4.2.2.2.1.3">0</cn></apply><ci id="A1.E4.m1.3.3.3.1.1.1.cmml" xref="A1.E4.m1.3.3.3.1.1.1">𝑤</ci></list></apply></apply><apply id="A1.E4.m1.10.10.cmml" xref="A1.E4.m1.10.10"><divide id="A1.E4.m1.10.10.7.cmml" xref="A1.E4.m1.10.10"></divide><apply id="A1.E4.m1.8.8.4.cmml" xref="A1.E4.m1.8.8.4"><times id="A1.E4.m1.8.8.4.5.cmml" xref="A1.E4.m1.8.8.4.5"></times><apply id="A1.E4.m1.8.8.4.4.cmml" xref="A1.E4.m1.8.8.4.4"><ci id="A1.E4.m1.8.8.4.4.2.cmml" xref="A1.E4.m1.8.8.4.4.2">⋅</ci><apply id="A1.E4.m1.8.8.4.4.1.cmml" xref="A1.E4.m1.8.8.4.4.1"><times id="A1.E4.m1.8.8.4.4.1.2.cmml" xref="A1.E4.m1.8.8.4.4.1.2"></times><ci id="A1.E4.m1.8.8.4.4.1.3.cmml" xref="A1.E4.m1.8.8.4.4.1.3">𝑝</ci><apply id="A1.E4.m1.8.8.4.4.1.1.1.1.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1"><eq id="A1.E4.m1.8.8.4.4.1.1.1.1.1.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.1"></eq><apply id="A1.E4.m1.8.8.4.4.1.1.1.1.2.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2"><csymbol cd="latexml" id="A1.E4.m1.8.8.4.4.1.1.1.1.2.1.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E4.m1.8.8.4.4.1.1.1.1.2.2.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.2">𝑎</ci><ci id="A1.E4.m1.8.8.4.4.1.1.1.1.2.3.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.E4.m1.8.8.4.4.1.1.1.1.3.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E4.m1.8.8.4.4.1.1.1.1.3.1.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3">subscript</csymbol><ci id="A1.E4.m1.8.8.4.4.1.1.1.1.3.2.cmml" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3.2">𝑏</ci><cn id="A1.E4.m1.8.8.4.4.1.1.1.1.3.3.cmml" type="integer" xref="A1.E4.m1.8.8.4.4.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="A1.E4.m1.8.8.4.4.3.cmml" xref="A1.E4.m1.8.8.4.4.3"><csymbol cd="ambiguous" id="A1.E4.m1.8.8.4.4.3.1.cmml" xref="A1.E4.m1.8.8.4.4.3">subscript</csymbol><ci id="A1.E4.m1.8.8.4.4.3.2.cmml" xref="A1.E4.m1.8.8.4.4.3.2">𝑓</ci><list id="A1.E4.m1.6.6.2.2.2.3.cmml" xref="A1.E4.m1.6.6.2.2.2.2"><apply id="A1.E4.m1.6.6.2.2.2.2.1.cmml" xref="A1.E4.m1.6.6.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E4.m1.6.6.2.2.2.2.1.1.cmml" xref="A1.E4.m1.6.6.2.2.2.2.1">subscript</csymbol><ci id="A1.E4.m1.6.6.2.2.2.2.1.2.cmml" xref="A1.E4.m1.6.6.2.2.2.2.1.2">𝑏</ci><cn id="A1.E4.m1.6.6.2.2.2.2.1.3.cmml" type="integer" xref="A1.E4.m1.6.6.2.2.2.2.1.3">0</cn></apply><ci id="A1.E4.m1.5.5.1.1.1.1.cmml" xref="A1.E4.m1.5.5.1.1.1.1">𝑤</ci></list></apply></apply><ci id="A1.E4.m1.7.7.3.3.cmml" xref="A1.E4.m1.7.7.3.3">𝑎</ci></apply><apply id="A1.E4.m1.10.10.6.cmml" xref="A1.E4.m1.10.10.6"><csymbol cd="ambiguous" id="A1.E4.m1.10.10.6.3.cmml" xref="A1.E4.m1.10.10.6">subscript</csymbol><ci id="A1.E4.m1.10.10.6.4.cmml" xref="A1.E4.m1.10.10.6.4">𝑍</ci><list id="A1.E4.m1.10.10.6.2.2.3.cmml" xref="A1.E4.m1.10.10.6.2.2.2"><apply id="A1.E4.m1.10.10.6.2.2.2.1.cmml" xref="A1.E4.m1.10.10.6.2.2.2.1"><csymbol cd="ambiguous" id="A1.E4.m1.10.10.6.2.2.2.1.1.cmml" xref="A1.E4.m1.10.10.6.2.2.2.1">subscript</csymbol><ci id="A1.E4.m1.10.10.6.2.2.2.1.2.cmml" xref="A1.E4.m1.10.10.6.2.2.2.1.2">𝑏</ci><cn id="A1.E4.m1.10.10.6.2.2.2.1.3.cmml" type="integer" xref="A1.E4.m1.10.10.6.2.2.2.1.3">0</cn></apply><ci id="A1.E4.m1.9.9.5.1.1.1.cmml" xref="A1.E4.m1.9.9.5.1.1.1">𝑤</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m1.10c">\frac{p(a|b=b_{0})\cdot p(b=b_{0}|a)^{w}}{Z_{b_{0},w}}=\frac{p(a|b=b_{0})\cdot
f%
_{b_{0},w}(a)}{Z_{b_{0},w}}</annotation><annotation encoding="application/x-llamapun" id="A1.E4.m1.10d">divide start_ARG italic_p ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ⋅ italic_p ( italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT end_ARG start_ARG italic_Z start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT end_ARG = divide start_ARG italic_p ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ⋅ italic_f start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT ( italic_a ) end_ARG start_ARG italic_Z start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_w end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.1.p1.11">is a proper probability density function of <math alttext="a" class="ltx_Math" display="inline" id="A1.1.p1.7.m1.1"><semantics id="A1.1.p1.7.m1.1a"><mi id="A1.1.p1.7.m1.1.1" xref="A1.1.p1.7.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.1.p1.7.m1.1b"><ci id="A1.1.p1.7.m1.1.1.cmml" xref="A1.1.p1.7.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.7.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.7.m1.1d">italic_a</annotation></semantics></math> with <math alttext="b=b_{0}" class="ltx_Math" display="inline" id="A1.1.p1.8.m2.1"><semantics id="A1.1.p1.8.m2.1a"><mrow id="A1.1.p1.8.m2.1.1" xref="A1.1.p1.8.m2.1.1.cmml"><mi id="A1.1.p1.8.m2.1.1.2" xref="A1.1.p1.8.m2.1.1.2.cmml">b</mi><mo id="A1.1.p1.8.m2.1.1.1" xref="A1.1.p1.8.m2.1.1.1.cmml">=</mo><msub id="A1.1.p1.8.m2.1.1.3" xref="A1.1.p1.8.m2.1.1.3.cmml"><mi id="A1.1.p1.8.m2.1.1.3.2" xref="A1.1.p1.8.m2.1.1.3.2.cmml">b</mi><mn id="A1.1.p1.8.m2.1.1.3.3" xref="A1.1.p1.8.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.8.m2.1b"><apply id="A1.1.p1.8.m2.1.1.cmml" xref="A1.1.p1.8.m2.1.1"><eq id="A1.1.p1.8.m2.1.1.1.cmml" xref="A1.1.p1.8.m2.1.1.1"></eq><ci id="A1.1.p1.8.m2.1.1.2.cmml" xref="A1.1.p1.8.m2.1.1.2">𝑏</ci><apply id="A1.1.p1.8.m2.1.1.3.cmml" xref="A1.1.p1.8.m2.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.8.m2.1.1.3.1.cmml" xref="A1.1.p1.8.m2.1.1.3">subscript</csymbol><ci id="A1.1.p1.8.m2.1.1.3.2.cmml" xref="A1.1.p1.8.m2.1.1.3.2">𝑏</ci><cn id="A1.1.p1.8.m2.1.1.3.3.cmml" type="integer" xref="A1.1.p1.8.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.8.m2.1c">b=b_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.8.m2.1d">italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> given.
Therefore, Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A1.E4" title='Equation A.4 ‣ Proof. ‣ Appendix A Appendix A ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">A.4</span></a>) can be written as <math alttext="\tilde{p}(a|b=b_{0})" class="ltx_Math" display="inline" id="A1.1.p1.9.m3.1"><semantics id="A1.1.p1.9.m3.1a"><mrow id="A1.1.p1.9.m3.1.1" xref="A1.1.p1.9.m3.1.1.cmml"><mover accent="true" id="A1.1.p1.9.m3.1.1.3" xref="A1.1.p1.9.m3.1.1.3.cmml"><mi id="A1.1.p1.9.m3.1.1.3.2" xref="A1.1.p1.9.m3.1.1.3.2.cmml">p</mi><mo id="A1.1.p1.9.m3.1.1.3.1" xref="A1.1.p1.9.m3.1.1.3.1.cmml">~</mo></mover><mo id="A1.1.p1.9.m3.1.1.2" xref="A1.1.p1.9.m3.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.9.m3.1.1.1.1" xref="A1.1.p1.9.m3.1.1.1.1.1.cmml"><mo id="A1.1.p1.9.m3.1.1.1.1.2" stretchy="false" xref="A1.1.p1.9.m3.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.9.m3.1.1.1.1.1" xref="A1.1.p1.9.m3.1.1.1.1.1.cmml"><mrow id="A1.1.p1.9.m3.1.1.1.1.1.2" xref="A1.1.p1.9.m3.1.1.1.1.1.2.cmml"><mi id="A1.1.p1.9.m3.1.1.1.1.1.2.2" xref="A1.1.p1.9.m3.1.1.1.1.1.2.2.cmml">a</mi><mo fence="false" id="A1.1.p1.9.m3.1.1.1.1.1.2.1" xref="A1.1.p1.9.m3.1.1.1.1.1.2.1.cmml">|</mo><mi id="A1.1.p1.9.m3.1.1.1.1.1.2.3" xref="A1.1.p1.9.m3.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="A1.1.p1.9.m3.1.1.1.1.1.1" xref="A1.1.p1.9.m3.1.1.1.1.1.1.cmml">=</mo><msub id="A1.1.p1.9.m3.1.1.1.1.1.3" xref="A1.1.p1.9.m3.1.1.1.1.1.3.cmml"><mi id="A1.1.p1.9.m3.1.1.1.1.1.3.2" xref="A1.1.p1.9.m3.1.1.1.1.1.3.2.cmml">b</mi><mn id="A1.1.p1.9.m3.1.1.1.1.1.3.3" xref="A1.1.p1.9.m3.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.1.p1.9.m3.1.1.1.1.3" stretchy="false" xref="A1.1.p1.9.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.9.m3.1b"><apply id="A1.1.p1.9.m3.1.1.cmml" xref="A1.1.p1.9.m3.1.1"><times id="A1.1.p1.9.m3.1.1.2.cmml" xref="A1.1.p1.9.m3.1.1.2"></times><apply id="A1.1.p1.9.m3.1.1.3.cmml" xref="A1.1.p1.9.m3.1.1.3"><ci id="A1.1.p1.9.m3.1.1.3.1.cmml" xref="A1.1.p1.9.m3.1.1.3.1">~</ci><ci id="A1.1.p1.9.m3.1.1.3.2.cmml" xref="A1.1.p1.9.m3.1.1.3.2">𝑝</ci></apply><apply id="A1.1.p1.9.m3.1.1.1.1.1.cmml" xref="A1.1.p1.9.m3.1.1.1.1"><eq id="A1.1.p1.9.m3.1.1.1.1.1.1.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.1"></eq><apply id="A1.1.p1.9.m3.1.1.1.1.1.2.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.1.p1.9.m3.1.1.1.1.1.2.1.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.1.p1.9.m3.1.1.1.1.1.2.2.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.2.2">𝑎</ci><ci id="A1.1.p1.9.m3.1.1.1.1.1.2.3.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="A1.1.p1.9.m3.1.1.1.1.1.3.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.1.p1.9.m3.1.1.1.1.1.3.1.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.3">subscript</csymbol><ci id="A1.1.p1.9.m3.1.1.1.1.1.3.2.cmml" xref="A1.1.p1.9.m3.1.1.1.1.1.3.2">𝑏</ci><cn id="A1.1.p1.9.m3.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.1.p1.9.m3.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.9.m3.1c">\tilde{p}(a|b=b_{0})</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.9.m3.1d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. The above proof holds true for any <math alttext="b_{0}" class="ltx_Math" display="inline" id="A1.1.p1.10.m4.1"><semantics id="A1.1.p1.10.m4.1a"><msub id="A1.1.p1.10.m4.1.1" xref="A1.1.p1.10.m4.1.1.cmml"><mi id="A1.1.p1.10.m4.1.1.2" xref="A1.1.p1.10.m4.1.1.2.cmml">b</mi><mn id="A1.1.p1.10.m4.1.1.3" xref="A1.1.p1.10.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.1.p1.10.m4.1b"><apply id="A1.1.p1.10.m4.1.1.cmml" xref="A1.1.p1.10.m4.1.1"><csymbol cd="ambiguous" id="A1.1.p1.10.m4.1.1.1.cmml" xref="A1.1.p1.10.m4.1.1">subscript</csymbol><ci id="A1.1.p1.10.m4.1.1.2.cmml" xref="A1.1.p1.10.m4.1.1.2">𝑏</ci><cn id="A1.1.p1.10.m4.1.1.3.cmml" type="integer" xref="A1.1.p1.10.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.10.m4.1c">b_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.10.m4.1d">italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, which concludes the proof for <math alttext="\tilde{p}(a|b)\propto p(a|b)\cdot p(b|a)^{w},w&gt;0" class="ltx_Math" display="inline" id="A1.1.p1.11.m5.2"><semantics id="A1.1.p1.11.m5.2a"><mrow id="A1.1.p1.11.m5.2.2.2" xref="A1.1.p1.11.m5.2.2.3.cmml"><mrow id="A1.1.p1.11.m5.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.cmml"><mrow id="A1.1.p1.11.m5.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.1.cmml"><mover accent="true" id="A1.1.p1.11.m5.1.1.1.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.1.3.cmml"><mi id="A1.1.p1.11.m5.1.1.1.1.1.3.2" xref="A1.1.p1.11.m5.1.1.1.1.1.3.2.cmml">p</mi><mo id="A1.1.p1.11.m5.1.1.1.1.1.3.1" xref="A1.1.p1.11.m5.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="A1.1.p1.11.m5.1.1.1.1.1.2" xref="A1.1.p1.11.m5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.cmml"><mo id="A1.1.p1.11.m5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.cmml"><mi id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.2" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.4" xref="A1.1.p1.11.m5.1.1.1.1.4.cmml">∝</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.3.cmml"><mrow id="A1.1.p1.11.m5.1.1.1.1.2.1" xref="A1.1.p1.11.m5.1.1.1.1.2.1.cmml"><mrow id="A1.1.p1.11.m5.1.1.1.1.2.1.1" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.cmml"><mi id="A1.1.p1.11.m5.1.1.1.1.2.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.3.cmml">p</mi><mo id="A1.1.p1.11.m5.1.1.1.1.2.1.1.2" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.cmml"><mo id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.2" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.2.1.2" rspace="0.222em" xref="A1.1.p1.11.m5.1.1.1.1.2.1.2.cmml">⋅</mo><mi id="A1.1.p1.11.m5.1.1.1.1.2.1.3" xref="A1.1.p1.11.m5.1.1.1.1.2.1.3.cmml">p</mi></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.3.3" xref="A1.1.p1.11.m5.1.1.1.1.3.3.cmml">⁢</mo><msup id="A1.1.p1.11.m5.1.1.1.1.3.2" xref="A1.1.p1.11.m5.1.1.1.1.3.2.cmml"><mrow id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.cmml"><mo id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.2" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.cmml">(</mo><mrow id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.cmml"><mi id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.2" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.2.cmml">b</mi><mo fence="false" id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.1" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.1.cmml">|</mo><mi id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.3" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.3.cmml">a</mi></mrow><mo id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.3" stretchy="false" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.cmml">)</mo></mrow><mi id="A1.1.p1.11.m5.1.1.1.1.3.2.3" xref="A1.1.p1.11.m5.1.1.1.1.3.2.3.cmml">w</mi></msup></mrow></mrow><mo id="A1.1.p1.11.m5.2.2.2.3" xref="A1.1.p1.11.m5.2.2.3a.cmml">,</mo><mrow id="A1.1.p1.11.m5.2.2.2.2" xref="A1.1.p1.11.m5.2.2.2.2.cmml"><mi id="A1.1.p1.11.m5.2.2.2.2.2" xref="A1.1.p1.11.m5.2.2.2.2.2.cmml">w</mi><mo id="A1.1.p1.11.m5.2.2.2.2.1" xref="A1.1.p1.11.m5.2.2.2.2.1.cmml">&gt;</mo><mn id="A1.1.p1.11.m5.2.2.2.2.3" xref="A1.1.p1.11.m5.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.1.p1.11.m5.2b"><apply id="A1.1.p1.11.m5.2.2.3.cmml" xref="A1.1.p1.11.m5.2.2.2"><csymbol cd="ambiguous" id="A1.1.p1.11.m5.2.2.3a.cmml" xref="A1.1.p1.11.m5.2.2.2.3">formulae-sequence</csymbol><apply id="A1.1.p1.11.m5.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.11.m5.1.1.1.1.4.cmml" xref="A1.1.p1.11.m5.1.1.1.1.4">proportional-to</csymbol><apply id="A1.1.p1.11.m5.1.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1"><times id="A1.1.p1.11.m5.1.1.1.1.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.2"></times><apply id="A1.1.p1.11.m5.1.1.1.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.3"><ci id="A1.1.p1.11.m5.1.1.1.1.1.3.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.3.1">~</ci><ci id="A1.1.p1.11.m5.1.1.1.1.1.3.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><apply id="A1.1.p1.11.m5.1.1.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3"><times id="A1.1.p1.11.m5.1.1.1.1.3.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.3"></times><apply id="A1.1.p1.11.m5.1.1.1.1.2.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1"><ci id="A1.1.p1.11.m5.1.1.1.1.2.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.2">⋅</ci><apply id="A1.1.p1.11.m5.1.1.1.1.2.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1"><times id="A1.1.p1.11.m5.1.1.1.1.2.1.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.2"></times><ci id="A1.1.p1.11.m5.1.1.1.1.2.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.3">𝑝</ci><apply id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.2">𝑎</ci><ci id="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.1.1.1.1.3">𝑏</ci></apply></apply><ci id="A1.1.p1.11.m5.1.1.1.1.2.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.2.1.3">𝑝</ci></apply><apply id="A1.1.p1.11.m5.1.1.1.1.3.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.1.p1.11.m5.1.1.1.1.3.2.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2">superscript</csymbol><apply id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1"><csymbol cd="latexml" id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.1.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.1">conditional</csymbol><ci id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.2.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.2">𝑏</ci><ci id="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2.1.1.1.3">𝑎</ci></apply><ci id="A1.1.p1.11.m5.1.1.1.1.3.2.3.cmml" xref="A1.1.p1.11.m5.1.1.1.1.3.2.3">𝑤</ci></apply></apply></apply><apply id="A1.1.p1.11.m5.2.2.2.2.cmml" xref="A1.1.p1.11.m5.2.2.2.2"><gt id="A1.1.p1.11.m5.2.2.2.2.1.cmml" xref="A1.1.p1.11.m5.2.2.2.2.1"></gt><ci id="A1.1.p1.11.m5.2.2.2.2.2.cmml" xref="A1.1.p1.11.m5.2.2.2.2.2">𝑤</ci><cn id="A1.1.p1.11.m5.2.2.2.2.3.cmml" type="integer" xref="A1.1.p1.11.m5.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.1.p1.11.m5.2c">\tilde{p}(a|b)\propto p(a|b)\cdot p(b|a)^{w},w&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.1.p1.11.m5.2d">over~ start_ARG italic_p end_ARG ( italic_a | italic_b ) ∝ italic_p ( italic_a | italic_b ) ⋅ italic_p ( italic_b | italic_a ) start_POSTSUPERSCRIPT italic_w end_POSTSUPERSCRIPT , italic_w &gt; 0</annotation></semantics></math>. Note that this result can be trivially extended to multivariate random variables.</p>
</div>
<div class="ltx_para" id="A1.2.p2">
<p class="ltx_p" id="A1.2.p2.1">∎</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.3"><span class="ltx_text ltx_font_bold" id="A1.p2.3.3">Theorem 3.1.<em class="ltx_emph ltx_font_medium ltx_font_italic" id="A1.p2.3.3.3"> Minimizing <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="A1.p2.1.1.1.m1.1"><semantics id="A1.p2.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.p2.1.1.1.m1.1.1" xref="A1.p2.1.1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.1.1.m1.1b"><ci id="A1.p2.1.1.1.m1.1.1.cmml" xref="A1.p2.1.1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.1.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.1.1.m1.1d">caligraphic_L</annotation></semantics></math> with regard to <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="A1.p2.2.2.2.m2.1"><semantics id="A1.p2.2.2.2.m2.1a"><mi id="A1.p2.2.2.2.m2.1.1" xref="A1.p2.2.2.2.m2.1.1.cmml">𝛉</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.2.2.m2.1b"><ci id="A1.p2.2.2.2.m2.1.1.cmml" xref="A1.p2.2.2.2.m2.1.1">𝛉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.2.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.2.2.m2.1d">bold_italic_θ</annotation></semantics></math> is equivalent to minimizing the upper bound of an adjusted conditional data negative log-likelihood <math alttext="-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="A1.p2.3.3.3.m3.3"><semantics id="A1.p2.3.3.3.m3.3a"><mrow id="A1.p2.3.3.3.m3.3.3" xref="A1.p2.3.3.3.m3.3.3.cmml"><mo id="A1.p2.3.3.3.m3.3.3a" rspace="0.167em" xref="A1.p2.3.3.3.m3.3.3.cmml">−</mo><mrow id="A1.p2.3.3.3.m3.3.3.1" xref="A1.p2.3.3.3.m3.3.3.1.cmml"><mrow id="A1.p2.3.3.3.m3.3.3.1.3" xref="A1.p2.3.3.3.m3.3.3.1.3.cmml"><mi id="A1.p2.3.3.3.m3.3.3.1.3.1" xref="A1.p2.3.3.3.m3.3.3.1.3.1.cmml">log</mi><mo id="A1.p2.3.3.3.m3.3.3.1.3a" lspace="0.167em" xref="A1.p2.3.3.3.m3.3.3.1.3.cmml">⁡</mo><mover accent="true" id="A1.p2.3.3.3.m3.3.3.1.3.2" xref="A1.p2.3.3.3.m3.3.3.1.3.2.cmml"><mi id="A1.p2.3.3.3.m3.3.3.1.3.2.2" xref="A1.p2.3.3.3.m3.3.3.1.3.2.2.cmml">p</mi><mo id="A1.p2.3.3.3.m3.3.3.1.3.2.1" xref="A1.p2.3.3.3.m3.3.3.1.3.2.1.cmml">~</mo></mover></mrow><mo id="A1.p2.3.3.3.m3.3.3.1.2" xref="A1.p2.3.3.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="A1.p2.3.3.3.m3.3.3.1.1.1" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.cmml"><mo id="A1.p2.3.3.3.m3.3.3.1.1.1.2" stretchy="false" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.p2.3.3.3.m3.3.3.1.1.1.1" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.cmml"><mi id="A1.p2.3.3.3.m3.3.3.1.1.1.1.2" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.p2.3.3.3.m3.3.3.1.1.1.1.1" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.1.cmml">|</mo><mrow id="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.2" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.1.cmml"><mi id="A1.p2.3.3.3.m3.1.1" xref="A1.p2.3.3.3.m3.1.1.cmml">𝐲</mi><mo id="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.2.1" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="A1.p2.3.3.3.m3.2.2" xref="A1.p2.3.3.3.m3.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.p2.3.3.3.m3.3.3.1.1.1.3" stretchy="false" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.3.3.3.m3.3b"><apply id="A1.p2.3.3.3.m3.3.3.cmml" xref="A1.p2.3.3.3.m3.3.3"><minus id="A1.p2.3.3.3.m3.3.3.2.cmml" xref="A1.p2.3.3.3.m3.3.3"></minus><apply id="A1.p2.3.3.3.m3.3.3.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1"><times id="A1.p2.3.3.3.m3.3.3.1.2.cmml" xref="A1.p2.3.3.3.m3.3.3.1.2"></times><apply id="A1.p2.3.3.3.m3.3.3.1.3.cmml" xref="A1.p2.3.3.3.m3.3.3.1.3"><log id="A1.p2.3.3.3.m3.3.3.1.3.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1.3.1"></log><apply id="A1.p2.3.3.3.m3.3.3.1.3.2.cmml" xref="A1.p2.3.3.3.m3.3.3.1.3.2"><ci id="A1.p2.3.3.3.m3.3.3.1.3.2.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1.3.2.1">~</ci><ci id="A1.p2.3.3.3.m3.3.3.1.3.2.2.cmml" xref="A1.p2.3.3.3.m3.3.3.1.3.2.2">𝑝</ci></apply></apply><apply id="A1.p2.3.3.3.m3.3.3.1.1.1.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="A1.p2.3.3.3.m3.3.3.1.1.1.1.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.1">conditional</csymbol><ci id="A1.p2.3.3.3.m3.3.3.1.1.1.1.2.cmml" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.2">𝐱</ci><list id="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.1.cmml" xref="A1.p2.3.3.3.m3.3.3.1.1.1.1.3.2"><ci id="A1.p2.3.3.3.m3.1.1.cmml" xref="A1.p2.3.3.3.m3.1.1">𝐲</ci><ci id="A1.p2.3.3.3.m3.2.2.cmml" xref="A1.p2.3.3.3.m3.2.2">𝐬</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.3.3.m3.3c">-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.3.3.m3.3d">- roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math>, i.e.:</em></span></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\bm{\theta}}\mathcal{L}_{\bm{\theta}}(\mathbf{x}_{0},\mathbf{y},\mathbf{%
s})\geq-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="block" id="A1.E5.m1.6"><semantics id="A1.E5.m1.6a"><mrow id="A1.E5.m1.6.6" xref="A1.E5.m1.6.6.cmml"><mrow id="A1.E5.m1.5.5.1" xref="A1.E5.m1.5.5.1.cmml"><mrow id="A1.E5.m1.5.5.1.3" xref="A1.E5.m1.5.5.1.3.cmml"><munder id="A1.E5.m1.5.5.1.3.1" xref="A1.E5.m1.5.5.1.3.1.cmml"><mi id="A1.E5.m1.5.5.1.3.1.2" xref="A1.E5.m1.5.5.1.3.1.2.cmml">min</mi><mi id="A1.E5.m1.5.5.1.3.1.3" xref="A1.E5.m1.5.5.1.3.1.3.cmml">𝜽</mi></munder><mo id="A1.E5.m1.5.5.1.3a" lspace="0.167em" xref="A1.E5.m1.5.5.1.3.cmml">⁡</mo><msub id="A1.E5.m1.5.5.1.3.2" xref="A1.E5.m1.5.5.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E5.m1.5.5.1.3.2.2" xref="A1.E5.m1.5.5.1.3.2.2.cmml">ℒ</mi><mi id="A1.E5.m1.5.5.1.3.2.3" xref="A1.E5.m1.5.5.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo id="A1.E5.m1.5.5.1.2" xref="A1.E5.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E5.m1.5.5.1.1.1" xref="A1.E5.m1.5.5.1.1.2.cmml"><mo id="A1.E5.m1.5.5.1.1.1.2" stretchy="false" xref="A1.E5.m1.5.5.1.1.2.cmml">(</mo><msub id="A1.E5.m1.5.5.1.1.1.1" xref="A1.E5.m1.5.5.1.1.1.1.cmml"><mi id="A1.E5.m1.5.5.1.1.1.1.2" xref="A1.E5.m1.5.5.1.1.1.1.2.cmml">𝐱</mi><mn id="A1.E5.m1.5.5.1.1.1.1.3" xref="A1.E5.m1.5.5.1.1.1.1.3.cmml">0</mn></msub><mo id="A1.E5.m1.5.5.1.1.1.3" xref="A1.E5.m1.5.5.1.1.2.cmml">,</mo><mi id="A1.E5.m1.1.1" xref="A1.E5.m1.1.1.cmml">𝐲</mi><mo id="A1.E5.m1.5.5.1.1.1.4" xref="A1.E5.m1.5.5.1.1.2.cmml">,</mo><mi id="A1.E5.m1.2.2" xref="A1.E5.m1.2.2.cmml">𝐬</mi><mo id="A1.E5.m1.5.5.1.1.1.5" stretchy="false" xref="A1.E5.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.6.6.3" xref="A1.E5.m1.6.6.3.cmml">≥</mo><mrow id="A1.E5.m1.6.6.2" xref="A1.E5.m1.6.6.2.cmml"><mo id="A1.E5.m1.6.6.2a" rspace="0.167em" xref="A1.E5.m1.6.6.2.cmml">−</mo><mrow id="A1.E5.m1.6.6.2.1" xref="A1.E5.m1.6.6.2.1.cmml"><mrow id="A1.E5.m1.6.6.2.1.3" xref="A1.E5.m1.6.6.2.1.3.cmml"><mi id="A1.E5.m1.6.6.2.1.3.1" xref="A1.E5.m1.6.6.2.1.3.1.cmml">log</mi><mo id="A1.E5.m1.6.6.2.1.3a" lspace="0.167em" xref="A1.E5.m1.6.6.2.1.3.cmml">⁡</mo><mover accent="true" id="A1.E5.m1.6.6.2.1.3.2" xref="A1.E5.m1.6.6.2.1.3.2.cmml"><mi id="A1.E5.m1.6.6.2.1.3.2.2" xref="A1.E5.m1.6.6.2.1.3.2.2.cmml">p</mi><mo id="A1.E5.m1.6.6.2.1.3.2.1" xref="A1.E5.m1.6.6.2.1.3.2.1.cmml">~</mo></mover></mrow><mo id="A1.E5.m1.6.6.2.1.2" xref="A1.E5.m1.6.6.2.1.2.cmml">⁢</mo><mrow id="A1.E5.m1.6.6.2.1.1.1" xref="A1.E5.m1.6.6.2.1.1.1.1.cmml"><mo id="A1.E5.m1.6.6.2.1.1.1.2" stretchy="false" xref="A1.E5.m1.6.6.2.1.1.1.1.cmml">(</mo><mrow id="A1.E5.m1.6.6.2.1.1.1.1" xref="A1.E5.m1.6.6.2.1.1.1.1.cmml"><mi id="A1.E5.m1.6.6.2.1.1.1.1.2" xref="A1.E5.m1.6.6.2.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E5.m1.6.6.2.1.1.1.1.1" xref="A1.E5.m1.6.6.2.1.1.1.1.1.cmml">|</mo><mrow id="A1.E5.m1.6.6.2.1.1.1.1.3.2" xref="A1.E5.m1.6.6.2.1.1.1.1.3.1.cmml"><mi id="A1.E5.m1.3.3" xref="A1.E5.m1.3.3.cmml">𝐲</mi><mo id="A1.E5.m1.6.6.2.1.1.1.1.3.2.1" xref="A1.E5.m1.6.6.2.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E5.m1.4.4" xref="A1.E5.m1.4.4.cmml">𝐬</mi></mrow></mrow><mo id="A1.E5.m1.6.6.2.1.1.1.3" stretchy="false" xref="A1.E5.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.6b"><apply id="A1.E5.m1.6.6.cmml" xref="A1.E5.m1.6.6"><geq id="A1.E5.m1.6.6.3.cmml" xref="A1.E5.m1.6.6.3"></geq><apply id="A1.E5.m1.5.5.1.cmml" xref="A1.E5.m1.5.5.1"><times id="A1.E5.m1.5.5.1.2.cmml" xref="A1.E5.m1.5.5.1.2"></times><apply id="A1.E5.m1.5.5.1.3.cmml" xref="A1.E5.m1.5.5.1.3"><apply id="A1.E5.m1.5.5.1.3.1.cmml" xref="A1.E5.m1.5.5.1.3.1"><csymbol cd="ambiguous" id="A1.E5.m1.5.5.1.3.1.1.cmml" xref="A1.E5.m1.5.5.1.3.1">subscript</csymbol><min id="A1.E5.m1.5.5.1.3.1.2.cmml" xref="A1.E5.m1.5.5.1.3.1.2"></min><ci id="A1.E5.m1.5.5.1.3.1.3.cmml" xref="A1.E5.m1.5.5.1.3.1.3">𝜽</ci></apply><apply id="A1.E5.m1.5.5.1.3.2.cmml" xref="A1.E5.m1.5.5.1.3.2"><csymbol cd="ambiguous" id="A1.E5.m1.5.5.1.3.2.1.cmml" xref="A1.E5.m1.5.5.1.3.2">subscript</csymbol><ci id="A1.E5.m1.5.5.1.3.2.2.cmml" xref="A1.E5.m1.5.5.1.3.2.2">ℒ</ci><ci id="A1.E5.m1.5.5.1.3.2.3.cmml" xref="A1.E5.m1.5.5.1.3.2.3">𝜽</ci></apply></apply><vector id="A1.E5.m1.5.5.1.1.2.cmml" xref="A1.E5.m1.5.5.1.1.1"><apply id="A1.E5.m1.5.5.1.1.1.1.cmml" xref="A1.E5.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.5.5.1.1.1.1.1.cmml" xref="A1.E5.m1.5.5.1.1.1.1">subscript</csymbol><ci id="A1.E5.m1.5.5.1.1.1.1.2.cmml" xref="A1.E5.m1.5.5.1.1.1.1.2">𝐱</ci><cn id="A1.E5.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="A1.E5.m1.5.5.1.1.1.1.3">0</cn></apply><ci id="A1.E5.m1.1.1.cmml" xref="A1.E5.m1.1.1">𝐲</ci><ci id="A1.E5.m1.2.2.cmml" xref="A1.E5.m1.2.2">𝐬</ci></vector></apply><apply id="A1.E5.m1.6.6.2.cmml" xref="A1.E5.m1.6.6.2"><minus id="A1.E5.m1.6.6.2.2.cmml" xref="A1.E5.m1.6.6.2"></minus><apply id="A1.E5.m1.6.6.2.1.cmml" xref="A1.E5.m1.6.6.2.1"><times id="A1.E5.m1.6.6.2.1.2.cmml" xref="A1.E5.m1.6.6.2.1.2"></times><apply id="A1.E5.m1.6.6.2.1.3.cmml" xref="A1.E5.m1.6.6.2.1.3"><log id="A1.E5.m1.6.6.2.1.3.1.cmml" xref="A1.E5.m1.6.6.2.1.3.1"></log><apply id="A1.E5.m1.6.6.2.1.3.2.cmml" xref="A1.E5.m1.6.6.2.1.3.2"><ci id="A1.E5.m1.6.6.2.1.3.2.1.cmml" xref="A1.E5.m1.6.6.2.1.3.2.1">~</ci><ci id="A1.E5.m1.6.6.2.1.3.2.2.cmml" xref="A1.E5.m1.6.6.2.1.3.2.2">𝑝</ci></apply></apply><apply id="A1.E5.m1.6.6.2.1.1.1.1.cmml" xref="A1.E5.m1.6.6.2.1.1.1"><csymbol cd="latexml" id="A1.E5.m1.6.6.2.1.1.1.1.1.cmml" xref="A1.E5.m1.6.6.2.1.1.1.1.1">conditional</csymbol><ci id="A1.E5.m1.6.6.2.1.1.1.1.2.cmml" xref="A1.E5.m1.6.6.2.1.1.1.1.2">𝐱</ci><list id="A1.E5.m1.6.6.2.1.1.1.1.3.1.cmml" xref="A1.E5.m1.6.6.2.1.1.1.1.3.2"><ci id="A1.E5.m1.3.3.cmml" xref="A1.E5.m1.3.3">𝐲</ci><ci id="A1.E5.m1.4.4.cmml" xref="A1.E5.m1.4.4">𝐬</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.6c">\min_{\bm{\theta}}\mathcal{L}_{\bm{\theta}}(\mathbf{x}_{0},\mathbf{y},\mathbf{%
s})\geq-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A1.E5.m1.6d">roman_min start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) ≥ - roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p2.6"><em class="ltx_emph ltx_font_italic" id="A1.p2.6.1">where</em></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})\propto p(\mathbf{x}|\mathbf{y},%
\mathbf{s})\cdot p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}" class="ltx_Math" display="block" id="A1.E6.m1.8"><semantics id="A1.E6.m1.8a"><mrow id="A1.E6.m1.8.8" xref="A1.E6.m1.8.8.cmml"><mrow id="A1.E6.m1.6.6.1" xref="A1.E6.m1.6.6.1.cmml"><mover accent="true" id="A1.E6.m1.6.6.1.3" xref="A1.E6.m1.6.6.1.3.cmml"><mi id="A1.E6.m1.6.6.1.3.2" xref="A1.E6.m1.6.6.1.3.2.cmml">p</mi><mo id="A1.E6.m1.6.6.1.3.1" xref="A1.E6.m1.6.6.1.3.1.cmml">~</mo></mover><mo id="A1.E6.m1.6.6.1.2" xref="A1.E6.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.6.6.1.1.1" xref="A1.E6.m1.6.6.1.1.1.1.cmml"><mo id="A1.E6.m1.6.6.1.1.1.2" stretchy="false" xref="A1.E6.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.6.6.1.1.1.1" xref="A1.E6.m1.6.6.1.1.1.1.cmml"><mi id="A1.E6.m1.6.6.1.1.1.1.2" xref="A1.E6.m1.6.6.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E6.m1.6.6.1.1.1.1.1" xref="A1.E6.m1.6.6.1.1.1.1.1.cmml">|</mo><mrow id="A1.E6.m1.6.6.1.1.1.1.3.2" xref="A1.E6.m1.6.6.1.1.1.1.3.1.cmml"><mi id="A1.E6.m1.1.1" xref="A1.E6.m1.1.1.cmml">𝐲</mi><mo id="A1.E6.m1.6.6.1.1.1.1.3.2.1" xref="A1.E6.m1.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E6.m1.2.2" xref="A1.E6.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E6.m1.6.6.1.1.1.3" stretchy="false" xref="A1.E6.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.8.8.4" xref="A1.E6.m1.8.8.4.cmml">∝</mo><mrow id="A1.E6.m1.8.8.3" xref="A1.E6.m1.8.8.3.cmml"><mrow id="A1.E6.m1.7.7.2.1" xref="A1.E6.m1.7.7.2.1.cmml"><mrow id="A1.E6.m1.7.7.2.1.1" xref="A1.E6.m1.7.7.2.1.1.cmml"><mi id="A1.E6.m1.7.7.2.1.1.3" xref="A1.E6.m1.7.7.2.1.1.3.cmml">p</mi><mo id="A1.E6.m1.7.7.2.1.1.2" xref="A1.E6.m1.7.7.2.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.7.7.2.1.1.1.1" xref="A1.E6.m1.7.7.2.1.1.1.1.1.cmml"><mo id="A1.E6.m1.7.7.2.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.7.7.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.7.7.2.1.1.1.1.1" xref="A1.E6.m1.7.7.2.1.1.1.1.1.cmml"><mi id="A1.E6.m1.7.7.2.1.1.1.1.1.2" xref="A1.E6.m1.7.7.2.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E6.m1.7.7.2.1.1.1.1.1.1" xref="A1.E6.m1.7.7.2.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E6.m1.7.7.2.1.1.1.1.1.3.2" xref="A1.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml"><mi id="A1.E6.m1.3.3" xref="A1.E6.m1.3.3.cmml">𝐲</mi><mo id="A1.E6.m1.7.7.2.1.1.1.1.1.3.2.1" xref="A1.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E6.m1.4.4" xref="A1.E6.m1.4.4.cmml">𝐬</mi></mrow></mrow><mo id="A1.E6.m1.7.7.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E6.m1.7.7.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.7.7.2.1.2" rspace="0.222em" xref="A1.E6.m1.7.7.2.1.2.cmml">⋅</mo><mi id="A1.E6.m1.7.7.2.1.3" xref="A1.E6.m1.7.7.2.1.3.cmml">p</mi></mrow><mo id="A1.E6.m1.8.8.3.3" xref="A1.E6.m1.8.8.3.3.cmml">⁢</mo><msup id="A1.E6.m1.8.8.3.2" xref="A1.E6.m1.8.8.3.2.cmml"><mrow id="A1.E6.m1.8.8.3.2.1.1" xref="A1.E6.m1.8.8.3.2.1.2.cmml"><mo id="A1.E6.m1.8.8.3.2.1.1.2" stretchy="false" xref="A1.E6.m1.8.8.3.2.1.2.cmml">(</mo><mi id="A1.E6.m1.5.5" xref="A1.E6.m1.5.5.cmml">𝐲</mi><mo id="A1.E6.m1.8.8.3.2.1.1.3" xref="A1.E6.m1.8.8.3.2.1.2.cmml">,</mo><mrow id="A1.E6.m1.8.8.3.2.1.1.1" xref="A1.E6.m1.8.8.3.2.1.1.1.cmml"><mi id="A1.E6.m1.8.8.3.2.1.1.1.2" xref="A1.E6.m1.8.8.3.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E6.m1.8.8.3.2.1.1.1.1" xref="A1.E6.m1.8.8.3.2.1.1.1.1.cmml">|</mo><mi id="A1.E6.m1.8.8.3.2.1.1.1.3" xref="A1.E6.m1.8.8.3.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E6.m1.8.8.3.2.1.1.4" stretchy="false" xref="A1.E6.m1.8.8.3.2.1.2.cmml">)</mo></mrow><mfrac id="A1.E6.m1.8.8.3.2.3" xref="A1.E6.m1.8.8.3.2.3.cmml"><mrow id="A1.E6.m1.8.8.3.2.3.2" xref="A1.E6.m1.8.8.3.2.3.2.cmml"><mstyle displaystyle="false" id="A1.E6.m1.8.8.3.2.3.2.1" xref="A1.E6.m1.8.8.3.2.3.2.1.cmml"><msubsup id="A1.E6.m1.8.8.3.2.3.2.1a" xref="A1.E6.m1.8.8.3.2.3.2.1.cmml"><mo id="A1.E6.m1.8.8.3.2.3.2.1.2.2" xref="A1.E6.m1.8.8.3.2.3.2.1.2.2.cmml">∑</mo><mrow id="A1.E6.m1.8.8.3.2.3.2.1.2.3" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.cmml"><mi id="A1.E6.m1.8.8.3.2.3.2.1.2.3.2" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.2.cmml">t</mi><mo id="A1.E6.m1.8.8.3.2.3.2.1.2.3.1" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.1.cmml">=</mo><mn id="A1.E6.m1.8.8.3.2.3.2.1.2.3.3" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E6.m1.8.8.3.2.3.2.1.3" xref="A1.E6.m1.8.8.3.2.3.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="A1.E6.m1.8.8.3.2.3.2.2" xref="A1.E6.m1.8.8.3.2.3.2.2.cmml"><mi id="A1.E6.m1.8.8.3.2.3.2.2.2" xref="A1.E6.m1.8.8.3.2.3.2.2.2.cmml">λ</mi><mi id="A1.E6.m1.8.8.3.2.3.2.2.3" xref="A1.E6.m1.8.8.3.2.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.E6.m1.8.8.3.2.3.3" xref="A1.E6.m1.8.8.3.2.3.3.cmml"><mi id="A1.E6.m1.8.8.3.2.3.3.2" xref="A1.E6.m1.8.8.3.2.3.3.2.cmml">T</mi><mo id="A1.E6.m1.8.8.3.2.3.3.1" xref="A1.E6.m1.8.8.3.2.3.3.1.cmml">−</mo><mn id="A1.E6.m1.8.8.3.2.3.3.3" xref="A1.E6.m1.8.8.3.2.3.3.3.cmml">1</mn></mrow></mfrac></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.8b"><apply id="A1.E6.m1.8.8.cmml" xref="A1.E6.m1.8.8"><csymbol cd="latexml" id="A1.E6.m1.8.8.4.cmml" xref="A1.E6.m1.8.8.4">proportional-to</csymbol><apply id="A1.E6.m1.6.6.1.cmml" xref="A1.E6.m1.6.6.1"><times id="A1.E6.m1.6.6.1.2.cmml" xref="A1.E6.m1.6.6.1.2"></times><apply id="A1.E6.m1.6.6.1.3.cmml" xref="A1.E6.m1.6.6.1.3"><ci id="A1.E6.m1.6.6.1.3.1.cmml" xref="A1.E6.m1.6.6.1.3.1">~</ci><ci id="A1.E6.m1.6.6.1.3.2.cmml" xref="A1.E6.m1.6.6.1.3.2">𝑝</ci></apply><apply id="A1.E6.m1.6.6.1.1.1.1.cmml" xref="A1.E6.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.6.6.1.1.1.1.1.cmml" xref="A1.E6.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="A1.E6.m1.6.6.1.1.1.1.2.cmml" xref="A1.E6.m1.6.6.1.1.1.1.2">𝐱</ci><list id="A1.E6.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.E6.m1.6.6.1.1.1.1.3.2"><ci id="A1.E6.m1.1.1.cmml" xref="A1.E6.m1.1.1">𝐲</ci><ci id="A1.E6.m1.2.2.cmml" xref="A1.E6.m1.2.2">𝐬</ci></list></apply></apply><apply id="A1.E6.m1.8.8.3.cmml" xref="A1.E6.m1.8.8.3"><times id="A1.E6.m1.8.8.3.3.cmml" xref="A1.E6.m1.8.8.3.3"></times><apply id="A1.E6.m1.7.7.2.1.cmml" xref="A1.E6.m1.7.7.2.1"><ci id="A1.E6.m1.7.7.2.1.2.cmml" xref="A1.E6.m1.7.7.2.1.2">⋅</ci><apply id="A1.E6.m1.7.7.2.1.1.cmml" xref="A1.E6.m1.7.7.2.1.1"><times id="A1.E6.m1.7.7.2.1.1.2.cmml" xref="A1.E6.m1.7.7.2.1.1.2"></times><ci id="A1.E6.m1.7.7.2.1.1.3.cmml" xref="A1.E6.m1.7.7.2.1.1.3">𝑝</ci><apply id="A1.E6.m1.7.7.2.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.2.1.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.7.7.2.1.1.1.1.1.1.cmml" xref="A1.E6.m1.7.7.2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E6.m1.7.7.2.1.1.1.1.1.2.cmml" xref="A1.E6.m1.7.7.2.1.1.1.1.1.2">𝐱</ci><list id="A1.E6.m1.7.7.2.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.7.7.2.1.1.1.1.1.3.2"><ci id="A1.E6.m1.3.3.cmml" xref="A1.E6.m1.3.3">𝐲</ci><ci id="A1.E6.m1.4.4.cmml" xref="A1.E6.m1.4.4">𝐬</ci></list></apply></apply><ci id="A1.E6.m1.7.7.2.1.3.cmml" xref="A1.E6.m1.7.7.2.1.3">𝑝</ci></apply><apply id="A1.E6.m1.8.8.3.2.cmml" xref="A1.E6.m1.8.8.3.2"><csymbol cd="ambiguous" id="A1.E6.m1.8.8.3.2.2.cmml" xref="A1.E6.m1.8.8.3.2">superscript</csymbol><interval closure="open" id="A1.E6.m1.8.8.3.2.1.2.cmml" xref="A1.E6.m1.8.8.3.2.1.1"><ci id="A1.E6.m1.5.5.cmml" xref="A1.E6.m1.5.5">𝐲</ci><apply id="A1.E6.m1.8.8.3.2.1.1.1.cmml" xref="A1.E6.m1.8.8.3.2.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.8.8.3.2.1.1.1.1.cmml" xref="A1.E6.m1.8.8.3.2.1.1.1.1">conditional</csymbol><ci id="A1.E6.m1.8.8.3.2.1.1.1.2.cmml" xref="A1.E6.m1.8.8.3.2.1.1.1.2">𝐬</ci><ci id="A1.E6.m1.8.8.3.2.1.1.1.3.cmml" xref="A1.E6.m1.8.8.3.2.1.1.1.3">𝐱</ci></apply></interval><apply id="A1.E6.m1.8.8.3.2.3.cmml" xref="A1.E6.m1.8.8.3.2.3"><divide id="A1.E6.m1.8.8.3.2.3.1.cmml" xref="A1.E6.m1.8.8.3.2.3"></divide><apply id="A1.E6.m1.8.8.3.2.3.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2"><apply id="A1.E6.m1.8.8.3.2.3.2.1.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="A1.E6.m1.8.8.3.2.3.2.1.1.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1">superscript</csymbol><apply id="A1.E6.m1.8.8.3.2.3.2.1.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1"><csymbol cd="ambiguous" id="A1.E6.m1.8.8.3.2.3.2.1.2.1.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1">subscript</csymbol><sum id="A1.E6.m1.8.8.3.2.3.2.1.2.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1.2.2"></sum><apply id="A1.E6.m1.8.8.3.2.3.2.1.2.3.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3"><eq id="A1.E6.m1.8.8.3.2.3.2.1.2.3.1.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.1"></eq><ci id="A1.E6.m1.8.8.3.2.3.2.1.2.3.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.2">𝑡</ci><cn id="A1.E6.m1.8.8.3.2.3.2.1.2.3.3.cmml" type="integer" xref="A1.E6.m1.8.8.3.2.3.2.1.2.3.3">2</cn></apply></apply><ci id="A1.E6.m1.8.8.3.2.3.2.1.3.cmml" xref="A1.E6.m1.8.8.3.2.3.2.1.3">𝑇</ci></apply><apply id="A1.E6.m1.8.8.3.2.3.2.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2.2"><csymbol cd="ambiguous" id="A1.E6.m1.8.8.3.2.3.2.2.1.cmml" xref="A1.E6.m1.8.8.3.2.3.2.2">subscript</csymbol><ci id="A1.E6.m1.8.8.3.2.3.2.2.2.cmml" xref="A1.E6.m1.8.8.3.2.3.2.2.2">𝜆</ci><ci id="A1.E6.m1.8.8.3.2.3.2.2.3.cmml" xref="A1.E6.m1.8.8.3.2.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.E6.m1.8.8.3.2.3.3.cmml" xref="A1.E6.m1.8.8.3.2.3.3"><minus id="A1.E6.m1.8.8.3.2.3.3.1.cmml" xref="A1.E6.m1.8.8.3.2.3.3.1"></minus><ci id="A1.E6.m1.8.8.3.2.3.3.2.cmml" xref="A1.E6.m1.8.8.3.2.3.3.2">𝑇</ci><cn id="A1.E6.m1.8.8.3.2.3.3.3.cmml" type="integer" xref="A1.E6.m1.8.8.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.8c">\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})\propto p(\mathbf{x}|\mathbf{y},%
\mathbf{s})\cdot p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m1.8d">over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s ) ∝ italic_p ( bold_x | bold_y , bold_s ) ⋅ italic_p ( bold_y , bold_s | bold_x ) start_POSTSUPERSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p2.5"><em class="ltx_emph ltx_font_italic" id="A1.p2.5.2">and <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.p2.4.1.m1.1"><semantics id="A1.p2.4.1.m1.1a"><msub id="A1.p2.4.1.m1.1.1" xref="A1.p2.4.1.m1.1.1.cmml"><mi id="A1.p2.4.1.m1.1.1.2" xref="A1.p2.4.1.m1.1.1.2.cmml">𝐱</mi><mn id="A1.p2.4.1.m1.1.1.3" xref="A1.p2.4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p2.4.1.m1.1b"><apply id="A1.p2.4.1.m1.1.1.cmml" xref="A1.p2.4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p2.4.1.m1.1.1.1.cmml" xref="A1.p2.4.1.m1.1.1">subscript</csymbol><ci id="A1.p2.4.1.m1.1.1.2.cmml" xref="A1.p2.4.1.m1.1.1.2">𝐱</ci><cn id="A1.p2.4.1.m1.1.1.3.cmml" type="integer" xref="A1.p2.4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.1.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A1.p2.5.2.m2.1"><semantics id="A1.p2.5.2.m2.1a"><mi id="A1.p2.5.2.m2.1.1" xref="A1.p2.5.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A1.p2.5.2.m2.1b"><ci id="A1.p2.5.2.m2.1.1.cmml" xref="A1.p2.5.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.2.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.2.m2.1d">bold_x</annotation></semantics></math> both refer to a raw image interchangeably.</em></p>
</div>
<div class="ltx_proof" id="A1.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.3.p1">
<p class="ltx_p" id="A1.3.p1.24">Recall that</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{\bm{\theta}}(\mathbf{x}_{0},\mathbf{y},\mathbf{s})&amp;=%
\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}-\underbrace{\lambda_{t}\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{%
\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term}}%
\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[\underbrace{\frac{%
1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}\right\rVert_{2}^{2}}%
_{\text{one-step reconstruction term}}\right]+C\\
&amp;=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[%
\underbrace{\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}%
\right\rVert_{2}^{2}}_{\text{one-step reconstruction term}}\right]+C-\mathbb{E%
}_{t\sim\mathcal{U}[2,T]}{\bigg{[}\underbrace{\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}\bigg{]}}\end{split}" class="ltx_Math" display="block" id="A1.E7.m1.64"><semantics id="A1.E7.m1.64a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E7.m1.64.64.12" rowspacing="0pt" xref="A1.E7.m1.58.58.6.cmml"><mtr id="A1.E7.m1.64.64.12a" xref="A1.E7.m1.58.58.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E7.m1.64.64.12b" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.59.59.7.53.30.11" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.59.59.7.53.30.11.13" xref="A1.E7.m1.58.58.6.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.cmml">ℒ</mi><mi id="A1.E7.m1.2.2.2.2.2.2.1" xref="A1.E7.m1.2.2.2.2.2.2.1.cmml">𝜽</mi></msub><mo id="A1.E7.m1.59.59.7.53.30.11.12" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.59.59.7.53.30.11.11.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.3.3.3.3.3.3" stretchy="false" xref="A1.E7.m1.58.58.6a.cmml">(</mo><msub id="A1.E7.m1.59.59.7.53.30.11.11.1.1" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.4.4.4.4.4.4" xref="A1.E7.m1.4.4.4.4.4.4.cmml">𝐱</mi><mn id="A1.E7.m1.5.5.5.5.5.5.1" xref="A1.E7.m1.5.5.5.5.5.5.1.cmml">0</mn></msub><mo id="A1.E7.m1.6.6.6.6.6.6" xref="A1.E7.m1.58.58.6a.cmml">,</mo><mi id="A1.E7.m1.7.7.7.7.7.7" xref="A1.E7.m1.7.7.7.7.7.7.cmml">𝐲</mi><mo id="A1.E7.m1.8.8.8.8.8.8" xref="A1.E7.m1.58.58.6a.cmml">,</mo><mi id="A1.E7.m1.9.9.9.9.9.9" xref="A1.E7.m1.9.9.9.9.9.9.cmml">𝐬</mi><mo id="A1.E7.m1.10.10.10.10.10.10" stretchy="false" xref="A1.E7.m1.58.58.6a.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.64.64.12c" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.61.61.9.55.32.21" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.61.61.9.55.32.21.22" xref="A1.E7.m1.58.58.6a.cmml"></mi><mo id="A1.E7.m1.11.11.11.11.1.1" xref="A1.E7.m1.11.11.11.11.1.1.cmml">=</mo><mrow id="A1.E7.m1.61.61.9.55.32.21.21" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.60.60.8.54.31.20.20.1" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.60.60.8.54.31.20.20.1.3" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.12.12.12.12.2.2" xref="A1.E7.m1.12.12.12.12.2.2.cmml">𝔼</mi><mrow id="A1.E7.m1.13.13.13.13.3.3.1" xref="A1.E7.m1.13.13.13.13.3.3.1.cmml"><mi id="A1.E7.m1.13.13.13.13.3.3.1.4" xref="A1.E7.m1.13.13.13.13.3.3.1.4.cmml">t</mi><mo id="A1.E7.m1.13.13.13.13.3.3.1.3" xref="A1.E7.m1.13.13.13.13.3.3.1.3.cmml">∼</mo><mrow id="A1.E7.m1.13.13.13.13.3.3.1.5" xref="A1.E7.m1.13.13.13.13.3.3.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.13.13.13.13.3.3.1.5.2" xref="A1.E7.m1.13.13.13.13.3.3.1.5.2.cmml">𝒰</mi><mo id="A1.E7.m1.13.13.13.13.3.3.1.5.1" xref="A1.E7.m1.13.13.13.13.3.3.1.5.1.cmml">⁢</mo><mrow id="A1.E7.m1.13.13.13.13.3.3.1.5.3.2" xref="A1.E7.m1.13.13.13.13.3.3.1.5.3.1.cmml"><mo id="A1.E7.m1.13.13.13.13.3.3.1.5.3.2.1" stretchy="false" xref="A1.E7.m1.13.13.13.13.3.3.1.5.3.1.cmml">[</mo><mn id="A1.E7.m1.13.13.13.13.3.3.1.1" xref="A1.E7.m1.13.13.13.13.3.3.1.1.cmml">2</mn><mo id="A1.E7.m1.13.13.13.13.3.3.1.5.3.2.2" xref="A1.E7.m1.13.13.13.13.3.3.1.5.3.1.cmml">,</mo><mi id="A1.E7.m1.13.13.13.13.3.3.1.2" xref="A1.E7.m1.13.13.13.13.3.3.1.2.cmml">T</mi><mo id="A1.E7.m1.13.13.13.13.3.3.1.5.3.2.3" stretchy="false" xref="A1.E7.m1.13.13.13.13.3.3.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="A1.E7.m1.60.60.8.54.31.20.20.1.2" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.60.60.8.54.31.20.20.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.14.14.14.14.4.4" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">[</mo><mrow id="A1.E7.m1.60.60.8.54.31.20.20.1.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder id="A1.E7.m1.60.60.8.54.31.20.20.1.1.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.15.15.15.15.5.5" xref="A1.E7.m1.15.15.15.15.5.5.cmml"><mrow id="A1.E7.m1.15.15.15.15.5.5.2" xref="A1.E7.m1.15.15.15.15.5.5.2.cmml"><msub id="A1.E7.m1.15.15.15.15.5.5.2.4" xref="A1.E7.m1.15.15.15.15.5.5.2.4.cmml"><mi id="A1.E7.m1.15.15.15.15.5.5.2.4.2" xref="A1.E7.m1.15.15.15.15.5.5.2.4.2.cmml">μ</mi><mi id="A1.E7.m1.15.15.15.15.5.5.2.4.3" xref="A1.E7.m1.15.15.15.15.5.5.2.4.3.cmml">t</mi></msub><mo id="A1.E7.m1.15.15.15.15.5.5.2.3" lspace="0em" xref="A1.E7.m1.15.15.15.15.5.5.2.3.cmml">⁢</mo><msubsup id="A1.E7.m1.15.15.15.15.5.5.2.2" xref="A1.E7.m1.15.15.15.15.5.5.2.2.cmml"><mrow id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.2.cmml"><mo fence="true" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.2.1.cmml">∥</mo><mrow id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.cmml"><msub id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.cmml"><mi id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.2" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.1" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.2" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.1" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.15.15.15.15.5.5.1.1.1.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.cmml"><mo id="A1.E7.m1.15.15.15.15.5.5.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.cmml">(</mo><mi id="A1.E7.m1.15.15.15.15.5.5.1.1.1.1" xref="A1.E7.m1.15.15.15.15.5.5.1.1.1.1.cmml">t</mi><mo id="A1.E7.m1.15.15.15.15.5.5.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.3.cmml">2</mn><mn id="A1.E7.m1.15.15.15.15.5.5.2.2.3" xref="A1.E7.m1.15.15.15.15.5.5.2.2.3.cmml">2</mn></msubsup></mrow><mo id="A1.E7.m1.15.15.15.15.5.5.3" xref="A1.E7.m1.15.15.15.15.5.5.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.16.16.16.16.6.6.1" xref="A1.E7.m1.16.16.16.16.6.6.1a.cmml">denoising term</mtext></munder><mo id="A1.E7.m1.17.17.17.17.7.7" xref="A1.E7.m1.17.17.17.17.7.7.cmml">−</mo><munder id="A1.E7.m1.60.60.8.54.31.20.20.1.1.1.1.2" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.18.18.18.18.8.8" xref="A1.E7.m1.18.18.18.18.8.8.cmml"><mrow id="A1.E7.m1.18.18.18.18.8.8.2" xref="A1.E7.m1.18.18.18.18.8.8.2.cmml"><msub id="A1.E7.m1.18.18.18.18.8.8.2.4" xref="A1.E7.m1.18.18.18.18.8.8.2.4.cmml"><mi id="A1.E7.m1.18.18.18.18.8.8.2.4.2" xref="A1.E7.m1.18.18.18.18.8.8.2.4.2.cmml">λ</mi><mi id="A1.E7.m1.18.18.18.18.8.8.2.4.3" xref="A1.E7.m1.18.18.18.18.8.8.2.4.3.cmml">t</mi></msub><mo id="A1.E7.m1.18.18.18.18.8.8.2.3" xref="A1.E7.m1.18.18.18.18.8.8.2.3.cmml">⁢</mo><msub id="A1.E7.m1.18.18.18.18.8.8.2.5" xref="A1.E7.m1.18.18.18.18.8.8.2.5.cmml"><mi id="A1.E7.m1.18.18.18.18.8.8.2.5.2" xref="A1.E7.m1.18.18.18.18.8.8.2.5.2.cmml">κ</mi><mi id="A1.E7.m1.18.18.18.18.8.8.2.5.3" xref="A1.E7.m1.18.18.18.18.8.8.2.5.3.cmml">𝐱</mi></msub><mo id="A1.E7.m1.18.18.18.18.8.8.2.3a" xref="A1.E7.m1.18.18.18.18.8.8.2.3.cmml">⁢</mo><msup id="A1.E7.m1.18.18.18.18.8.8.2.6" xref="A1.E7.m1.18.18.18.18.8.8.2.6.cmml"><mi id="A1.E7.m1.18.18.18.18.8.8.2.6.2" xref="A1.E7.m1.18.18.18.18.8.8.2.6.2.cmml">𝐲</mi><mi id="A1.E7.m1.18.18.18.18.8.8.2.6.3" xref="A1.E7.m1.18.18.18.18.8.8.2.6.3.cmml">T</mi></msup><mo id="A1.E7.m1.18.18.18.18.8.8.2.3b" xref="A1.E7.m1.18.18.18.18.8.8.2.3.cmml">⁢</mo><msub id="A1.E7.m1.18.18.18.18.8.8.2.7" xref="A1.E7.m1.18.18.18.18.8.8.2.7.cmml"><mi id="A1.E7.m1.18.18.18.18.8.8.2.7.2" xref="A1.E7.m1.18.18.18.18.8.8.2.7.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E7.m1.18.18.18.18.8.8.2.7.3" mathvariant="bold-italic" xref="A1.E7.m1.18.18.18.18.8.8.2.7.3.cmml">ϕ</mi></msub><mo id="A1.E7.m1.18.18.18.18.8.8.2.3c" xref="A1.E7.m1.18.18.18.18.8.8.2.3.cmml">⁢</mo><mrow id="A1.E7.m1.18.18.18.18.8.8.2.2.1" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml"><mo id="A1.E7.m1.18.18.18.18.8.8.2.2.1.2" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml">(</mo><msubsup id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml"><mover accent="true" id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.cmml"><mi id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.2" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.1" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.3" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.3.cmml">0</mn><mrow id="A1.E7.m1.18.18.18.18.8.8.1.1.1.3" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml"><mo id="A1.E7.m1.18.18.18.18.8.8.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml">(</mo><mi id="A1.E7.m1.18.18.18.18.8.8.1.1.1.1" xref="A1.E7.m1.18.18.18.18.8.8.1.1.1.1.cmml">t</mi><mo id="A1.E7.m1.18.18.18.18.8.8.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E7.m1.18.18.18.18.8.8.2.2.1.3" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.18.18.18.18.8.8.3" xref="A1.E7.m1.18.18.18.18.8.8.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.19.19.19.19.9.9.1" xref="A1.E7.m1.19.19.19.19.9.9.1a.cmml">inner-product term</mtext></munder></mrow><mo id="A1.E7.m1.20.20.20.20.10.10" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">]</mo></mrow></mrow><mo id="A1.E7.m1.21.21.21.21.11.11" xref="A1.E7.m1.21.21.21.21.11.11.cmml">+</mo><mrow id="A1.E7.m1.61.61.9.55.32.21.21.2" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.61.61.9.55.32.21.21.2.3" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.22.22.22.22.12.12" xref="A1.E7.m1.22.22.22.22.12.12.cmml">𝔼</mi><mrow id="A1.E7.m1.23.23.23.23.13.13.1" xref="A1.E7.m1.23.23.23.23.13.13.1.cmml"><mi id="A1.E7.m1.23.23.23.23.13.13.1.3" xref="A1.E7.m1.23.23.23.23.13.13.1.3.cmml">q</mi><mo id="A1.E7.m1.23.23.23.23.13.13.1.2" xref="A1.E7.m1.23.23.23.23.13.13.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.23.23.23.23.13.13.1.1.1" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.cmml"><mo id="A1.E7.m1.23.23.23.23.13.13.1.1.1.2" stretchy="false" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.cmml"><msub id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.cmml"><mi id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.2" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.3" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.1" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.1.cmml">|</mo><msub id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.cmml"><mi id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.2" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.2.cmml">𝐱</mi><mn id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.3" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E7.m1.23.23.23.23.13.13.1.1.1.3" stretchy="false" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.E7.m1.61.61.9.55.32.21.21.2.2" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.61.61.9.55.32.21.21.2.1.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.24.24.24.24.14.14" xref="A1.E7.m1.58.58.6a.cmml">[</mo><munder id="A1.E7.m1.61.61.9.55.32.21.21.2.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.25.25.25.25.15.15" xref="A1.E7.m1.25.25.25.25.15.15.cmml"><mrow id="A1.E7.m1.25.25.25.25.15.15.2" xref="A1.E7.m1.25.25.25.25.15.15.2.cmml"><mfrac id="A1.E7.m1.25.25.25.25.15.15.2.4" xref="A1.E7.m1.25.25.25.25.15.15.2.4.cmml"><mn id="A1.E7.m1.25.25.25.25.15.15.2.4.2" xref="A1.E7.m1.25.25.25.25.15.15.2.4.2.cmml">1</mn><mn id="A1.E7.m1.25.25.25.25.15.15.2.4.3" xref="A1.E7.m1.25.25.25.25.15.15.2.4.3.cmml">2</mn></mfrac><mo id="A1.E7.m1.25.25.25.25.15.15.2.3" lspace="0em" xref="A1.E7.m1.25.25.25.25.15.15.2.3.cmml">⁢</mo><msubsup id="A1.E7.m1.25.25.25.25.15.15.2.2" xref="A1.E7.m1.25.25.25.25.15.15.2.2.cmml"><mrow id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.2.cmml"><mo fence="true" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.2.1.cmml">∥</mo><mrow id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.cmml"><msub id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.cmml"><mi id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.2" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.1" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.2" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.1" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.25.25.25.25.15.15.1.1.1.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.cmml"><mo id="A1.E7.m1.25.25.25.25.15.15.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.cmml">(</mo><mn id="A1.E7.m1.25.25.25.25.15.15.1.1.1.1" xref="A1.E7.m1.25.25.25.25.15.15.1.1.1.1.cmml">1</mn><mo id="A1.E7.m1.25.25.25.25.15.15.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.3.cmml">2</mn><mn id="A1.E7.m1.25.25.25.25.15.15.2.2.3" xref="A1.E7.m1.25.25.25.25.15.15.2.2.3.cmml">2</mn></msubsup></mrow><mo id="A1.E7.m1.25.25.25.25.15.15.3" xref="A1.E7.m1.25.25.25.25.15.15.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.26.26.26.26.16.16.1" xref="A1.E7.m1.26.26.26.26.16.16.1a.cmml">one-step reconstruction term</mtext></munder><mo id="A1.E7.m1.27.27.27.27.17.17" xref="A1.E7.m1.58.58.6a.cmml">]</mo></mrow></mrow><mo id="A1.E7.m1.21.21.21.21.11.11a" xref="A1.E7.m1.21.21.21.21.11.11.cmml">+</mo><mi id="A1.E7.m1.29.29.29.29.19.19" xref="A1.E7.m1.29.29.29.29.19.19.cmml">C</mi></mrow></mrow></mtd></mtr><mtr id="A1.E7.m1.64.64.12d" xref="A1.E7.m1.58.58.6.cmml"><mtd id="A1.E7.m1.64.64.12e" xref="A1.E7.m1.58.58.6a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.64.64.12f" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.64.64.12.58.26.26" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.64.64.12.58.26.26.27" xref="A1.E7.m1.58.58.6a.cmml"></mi><mo id="A1.E7.m1.30.30.30.1.1.1" xref="A1.E7.m1.30.30.30.1.1.1.cmml">=</mo><mrow id="A1.E7.m1.64.64.12.58.26.26.26" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.63.63.11.57.25.25.25.2" xref="A1.E7.m1.58.58.6.cmml"><mrow id="A1.E7.m1.62.62.10.56.24.24.24.1.1" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.62.62.10.56.24.24.24.1.1.3" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.31.31.31.2.2.2" xref="A1.E7.m1.31.31.31.2.2.2.cmml">𝔼</mi><mrow id="A1.E7.m1.32.32.32.3.3.3.1" xref="A1.E7.m1.32.32.32.3.3.3.1.cmml"><mi id="A1.E7.m1.32.32.32.3.3.3.1.4" xref="A1.E7.m1.32.32.32.3.3.3.1.4.cmml">t</mi><mo id="A1.E7.m1.32.32.32.3.3.3.1.3" xref="A1.E7.m1.32.32.32.3.3.3.1.3.cmml">∼</mo><mrow id="A1.E7.m1.32.32.32.3.3.3.1.5" xref="A1.E7.m1.32.32.32.3.3.3.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.32.32.32.3.3.3.1.5.2" xref="A1.E7.m1.32.32.32.3.3.3.1.5.2.cmml">𝒰</mi><mo id="A1.E7.m1.32.32.32.3.3.3.1.5.1" xref="A1.E7.m1.32.32.32.3.3.3.1.5.1.cmml">⁢</mo><mrow id="A1.E7.m1.32.32.32.3.3.3.1.5.3.2" xref="A1.E7.m1.32.32.32.3.3.3.1.5.3.1.cmml"><mo id="A1.E7.m1.32.32.32.3.3.3.1.5.3.2.1" stretchy="false" xref="A1.E7.m1.32.32.32.3.3.3.1.5.3.1.cmml">[</mo><mn id="A1.E7.m1.32.32.32.3.3.3.1.1" xref="A1.E7.m1.32.32.32.3.3.3.1.1.cmml">2</mn><mo id="A1.E7.m1.32.32.32.3.3.3.1.5.3.2.2" xref="A1.E7.m1.32.32.32.3.3.3.1.5.3.1.cmml">,</mo><mi id="A1.E7.m1.32.32.32.3.3.3.1.2" xref="A1.E7.m1.32.32.32.3.3.3.1.2.cmml">T</mi><mo id="A1.E7.m1.32.32.32.3.3.3.1.5.3.2.3" stretchy="false" xref="A1.E7.m1.32.32.32.3.3.3.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="A1.E7.m1.62.62.10.56.24.24.24.1.1.2" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.62.62.10.56.24.24.24.1.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.33.33.33.4.4.4" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">[</mo><munder id="A1.E7.m1.62.62.10.56.24.24.24.1.1.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.34.34.34.5.5.5" xref="A1.E7.m1.34.34.34.5.5.5.cmml"><mrow id="A1.E7.m1.34.34.34.5.5.5.2" xref="A1.E7.m1.34.34.34.5.5.5.2.cmml"><msub id="A1.E7.m1.34.34.34.5.5.5.2.4" xref="A1.E7.m1.34.34.34.5.5.5.2.4.cmml"><mi id="A1.E7.m1.34.34.34.5.5.5.2.4.2" xref="A1.E7.m1.34.34.34.5.5.5.2.4.2.cmml">μ</mi><mi id="A1.E7.m1.34.34.34.5.5.5.2.4.3" xref="A1.E7.m1.34.34.34.5.5.5.2.4.3.cmml">t</mi></msub><mo id="A1.E7.m1.34.34.34.5.5.5.2.3" lspace="0em" xref="A1.E7.m1.34.34.34.5.5.5.2.3.cmml">⁢</mo><msubsup id="A1.E7.m1.34.34.34.5.5.5.2.2" xref="A1.E7.m1.34.34.34.5.5.5.2.2.cmml"><mrow id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.2.cmml"><mo fence="true" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.2.1.cmml">∥</mo><mrow id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.cmml"><msub id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.cmml"><mi id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.2" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.1" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.2" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.1" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.34.34.34.5.5.5.1.1.1.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.cmml"><mo id="A1.E7.m1.34.34.34.5.5.5.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.cmml">(</mo><mi id="A1.E7.m1.34.34.34.5.5.5.1.1.1.1" xref="A1.E7.m1.34.34.34.5.5.5.1.1.1.1.cmml">t</mi><mo id="A1.E7.m1.34.34.34.5.5.5.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.3.cmml">2</mn><mn id="A1.E7.m1.34.34.34.5.5.5.2.2.3" xref="A1.E7.m1.34.34.34.5.5.5.2.2.3.cmml">2</mn></msubsup></mrow><mo id="A1.E7.m1.34.34.34.5.5.5.3" xref="A1.E7.m1.34.34.34.5.5.5.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.35.35.35.6.6.6.1" xref="A1.E7.m1.35.35.35.6.6.6.1a.cmml">denoising term</mtext></munder><mo id="A1.E7.m1.36.36.36.7.7.7" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">]</mo></mrow></mrow><mo id="A1.E7.m1.37.37.37.8.8.8" xref="A1.E7.m1.37.37.37.8.8.8.cmml">+</mo><mrow id="A1.E7.m1.63.63.11.57.25.25.25.2.2" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.63.63.11.57.25.25.25.2.2.3" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.38.38.38.9.9.9" xref="A1.E7.m1.38.38.38.9.9.9.cmml">𝔼</mi><mrow id="A1.E7.m1.39.39.39.10.10.10.1" xref="A1.E7.m1.39.39.39.10.10.10.1.cmml"><mi id="A1.E7.m1.39.39.39.10.10.10.1.3" xref="A1.E7.m1.39.39.39.10.10.10.1.3.cmml">q</mi><mo id="A1.E7.m1.39.39.39.10.10.10.1.2" xref="A1.E7.m1.39.39.39.10.10.10.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.39.39.39.10.10.10.1.1.1" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.cmml"><mo id="A1.E7.m1.39.39.39.10.10.10.1.1.1.2" stretchy="false" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.cmml"><msub id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.cmml"><mi id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.2" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.3" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.1" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.1.cmml">|</mo><msub id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.cmml"><mi id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.2" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.2.cmml">𝐱</mi><mn id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.3" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E7.m1.39.39.39.10.10.10.1.1.1.3" stretchy="false" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.E7.m1.63.63.11.57.25.25.25.2.2.2" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.63.63.11.57.25.25.25.2.2.1.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.40.40.40.11.11.11" xref="A1.E7.m1.58.58.6a.cmml">[</mo><munder id="A1.E7.m1.63.63.11.57.25.25.25.2.2.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.41.41.41.12.12.12" xref="A1.E7.m1.41.41.41.12.12.12.cmml"><mrow id="A1.E7.m1.41.41.41.12.12.12.2" xref="A1.E7.m1.41.41.41.12.12.12.2.cmml"><mfrac id="A1.E7.m1.41.41.41.12.12.12.2.4" xref="A1.E7.m1.41.41.41.12.12.12.2.4.cmml"><mn id="A1.E7.m1.41.41.41.12.12.12.2.4.2" xref="A1.E7.m1.41.41.41.12.12.12.2.4.2.cmml">1</mn><mn id="A1.E7.m1.41.41.41.12.12.12.2.4.3" xref="A1.E7.m1.41.41.41.12.12.12.2.4.3.cmml">2</mn></mfrac><mo id="A1.E7.m1.41.41.41.12.12.12.2.3" lspace="0em" xref="A1.E7.m1.41.41.41.12.12.12.2.3.cmml">⁢</mo><msubsup id="A1.E7.m1.41.41.41.12.12.12.2.2" xref="A1.E7.m1.41.41.41.12.12.12.2.2.cmml"><mrow id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.2.cmml"><mo fence="true" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.2" rspace="0em" stretchy="true" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.2.1.cmml">∥</mo><mrow id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.cmml"><msub id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.cmml"><mi id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.2" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.3.cmml">0</mn></msub><mo id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.1" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.2" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.1" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.41.41.41.12.12.12.1.1.1.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.cmml"><mo id="A1.E7.m1.41.41.41.12.12.12.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.cmml">(</mo><mn id="A1.E7.m1.41.41.41.12.12.12.1.1.1.1" xref="A1.E7.m1.41.41.41.12.12.12.1.1.1.1.cmml">1</mn><mo id="A1.E7.m1.41.41.41.12.12.12.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.3.cmml">2</mn><mn id="A1.E7.m1.41.41.41.12.12.12.2.2.3" xref="A1.E7.m1.41.41.41.12.12.12.2.2.3.cmml">2</mn></msubsup></mrow><mo id="A1.E7.m1.41.41.41.12.12.12.3" xref="A1.E7.m1.41.41.41.12.12.12.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.42.42.42.13.13.13.1" xref="A1.E7.m1.42.42.42.13.13.13.1a.cmml">one-step reconstruction term</mtext></munder><mo id="A1.E7.m1.43.43.43.14.14.14" xref="A1.E7.m1.58.58.6a.cmml">]</mo></mrow></mrow><mo id="A1.E7.m1.37.37.37.8.8.8a" xref="A1.E7.m1.37.37.37.8.8.8.cmml">+</mo><mi id="A1.E7.m1.45.45.45.16.16.16" xref="A1.E7.m1.45.45.45.16.16.16.cmml">C</mi></mrow><mo id="A1.E7.m1.46.46.46.17.17.17" xref="A1.E7.m1.46.46.46.17.17.17.cmml">−</mo><mrow id="A1.E7.m1.64.64.12.58.26.26.26.3" xref="A1.E7.m1.58.58.6.cmml"><msub id="A1.E7.m1.64.64.12.58.26.26.26.3.3" xref="A1.E7.m1.58.58.6.cmml"><mi id="A1.E7.m1.47.47.47.18.18.18" xref="A1.E7.m1.47.47.47.18.18.18.cmml">𝔼</mi><mrow id="A1.E7.m1.48.48.48.19.19.19.1" xref="A1.E7.m1.48.48.48.19.19.19.1.cmml"><mi id="A1.E7.m1.48.48.48.19.19.19.1.4" xref="A1.E7.m1.48.48.48.19.19.19.1.4.cmml">t</mi><mo id="A1.E7.m1.48.48.48.19.19.19.1.3" xref="A1.E7.m1.48.48.48.19.19.19.1.3.cmml">∼</mo><mrow id="A1.E7.m1.48.48.48.19.19.19.1.5" xref="A1.E7.m1.48.48.48.19.19.19.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.48.48.48.19.19.19.1.5.2" xref="A1.E7.m1.48.48.48.19.19.19.1.5.2.cmml">𝒰</mi><mo id="A1.E7.m1.48.48.48.19.19.19.1.5.1" xref="A1.E7.m1.48.48.48.19.19.19.1.5.1.cmml">⁢</mo><mrow id="A1.E7.m1.48.48.48.19.19.19.1.5.3.2" xref="A1.E7.m1.48.48.48.19.19.19.1.5.3.1.cmml"><mo id="A1.E7.m1.48.48.48.19.19.19.1.5.3.2.1" stretchy="false" xref="A1.E7.m1.48.48.48.19.19.19.1.5.3.1.cmml">[</mo><mn id="A1.E7.m1.48.48.48.19.19.19.1.1" xref="A1.E7.m1.48.48.48.19.19.19.1.1.cmml">2</mn><mo id="A1.E7.m1.48.48.48.19.19.19.1.5.3.2.2" xref="A1.E7.m1.48.48.48.19.19.19.1.5.3.1.cmml">,</mo><mi id="A1.E7.m1.48.48.48.19.19.19.1.2" xref="A1.E7.m1.48.48.48.19.19.19.1.2.cmml">T</mi><mo id="A1.E7.m1.48.48.48.19.19.19.1.5.3.2.3" stretchy="false" xref="A1.E7.m1.48.48.48.19.19.19.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="A1.E7.m1.64.64.12.58.26.26.26.3.2" xref="A1.E7.m1.58.58.6a.cmml">⁢</mo><mrow id="A1.E7.m1.64.64.12.58.26.26.26.3.1.1" xref="A1.E7.m1.58.58.6.cmml"><mo id="A1.E7.m1.49.49.49.20.20.20" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">[</mo><munder id="A1.E7.m1.64.64.12.58.26.26.26.3.1.1.1" xref="A1.E7.m1.58.58.6.cmml"><munder accentunder="true" id="A1.E7.m1.50.50.50.21.21.21" xref="A1.E7.m1.50.50.50.21.21.21.cmml"><mrow id="A1.E7.m1.50.50.50.21.21.21.2" xref="A1.E7.m1.50.50.50.21.21.21.2.cmml"><msub id="A1.E7.m1.50.50.50.21.21.21.2.4" xref="A1.E7.m1.50.50.50.21.21.21.2.4.cmml"><mi id="A1.E7.m1.50.50.50.21.21.21.2.4.2" xref="A1.E7.m1.50.50.50.21.21.21.2.4.2.cmml">λ</mi><mi id="A1.E7.m1.50.50.50.21.21.21.2.4.3" xref="A1.E7.m1.50.50.50.21.21.21.2.4.3.cmml">t</mi></msub><mo id="A1.E7.m1.50.50.50.21.21.21.2.3" xref="A1.E7.m1.50.50.50.21.21.21.2.3.cmml">⁢</mo><msub id="A1.E7.m1.50.50.50.21.21.21.2.5" xref="A1.E7.m1.50.50.50.21.21.21.2.5.cmml"><mi id="A1.E7.m1.50.50.50.21.21.21.2.5.2" xref="A1.E7.m1.50.50.50.21.21.21.2.5.2.cmml">κ</mi><mi id="A1.E7.m1.50.50.50.21.21.21.2.5.3" xref="A1.E7.m1.50.50.50.21.21.21.2.5.3.cmml">𝐱</mi></msub><mo id="A1.E7.m1.50.50.50.21.21.21.2.3a" xref="A1.E7.m1.50.50.50.21.21.21.2.3.cmml">⁢</mo><msup id="A1.E7.m1.50.50.50.21.21.21.2.6" xref="A1.E7.m1.50.50.50.21.21.21.2.6.cmml"><mi id="A1.E7.m1.50.50.50.21.21.21.2.6.2" xref="A1.E7.m1.50.50.50.21.21.21.2.6.2.cmml">𝐲</mi><mi id="A1.E7.m1.50.50.50.21.21.21.2.6.3" xref="A1.E7.m1.50.50.50.21.21.21.2.6.3.cmml">T</mi></msup><mo id="A1.E7.m1.50.50.50.21.21.21.2.3b" xref="A1.E7.m1.50.50.50.21.21.21.2.3.cmml">⁢</mo><msub id="A1.E7.m1.50.50.50.21.21.21.2.7" xref="A1.E7.m1.50.50.50.21.21.21.2.7.cmml"><mi id="A1.E7.m1.50.50.50.21.21.21.2.7.2" xref="A1.E7.m1.50.50.50.21.21.21.2.7.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E7.m1.50.50.50.21.21.21.2.7.3" mathvariant="bold-italic" xref="A1.E7.m1.50.50.50.21.21.21.2.7.3.cmml">ϕ</mi></msub><mo id="A1.E7.m1.50.50.50.21.21.21.2.3c" xref="A1.E7.m1.50.50.50.21.21.21.2.3.cmml">⁢</mo><mrow id="A1.E7.m1.50.50.50.21.21.21.2.2.1" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml"><mo id="A1.E7.m1.50.50.50.21.21.21.2.2.1.2" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml">(</mo><msubsup id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml"><mover accent="true" id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.cmml"><mi id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.2" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.1" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.3" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.3.cmml">0</mn><mrow id="A1.E7.m1.50.50.50.21.21.21.1.1.1.3" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml"><mo id="A1.E7.m1.50.50.50.21.21.21.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml">(</mo><mi id="A1.E7.m1.50.50.50.21.21.21.1.1.1.1" xref="A1.E7.m1.50.50.50.21.21.21.1.1.1.1.cmml">t</mi><mo id="A1.E7.m1.50.50.50.21.21.21.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E7.m1.50.50.50.21.21.21.2.2.1.3" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.50.50.50.21.21.21.3" xref="A1.E7.m1.50.50.50.21.21.21.3.cmml">⏟</mo></munder><mtext id="A1.E7.m1.51.51.51.22.22.22.1" xref="A1.E7.m1.51.51.51.22.22.22.1a.cmml">inner-product term</mtext></munder><mo id="A1.E7.m1.52.52.52.23.23.23" maxsize="210%" minsize="210%" xref="A1.E7.m1.58.58.6a.cmml">]</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E7.m1.64b"><apply id="A1.E7.m1.58.58.6.cmml" xref="A1.E7.m1.64.64.12"><and id="A1.E7.m1.58.58.6a.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></and><apply id="A1.E7.m1.58.58.6b.cmml" xref="A1.E7.m1.64.64.12"><eq id="A1.E7.m1.11.11.11.11.1.1.cmml" xref="A1.E7.m1.11.11.11.11.1.1"></eq><apply id="A1.E7.m1.53.53.1.1.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.53.53.1.1.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.53.53.1.1.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.53.53.1.1.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1">ℒ</ci><ci id="A1.E7.m1.2.2.2.2.2.2.1.cmml" xref="A1.E7.m1.2.2.2.2.2.2.1">𝜽</ci></apply><vector id="A1.E7.m1.53.53.1.1.1.2.cmml" xref="A1.E7.m1.64.64.12"><apply id="A1.E7.m1.53.53.1.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.53.53.1.1.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><ci id="A1.E7.m1.4.4.4.4.4.4.cmml" xref="A1.E7.m1.4.4.4.4.4.4">𝐱</ci><cn id="A1.E7.m1.5.5.5.5.5.5.1.cmml" type="integer" xref="A1.E7.m1.5.5.5.5.5.5.1">0</cn></apply><ci id="A1.E7.m1.7.7.7.7.7.7.cmml" xref="A1.E7.m1.7.7.7.7.7.7">𝐲</ci><ci id="A1.E7.m1.9.9.9.9.9.9.cmml" xref="A1.E7.m1.9.9.9.9.9.9">𝐬</ci></vector></apply><apply id="A1.E7.m1.55.55.3.3.cmml" xref="A1.E7.m1.64.64.12"><plus id="A1.E7.m1.21.21.21.21.11.11.cmml" xref="A1.E7.m1.21.21.21.21.11.11"></plus><apply id="A1.E7.m1.54.54.2.2.1.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.54.54.2.2.1.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.54.54.2.2.1.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.54.54.2.2.1.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.12.12.12.12.2.2.cmml" xref="A1.E7.m1.12.12.12.12.2.2">𝔼</ci><apply id="A1.E7.m1.13.13.13.13.3.3.1.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1"><csymbol cd="latexml" id="A1.E7.m1.13.13.13.13.3.3.1.3.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.3">similar-to</csymbol><ci id="A1.E7.m1.13.13.13.13.3.3.1.4.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.4">𝑡</ci><apply id="A1.E7.m1.13.13.13.13.3.3.1.5.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.5"><times id="A1.E7.m1.13.13.13.13.3.3.1.5.1.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.5.1"></times><ci id="A1.E7.m1.13.13.13.13.3.3.1.5.2.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.5.2">𝒰</ci><interval closure="closed" id="A1.E7.m1.13.13.13.13.3.3.1.5.3.1.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.5.3.2"><cn id="A1.E7.m1.13.13.13.13.3.3.1.1.cmml" type="integer" xref="A1.E7.m1.13.13.13.13.3.3.1.1">2</cn><ci id="A1.E7.m1.13.13.13.13.3.3.1.2.cmml" xref="A1.E7.m1.13.13.13.13.3.3.1.2">𝑇</ci></interval></apply></apply></apply><apply id="A1.E7.m1.54.54.2.2.1.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="latexml" id="A1.E7.m1.54.54.2.2.1.1.2.1.cmml" xref="A1.E7.m1.64.64.12">delimited-[]</csymbol><apply id="A1.E7.m1.54.54.2.2.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><minus id="A1.E7.m1.17.17.17.17.7.7.cmml" xref="A1.E7.m1.17.17.17.17.7.7"></minus><apply id="A1.E7.m1.54.54.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.54.54.2.2.1.1.1.1.2.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.cmml" xref="A1.E7.m1.15.15.15.15.5.5"><ci id="A1.E7.m1.15.15.15.15.5.5.3.cmml" xref="A1.E7.m1.15.15.15.15.5.5.3">⏟</ci><apply id="A1.E7.m1.15.15.15.15.5.5.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2"><times id="A1.E7.m1.15.15.15.15.5.5.2.3.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.3"></times><apply id="A1.E7.m1.15.15.15.15.5.5.2.4.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.4"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.4.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.4">subscript</csymbol><ci id="A1.E7.m1.15.15.15.15.5.5.2.4.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.4.2">𝜇</ci><ci id="A1.E7.m1.15.15.15.15.5.5.2.4.3.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.4.3">𝑡</ci></apply><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.2.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2">superscript</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2">subscript</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.2.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1"><minus id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.1"></minus><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.2.3">0</cn></apply><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3">subscript</csymbol><apply id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2"><ci id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.E7.m1.15.15.15.15.5.5.1.1.1.1.cmml" xref="A1.E7.m1.15.15.15.15.5.5.1.1.1.1">𝑡</ci></apply></apply></apply><cn id="A1.E7.m1.15.15.15.15.5.5.2.2.1.3.cmml" type="integer" xref="A1.E7.m1.15.15.15.15.5.5.2.2.1.3">2</cn></apply><cn id="A1.E7.m1.15.15.15.15.5.5.2.2.3.cmml" type="integer" xref="A1.E7.m1.15.15.15.15.5.5.2.2.3">2</cn></apply></apply></apply><ci id="A1.E7.m1.16.16.16.16.6.6.1a.cmml" xref="A1.E7.m1.16.16.16.16.6.6.1"><mtext id="A1.E7.m1.16.16.16.16.6.6.1.cmml" mathsize="70%" xref="A1.E7.m1.16.16.16.16.6.6.1">denoising term</mtext></ci></apply><apply id="A1.E7.m1.54.54.2.2.1.1.1.1.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.54.54.2.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.18.18.18.18.8.8.cmml" xref="A1.E7.m1.18.18.18.18.8.8"><ci id="A1.E7.m1.18.18.18.18.8.8.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.3">⏟</ci><apply id="A1.E7.m1.18.18.18.18.8.8.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2"><times id="A1.E7.m1.18.18.18.18.8.8.2.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.3"></times><apply id="A1.E7.m1.18.18.18.18.8.8.2.4.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.4"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.4.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.4">subscript</csymbol><ci id="A1.E7.m1.18.18.18.18.8.8.2.4.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.4.2">𝜆</ci><ci id="A1.E7.m1.18.18.18.18.8.8.2.4.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.4.3">𝑡</ci></apply><apply id="A1.E7.m1.18.18.18.18.8.8.2.5.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.5"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.5.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.5">subscript</csymbol><ci id="A1.E7.m1.18.18.18.18.8.8.2.5.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.5.2">𝜅</ci><ci id="A1.E7.m1.18.18.18.18.8.8.2.5.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.5.3">𝐱</ci></apply><apply id="A1.E7.m1.18.18.18.18.8.8.2.6.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.6"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.6.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.6">superscript</csymbol><ci id="A1.E7.m1.18.18.18.18.8.8.2.6.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.6.2">𝐲</ci><ci id="A1.E7.m1.18.18.18.18.8.8.2.6.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.6.3">𝑇</ci></apply><apply id="A1.E7.m1.18.18.18.18.8.8.2.7.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.7"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.7.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.7">subscript</csymbol><ci id="A1.E7.m1.18.18.18.18.8.8.2.7.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.7.2">𝑓</ci><ci id="A1.E7.m1.18.18.18.18.8.8.2.7.3.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.7.3">bold-italic-ϕ</ci></apply><apply id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1">superscript</csymbol><apply id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1"><csymbol cd="ambiguous" id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1">subscript</csymbol><apply id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2"><ci id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.1">^</ci><ci id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.2.cmml" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.18.18.18.18.8.8.2.2.1.1.2.3">0</cn></apply><ci id="A1.E7.m1.18.18.18.18.8.8.1.1.1.1.cmml" xref="A1.E7.m1.18.18.18.18.8.8.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="A1.E7.m1.19.19.19.19.9.9.1a.cmml" xref="A1.E7.m1.19.19.19.19.9.9.1"><mtext id="A1.E7.m1.19.19.19.19.9.9.1.cmml" mathsize="70%" xref="A1.E7.m1.19.19.19.19.9.9.1">inner-product term</mtext></ci></apply></apply></apply></apply><apply id="A1.E7.m1.55.55.3.3.2.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.55.55.3.3.2.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.55.55.3.3.2.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.55.55.3.3.2.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.22.22.22.22.12.12.cmml" xref="A1.E7.m1.22.22.22.22.12.12">𝔼</ci><apply id="A1.E7.m1.23.23.23.23.13.13.1.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1"><times id="A1.E7.m1.23.23.23.23.13.13.1.2.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.2"></times><ci id="A1.E7.m1.23.23.23.23.13.13.1.3.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.3">𝑞</ci><apply id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.1.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.1">conditional</csymbol><apply id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.1.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.2.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.2.3">1</cn></apply><apply id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.1.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.2.cmml" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.2">𝐱</ci><cn id="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.3.cmml" type="integer" xref="A1.E7.m1.23.23.23.23.13.13.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="A1.E7.m1.55.55.3.3.2.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="latexml" id="A1.E7.m1.55.55.3.3.2.1.2.1.cmml" xref="A1.E7.m1.64.64.12">delimited-[]</csymbol><apply id="A1.E7.m1.55.55.3.3.2.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.55.55.3.3.2.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.cmml" xref="A1.E7.m1.25.25.25.25.15.15"><ci id="A1.E7.m1.25.25.25.25.15.15.3.cmml" xref="A1.E7.m1.25.25.25.25.15.15.3">⏟</ci><apply id="A1.E7.m1.25.25.25.25.15.15.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2"><times id="A1.E7.m1.25.25.25.25.15.15.2.3.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.3"></times><apply id="A1.E7.m1.25.25.25.25.15.15.2.4.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.4"><divide id="A1.E7.m1.25.25.25.25.15.15.2.4.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.4"></divide><cn id="A1.E7.m1.25.25.25.25.15.15.2.4.2.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.4.2">1</cn><cn id="A1.E7.m1.25.25.25.25.15.15.2.4.3.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.4.3">2</cn></apply><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.25.25.25.25.15.15.2.2.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2">superscript</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2">subscript</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.2.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1"><minus id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.1"></minus><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.2.3">0</cn></apply><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3">subscript</csymbol><apply id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2"><ci id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.1.1.1.3.2.3">0</cn></apply><cn id="A1.E7.m1.25.25.25.25.15.15.1.1.1.1.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.1.1.1.1">1</cn></apply></apply></apply><cn id="A1.E7.m1.25.25.25.25.15.15.2.2.1.3.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.2.1.3">2</cn></apply><cn id="A1.E7.m1.25.25.25.25.15.15.2.2.3.cmml" type="integer" xref="A1.E7.m1.25.25.25.25.15.15.2.2.3">2</cn></apply></apply></apply><ci id="A1.E7.m1.26.26.26.26.16.16.1a.cmml" xref="A1.E7.m1.26.26.26.26.16.16.1"><mtext id="A1.E7.m1.26.26.26.26.16.16.1.cmml" mathsize="70%" xref="A1.E7.m1.26.26.26.26.16.16.1">one-step reconstruction term</mtext></ci></apply></apply></apply><ci id="A1.E7.m1.29.29.29.29.19.19.cmml" xref="A1.E7.m1.29.29.29.29.19.19">𝐶</ci></apply></apply><apply id="A1.E7.m1.58.58.6c.cmml" xref="A1.E7.m1.64.64.12"><eq id="A1.E7.m1.30.30.30.1.1.1.cmml" xref="A1.E7.m1.30.30.30.1.1.1"></eq><share href="https://arxiv.org/html/2409.17576v1#A1.E7.m1.55.55.3.3.cmml" id="A1.E7.m1.58.58.6d.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></share><apply id="A1.E7.m1.58.58.6.6.cmml" xref="A1.E7.m1.64.64.12"><minus id="A1.E7.m1.46.46.46.17.17.17.cmml" xref="A1.E7.m1.46.46.46.17.17.17"></minus><apply id="A1.E7.m1.57.57.5.5.2.cmml" xref="A1.E7.m1.64.64.12"><plus id="A1.E7.m1.37.37.37.8.8.8.cmml" xref="A1.E7.m1.37.37.37.8.8.8"></plus><apply id="A1.E7.m1.56.56.4.4.1.1.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.56.56.4.4.1.1.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.56.56.4.4.1.1.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.56.56.4.4.1.1.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.31.31.31.2.2.2.cmml" xref="A1.E7.m1.31.31.31.2.2.2">𝔼</ci><apply id="A1.E7.m1.32.32.32.3.3.3.1.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1"><csymbol cd="latexml" id="A1.E7.m1.32.32.32.3.3.3.1.3.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.3">similar-to</csymbol><ci id="A1.E7.m1.32.32.32.3.3.3.1.4.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.4">𝑡</ci><apply id="A1.E7.m1.32.32.32.3.3.3.1.5.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.5"><times id="A1.E7.m1.32.32.32.3.3.3.1.5.1.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.5.1"></times><ci id="A1.E7.m1.32.32.32.3.3.3.1.5.2.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.5.2">𝒰</ci><interval closure="closed" id="A1.E7.m1.32.32.32.3.3.3.1.5.3.1.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.5.3.2"><cn id="A1.E7.m1.32.32.32.3.3.3.1.1.cmml" type="integer" xref="A1.E7.m1.32.32.32.3.3.3.1.1">2</cn><ci id="A1.E7.m1.32.32.32.3.3.3.1.2.cmml" xref="A1.E7.m1.32.32.32.3.3.3.1.2">𝑇</ci></interval></apply></apply></apply><apply id="A1.E7.m1.56.56.4.4.1.1.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="latexml" id="A1.E7.m1.56.56.4.4.1.1.1.2.1.cmml" xref="A1.E7.m1.64.64.12">delimited-[]</csymbol><apply id="A1.E7.m1.56.56.4.4.1.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.56.56.4.4.1.1.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.cmml" xref="A1.E7.m1.34.34.34.5.5.5"><ci id="A1.E7.m1.34.34.34.5.5.5.3.cmml" xref="A1.E7.m1.34.34.34.5.5.5.3">⏟</ci><apply id="A1.E7.m1.34.34.34.5.5.5.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2"><times id="A1.E7.m1.34.34.34.5.5.5.2.3.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.3"></times><apply id="A1.E7.m1.34.34.34.5.5.5.2.4.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.4"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.4.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.4">subscript</csymbol><ci id="A1.E7.m1.34.34.34.5.5.5.2.4.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.4.2">𝜇</ci><ci id="A1.E7.m1.34.34.34.5.5.5.2.4.3.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.4.3">𝑡</ci></apply><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.2.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2">superscript</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2">subscript</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.2.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1"><minus id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.1"></minus><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.2.3">0</cn></apply><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3">subscript</csymbol><apply id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2"><ci id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.E7.m1.34.34.34.5.5.5.1.1.1.1.cmml" xref="A1.E7.m1.34.34.34.5.5.5.1.1.1.1">𝑡</ci></apply></apply></apply><cn id="A1.E7.m1.34.34.34.5.5.5.2.2.1.3.cmml" type="integer" xref="A1.E7.m1.34.34.34.5.5.5.2.2.1.3">2</cn></apply><cn id="A1.E7.m1.34.34.34.5.5.5.2.2.3.cmml" type="integer" xref="A1.E7.m1.34.34.34.5.5.5.2.2.3">2</cn></apply></apply></apply><ci id="A1.E7.m1.35.35.35.6.6.6.1a.cmml" xref="A1.E7.m1.35.35.35.6.6.6.1"><mtext id="A1.E7.m1.35.35.35.6.6.6.1.cmml" mathsize="70%" xref="A1.E7.m1.35.35.35.6.6.6.1">denoising term</mtext></ci></apply></apply></apply><apply id="A1.E7.m1.57.57.5.5.2.2.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.57.57.5.5.2.2.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.57.57.5.5.2.2.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.57.57.5.5.2.2.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.38.38.38.9.9.9.cmml" xref="A1.E7.m1.38.38.38.9.9.9">𝔼</ci><apply id="A1.E7.m1.39.39.39.10.10.10.1.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1"><times id="A1.E7.m1.39.39.39.10.10.10.1.2.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.2"></times><ci id="A1.E7.m1.39.39.39.10.10.10.1.3.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.3">𝑞</ci><apply id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.1.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.1">conditional</csymbol><apply id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.1.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.2.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.2.3">1</cn></apply><apply id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.1.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.2.cmml" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.2">𝐱</ci><cn id="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.3.cmml" type="integer" xref="A1.E7.m1.39.39.39.10.10.10.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="A1.E7.m1.57.57.5.5.2.2.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="latexml" id="A1.E7.m1.57.57.5.5.2.2.1.2.1.cmml" xref="A1.E7.m1.64.64.12">delimited-[]</csymbol><apply id="A1.E7.m1.57.57.5.5.2.2.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.57.57.5.5.2.2.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.cmml" xref="A1.E7.m1.41.41.41.12.12.12"><ci id="A1.E7.m1.41.41.41.12.12.12.3.cmml" xref="A1.E7.m1.41.41.41.12.12.12.3">⏟</ci><apply id="A1.E7.m1.41.41.41.12.12.12.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2"><times id="A1.E7.m1.41.41.41.12.12.12.2.3.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.3"></times><apply id="A1.E7.m1.41.41.41.12.12.12.2.4.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.4"><divide id="A1.E7.m1.41.41.41.12.12.12.2.4.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.4"></divide><cn id="A1.E7.m1.41.41.41.12.12.12.2.4.2.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.4.2">1</cn><cn id="A1.E7.m1.41.41.41.12.12.12.2.4.3.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.4.3">2</cn></apply><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.41.41.41.12.12.12.2.2.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2">superscript</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2">subscript</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.2.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1"><minus id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.1"></minus><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.2">𝐱</ci><cn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.2.3">0</cn></apply><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3">subscript</csymbol><apply id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2"><ci id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.1">^</ci><ci id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.1.1.1.3.2.3">0</cn></apply><cn id="A1.E7.m1.41.41.41.12.12.12.1.1.1.1.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.1.1.1.1">1</cn></apply></apply></apply><cn id="A1.E7.m1.41.41.41.12.12.12.2.2.1.3.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.2.1.3">2</cn></apply><cn id="A1.E7.m1.41.41.41.12.12.12.2.2.3.cmml" type="integer" xref="A1.E7.m1.41.41.41.12.12.12.2.2.3">2</cn></apply></apply></apply><ci id="A1.E7.m1.42.42.42.13.13.13.1a.cmml" xref="A1.E7.m1.42.42.42.13.13.13.1"><mtext id="A1.E7.m1.42.42.42.13.13.13.1.cmml" mathsize="70%" xref="A1.E7.m1.42.42.42.13.13.13.1">one-step reconstruction term</mtext></ci></apply></apply></apply><ci id="A1.E7.m1.45.45.45.16.16.16.cmml" xref="A1.E7.m1.45.45.45.16.16.16">𝐶</ci></apply><apply id="A1.E7.m1.58.58.6.6.3.cmml" xref="A1.E7.m1.64.64.12"><times id="A1.E7.m1.58.58.6.6.3.2.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12"></times><apply id="A1.E7.m1.58.58.6.6.3.3.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.58.58.6.6.3.3.1.cmml" xref="A1.E7.m1.59.59.7.53.30.11.12">subscript</csymbol><ci id="A1.E7.m1.47.47.47.18.18.18.cmml" xref="A1.E7.m1.47.47.47.18.18.18">𝔼</ci><apply id="A1.E7.m1.48.48.48.19.19.19.1.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1"><csymbol cd="latexml" id="A1.E7.m1.48.48.48.19.19.19.1.3.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.3">similar-to</csymbol><ci id="A1.E7.m1.48.48.48.19.19.19.1.4.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.4">𝑡</ci><apply id="A1.E7.m1.48.48.48.19.19.19.1.5.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.5"><times id="A1.E7.m1.48.48.48.19.19.19.1.5.1.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.5.1"></times><ci id="A1.E7.m1.48.48.48.19.19.19.1.5.2.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.5.2">𝒰</ci><interval closure="closed" id="A1.E7.m1.48.48.48.19.19.19.1.5.3.1.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.5.3.2"><cn id="A1.E7.m1.48.48.48.19.19.19.1.1.cmml" type="integer" xref="A1.E7.m1.48.48.48.19.19.19.1.1">2</cn><ci id="A1.E7.m1.48.48.48.19.19.19.1.2.cmml" xref="A1.E7.m1.48.48.48.19.19.19.1.2">𝑇</ci></interval></apply></apply></apply><apply id="A1.E7.m1.58.58.6.6.3.1.2.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="latexml" id="A1.E7.m1.58.58.6.6.3.1.2.1.cmml" xref="A1.E7.m1.64.64.12">delimited-[]</csymbol><apply id="A1.E7.m1.58.58.6.6.3.1.1.1.cmml" xref="A1.E7.m1.64.64.12"><csymbol cd="ambiguous" id="A1.E7.m1.58.58.6.6.3.1.1.1.1.cmml" xref="A1.E7.m1.64.64.12">subscript</csymbol><apply id="A1.E7.m1.50.50.50.21.21.21.cmml" xref="A1.E7.m1.50.50.50.21.21.21"><ci id="A1.E7.m1.50.50.50.21.21.21.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.3">⏟</ci><apply id="A1.E7.m1.50.50.50.21.21.21.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2"><times id="A1.E7.m1.50.50.50.21.21.21.2.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.3"></times><apply id="A1.E7.m1.50.50.50.21.21.21.2.4.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.4"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.4.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.4">subscript</csymbol><ci id="A1.E7.m1.50.50.50.21.21.21.2.4.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.4.2">𝜆</ci><ci id="A1.E7.m1.50.50.50.21.21.21.2.4.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.4.3">𝑡</ci></apply><apply id="A1.E7.m1.50.50.50.21.21.21.2.5.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.5"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.5.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.5">subscript</csymbol><ci id="A1.E7.m1.50.50.50.21.21.21.2.5.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.5.2">𝜅</ci><ci id="A1.E7.m1.50.50.50.21.21.21.2.5.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.5.3">𝐱</ci></apply><apply id="A1.E7.m1.50.50.50.21.21.21.2.6.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.6"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.6.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.6">superscript</csymbol><ci id="A1.E7.m1.50.50.50.21.21.21.2.6.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.6.2">𝐲</ci><ci id="A1.E7.m1.50.50.50.21.21.21.2.6.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.6.3">𝑇</ci></apply><apply id="A1.E7.m1.50.50.50.21.21.21.2.7.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.7"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.7.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.7">subscript</csymbol><ci id="A1.E7.m1.50.50.50.21.21.21.2.7.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.7.2">𝑓</ci><ci id="A1.E7.m1.50.50.50.21.21.21.2.7.3.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.7.3">bold-italic-ϕ</ci></apply><apply id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1">superscript</csymbol><apply id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1"><csymbol cd="ambiguous" id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1">subscript</csymbol><apply id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2"><ci id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.1">^</ci><ci id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.2.cmml" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.3.cmml" type="integer" xref="A1.E7.m1.50.50.50.21.21.21.2.2.1.1.2.3">0</cn></apply><ci id="A1.E7.m1.50.50.50.21.21.21.1.1.1.1.cmml" xref="A1.E7.m1.50.50.50.21.21.21.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="A1.E7.m1.51.51.51.22.22.22.1a.cmml" xref="A1.E7.m1.51.51.51.22.22.22.1"><mtext id="A1.E7.m1.51.51.51.22.22.22.1.cmml" mathsize="70%" xref="A1.E7.m1.51.51.51.22.22.22.1">inner-product term</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.64c">\begin{split}\mathcal{L}_{\bm{\theta}}(\mathbf{x}_{0},\mathbf{y},\mathbf{s})&amp;=%
\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}-\underbrace{\lambda_{t}\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{%
\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term}}%
\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[\underbrace{\frac{%
1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}\right\rVert_{2}^{2}}%
_{\text{one-step reconstruction term}}\right]+C\\
&amp;=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}\left\lVert%
\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{\text{%
denoising term}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}\left[%
\underbrace{\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(1)}%
\right\rVert_{2}^{2}}_{\text{one-step reconstruction term}}\right]+C-\mathbb{E%
}_{t\sim\mathcal{U}[2,T]}{\bigg{[}\underbrace{\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}\bigg{]}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.64d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_y , bold_s ) end_CELL start_CELL = blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ under⏟ start_ARG italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT denoising term end_POSTSUBSCRIPT - under⏟ start_ARG italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ under⏟ start_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT one-step reconstruction term end_POSTSUBSCRIPT ] + italic_C end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ under⏟ start_ARG italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT denoising term end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ under⏟ start_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT one-step reconstruction term end_POSTSUBSCRIPT ] + italic_C - blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ under⏟ start_ARG italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT ] end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.1">It can be shown that the reversed likelihood <math alttext="p(\mathbf{y},\mathbf{s}|\mathbf{x})" class="ltx_Math" display="inline" id="A1.3.p1.1.m1.2"><semantics id="A1.3.p1.1.m1.2a"><mrow id="A1.3.p1.1.m1.2.2" xref="A1.3.p1.1.m1.2.2.cmml"><mi id="A1.3.p1.1.m1.2.2.3" xref="A1.3.p1.1.m1.2.2.3.cmml">p</mi><mo id="A1.3.p1.1.m1.2.2.2" xref="A1.3.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A1.3.p1.1.m1.2.2.1.1" xref="A1.3.p1.1.m1.2.2.1.2.cmml"><mo id="A1.3.p1.1.m1.2.2.1.1.2" stretchy="false" xref="A1.3.p1.1.m1.2.2.1.2.cmml">(</mo><mi id="A1.3.p1.1.m1.1.1" xref="A1.3.p1.1.m1.1.1.cmml">𝐲</mi><mo id="A1.3.p1.1.m1.2.2.1.1.3" xref="A1.3.p1.1.m1.2.2.1.2.cmml">,</mo><mrow id="A1.3.p1.1.m1.2.2.1.1.1" xref="A1.3.p1.1.m1.2.2.1.1.1.cmml"><mi id="A1.3.p1.1.m1.2.2.1.1.1.2" xref="A1.3.p1.1.m1.2.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.3.p1.1.m1.2.2.1.1.1.1" xref="A1.3.p1.1.m1.2.2.1.1.1.1.cmml">|</mo><mi id="A1.3.p1.1.m1.2.2.1.1.1.3" xref="A1.3.p1.1.m1.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.3.p1.1.m1.2.2.1.1.4" stretchy="false" xref="A1.3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.1.m1.2b"><apply id="A1.3.p1.1.m1.2.2.cmml" xref="A1.3.p1.1.m1.2.2"><times id="A1.3.p1.1.m1.2.2.2.cmml" xref="A1.3.p1.1.m1.2.2.2"></times><ci id="A1.3.p1.1.m1.2.2.3.cmml" xref="A1.3.p1.1.m1.2.2.3">𝑝</ci><interval closure="open" id="A1.3.p1.1.m1.2.2.1.2.cmml" xref="A1.3.p1.1.m1.2.2.1.1"><ci id="A1.3.p1.1.m1.1.1.cmml" xref="A1.3.p1.1.m1.1.1">𝐲</ci><apply id="A1.3.p1.1.m1.2.2.1.1.1.cmml" xref="A1.3.p1.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.3.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.3.p1.1.m1.2.2.1.1.1.1">conditional</csymbol><ci id="A1.3.p1.1.m1.2.2.1.1.1.2.cmml" xref="A1.3.p1.1.m1.2.2.1.1.1.2">𝐬</ci><ci id="A1.3.p1.1.m1.2.2.1.1.1.3.cmml" xref="A1.3.p1.1.m1.2.2.1.1.1.3">𝐱</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.1.m1.2c">p(\mathbf{y},\mathbf{s}|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.1.m1.2d">italic_p ( bold_y , bold_s | bold_x )</annotation></semantics></math> is a joint vMF density <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Xu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>; <span class="ltx_text" style="font-size:90%;">Hasnat et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">2017</span></a>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx2">
<tbody id="A1.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(\mathbf{y},\mathbf{s}|\mathbf{x})\overset{\underset{(1)}{}}{=}%
p(\mathbf{y}|\mathbf{s},\mathbf{x})p(\mathbf{s}|\mathbf{x})\overset{\underset{%
(2)}{}}{=}p(\mathbf{y}|\mathbf{x})p(\mathbf{s}|\mathbf{x})\overset{\underset{(%
3)}{}}{=}J_{\kappa_{\mathbf{x}}}^{2}\exp{\left(\kappa_{\mathbf{x}}(\mathbf{y}^%
{T}f_{\bm{\phi}}\left(\mathbf{x}\right)+\mathbf{s}^{T}{F_{a}}(\mathbf{x}))%
\right)}" class="ltx_Math" display="inline" id="A1.E8.m1.15"><semantics id="A1.E8.m1.15a"><mrow id="A1.E8.m1.15.15" xref="A1.E8.m1.15.15.cmml"><mi id="A1.E8.m1.15.15.8" xref="A1.E8.m1.15.15.8.cmml">p</mi><mo id="A1.E8.m1.15.15.7" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.10.10.1.1" xref="A1.E8.m1.10.10.1.2.cmml"><mo id="A1.E8.m1.10.10.1.1.2" stretchy="false" xref="A1.E8.m1.10.10.1.2.cmml">(</mo><mi id="A1.E8.m1.4.4" xref="A1.E8.m1.4.4.cmml">𝐲</mi><mo id="A1.E8.m1.10.10.1.1.3" xref="A1.E8.m1.10.10.1.2.cmml">,</mo><mrow id="A1.E8.m1.10.10.1.1.1" xref="A1.E8.m1.10.10.1.1.1.cmml"><mi id="A1.E8.m1.10.10.1.1.1.2" xref="A1.E8.m1.10.10.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E8.m1.10.10.1.1.1.1" xref="A1.E8.m1.10.10.1.1.1.1.cmml">|</mo><mi id="A1.E8.m1.10.10.1.1.1.3" xref="A1.E8.m1.10.10.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E8.m1.10.10.1.1.4" stretchy="false" xref="A1.E8.m1.10.10.1.2.cmml">)</mo></mrow><mo id="A1.E8.m1.15.15.7a" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mover accent="true" id="A1.E8.m1.1.1" xref="A1.E8.m1.1.1.cmml"><mo id="A1.E8.m1.1.1.2" xref="A1.E8.m1.1.1.2.cmml">=</mo><munder accentunder="true" id="A1.E8.m1.1.1.1" xref="A1.E8.m1.1.1.1.cmml"><mi id="A1.E8.m1.1.1.1.2" xref="A1.E8.m1.1.1.1.2.cmml"></mi><mrow id="A1.E8.m1.1.1.1.1.3" xref="A1.E8.m1.1.1.1.cmml"><mo id="A1.E8.m1.1.1.1.1.3.1" stretchy="false" xref="A1.E8.m1.1.1.1.cmml">(</mo><mn id="A1.E8.m1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.cmml">1</mn><mo id="A1.E8.m1.1.1.1.1.3.2" stretchy="false" xref="A1.E8.m1.1.1.1.cmml">)</mo></mrow></munder></mover><mo id="A1.E8.m1.15.15.7b" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mi id="A1.E8.m1.15.15.9" xref="A1.E8.m1.15.15.9.cmml">p</mi><mo id="A1.E8.m1.15.15.7c" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.11.11.2.1" xref="A1.E8.m1.11.11.2.1.1.cmml"><mo id="A1.E8.m1.11.11.2.1.2" stretchy="false" xref="A1.E8.m1.11.11.2.1.1.cmml">(</mo><mrow id="A1.E8.m1.11.11.2.1.1" xref="A1.E8.m1.11.11.2.1.1.cmml"><mi id="A1.E8.m1.11.11.2.1.1.2" xref="A1.E8.m1.11.11.2.1.1.2.cmml">𝐲</mi><mo fence="false" id="A1.E8.m1.11.11.2.1.1.1" xref="A1.E8.m1.11.11.2.1.1.1.cmml">|</mo><mrow id="A1.E8.m1.11.11.2.1.1.3.2" xref="A1.E8.m1.11.11.2.1.1.3.1.cmml"><mi id="A1.E8.m1.5.5" xref="A1.E8.m1.5.5.cmml">𝐬</mi><mo id="A1.E8.m1.11.11.2.1.1.3.2.1" xref="A1.E8.m1.11.11.2.1.1.3.1.cmml">,</mo><mi id="A1.E8.m1.6.6" xref="A1.E8.m1.6.6.cmml">𝐱</mi></mrow></mrow><mo id="A1.E8.m1.11.11.2.1.3" stretchy="false" xref="A1.E8.m1.11.11.2.1.1.cmml">)</mo></mrow><mo id="A1.E8.m1.15.15.7d" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mi id="A1.E8.m1.15.15.10" xref="A1.E8.m1.15.15.10.cmml">p</mi><mo id="A1.E8.m1.15.15.7e" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.12.12.3.1" xref="A1.E8.m1.12.12.3.1.1.cmml"><mo id="A1.E8.m1.12.12.3.1.2" stretchy="false" xref="A1.E8.m1.12.12.3.1.1.cmml">(</mo><mrow id="A1.E8.m1.12.12.3.1.1" xref="A1.E8.m1.12.12.3.1.1.cmml"><mi id="A1.E8.m1.12.12.3.1.1.2" xref="A1.E8.m1.12.12.3.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E8.m1.12.12.3.1.1.1" xref="A1.E8.m1.12.12.3.1.1.1.cmml">|</mo><mi id="A1.E8.m1.12.12.3.1.1.3" xref="A1.E8.m1.12.12.3.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E8.m1.12.12.3.1.3" stretchy="false" xref="A1.E8.m1.12.12.3.1.1.cmml">)</mo></mrow><mo id="A1.E8.m1.15.15.7f" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mover accent="true" id="A1.E8.m1.2.2" xref="A1.E8.m1.2.2.cmml"><mo id="A1.E8.m1.2.2.2" xref="A1.E8.m1.2.2.2.cmml">=</mo><munder accentunder="true" id="A1.E8.m1.2.2.1" xref="A1.E8.m1.2.2.1.cmml"><mi id="A1.E8.m1.2.2.1.2" xref="A1.E8.m1.2.2.1.2.cmml"></mi><mrow id="A1.E8.m1.2.2.1.1.3" xref="A1.E8.m1.2.2.1.cmml"><mo id="A1.E8.m1.2.2.1.1.3.1" stretchy="false" xref="A1.E8.m1.2.2.1.cmml">(</mo><mn id="A1.E8.m1.2.2.1.1.1" xref="A1.E8.m1.2.2.1.1.1.cmml">2</mn><mo id="A1.E8.m1.2.2.1.1.3.2" stretchy="false" xref="A1.E8.m1.2.2.1.cmml">)</mo></mrow></munder></mover><mo id="A1.E8.m1.15.15.7g" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mi id="A1.E8.m1.15.15.11" xref="A1.E8.m1.15.15.11.cmml">p</mi><mo id="A1.E8.m1.15.15.7h" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.13.13.4.1" xref="A1.E8.m1.13.13.4.1.1.cmml"><mo id="A1.E8.m1.13.13.4.1.2" stretchy="false" xref="A1.E8.m1.13.13.4.1.1.cmml">(</mo><mrow id="A1.E8.m1.13.13.4.1.1" xref="A1.E8.m1.13.13.4.1.1.cmml"><mi id="A1.E8.m1.13.13.4.1.1.2" xref="A1.E8.m1.13.13.4.1.1.2.cmml">𝐲</mi><mo fence="false" id="A1.E8.m1.13.13.4.1.1.1" xref="A1.E8.m1.13.13.4.1.1.1.cmml">|</mo><mi id="A1.E8.m1.13.13.4.1.1.3" xref="A1.E8.m1.13.13.4.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E8.m1.13.13.4.1.3" stretchy="false" xref="A1.E8.m1.13.13.4.1.1.cmml">)</mo></mrow><mo id="A1.E8.m1.15.15.7i" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mi id="A1.E8.m1.15.15.12" xref="A1.E8.m1.15.15.12.cmml">p</mi><mo id="A1.E8.m1.15.15.7j" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.14.14.5.1" xref="A1.E8.m1.14.14.5.1.1.cmml"><mo id="A1.E8.m1.14.14.5.1.2" stretchy="false" xref="A1.E8.m1.14.14.5.1.1.cmml">(</mo><mrow id="A1.E8.m1.14.14.5.1.1" xref="A1.E8.m1.14.14.5.1.1.cmml"><mi id="A1.E8.m1.14.14.5.1.1.2" xref="A1.E8.m1.14.14.5.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E8.m1.14.14.5.1.1.1" xref="A1.E8.m1.14.14.5.1.1.1.cmml">|</mo><mi id="A1.E8.m1.14.14.5.1.1.3" xref="A1.E8.m1.14.14.5.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E8.m1.14.14.5.1.3" stretchy="false" xref="A1.E8.m1.14.14.5.1.1.cmml">)</mo></mrow><mo id="A1.E8.m1.15.15.7k" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mover accent="true" id="A1.E8.m1.3.3" xref="A1.E8.m1.3.3.cmml"><mo id="A1.E8.m1.3.3.2" xref="A1.E8.m1.3.3.2.cmml">=</mo><munder accentunder="true" id="A1.E8.m1.3.3.1" xref="A1.E8.m1.3.3.1.cmml"><mi id="A1.E8.m1.3.3.1.2" xref="A1.E8.m1.3.3.1.2.cmml"></mi><mrow id="A1.E8.m1.3.3.1.1.3" xref="A1.E8.m1.3.3.1.cmml"><mo id="A1.E8.m1.3.3.1.1.3.1" stretchy="false" xref="A1.E8.m1.3.3.1.cmml">(</mo><mn id="A1.E8.m1.3.3.1.1.1" xref="A1.E8.m1.3.3.1.1.1.cmml">3</mn><mo id="A1.E8.m1.3.3.1.1.3.2" stretchy="false" xref="A1.E8.m1.3.3.1.cmml">)</mo></mrow></munder></mover><mo id="A1.E8.m1.15.15.7l" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><msubsup id="A1.E8.m1.15.15.13" xref="A1.E8.m1.15.15.13.cmml"><mi id="A1.E8.m1.15.15.13.2.2" xref="A1.E8.m1.15.15.13.2.2.cmml">J</mi><msub id="A1.E8.m1.15.15.13.2.3" xref="A1.E8.m1.15.15.13.2.3.cmml"><mi id="A1.E8.m1.15.15.13.2.3.2" xref="A1.E8.m1.15.15.13.2.3.2.cmml">κ</mi><mi id="A1.E8.m1.15.15.13.2.3.3" xref="A1.E8.m1.15.15.13.2.3.3.cmml">𝐱</mi></msub><mn id="A1.E8.m1.15.15.13.3" xref="A1.E8.m1.15.15.13.3.cmml">2</mn></msubsup><mo id="A1.E8.m1.15.15.7m" lspace="0.167em" xref="A1.E8.m1.15.15.7.cmml">⁢</mo><mrow id="A1.E8.m1.15.15.6.1" xref="A1.E8.m1.15.15.6.2.cmml"><mi id="A1.E8.m1.9.9" xref="A1.E8.m1.9.9.cmml">exp</mi><mo id="A1.E8.m1.15.15.6.1a" xref="A1.E8.m1.15.15.6.2.cmml">⁡</mo><mrow id="A1.E8.m1.15.15.6.1.1" xref="A1.E8.m1.15.15.6.2.cmml"><mo id="A1.E8.m1.15.15.6.1.1.2" xref="A1.E8.m1.15.15.6.2.cmml">(</mo><mrow id="A1.E8.m1.15.15.6.1.1.1" xref="A1.E8.m1.15.15.6.1.1.1.cmml"><msub id="A1.E8.m1.15.15.6.1.1.1.3" xref="A1.E8.m1.15.15.6.1.1.1.3.cmml"><mi id="A1.E8.m1.15.15.6.1.1.1.3.2" xref="A1.E8.m1.15.15.6.1.1.1.3.2.cmml">κ</mi><mi id="A1.E8.m1.15.15.6.1.1.1.3.3" xref="A1.E8.m1.15.15.6.1.1.1.3.3.cmml">𝐱</mi></msub><mo id="A1.E8.m1.15.15.6.1.1.1.2" xref="A1.E8.m1.15.15.6.1.1.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.cmml"><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.2" stretchy="false" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.cmml"><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.cmml"><msup id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.2.cmml">𝐲</mi><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.3.cmml">T</mi></msup><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.3" mathvariant="bold-italic" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.3.cmml">ϕ</mi></msub><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1a" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.4.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.cmml"><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.4.2.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E8.m1.7.7" xref="A1.E8.m1.7.7.cmml">𝐱</mi><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.4.2.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.cmml"><msup id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.2.cmml">𝐬</mi><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.3.cmml">T</mi></msup><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.2.cmml">F</mi><mi id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.3" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.3.cmml">a</mi></msub><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1a" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.4.2" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.cmml"><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.4.2.1" stretchy="false" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E8.m1.8.8" xref="A1.E8.m1.8.8.cmml">𝐱</mi><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.4.2.2" stretchy="false" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E8.m1.15.15.6.1.1.1.1.1.3" stretchy="false" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.15.15.6.1.1.3" xref="A1.E8.m1.15.15.6.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.15b"><apply id="A1.E8.m1.15.15.cmml" xref="A1.E8.m1.15.15"><times id="A1.E8.m1.15.15.7.cmml" xref="A1.E8.m1.15.15.7"></times><ci id="A1.E8.m1.15.15.8.cmml" xref="A1.E8.m1.15.15.8">𝑝</ci><interval closure="open" id="A1.E8.m1.10.10.1.2.cmml" xref="A1.E8.m1.10.10.1.1"><ci id="A1.E8.m1.4.4.cmml" xref="A1.E8.m1.4.4">𝐲</ci><apply id="A1.E8.m1.10.10.1.1.1.cmml" xref="A1.E8.m1.10.10.1.1.1"><csymbol cd="latexml" id="A1.E8.m1.10.10.1.1.1.1.cmml" xref="A1.E8.m1.10.10.1.1.1.1">conditional</csymbol><ci id="A1.E8.m1.10.10.1.1.1.2.cmml" xref="A1.E8.m1.10.10.1.1.1.2">𝐬</ci><ci id="A1.E8.m1.10.10.1.1.1.3.cmml" xref="A1.E8.m1.10.10.1.1.1.3">𝐱</ci></apply></interval><apply id="A1.E8.m1.1.1.cmml" xref="A1.E8.m1.1.1"><apply id="A1.E8.m1.1.1.1.cmml" xref="A1.E8.m1.1.1.1"><cn id="A1.E8.m1.1.1.1.1.1.cmml" type="integer" xref="A1.E8.m1.1.1.1.1.1">1</cn><csymbol cd="latexml" id="A1.E8.m1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.2">absent</csymbol></apply><eq id="A1.E8.m1.1.1.2.cmml" xref="A1.E8.m1.1.1.2"></eq></apply><ci id="A1.E8.m1.15.15.9.cmml" xref="A1.E8.m1.15.15.9">𝑝</ci><apply id="A1.E8.m1.11.11.2.1.1.cmml" xref="A1.E8.m1.11.11.2.1"><csymbol cd="latexml" id="A1.E8.m1.11.11.2.1.1.1.cmml" xref="A1.E8.m1.11.11.2.1.1.1">conditional</csymbol><ci id="A1.E8.m1.11.11.2.1.1.2.cmml" xref="A1.E8.m1.11.11.2.1.1.2">𝐲</ci><list id="A1.E8.m1.11.11.2.1.1.3.1.cmml" xref="A1.E8.m1.11.11.2.1.1.3.2"><ci id="A1.E8.m1.5.5.cmml" xref="A1.E8.m1.5.5">𝐬</ci><ci id="A1.E8.m1.6.6.cmml" xref="A1.E8.m1.6.6">𝐱</ci></list></apply><ci id="A1.E8.m1.15.15.10.cmml" xref="A1.E8.m1.15.15.10">𝑝</ci><apply id="A1.E8.m1.12.12.3.1.1.cmml" xref="A1.E8.m1.12.12.3.1"><csymbol cd="latexml" id="A1.E8.m1.12.12.3.1.1.1.cmml" xref="A1.E8.m1.12.12.3.1.1.1">conditional</csymbol><ci id="A1.E8.m1.12.12.3.1.1.2.cmml" xref="A1.E8.m1.12.12.3.1.1.2">𝐬</ci><ci id="A1.E8.m1.12.12.3.1.1.3.cmml" xref="A1.E8.m1.12.12.3.1.1.3">𝐱</ci></apply><apply id="A1.E8.m1.2.2.cmml" xref="A1.E8.m1.2.2"><apply id="A1.E8.m1.2.2.1.cmml" xref="A1.E8.m1.2.2.1"><cn id="A1.E8.m1.2.2.1.1.1.cmml" type="integer" xref="A1.E8.m1.2.2.1.1.1">2</cn><csymbol cd="latexml" id="A1.E8.m1.2.2.1.2.cmml" xref="A1.E8.m1.2.2.1.2">absent</csymbol></apply><eq id="A1.E8.m1.2.2.2.cmml" xref="A1.E8.m1.2.2.2"></eq></apply><ci id="A1.E8.m1.15.15.11.cmml" xref="A1.E8.m1.15.15.11">𝑝</ci><apply id="A1.E8.m1.13.13.4.1.1.cmml" xref="A1.E8.m1.13.13.4.1"><csymbol cd="latexml" id="A1.E8.m1.13.13.4.1.1.1.cmml" xref="A1.E8.m1.13.13.4.1.1.1">conditional</csymbol><ci id="A1.E8.m1.13.13.4.1.1.2.cmml" xref="A1.E8.m1.13.13.4.1.1.2">𝐲</ci><ci id="A1.E8.m1.13.13.4.1.1.3.cmml" xref="A1.E8.m1.13.13.4.1.1.3">𝐱</ci></apply><ci id="A1.E8.m1.15.15.12.cmml" xref="A1.E8.m1.15.15.12">𝑝</ci><apply id="A1.E8.m1.14.14.5.1.1.cmml" xref="A1.E8.m1.14.14.5.1"><csymbol cd="latexml" id="A1.E8.m1.14.14.5.1.1.1.cmml" xref="A1.E8.m1.14.14.5.1.1.1">conditional</csymbol><ci id="A1.E8.m1.14.14.5.1.1.2.cmml" xref="A1.E8.m1.14.14.5.1.1.2">𝐬</ci><ci id="A1.E8.m1.14.14.5.1.1.3.cmml" xref="A1.E8.m1.14.14.5.1.1.3">𝐱</ci></apply><apply id="A1.E8.m1.3.3.cmml" xref="A1.E8.m1.3.3"><apply id="A1.E8.m1.3.3.1.cmml" xref="A1.E8.m1.3.3.1"><cn id="A1.E8.m1.3.3.1.1.1.cmml" type="integer" xref="A1.E8.m1.3.3.1.1.1">3</cn><csymbol cd="latexml" id="A1.E8.m1.3.3.1.2.cmml" xref="A1.E8.m1.3.3.1.2">absent</csymbol></apply><eq id="A1.E8.m1.3.3.2.cmml" xref="A1.E8.m1.3.3.2"></eq></apply><apply id="A1.E8.m1.15.15.13.cmml" xref="A1.E8.m1.15.15.13"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.13.1.cmml" xref="A1.E8.m1.15.15.13">superscript</csymbol><apply id="A1.E8.m1.15.15.13.2.cmml" xref="A1.E8.m1.15.15.13"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.13.2.1.cmml" xref="A1.E8.m1.15.15.13">subscript</csymbol><ci id="A1.E8.m1.15.15.13.2.2.cmml" xref="A1.E8.m1.15.15.13.2.2">𝐽</ci><apply id="A1.E8.m1.15.15.13.2.3.cmml" xref="A1.E8.m1.15.15.13.2.3"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.13.2.3.1.cmml" xref="A1.E8.m1.15.15.13.2.3">subscript</csymbol><ci id="A1.E8.m1.15.15.13.2.3.2.cmml" xref="A1.E8.m1.15.15.13.2.3.2">𝜅</ci><ci id="A1.E8.m1.15.15.13.2.3.3.cmml" xref="A1.E8.m1.15.15.13.2.3.3">𝐱</ci></apply></apply><cn id="A1.E8.m1.15.15.13.3.cmml" type="integer" xref="A1.E8.m1.15.15.13.3">2</cn></apply><apply id="A1.E8.m1.15.15.6.2.cmml" xref="A1.E8.m1.15.15.6.1"><exp id="A1.E8.m1.9.9.cmml" xref="A1.E8.m1.9.9"></exp><apply id="A1.E8.m1.15.15.6.1.1.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1"><times id="A1.E8.m1.15.15.6.1.1.1.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.2"></times><apply id="A1.E8.m1.15.15.6.1.1.1.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.3"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.6.1.1.1.3.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.3">subscript</csymbol><ci id="A1.E8.m1.15.15.6.1.1.1.3.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.3.2">𝜅</ci><ci id="A1.E8.m1.15.15.6.1.1.1.3.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.3.3">𝐱</ci></apply><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1"><plus id="A1.E8.m1.15.15.6.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.1"></plus><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2"><times id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.1"></times><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.2">𝐲</ci><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.2">𝑓</ci><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.2.3.3">bold-italic-ϕ</ci></apply><ci id="A1.E8.m1.7.7.cmml" xref="A1.E8.m1.7.7">𝐱</ci></apply><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3"><times id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.1"></times><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.2">𝐬</ci><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.2">𝐹</ci><ci id="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E8.m1.15.15.6.1.1.1.1.1.1.3.3.3">𝑎</ci></apply><ci id="A1.E8.m1.8.8.cmml" xref="A1.E8.m1.8.8">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.15c">\displaystyle p(\mathbf{y},\mathbf{s}|\mathbf{x})\overset{\underset{(1)}{}}{=}%
p(\mathbf{y}|\mathbf{s},\mathbf{x})p(\mathbf{s}|\mathbf{x})\overset{\underset{%
(2)}{}}{=}p(\mathbf{y}|\mathbf{x})p(\mathbf{s}|\mathbf{x})\overset{\underset{(%
3)}{}}{=}J_{\kappa_{\mathbf{x}}}^{2}\exp{\left(\kappa_{\mathbf{x}}(\mathbf{y}^%
{T}f_{\bm{\phi}}\left(\mathbf{x}\right)+\mathbf{s}^{T}{F_{a}}(\mathbf{x}))%
\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.15d">italic_p ( bold_y , bold_s | bold_x ) start_OVERACCENT start_UNDERACCENT ( 1 ) end_UNDERACCENT start_ARG end_ARG end_OVERACCENT start_ARG = end_ARG italic_p ( bold_y | bold_s , bold_x ) italic_p ( bold_s | bold_x ) start_OVERACCENT start_UNDERACCENT ( 2 ) end_UNDERACCENT start_ARG end_ARG end_OVERACCENT start_ARG = end_ARG italic_p ( bold_y | bold_x ) italic_p ( bold_s | bold_x ) start_OVERACCENT start_UNDERACCENT ( 3 ) end_UNDERACCENT start_ARG end_ARG end_OVERACCENT start_ARG = end_ARG italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_exp ( italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ( bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x ) + bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.6">where <math alttext="J_{\kappa_{\mathbf{x}}}" class="ltx_Math" display="inline" id="A1.3.p1.2.m1.1"><semantics id="A1.3.p1.2.m1.1a"><msub id="A1.3.p1.2.m1.1.1" xref="A1.3.p1.2.m1.1.1.cmml"><mi id="A1.3.p1.2.m1.1.1.2" xref="A1.3.p1.2.m1.1.1.2.cmml">J</mi><msub id="A1.3.p1.2.m1.1.1.3" xref="A1.3.p1.2.m1.1.1.3.cmml"><mi id="A1.3.p1.2.m1.1.1.3.2" xref="A1.3.p1.2.m1.1.1.3.2.cmml">κ</mi><mi id="A1.3.p1.2.m1.1.1.3.3" xref="A1.3.p1.2.m1.1.1.3.3.cmml">𝐱</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A1.3.p1.2.m1.1b"><apply id="A1.3.p1.2.m1.1.1.cmml" xref="A1.3.p1.2.m1.1.1"><csymbol cd="ambiguous" id="A1.3.p1.2.m1.1.1.1.cmml" xref="A1.3.p1.2.m1.1.1">subscript</csymbol><ci id="A1.3.p1.2.m1.1.1.2.cmml" xref="A1.3.p1.2.m1.1.1.2">𝐽</ci><apply id="A1.3.p1.2.m1.1.1.3.cmml" xref="A1.3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="A1.3.p1.2.m1.1.1.3.1.cmml" xref="A1.3.p1.2.m1.1.1.3">subscript</csymbol><ci id="A1.3.p1.2.m1.1.1.3.2.cmml" xref="A1.3.p1.2.m1.1.1.3.2">𝜅</ci><ci id="A1.3.p1.2.m1.1.1.3.3.cmml" xref="A1.3.p1.2.m1.1.1.3.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.2.m1.1c">J_{\kappa_{\mathbf{x}}}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.2.m1.1d">italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the normalizing constant and <math alttext="F_{a}" class="ltx_Math" display="inline" id="A1.3.p1.3.m2.1"><semantics id="A1.3.p1.3.m2.1a"><msub id="A1.3.p1.3.m2.1.1" xref="A1.3.p1.3.m2.1.1.cmml"><mi id="A1.3.p1.3.m2.1.1.2" xref="A1.3.p1.3.m2.1.1.2.cmml">F</mi><mi id="A1.3.p1.3.m2.1.1.3" xref="A1.3.p1.3.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.3.p1.3.m2.1b"><apply id="A1.3.p1.3.m2.1.1.cmml" xref="A1.3.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A1.3.p1.3.m2.1.1.1.cmml" xref="A1.3.p1.3.m2.1.1">subscript</csymbol><ci id="A1.3.p1.3.m2.1.1.2.cmml" xref="A1.3.p1.3.m2.1.1.2">𝐹</ci><ci id="A1.3.p1.3.m2.1.1.3.cmml" xref="A1.3.p1.3.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.3.m2.1c">F_{a}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.3.m2.1d">italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is the pretrained attribute predictor. Note that Equality (1) is obtained by the product rule of probability; Equality (2) is obtained by observing that <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="A1.3.p1.4.m3.1"><semantics id="A1.3.p1.4.m3.1a"><mi id="A1.3.p1.4.m3.1.1" xref="A1.3.p1.4.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.4.m3.1b"><ci id="A1.3.p1.4.m3.1.1.cmml" xref="A1.3.p1.4.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.4.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.4.m3.1d">bold_y</annotation></semantics></math> and <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="A1.3.p1.5.m4.1"><semantics id="A1.3.p1.5.m4.1a"><mi id="A1.3.p1.5.m4.1.1" xref="A1.3.p1.5.m4.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.5.m4.1b"><ci id="A1.3.p1.5.m4.1.1.cmml" xref="A1.3.p1.5.m4.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.5.m4.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.5.m4.1d">bold_s</annotation></semantics></math> are conditionally independent when <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A1.3.p1.6.m5.1"><semantics id="A1.3.p1.6.m5.1a"><mi id="A1.3.p1.6.m5.1.1" xref="A1.3.p1.6.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.6.m5.1b"><ci id="A1.3.p1.6.m5.1.1.cmml" xref="A1.3.p1.6.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.6.m5.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.6.m5.1d">bold_x</annotation></semantics></math> is given; and Equality (3) is obtained by assuming that</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(\mathbf{y}|\mathbf{x})=J_{\kappa_{\mathbf{x}}}\exp{\left(\kappa_{\mathbf{x}}%
\cdot\mathbf{y}^{T}f_{\bm{\phi}}\left(\mathbf{x}\right)\right)},\quad p(%
\mathbf{s}|\mathbf{x})=J_{\kappa_{\mathbf{x}}}\exp{\left(\kappa_{\mathbf{x}}%
\cdot\mathbf{s}^{T}F_{a}(\mathbf{x})\right)}" class="ltx_Math" display="block" id="A1.E9.m1.6"><semantics id="A1.E9.m1.6a"><mrow id="A1.E9.m1.6.6.2" xref="A1.E9.m1.6.6.3.cmml"><mrow id="A1.E9.m1.5.5.1.1" xref="A1.E9.m1.5.5.1.1.cmml"><mrow id="A1.E9.m1.5.5.1.1.1" xref="A1.E9.m1.5.5.1.1.1.cmml"><mi id="A1.E9.m1.5.5.1.1.1.3" xref="A1.E9.m1.5.5.1.1.1.3.cmml">p</mi><mo id="A1.E9.m1.5.5.1.1.1.2" xref="A1.E9.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.1.1.1.1.1" xref="A1.E9.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="A1.E9.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.5.5.1.1.1.1.1.1" xref="A1.E9.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.5.5.1.1.1.1.1.1.2" xref="A1.E9.m1.5.5.1.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="A1.E9.m1.5.5.1.1.1.1.1.1.1" xref="A1.E9.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E9.m1.5.5.1.1.1.1.1.1.3" xref="A1.E9.m1.5.5.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E9.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="A1.E9.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.5.5.1.1.3" xref="A1.E9.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E9.m1.5.5.1.1.2" xref="A1.E9.m1.5.5.1.1.2.cmml"><msub id="A1.E9.m1.5.5.1.1.2.3" xref="A1.E9.m1.5.5.1.1.2.3.cmml"><mi id="A1.E9.m1.5.5.1.1.2.3.2" xref="A1.E9.m1.5.5.1.1.2.3.2.cmml">J</mi><msub id="A1.E9.m1.5.5.1.1.2.3.3" xref="A1.E9.m1.5.5.1.1.2.3.3.cmml"><mi id="A1.E9.m1.5.5.1.1.2.3.3.2" xref="A1.E9.m1.5.5.1.1.2.3.3.2.cmml">κ</mi><mi id="A1.E9.m1.5.5.1.1.2.3.3.3" xref="A1.E9.m1.5.5.1.1.2.3.3.3.cmml">𝐱</mi></msub></msub><mo id="A1.E9.m1.5.5.1.1.2.2" lspace="0.167em" xref="A1.E9.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.1.1.2.1.1" xref="A1.E9.m1.5.5.1.1.2.1.2.cmml"><mi id="A1.E9.m1.2.2" xref="A1.E9.m1.2.2.cmml">exp</mi><mo id="A1.E9.m1.5.5.1.1.2.1.1a" xref="A1.E9.m1.5.5.1.1.2.1.2.cmml">⁡</mo><mrow id="A1.E9.m1.5.5.1.1.2.1.1.1" xref="A1.E9.m1.5.5.1.1.2.1.2.cmml"><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.2" xref="A1.E9.m1.5.5.1.1.2.1.2.cmml">(</mo><mrow id="A1.E9.m1.5.5.1.1.2.1.1.1.1" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.cmml"><mrow id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.cmml"><msub id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.cmml"><mi id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.2.cmml">κ</mi><mi id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.3" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.3.cmml">𝐱</mi></msub><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.1.cmml">⋅</mo><msup id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.cmml"><mi id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.2.cmml">𝐲</mi><mi id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.3" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.1.1" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.1.cmml">⁢</mo><msub id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.cmml"><mi id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.3" mathvariant="bold-italic" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.1.1a" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.1.1.2.1.1.1.1.4.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.1.4.2.1" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mi id="A1.E9.m1.1.1" xref="A1.E9.m1.1.1.cmml">𝐱</mi><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.1.4.2.2" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.5.5.1.1.2.1.1.1.3" xref="A1.E9.m1.5.5.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E9.m1.6.6.2.3" rspace="1.167em" xref="A1.E9.m1.6.6.3a.cmml">,</mo><mrow id="A1.E9.m1.6.6.2.2" xref="A1.E9.m1.6.6.2.2.cmml"><mrow id="A1.E9.m1.6.6.2.2.1" xref="A1.E9.m1.6.6.2.2.1.cmml"><mi id="A1.E9.m1.6.6.2.2.1.3" xref="A1.E9.m1.6.6.2.2.1.3.cmml">p</mi><mo id="A1.E9.m1.6.6.2.2.1.2" xref="A1.E9.m1.6.6.2.2.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.6.6.2.2.1.1.1" xref="A1.E9.m1.6.6.2.2.1.1.1.1.cmml"><mo id="A1.E9.m1.6.6.2.2.1.1.1.2" stretchy="false" xref="A1.E9.m1.6.6.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.6.6.2.2.1.1.1.1" xref="A1.E9.m1.6.6.2.2.1.1.1.1.cmml"><mi id="A1.E9.m1.6.6.2.2.1.1.1.1.2" xref="A1.E9.m1.6.6.2.2.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E9.m1.6.6.2.2.1.1.1.1.1" xref="A1.E9.m1.6.6.2.2.1.1.1.1.1.cmml">|</mo><mi id="A1.E9.m1.6.6.2.2.1.1.1.1.3" xref="A1.E9.m1.6.6.2.2.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E9.m1.6.6.2.2.1.1.1.3" stretchy="false" xref="A1.E9.m1.6.6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.6.6.2.2.3" xref="A1.E9.m1.6.6.2.2.3.cmml">=</mo><mrow id="A1.E9.m1.6.6.2.2.2" xref="A1.E9.m1.6.6.2.2.2.cmml"><msub id="A1.E9.m1.6.6.2.2.2.3" xref="A1.E9.m1.6.6.2.2.2.3.cmml"><mi id="A1.E9.m1.6.6.2.2.2.3.2" xref="A1.E9.m1.6.6.2.2.2.3.2.cmml">J</mi><msub id="A1.E9.m1.6.6.2.2.2.3.3" xref="A1.E9.m1.6.6.2.2.2.3.3.cmml"><mi id="A1.E9.m1.6.6.2.2.2.3.3.2" xref="A1.E9.m1.6.6.2.2.2.3.3.2.cmml">κ</mi><mi id="A1.E9.m1.6.6.2.2.2.3.3.3" xref="A1.E9.m1.6.6.2.2.2.3.3.3.cmml">𝐱</mi></msub></msub><mo id="A1.E9.m1.6.6.2.2.2.2" lspace="0.167em" xref="A1.E9.m1.6.6.2.2.2.2.cmml">⁢</mo><mrow id="A1.E9.m1.6.6.2.2.2.1.1" xref="A1.E9.m1.6.6.2.2.2.1.2.cmml"><mi id="A1.E9.m1.4.4" xref="A1.E9.m1.4.4.cmml">exp</mi><mo id="A1.E9.m1.6.6.2.2.2.1.1a" xref="A1.E9.m1.6.6.2.2.2.1.2.cmml">⁡</mo><mrow id="A1.E9.m1.6.6.2.2.2.1.1.1" xref="A1.E9.m1.6.6.2.2.2.1.2.cmml"><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.2" xref="A1.E9.m1.6.6.2.2.2.1.2.cmml">(</mo><mrow id="A1.E9.m1.6.6.2.2.2.1.1.1.1" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.cmml"><mrow id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.cmml"><msub id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.cmml"><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.2.cmml">κ</mi><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.3" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.3.cmml">𝐱</mi></msub><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.1.cmml">⋅</mo><msup id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.cmml"><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.2.cmml">𝐬</mi><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.3" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.3.cmml">T</mi></msup></mrow><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.1.1" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.cmml"><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.2.cmml">F</mi><mi id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.3" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.3.cmml">a</mi></msub><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.1.1a" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E9.m1.6.6.2.2.2.1.1.1.1.4.2" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.cmml"><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.1.4.2.1" stretchy="false" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.cmml">(</mo><mi id="A1.E9.m1.3.3" xref="A1.E9.m1.3.3.cmml">𝐱</mi><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.1.4.2.2" stretchy="false" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.6.6.2.2.2.1.1.1.3" xref="A1.E9.m1.6.6.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.6b"><apply id="A1.E9.m1.6.6.3.cmml" xref="A1.E9.m1.6.6.2"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.3a.cmml" xref="A1.E9.m1.6.6.2.3">formulae-sequence</csymbol><apply id="A1.E9.m1.5.5.1.1.cmml" xref="A1.E9.m1.5.5.1.1"><eq id="A1.E9.m1.5.5.1.1.3.cmml" xref="A1.E9.m1.5.5.1.1.3"></eq><apply id="A1.E9.m1.5.5.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.1"><times id="A1.E9.m1.5.5.1.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.1.2"></times><ci id="A1.E9.m1.5.5.1.1.1.3.cmml" xref="A1.E9.m1.5.5.1.1.1.3">𝑝</ci><apply id="A1.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.1.1.1.1.2">𝐲</ci><ci id="A1.E9.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.5.5.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="A1.E9.m1.5.5.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.2"><times id="A1.E9.m1.5.5.1.1.2.2.cmml" xref="A1.E9.m1.5.5.1.1.2.2"></times><apply id="A1.E9.m1.5.5.1.1.2.3.cmml" xref="A1.E9.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.1.1.2.3.1.cmml" xref="A1.E9.m1.5.5.1.1.2.3">subscript</csymbol><ci id="A1.E9.m1.5.5.1.1.2.3.2.cmml" xref="A1.E9.m1.5.5.1.1.2.3.2">𝐽</ci><apply id="A1.E9.m1.5.5.1.1.2.3.3.cmml" xref="A1.E9.m1.5.5.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.1.1.2.3.3.1.cmml" xref="A1.E9.m1.5.5.1.1.2.3.3">subscript</csymbol><ci id="A1.E9.m1.5.5.1.1.2.3.3.2.cmml" xref="A1.E9.m1.5.5.1.1.2.3.3.2">𝜅</ci><ci id="A1.E9.m1.5.5.1.1.2.3.3.3.cmml" xref="A1.E9.m1.5.5.1.1.2.3.3.3">𝐱</ci></apply></apply><apply id="A1.E9.m1.5.5.1.1.2.1.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1"><exp id="A1.E9.m1.2.2.cmml" xref="A1.E9.m1.2.2"></exp><apply id="A1.E9.m1.5.5.1.1.2.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1"><times id="A1.E9.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.1"></times><apply id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2"><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.1">⋅</ci><apply id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.2">𝜅</ci><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.3.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.2.3">𝐱</ci></apply><apply id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.2">𝐲</ci><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.1.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.2.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.2">𝑓</ci><ci id="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.3.cmml" xref="A1.E9.m1.5.5.1.1.2.1.1.1.1.3.3">bold-italic-ϕ</ci></apply><ci id="A1.E9.m1.1.1.cmml" xref="A1.E9.m1.1.1">𝐱</ci></apply></apply></apply></apply><apply id="A1.E9.m1.6.6.2.2.cmml" xref="A1.E9.m1.6.6.2.2"><eq id="A1.E9.m1.6.6.2.2.3.cmml" xref="A1.E9.m1.6.6.2.2.3"></eq><apply id="A1.E9.m1.6.6.2.2.1.cmml" xref="A1.E9.m1.6.6.2.2.1"><times id="A1.E9.m1.6.6.2.2.1.2.cmml" xref="A1.E9.m1.6.6.2.2.1.2"></times><ci id="A1.E9.m1.6.6.2.2.1.3.cmml" xref="A1.E9.m1.6.6.2.2.1.3">𝑝</ci><apply id="A1.E9.m1.6.6.2.2.1.1.1.1.cmml" xref="A1.E9.m1.6.6.2.2.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.6.6.2.2.1.1.1.1.1.cmml" xref="A1.E9.m1.6.6.2.2.1.1.1.1.1">conditional</csymbol><ci id="A1.E9.m1.6.6.2.2.1.1.1.1.2.cmml" xref="A1.E9.m1.6.6.2.2.1.1.1.1.2">𝐬</ci><ci id="A1.E9.m1.6.6.2.2.1.1.1.1.3.cmml" xref="A1.E9.m1.6.6.2.2.1.1.1.1.3">𝐱</ci></apply></apply><apply id="A1.E9.m1.6.6.2.2.2.cmml" xref="A1.E9.m1.6.6.2.2.2"><times id="A1.E9.m1.6.6.2.2.2.2.cmml" xref="A1.E9.m1.6.6.2.2.2.2"></times><apply id="A1.E9.m1.6.6.2.2.2.3.cmml" xref="A1.E9.m1.6.6.2.2.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.2.2.2.3.1.cmml" xref="A1.E9.m1.6.6.2.2.2.3">subscript</csymbol><ci id="A1.E9.m1.6.6.2.2.2.3.2.cmml" xref="A1.E9.m1.6.6.2.2.2.3.2">𝐽</ci><apply id="A1.E9.m1.6.6.2.2.2.3.3.cmml" xref="A1.E9.m1.6.6.2.2.2.3.3"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.2.2.2.3.3.1.cmml" xref="A1.E9.m1.6.6.2.2.2.3.3">subscript</csymbol><ci id="A1.E9.m1.6.6.2.2.2.3.3.2.cmml" xref="A1.E9.m1.6.6.2.2.2.3.3.2">𝜅</ci><ci id="A1.E9.m1.6.6.2.2.2.3.3.3.cmml" xref="A1.E9.m1.6.6.2.2.2.3.3.3">𝐱</ci></apply></apply><apply id="A1.E9.m1.6.6.2.2.2.1.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1"><exp id="A1.E9.m1.4.4.cmml" xref="A1.E9.m1.4.4"></exp><apply id="A1.E9.m1.6.6.2.2.2.1.1.1.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1"><times id="A1.E9.m1.6.6.2.2.2.1.1.1.1.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.1"></times><apply id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2"><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.1">⋅</ci><apply id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.2">𝜅</ci><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.3.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.2.3">𝐱</ci></apply><apply id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.2">𝐬</ci><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.1.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.2.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.2">𝐹</ci><ci id="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.3.cmml" xref="A1.E9.m1.6.6.2.2.2.1.1.1.1.3.3">𝑎</ci></apply><ci id="A1.E9.m1.3.3.cmml" xref="A1.E9.m1.3.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.6c">p(\mathbf{y}|\mathbf{x})=J_{\kappa_{\mathbf{x}}}\exp{\left(\kappa_{\mathbf{x}}%
\cdot\mathbf{y}^{T}f_{\bm{\phi}}\left(\mathbf{x}\right)\right)},\quad p(%
\mathbf{s}|\mathbf{x})=J_{\kappa_{\mathbf{x}}}\exp{\left(\kappa_{\mathbf{x}}%
\cdot\mathbf{s}^{T}F_{a}(\mathbf{x})\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.6d">italic_p ( bold_y | bold_x ) = italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ⋅ bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x ) ) , italic_p ( bold_s | bold_x ) = italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ⋅ bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.7">Note that these reasonable assumptions are applied in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Xu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>; <span class="ltx_text" style="font-size:90%;">Li et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>; <span class="ltx_text" style="font-size:90%;">Hasnat et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">2017</span></a>)</cite>.
Now we can specify the value of the scalar <math alttext="C" class="ltx_Math" display="inline" id="A1.3.p1.7.m1.1"><semantics id="A1.3.p1.7.m1.1a"><mi id="A1.3.p1.7.m1.1.1" xref="A1.3.p1.7.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.7.m1.1b"><ci id="A1.3.p1.7.m1.1.1.cmml" xref="A1.3.p1.7.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.7.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.7.m1.1d">italic_C</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\lambda_{t}\left(\log J_{\kappa_{%
\mathbf{x}}}^{2}+\mathbf{s}^{T}F_{a}(\mathbf{x})\right)\bigg{]}-\frac{n}{2}%
\log(2\pi)+D_{\text{KL}}\left(q(\mathbf{x}_{T}|\mathbf{x}_{0})||p(\mathbf{x}_{%
T})\right)+\log Z" class="ltx_math_unparsed" display="block" id="A1.E10.m1.4"><semantics id="A1.E10.m1.4a"><mrow id="A1.E10.m1.4b"><mi id="A1.E10.m1.4.5">C</mi><mo id="A1.E10.m1.4.6" rspace="0em">=</mo><mo id="A1.E10.m1.4.7" lspace="0em">−</mo><msub id="A1.E10.m1.4.8"><mi id="A1.E10.m1.4.8.2">𝔼</mi><mrow id="A1.E10.m1.2.2.2"><mi id="A1.E10.m1.2.2.2.4">t</mi><mo id="A1.E10.m1.2.2.2.3">∼</mo><mrow id="A1.E10.m1.2.2.2.5"><mi class="ltx_font_mathcaligraphic" id="A1.E10.m1.2.2.2.5.2">𝒰</mi><mo id="A1.E10.m1.2.2.2.5.1">⁢</mo><mrow id="A1.E10.m1.2.2.2.5.3.2"><mo id="A1.E10.m1.2.2.2.5.3.2.1" stretchy="false">[</mo><mn id="A1.E10.m1.1.1.1.1">2</mn><mo id="A1.E10.m1.2.2.2.5.3.2.2">,</mo><mi id="A1.E10.m1.2.2.2.2">T</mi><mo id="A1.E10.m1.2.2.2.5.3.2.3" stretchy="false">]</mo></mrow></mrow></mrow></msub><mrow id="A1.E10.m1.4.9"><mo id="A1.E10.m1.4.9.1" maxsize="210%" minsize="210%">[</mo><msub id="A1.E10.m1.4.9.2"><mi id="A1.E10.m1.4.9.2.2">λ</mi><mi id="A1.E10.m1.4.9.2.3">t</mi></msub><mrow id="A1.E10.m1.4.9.3"><mo id="A1.E10.m1.4.9.3.1">(</mo><mi id="A1.E10.m1.4.9.3.2">log</mi><msubsup id="A1.E10.m1.4.9.3.3"><mi id="A1.E10.m1.4.9.3.3.2.2">J</mi><msub id="A1.E10.m1.4.9.3.3.2.3"><mi id="A1.E10.m1.4.9.3.3.2.3.2">κ</mi><mi id="A1.E10.m1.4.9.3.3.2.3.3">𝐱</mi></msub><mn id="A1.E10.m1.4.9.3.3.3">2</mn></msubsup><mo id="A1.E10.m1.4.9.3.4">+</mo><msup id="A1.E10.m1.4.9.3.5"><mi id="A1.E10.m1.4.9.3.5.2">𝐬</mi><mi id="A1.E10.m1.4.9.3.5.3">T</mi></msup><msub id="A1.E10.m1.4.9.3.6"><mi id="A1.E10.m1.4.9.3.6.2">F</mi><mi id="A1.E10.m1.4.9.3.6.3">a</mi></msub><mrow id="A1.E10.m1.4.9.3.7"><mo id="A1.E10.m1.4.9.3.7.1" stretchy="false">(</mo><mi id="A1.E10.m1.3.3">𝐱</mi><mo id="A1.E10.m1.4.9.3.7.2" stretchy="false">)</mo></mrow><mo id="A1.E10.m1.4.9.3.8">)</mo></mrow><mo id="A1.E10.m1.4.9.4" maxsize="210%" minsize="210%">]</mo></mrow><mo id="A1.E10.m1.4.10">−</mo><mfrac id="A1.E10.m1.4.11"><mi id="A1.E10.m1.4.11.2">n</mi><mn id="A1.E10.m1.4.11.3">2</mn></mfrac><mi id="A1.E10.m1.4.4">log</mi><mrow id="A1.E10.m1.4.12"><mo id="A1.E10.m1.4.12.1" stretchy="false">(</mo><mn id="A1.E10.m1.4.12.2">2</mn><mi id="A1.E10.m1.4.12.3">π</mi><mo id="A1.E10.m1.4.12.4" stretchy="false">)</mo></mrow><mo id="A1.E10.m1.4.13">+</mo><msub id="A1.E10.m1.4.14"><mi id="A1.E10.m1.4.14.2">D</mi><mtext id="A1.E10.m1.4.14.3">KL</mtext></msub><mrow id="A1.E10.m1.4.15"><mo id="A1.E10.m1.4.15.1">(</mo><mi id="A1.E10.m1.4.15.2">q</mi><mrow id="A1.E10.m1.4.15.3"><mo id="A1.E10.m1.4.15.3.1" stretchy="false">(</mo><msub id="A1.E10.m1.4.15.3.2"><mi id="A1.E10.m1.4.15.3.2.2">𝐱</mi><mi id="A1.E10.m1.4.15.3.2.3">T</mi></msub><mo fence="false" id="A1.E10.m1.4.15.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E10.m1.4.15.3.4"><mi id="A1.E10.m1.4.15.3.4.2">𝐱</mi><mn id="A1.E10.m1.4.15.3.4.3">0</mn></msub><mo id="A1.E10.m1.4.15.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E10.m1.4.15.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E10.m1.4.15.5" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E10.m1.4.15.6">p</mi><mrow id="A1.E10.m1.4.15.7"><mo id="A1.E10.m1.4.15.7.1" stretchy="false">(</mo><msub id="A1.E10.m1.4.15.7.2"><mi id="A1.E10.m1.4.15.7.2.2">𝐱</mi><mi id="A1.E10.m1.4.15.7.2.3">T</mi></msub><mo id="A1.E10.m1.4.15.7.3" stretchy="false">)</mo></mrow><mo id="A1.E10.m1.4.15.8">)</mo></mrow><mo id="A1.E10.m1.4.16">+</mo><mi id="A1.E10.m1.4.17">log</mi><mi id="A1.E10.m1.4.18">Z</mi></mrow><annotation encoding="application/x-tex" id="A1.E10.m1.4c">C=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\lambda_{t}\left(\log J_{\kappa_{%
\mathbf{x}}}^{2}+\mathbf{s}^{T}F_{a}(\mathbf{x})\right)\bigg{]}-\frac{n}{2}%
\log(2\pi)+D_{\text{KL}}\left(q(\mathbf{x}_{T}|\mathbf{x}_{0})||p(\mathbf{x}_{%
T})\right)+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.4d">italic_C = - blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( roman_log italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) ) ] - divide start_ARG italic_n end_ARG start_ARG 2 end_ARG roman_log ( 2 italic_π ) + italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_q ( bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) | | italic_p ( bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ) + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.9">where <math alttext="n=3HW" class="ltx_Math" display="inline" id="A1.3.p1.8.m1.1"><semantics id="A1.3.p1.8.m1.1a"><mrow id="A1.3.p1.8.m1.1.1" xref="A1.3.p1.8.m1.1.1.cmml"><mi id="A1.3.p1.8.m1.1.1.2" xref="A1.3.p1.8.m1.1.1.2.cmml">n</mi><mo id="A1.3.p1.8.m1.1.1.1" xref="A1.3.p1.8.m1.1.1.1.cmml">=</mo><mrow id="A1.3.p1.8.m1.1.1.3" xref="A1.3.p1.8.m1.1.1.3.cmml"><mn id="A1.3.p1.8.m1.1.1.3.2" xref="A1.3.p1.8.m1.1.1.3.2.cmml">3</mn><mo id="A1.3.p1.8.m1.1.1.3.1" xref="A1.3.p1.8.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.3.p1.8.m1.1.1.3.3" xref="A1.3.p1.8.m1.1.1.3.3.cmml">H</mi><mo id="A1.3.p1.8.m1.1.1.3.1a" xref="A1.3.p1.8.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.3.p1.8.m1.1.1.3.4" xref="A1.3.p1.8.m1.1.1.3.4.cmml">W</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.8.m1.1b"><apply id="A1.3.p1.8.m1.1.1.cmml" xref="A1.3.p1.8.m1.1.1"><eq id="A1.3.p1.8.m1.1.1.1.cmml" xref="A1.3.p1.8.m1.1.1.1"></eq><ci id="A1.3.p1.8.m1.1.1.2.cmml" xref="A1.3.p1.8.m1.1.1.2">𝑛</ci><apply id="A1.3.p1.8.m1.1.1.3.cmml" xref="A1.3.p1.8.m1.1.1.3"><times id="A1.3.p1.8.m1.1.1.3.1.cmml" xref="A1.3.p1.8.m1.1.1.3.1"></times><cn id="A1.3.p1.8.m1.1.1.3.2.cmml" type="integer" xref="A1.3.p1.8.m1.1.1.3.2">3</cn><ci id="A1.3.p1.8.m1.1.1.3.3.cmml" xref="A1.3.p1.8.m1.1.1.3.3">𝐻</ci><ci id="A1.3.p1.8.m1.1.1.3.4.cmml" xref="A1.3.p1.8.m1.1.1.3.4">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.8.m1.1c">n=3HW</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.8.m1.1d">italic_n = 3 italic_H italic_W</annotation></semantics></math> is the dimensionality of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A1.3.p1.9.m2.1"><semantics id="A1.3.p1.9.m2.1a"><mi id="A1.3.p1.9.m2.1.1" xref="A1.3.p1.9.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.9.m2.1b"><ci id="A1.3.p1.9.m2.1.1.cmml" xref="A1.3.p1.9.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.9.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.9.m2.1d">bold_x</annotation></semantics></math>, and</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Z=\int_{\mathbf{x}}{p(\mathbf{x}|\mathbf{y},\mathbf{s})\cdot p(\mathbf{y},%
\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}}}d\mathbf{x}=Z%
\left(\mathbf{y},\mathbf{s},\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\right)" class="ltx_Math" display="block" id="A1.E11.m1.8"><semantics id="A1.E11.m1.8a"><mrow id="A1.E11.m1.8.8" xref="A1.E11.m1.8.8.cmml"><mi id="A1.E11.m1.8.8.4" xref="A1.E11.m1.8.8.4.cmml">Z</mi><mo id="A1.E11.m1.8.8.5" rspace="0.111em" xref="A1.E11.m1.8.8.5.cmml">=</mo><mrow id="A1.E11.m1.8.8.2" xref="A1.E11.m1.8.8.2.cmml"><msub id="A1.E11.m1.8.8.2.3" xref="A1.E11.m1.8.8.2.3.cmml"><mo id="A1.E11.m1.8.8.2.3.2" xref="A1.E11.m1.8.8.2.3.2.cmml">∫</mo><mi id="A1.E11.m1.8.8.2.3.3" xref="A1.E11.m1.8.8.2.3.3.cmml">𝐱</mi></msub><mrow id="A1.E11.m1.8.8.2.2" xref="A1.E11.m1.8.8.2.2.cmml"><mrow id="A1.E11.m1.7.7.1.1.1" xref="A1.E11.m1.7.7.1.1.1.cmml"><mrow id="A1.E11.m1.7.7.1.1.1.1" xref="A1.E11.m1.7.7.1.1.1.1.cmml"><mi id="A1.E11.m1.7.7.1.1.1.1.3" xref="A1.E11.m1.7.7.1.1.1.1.3.cmml">p</mi><mo id="A1.E11.m1.7.7.1.1.1.1.2" xref="A1.E11.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.7.7.1.1.1.1.1.1" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.7.7.1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m1.7.7.1.1.1.1.1.1.1" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.7.7.1.1.1.1.1.1.1.2" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E11.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.2" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.1.cmml"><mi id="A1.E11.m1.1.1" xref="A1.E11.m1.1.1.cmml">𝐲</mi><mo id="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.2.1" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E11.m1.7.7.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.7.7.1.1.1.2" rspace="0.222em" xref="A1.E11.m1.7.7.1.1.1.2.cmml">⋅</mo><mi id="A1.E11.m1.7.7.1.1.1.3" xref="A1.E11.m1.7.7.1.1.1.3.cmml">p</mi></mrow><mo id="A1.E11.m1.8.8.2.2.3" xref="A1.E11.m1.8.8.2.2.3.cmml">⁢</mo><msup id="A1.E11.m1.8.8.2.2.2" xref="A1.E11.m1.8.8.2.2.2.cmml"><mrow id="A1.E11.m1.8.8.2.2.2.1.1" xref="A1.E11.m1.8.8.2.2.2.1.2.cmml"><mo id="A1.E11.m1.8.8.2.2.2.1.1.2" stretchy="false" xref="A1.E11.m1.8.8.2.2.2.1.2.cmml">(</mo><mi id="A1.E11.m1.3.3" xref="A1.E11.m1.3.3.cmml">𝐲</mi><mo id="A1.E11.m1.8.8.2.2.2.1.1.3" xref="A1.E11.m1.8.8.2.2.2.1.2.cmml">,</mo><mrow id="A1.E11.m1.8.8.2.2.2.1.1.1" xref="A1.E11.m1.8.8.2.2.2.1.1.1.cmml"><mi id="A1.E11.m1.8.8.2.2.2.1.1.1.2" xref="A1.E11.m1.8.8.2.2.2.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E11.m1.8.8.2.2.2.1.1.1.1" xref="A1.E11.m1.8.8.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.E11.m1.8.8.2.2.2.1.1.1.3" xref="A1.E11.m1.8.8.2.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E11.m1.8.8.2.2.2.1.1.4" stretchy="false" xref="A1.E11.m1.8.8.2.2.2.1.2.cmml">)</mo></mrow><mfrac id="A1.E11.m1.8.8.2.2.2.3" xref="A1.E11.m1.8.8.2.2.2.3.cmml"><mrow id="A1.E11.m1.8.8.2.2.2.3.2" xref="A1.E11.m1.8.8.2.2.2.3.2.cmml"><mstyle displaystyle="false" id="A1.E11.m1.8.8.2.2.2.3.2.1" xref="A1.E11.m1.8.8.2.2.2.3.2.1.cmml"><msubsup id="A1.E11.m1.8.8.2.2.2.3.2.1a" xref="A1.E11.m1.8.8.2.2.2.3.2.1.cmml"><mo id="A1.E11.m1.8.8.2.2.2.3.2.1.2.2" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.2.cmml">∑</mo><mrow id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.cmml"><mi id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.2" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.2.cmml">t</mi><mo id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.1" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.1.cmml">=</mo><mn id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.3" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E11.m1.8.8.2.2.2.3.2.1.3" xref="A1.E11.m1.8.8.2.2.2.3.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="A1.E11.m1.8.8.2.2.2.3.2.2" xref="A1.E11.m1.8.8.2.2.2.3.2.2.cmml"><mi id="A1.E11.m1.8.8.2.2.2.3.2.2.2" xref="A1.E11.m1.8.8.2.2.2.3.2.2.2.cmml">λ</mi><mi id="A1.E11.m1.8.8.2.2.2.3.2.2.3" xref="A1.E11.m1.8.8.2.2.2.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.E11.m1.8.8.2.2.2.3.3" xref="A1.E11.m1.8.8.2.2.2.3.3.cmml"><mi id="A1.E11.m1.8.8.2.2.2.3.3.2" xref="A1.E11.m1.8.8.2.2.2.3.3.2.cmml">T</mi><mo id="A1.E11.m1.8.8.2.2.2.3.3.1" xref="A1.E11.m1.8.8.2.2.2.3.3.1.cmml">−</mo><mn id="A1.E11.m1.8.8.2.2.2.3.3.3" xref="A1.E11.m1.8.8.2.2.2.3.3.3.cmml">1</mn></mrow></mfrac></msup><mo id="A1.E11.m1.8.8.2.2.3a" lspace="0em" xref="A1.E11.m1.8.8.2.2.3.cmml">⁢</mo><mrow id="A1.E11.m1.8.8.2.2.4" xref="A1.E11.m1.8.8.2.2.4.cmml"><mo id="A1.E11.m1.8.8.2.2.4.1" rspace="0em" xref="A1.E11.m1.8.8.2.2.4.1.cmml">𝑑</mo><mi id="A1.E11.m1.8.8.2.2.4.2" xref="A1.E11.m1.8.8.2.2.4.2.cmml">𝐱</mi></mrow></mrow></mrow><mo id="A1.E11.m1.8.8.6" xref="A1.E11.m1.8.8.6.cmml">=</mo><mrow id="A1.E11.m1.8.8.7" xref="A1.E11.m1.8.8.7.cmml"><mi id="A1.E11.m1.8.8.7.2" xref="A1.E11.m1.8.8.7.2.cmml">Z</mi><mo id="A1.E11.m1.8.8.7.1" xref="A1.E11.m1.8.8.7.1.cmml">⁢</mo><mrow id="A1.E11.m1.8.8.7.3.2" xref="A1.E11.m1.8.8.7.3.1.cmml"><mo id="A1.E11.m1.8.8.7.3.2.1" xref="A1.E11.m1.8.8.7.3.1.cmml">(</mo><mi id="A1.E11.m1.4.4" xref="A1.E11.m1.4.4.cmml">𝐲</mi><mo id="A1.E11.m1.8.8.7.3.2.2" xref="A1.E11.m1.8.8.7.3.1.cmml">,</mo><mi id="A1.E11.m1.5.5" xref="A1.E11.m1.5.5.cmml">𝐬</mi><mo id="A1.E11.m1.8.8.7.3.2.3" xref="A1.E11.m1.8.8.7.3.1.cmml">,</mo><mfrac id="A1.E11.m1.6.6" xref="A1.E11.m1.6.6.cmml"><mrow id="A1.E11.m1.6.6.2" xref="A1.E11.m1.6.6.2.cmml"><msubsup id="A1.E11.m1.6.6.2.1" xref="A1.E11.m1.6.6.2.1.cmml"><mo id="A1.E11.m1.6.6.2.1.2.2" xref="A1.E11.m1.6.6.2.1.2.2.cmml">∑</mo><mrow id="A1.E11.m1.6.6.2.1.2.3" xref="A1.E11.m1.6.6.2.1.2.3.cmml"><mi id="A1.E11.m1.6.6.2.1.2.3.2" xref="A1.E11.m1.6.6.2.1.2.3.2.cmml">t</mi><mo id="A1.E11.m1.6.6.2.1.2.3.1" xref="A1.E11.m1.6.6.2.1.2.3.1.cmml">=</mo><mn id="A1.E11.m1.6.6.2.1.2.3.3" xref="A1.E11.m1.6.6.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E11.m1.6.6.2.1.3" xref="A1.E11.m1.6.6.2.1.3.cmml">T</mi></msubsup><msub id="A1.E11.m1.6.6.2.2" xref="A1.E11.m1.6.6.2.2.cmml"><mi id="A1.E11.m1.6.6.2.2.2" xref="A1.E11.m1.6.6.2.2.2.cmml">λ</mi><mi id="A1.E11.m1.6.6.2.2.3" xref="A1.E11.m1.6.6.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.E11.m1.6.6.3" xref="A1.E11.m1.6.6.3.cmml"><mi id="A1.E11.m1.6.6.3.2" xref="A1.E11.m1.6.6.3.2.cmml">T</mi><mo id="A1.E11.m1.6.6.3.1" xref="A1.E11.m1.6.6.3.1.cmml">−</mo><mn id="A1.E11.m1.6.6.3.3" xref="A1.E11.m1.6.6.3.3.cmml">1</mn></mrow></mfrac><mo id="A1.E11.m1.8.8.7.3.2.4" xref="A1.E11.m1.8.8.7.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.8b"><apply id="A1.E11.m1.8.8.cmml" xref="A1.E11.m1.8.8"><and id="A1.E11.m1.8.8a.cmml" xref="A1.E11.m1.8.8"></and><apply id="A1.E11.m1.8.8b.cmml" xref="A1.E11.m1.8.8"><eq id="A1.E11.m1.8.8.5.cmml" xref="A1.E11.m1.8.8.5"></eq><ci id="A1.E11.m1.8.8.4.cmml" xref="A1.E11.m1.8.8.4">𝑍</ci><apply id="A1.E11.m1.8.8.2.cmml" xref="A1.E11.m1.8.8.2"><apply id="A1.E11.m1.8.8.2.3.cmml" xref="A1.E11.m1.8.8.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.8.8.2.3.1.cmml" xref="A1.E11.m1.8.8.2.3">subscript</csymbol><int id="A1.E11.m1.8.8.2.3.2.cmml" xref="A1.E11.m1.8.8.2.3.2"></int><ci id="A1.E11.m1.8.8.2.3.3.cmml" xref="A1.E11.m1.8.8.2.3.3">𝐱</ci></apply><apply id="A1.E11.m1.8.8.2.2.cmml" xref="A1.E11.m1.8.8.2.2"><times id="A1.E11.m1.8.8.2.2.3.cmml" xref="A1.E11.m1.8.8.2.2.3"></times><apply id="A1.E11.m1.7.7.1.1.1.cmml" xref="A1.E11.m1.7.7.1.1.1"><ci id="A1.E11.m1.7.7.1.1.1.2.cmml" xref="A1.E11.m1.7.7.1.1.1.2">⋅</ci><apply id="A1.E11.m1.7.7.1.1.1.1.cmml" xref="A1.E11.m1.7.7.1.1.1.1"><times id="A1.E11.m1.7.7.1.1.1.1.2.cmml" xref="A1.E11.m1.7.7.1.1.1.1.2"></times><ci id="A1.E11.m1.7.7.1.1.1.1.3.cmml" xref="A1.E11.m1.7.7.1.1.1.1.3">𝑝</ci><apply id="A1.E11.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E11.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E11.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.2">𝐱</ci><list id="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.7.7.1.1.1.1.1.1.1.3.2"><ci id="A1.E11.m1.1.1.cmml" xref="A1.E11.m1.1.1">𝐲</ci><ci id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2">𝐬</ci></list></apply></apply><ci id="A1.E11.m1.7.7.1.1.1.3.cmml" xref="A1.E11.m1.7.7.1.1.1.3">𝑝</ci></apply><apply id="A1.E11.m1.8.8.2.2.2.cmml" xref="A1.E11.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.8.8.2.2.2.2.cmml" xref="A1.E11.m1.8.8.2.2.2">superscript</csymbol><interval closure="open" id="A1.E11.m1.8.8.2.2.2.1.2.cmml" xref="A1.E11.m1.8.8.2.2.2.1.1"><ci id="A1.E11.m1.3.3.cmml" xref="A1.E11.m1.3.3">𝐲</ci><apply id="A1.E11.m1.8.8.2.2.2.1.1.1.cmml" xref="A1.E11.m1.8.8.2.2.2.1.1.1"><csymbol cd="latexml" id="A1.E11.m1.8.8.2.2.2.1.1.1.1.cmml" xref="A1.E11.m1.8.8.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.E11.m1.8.8.2.2.2.1.1.1.2.cmml" xref="A1.E11.m1.8.8.2.2.2.1.1.1.2">𝐬</ci><ci id="A1.E11.m1.8.8.2.2.2.1.1.1.3.cmml" xref="A1.E11.m1.8.8.2.2.2.1.1.1.3">𝐱</ci></apply></interval><apply id="A1.E11.m1.8.8.2.2.2.3.cmml" xref="A1.E11.m1.8.8.2.2.2.3"><divide id="A1.E11.m1.8.8.2.2.2.3.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3"></divide><apply id="A1.E11.m1.8.8.2.2.2.3.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2"><apply id="A1.E11.m1.8.8.2.2.2.3.2.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.8.8.2.2.2.3.2.1.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1">superscript</csymbol><apply id="A1.E11.m1.8.8.2.2.2.3.2.1.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.8.8.2.2.2.3.2.1.2.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1">subscript</csymbol><sum id="A1.E11.m1.8.8.2.2.2.3.2.1.2.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.2"></sum><apply id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3"><eq id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.1"></eq><ci id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.2">𝑡</ci><cn id="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.3.cmml" type="integer" xref="A1.E11.m1.8.8.2.2.2.3.2.1.2.3.3">2</cn></apply></apply><ci id="A1.E11.m1.8.8.2.2.2.3.2.1.3.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.1.3">𝑇</ci></apply><apply id="A1.E11.m1.8.8.2.2.2.3.2.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.8.8.2.2.2.3.2.2.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.2">subscript</csymbol><ci id="A1.E11.m1.8.8.2.2.2.3.2.2.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.2.2">𝜆</ci><ci id="A1.E11.m1.8.8.2.2.2.3.2.2.3.cmml" xref="A1.E11.m1.8.8.2.2.2.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.E11.m1.8.8.2.2.2.3.3.cmml" xref="A1.E11.m1.8.8.2.2.2.3.3"><minus id="A1.E11.m1.8.8.2.2.2.3.3.1.cmml" xref="A1.E11.m1.8.8.2.2.2.3.3.1"></minus><ci id="A1.E11.m1.8.8.2.2.2.3.3.2.cmml" xref="A1.E11.m1.8.8.2.2.2.3.3.2">𝑇</ci><cn id="A1.E11.m1.8.8.2.2.2.3.3.3.cmml" type="integer" xref="A1.E11.m1.8.8.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="A1.E11.m1.8.8.2.2.4.cmml" xref="A1.E11.m1.8.8.2.2.4"><csymbol cd="latexml" id="A1.E11.m1.8.8.2.2.4.1.cmml" xref="A1.E11.m1.8.8.2.2.4.1">differential-d</csymbol><ci id="A1.E11.m1.8.8.2.2.4.2.cmml" xref="A1.E11.m1.8.8.2.2.4.2">𝐱</ci></apply></apply></apply></apply><apply id="A1.E11.m1.8.8c.cmml" xref="A1.E11.m1.8.8"><eq id="A1.E11.m1.8.8.6.cmml" xref="A1.E11.m1.8.8.6"></eq><share href="https://arxiv.org/html/2409.17576v1#A1.E11.m1.8.8.2.cmml" id="A1.E11.m1.8.8d.cmml" xref="A1.E11.m1.8.8"></share><apply id="A1.E11.m1.8.8.7.cmml" xref="A1.E11.m1.8.8.7"><times id="A1.E11.m1.8.8.7.1.cmml" xref="A1.E11.m1.8.8.7.1"></times><ci id="A1.E11.m1.8.8.7.2.cmml" xref="A1.E11.m1.8.8.7.2">𝑍</ci><vector id="A1.E11.m1.8.8.7.3.1.cmml" xref="A1.E11.m1.8.8.7.3.2"><ci id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4">𝐲</ci><ci id="A1.E11.m1.5.5.cmml" xref="A1.E11.m1.5.5">𝐬</ci><apply id="A1.E11.m1.6.6.cmml" xref="A1.E11.m1.6.6"><divide id="A1.E11.m1.6.6.1.cmml" xref="A1.E11.m1.6.6"></divide><apply id="A1.E11.m1.6.6.2.cmml" xref="A1.E11.m1.6.6.2"><apply id="A1.E11.m1.6.6.2.1.cmml" xref="A1.E11.m1.6.6.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.2.1.1.cmml" xref="A1.E11.m1.6.6.2.1">superscript</csymbol><apply id="A1.E11.m1.6.6.2.1.2.cmml" xref="A1.E11.m1.6.6.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.2.1.2.1.cmml" xref="A1.E11.m1.6.6.2.1">subscript</csymbol><sum id="A1.E11.m1.6.6.2.1.2.2.cmml" xref="A1.E11.m1.6.6.2.1.2.2"></sum><apply id="A1.E11.m1.6.6.2.1.2.3.cmml" xref="A1.E11.m1.6.6.2.1.2.3"><eq id="A1.E11.m1.6.6.2.1.2.3.1.cmml" xref="A1.E11.m1.6.6.2.1.2.3.1"></eq><ci id="A1.E11.m1.6.6.2.1.2.3.2.cmml" xref="A1.E11.m1.6.6.2.1.2.3.2">𝑡</ci><cn id="A1.E11.m1.6.6.2.1.2.3.3.cmml" type="integer" xref="A1.E11.m1.6.6.2.1.2.3.3">2</cn></apply></apply><ci id="A1.E11.m1.6.6.2.1.3.cmml" xref="A1.E11.m1.6.6.2.1.3">𝑇</ci></apply><apply id="A1.E11.m1.6.6.2.2.cmml" xref="A1.E11.m1.6.6.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.2.2.1.cmml" xref="A1.E11.m1.6.6.2.2">subscript</csymbol><ci id="A1.E11.m1.6.6.2.2.2.cmml" xref="A1.E11.m1.6.6.2.2.2">𝜆</ci><ci id="A1.E11.m1.6.6.2.2.3.cmml" xref="A1.E11.m1.6.6.2.2.3">𝑡</ci></apply></apply><apply id="A1.E11.m1.6.6.3.cmml" xref="A1.E11.m1.6.6.3"><minus id="A1.E11.m1.6.6.3.1.cmml" xref="A1.E11.m1.6.6.3.1"></minus><ci id="A1.E11.m1.6.6.3.2.cmml" xref="A1.E11.m1.6.6.3.2">𝑇</ci><cn id="A1.E11.m1.6.6.3.3.cmml" type="integer" xref="A1.E11.m1.6.6.3.3">1</cn></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.8c">Z=\int_{\mathbf{x}}{p(\mathbf{x}|\mathbf{y},\mathbf{s})\cdot p(\mathbf{y},%
\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}}}d\mathbf{x}=Z%
\left(\mathbf{y},\mathbf{s},\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.8d">italic_Z = ∫ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT italic_p ( bold_x | bold_y , bold_s ) ⋅ italic_p ( bold_y , bold_s | bold_x ) start_POSTSUPERSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG end_POSTSUPERSCRIPT italic_d bold_x = italic_Z ( bold_y , bold_s , divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.17">Note that <math alttext="Z" class="ltx_Math" display="inline" id="A1.3.p1.10.m1.1"><semantics id="A1.3.p1.10.m1.1a"><mi id="A1.3.p1.10.m1.1.1" xref="A1.3.p1.10.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.10.m1.1b"><ci id="A1.3.p1.10.m1.1.1.cmml" xref="A1.3.p1.10.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.10.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.10.m1.1d">italic_Z</annotation></semantics></math> only depends on <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="A1.3.p1.11.m2.1"><semantics id="A1.3.p1.11.m2.1a"><mi id="A1.3.p1.11.m2.1.1" xref="A1.3.p1.11.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.11.m2.1b"><ci id="A1.3.p1.11.m2.1.1.cmml" xref="A1.3.p1.11.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.11.m2.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.11.m2.1d">bold_y</annotation></semantics></math>, <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="A1.3.p1.12.m3.1"><semantics id="A1.3.p1.12.m3.1a"><mi id="A1.3.p1.12.m3.1.1" xref="A1.3.p1.12.m3.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.12.m3.1b"><ci id="A1.3.p1.12.m3.1.1.cmml" xref="A1.3.p1.12.m3.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.12.m3.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.12.m3.1d">bold_s</annotation></semantics></math> and <math alttext="\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}" class="ltx_Math" display="inline" id="A1.3.p1.13.m4.1"><semantics id="A1.3.p1.13.m4.1a"><mfrac id="A1.3.p1.13.m4.1.1" xref="A1.3.p1.13.m4.1.1.cmml"><mrow id="A1.3.p1.13.m4.1.1.2" xref="A1.3.p1.13.m4.1.1.2.cmml"><mstyle displaystyle="false" id="A1.3.p1.13.m4.1.1.2.1" xref="A1.3.p1.13.m4.1.1.2.1.cmml"><msubsup id="A1.3.p1.13.m4.1.1.2.1a" xref="A1.3.p1.13.m4.1.1.2.1.cmml"><mo id="A1.3.p1.13.m4.1.1.2.1.2.2" xref="A1.3.p1.13.m4.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.3.p1.13.m4.1.1.2.1.2.3" xref="A1.3.p1.13.m4.1.1.2.1.2.3.cmml"><mi id="A1.3.p1.13.m4.1.1.2.1.2.3.2" xref="A1.3.p1.13.m4.1.1.2.1.2.3.2.cmml">t</mi><mo id="A1.3.p1.13.m4.1.1.2.1.2.3.1" xref="A1.3.p1.13.m4.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.3.p1.13.m4.1.1.2.1.2.3.3" xref="A1.3.p1.13.m4.1.1.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.3.p1.13.m4.1.1.2.1.3" xref="A1.3.p1.13.m4.1.1.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="A1.3.p1.13.m4.1.1.2.2" xref="A1.3.p1.13.m4.1.1.2.2.cmml"><mi id="A1.3.p1.13.m4.1.1.2.2.2" xref="A1.3.p1.13.m4.1.1.2.2.2.cmml">λ</mi><mi id="A1.3.p1.13.m4.1.1.2.2.3" xref="A1.3.p1.13.m4.1.1.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.3.p1.13.m4.1.1.3" xref="A1.3.p1.13.m4.1.1.3.cmml"><mi id="A1.3.p1.13.m4.1.1.3.2" xref="A1.3.p1.13.m4.1.1.3.2.cmml">T</mi><mo id="A1.3.p1.13.m4.1.1.3.1" xref="A1.3.p1.13.m4.1.1.3.1.cmml">−</mo><mn id="A1.3.p1.13.m4.1.1.3.3" xref="A1.3.p1.13.m4.1.1.3.3.cmml">1</mn></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.3.p1.13.m4.1b"><apply id="A1.3.p1.13.m4.1.1.cmml" xref="A1.3.p1.13.m4.1.1"><divide id="A1.3.p1.13.m4.1.1.1.cmml" xref="A1.3.p1.13.m4.1.1"></divide><apply id="A1.3.p1.13.m4.1.1.2.cmml" xref="A1.3.p1.13.m4.1.1.2"><apply id="A1.3.p1.13.m4.1.1.2.1.cmml" xref="A1.3.p1.13.m4.1.1.2.1"><csymbol cd="ambiguous" id="A1.3.p1.13.m4.1.1.2.1.1.cmml" xref="A1.3.p1.13.m4.1.1.2.1">superscript</csymbol><apply id="A1.3.p1.13.m4.1.1.2.1.2.cmml" xref="A1.3.p1.13.m4.1.1.2.1"><csymbol cd="ambiguous" id="A1.3.p1.13.m4.1.1.2.1.2.1.cmml" xref="A1.3.p1.13.m4.1.1.2.1">subscript</csymbol><sum id="A1.3.p1.13.m4.1.1.2.1.2.2.cmml" xref="A1.3.p1.13.m4.1.1.2.1.2.2"></sum><apply id="A1.3.p1.13.m4.1.1.2.1.2.3.cmml" xref="A1.3.p1.13.m4.1.1.2.1.2.3"><eq id="A1.3.p1.13.m4.1.1.2.1.2.3.1.cmml" xref="A1.3.p1.13.m4.1.1.2.1.2.3.1"></eq><ci id="A1.3.p1.13.m4.1.1.2.1.2.3.2.cmml" xref="A1.3.p1.13.m4.1.1.2.1.2.3.2">𝑡</ci><cn id="A1.3.p1.13.m4.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.3.p1.13.m4.1.1.2.1.2.3.3">2</cn></apply></apply><ci id="A1.3.p1.13.m4.1.1.2.1.3.cmml" xref="A1.3.p1.13.m4.1.1.2.1.3">𝑇</ci></apply><apply id="A1.3.p1.13.m4.1.1.2.2.cmml" xref="A1.3.p1.13.m4.1.1.2.2"><csymbol cd="ambiguous" id="A1.3.p1.13.m4.1.1.2.2.1.cmml" xref="A1.3.p1.13.m4.1.1.2.2">subscript</csymbol><ci id="A1.3.p1.13.m4.1.1.2.2.2.cmml" xref="A1.3.p1.13.m4.1.1.2.2.2">𝜆</ci><ci id="A1.3.p1.13.m4.1.1.2.2.3.cmml" xref="A1.3.p1.13.m4.1.1.2.2.3">𝑡</ci></apply></apply><apply id="A1.3.p1.13.m4.1.1.3.cmml" xref="A1.3.p1.13.m4.1.1.3"><minus id="A1.3.p1.13.m4.1.1.3.1.cmml" xref="A1.3.p1.13.m4.1.1.3.1"></minus><ci id="A1.3.p1.13.m4.1.1.3.2.cmml" xref="A1.3.p1.13.m4.1.1.3.2">𝑇</ci><cn id="A1.3.p1.13.m4.1.1.3.3.cmml" type="integer" xref="A1.3.p1.13.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.13.m4.1c">\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.13.m4.1d">divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG</annotation></semantics></math> and hence <math alttext="C" class="ltx_Math" display="inline" id="A1.3.p1.14.m5.1"><semantics id="A1.3.p1.14.m5.1a"><mi id="A1.3.p1.14.m5.1.1" xref="A1.3.p1.14.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.14.m5.1b"><ci id="A1.3.p1.14.m5.1.1.cmml" xref="A1.3.p1.14.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.14.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.14.m5.1d">italic_C</annotation></semantics></math> is a scalar that does not depend on the learnable parameter <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="A1.3.p1.15.m6.1"><semantics id="A1.3.p1.15.m6.1a"><mi id="A1.3.p1.15.m6.1.1" xref="A1.3.p1.15.m6.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.15.m6.1b"><ci id="A1.3.p1.15.m6.1.1.cmml" xref="A1.3.p1.15.m6.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.15.m6.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.15.m6.1d">bold_italic_θ</annotation></semantics></math>.
Therefore, <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="A1.3.p1.16.m7.1"><semantics id="A1.3.p1.16.m7.1a"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.16.m7.1.1" xref="A1.3.p1.16.m7.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.16.m7.1b"><ci id="A1.3.p1.16.m7.1.1.cmml" xref="A1.3.p1.16.m7.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.16.m7.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.16.m7.1d">caligraphic_L</annotation></semantics></math> can be rewritten into a sum of two parts: <math alttext="\mathcal{L}=\mathcal{L}_{1}+\mathcal{L}_{2}" class="ltx_Math" display="inline" id="A1.3.p1.17.m8.1"><semantics id="A1.3.p1.17.m8.1a"><mrow id="A1.3.p1.17.m8.1.1" xref="A1.3.p1.17.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.17.m8.1.1.2" xref="A1.3.p1.17.m8.1.1.2.cmml">ℒ</mi><mo id="A1.3.p1.17.m8.1.1.1" xref="A1.3.p1.17.m8.1.1.1.cmml">=</mo><mrow id="A1.3.p1.17.m8.1.1.3" xref="A1.3.p1.17.m8.1.1.3.cmml"><msub id="A1.3.p1.17.m8.1.1.3.2" xref="A1.3.p1.17.m8.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.17.m8.1.1.3.2.2" xref="A1.3.p1.17.m8.1.1.3.2.2.cmml">ℒ</mi><mn id="A1.3.p1.17.m8.1.1.3.2.3" xref="A1.3.p1.17.m8.1.1.3.2.3.cmml">1</mn></msub><mo id="A1.3.p1.17.m8.1.1.3.1" xref="A1.3.p1.17.m8.1.1.3.1.cmml">+</mo><msub id="A1.3.p1.17.m8.1.1.3.3" xref="A1.3.p1.17.m8.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.17.m8.1.1.3.3.2" xref="A1.3.p1.17.m8.1.1.3.3.2.cmml">ℒ</mi><mn id="A1.3.p1.17.m8.1.1.3.3.3" xref="A1.3.p1.17.m8.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.17.m8.1b"><apply id="A1.3.p1.17.m8.1.1.cmml" xref="A1.3.p1.17.m8.1.1"><eq id="A1.3.p1.17.m8.1.1.1.cmml" xref="A1.3.p1.17.m8.1.1.1"></eq><ci id="A1.3.p1.17.m8.1.1.2.cmml" xref="A1.3.p1.17.m8.1.1.2">ℒ</ci><apply id="A1.3.p1.17.m8.1.1.3.cmml" xref="A1.3.p1.17.m8.1.1.3"><plus id="A1.3.p1.17.m8.1.1.3.1.cmml" xref="A1.3.p1.17.m8.1.1.3.1"></plus><apply id="A1.3.p1.17.m8.1.1.3.2.cmml" xref="A1.3.p1.17.m8.1.1.3.2"><csymbol cd="ambiguous" id="A1.3.p1.17.m8.1.1.3.2.1.cmml" xref="A1.3.p1.17.m8.1.1.3.2">subscript</csymbol><ci id="A1.3.p1.17.m8.1.1.3.2.2.cmml" xref="A1.3.p1.17.m8.1.1.3.2.2">ℒ</ci><cn id="A1.3.p1.17.m8.1.1.3.2.3.cmml" type="integer" xref="A1.3.p1.17.m8.1.1.3.2.3">1</cn></apply><apply id="A1.3.p1.17.m8.1.1.3.3.cmml" xref="A1.3.p1.17.m8.1.1.3.3"><csymbol cd="ambiguous" id="A1.3.p1.17.m8.1.1.3.3.1.cmml" xref="A1.3.p1.17.m8.1.1.3.3">subscript</csymbol><ci id="A1.3.p1.17.m8.1.1.3.3.2.cmml" xref="A1.3.p1.17.m8.1.1.3.3.2">ℒ</ci><cn id="A1.3.p1.17.m8.1.1.3.3.3.cmml" type="integer" xref="A1.3.p1.17.m8.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.17.m8.1c">\mathcal{L}=\mathcal{L}_{1}+\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.17.m8.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, where</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{1}=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}%
\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{%
\text{denoising term}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}%
\left[\underbrace{\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(%
1)}\right\rVert_{2}^{2}}_{\text{one-step reconstruction term}}\right]-\frac{n}%
{2}\log(2\pi)+D_{\text{KL}}\left(q(\mathbf{x}_{T}|\mathbf{x}_{0})||p(\mathbf{x%
}_{T})\right)" class="ltx_math_unparsed" display="block" id="A1.E12.m1.8"><semantics id="A1.E12.m1.8a"><mrow id="A1.E12.m1.8b"><msub id="A1.E12.m1.8.9"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.8.9.2">ℒ</mi><mn id="A1.E12.m1.8.9.3">1</mn></msub><mo id="A1.E12.m1.8.10">=</mo><msub id="A1.E12.m1.8.11"><mi id="A1.E12.m1.8.11.2">𝔼</mi><mrow id="A1.E12.m1.2.2.2"><mi id="A1.E12.m1.2.2.2.4">t</mi><mo id="A1.E12.m1.2.2.2.3">∼</mo><mrow id="A1.E12.m1.2.2.2.5"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.2.2.2.5.2">𝒰</mi><mo id="A1.E12.m1.2.2.2.5.1">⁢</mo><mrow id="A1.E12.m1.2.2.2.5.3.2"><mo id="A1.E12.m1.2.2.2.5.3.2.1" stretchy="false">[</mo><mn id="A1.E12.m1.1.1.1.1">2</mn><mo id="A1.E12.m1.2.2.2.5.3.2.2">,</mo><mi id="A1.E12.m1.2.2.2.2">T</mi><mo id="A1.E12.m1.2.2.2.5.3.2.3" stretchy="false">]</mo></mrow></mrow></mrow></msub><mrow id="A1.E12.m1.8.12"><mo id="A1.E12.m1.8.12.1" maxsize="210%" minsize="210%">[</mo><munder id="A1.E12.m1.8.12.2"><munder accentunder="true" id="A1.E12.m1.4.4"><mrow id="A1.E12.m1.4.4.2"><msub id="A1.E12.m1.4.4.2.4"><mi id="A1.E12.m1.4.4.2.4.2">μ</mi><mi id="A1.E12.m1.4.4.2.4.3">t</mi></msub><mo id="A1.E12.m1.4.4.2.3" lspace="0em">⁢</mo><msubsup id="A1.E12.m1.4.4.2.2"><mrow id="A1.E12.m1.4.4.2.2.1.1.1"><mo fence="true" id="A1.E12.m1.4.4.2.2.1.1.1.2" rspace="0em" stretchy="true">∥</mo><mrow id="A1.E12.m1.4.4.2.2.1.1.1.1"><msub id="A1.E12.m1.4.4.2.2.1.1.1.1.2"><mi id="A1.E12.m1.4.4.2.2.1.1.1.1.2.2">𝐱</mi><mn id="A1.E12.m1.4.4.2.2.1.1.1.1.2.3">0</mn></msub><mo id="A1.E12.m1.4.4.2.2.1.1.1.1.1">−</mo><msubsup id="A1.E12.m1.4.4.2.2.1.1.1.1.3"><mover accent="true" id="A1.E12.m1.4.4.2.2.1.1.1.1.3.2.2"><mi id="A1.E12.m1.4.4.2.2.1.1.1.1.3.2.2.2">𝐱</mi><mo id="A1.E12.m1.4.4.2.2.1.1.1.1.3.2.2.1">^</mo></mover><mn id="A1.E12.m1.4.4.2.2.1.1.1.1.3.2.3">0</mn><mrow id="A1.E12.m1.3.3.1.1.1.3"><mo id="A1.E12.m1.3.3.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E12.m1.3.3.1.1.1.1">t</mi><mo id="A1.E12.m1.3.3.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E12.m1.4.4.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true">∥</mo></mrow><mn id="A1.E12.m1.4.4.2.2.1.3">2</mn><mn id="A1.E12.m1.4.4.2.2.3">2</mn></msubsup></mrow><mo id="A1.E12.m1.4.4.3">⏟</mo></munder><mtext id="A1.E12.m1.8.12.2.2">denoising term</mtext></munder><mo id="A1.E12.m1.8.12.3" maxsize="210%" minsize="210%">]</mo></mrow><mo id="A1.E12.m1.8.13">+</mo><msub id="A1.E12.m1.8.14"><mi id="A1.E12.m1.8.14.2">𝔼</mi><mrow id="A1.E12.m1.5.5.1"><mi id="A1.E12.m1.5.5.1.3">q</mi><mo id="A1.E12.m1.5.5.1.2">⁢</mo><mrow id="A1.E12.m1.5.5.1.1.1"><mo id="A1.E12.m1.5.5.1.1.1.2" stretchy="false">(</mo><mrow id="A1.E12.m1.5.5.1.1.1.1"><msub id="A1.E12.m1.5.5.1.1.1.1.2"><mi id="A1.E12.m1.5.5.1.1.1.1.2.2">𝐱</mi><mn id="A1.E12.m1.5.5.1.1.1.1.2.3">1</mn></msub><mo fence="false" id="A1.E12.m1.5.5.1.1.1.1.1">|</mo><msub id="A1.E12.m1.5.5.1.1.1.1.3"><mi id="A1.E12.m1.5.5.1.1.1.1.3.2">𝐱</mi><mn id="A1.E12.m1.5.5.1.1.1.1.3.3">0</mn></msub></mrow><mo id="A1.E12.m1.5.5.1.1.1.3" stretchy="false">)</mo></mrow></mrow></msub><mrow id="A1.E12.m1.8.15"><mo id="A1.E12.m1.8.15.1">[</mo><munder id="A1.E12.m1.8.15.2"><munder accentunder="true" id="A1.E12.m1.7.7"><mrow id="A1.E12.m1.7.7.2"><mfrac id="A1.E12.m1.7.7.2.4"><mn id="A1.E12.m1.7.7.2.4.2">1</mn><mn id="A1.E12.m1.7.7.2.4.3">2</mn></mfrac><mo id="A1.E12.m1.7.7.2.3" lspace="0em">⁢</mo><msubsup id="A1.E12.m1.7.7.2.2"><mrow id="A1.E12.m1.7.7.2.2.1.1.1"><mo fence="true" id="A1.E12.m1.7.7.2.2.1.1.1.2" rspace="0em" stretchy="true">∥</mo><mrow id="A1.E12.m1.7.7.2.2.1.1.1.1"><msub id="A1.E12.m1.7.7.2.2.1.1.1.1.2"><mi id="A1.E12.m1.7.7.2.2.1.1.1.1.2.2">𝐱</mi><mn id="A1.E12.m1.7.7.2.2.1.1.1.1.2.3">0</mn></msub><mo id="A1.E12.m1.7.7.2.2.1.1.1.1.1">−</mo><msubsup id="A1.E12.m1.7.7.2.2.1.1.1.1.3"><mover accent="true" id="A1.E12.m1.7.7.2.2.1.1.1.1.3.2.2"><mi id="A1.E12.m1.7.7.2.2.1.1.1.1.3.2.2.2">𝐱</mi><mo id="A1.E12.m1.7.7.2.2.1.1.1.1.3.2.2.1">^</mo></mover><mn id="A1.E12.m1.7.7.2.2.1.1.1.1.3.2.3">0</mn><mrow id="A1.E12.m1.6.6.1.1.1.3"><mo id="A1.E12.m1.6.6.1.1.1.3.1" stretchy="false">(</mo><mn id="A1.E12.m1.6.6.1.1.1.1">1</mn><mo id="A1.E12.m1.6.6.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup></mrow><mo fence="true" id="A1.E12.m1.7.7.2.2.1.1.1.3" lspace="0em" rspace="0em" stretchy="true">∥</mo></mrow><mn id="A1.E12.m1.7.7.2.2.1.3">2</mn><mn id="A1.E12.m1.7.7.2.2.3">2</mn></msubsup></mrow><mo id="A1.E12.m1.7.7.3">⏟</mo></munder><mtext id="A1.E12.m1.8.15.2.2">one-step reconstruction term</mtext></munder><mo id="A1.E12.m1.8.15.3">]</mo></mrow><mo id="A1.E12.m1.8.16">−</mo><mfrac id="A1.E12.m1.8.17"><mi id="A1.E12.m1.8.17.2">n</mi><mn id="A1.E12.m1.8.17.3">2</mn></mfrac><mi id="A1.E12.m1.8.8">log</mi><mrow id="A1.E12.m1.8.18"><mo id="A1.E12.m1.8.18.1" stretchy="false">(</mo><mn id="A1.E12.m1.8.18.2">2</mn><mi id="A1.E12.m1.8.18.3">π</mi><mo id="A1.E12.m1.8.18.4" stretchy="false">)</mo></mrow><mo id="A1.E12.m1.8.19">+</mo><msub id="A1.E12.m1.8.20"><mi id="A1.E12.m1.8.20.2">D</mi><mtext id="A1.E12.m1.8.20.3">KL</mtext></msub><mrow id="A1.E12.m1.8.21"><mo id="A1.E12.m1.8.21.1">(</mo><mi id="A1.E12.m1.8.21.2">q</mi><mrow id="A1.E12.m1.8.21.3"><mo id="A1.E12.m1.8.21.3.1" stretchy="false">(</mo><msub id="A1.E12.m1.8.21.3.2"><mi id="A1.E12.m1.8.21.3.2.2">𝐱</mi><mi id="A1.E12.m1.8.21.3.2.3">T</mi></msub><mo fence="false" id="A1.E12.m1.8.21.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E12.m1.8.21.3.4"><mi id="A1.E12.m1.8.21.3.4.2">𝐱</mi><mn id="A1.E12.m1.8.21.3.4.3">0</mn></msub><mo id="A1.E12.m1.8.21.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E12.m1.8.21.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E12.m1.8.21.5" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E12.m1.8.21.6">p</mi><mrow id="A1.E12.m1.8.21.7"><mo id="A1.E12.m1.8.21.7.1" stretchy="false">(</mo><msub id="A1.E12.m1.8.21.7.2"><mi id="A1.E12.m1.8.21.7.2.2">𝐱</mi><mi id="A1.E12.m1.8.21.7.2.3">T</mi></msub><mo id="A1.E12.m1.8.21.7.3" stretchy="false">)</mo></mrow><mo id="A1.E12.m1.8.21.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E12.m1.8c">\mathcal{L}_{1}=\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}\underbrace{\mu_{t}%
\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(t)}\right\rVert_{2}^{2}}_{%
\text{denoising term}}\bigg{]}+\mathbb{E}_{q(\mathbf{x}_{1}|\mathbf{x}_{0})}%
\left[\underbrace{\frac{1}{2}\left\lVert\mathbf{x}_{0}-\hat{\mathbf{x}}_{0}^{(%
1)}\right\rVert_{2}^{2}}_{\text{one-step reconstruction term}}\right]-\frac{n}%
{2}\log(2\pi)+D_{\text{KL}}\left(q(\mathbf{x}_{T}|\mathbf{x}_{0})||p(\mathbf{x%
}_{T})\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.8d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ under⏟ start_ARG italic_μ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT denoising term end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ under⏟ start_ARG divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∥ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT one-step reconstruction term end_POSTSUBSCRIPT ] - divide start_ARG italic_n end_ARG start_ARG 2 end_ARG roman_log ( 2 italic_π ) + italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_q ( bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) | | italic_p ( bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.25">and</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{2}&amp;=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}%
\lambda_{t}\log J_{\kappa_{\mathbf{x}}}^{2}+\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{s}^{T}F_{a}(\mathbf{x})+\underbrace{\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}\bigg{]}+\log Z\end{split}" class="ltx_Math" display="block" id="A1.E13.m1.34"><semantics id="A1.E13.m1.34a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E13.m1.34.34.2" xref="A1.E13.m1.33.33.1.cmml"><mtr id="A1.E13.m1.34.34.2a" xref="A1.E13.m1.33.33.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E13.m1.34.34.2b" xref="A1.E13.m1.33.33.1.cmml"><msub id="A1.E13.m1.2.2.2.2.2" xref="A1.E13.m1.33.33.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.cmml">ℒ</mi><mn id="A1.E13.m1.2.2.2.2.2.2.1" xref="A1.E13.m1.2.2.2.2.2.2.1.cmml">2</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E13.m1.34.34.2c" xref="A1.E13.m1.33.33.1.cmml"><mrow id="A1.E13.m1.34.34.2.33.33.31" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.34.34.2.33.33.31.32" xref="A1.E13.m1.33.33.1.cmml"></mi><mo id="A1.E13.m1.3.3.3.3.1.1" xref="A1.E13.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31" xref="A1.E13.m1.33.33.1.cmml"><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1" xref="A1.E13.m1.33.33.1.cmml"><mo id="A1.E13.m1.34.34.2.33.33.31.31.1a" xref="A1.E13.m1.33.33.1.cmml">−</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1" xref="A1.E13.m1.33.33.1.cmml"><msub id="A1.E13.m1.34.34.2.33.33.31.31.1.1.3" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.5.5.5.5.3.3" xref="A1.E13.m1.5.5.5.5.3.3.cmml">𝔼</mi><mrow id="A1.E13.m1.6.6.6.6.4.4.1" xref="A1.E13.m1.6.6.6.6.4.4.1.cmml"><mi id="A1.E13.m1.6.6.6.6.4.4.1.4" xref="A1.E13.m1.6.6.6.6.4.4.1.4.cmml">t</mi><mo id="A1.E13.m1.6.6.6.6.4.4.1.3" xref="A1.E13.m1.6.6.6.6.4.4.1.3.cmml">∼</mo><mrow id="A1.E13.m1.6.6.6.6.4.4.1.5" xref="A1.E13.m1.6.6.6.6.4.4.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.6.6.6.6.4.4.1.5.2" xref="A1.E13.m1.6.6.6.6.4.4.1.5.2.cmml">𝒰</mi><mo id="A1.E13.m1.6.6.6.6.4.4.1.5.1" xref="A1.E13.m1.6.6.6.6.4.4.1.5.1.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.6.6.4.4.1.5.3.2" xref="A1.E13.m1.6.6.6.6.4.4.1.5.3.1.cmml"><mo id="A1.E13.m1.6.6.6.6.4.4.1.5.3.2.1" stretchy="false" xref="A1.E13.m1.6.6.6.6.4.4.1.5.3.1.cmml">[</mo><mn id="A1.E13.m1.6.6.6.6.4.4.1.1" xref="A1.E13.m1.6.6.6.6.4.4.1.1.cmml">2</mn><mo id="A1.E13.m1.6.6.6.6.4.4.1.5.3.2.2" xref="A1.E13.m1.6.6.6.6.4.4.1.5.3.1.cmml">,</mo><mi id="A1.E13.m1.6.6.6.6.4.4.1.2" xref="A1.E13.m1.6.6.6.6.4.4.1.2.cmml">T</mi><mo id="A1.E13.m1.6.6.6.6.4.4.1.5.3.2.3" stretchy="false" xref="A1.E13.m1.6.6.6.6.4.4.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.2" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1" xref="A1.E13.m1.33.33.1.cmml"><mo id="A1.E13.m1.7.7.7.7.5.5" maxsize="210%" minsize="210%" xref="A1.E13.m1.33.33.1.cmml">[</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1" xref="A1.E13.m1.33.33.1.cmml"><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1" xref="A1.E13.m1.33.33.1.cmml"><msub id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1.2" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.8.8.8.8.6.6" xref="A1.E13.m1.8.8.8.8.6.6.cmml">λ</mi><mi id="A1.E13.m1.9.9.9.9.7.7.1" xref="A1.E13.m1.9.9.9.9.7.7.1.cmml">t</mi></msub><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1.1" lspace="0.167em" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1.3" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.10.10.10.10.8.8" xref="A1.E13.m1.10.10.10.10.8.8.cmml">log</mi><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E13.m1.33.33.1.cmml">⁡</mo><msubsup id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.1.3.1" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.11.11.11.11.9.9" xref="A1.E13.m1.11.11.11.11.9.9.cmml">J</mi><msub id="A1.E13.m1.12.12.12.12.10.10.1" xref="A1.E13.m1.12.12.12.12.10.10.1.cmml"><mi id="A1.E13.m1.12.12.12.12.10.10.1.2" xref="A1.E13.m1.12.12.12.12.10.10.1.2.cmml">κ</mi><mi id="A1.E13.m1.12.12.12.12.10.10.1.3" xref="A1.E13.m1.12.12.12.12.10.10.1.3.cmml">𝐱</mi></msub><mn id="A1.E13.m1.13.13.13.13.11.11.1" xref="A1.E13.m1.13.13.13.13.11.11.1.cmml">2</mn></msubsup></mrow></mrow><mo id="A1.E13.m1.14.14.14.14.12.12" xref="A1.E13.m1.14.14.14.14.12.12.cmml">+</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2" xref="A1.E13.m1.33.33.1.cmml"><msub id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.2" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.15.15.15.15.13.13" xref="A1.E13.m1.15.15.15.15.13.13.cmml">λ</mi><mi id="A1.E13.m1.16.16.16.16.14.14.1" xref="A1.E13.m1.16.16.16.16.14.14.1.cmml">t</mi></msub><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.1" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><msub id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.3" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.17.17.17.17.15.15" xref="A1.E13.m1.17.17.17.17.15.15.cmml">κ</mi><mi id="A1.E13.m1.18.18.18.18.16.16.1" xref="A1.E13.m1.18.18.18.18.16.16.1.cmml">𝐱</mi></msub><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.1a" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><msup id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.4" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.19.19.19.19.17.17" xref="A1.E13.m1.19.19.19.19.17.17.cmml">𝐬</mi><mi id="A1.E13.m1.20.20.20.20.18.18.1" xref="A1.E13.m1.20.20.20.20.18.18.1.cmml">T</mi></msup><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.1b" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><msub id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.5" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.21.21.21.21.19.19" xref="A1.E13.m1.21.21.21.21.19.19.cmml">F</mi><mi id="A1.E13.m1.22.22.22.22.20.20.1" xref="A1.E13.m1.22.22.22.22.20.20.1.cmml">a</mi></msub><mo id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.1c" xref="A1.E13.m1.33.33.1.cmml">⁢</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.2.6" xref="A1.E13.m1.33.33.1.cmml"><mo id="A1.E13.m1.23.23.23.23.21.21" stretchy="false" xref="A1.E13.m1.33.33.1.cmml">(</mo><mi id="A1.E13.m1.24.24.24.24.22.22" xref="A1.E13.m1.24.24.24.24.22.22.cmml">𝐱</mi><mo id="A1.E13.m1.25.25.25.25.23.23" stretchy="false" xref="A1.E13.m1.33.33.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.14.14.14.14.12.12a" xref="A1.E13.m1.14.14.14.14.12.12.cmml">+</mo><munder id="A1.E13.m1.34.34.2.33.33.31.31.1.1.1.1.1.3" xref="A1.E13.m1.33.33.1.cmml"><munder accentunder="true" id="A1.E13.m1.27.27.27.27.25.25" xref="A1.E13.m1.27.27.27.27.25.25.cmml"><mrow id="A1.E13.m1.27.27.27.27.25.25.2" xref="A1.E13.m1.27.27.27.27.25.25.2.cmml"><msub id="A1.E13.m1.27.27.27.27.25.25.2.4" xref="A1.E13.m1.27.27.27.27.25.25.2.4.cmml"><mi id="A1.E13.m1.27.27.27.27.25.25.2.4.2" xref="A1.E13.m1.27.27.27.27.25.25.2.4.2.cmml">λ</mi><mi id="A1.E13.m1.27.27.27.27.25.25.2.4.3" xref="A1.E13.m1.27.27.27.27.25.25.2.4.3.cmml">t</mi></msub><mo id="A1.E13.m1.27.27.27.27.25.25.2.3" xref="A1.E13.m1.27.27.27.27.25.25.2.3.cmml">⁢</mo><msub id="A1.E13.m1.27.27.27.27.25.25.2.5" xref="A1.E13.m1.27.27.27.27.25.25.2.5.cmml"><mi id="A1.E13.m1.27.27.27.27.25.25.2.5.2" xref="A1.E13.m1.27.27.27.27.25.25.2.5.2.cmml">κ</mi><mi id="A1.E13.m1.27.27.27.27.25.25.2.5.3" xref="A1.E13.m1.27.27.27.27.25.25.2.5.3.cmml">𝐱</mi></msub><mo id="A1.E13.m1.27.27.27.27.25.25.2.3a" xref="A1.E13.m1.27.27.27.27.25.25.2.3.cmml">⁢</mo><msup id="A1.E13.m1.27.27.27.27.25.25.2.6" xref="A1.E13.m1.27.27.27.27.25.25.2.6.cmml"><mi id="A1.E13.m1.27.27.27.27.25.25.2.6.2" xref="A1.E13.m1.27.27.27.27.25.25.2.6.2.cmml">𝐲</mi><mi id="A1.E13.m1.27.27.27.27.25.25.2.6.3" xref="A1.E13.m1.27.27.27.27.25.25.2.6.3.cmml">T</mi></msup><mo id="A1.E13.m1.27.27.27.27.25.25.2.3b" xref="A1.E13.m1.27.27.27.27.25.25.2.3.cmml">⁢</mo><msub id="A1.E13.m1.27.27.27.27.25.25.2.7" xref="A1.E13.m1.27.27.27.27.25.25.2.7.cmml"><mi id="A1.E13.m1.27.27.27.27.25.25.2.7.2" xref="A1.E13.m1.27.27.27.27.25.25.2.7.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E13.m1.27.27.27.27.25.25.2.7.3" mathvariant="bold-italic" xref="A1.E13.m1.27.27.27.27.25.25.2.7.3.cmml">ϕ</mi></msub><mo id="A1.E13.m1.27.27.27.27.25.25.2.3c" xref="A1.E13.m1.27.27.27.27.25.25.2.3.cmml">⁢</mo><mrow id="A1.E13.m1.27.27.27.27.25.25.2.2.1" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml"><mo id="A1.E13.m1.27.27.27.27.25.25.2.2.1.2" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml">(</mo><msubsup id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml"><mover accent="true" id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.cmml"><mi id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.2" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.1" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.3" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.3.cmml">0</mn><mrow id="A1.E13.m1.27.27.27.27.25.25.1.1.1.3" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml"><mo id="A1.E13.m1.27.27.27.27.25.25.1.1.1.3.1" stretchy="false" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml">(</mo><mi id="A1.E13.m1.27.27.27.27.25.25.1.1.1.1" xref="A1.E13.m1.27.27.27.27.25.25.1.1.1.1.cmml">t</mi><mo id="A1.E13.m1.27.27.27.27.25.25.1.1.1.3.2" stretchy="false" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E13.m1.27.27.27.27.25.25.2.2.1.3" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.27.27.27.27.25.25.3" xref="A1.E13.m1.27.27.27.27.25.25.3.cmml">⏟</mo></munder><mtext id="A1.E13.m1.28.28.28.28.26.26.1" xref="A1.E13.m1.28.28.28.28.26.26.1a.cmml">inner-product term</mtext></munder></mrow><mo id="A1.E13.m1.29.29.29.29.27.27" maxsize="210%" minsize="210%" xref="A1.E13.m1.33.33.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E13.m1.30.30.30.30.28.28" xref="A1.E13.m1.30.30.30.30.28.28.cmml">+</mo><mrow id="A1.E13.m1.34.34.2.33.33.31.31.2" xref="A1.E13.m1.33.33.1.cmml"><mi id="A1.E13.m1.31.31.31.31.29.29" xref="A1.E13.m1.31.31.31.31.29.29.cmml">log</mi><mo id="A1.E13.m1.34.34.2.33.33.31.31.2a" lspace="0.167em" xref="A1.E13.m1.33.33.1.cmml">⁡</mo><mi id="A1.E13.m1.32.32.32.32.30.30" xref="A1.E13.m1.32.32.32.32.30.30.cmml">Z</mi></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E13.m1.34b"><apply id="A1.E13.m1.33.33.1.cmml" xref="A1.E13.m1.34.34.2"><eq id="A1.E13.m1.3.3.3.3.1.1.cmml" xref="A1.E13.m1.3.3.3.3.1.1"></eq><apply id="A1.E13.m1.33.33.1.3.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.3.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1">ℒ</ci><cn id="A1.E13.m1.2.2.2.2.2.2.1.cmml" type="integer" xref="A1.E13.m1.2.2.2.2.2.2.1">2</cn></apply><apply id="A1.E13.m1.33.33.1.1.cmml" xref="A1.E13.m1.34.34.2"><plus id="A1.E13.m1.30.30.30.30.28.28.cmml" xref="A1.E13.m1.30.30.30.30.28.28"></plus><apply id="A1.E13.m1.33.33.1.1.1.cmml" xref="A1.E13.m1.34.34.2"><minus id="A1.E13.m1.4.4.4.4.2.2.cmml" xref="A1.E13.m1.34.34.2"></minus><apply id="A1.E13.m1.33.33.1.1.1.1.cmml" xref="A1.E13.m1.34.34.2"><times id="A1.E13.m1.33.33.1.1.1.1.2.cmml" xref="A1.E13.m1.34.34.2"></times><apply id="A1.E13.m1.33.33.1.1.1.1.3.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.3.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.5.5.5.5.3.3.cmml" xref="A1.E13.m1.5.5.5.5.3.3">𝔼</ci><apply id="A1.E13.m1.6.6.6.6.4.4.1.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1"><csymbol cd="latexml" id="A1.E13.m1.6.6.6.6.4.4.1.3.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.3">similar-to</csymbol><ci id="A1.E13.m1.6.6.6.6.4.4.1.4.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.4">𝑡</ci><apply id="A1.E13.m1.6.6.6.6.4.4.1.5.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.5"><times id="A1.E13.m1.6.6.6.6.4.4.1.5.1.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.5.1"></times><ci id="A1.E13.m1.6.6.6.6.4.4.1.5.2.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.5.2">𝒰</ci><interval closure="closed" id="A1.E13.m1.6.6.6.6.4.4.1.5.3.1.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.5.3.2"><cn id="A1.E13.m1.6.6.6.6.4.4.1.1.cmml" type="integer" xref="A1.E13.m1.6.6.6.6.4.4.1.1">2</cn><ci id="A1.E13.m1.6.6.6.6.4.4.1.2.cmml" xref="A1.E13.m1.6.6.6.6.4.4.1.2">𝑇</ci></interval></apply></apply></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.2.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="latexml" id="A1.E13.m1.33.33.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.34.34.2">delimited-[]</csymbol><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.34.34.2"><plus id="A1.E13.m1.14.14.14.14.12.12.cmml" xref="A1.E13.m1.14.14.14.14.12.12"></plus><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.34.34.2"><times id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.34.34.2"></times><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.8.8.8.8.6.6.cmml" xref="A1.E13.m1.8.8.8.8.6.6">𝜆</ci><ci id="A1.E13.m1.9.9.9.9.7.7.1.cmml" xref="A1.E13.m1.9.9.9.9.7.7.1">𝑡</ci></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.34.34.2"><log id="A1.E13.m1.10.10.10.10.8.8.cmml" xref="A1.E13.m1.10.10.10.10.8.8"></log><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="A1.E13.m1.34.34.2">superscript</csymbol><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.11.11.11.11.9.9.cmml" xref="A1.E13.m1.11.11.11.11.9.9">𝐽</ci><apply id="A1.E13.m1.12.12.12.12.10.10.1.cmml" xref="A1.E13.m1.12.12.12.12.10.10.1"><csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.12.10.10.1.1.cmml" xref="A1.E13.m1.12.12.12.12.10.10.1">subscript</csymbol><ci id="A1.E13.m1.12.12.12.12.10.10.1.2.cmml" xref="A1.E13.m1.12.12.12.12.10.10.1.2">𝜅</ci><ci id="A1.E13.m1.12.12.12.12.10.10.1.3.cmml" xref="A1.E13.m1.12.12.12.12.10.10.1.3">𝐱</ci></apply></apply><cn id="A1.E13.m1.13.13.13.13.11.11.1.cmml" type="integer" xref="A1.E13.m1.13.13.13.13.11.11.1">2</cn></apply></apply></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.34.34.2"><times id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.34.34.2"></times><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.15.15.15.15.13.13.cmml" xref="A1.E13.m1.15.15.15.15.13.13">𝜆</ci><ci id="A1.E13.m1.16.16.16.16.14.14.1.cmml" xref="A1.E13.m1.16.16.16.16.14.14.1">𝑡</ci></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.17.17.17.17.15.15.cmml" xref="A1.E13.m1.17.17.17.17.15.15">𝜅</ci><ci id="A1.E13.m1.18.18.18.18.16.16.1.cmml" xref="A1.E13.m1.18.18.18.18.16.16.1">𝐱</ci></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.4.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.E13.m1.34.34.2">superscript</csymbol><ci id="A1.E13.m1.19.19.19.19.17.17.cmml" xref="A1.E13.m1.19.19.19.19.17.17">𝐬</ci><ci id="A1.E13.m1.20.20.20.20.18.18.1.cmml" xref="A1.E13.m1.20.20.20.20.18.18.1">𝑇</ci></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.5.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.3.5.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><ci id="A1.E13.m1.21.21.21.21.19.19.cmml" xref="A1.E13.m1.21.21.21.21.19.19">𝐹</ci><ci id="A1.E13.m1.22.22.22.22.20.20.1.cmml" xref="A1.E13.m1.22.22.22.22.20.20.1">𝑎</ci></apply><ci id="A1.E13.m1.24.24.24.24.22.22.cmml" xref="A1.E13.m1.24.24.24.24.22.22">𝐱</ci></apply><apply id="A1.E13.m1.33.33.1.1.1.1.1.1.1.4.cmml" xref="A1.E13.m1.34.34.2"><csymbol cd="ambiguous" id="A1.E13.m1.33.33.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E13.m1.34.34.2">subscript</csymbol><apply id="A1.E13.m1.27.27.27.27.25.25.cmml" xref="A1.E13.m1.27.27.27.27.25.25"><ci id="A1.E13.m1.27.27.27.27.25.25.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.3">⏟</ci><apply id="A1.E13.m1.27.27.27.27.25.25.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2"><times id="A1.E13.m1.27.27.27.27.25.25.2.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.3"></times><apply id="A1.E13.m1.27.27.27.27.25.25.2.4.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.4"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.4.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.4">subscript</csymbol><ci id="A1.E13.m1.27.27.27.27.25.25.2.4.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.4.2">𝜆</ci><ci id="A1.E13.m1.27.27.27.27.25.25.2.4.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.4.3">𝑡</ci></apply><apply id="A1.E13.m1.27.27.27.27.25.25.2.5.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.5"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.5.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.5">subscript</csymbol><ci id="A1.E13.m1.27.27.27.27.25.25.2.5.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.5.2">𝜅</ci><ci id="A1.E13.m1.27.27.27.27.25.25.2.5.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.5.3">𝐱</ci></apply><apply id="A1.E13.m1.27.27.27.27.25.25.2.6.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.6"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.6.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.6">superscript</csymbol><ci id="A1.E13.m1.27.27.27.27.25.25.2.6.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.6.2">𝐲</ci><ci id="A1.E13.m1.27.27.27.27.25.25.2.6.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.6.3">𝑇</ci></apply><apply id="A1.E13.m1.27.27.27.27.25.25.2.7.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.7"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.7.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.7">subscript</csymbol><ci id="A1.E13.m1.27.27.27.27.25.25.2.7.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.7.2">𝑓</ci><ci id="A1.E13.m1.27.27.27.27.25.25.2.7.3.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.7.3">bold-italic-ϕ</ci></apply><apply id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1">superscript</csymbol><apply id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1"><csymbol cd="ambiguous" id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1">subscript</csymbol><apply id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2"><ci id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.1">^</ci><ci id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.2.cmml" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.3.cmml" type="integer" xref="A1.E13.m1.27.27.27.27.25.25.2.2.1.1.2.3">0</cn></apply><ci id="A1.E13.m1.27.27.27.27.25.25.1.1.1.1.cmml" xref="A1.E13.m1.27.27.27.27.25.25.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="A1.E13.m1.28.28.28.28.26.26.1a.cmml" xref="A1.E13.m1.28.28.28.28.26.26.1"><mtext id="A1.E13.m1.28.28.28.28.26.26.1.cmml" mathsize="70%" xref="A1.E13.m1.28.28.28.28.26.26.1">inner-product term</mtext></ci></apply></apply></apply></apply></apply><apply id="A1.E13.m1.33.33.1.1.3.cmml" xref="A1.E13.m1.34.34.2"><log id="A1.E13.m1.31.31.31.31.29.29.cmml" xref="A1.E13.m1.31.31.31.31.29.29"></log><ci id="A1.E13.m1.32.32.32.32.30.30.cmml" xref="A1.E13.m1.32.32.32.32.30.30">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.34c">\begin{split}\mathcal{L}_{2}&amp;=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\bigg{[}%
\lambda_{t}\log J_{\kappa_{\mathbf{x}}}^{2}+\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{s}^{T}F_{a}(\mathbf{x})+\underbrace{\lambda_{t}\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}\bigg{]}+\log Z\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.34d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL start_CELL = - blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT roman_log italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) + under⏟ start_ARG italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT ] + roman_log italic_Z end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.19">We recognize <math alttext="-\mathcal{L}_{1}" class="ltx_Math" display="inline" id="A1.3.p1.18.m1.1"><semantics id="A1.3.p1.18.m1.1a"><mrow id="A1.3.p1.18.m1.1.1" xref="A1.3.p1.18.m1.1.1.cmml"><mo id="A1.3.p1.18.m1.1.1a" xref="A1.3.p1.18.m1.1.1.cmml">−</mo><msub id="A1.3.p1.18.m1.1.1.2" xref="A1.3.p1.18.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.18.m1.1.1.2.2" xref="A1.3.p1.18.m1.1.1.2.2.cmml">ℒ</mi><mn id="A1.3.p1.18.m1.1.1.2.3" xref="A1.3.p1.18.m1.1.1.2.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.18.m1.1b"><apply id="A1.3.p1.18.m1.1.1.cmml" xref="A1.3.p1.18.m1.1.1"><minus id="A1.3.p1.18.m1.1.1.1.cmml" xref="A1.3.p1.18.m1.1.1"></minus><apply id="A1.3.p1.18.m1.1.1.2.cmml" xref="A1.3.p1.18.m1.1.1.2"><csymbol cd="ambiguous" id="A1.3.p1.18.m1.1.1.2.1.cmml" xref="A1.3.p1.18.m1.1.1.2">subscript</csymbol><ci id="A1.3.p1.18.m1.1.1.2.2.cmml" xref="A1.3.p1.18.m1.1.1.2.2">ℒ</ci><cn id="A1.3.p1.18.m1.1.1.2.3.cmml" type="integer" xref="A1.3.p1.18.m1.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.18.m1.1c">-\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.18.m1.1d">- caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is the evidence lower bound (ELBO) of <math alttext="\log p(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="A1.3.p1.19.m2.3"><semantics id="A1.3.p1.19.m2.3a"><mrow id="A1.3.p1.19.m2.3.3" xref="A1.3.p1.19.m2.3.3.cmml"><mrow id="A1.3.p1.19.m2.3.3.3" xref="A1.3.p1.19.m2.3.3.3.cmml"><mi id="A1.3.p1.19.m2.3.3.3.1" xref="A1.3.p1.19.m2.3.3.3.1.cmml">log</mi><mo id="A1.3.p1.19.m2.3.3.3a" lspace="0.167em" xref="A1.3.p1.19.m2.3.3.3.cmml">⁡</mo><mi id="A1.3.p1.19.m2.3.3.3.2" xref="A1.3.p1.19.m2.3.3.3.2.cmml">p</mi></mrow><mo id="A1.3.p1.19.m2.3.3.2" xref="A1.3.p1.19.m2.3.3.2.cmml">⁢</mo><mrow id="A1.3.p1.19.m2.3.3.1.1" xref="A1.3.p1.19.m2.3.3.1.1.1.cmml"><mo id="A1.3.p1.19.m2.3.3.1.1.2" stretchy="false" xref="A1.3.p1.19.m2.3.3.1.1.1.cmml">(</mo><mrow id="A1.3.p1.19.m2.3.3.1.1.1" xref="A1.3.p1.19.m2.3.3.1.1.1.cmml"><mi id="A1.3.p1.19.m2.3.3.1.1.1.2" xref="A1.3.p1.19.m2.3.3.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.3.p1.19.m2.3.3.1.1.1.1" xref="A1.3.p1.19.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="A1.3.p1.19.m2.3.3.1.1.1.3.2" xref="A1.3.p1.19.m2.3.3.1.1.1.3.1.cmml"><mi id="A1.3.p1.19.m2.1.1" xref="A1.3.p1.19.m2.1.1.cmml">𝐲</mi><mo id="A1.3.p1.19.m2.3.3.1.1.1.3.2.1" xref="A1.3.p1.19.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="A1.3.p1.19.m2.2.2" xref="A1.3.p1.19.m2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.3.p1.19.m2.3.3.1.1.3" stretchy="false" xref="A1.3.p1.19.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.19.m2.3b"><apply id="A1.3.p1.19.m2.3.3.cmml" xref="A1.3.p1.19.m2.3.3"><times id="A1.3.p1.19.m2.3.3.2.cmml" xref="A1.3.p1.19.m2.3.3.2"></times><apply id="A1.3.p1.19.m2.3.3.3.cmml" xref="A1.3.p1.19.m2.3.3.3"><log id="A1.3.p1.19.m2.3.3.3.1.cmml" xref="A1.3.p1.19.m2.3.3.3.1"></log><ci id="A1.3.p1.19.m2.3.3.3.2.cmml" xref="A1.3.p1.19.m2.3.3.3.2">𝑝</ci></apply><apply id="A1.3.p1.19.m2.3.3.1.1.1.cmml" xref="A1.3.p1.19.m2.3.3.1.1"><csymbol cd="latexml" id="A1.3.p1.19.m2.3.3.1.1.1.1.cmml" xref="A1.3.p1.19.m2.3.3.1.1.1.1">conditional</csymbol><ci id="A1.3.p1.19.m2.3.3.1.1.1.2.cmml" xref="A1.3.p1.19.m2.3.3.1.1.1.2">𝐱</ci><list id="A1.3.p1.19.m2.3.3.1.1.1.3.1.cmml" xref="A1.3.p1.19.m2.3.3.1.1.1.3.2"><ci id="A1.3.p1.19.m2.1.1.cmml" xref="A1.3.p1.19.m2.1.1">𝐲</ci><ci id="A1.3.p1.19.m2.2.2.cmml" xref="A1.3.p1.19.m2.2.2">𝐬</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.19.m2.3c">\log p(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.19.m2.3d">roman_log italic_p ( bold_x | bold_y , bold_s )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Luo</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>)</cite>, i.e.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{1}\geq-\log p(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="block" id="A1.E14.m1.3"><semantics id="A1.E14.m1.3a"><mrow id="A1.E14.m1.3.3" xref="A1.E14.m1.3.3.cmml"><msub id="A1.E14.m1.3.3.3" xref="A1.E14.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.3.3.3.2" xref="A1.E14.m1.3.3.3.2.cmml">ℒ</mi><mn id="A1.E14.m1.3.3.3.3" xref="A1.E14.m1.3.3.3.3.cmml">1</mn></msub><mo id="A1.E14.m1.3.3.2" xref="A1.E14.m1.3.3.2.cmml">≥</mo><mrow id="A1.E14.m1.3.3.1" xref="A1.E14.m1.3.3.1.cmml"><mo id="A1.E14.m1.3.3.1a" rspace="0.167em" xref="A1.E14.m1.3.3.1.cmml">−</mo><mrow id="A1.E14.m1.3.3.1.1" xref="A1.E14.m1.3.3.1.1.cmml"><mrow id="A1.E14.m1.3.3.1.1.3" xref="A1.E14.m1.3.3.1.1.3.cmml"><mi id="A1.E14.m1.3.3.1.1.3.1" xref="A1.E14.m1.3.3.1.1.3.1.cmml">log</mi><mo id="A1.E14.m1.3.3.1.1.3a" lspace="0.167em" xref="A1.E14.m1.3.3.1.1.3.cmml">⁡</mo><mi id="A1.E14.m1.3.3.1.1.3.2" xref="A1.E14.m1.3.3.1.1.3.2.cmml">p</mi></mrow><mo id="A1.E14.m1.3.3.1.1.2" xref="A1.E14.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.3.3.1.1.1.1" xref="A1.E14.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.E14.m1.3.3.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E14.m1.3.3.1.1.1.1.1" xref="A1.E14.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.E14.m1.3.3.1.1.1.1.1.2" xref="A1.E14.m1.3.3.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E14.m1.3.3.1.1.1.1.1.1" xref="A1.E14.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E14.m1.3.3.1.1.1.1.1.3.2" xref="A1.E14.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="A1.E14.m1.1.1" xref="A1.E14.m1.1.1.cmml">𝐲</mi><mo id="A1.E14.m1.3.3.1.1.1.1.1.3.2.1" xref="A1.E14.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E14.m1.3.3.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.3b"><apply id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3"><geq id="A1.E14.m1.3.3.2.cmml" xref="A1.E14.m1.3.3.2"></geq><apply id="A1.E14.m1.3.3.3.cmml" xref="A1.E14.m1.3.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.3.3.3.1.cmml" xref="A1.E14.m1.3.3.3">subscript</csymbol><ci id="A1.E14.m1.3.3.3.2.cmml" xref="A1.E14.m1.3.3.3.2">ℒ</ci><cn id="A1.E14.m1.3.3.3.3.cmml" type="integer" xref="A1.E14.m1.3.3.3.3">1</cn></apply><apply id="A1.E14.m1.3.3.1.cmml" xref="A1.E14.m1.3.3.1"><minus id="A1.E14.m1.3.3.1.2.cmml" xref="A1.E14.m1.3.3.1"></minus><apply id="A1.E14.m1.3.3.1.1.cmml" xref="A1.E14.m1.3.3.1.1"><times id="A1.E14.m1.3.3.1.1.2.cmml" xref="A1.E14.m1.3.3.1.1.2"></times><apply id="A1.E14.m1.3.3.1.1.3.cmml" xref="A1.E14.m1.3.3.1.1.3"><log id="A1.E14.m1.3.3.1.1.3.1.cmml" xref="A1.E14.m1.3.3.1.1.3.1"></log><ci id="A1.E14.m1.3.3.1.1.3.2.cmml" xref="A1.E14.m1.3.3.1.1.3.2">𝑝</ci></apply><apply id="A1.E14.m1.3.3.1.1.1.1.1.cmml" xref="A1.E14.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E14.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E14.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E14.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E14.m1.3.3.1.1.1.1.1.2">𝐱</ci><list id="A1.E14.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.3.3.1.1.1.1.1.3.2"><ci id="A1.E14.m1.1.1.cmml" xref="A1.E14.m1.1.1">𝐲</ci><ci id="A1.E14.m1.2.2.cmml" xref="A1.E14.m1.2.2">𝐬</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.3c">\mathcal{L}_{1}\geq-\log p(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.3d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≥ - roman_log italic_p ( bold_x | bold_y , bold_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.20">As for <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="A1.3.p1.20.m1.1"><semantics id="A1.3.p1.20.m1.1a"><msub id="A1.3.p1.20.m1.1.1" xref="A1.3.p1.20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.20.m1.1.1.2" xref="A1.3.p1.20.m1.1.1.2.cmml">ℒ</mi><mn id="A1.3.p1.20.m1.1.1.3" xref="A1.3.p1.20.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.3.p1.20.m1.1b"><apply id="A1.3.p1.20.m1.1.1.cmml" xref="A1.3.p1.20.m1.1.1"><csymbol cd="ambiguous" id="A1.3.p1.20.m1.1.1.1.cmml" xref="A1.3.p1.20.m1.1.1">subscript</csymbol><ci id="A1.3.p1.20.m1.1.1.2.cmml" xref="A1.3.p1.20.m1.1.1.2">ℒ</ci><cn id="A1.3.p1.20.m1.1.1.3.cmml" type="integer" xref="A1.3.p1.20.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.20.m1.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.20.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{2}&amp;=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\left[\lambda%
_{t}\left(\log J_{\kappa_{\mathbf{x}}}^{2}+\underbrace{\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}+\kappa_{\mathbf{x}}\mathbf{s}^{T}F_{a}(\mathbf{x})\right)%
\right]+\log Z\\
&amp;=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\left(\log J_{\kappa_{\mathbf{%
x}}}^{2}+\underbrace{\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{%
\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term}}+\kappa_{\mathbf{x}}%
\mathbf{s}^{T}F_{a}(\mathbf{x})\right)\right]}+\log Z\end{split}" class="ltx_Math" display="block" id="A1.E15.m1.68"><semantics id="A1.E15.m1.68a"><mtable columnspacing="0pt" displaystyle="true" id="A1.E15.m1.68.68.4" rowspacing="0pt" xref="A1.E15.m1.66.66.2.cmml"><mtr id="A1.E15.m1.68.68.4a" xref="A1.E15.m1.66.66.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E15.m1.68.68.4b" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.2.2.2.2.2" xref="A1.E15.m1.66.66.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E15.m1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.cmml">ℒ</mi><mn id="A1.E15.m1.2.2.2.2.2.2.1" xref="A1.E15.m1.2.2.2.2.2.2.1.cmml">2</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E15.m1.68.68.4c" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.67.67.3.65.33.31" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.67.67.3.65.33.31.32" xref="A1.E15.m1.66.66.2a.cmml"></mi><mo id="A1.E15.m1.3.3.3.3.1.1" xref="A1.E15.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.67.67.3.65.33.31.31.1a" xref="A1.E15.m1.66.66.2a.cmml">−</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.67.67.3.65.33.31.31.1.1.3" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.5.5.5.5.3.3" xref="A1.E15.m1.5.5.5.5.3.3.cmml">𝔼</mi><mrow id="A1.E15.m1.6.6.6.6.4.4.1" xref="A1.E15.m1.6.6.6.6.4.4.1.cmml"><mi id="A1.E15.m1.6.6.6.6.4.4.1.4" xref="A1.E15.m1.6.6.6.6.4.4.1.4.cmml">t</mi><mo id="A1.E15.m1.6.6.6.6.4.4.1.3" xref="A1.E15.m1.6.6.6.6.4.4.1.3.cmml">∼</mo><mrow id="A1.E15.m1.6.6.6.6.4.4.1.5" xref="A1.E15.m1.6.6.6.6.4.4.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E15.m1.6.6.6.6.4.4.1.5.2" xref="A1.E15.m1.6.6.6.6.4.4.1.5.2.cmml">𝒰</mi><mo id="A1.E15.m1.6.6.6.6.4.4.1.5.1" xref="A1.E15.m1.6.6.6.6.4.4.1.5.1.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.6.6.4.4.1.5.3.2" xref="A1.E15.m1.6.6.6.6.4.4.1.5.3.1.cmml"><mo id="A1.E15.m1.6.6.6.6.4.4.1.5.3.2.1" stretchy="false" xref="A1.E15.m1.6.6.6.6.4.4.1.5.3.1.cmml">[</mo><mn id="A1.E15.m1.6.6.6.6.4.4.1.1" xref="A1.E15.m1.6.6.6.6.4.4.1.1.cmml">2</mn><mo id="A1.E15.m1.6.6.6.6.4.4.1.5.3.2.2" xref="A1.E15.m1.6.6.6.6.4.4.1.5.3.1.cmml">,</mo><mi id="A1.E15.m1.6.6.6.6.4.4.1.2" xref="A1.E15.m1.6.6.6.6.4.4.1.2.cmml">T</mi><mo id="A1.E15.m1.6.6.6.6.4.4.1.5.3.2.3" stretchy="false" xref="A1.E15.m1.6.6.6.6.4.4.1.5.3.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.2" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.7.7.7.7.5.5" xref="A1.E15.m1.66.66.2a.cmml">[</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.3" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.8.8.8.8.6.6" xref="A1.E15.m1.8.8.8.8.6.6.cmml">λ</mi><mi id="A1.E15.m1.9.9.9.9.7.7.1" xref="A1.E15.m1.9.9.9.9.7.7.1.cmml">t</mi></msub><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.2" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.10.10.10.10.8.8" xref="A1.E15.m1.66.66.2a.cmml">(</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.11.11.11.11.9.9" xref="A1.E15.m1.11.11.11.11.9.9.cmml">log</mi><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.1a" lspace="0.167em" xref="A1.E15.m1.66.66.2a.cmml">⁡</mo><msubsup id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.12.12.12.12.10.10" xref="A1.E15.m1.12.12.12.12.10.10.cmml">J</mi><msub id="A1.E15.m1.13.13.13.13.11.11.1" xref="A1.E15.m1.13.13.13.13.11.11.1.cmml"><mi id="A1.E15.m1.13.13.13.13.11.11.1.2" xref="A1.E15.m1.13.13.13.13.11.11.1.2.cmml">κ</mi><mi id="A1.E15.m1.13.13.13.13.11.11.1.3" xref="A1.E15.m1.13.13.13.13.11.11.1.3.cmml">𝐱</mi></msub><mn id="A1.E15.m1.14.14.14.14.12.12.1" xref="A1.E15.m1.14.14.14.14.12.12.1.cmml">2</mn></msubsup></mrow><mo id="A1.E15.m1.15.15.15.15.13.13" xref="A1.E15.m1.15.15.15.15.13.13.cmml">+</mo><munder id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.66.66.2.cmml"><munder accentunder="true" id="A1.E15.m1.16.16.16.16.14.14" xref="A1.E15.m1.16.16.16.16.14.14.cmml"><mrow id="A1.E15.m1.16.16.16.16.14.14.2" xref="A1.E15.m1.16.16.16.16.14.14.2.cmml"><msub id="A1.E15.m1.16.16.16.16.14.14.2.4" xref="A1.E15.m1.16.16.16.16.14.14.2.4.cmml"><mi id="A1.E15.m1.16.16.16.16.14.14.2.4.2" xref="A1.E15.m1.16.16.16.16.14.14.2.4.2.cmml">κ</mi><mi id="A1.E15.m1.16.16.16.16.14.14.2.4.3" xref="A1.E15.m1.16.16.16.16.14.14.2.4.3.cmml">𝐱</mi></msub><mo id="A1.E15.m1.16.16.16.16.14.14.2.3" xref="A1.E15.m1.16.16.16.16.14.14.2.3.cmml">⁢</mo><msup id="A1.E15.m1.16.16.16.16.14.14.2.5" xref="A1.E15.m1.16.16.16.16.14.14.2.5.cmml"><mi id="A1.E15.m1.16.16.16.16.14.14.2.5.2" xref="A1.E15.m1.16.16.16.16.14.14.2.5.2.cmml">𝐲</mi><mi id="A1.E15.m1.16.16.16.16.14.14.2.5.3" xref="A1.E15.m1.16.16.16.16.14.14.2.5.3.cmml">T</mi></msup><mo id="A1.E15.m1.16.16.16.16.14.14.2.3a" xref="A1.E15.m1.16.16.16.16.14.14.2.3.cmml">⁢</mo><msub id="A1.E15.m1.16.16.16.16.14.14.2.6" xref="A1.E15.m1.16.16.16.16.14.14.2.6.cmml"><mi id="A1.E15.m1.16.16.16.16.14.14.2.6.2" xref="A1.E15.m1.16.16.16.16.14.14.2.6.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E15.m1.16.16.16.16.14.14.2.6.3" mathvariant="bold-italic" xref="A1.E15.m1.16.16.16.16.14.14.2.6.3.cmml">ϕ</mi></msub><mo id="A1.E15.m1.16.16.16.16.14.14.2.3b" xref="A1.E15.m1.16.16.16.16.14.14.2.3.cmml">⁢</mo><mrow id="A1.E15.m1.16.16.16.16.14.14.2.2.1" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml"><mo id="A1.E15.m1.16.16.16.16.14.14.2.2.1.2" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml">(</mo><msubsup id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml"><mover accent="true" id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.cmml"><mi id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.2" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.1" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.3" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.3.cmml">0</mn><mrow id="A1.E15.m1.16.16.16.16.14.14.1.1.1.3" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml"><mo id="A1.E15.m1.16.16.16.16.14.14.1.1.1.3.1" stretchy="false" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml">(</mo><mi id="A1.E15.m1.16.16.16.16.14.14.1.1.1.1" xref="A1.E15.m1.16.16.16.16.14.14.1.1.1.1.cmml">t</mi><mo id="A1.E15.m1.16.16.16.16.14.14.1.1.1.3.2" stretchy="false" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E15.m1.16.16.16.16.14.14.2.2.1.3" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.16.16.16.16.14.14.3" xref="A1.E15.m1.16.16.16.16.14.14.3.cmml">⏟</mo></munder><mtext id="A1.E15.m1.17.17.17.17.15.15.1" xref="A1.E15.m1.17.17.17.17.15.15.1a.cmml">inner-product term</mtext></munder><mo id="A1.E15.m1.15.15.15.15.13.13a" xref="A1.E15.m1.15.15.15.15.13.13.cmml">+</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.2" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.19.19.19.19.17.17" xref="A1.E15.m1.19.19.19.19.17.17.cmml">κ</mi><mi id="A1.E15.m1.20.20.20.20.18.18.1" xref="A1.E15.m1.20.20.20.20.18.18.1.cmml">𝐱</mi></msub><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.1" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><msup id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.3" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.21.21.21.21.19.19" xref="A1.E15.m1.21.21.21.21.19.19.cmml">𝐬</mi><mi id="A1.E15.m1.22.22.22.22.20.20.1" xref="A1.E15.m1.22.22.22.22.20.20.1.cmml">T</mi></msup><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.1a" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><msub id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.4" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.23.23.23.23.21.21" xref="A1.E15.m1.23.23.23.23.21.21.cmml">F</mi><mi id="A1.E15.m1.24.24.24.24.22.22.1" xref="A1.E15.m1.24.24.24.24.22.22.1.cmml">a</mi></msub><mo id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.1b" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.1.1.1.1.1.1.1.1.3.5" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.25.25.25.25.23.23" stretchy="false" xref="A1.E15.m1.66.66.2a.cmml">(</mo><mi id="A1.E15.m1.26.26.26.26.24.24" xref="A1.E15.m1.26.26.26.26.24.24.cmml">𝐱</mi><mo id="A1.E15.m1.27.27.27.27.25.25" stretchy="false" xref="A1.E15.m1.66.66.2a.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E15.m1.28.28.28.28.26.26" xref="A1.E15.m1.66.66.2a.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.29.29.29.29.27.27" xref="A1.E15.m1.66.66.2a.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E15.m1.30.30.30.30.28.28" xref="A1.E15.m1.30.30.30.30.28.28.cmml">+</mo><mrow id="A1.E15.m1.67.67.3.65.33.31.31.2" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.31.31.31.31.29.29" xref="A1.E15.m1.31.31.31.31.29.29.cmml">log</mi><mo id="A1.E15.m1.67.67.3.65.33.31.31.2a" lspace="0.167em" xref="A1.E15.m1.66.66.2a.cmml">⁡</mo><mi id="A1.E15.m1.32.32.32.32.30.30" xref="A1.E15.m1.32.32.32.32.30.30.cmml">Z</mi></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E15.m1.68.68.4d" xref="A1.E15.m1.66.66.2.cmml"><mtd id="A1.E15.m1.68.68.4e" xref="A1.E15.m1.66.66.2a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E15.m1.68.68.4f" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.68.68.4.66.33.33" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.68.68.4.66.33.33.34" xref="A1.E15.m1.66.66.2a.cmml"></mi><mo id="A1.E15.m1.33.33.33.1.1.1" xref="A1.E15.m1.33.33.33.1.1.1.cmml">=</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.68.68.4.66.33.33.33.1a" xref="A1.E15.m1.66.66.2a.cmml">−</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1" xref="A1.E15.m1.66.66.2.cmml"><mfrac id="A1.E15.m1.35.35.35.3.3.3" xref="A1.E15.m1.35.35.35.3.3.3.cmml"><mn id="A1.E15.m1.35.35.35.3.3.3.2" xref="A1.E15.m1.35.35.35.3.3.3.2.cmml">1</mn><mrow id="A1.E15.m1.35.35.35.3.3.3.3" xref="A1.E15.m1.35.35.35.3.3.3.3.cmml"><mi id="A1.E15.m1.35.35.35.3.3.3.3.2" xref="A1.E15.m1.35.35.35.3.3.3.3.2.cmml">T</mi><mo id="A1.E15.m1.35.35.35.3.3.3.3.1" xref="A1.E15.m1.35.35.35.3.3.3.3.1.cmml">−</mo><mn id="A1.E15.m1.35.35.35.3.3.3.3.3" xref="A1.E15.m1.35.35.35.3.3.3.3.3.cmml">1</mn></mrow></mfrac><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.2" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><munderover id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.2" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.36.36.36.4.4.4" movablelimits="false" rspace="0em" xref="A1.E15.m1.36.36.36.4.4.4.cmml">∑</mo><mrow id="A1.E15.m1.37.37.37.5.5.5.1" xref="A1.E15.m1.37.37.37.5.5.5.1.cmml"><mi id="A1.E15.m1.37.37.37.5.5.5.1.2" xref="A1.E15.m1.37.37.37.5.5.5.1.2.cmml">t</mi><mo id="A1.E15.m1.37.37.37.5.5.5.1.1" xref="A1.E15.m1.37.37.37.5.5.5.1.1.cmml">=</mo><mn id="A1.E15.m1.37.37.37.5.5.5.1.3" xref="A1.E15.m1.37.37.37.5.5.5.1.3.cmml">2</mn></mrow><mi id="A1.E15.m1.38.38.38.6.6.6.1" xref="A1.E15.m1.38.38.38.6.6.6.1.cmml">T</mi></munderover><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.39.39.39.7.7.7" xref="A1.E15.m1.66.66.2a.cmml">[</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.3" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.40.40.40.8.8.8" xref="A1.E15.m1.40.40.40.8.8.8.cmml">λ</mi><mi id="A1.E15.m1.41.41.41.9.9.9.1" xref="A1.E15.m1.41.41.41.9.9.9.1.cmml">t</mi></msub><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.2" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.42.42.42.10.10.10" xref="A1.E15.m1.66.66.2a.cmml">(</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.43.43.43.11.11.11" xref="A1.E15.m1.43.43.43.11.11.11.cmml">log</mi><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.1a" lspace="0.167em" xref="A1.E15.m1.66.66.2a.cmml">⁡</mo><msubsup id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.44.44.44.12.12.12" xref="A1.E15.m1.44.44.44.12.12.12.cmml">J</mi><msub id="A1.E15.m1.45.45.45.13.13.13.1" xref="A1.E15.m1.45.45.45.13.13.13.1.cmml"><mi id="A1.E15.m1.45.45.45.13.13.13.1.2" xref="A1.E15.m1.45.45.45.13.13.13.1.2.cmml">κ</mi><mi id="A1.E15.m1.45.45.45.13.13.13.1.3" xref="A1.E15.m1.45.45.45.13.13.13.1.3.cmml">𝐱</mi></msub><mn id="A1.E15.m1.46.46.46.14.14.14.1" xref="A1.E15.m1.46.46.46.14.14.14.1.cmml">2</mn></msubsup></mrow><mo id="A1.E15.m1.47.47.47.15.15.15" xref="A1.E15.m1.47.47.47.15.15.15.cmml">+</mo><munder id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.66.66.2.cmml"><munder accentunder="true" id="A1.E15.m1.48.48.48.16.16.16" xref="A1.E15.m1.48.48.48.16.16.16.cmml"><mrow id="A1.E15.m1.48.48.48.16.16.16.2" xref="A1.E15.m1.48.48.48.16.16.16.2.cmml"><msub id="A1.E15.m1.48.48.48.16.16.16.2.4" xref="A1.E15.m1.48.48.48.16.16.16.2.4.cmml"><mi id="A1.E15.m1.48.48.48.16.16.16.2.4.2" xref="A1.E15.m1.48.48.48.16.16.16.2.4.2.cmml">κ</mi><mi id="A1.E15.m1.48.48.48.16.16.16.2.4.3" xref="A1.E15.m1.48.48.48.16.16.16.2.4.3.cmml">𝐱</mi></msub><mo id="A1.E15.m1.48.48.48.16.16.16.2.3" xref="A1.E15.m1.48.48.48.16.16.16.2.3.cmml">⁢</mo><msup id="A1.E15.m1.48.48.48.16.16.16.2.5" xref="A1.E15.m1.48.48.48.16.16.16.2.5.cmml"><mi id="A1.E15.m1.48.48.48.16.16.16.2.5.2" xref="A1.E15.m1.48.48.48.16.16.16.2.5.2.cmml">𝐲</mi><mi id="A1.E15.m1.48.48.48.16.16.16.2.5.3" xref="A1.E15.m1.48.48.48.16.16.16.2.5.3.cmml">T</mi></msup><mo id="A1.E15.m1.48.48.48.16.16.16.2.3a" xref="A1.E15.m1.48.48.48.16.16.16.2.3.cmml">⁢</mo><msub id="A1.E15.m1.48.48.48.16.16.16.2.6" xref="A1.E15.m1.48.48.48.16.16.16.2.6.cmml"><mi id="A1.E15.m1.48.48.48.16.16.16.2.6.2" xref="A1.E15.m1.48.48.48.16.16.16.2.6.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E15.m1.48.48.48.16.16.16.2.6.3" mathvariant="bold-italic" xref="A1.E15.m1.48.48.48.16.16.16.2.6.3.cmml">ϕ</mi></msub><mo id="A1.E15.m1.48.48.48.16.16.16.2.3b" xref="A1.E15.m1.48.48.48.16.16.16.2.3.cmml">⁢</mo><mrow id="A1.E15.m1.48.48.48.16.16.16.2.2.1" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml"><mo id="A1.E15.m1.48.48.48.16.16.16.2.2.1.2" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml">(</mo><msubsup id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml"><mover accent="true" id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.cmml"><mi id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.2" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.2.cmml">𝐱</mi><mo id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.1" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.1.cmml">^</mo></mover><mn id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.3" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.3.cmml">0</mn><mrow id="A1.E15.m1.48.48.48.16.16.16.1.1.1.3" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml"><mo id="A1.E15.m1.48.48.48.16.16.16.1.1.1.3.1" stretchy="false" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml">(</mo><mi id="A1.E15.m1.48.48.48.16.16.16.1.1.1.1" xref="A1.E15.m1.48.48.48.16.16.16.1.1.1.1.cmml">t</mi><mo id="A1.E15.m1.48.48.48.16.16.16.1.1.1.3.2" stretchy="false" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E15.m1.48.48.48.16.16.16.2.2.1.3" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.48.48.48.16.16.16.3" xref="A1.E15.m1.48.48.48.16.16.16.3.cmml">⏟</mo></munder><mtext id="A1.E15.m1.49.49.49.17.17.17.1" xref="A1.E15.m1.49.49.49.17.17.17.1a.cmml">inner-product term</mtext></munder><mo id="A1.E15.m1.47.47.47.15.15.15a" xref="A1.E15.m1.47.47.47.15.15.15.cmml">+</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3" xref="A1.E15.m1.66.66.2.cmml"><msub id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.51.51.51.19.19.19" xref="A1.E15.m1.51.51.51.19.19.19.cmml">κ</mi><mi id="A1.E15.m1.52.52.52.20.20.20.1" xref="A1.E15.m1.52.52.52.20.20.20.1.cmml">𝐱</mi></msub><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><msup id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.53.53.53.21.21.21" xref="A1.E15.m1.53.53.53.21.21.21.cmml">𝐬</mi><mi id="A1.E15.m1.54.54.54.22.22.22.1" xref="A1.E15.m1.54.54.54.22.22.22.1.cmml">T</mi></msup><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.1a" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><msub id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.4" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.55.55.55.23.23.23" xref="A1.E15.m1.55.55.55.23.23.23.cmml">F</mi><mi id="A1.E15.m1.56.56.56.24.24.24.1" xref="A1.E15.m1.56.56.56.24.24.24.1.cmml">a</mi></msub><mo id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.1b" xref="A1.E15.m1.66.66.2a.cmml">⁢</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.1.1.1.1.1.1.1.1.1.3.5" xref="A1.E15.m1.66.66.2.cmml"><mo id="A1.E15.m1.57.57.57.25.25.25" stretchy="false" xref="A1.E15.m1.66.66.2a.cmml">(</mo><mi id="A1.E15.m1.58.58.58.26.26.26" xref="A1.E15.m1.58.58.58.26.26.26.cmml">𝐱</mi><mo id="A1.E15.m1.59.59.59.27.27.27" stretchy="false" xref="A1.E15.m1.66.66.2a.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E15.m1.60.60.60.28.28.28" xref="A1.E15.m1.66.66.2a.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.61.61.61.29.29.29" xref="A1.E15.m1.66.66.2a.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A1.E15.m1.62.62.62.30.30.30" xref="A1.E15.m1.62.62.62.30.30.30.cmml">+</mo><mrow id="A1.E15.m1.68.68.4.66.33.33.33.2" xref="A1.E15.m1.66.66.2.cmml"><mi id="A1.E15.m1.63.63.63.31.31.31" xref="A1.E15.m1.63.63.63.31.31.31.cmml">log</mi><mo id="A1.E15.m1.68.68.4.66.33.33.33.2a" lspace="0.167em" xref="A1.E15.m1.66.66.2a.cmml">⁡</mo><mi id="A1.E15.m1.64.64.64.32.32.32" xref="A1.E15.m1.64.64.64.32.32.32.cmml">Z</mi></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E15.m1.68b"><apply id="A1.E15.m1.66.66.2.cmml" xref="A1.E15.m1.68.68.4"><and id="A1.E15.m1.66.66.2a.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32"></and><apply id="A1.E15.m1.66.66.2b.cmml" xref="A1.E15.m1.68.68.4"><eq id="A1.E15.m1.3.3.3.3.1.1.cmml" xref="A1.E15.m1.3.3.3.3.1.1"></eq><apply id="A1.E15.m1.66.66.2.4.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.4.1.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32">subscript</csymbol><ci id="A1.E15.m1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">ℒ</ci><cn id="A1.E15.m1.2.2.2.2.2.2.1.cmml" type="integer" xref="A1.E15.m1.2.2.2.2.2.2.1">2</cn></apply><apply id="A1.E15.m1.65.65.1.1.cmml" xref="A1.E15.m1.68.68.4"><plus id="A1.E15.m1.30.30.30.30.28.28.cmml" xref="A1.E15.m1.30.30.30.30.28.28"></plus><apply id="A1.E15.m1.65.65.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><minus id="A1.E15.m1.4.4.4.4.2.2.cmml" xref="A1.E15.m1.68.68.4"></minus><apply id="A1.E15.m1.65.65.1.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.65.65.1.1.1.1.2.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32"></times><apply id="A1.E15.m1.65.65.1.1.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.3.1.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32">subscript</csymbol><ci id="A1.E15.m1.5.5.5.5.3.3.cmml" xref="A1.E15.m1.5.5.5.5.3.3">𝔼</ci><apply id="A1.E15.m1.6.6.6.6.4.4.1.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1"><csymbol cd="latexml" id="A1.E15.m1.6.6.6.6.4.4.1.3.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.3">similar-to</csymbol><ci id="A1.E15.m1.6.6.6.6.4.4.1.4.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.4">𝑡</ci><apply id="A1.E15.m1.6.6.6.6.4.4.1.5.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.5"><times id="A1.E15.m1.6.6.6.6.4.4.1.5.1.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.5.1"></times><ci id="A1.E15.m1.6.6.6.6.4.4.1.5.2.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.5.2">𝒰</ci><interval closure="closed" id="A1.E15.m1.6.6.6.6.4.4.1.5.3.1.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.5.3.2"><cn id="A1.E15.m1.6.6.6.6.4.4.1.1.cmml" type="integer" xref="A1.E15.m1.6.6.6.6.4.4.1.1">2</cn><ci id="A1.E15.m1.6.6.6.6.4.4.1.2.cmml" xref="A1.E15.m1.6.6.6.6.4.4.1.2">𝑇</ci></interval></apply></apply></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="latexml" id="A1.E15.m1.65.65.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.68.68.4">delimited-[]</csymbol><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.65.65.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"></times><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.8.8.8.8.6.6.cmml" xref="A1.E15.m1.8.8.8.8.6.6">𝜆</ci><ci id="A1.E15.m1.9.9.9.9.7.7.1.cmml" xref="A1.E15.m1.9.9.9.9.7.7.1">𝑡</ci></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><plus id="A1.E15.m1.15.15.15.15.13.13.cmml" xref="A1.E15.m1.15.15.15.15.13.13"></plus><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"><log id="A1.E15.m1.11.11.11.11.9.9.cmml" xref="A1.E15.m1.11.11.11.11.9.9"></log><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E15.m1.68.68.4">superscript</csymbol><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.12.12.12.12.10.10.cmml" xref="A1.E15.m1.12.12.12.12.10.10">𝐽</ci><apply id="A1.E15.m1.13.13.13.13.11.11.1.cmml" xref="A1.E15.m1.13.13.13.13.11.11.1"><csymbol cd="ambiguous" id="A1.E15.m1.13.13.13.13.11.11.1.1.cmml" xref="A1.E15.m1.13.13.13.13.11.11.1">subscript</csymbol><ci id="A1.E15.m1.13.13.13.13.11.11.1.2.cmml" xref="A1.E15.m1.13.13.13.13.11.11.1.2">𝜅</ci><ci id="A1.E15.m1.13.13.13.13.11.11.1.3.cmml" xref="A1.E15.m1.13.13.13.13.11.11.1.3">𝐱</ci></apply></apply><cn id="A1.E15.m1.14.14.14.14.12.12.1.cmml" type="integer" xref="A1.E15.m1.14.14.14.14.12.12.1">2</cn></apply></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><apply id="A1.E15.m1.16.16.16.16.14.14.cmml" xref="A1.E15.m1.16.16.16.16.14.14"><ci id="A1.E15.m1.16.16.16.16.14.14.3.cmml" xref="A1.E15.m1.16.16.16.16.14.14.3">⏟</ci><apply id="A1.E15.m1.16.16.16.16.14.14.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2"><times id="A1.E15.m1.16.16.16.16.14.14.2.3.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.3"></times><apply id="A1.E15.m1.16.16.16.16.14.14.2.4.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.4"><csymbol cd="ambiguous" id="A1.E15.m1.16.16.16.16.14.14.2.4.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.4">subscript</csymbol><ci id="A1.E15.m1.16.16.16.16.14.14.2.4.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.4.2">𝜅</ci><ci id="A1.E15.m1.16.16.16.16.14.14.2.4.3.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.4.3">𝐱</ci></apply><apply id="A1.E15.m1.16.16.16.16.14.14.2.5.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.5"><csymbol cd="ambiguous" id="A1.E15.m1.16.16.16.16.14.14.2.5.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.5">superscript</csymbol><ci id="A1.E15.m1.16.16.16.16.14.14.2.5.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.5.2">𝐲</ci><ci id="A1.E15.m1.16.16.16.16.14.14.2.5.3.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.5.3">𝑇</ci></apply><apply id="A1.E15.m1.16.16.16.16.14.14.2.6.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.6"><csymbol cd="ambiguous" id="A1.E15.m1.16.16.16.16.14.14.2.6.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.6">subscript</csymbol><ci id="A1.E15.m1.16.16.16.16.14.14.2.6.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.6.2">𝑓</ci><ci id="A1.E15.m1.16.16.16.16.14.14.2.6.3.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.6.3">bold-italic-ϕ</ci></apply><apply id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1"><csymbol cd="ambiguous" id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1">superscript</csymbol><apply id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1"><csymbol cd="ambiguous" id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1">subscript</csymbol><apply id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2"><ci id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.1">^</ci><ci id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.2.cmml" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.3.cmml" type="integer" xref="A1.E15.m1.16.16.16.16.14.14.2.2.1.1.2.3">0</cn></apply><ci id="A1.E15.m1.16.16.16.16.14.14.1.1.1.1.cmml" xref="A1.E15.m1.16.16.16.16.14.14.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="A1.E15.m1.17.17.17.17.15.15.1a.cmml" xref="A1.E15.m1.17.17.17.17.15.15.1"><mtext id="A1.E15.m1.17.17.17.17.15.15.1.cmml" mathsize="70%" xref="A1.E15.m1.17.17.17.17.15.15.1">inner-product term</mtext></ci></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E15.m1.68.68.4"></times><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.19.19.19.19.17.17.cmml" xref="A1.E15.m1.19.19.19.19.17.17">𝜅</ci><ci id="A1.E15.m1.20.20.20.20.18.18.1.cmml" xref="A1.E15.m1.20.20.20.20.18.18.1">𝐱</ci></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E15.m1.68.68.4">superscript</csymbol><ci id="A1.E15.m1.21.21.21.21.19.19.cmml" xref="A1.E15.m1.21.21.21.21.19.19">𝐬</ci><ci id="A1.E15.m1.22.22.22.22.20.20.1.cmml" xref="A1.E15.m1.22.22.22.22.20.20.1">𝑇</ci></apply><apply id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.65.65.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.23.23.23.23.21.21.cmml" xref="A1.E15.m1.23.23.23.23.21.21">𝐹</ci><ci id="A1.E15.m1.24.24.24.24.22.22.1.cmml" xref="A1.E15.m1.24.24.24.24.22.22.1">𝑎</ci></apply><ci id="A1.E15.m1.26.26.26.26.24.24.cmml" xref="A1.E15.m1.26.26.26.26.24.24">𝐱</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E15.m1.65.65.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><log id="A1.E15.m1.31.31.31.31.29.29.cmml" xref="A1.E15.m1.31.31.31.31.29.29"></log><ci id="A1.E15.m1.32.32.32.32.30.30.cmml" xref="A1.E15.m1.32.32.32.32.30.30">𝑍</ci></apply></apply></apply><apply id="A1.E15.m1.66.66.2c.cmml" xref="A1.E15.m1.68.68.4"><eq id="A1.E15.m1.33.33.33.1.1.1.cmml" xref="A1.E15.m1.33.33.33.1.1.1"></eq><share href="https://arxiv.org/html/2409.17576v1#A1.E15.m1.65.65.1.1.cmml" id="A1.E15.m1.66.66.2d.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32"></share><apply id="A1.E15.m1.66.66.2.2.cmml" xref="A1.E15.m1.68.68.4"><plus id="A1.E15.m1.62.62.62.30.30.30.cmml" xref="A1.E15.m1.62.62.62.30.30.30"></plus><apply id="A1.E15.m1.66.66.2.2.1.cmml" xref="A1.E15.m1.68.68.4"><minus id="A1.E15.m1.34.34.34.2.2.2.cmml" xref="A1.E15.m1.68.68.4"></minus><apply id="A1.E15.m1.66.66.2.2.1.1.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.66.66.2.2.1.1.2.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32"></times><apply id="A1.E15.m1.35.35.35.3.3.3.cmml" xref="A1.E15.m1.35.35.35.3.3.3"><divide id="A1.E15.m1.35.35.35.3.3.3.1.cmml" xref="A1.E15.m1.35.35.35.3.3.3"></divide><cn id="A1.E15.m1.35.35.35.3.3.3.2.cmml" type="integer" xref="A1.E15.m1.35.35.35.3.3.3.2">1</cn><apply id="A1.E15.m1.35.35.35.3.3.3.3.cmml" xref="A1.E15.m1.35.35.35.3.3.3.3"><minus id="A1.E15.m1.35.35.35.3.3.3.3.1.cmml" xref="A1.E15.m1.35.35.35.3.3.3.3.1"></minus><ci id="A1.E15.m1.35.35.35.3.3.3.3.2.cmml" xref="A1.E15.m1.35.35.35.3.3.3.3.2">𝑇</ci><cn id="A1.E15.m1.35.35.35.3.3.3.3.3.cmml" type="integer" xref="A1.E15.m1.35.35.35.3.3.3.3.3">1</cn></apply></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><apply id="A1.E15.m1.66.66.2.2.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.2.1.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32">superscript</csymbol><apply id="A1.E15.m1.66.66.2.2.1.1.1.2.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.2.2.1.cmml" xref="A1.E15.m1.67.67.3.65.33.31.32">subscript</csymbol><sum id="A1.E15.m1.36.36.36.4.4.4.cmml" xref="A1.E15.m1.36.36.36.4.4.4"></sum><apply id="A1.E15.m1.37.37.37.5.5.5.1.cmml" xref="A1.E15.m1.37.37.37.5.5.5.1"><eq id="A1.E15.m1.37.37.37.5.5.5.1.1.cmml" xref="A1.E15.m1.37.37.37.5.5.5.1.1"></eq><ci id="A1.E15.m1.37.37.37.5.5.5.1.2.cmml" xref="A1.E15.m1.37.37.37.5.5.5.1.2">𝑡</ci><cn id="A1.E15.m1.37.37.37.5.5.5.1.3.cmml" type="integer" xref="A1.E15.m1.37.37.37.5.5.5.1.3">2</cn></apply></apply><ci id="A1.E15.m1.38.38.38.6.6.6.1.cmml" xref="A1.E15.m1.38.38.38.6.6.6.1">𝑇</ci></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="latexml" id="A1.E15.m1.66.66.2.2.1.1.1.1.2.1.cmml" xref="A1.E15.m1.68.68.4">delimited-[]</csymbol><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"></times><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.40.40.40.8.8.8.cmml" xref="A1.E15.m1.40.40.40.8.8.8">𝜆</ci><ci id="A1.E15.m1.41.41.41.9.9.9.1.cmml" xref="A1.E15.m1.41.41.41.9.9.9.1">𝑡</ci></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.68.68.4"><plus id="A1.E15.m1.47.47.47.15.15.15.cmml" xref="A1.E15.m1.47.47.47.15.15.15"></plus><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.68.68.4"><log id="A1.E15.m1.43.43.43.11.11.11.cmml" xref="A1.E15.m1.43.43.43.11.11.11"></log><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E15.m1.68.68.4">superscript</csymbol><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.44.44.44.12.12.12.cmml" xref="A1.E15.m1.44.44.44.12.12.12">𝐽</ci><apply id="A1.E15.m1.45.45.45.13.13.13.1.cmml" xref="A1.E15.m1.45.45.45.13.13.13.1"><csymbol cd="ambiguous" id="A1.E15.m1.45.45.45.13.13.13.1.1.cmml" xref="A1.E15.m1.45.45.45.13.13.13.1">subscript</csymbol><ci id="A1.E15.m1.45.45.45.13.13.13.1.2.cmml" xref="A1.E15.m1.45.45.45.13.13.13.1.2">𝜅</ci><ci id="A1.E15.m1.45.45.45.13.13.13.1.3.cmml" xref="A1.E15.m1.45.45.45.13.13.13.1.3">𝐱</ci></apply></apply><cn id="A1.E15.m1.46.46.46.14.14.14.1.cmml" type="integer" xref="A1.E15.m1.46.46.46.14.14.14.1">2</cn></apply></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><apply id="A1.E15.m1.48.48.48.16.16.16.cmml" xref="A1.E15.m1.48.48.48.16.16.16"><ci id="A1.E15.m1.48.48.48.16.16.16.3.cmml" xref="A1.E15.m1.48.48.48.16.16.16.3">⏟</ci><apply id="A1.E15.m1.48.48.48.16.16.16.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2"><times id="A1.E15.m1.48.48.48.16.16.16.2.3.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.3"></times><apply id="A1.E15.m1.48.48.48.16.16.16.2.4.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.4"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.48.16.16.16.2.4.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.4">subscript</csymbol><ci id="A1.E15.m1.48.48.48.16.16.16.2.4.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.4.2">𝜅</ci><ci id="A1.E15.m1.48.48.48.16.16.16.2.4.3.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.4.3">𝐱</ci></apply><apply id="A1.E15.m1.48.48.48.16.16.16.2.5.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.5"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.48.16.16.16.2.5.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.5">superscript</csymbol><ci id="A1.E15.m1.48.48.48.16.16.16.2.5.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.5.2">𝐲</ci><ci id="A1.E15.m1.48.48.48.16.16.16.2.5.3.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.5.3">𝑇</ci></apply><apply id="A1.E15.m1.48.48.48.16.16.16.2.6.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.6"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.48.16.16.16.2.6.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.6">subscript</csymbol><ci id="A1.E15.m1.48.48.48.16.16.16.2.6.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.6.2">𝑓</ci><ci id="A1.E15.m1.48.48.48.16.16.16.2.6.3.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.6.3">bold-italic-ϕ</ci></apply><apply id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1">superscript</csymbol><apply id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1"><csymbol cd="ambiguous" id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1">subscript</csymbol><apply id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2"><ci id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.1">^</ci><ci id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.2.cmml" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.2.2">𝐱</ci></apply><cn id="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.3.cmml" type="integer" xref="A1.E15.m1.48.48.48.16.16.16.2.2.1.1.2.3">0</cn></apply><ci id="A1.E15.m1.48.48.48.16.16.16.1.1.1.1.cmml" xref="A1.E15.m1.48.48.48.16.16.16.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="A1.E15.m1.49.49.49.17.17.17.1a.cmml" xref="A1.E15.m1.49.49.49.17.17.17.1"><mtext id="A1.E15.m1.49.49.49.17.17.17.1.cmml" mathsize="70%" xref="A1.E15.m1.49.49.49.17.17.17.1">inner-product term</mtext></ci></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E15.m1.68.68.4"><times id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E15.m1.68.68.4"></times><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.51.51.51.19.19.19.cmml" xref="A1.E15.m1.51.51.51.19.19.19">𝜅</ci><ci id="A1.E15.m1.52.52.52.20.20.20.1.cmml" xref="A1.E15.m1.52.52.52.20.20.20.1">𝐱</ci></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E15.m1.68.68.4">superscript</csymbol><ci id="A1.E15.m1.53.53.53.21.21.21.cmml" xref="A1.E15.m1.53.53.53.21.21.21">𝐬</ci><ci id="A1.E15.m1.54.54.54.22.22.22.1.cmml" xref="A1.E15.m1.54.54.54.22.22.22.1">𝑇</ci></apply><apply id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="A1.E15.m1.68.68.4"><csymbol cd="ambiguous" id="A1.E15.m1.66.66.2.2.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="A1.E15.m1.68.68.4">subscript</csymbol><ci id="A1.E15.m1.55.55.55.23.23.23.cmml" xref="A1.E15.m1.55.55.55.23.23.23">𝐹</ci><ci id="A1.E15.m1.56.56.56.24.24.24.1.cmml" xref="A1.E15.m1.56.56.56.24.24.24.1">𝑎</ci></apply><ci id="A1.E15.m1.58.58.58.26.26.26.cmml" xref="A1.E15.m1.58.58.58.26.26.26">𝐱</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E15.m1.66.66.2.2.3.cmml" xref="A1.E15.m1.68.68.4"><log id="A1.E15.m1.63.63.63.31.31.31.cmml" xref="A1.E15.m1.63.63.63.31.31.31"></log><ci id="A1.E15.m1.64.64.64.32.32.32.cmml" xref="A1.E15.m1.64.64.64.32.32.32">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.68c">\begin{split}\mathcal{L}_{2}&amp;=-\mathbb{E}_{t\sim\mathcal{U}[2,T]}\left[\lambda%
_{t}\left(\log J_{\kappa_{\mathbf{x}}}^{2}+\underbrace{\kappa_{\mathbf{x}}%
\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{\mathbf{x}}_{0}^{(t)}\right)}_{\text{%
inner-product term}}+\kappa_{\mathbf{x}}\mathbf{s}^{T}F_{a}(\mathbf{x})\right)%
\right]+\log Z\\
&amp;=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\left(\log J_{\kappa_{\mathbf{%
x}}}^{2}+\underbrace{\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{\bm{\phi}}\left(\hat{%
\mathbf{x}}_{0}^{(t)}\right)}_{\text{inner-product term}}+\kappa_{\mathbf{x}}%
\mathbf{s}^{T}F_{a}(\mathbf{x})\right)\right]}+\log Z\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.68d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL start_CELL = - blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U [ 2 , italic_T ] end_POSTSUBSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( roman_log italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + under⏟ start_ARG italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT + italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) ) ] + roman_log italic_Z end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = - divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( roman_log italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + under⏟ start_ARG italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) end_ARG start_POSTSUBSCRIPT inner-product term end_POSTSUBSCRIPT + italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) ) ] + roman_log italic_Z end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.3.p1.23">Here we assume access to a perfect denoising module such that <math alttext="\hat{\mathbf{x}}_{0}^{(t)}=\mathbf{x}_{0}=\mathbf{x}" class="ltx_Math" display="inline" id="A1.3.p1.21.m1.1"><semantics id="A1.3.p1.21.m1.1a"><mrow id="A1.3.p1.21.m1.1.2" xref="A1.3.p1.21.m1.1.2.cmml"><msubsup id="A1.3.p1.21.m1.1.2.2" xref="A1.3.p1.21.m1.1.2.2.cmml"><mover accent="true" id="A1.3.p1.21.m1.1.2.2.2.2" xref="A1.3.p1.21.m1.1.2.2.2.2.cmml"><mi id="A1.3.p1.21.m1.1.2.2.2.2.2" xref="A1.3.p1.21.m1.1.2.2.2.2.2.cmml">𝐱</mi><mo id="A1.3.p1.21.m1.1.2.2.2.2.1" xref="A1.3.p1.21.m1.1.2.2.2.2.1.cmml">^</mo></mover><mn id="A1.3.p1.21.m1.1.2.2.2.3" xref="A1.3.p1.21.m1.1.2.2.2.3.cmml">0</mn><mrow id="A1.3.p1.21.m1.1.1.1.3" xref="A1.3.p1.21.m1.1.2.2.cmml"><mo id="A1.3.p1.21.m1.1.1.1.3.1" stretchy="false" xref="A1.3.p1.21.m1.1.2.2.cmml">(</mo><mi id="A1.3.p1.21.m1.1.1.1.1" xref="A1.3.p1.21.m1.1.1.1.1.cmml">t</mi><mo id="A1.3.p1.21.m1.1.1.1.3.2" stretchy="false" xref="A1.3.p1.21.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.3.p1.21.m1.1.2.3" xref="A1.3.p1.21.m1.1.2.3.cmml">=</mo><msub id="A1.3.p1.21.m1.1.2.4" xref="A1.3.p1.21.m1.1.2.4.cmml"><mi id="A1.3.p1.21.m1.1.2.4.2" xref="A1.3.p1.21.m1.1.2.4.2.cmml">𝐱</mi><mn id="A1.3.p1.21.m1.1.2.4.3" xref="A1.3.p1.21.m1.1.2.4.3.cmml">0</mn></msub><mo id="A1.3.p1.21.m1.1.2.5" xref="A1.3.p1.21.m1.1.2.5.cmml">=</mo><mi id="A1.3.p1.21.m1.1.2.6" xref="A1.3.p1.21.m1.1.2.6.cmml">𝐱</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.3.p1.21.m1.1b"><apply id="A1.3.p1.21.m1.1.2.cmml" xref="A1.3.p1.21.m1.1.2"><and id="A1.3.p1.21.m1.1.2a.cmml" xref="A1.3.p1.21.m1.1.2"></and><apply id="A1.3.p1.21.m1.1.2b.cmml" xref="A1.3.p1.21.m1.1.2"><eq id="A1.3.p1.21.m1.1.2.3.cmml" xref="A1.3.p1.21.m1.1.2.3"></eq><apply id="A1.3.p1.21.m1.1.2.2.cmml" xref="A1.3.p1.21.m1.1.2.2"><csymbol cd="ambiguous" id="A1.3.p1.21.m1.1.2.2.1.cmml" xref="A1.3.p1.21.m1.1.2.2">superscript</csymbol><apply id="A1.3.p1.21.m1.1.2.2.2.cmml" xref="A1.3.p1.21.m1.1.2.2"><csymbol cd="ambiguous" id="A1.3.p1.21.m1.1.2.2.2.1.cmml" xref="A1.3.p1.21.m1.1.2.2">subscript</csymbol><apply id="A1.3.p1.21.m1.1.2.2.2.2.cmml" xref="A1.3.p1.21.m1.1.2.2.2.2"><ci id="A1.3.p1.21.m1.1.2.2.2.2.1.cmml" xref="A1.3.p1.21.m1.1.2.2.2.2.1">^</ci><ci id="A1.3.p1.21.m1.1.2.2.2.2.2.cmml" xref="A1.3.p1.21.m1.1.2.2.2.2.2">𝐱</ci></apply><cn id="A1.3.p1.21.m1.1.2.2.2.3.cmml" type="integer" xref="A1.3.p1.21.m1.1.2.2.2.3">0</cn></apply><ci id="A1.3.p1.21.m1.1.1.1.1.cmml" xref="A1.3.p1.21.m1.1.1.1.1">𝑡</ci></apply><apply id="A1.3.p1.21.m1.1.2.4.cmml" xref="A1.3.p1.21.m1.1.2.4"><csymbol cd="ambiguous" id="A1.3.p1.21.m1.1.2.4.1.cmml" xref="A1.3.p1.21.m1.1.2.4">subscript</csymbol><ci id="A1.3.p1.21.m1.1.2.4.2.cmml" xref="A1.3.p1.21.m1.1.2.4.2">𝐱</ci><cn id="A1.3.p1.21.m1.1.2.4.3.cmml" type="integer" xref="A1.3.p1.21.m1.1.2.4.3">0</cn></apply></apply><apply id="A1.3.p1.21.m1.1.2c.cmml" xref="A1.3.p1.21.m1.1.2"><eq id="A1.3.p1.21.m1.1.2.5.cmml" xref="A1.3.p1.21.m1.1.2.5"></eq><share href="https://arxiv.org/html/2409.17576v1#A1.3.p1.21.m1.1.2.4.cmml" id="A1.3.p1.21.m1.1.2d.cmml" xref="A1.3.p1.21.m1.1.2"></share><ci id="A1.3.p1.21.m1.1.2.6.cmml" xref="A1.3.p1.21.m1.1.2.6">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.21.m1.1c">\hat{\mathbf{x}}_{0}^{(t)}=\mathbf{x}_{0}=\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.21.m1.1d">over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_x</annotation></semantics></math>, for all <math alttext="t" class="ltx_Math" display="inline" id="A1.3.p1.22.m2.1"><semantics id="A1.3.p1.22.m2.1a"><mi id="A1.3.p1.22.m2.1.1" xref="A1.3.p1.22.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.3.p1.22.m2.1b"><ci id="A1.3.p1.22.m2.1.1.cmml" xref="A1.3.p1.22.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.22.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.22.m2.1d">italic_t</annotation></semantics></math>’s. Hence, <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="A1.3.p1.23.m3.1"><semantics id="A1.3.p1.23.m3.1a"><msub id="A1.3.p1.23.m3.1.1" xref="A1.3.p1.23.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.3.p1.23.m3.1.1.2" xref="A1.3.p1.23.m3.1.1.2.cmml">ℒ</mi><mn id="A1.3.p1.23.m3.1.1.3" xref="A1.3.p1.23.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.3.p1.23.m3.1b"><apply id="A1.3.p1.23.m3.1.1.cmml" xref="A1.3.p1.23.m3.1.1"><csymbol cd="ambiguous" id="A1.3.p1.23.m3.1.1.1.cmml" xref="A1.3.p1.23.m3.1.1">subscript</csymbol><ci id="A1.3.p1.23.m3.1.1.2.cmml" xref="A1.3.p1.23.m3.1.1.2">ℒ</ci><cn id="A1.3.p1.23.m3.1.1.3.cmml" type="integer" xref="A1.3.p1.23.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.3.p1.23.m3.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.3.p1.23.m3.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> can be written as</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E16">
<tbody>
<tr class="ltx_eqn_row" id="A5.EGx3"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{2}" class="ltx_Math" display="inline" id="A1.E16.1.m1.1"><semantics id="A1.E16.1.m1.1a"><msub id="A1.E16.1.m1.1.1" xref="A1.E16.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E16.1.m1.1.1.2" xref="A1.E16.1.m1.1.1.2.cmml">ℒ</mi><mn id="A1.E16.1.m1.1.1.3" xref="A1.E16.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.E16.1.m1.1b"><apply id="A1.E16.1.m1.1.1.cmml" xref="A1.E16.1.m1.1.1"><csymbol cd="ambiguous" id="A1.E16.1.m1.1.1.1.cmml" xref="A1.E16.1.m1.1.1">subscript</csymbol><ci id="A1.E16.1.m1.1.1.2.cmml" xref="A1.E16.1.m1.1.1.2">ℒ</ci><cn id="A1.E16.1.m1.1.1.3.cmml" type="integer" xref="A1.E16.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.1.m1.1c">\displaystyle\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\left(\log J_{%
\kappa_{\mathbf{x}}}^{2}+\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{\bm{\phi}}\left(%
\mathbf{x}\right)+\kappa_{\mathbf{x}}\mathbf{s}^{T}F_{a}(\mathbf{x})\right)%
\right]}+\log Z" class="ltx_Math" display="inline" id="A1.E16.1.m2.3"><semantics id="A1.E16.1.m2.3a"><mrow id="A1.E16.1.m2.3.3" xref="A1.E16.1.m2.3.3.cmml"><mi id="A1.E16.1.m2.3.3.3" xref="A1.E16.1.m2.3.3.3.cmml"></mi><mo id="A1.E16.1.m2.3.3.2" xref="A1.E16.1.m2.3.3.2.cmml">=</mo><mrow id="A1.E16.1.m2.3.3.1" xref="A1.E16.1.m2.3.3.1.cmml"><mrow id="A1.E16.1.m2.3.3.1.1" xref="A1.E16.1.m2.3.3.1.1.cmml"><mo id="A1.E16.1.m2.3.3.1.1a" xref="A1.E16.1.m2.3.3.1.1.cmml">−</mo><mrow id="A1.E16.1.m2.3.3.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.1.m2.3.3.1.1.1.3" xref="A1.E16.1.m2.3.3.1.1.1.3.cmml"><mfrac id="A1.E16.1.m2.3.3.1.1.1.3a" xref="A1.E16.1.m2.3.3.1.1.1.3.cmml"><mn id="A1.E16.1.m2.3.3.1.1.1.3.2" xref="A1.E16.1.m2.3.3.1.1.1.3.2.cmml">1</mn><mrow id="A1.E16.1.m2.3.3.1.1.1.3.3" xref="A1.E16.1.m2.3.3.1.1.1.3.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.3.3.2" xref="A1.E16.1.m2.3.3.1.1.1.3.3.2.cmml">T</mi><mo id="A1.E16.1.m2.3.3.1.1.1.3.3.1" xref="A1.E16.1.m2.3.3.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E16.1.m2.3.3.1.1.1.3.3.3" xref="A1.E16.1.m2.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mstyle><mo id="A1.E16.1.m2.3.3.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.1.m2.3.3.1.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.1.2.cmml"><munderover id="A1.E16.1.m2.3.3.1.1.1.1.2a" xref="A1.E16.1.m2.3.3.1.1.1.1.2.cmml"><mo id="A1.E16.1.m2.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.1" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.3.cmml">2</mn></mrow><mi id="A1.E16.1.m2.3.3.1.1.1.1.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.2.cmml"><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">log</mi><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2a" lspace="0.167em" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><msubsup id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">J</mi><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">κ</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">𝐱</mi></msub><mn id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msubsup></mrow><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">κ</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">𝐱</mi></msub><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐲</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></msup><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1a" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.3" mathvariant="bold-italic" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.3.cmml">ϕ</mi></msub><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1b" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.5.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.5.2.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E16.1.m2.1.1" xref="A1.E16.1.m2.1.1.cmml">𝐱</mi><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.5.2.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1a" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.cmml"><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">κ</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">𝐱</mi></msub><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><msup id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">𝐬</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">T</mi></msup><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1a" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><msub id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.cmml"><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml">F</mi><mi id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml">a</mi></msub><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1b" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.5.2" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.cmml"><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.5.2.1" stretchy="false" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.cmml">(</mo><mi id="A1.E16.1.m2.2.2" xref="A1.E16.1.m2.2.2.cmml">𝐱</mi><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.5.2.2" stretchy="false" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.1.m2.3.3.1.1.1.1.1.1.3" xref="A1.E16.1.m2.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A1.E16.1.m2.3.3.1.2" xref="A1.E16.1.m2.3.3.1.2.cmml">+</mo><mrow id="A1.E16.1.m2.3.3.1.3" xref="A1.E16.1.m2.3.3.1.3.cmml"><mi id="A1.E16.1.m2.3.3.1.3.1" xref="A1.E16.1.m2.3.3.1.3.1.cmml">log</mi><mo id="A1.E16.1.m2.3.3.1.3a" lspace="0.167em" xref="A1.E16.1.m2.3.3.1.3.cmml">⁡</mo><mi id="A1.E16.1.m2.3.3.1.3.2" xref="A1.E16.1.m2.3.3.1.3.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.1.m2.3b"><apply id="A1.E16.1.m2.3.3.cmml" xref="A1.E16.1.m2.3.3"><eq id="A1.E16.1.m2.3.3.2.cmml" xref="A1.E16.1.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.E16.1.m2.3.3.3.cmml" xref="A1.E16.1.m2.3.3.3">absent</csymbol><apply id="A1.E16.1.m2.3.3.1.cmml" xref="A1.E16.1.m2.3.3.1"><plus id="A1.E16.1.m2.3.3.1.2.cmml" xref="A1.E16.1.m2.3.3.1.2"></plus><apply id="A1.E16.1.m2.3.3.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1"><minus id="A1.E16.1.m2.3.3.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1"></minus><apply id="A1.E16.1.m2.3.3.1.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1"><times id="A1.E16.1.m2.3.3.1.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.2"></times><apply id="A1.E16.1.m2.3.3.1.1.1.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.3"><divide id="A1.E16.1.m2.3.3.1.1.1.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.3"></divide><cn id="A1.E16.1.m2.3.3.1.1.1.3.2.cmml" type="integer" xref="A1.E16.1.m2.3.3.1.1.1.3.2">1</cn><apply id="A1.E16.1.m2.3.3.1.1.1.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.3.3"><minus id="A1.E16.1.m2.3.3.1.1.1.3.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.3.3.1"></minus><ci id="A1.E16.1.m2.3.3.1.1.1.3.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.3.3.2">𝑇</ci><cn id="A1.E16.1.m2.3.3.1.1.1.3.3.3.cmml" type="integer" xref="A1.E16.1.m2.3.3.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1"><apply id="A1.E16.1.m2.3.3.1.1.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="A1.E16.1.m2.3.3.1.1.1.1.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.2.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="A1.E16.1.m2.3.3.1.1.1.1.2.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3"><eq id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.2">𝑡</ci><cn id="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E16.1.m2.3.3.1.1.1.1.2.2.3.3">2</cn></apply></apply><ci id="A1.E16.1.m2.3.3.1.1.1.1.2.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.2.3">𝑇</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E16.1.m2.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1"><times id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.2"></times><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1"><plus id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2"><log id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1"></log><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐽</ci><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝜅</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝐱</ci></apply></apply><cn id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.2.3">2</cn></apply></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2">𝜅</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3">𝐱</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐲</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.2">𝑓</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.4.3">bold-italic-ϕ</ci></apply><ci id="A1.E16.1.m2.1.1.cmml" xref="A1.E16.1.m2.1.1">𝐱</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4"><times id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.1"></times><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.2">𝜅</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.2.3">𝐱</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3">superscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.2">𝐬</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.3.3">𝑇</ci></apply><apply id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.2">𝐹</ci><ci id="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="A1.E16.1.m2.3.3.1.1.1.1.1.1.1.1.1.1.4.4.3">𝑎</ci></apply><ci id="A1.E16.1.m2.2.2.cmml" xref="A1.E16.1.m2.2.2">𝐱</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E16.1.m2.3.3.1.3.cmml" xref="A1.E16.1.m2.3.3.1.3"><log id="A1.E16.1.m2.3.3.1.3.1.cmml" xref="A1.E16.1.m2.3.3.1.3.1"></log><ci id="A1.E16.1.m2.3.3.1.3.2.cmml" xref="A1.E16.1.m2.3.3.1.3.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.1.m2.3c">\displaystyle=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\left(\log J_{%
\kappa_{\mathbf{x}}}^{2}+\kappa_{\mathbf{x}}\mathbf{y}^{T}f_{\bm{\phi}}\left(%
\mathbf{x}\right)+\kappa_{\mathbf{x}}\mathbf{s}^{T}F_{a}(\mathbf{x})\right)%
\right]}+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E16.1.m2.3d">= - divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( roman_log italic_J start_POSTSUBSCRIPT italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x ) + italic_κ start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT bold_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_F start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( bold_x ) ) ] + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.16a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\log p(\mathbf{y},%
\mathbf{s}|\mathbf{x})\right]}+\log Z" class="ltx_Math" display="inline" id="A1.E16.2.m1.2"><semantics id="A1.E16.2.m1.2a"><mrow id="A1.E16.2.m1.2.2" xref="A1.E16.2.m1.2.2.cmml"><mi id="A1.E16.2.m1.2.2.3" xref="A1.E16.2.m1.2.2.3.cmml"></mi><mo id="A1.E16.2.m1.2.2.2" xref="A1.E16.2.m1.2.2.2.cmml">=</mo><mrow id="A1.E16.2.m1.2.2.1" xref="A1.E16.2.m1.2.2.1.cmml"><mrow id="A1.E16.2.m1.2.2.1.1" xref="A1.E16.2.m1.2.2.1.1.cmml"><mo id="A1.E16.2.m1.2.2.1.1a" xref="A1.E16.2.m1.2.2.1.1.cmml">−</mo><mrow id="A1.E16.2.m1.2.2.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.2.m1.2.2.1.1.1.3" xref="A1.E16.2.m1.2.2.1.1.1.3.cmml"><mfrac id="A1.E16.2.m1.2.2.1.1.1.3a" xref="A1.E16.2.m1.2.2.1.1.1.3.cmml"><mn id="A1.E16.2.m1.2.2.1.1.1.3.2" xref="A1.E16.2.m1.2.2.1.1.1.3.2.cmml">1</mn><mrow id="A1.E16.2.m1.2.2.1.1.1.3.3" xref="A1.E16.2.m1.2.2.1.1.1.3.3.cmml"><mi id="A1.E16.2.m1.2.2.1.1.1.3.3.2" xref="A1.E16.2.m1.2.2.1.1.1.3.3.2.cmml">T</mi><mo id="A1.E16.2.m1.2.2.1.1.1.3.3.1" xref="A1.E16.2.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E16.2.m1.2.2.1.1.1.3.3.3" xref="A1.E16.2.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mstyle><mo id="A1.E16.2.m1.2.2.1.1.1.2" xref="A1.E16.2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.2.m1.2.2.1.1.1.1.2" xref="A1.E16.2.m1.2.2.1.1.1.1.2.cmml"><munderover id="A1.E16.2.m1.2.2.1.1.1.1.2a" xref="A1.E16.2.m1.2.2.1.1.1.1.2.cmml"><mo id="A1.E16.2.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.2" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.1" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.3" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.3.cmml">2</mn></mrow><mi id="A1.E16.2.m1.2.2.1.1.1.1.2.3" xref="A1.E16.2.m1.2.2.1.1.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="A1.E16.2.m1.2.2.1.1.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.2" xref="A1.E16.2.m1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2" lspace="0.167em" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.2" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.2.cmml">p</mi></mrow><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2a" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.2.m1.1.1" xref="A1.E16.2.m1.1.1.cmml">𝐲</mi><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.2.m1.2.2.1.1.1.1.1.1.3" xref="A1.E16.2.m1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A1.E16.2.m1.2.2.1.2" xref="A1.E16.2.m1.2.2.1.2.cmml">+</mo><mrow id="A1.E16.2.m1.2.2.1.3" xref="A1.E16.2.m1.2.2.1.3.cmml"><mi id="A1.E16.2.m1.2.2.1.3.1" xref="A1.E16.2.m1.2.2.1.3.1.cmml">log</mi><mo id="A1.E16.2.m1.2.2.1.3a" lspace="0.167em" xref="A1.E16.2.m1.2.2.1.3.cmml">⁡</mo><mi id="A1.E16.2.m1.2.2.1.3.2" xref="A1.E16.2.m1.2.2.1.3.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.2.m1.2b"><apply id="A1.E16.2.m1.2.2.cmml" xref="A1.E16.2.m1.2.2"><eq id="A1.E16.2.m1.2.2.2.cmml" xref="A1.E16.2.m1.2.2.2"></eq><csymbol cd="latexml" id="A1.E16.2.m1.2.2.3.cmml" xref="A1.E16.2.m1.2.2.3">absent</csymbol><apply id="A1.E16.2.m1.2.2.1.cmml" xref="A1.E16.2.m1.2.2.1"><plus id="A1.E16.2.m1.2.2.1.2.cmml" xref="A1.E16.2.m1.2.2.1.2"></plus><apply id="A1.E16.2.m1.2.2.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1"><minus id="A1.E16.2.m1.2.2.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1"></minus><apply id="A1.E16.2.m1.2.2.1.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1"><times id="A1.E16.2.m1.2.2.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.2"></times><apply id="A1.E16.2.m1.2.2.1.1.1.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.3"><divide id="A1.E16.2.m1.2.2.1.1.1.3.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.3"></divide><cn id="A1.E16.2.m1.2.2.1.1.1.3.2.cmml" type="integer" xref="A1.E16.2.m1.2.2.1.1.1.3.2">1</cn><apply id="A1.E16.2.m1.2.2.1.1.1.3.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.3.3"><minus id="A1.E16.2.m1.2.2.1.1.1.3.3.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.3.3.1"></minus><ci id="A1.E16.2.m1.2.2.1.1.1.3.3.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.3.3.2">𝑇</ci><cn id="A1.E16.2.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.E16.2.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E16.2.m1.2.2.1.1.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1"><apply id="A1.E16.2.m1.2.2.1.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.2.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="A1.E16.2.m1.2.2.1.1.1.1.2.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="A1.E16.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3"><eq id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.2">𝑡</ci><cn id="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E16.2.m1.2.2.1.1.1.1.2.2.3.3">2</cn></apply></apply><ci id="A1.E16.2.m1.2.2.1.1.1.1.2.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="A1.E16.2.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E16.2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1"><times id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4"><log id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.1"></log><ci id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.4.2">𝑝</ci></apply><interval closure="open" id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1"><ci id="A1.E16.2.m1.1.1.cmml" xref="A1.E16.2.m1.1.1">𝐲</ci><apply id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝐬</ci><ci id="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝐱</ci></apply></interval></apply></apply></apply></apply></apply><apply id="A1.E16.2.m1.2.2.1.3.cmml" xref="A1.E16.2.m1.2.2.1.3"><log id="A1.E16.2.m1.2.2.1.3.1.cmml" xref="A1.E16.2.m1.2.2.1.3.1"></log><ci id="A1.E16.2.m1.2.2.1.3.2.cmml" xref="A1.E16.2.m1.2.2.1.3.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.2.m1.2c">\displaystyle=-\frac{1}{T-1}\sum_{t=2}^{T}{\left[\lambda_{t}\log p(\mathbf{y},%
\mathbf{s}|\mathbf{x})\right]}+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E16.2.m1.2d">= - divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT roman_log italic_p ( bold_y , bold_s | bold_x ) ] + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.16b)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16.3">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{T-1}\left(\sum_{t=2}^{T}{\lambda_{t}}\right)\cdot\log p%
(\mathbf{y},\mathbf{s}|\mathbf{x})+\log Z" class="ltx_Math" display="inline" id="A1.E16.3.m1.3"><semantics id="A1.E16.3.m1.3a"><mrow id="A1.E16.3.m1.3.3" xref="A1.E16.3.m1.3.3.cmml"><mi id="A1.E16.3.m1.3.3.4" xref="A1.E16.3.m1.3.3.4.cmml"></mi><mo id="A1.E16.3.m1.3.3.3" xref="A1.E16.3.m1.3.3.3.cmml">=</mo><mrow id="A1.E16.3.m1.3.3.2" xref="A1.E16.3.m1.3.3.2.cmml"><mrow id="A1.E16.3.m1.3.3.2.2" xref="A1.E16.3.m1.3.3.2.2.cmml"><mo id="A1.E16.3.m1.3.3.2.2a" xref="A1.E16.3.m1.3.3.2.2.cmml">−</mo><mrow id="A1.E16.3.m1.3.3.2.2.2" xref="A1.E16.3.m1.3.3.2.2.2.cmml"><mrow id="A1.E16.3.m1.2.2.1.1.1.1" xref="A1.E16.3.m1.2.2.1.1.1.1.cmml"><mrow id="A1.E16.3.m1.2.2.1.1.1.1.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.3.m1.2.2.1.1.1.1.1.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.cmml"><mfrac id="A1.E16.3.m1.2.2.1.1.1.1.1.3a" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.cmml"><mn id="A1.E16.3.m1.2.2.1.1.1.1.1.3.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.2.cmml">1</mn><mrow id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.2.cmml">T</mi><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mstyle><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1a" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></munderover></mstyle><msub id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">λ</mi><mi id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub></mrow><mo id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.3.m1.2.2.1.1.1.1.2" rspace="0.222em" xref="A1.E16.3.m1.2.2.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.E16.3.m1.2.2.1.1.1.1.3" xref="A1.E16.3.m1.2.2.1.1.1.1.3.cmml"><mi id="A1.E16.3.m1.2.2.1.1.1.1.3.1" xref="A1.E16.3.m1.2.2.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E16.3.m1.2.2.1.1.1.1.3a" lspace="0.167em" xref="A1.E16.3.m1.2.2.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E16.3.m1.2.2.1.1.1.1.3.2" xref="A1.E16.3.m1.2.2.1.1.1.1.3.2.cmml">p</mi></mrow></mrow><mo id="A1.E16.3.m1.3.3.2.2.2.3" xref="A1.E16.3.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="A1.E16.3.m1.3.3.2.2.2.2.1" xref="A1.E16.3.m1.3.3.2.2.2.2.2.cmml"><mo id="A1.E16.3.m1.3.3.2.2.2.2.1.2" stretchy="false" xref="A1.E16.3.m1.3.3.2.2.2.2.2.cmml">(</mo><mi id="A1.E16.3.m1.1.1" xref="A1.E16.3.m1.1.1.cmml">𝐲</mi><mo id="A1.E16.3.m1.3.3.2.2.2.2.1.3" xref="A1.E16.3.m1.3.3.2.2.2.2.2.cmml">,</mo><mrow id="A1.E16.3.m1.3.3.2.2.2.2.1.1" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.cmml"><mi id="A1.E16.3.m1.3.3.2.2.2.2.1.1.2" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E16.3.m1.3.3.2.2.2.2.1.1.1" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E16.3.m1.3.3.2.2.2.2.1.1.3" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E16.3.m1.3.3.2.2.2.2.1.4" stretchy="false" xref="A1.E16.3.m1.3.3.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E16.3.m1.3.3.2.3" xref="A1.E16.3.m1.3.3.2.3.cmml">+</mo><mrow id="A1.E16.3.m1.3.3.2.4" xref="A1.E16.3.m1.3.3.2.4.cmml"><mi id="A1.E16.3.m1.3.3.2.4.1" xref="A1.E16.3.m1.3.3.2.4.1.cmml">log</mi><mo id="A1.E16.3.m1.3.3.2.4a" lspace="0.167em" xref="A1.E16.3.m1.3.3.2.4.cmml">⁡</mo><mi id="A1.E16.3.m1.3.3.2.4.2" xref="A1.E16.3.m1.3.3.2.4.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.3.m1.3b"><apply id="A1.E16.3.m1.3.3.cmml" xref="A1.E16.3.m1.3.3"><eq id="A1.E16.3.m1.3.3.3.cmml" xref="A1.E16.3.m1.3.3.3"></eq><csymbol cd="latexml" id="A1.E16.3.m1.3.3.4.cmml" xref="A1.E16.3.m1.3.3.4">absent</csymbol><apply id="A1.E16.3.m1.3.3.2.cmml" xref="A1.E16.3.m1.3.3.2"><plus id="A1.E16.3.m1.3.3.2.3.cmml" xref="A1.E16.3.m1.3.3.2.3"></plus><apply id="A1.E16.3.m1.3.3.2.2.cmml" xref="A1.E16.3.m1.3.3.2.2"><minus id="A1.E16.3.m1.3.3.2.2.3.cmml" xref="A1.E16.3.m1.3.3.2.2"></minus><apply id="A1.E16.3.m1.3.3.2.2.2.cmml" xref="A1.E16.3.m1.3.3.2.2.2"><times id="A1.E16.3.m1.3.3.2.2.2.3.cmml" xref="A1.E16.3.m1.3.3.2.2.2.3"></times><apply id="A1.E16.3.m1.2.2.1.1.1.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1"><ci id="A1.E16.3.m1.2.2.1.1.1.1.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.2">⋅</ci><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1"><times id="A1.E16.3.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.2"></times><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3"><divide id="A1.E16.3.m1.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3"></divide><cn id="A1.E16.3.m1.2.2.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.2">1</cn><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3"><minus id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.1"></minus><ci id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.2">𝑇</ci><cn id="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E16.3.m1.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1"><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><eq id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><ci id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝜆</ci><ci id="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply></apply></apply><apply id="A1.E16.3.m1.2.2.1.1.1.1.3.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.3"><log id="A1.E16.3.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.3.1"></log><ci id="A1.E16.3.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E16.3.m1.2.2.1.1.1.1.3.2">𝑝</ci></apply></apply><interval closure="open" id="A1.E16.3.m1.3.3.2.2.2.2.2.cmml" xref="A1.E16.3.m1.3.3.2.2.2.2.1"><ci id="A1.E16.3.m1.1.1.cmml" xref="A1.E16.3.m1.1.1">𝐲</ci><apply id="A1.E16.3.m1.3.3.2.2.2.2.1.1.cmml" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E16.3.m1.3.3.2.2.2.2.1.1.1.cmml" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E16.3.m1.3.3.2.2.2.2.1.1.2.cmml" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.2">𝐬</ci><ci id="A1.E16.3.m1.3.3.2.2.2.2.1.1.3.cmml" xref="A1.E16.3.m1.3.3.2.2.2.2.1.1.3">𝐱</ci></apply></interval></apply></apply><apply id="A1.E16.3.m1.3.3.2.4.cmml" xref="A1.E16.3.m1.3.3.2.4"><log id="A1.E16.3.m1.3.3.2.4.1.cmml" xref="A1.E16.3.m1.3.3.2.4.1"></log><ci id="A1.E16.3.m1.3.3.2.4.2.cmml" xref="A1.E16.3.m1.3.3.2.4.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.3.m1.3c">\displaystyle=-\frac{1}{T-1}\left(\sum_{t=2}^{T}{\lambda_{t}}\right)\cdot\log p%
(\mathbf{y},\mathbf{s}|\mathbf{x})+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E16.3.m1.3d">= - divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG ( ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ roman_log italic_p ( bold_y , bold_s | bold_x ) + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.16c)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16.4">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\log p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}+\log Z" class="ltx_Math" display="inline" id="A1.E16.4.m1.2"><semantics id="A1.E16.4.m1.2a"><mrow id="A1.E16.4.m1.2.2" xref="A1.E16.4.m1.2.2.cmml"><mi id="A1.E16.4.m1.2.2.3" xref="A1.E16.4.m1.2.2.3.cmml"></mi><mo id="A1.E16.4.m1.2.2.2" xref="A1.E16.4.m1.2.2.2.cmml">=</mo><mrow id="A1.E16.4.m1.2.2.1" xref="A1.E16.4.m1.2.2.1.cmml"><mrow id="A1.E16.4.m1.2.2.1.1" xref="A1.E16.4.m1.2.2.1.1.cmml"><mo id="A1.E16.4.m1.2.2.1.1a" rspace="0.167em" xref="A1.E16.4.m1.2.2.1.1.cmml">−</mo><mrow id="A1.E16.4.m1.2.2.1.1.1" xref="A1.E16.4.m1.2.2.1.1.1.cmml"><mrow id="A1.E16.4.m1.2.2.1.1.1.3" xref="A1.E16.4.m1.2.2.1.1.1.3.cmml"><mi id="A1.E16.4.m1.2.2.1.1.1.3.1" xref="A1.E16.4.m1.2.2.1.1.1.3.1.cmml">log</mi><mo id="A1.E16.4.m1.2.2.1.1.1.3a" lspace="0.167em" xref="A1.E16.4.m1.2.2.1.1.1.3.cmml">⁡</mo><mi id="A1.E16.4.m1.2.2.1.1.1.3.2" xref="A1.E16.4.m1.2.2.1.1.1.3.2.cmml">p</mi></mrow><mo id="A1.E16.4.m1.2.2.1.1.1.2" xref="A1.E16.4.m1.2.2.1.1.1.2.cmml">⁢</mo><msup id="A1.E16.4.m1.2.2.1.1.1.1" xref="A1.E16.4.m1.2.2.1.1.1.1.cmml"><mrow id="A1.E16.4.m1.2.2.1.1.1.1.1.1" xref="A1.E16.4.m1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.E16.4.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.4.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.4.m1.1.1" xref="A1.E16.4.m1.1.1.cmml">𝐲</mi><mo id="A1.E16.4.m1.2.2.1.1.1.1.1.1.3" xref="A1.E16.4.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mrow id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E16.4.m1.2.2.1.1.1.1.1.1.4" stretchy="false" xref="A1.E16.4.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow><mfrac id="A1.E16.4.m1.2.2.1.1.1.1.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.cmml"><mrow id="A1.E16.4.m1.2.2.1.1.1.1.3.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.cmml"><mstyle displaystyle="false" id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.cmml"><msubsup id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1a" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.cmml"><mo id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.cmml"><mi id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.2.cmml">t</mi><mo id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.1" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.2.cmml">λ</mi><mi id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.E16.4.m1.2.2.1.1.1.1.3.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.cmml"><mi id="A1.E16.4.m1.2.2.1.1.1.1.3.3.2" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.2.cmml">T</mi><mo id="A1.E16.4.m1.2.2.1.1.1.1.3.3.1" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E16.4.m1.2.2.1.1.1.1.3.3.3" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></msup></mrow></mrow><mo id="A1.E16.4.m1.2.2.1.2" xref="A1.E16.4.m1.2.2.1.2.cmml">+</mo><mrow id="A1.E16.4.m1.2.2.1.3" xref="A1.E16.4.m1.2.2.1.3.cmml"><mi id="A1.E16.4.m1.2.2.1.3.1" xref="A1.E16.4.m1.2.2.1.3.1.cmml">log</mi><mo id="A1.E16.4.m1.2.2.1.3a" lspace="0.167em" xref="A1.E16.4.m1.2.2.1.3.cmml">⁡</mo><mi id="A1.E16.4.m1.2.2.1.3.2" xref="A1.E16.4.m1.2.2.1.3.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.4.m1.2b"><apply id="A1.E16.4.m1.2.2.cmml" xref="A1.E16.4.m1.2.2"><eq id="A1.E16.4.m1.2.2.2.cmml" xref="A1.E16.4.m1.2.2.2"></eq><csymbol cd="latexml" id="A1.E16.4.m1.2.2.3.cmml" xref="A1.E16.4.m1.2.2.3">absent</csymbol><apply id="A1.E16.4.m1.2.2.1.cmml" xref="A1.E16.4.m1.2.2.1"><plus id="A1.E16.4.m1.2.2.1.2.cmml" xref="A1.E16.4.m1.2.2.1.2"></plus><apply id="A1.E16.4.m1.2.2.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1"><minus id="A1.E16.4.m1.2.2.1.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1"></minus><apply id="A1.E16.4.m1.2.2.1.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1"><times id="A1.E16.4.m1.2.2.1.1.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.2"></times><apply id="A1.E16.4.m1.2.2.1.1.1.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.3"><log id="A1.E16.4.m1.2.2.1.1.1.3.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.3.1"></log><ci id="A1.E16.4.m1.2.2.1.1.1.3.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E16.4.m1.2.2.1.1.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.4.m1.2.2.1.1.1.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1">superscript</csymbol><interval closure="open" id="A1.E16.4.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1"><ci id="A1.E16.4.m1.1.1.cmml" xref="A1.E16.4.m1.1.1">𝐲</ci><apply id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.2">𝐬</ci><ci id="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.1.1.1.3">𝐱</ci></apply></interval><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3"><divide id="A1.E16.4.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3"></divide><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2"><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1">superscript</csymbol><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1">subscript</csymbol><sum id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.2"></sum><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3"><eq id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.1"></eq><ci id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.2">𝑡</ci><cn id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.3.cmml" type="integer" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.2.3.3">2</cn></apply></apply><ci id="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.1.3">𝑇</ci></apply><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2">subscript</csymbol><ci id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.2">𝜆</ci><ci id="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.E16.4.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3"><minus id="A1.E16.4.m1.2.2.1.1.1.1.3.3.1.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.1"></minus><ci id="A1.E16.4.m1.2.2.1.1.1.1.3.3.2.cmml" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.2">𝑇</ci><cn id="A1.E16.4.m1.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E16.4.m1.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="A1.E16.4.m1.2.2.1.3.cmml" xref="A1.E16.4.m1.2.2.1.3"><log id="A1.E16.4.m1.2.2.1.3.1.cmml" xref="A1.E16.4.m1.2.2.1.3.1"></log><ci id="A1.E16.4.m1.2.2.1.3.2.cmml" xref="A1.E16.4.m1.2.2.1.3.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.4.m1.2c">\displaystyle=-\log p(\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{%
\lambda_{t}}}{T-1}}+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E16.4.m1.2d">= - roman_log italic_p ( bold_y , bold_s | bold_x ) start_POSTSUPERSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG end_POSTSUPERSCRIPT + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.16d)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.3.p1.26">Then,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E17">
<tbody>
<tr class="ltx_eqn_row" id="A5.EGx4"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}" class="ltx_Math" display="inline" id="A1.E17.1.m1.1"><semantics id="A1.E17.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.E17.1.m1.1.1" xref="A1.E17.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A1.E17.1.m1.1b"><ci id="A1.E17.1.m1.1.1.cmml" xref="A1.E17.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.1.m1.1c">\displaystyle\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="A1.E17.1.m1.1d">caligraphic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{L}_{1}+\mathcal{L}_{2}" class="ltx_Math" display="inline" id="A1.E17.1.m2.1"><semantics id="A1.E17.1.m2.1a"><mrow id="A1.E17.1.m2.1.1" xref="A1.E17.1.m2.1.1.cmml"><mi id="A1.E17.1.m2.1.1.2" xref="A1.E17.1.m2.1.1.2.cmml"></mi><mo id="A1.E17.1.m2.1.1.1" xref="A1.E17.1.m2.1.1.1.cmml">=</mo><mrow id="A1.E17.1.m2.1.1.3" xref="A1.E17.1.m2.1.1.3.cmml"><msub id="A1.E17.1.m2.1.1.3.2" xref="A1.E17.1.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.1.m2.1.1.3.2.2" xref="A1.E17.1.m2.1.1.3.2.2.cmml">ℒ</mi><mn id="A1.E17.1.m2.1.1.3.2.3" xref="A1.E17.1.m2.1.1.3.2.3.cmml">1</mn></msub><mo id="A1.E17.1.m2.1.1.3.1" xref="A1.E17.1.m2.1.1.3.1.cmml">+</mo><msub id="A1.E17.1.m2.1.1.3.3" xref="A1.E17.1.m2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.1.m2.1.1.3.3.2" xref="A1.E17.1.m2.1.1.3.3.2.cmml">ℒ</mi><mn id="A1.E17.1.m2.1.1.3.3.3" xref="A1.E17.1.m2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.1.m2.1b"><apply id="A1.E17.1.m2.1.1.cmml" xref="A1.E17.1.m2.1.1"><eq id="A1.E17.1.m2.1.1.1.cmml" xref="A1.E17.1.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.E17.1.m2.1.1.2.cmml" xref="A1.E17.1.m2.1.1.2">absent</csymbol><apply id="A1.E17.1.m2.1.1.3.cmml" xref="A1.E17.1.m2.1.1.3"><plus id="A1.E17.1.m2.1.1.3.1.cmml" xref="A1.E17.1.m2.1.1.3.1"></plus><apply id="A1.E17.1.m2.1.1.3.2.cmml" xref="A1.E17.1.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.E17.1.m2.1.1.3.2.1.cmml" xref="A1.E17.1.m2.1.1.3.2">subscript</csymbol><ci id="A1.E17.1.m2.1.1.3.2.2.cmml" xref="A1.E17.1.m2.1.1.3.2.2">ℒ</ci><cn id="A1.E17.1.m2.1.1.3.2.3.cmml" type="integer" xref="A1.E17.1.m2.1.1.3.2.3">1</cn></apply><apply id="A1.E17.1.m2.1.1.3.3.cmml" xref="A1.E17.1.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.E17.1.m2.1.1.3.3.1.cmml" xref="A1.E17.1.m2.1.1.3.3">subscript</csymbol><ci id="A1.E17.1.m2.1.1.3.3.2.cmml" xref="A1.E17.1.m2.1.1.3.3.2">ℒ</ci><cn id="A1.E17.1.m2.1.1.3.3.3.cmml" type="integer" xref="A1.E17.1.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.1.m2.1c">\displaystyle=\mathcal{L}_{1}+\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.E17.1.m2.1d">= caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.17a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq-\left[\log p(\mathbf{x}|\mathbf{y},\mathbf{s})+\log p(%
\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}}%
\right]+\log Z" class="ltx_Math" display="inline" id="A1.E17.2.m1.4"><semantics id="A1.E17.2.m1.4a"><mrow id="A1.E17.2.m1.4.4" xref="A1.E17.2.m1.4.4.cmml"><mi id="A1.E17.2.m1.4.4.3" xref="A1.E17.2.m1.4.4.3.cmml"></mi><mo id="A1.E17.2.m1.4.4.2" xref="A1.E17.2.m1.4.4.2.cmml">≥</mo><mrow id="A1.E17.2.m1.4.4.1" xref="A1.E17.2.m1.4.4.1.cmml"><mrow id="A1.E17.2.m1.4.4.1.1" xref="A1.E17.2.m1.4.4.1.1.cmml"><mo id="A1.E17.2.m1.4.4.1.1a" xref="A1.E17.2.m1.4.4.1.1.cmml">−</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.2.cmml"><mo id="A1.E17.2.m1.4.4.1.1.1.1.2" xref="A1.E17.2.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3a" lspace="0.167em" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.1.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="A1.E17.2.m1.1.1" xref="A1.E17.2.m1.1.1.cmml">𝐲</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E17.2.m1.2.2" xref="A1.E17.2.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3a" lspace="0.167em" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.2.cmml">p</mi></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.2.cmml">⁢</mo><msup id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.cmml"><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.2.cmml"><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.2.cmml">(</mo><mi id="A1.E17.2.m1.3.3" xref="A1.E17.2.m1.3.3.cmml">𝐲</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.2.cmml">,</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.cmml">|</mo><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.4" stretchy="false" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.2.cmml">)</mo></mrow><mfrac id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.cmml"><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.cmml"><mstyle displaystyle="false" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.cmml"><msubsup id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1a" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.cmml"><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.2.cmml">∑</mo><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.2.cmml">t</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.1.cmml">=</mo><mn id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.3.cmml">2</mn></mrow><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.3.cmml">T</mi></msubsup></mstyle><msub id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.2.cmml">λ</mi><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.cmml"><mi id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.2" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.2.cmml">T</mi><mo id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.1" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.1.cmml">−</mo><mn id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.3" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.3.cmml">1</mn></mrow></mfrac></msup></mrow></mrow><mo id="A1.E17.2.m1.4.4.1.1.1.1.3" xref="A1.E17.2.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.2.m1.4.4.1.2" xref="A1.E17.2.m1.4.4.1.2.cmml">+</mo><mrow id="A1.E17.2.m1.4.4.1.3" xref="A1.E17.2.m1.4.4.1.3.cmml"><mi id="A1.E17.2.m1.4.4.1.3.1" xref="A1.E17.2.m1.4.4.1.3.1.cmml">log</mi><mo id="A1.E17.2.m1.4.4.1.3a" lspace="0.167em" xref="A1.E17.2.m1.4.4.1.3.cmml">⁡</mo><mi id="A1.E17.2.m1.4.4.1.3.2" xref="A1.E17.2.m1.4.4.1.3.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.2.m1.4b"><apply id="A1.E17.2.m1.4.4.cmml" xref="A1.E17.2.m1.4.4"><geq id="A1.E17.2.m1.4.4.2.cmml" xref="A1.E17.2.m1.4.4.2"></geq><csymbol cd="latexml" id="A1.E17.2.m1.4.4.3.cmml" xref="A1.E17.2.m1.4.4.3">absent</csymbol><apply id="A1.E17.2.m1.4.4.1.cmml" xref="A1.E17.2.m1.4.4.1"><plus id="A1.E17.2.m1.4.4.1.2.cmml" xref="A1.E17.2.m1.4.4.1.2"></plus><apply id="A1.E17.2.m1.4.4.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1"><minus id="A1.E17.2.m1.4.4.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1"></minus><apply id="A1.E17.2.m1.4.4.1.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="A1.E17.2.m1.4.4.1.1.1.2.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1"><plus id="A1.E17.2.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.3"></plus><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1"><times id="A1.E17.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.2"></times><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3"><log id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.1"></log><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝐱</ci><list id="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"><ci id="A1.E17.2.m1.1.1.cmml" xref="A1.E17.2.m1.1.1">𝐲</ci><ci id="A1.E17.2.m1.2.2.cmml" xref="A1.E17.2.m1.2.2">𝐬</ci></list></apply></apply><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2"><times id="A1.E17.2.m1.4.4.1.1.1.1.1.2.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.2"></times><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3"><log id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.1"></log><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.3.2">𝑝</ci></apply><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1">superscript</csymbol><interval closure="open" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1"><ci id="A1.E17.2.m1.3.3.cmml" xref="A1.E17.2.m1.3.3">𝐲</ci><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.2">𝐬</ci><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.1.1.1.3">𝐱</ci></apply></interval><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3"><divide id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3"></divide><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2"><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1"><csymbol cd="ambiguous" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1">superscript</csymbol><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1"><csymbol cd="ambiguous" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1">subscript</csymbol><sum id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.2"></sum><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3"><eq id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.1"></eq><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.2">𝑡</ci><cn id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.3.cmml" type="integer" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.2.3.3">2</cn></apply></apply><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.1.3">𝑇</ci></apply><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2"><csymbol cd="ambiguous" id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2">subscript</csymbol><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.2">𝜆</ci><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3"><minus id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.1.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.1"></minus><ci id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.2.cmml" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.2">𝑇</ci><cn id="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.3.cmml" type="integer" xref="A1.E17.2.m1.4.4.1.1.1.1.1.2.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="A1.E17.2.m1.4.4.1.3.cmml" xref="A1.E17.2.m1.4.4.1.3"><log id="A1.E17.2.m1.4.4.1.3.1.cmml" xref="A1.E17.2.m1.4.4.1.3.1"></log><ci id="A1.E17.2.m1.4.4.1.3.2.cmml" xref="A1.E17.2.m1.4.4.1.3.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.2.m1.4c">\displaystyle\geq-\left[\log p(\mathbf{x}|\mathbf{y},\mathbf{s})+\log p(%
\mathbf{y},\mathbf{s}|\mathbf{x})^{\frac{\sum_{t=2}^{T}{\lambda_{t}}}{T-1}}%
\right]+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E17.2.m1.4d">≥ - [ roman_log italic_p ( bold_x | bold_y , bold_s ) + roman_log italic_p ( bold_y , bold_s | bold_x ) start_POSTSUPERSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG end_POSTSUPERSCRIPT ] + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.17b)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17.3">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\log{(Z\cdot\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s}))}+\log Z" class="ltx_Math" display="inline" id="A1.E17.3.m1.4"><semantics id="A1.E17.3.m1.4a"><mrow id="A1.E17.3.m1.4.4" xref="A1.E17.3.m1.4.4.cmml"><mi id="A1.E17.3.m1.4.4.3" xref="A1.E17.3.m1.4.4.3.cmml"></mi><mo id="A1.E17.3.m1.4.4.2" xref="A1.E17.3.m1.4.4.2.cmml">=</mo><mrow id="A1.E17.3.m1.4.4.1" xref="A1.E17.3.m1.4.4.1.cmml"><mrow id="A1.E17.3.m1.4.4.1.1" xref="A1.E17.3.m1.4.4.1.1.cmml"><mo id="A1.E17.3.m1.4.4.1.1a" rspace="0.167em" xref="A1.E17.3.m1.4.4.1.1.cmml">−</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.2.cmml"><mi id="A1.E17.3.m1.3.3" xref="A1.E17.3.m1.3.3.cmml">log</mi><mo id="A1.E17.3.m1.4.4.1.1.1.1a" xref="A1.E17.3.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.2.cmml"><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="A1.E17.3.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.2" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.2.cmml">Z</mi><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.1.cmml">⋅</mo><mover accent="true" id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.2" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">p</mi><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">~</mo></mover></mrow><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.2" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="A1.E17.3.m1.1.1" xref="A1.E17.3.m1.1.1.cmml">𝐲</mi><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E17.3.m1.2.2" xref="A1.E17.3.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.3.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="A1.E17.3.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E17.3.m1.4.4.1.2" xref="A1.E17.3.m1.4.4.1.2.cmml">+</mo><mrow id="A1.E17.3.m1.4.4.1.3" xref="A1.E17.3.m1.4.4.1.3.cmml"><mi id="A1.E17.3.m1.4.4.1.3.1" xref="A1.E17.3.m1.4.4.1.3.1.cmml">log</mi><mo id="A1.E17.3.m1.4.4.1.3a" lspace="0.167em" xref="A1.E17.3.m1.4.4.1.3.cmml">⁡</mo><mi id="A1.E17.3.m1.4.4.1.3.2" xref="A1.E17.3.m1.4.4.1.3.2.cmml">Z</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.3.m1.4b"><apply id="A1.E17.3.m1.4.4.cmml" xref="A1.E17.3.m1.4.4"><eq id="A1.E17.3.m1.4.4.2.cmml" xref="A1.E17.3.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.E17.3.m1.4.4.3.cmml" xref="A1.E17.3.m1.4.4.3">absent</csymbol><apply id="A1.E17.3.m1.4.4.1.cmml" xref="A1.E17.3.m1.4.4.1"><plus id="A1.E17.3.m1.4.4.1.2.cmml" xref="A1.E17.3.m1.4.4.1.2"></plus><apply id="A1.E17.3.m1.4.4.1.1.cmml" xref="A1.E17.3.m1.4.4.1.1"><minus id="A1.E17.3.m1.4.4.1.1.2.cmml" xref="A1.E17.3.m1.4.4.1.1"></minus><apply id="A1.E17.3.m1.4.4.1.1.1.2.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1"><log id="A1.E17.3.m1.3.3.cmml" xref="A1.E17.3.m1.3.3"></log><apply id="A1.E17.3.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1"><times id="A1.E17.3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.2"></times><apply id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3"><ci id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.1">⋅</ci><ci id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.2">𝑍</ci><apply id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3"><ci id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.1">~</ci><ci id="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.3.3.2">𝑝</ci></apply></apply><apply id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝐱</ci><list id="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"><ci id="A1.E17.3.m1.1.1.cmml" xref="A1.E17.3.m1.1.1">𝐲</ci><ci id="A1.E17.3.m1.2.2.cmml" xref="A1.E17.3.m1.2.2">𝐬</ci></list></apply></apply></apply></apply><apply id="A1.E17.3.m1.4.4.1.3.cmml" xref="A1.E17.3.m1.4.4.1.3"><log id="A1.E17.3.m1.4.4.1.3.1.cmml" xref="A1.E17.3.m1.4.4.1.3.1"></log><ci id="A1.E17.3.m1.4.4.1.3.2.cmml" xref="A1.E17.3.m1.4.4.1.3.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.3.m1.4c">\displaystyle=-\log{(Z\cdot\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s}))}+\log Z</annotation><annotation encoding="application/x-llamapun" id="A1.E17.3.m1.4d">= - roman_log ( italic_Z ⋅ over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s ) ) + roman_log italic_Z</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.17c)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E17.4">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})" class="ltx_Math" display="inline" id="A1.E17.4.m1.3"><semantics id="A1.E17.4.m1.3a"><mrow id="A1.E17.4.m1.3.3" xref="A1.E17.4.m1.3.3.cmml"><mi id="A1.E17.4.m1.3.3.3" xref="A1.E17.4.m1.3.3.3.cmml"></mi><mo id="A1.E17.4.m1.3.3.2" xref="A1.E17.4.m1.3.3.2.cmml">=</mo><mrow id="A1.E17.4.m1.3.3.1" xref="A1.E17.4.m1.3.3.1.cmml"><mo id="A1.E17.4.m1.3.3.1a" rspace="0.167em" xref="A1.E17.4.m1.3.3.1.cmml">−</mo><mrow id="A1.E17.4.m1.3.3.1.1" xref="A1.E17.4.m1.3.3.1.1.cmml"><mrow id="A1.E17.4.m1.3.3.1.1.3" xref="A1.E17.4.m1.3.3.1.1.3.cmml"><mi id="A1.E17.4.m1.3.3.1.1.3.1" xref="A1.E17.4.m1.3.3.1.1.3.1.cmml">log</mi><mo id="A1.E17.4.m1.3.3.1.1.3a" lspace="0.167em" xref="A1.E17.4.m1.3.3.1.1.3.cmml">⁡</mo><mover accent="true" id="A1.E17.4.m1.3.3.1.1.3.2" xref="A1.E17.4.m1.3.3.1.1.3.2.cmml"><mi id="A1.E17.4.m1.3.3.1.1.3.2.2" xref="A1.E17.4.m1.3.3.1.1.3.2.2.cmml">p</mi><mo id="A1.E17.4.m1.3.3.1.1.3.2.1" xref="A1.E17.4.m1.3.3.1.1.3.2.1.cmml">~</mo></mover></mrow><mo id="A1.E17.4.m1.3.3.1.1.2" xref="A1.E17.4.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E17.4.m1.3.3.1.1.1.1" xref="A1.E17.4.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.E17.4.m1.3.3.1.1.1.1.2" stretchy="false" xref="A1.E17.4.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.4.m1.3.3.1.1.1.1.1" xref="A1.E17.4.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.E17.4.m1.3.3.1.1.1.1.1.2" xref="A1.E17.4.m1.3.3.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="A1.E17.4.m1.3.3.1.1.1.1.1.1" xref="A1.E17.4.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.E17.4.m1.3.3.1.1.1.1.1.3.2" xref="A1.E17.4.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="A1.E17.4.m1.1.1" xref="A1.E17.4.m1.1.1.cmml">𝐲</mi><mo id="A1.E17.4.m1.3.3.1.1.1.1.1.3.2.1" xref="A1.E17.4.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E17.4.m1.2.2" xref="A1.E17.4.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A1.E17.4.m1.3.3.1.1.1.1.3" stretchy="false" xref="A1.E17.4.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.4.m1.3b"><apply id="A1.E17.4.m1.3.3.cmml" xref="A1.E17.4.m1.3.3"><eq id="A1.E17.4.m1.3.3.2.cmml" xref="A1.E17.4.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.E17.4.m1.3.3.3.cmml" xref="A1.E17.4.m1.3.3.3">absent</csymbol><apply id="A1.E17.4.m1.3.3.1.cmml" xref="A1.E17.4.m1.3.3.1"><minus id="A1.E17.4.m1.3.3.1.2.cmml" xref="A1.E17.4.m1.3.3.1"></minus><apply id="A1.E17.4.m1.3.3.1.1.cmml" xref="A1.E17.4.m1.3.3.1.1"><times id="A1.E17.4.m1.3.3.1.1.2.cmml" xref="A1.E17.4.m1.3.3.1.1.2"></times><apply id="A1.E17.4.m1.3.3.1.1.3.cmml" xref="A1.E17.4.m1.3.3.1.1.3"><log id="A1.E17.4.m1.3.3.1.1.3.1.cmml" xref="A1.E17.4.m1.3.3.1.1.3.1"></log><apply id="A1.E17.4.m1.3.3.1.1.3.2.cmml" xref="A1.E17.4.m1.3.3.1.1.3.2"><ci id="A1.E17.4.m1.3.3.1.1.3.2.1.cmml" xref="A1.E17.4.m1.3.3.1.1.3.2.1">~</ci><ci id="A1.E17.4.m1.3.3.1.1.3.2.2.cmml" xref="A1.E17.4.m1.3.3.1.1.3.2.2">𝑝</ci></apply></apply><apply id="A1.E17.4.m1.3.3.1.1.1.1.1.cmml" xref="A1.E17.4.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E17.4.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E17.4.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E17.4.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E17.4.m1.3.3.1.1.1.1.1.2">𝐱</ci><list id="A1.E17.4.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E17.4.m1.3.3.1.1.1.1.1.3.2"><ci id="A1.E17.4.m1.1.1.cmml" xref="A1.E17.4.m1.1.1">𝐲</ci><ci id="A1.E17.4.m1.2.2.cmml" xref="A1.E17.4.m1.2.2">𝐬</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.4.m1.3c">\displaystyle=-\log\tilde{p}(\mathbf{x}|\mathbf{y},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A1.E17.4.m1.3d">= - roman_log over~ start_ARG italic_p end_ARG ( bold_x | bold_y , bold_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.17d)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A1.3.p1.27">where Equality (A.17c) is obtained by applying Lemma A.1. This completes the proof.
∎</p>
</div>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Appendix B</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this section, we show the derivations of the following equations:</p>
</div>
<div class="ltx_para" id="A2.p2">
<table class="ltx_equation ltx_eqn_table" id="A2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_%
{t},t,\mathbf{y},\mathbf{s})-\frac{\mathbf{x}_{t}}{\sqrt{\bar{\alpha}_{t}}}\right)" class="ltx_Math" display="block" id="A2.E18.m1.7"><semantics id="A2.E18.m1.7a"><mrow id="A2.E18.m1.7.7" xref="A2.E18.m1.7.7.cmml"><mrow id="A2.E18.m1.6.6.1" xref="A2.E18.m1.6.6.1.cmml"><mrow id="A2.E18.m1.6.6.1.3" xref="A2.E18.m1.6.6.1.3.cmml"><mrow id="A2.E18.m1.6.6.1.3.1" xref="A2.E18.m1.6.6.1.3.1.cmml"><mo id="A2.E18.m1.6.6.1.3.1.1" rspace="0.167em" xref="A2.E18.m1.6.6.1.3.1.1.cmml">∇</mo><mi id="A2.E18.m1.6.6.1.3.1.2" xref="A2.E18.m1.6.6.1.3.1.2.cmml">log</mi></mrow><mo id="A2.E18.m1.6.6.1.3a" lspace="0.167em" xref="A2.E18.m1.6.6.1.3.cmml">⁡</mo><mi id="A2.E18.m1.6.6.1.3.2" xref="A2.E18.m1.6.6.1.3.2.cmml">p</mi></mrow><mo id="A2.E18.m1.6.6.1.2" xref="A2.E18.m1.6.6.1.2.cmml">⁢</mo><mrow id="A2.E18.m1.6.6.1.1.1" xref="A2.E18.m1.6.6.1.1.1.1.cmml"><mo id="A2.E18.m1.6.6.1.1.1.2" stretchy="false" xref="A2.E18.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A2.E18.m1.6.6.1.1.1.1" xref="A2.E18.m1.6.6.1.1.1.1.cmml"><msub id="A2.E18.m1.6.6.1.1.1.1.2" xref="A2.E18.m1.6.6.1.1.1.1.2.cmml"><mi id="A2.E18.m1.6.6.1.1.1.1.2.2" xref="A2.E18.m1.6.6.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A2.E18.m1.6.6.1.1.1.1.2.3" xref="A2.E18.m1.6.6.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A2.E18.m1.6.6.1.1.1.1.1" xref="A2.E18.m1.6.6.1.1.1.1.1.cmml">|</mo><mrow id="A2.E18.m1.6.6.1.1.1.1.3.2" xref="A2.E18.m1.6.6.1.1.1.1.3.1.cmml"><mi id="A2.E18.m1.1.1" xref="A2.E18.m1.1.1.cmml">𝐲</mi><mo id="A2.E18.m1.6.6.1.1.1.1.3.2.1" xref="A2.E18.m1.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="A2.E18.m1.2.2" xref="A2.E18.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A2.E18.m1.6.6.1.1.1.3" stretchy="false" xref="A2.E18.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E18.m1.7.7.3" xref="A2.E18.m1.7.7.3.cmml">=</mo><mrow id="A2.E18.m1.7.7.2" xref="A2.E18.m1.7.7.2.cmml"><mfrac id="A2.E18.m1.7.7.2.3" xref="A2.E18.m1.7.7.2.3.cmml"><msqrt id="A2.E18.m1.7.7.2.3.2" xref="A2.E18.m1.7.7.2.3.2.cmml"><msub id="A2.E18.m1.7.7.2.3.2.2" xref="A2.E18.m1.7.7.2.3.2.2.cmml"><mover accent="true" id="A2.E18.m1.7.7.2.3.2.2.2" xref="A2.E18.m1.7.7.2.3.2.2.2.cmml"><mi id="A2.E18.m1.7.7.2.3.2.2.2.2" xref="A2.E18.m1.7.7.2.3.2.2.2.2.cmml">α</mi><mo id="A2.E18.m1.7.7.2.3.2.2.2.1" xref="A2.E18.m1.7.7.2.3.2.2.2.1.cmml">¯</mo></mover><mi id="A2.E18.m1.7.7.2.3.2.2.3" xref="A2.E18.m1.7.7.2.3.2.2.3.cmml">t</mi></msub></msqrt><msqrt id="A2.E18.m1.7.7.2.3.3" xref="A2.E18.m1.7.7.2.3.3.cmml"><mrow id="A2.E18.m1.7.7.2.3.3.2" xref="A2.E18.m1.7.7.2.3.3.2.cmml"><mn id="A2.E18.m1.7.7.2.3.3.2.2" xref="A2.E18.m1.7.7.2.3.3.2.2.cmml">1</mn><mo id="A2.E18.m1.7.7.2.3.3.2.1" xref="A2.E18.m1.7.7.2.3.3.2.1.cmml">−</mo><msub id="A2.E18.m1.7.7.2.3.3.2.3" xref="A2.E18.m1.7.7.2.3.3.2.3.cmml"><mover accent="true" id="A2.E18.m1.7.7.2.3.3.2.3.2" xref="A2.E18.m1.7.7.2.3.3.2.3.2.cmml"><mi id="A2.E18.m1.7.7.2.3.3.2.3.2.2" xref="A2.E18.m1.7.7.2.3.3.2.3.2.2.cmml">α</mi><mo id="A2.E18.m1.7.7.2.3.3.2.3.2.1" xref="A2.E18.m1.7.7.2.3.3.2.3.2.1.cmml">¯</mo></mover><mi id="A2.E18.m1.7.7.2.3.3.2.3.3" xref="A2.E18.m1.7.7.2.3.3.2.3.3.cmml">t</mi></msub></mrow></msqrt></mfrac><mo id="A2.E18.m1.7.7.2.2" xref="A2.E18.m1.7.7.2.2.cmml">⁢</mo><mrow id="A2.E18.m1.7.7.2.1.1" xref="A2.E18.m1.7.7.2.1.1.1.cmml"><mo id="A2.E18.m1.7.7.2.1.1.2" xref="A2.E18.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="A2.E18.m1.7.7.2.1.1.1" xref="A2.E18.m1.7.7.2.1.1.1.cmml"><mrow id="A2.E18.m1.7.7.2.1.1.1.1" xref="A2.E18.m1.7.7.2.1.1.1.1.cmml"><msub id="A2.E18.m1.7.7.2.1.1.1.1.3" xref="A2.E18.m1.7.7.2.1.1.1.1.3.cmml"><mover accent="true" id="A2.E18.m1.7.7.2.1.1.1.1.3.2" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2.cmml"><mi id="A2.E18.m1.7.7.2.1.1.1.1.3.2.2" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2.2.cmml">𝐱</mi><mo id="A2.E18.m1.7.7.2.1.1.1.1.3.2.1" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="A2.E18.m1.7.7.2.1.1.1.1.3.3" xref="A2.E18.m1.7.7.2.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="A2.E18.m1.7.7.2.1.1.1.1.2" xref="A2.E18.m1.7.7.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A2.E18.m1.7.7.2.1.1.1.1.1.1" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml"><mo id="A2.E18.m1.7.7.2.1.1.1.1.1.1.2" stretchy="false" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml">(</mo><msub id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mi id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.2" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.3" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A2.E18.m1.7.7.2.1.1.1.1.1.1.3" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="A2.E18.m1.3.3" xref="A2.E18.m1.3.3.cmml">t</mi><mo id="A2.E18.m1.7.7.2.1.1.1.1.1.1.4" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="A2.E18.m1.4.4" xref="A2.E18.m1.4.4.cmml">𝐲</mi><mo id="A2.E18.m1.7.7.2.1.1.1.1.1.1.5" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml">,</mo><mi id="A2.E18.m1.5.5" xref="A2.E18.m1.5.5.cmml">𝐬</mi><mo id="A2.E18.m1.7.7.2.1.1.1.1.1.1.6" stretchy="false" xref="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E18.m1.7.7.2.1.1.1.2" xref="A2.E18.m1.7.7.2.1.1.1.2.cmml">−</mo><mfrac id="A2.E18.m1.7.7.2.1.1.1.3" xref="A2.E18.m1.7.7.2.1.1.1.3.cmml"><msub id="A2.E18.m1.7.7.2.1.1.1.3.2" xref="A2.E18.m1.7.7.2.1.1.1.3.2.cmml"><mi id="A2.E18.m1.7.7.2.1.1.1.3.2.2" xref="A2.E18.m1.7.7.2.1.1.1.3.2.2.cmml">𝐱</mi><mi id="A2.E18.m1.7.7.2.1.1.1.3.2.3" xref="A2.E18.m1.7.7.2.1.1.1.3.2.3.cmml">t</mi></msub><msqrt id="A2.E18.m1.7.7.2.1.1.1.3.3" xref="A2.E18.m1.7.7.2.1.1.1.3.3.cmml"><msub id="A2.E18.m1.7.7.2.1.1.1.3.3.2" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.cmml"><mover accent="true" id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.cmml"><mi id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.2" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.2.cmml">α</mi><mo id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.1" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.1.cmml">¯</mo></mover><mi id="A2.E18.m1.7.7.2.1.1.1.3.3.2.3" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.3.cmml">t</mi></msub></msqrt></mfrac></mrow><mo id="A2.E18.m1.7.7.2.1.1.3" xref="A2.E18.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E18.m1.7b"><apply id="A2.E18.m1.7.7.cmml" xref="A2.E18.m1.7.7"><eq id="A2.E18.m1.7.7.3.cmml" xref="A2.E18.m1.7.7.3"></eq><apply id="A2.E18.m1.6.6.1.cmml" xref="A2.E18.m1.6.6.1"><times id="A2.E18.m1.6.6.1.2.cmml" xref="A2.E18.m1.6.6.1.2"></times><apply id="A2.E18.m1.6.6.1.3.cmml" xref="A2.E18.m1.6.6.1.3"><apply id="A2.E18.m1.6.6.1.3.1.cmml" xref="A2.E18.m1.6.6.1.3.1"><ci id="A2.E18.m1.6.6.1.3.1.1.cmml" xref="A2.E18.m1.6.6.1.3.1.1">∇</ci><log id="A2.E18.m1.6.6.1.3.1.2.cmml" xref="A2.E18.m1.6.6.1.3.1.2"></log></apply><ci id="A2.E18.m1.6.6.1.3.2.cmml" xref="A2.E18.m1.6.6.1.3.2">𝑝</ci></apply><apply id="A2.E18.m1.6.6.1.1.1.1.cmml" xref="A2.E18.m1.6.6.1.1.1"><csymbol cd="latexml" id="A2.E18.m1.6.6.1.1.1.1.1.cmml" xref="A2.E18.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="A2.E18.m1.6.6.1.1.1.1.2.cmml" xref="A2.E18.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.6.6.1.1.1.1.2.1.cmml" xref="A2.E18.m1.6.6.1.1.1.1.2">subscript</csymbol><ci id="A2.E18.m1.6.6.1.1.1.1.2.2.cmml" xref="A2.E18.m1.6.6.1.1.1.1.2.2">𝐱</ci><ci id="A2.E18.m1.6.6.1.1.1.1.2.3.cmml" xref="A2.E18.m1.6.6.1.1.1.1.2.3">𝑡</ci></apply><list id="A2.E18.m1.6.6.1.1.1.1.3.1.cmml" xref="A2.E18.m1.6.6.1.1.1.1.3.2"><ci id="A2.E18.m1.1.1.cmml" xref="A2.E18.m1.1.1">𝐲</ci><ci id="A2.E18.m1.2.2.cmml" xref="A2.E18.m1.2.2">𝐬</ci></list></apply></apply><apply id="A2.E18.m1.7.7.2.cmml" xref="A2.E18.m1.7.7.2"><times id="A2.E18.m1.7.7.2.2.cmml" xref="A2.E18.m1.7.7.2.2"></times><apply id="A2.E18.m1.7.7.2.3.cmml" xref="A2.E18.m1.7.7.2.3"><divide id="A2.E18.m1.7.7.2.3.1.cmml" xref="A2.E18.m1.7.7.2.3"></divide><apply id="A2.E18.m1.7.7.2.3.2.cmml" xref="A2.E18.m1.7.7.2.3.2"><root id="A2.E18.m1.7.7.2.3.2a.cmml" xref="A2.E18.m1.7.7.2.3.2"></root><apply id="A2.E18.m1.7.7.2.3.2.2.cmml" xref="A2.E18.m1.7.7.2.3.2.2"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.3.2.2.1.cmml" xref="A2.E18.m1.7.7.2.3.2.2">subscript</csymbol><apply id="A2.E18.m1.7.7.2.3.2.2.2.cmml" xref="A2.E18.m1.7.7.2.3.2.2.2"><ci id="A2.E18.m1.7.7.2.3.2.2.2.1.cmml" xref="A2.E18.m1.7.7.2.3.2.2.2.1">¯</ci><ci id="A2.E18.m1.7.7.2.3.2.2.2.2.cmml" xref="A2.E18.m1.7.7.2.3.2.2.2.2">𝛼</ci></apply><ci id="A2.E18.m1.7.7.2.3.2.2.3.cmml" xref="A2.E18.m1.7.7.2.3.2.2.3">𝑡</ci></apply></apply><apply id="A2.E18.m1.7.7.2.3.3.cmml" xref="A2.E18.m1.7.7.2.3.3"><root id="A2.E18.m1.7.7.2.3.3a.cmml" xref="A2.E18.m1.7.7.2.3.3"></root><apply id="A2.E18.m1.7.7.2.3.3.2.cmml" xref="A2.E18.m1.7.7.2.3.3.2"><minus id="A2.E18.m1.7.7.2.3.3.2.1.cmml" xref="A2.E18.m1.7.7.2.3.3.2.1"></minus><cn id="A2.E18.m1.7.7.2.3.3.2.2.cmml" type="integer" xref="A2.E18.m1.7.7.2.3.3.2.2">1</cn><apply id="A2.E18.m1.7.7.2.3.3.2.3.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.3.3.2.3.1.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3">subscript</csymbol><apply id="A2.E18.m1.7.7.2.3.3.2.3.2.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3.2"><ci id="A2.E18.m1.7.7.2.3.3.2.3.2.1.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3.2.1">¯</ci><ci id="A2.E18.m1.7.7.2.3.3.2.3.2.2.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3.2.2">𝛼</ci></apply><ci id="A2.E18.m1.7.7.2.3.3.2.3.3.cmml" xref="A2.E18.m1.7.7.2.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="A2.E18.m1.7.7.2.1.1.1.cmml" xref="A2.E18.m1.7.7.2.1.1"><minus id="A2.E18.m1.7.7.2.1.1.1.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.2"></minus><apply id="A2.E18.m1.7.7.2.1.1.1.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1"><times id="A2.E18.m1.7.7.2.1.1.1.1.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.2"></times><apply id="A2.E18.m1.7.7.2.1.1.1.1.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.1.1.1.1.3.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3">subscript</csymbol><apply id="A2.E18.m1.7.7.2.1.1.1.1.3.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2"><ci id="A2.E18.m1.7.7.2.1.1.1.1.3.2.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2.1">^</ci><ci id="A2.E18.m1.7.7.2.1.1.1.1.3.2.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3.2.2">𝐱</ci></apply><ci id="A2.E18.m1.7.7.2.1.1.1.1.3.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.3.3">𝜽</ci></apply><vector id="A2.E18.m1.7.7.2.1.1.1.1.1.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1"><apply id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="A2.E18.m1.3.3.cmml" xref="A2.E18.m1.3.3">𝑡</ci><ci id="A2.E18.m1.4.4.cmml" xref="A2.E18.m1.4.4">𝐲</ci><ci id="A2.E18.m1.5.5.cmml" xref="A2.E18.m1.5.5">𝐬</ci></vector></apply><apply id="A2.E18.m1.7.7.2.1.1.1.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3"><divide id="A2.E18.m1.7.7.2.1.1.1.3.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3"></divide><apply id="A2.E18.m1.7.7.2.1.1.1.3.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.1.1.1.3.2.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.2">subscript</csymbol><ci id="A2.E18.m1.7.7.2.1.1.1.3.2.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.2.2">𝐱</ci><ci id="A2.E18.m1.7.7.2.1.1.1.3.2.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.2.3">𝑡</ci></apply><apply id="A2.E18.m1.7.7.2.1.1.1.3.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3"><root id="A2.E18.m1.7.7.2.1.1.1.3.3a.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3"></root><apply id="A2.E18.m1.7.7.2.1.1.1.3.3.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.E18.m1.7.7.2.1.1.1.3.3.2.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2">subscript</csymbol><apply id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2"><ci id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.1.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.1">¯</ci><ci id="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.2.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.2.2">𝛼</ci></apply><ci id="A2.E18.m1.7.7.2.1.1.1.3.3.2.3.cmml" xref="A2.E18.m1.7.7.2.1.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m1.7c">\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_%
{t},t,\mathbf{y},\mathbf{s})-\frac{\mathbf{x}_{t}}{\sqrt{\bar{\alpha}_{t}}}\right)</annotation><annotation encoding="application/x-llamapun" id="A2.E18.m1.7d">∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) = divide start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG start_ARG square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG ( over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , bold_y , bold_s ) - divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A2.p3">
<table class="ltx_equation ltx_eqn_table" id="A2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})=\kappa_{\mathbf{x}_{t}}%
\mathbf{y}^{T}{\nabla f_{\bm{\phi}}(\mathbf{x}_{t})}" class="ltx_Math" display="block" id="A2.E19.m1.3"><semantics id="A2.E19.m1.3a"><mrow id="A2.E19.m1.3.3" xref="A2.E19.m1.3.3.cmml"><mrow id="A2.E19.m1.2.2.1" xref="A2.E19.m1.2.2.1.cmml"><mrow id="A2.E19.m1.2.2.1.3" xref="A2.E19.m1.2.2.1.3.cmml"><mrow id="A2.E19.m1.2.2.1.3.1" xref="A2.E19.m1.2.2.1.3.1.cmml"><mo id="A2.E19.m1.2.2.1.3.1.1" rspace="0.167em" xref="A2.E19.m1.2.2.1.3.1.1.cmml">∇</mo><mi id="A2.E19.m1.2.2.1.3.1.2" xref="A2.E19.m1.2.2.1.3.1.2.cmml">log</mi></mrow><mo id="A2.E19.m1.2.2.1.3a" lspace="0.167em" xref="A2.E19.m1.2.2.1.3.cmml">⁡</mo><mi id="A2.E19.m1.2.2.1.3.2" xref="A2.E19.m1.2.2.1.3.2.cmml">p</mi></mrow><mo id="A2.E19.m1.2.2.1.2" xref="A2.E19.m1.2.2.1.2.cmml">⁢</mo><mrow id="A2.E19.m1.2.2.1.1.1" xref="A2.E19.m1.2.2.1.1.2.cmml"><mo id="A2.E19.m1.2.2.1.1.1.2" stretchy="false" xref="A2.E19.m1.2.2.1.1.2.cmml">(</mo><mi id="A2.E19.m1.1.1" xref="A2.E19.m1.1.1.cmml">𝐲</mi><mo id="A2.E19.m1.2.2.1.1.1.3" xref="A2.E19.m1.2.2.1.1.2.cmml">,</mo><mrow id="A2.E19.m1.2.2.1.1.1.1" xref="A2.E19.m1.2.2.1.1.1.1.cmml"><mi id="A2.E19.m1.2.2.1.1.1.1.2" xref="A2.E19.m1.2.2.1.1.1.1.2.cmml">𝐬</mi><mo fence="false" id="A2.E19.m1.2.2.1.1.1.1.1" xref="A2.E19.m1.2.2.1.1.1.1.1.cmml">|</mo><msub id="A2.E19.m1.2.2.1.1.1.1.3" xref="A2.E19.m1.2.2.1.1.1.1.3.cmml"><mi id="A2.E19.m1.2.2.1.1.1.1.3.2" xref="A2.E19.m1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mi id="A2.E19.m1.2.2.1.1.1.1.3.3" xref="A2.E19.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A2.E19.m1.2.2.1.1.1.4" stretchy="false" xref="A2.E19.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A2.E19.m1.3.3.3" xref="A2.E19.m1.3.3.3.cmml">=</mo><mrow id="A2.E19.m1.3.3.2" xref="A2.E19.m1.3.3.2.cmml"><msub id="A2.E19.m1.3.3.2.3" xref="A2.E19.m1.3.3.2.3.cmml"><mi id="A2.E19.m1.3.3.2.3.2" xref="A2.E19.m1.3.3.2.3.2.cmml">κ</mi><msub id="A2.E19.m1.3.3.2.3.3" xref="A2.E19.m1.3.3.2.3.3.cmml"><mi id="A2.E19.m1.3.3.2.3.3.2" xref="A2.E19.m1.3.3.2.3.3.2.cmml">𝐱</mi><mi id="A2.E19.m1.3.3.2.3.3.3" xref="A2.E19.m1.3.3.2.3.3.3.cmml">t</mi></msub></msub><mo id="A2.E19.m1.3.3.2.2" xref="A2.E19.m1.3.3.2.2.cmml">⁢</mo><msup id="A2.E19.m1.3.3.2.4" xref="A2.E19.m1.3.3.2.4.cmml"><mi id="A2.E19.m1.3.3.2.4.2" xref="A2.E19.m1.3.3.2.4.2.cmml">𝐲</mi><mi id="A2.E19.m1.3.3.2.4.3" xref="A2.E19.m1.3.3.2.4.3.cmml">T</mi></msup><mo id="A2.E19.m1.3.3.2.2a" lspace="0.167em" xref="A2.E19.m1.3.3.2.2.cmml">⁢</mo><mrow id="A2.E19.m1.3.3.2.5" xref="A2.E19.m1.3.3.2.5.cmml"><mo id="A2.E19.m1.3.3.2.5.1" rspace="0.167em" xref="A2.E19.m1.3.3.2.5.1.cmml">∇</mo><msub id="A2.E19.m1.3.3.2.5.2" xref="A2.E19.m1.3.3.2.5.2.cmml"><mi id="A2.E19.m1.3.3.2.5.2.2" xref="A2.E19.m1.3.3.2.5.2.2.cmml">f</mi><mi class="ltx_mathvariant_bold-italic" id="A2.E19.m1.3.3.2.5.2.3" mathvariant="bold-italic" xref="A2.E19.m1.3.3.2.5.2.3.cmml">ϕ</mi></msub></mrow><mo id="A2.E19.m1.3.3.2.2b" xref="A2.E19.m1.3.3.2.2.cmml">⁢</mo><mrow id="A2.E19.m1.3.3.2.1.1" xref="A2.E19.m1.3.3.2.1.1.1.cmml"><mo id="A2.E19.m1.3.3.2.1.1.2" stretchy="false" xref="A2.E19.m1.3.3.2.1.1.1.cmml">(</mo><msub id="A2.E19.m1.3.3.2.1.1.1" xref="A2.E19.m1.3.3.2.1.1.1.cmml"><mi id="A2.E19.m1.3.3.2.1.1.1.2" xref="A2.E19.m1.3.3.2.1.1.1.2.cmml">𝐱</mi><mi id="A2.E19.m1.3.3.2.1.1.1.3" xref="A2.E19.m1.3.3.2.1.1.1.3.cmml">t</mi></msub><mo id="A2.E19.m1.3.3.2.1.1.3" stretchy="false" xref="A2.E19.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E19.m1.3b"><apply id="A2.E19.m1.3.3.cmml" xref="A2.E19.m1.3.3"><eq id="A2.E19.m1.3.3.3.cmml" xref="A2.E19.m1.3.3.3"></eq><apply id="A2.E19.m1.2.2.1.cmml" xref="A2.E19.m1.2.2.1"><times id="A2.E19.m1.2.2.1.2.cmml" xref="A2.E19.m1.2.2.1.2"></times><apply id="A2.E19.m1.2.2.1.3.cmml" xref="A2.E19.m1.2.2.1.3"><apply id="A2.E19.m1.2.2.1.3.1.cmml" xref="A2.E19.m1.2.2.1.3.1"><ci id="A2.E19.m1.2.2.1.3.1.1.cmml" xref="A2.E19.m1.2.2.1.3.1.1">∇</ci><log id="A2.E19.m1.2.2.1.3.1.2.cmml" xref="A2.E19.m1.2.2.1.3.1.2"></log></apply><ci id="A2.E19.m1.2.2.1.3.2.cmml" xref="A2.E19.m1.2.2.1.3.2">𝑝</ci></apply><interval closure="open" id="A2.E19.m1.2.2.1.1.2.cmml" xref="A2.E19.m1.2.2.1.1.1"><ci id="A2.E19.m1.1.1.cmml" xref="A2.E19.m1.1.1">𝐲</ci><apply id="A2.E19.m1.2.2.1.1.1.1.cmml" xref="A2.E19.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.2.2.1.1.1.1.1.cmml" xref="A2.E19.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="A2.E19.m1.2.2.1.1.1.1.2.cmml" xref="A2.E19.m1.2.2.1.1.1.1.2">𝐬</ci><apply id="A2.E19.m1.2.2.1.1.1.1.3.cmml" xref="A2.E19.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.1.1.1.1.3.1.cmml" xref="A2.E19.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A2.E19.m1.2.2.1.1.1.1.3.2.cmml" xref="A2.E19.m1.2.2.1.1.1.1.3.2">𝐱</ci><ci id="A2.E19.m1.2.2.1.1.1.1.3.3.cmml" xref="A2.E19.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply><apply id="A2.E19.m1.3.3.2.cmml" xref="A2.E19.m1.3.3.2"><times id="A2.E19.m1.3.3.2.2.cmml" xref="A2.E19.m1.3.3.2.2"></times><apply id="A2.E19.m1.3.3.2.3.cmml" xref="A2.E19.m1.3.3.2.3"><csymbol cd="ambiguous" id="A2.E19.m1.3.3.2.3.1.cmml" xref="A2.E19.m1.3.3.2.3">subscript</csymbol><ci id="A2.E19.m1.3.3.2.3.2.cmml" xref="A2.E19.m1.3.3.2.3.2">𝜅</ci><apply id="A2.E19.m1.3.3.2.3.3.cmml" xref="A2.E19.m1.3.3.2.3.3"><csymbol cd="ambiguous" id="A2.E19.m1.3.3.2.3.3.1.cmml" xref="A2.E19.m1.3.3.2.3.3">subscript</csymbol><ci id="A2.E19.m1.3.3.2.3.3.2.cmml" xref="A2.E19.m1.3.3.2.3.3.2">𝐱</ci><ci id="A2.E19.m1.3.3.2.3.3.3.cmml" xref="A2.E19.m1.3.3.2.3.3.3">𝑡</ci></apply></apply><apply id="A2.E19.m1.3.3.2.4.cmml" xref="A2.E19.m1.3.3.2.4"><csymbol cd="ambiguous" id="A2.E19.m1.3.3.2.4.1.cmml" xref="A2.E19.m1.3.3.2.4">superscript</csymbol><ci id="A2.E19.m1.3.3.2.4.2.cmml" xref="A2.E19.m1.3.3.2.4.2">𝐲</ci><ci id="A2.E19.m1.3.3.2.4.3.cmml" xref="A2.E19.m1.3.3.2.4.3">𝑇</ci></apply><apply id="A2.E19.m1.3.3.2.5.cmml" xref="A2.E19.m1.3.3.2.5"><ci id="A2.E19.m1.3.3.2.5.1.cmml" xref="A2.E19.m1.3.3.2.5.1">∇</ci><apply id="A2.E19.m1.3.3.2.5.2.cmml" xref="A2.E19.m1.3.3.2.5.2"><csymbol cd="ambiguous" id="A2.E19.m1.3.3.2.5.2.1.cmml" xref="A2.E19.m1.3.3.2.5.2">subscript</csymbol><ci id="A2.E19.m1.3.3.2.5.2.2.cmml" xref="A2.E19.m1.3.3.2.5.2.2">𝑓</ci><ci id="A2.E19.m1.3.3.2.5.2.3.cmml" xref="A2.E19.m1.3.3.2.5.2.3">bold-italic-ϕ</ci></apply></apply><apply id="A2.E19.m1.3.3.2.1.1.1.cmml" xref="A2.E19.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.3.3.2.1.1.1.1.cmml" xref="A2.E19.m1.3.3.2.1.1">subscript</csymbol><ci id="A2.E19.m1.3.3.2.1.1.1.2.cmml" xref="A2.E19.m1.3.3.2.1.1.1.2">𝐱</ci><ci id="A2.E19.m1.3.3.2.1.1.1.3.cmml" xref="A2.E19.m1.3.3.2.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m1.3c">\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})=\kappa_{\mathbf{x}_{t}}%
\mathbf{y}^{T}{\nabla f_{\bm{\phi}}(\mathbf{x}_{t})}</annotation><annotation encoding="application/x-llamapun" id="A2.E19.m1.3d">∇ roman_log italic_p ( bold_y , bold_s | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_κ start_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∇ italic_f start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.4">Recall that in the main text, we showed that the adjusted likelihood score is a summation of the original likelihood score and the scaled reversed likelihood score:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underbrace{\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})}_{\text{%
adjusted likelihood score}}=\underbrace{\nabla\log p(\mathbf{x}_{t}|\mathbf{y}%
,\mathbf{s})}_{\text{original likelihood score}}+\frac{\sum_{t=2}^{T}{\lambda_%
{t}}}{T-1}\underbrace{\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})}_{%
\text{reversed likelihood score}}" class="ltx_Math" display="block" id="A2.E20.m1.8"><semantics id="A2.E20.m1.8a"><mrow id="A2.E20.m1.8.9" xref="A2.E20.m1.8.9.cmml"><munder id="A2.E20.m1.8.9.2" xref="A2.E20.m1.8.9.2.cmml"><munder accentunder="true" id="A2.E20.m1.3.3" xref="A2.E20.m1.3.3.cmml"><mrow id="A2.E20.m1.3.3.3" xref="A2.E20.m1.3.3.3.cmml"><mrow id="A2.E20.m1.3.3.3.5" xref="A2.E20.m1.3.3.3.5.cmml"><mrow id="A2.E20.m1.3.3.3.5.1" xref="A2.E20.m1.3.3.3.5.1.cmml"><mo id="A2.E20.m1.3.3.3.5.1.1" rspace="0.167em" xref="A2.E20.m1.3.3.3.5.1.1.cmml">∇</mo><mi id="A2.E20.m1.3.3.3.5.1.2" xref="A2.E20.m1.3.3.3.5.1.2.cmml">log</mi></mrow><mo id="A2.E20.m1.3.3.3.5a" lspace="0.167em" xref="A2.E20.m1.3.3.3.5.cmml">⁡</mo><mover accent="true" id="A2.E20.m1.3.3.3.5.2" xref="A2.E20.m1.3.3.3.5.2.cmml"><mi id="A2.E20.m1.3.3.3.5.2.2" xref="A2.E20.m1.3.3.3.5.2.2.cmml">p</mi><mo id="A2.E20.m1.3.3.3.5.2.1" xref="A2.E20.m1.3.3.3.5.2.1.cmml">~</mo></mover></mrow><mo id="A2.E20.m1.3.3.3.4" xref="A2.E20.m1.3.3.3.4.cmml">⁢</mo><mrow id="A2.E20.m1.3.3.3.3.1" xref="A2.E20.m1.3.3.3.3.1.1.cmml"><mo id="A2.E20.m1.3.3.3.3.1.2" stretchy="false" xref="A2.E20.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="A2.E20.m1.3.3.3.3.1.1" xref="A2.E20.m1.3.3.3.3.1.1.cmml"><msub id="A2.E20.m1.3.3.3.3.1.1.2" xref="A2.E20.m1.3.3.3.3.1.1.2.cmml"><mi id="A2.E20.m1.3.3.3.3.1.1.2.2" xref="A2.E20.m1.3.3.3.3.1.1.2.2.cmml">𝐱</mi><mi id="A2.E20.m1.3.3.3.3.1.1.2.3" xref="A2.E20.m1.3.3.3.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A2.E20.m1.3.3.3.3.1.1.1" xref="A2.E20.m1.3.3.3.3.1.1.1.cmml">|</mo><mrow id="A2.E20.m1.3.3.3.3.1.1.3.2" xref="A2.E20.m1.3.3.3.3.1.1.3.1.cmml"><mi id="A2.E20.m1.1.1.1.1" xref="A2.E20.m1.1.1.1.1.cmml">𝐲</mi><mo id="A2.E20.m1.3.3.3.3.1.1.3.2.1" xref="A2.E20.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="A2.E20.m1.2.2.2.2" xref="A2.E20.m1.2.2.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A2.E20.m1.3.3.3.3.1.3" stretchy="false" xref="A2.E20.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E20.m1.3.3.4" xref="A2.E20.m1.3.3.4.cmml">⏟</mo></munder><mtext id="A2.E20.m1.8.9.2.2" xref="A2.E20.m1.8.9.2.2a.cmml">adjusted likelihood score</mtext></munder><mo id="A2.E20.m1.8.9.1" xref="A2.E20.m1.8.9.1.cmml">=</mo><mrow id="A2.E20.m1.8.9.3" xref="A2.E20.m1.8.9.3.cmml"><munder id="A2.E20.m1.8.9.3.2" xref="A2.E20.m1.8.9.3.2.cmml"><munder accentunder="true" id="A2.E20.m1.6.6" xref="A2.E20.m1.6.6.cmml"><mrow id="A2.E20.m1.6.6.3" xref="A2.E20.m1.6.6.3.cmml"><mrow id="A2.E20.m1.6.6.3.5" xref="A2.E20.m1.6.6.3.5.cmml"><mrow id="A2.E20.m1.6.6.3.5.1" xref="A2.E20.m1.6.6.3.5.1.cmml"><mo id="A2.E20.m1.6.6.3.5.1.1" rspace="0.167em" xref="A2.E20.m1.6.6.3.5.1.1.cmml">∇</mo><mi id="A2.E20.m1.6.6.3.5.1.2" xref="A2.E20.m1.6.6.3.5.1.2.cmml">log</mi></mrow><mo id="A2.E20.m1.6.6.3.5a" lspace="0.167em" xref="A2.E20.m1.6.6.3.5.cmml">⁡</mo><mi id="A2.E20.m1.6.6.3.5.2" xref="A2.E20.m1.6.6.3.5.2.cmml">p</mi></mrow><mo id="A2.E20.m1.6.6.3.4" xref="A2.E20.m1.6.6.3.4.cmml">⁢</mo><mrow id="A2.E20.m1.6.6.3.3.1" xref="A2.E20.m1.6.6.3.3.1.1.cmml"><mo id="A2.E20.m1.6.6.3.3.1.2" stretchy="false" xref="A2.E20.m1.6.6.3.3.1.1.cmml">(</mo><mrow id="A2.E20.m1.6.6.3.3.1.1" xref="A2.E20.m1.6.6.3.3.1.1.cmml"><msub id="A2.E20.m1.6.6.3.3.1.1.2" xref="A2.E20.m1.6.6.3.3.1.1.2.cmml"><mi id="A2.E20.m1.6.6.3.3.1.1.2.2" xref="A2.E20.m1.6.6.3.3.1.1.2.2.cmml">𝐱</mi><mi id="A2.E20.m1.6.6.3.3.1.1.2.3" xref="A2.E20.m1.6.6.3.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A2.E20.m1.6.6.3.3.1.1.1" xref="A2.E20.m1.6.6.3.3.1.1.1.cmml">|</mo><mrow id="A2.E20.m1.6.6.3.3.1.1.3.2" xref="A2.E20.m1.6.6.3.3.1.1.3.1.cmml"><mi id="A2.E20.m1.4.4.1.1" xref="A2.E20.m1.4.4.1.1.cmml">𝐲</mi><mo id="A2.E20.m1.6.6.3.3.1.1.3.2.1" xref="A2.E20.m1.6.6.3.3.1.1.3.1.cmml">,</mo><mi id="A2.E20.m1.5.5.2.2" xref="A2.E20.m1.5.5.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A2.E20.m1.6.6.3.3.1.3" stretchy="false" xref="A2.E20.m1.6.6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E20.m1.6.6.4" xref="A2.E20.m1.6.6.4.cmml">⏟</mo></munder><mtext id="A2.E20.m1.8.9.3.2.2" xref="A2.E20.m1.8.9.3.2.2a.cmml">original likelihood score</mtext></munder><mo id="A2.E20.m1.8.9.3.1" xref="A2.E20.m1.8.9.3.1.cmml">+</mo><mrow id="A2.E20.m1.8.9.3.3" xref="A2.E20.m1.8.9.3.3.cmml"><mfrac id="A2.E20.m1.8.9.3.3.2" xref="A2.E20.m1.8.9.3.3.2.cmml"><mrow id="A2.E20.m1.8.9.3.3.2.2" xref="A2.E20.m1.8.9.3.3.2.2.cmml"><msubsup id="A2.E20.m1.8.9.3.3.2.2.1" xref="A2.E20.m1.8.9.3.3.2.2.1.cmml"><mo id="A2.E20.m1.8.9.3.3.2.2.1.2.2" xref="A2.E20.m1.8.9.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="A2.E20.m1.8.9.3.3.2.2.1.2.3" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.cmml"><mi id="A2.E20.m1.8.9.3.3.2.2.1.2.3.2" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.2.cmml">t</mi><mo id="A2.E20.m1.8.9.3.3.2.2.1.2.3.1" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.1.cmml">=</mo><mn id="A2.E20.m1.8.9.3.3.2.2.1.2.3.3" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.3.cmml">2</mn></mrow><mi id="A2.E20.m1.8.9.3.3.2.2.1.3" xref="A2.E20.m1.8.9.3.3.2.2.1.3.cmml">T</mi></msubsup><msub id="A2.E20.m1.8.9.3.3.2.2.2" xref="A2.E20.m1.8.9.3.3.2.2.2.cmml"><mi id="A2.E20.m1.8.9.3.3.2.2.2.2" xref="A2.E20.m1.8.9.3.3.2.2.2.2.cmml">λ</mi><mi id="A2.E20.m1.8.9.3.3.2.2.2.3" xref="A2.E20.m1.8.9.3.3.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="A2.E20.m1.8.9.3.3.2.3" xref="A2.E20.m1.8.9.3.3.2.3.cmml"><mi id="A2.E20.m1.8.9.3.3.2.3.2" xref="A2.E20.m1.8.9.3.3.2.3.2.cmml">T</mi><mo id="A2.E20.m1.8.9.3.3.2.3.1" xref="A2.E20.m1.8.9.3.3.2.3.1.cmml">−</mo><mn id="A2.E20.m1.8.9.3.3.2.3.3" xref="A2.E20.m1.8.9.3.3.2.3.3.cmml">1</mn></mrow></mfrac><mo id="A2.E20.m1.8.9.3.3.1" lspace="0.167em" xref="A2.E20.m1.8.9.3.3.1.cmml">⁢</mo><munder id="A2.E20.m1.8.9.3.3.3" xref="A2.E20.m1.8.9.3.3.3.cmml"><munder accentunder="true" id="A2.E20.m1.8.8" xref="A2.E20.m1.8.8.cmml"><mrow id="A2.E20.m1.8.8.2" xref="A2.E20.m1.8.8.2.cmml"><mrow id="A2.E20.m1.8.8.2.4" xref="A2.E20.m1.8.8.2.4.cmml"><mrow id="A2.E20.m1.8.8.2.4.1" xref="A2.E20.m1.8.8.2.4.1.cmml"><mo id="A2.E20.m1.8.8.2.4.1.1" rspace="0.167em" xref="A2.E20.m1.8.8.2.4.1.1.cmml">∇</mo><mi id="A2.E20.m1.8.8.2.4.1.2" xref="A2.E20.m1.8.8.2.4.1.2.cmml">log</mi></mrow><mo id="A2.E20.m1.8.8.2.4a" lspace="0.167em" xref="A2.E20.m1.8.8.2.4.cmml">⁡</mo><mi id="A2.E20.m1.8.8.2.4.2" xref="A2.E20.m1.8.8.2.4.2.cmml">p</mi></mrow><mo id="A2.E20.m1.8.8.2.3" xref="A2.E20.m1.8.8.2.3.cmml">⁢</mo><mrow id="A2.E20.m1.8.8.2.2.1" xref="A2.E20.m1.8.8.2.2.2.cmml"><mo id="A2.E20.m1.8.8.2.2.1.2" stretchy="false" xref="A2.E20.m1.8.8.2.2.2.cmml">(</mo><mi id="A2.E20.m1.7.7.1.1" xref="A2.E20.m1.7.7.1.1.cmml">𝐲</mi><mo id="A2.E20.m1.8.8.2.2.1.3" xref="A2.E20.m1.8.8.2.2.2.cmml">,</mo><mrow id="A2.E20.m1.8.8.2.2.1.1" xref="A2.E20.m1.8.8.2.2.1.1.cmml"><mi id="A2.E20.m1.8.8.2.2.1.1.2" xref="A2.E20.m1.8.8.2.2.1.1.2.cmml">𝐬</mi><mo fence="false" id="A2.E20.m1.8.8.2.2.1.1.1" xref="A2.E20.m1.8.8.2.2.1.1.1.cmml">|</mo><msub id="A2.E20.m1.8.8.2.2.1.1.3" xref="A2.E20.m1.8.8.2.2.1.1.3.cmml"><mi id="A2.E20.m1.8.8.2.2.1.1.3.2" xref="A2.E20.m1.8.8.2.2.1.1.3.2.cmml">𝐱</mi><mi id="A2.E20.m1.8.8.2.2.1.1.3.3" xref="A2.E20.m1.8.8.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A2.E20.m1.8.8.2.2.1.4" stretchy="false" xref="A2.E20.m1.8.8.2.2.2.cmml">)</mo></mrow></mrow><mo id="A2.E20.m1.8.8.3" xref="A2.E20.m1.8.8.3.cmml">⏟</mo></munder><mtext id="A2.E20.m1.8.9.3.3.3.2" xref="A2.E20.m1.8.9.3.3.3.2a.cmml">reversed likelihood score</mtext></munder></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E20.m1.8b"><apply id="A2.E20.m1.8.9.cmml" xref="A2.E20.m1.8.9"><eq id="A2.E20.m1.8.9.1.cmml" xref="A2.E20.m1.8.9.1"></eq><apply id="A2.E20.m1.8.9.2.cmml" xref="A2.E20.m1.8.9.2"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.2.1.cmml" xref="A2.E20.m1.8.9.2">subscript</csymbol><apply id="A2.E20.m1.3.3.cmml" xref="A2.E20.m1.3.3"><ci id="A2.E20.m1.3.3.4.cmml" xref="A2.E20.m1.3.3.4">⏟</ci><apply id="A2.E20.m1.3.3.3.cmml" xref="A2.E20.m1.3.3.3"><times id="A2.E20.m1.3.3.3.4.cmml" xref="A2.E20.m1.3.3.3.4"></times><apply id="A2.E20.m1.3.3.3.5.cmml" xref="A2.E20.m1.3.3.3.5"><apply id="A2.E20.m1.3.3.3.5.1.cmml" xref="A2.E20.m1.3.3.3.5.1"><ci id="A2.E20.m1.3.3.3.5.1.1.cmml" xref="A2.E20.m1.3.3.3.5.1.1">∇</ci><log id="A2.E20.m1.3.3.3.5.1.2.cmml" xref="A2.E20.m1.3.3.3.5.1.2"></log></apply><apply id="A2.E20.m1.3.3.3.5.2.cmml" xref="A2.E20.m1.3.3.3.5.2"><ci id="A2.E20.m1.3.3.3.5.2.1.cmml" xref="A2.E20.m1.3.3.3.5.2.1">~</ci><ci id="A2.E20.m1.3.3.3.5.2.2.cmml" xref="A2.E20.m1.3.3.3.5.2.2">𝑝</ci></apply></apply><apply id="A2.E20.m1.3.3.3.3.1.1.cmml" xref="A2.E20.m1.3.3.3.3.1"><csymbol cd="latexml" id="A2.E20.m1.3.3.3.3.1.1.1.cmml" xref="A2.E20.m1.3.3.3.3.1.1.1">conditional</csymbol><apply id="A2.E20.m1.3.3.3.3.1.1.2.cmml" xref="A2.E20.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E20.m1.3.3.3.3.1.1.2.1.cmml" xref="A2.E20.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="A2.E20.m1.3.3.3.3.1.1.2.2.cmml" xref="A2.E20.m1.3.3.3.3.1.1.2.2">𝐱</ci><ci id="A2.E20.m1.3.3.3.3.1.1.2.3.cmml" xref="A2.E20.m1.3.3.3.3.1.1.2.3">𝑡</ci></apply><list id="A2.E20.m1.3.3.3.3.1.1.3.1.cmml" xref="A2.E20.m1.3.3.3.3.1.1.3.2"><ci id="A2.E20.m1.1.1.1.1.cmml" xref="A2.E20.m1.1.1.1.1">𝐲</ci><ci id="A2.E20.m1.2.2.2.2.cmml" xref="A2.E20.m1.2.2.2.2">𝐬</ci></list></apply></apply></apply><ci id="A2.E20.m1.8.9.2.2a.cmml" xref="A2.E20.m1.8.9.2.2"><mtext id="A2.E20.m1.8.9.2.2.cmml" mathsize="70%" xref="A2.E20.m1.8.9.2.2">adjusted likelihood score</mtext></ci></apply><apply id="A2.E20.m1.8.9.3.cmml" xref="A2.E20.m1.8.9.3"><plus id="A2.E20.m1.8.9.3.1.cmml" xref="A2.E20.m1.8.9.3.1"></plus><apply id="A2.E20.m1.8.9.3.2.cmml" xref="A2.E20.m1.8.9.3.2"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.3.2.1.cmml" xref="A2.E20.m1.8.9.3.2">subscript</csymbol><apply id="A2.E20.m1.6.6.cmml" xref="A2.E20.m1.6.6"><ci id="A2.E20.m1.6.6.4.cmml" xref="A2.E20.m1.6.6.4">⏟</ci><apply id="A2.E20.m1.6.6.3.cmml" xref="A2.E20.m1.6.6.3"><times id="A2.E20.m1.6.6.3.4.cmml" xref="A2.E20.m1.6.6.3.4"></times><apply id="A2.E20.m1.6.6.3.5.cmml" xref="A2.E20.m1.6.6.3.5"><apply id="A2.E20.m1.6.6.3.5.1.cmml" xref="A2.E20.m1.6.6.3.5.1"><ci id="A2.E20.m1.6.6.3.5.1.1.cmml" xref="A2.E20.m1.6.6.3.5.1.1">∇</ci><log id="A2.E20.m1.6.6.3.5.1.2.cmml" xref="A2.E20.m1.6.6.3.5.1.2"></log></apply><ci id="A2.E20.m1.6.6.3.5.2.cmml" xref="A2.E20.m1.6.6.3.5.2">𝑝</ci></apply><apply id="A2.E20.m1.6.6.3.3.1.1.cmml" xref="A2.E20.m1.6.6.3.3.1"><csymbol cd="latexml" id="A2.E20.m1.6.6.3.3.1.1.1.cmml" xref="A2.E20.m1.6.6.3.3.1.1.1">conditional</csymbol><apply id="A2.E20.m1.6.6.3.3.1.1.2.cmml" xref="A2.E20.m1.6.6.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.E20.m1.6.6.3.3.1.1.2.1.cmml" xref="A2.E20.m1.6.6.3.3.1.1.2">subscript</csymbol><ci id="A2.E20.m1.6.6.3.3.1.1.2.2.cmml" xref="A2.E20.m1.6.6.3.3.1.1.2.2">𝐱</ci><ci id="A2.E20.m1.6.6.3.3.1.1.2.3.cmml" xref="A2.E20.m1.6.6.3.3.1.1.2.3">𝑡</ci></apply><list id="A2.E20.m1.6.6.3.3.1.1.3.1.cmml" xref="A2.E20.m1.6.6.3.3.1.1.3.2"><ci id="A2.E20.m1.4.4.1.1.cmml" xref="A2.E20.m1.4.4.1.1">𝐲</ci><ci id="A2.E20.m1.5.5.2.2.cmml" xref="A2.E20.m1.5.5.2.2">𝐬</ci></list></apply></apply></apply><ci id="A2.E20.m1.8.9.3.2.2a.cmml" xref="A2.E20.m1.8.9.3.2.2"><mtext id="A2.E20.m1.8.9.3.2.2.cmml" mathsize="70%" xref="A2.E20.m1.8.9.3.2.2">original likelihood score</mtext></ci></apply><apply id="A2.E20.m1.8.9.3.3.cmml" xref="A2.E20.m1.8.9.3.3"><times id="A2.E20.m1.8.9.3.3.1.cmml" xref="A2.E20.m1.8.9.3.3.1"></times><apply id="A2.E20.m1.8.9.3.3.2.cmml" xref="A2.E20.m1.8.9.3.3.2"><divide id="A2.E20.m1.8.9.3.3.2.1.cmml" xref="A2.E20.m1.8.9.3.3.2"></divide><apply id="A2.E20.m1.8.9.3.3.2.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2"><apply id="A2.E20.m1.8.9.3.3.2.2.1.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.3.3.2.2.1.1.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1">superscript</csymbol><apply id="A2.E20.m1.8.9.3.3.2.2.1.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.3.3.2.2.1.2.1.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1">subscript</csymbol><sum id="A2.E20.m1.8.9.3.3.2.2.1.2.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1.2.2"></sum><apply id="A2.E20.m1.8.9.3.3.2.2.1.2.3.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3"><eq id="A2.E20.m1.8.9.3.3.2.2.1.2.3.1.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.1"></eq><ci id="A2.E20.m1.8.9.3.3.2.2.1.2.3.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.2">𝑡</ci><cn id="A2.E20.m1.8.9.3.3.2.2.1.2.3.3.cmml" type="integer" xref="A2.E20.m1.8.9.3.3.2.2.1.2.3.3">2</cn></apply></apply><ci id="A2.E20.m1.8.9.3.3.2.2.1.3.cmml" xref="A2.E20.m1.8.9.3.3.2.2.1.3">𝑇</ci></apply><apply id="A2.E20.m1.8.9.3.3.2.2.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.3.3.2.2.2.1.cmml" xref="A2.E20.m1.8.9.3.3.2.2.2">subscript</csymbol><ci id="A2.E20.m1.8.9.3.3.2.2.2.2.cmml" xref="A2.E20.m1.8.9.3.3.2.2.2.2">𝜆</ci><ci id="A2.E20.m1.8.9.3.3.2.2.2.3.cmml" xref="A2.E20.m1.8.9.3.3.2.2.2.3">𝑡</ci></apply></apply><apply id="A2.E20.m1.8.9.3.3.2.3.cmml" xref="A2.E20.m1.8.9.3.3.2.3"><minus id="A2.E20.m1.8.9.3.3.2.3.1.cmml" xref="A2.E20.m1.8.9.3.3.2.3.1"></minus><ci id="A2.E20.m1.8.9.3.3.2.3.2.cmml" xref="A2.E20.m1.8.9.3.3.2.3.2">𝑇</ci><cn id="A2.E20.m1.8.9.3.3.2.3.3.cmml" type="integer" xref="A2.E20.m1.8.9.3.3.2.3.3">1</cn></apply></apply><apply id="A2.E20.m1.8.9.3.3.3.cmml" xref="A2.E20.m1.8.9.3.3.3"><csymbol cd="ambiguous" id="A2.E20.m1.8.9.3.3.3.1.cmml" xref="A2.E20.m1.8.9.3.3.3">subscript</csymbol><apply id="A2.E20.m1.8.8.cmml" xref="A2.E20.m1.8.8"><ci id="A2.E20.m1.8.8.3.cmml" xref="A2.E20.m1.8.8.3">⏟</ci><apply id="A2.E20.m1.8.8.2.cmml" xref="A2.E20.m1.8.8.2"><times id="A2.E20.m1.8.8.2.3.cmml" xref="A2.E20.m1.8.8.2.3"></times><apply id="A2.E20.m1.8.8.2.4.cmml" xref="A2.E20.m1.8.8.2.4"><apply id="A2.E20.m1.8.8.2.4.1.cmml" xref="A2.E20.m1.8.8.2.4.1"><ci id="A2.E20.m1.8.8.2.4.1.1.cmml" xref="A2.E20.m1.8.8.2.4.1.1">∇</ci><log id="A2.E20.m1.8.8.2.4.1.2.cmml" xref="A2.E20.m1.8.8.2.4.1.2"></log></apply><ci id="A2.E20.m1.8.8.2.4.2.cmml" xref="A2.E20.m1.8.8.2.4.2">𝑝</ci></apply><interval closure="open" id="A2.E20.m1.8.8.2.2.2.cmml" xref="A2.E20.m1.8.8.2.2.1"><ci id="A2.E20.m1.7.7.1.1.cmml" xref="A2.E20.m1.7.7.1.1">𝐲</ci><apply id="A2.E20.m1.8.8.2.2.1.1.cmml" xref="A2.E20.m1.8.8.2.2.1.1"><csymbol cd="latexml" id="A2.E20.m1.8.8.2.2.1.1.1.cmml" xref="A2.E20.m1.8.8.2.2.1.1.1">conditional</csymbol><ci id="A2.E20.m1.8.8.2.2.1.1.2.cmml" xref="A2.E20.m1.8.8.2.2.1.1.2">𝐬</ci><apply id="A2.E20.m1.8.8.2.2.1.1.3.cmml" xref="A2.E20.m1.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m1.8.8.2.2.1.1.3.1.cmml" xref="A2.E20.m1.8.8.2.2.1.1.3">subscript</csymbol><ci id="A2.E20.m1.8.8.2.2.1.1.3.2.cmml" xref="A2.E20.m1.8.8.2.2.1.1.3.2">𝐱</ci><ci id="A2.E20.m1.8.8.2.2.1.1.3.3.cmml" xref="A2.E20.m1.8.8.2.2.1.1.3.3">𝑡</ci></apply></apply></interval></apply></apply><ci id="A2.E20.m1.8.9.3.3.3.2a.cmml" xref="A2.E20.m1.8.9.3.3.3.2"><mtext id="A2.E20.m1.8.9.3.3.3.2.cmml" mathsize="70%" xref="A2.E20.m1.8.9.3.3.3.2">reversed likelihood score</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E20.m1.8c">\underbrace{\nabla\log\tilde{p}(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})}_{\text{%
adjusted likelihood score}}=\underbrace{\nabla\log p(\mathbf{x}_{t}|\mathbf{y}%
,\mathbf{s})}_{\text{original likelihood score}}+\frac{\sum_{t=2}^{T}{\lambda_%
{t}}}{T-1}\underbrace{\nabla\log p(\mathbf{y},\mathbf{s}|\mathbf{x}_{t})}_{%
\text{reversed likelihood score}}</annotation><annotation encoding="application/x-llamapun" id="A2.E20.m1.8d">under⏟ start_ARG ∇ roman_log over~ start_ARG italic_p end_ARG ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) end_ARG start_POSTSUBSCRIPT adjusted likelihood score end_POSTSUBSCRIPT = under⏟ start_ARG ∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) end_ARG start_POSTSUBSCRIPT original likelihood score end_POSTSUBSCRIPT + divide start_ARG ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_T - 1 end_ARG under⏟ start_ARG ∇ roman_log italic_p ( bold_y , bold_s | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT reversed likelihood score end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.20)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p4.1">For the original likelihood score, we note that our proposed ID<sup class="ltx_sup" id="A2.p4.1.1">3</sup> itself is a conditional diffusion model. By virtue of the relation between the score and the denoising module (i.e. the Tweedie’s Formula) in diffusion models (cf. Equation (133) in <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Luo</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>)</cite>), we are able to show that</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\mathbf{x}_{0}-\frac{\mathbf{x}_{t}}{\sqrt%
{\bar{\alpha}_{t}}}\right)" class="ltx_Math" display="block" id="A2.E21.m1.4"><semantics id="A2.E21.m1.4a"><mrow id="A2.E21.m1.4.4" xref="A2.E21.m1.4.4.cmml"><mrow id="A2.E21.m1.3.3.1" xref="A2.E21.m1.3.3.1.cmml"><mrow id="A2.E21.m1.3.3.1.3" xref="A2.E21.m1.3.3.1.3.cmml"><mrow id="A2.E21.m1.3.3.1.3.1" xref="A2.E21.m1.3.3.1.3.1.cmml"><mo id="A2.E21.m1.3.3.1.3.1.1" rspace="0.167em" xref="A2.E21.m1.3.3.1.3.1.1.cmml">∇</mo><mi id="A2.E21.m1.3.3.1.3.1.2" xref="A2.E21.m1.3.3.1.3.1.2.cmml">log</mi></mrow><mo id="A2.E21.m1.3.3.1.3a" lspace="0.167em" xref="A2.E21.m1.3.3.1.3.cmml">⁡</mo><mi id="A2.E21.m1.3.3.1.3.2" xref="A2.E21.m1.3.3.1.3.2.cmml">p</mi></mrow><mo id="A2.E21.m1.3.3.1.2" xref="A2.E21.m1.3.3.1.2.cmml">⁢</mo><mrow id="A2.E21.m1.3.3.1.1.1" xref="A2.E21.m1.3.3.1.1.1.1.cmml"><mo id="A2.E21.m1.3.3.1.1.1.2" stretchy="false" xref="A2.E21.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A2.E21.m1.3.3.1.1.1.1" xref="A2.E21.m1.3.3.1.1.1.1.cmml"><msub id="A2.E21.m1.3.3.1.1.1.1.2" xref="A2.E21.m1.3.3.1.1.1.1.2.cmml"><mi id="A2.E21.m1.3.3.1.1.1.1.2.2" xref="A2.E21.m1.3.3.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A2.E21.m1.3.3.1.1.1.1.2.3" xref="A2.E21.m1.3.3.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A2.E21.m1.3.3.1.1.1.1.1" xref="A2.E21.m1.3.3.1.1.1.1.1.cmml">|</mo><mrow id="A2.E21.m1.3.3.1.1.1.1.3.2" xref="A2.E21.m1.3.3.1.1.1.1.3.1.cmml"><mi id="A2.E21.m1.1.1" xref="A2.E21.m1.1.1.cmml">𝐲</mi><mo id="A2.E21.m1.3.3.1.1.1.1.3.2.1" xref="A2.E21.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="A2.E21.m1.2.2" xref="A2.E21.m1.2.2.cmml">𝐬</mi></mrow></mrow><mo id="A2.E21.m1.3.3.1.1.1.3" stretchy="false" xref="A2.E21.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E21.m1.4.4.3" xref="A2.E21.m1.4.4.3.cmml">=</mo><mrow id="A2.E21.m1.4.4.2" xref="A2.E21.m1.4.4.2.cmml"><mfrac id="A2.E21.m1.4.4.2.3" xref="A2.E21.m1.4.4.2.3.cmml"><msqrt id="A2.E21.m1.4.4.2.3.2" xref="A2.E21.m1.4.4.2.3.2.cmml"><msub id="A2.E21.m1.4.4.2.3.2.2" xref="A2.E21.m1.4.4.2.3.2.2.cmml"><mover accent="true" id="A2.E21.m1.4.4.2.3.2.2.2" xref="A2.E21.m1.4.4.2.3.2.2.2.cmml"><mi id="A2.E21.m1.4.4.2.3.2.2.2.2" xref="A2.E21.m1.4.4.2.3.2.2.2.2.cmml">α</mi><mo id="A2.E21.m1.4.4.2.3.2.2.2.1" xref="A2.E21.m1.4.4.2.3.2.2.2.1.cmml">¯</mo></mover><mi id="A2.E21.m1.4.4.2.3.2.2.3" xref="A2.E21.m1.4.4.2.3.2.2.3.cmml">t</mi></msub></msqrt><msqrt id="A2.E21.m1.4.4.2.3.3" xref="A2.E21.m1.4.4.2.3.3.cmml"><mrow id="A2.E21.m1.4.4.2.3.3.2" xref="A2.E21.m1.4.4.2.3.3.2.cmml"><mn id="A2.E21.m1.4.4.2.3.3.2.2" xref="A2.E21.m1.4.4.2.3.3.2.2.cmml">1</mn><mo id="A2.E21.m1.4.4.2.3.3.2.1" xref="A2.E21.m1.4.4.2.3.3.2.1.cmml">−</mo><msub id="A2.E21.m1.4.4.2.3.3.2.3" xref="A2.E21.m1.4.4.2.3.3.2.3.cmml"><mover accent="true" id="A2.E21.m1.4.4.2.3.3.2.3.2" xref="A2.E21.m1.4.4.2.3.3.2.3.2.cmml"><mi id="A2.E21.m1.4.4.2.3.3.2.3.2.2" xref="A2.E21.m1.4.4.2.3.3.2.3.2.2.cmml">α</mi><mo id="A2.E21.m1.4.4.2.3.3.2.3.2.1" xref="A2.E21.m1.4.4.2.3.3.2.3.2.1.cmml">¯</mo></mover><mi id="A2.E21.m1.4.4.2.3.3.2.3.3" xref="A2.E21.m1.4.4.2.3.3.2.3.3.cmml">t</mi></msub></mrow></msqrt></mfrac><mo id="A2.E21.m1.4.4.2.2" xref="A2.E21.m1.4.4.2.2.cmml">⁢</mo><mrow id="A2.E21.m1.4.4.2.1.1" xref="A2.E21.m1.4.4.2.1.1.1.cmml"><mo id="A2.E21.m1.4.4.2.1.1.2" xref="A2.E21.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="A2.E21.m1.4.4.2.1.1.1" xref="A2.E21.m1.4.4.2.1.1.1.cmml"><msub id="A2.E21.m1.4.4.2.1.1.1.2" xref="A2.E21.m1.4.4.2.1.1.1.2.cmml"><mi id="A2.E21.m1.4.4.2.1.1.1.2.2" xref="A2.E21.m1.4.4.2.1.1.1.2.2.cmml">𝐱</mi><mn id="A2.E21.m1.4.4.2.1.1.1.2.3" xref="A2.E21.m1.4.4.2.1.1.1.2.3.cmml">0</mn></msub><mo id="A2.E21.m1.4.4.2.1.1.1.1" xref="A2.E21.m1.4.4.2.1.1.1.1.cmml">−</mo><mfrac id="A2.E21.m1.4.4.2.1.1.1.3" xref="A2.E21.m1.4.4.2.1.1.1.3.cmml"><msub id="A2.E21.m1.4.4.2.1.1.1.3.2" xref="A2.E21.m1.4.4.2.1.1.1.3.2.cmml"><mi id="A2.E21.m1.4.4.2.1.1.1.3.2.2" xref="A2.E21.m1.4.4.2.1.1.1.3.2.2.cmml">𝐱</mi><mi id="A2.E21.m1.4.4.2.1.1.1.3.2.3" xref="A2.E21.m1.4.4.2.1.1.1.3.2.3.cmml">t</mi></msub><msqrt id="A2.E21.m1.4.4.2.1.1.1.3.3" xref="A2.E21.m1.4.4.2.1.1.1.3.3.cmml"><msub id="A2.E21.m1.4.4.2.1.1.1.3.3.2" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.cmml"><mover accent="true" id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.cmml"><mi id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.2" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.2.cmml">α</mi><mo id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.1" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.1.cmml">¯</mo></mover><mi id="A2.E21.m1.4.4.2.1.1.1.3.3.2.3" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.3.cmml">t</mi></msub></msqrt></mfrac></mrow><mo id="A2.E21.m1.4.4.2.1.1.3" xref="A2.E21.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E21.m1.4b"><apply id="A2.E21.m1.4.4.cmml" xref="A2.E21.m1.4.4"><eq id="A2.E21.m1.4.4.3.cmml" xref="A2.E21.m1.4.4.3"></eq><apply id="A2.E21.m1.3.3.1.cmml" xref="A2.E21.m1.3.3.1"><times id="A2.E21.m1.3.3.1.2.cmml" xref="A2.E21.m1.3.3.1.2"></times><apply id="A2.E21.m1.3.3.1.3.cmml" xref="A2.E21.m1.3.3.1.3"><apply id="A2.E21.m1.3.3.1.3.1.cmml" xref="A2.E21.m1.3.3.1.3.1"><ci id="A2.E21.m1.3.3.1.3.1.1.cmml" xref="A2.E21.m1.3.3.1.3.1.1">∇</ci><log id="A2.E21.m1.3.3.1.3.1.2.cmml" xref="A2.E21.m1.3.3.1.3.1.2"></log></apply><ci id="A2.E21.m1.3.3.1.3.2.cmml" xref="A2.E21.m1.3.3.1.3.2">𝑝</ci></apply><apply id="A2.E21.m1.3.3.1.1.1.1.cmml" xref="A2.E21.m1.3.3.1.1.1"><csymbol cd="latexml" id="A2.E21.m1.3.3.1.1.1.1.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="A2.E21.m1.3.3.1.1.1.1.2.cmml" xref="A2.E21.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.3.3.1.1.1.1.2.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="A2.E21.m1.3.3.1.1.1.1.2.2.cmml" xref="A2.E21.m1.3.3.1.1.1.1.2.2">𝐱</ci><ci id="A2.E21.m1.3.3.1.1.1.1.2.3.cmml" xref="A2.E21.m1.3.3.1.1.1.1.2.3">𝑡</ci></apply><list id="A2.E21.m1.3.3.1.1.1.1.3.1.cmml" xref="A2.E21.m1.3.3.1.1.1.1.3.2"><ci id="A2.E21.m1.1.1.cmml" xref="A2.E21.m1.1.1">𝐲</ci><ci id="A2.E21.m1.2.2.cmml" xref="A2.E21.m1.2.2">𝐬</ci></list></apply></apply><apply id="A2.E21.m1.4.4.2.cmml" xref="A2.E21.m1.4.4.2"><times id="A2.E21.m1.4.4.2.2.cmml" xref="A2.E21.m1.4.4.2.2"></times><apply id="A2.E21.m1.4.4.2.3.cmml" xref="A2.E21.m1.4.4.2.3"><divide id="A2.E21.m1.4.4.2.3.1.cmml" xref="A2.E21.m1.4.4.2.3"></divide><apply id="A2.E21.m1.4.4.2.3.2.cmml" xref="A2.E21.m1.4.4.2.3.2"><root id="A2.E21.m1.4.4.2.3.2a.cmml" xref="A2.E21.m1.4.4.2.3.2"></root><apply id="A2.E21.m1.4.4.2.3.2.2.cmml" xref="A2.E21.m1.4.4.2.3.2.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.3.2.2.1.cmml" xref="A2.E21.m1.4.4.2.3.2.2">subscript</csymbol><apply id="A2.E21.m1.4.4.2.3.2.2.2.cmml" xref="A2.E21.m1.4.4.2.3.2.2.2"><ci id="A2.E21.m1.4.4.2.3.2.2.2.1.cmml" xref="A2.E21.m1.4.4.2.3.2.2.2.1">¯</ci><ci id="A2.E21.m1.4.4.2.3.2.2.2.2.cmml" xref="A2.E21.m1.4.4.2.3.2.2.2.2">𝛼</ci></apply><ci id="A2.E21.m1.4.4.2.3.2.2.3.cmml" xref="A2.E21.m1.4.4.2.3.2.2.3">𝑡</ci></apply></apply><apply id="A2.E21.m1.4.4.2.3.3.cmml" xref="A2.E21.m1.4.4.2.3.3"><root id="A2.E21.m1.4.4.2.3.3a.cmml" xref="A2.E21.m1.4.4.2.3.3"></root><apply id="A2.E21.m1.4.4.2.3.3.2.cmml" xref="A2.E21.m1.4.4.2.3.3.2"><minus id="A2.E21.m1.4.4.2.3.3.2.1.cmml" xref="A2.E21.m1.4.4.2.3.3.2.1"></minus><cn id="A2.E21.m1.4.4.2.3.3.2.2.cmml" type="integer" xref="A2.E21.m1.4.4.2.3.3.2.2">1</cn><apply id="A2.E21.m1.4.4.2.3.3.2.3.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.3.3.2.3.1.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3">subscript</csymbol><apply id="A2.E21.m1.4.4.2.3.3.2.3.2.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3.2"><ci id="A2.E21.m1.4.4.2.3.3.2.3.2.1.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3.2.1">¯</ci><ci id="A2.E21.m1.4.4.2.3.3.2.3.2.2.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3.2.2">𝛼</ci></apply><ci id="A2.E21.m1.4.4.2.3.3.2.3.3.cmml" xref="A2.E21.m1.4.4.2.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="A2.E21.m1.4.4.2.1.1.1.cmml" xref="A2.E21.m1.4.4.2.1.1"><minus id="A2.E21.m1.4.4.2.1.1.1.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.1"></minus><apply id="A2.E21.m1.4.4.2.1.1.1.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.1.1.1.2.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.2">subscript</csymbol><ci id="A2.E21.m1.4.4.2.1.1.1.2.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.2.2">𝐱</ci><cn id="A2.E21.m1.4.4.2.1.1.1.2.3.cmml" type="integer" xref="A2.E21.m1.4.4.2.1.1.1.2.3">0</cn></apply><apply id="A2.E21.m1.4.4.2.1.1.1.3.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3"><divide id="A2.E21.m1.4.4.2.1.1.1.3.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3"></divide><apply id="A2.E21.m1.4.4.2.1.1.1.3.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.1.1.1.3.2.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.2">subscript</csymbol><ci id="A2.E21.m1.4.4.2.1.1.1.3.2.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.2.2">𝐱</ci><ci id="A2.E21.m1.4.4.2.1.1.1.3.2.3.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.2.3">𝑡</ci></apply><apply id="A2.E21.m1.4.4.2.1.1.1.3.3.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3"><root id="A2.E21.m1.4.4.2.1.1.1.3.3a.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3"></root><apply id="A2.E21.m1.4.4.2.1.1.1.3.3.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.2.1.1.1.3.3.2.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2">subscript</csymbol><apply id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2"><ci id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.1.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.1">¯</ci><ci id="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.2.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.2.2">𝛼</ci></apply><ci id="A2.E21.m1.4.4.2.1.1.1.3.3.2.3.cmml" xref="A2.E21.m1.4.4.2.1.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E21.m1.4c">\nabla\log p(\mathbf{x}_{t}|\mathbf{y},\mathbf{s})=\frac{\sqrt{\bar{\alpha}_{t%
}}}{\sqrt{1-\bar{\alpha}_{t}}}\left(\mathbf{x}_{0}-\frac{\mathbf{x}_{t}}{\sqrt%
{\bar{\alpha}_{t}}}\right)</annotation><annotation encoding="application/x-llamapun" id="A2.E21.m1.4d">∇ roman_log italic_p ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_y , bold_s ) = divide start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG start_ARG square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG ( bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - divide start_ARG bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.21)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p4.3">Here, <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A2.p4.2.m1.1"><semantics id="A2.p4.2.m1.1a"><msub id="A2.p4.2.m1.1.1" xref="A2.p4.2.m1.1.1.cmml"><mi id="A2.p4.2.m1.1.1.2" xref="A2.p4.2.m1.1.1.2.cmml">𝐱</mi><mn id="A2.p4.2.m1.1.1.3" xref="A2.p4.2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A2.p4.2.m1.1b"><apply id="A2.p4.2.m1.1.1.cmml" xref="A2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="A2.p4.2.m1.1.1.1.cmml" xref="A2.p4.2.m1.1.1">subscript</csymbol><ci id="A2.p4.2.m1.1.1.2.cmml" xref="A2.p4.2.m1.1.1.2">𝐱</ci><cn id="A2.p4.2.m1.1.1.3.cmml" type="integer" xref="A2.p4.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.2.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A2.p4.2.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> can be approximated by denoising <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A2.p4.3.m2.1"><semantics id="A2.p4.3.m2.1a"><msub id="A2.p4.3.m2.1.1" xref="A2.p4.3.m2.1.1.cmml"><mi id="A2.p4.3.m2.1.1.2" xref="A2.p4.3.m2.1.1.2.cmml">𝐱</mi><mi id="A2.p4.3.m2.1.1.3" xref="A2.p4.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p4.3.m2.1b"><apply id="A2.p4.3.m2.1.1.cmml" xref="A2.p4.3.m2.1.1"><csymbol cd="ambiguous" id="A2.p4.3.m2.1.1.1.cmml" xref="A2.p4.3.m2.1.1">subscript</csymbol><ci id="A2.p4.3.m2.1.1.2.cmml" xref="A2.p4.3.m2.1.1.2">𝐱</ci><ci id="A2.p4.3.m2.1.1.3.cmml" xref="A2.p4.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.3.m2.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A2.p4.3.m2.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> via the trained denoising module</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{0}\approx\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t,\mathbf{y%
},\mathbf{s})" class="ltx_Math" display="block" id="A2.E22.m1.4"><semantics id="A2.E22.m1.4a"><mrow id="A2.E22.m1.4.4" xref="A2.E22.m1.4.4.cmml"><msub id="A2.E22.m1.4.4.3" xref="A2.E22.m1.4.4.3.cmml"><mi id="A2.E22.m1.4.4.3.2" xref="A2.E22.m1.4.4.3.2.cmml">𝐱</mi><mn id="A2.E22.m1.4.4.3.3" xref="A2.E22.m1.4.4.3.3.cmml">0</mn></msub><mo id="A2.E22.m1.4.4.2" xref="A2.E22.m1.4.4.2.cmml">≈</mo><mrow id="A2.E22.m1.4.4.1" xref="A2.E22.m1.4.4.1.cmml"><msub id="A2.E22.m1.4.4.1.3" xref="A2.E22.m1.4.4.1.3.cmml"><mover accent="true" id="A2.E22.m1.4.4.1.3.2" xref="A2.E22.m1.4.4.1.3.2.cmml"><mi id="A2.E22.m1.4.4.1.3.2.2" xref="A2.E22.m1.4.4.1.3.2.2.cmml">𝐱</mi><mo id="A2.E22.m1.4.4.1.3.2.1" xref="A2.E22.m1.4.4.1.3.2.1.cmml">^</mo></mover><mi id="A2.E22.m1.4.4.1.3.3" xref="A2.E22.m1.4.4.1.3.3.cmml">𝜽</mi></msub><mo id="A2.E22.m1.4.4.1.2" xref="A2.E22.m1.4.4.1.2.cmml">⁢</mo><mrow id="A2.E22.m1.4.4.1.1.1" xref="A2.E22.m1.4.4.1.1.2.cmml"><mo id="A2.E22.m1.4.4.1.1.1.2" stretchy="false" xref="A2.E22.m1.4.4.1.1.2.cmml">(</mo><msub id="A2.E22.m1.4.4.1.1.1.1" xref="A2.E22.m1.4.4.1.1.1.1.cmml"><mi id="A2.E22.m1.4.4.1.1.1.1.2" xref="A2.E22.m1.4.4.1.1.1.1.2.cmml">𝐱</mi><mi id="A2.E22.m1.4.4.1.1.1.1.3" xref="A2.E22.m1.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="A2.E22.m1.4.4.1.1.1.3" xref="A2.E22.m1.4.4.1.1.2.cmml">,</mo><mi id="A2.E22.m1.1.1" xref="A2.E22.m1.1.1.cmml">t</mi><mo id="A2.E22.m1.4.4.1.1.1.4" xref="A2.E22.m1.4.4.1.1.2.cmml">,</mo><mi id="A2.E22.m1.2.2" xref="A2.E22.m1.2.2.cmml">𝐲</mi><mo id="A2.E22.m1.4.4.1.1.1.5" xref="A2.E22.m1.4.4.1.1.2.cmml">,</mo><mi id="A2.E22.m1.3.3" xref="A2.E22.m1.3.3.cmml">𝐬</mi><mo id="A2.E22.m1.4.4.1.1.1.6" stretchy="false" xref="A2.E22.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E22.m1.4b"><apply id="A2.E22.m1.4.4.cmml" xref="A2.E22.m1.4.4"><approx id="A2.E22.m1.4.4.2.cmml" xref="A2.E22.m1.4.4.2"></approx><apply id="A2.E22.m1.4.4.3.cmml" xref="A2.E22.m1.4.4.3"><csymbol cd="ambiguous" id="A2.E22.m1.4.4.3.1.cmml" xref="A2.E22.m1.4.4.3">subscript</csymbol><ci id="A2.E22.m1.4.4.3.2.cmml" xref="A2.E22.m1.4.4.3.2">𝐱</ci><cn id="A2.E22.m1.4.4.3.3.cmml" type="integer" xref="A2.E22.m1.4.4.3.3">0</cn></apply><apply id="A2.E22.m1.4.4.1.cmml" xref="A2.E22.m1.4.4.1"><times id="A2.E22.m1.4.4.1.2.cmml" xref="A2.E22.m1.4.4.1.2"></times><apply id="A2.E22.m1.4.4.1.3.cmml" xref="A2.E22.m1.4.4.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.4.4.1.3.1.cmml" xref="A2.E22.m1.4.4.1.3">subscript</csymbol><apply id="A2.E22.m1.4.4.1.3.2.cmml" xref="A2.E22.m1.4.4.1.3.2"><ci id="A2.E22.m1.4.4.1.3.2.1.cmml" xref="A2.E22.m1.4.4.1.3.2.1">^</ci><ci id="A2.E22.m1.4.4.1.3.2.2.cmml" xref="A2.E22.m1.4.4.1.3.2.2">𝐱</ci></apply><ci id="A2.E22.m1.4.4.1.3.3.cmml" xref="A2.E22.m1.4.4.1.3.3">𝜽</ci></apply><vector id="A2.E22.m1.4.4.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.1"><apply id="A2.E22.m1.4.4.1.1.1.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.4.4.1.1.1.1.1.cmml" xref="A2.E22.m1.4.4.1.1.1.1">subscript</csymbol><ci id="A2.E22.m1.4.4.1.1.1.1.2.cmml" xref="A2.E22.m1.4.4.1.1.1.1.2">𝐱</ci><ci id="A2.E22.m1.4.4.1.1.1.1.3.cmml" xref="A2.E22.m1.4.4.1.1.1.1.3">𝑡</ci></apply><ci id="A2.E22.m1.1.1.cmml" xref="A2.E22.m1.1.1">𝑡</ci><ci id="A2.E22.m1.2.2.cmml" xref="A2.E22.m1.2.2">𝐲</ci><ci id="A2.E22.m1.3.3.cmml" xref="A2.E22.m1.3.3">𝐬</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E22.m1.4c">\mathbf{x}_{0}\approx\hat{\mathbf{x}}_{\bm{\theta}}(\mathbf{x}_{t},t,\mathbf{y%
},\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="A2.E22.m1.4d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ≈ over^ start_ARG bold_x end_ARG start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , bold_y , bold_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A.22)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>An Illustration of the Dataset Generating Algorithm</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.2">We illustrate the dataset generating algorithm in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A3.F1" title='Figure A.1 ‣ Appendix C An Illustration of the Dataset Generating Algorithm ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">A.1</span></a>. First, <math alttext="N" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_N</annotation></semantics></math> anchor embeddings are generated on the sphere as uniformly as possible. Then, for each anchor, <math alttext="m" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_m</annotation></semantics></math> identity embeddings are generated around the anchor. This strategy ensures inter-class diversity while intra-class identity preservation is guaranteed. Colors show the correspondence between the generation procedure on the left and the generated samples on the right.</p>
</div>
<figure class="ltx_figure" id="A3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="178" id="A3.F1.g1" src="x2.png" width="296"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A.1: </span><span class="ltx_text" id="A3.F1.2.1" style="font-size:90%;">An illustration of the dataset-generating algorithm.
</span></figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Related Work</h2>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Face Recognition.</h5>
<div class="ltx_para" id="A4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p1.1">Face Recognition (FR) is the task of matching query imagery to an enrolled identity database. SoTA FR models are trained using margin-based softmax losses <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Wang et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">2018</span></a>; <span class="ltx_text" style="font-size:90%;">Deng et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">2019</span></a>)</cite> on large-scale web-crawled datasets  <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Guo et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">2016</span></a>; <span class="ltx_text" style="font-size:90%;">Zhu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>)</cite>. These datasets encompasses three characteristics in common (as mentioned in the introduction): (i) sufficient inter-class diversity; (ii) intra-class diversity; (iii) intra-class identity preservation. However, due to the introduction of various regulations restricing the use of authentic face data, researchers switch their attention to synthetic face recognition (SFR). We argue that the crux of SFR is to generate a training dataset that inherits the three characteristics above.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p2.1"><span class="ltx_text ltx_font_bold" id="A4.SS0.SSS0.Px1.p2.1.1">GAN-based SFR models.</span>
Most of the deep generative models for synthetic faces generation are based on GANs.
DigiFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Bae et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite> utilizes a digital rendering pipeline to generate synthetic images based on a learned model of facial geometry and attributes. SFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2022</span></a>)</cite> and ID-Net <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Kolf et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite> train a StyleGAN-ADA <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Karras et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">2020</span></a>)</cite> under a class-conditional setting. SynFace <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Qiu et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">2021</span></a>)</cite> extends DiscoFaceGAN <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Deng et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">2020</span></a>)</cite> using synthetic identity mix-up to enhance the intra-class diversity. However, the reported results shown by these models show significant performance degradation in comparison to FR trained on real data. This performance gap is mainly due to inter-class discrimination and small intra-class diversity in their generated synthetic training datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p3.1"><span class="ltx_text ltx_font_bold" id="A4.SS0.SSS0.Px1.p3.1.1">Diffusion models for SFR.</span>
Recently, Diffusion Models (DMs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Ho et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">2020</span></a>; <span class="ltx_text" style="font-size:90%;">Lin et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">2018</span></a>; <span class="ltx_text" style="font-size:90%;">Song et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">2020</span></a>)</cite> gained attention for both research and industry due to their potential to rival GANs on image synthesis, as they are easier to train without stability issues, and stem from a solid theoretical foundation.
Among SFR diffusion models, IDiff-Face <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_text" style="font-size:90%;">Boutros et al.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">2023</span></a>)</cite> achieves SoTA performance. On the basis of a diffusion model, it incorporates Contextual Partial Dropout to generate diverse intra-class images. However, IDiff-Face fails to regularize the relationship among different identities.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Ablation Study (ii)</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.4">We show the inter-class and intra-class similarity in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17576v1#A5.F2" title='Figure A.2 ‣ Appendix E Ablation Study (ii) ‣ "ID"³: Identity-Preserving-yet-Diversified Diffusion Models for Synthetic Face Recognition'><span class="ltx_text ltx_ref_tag">A.2</span></a>when using <math alttext="[0.5,0.7]" class="ltx_Math" display="inline" id="A5.p1.1.m1.2"><semantics id="A5.p1.1.m1.2a"><mrow id="A5.p1.1.m1.2.3.2" xref="A5.p1.1.m1.2.3.1.cmml"><mo id="A5.p1.1.m1.2.3.2.1" stretchy="false" xref="A5.p1.1.m1.2.3.1.cmml">[</mo><mn id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">0.5</mn><mo id="A5.p1.1.m1.2.3.2.2" xref="A5.p1.1.m1.2.3.1.cmml">,</mo><mn id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">0.7</mn><mo id="A5.p1.1.m1.2.3.2.3" stretchy="false" xref="A5.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.2b"><interval closure="closed" id="A5.p1.1.m1.2.3.1.cmml" xref="A5.p1.1.m1.2.3.2"><cn id="A5.p1.1.m1.1.1.cmml" type="float" xref="A5.p1.1.m1.1.1">0.5</cn><cn id="A5.p1.1.m1.2.2.cmml" type="float" xref="A5.p1.1.m1.2.2">0.7</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.2c">[0.5,0.7]</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.2d">[ 0.5 , 0.7 ]</annotation></semantics></math> and <math alttext="[0.7,0.9]" class="ltx_Math" display="inline" id="A5.p1.2.m2.2"><semantics id="A5.p1.2.m2.2a"><mrow id="A5.p1.2.m2.2.3.2" xref="A5.p1.2.m2.2.3.1.cmml"><mo id="A5.p1.2.m2.2.3.2.1" stretchy="false" xref="A5.p1.2.m2.2.3.1.cmml">[</mo><mn id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml">0.7</mn><mo id="A5.p1.2.m2.2.3.2.2" xref="A5.p1.2.m2.2.3.1.cmml">,</mo><mn id="A5.p1.2.m2.2.2" xref="A5.p1.2.m2.2.2.cmml">0.9</mn><mo id="A5.p1.2.m2.2.3.2.3" stretchy="false" xref="A5.p1.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.2b"><interval closure="closed" id="A5.p1.2.m2.2.3.1.cmml" xref="A5.p1.2.m2.2.3.2"><cn id="A5.p1.2.m2.1.1.cmml" type="float" xref="A5.p1.2.m2.1.1">0.7</cn><cn id="A5.p1.2.m2.2.2.cmml" type="float" xref="A5.p1.2.m2.2.2">0.9</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.2c">[0.7,0.9]</annotation><annotation encoding="application/x-llamapun" id="A5.p1.2.m2.2d">[ 0.7 , 0.9 ]</annotation></semantics></math> as the lower- and upper-bound <math alttext="[lb,ub]" class="ltx_Math" display="inline" id="A5.p1.3.m3.2"><semantics id="A5.p1.3.m3.2a"><mrow id="A5.p1.3.m3.2.2.2" xref="A5.p1.3.m3.2.2.3.cmml"><mo id="A5.p1.3.m3.2.2.2.3" stretchy="false" xref="A5.p1.3.m3.2.2.3.cmml">[</mo><mrow id="A5.p1.3.m3.1.1.1.1" xref="A5.p1.3.m3.1.1.1.1.cmml"><mi id="A5.p1.3.m3.1.1.1.1.2" xref="A5.p1.3.m3.1.1.1.1.2.cmml">l</mi><mo id="A5.p1.3.m3.1.1.1.1.1" xref="A5.p1.3.m3.1.1.1.1.1.cmml">⁢</mo><mi id="A5.p1.3.m3.1.1.1.1.3" xref="A5.p1.3.m3.1.1.1.1.3.cmml">b</mi></mrow><mo id="A5.p1.3.m3.2.2.2.4" xref="A5.p1.3.m3.2.2.3.cmml">,</mo><mrow id="A5.p1.3.m3.2.2.2.2" xref="A5.p1.3.m3.2.2.2.2.cmml"><mi id="A5.p1.3.m3.2.2.2.2.2" xref="A5.p1.3.m3.2.2.2.2.2.cmml">u</mi><mo id="A5.p1.3.m3.2.2.2.2.1" xref="A5.p1.3.m3.2.2.2.2.1.cmml">⁢</mo><mi id="A5.p1.3.m3.2.2.2.2.3" xref="A5.p1.3.m3.2.2.2.2.3.cmml">b</mi></mrow><mo id="A5.p1.3.m3.2.2.2.5" stretchy="false" xref="A5.p1.3.m3.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.3.m3.2b"><interval closure="closed" id="A5.p1.3.m3.2.2.3.cmml" xref="A5.p1.3.m3.2.2.2"><apply id="A5.p1.3.m3.1.1.1.1.cmml" xref="A5.p1.3.m3.1.1.1.1"><times id="A5.p1.3.m3.1.1.1.1.1.cmml" xref="A5.p1.3.m3.1.1.1.1.1"></times><ci id="A5.p1.3.m3.1.1.1.1.2.cmml" xref="A5.p1.3.m3.1.1.1.1.2">𝑙</ci><ci id="A5.p1.3.m3.1.1.1.1.3.cmml" xref="A5.p1.3.m3.1.1.1.1.3">𝑏</ci></apply><apply id="A5.p1.3.m3.2.2.2.2.cmml" xref="A5.p1.3.m3.2.2.2.2"><times id="A5.p1.3.m3.2.2.2.2.1.cmml" xref="A5.p1.3.m3.2.2.2.2.1"></times><ci id="A5.p1.3.m3.2.2.2.2.2.cmml" xref="A5.p1.3.m3.2.2.2.2.2">𝑢</ci><ci id="A5.p1.3.m3.2.2.2.2.3.cmml" xref="A5.p1.3.m3.2.2.2.2.3">𝑏</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.m3.2c">[lb,ub]</annotation><annotation encoding="application/x-llamapun" id="A5.p1.3.m3.2d">[ italic_l italic_b , italic_u italic_b ]</annotation></semantics></math> for sampling <math alttext="\nu_{ij}" class="ltx_Math" display="inline" id="A5.p1.4.m4.1"><semantics id="A5.p1.4.m4.1a"><msub id="A5.p1.4.m4.1.1" xref="A5.p1.4.m4.1.1.cmml"><mi id="A5.p1.4.m4.1.1.2" xref="A5.p1.4.m4.1.1.2.cmml">ν</mi><mrow id="A5.p1.4.m4.1.1.3" xref="A5.p1.4.m4.1.1.3.cmml"><mi id="A5.p1.4.m4.1.1.3.2" xref="A5.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="A5.p1.4.m4.1.1.3.1" xref="A5.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A5.p1.4.m4.1.1.3.3" xref="A5.p1.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A5.p1.4.m4.1b"><apply id="A5.p1.4.m4.1.1.cmml" xref="A5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A5.p1.4.m4.1.1.1.cmml" xref="A5.p1.4.m4.1.1">subscript</csymbol><ci id="A5.p1.4.m4.1.1.2.cmml" xref="A5.p1.4.m4.1.1.2">𝜈</ci><apply id="A5.p1.4.m4.1.1.3.cmml" xref="A5.p1.4.m4.1.1.3"><times id="A5.p1.4.m4.1.1.3.1.cmml" xref="A5.p1.4.m4.1.1.3.1"></times><ci id="A5.p1.4.m4.1.1.3.2.cmml" xref="A5.p1.4.m4.1.1.3.2">𝑖</ci><ci id="A5.p1.4.m4.1.1.3.3.cmml" xref="A5.p1.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m4.1c">\nu_{ij}</annotation><annotation encoding="application/x-llamapun" id="A5.p1.4.m4.1d">italic_ν start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>’s in our proposed dataset-generating algorithm.</p>
</div>
<figure class="ltx_figure" id="A5.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="400" id="A5.F2.g1" src="extracted/5880644/Fig/inter-intra.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure A.2: </span><span class="ltx_text" id="A5.F2.2.1" style="font-size:90%;">The distribution of inter-class and intra-class similarities.
</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Sep 26 06:43:06 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
