<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.15834] FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol</title><meta property="og:description" content="The NOSTR is a communication protocol for the social web, based on the w3c websockets standard. Although it is still in its infancy, it is well known as a social media protocol, thousands of trusted users and multiple …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.15834">

<!--Generated on Sun May  5 21:40:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_font_bold ltx_title_document">FEDSTR (f<span id="id1.id1" class="ltx_ERROR undefined">\textepsilon</span>dst<span id="id2.id2" class="ltx_ERROR undefined">\textschwa</span>r): Money-In AI-Out

<br class="ltx_break">A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol </h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Konstantinos E. Nikolakakis
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">konstantinos.nikolakakis@yale.edu</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">George Chantzialexiou<sup id="id4.1.id1" class="ltx_sup"></sup> 
<br class="ltx_break"><span id="id5.2.id2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">george.chantzialexiou@gmail.com</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dionysis Kalogerias
<br class="ltx_break"><span id="id6.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">dionysis.kalogerias@yale.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p"><span id="id7.id1.1" class="ltx_text">The NOSTR is a communication protocol for the social web, based on the w3c websockets standard. Although it is still in its infancy, it is well known as a social media protocol, thousands of trusted users and multiple user interfaces, offering a unique experience and enormous capabilities. To name a few, the NOSTR applications include but are not limited to direct messaging, file sharing, audio/video streaming, collaborative writing, blogging and data processing through distributed AI directories. In this work, we propose an approach that builds upon the existing protocol structure with end goal a decentralized marketplace for federated learning and LLM training. In this proposed design there are two parties: on one side there are customers who provide a dataset that they want to use for training an AI model. On the other side, there are service providers, who receive (parts of) the dataset, train the AI model, and for a payment as an exchange, they return the optimized AI model. The decentralized and censorship resistant features of the NOSTR enable the possibility of designing a fair and open marketplace for training AI models and LLMs.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The NOSTR (n<span id="S1.p1.1.1" class="ltx_ERROR undefined">\textopeno</span>st<span id="S1.p1.1.2" class="ltx_ERROR undefined">\textschwa</span>r) - Notes and Other Stuff Transmitted by Relays <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is an open protocol that enables censorship-resistant communication. In fact, it is resilient and does not rely on any trusted central servers. The communication over the NOSTR is tamperproof since it relies on cryptographic keys and signatures. The first successful application of the NOSTR protocol is the decentralized social media with at least <math id="S1.p1.1.m1.1" class="ltx_Math" alttext="150000" display="inline"><semantics id="S1.p1.1.m1.1a"><mn id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">150000</mn><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><cn type="integer" id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">150000</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">150000</annotation></semantics></math> known trusted users <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. The NOSTR has several common structural properties with the competitive open protocol Bluesky <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Bluesky and the NOSTR both aim to solve the problem of decentralized social media, under partial consistency trade-offs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, CAP Theorem]</cite>. Herein, we focus on the NOSTR protocol because it is the most flexible and safest of the protocols in terms of developer control and future development.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In parallel with the NOSTR protocol development, distributed AI training has attracted major attention the last few years, with the Language Model breakthroughs leading the progress. By combining recent advanced tools and breakthroughs from open communication protocols <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, bitcoin payments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and distributed optimization algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, we propose a system design that enables open marketplaces for training AI models. Specifically, the NOSTR has already built-in protocol flow for payments through the lightning network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, as well as communication flows for a distributed data processing system, which makes it the state of the art protocol for designing a decentralized market for distributed computation and AI directories. Such a network system can mitigate privacy issues, security risks and potentially minimize operational costs of machine learning and language models training by leveraging the structure and capabilities of the NOSTR protocol. We begin by discussing some fundamental aspects of the NOSTR, and the core protocol application designed specifically for the social web.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A prominent challenge for social web applications is that of designing decentralized social networks through peer-to-peer architectures. Additionally, web 3.0 and blockchain implementations will either fail to scale or they will be highly centralized. Tokenized web 3.0 approaches introduce unnecessarily highly counter-party economic risk. Although decentralized payment systems require both blockchain and Proof-of-Work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> (or smart contracts) for asynchronous distributed consensus under faulty processes, it becomes more and more clear that other applications including decentralized social media and marketplaces for computational resources work securely and efficiently without blockchain or global consensus. In contrast, with peer-to-peer networks, web 3.0 and blockchain applications, the NOSTR protocol works efficiently as a social media protocol, because it does not require a majority of nodes of the network to share a common database of the data history. As a consequence, it is also economically efficient since it does not require any form of tokens and it does not hide any counter party risk. In summary, the NOSTR offers a censorship-resistance, open, public network structure, as a well as a digital IDs (DIDs) solution through cryptography and a novel protocol implementation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">At the core of the NOSTR, there are two main structural components: clients and relays. For social media applications, users run clients to participate in the network and interact/communicate with other users, through the user interface of the client application. This includes, but it is not limited to retrieving posts from other users, posting notes, accessing profiles of other users, re-posts, likes or even sending payments through the lightning network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. To guarantee uniqueness of identities, every user is identified by a public key <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Ownership of each identity is guaranteed through a private key that users generate locally <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Every post (or action) is signed by using the private key and every client validates these signatures.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.3" class="ltx_p">Users do not communicate directly with each other, but rather through relays and relays interact with users only. Relays listen only and propagate information. Although relays can not change the content (or action) of users, they can possibly act independently (with any other user or relay) and refuse to propagate pieces of information. The protocol is robust to such censorship attempts, since anyone including users can run one or multiple relays and users can choose an arbitrary set of relays to interact with. Also anyone can run their own relay. Clients retrieve and publish data from relays of their choice. As an example, assume that the User A "follows" a set S of Users, then the client just queries selected relays for posts from the public key of all users within the set S. That is, on startup a client queries data from all relays it knows for all users it follows (for example, all updates from the last day), then displays that data to the user chronologically. An event (user action, for instance a post or a like) can contain any kind of structured data, and clients choose how to display events (defined as any user generated action) of certain kind, while relays can handle them seamlessly. Examples of different kinds are simple note/post (kind <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\#1" display="inline"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S1.p5.1.m1.1.1.1" xref="S1.p5.1.m1.1.1.1.cmml">​</mo><mn id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><times id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1"></times><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">#</ci><cn type="integer" id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\#1</annotation></semantics></math>), re-post (kind <math id="S1.p5.2.m2.1" class="ltx_Math" alttext="\#6" display="inline"><semantics id="S1.p5.2.m2.1a"><mrow id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml"><mi mathvariant="normal" id="S1.p5.2.m2.1.1.2" xref="S1.p5.2.m2.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S1.p5.2.m2.1.1.1" xref="S1.p5.2.m2.1.1.1.cmml">​</mo><mn id="S1.p5.2.m2.1.1.3" xref="S1.p5.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1"><times id="S1.p5.2.m2.1.1.1.cmml" xref="S1.p5.2.m2.1.1.1"></times><ci id="S1.p5.2.m2.1.1.2.cmml" xref="S1.p5.2.m2.1.1.2">#</ci><cn type="integer" id="S1.p5.2.m2.1.1.3.cmml" xref="S1.p5.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">\#6</annotation></semantics></math>), reaction (kind <math id="S1.p5.3.m3.1" class="ltx_Math" alttext="\#7" display="inline"><semantics id="S1.p5.3.m3.1a"><mrow id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml"><mi mathvariant="normal" id="S1.p5.3.m3.1.1.2" xref="S1.p5.3.m3.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S1.p5.3.m3.1.1.1" xref="S1.p5.3.m3.1.1.1.cmml">​</mo><mn id="S1.p5.3.m3.1.1.3" xref="S1.p5.3.m3.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><apply id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1"><times id="S1.p5.3.m3.1.1.1.cmml" xref="S1.p5.3.m3.1.1.1"></times><ci id="S1.p5.3.m3.1.1.2.cmml" xref="S1.p5.3.m3.1.1.2">#</ci><cn type="integer" id="S1.p5.3.m3.1.1.3.cmml" xref="S1.p5.3.m3.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">\#7</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The NOSTR protocol offers flexible structure of messages through a customizable structure and different kind of events.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The orchestration of middleware systems to distribute computational tasks over wide-ranging networks marks a cornerstone in the evolution of distributed computing. A pivotal advancement in this area has been the development of grid computing. Emerging as a potent global cyber-infrastructure, grid computing is engineered to bolster the forthcoming wave of e-Science applications. By amalgamating large-scale, diverse, and distributed resources, it fosters a cooperative model for the sharing of computational power and data storage on an unprecedented scale. This cooperative paradigm paves the way for unparalleled computational and data management capabilities, enabling the execution of sophisticated scientific, engineering, and academic endeavors previously beyond reach.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Within the diverse ecosystem of grid computing frameworks, centralized systems such as Pegasus <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and Triana<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> have emerged as paragons. Pegasus, functioning as a workflow mapping engine, abstracts workflow execution from its underlying infrastructure, facilitating the seamless amalgamation of computational tasks across varied grid environments. This system is heralded for its ability to streamline and optimize complex workflows with remarkable efficiency. Conversely, Triana offers a dynamic platform for the composition of applications, harnessing distributed resources through meticulous integration and orchestration. These frameworks underscore the dynamic and adaptable nature of grid computing, illustrating its capacity to tackle complex challenges through the strategic leverage of distributed resources.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Concurrently, volunteer computing has established itself as an integral component within the broader spectrum of grid systems. The Berkeley Open Infrastructure for Network Computing (BOINC)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> stands as a testament to this model, capturing the essence of volunteer computing by mobilizing the latent processing power of personal computers worldwide for scientific research necessitating extensive computational resources. This model champions the democratization of scientific inquiry, inviting public engagement while significantly enhancing computational prowess without the need for equivalent infrastructural investment.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">The "BOINC: A Platform for Volunteer Computing" <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> discourse elucidates the enduring success of the BOINC project, spotlighting its sustained operation over the years as a beacon of collaborative scientific endeavor. This analysis brings to the forefront the prohibitive costs and reliability concerns associated with conventional cloud computing platforms, such as Amazon Web Services (AWS), which, despite their widespread adoption, pose financial and operational challenges for extensive, computation-intensive projects. Furthermore, the discourse addresses the intrinsic challenge of maintaining a robust volunteer base — a critical component for the sustenance of volunteer computing frameworks. The fluctuating levels of engagement and the logistical complexities of coordinating such a decentralized workforce underscore the necessity for innovative solutions to bolster volunteer retention and participation.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">To address the lack of incentives and participation in volunteer computing, reward based approaches have been introduced in prior works. For instance, Gridcoin<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> is a proof-of-stake cryptocurrency that rewards participants for contributing computational power to scientific research projects, notably through the Berkeley Open Infrastructure for Network Computing (BOINC) and Folding@Home. However, a proof-of-stake cryptocurrency may introduce several technical issues, since the payment network requires a global synchronized clock <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Such issues and significant outages become prominent in many non-proof-of-work blockchain systems (for instance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>).</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">While blockchain based approaches aim to provide innovative solutions to incentivize contributions in distributed computing, such approaches differ significantly from the NOSTR protocol. The NOSTR offers a broader set of capabilities, extending beyond the computational resource sharing model to include secure communications and permissionsless interaction between customers and service providers. In contrast with volunteer computing and proof-of-stake cryptocurency models, the decentralized protocol NOSTR integrates bitcoin through the lightning network and a dedicated protocol flow for payments. The NOSTR solves the user-to-user micro-payment problem, incentivizes honest collaborative computation, enables the possibility of an open market through instant, permissionless payments and presents a viable solution to the challenge of volunteer maintenance. These together with the secure and robust digital IDs implementation, make the NOSTR the state of the art protocol, capable of supporting a wide range of decentralized applications and services, offering a pathway to enhance viability, sustainability, and effectiveness.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>A Decentralized Marketplace for Distributed Computing</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">As the name of the protocol indicates (Notes and Other Stuff Transmitted by Relays), the type of communication messages and user-to-user interactions are not restricted to simple notes, and they support a variety of alternative applications including direct messaging, file sharing, audio/video streaming, collaborative writing, marketplaces for data processing and more <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Another example is that of marketplaces for data processing, where users interact with each other to execute AI algorithms. For the implementation of data processing on the NOSTR protocol, dedicated event kinds have been developed to facilitate distributed data processing (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>). These implementations have been considered for designing a decentralized AI-directories marketplace of the form "Money-In Data-Out". For instance, a customer can provide some input data, such as text or audio, and pay a service provider to receive a short summary of the input data. More specifically, the kinds in range <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\#5000-\#5999" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mrow id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.p1.1.m1.1.1.2.2" xref="S3.p1.1.m1.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.2.1" xref="S3.p1.1.m1.1.1.2.1.cmml">​</mo><mn id="S3.p1.1.m1.1.1.2.3" xref="S3.p1.1.m1.1.1.2.3.cmml">5000</mn></mrow><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">−</mo><mrow id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1.3.1" xref="S3.p1.1.m1.1.1.3.1.cmml">​</mo><mn id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml">5999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><minus id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></minus><apply id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2"><times id="S3.p1.1.m1.1.1.2.1.cmml" xref="S3.p1.1.m1.1.1.2.1"></times><ci id="S3.p1.1.m1.1.1.2.2.cmml" xref="S3.p1.1.m1.1.1.2.2">#</ci><cn type="integer" id="S3.p1.1.m1.1.1.2.3.cmml" xref="S3.p1.1.m1.1.1.2.3">5000</cn></apply><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><times id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3.1"></times><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">#</ci><cn type="integer" id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">5999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\#5000-\#5999</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> are reserved for text manipulation jobs including text extraction, summarising text, text generation and translation. Image generation corresponds to kind <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\#5100" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">​</mo><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">5100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><times id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></times><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">#</ci><cn type="integer" id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">5100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\#5100</annotation></semantics></math>, and video/audio manipulation corresponds to kinds in range <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="\#5200-\#5299" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mrow id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.2.1" xref="S3.p1.3.m3.1.1.2.1.cmml">​</mo><mn id="S3.p1.3.m3.1.1.2.3" xref="S3.p1.3.m3.1.1.2.3.cmml">5200</mn></mrow><mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">−</mo><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi mathvariant="normal" id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.1.3.1" xref="S3.p1.3.m3.1.1.3.1.cmml">​</mo><mn id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">5299</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><minus id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1"></minus><apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"><times id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.2.1"></times><ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">#</ci><cn type="integer" id="S3.p1.3.m3.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.2.3">5200</cn></apply><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><times id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3.1"></times><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">#</ci><cn type="integer" id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">5299</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\#5200-\#5299</annotation></semantics></math>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">In this work, we propose an extension of the protocol. Our goal is to design a decentralized marketplace for federated learning and LLMs training. In a nutshell, a customer provides a data-set, model specification and a required payment to a set of service providers. Then the service providers execute the model training, and they return the parameters of the model in order to receive the payment for their work (Money-In AI-Out). In other words, we propose a protocol flow for developing AI-Model Vending Machines (AI-VM), where a customer provides a data-set, a set of specifications, and submits a payment to a set of service providers to acquire a model trained on the input data-set. There are several components of the protocol that allow us to build upon existing protocol rules and design a decentralized marketplace. These include Digital IDs, payments, fast communication though websockets, a flexible protocol structure, also suitable for distributing computing. We proceed by briefly explaining these features.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Signatures &amp; Digital IDs</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The NOSTR identity is a dual-key cryptographic system <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, Schnorr Signatures]</cite>. Each user profile is associated with a private (nsec) and a public key (npub). These keys are generated locally without the need of a trusted party. Cryptographic keys are essential to the protocol security, ensuring the protection of user identities and messages. The private key is used to sign messages and other actions by the user, verifying that they originate from the authentic identity owner. On the other hand, the public key is employed to authenticate these messages, confirming that they were signed using the corresponding private key. Identically, to the social media applications, the same DID, private and public keys can be used for alternative applications, for instance private messaging applications, or marketplaces. This allows for a consistent and secure way to authenticate users DIDs and across different applications over the NOSTR protocol.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Nostr Digital Identity And Reputation:</h4>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">Owing a well known DID or building a solid reputation over the NOSTR offers the benefits of recognizability and trust from other users, similarly to all other online media platforms. Notably, this identity and its accompanying reputation can be seamlessly transferred between different applications. In the context of a marketplace, a good reputation can help a service provider maximize their profit. A high reputation indicates a consistent service, which in turn makes more customers trust the service provider, ensuring a steady stream of business. Alternatively, bad reputation may assist customers to avoid incompetent service providers. As a matter of fact, a reputation system for a decentralized and open marketplace for distributing computing will be valuable. However, this remains out of the scope of this work, but it is an interesting implementation possibility for future extensions of the protocol.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Protocol Design for Distributed Computing and AI Directories</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The NOSTR protocol supports a primal version of AI directories for data processing in the form of an open and decentralized marketplace <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, known as Data Vending Machines. On one side, there are users (customers) who provide some data that should be processed (image, video or text) and they request jobs that can be done with some AI tools, for instance image generation from text, a transcript of a video, a summary of an article. On the other side, there are AI agents (service providers) that offer their services to users, and in exchange for a payment, they deliver the requested results in the form of processed data. This system works in the form of Money-In Data-out; a marketplace for data processing/manipulation by applying AI tools. This design sets the foundations of distributed data processing over the NOSTR protocol and offers a unique protocol structure and flow for additional development.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Our goal is to utilize the existing architecture and to go one step further by extending components of the protocol if necessary, in order to design a decentralized marketplace for Federated Learning (FL) and Large Language Models (LLM) training. In what we propose later (see Section <a href="#S7" title="7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), users (customers) provide an input data-set and certain specifications and request a sequence of jobs that aim to train a deep neural network or an LLM model. Then service providers receive the data, model specifications and the requested task (train through regular FL or LLM training (e.g., via the DiLoCo algorithm) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>), they train the model through multiple rounds and jobs requests, and they return the model parameters. In exchange for their computational resources, the service providers receive recurrent payments from the customer upon delivering valid results. A main difference of our design in comparison with existing approaches is the concept of delivering a trained model instead of processed data; a set of service providers are required to optimize the same model in parallel and deliver valid results through multiple rounds of computation. For that purpose we extend the structure of protocol by introducing new event kinds, a new protocol flow and we deploy the classical FL approach, as well as the DiLoCo algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for LLM training. Next, we delve into the existing protocol structure for distributing computing over the NOSTR network. We also emphasize the modifications we introduce to support the Money-IN AI-Out marketplace design.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span> Distributed Computing on the NOSTR Protocol</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Herein, we discuss the existing dedicated protocol messages and protocol flow for distributed computing. We mainly focus on five components that we will utilize later with slight extensions or variations, these include job request events, job result events, job feedback events, events for service provider discoverability and job chaining rules. These type of events consist the core of the communication messages between customer and service providers. We refer the reader to the NOSTR Implementation Possibility - 90 (NIP-90 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>) for further details.</p>
</div>
<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Basic Protocol Flow for Data Vending Machines (DMVs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para">
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math id="S5.I1.i1.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I1.i1.1.1.m1.1b"><mo id="S5.I1.i1.1.1.m1.1.1" xref="S5.I1.i1.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i1.1.1.m1.1c"><ci id="S5.I1.i1.1.1.m1.1.1.cmml" xref="S5.I1.i1.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Customer publishes a job request (e.g. kind:5000, speech-to-text).</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math id="S5.I1.i2.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I1.i2.1.1.m1.1b"><mo id="S5.I1.i2.1.1.m1.1.1" xref="S5.I1.i2.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i2.1.1.m1.1c"><ci id="S5.I1.i2.1.1.m1.1.1.cmml" xref="S5.I1.i2.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Service Providers may submit job-feedback events (kind:7000, e.g. payment-required, processing, error, etc.).</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math id="S5.I1.i3.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I1.i3.1.1.m1.1b"><mo id="S5.I1.i3.1.1.m1.1.1" xref="S5.I1.i3.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i3.1.1.m1.1c"><ci id="S5.I1.i3.1.1.m1.1.1.cmml" xref="S5.I1.i3.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i3.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">Upon completion, the service provider publishes the result of the job with a job-result event (kind:6000).</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><math id="S5.I1.i4.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I1.i4.1.1.m1.1b"><mo id="S5.I1.i4.1.1.m1.1.1" xref="S5.I1.i4.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i4.1.1.m1.1c"><ci id="S5.I1.i4.1.1.m1.1.1.cmml" xref="S5.I1.i4.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">At any point, if there is an amount pending to be paid as instructed by the service provider, the user can pay the included bolt11 invoice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> of the job result event that the service provider has sent to the user.</p>
</div>
</li>
</ul>
</div>
<div id="S5.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p2.1" class="ltx_p">The above protocol is designed to be deliberately ambiguous. For instance a customer may choose a set of service providers and restrict or not restrict the job request to be completed by this specific set of service providers. Also, a service provider may not start a job until they receive a form of payment, or their response can depend on the other participants reputation based on their public key. The flexibility of the protocol flow allows us to extend parts of it, and implement additional communication steps for the design of on demand LLMs training over a decentralized marketplace. Next we proceed by presenting the existing events as appear in the protocol flow for DMVs.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Job Request (DVMs)</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p">A Job Request for Data Vending Mchines is an event, published by a customer through a set of relays. This event signals that a customer is interested in receiving the result of some kind of computation by an AI tool. The reserved range for job request events is <math id="S5.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\#5000-\#5999" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mrow id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.1.cmml">​</mo><mn id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">5000</mn></mrow><mo id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml">−</mo><mrow id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mn id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">5999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1"><minus id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.1"></minus><apply id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2"><times id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.1"></times><ci id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.2">#</ci><cn type="integer" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.2.3">5000</cn></apply><apply id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3"><times id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.1"></times><ci id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">#</ci><cn type="integer" id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.3.3">5999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.1.m1.1c">\#5000-\#5999</annotation></semantics></math>. The field with label "content" is empty, while, all the required information should be provided in the field with label "tags". The field "tags" contains all the required information from an AI-agent in order to process the data.

<span id="S5.SS1.SSS0.Px2.p1.1.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST1" class="ltx_float ltx_lstlisting">
<span id="LST1.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJraW5kIjogNXh4eCAvLyBraW5kIGluIHJhbmdlIDUwMDAgLSA1OTk5LAogICJjb250ZW50IjogIiIsCiAgInRhZ3MiOiAoKiRcYmlnWyQqKQogICAgICgqJFxiaWdbIFx0ZXh0eyJpIiwgIiA8ZGF0YT4gIiwgIjxpbnB1dC10eXBlPiwgIjxyZWxheT4iLCAiPG1hcmtlcj4ifSBcYmlnXSQqKSwKICAgICAoKiQgXGJpZ1sgXHRleHR7Im91dHB1dCIsICI8bWltZS10eXBlPiJ9IFxiaWddJCopLAogICAgICgqJCBcYmlnWyBcdGV4dHsicmVsYXlzIiwgIndzczovLy4uLiJ9IFxiaWddJCopLAogICAgICgqJCBcYmlnWyBcdGV4dHsiYmlkIiwgIjxtc2F0LWFtb3VudD4ifVxiaWddJCopLAogICAgICgqJCBcYmlnW1x0ZXh0eyJ0IiwgImJpdGNvaW4ifSBcYmlnXSQqKQogICgqJFxiaWddJCopCn0=" download="">⬇</a></span>
<span id="lstnumberx1" class="ltx_listingline">{
</span>
<span id="lstnumberx2" class="ltx_listingline"><span id="lstnumberx2.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx2.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx2.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx2.3.1" class="ltx_text ltx_lst_space"> </span>5xxx<span id="lstnumberx2.3.2" class="ltx_text ltx_lst_space"> </span>//<span id="lstnumberx2.3.3" class="ltx_text ltx_lst_space"> </span>kind<span id="lstnumberx2.3.4" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx2.3.5" class="ltx_text ltx_lst_space"> </span>range<span id="lstnumberx2.3.6" class="ltx_text ltx_lst_space"> </span>5000<span id="lstnumberx2.3.7" class="ltx_text ltx_lst_space"> </span>-<span id="lstnumberx2.3.8" class="ltx_text ltx_lst_space"> </span>5999,</span>
</span>
<span id="lstnumberx3" class="ltx_listingline"><span id="lstnumberx3.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx3.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx3.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx3.3.1" class="ltx_text ltx_lst_space"> </span>"",</span>
</span>
<span id="lstnumberx4" class="ltx_listingline"><span id="lstnumberx4.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx4.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx4.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx4.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx4.1.1.1" class="ltx_text"><math id="lstnumberx4.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx4.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx4.1.1.1.m1.1.1" xref="lstnumberx4.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx4.1.1.1.m1.1b"><ci id="lstnumberx4.1.1.1.m1.1.1.cmml" xref="lstnumberx4.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx4.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx5" class="ltx_listingline"><span id="lstnumberx5.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx5.1" class="ltx_text"><math id="lstnumberx5.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"i", " &lt;data&gt; ", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"}\big{]}' display="inline"><semantics id="lstnumberx5.1.m1.1a"><mrow id="lstnumberx5.1.m1.1.2.2" xref="lstnumberx5.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx5.1.m1.1.2.2.1" xref="lstnumberx5.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx5.1.m1.1.1" xref="lstnumberx5.1.m1.1.1a.cmml">"i", " &lt;data&gt; ", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx5.1.m1.1.2.2.2" xref="lstnumberx5.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx5.1.m1.1b"><apply id="lstnumberx5.1.m1.1.2.1.cmml" xref="lstnumberx5.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx5.1.m1.1.2.1.1.cmml" xref="lstnumberx5.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx5.1.m1.1.1a.cmml" xref="lstnumberx5.1.m1.1.1"><mtext id="lstnumberx5.1.m1.1.1.cmml" xref="lstnumberx5.1.m1.1.1">"i", " &lt;data&gt; ", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx5.1.m1.1c">\big{[}\text{"i", " &lt;data&gt; ", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx6" class="ltx_listingline"><span id="lstnumberx6.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx6.1" class="ltx_text"><math id="lstnumberx6.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"output", "&lt;mime-type&gt;"}\big{]}' display="inline"><semantics id="lstnumberx6.1.m1.1a"><mrow id="lstnumberx6.1.m1.1.2.2" xref="lstnumberx6.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx6.1.m1.1.2.2.1" xref="lstnumberx6.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx6.1.m1.1.1" xref="lstnumberx6.1.m1.1.1a.cmml">"output", "&lt;mime-type&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx6.1.m1.1.2.2.2" xref="lstnumberx6.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx6.1.m1.1b"><apply id="lstnumberx6.1.m1.1.2.1.cmml" xref="lstnumberx6.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx6.1.m1.1.2.1.1.cmml" xref="lstnumberx6.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx6.1.m1.1.1a.cmml" xref="lstnumberx6.1.m1.1.1"><mtext id="lstnumberx6.1.m1.1.1.cmml" xref="lstnumberx6.1.m1.1.1">"output", "&lt;mime-type&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx6.1.m1.1c">\big{[}\text{"output", "&lt;mime-type&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx7" class="ltx_listingline"><span id="lstnumberx7.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx7.1" class="ltx_text"><math id="lstnumberx7.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"relays", "wss://..."}\big{]}' display="inline"><semantics id="lstnumberx7.1.m1.1a"><mrow id="lstnumberx7.1.m1.1.2.2" xref="lstnumberx7.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx7.1.m1.1.2.2.1" xref="lstnumberx7.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx7.1.m1.1.1" xref="lstnumberx7.1.m1.1.1a.cmml">"relays", "wss://…"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx7.1.m1.1.2.2.2" xref="lstnumberx7.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx7.1.m1.1b"><apply id="lstnumberx7.1.m1.1.2.1.cmml" xref="lstnumberx7.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx7.1.m1.1.2.1.1.cmml" xref="lstnumberx7.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx7.1.m1.1.1a.cmml" xref="lstnumberx7.1.m1.1.1"><mtext id="lstnumberx7.1.m1.1.1.cmml" xref="lstnumberx7.1.m1.1.1">"relays", "wss://…"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx7.1.m1.1c">\big{[}\text{"relays", "wss://..."}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx8" class="ltx_listingline"><span id="lstnumberx8.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx8.1" class="ltx_text"><math id="lstnumberx8.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"bid", "&lt;msat-amount&gt;"}\big{]}' display="inline"><semantics id="lstnumberx8.1.m1.1a"><mrow id="lstnumberx8.1.m1.1.2.2" xref="lstnumberx8.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx8.1.m1.1.2.2.1" xref="lstnumberx8.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx8.1.m1.1.1" xref="lstnumberx8.1.m1.1.1a.cmml">"bid", "&lt;msat-amount&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx8.1.m1.1.2.2.2" xref="lstnumberx8.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx8.1.m1.1b"><apply id="lstnumberx8.1.m1.1.2.1.cmml" xref="lstnumberx8.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx8.1.m1.1.2.1.1.cmml" xref="lstnumberx8.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx8.1.m1.1.1a.cmml" xref="lstnumberx8.1.m1.1.1"><mtext id="lstnumberx8.1.m1.1.1.cmml" xref="lstnumberx8.1.m1.1.1">"bid", "&lt;msat-amount&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx8.1.m1.1c">\big{[}\text{"bid", "&lt;msat-amount&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx9" class="ltx_listingline"><span id="lstnumberx9.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx9.1" class="ltx_text"><math id="lstnumberx9.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"t", "bitcoin"}\big{]}' display="inline"><semantics id="lstnumberx9.1.m1.1a"><mrow id="lstnumberx9.1.m1.1.2.2" xref="lstnumberx9.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx9.1.m1.1.2.2.1" xref="lstnumberx9.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx9.1.m1.1.1" xref="lstnumberx9.1.m1.1.1a.cmml">"t", "bitcoin"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx9.1.m1.1.2.2.2" xref="lstnumberx9.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx9.1.m1.1b"><apply id="lstnumberx9.1.m1.1.2.1.cmml" xref="lstnumberx9.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx9.1.m1.1.2.1.1.cmml" xref="lstnumberx9.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx9.1.m1.1.1a.cmml" xref="lstnumberx9.1.m1.1.1"><mtext id="lstnumberx9.1.m1.1.1.cmml" xref="lstnumberx9.1.m1.1.1">"t", "bitcoin"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx9.1.m1.1c">\big{[}\text{"t", "bitcoin"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx10" class="ltx_listingline"><span id="lstnumberx10.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx10.1" class="ltx_text"><math id="lstnumberx10.1.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx10.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx10.1.m1.1.1" xref="lstnumberx10.1.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx10.1.m1.1b"><ci id="lstnumberx10.1.m1.1.1.cmml" xref="lstnumberx10.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx10.1.m1.1c">\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx11" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 1: </span>Job Request Event with kind in range 5000 -5999</span>
</span>
<span id="S5.SS1.SSS0.Px2.p1.1.1.1" class="ltx_p">For completeness, we provide additional explanation regarding each tag of the events. We first present the existing events structure. Then we introduce any necessary changes or additions that we will consider in the protocol flow and in the algorithm. For the Job Request event (Event Type <a href="#LST1" title="Event Type 1 ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) there are the following tags:
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.1" class="ltx_ERROR undefined">{outline}</span><span id="S5.SS1.SSS0.Px2.p1.1.1.1.2" class="ltx_ERROR undefined">\1</span> &lt;i&gt;: All the required input data for the job appear here. Specifically, the inputs of the AI algorithm.

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.3" class="ltx_ERROR undefined">\2</span> &lt;data&gt;: The argument for the input.
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.4" class="ltx_ERROR undefined">\2</span> &lt;input-type&gt;: The type of the argument input, it must be one of the following:
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.5" class="ltx_ERROR undefined">\3</span> url: A URL to be fetched of the data that should be processed.
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.6" class="ltx_ERROR undefined">\3</span> event: A Nostr event ID.
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.7" class="ltx_ERROR undefined">\3</span> job: The output of a previous job with the specified event ID. The determination of which output to build upon is up to the service provider to decide (e.g. waiting for a signaling from the customer, waiting for a payment, etc.)
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.8" class="ltx_ERROR undefined">\3</span> text: &lt;data&gt; is the value of the input, no resolution is needed

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.9" class="ltx_ERROR undefined">\1</span> &lt;relay&gt;: The relay where the event/job was published

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.10" class="ltx_ERROR undefined">\1</span> &lt;marker&gt;: An optional field indicating how this input should be used within the context of the job

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.11" class="ltx_ERROR undefined">\1</span> &lt;output&gt;: Expected output format. 
<span id="S5.SS1.SSS0.Px2.p1.1.1.1.12" class="ltx_ERROR undefined">\1</span> &lt;param&gt;: Optional parameters for the job. Different job request kind defines this more precisely. (e.g. [ "task", "run option", "initial state" ]).

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.13" class="ltx_ERROR undefined">\1</span> &lt;bid&gt;: Customer MAY specify a maximum amount (in millisats) they are willing to pay

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.14" class="ltx_ERROR undefined">\1</span> &lt;relays&gt;: List of relays where Service Providers SHOULD publish responses to.

<span id="S5.SS1.SSS0.Px2.p1.1.1.1.15" class="ltx_ERROR undefined">\1</span> p: Service providers the customer is interested in. Other service providers might still choose to process the job.</span>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Job Request (AI VMs)</h4>

<span id="S5.SS1.SSS0.Px3.p1" class="ltx_para">
<span id="S5.SS1.SSS0.Px3.p1.1" class="ltx_p">The existing job request events include a large number of different jobs, dedicated to data processing applications. Such job request have a certain structure (see Event Type <a href="#LST1" title="Event Type 1 ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). For clarity and for efficacy of our approach, we propose to introduce the kinds 8000 - 8999 as Job Request events for federated learning, LLM training and distributed optimization. Although, each kind can correspond at a different algorithm or variation of an algorithm, specific details can be considered by introducing additional fields in the tags. As an example, notice that the predefined structure of Event Type <a href="#LST1" title="Event Type 1 ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, requires a single input data type as we discussed earlier, while additional information may be included in parameters field (&lt;param&gt;).</span>
</span>
<span id="S5.SS1.SSS0.Px3.p2" class="ltx_para">
<span id="S5.SS1.SSS0.Px3.p2.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST2" class="ltx_float ltx_lstlisting">
<span id="LST2.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJraW5kIjogOHh4eCAvLyBraW5kIGluIHJhbmdlICQ4MDAwIC0gODk5OSQsCiAgImNvbnRlbnQiOiAiIiwKICAidGFncyI6ICgqJFxiaWdbJCopCiAgICAgKCokXGJpZ1sgXHRleHR7ImkiLCAiPGRhdGE+IiwgIjxpbnB1dC10eXBlPiwgIjxyZWxheT4iLCAiPG1hcmtlcj4ifSBcYmlnXSQqKSwKICAgICAoKiQgXGJpZ1sgXHRleHR7Im91dHB1dCIsICI8bW9kZWwtcGFyYW1ldGVycy10eXBlPiIsfSBcYmlnXSQqKSwKICAgICAoKiQgXGJpZ1sgXHRleHR7InJlbGF5cyIsICJ3c3M6Ly8uLi4ifSBcYmlnXSQqKSwKICAgICAoKiQgXGJpZ1sgXHRleHR7ImJpZCIsICI8bXNhdC1hbW91bnQ+In1cYmlnXSQqKSwKICAgICAoKiQgXGJpZ1tcdGV4dHsidCIsICJiaXRjb2luIn0gXGJpZ10kKikKICAgICAoKiQgXGJpZ1tcdGV4dHsicCIsICI8c2VydmljZS1wcm92aWRlcihzKS1wdWJsaWMta2V5KHMpPiJ9IFxiaWddJCopCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0idGFzayIsICJJbm5lci1vci1PdXRlciJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0icnVuIG9wdGlvbiIsICJGZXZhdmctb3ItRGlMb0NvIn1cYmlnXSQqKQogICAgICgqJCBcYmlnW1x0ZXh0eyJwYXJhbSIsIFxjb2xvcntyZWR9ImRhdGFcX3NldCIsICI8VVJMPiJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0iaW5pdGlhbC9jdXJyZW50LW1vZGVsLXN0YXRlIiwgIjxyYXctZGF0YT4ifVxiaWddJCopCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0ibW9kZWwiLCAiTExhTUEtMiJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0ic291cmNlXF9jb2RlIiwgIjxVUkw+In1cYmlnXSQqKSwKICAgICAoKiQgXGJpZ1tcdGV4dHsicGFyYW0iLCBcY29sb3J7cmVkfSJleHBlY3RlZFxfZXhlY3V0aW9uXF90aW1lIiwgIjx0aW1lPiJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0icmVjb21tZW5kZWRcX2hhcmR3YXJlXF9zcGVjaWZpY2F0aW9uIiwgIjx0ZXh0PiJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0idmFsaWRhdGlvblxfcnVsZXNcX2ZvclxfdGhlXF9vdXRwdXQiLCAiPFVSTD4ifVxiaWddJCopCiAgICAgKCokIFxiaWdbXHRleHR7InBhcmFtIiwgXGNvbG9ye3JlZH0idGltZS1vdXQtc3BlY2lmaWNhdGlvbiIsICJtYXgtdGltZT4ifVxiaWddJCopCiAgKCokXGJpZ10kKikKfQ==" download="">⬇</a></span>
<span id="lstnumberx12" class="ltx_listingline">{
</span>
<span id="lstnumberx13" class="ltx_listingline"><span id="lstnumberx13.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx13.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx13.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx13.3.1" class="ltx_text ltx_lst_space"> </span>8xxx<span id="lstnumberx13.3.2" class="ltx_text ltx_lst_space"> </span>//<span id="lstnumberx13.3.3" class="ltx_text ltx_lst_space"> </span>kind<span id="lstnumberx13.3.4" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx13.3.5" class="ltx_text ltx_lst_space"> </span>range<span id="lstnumberx13.3.6" class="ltx_text ltx_lst_space"> </span>$8000<span id="lstnumberx13.3.7" class="ltx_text ltx_lst_space"> </span>-<span id="lstnumberx13.3.8" class="ltx_text ltx_lst_space"> </span>8999$,</span>
</span>
<span id="lstnumberx14" class="ltx_listingline"><span id="lstnumberx14.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx14.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx14.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx14.3.1" class="ltx_text ltx_lst_space"> </span>"",</span>
</span>
<span id="lstnumberx15" class="ltx_listingline"><span id="lstnumberx15.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx15.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx15.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx15.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx15.1.1.1" class="ltx_text"><math id="lstnumberx15.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx15.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx15.1.1.1.m1.1.1" xref="lstnumberx15.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx15.1.1.1.m1.1b"><ci id="lstnumberx15.1.1.1.m1.1.1.cmml" xref="lstnumberx15.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx15.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx16" class="ltx_listingline"><span id="lstnumberx16.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx16.1" class="ltx_text"><math id="lstnumberx16.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"i", "&lt;data&gt;", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"}\big{]}' display="inline"><semantics id="lstnumberx16.1.m1.1a"><mrow id="lstnumberx16.1.m1.1.2.2" xref="lstnumberx16.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx16.1.m1.1.2.2.1" xref="lstnumberx16.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx16.1.m1.1.1" xref="lstnumberx16.1.m1.1.1a.cmml">"i", "&lt;data&gt;", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx16.1.m1.1.2.2.2" xref="lstnumberx16.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx16.1.m1.1b"><apply id="lstnumberx16.1.m1.1.2.1.cmml" xref="lstnumberx16.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx16.1.m1.1.2.1.1.cmml" xref="lstnumberx16.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx16.1.m1.1.1a.cmml" xref="lstnumberx16.1.m1.1.1"><mtext id="lstnumberx16.1.m1.1.1.cmml" xref="lstnumberx16.1.m1.1.1">"i", "&lt;data&gt;", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx16.1.m1.1c">\big{[}\text{"i", "&lt;data&gt;", "&lt;input-type&gt;, "&lt;relay&gt;", "&lt;marker&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx17" class="ltx_listingline"><span id="lstnumberx17.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx17.1" class="ltx_text"><math id="lstnumberx17.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"output", "&lt;model-parameters-type&gt;",}\big{]}' display="inline"><semantics id="lstnumberx17.1.m1.1a"><mrow id="lstnumberx17.1.m1.1.2.2" xref="lstnumberx17.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx17.1.m1.1.2.2.1" xref="lstnumberx17.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx17.1.m1.1.1" xref="lstnumberx17.1.m1.1.1a.cmml">"output", "&lt;model-parameters-type&gt;",</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx17.1.m1.1.2.2.2" xref="lstnumberx17.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx17.1.m1.1b"><apply id="lstnumberx17.1.m1.1.2.1.cmml" xref="lstnumberx17.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx17.1.m1.1.2.1.1.cmml" xref="lstnumberx17.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx17.1.m1.1.1a.cmml" xref="lstnumberx17.1.m1.1.1"><mtext id="lstnumberx17.1.m1.1.1.cmml" xref="lstnumberx17.1.m1.1.1">"output", "&lt;model-parameters-type&gt;",</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx17.1.m1.1c">\big{[}\text{"output", "&lt;model-parameters-type&gt;",}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx18" class="ltx_listingline"><span id="lstnumberx18.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx18.1" class="ltx_text"><math id="lstnumberx18.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"relays", "wss://..."}\big{]}' display="inline"><semantics id="lstnumberx18.1.m1.1a"><mrow id="lstnumberx18.1.m1.1.2.2" xref="lstnumberx18.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx18.1.m1.1.2.2.1" xref="lstnumberx18.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx18.1.m1.1.1" xref="lstnumberx18.1.m1.1.1a.cmml">"relays", "wss://…"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx18.1.m1.1.2.2.2" xref="lstnumberx18.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx18.1.m1.1b"><apply id="lstnumberx18.1.m1.1.2.1.cmml" xref="lstnumberx18.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx18.1.m1.1.2.1.1.cmml" xref="lstnumberx18.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx18.1.m1.1.1a.cmml" xref="lstnumberx18.1.m1.1.1"><mtext id="lstnumberx18.1.m1.1.1.cmml" xref="lstnumberx18.1.m1.1.1">"relays", "wss://…"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx18.1.m1.1c">\big{[}\text{"relays", "wss://..."}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx19" class="ltx_listingline"><span id="lstnumberx19.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx19.1" class="ltx_text"><math id="lstnumberx19.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"bid", "&lt;msat-amount&gt;"}\big{]}' display="inline"><semantics id="lstnumberx19.1.m1.1a"><mrow id="lstnumberx19.1.m1.1.2.2" xref="lstnumberx19.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx19.1.m1.1.2.2.1" xref="lstnumberx19.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx19.1.m1.1.1" xref="lstnumberx19.1.m1.1.1a.cmml">"bid", "&lt;msat-amount&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx19.1.m1.1.2.2.2" xref="lstnumberx19.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx19.1.m1.1b"><apply id="lstnumberx19.1.m1.1.2.1.cmml" xref="lstnumberx19.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx19.1.m1.1.2.1.1.cmml" xref="lstnumberx19.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx19.1.m1.1.1a.cmml" xref="lstnumberx19.1.m1.1.1"><mtext id="lstnumberx19.1.m1.1.1.cmml" xref="lstnumberx19.1.m1.1.1">"bid", "&lt;msat-amount&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx19.1.m1.1c">\big{[}\text{"bid", "&lt;msat-amount&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx20" class="ltx_listingline"><span id="lstnumberx20.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx20.1" class="ltx_text"><math id="lstnumberx20.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"t", "bitcoin"}\big{]}' display="inline"><semantics id="lstnumberx20.1.m1.1a"><mrow id="lstnumberx20.1.m1.1.2.2" xref="lstnumberx20.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx20.1.m1.1.2.2.1" xref="lstnumberx20.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx20.1.m1.1.1" xref="lstnumberx20.1.m1.1.1a.cmml">"t", "bitcoin"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx20.1.m1.1.2.2.2" xref="lstnumberx20.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx20.1.m1.1b"><apply id="lstnumberx20.1.m1.1.2.1.cmml" xref="lstnumberx20.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx20.1.m1.1.2.1.1.cmml" xref="lstnumberx20.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx20.1.m1.1.1a.cmml" xref="lstnumberx20.1.m1.1.1"><mtext id="lstnumberx20.1.m1.1.1.cmml" xref="lstnumberx20.1.m1.1.1">"t", "bitcoin"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx20.1.m1.1c">\big{[}\text{"t", "bitcoin"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx21" class="ltx_listingline"><span id="lstnumberx21.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx21.1" class="ltx_text"><math id="lstnumberx21.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"p", "&lt;service-provider(s)-public-key(s)&gt;"}\big{]}' display="inline"><semantics id="lstnumberx21.1.m1.1a"><mrow id="lstnumberx21.1.m1.1.2.2" xref="lstnumberx21.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx21.1.m1.1.2.2.1" xref="lstnumberx21.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx21.1.m1.1.1" xref="lstnumberx21.1.m1.1.1a.cmml">"p", "&lt;service-provider(s)-public-key(s)&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx21.1.m1.1.2.2.2" xref="lstnumberx21.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx21.1.m1.1b"><apply id="lstnumberx21.1.m1.1.2.1.cmml" xref="lstnumberx21.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx21.1.m1.1.2.1.1.cmml" xref="lstnumberx21.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx21.1.m1.1.1a.cmml" xref="lstnumberx21.1.m1.1.1"><mtext id="lstnumberx21.1.m1.1.1.cmml" xref="lstnumberx21.1.m1.1.1">"p", "&lt;service-provider(s)-public-key(s)&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx21.1.m1.1c">\big{[}\text{"p", "&lt;service-provider(s)-public-key(s)&gt;"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx22" class="ltx_listingline"><span id="lstnumberx22.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx22.1" class="ltx_text"><math id="lstnumberx22.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"task", "Inner-or-Outer"}\big{]}' display="inline"><semantics id="lstnumberx22.1.m1.1a"><mrow id="lstnumberx22.1.m1.1.2.2" xref="lstnumberx22.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx22.1.m1.1.2.2.1" xref="lstnumberx22.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx22.1.m1.1.1" xref="lstnumberx22.1.m1.1.1c.cmml"><mtext id="lstnumberx22.1.m1.1.1a" xref="lstnumberx22.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx22.1.m1.1.1b" xref="lstnumberx22.1.m1.1.1c.cmml">"task", "Inner-or-Outer"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx22.1.m1.1.2.2.2" xref="lstnumberx22.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx22.1.m1.1b"><apply id="lstnumberx22.1.m1.1.2.1.cmml" xref="lstnumberx22.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx22.1.m1.1.2.1.1.cmml" xref="lstnumberx22.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx22.1.m1.1.1c.cmml" xref="lstnumberx22.1.m1.1.1"><mrow id="lstnumberx22.1.m1.1.1.cmml" xref="lstnumberx22.1.m1.1.1"><mtext id="lstnumberx22.1.m1.1.1a.cmml" xref="lstnumberx22.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx22.1.m1.1.1b.cmml" xref="lstnumberx22.1.m1.1.1">"task", "Inner-or-Outer"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx22.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"task", "Inner-or-Outer"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx23" class="ltx_listingline"><span id="lstnumberx23.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx23.1" class="ltx_text"><math id="lstnumberx23.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"run option", "Fevavg-or-DiLoCo"}\big{]}' display="inline"><semantics id="lstnumberx23.1.m1.1a"><mrow id="lstnumberx23.1.m1.1.2.2" xref="lstnumberx23.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx23.1.m1.1.2.2.1" xref="lstnumberx23.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx23.1.m1.1.1" xref="lstnumberx23.1.m1.1.1c.cmml"><mtext id="lstnumberx23.1.m1.1.1a" xref="lstnumberx23.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx23.1.m1.1.1b" xref="lstnumberx23.1.m1.1.1c.cmml">"run option", "Fevavg-or-DiLoCo"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx23.1.m1.1.2.2.2" xref="lstnumberx23.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx23.1.m1.1b"><apply id="lstnumberx23.1.m1.1.2.1.cmml" xref="lstnumberx23.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx23.1.m1.1.2.1.1.cmml" xref="lstnumberx23.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx23.1.m1.1.1c.cmml" xref="lstnumberx23.1.m1.1.1"><mrow id="lstnumberx23.1.m1.1.1.cmml" xref="lstnumberx23.1.m1.1.1"><mtext id="lstnumberx23.1.m1.1.1a.cmml" xref="lstnumberx23.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx23.1.m1.1.1b.cmml" xref="lstnumberx23.1.m1.1.1">"run option", "Fevavg-or-DiLoCo"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx23.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"run option", "Fevavg-or-DiLoCo"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx24" class="ltx_listingline"><span id="lstnumberx24.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx24.1" class="ltx_text"><math id="lstnumberx24.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"data\_set", "&lt;URL&gt;"}\big{]}' display="inline"><semantics id="lstnumberx24.1.m1.1a"><mrow id="lstnumberx24.1.m1.1.2.2" xref="lstnumberx24.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx24.1.m1.1.2.2.1" xref="lstnumberx24.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx24.1.m1.1.1" xref="lstnumberx24.1.m1.1.1c.cmml"><mtext id="lstnumberx24.1.m1.1.1a" xref="lstnumberx24.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx24.1.m1.1.1b" xref="lstnumberx24.1.m1.1.1c.cmml">"data_set", "&lt;URL&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx24.1.m1.1.2.2.2" xref="lstnumberx24.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx24.1.m1.1b"><apply id="lstnumberx24.1.m1.1.2.1.cmml" xref="lstnumberx24.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx24.1.m1.1.2.1.1.cmml" xref="lstnumberx24.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx24.1.m1.1.1c.cmml" xref="lstnumberx24.1.m1.1.1"><mrow id="lstnumberx24.1.m1.1.1.cmml" xref="lstnumberx24.1.m1.1.1"><mtext id="lstnumberx24.1.m1.1.1a.cmml" xref="lstnumberx24.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx24.1.m1.1.1b.cmml" xref="lstnumberx24.1.m1.1.1">"data_set", "&lt;URL&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx24.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"data\_set", "&lt;URL&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx25" class="ltx_listingline"><span id="lstnumberx25.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx25.1" class="ltx_text"><math id="lstnumberx25.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"initial/current-model-state", "&lt;raw-data&gt;"}\big{]}' display="inline"><semantics id="lstnumberx25.1.m1.1a"><mrow id="lstnumberx25.1.m1.1.2.2" xref="lstnumberx25.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx25.1.m1.1.2.2.1" xref="lstnumberx25.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx25.1.m1.1.1" xref="lstnumberx25.1.m1.1.1c.cmml"><mtext id="lstnumberx25.1.m1.1.1a" xref="lstnumberx25.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx25.1.m1.1.1b" xref="lstnumberx25.1.m1.1.1c.cmml">"initial/current-model-state", "&lt;raw-data&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx25.1.m1.1.2.2.2" xref="lstnumberx25.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx25.1.m1.1b"><apply id="lstnumberx25.1.m1.1.2.1.cmml" xref="lstnumberx25.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx25.1.m1.1.2.1.1.cmml" xref="lstnumberx25.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx25.1.m1.1.1c.cmml" xref="lstnumberx25.1.m1.1.1"><mrow id="lstnumberx25.1.m1.1.1.cmml" xref="lstnumberx25.1.m1.1.1"><mtext id="lstnumberx25.1.m1.1.1a.cmml" xref="lstnumberx25.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx25.1.m1.1.1b.cmml" xref="lstnumberx25.1.m1.1.1">"initial/current-model-state", "&lt;raw-data&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx25.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"initial/current-model-state", "&lt;raw-data&gt;"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx26" class="ltx_listingline"><span id="lstnumberx26.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx26.1" class="ltx_text"><math id="lstnumberx26.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"model", "LLaMA-2"}\big{]}' display="inline"><semantics id="lstnumberx26.1.m1.1a"><mrow id="lstnumberx26.1.m1.1.2.2" xref="lstnumberx26.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx26.1.m1.1.2.2.1" xref="lstnumberx26.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx26.1.m1.1.1" xref="lstnumberx26.1.m1.1.1c.cmml"><mtext id="lstnumberx26.1.m1.1.1a" xref="lstnumberx26.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx26.1.m1.1.1b" xref="lstnumberx26.1.m1.1.1c.cmml">"model", "LLaMA-2"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx26.1.m1.1.2.2.2" xref="lstnumberx26.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx26.1.m1.1b"><apply id="lstnumberx26.1.m1.1.2.1.cmml" xref="lstnumberx26.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx26.1.m1.1.2.1.1.cmml" xref="lstnumberx26.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx26.1.m1.1.1c.cmml" xref="lstnumberx26.1.m1.1.1"><mrow id="lstnumberx26.1.m1.1.1.cmml" xref="lstnumberx26.1.m1.1.1"><mtext id="lstnumberx26.1.m1.1.1a.cmml" xref="lstnumberx26.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx26.1.m1.1.1b.cmml" xref="lstnumberx26.1.m1.1.1">"model", "LLaMA-2"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx26.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"model", "LLaMA-2"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx27" class="ltx_listingline"><span id="lstnumberx27.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx27.1" class="ltx_text"><math id="lstnumberx27.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"source\_code", "&lt;URL&gt;"}\big{]}' display="inline"><semantics id="lstnumberx27.1.m1.1a"><mrow id="lstnumberx27.1.m1.1.2.2" xref="lstnumberx27.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx27.1.m1.1.2.2.1" xref="lstnumberx27.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx27.1.m1.1.1" xref="lstnumberx27.1.m1.1.1c.cmml"><mtext id="lstnumberx27.1.m1.1.1a" xref="lstnumberx27.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx27.1.m1.1.1b" xref="lstnumberx27.1.m1.1.1c.cmml">"source_code", "&lt;URL&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx27.1.m1.1.2.2.2" xref="lstnumberx27.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx27.1.m1.1b"><apply id="lstnumberx27.1.m1.1.2.1.cmml" xref="lstnumberx27.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx27.1.m1.1.2.1.1.cmml" xref="lstnumberx27.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx27.1.m1.1.1c.cmml" xref="lstnumberx27.1.m1.1.1"><mrow id="lstnumberx27.1.m1.1.1.cmml" xref="lstnumberx27.1.m1.1.1"><mtext id="lstnumberx27.1.m1.1.1a.cmml" xref="lstnumberx27.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx27.1.m1.1.1b.cmml" xref="lstnumberx27.1.m1.1.1">"source_code", "&lt;URL&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx27.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"source\_code", "&lt;URL&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx28" class="ltx_listingline"><span id="lstnumberx28.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx28.1" class="ltx_text"><math id="lstnumberx28.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"expected\_execution\_time", "&lt;time&gt;"}\big{]}' display="inline"><semantics id="lstnumberx28.1.m1.1a"><mrow id="lstnumberx28.1.m1.1.2.2" xref="lstnumberx28.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx28.1.m1.1.2.2.1" xref="lstnumberx28.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx28.1.m1.1.1" xref="lstnumberx28.1.m1.1.1c.cmml"><mtext id="lstnumberx28.1.m1.1.1a" xref="lstnumberx28.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx28.1.m1.1.1b" xref="lstnumberx28.1.m1.1.1c.cmml">"expected_execution_time", "&lt;time&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx28.1.m1.1.2.2.2" xref="lstnumberx28.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx28.1.m1.1b"><apply id="lstnumberx28.1.m1.1.2.1.cmml" xref="lstnumberx28.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx28.1.m1.1.2.1.1.cmml" xref="lstnumberx28.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx28.1.m1.1.1c.cmml" xref="lstnumberx28.1.m1.1.1"><mrow id="lstnumberx28.1.m1.1.1.cmml" xref="lstnumberx28.1.m1.1.1"><mtext id="lstnumberx28.1.m1.1.1a.cmml" xref="lstnumberx28.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx28.1.m1.1.1b.cmml" xref="lstnumberx28.1.m1.1.1">"expected_execution_time", "&lt;time&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx28.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"expected\_execution\_time", "&lt;time&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx29" class="ltx_listingline"><span id="lstnumberx29.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx29.1" class="ltx_text"><math id="lstnumberx29.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"recommended\_hardware\_specification", "&lt;text&gt;"}\big{]}' display="inline"><semantics id="lstnumberx29.1.m1.1a"><mrow id="lstnumberx29.1.m1.1.2.2" xref="lstnumberx29.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx29.1.m1.1.2.2.1" xref="lstnumberx29.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx29.1.m1.1.1" xref="lstnumberx29.1.m1.1.1c.cmml"><mtext id="lstnumberx29.1.m1.1.1a" xref="lstnumberx29.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx29.1.m1.1.1b" xref="lstnumberx29.1.m1.1.1c.cmml">"recommended_hardware_specification", "&lt;text&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx29.1.m1.1.2.2.2" xref="lstnumberx29.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx29.1.m1.1b"><apply id="lstnumberx29.1.m1.1.2.1.cmml" xref="lstnumberx29.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx29.1.m1.1.2.1.1.cmml" xref="lstnumberx29.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx29.1.m1.1.1c.cmml" xref="lstnumberx29.1.m1.1.1"><mrow id="lstnumberx29.1.m1.1.1.cmml" xref="lstnumberx29.1.m1.1.1"><mtext id="lstnumberx29.1.m1.1.1a.cmml" xref="lstnumberx29.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx29.1.m1.1.1b.cmml" xref="lstnumberx29.1.m1.1.1">"recommended_hardware_specification", "&lt;text&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx29.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"recommended\_hardware\_specification", "&lt;text&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx30" class="ltx_listingline"><span id="lstnumberx30.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx30.1" class="ltx_text"><math id="lstnumberx30.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"validation\_rules\_for\_the\_output", "&lt;URL&gt;"}\big{]}' display="inline"><semantics id="lstnumberx30.1.m1.1a"><mrow id="lstnumberx30.1.m1.1.2.2" xref="lstnumberx30.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx30.1.m1.1.2.2.1" xref="lstnumberx30.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx30.1.m1.1.1" xref="lstnumberx30.1.m1.1.1c.cmml"><mtext id="lstnumberx30.1.m1.1.1a" xref="lstnumberx30.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx30.1.m1.1.1b" xref="lstnumberx30.1.m1.1.1c.cmml">"validation_rules_for_the_output", "&lt;URL&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx30.1.m1.1.2.2.2" xref="lstnumberx30.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx30.1.m1.1b"><apply id="lstnumberx30.1.m1.1.2.1.cmml" xref="lstnumberx30.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx30.1.m1.1.2.1.1.cmml" xref="lstnumberx30.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx30.1.m1.1.1c.cmml" xref="lstnumberx30.1.m1.1.1"><mrow id="lstnumberx30.1.m1.1.1.cmml" xref="lstnumberx30.1.m1.1.1"><mtext id="lstnumberx30.1.m1.1.1a.cmml" xref="lstnumberx30.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx30.1.m1.1.1b.cmml" xref="lstnumberx30.1.m1.1.1">"validation_rules_for_the_output", "&lt;URL&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx30.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"validation\_rules\_for\_the\_output", "&lt;URL&gt;"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx31" class="ltx_listingline"><span id="lstnumberx31.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx31.1" class="ltx_text"><math id="lstnumberx31.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"time-out-specification", "max-time&gt;"}\big{]}' display="inline"><semantics id="lstnumberx31.1.m1.1a"><mrow id="lstnumberx31.1.m1.1.2.2" xref="lstnumberx31.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx31.1.m1.1.2.2.1" xref="lstnumberx31.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx31.1.m1.1.1" xref="lstnumberx31.1.m1.1.1c.cmml"><mtext id="lstnumberx31.1.m1.1.1a" xref="lstnumberx31.1.m1.1.1c.cmml">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx31.1.m1.1.1b" xref="lstnumberx31.1.m1.1.1c.cmml">"time-out-specification", "max-time&gt;"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx31.1.m1.1.2.2.2" xref="lstnumberx31.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx31.1.m1.1b"><apply id="lstnumberx31.1.m1.1.2.1.cmml" xref="lstnumberx31.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx31.1.m1.1.2.1.1.cmml" xref="lstnumberx31.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx31.1.m1.1.1c.cmml" xref="lstnumberx31.1.m1.1.1"><mrow id="lstnumberx31.1.m1.1.1.cmml" xref="lstnumberx31.1.m1.1.1"><mtext id="lstnumberx31.1.m1.1.1a.cmml" xref="lstnumberx31.1.m1.1.1">"param", </mtext><mtext mathcolor="#FF0000" id="lstnumberx31.1.m1.1.1b.cmml" xref="lstnumberx31.1.m1.1.1">"time-out-specification", "max-time&gt;"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx31.1.m1.1c">\big{[}\text{"param", \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}"time-out-specification", "max-time&gt;"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx32" class="ltx_listingline"><span id="lstnumberx32.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx32.1" class="ltx_text"><math id="lstnumberx32.1.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx32.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx32.1.m1.1.1" xref="lstnumberx32.1.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx32.1.m1.1b"><ci id="lstnumberx32.1.m1.1.1.cmml" xref="lstnumberx32.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx32.1.m1.1c">\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx33" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 2: </span>Job Request Event for training AI models, kind in range 8000 -8999</span>
</span>
<span id="S5.SS1.SSS0.Px3.p2.1.1" class="ltx_p">Similarly, for the purpose of training an LLM, the customer needs to provide a training data-set though a URL as input data, and additionally a set of parameters related to the training task, for instance initial model parameters, a URL to the source code of the training or optimization method, model specification (example "LLaMA-2"), rules for validation of the output. To maintain the existing protocol flow as much as possible, we consider the input data as a URL to the training dataset for the initial job request, or the output of a previous job with a specified event job id to declare a job chaining and multiple rounds of training. In both cases (initial or chain job request), we consider all the required information for executing algorithm in the parameters fields for consistency. Below some pieces of that information follow (Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>):</span>
<span id="S5.I2" class="ltx_itemize">
<span id="S5.I2.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S5.I2.i1.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I2.i1.1.1.m1.1b"><mo id="S5.I2.i1.1.1.m1.1.1" xref="S5.I2.i1.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i1.1.1.m1.1c"><ci id="S5.I2.i1.1.1.m1.1.1.cmml" xref="S5.I2.i1.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i1.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S5.I2.i1.p1" class="ltx_para">
<span id="S5.I2.i1.p1.1" class="ltx_p">a source for the code: While the service provider may have its own code, there should be reference to a standard approach that guarantees consistency</span>
</span></span>
<span id="S5.I2.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S5.I2.i2.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I2.i2.1.1.m1.1b"><mo id="S5.I2.i2.1.1.m1.1.1" xref="S5.I2.i2.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i2.1.1.m1.1c"><ci id="S5.I2.i2.1.1.m1.1.1.cmml" xref="S5.I2.i2.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i2.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S5.I2.i2.p1" class="ltx_para">
<span id="S5.I2.i2.p1.1" class="ltx_p">a source for the data: The customer splits and sends an encrypted URL to the service providers. The customer decides how to split the data. The way of splitting the data may be arbitrary.</span>
</span></span>
<span id="S5.I2.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S5.I2.i3.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I2.i3.1.1.m1.1b"><mo id="S5.I2.i3.1.1.m1.1.1" xref="S5.I2.i3.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i3.1.1.m1.1c"><ci id="S5.I2.i3.1.1.m1.1.1.cmml" xref="S5.I2.i3.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i3.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S5.I2.i3.p1" class="ltx_para">
<span id="S5.I2.i3.p1.1" class="ltx_p">job details: expected execution type or hardware that is needed, rules related to time-out conditions.</span>
</span></span>
<span id="S5.I2.i4" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S5.I2.i4.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S5.I2.i4.1.1.m1.1b"><mo id="S5.I2.i4.1.1.m1.1.1" xref="S5.I2.i4.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i4.1.1.m1.1c"><ci id="S5.I2.i4.1.1.m1.1.1.cmml" xref="S5.I2.i4.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i4.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S5.I2.i4.p1" class="ltx_para">
<span id="S5.I2.i4.p1.1" class="ltx_p">Declaration of validation process. This is how the customer will decide if the output is accurate or not.</span>
</span></span>
</span>
<span id="S5.SS1.SSS0.Px3.p2.1.2" class="ltx_p">Through the optimization process we introduce a new job request at each round. We also consider job chaining to speed up the process and most likely to execute the training by assigning the jobs to the same service providers, as long as they provide valid outputs. A running job will be assigned to new service provider, if a previous service provider goes offline, or fails to provide valid result. Finally, the customer has the option to encrypt all the parameters, and only the selected service provider(s) in the tag "p" will be able to decrypt them. We proceed by briefly discussing the Job Chaining rules, for a detailed description we refer the reader to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, (NIP-90)]</cite>.</span>
<section id="S5.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Job Chaining</h4>

<span id="S5.SS1.SSS0.Px4.p1" class="ltx_para">
<span id="S5.SS1.SSS0.Px4.p1.1" class="ltx_p">A Customer has the option to request multiple rounds of jobs to be processed as a chain, where the output of a job is the input of another job. In the context of data processing and DMVs this can be a sequence of processing as a podcast transcription by one service provider and then extracting a summary of the transcription by another. One way to implement this is by specifying as input an event id of a different job with the job type. In general, service providers may begin processing a subsequent job the moment they see the prior job result, but they will likely wait to receive a (partial) payment first.</span>
</span>
<span id="S5.SS1.SSS0.Px4.p2" class="ltx_para">
<span id="S5.SS1.SSS0.Px4.p2.1" class="ltx_p">In the case of federated learning and LLM training such options still exist, however we propose certain protocol rules to minimize the risk introduced by bad actors and malicious users. To do this, we consider necessary for the customer to validate the progress made by each service provider at every single round. After the validation is completed, each service provider who produced successful results receives a partial payment for the work done in the corresponding round. Then the customer updates the current state of model and submits a follow-up job request for the next round (and optionally a partial payment to the service providers upfront). Upon completion of the optimization task at each round, the service providers communicate with the customer through a Job Result event.</span>
</span>
<section id="S5.SS1.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Job Result (kind: 6000-6999)</h4>

<span id="S5.SS1.SSS0.Px5.p1" class="ltx_para">
<span id="S5.SS1.SSS0.Px5.p1.1" class="ltx_p">Service providers communicate with the customer through Job Result events, by providing the (optionally) encrypted output of the job. In the case of AI training, the output corresponds to an optimized version of the model parameters. The format of the Job Result event appears in the Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> above. The tag of the Job Result event include the original job request event id (stringified-JSON), the public key of the customer, amount that the Service Provider is requesting to be paid or an lightning invoice (bolt11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>), and the optimized model parameter as an encrypted output. Finally, a tag "i" may be considered for additional information related to the initial job request or for validation of the output by the customer.

<span id="S5.SS1.SSS0.Px5.p1.1.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST3" class="ltx_float ltx_lstlisting">
<span id="LST3.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJwdWJrZXkiOiAiPHNlcnZpY2UtcHJvY2lkZXIgcHVia2V5PiIsCiAgImNvbnRlbnQiOiAiPGVuY3R5cHRlZCBwYXlsb2FkPiIsCiAgImtpbmQiOiA2eHh4IC8vIGtpbmQgaW4gcmFuZ2UgNjAwMCAtIDY5OTksCiAgInRhZ3MiOiAoKiRcYmlnWyQqKQogICAgICgqJFxiaWdbIFx0ZXh0eyJyZXF1ZXN0IiwgIiA8am9iLXJlcXVlc3Q+ICJ9IFxiaWddJCopLAogICAgICgqJCBcYmlnWyBcdGV4dHsiZSIsICI8am9iLXJlcXVlc3QtaWQ+IiwgIjxyZWxheS1oaW50PiJ9IFxiaWddJCopLAogICAgICgqJCBcYmlnWyBcdGV4dHsicCIsICI8Y3VzdG9tZXJzJ3MtcHVia2V5PiJ9IFxiaWddJCopLAogICAgICgqJCBcYmlnWyBcdGV4dHsiYW1vdW50IiwgInJlcXVlc3RlZC1wYXltZW50LWFtb3VudCIsICI8b3B0aW9uYWwtYm9sdDExPiJ9XGJpZ10kKiksCiAgICAgKCokIFxiaWdbIFx0ZXh0eyJpIiwgImFkZGl0aW9uYWwtaW5mb3JtYXRpb24tZm9yLXZhbGlkYXRpb24iLCAiPGluZm9ybWF0aW9uPiJ9XGJpZ10kKikKICAgICAoKiQgXGJpZ1tcdGV4dHsib3V0cHV0IiwgImVuY3J5cHRlZDogXGNvbG9ye3JlZH0gbW9kZWwgcGFyYW1ldGVycyAoYW5kIGxvc3MgZm9yIHZhbGlkYXRpb24gcHVycG9zZXMpIn0gXGJpZ10kKikKICAoKiRcYmlnXSwkKikKICAuLi4KfQ==" download="">⬇</a></span>
<span id="lstnumberx34" class="ltx_listingline">{
</span>
<span id="lstnumberx35" class="ltx_listingline"><span id="lstnumberx35.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx35.2" class="ltx_text ltx_lst_string" style="color:#003300;">"pubkey"</span><span id="lstnumberx35.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx35.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;service-procider<span id="lstnumberx35.3.2" class="ltx_text ltx_lst_space"> </span>pubkey&gt;",</span>
</span>
<span id="lstnumberx36" class="ltx_listingline"><span id="lstnumberx36.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx36.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx36.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx36.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;enctypted<span id="lstnumberx36.3.2" class="ltx_text ltx_lst_space"> </span>payload&gt;",</span>
</span>
<span id="lstnumberx37" class="ltx_listingline"><span id="lstnumberx37.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx37.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx37.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx37.3.1" class="ltx_text ltx_lst_space"> </span>6xxx<span id="lstnumberx37.3.2" class="ltx_text ltx_lst_space"> </span>//<span id="lstnumberx37.3.3" class="ltx_text ltx_lst_space"> </span>kind<span id="lstnumberx37.3.4" class="ltx_text ltx_lst_space"> </span>in<span id="lstnumberx37.3.5" class="ltx_text ltx_lst_space"> </span>range<span id="lstnumberx37.3.6" class="ltx_text ltx_lst_space"> </span>6000<span id="lstnumberx37.3.7" class="ltx_text ltx_lst_space"> </span>-<span id="lstnumberx37.3.8" class="ltx_text ltx_lst_space"> </span>6999,</span>
</span>
<span id="lstnumberx38" class="ltx_listingline"><span id="lstnumberx38.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx38.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx38.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx38.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx38.1.1.1" class="ltx_text"><math id="lstnumberx38.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx38.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx38.1.1.1.m1.1.1" xref="lstnumberx38.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx38.1.1.1.m1.1b"><ci id="lstnumberx38.1.1.1.m1.1.1.cmml" xref="lstnumberx38.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx38.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx39" class="ltx_listingline"><span id="lstnumberx39.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx39.1" class="ltx_text"><math id="lstnumberx39.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"request", " &lt;job-request&gt; "}\big{]}' display="inline"><semantics id="lstnumberx39.1.m1.1a"><mrow id="lstnumberx39.1.m1.1.2.2" xref="lstnumberx39.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx39.1.m1.1.2.2.1" xref="lstnumberx39.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx39.1.m1.1.1" xref="lstnumberx39.1.m1.1.1a.cmml">"request", " &lt;job-request&gt; "</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx39.1.m1.1.2.2.2" xref="lstnumberx39.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx39.1.m1.1b"><apply id="lstnumberx39.1.m1.1.2.1.cmml" xref="lstnumberx39.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx39.1.m1.1.2.1.1.cmml" xref="lstnumberx39.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx39.1.m1.1.1a.cmml" xref="lstnumberx39.1.m1.1.1"><mtext id="lstnumberx39.1.m1.1.1.cmml" xref="lstnumberx39.1.m1.1.1">"request", " &lt;job-request&gt; "</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx39.1.m1.1c">\big{[}\text{"request", " &lt;job-request&gt; "}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx40" class="ltx_listingline"><span id="lstnumberx40.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx40.1" class="ltx_text"><math id="lstnumberx40.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"e", "&lt;job-request-id&gt;", "&lt;relay-hint&gt;"}\big{]}' display="inline"><semantics id="lstnumberx40.1.m1.1a"><mrow id="lstnumberx40.1.m1.1.2.2" xref="lstnumberx40.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx40.1.m1.1.2.2.1" xref="lstnumberx40.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx40.1.m1.1.1" xref="lstnumberx40.1.m1.1.1a.cmml">"e", "&lt;job-request-id&gt;", "&lt;relay-hint&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx40.1.m1.1.2.2.2" xref="lstnumberx40.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx40.1.m1.1b"><apply id="lstnumberx40.1.m1.1.2.1.cmml" xref="lstnumberx40.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx40.1.m1.1.2.1.1.cmml" xref="lstnumberx40.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx40.1.m1.1.1a.cmml" xref="lstnumberx40.1.m1.1.1"><mtext id="lstnumberx40.1.m1.1.1.cmml" xref="lstnumberx40.1.m1.1.1">"e", "&lt;job-request-id&gt;", "&lt;relay-hint&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx40.1.m1.1c">\big{[}\text{"e", "&lt;job-request-id&gt;", "&lt;relay-hint&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx41" class="ltx_listingline"><span id="lstnumberx41.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx41.1" class="ltx_text"><math id="lstnumberx41.1.m1.1" class="ltx_Math" alttext="\big{[}\text{&quot;p&quot;, &quot;&lt;customers's-pubkey&gt;&quot;}\big{]}" display="inline"><semantics id="lstnumberx41.1.m1.1a"><mrow id="lstnumberx41.1.m1.1.2.2" xref="lstnumberx41.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx41.1.m1.1.2.2.1" xref="lstnumberx41.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx41.1.m1.1.1" xref="lstnumberx41.1.m1.1.1a.cmml">"p", "&lt;customers’s-pubkey&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx41.1.m1.1.2.2.2" xref="lstnumberx41.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx41.1.m1.1b"><apply id="lstnumberx41.1.m1.1.2.1.cmml" xref="lstnumberx41.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx41.1.m1.1.2.1.1.cmml" xref="lstnumberx41.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx41.1.m1.1.1a.cmml" xref="lstnumberx41.1.m1.1.1"><mtext id="lstnumberx41.1.m1.1.1.cmml" xref="lstnumberx41.1.m1.1.1">"p", "&lt;customers’s-pubkey&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx41.1.m1.1c">\big{[}\text{"p", "&lt;customers's-pubkey&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx42" class="ltx_listingline"><span id="lstnumberx42.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx42.1" class="ltx_text"><math id="lstnumberx42.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"amount", "requested-payment-amount", "&lt;optional-bolt11&gt;"}\big{]}' display="inline"><semantics id="lstnumberx42.1.m1.1a"><mrow id="lstnumberx42.1.m1.1.2.2" xref="lstnumberx42.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx42.1.m1.1.2.2.1" xref="lstnumberx42.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx42.1.m1.1.1" xref="lstnumberx42.1.m1.1.1a.cmml">"amount", "requested-payment-amount", "&lt;optional-bolt11&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx42.1.m1.1.2.2.2" xref="lstnumberx42.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx42.1.m1.1b"><apply id="lstnumberx42.1.m1.1.2.1.cmml" xref="lstnumberx42.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx42.1.m1.1.2.1.1.cmml" xref="lstnumberx42.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx42.1.m1.1.1a.cmml" xref="lstnumberx42.1.m1.1.1"><mtext id="lstnumberx42.1.m1.1.1.cmml" xref="lstnumberx42.1.m1.1.1">"amount", "requested-payment-amount", "&lt;optional-bolt11&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx42.1.m1.1c">\big{[}\text{"amount", "requested-payment-amount", "&lt;optional-bolt11&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx43" class="ltx_listingline"><span id="lstnumberx43.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx43.1" class="ltx_text"><math id="lstnumberx43.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"i", "additional-information-for-validation", "&lt;information&gt;"}\big{]}' display="inline"><semantics id="lstnumberx43.1.m1.1a"><mrow id="lstnumberx43.1.m1.1.2.2" xref="lstnumberx43.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx43.1.m1.1.2.2.1" xref="lstnumberx43.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx43.1.m1.1.1" xref="lstnumberx43.1.m1.1.1a.cmml">"i", "additional-information-for-validation", "&lt;information&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx43.1.m1.1.2.2.2" xref="lstnumberx43.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx43.1.m1.1b"><apply id="lstnumberx43.1.m1.1.2.1.cmml" xref="lstnumberx43.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx43.1.m1.1.2.1.1.cmml" xref="lstnumberx43.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx43.1.m1.1.1a.cmml" xref="lstnumberx43.1.m1.1.1"><mtext id="lstnumberx43.1.m1.1.1.cmml" xref="lstnumberx43.1.m1.1.1">"i", "additional-information-for-validation", "&lt;information&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx43.1.m1.1c">\big{[}\text{"i", "additional-information-for-validation", "&lt;information&gt;"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx44" class="ltx_listingline"><span id="lstnumberx44.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx44.1" class="ltx_text"><math id="lstnumberx44.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"output", "encrypted: \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0} model parameters (and loss for validation purposes)"}\big{]}' display="inline"><semantics id="lstnumberx44.1.m1.1a"><mrow id="lstnumberx44.1.m1.1.2.2" xref="lstnumberx44.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx44.1.m1.1.2.2.1" xref="lstnumberx44.1.m1.1.2.1.1.cmml">[</mo><mrow id="lstnumberx44.1.m1.1.1" xref="lstnumberx44.1.m1.1.1c.cmml"><mtext id="lstnumberx44.1.m1.1.1a" xref="lstnumberx44.1.m1.1.1c.cmml">"output", "encrypted: </mtext><mtext mathcolor="#FF0000" id="lstnumberx44.1.m1.1.1b" xref="lstnumberx44.1.m1.1.1c.cmml"> model parameters (and loss for validation purposes)"</mtext></mrow><mo maxsize="120%" minsize="120%" id="lstnumberx44.1.m1.1.2.2.2" xref="lstnumberx44.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx44.1.m1.1b"><apply id="lstnumberx44.1.m1.1.2.1.cmml" xref="lstnumberx44.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx44.1.m1.1.2.1.1.cmml" xref="lstnumberx44.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx44.1.m1.1.1c.cmml" xref="lstnumberx44.1.m1.1.1"><mrow id="lstnumberx44.1.m1.1.1.cmml" xref="lstnumberx44.1.m1.1.1"><mtext id="lstnumberx44.1.m1.1.1a.cmml" xref="lstnumberx44.1.m1.1.1">"output", "encrypted: </mtext><mtext mathcolor="#FF0000" id="lstnumberx44.1.m1.1.1b.cmml" xref="lstnumberx44.1.m1.1.1"> model parameters (and loss for validation purposes)"</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx44.1.m1.1c">\big{[}\text{"output", "encrypted: \color[rgb]{1,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0} model parameters (and loss for validation purposes)"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx45" class="ltx_listingline"><span id="lstnumberx45.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx45.1" class="ltx_text"><math id="lstnumberx45.1.m1.1" class="ltx_Math" alttext="\big{]}," display="inline"><semantics id="lstnumberx45.1.m1.1a"><mrow id="lstnumberx45.1.m1.1.2.2"><mo maxsize="120%" minsize="120%" id="lstnumberx45.1.m1.1.1" xref="lstnumberx45.1.m1.1.1.cmml">]</mo><mo id="lstnumberx45.1.m1.1.2.2.1">,</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx45.1.m1.1b"><ci id="lstnumberx45.1.m1.1.1.cmml" xref="lstnumberx45.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx45.1.m1.1c">\big{]},</annotation></semantics></math></span>
</span>
<span id="lstnumberx46" class="ltx_listingline"><span id="lstnumberx46.1" class="ltx_text ltx_lst_space">  </span>…
</span>
<span id="lstnumberx47" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 3: </span>Job Result Event</span>
</span>
<section id="S5.SS1.SSS0.Px6" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Job Feedback (kind:7000)</h4>

<span id="S5.SS1.SSS0.Px6.p1" class="ltx_para">
<span id="S5.SS1.SSS0.Px6.p1.1" class="ltx_p">During the model training process, service providers can communicate and provide feedback for an ongoing job through the Job Feedback event. The Job Feedback events may be considered in order to avoid time-outs and ensure that a service provider has achieved some partial progress. Information about partial progress can be optionally included by introducing additional fields in the tags of the event format in the Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.

<span id="S5.SS1.SSS0.Px6.p1.1.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST4" class="ltx_float ltx_lstlisting">
<span id="LST4.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJraW5kIjogNzAwMCwKICAiY29udGVudCI6ICI8ZW1wdHktb3ItcGF5bG9hZD4iLAogICJ0YWdzIjogKCokXGJpZ1skKikKICAgICAoKiRcYmlnWyBcdGV4dHsic3RhdHVzIiwgIiA8c3RhdHVzPiAiLCAiPGV4dHJhLWluZm8+In0gXGJpZ10kKiksCiAgICAgKCokIFxiaWdbIFx0ZXh0eyJhbW91bnQiLCAiPHJlcXVlc3RlZC1wYXltZW50LWFtb3VudD4iLCAiPGJvbHQxMT4ifSBcYmlnXSQqKSwKICAgICAoKiQgXGJpZ1sgXHRleHR7ImUiLCAiam9iLXJlcXVlc3QtaWQiLCAiPHJlbGF5LWhpbnQ+In0gXGJpZ10kKiksCiAgICAgKCokIFxiaWdbIFx0ZXh0eyJwIiwgIjxjdXN0b21lcidzLXB1YmtleT4ifVxiaWddJCopLAogICgqJFxiaWddLCQqKQogIC4uLgp9" download="">⬇</a></span>
<span id="lstnumberx48" class="ltx_listingline">{
</span>
<span id="lstnumberx49" class="ltx_listingline"><span id="lstnumberx49.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx49.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx49.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx49.3.1" class="ltx_text ltx_lst_space"> </span>7000,</span>
</span>
<span id="lstnumberx50" class="ltx_listingline"><span id="lstnumberx50.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx50.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx50.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx50.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;empty-or-payload&gt;",</span>
</span>
<span id="lstnumberx51" class="ltx_listingline"><span id="lstnumberx51.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx51.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx51.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx51.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx51.1.1.1" class="ltx_text"><math id="lstnumberx51.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx51.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx51.1.1.1.m1.1.1" xref="lstnumberx51.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx51.1.1.1.m1.1b"><ci id="lstnumberx51.1.1.1.m1.1.1.cmml" xref="lstnumberx51.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx51.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx52" class="ltx_listingline"><span id="lstnumberx52.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx52.1" class="ltx_text"><math id="lstnumberx52.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"status", " &lt;status&gt; ", "&lt;extra-info&gt;"}\big{]}' display="inline"><semantics id="lstnumberx52.1.m1.1a"><mrow id="lstnumberx52.1.m1.1.2.2" xref="lstnumberx52.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx52.1.m1.1.2.2.1" xref="lstnumberx52.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx52.1.m1.1.1" xref="lstnumberx52.1.m1.1.1a.cmml">"status", " &lt;status&gt; ", "&lt;extra-info&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx52.1.m1.1.2.2.2" xref="lstnumberx52.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx52.1.m1.1b"><apply id="lstnumberx52.1.m1.1.2.1.cmml" xref="lstnumberx52.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx52.1.m1.1.2.1.1.cmml" xref="lstnumberx52.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx52.1.m1.1.1a.cmml" xref="lstnumberx52.1.m1.1.1"><mtext id="lstnumberx52.1.m1.1.1.cmml" xref="lstnumberx52.1.m1.1.1">"status", " &lt;status&gt; ", "&lt;extra-info&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx52.1.m1.1c">\big{[}\text{"status", " &lt;status&gt; ", "&lt;extra-info&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx53" class="ltx_listingline"><span id="lstnumberx53.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx53.1" class="ltx_text"><math id="lstnumberx53.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"amount", "&lt;requested-payment-amount&gt;", "&lt;bolt11&gt;"}\big{]}' display="inline"><semantics id="lstnumberx53.1.m1.1a"><mrow id="lstnumberx53.1.m1.1.2.2" xref="lstnumberx53.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx53.1.m1.1.2.2.1" xref="lstnumberx53.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx53.1.m1.1.1" xref="lstnumberx53.1.m1.1.1a.cmml">"amount", "&lt;requested-payment-amount&gt;", "&lt;bolt11&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx53.1.m1.1.2.2.2" xref="lstnumberx53.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx53.1.m1.1b"><apply id="lstnumberx53.1.m1.1.2.1.cmml" xref="lstnumberx53.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx53.1.m1.1.2.1.1.cmml" xref="lstnumberx53.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx53.1.m1.1.1a.cmml" xref="lstnumberx53.1.m1.1.1"><mtext id="lstnumberx53.1.m1.1.1.cmml" xref="lstnumberx53.1.m1.1.1">"amount", "&lt;requested-payment-amount&gt;", "&lt;bolt11&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx53.1.m1.1c">\big{[}\text{"amount", "&lt;requested-payment-amount&gt;", "&lt;bolt11&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx54" class="ltx_listingline"><span id="lstnumberx54.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx54.1" class="ltx_text"><math id="lstnumberx54.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"e", "job-request-id", "&lt;relay-hint&gt;"}\big{]}' display="inline"><semantics id="lstnumberx54.1.m1.1a"><mrow id="lstnumberx54.1.m1.1.2.2" xref="lstnumberx54.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx54.1.m1.1.2.2.1" xref="lstnumberx54.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx54.1.m1.1.1" xref="lstnumberx54.1.m1.1.1a.cmml">"e", "job-request-id", "&lt;relay-hint&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx54.1.m1.1.2.2.2" xref="lstnumberx54.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx54.1.m1.1b"><apply id="lstnumberx54.1.m1.1.2.1.cmml" xref="lstnumberx54.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx54.1.m1.1.2.1.1.cmml" xref="lstnumberx54.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx54.1.m1.1.1a.cmml" xref="lstnumberx54.1.m1.1.1"><mtext id="lstnumberx54.1.m1.1.1.cmml" xref="lstnumberx54.1.m1.1.1">"e", "job-request-id", "&lt;relay-hint&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx54.1.m1.1c">\big{[}\text{"e", "job-request-id", "&lt;relay-hint&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx55" class="ltx_listingline"><span id="lstnumberx55.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx55.1" class="ltx_text"><math id="lstnumberx55.1.m1.1" class="ltx_Math" alttext="\big{[}\text{&quot;p&quot;, &quot;&lt;customer's-pubkey&gt;&quot;}\big{]}" display="inline"><semantics id="lstnumberx55.1.m1.1a"><mrow id="lstnumberx55.1.m1.1.2.2" xref="lstnumberx55.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx55.1.m1.1.2.2.1" xref="lstnumberx55.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx55.1.m1.1.1" xref="lstnumberx55.1.m1.1.1a.cmml">"p", "&lt;customer’s-pubkey&gt;"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx55.1.m1.1.2.2.2" xref="lstnumberx55.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx55.1.m1.1b"><apply id="lstnumberx55.1.m1.1.2.1.cmml" xref="lstnumberx55.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx55.1.m1.1.2.1.1.cmml" xref="lstnumberx55.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx55.1.m1.1.1a.cmml" xref="lstnumberx55.1.m1.1.1"><mtext id="lstnumberx55.1.m1.1.1.cmml" xref="lstnumberx55.1.m1.1.1">"p", "&lt;customer’s-pubkey&gt;"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx55.1.m1.1c">\big{[}\text{"p", "&lt;customer's-pubkey&gt;"}\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx56" class="ltx_listingline"><span id="lstnumberx56.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx56.1" class="ltx_text"><math id="lstnumberx56.1.m1.1" class="ltx_Math" alttext="\big{]}," display="inline"><semantics id="lstnumberx56.1.m1.1a"><mrow id="lstnumberx56.1.m1.1.2.2"><mo maxsize="120%" minsize="120%" id="lstnumberx56.1.m1.1.1" xref="lstnumberx56.1.m1.1.1.cmml">]</mo><mo id="lstnumberx56.1.m1.1.2.2.1">,</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx56.1.m1.1b"><ci id="lstnumberx56.1.m1.1.1.cmml" xref="lstnumberx56.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx56.1.m1.1c">\big{]},</annotation></semantics></math></span>
</span>
<span id="lstnumberx57" class="ltx_listingline"><span id="lstnumberx57.1" class="ltx_text ltx_lst_space">  </span>…
</span>
<span id="lstnumberx58" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 4: </span>Job Feedback Event</span>
</span>
<span id="S5.SS1.SSS0.Px6.p1.1.1.1" class="ltx_p">The predefined format of the Job Feedback event includes the following tags <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>:
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.1" class="ltx_ERROR undefined">{outline}</span>
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.2" class="ltx_ERROR undefined">\1</span> &lt;content&gt;: It may be empty, a final job-result or a partial-result (for a job in progress). This field will have an encrypted payload with p tag as key.

<span id="S5.SS1.SSS0.Px6.p1.1.1.1.3" class="ltx_ERROR undefined">\1</span> &lt;amount&gt;: Requested payment amount.

<span id="S5.SS1.SSS0.Px6.p1.1.1.1.4" class="ltx_ERROR undefined">\1</span> &lt;status&gt;: The service provider publishes the current status of the requested job. For instance:

<span id="S5.SS1.SSS0.Px6.p1.1.1.1.5" class="ltx_ERROR undefined">\2</span> payment-required: Service Provider requires payment before continuing.
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.6" class="ltx_ERROR undefined">\2</span> processing: Service Provider is processing the job.
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.7" class="ltx_ERROR undefined">\2</span> error: Service Provider was unable to process the job.
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.8" class="ltx_ERROR undefined">\2</span> success: Service Provider successfully processed the job.
<span id="S5.SS1.SSS0.Px6.p1.1.1.1.9" class="ltx_ERROR undefined">\2</span> partial: Service Provider partially processed the job. The content filed might include a sample of the partial results.</span>
<section id="S5.SS1.SSS0.Px7" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Discoverability</h4>

<span id="S5.SS1.SSS0.Px7.p1" class="ltx_para">
<span id="S5.SS1.SSS0.Px7.p1.1" class="ltx_p">Service Providers have the option to announce availability or to advertise their support for specific job kinds by publishing discoverability events <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, (NIP-89)]</cite>. The format structure of the discoverability event appears in the Event Type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. By including a field tag "i", service providers may provide additional information related to their available computational capabilities, hardware specification or execution time limits.


<span id="S5.SS1.SSS0.Px7.p1.1.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST5" class="ltx_float ltx_lstlisting">
<span id="LST5.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJraW5kIjogMzE5OTAsCiAgInB1YmtleSI6ICI8cHVia2V5PiIsCiAgImNvbnRlbnQiOiAoKiBcYmlnWyAqKQogICAgXCJuYW1lXCI6ICgqICQgXHRleHR7XCAiRmVkZXJhdGVkIExlYXJuaW5nIEFJLVZNIiBcIH0gJCAqKSwKICAgIFwiYWJvdXRcIjogICgqICJJJ20gYSBBSS1WTSBmb3IgZmVkZXJhdGVkIGxlYXJuaW5nLiopIgogICgqIFxiaWddICopICwKICAidGFncyI6ICgqJFxiaWdbJCopCiAgICAgKCokXGJpZ1sgXHRleHR7ImsiLCAiODAwMCJ9IFxiaWddLCAgXHRleHR7IC8vIGUuZy4gb3B0aW1pemF0aW9uIG1ldGhvZHMsIGZlZGVyYXRlZCBsZWFybmluZ30kKikKICAgICAoKiQgXGJpZ1tcdGV4dHsidCIsICJiaXRjb2luIn0gXGJpZ10kKikKICAgICAoKiQgXGJpZ1tcdGV4dHsiaSIsICJzcGVjaWZpY2F0aW9ucyIsICJoYXJkd2FyZSIsICJtYXhpbXVtLWV4ZWN1dGlvbi10aW1lIiwgIm1vZGVsLWRpbWVuc2lvbnMtcmFuZ2UifSBcYmlnXSQqKQogICgqJFxiaWddLCQqKQogIC4uLgp9" download="">⬇</a></span>
<span id="lstnumberx59" class="ltx_listingline">{
</span>
<span id="lstnumberx60" class="ltx_listingline"><span id="lstnumberx60.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx60.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx60.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx60.3.1" class="ltx_text ltx_lst_space"> </span>31990,</span>
</span>
<span id="lstnumberx61" class="ltx_listingline"><span id="lstnumberx61.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx61.2" class="ltx_text ltx_lst_string" style="color:#003300;">"pubkey"</span><span id="lstnumberx61.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx61.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;pubkey&gt;",</span>
</span>
<span id="lstnumberx62" class="ltx_listingline"><span id="lstnumberx62.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx62.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx62.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx62.3.1" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx62.3.2" class="ltx_text" style="font-size:120%;">[</span></span>
</span>
<span id="lstnumberx63" class="ltx_listingline"><span id="lstnumberx63.2" class="ltx_text ltx_lst_space">    </span>\<span id="lstnumberx63.3" class="ltx_text ltx_lst_string" style="color:#003300;">"name\"</span><span id="lstnumberx63.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx63.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx63.1.1.1" class="ltx_text ltx_markedasmath"> "Federated Learning AI-VM"  </span>,</span>
</span>
<span id="lstnumberx64" class="ltx_listingline"><span id="lstnumberx64.1" class="ltx_text ltx_lst_space">    </span>\<span id="lstnumberx64.2" class="ltx_text ltx_lst_string" style="color:#003300;">"about\"</span><span id="lstnumberx64.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx64.3.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx64.3.2" class="ltx_text">"I’m a AI-VM for federated learning.</span>"</span>
</span>
<span id="lstnumberx65" class="ltx_listingline"><span id="lstnumberx65.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx65.2" class="ltx_text" style="font-size:120%;">]</span><span id="lstnumberx65.3" class="ltx_text ltx_lst_space"> </span>,
</span>
<span id="lstnumberx66" class="ltx_listingline"><span id="lstnumberx66.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx66.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx66.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx66.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx66.1.1.1" class="ltx_text"><math id="lstnumberx66.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx66.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx66.1.1.1.m1.1.1" xref="lstnumberx66.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx66.1.1.1.m1.1b"><ci id="lstnumberx66.1.1.1.m1.1.1.cmml" xref="lstnumberx66.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx66.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx67" class="ltx_listingline"><span id="lstnumberx67.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx67.1" class="ltx_text"><math id="lstnumberx67.1.m1.3" class="ltx_Math" alttext='\big{[}\text{"k", "8000"}\big{]},\text{ // e.g. optimization methods, federated learning}' display="inline"><semantics id="lstnumberx67.1.m1.3a"><mrow id="lstnumberx67.1.m1.3.3.1" xref="lstnumberx67.1.m1.3.3.2.cmml"><mrow id="lstnumberx67.1.m1.3.3.1.1.2" xref="lstnumberx67.1.m1.3.3.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx67.1.m1.3.3.1.1.2.1" xref="lstnumberx67.1.m1.3.3.1.1.1.1.cmml">[</mo><mtext id="lstnumberx67.1.m1.1.1" xref="lstnumberx67.1.m1.1.1a.cmml">"k", "8000"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx67.1.m1.3.3.1.1.2.2" xref="lstnumberx67.1.m1.3.3.1.1.1.1.cmml">]</mo></mrow><mo id="lstnumberx67.1.m1.3.3.1.2" xref="lstnumberx67.1.m1.3.3.2.cmml">,</mo><mtext id="lstnumberx67.1.m1.2.2" xref="lstnumberx67.1.m1.2.2a.cmml"> // e.g. optimization methods, federated learning</mtext></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx67.1.m1.3b"><list id="lstnumberx67.1.m1.3.3.2.cmml" xref="lstnumberx67.1.m1.3.3.1"><apply id="lstnumberx67.1.m1.3.3.1.1.1.cmml" xref="lstnumberx67.1.m1.3.3.1.1.2"><csymbol cd="latexml" id="lstnumberx67.1.m1.3.3.1.1.1.1.cmml" xref="lstnumberx67.1.m1.3.3.1.1.2.1">delimited-[]</csymbol><ci id="lstnumberx67.1.m1.1.1a.cmml" xref="lstnumberx67.1.m1.1.1"><mtext id="lstnumberx67.1.m1.1.1.cmml" xref="lstnumberx67.1.m1.1.1">"k", "8000"</mtext></ci></apply><ci id="lstnumberx67.1.m1.2.2a.cmml" xref="lstnumberx67.1.m1.2.2"><mtext id="lstnumberx67.1.m1.2.2.cmml" xref="lstnumberx67.1.m1.2.2"> // e.g. optimization methods, federated learning</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx67.1.m1.3c">\big{[}\text{"k", "8000"}\big{]},\text{ // e.g. optimization methods, federated learning}</annotation></semantics></math></span>
</span>
<span id="lstnumberx68" class="ltx_listingline"><span id="lstnumberx68.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx68.1" class="ltx_text"><math id="lstnumberx68.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"t", "bitcoin"}\big{]}' display="inline"><semantics id="lstnumberx68.1.m1.1a"><mrow id="lstnumberx68.1.m1.1.2.2" xref="lstnumberx68.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx68.1.m1.1.2.2.1" xref="lstnumberx68.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx68.1.m1.1.1" xref="lstnumberx68.1.m1.1.1a.cmml">"t", "bitcoin"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx68.1.m1.1.2.2.2" xref="lstnumberx68.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx68.1.m1.1b"><apply id="lstnumberx68.1.m1.1.2.1.cmml" xref="lstnumberx68.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx68.1.m1.1.2.1.1.cmml" xref="lstnumberx68.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx68.1.m1.1.1a.cmml" xref="lstnumberx68.1.m1.1.1"><mtext id="lstnumberx68.1.m1.1.1.cmml" xref="lstnumberx68.1.m1.1.1">"t", "bitcoin"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx68.1.m1.1c">\big{[}\text{"t", "bitcoin"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx69" class="ltx_listingline"><span id="lstnumberx69.2" class="ltx_text ltx_lst_space">     </span><span id="lstnumberx69.1" class="ltx_text"><math id="lstnumberx69.1.m1.1" class="ltx_Math" alttext='\big{[}\text{"i", "specifications", "hardware", "maximum-execution-time", "model-dimensions-range"}\big{]}' display="inline"><semantics id="lstnumberx69.1.m1.1a"><mrow id="lstnumberx69.1.m1.1.2.2" xref="lstnumberx69.1.m1.1.2.1.cmml"><mo maxsize="120%" minsize="120%" id="lstnumberx69.1.m1.1.2.2.1" xref="lstnumberx69.1.m1.1.2.1.1.cmml">[</mo><mtext id="lstnumberx69.1.m1.1.1" xref="lstnumberx69.1.m1.1.1a.cmml">"i", "specifications", "hardware", "maximum-execution-time", "model-dimensions-range"</mtext><mo maxsize="120%" minsize="120%" id="lstnumberx69.1.m1.1.2.2.2" xref="lstnumberx69.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx69.1.m1.1b"><apply id="lstnumberx69.1.m1.1.2.1.cmml" xref="lstnumberx69.1.m1.1.2.2"><csymbol cd="latexml" id="lstnumberx69.1.m1.1.2.1.1.cmml" xref="lstnumberx69.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="lstnumberx69.1.m1.1.1a.cmml" xref="lstnumberx69.1.m1.1.1"><mtext id="lstnumberx69.1.m1.1.1.cmml" xref="lstnumberx69.1.m1.1.1">"i", "specifications", "hardware", "maximum-execution-time", "model-dimensions-range"</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx69.1.m1.1c">\big{[}\text{"i", "specifications", "hardware", "maximum-execution-time", "model-dimensions-range"}\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx70" class="ltx_listingline"><span id="lstnumberx70.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx70.1" class="ltx_text"><math id="lstnumberx70.1.m1.1" class="ltx_Math" alttext="\big{]}," display="inline"><semantics id="lstnumberx70.1.m1.1a"><mrow id="lstnumberx70.1.m1.1.2.2"><mo maxsize="120%" minsize="120%" id="lstnumberx70.1.m1.1.1" xref="lstnumberx70.1.m1.1.1.cmml">]</mo><mo id="lstnumberx70.1.m1.1.2.2.1">,</mo></mrow><annotation-xml encoding="MathML-Content" id="lstnumberx70.1.m1.1b"><ci id="lstnumberx70.1.m1.1.1.cmml" xref="lstnumberx70.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx70.1.m1.1c">\big{]},</annotation></semantics></math></span>
</span>
<span id="lstnumberx71" class="ltx_listingline"><span id="lstnumberx71.1" class="ltx_text ltx_lst_space">  </span>…
</span>
<span id="lstnumberx72" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 5: </span>Discoverability Event</span>
</span>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Payments</h2>

<span id="S6.p1" class="ltx_para">
<span id="S6.p1.1" class="ltx_p">The NOSTR protocol has an integrated protocol flow for payments; requests for payment, invoice notifications, receipts for payments, as well as payments to certain events or directly to a user or a group of users. The payments take place through the lightning network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
. For any form of application including social media, Internet-of-Things applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and marketplaces <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, the lightning network enables bitcoin payments with instant settlement and virtually zero transaction fee. These properties together with in-channel messages are ideal for reliable handshaking mechanisms, anti-spam and on the fly payments between multiple job rounds among devices.</span>
</span>
<span id="S6.p2" class="ltx_para">
<span id="S6.p2.2" class="ltx_p">To further explain how the payments blend in with the rest of the protocol we proceed with an example. In the case of federated learning the aggregator itself may act as a customer who pays service providers to optimize a model on different subsets of a training data-set through multiple job rounds. Initially, the customer (aggregator) identifies possible service providers through the discoverability event (kind 31990, event type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), selects a number of them and submits a Job Request event (kind <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="\#8000" display="inline"><semantics id="S6.p2.1.m1.1a"><mrow id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S6.p2.1.m1.1.1.2" xref="S6.p2.1.m1.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S6.p2.1.m1.1.1.1" xref="S6.p2.1.m1.1.1.1.cmml">​</mo><mn id="S6.p2.1.m1.1.1.3" xref="S6.p2.1.m1.1.1.3.cmml">8000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><apply id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1"><times id="S6.p2.1.m1.1.1.1.cmml" xref="S6.p2.1.m1.1.1.1"></times><ci id="S6.p2.1.m1.1.1.2.cmml" xref="S6.p2.1.m1.1.1.2">#</ci><cn type="integer" id="S6.p2.1.m1.1.1.3.cmml" xref="S6.p2.1.m1.1.1.3">8000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">\#8000</annotation></semantics></math>, event type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The service providers respond with a Job Feedback event (kind <math id="S6.p2.2.m2.1" class="ltx_Math" alttext="\#7000" display="inline"><semantics id="S6.p2.2.m2.1a"><mrow id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S6.p2.2.m2.1.1.2" xref="S6.p2.2.m2.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S6.p2.2.m2.1.1.1" xref="S6.p2.2.m2.1.1.1.cmml">​</mo><mn id="S6.p2.2.m2.1.1.3" xref="S6.p2.2.m2.1.1.3.cmml">7000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><apply id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1"><times id="S6.p2.2.m2.1.1.1.cmml" xref="S6.p2.2.m2.1.1.1"></times><ci id="S6.p2.2.m2.1.1.2.cmml" xref="S6.p2.2.m2.1.1.2">#</ci><cn type="integer" id="S6.p2.2.m2.1.1.3.cmml" xref="S6.p2.2.m2.1.1.3">7000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">\#7000</annotation></semantics></math>, event type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) with status payment-required, to announce that they are available to complete the job. Then the customer proceeds by submitting a small amount (of the total) as a payment and the service provider starts the job. Upon delivery of the final or partial output result (Job Result <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> &amp; Job Feedback <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), the customer proceeds with a partial or total payment. This process repeats for each optimization round and for all service providers (assuming that they provide valid results). The ability to break down the payments into partial amounts and pay upon delivery of a valid result significantly minimizes the chance of stealing funds without completing the requested task. This strategy together with a reputation system can make the marketplace robust against adversarial or spam attacks up to a large extend. However, an in depth implementation of such sophisticated strategies remains out of the scope of this work. We discuss strategies for validation of the delivered output in Section <a href="#S7.SS1" title="7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>.</span>
</span>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Payments Implementation</h3>

<span id="S6.SS1.p1" class="ltx_para">
<span id="S6.SS1.p1.1" class="ltx_p">Herein, we discuss the payment system which is integrated into the NOSTR protocol. We indicatively explain three components of the payment system; Payment Request, Payment Receipts and Validation of Receipts. For detailed documentation of the payment protocol flow, we refer the reader to implementation 57 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</span>
</span>
<section id="S6.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Payment Request</h4>

<span id="S6.SS1.SSS0.Px1.p1" class="ltx_para">
<span id="S6.SS1.SSS0.Px1.p1.1" class="ltx_p">A payment (known as zap) request is an event of kind 9734 that is not published to relays, but is instead sent to a lnurl pay callback url <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> of the recipient. The field content may be an optional message to send along with the payment. The event must include the following tags:</span>
<span id="S6.I1" class="ltx_itemize">
<span id="S6.I1.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I1.i1.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I1.i1.1.1.m1.1b"><mo id="S6.I1.i1.1.1.m1.1.1" xref="S6.I1.i1.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I1.i1.1.1.m1.1c"><ci id="S6.I1.i1.1.1.m1.1.1.cmml" xref="S6.I1.i1.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I1.i1.p1" class="ltx_para">
<span id="S6.I1.i1.p1.1" class="ltx_p">Relays is a list of relays for the wallet of the recipient to publish its payment (zap) receipt to.</span>
</span></span>
<span id="S6.I1.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I1.i2.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I1.i2.1.1.m1.1b"><mo id="S6.I1.i2.1.1.m1.1.1" xref="S6.I1.i2.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I1.i2.1.1.m1.1c"><ci id="S6.I1.i2.1.1.m1.1.1.cmml" xref="S6.I1.i2.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i2.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I1.i2.p1" class="ltx_para">
<span id="S6.I1.i2.p1.1" class="ltx_p">Amount is the amount in millisats the sender intends to pay, formatted as a string.</span>
</span></span>
<span id="S6.I1.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I1.i3.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I1.i3.1.1.m1.1b"><mo id="S6.I1.i3.1.1.m1.1.1" xref="S6.I1.i3.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I1.i3.1.1.m1.1c"><ci id="S6.I1.i3.1.1.m1.1.1.cmml" xref="S6.I1.i3.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i3.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I1.i3.p1" class="ltx_para">
<span id="S6.I1.i3.p1.1" class="ltx_p">Lnurl is the lnurl pay url of the recipient, encoded using bech32 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> with the prefix lnurl.</span>
</span></span>
<span id="S6.I1.i4" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I1.i4.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I1.i4.1.1.m1.1b"><mo id="S6.I1.i4.1.1.m1.1.1" xref="S6.I1.i4.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I1.i4.1.1.m1.1c"><ci id="S6.I1.i4.1.1.m1.1.1.cmml" xref="S6.I1.i4.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i4.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I1.i4.p1" class="ltx_para">
<span id="S6.I1.i4.p1.1" class="ltx_p">p is the hex-encoded pubkey of the recipient.</span>
</span></span>
<span id="S6.I1.i5" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I1.i5.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I1.i5.1.1.m1.1b"><mo id="S6.I1.i5.1.1.m1.1.1" xref="S6.I1.i5.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I1.i5.1.1.m1.1c"><ci id="S6.I1.i5.1.1.m1.1.1.cmml" xref="S6.I1.i5.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i5.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I1.i5.p1" class="ltx_para">
<span id="S6.I1.i5.p1.1" class="ltx_p">e is an optional hex-encoded event id. Implementations must include this while paying an event rather than a public key.</span>
</span></span>
</span>
</span>
<span id="S6.SS1.SSS0.Px1.p2" class="ltx_para">
<span id="S6.SS1.SSS0.Px1.p2.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST6" class="ltx_float ltx_lstlisting">
<span id="LST6.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICJraW5kIjogOTczNCwKICAiY29udGVudCI6ICJaYXAhIiwKICAidGFncyI6ICgqJFxiaWdbJCopCiAgICAoKiRcYmlnWyQqKSJyZWxheXMiLCAiPHdzczovL3JlbGF5LWRvbWFpbj4iLCAid3NzOi8vYW5vdGhlcnJlbGF5LmNvbSIoKiRcYmlnXSQqKSwKICAgICgqJFxiaWdbJCopImFtb3VudCIsICI8bXNhdHMtYW1vdW50PiIoKiRcYmlnXSQqKSwKICAgICgqJFxiaWdbJCopImxudXJsIiwgIjxhLXN0YXRpYy1saWdodG5pbmctaW52b2ljZT4iKCokXGJpZ10kKiksCiAgICAoKiRcYmlnWyQqKSJwIiwgIjxoZXgtZW5jb2RlZC1wdWJrZXktb2YtdGhlLXJlY2lwaWVudD4iKCokXGJpZ10kKiksCiAgICAoKiRcYmlnWyQqKSJlIiwgIjxvcHRpb25hbC1oZXgtZW5jb2RlZC1ldmVudC1JRD4iKCokXGJpZ10kKikKICAoKiRcYmlnXSQqKSwKICAicHVia2V5IjogIjxOUFVCPiIsCiAgImNyZWF0ZWRfYXQiOiA8dGltZXN0YW1wPiwKICAiaWQiOiAiPGV2ZW50LUlEPiIsCiAgInNpZyI6ICI8c2lnbmF0dXJlPiIKfQ==" download="">⬇</a></span>
<span id="lstnumberx73" class="ltx_listingline">{
</span>
<span id="lstnumberx74" class="ltx_listingline"><span id="lstnumberx74.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx74.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx74.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx74.3.1" class="ltx_text ltx_lst_space"> </span>9734,</span>
</span>
<span id="lstnumberx75" class="ltx_listingline"><span id="lstnumberx75.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx75.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx75.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx75.3.1" class="ltx_text ltx_lst_space"> </span>"Zap!",</span>
</span>
<span id="lstnumberx76" class="ltx_listingline"><span id="lstnumberx76.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx76.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx76.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx76.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx76.1.1.1" class="ltx_text"><math id="lstnumberx76.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx76.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx76.1.1.1.m1.1.1" xref="lstnumberx76.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx76.1.1.1.m1.1b"><ci id="lstnumberx76.1.1.1.m1.1.1.cmml" xref="lstnumberx76.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx76.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx77" class="ltx_listingline"><span id="lstnumberx77.3" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx77.1" class="ltx_text"><math id="lstnumberx77.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx77.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx77.1.m1.1.1" xref="lstnumberx77.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx77.1.m1.1b"><ci id="lstnumberx77.1.m1.1.1.cmml" xref="lstnumberx77.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx77.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx77.4" class="ltx_text ltx_lst_string" style="color:#003300;">"relays"</span>,<span id="lstnumberx77.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx77.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;wss://relay-domain&gt;"</span>,<span id="lstnumberx77.7" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx77.8" class="ltx_text ltx_lst_string" style="color:#003300;">"wss://anotherrelay.com"</span><span id="lstnumberx77.2" class="ltx_text"><math id="lstnumberx77.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx77.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx77.2.m1.1.1" xref="lstnumberx77.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx77.2.m1.1b"><ci id="lstnumberx77.2.m1.1.1.cmml" xref="lstnumberx77.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx77.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx78" class="ltx_listingline"><span id="lstnumberx78.3" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx78.1" class="ltx_text"><math id="lstnumberx78.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx78.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx78.1.m1.1.1" xref="lstnumberx78.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx78.1.m1.1b"><ci id="lstnumberx78.1.m1.1.1.cmml" xref="lstnumberx78.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx78.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx78.4" class="ltx_text ltx_lst_string" style="color:#003300;">"amount"</span>,<span id="lstnumberx78.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx78.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;msats-amount&gt;"</span><span id="lstnumberx78.2" class="ltx_text"><math id="lstnumberx78.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx78.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx78.2.m1.1.1" xref="lstnumberx78.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx78.2.m1.1b"><ci id="lstnumberx78.2.m1.1.1.cmml" xref="lstnumberx78.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx78.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx79" class="ltx_listingline"><span id="lstnumberx79.3" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx79.1" class="ltx_text"><math id="lstnumberx79.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx79.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx79.1.m1.1.1" xref="lstnumberx79.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx79.1.m1.1b"><ci id="lstnumberx79.1.m1.1.1.cmml" xref="lstnumberx79.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx79.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx79.4" class="ltx_text ltx_lst_string" style="color:#003300;">"lnurl"</span>,<span id="lstnumberx79.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx79.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;a-static-lightning-invoice&gt;"</span><span id="lstnumberx79.2" class="ltx_text"><math id="lstnumberx79.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx79.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx79.2.m1.1.1" xref="lstnumberx79.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx79.2.m1.1b"><ci id="lstnumberx79.2.m1.1.1.cmml" xref="lstnumberx79.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx79.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx80" class="ltx_listingline"><span id="lstnumberx80.3" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx80.1" class="ltx_text"><math id="lstnumberx80.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx80.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx80.1.m1.1.1" xref="lstnumberx80.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx80.1.m1.1b"><ci id="lstnumberx80.1.m1.1.1.cmml" xref="lstnumberx80.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx80.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx80.4" class="ltx_text ltx_lst_string" style="color:#003300;">"p"</span>,<span id="lstnumberx80.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx80.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;hex-encoded-pubkey-of-the-recipient&gt;"</span><span id="lstnumberx80.2" class="ltx_text"><math id="lstnumberx80.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx80.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx80.2.m1.1.1" xref="lstnumberx80.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx80.2.m1.1b"><ci id="lstnumberx80.2.m1.1.1.cmml" xref="lstnumberx80.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx80.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx81" class="ltx_listingline"><span id="lstnumberx81.3" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx81.1" class="ltx_text"><math id="lstnumberx81.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx81.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx81.1.m1.1.1" xref="lstnumberx81.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx81.1.m1.1b"><ci id="lstnumberx81.1.m1.1.1.cmml" xref="lstnumberx81.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx81.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx81.4" class="ltx_text ltx_lst_string" style="color:#003300;">"e"</span>,<span id="lstnumberx81.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx81.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;optional-hex-encoded-event-ID&gt;"</span><span id="lstnumberx81.2" class="ltx_text"><math id="lstnumberx81.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx81.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx81.2.m1.1.1" xref="lstnumberx81.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx81.2.m1.1b"><ci id="lstnumberx81.2.m1.1.1.cmml" xref="lstnumberx81.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx81.2.m1.1c">\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx82" class="ltx_listingline"><span id="lstnumberx82.2" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx82.1" class="ltx_text"><math id="lstnumberx82.1.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx82.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx82.1.m1.1.1" xref="lstnumberx82.1.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx82.1.m1.1b"><ci id="lstnumberx82.1.m1.1.1.cmml" xref="lstnumberx82.1.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx82.1.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx83" class="ltx_listingline"><span id="lstnumberx83.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx83.2" class="ltx_text ltx_lst_string" style="color:#003300;">"pubkey"</span><span id="lstnumberx83.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx83.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;NPUB&gt;",</span>
</span>
<span id="lstnumberx84" class="ltx_listingline"><span id="lstnumberx84.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx84.2" class="ltx_text ltx_lst_string" style="color:#003300;">"created_at"</span><span id="lstnumberx84.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx84.3.1" class="ltx_text ltx_lst_space"> </span>&lt;timestamp&gt;,</span>
</span>
<span id="lstnumberx85" class="ltx_listingline"><span id="lstnumberx85.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx85.2" class="ltx_text ltx_lst_string" style="color:#003300;">"id"</span><span id="lstnumberx85.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx85.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;event-ID&gt;",</span>
</span>
<span id="lstnumberx86" class="ltx_listingline"><span id="lstnumberx86.1" class="ltx_text ltx_lst_space">  </span><span id="lstnumberx86.2" class="ltx_text ltx_lst_string" style="color:#003300;">"sig"</span><span id="lstnumberx86.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx86.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;signature&gt;"</span>
</span>
<span id="lstnumberx87" class="ltx_listingline">}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 6: </span>Payment Request Event</span>
</span>
<section id="S6.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Payment Receipt</h4>

<span id="S6.SS1.SSS0.Px2.p1" class="ltx_para">
<span id="S6.SS1.SSS0.Px2.p1.1" class="ltx_p">A payment receipt is created by a lightning node when an invoice generated by a payment request is paid. Payment receipts are only created when the invoice description (committed to the description hash) contains a payment request note. When receiving a payment, a series of steps are executed and a NOSTR event of kind 9735 (as appears below; Event Type <a href="#LST7" title="Event Type 7 ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) should be published to the relays declared in the payment request. We refer the reader to the detailed documentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for a complete description of the Payment Receipt event structure and the full protocol flow.</span>
</span>
<span id="S6.SS1.SSS0.Px2.p2" class="ltx_para">
<span id="S6.SS1.SSS0.Px2.p2.1" class="ltx_inline-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;">
<span id="LST7" class="ltx_float ltx_lstlisting">
<span id="LST7.1" class="ltx_listing ltx_lstlisting ltx_listing"><span class="ltx_listing_data"><a href="data:text/plain;base64,ewogICAgImlkIjogIjxldmVudC1JRD4iLAogICAgInB1YmtleSI6ICI8TlBVQj4iLAogICAgImNyZWF0ZWRfYXQiOiA8cGFpZC1hdC1kYXRlPiwKICAgICJraW5kIjogOTczNSwKICAgICJ0YWdzIjogKCokXGJpZ1skKikKICAgICAgKCokXGJpZ1skKikicCIsICI8cGF5bWVudC1yZWNpcGllbnQpPiIoKiRcYmlnXSQqKSwKICAgICAgKCokXGJpZ1skKikiUCIsICI8b3B0aW9uYWwtUC10YWctZnJvbS10aGUtcHVia2V5LW9mLXRoZS1wYXltZW50LXJlcXVlc3Q+IigqJFxiaWddJCopLAogICAgICAoKiRcYmlnWyQqKSJlIiwgIjxvcHRpb25hbC10YWctc2FtZS1hcy1wYXltZW50LXJlcXVlc3QtZS10YWc+IigqJFxiaWddJCopLAogICAgICAoKiRcYmlnWyQqKSJib2x0MTEiLCAiPGxpZ2h0bmluZy1pbnZvaWNlPiIoKiRcYmlnXSQqKSwKICAgICAgKCokXGJpZ1skKikiZGVzY3JpcHRpb24iLCAiPFNIQTI1NihkZXNjcmlwdGlvbiktZnJvbS1pbnZvaWNlPiIoKiRcYmlnXSQqKSwKICAgICAgKCokXGJpZ1skKikicHJlaW1hZ2UiLCAiPHBheW1lbnQtcHJlaW1hZ2U+IigqJFxiaWddJCopCiAgICBdLAogICAgImNvbnRlbnQiOiAiIiwKICB9" download="">⬇</a></span>
<span id="lstnumberx88" class="ltx_listingline">{
</span>
<span id="lstnumberx89" class="ltx_listingline"><span id="lstnumberx89.1" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx89.2" class="ltx_text ltx_lst_string" style="color:#003300;">"id"</span><span id="lstnumberx89.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx89.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;event-ID&gt;",</span>
</span>
<span id="lstnumberx90" class="ltx_listingline"><span id="lstnumberx90.1" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx90.2" class="ltx_text ltx_lst_string" style="color:#003300;">"pubkey"</span><span id="lstnumberx90.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx90.3.1" class="ltx_text ltx_lst_space"> </span>"&lt;NPUB&gt;",</span>
</span>
<span id="lstnumberx91" class="ltx_listingline"><span id="lstnumberx91.1" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx91.2" class="ltx_text ltx_lst_string" style="color:#003300;">"created_at"</span><span id="lstnumberx91.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx91.3.1" class="ltx_text ltx_lst_space"> </span>&lt;paid-at-date&gt;,</span>
</span>
<span id="lstnumberx92" class="ltx_listingline"><span id="lstnumberx92.1" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx92.2" class="ltx_text ltx_lst_string" style="color:#003300;">"kind"</span><span id="lstnumberx92.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx92.3.1" class="ltx_text ltx_lst_space"> </span>9735,</span>
</span>
<span id="lstnumberx93" class="ltx_listingline"><span id="lstnumberx93.2" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx93.3" class="ltx_text ltx_lst_string" style="color:#003300;">"tags"</span><span id="lstnumberx93.1" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx93.1.2" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx93.1.1.1" class="ltx_text"><math id="lstnumberx93.1.1.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx93.1.1.1.m1.1a"><mo mathcolor="#000080" maxsize="120%" minsize="120%" id="lstnumberx93.1.1.1.m1.1.1" xref="lstnumberx93.1.1.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx93.1.1.1.m1.1b"><ci id="lstnumberx93.1.1.1.m1.1.1.cmml" xref="lstnumberx93.1.1.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx93.1.1.1.m1.1c">\big{[}</annotation></semantics></math></span></span>
</span>
<span id="lstnumberx94" class="ltx_listingline"><span id="lstnumberx94.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx94.1" class="ltx_text"><math id="lstnumberx94.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx94.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx94.1.m1.1.1" xref="lstnumberx94.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx94.1.m1.1b"><ci id="lstnumberx94.1.m1.1.1.cmml" xref="lstnumberx94.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx94.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx94.4" class="ltx_text ltx_lst_string" style="color:#003300;">"p"</span>,<span id="lstnumberx94.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx94.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;payment-recipient)&gt;"</span><span id="lstnumberx94.2" class="ltx_text"><math id="lstnumberx94.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx94.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx94.2.m1.1.1" xref="lstnumberx94.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx94.2.m1.1b"><ci id="lstnumberx94.2.m1.1.1.cmml" xref="lstnumberx94.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx94.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx95" class="ltx_listingline"><span id="lstnumberx95.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx95.1" class="ltx_text"><math id="lstnumberx95.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx95.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx95.1.m1.1.1" xref="lstnumberx95.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx95.1.m1.1b"><ci id="lstnumberx95.1.m1.1.1.cmml" xref="lstnumberx95.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx95.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx95.4" class="ltx_text ltx_lst_string" style="color:#003300;">"P"</span>,<span id="lstnumberx95.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx95.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;optional-P-tag-from-the-pubkey-of-the-payment-request&gt;"</span><span id="lstnumberx95.2" class="ltx_text"><math id="lstnumberx95.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx95.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx95.2.m1.1.1" xref="lstnumberx95.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx95.2.m1.1b"><ci id="lstnumberx95.2.m1.1.1.cmml" xref="lstnumberx95.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx95.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx96" class="ltx_listingline"><span id="lstnumberx96.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx96.1" class="ltx_text"><math id="lstnumberx96.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx96.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx96.1.m1.1.1" xref="lstnumberx96.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx96.1.m1.1b"><ci id="lstnumberx96.1.m1.1.1.cmml" xref="lstnumberx96.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx96.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx96.4" class="ltx_text ltx_lst_string" style="color:#003300;">"e"</span>,<span id="lstnumberx96.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx96.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;optional-tag-same-as-payment-request-e-tag&gt;"</span><span id="lstnumberx96.2" class="ltx_text"><math id="lstnumberx96.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx96.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx96.2.m1.1.1" xref="lstnumberx96.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx96.2.m1.1b"><ci id="lstnumberx96.2.m1.1.1.cmml" xref="lstnumberx96.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx96.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx97" class="ltx_listingline"><span id="lstnumberx97.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx97.1" class="ltx_text"><math id="lstnumberx97.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx97.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx97.1.m1.1.1" xref="lstnumberx97.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx97.1.m1.1b"><ci id="lstnumberx97.1.m1.1.1.cmml" xref="lstnumberx97.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx97.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx97.4" class="ltx_text ltx_lst_string" style="color:#003300;">"bolt11"</span>,<span id="lstnumberx97.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx97.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;lightning-invoice&gt;"</span><span id="lstnumberx97.2" class="ltx_text"><math id="lstnumberx97.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx97.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx97.2.m1.1.1" xref="lstnumberx97.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx97.2.m1.1b"><ci id="lstnumberx97.2.m1.1.1.cmml" xref="lstnumberx97.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx97.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx98" class="ltx_listingline"><span id="lstnumberx98.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx98.1" class="ltx_text"><math id="lstnumberx98.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx98.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx98.1.m1.1.1" xref="lstnumberx98.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx98.1.m1.1b"><ci id="lstnumberx98.1.m1.1.1.cmml" xref="lstnumberx98.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx98.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx98.4" class="ltx_text ltx_lst_string" style="color:#003300;">"description"</span>,<span id="lstnumberx98.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx98.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;SHA256(description)-from-invoice&gt;"</span><span id="lstnumberx98.2" class="ltx_text"><math id="lstnumberx98.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx98.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx98.2.m1.1.1" xref="lstnumberx98.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx98.2.m1.1b"><ci id="lstnumberx98.2.m1.1.1.cmml" xref="lstnumberx98.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx98.2.m1.1c">\big{]}</annotation></semantics></math></span>,
</span>
<span id="lstnumberx99" class="ltx_listingline"><span id="lstnumberx99.3" class="ltx_text ltx_lst_space">      </span><span id="lstnumberx99.1" class="ltx_text"><math id="lstnumberx99.1.m1.1" class="ltx_Math" alttext="\big{[}" display="inline"><semantics id="lstnumberx99.1.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx99.1.m1.1.1" xref="lstnumberx99.1.m1.1.1.cmml">[</mo><annotation-xml encoding="MathML-Content" id="lstnumberx99.1.m1.1b"><ci id="lstnumberx99.1.m1.1.1.cmml" xref="lstnumberx99.1.m1.1.1">[</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx99.1.m1.1c">\big{[}</annotation></semantics></math></span><span id="lstnumberx99.4" class="ltx_text ltx_lst_string" style="color:#003300;">"preimage"</span>,<span id="lstnumberx99.5" class="ltx_text ltx_lst_space"> </span><span id="lstnumberx99.6" class="ltx_text ltx_lst_string" style="color:#003300;">"&lt;payment-preimage&gt;"</span><span id="lstnumberx99.2" class="ltx_text"><math id="lstnumberx99.2.m1.1" class="ltx_Math" alttext="\big{]}" display="inline"><semantics id="lstnumberx99.2.m1.1a"><mo maxsize="120%" minsize="120%" id="lstnumberx99.2.m1.1.1" xref="lstnumberx99.2.m1.1.1.cmml">]</mo><annotation-xml encoding="MathML-Content" id="lstnumberx99.2.m1.1b"><ci id="lstnumberx99.2.m1.1.1.cmml" xref="lstnumberx99.2.m1.1.1">]</ci></annotation-xml><annotation encoding="application/x-tex" id="lstnumberx99.2.m1.1c">\big{]}</annotation></semantics></math></span>
</span>
<span id="lstnumberx100" class="ltx_listingline"><span id="lstnumberx100.1" class="ltx_text ltx_lst_space">    </span>],
</span>
<span id="lstnumberx101" class="ltx_listingline"><span id="lstnumberx101.1" class="ltx_text ltx_lst_space">    </span><span id="lstnumberx101.2" class="ltx_text ltx_lst_string" style="color:#003300;">"content"</span><span id="lstnumberx101.3" class="ltx_text ltx_lst_comment" style="color:#000080;">:<span id="lstnumberx101.3.1" class="ltx_text ltx_lst_space"> </span>"",</span>
</span>
<span id="lstnumberx102" class="ltx_listingline"><span id="lstnumberx102.1" class="ltx_text ltx_lst_space">  </span>}
</span>
</span>
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float">Event Type 7: </span>Payment Receipt Event</span>
</span>
<section id="S6.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Receipt Validation</h4>

<span id="S6.SS1.SSS0.Px3.p1" class="ltx_para">
<span id="S6.SS1.SSS0.Px3.p1.1" class="ltx_p">The service provider can retrieve payment receipts using a NIP-<math id="S6.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="01" display="inline"><semantics id="S6.SS1.SSS0.Px3.p1.1.m1.1a"><mn id="S6.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">01</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS0.Px3.p1.1.m1.1b"><cn type="integer" id="S6.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS0.Px3.p1.1.m1.1.1">01</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS0.Px3.p1.1.m1.1c">01</annotation></semantics></math> filter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and validate each receipt to verify that a customer fetched their invoice and claims payment submission for a certain job. Payments are validated by using the following steps:</span>
<span id="S6.I2" class="ltx_itemize">
<span id="S6.I2.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I2.i1.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I2.i1.1.1.m1.1b"><mo id="S6.I2.i1.1.1.m1.1.1" xref="S6.I2.i1.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I2.i1.1.1.m1.1c"><ci id="S6.I2.i1.1.1.m1.1.1.cmml" xref="S6.I2.i1.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i1.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I2.i1.p1" class="ltx_para">
<span id="S6.I2.i1.p1.1" class="ltx_p">The public key in the payment receipt event must be the same as the public key of the service provider.</span>
</span></span>
<span id="S6.I2.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I2.i2.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I2.i2.1.1.m1.1b"><mo id="S6.I2.i2.1.1.m1.1.1" xref="S6.I2.i2.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I2.i2.1.1.m1.1c"><ci id="S6.I2.i2.1.1.m1.1.1.cmml" xref="S6.I2.i2.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I2.i2.p1" class="ltx_para">
<span id="S6.I2.i2.p1.1" class="ltx_p">The invoice Amount contained in the bolt11 tag of the payment receipt must be equal to the amount tag of the payment request.</span>
</span></span>
<span id="S6.I2.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"><math id="S6.I2.i3.1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S6.I2.i3.1.1.m1.1b"><mo id="S6.I2.i3.1.1.m1.1.1" xref="S6.I2.i3.1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S6.I2.i3.1.1.m1.1c"><ci id="S6.I2.i3.1.1.m1.1.1.cmml" xref="S6.I2.i3.1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i3.1.1.m1.1d">\bullet</annotation></semantics></math></span> 
<span id="S6.I2.i3.p1" class="ltx_para">
<span id="S6.I2.i3.p1.1" class="ltx_p">The lnurl tag of the payment request should be equal the lnurl of the recipient.</span>
</span></span>
</span>
</span>
<span id="S6.SS1.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<span id="S6.SS1.SSS0.Px3.p2.1" class="ltx_p">We highlight the fact that a receipt is not a proof of payment, and it only proves that some NOSTR user fetched an invoice. As a final step of payment validation, the recipient must verify the payment on their lightning node or payment processor.</span>
</span>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Money-In AI-Out: Marketplace for Federated Learning and LLMs</h2>

<span id="S7.p1" class="ltx_para">
<span id="S7.p1.1" class="ltx_p">Herein, we introduce the protocol flow and algorithmic design for federated learning and LLMs training over the NOSTR protocol. By leveraging the existing structure of the protocol for data processing, and by introducing additional components when it is necessary, we construct an open and decentralized marketplace for training AI models. In this market, a user (customer) provides a dataset, model specifications, the service providers (AI Vending Machines) receive a payment, and they return an AI model trained on this dataset. Customers and service providers communicate through relays, which can be public or private (and self hosted). Also, the communication can be implemented with encrypted information to guarantee privacy for the dataset or for the output of the computation. We proceed by explaining further the protocol flow and then we present a detailed algorithmic implementation for customers and service providers.</span>
</span>
<span id="S7.p2" class="ltx_para">
<span id="S7.p2.1" class="ltx_p">We propose a protocol flow that involves multiple job rounds between the customer and service providers. Through multiple job rounds we ensure that there is a valid progress in the optimization process by each of the service providers individually. This allows to consider on the fly payments after validation of the output at each round. If the service providers give an invalid output or if they delay the job beyond a certain amount of time, then the customer proceeds to reassign the job to another service provider without paying for the invalid (or delayed) job output.</span>
</span>
<span id="S7.p3" class="ltx_para">
<span id="S7.p3.1" class="ltx_p">In this work we consider two training methods: the classical federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, FEDAVG]</cite> and DiLoCo algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for training LLMs. Both of these have an inner and outer optimization part. This allows us to present our approach in parallel. Specifically, we define the job round as the sequence of the following successful publication of events and actions; for the first part (inner optimization): job request, inner optimization computation executed by the service providers, retrieval of the outputs from inner optimization routines by the customer through job result events, validation of the output result. For the second part (Outer optimization): use the latest inner optimization outputs as inputs and execute the outer optimization (through a job request, if needed or locally directly executed by the customer), complete any pending payments and update the model parameters for the next round (if any). Upon validation of the outputs a (partial) payment is submitted by the customer to each of the service providers. To explain this further we provide the sequence of the steps below.</span>
</span>
<section id="S7.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Protocol Flow.</h4>

<span id="S7.SS0.SSS0.Px1.p1" class="ltx_para">
<span id="S7.SS0.SSS0.Px1.p1.1" class="ltx_p">At every job round:
<span id="S7.SS0.SSS0.Px1.p1.1.1" class="ltx_ERROR undefined">{outline}</span>
<span id="S7.SS0.SSS0.Px1.p1.1.2" class="ltx_ERROR undefined">\1</span> Customer (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Validation of the Output (Algorithm 3). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) publishes a job request (e.g. kind:8000, Federated Learning, inner optimization). The job request may include a list of chosen service providers, and it must include all the required information: the current state of the model (for instance for the first round initial value of model parameters), a link (source) to the data, list of relays where the service providers should publish their job results job feedback at, as well as all the required parameters (see Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).

<span id="S7.SS0.SSS0.Px1.p1.1.3" class="ltx_ERROR undefined">\1</span> Service Providers (Algorithm <a href="#alg4" title="Algorithm 4 ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) must submit job-feedback events (kind:7000, e.g. partial payment-required) before they start the job with STATUS = payment_required, if they wish a (partial) payment before starting computation (Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). This requests a partial payment and signals that a service provider is available to start upon receiving the payment.

<span id="S7.SS0.SSS0.Px1.p1.1.4" class="ltx_ERROR undefined">\1</span> Customer submits a initial payment to service providers (responsible for inner optimization).

<span id="S7.SS0.SSS0.Px1.p1.1.5" class="ltx_ERROR undefined">\1</span> Upon receiving the partial payment the service providers start executing the inner optimization job (Algorithm <a href="#alg5" title="Algorithm 5 ‣ Inner Optimization (Algorithm 5) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
<span id="S7.SS0.SSS0.Px1.p1.1.6" class="ltx_ERROR undefined">\2</span> Within a fixed time period service providers publish Job Feedback events (Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) with partial/sample result.

<span id="S7.SS0.SSS0.Px1.p1.1.7" class="ltx_ERROR undefined">\2</span> If results delivery exceeds a predefined time limit, then customer stops the procedure and seeks for other service providers (responsible for inner optimization).

<span id="S7.SS0.SSS0.Px1.p1.1.8" class="ltx_ERROR undefined">\1</span> Upon completion, each service provider publishes the output of the job through a Job Result event (kind:6000) (Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).

<span id="S7.SS0.SSS0.Px1.p1.1.9" class="ltx_ERROR undefined">\1</span> Customer validates the results/ouputs (Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)

<span id="S7.SS0.SSS0.Px1.p1.1.10" class="ltx_ERROR undefined">\2</span> If the result/ouput is valid then the customer completes the payments to all service providers (responsible for inner optimization) with valid output.

<span id="S7.SS0.SSS0.Px1.p1.1.11" class="ltx_ERROR undefined">\2</span> If the result is not valid then reassigns the job to a different service provider (Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).

<span id="S7.SS0.SSS0.Px1.p1.1.12" class="ltx_ERROR undefined">\1</span> With successful outputs for all inner optimization jobs: The customer proceeds to the outer optimization (Algorithm <a href="#alg6" title="Algorithm 6 ‣ Outer Optimization (Algorithm 6) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).

<span id="S7.SS0.SSS0.Px1.p1.1.13" class="ltx_ERROR undefined">\2</span> If the customer selects to execute the outer optimization locally, then the customer executes the outer optimization (Algorithm <a href="#alg6" title="Algorithm 6 ‣ Outer Optimization (Algorithm 6) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) with input the output of inner optimization procedures.

<span id="S7.SS0.SSS0.Px1.p1.1.14" class="ltx_ERROR undefined">\2</span> Else if the customer selects to assign the task to a service provider for the outer optimization, then the customer follows the steps of reassigning the job from SELF to a service provider (Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), retrieving and validating the output, and completing any payments identically to the inner optimization job handling as was described above.</span>
</span>
<span id="S7.SS0.SSS0.Px1.p2" class="ltx_para"><span id="S7.SS0.SSS0.Px1.p2.1" class="ltx_ERROR undefined">\1</span>
<span id="S7.SS0.SSS0.Px1.p2.2" class="ltx_p">At the end of each round the customer updates the model parameters to use them as input for the next round.

<span id="S7.SS0.SSS0.Px1.p2.2.1" class="ltx_ERROR undefined">\2</span> If the current round is the terminal round then the customer completes any pending payments and ends the procedure with output the final result.

<span id="S7.SS0.SSS0.Px1.p2.2.2" class="ltx_ERROR undefined">\1</span> At any point, if there is an amount pending to be paid as instructed by the service provider, the customer can pay the lightning-invoice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, bolt11]</cite> (see lnurl Event Type <a href="#LST6" title="Event Type 6 ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).

We present an implementation of the protocol flow in Section <a href="#S7.SS1" title="7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a> and Section <a href="#S7.SS2" title="7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2</span></a>.</span>
</span>
</section>
<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Customer</h3>

<span id="S7.SS1.p1" class="ltx_para">
<span id="S7.SS1.p1.1" class="ltx_p">A complete implementation of the customer routine appears in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Validation of the Output (Algorithm 3). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. This includes the steps that the customer follows and the events that the customer publishes. First, the customer discovers and requests a set of service providers to run inner optimization part of the job to as we explained in the protocol flow above. Upon successful delivery of outputs, the customer proceeds to the outer optimization. The outer optimization for both FedAvg and DiLoCo is a single or double update of local variables respectively. However we consider the option for the customer to also assign this computation step to a service provider. This can be useful in practice if someone prefers to implement an outer optimizer with higher computational complexity (for instance multiple iterations) and the customer is not able to perform such computations locally. We proceed by explaining further three parts of the main customer routine: how the customer handles disconnections and failures of a service provider to respond (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Validation of the Output (Algorithm 3). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), how the customer validates the output results given by a service provider at job completion (Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), and how the customer reassigns a job to a different service provider if needed (Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</span>
</span>
<section id="S7.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Handling Disconnections and Failures to Respond.</h4>

<span id="S7.SS1.SSS0.Px1.p1" class="ltx_para">
<span id="S7.SS1.SSS0.Px1.p1.1" class="ltx_p">The customer may consider a time-out period. If a service provider did not provide the output within a certain time window (from the time point of receiving the initialization payment), then the customer proceeds to reassign the job to a different service provider (Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). As an example of the time-out implementation see Algorithm <a href="#alg1" title="Algorithm 1 ‣ Validation of the Output (Algorithm 3). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (lines 13-14). All the information regarding the time-out rules should be included in the Job Request event (Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</span>
</span>
<span id="S7.SS1.SSS0.Px1.p2" class="ltx_para">
<span id="S7.SS1.SSS0.Px1.p2.1" class="ltx_p">The definition of failure to respond may vary from one implementation to another. As an example, the customer may choose to receive a valid output within a certain time period. Alternatively the time-out decision may depend on the periodic responses by the service provider through Job Feedback events (Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), that notify the customer about the status of the job and provide partial results of the computation.</span>
</span>
</section>
<section id="S7.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Validation of the Output (Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</h4>

<span id="S7.SS1.SSS0.Px2.p1" class="ltx_para">
<span id="S7.SS1.SSS0.Px2.p1.1" class="ltx_p">Upon receiving a Job Result event (Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) the customer proceeds to verify the accuracy of the output. In the context of training AI models with FEDAVG and DiLoCl, we consider two conditions that test the decay of the loss on a validation dataset. Specifically, Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> requires as input the validation dataset, the current state of the model (model parameters), and a threshold for the two following policies. As a first option, we compare the loss decay progress relative to other service providers (see accuracy against service providers, Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). This validation test has been introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, Accuracy Checking]</cite>. As a second option, we consider a test that checks if a moving average of loss decays with a certain rate (Algorithm <a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Alternative accuracy tests and approaches to identify malicious service providers appear in prior works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Such implementations may be considered in parallel with our design but remain out of the scope of this work.</span>
</span>
<span id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Customer</span>
<span id="alg1.3" class="ltx_listing ltx_listing">
<span id="alg1.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="color:#000066;">C_NPUB</span>: Customer’s NOSTR public key, <span id="alg1.l1.3" class="ltx_text" style="color:#000066;">DATA_SOURCE</span>: link to the data, <span id="alg1.l1.4" class="ltx_text" style="color:#000066;">NUM_PR</span>: # of providers, <span id="alg1.l1.5" class="ltx_text" style="color:#000066;">NUM_JOBS</span> : Total # of jobs for each provider, <span id="alg1.l1.6" class="ltx_text" style="color:#000066;">RELAYS</span>: a set of relays

</span>
<span id="alg1.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Connection through websockets to all <span id="alg1.l2.3" class="ltx_text ltx_font_italic" style="color:#00260D;">relays</span> in <span id="alg1.l2.4" class="ltx_text" style="color:#000066;">RELAYS</span> <span id="alg1.l2.1" class="ltx_text" style="float:right;"><math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l2.1.1" class="ltx_text" style="color:#BF8040;"> Where events are published at<span id="alg1.l2.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg1.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.3" class="ltx_text ltx_font_bold" style="color:#000000;">Search Routine</span><span id="alg1.l3.4" class="ltx_text" style="color:#000000;">: Search for </span><span id="alg1.l3.5" class="ltx_text" style="color:#000066;">NUM_PR</span><span id="alg1.l3.6" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l3.7" class="ltx_text" style="color:#000066;">AVAILABLE</span><span id="alg1.l3.8" class="ltx_text" style="color:#000000;"> service providers. </span><span id="alg1.l3.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l3.1.m1.1a"><mo mathcolor="#000000" id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l3.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a></span> </span>
</span>
<span id="alg1.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold" style="color:#000000;">Search Routine returns</span><span id="alg1.l4.3" class="ltx_text" style="color:#000000;">: </span><span id="alg1.l4.4" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l4.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg1.l4.6" class="ltx_text" style="color:#000066;">NUM_PR</span><span id="alg1.l4.7" class="ltx_text" style="color:#000000;"> NPUBs entries
</span>
</span>
<span id="alg1.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.4.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.5" class="ltx_text" style="color:#000000;">Split the data to </span><span id="alg1.l5.6" class="ltx_text" style="color:#000066;">NUM_PR</span><span id="alg1.l5.7" class="ltx_text" style="color:#000000;"> parts and generate the list </span><span id="alg1.l5.8" class="ltx_text" style="color:#000066;">DATA_SOURCES</span><span id="alg1.l5.9" class="ltx_text" style="color:#000000;"> with </span><span id="alg1.l5.10" class="ltx_text" style="color:#000066;">NUM_PR</span><span id="alg1.l5.11" class="ltx_text" style="color:#000000;"> sources to each data segment </span><span id="alg1.l5.3" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l5.1.m1.1a"><mo mathcolor="#000000" id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l5.2.1" class="ltx_text" style="color:#BF8040;"> <span id="alg1.l5.2.1.1" class="ltx_text" style="color:#000066;">DATA_SOURCES<math id="alg1.l5.2.1.1.m1.1" class="ltx_Math" alttext="(i)" display="inline"><semantics id="alg1.l5.2.1.1.m1.1a"><mrow id="alg1.l5.2.1.1.m1.1.2.2"><mo mathcolor="#000000" stretchy="false" id="alg1.l5.2.1.1.m1.1.2.2.1">(</mo><mi mathcolor="#000000" id="alg1.l5.2.1.1.m1.1.1" xref="alg1.l5.2.1.1.m1.1.1.cmml">i</mi><mo mathcolor="#000000" stretchy="false" id="alg1.l5.2.1.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.2.1.1.m1.1b"><ci id="alg1.l5.2.1.1.m1.1.1.cmml" xref="alg1.l5.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.2.1.1.m1.1c">(i)</annotation></semantics></math></span></span> <span id="alg1.l5.3.2" class="ltx_text" style="color:#BF8040;"> is the data source of the <math id="alg1.l5.3.2.m1.1" class="ltx_Math" alttext="i_{\text{th}}" display="inline"><semantics id="alg1.l5.3.2.m1.1a"><msub id="alg1.l5.3.2.m1.1.1" xref="alg1.l5.3.2.m1.1.1.cmml"><mi mathcolor="#BF8040" id="alg1.l5.3.2.m1.1.1.2" xref="alg1.l5.3.2.m1.1.1.2.cmml">i</mi><mtext mathcolor="#BF8040" id="alg1.l5.3.2.m1.1.1.3" xref="alg1.l5.3.2.m1.1.1.3a.cmml">th</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.3.2.m1.1b"><apply id="alg1.l5.3.2.m1.1.1.cmml" xref="alg1.l5.3.2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.3.2.m1.1.1.1.cmml" xref="alg1.l5.3.2.m1.1.1">subscript</csymbol><ci id="alg1.l5.3.2.m1.1.1.2.cmml" xref="alg1.l5.3.2.m1.1.1.2">𝑖</ci><ci id="alg1.l5.3.2.m1.1.1.3a.cmml" xref="alg1.l5.3.2.m1.1.1.3"><mtext mathcolor="#BF8040" mathsize="70%" id="alg1.l5.3.2.m1.1.1.3.cmml" xref="alg1.l5.3.2.m1.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.3.2.m1.1c">i_{\text{th}}</annotation></semantics></math> provider </span>
</span>
</span>
<span id="alg1.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="color:#000000;">Initialize the optimization parameters and model: </span><span id="alg1.l6.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg1.l6.4" class="ltx_text" style="color:#000000;">, </span><span id="alg1.l6.5" class="ltx_text ltx_font_italic" style="color:#00260D;">model</span><span id="alg1.l6.6" class="ltx_text" style="color:#000000;">, …
</span>
</span>
<span id="alg1.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.3" class="ltx_text" style="color:#000000;">Publish </span><span id="alg1.l7.4" class="ltx_text" style="color:#78453B;">Job Requests</span><span id="alg1.l7.5" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l7.6" class="ltx_text" style="color:#78453B;">KIND: 8000</span><span id="alg1.l7.7" class="ltx_text" style="color:#000000;"> with all the required information </span><span id="alg1.l7.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l7.1.m1.1a"><mo mathcolor="#000000" id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l7.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> </span>
</span>
</span>
<span id="alg1.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.3" class="ltx_text" style="color:#000000;">Wait for </span><span id="alg1.l8.4" class="ltx_text" style="color:#78453B;">Job Feedback</span><span id="alg1.l8.5" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l8.6" class="ltx_text" style="color:#78453B;">KIND: 7000</span><span id="alg1.l8.7" class="ltx_text" style="color:#000000;"> and payment-request from service providers </span><span id="alg1.l8.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo mathcolor="#000000" id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l8.1.1" class="ltx_text" style="color:#BF8040;">Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> </span>
</span>
</span>
<span id="alg1.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="color:#000000;">Submit an initialization payment to </span><span id="alg1.l9.3" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l9.4" class="ltx_text" style="color:#000000;"> </span>
</span>
<span id="alg1.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text ltx_font_bold" style="color:#000000;">for</span><span id="alg1.l10.3" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l10.4" class="ltx_text ltx_font_italic" style="color:#00260D;">job</span><span id="alg1.l10.5" class="ltx_text" style="color:#000000;"> in (1,</span><span id="alg1.l10.6" class="ltx_text" style="color:#000066;">NUM_JOBS</span><span id="alg1.l10.7" class="ltx_text" style="color:#000000;">) </span><span id="alg1.l10.8" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg1.l10.9" class="ltx_text" style="color:#000000;"> </span>
</span>
<span id="alg1.l11" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg1.l11.2" class="ltx_text" style="color:#000000;">     Initialize </span><span id="alg1.l11.3" class="ltx_text" style="color:#00260D;">done</span><span id="alg1.l11.4" class="ltx_text" style="color:#000000;"> </span><math id="alg1.l11.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l11.m1.1a"><mo mathcolor="#000000" stretchy="false" id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\leftarrow</annotation></semantics></math><span id="alg1.l11.5" class="ltx_text" style="color:#000000;"> FALSE
</span>
</span>
<span id="alg1.l12" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l12.3" class="ltx_text ltx_font_bold" style="color:#000000;">while</span><span id="alg1.l12.4" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l12.5" class="ltx_text" style="color:#00260D;">done</span><span id="alg1.l12.6" class="ltx_text" style="color:#000000;"> </span><math id="alg1.l12.m1.1" class="ltx_Math" alttext="\neq" display="inline"><semantics id="alg1.l12.m1.1a"><mo mathcolor="#000000" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><neq id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\neq</annotation></semantics></math><span id="alg1.l12.7" class="ltx_text" style="color:#000000;"> TRUE  </span><span id="alg1.l12.8" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg1.l12.9" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l13" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg1.l13.2" class="ltx_text" style="color:#000000;">         Wait some time
</span>
</span>
<span id="alg1.l14" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg1.l14.2" class="ltx_text" style="color:#000000;">         Fetch </span><span id="alg1.l14.3" class="ltx_text" style="color:#78453B;">Job Feedback</span><span id="alg1.l14.4" class="ltx_text" style="color:#000000;"> events </span><span id="alg1.l14.5" class="ltx_text" style="color:#78453B;">(KIND:7000)</span><span id="alg1.l14.6" class="ltx_text" style="color:#000000;"> from each provider in </span><span id="alg1.l14.7" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l14.8" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l15" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text" style="color:#000000;">         </span><span id="alg1.l15.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg1.l15.4" class="ltx_text" style="color:#000000;"> Time-out occurs </span><span id="alg1.l15.5" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg1.l15.6" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l16" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg1.l16.2" class="ltx_text" style="color:#000000;">              Call Reassign (Algorithm </span><a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref" style="color:#000000;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="alg1.l16.3" class="ltx_text" style="color:#000000;">) to replace all the delayed service providers, update </span><span id="alg1.l16.4" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l16.5" class="ltx_text" style="color:#000000;">
         </span>
</span>
<span id="alg1.l17" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg1.l17.2" class="ltx_text" style="color:#000000;">         </span><span id="alg1.l17.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg1.l17.4" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l17.5" class="ltx_text" style="color:#000066;">JOB_STATUS</span><span id="alg1.l17.6" class="ltx_text" style="color:#000000;"> = </span><span id="alg1.l17.7" class="ltx_text" style="color:#00260D;">success</span><span id="alg1.l17.8" class="ltx_text" style="color:#000000;"> for all providers in </span><span id="alg1.l17.9" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l17.10" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l17.11" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg1.l17.12" class="ltx_text" style="color:#000000;">
</span><span id="alg1.l17.13" class="ltx_text" style="color:#00260D;">done</span><span id="alg1.l17.14" class="ltx_text" style="color:#000000;"> = TRUE
              </span>
</span>
<span id="alg1.l18" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.2.1.1" class="ltx_text" style="font-size:80%;">18:</span></span><span id="alg1.l18.3" class="ltx_text" style="color:#000000;">     Fetch </span><span id="alg1.l18.4" class="ltx_text" style="color:#78453B;">Job Results</span><span id="alg1.l18.5" class="ltx_text" style="color:#000000;"> (</span><span id="alg1.l18.6" class="ltx_text" style="color:#78453B;">KIND: 6000</span><span id="alg1.l18.7" class="ltx_text" style="color:#000000;">) and </span><span id="alg1.l18.8" class="ltx_text" style="color:#00260D;">"outputs"</span><span id="alg1.l18.9" class="ltx_text" style="color:#000000;"> from all providers in </span><span id="alg1.l18.10" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l18.11" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l18.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l18.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l18.1.m1.1a"><mo mathcolor="#000000" id="alg1.l18.1.m1.1.1" xref="alg1.l18.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l18.1.m1.1b"><ci id="alg1.l18.1.m1.1.1.cmml" xref="alg1.l18.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l18.1.1" class="ltx_text" style="color:#BF8040;">Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> </span>
</span>
</span>
<span id="alg1.l19" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span><span id="alg1.l19.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l19.3" class="ltx_text ltx_font_bold" style="color:#000000;">for</span><span id="alg1.l19.4" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l19.5" class="ltx_text ltx_font_italic" style="color:#00260D;">service_provider</span><span id="alg1.l19.6" class="ltx_text" style="color:#000000;"> in </span><span id="alg1.l19.7" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l19.8" class="ltx_text" style="color:#000000;"> call the Validation routine (Algorithm </span><a href="#alg3" title="Algorithm 3 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref" style="color:#000000;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="alg1.l19.9" class="ltx_text" style="color:#000000;">) and </span><span id="alg1.l19.10" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg1.l19.11" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l20" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span><span id="alg1.l20.2" class="ltx_text" style="color:#000000;">         </span><span id="alg1.l20.3" class="ltx_text ltx_font_bold" style="color:#000000;">while</span><span id="alg1.l20.4" class="ltx_text" style="color:#000000;"> Validation_Test = </span><span id="alg1.l20.5" class="ltx_text" style="color:#000066;">FAIL</span><span id="alg1.l20.6" class="ltx_text" style="color:#000000;"> for the </span><span id="alg1.l20.7" class="ltx_text ltx_font_italic" style="color:#00260D;">service_provider</span><span id="alg1.l20.8" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l20.9" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg1.l20.10" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l21" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span><span id="alg1.l21.2" class="ltx_text" style="color:#000000;">              Reassign the job of </span><span id="alg1.l21.3" class="ltx_text ltx_font_italic" style="color:#00260D;">service_provider</span><span id="alg1.l21.4" class="ltx_text" style="color:#000000;">; call Reassign (Algorithm </span><a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref" style="color:#000000;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="alg1.l21.5" class="ltx_text" style="color:#000000;">), update </span><span id="alg1.l21.6" class="ltx_text" style="color:#000066;">PROVIDERS</span><span id="alg1.l21.7" class="ltx_text" style="color:#000000;">
         </span>
</span>
<span id="alg1.l22" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span><span id="alg1.l22.2" class="ltx_text" style="color:#000000;">         Submit (partial) payments to </span><span id="alg1.l22.3" class="ltx_text ltx_font_italic" style="color:#00260D;">service_provider</span><span id="alg1.l22.4" class="ltx_text" style="color:#000000;"> and publish </span><span id="alg1.l22.5" class="ltx_text" style="color:#78453B;">Payment Receipt (KIND: 9735)</span><span id="alg1.l22.6" class="ltx_text" style="color:#000000;">
     </span>
</span>
<span id="alg1.l23" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span><span id="alg1.l23.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l23.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg1.l23.4" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l23.5" class="ltx_text" style="color:#000066;">OUTER_OPTIMIZER</span><span id="alg1.l23.6" class="ltx_text" style="color:#000000;"> </span><math id="alg1.l23.m1.1" class="ltx_Math" alttext="=" display="inline"><semantics id="alg1.l23.m1.1a"><mo mathcolor="#000000" id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><eq id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">=</annotation></semantics></math><span id="alg1.l23.7" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l23.8" class="ltx_text" style="color:#000066;">SELF</span><span id="alg1.l23.9" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l23.10" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg1.l23.11" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l24" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span><span id="alg1.l24.2" class="ltx_text" style="color:#000000;">         Run the Outer_Optimization routine (Algorithm </span><a href="#alg6" title="Algorithm 6 ‣ Outer Optimization (Algorithm 6) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref" style="color:#000000;"><span class="ltx_text ltx_ref_tag">6</span></a><span id="alg1.l24.3" class="ltx_text" style="color:#000000;">) with input the current updates </span><span id="alg1.l24.4" class="ltx_text" style="color:#00260D;">"outputs"</span><span id="alg1.l24.5" class="ltx_text" style="color:#000000;"> </span>
</span>
<span id="alg1.l25" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span><span id="alg1.l25.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l25.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span>
</span>
<span id="alg1.l26" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span><span id="alg1.l26.2" class="ltx_text" style="color:#000000;">         Reassign the Outer Optimization from </span><span id="alg1.l26.3" class="ltx_text" style="color:#000066;">SELF</span><span id="alg1.l26.4" class="ltx_text" style="color:#000000;"> to a service provider (Algorithm </span><a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref" style="color:#000000;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="alg1.l26.5" class="ltx_text" style="color:#000000;">)
</span>
</span>
<span id="alg1.l27" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span><span id="alg1.l27.2" class="ltx_text" style="color:#000000;">         Submit (partial) payment to </span><span id="alg1.l27.3" class="ltx_text" style="color:#000066;">OUTER_OPTIMIZER</span><span id="alg1.l27.4" class="ltx_text" style="color:#000000;"> and publish </span><span id="alg1.l27.5" class="ltx_text" style="color:#78453B;">Payment Receipt (KIND: 9735)</span><span id="alg1.l27.6" class="ltx_text" style="color:#000000;">
     </span>
</span>
<span id="alg1.l28" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span><span id="alg1.l28.2" class="ltx_text" style="color:#000000;">     Update </span><span id="alg1.l28.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg1.l28.4" class="ltx_text" style="color:#000000;"> using the "output" of the OUTER_OPTIMIZER
</span>
</span>
<span id="alg1.l29" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span><span id="alg1.l29.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l29.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg1.l29.4" class="ltx_text" style="color:#000000;"> stopping condition is satisfied  </span><span id="alg1.l29.5" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg1.l29.6" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l30" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l30.1.1.1" class="ltx_text" style="font-size:80%;">30:</span></span><span id="alg1.l30.2" class="ltx_text" style="color:#000000;">         break
</span>
</span>
<span id="alg1.l31" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l31.1.1.1" class="ltx_text" style="font-size:80%;">31:</span></span><span id="alg1.l31.2" class="ltx_text" style="color:#000000;">     </span><span id="alg1.l31.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg1.l31.4" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l31.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg1.l31.6" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l31.7" class="ltx_text ltx_font_italic" style="color:#00260D;">job</span><span id="alg1.l31.8" class="ltx_text" style="color:#000000;"> </span><math id="alg1.l31.m1.1" class="ltx_Math" alttext="\leq" display="inline"><semantics id="alg1.l31.m1.1a"><mo mathcolor="#000000" id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><leq id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">\leq</annotation></semantics></math><span id="alg1.l31.9" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l31.10" class="ltx_text" style="color:#000066;">NUM_JOBS</span><span id="alg1.l31.11" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l31.12" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg1.l31.13" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg1.l32" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l32.2.1.1" class="ltx_text" style="font-size:80%;">32:</span></span><span id="alg1.l32.3" class="ltx_text" style="color:#000000;">         Publish </span><span id="alg1.l32.4" class="ltx_text" style="color:#78453B;">Job Requests</span><span id="alg1.l32.5" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l32.6" class="ltx_text" style="color:#78453B;">KIND: 8000</span><span id="alg1.l32.7" class="ltx_text" style="color:#000000;"> with all the required information </span><span id="alg1.l32.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l32.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l32.1.m1.1a"><mo mathcolor="#000000" id="alg1.l32.1.m1.1.1" xref="alg1.l32.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l32.1.m1.1b"><ci id="alg1.l32.1.m1.1.1.cmml" xref="alg1.l32.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l32.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> </span>
     </span>
</span>
<span id="alg1.l33" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l33.2.1.1" class="ltx_text" style="font-size:80%;">33:</span></span><span id="alg1.l33.3" class="ltx_text" style="color:#000000;">Finalize payments to every </span><span id="alg1.l33.4" class="ltx_text ltx_font_italic" style="color:#00260D;">service_provider<span id="alg1.l33.4.1" class="ltx_text ltx_font_upright"> in <span id="alg1.l33.4.1.1" class="ltx_text" style="color:#000066;">PROVIDERS</span></span></span><span id="alg1.l33.5" class="ltx_text" style="color:#000000;"> and publish receipts </span><span id="alg1.l33.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg1.l33.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l33.1.m1.1a"><mo mathcolor="#000000" id="alg1.l33.1.m1.1.1" xref="alg1.l33.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l33.1.m1.1b"><ci id="alg1.l33.1.m1.1.1.cmml" xref="alg1.l33.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l33.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l33.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST7" title="Event Type 7 ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> </span>
</span>
</span>
<span id="alg1.l34" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l34.1.1.1" class="ltx_text" style="font-size:80%;">34:</span></span><span id="alg1.l34.2" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg1.l34.3" class="ltx_text" style="color:#000000;"> </span><span id="alg1.l34.4" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg1.l34.5" class="ltx_text" style="color:#000000;">
</span>
</span>
</span>
</span>
</section>
<section id="S7.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reassigning the Job to a Different Service Provider (Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</h4>

<span id="S7.SS1.SSS0.Px3.p1" class="ltx_para">
<span id="S7.SS1.SSS0.Px3.p1.1" class="ltx_p">Under a time-out or a failed validation instance, the customer reassigns the job to a different service provider. We provide an example of such implementation in Algorithm <a href="#alg2" title="Algorithm 2 ‣ Reassigning the Job to a Different Service Provider (Algorithm 2). ‣ 7.1 Customer ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Further, under perpetual time-outs and invalid output detection, the customer continues to reassign the job, until a service provider delivers a valid output. Then the routine returns the public key of new service provider and the customer updates the list of the service providers under consideration.</span>
</span>
<span id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Reassign the job of a Service Provider to a different Service Provider</span>
<span id="alg2.3" class="ltx_listing ltx_listing">
<span id="alg2.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text" style="color:#000066;">SP_NPUB</span>: public key of the service provider that will be be replaced, &lt;computation information &amp; time&gt;, <span id="alg2.l1.3" class="ltx_text" style="color:#000066;">RUN_OPTION</span>: &lt;FEDAVG or DiLoCo&gt;, <span id="alg2.l1.4" class="ltx_text" style="color:#000066;">DATA:</span> <span id="alg2.l1.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span> , <span id="alg2.l1.6" class="ltx_text" style="color:#000066;">PROVIDERS</span>, <span id="alg2.l1.7" class="ltx_text" style="color:#000066;">TASK</span>: &lt;INNER or OUTER&gt;

</span>
<span id="alg2.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Connection through websockets to all <span id="alg2.l2.3" class="ltx_text ltx_font_italic" style="color:#00260D;">relays</span> in <span id="alg2.l2.4" class="ltx_text" style="color:#000066;">RELAYS</span> <span id="alg2.l2.1" class="ltx_text" style="float:right;"><math id="alg2.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l2.1.m1.1a"><mo id="alg2.l2.1.m1.1.1" xref="alg2.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l2.1.m1.1b"><ci id="alg2.l2.1.m1.1.1.cmml" xref="alg2.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg2.l2.1.1" class="ltx_text" style="color:#BF8040;"> Where events are published at<span id="alg2.l2.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg2.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg2.l3.3" class="ltx_text ltx_font_bold" style="color:#000000;">Search Routine</span><span id="alg2.l3.4" class="ltx_text" style="color:#000000;">: Search for an </span><span id="alg2.l3.5" class="ltx_text" style="color:#000066;">AVAILABLE</span><span id="alg2.l3.6" class="ltx_text" style="color:#000000;"> service provider for </span><span id="alg2.l3.7" class="ltx_text" style="color:#78453B;">KIND: 8000</span><span id="alg2.l3.8" class="ltx_text" style="color:#000000;">. </span><span id="alg2.l3.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg2.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l3.1.m1.1a"><mo mathcolor="#000000" id="alg2.l3.1.m1.1.1" xref="alg2.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l3.1.m1.1b"><ci id="alg2.l3.1.m1.1.1.cmml" xref="alg2.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg2.l3.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a></span> </span>
</span>
<span id="alg2.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg2.l4.2" class="ltx_text ltx_font_bold" style="color:#000000;">Search Routine returns</span><span id="alg2.l4.3" class="ltx_text" style="color:#000000;">: A single public key: </span><span id="alg2.l4.4" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l4.5" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.2.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg2.l5.3" class="ltx_text" style="color:#000000;">Publish a </span><span id="alg2.l5.4" class="ltx_text" style="color:#78453B;">Job Request</span><span id="alg2.l5.5" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l5.6" class="ltx_text" style="color:#78453B;">KIND: 8000</span><span id="alg2.l5.7" class="ltx_text" style="color:#000000;">: Identical to the last job request for the service provider </span><span id="alg2.l5.8" class="ltx_text" style="color:#000066;">SP_NPUB</span><span id="alg2.l5.9" class="ltx_text" style="color:#000000;">, but with updated field "p" to </span><span id="alg2.l5.10" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l5.11" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l5.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg2.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l5.1.m1.1a"><mo mathcolor="#000000" id="alg2.l5.1.m1.1.1" xref="alg2.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.1b"><ci id="alg2.l5.1.m1.1.1.cmml" xref="alg2.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg2.l5.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></span>
</span>
</span>
<span id="alg2.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg2.l6.2" class="ltx_text" style="color:#000000;">Wait for </span><span id="alg2.l6.3" class="ltx_text" style="color:#78453B;">Job Feedback</span><span id="alg2.l6.4" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l6.5" class="ltx_text" style="color:#78453B;">KIND: 7000</span><span id="alg2.l6.6" class="ltx_text" style="color:#000000;"> and payment-request from service provider </span><span id="alg2.l6.7" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l6.8" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg2.l7.2" class="ltx_text" style="color:#000000;">Submit an initialization payment to </span><span id="alg2.l7.3" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l7.4" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg2.l8.2" class="ltx_text ltx_font_bold" style="color:#000000;">while</span><span id="alg2.l8.3" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l8.4" class="ltx_text" style="color:#000066;">JOB_STATUS</span><span id="alg2.l8.5" class="ltx_text" style="color:#000000;"> </span><math id="alg2.l8.m1.1" class="ltx_Math" alttext="\neq" display="inline"><semantics id="alg2.l8.m1.1a"><mo mathcolor="#000000" id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><neq id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\neq</annotation></semantics></math><span id="alg2.l8.6" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l8.7" class="ltx_text" style="color:#000066;">success</span><span id="alg2.l8.8" class="ltx_text" style="color:#000000;"> for </span><span id="alg2.l8.9" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l8.10" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l8.11" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg2.l8.12" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg2.l9.2" class="ltx_text" style="color:#000000;">     Wait some time
</span>
</span>
<span id="alg2.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.2.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg2.l10.3" class="ltx_text" style="color:#000000;">     Fetch </span><span id="alg2.l10.4" class="ltx_text" style="color:#78453B;">Job Feedback</span><span id="alg2.l10.5" class="ltx_text" style="color:#000000;"> events </span><span id="alg2.l10.6" class="ltx_text" style="color:#78453B;">(KIND:7000)</span><span id="alg2.l10.7" class="ltx_text" style="color:#000000;"> from service provider </span><span id="alg2.l10.8" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l10.9" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l10.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg2.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l10.1.m1.1a"><mo mathcolor="#000000" id="alg2.l10.1.m1.1.1" xref="alg2.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l10.1.m1.1b"><ci id="alg2.l10.1.m1.1.1.cmml" xref="alg2.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg2.l10.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> </span>
</span>
</span>
<span id="alg2.l11" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg2.l11.2" class="ltx_text" style="color:#000000;">     </span><span id="alg2.l11.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg2.l11.4" class="ltx_text" style="color:#000000;"> time-out occurs </span><span id="alg2.l11.5" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg2.l11.6" class="ltx_text" style="color:#000000;"> break and Reassign again to replace </span><span id="alg2.l11.7" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l11.8" class="ltx_text" style="color:#000000;">
     </span>
</span>
<span id="alg2.l12" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg2.l12.2" class="ltx_text" style="color:#000000;">     </span><span id="alg2.l12.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg2.l12.4" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l12.5" class="ltx_text" style="color:#000066;">JOB_STATUS</span><span id="alg2.l12.6" class="ltx_text" style="color:#000000;"> = </span><span id="alg2.l12.7" class="ltx_text" style="color:#00260D;">success</span><span id="alg2.l12.8" class="ltx_text" style="color:#000000;"> for </span><span id="alg2.l12.9" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l12.10" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l12.11" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg2.l12.12" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l13" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.2.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg2.l13.3" class="ltx_text" style="color:#000000;">         Fetch </span><span id="alg2.l13.4" class="ltx_text" style="color:#78453B;">Job Result</span><span id="alg2.l13.5" class="ltx_text" style="color:#000000;"> (</span><span id="alg2.l13.6" class="ltx_text" style="color:#78453B;">KIND: 6000</span><span id="alg2.l13.7" class="ltx_text" style="color:#000000;">) and </span><span id="alg2.l13.8" class="ltx_text" style="color:#00260D;">"output"</span><span id="alg2.l13.9" class="ltx_text" style="color:#000000;"> from </span><span id="alg2.l13.10" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l13.11" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l13.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg2.l13.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l13.1.m1.1a"><mo mathcolor="#000000" id="alg2.l13.1.m1.1.1" xref="alg2.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l13.1.m1.1b"><ci id="alg2.l13.1.m1.1.1.cmml" xref="alg2.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg2.l13.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> </span>
</span>
</span>
<span id="alg2.l14" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg2.l14.2" class="ltx_text" style="color:#000000;">         Call the Validation Routine
</span>
</span>
<span id="alg2.l15" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg2.l15.2" class="ltx_text" style="color:#000000;">         </span><span id="alg2.l15.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg2.l15.4" class="ltx_text" style="color:#000000;"> Validation_Test = </span><span id="alg2.l15.5" class="ltx_text" style="color:#000066;">PASS</span><span id="alg2.l15.6" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l15.7" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg2.l15.8" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg2.l16" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg2.l16.2" class="ltx_text" style="color:#000000;">              </span><span id="alg2.l16.3" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg2.l16.4" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l16.5" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l16.6" class="ltx_text" style="color:#000000;">, "output"
</span>
</span>
<span id="alg2.l17" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg2.l17.2" class="ltx_text" style="color:#000000;">         </span><span id="alg2.l17.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg2.l17.4" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l17.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg2.l17.6" class="ltx_text" style="color:#000000;"> Validation_Test = </span><span id="alg2.l17.7" class="ltx_text" style="color:#000066;">FAIL</span><span id="alg2.l17.8" class="ltx_text" style="color:#000000;"> </span><span id="alg2.l17.9" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg2.l17.10" class="ltx_text" style="color:#000000;"> break and
Reassign again to replace </span><span id="alg2.l17.11" class="ltx_text" style="color:#000066;">SP_NPUB_NEW</span><span id="alg2.l17.12" class="ltx_text" style="color:#000000;">
              </span>
</span>
</span>
</span>
<span id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Validation of the Service Provider Output</span>
<span id="alg3.3" class="ltx_listing ltx_listing">
<span id="alg3.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg3.l1.2" class="ltx_text" style="color:#000066;">SP_NPUB</span>: service provider public key, <span id="alg3.l1.3" class="ltx_text" style="color:#000066;">RUN_OPTION</span>: &lt;FEDAVG or DiLoCo&gt;, validation-dataset: <math id="alg3.l1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\text{test}}" display="inline"><semantics id="alg3.l1.m1.1a"><msub id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">𝒟</mi><mtext id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1">subscript</csymbol><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">𝒟</ci><ci id="alg3.l1.m1.1.1.3a.cmml" xref="alg3.l1.m1.1.1.3"><mtext mathsize="70%" id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">\mathcal{D}_{\text{test}}</annotation></semantics></math>, <span id="alg3.l1.4" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span>: <math id="alg3.l1.m2.1" class="ltx_Math" alttext="\theta_{\text{global}}" display="inline"><semantics id="alg3.l1.m2.1a"><msub id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml"><mi id="alg3.l1.m2.1.1.2" xref="alg3.l1.m2.1.1.2.cmml">θ</mi><mtext id="alg3.l1.m2.1.1.3" xref="alg3.l1.m2.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.1.cmml" xref="alg3.l1.m2.1.1">subscript</csymbol><ci id="alg3.l1.m2.1.1.2.cmml" xref="alg3.l1.m2.1.1.2">𝜃</ci><ci id="alg3.l1.m2.1.1.3a.cmml" xref="alg3.l1.m2.1.1.3"><mtext mathsize="70%" id="alg3.l1.m2.1.1.3.cmml" xref="alg3.l1.m2.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">\theta_{\text{global}}</annotation></semantics></math>, the last "outputs" of the Inner Optimization jobs: <math id="alg3.l1.m3.1" class="ltx_Math" alttext="\theta_{\text{Inner}}" display="inline"><semantics id="alg3.l1.m3.1a"><msub id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml"><mi id="alg3.l1.m3.1.1.2" xref="alg3.l1.m3.1.1.2.cmml">θ</mi><mtext id="alg3.l1.m3.1.1.3" xref="alg3.l1.m3.1.1.3a.cmml">Inner</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><apply id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1"><csymbol cd="ambiguous" id="alg3.l1.m3.1.1.1.cmml" xref="alg3.l1.m3.1.1">subscript</csymbol><ci id="alg3.l1.m3.1.1.2.cmml" xref="alg3.l1.m3.1.1.2">𝜃</ci><ci id="alg3.l1.m3.1.1.3a.cmml" xref="alg3.l1.m3.1.1.3"><mtext mathsize="70%" id="alg3.l1.m3.1.1.3.cmml" xref="alg3.l1.m3.1.1.3">Inner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">\theta_{\text{Inner}}</annotation></semantics></math> and the increments <math id="alg3.l1.m4.1" class="ltx_Math" alttext="\Delta\theta_{\text{Inner}}" display="inline"><semantics id="alg3.l1.m4.1a"><mrow id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml"><mi mathvariant="normal" id="alg3.l1.m4.1.1.2" xref="alg3.l1.m4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg3.l1.m4.1.1.1" xref="alg3.l1.m4.1.1.1.cmml">​</mo><msub id="alg3.l1.m4.1.1.3" xref="alg3.l1.m4.1.1.3.cmml"><mi id="alg3.l1.m4.1.1.3.2" xref="alg3.l1.m4.1.1.3.2.cmml">θ</mi><mtext id="alg3.l1.m4.1.1.3.3" xref="alg3.l1.m4.1.1.3.3a.cmml">Inner</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><apply id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1"><times id="alg3.l1.m4.1.1.1.cmml" xref="alg3.l1.m4.1.1.1"></times><ci id="alg3.l1.m4.1.1.2.cmml" xref="alg3.l1.m4.1.1.2">Δ</ci><apply id="alg3.l1.m4.1.1.3.cmml" xref="alg3.l1.m4.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m4.1.1.3.1.cmml" xref="alg3.l1.m4.1.1.3">subscript</csymbol><ci id="alg3.l1.m4.1.1.3.2.cmml" xref="alg3.l1.m4.1.1.3.2">𝜃</ci><ci id="alg3.l1.m4.1.1.3.3a.cmml" xref="alg3.l1.m4.1.1.3.3"><mtext mathsize="70%" id="alg3.l1.m4.1.1.3.3.cmml" xref="alg3.l1.m4.1.1.3.3">Inner</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">\Delta\theta_{\text{Inner}}</annotation></semantics></math>, policy thresholds: <math id="alg3.l1.m5.2" class="ltx_Math" alttext="\gamma_{t},\beta_{t}" display="inline"><semantics id="alg3.l1.m5.2a"><mrow id="alg3.l1.m5.2.2.2" xref="alg3.l1.m5.2.2.3.cmml"><msub id="alg3.l1.m5.1.1.1.1" xref="alg3.l1.m5.1.1.1.1.cmml"><mi id="alg3.l1.m5.1.1.1.1.2" xref="alg3.l1.m5.1.1.1.1.2.cmml">γ</mi><mi id="alg3.l1.m5.1.1.1.1.3" xref="alg3.l1.m5.1.1.1.1.3.cmml">t</mi></msub><mo id="alg3.l1.m5.2.2.2.3" xref="alg3.l1.m5.2.2.3.cmml">,</mo><msub id="alg3.l1.m5.2.2.2.2" xref="alg3.l1.m5.2.2.2.2.cmml"><mi id="alg3.l1.m5.2.2.2.2.2" xref="alg3.l1.m5.2.2.2.2.2.cmml">β</mi><mi id="alg3.l1.m5.2.2.2.2.3" xref="alg3.l1.m5.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m5.2b"><list id="alg3.l1.m5.2.2.3.cmml" xref="alg3.l1.m5.2.2.2"><apply id="alg3.l1.m5.1.1.1.1.cmml" xref="alg3.l1.m5.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m5.1.1.1.1.1.cmml" xref="alg3.l1.m5.1.1.1.1">subscript</csymbol><ci id="alg3.l1.m5.1.1.1.1.2.cmml" xref="alg3.l1.m5.1.1.1.1.2">𝛾</ci><ci id="alg3.l1.m5.1.1.1.1.3.cmml" xref="alg3.l1.m5.1.1.1.1.3">𝑡</ci></apply><apply id="alg3.l1.m5.2.2.2.2.cmml" xref="alg3.l1.m5.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l1.m5.2.2.2.2.1.cmml" xref="alg3.l1.m5.2.2.2.2">subscript</csymbol><ci id="alg3.l1.m5.2.2.2.2.2.cmml" xref="alg3.l1.m5.2.2.2.2.2">𝛽</ci><ci id="alg3.l1.m5.2.2.2.2.3.cmml" xref="alg3.l1.m5.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m5.2c">\gamma_{t},\beta_{t}</annotation></semantics></math>, <span id="alg3.l1.5" class="ltx_text" style="color:#000066;">TEST_TYPE</span>

</span>
<span id="alg3.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>A history of model parameters is available. (<span id="alg3.l2.2" class="ltx_text" style="color:#000066;">TEST_TYPE</span> = "B" requires the previous <math id="alg3.l2.m1.1" class="ltx_Math" alttext="\tau_{c}" display="inline"><semantics id="alg3.l2.m1.1a"><msub id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mi id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml">τ</mi><mi id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1">subscript</csymbol><ci id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2">𝜏</ci><ci id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">\tau_{c}</annotation></semantics></math> model parameters for test condition)

</span>
<span id="alg3.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg3.l3.3" class="ltx_text ltx_font_bold">if</span> <span id="alg3.l3.4" class="ltx_text" style="color:#000066;">TEST_TYPE</span> = "A" <span id="alg3.l3.5" class="ltx_text ltx_font_bold">then</span> <span id="alg3.l3.1" class="ltx_text" style="float:right;"><math id="alg3.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l3.1.m1.1a"><mo id="alg3.l3.1.m1.1.1" xref="alg3.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l3.1.m1.1b"><ci id="alg3.l3.1.m1.1.1.cmml" xref="alg3.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg3.l3.1.1" class="ltx_text" style="color:#BF8040;">Check accuracy against other service providers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite><span id="alg3.l3.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg3.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg3.l4.2" class="ltx_text" style="color:#000000;">     </span><math id="alg3.l4.m1.1" class="ltx_Math" alttext="\tilde{\theta}\leftarrow\theta_{\text{global}}+\Delta\theta^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{SP\_NPUB}}}_{\text{Inner}}\ " display="inline"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><mover accent="true" id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml"><mi mathcolor="#000000" id="alg3.l4.m1.1.1.2.2" xref="alg3.l4.m1.1.1.2.2.cmml">θ</mi><mo mathcolor="#000000" id="alg3.l4.m1.1.1.2.1" xref="alg3.l4.m1.1.1.2.1.cmml">~</mo></mover><mo mathcolor="#000000" stretchy="false" id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">←</mo><mrow id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml"><msub id="alg3.l4.m1.1.1.3.2" xref="alg3.l4.m1.1.1.3.2.cmml"><mi mathcolor="#000000" id="alg3.l4.m1.1.1.3.2.2" xref="alg3.l4.m1.1.1.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg3.l4.m1.1.1.3.2.3" xref="alg3.l4.m1.1.1.3.2.3a.cmml">global</mtext></msub><mo mathcolor="#000000" id="alg3.l4.m1.1.1.3.1" xref="alg3.l4.m1.1.1.3.1.cmml">+</mo><mrow id="alg3.l4.m1.1.1.3.3" xref="alg3.l4.m1.1.1.3.3.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg3.l4.m1.1.1.3.3.2" xref="alg3.l4.m1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.3.3.1" xref="alg3.l4.m1.1.1.3.3.1.cmml">​</mo><msubsup id="alg3.l4.m1.1.1.3.3.3" xref="alg3.l4.m1.1.1.3.3.3.cmml"><mi mathcolor="#000000" id="alg3.l4.m1.1.1.3.3.3.2.2" xref="alg3.l4.m1.1.1.3.3.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg3.l4.m1.1.1.3.3.3.3" xref="alg3.l4.m1.1.1.3.3.3.3a.cmml">Inner</mtext><mtext mathcolor="#000066" id="alg3.l4.m1.1.1.3.3.3.2.3" xref="alg3.l4.m1.1.1.3.3.3.2.3a.cmml">SP_NPUB</mtext></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><ci id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1">←</ci><apply id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2"><ci id="alg3.l4.m1.1.1.2.1.cmml" xref="alg3.l4.m1.1.1.2.1">~</ci><ci id="alg3.l4.m1.1.1.2.2.cmml" xref="alg3.l4.m1.1.1.2.2">𝜃</ci></apply><apply id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3"><plus id="alg3.l4.m1.1.1.3.1.cmml" xref="alg3.l4.m1.1.1.3.1"></plus><apply id="alg3.l4.m1.1.1.3.2.cmml" xref="alg3.l4.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.2">subscript</csymbol><ci id="alg3.l4.m1.1.1.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.2.2">𝜃</ci><ci id="alg3.l4.m1.1.1.3.2.3a.cmml" xref="alg3.l4.m1.1.1.3.2.3"><mtext mathsize="70%" id="alg3.l4.m1.1.1.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.2.3">global</mtext></ci></apply><apply id="alg3.l4.m1.1.1.3.3.cmml" xref="alg3.l4.m1.1.1.3.3"><times id="alg3.l4.m1.1.1.3.3.1.cmml" xref="alg3.l4.m1.1.1.3.3.1"></times><ci id="alg3.l4.m1.1.1.3.3.2.cmml" xref="alg3.l4.m1.1.1.3.3.2">Δ</ci><apply id="alg3.l4.m1.1.1.3.3.3.cmml" xref="alg3.l4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.3.3.1.cmml" xref="alg3.l4.m1.1.1.3.3.3">subscript</csymbol><apply id="alg3.l4.m1.1.1.3.3.3.2.cmml" xref="alg3.l4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.3.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.3.3">superscript</csymbol><ci id="alg3.l4.m1.1.1.3.3.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.3.3.2.2">𝜃</ci><ci id="alg3.l4.m1.1.1.3.3.3.2.3a.cmml" xref="alg3.l4.m1.1.1.3.3.3.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l4.m1.1.1.3.3.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.3.3.2.3">SP_NPUB</mtext></ci></apply><ci id="alg3.l4.m1.1.1.3.3.3.3a.cmml" xref="alg3.l4.m1.1.1.3.3.3.3"><mtext mathsize="70%" id="alg3.l4.m1.1.1.3.3.3.3.cmml" xref="alg3.l4.m1.1.1.3.3.3.3">Inner</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\tilde{\theta}\leftarrow\theta_{\text{global}}+\Delta\theta^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{SP\_NPUB}}}_{\text{Inner}}\ </annotation></semantics></math>
</span>
<span id="alg3.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg3.l5.2" class="ltx_text" style="color:#000000;">     </span><math id="alg3.l5.m1.1" class="ltx_Math" alttext="\tilde{\theta}_{G\setminus\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}\leftarrow\theta_{\text{global}}+\sum_{\text{npub}\in\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}PROVIDERS}}}\Delta\theta^{\text{npub}}_{\text{Inner}}\ " display="inline"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><msub id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml"><mover accent="true" id="alg3.l5.m1.1.1.2.2" xref="alg3.l5.m1.1.1.2.2.cmml"><mi mathcolor="#000000" id="alg3.l5.m1.1.1.2.2.2" xref="alg3.l5.m1.1.1.2.2.2.cmml">θ</mi><mo mathcolor="#000000" id="alg3.l5.m1.1.1.2.2.1" xref="alg3.l5.m1.1.1.2.2.1.cmml">~</mo></mover><mrow id="alg3.l5.m1.1.1.2.3" xref="alg3.l5.m1.1.1.2.3.cmml"><mi mathcolor="#000000" id="alg3.l5.m1.1.1.2.3.2" xref="alg3.l5.m1.1.1.2.3.2.cmml">G</mi><mo mathcolor="#000000" id="alg3.l5.m1.1.1.2.3.1" xref="alg3.l5.m1.1.1.2.3.1.cmml">∖</mo><mtext mathcolor="#000066" id="alg3.l5.m1.1.1.2.3.3" xref="alg3.l5.m1.1.1.2.3.3a.cmml">SP_NPUB</mtext></mrow></msub><mo mathcolor="#000000" stretchy="false" id="alg3.l5.m1.1.1.1" xref="alg3.l5.m1.1.1.1.cmml">←</mo><mrow id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml"><msub id="alg3.l5.m1.1.1.3.2" xref="alg3.l5.m1.1.1.3.2.cmml"><mi mathcolor="#000000" id="alg3.l5.m1.1.1.3.2.2" xref="alg3.l5.m1.1.1.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg3.l5.m1.1.1.3.2.3" xref="alg3.l5.m1.1.1.3.2.3a.cmml">global</mtext></msub><mo mathcolor="#000000" rspace="0.055em" id="alg3.l5.m1.1.1.3.1" xref="alg3.l5.m1.1.1.3.1.cmml">+</mo><mrow id="alg3.l5.m1.1.1.3.3" xref="alg3.l5.m1.1.1.3.3.cmml"><msub id="alg3.l5.m1.1.1.3.3.1" xref="alg3.l5.m1.1.1.3.3.1.cmml"><mo mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.1.2" xref="alg3.l5.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="alg3.l5.m1.1.1.3.3.1.3" xref="alg3.l5.m1.1.1.3.3.1.3.cmml"><mtext mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.1.3.2" xref="alg3.l5.m1.1.1.3.3.1.3.2a.cmml">npub</mtext><mo mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.1.3.1" xref="alg3.l5.m1.1.1.3.3.1.3.1.cmml">∈</mo><mtext mathcolor="#000066" id="alg3.l5.m1.1.1.3.3.1.3.3" xref="alg3.l5.m1.1.1.3.3.1.3.3a.cmml">PROVIDERS</mtext></mrow></msub><mrow id="alg3.l5.m1.1.1.3.3.2" xref="alg3.l5.m1.1.1.3.3.2.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg3.l5.m1.1.1.3.3.2.2" xref="alg3.l5.m1.1.1.3.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.1.3.3.2.1" xref="alg3.l5.m1.1.1.3.3.2.1.cmml">​</mo><msubsup id="alg3.l5.m1.1.1.3.3.2.3" xref="alg3.l5.m1.1.1.3.3.2.3.cmml"><mi mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.2.3.2.2" xref="alg3.l5.m1.1.1.3.3.2.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.2.3.3" xref="alg3.l5.m1.1.1.3.3.2.3.3a.cmml">Inner</mtext><mtext mathcolor="#000000" id="alg3.l5.m1.1.1.3.3.2.3.2.3" xref="alg3.l5.m1.1.1.3.3.2.3.2.3a.cmml">npub</mtext></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><ci id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1">←</ci><apply id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.2.1.cmml" xref="alg3.l5.m1.1.1.2">subscript</csymbol><apply id="alg3.l5.m1.1.1.2.2.cmml" xref="alg3.l5.m1.1.1.2.2"><ci id="alg3.l5.m1.1.1.2.2.1.cmml" xref="alg3.l5.m1.1.1.2.2.1">~</ci><ci id="alg3.l5.m1.1.1.2.2.2.cmml" xref="alg3.l5.m1.1.1.2.2.2">𝜃</ci></apply><apply id="alg3.l5.m1.1.1.2.3.cmml" xref="alg3.l5.m1.1.1.2.3"><setdiff id="alg3.l5.m1.1.1.2.3.1.cmml" xref="alg3.l5.m1.1.1.2.3.1"></setdiff><ci id="alg3.l5.m1.1.1.2.3.2.cmml" xref="alg3.l5.m1.1.1.2.3.2">𝐺</ci><ci id="alg3.l5.m1.1.1.2.3.3a.cmml" xref="alg3.l5.m1.1.1.2.3.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l5.m1.1.1.2.3.3.cmml" xref="alg3.l5.m1.1.1.2.3.3">SP_NPUB</mtext></ci></apply></apply><apply id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3"><plus id="alg3.l5.m1.1.1.3.1.cmml" xref="alg3.l5.m1.1.1.3.1"></plus><apply id="alg3.l5.m1.1.1.3.2.cmml" xref="alg3.l5.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.3.2.1.cmml" xref="alg3.l5.m1.1.1.3.2">subscript</csymbol><ci id="alg3.l5.m1.1.1.3.2.2.cmml" xref="alg3.l5.m1.1.1.3.2.2">𝜃</ci><ci id="alg3.l5.m1.1.1.3.2.3a.cmml" xref="alg3.l5.m1.1.1.3.2.3"><mtext mathsize="70%" id="alg3.l5.m1.1.1.3.2.3.cmml" xref="alg3.l5.m1.1.1.3.2.3">global</mtext></ci></apply><apply id="alg3.l5.m1.1.1.3.3.cmml" xref="alg3.l5.m1.1.1.3.3"><apply id="alg3.l5.m1.1.1.3.3.1.cmml" xref="alg3.l5.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.3.3.1.1.cmml" xref="alg3.l5.m1.1.1.3.3.1">subscript</csymbol><sum id="alg3.l5.m1.1.1.3.3.1.2.cmml" xref="alg3.l5.m1.1.1.3.3.1.2"></sum><apply id="alg3.l5.m1.1.1.3.3.1.3.cmml" xref="alg3.l5.m1.1.1.3.3.1.3"><in id="alg3.l5.m1.1.1.3.3.1.3.1.cmml" xref="alg3.l5.m1.1.1.3.3.1.3.1"></in><ci id="alg3.l5.m1.1.1.3.3.1.3.2a.cmml" xref="alg3.l5.m1.1.1.3.3.1.3.2"><mtext mathsize="70%" id="alg3.l5.m1.1.1.3.3.1.3.2.cmml" xref="alg3.l5.m1.1.1.3.3.1.3.2">npub</mtext></ci><ci id="alg3.l5.m1.1.1.3.3.1.3.3a.cmml" xref="alg3.l5.m1.1.1.3.3.1.3.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l5.m1.1.1.3.3.1.3.3.cmml" xref="alg3.l5.m1.1.1.3.3.1.3.3">PROVIDERS</mtext></ci></apply></apply><apply id="alg3.l5.m1.1.1.3.3.2.cmml" xref="alg3.l5.m1.1.1.3.3.2"><times id="alg3.l5.m1.1.1.3.3.2.1.cmml" xref="alg3.l5.m1.1.1.3.3.2.1"></times><ci id="alg3.l5.m1.1.1.3.3.2.2.cmml" xref="alg3.l5.m1.1.1.3.3.2.2">Δ</ci><apply id="alg3.l5.m1.1.1.3.3.2.3.cmml" xref="alg3.l5.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.3.3.2.3.1.cmml" xref="alg3.l5.m1.1.1.3.3.2.3">subscript</csymbol><apply id="alg3.l5.m1.1.1.3.3.2.3.2.cmml" xref="alg3.l5.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.3.3.2.3.2.1.cmml" xref="alg3.l5.m1.1.1.3.3.2.3">superscript</csymbol><ci id="alg3.l5.m1.1.1.3.3.2.3.2.2.cmml" xref="alg3.l5.m1.1.1.3.3.2.3.2.2">𝜃</ci><ci id="alg3.l5.m1.1.1.3.3.2.3.2.3a.cmml" xref="alg3.l5.m1.1.1.3.3.2.3.2.3"><mtext mathsize="70%" id="alg3.l5.m1.1.1.3.3.2.3.2.3.cmml" xref="alg3.l5.m1.1.1.3.3.2.3.2.3">npub</mtext></ci></apply><ci id="alg3.l5.m1.1.1.3.3.2.3.3a.cmml" xref="alg3.l5.m1.1.1.3.3.2.3.3"><mtext mathsize="70%" id="alg3.l5.m1.1.1.3.3.2.3.3.cmml" xref="alg3.l5.m1.1.1.3.3.2.3.3">Inner</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">\tilde{\theta}_{G\setminus\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}\leftarrow\theta_{\text{global}}+\sum_{\text{npub}\in\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}PROVIDERS}}}\Delta\theta^{\text{npub}}_{\text{Inner}}\ </annotation></semantics></math><span id="alg3.l5.3" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg3.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg3.l6.2" class="ltx_text" style="color:#000000;">     </span><span id="alg3.l6.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg3.l6.4" class="ltx_text" style="color:#000000;"> </span><math id="alg3.l6.m1.4" class="ltx_Math" alttext="\sum_{z\in\mathcal{D}_{\text{test}}}\ell(\tilde{\theta},z)-\ell(\tilde{\theta}_{G\setminus\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}},z)&gt;\gamma_{t}" display="inline"><semantics id="alg3.l6.m1.4a"><mrow id="alg3.l6.m1.4.4" xref="alg3.l6.m1.4.4.cmml"><mrow id="alg3.l6.m1.4.4.1" xref="alg3.l6.m1.4.4.1.cmml"><mrow id="alg3.l6.m1.4.4.1.3" xref="alg3.l6.m1.4.4.1.3.cmml"><msub id="alg3.l6.m1.4.4.1.3.1" xref="alg3.l6.m1.4.4.1.3.1.cmml"><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.1.2" xref="alg3.l6.m1.4.4.1.3.1.2.cmml">∑</mo><mrow id="alg3.l6.m1.4.4.1.3.1.3" xref="alg3.l6.m1.4.4.1.3.1.3.cmml"><mi mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.1.3.2" xref="alg3.l6.m1.4.4.1.3.1.3.2.cmml">z</mi><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.1.3.1" xref="alg3.l6.m1.4.4.1.3.1.3.1.cmml">∈</mo><msub id="alg3.l6.m1.4.4.1.3.1.3.3" xref="alg3.l6.m1.4.4.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.1.3.3.2" xref="alg3.l6.m1.4.4.1.3.1.3.3.2.cmml">𝒟</mi><mtext mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.1.3.3.3" xref="alg3.l6.m1.4.4.1.3.1.3.3.3a.cmml">test</mtext></msub></mrow></msub><mrow id="alg3.l6.m1.4.4.1.3.2" xref="alg3.l6.m1.4.4.1.3.2.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg3.l6.m1.4.4.1.3.2.2" xref="alg3.l6.m1.4.4.1.3.2.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.4.4.1.3.2.1" xref="alg3.l6.m1.4.4.1.3.2.1.cmml">​</mo><mrow id="alg3.l6.m1.4.4.1.3.2.3.2" xref="alg3.l6.m1.4.4.1.3.2.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg3.l6.m1.4.4.1.3.2.3.2.1" xref="alg3.l6.m1.4.4.1.3.2.3.1.cmml">(</mo><mover accent="true" id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><mi mathcolor="#000000" id="alg3.l6.m1.1.1.2" xref="alg3.l6.m1.1.1.2.cmml">θ</mi><mo mathcolor="#000000" id="alg3.l6.m1.1.1.1" xref="alg3.l6.m1.1.1.1.cmml">~</mo></mover><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.3.2.3.2.2" xref="alg3.l6.m1.4.4.1.3.2.3.1.cmml">,</mo><mi mathcolor="#000000" id="alg3.l6.m1.2.2" xref="alg3.l6.m1.2.2.cmml">z</mi><mo mathcolor="#000000" stretchy="false" id="alg3.l6.m1.4.4.1.3.2.3.2.3" xref="alg3.l6.m1.4.4.1.3.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.2" xref="alg3.l6.m1.4.4.1.2.cmml">−</mo><mrow id="alg3.l6.m1.4.4.1.1" xref="alg3.l6.m1.4.4.1.1.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg3.l6.m1.4.4.1.1.3" xref="alg3.l6.m1.4.4.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.4.4.1.1.2" xref="alg3.l6.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg3.l6.m1.4.4.1.1.1.1" xref="alg3.l6.m1.4.4.1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="alg3.l6.m1.4.4.1.1.1.1.2" xref="alg3.l6.m1.4.4.1.1.1.2.cmml">(</mo><msub id="alg3.l6.m1.4.4.1.1.1.1.1" xref="alg3.l6.m1.4.4.1.1.1.1.1.cmml"><mover accent="true" id="alg3.l6.m1.4.4.1.1.1.1.1.2" xref="alg3.l6.m1.4.4.1.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="alg3.l6.m1.4.4.1.1.1.1.1.2.2" xref="alg3.l6.m1.4.4.1.1.1.1.1.2.2.cmml">θ</mi><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.1.1.1.1.2.1" xref="alg3.l6.m1.4.4.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="alg3.l6.m1.4.4.1.1.1.1.1.3" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="alg3.l6.m1.4.4.1.1.1.1.1.3.2" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.2.cmml">G</mi><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.1.1.1.1.3.1" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.1.cmml">∖</mo><mtext mathcolor="#000066" id="alg3.l6.m1.4.4.1.1.1.1.1.3.3" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.3a.cmml">SP_NPUB</mtext></mrow></msub><mo mathcolor="#000000" id="alg3.l6.m1.4.4.1.1.1.1.3" xref="alg3.l6.m1.4.4.1.1.1.2.cmml">,</mo><mi mathcolor="#000000" id="alg3.l6.m1.3.3" xref="alg3.l6.m1.3.3.cmml">z</mi><mo mathcolor="#000000" stretchy="false" id="alg3.l6.m1.4.4.1.1.1.1.4" xref="alg3.l6.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo mathcolor="#000000" id="alg3.l6.m1.4.4.2" xref="alg3.l6.m1.4.4.2.cmml">&gt;</mo><msub id="alg3.l6.m1.4.4.3" xref="alg3.l6.m1.4.4.3.cmml"><mi mathcolor="#000000" id="alg3.l6.m1.4.4.3.2" xref="alg3.l6.m1.4.4.3.2.cmml">γ</mi><mi mathcolor="#000000" id="alg3.l6.m1.4.4.3.3" xref="alg3.l6.m1.4.4.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.4b"><apply id="alg3.l6.m1.4.4.cmml" xref="alg3.l6.m1.4.4"><gt id="alg3.l6.m1.4.4.2.cmml" xref="alg3.l6.m1.4.4.2"></gt><apply id="alg3.l6.m1.4.4.1.cmml" xref="alg3.l6.m1.4.4.1"><minus id="alg3.l6.m1.4.4.1.2.cmml" xref="alg3.l6.m1.4.4.1.2"></minus><apply id="alg3.l6.m1.4.4.1.3.cmml" xref="alg3.l6.m1.4.4.1.3"><apply id="alg3.l6.m1.4.4.1.3.1.cmml" xref="alg3.l6.m1.4.4.1.3.1"><csymbol cd="ambiguous" id="alg3.l6.m1.4.4.1.3.1.1.cmml" xref="alg3.l6.m1.4.4.1.3.1">subscript</csymbol><sum id="alg3.l6.m1.4.4.1.3.1.2.cmml" xref="alg3.l6.m1.4.4.1.3.1.2"></sum><apply id="alg3.l6.m1.4.4.1.3.1.3.cmml" xref="alg3.l6.m1.4.4.1.3.1.3"><in id="alg3.l6.m1.4.4.1.3.1.3.1.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.1"></in><ci id="alg3.l6.m1.4.4.1.3.1.3.2.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.2">𝑧</ci><apply id="alg3.l6.m1.4.4.1.3.1.3.3.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.3"><csymbol cd="ambiguous" id="alg3.l6.m1.4.4.1.3.1.3.3.1.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.3">subscript</csymbol><ci id="alg3.l6.m1.4.4.1.3.1.3.3.2.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.3.2">𝒟</ci><ci id="alg3.l6.m1.4.4.1.3.1.3.3.3a.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.3.3"><mtext mathsize="50%" id="alg3.l6.m1.4.4.1.3.1.3.3.3.cmml" xref="alg3.l6.m1.4.4.1.3.1.3.3.3">test</mtext></ci></apply></apply></apply><apply id="alg3.l6.m1.4.4.1.3.2.cmml" xref="alg3.l6.m1.4.4.1.3.2"><times id="alg3.l6.m1.4.4.1.3.2.1.cmml" xref="alg3.l6.m1.4.4.1.3.2.1"></times><ci id="alg3.l6.m1.4.4.1.3.2.2.cmml" xref="alg3.l6.m1.4.4.1.3.2.2">ℓ</ci><interval closure="open" id="alg3.l6.m1.4.4.1.3.2.3.1.cmml" xref="alg3.l6.m1.4.4.1.3.2.3.2"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><ci id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1">~</ci><ci id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1.2">𝜃</ci></apply><ci id="alg3.l6.m1.2.2.cmml" xref="alg3.l6.m1.2.2">𝑧</ci></interval></apply></apply><apply id="alg3.l6.m1.4.4.1.1.cmml" xref="alg3.l6.m1.4.4.1.1"><times id="alg3.l6.m1.4.4.1.1.2.cmml" xref="alg3.l6.m1.4.4.1.1.2"></times><ci id="alg3.l6.m1.4.4.1.1.3.cmml" xref="alg3.l6.m1.4.4.1.1.3">ℓ</ci><interval closure="open" id="alg3.l6.m1.4.4.1.1.1.2.cmml" xref="alg3.l6.m1.4.4.1.1.1.1"><apply id="alg3.l6.m1.4.4.1.1.1.1.1.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.4.4.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1">subscript</csymbol><apply id="alg3.l6.m1.4.4.1.1.1.1.1.2.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.2"><ci id="alg3.l6.m1.4.4.1.1.1.1.1.2.1.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.2.1">~</ci><ci id="alg3.l6.m1.4.4.1.1.1.1.1.2.2.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.2.2">𝜃</ci></apply><apply id="alg3.l6.m1.4.4.1.1.1.1.1.3.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.3"><setdiff id="alg3.l6.m1.4.4.1.1.1.1.1.3.1.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.1"></setdiff><ci id="alg3.l6.m1.4.4.1.1.1.1.1.3.2.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.2">𝐺</ci><ci id="alg3.l6.m1.4.4.1.1.1.1.1.3.3a.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l6.m1.4.4.1.1.1.1.1.3.3.cmml" xref="alg3.l6.m1.4.4.1.1.1.1.1.3.3">SP_NPUB</mtext></ci></apply></apply><ci id="alg3.l6.m1.3.3.cmml" xref="alg3.l6.m1.3.3">𝑧</ci></interval></apply></apply><apply id="alg3.l6.m1.4.4.3.cmml" xref="alg3.l6.m1.4.4.3"><csymbol cd="ambiguous" id="alg3.l6.m1.4.4.3.1.cmml" xref="alg3.l6.m1.4.4.3">subscript</csymbol><ci id="alg3.l6.m1.4.4.3.2.cmml" xref="alg3.l6.m1.4.4.3.2">𝛾</ci><ci id="alg3.l6.m1.4.4.3.3.cmml" xref="alg3.l6.m1.4.4.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.4c">\sum_{z\in\mathcal{D}_{\text{test}}}\ell(\tilde{\theta},z)-\ell(\tilde{\theta}_{G\setminus\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}},z)&gt;\gamma_{t}</annotation></semantics></math><span id="alg3.l6.5" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l6.6" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg3.l6.7" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg3.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg3.l7.2" class="ltx_text" style="color:#000000;">         </span><span id="alg3.l7.3" class="ltx_text" style="color:#000066;">SP_NPUB</span><span id="alg3.l7.4" class="ltx_text" style="color:#000000;"> is malicious
</span>
</span>
<span id="alg3.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg3.l8.2" class="ltx_text" style="color:#000000;">         </span><span id="alg3.l8.3" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg3.l8.4" class="ltx_text" style="color:#000000;"> FAIL
     </span>
</span>
<span id="alg3.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l9.2.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg3.l9.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg3.l9.4" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l9.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg3.l9.6" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l9.7" class="ltx_text" style="color:#000066;">TEST_TYPE</span><span id="alg3.l9.8" class="ltx_text" style="color:#000000;"> = "B" </span><span id="alg3.l9.9" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg3.l9.10" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l9.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg3.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l9.1.m1.1a"><mo mathcolor="#000000" id="alg3.l9.1.m1.1.1" xref="alg3.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l9.1.m1.1b"><ci id="alg3.l9.1.m1.1.1.cmml" xref="alg3.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg3.l9.1.1" class="ltx_text" style="color:#BF8040;"> Check progress over time (with time lag) </span>

</span>
</span>
<span id="alg3.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l10.4.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg3.l10.5" class="ltx_text" style="color:#000000;">     </span><math id="alg3.l10.m1.1" class="ltx_Math" alttext="\theta^{\tau}\leftarrow\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{Inner at time $\tau$}}" display="inline"><semantics id="alg3.l10.m1.1a"><mrow id="alg3.l10.m1.1.2" xref="alg3.l10.m1.1.2.cmml"><msup id="alg3.l10.m1.1.2.2" xref="alg3.l10.m1.1.2.2.cmml"><mi mathcolor="#000000" id="alg3.l10.m1.1.2.2.2" xref="alg3.l10.m1.1.2.2.2.cmml">θ</mi><mi mathcolor="#000000" id="alg3.l10.m1.1.2.2.3" xref="alg3.l10.m1.1.2.2.3.cmml">τ</mi></msup><mo mathcolor="#000000" stretchy="false" id="alg3.l10.m1.1.2.1" xref="alg3.l10.m1.1.2.1.cmml">←</mo><msubsup id="alg3.l10.m1.1.2.3" xref="alg3.l10.m1.1.2.3.cmml"><mi mathcolor="#000000" id="alg3.l10.m1.1.2.3.2.2" xref="alg3.l10.m1.1.2.3.2.2.cmml">θ</mi><mrow id="alg3.l10.m1.1.1.1" xref="alg3.l10.m1.1.1.1b.cmml"><mtext mathcolor="#000000" id="alg3.l10.m1.1.1.1a" xref="alg3.l10.m1.1.1.1b.cmml">Inner at time </mtext><mi mathcolor="#000000" id="alg3.l10.m1.1.1.1.1.1.m1.1.1" xref="alg3.l10.m1.1.1.1.1.1.m1.1.1.cmml">τ</mi></mrow><mtext mathcolor="#000066" id="alg3.l10.m1.1.2.3.2.3" xref="alg3.l10.m1.1.2.3.2.3a.cmml">SP_NPUB</mtext></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.1b"><apply id="alg3.l10.m1.1.2.cmml" xref="alg3.l10.m1.1.2"><ci id="alg3.l10.m1.1.2.1.cmml" xref="alg3.l10.m1.1.2.1">←</ci><apply id="alg3.l10.m1.1.2.2.cmml" xref="alg3.l10.m1.1.2.2"><csymbol cd="ambiguous" id="alg3.l10.m1.1.2.2.1.cmml" xref="alg3.l10.m1.1.2.2">superscript</csymbol><ci id="alg3.l10.m1.1.2.2.2.cmml" xref="alg3.l10.m1.1.2.2.2">𝜃</ci><ci id="alg3.l10.m1.1.2.2.3.cmml" xref="alg3.l10.m1.1.2.2.3">𝜏</ci></apply><apply id="alg3.l10.m1.1.2.3.cmml" xref="alg3.l10.m1.1.2.3"><csymbol cd="ambiguous" id="alg3.l10.m1.1.2.3.1.cmml" xref="alg3.l10.m1.1.2.3">subscript</csymbol><apply id="alg3.l10.m1.1.2.3.2.cmml" xref="alg3.l10.m1.1.2.3"><csymbol cd="ambiguous" id="alg3.l10.m1.1.2.3.2.1.cmml" xref="alg3.l10.m1.1.2.3">superscript</csymbol><ci id="alg3.l10.m1.1.2.3.2.2.cmml" xref="alg3.l10.m1.1.2.3.2.2">𝜃</ci><ci id="alg3.l10.m1.1.2.3.2.3a.cmml" xref="alg3.l10.m1.1.2.3.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l10.m1.1.2.3.2.3.cmml" xref="alg3.l10.m1.1.2.3.2.3">SP_NPUB</mtext></ci></apply><ci id="alg3.l10.m1.1.1.1b.cmml" xref="alg3.l10.m1.1.1.1"><mrow id="alg3.l10.m1.1.1.1.cmml" xref="alg3.l10.m1.1.1.1"><mtext mathsize="70%" id="alg3.l10.m1.1.1.1a.cmml" xref="alg3.l10.m1.1.1.1">Inner at time </mtext><mi mathsize="70%" id="alg3.l10.m1.1.1.1.1.1.m1.1.1.cmml" xref="alg3.l10.m1.1.1.1.1.1.m1.1.1">τ</mi></mrow></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.1c">\theta^{\tau}\leftarrow\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{Inner at time $\tau$}}</annotation></semantics></math><span id="alg3.l10.6" class="ltx_text" style="color:#000000;">, for all </span><math id="alg3.l10.m2.2" class="ltx_Math" alttext="\tau\in[t-\tau_{c},t]" display="inline"><semantics id="alg3.l10.m2.2a"><mrow id="alg3.l10.m2.2.2" xref="alg3.l10.m2.2.2.cmml"><mi mathcolor="#000000" id="alg3.l10.m2.2.2.3" xref="alg3.l10.m2.2.2.3.cmml">τ</mi><mo mathcolor="#000000" id="alg3.l10.m2.2.2.2" xref="alg3.l10.m2.2.2.2.cmml">∈</mo><mrow id="alg3.l10.m2.2.2.1.1" xref="alg3.l10.m2.2.2.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="alg3.l10.m2.2.2.1.1.2" xref="alg3.l10.m2.2.2.1.2.cmml">[</mo><mrow id="alg3.l10.m2.2.2.1.1.1" xref="alg3.l10.m2.2.2.1.1.1.cmml"><mi mathcolor="#000000" id="alg3.l10.m2.2.2.1.1.1.2" xref="alg3.l10.m2.2.2.1.1.1.2.cmml">t</mi><mo mathcolor="#000000" id="alg3.l10.m2.2.2.1.1.1.1" xref="alg3.l10.m2.2.2.1.1.1.1.cmml">−</mo><msub id="alg3.l10.m2.2.2.1.1.1.3" xref="alg3.l10.m2.2.2.1.1.1.3.cmml"><mi mathcolor="#000000" id="alg3.l10.m2.2.2.1.1.1.3.2" xref="alg3.l10.m2.2.2.1.1.1.3.2.cmml">τ</mi><mi mathcolor="#000000" id="alg3.l10.m2.2.2.1.1.1.3.3" xref="alg3.l10.m2.2.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo mathcolor="#000000" id="alg3.l10.m2.2.2.1.1.3" xref="alg3.l10.m2.2.2.1.2.cmml">,</mo><mi mathcolor="#000000" id="alg3.l10.m2.1.1" xref="alg3.l10.m2.1.1.cmml">t</mi><mo mathcolor="#000000" stretchy="false" id="alg3.l10.m2.2.2.1.1.4" xref="alg3.l10.m2.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m2.2b"><apply id="alg3.l10.m2.2.2.cmml" xref="alg3.l10.m2.2.2"><in id="alg3.l10.m2.2.2.2.cmml" xref="alg3.l10.m2.2.2.2"></in><ci id="alg3.l10.m2.2.2.3.cmml" xref="alg3.l10.m2.2.2.3">𝜏</ci><interval closure="closed" id="alg3.l10.m2.2.2.1.2.cmml" xref="alg3.l10.m2.2.2.1.1"><apply id="alg3.l10.m2.2.2.1.1.1.cmml" xref="alg3.l10.m2.2.2.1.1.1"><minus id="alg3.l10.m2.2.2.1.1.1.1.cmml" xref="alg3.l10.m2.2.2.1.1.1.1"></minus><ci id="alg3.l10.m2.2.2.1.1.1.2.cmml" xref="alg3.l10.m2.2.2.1.1.1.2">𝑡</ci><apply id="alg3.l10.m2.2.2.1.1.1.3.cmml" xref="alg3.l10.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l10.m2.2.2.1.1.1.3.1.cmml" xref="alg3.l10.m2.2.2.1.1.1.3">subscript</csymbol><ci id="alg3.l10.m2.2.2.1.1.1.3.2.cmml" xref="alg3.l10.m2.2.2.1.1.1.3.2">𝜏</ci><ci id="alg3.l10.m2.2.2.1.1.1.3.3.cmml" xref="alg3.l10.m2.2.2.1.1.1.3.3">𝑐</ci></apply></apply><ci id="alg3.l10.m2.1.1.cmml" xref="alg3.l10.m2.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m2.2c">\tau\in[t-\tau_{c},t]</annotation></semantics></math><span id="alg3.l10.7" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l10.3" class="ltx_text" style="color:#000000;float:right;"><math id="alg3.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l10.1.m1.1a"><mo mathcolor="#000000" id="alg3.l10.1.m1.1.1" xref="alg3.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l10.1.m1.1b"><ci id="alg3.l10.1.m1.1.1.cmml" xref="alg3.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg3.l10.3.2" class="ltx_text" style="color:#BF8040;"> For Outer: replace <math id="alg3.l10.2.1.m1.1" class="ltx_Math" alttext="\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{Inner at time $\tau$}}" display="inline"><semantics id="alg3.l10.2.1.m1.1a"><msubsup id="alg3.l10.2.1.m1.1.2" xref="alg3.l10.2.1.m1.1.2.cmml"><mi mathcolor="#BF8040" id="alg3.l10.2.1.m1.1.2.2.2" xref="alg3.l10.2.1.m1.1.2.2.2.cmml">θ</mi><mrow id="alg3.l10.2.1.m1.1.1.1" xref="alg3.l10.2.1.m1.1.1.1b.cmml"><mtext mathcolor="#BF8040" id="alg3.l10.2.1.m1.1.1.1a" xref="alg3.l10.2.1.m1.1.1.1b.cmml">Inner at time </mtext><mi mathcolor="#BF8040" id="alg3.l10.2.1.m1.1.1.1.1.1.m1.1.1" xref="alg3.l10.2.1.m1.1.1.1.1.1.m1.1.1.cmml">τ</mi></mrow><mtext mathcolor="#000066" id="alg3.l10.2.1.m1.1.2.2.3" xref="alg3.l10.2.1.m1.1.2.2.3a.cmml">SP_NPUB</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l10.2.1.m1.1b"><apply id="alg3.l10.2.1.m1.1.2.cmml" xref="alg3.l10.2.1.m1.1.2"><csymbol cd="ambiguous" id="alg3.l10.2.1.m1.1.2.1.cmml" xref="alg3.l10.2.1.m1.1.2">subscript</csymbol><apply id="alg3.l10.2.1.m1.1.2.2.cmml" xref="alg3.l10.2.1.m1.1.2"><csymbol cd="ambiguous" id="alg3.l10.2.1.m1.1.2.2.1.cmml" xref="alg3.l10.2.1.m1.1.2">superscript</csymbol><ci id="alg3.l10.2.1.m1.1.2.2.2.cmml" xref="alg3.l10.2.1.m1.1.2.2.2">𝜃</ci><ci id="alg3.l10.2.1.m1.1.2.2.3a.cmml" xref="alg3.l10.2.1.m1.1.2.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l10.2.1.m1.1.2.2.3.cmml" xref="alg3.l10.2.1.m1.1.2.2.3">SP_NPUB</mtext></ci></apply><ci id="alg3.l10.2.1.m1.1.1.1b.cmml" xref="alg3.l10.2.1.m1.1.1.1"><mrow id="alg3.l10.2.1.m1.1.1.1.cmml" xref="alg3.l10.2.1.m1.1.1.1"><mtext mathcolor="#BF8040" mathsize="70%" id="alg3.l10.2.1.m1.1.1.1a.cmml" xref="alg3.l10.2.1.m1.1.1.1">Inner at time </mtext><mi mathcolor="#BF8040" mathsize="70%" id="alg3.l10.2.1.m1.1.1.1.1.1.m1.1.1.cmml" xref="alg3.l10.2.1.m1.1.1.1.1.1.m1.1.1">τ</mi></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.2.1.m1.1c">\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{Inner at time $\tau$}}</annotation></semantics></math> with <math id="alg3.l10.3.2.m2.1" class="ltx_Math" alttext="\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{global at time $\tau$}}" display="inline"><semantics id="alg3.l10.3.2.m2.1a"><msubsup id="alg3.l10.3.2.m2.1.2" xref="alg3.l10.3.2.m2.1.2.cmml"><mi mathcolor="#BF8040" id="alg3.l10.3.2.m2.1.2.2.2" xref="alg3.l10.3.2.m2.1.2.2.2.cmml">θ</mi><mrow id="alg3.l10.3.2.m2.1.1.1" xref="alg3.l10.3.2.m2.1.1.1b.cmml"><mtext mathcolor="#BF8040" id="alg3.l10.3.2.m2.1.1.1a" xref="alg3.l10.3.2.m2.1.1.1b.cmml">global at time </mtext><mi mathcolor="#BF8040" id="alg3.l10.3.2.m2.1.1.1.1.1.m1.1.1" xref="alg3.l10.3.2.m2.1.1.1.1.1.m1.1.1.cmml">τ</mi></mrow><mtext mathcolor="#000066" id="alg3.l10.3.2.m2.1.2.2.3" xref="alg3.l10.3.2.m2.1.2.2.3a.cmml">SP_NPUB</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l10.3.2.m2.1b"><apply id="alg3.l10.3.2.m2.1.2.cmml" xref="alg3.l10.3.2.m2.1.2"><csymbol cd="ambiguous" id="alg3.l10.3.2.m2.1.2.1.cmml" xref="alg3.l10.3.2.m2.1.2">subscript</csymbol><apply id="alg3.l10.3.2.m2.1.2.2.cmml" xref="alg3.l10.3.2.m2.1.2"><csymbol cd="ambiguous" id="alg3.l10.3.2.m2.1.2.2.1.cmml" xref="alg3.l10.3.2.m2.1.2">superscript</csymbol><ci id="alg3.l10.3.2.m2.1.2.2.2.cmml" xref="alg3.l10.3.2.m2.1.2.2.2">𝜃</ci><ci id="alg3.l10.3.2.m2.1.2.2.3a.cmml" xref="alg3.l10.3.2.m2.1.2.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg3.l10.3.2.m2.1.2.2.3.cmml" xref="alg3.l10.3.2.m2.1.2.2.3">SP_NPUB</mtext></ci></apply><ci id="alg3.l10.3.2.m2.1.1.1b.cmml" xref="alg3.l10.3.2.m2.1.1.1"><mrow id="alg3.l10.3.2.m2.1.1.1.cmml" xref="alg3.l10.3.2.m2.1.1.1"><mtext mathcolor="#BF8040" mathsize="70%" id="alg3.l10.3.2.m2.1.1.1a.cmml" xref="alg3.l10.3.2.m2.1.1.1">global at time </mtext><mi mathcolor="#BF8040" mathsize="70%" id="alg3.l10.3.2.m2.1.1.1.1.1.m1.1.1.cmml" xref="alg3.l10.3.2.m2.1.1.1.1.1.m1.1.1">τ</mi></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.3.2.m2.1c">\theta^{\text{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}SP\_NPUB}}}_{\text{global at time $\tau$}}</annotation></semantics></math> </span>

</span>
</span>
<span id="alg3.l11" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l11.2.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg3.l11.3" class="ltx_text" style="color:#000000;">     </span><span id="alg3.l11.4" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg3.l11.5" class="ltx_text" style="color:#000000;"> </span><math id="alg3.l11.m1.2" class="ltx_Math" alttext="\frac{1}{\tau_{c}+1}\sum^{t}_{\tau=t-\tau_{c}}\sum_{z\in\mathcal{D}_{\text{test}}}\ell(\theta^{\tau},z)&gt;\beta_{t}" display="inline"><semantics id="alg3.l11.m1.2a"><mrow id="alg3.l11.m1.2.2" xref="alg3.l11.m1.2.2.cmml"><mrow id="alg3.l11.m1.2.2.1" xref="alg3.l11.m1.2.2.1.cmml"><mfrac mathcolor="#000000" id="alg3.l11.m1.2.2.1.3" xref="alg3.l11.m1.2.2.1.3.cmml"><mn mathcolor="#000000" id="alg3.l11.m1.2.2.1.3.2" xref="alg3.l11.m1.2.2.1.3.2.cmml">1</mn><mrow id="alg3.l11.m1.2.2.1.3.3" xref="alg3.l11.m1.2.2.1.3.3.cmml"><msub id="alg3.l11.m1.2.2.1.3.3.2" xref="alg3.l11.m1.2.2.1.3.3.2.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.3.3.2.2" xref="alg3.l11.m1.2.2.1.3.3.2.2.cmml">τ</mi><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.3.3.2.3" xref="alg3.l11.m1.2.2.1.3.3.2.3.cmml">c</mi></msub><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.3.3.1" xref="alg3.l11.m1.2.2.1.3.3.1.cmml">+</mo><mn mathcolor="#000000" id="alg3.l11.m1.2.2.1.3.3.3" xref="alg3.l11.m1.2.2.1.3.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg3.l11.m1.2.2.1.2" xref="alg3.l11.m1.2.2.1.2.cmml">​</mo><mrow id="alg3.l11.m1.2.2.1.1" xref="alg3.l11.m1.2.2.1.1.cmml"><msubsup id="alg3.l11.m1.2.2.1.1.2" xref="alg3.l11.m1.2.2.1.1.2.cmml"><mo mathcolor="#000000" rspace="0em" id="alg3.l11.m1.2.2.1.1.2.2.2" xref="alg3.l11.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="alg3.l11.m1.2.2.1.1.2.3" xref="alg3.l11.m1.2.2.1.1.2.3.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.2" xref="alg3.l11.m1.2.2.1.1.2.3.2.cmml">τ</mi><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.1" xref="alg3.l11.m1.2.2.1.1.2.3.1.cmml">=</mo><mrow id="alg3.l11.m1.2.2.1.1.2.3.3" xref="alg3.l11.m1.2.2.1.1.2.3.3.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.3.2" xref="alg3.l11.m1.2.2.1.1.2.3.3.2.cmml">t</mi><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.3.1" xref="alg3.l11.m1.2.2.1.1.2.3.3.1.cmml">−</mo><msub id="alg3.l11.m1.2.2.1.1.2.3.3.3" xref="alg3.l11.m1.2.2.1.1.2.3.3.3.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.3.3.2" xref="alg3.l11.m1.2.2.1.1.2.3.3.3.2.cmml">τ</mi><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.3.3.3.3" xref="alg3.l11.m1.2.2.1.1.2.3.3.3.3.cmml">c</mi></msub></mrow></mrow><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.2.2.3" xref="alg3.l11.m1.2.2.1.1.2.2.3.cmml">t</mi></msubsup><mrow id="alg3.l11.m1.2.2.1.1.1" xref="alg3.l11.m1.2.2.1.1.1.cmml"><msub id="alg3.l11.m1.2.2.1.1.1.2" xref="alg3.l11.m1.2.2.1.1.1.2.cmml"><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.2.2" xref="alg3.l11.m1.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="alg3.l11.m1.2.2.1.1.1.2.3" xref="alg3.l11.m1.2.2.1.1.1.2.3.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.2.3.2" xref="alg3.l11.m1.2.2.1.1.1.2.3.2.cmml">z</mi><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.2.3.1" xref="alg3.l11.m1.2.2.1.1.1.2.3.1.cmml">∈</mo><msub id="alg3.l11.m1.2.2.1.1.1.2.3.3" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.2.3.3.2" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.2.cmml">𝒟</mi><mtext mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.2.3.3.3" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.3a.cmml">test</mtext></msub></mrow></msub><mrow id="alg3.l11.m1.2.2.1.1.1.1" xref="alg3.l11.m1.2.2.1.1.1.1.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg3.l11.m1.2.2.1.1.1.1.3" xref="alg3.l11.m1.2.2.1.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg3.l11.m1.2.2.1.1.1.1.2" xref="alg3.l11.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg3.l11.m1.2.2.1.1.1.1.1.1" xref="alg3.l11.m1.2.2.1.1.1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="alg3.l11.m1.2.2.1.1.1.1.1.1.2" xref="alg3.l11.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msup id="alg3.l11.m1.2.2.1.1.1.1.1.1.1" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.2" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.3" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1.3.cmml">τ</mi></msup><mo mathcolor="#000000" id="alg3.l11.m1.2.2.1.1.1.1.1.1.3" xref="alg3.l11.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi mathcolor="#000000" id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml">z</mi><mo mathcolor="#000000" stretchy="false" id="alg3.l11.m1.2.2.1.1.1.1.1.1.4" xref="alg3.l11.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo mathcolor="#000000" id="alg3.l11.m1.2.2.2" xref="alg3.l11.m1.2.2.2.cmml">&gt;</mo><msub id="alg3.l11.m1.2.2.3" xref="alg3.l11.m1.2.2.3.cmml"><mi mathcolor="#000000" id="alg3.l11.m1.2.2.3.2" xref="alg3.l11.m1.2.2.3.2.cmml">β</mi><mi mathcolor="#000000" id="alg3.l11.m1.2.2.3.3" xref="alg3.l11.m1.2.2.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.2b"><apply id="alg3.l11.m1.2.2.cmml" xref="alg3.l11.m1.2.2"><gt id="alg3.l11.m1.2.2.2.cmml" xref="alg3.l11.m1.2.2.2"></gt><apply id="alg3.l11.m1.2.2.1.cmml" xref="alg3.l11.m1.2.2.1"><times id="alg3.l11.m1.2.2.1.2.cmml" xref="alg3.l11.m1.2.2.1.2"></times><apply id="alg3.l11.m1.2.2.1.3.cmml" xref="alg3.l11.m1.2.2.1.3"><divide id="alg3.l11.m1.2.2.1.3.1.cmml" xref="alg3.l11.m1.2.2.1.3"></divide><cn type="integer" id="alg3.l11.m1.2.2.1.3.2.cmml" xref="alg3.l11.m1.2.2.1.3.2">1</cn><apply id="alg3.l11.m1.2.2.1.3.3.cmml" xref="alg3.l11.m1.2.2.1.3.3"><plus id="alg3.l11.m1.2.2.1.3.3.1.cmml" xref="alg3.l11.m1.2.2.1.3.3.1"></plus><apply id="alg3.l11.m1.2.2.1.3.3.2.cmml" xref="alg3.l11.m1.2.2.1.3.3.2"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.3.3.2.1.cmml" xref="alg3.l11.m1.2.2.1.3.3.2">subscript</csymbol><ci id="alg3.l11.m1.2.2.1.3.3.2.2.cmml" xref="alg3.l11.m1.2.2.1.3.3.2.2">𝜏</ci><ci id="alg3.l11.m1.2.2.1.3.3.2.3.cmml" xref="alg3.l11.m1.2.2.1.3.3.2.3">𝑐</ci></apply><cn type="integer" id="alg3.l11.m1.2.2.1.3.3.3.cmml" xref="alg3.l11.m1.2.2.1.3.3.3">1</cn></apply></apply><apply id="alg3.l11.m1.2.2.1.1.cmml" xref="alg3.l11.m1.2.2.1.1"><apply id="alg3.l11.m1.2.2.1.1.2.cmml" xref="alg3.l11.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.2.1.cmml" xref="alg3.l11.m1.2.2.1.1.2">subscript</csymbol><apply id="alg3.l11.m1.2.2.1.1.2.2.cmml" xref="alg3.l11.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.2.2.1.cmml" xref="alg3.l11.m1.2.2.1.1.2">superscript</csymbol><sum id="alg3.l11.m1.2.2.1.1.2.2.2.cmml" xref="alg3.l11.m1.2.2.1.1.2.2.2"></sum><ci id="alg3.l11.m1.2.2.1.1.2.2.3.cmml" xref="alg3.l11.m1.2.2.1.1.2.2.3">𝑡</ci></apply><apply id="alg3.l11.m1.2.2.1.1.2.3.cmml" xref="alg3.l11.m1.2.2.1.1.2.3"><eq id="alg3.l11.m1.2.2.1.1.2.3.1.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.1"></eq><ci id="alg3.l11.m1.2.2.1.1.2.3.2.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.2">𝜏</ci><apply id="alg3.l11.m1.2.2.1.1.2.3.3.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3"><minus id="alg3.l11.m1.2.2.1.1.2.3.3.1.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.1"></minus><ci id="alg3.l11.m1.2.2.1.1.2.3.3.2.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.2">𝑡</ci><apply id="alg3.l11.m1.2.2.1.1.2.3.3.3.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.3"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.2.3.3.3.1.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.3">subscript</csymbol><ci id="alg3.l11.m1.2.2.1.1.2.3.3.3.2.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.3.2">𝜏</ci><ci id="alg3.l11.m1.2.2.1.1.2.3.3.3.3.cmml" xref="alg3.l11.m1.2.2.1.1.2.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="alg3.l11.m1.2.2.1.1.1.cmml" xref="alg3.l11.m1.2.2.1.1.1"><apply id="alg3.l11.m1.2.2.1.1.1.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.1.2.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.2">subscript</csymbol><sum id="alg3.l11.m1.2.2.1.1.1.2.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.2"></sum><apply id="alg3.l11.m1.2.2.1.1.1.2.3.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3"><in id="alg3.l11.m1.2.2.1.1.1.2.3.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.1"></in><ci id="alg3.l11.m1.2.2.1.1.1.2.3.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.2">𝑧</ci><apply id="alg3.l11.m1.2.2.1.1.1.2.3.3.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.1.2.3.3.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.3">subscript</csymbol><ci id="alg3.l11.m1.2.2.1.1.1.2.3.3.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.2">𝒟</ci><ci id="alg3.l11.m1.2.2.1.1.1.2.3.3.3a.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.3"><mtext mathsize="50%" id="alg3.l11.m1.2.2.1.1.1.2.3.3.3.cmml" xref="alg3.l11.m1.2.2.1.1.1.2.3.3.3">test</mtext></ci></apply></apply></apply><apply id="alg3.l11.m1.2.2.1.1.1.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.1"><times id="alg3.l11.m1.2.2.1.1.1.1.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.2"></times><ci id="alg3.l11.m1.2.2.1.1.1.1.3.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.3">ℓ</ci><interval closure="open" id="alg3.l11.m1.2.2.1.1.1.1.1.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.1.1"><apply id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg3.l11.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg3.l11.m1.2.2.1.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1">𝑧</ci></interval></apply></apply></apply></apply><apply id="alg3.l11.m1.2.2.3.cmml" xref="alg3.l11.m1.2.2.3"><csymbol cd="ambiguous" id="alg3.l11.m1.2.2.3.1.cmml" xref="alg3.l11.m1.2.2.3">subscript</csymbol><ci id="alg3.l11.m1.2.2.3.2.cmml" xref="alg3.l11.m1.2.2.3.2">𝛽</ci><ci id="alg3.l11.m1.2.2.3.3.cmml" xref="alg3.l11.m1.2.2.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.2c">\frac{1}{\tau_{c}+1}\sum^{t}_{\tau=t-\tau_{c}}\sum_{z\in\mathcal{D}_{\text{test}}}\ell(\theta^{\tau},z)&gt;\beta_{t}</annotation></semantics></math><span id="alg3.l11.6" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l11.7" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg3.l11.8" class="ltx_text" style="color:#000000;"> </span><span id="alg3.l11.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg3.l11.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.l11.1.m1.1a"><mo mathcolor="#000000" id="alg3.l11.1.m1.1.1" xref="alg3.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.l11.1.m1.1b"><ci id="alg3.l11.1.m1.1.1.cmml" xref="alg3.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg3.l11.1.1" class="ltx_text" style="color:#BF8040;"> Check if a moving average of the loss decays </span>

</span>
</span>
<span id="alg3.l12" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg3.l12.2" class="ltx_text" style="color:#000000;">         </span><span id="alg3.l12.3" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg3.l12.4" class="ltx_text" style="color:#000000;"> FAIL
     </span>
</span>
<span id="alg3.l13" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg3.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg3.l13.2" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg3.l13.3" class="ltx_text" style="color:#000000;"> PASS
</span>
</span>
</span>
</span>
</section>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Service provider</h3>

<span id="S7.SS2.p1" class="ltx_para">
<span id="S7.SS2.p1.1" class="ltx_p">Algorithm <a href="#alg4" title="Algorithm 4 ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> is an implementation of the routine for the service providers. For announcement and advertisement of their service, the providers publish a discoverability event of kind 31990 (Event Type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Initially, the service providers wait until they receive a job request. Then they signal initiation through a job feedback event. Upon receiving any required payments they proceed with the optimization routine, as the customer has requested. The optimization procedure may be one of the run options (FEDAVG or DiLoCo) and the task for either run option may be Inner or Outer optimization. Depending on the run option the service providers calls the corresponding algorithmic routine (Algorithm <a href="#alg5" title="Algorithm 5 ‣ Inner Optimization (Algorithm 5) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> or Algorithm <a href="#alg6" title="Algorithm 6 ‣ Outer Optimization (Algorithm 6) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>). Periodically the service provider announces the status of the job through a Job Feedback event and provides a progress of the computation, for instance see Algorithm <a href="#alg5" title="Algorithm 5 ‣ Inner Optimization (Algorithm 5) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. After the completion of the optimization routine the service providers respond with a job result event, and they expect any pending payment to be settled. If the customer does not complete payment(s) after a reasonable time period despite the delivery of accurate outputs, then the service providers may stop receiving job request from the specific customer immediately.</span>
</span>
<span id="alg4" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg4.2.1.1" class="ltx_text ltx_font_bold">Algorithm 4</span> </span> Service provider</span>
<span id="alg4.3" class="ltx_listing ltx_listing">
<span id="alg4.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg4.l1.2" class="ltx_text" style="color:#000066;">SP_NPUB</span>: service provider public key, &lt;computation information &amp; time&gt;, &lt;lightning address&gt;
</span>
<span id="alg4.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Connection through websockets to all <span id="alg4.l2.3" class="ltx_text ltx_font_italic" style="color:#00260D;">relays</span> in <span id="alg4.l2.4" class="ltx_text" style="color:#000066;">RELAYS</span> <span id="alg4.l2.1" class="ltx_text" style="float:right;"><math id="alg4.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l2.1.m1.1a"><mo id="alg4.l2.1.m1.1.1" xref="alg4.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l2.1.m1.1b"><ci id="alg4.l2.1.m1.1.1.cmml" xref="alg4.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l2.1.1" class="ltx_text" style="color:#BF8040;"> Where events are published at<span id="alg4.l2.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg4.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l3.3.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg4.l3.4" class="ltx_text" style="color:#000000;">Publish an event </span><span id="alg4.l3.1" class="ltx_text" style="color:#78453B;">(NIP-89) of kind <math id="alg4.l3.1.m1.1" class="ltx_Math" alttext="31990" display="inline"><semantics id="alg4.l3.1.m1.1a"><mn mathcolor="#78453B" id="alg4.l3.1.m1.1.1" xref="alg4.l3.1.m1.1.1.cmml">31990</mn><annotation-xml encoding="MathML-Content" id="alg4.l3.1.m1.1b"><cn type="integer" id="alg4.l3.1.m1.1.1.cmml" xref="alg4.l3.1.m1.1.1">31990</cn></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.1.m1.1c">31990</annotation></semantics></math></span><span id="alg4.l3.5" class="ltx_text" style="color:#000000;"> for discoverability </span><span id="alg4.l3.2" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l3.2.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l3.2.m1.1a"><mo mathcolor="#000000" id="alg4.l3.2.m1.1.1" xref="alg4.l3.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l3.2.m1.1b"><ci id="alg4.l3.2.m1.1.1.cmml" xref="alg4.l3.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.2.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l3.2.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST5" title="Event Type 5 ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a></span>
</span>
</span>
<span id="alg4.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg4.l4.2" class="ltx_text ltx_font_bold" style="color:#000000;">while</span><span id="alg4.l4.3" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l4.4" class="ltx_text" style="color:#000066;">TRUE</span><span id="alg4.l4.5" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l4.6" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg4.l4.7" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg4.l5.2" class="ltx_text" style="color:#000000;">     </span><span id="alg4.l5.3" class="ltx_text ltx_font_bold" style="color:#000000;">Routine:</span><span id="alg4.l5.4" class="ltx_text" style="color:#000000;"> Search for </span><span id="alg4.l5.5" class="ltx_text" style="color:#78453B;">JOB REQUEST</span><span id="alg4.l5.6" class="ltx_text" style="color:#000000;"> for provider </span><span id="alg4.l5.7" class="ltx_text" style="color:#000066;">SP_NPUB</span><span id="alg4.l5.8" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l6.2.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg4.l6.3" class="ltx_text" style="color:#000000;">     </span><span id="alg4.l6.4" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l6.5" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l6.6" class="ltx_text" style="color:#78453B;">JOB REQUEST</span><span id="alg4.l6.7" class="ltx_text" style="color:#000000;"> with appropriate KIND was found </span><span id="alg4.l6.8" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l6.9" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l6.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l6.1.m1.1a"><mo mathcolor="#000000" id="alg4.l6.1.m1.1.1" xref="alg4.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l6.1.m1.1b"><ci id="alg4.l6.1.m1.1.1.cmml" xref="alg4.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l6.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST2" title="Event Type 2 ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></span>
</span>
</span>
<span id="alg4.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg4.l7.3" class="ltx_text" style="color:#000000;">         Publish </span><span id="alg4.l7.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg4.l7.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg4.l7.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg4.l7.7" class="ltx_text" style="color:#000000;"> = payment_request </span><span id="alg4.l7.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l7.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l7.1.m1.1a"><mo mathcolor="#000000" id="alg4.l7.1.m1.1.1" xref="alg4.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l7.1.m1.1b"><ci id="alg4.l7.1.m1.1.1.cmml" xref="alg4.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l7.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span> </span>
</span>
<span id="alg4.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg4.l8.2" class="ltx_text" style="color:#000000;">         Wait until the initial payment is submitted, fetch and validate </span><span id="alg4.l8.3" class="ltx_text" style="color:#78453B;">Payment Receipt (KIND: 9735)</span><span id="alg4.l8.4" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg4.l9.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l9.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l9.4" class="ltx_text" style="color:#000000;"> payment = successful </span><span id="alg4.l9.5" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l9.6" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l10.2.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg4.l10.3" class="ltx_text" style="color:#000000;">              Publish </span><span id="alg4.l10.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg4.l10.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg4.l10.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg4.l10.7" class="ltx_text" style="color:#000000;"> = processing </span><span id="alg4.l10.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l10.1.m1.1a"><mo mathcolor="#000000" id="alg4.l10.1.m1.1.1" xref="alg4.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l10.1.m1.1b"><ci id="alg4.l10.1.m1.1.1.cmml" xref="alg4.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l10.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</span>
<span id="alg4.l11" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg4.l11.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l11.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span>
</span>
<span id="alg4.l12" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg4.l12.2" class="ltx_text" style="color:#000000;">              Publish </span><span id="alg4.l12.3" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg4.l12.4" class="ltx_text" style="color:#000000;"> with </span><span id="alg4.l12.5" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg4.l12.6" class="ltx_text" style="color:#000000;"> = error
         </span>
</span>
<span id="alg4.l13" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg4.l13.2" class="ltx_text" style="color:#000000;">         Fetch </span><span id="alg4.l13.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg4.l13.4" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l13.5" class="ltx_text" style="color:#000066;">DATA_SOURCES(SP_NPUB)</span><span id="alg4.l13.6" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l13.7" class="ltx_text" style="color:#000066;"> RUN_OPTION</span><span id="alg4.l13.8" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l13.9" class="ltx_text" style="color:#000066;">TASK</span><span id="alg4.l13.10" class="ltx_text" style="color:#000000;"> from </span><span id="alg4.l13.11" class="ltx_text" style="color:#78453B;">JOB REQUEST</span><span id="alg4.l13.12" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l14" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg4.l14.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l14.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l14.4" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l14.5" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg4.l14.6" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l14.7" class="ltx_text" style="color:#78453B;">FEDAVG</span><span id="alg4.l14.8" class="ltx_text" style="color:#000000;"> and </span><span id="alg4.l14.9" class="ltx_text" style="color:#000066;">TASK</span><span id="alg4.l14.10" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l14.11" class="ltx_text" style="color:#78453B;">INNER</span><span id="alg4.l14.12" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l14.13" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l14.14" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l15" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg4.l15.2" class="ltx_text" style="color:#000000;">              Call Inner_Optimization( </span><span id="alg4.l15.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg4.l15.4" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l15.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span><span id="alg4.l15.6" class="ltx_text" style="color:#000000;"> , </span><span id="alg4.l15.7" class="ltx_text" style="color:#78453B;">FEDAVG</span><span id="alg4.l15.8" class="ltx_text" style="color:#000000;"> )
</span>
</span>
<span id="alg4.l16" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg4.l16.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l16.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg4.l16.4" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l16.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l16.6" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l16.7" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg4.l16.8" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l16.9" class="ltx_text" style="color:#78453B;">FEDAVG</span><span id="alg4.l16.10" class="ltx_text" style="color:#000000;"> and </span><span id="alg4.l16.11" class="ltx_text" style="color:#000066;">TASK</span><span id="alg4.l16.12" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l16.13" class="ltx_text" style="color:#78453B;">OUTER</span><span id="alg4.l16.14" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l16.15" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l16.16" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l17" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg4.l17.2" class="ltx_text" style="color:#000000;">              Call Outer_Optimization( </span><span id="alg4.l17.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg4.l17.4" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l17.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span><span id="alg4.l17.6" class="ltx_text" style="color:#000000;"> , </span><span id="alg4.l17.7" class="ltx_text" style="color:#78453B;">FEDAVG</span><span id="alg4.l17.8" class="ltx_text" style="color:#000000;"> )
</span>
</span>
<span id="alg4.l18" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span><span id="alg4.l18.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l18.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg4.l18.4" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l18.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l18.6" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l18.7" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg4.l18.8" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l18.9" class="ltx_text" style="color:#78453B;">DiLoCo</span><span id="alg4.l18.10" class="ltx_text" style="color:#000000;"> and </span><span id="alg4.l18.11" class="ltx_text" style="color:#000066;">TASK</span><span id="alg4.l18.12" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l18.13" class="ltx_text" style="color:#78453B;">INNER</span><span id="alg4.l18.14" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l18.15" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l18.16" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l19" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span><span id="alg4.l19.2" class="ltx_text" style="color:#000000;">              Call Inner_Optimization( </span><span id="alg4.l19.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg4.l19.4" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l19.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span><span id="alg4.l19.6" class="ltx_text" style="color:#000000;"> , </span><span id="alg4.l19.7" class="ltx_text" style="color:#78453B;">DiLoCo</span><span id="alg4.l19.8" class="ltx_text" style="color:#000000;"> )
</span>
</span>
<span id="alg4.l20" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span><span id="alg4.l20.2" class="ltx_text" style="color:#000000;">         </span><span id="alg4.l20.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg4.l20.4" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l20.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg4.l20.6" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l20.7" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg4.l20.8" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l20.9" class="ltx_text" style="color:#78453B;">DiLoCo</span><span id="alg4.l20.10" class="ltx_text" style="color:#000000;"> and </span><span id="alg4.l20.11" class="ltx_text" style="color:#000066;">TASK</span><span id="alg4.l20.12" class="ltx_text" style="color:#000000;"> = </span><span id="alg4.l20.13" class="ltx_text" style="color:#78453B;">INNER</span><span id="alg4.l20.14" class="ltx_text" style="color:#000000;"> </span><span id="alg4.l20.15" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg4.l20.16" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg4.l21" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span><span id="alg4.l21.2" class="ltx_text" style="color:#000000;">              Call Outer_Optimization( </span><span id="alg4.l21.3" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span><span id="alg4.l21.4" class="ltx_text" style="color:#000000;">, </span><span id="alg4.l21.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span><span id="alg4.l21.6" class="ltx_text" style="color:#000000;"> , </span><span id="alg4.l21.7" class="ltx_text" style="color:#78453B;">DiLoCo</span><span id="alg4.l21.8" class="ltx_text" style="color:#000000;"> )
         </span>
</span>
<span id="alg4.l22" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l22.2.1.1" class="ltx_text" style="font-size:80%;">22:</span></span><span id="alg4.l22.3" class="ltx_text" style="color:#000000;">         Publish </span><span id="alg4.l22.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg4.l22.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg4.l22.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg4.l22.7" class="ltx_text" style="color:#000000;"> = success </span><span id="alg4.l22.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l22.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l22.1.m1.1a"><mo mathcolor="#000000" id="alg4.l22.1.m1.1.1" xref="alg4.l22.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l22.1.m1.1b"><ci id="alg4.l22.1.m1.1.1.cmml" xref="alg4.l22.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l22.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l22.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</span>
<span id="alg4.l23" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg4.l23.2.1.1" class="ltx_text" style="font-size:80%;">23:</span></span><span id="alg4.l23.3" class="ltx_text" style="color:#000000;">         Publish a </span><span id="alg4.l23.4" class="ltx_text" style="color:#78453B;">JOB RESULT</span><span id="alg4.l23.5" class="ltx_text" style="color:#000000;"> event with "output" the result of the optimization </span><span id="alg4.l23.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg4.l23.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg4.l23.1.m1.1a"><mo mathcolor="#000000" id="alg4.l23.1.m1.1.1" xref="alg4.l23.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l23.1.m1.1b"><ci id="alg4.l23.1.m1.1.1.cmml" xref="alg4.l23.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l23.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg4.l23.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST3" title="Event Type 3 ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a></span>
     </span>
</span>
</span>
</span>
<section id="S7.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Federated Averaging vs Distributed Low-Communication
Training of LLMs (DiLoCo)</h4>

<span id="S7.SS2.SSS0.Px1.p1" class="ltx_para">
<span id="S7.SS2.SSS0.Px1.p1.1" class="ltx_p">The federated averaging algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> (FEDAVG) is a distributed and communication efficient learning method of AI models from decentralized data. This decentralized computation is known as federated learning; a set of different devices learn a shared model by aggregating locally-computed updates. In our design we consider as one optimization approach the FEDAVG. The customer provides a common model specification and the data to the servicce providers. The service providers have the role of different devices, they obtain a subset of the data-set and they train the shared model. Upon completion of the computation they return the optimized model parameters, and they receive a payment.</span>
</span>
<span id="S7.SS2.SSS0.Px1.p2" class="ltx_para">
<span id="S7.SS2.SSS0.Px1.p2.1" class="ltx_p">Although the FEDAVG is a successful approach for training neural netowrks and AI in a decentralized fashion, we also consider a variant of FEDAVG that has numerous advantages over the classical approach. Specifically, the DiLoCo algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> enables training of LLMs under constrained communication. In fact, the inner part of optimization (jobs by Service providers) requires the greatest amount of computation, while the request for a new job is being decreased significantly. This provides additional flexibility to our design since it minimizes the number of job requests by the customer. Nevertheless, the service providers have the option to frequently provide information (e.g. job status, partial output) to the customer through the Job Feedback events. We proceed by presenting the implementation of the Inner Optimization and Outer Optimization routines for both FEDAVG and DiLoCo algorithms.</span>
</span>
</section>
<section id="S7.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Inner Optimization (Algorithm <a href="#alg5" title="Algorithm 5 ‣ Inner Optimization (Algorithm 5) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)</h4>

<span id="S7.SS2.SSS0.Px2.p1" class="ltx_para">
<span id="S7.SS2.SSS0.Px2.p1.1" class="ltx_p">The Inner Optimization routine provides the implementation of the inner part of the computation. A service provider runs the inner part of FEDAVG (example SGD) or DiLoCo (AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, Algorithm 2]</cite>). The run option is provided by the customer through the job request event. The algorithm returns the updated model parameter.</span>
</span>
<span id="alg5" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg5.2.1.1" class="ltx_text ltx_font_bold">Algorithm 5</span> </span> Inner_Optimization</span>
<span id="alg5.3" class="ltx_listing ltx_listing">
<span id="alg5.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg5.l1.2" class="ltx_text" style="color:#000066;">RUN_OPTION</span>: &lt;FEDAVG or DiLoCo&gt;, <span id="alg5.l1.3" class="ltx_text" style="color:#000066;">DATA:</span> <span id="alg5.l1.4" class="ltx_text" style="color:#000066;">DATA_SOURCES</span>, <span id="alg5.l1.5" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span>: <math id="alg5.l1.m1.1" class="ltx_Math" alttext="\theta_{\text{global}}" display="inline"><semantics id="alg5.l1.m1.1a"><msub id="alg5.l1.m1.1.1" xref="alg5.l1.m1.1.1.cmml"><mi id="alg5.l1.m1.1.1.2" xref="alg5.l1.m1.1.1.2.cmml">θ</mi><mtext id="alg5.l1.m1.1.1.3" xref="alg5.l1.m1.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="alg5.l1.m1.1b"><apply id="alg5.l1.m1.1.1.cmml" xref="alg5.l1.m1.1.1"><csymbol cd="ambiguous" id="alg5.l1.m1.1.1.1.cmml" xref="alg5.l1.m1.1.1">subscript</csymbol><ci id="alg5.l1.m1.1.1.2.cmml" xref="alg5.l1.m1.1.1.2">𝜃</ci><ci id="alg5.l1.m1.1.1.3a.cmml" xref="alg5.l1.m1.1.1.3"><mtext mathsize="70%" id="alg5.l1.m1.1.1.3.cmml" xref="alg5.l1.m1.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m1.1c">\theta_{\text{global}}</annotation></semantics></math>

</span>
<span id="alg5.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Connection through websockets to all <span id="alg5.l2.3" class="ltx_text ltx_font_italic" style="color:#00260D;">relays</span> in <span id="alg5.l2.4" class="ltx_text" style="color:#000066;">RELAYS</span> <span id="alg5.l2.1" class="ltx_text" style="float:right;"><math id="alg5.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l2.1.m1.1a"><mo id="alg5.l2.1.m1.1.1" xref="alg5.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l2.1.m1.1b"><ci id="alg5.l2.1.m1.1.1.cmml" xref="alg5.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l2.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l2.1.1" class="ltx_text" style="color:#BF8040;"> Where events are published at<span id="alg5.l2.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg5.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg5.l3.m1.1" class="ltx_Math" alttext="\theta\leftarrow\theta_{\text{global}}" display="inline"><semantics id="alg5.l3.m1.1a"><mrow id="alg5.l3.m1.1.1" xref="alg5.l3.m1.1.1.cmml"><mi mathcolor="#000000" id="alg5.l3.m1.1.1.2" xref="alg5.l3.m1.1.1.2.cmml">θ</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l3.m1.1.1.1" xref="alg5.l3.m1.1.1.1.cmml">←</mo><msub id="alg5.l3.m1.1.1.3" xref="alg5.l3.m1.1.1.3.cmml"><mi mathcolor="#000000" id="alg5.l3.m1.1.1.3.2" xref="alg5.l3.m1.1.1.3.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg5.l3.m1.1.1.3.3" xref="alg5.l3.m1.1.1.3.3a.cmml">global</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg5.l3.m1.1b"><apply id="alg5.l3.m1.1.1.cmml" xref="alg5.l3.m1.1.1"><ci id="alg5.l3.m1.1.1.1.cmml" xref="alg5.l3.m1.1.1.1">←</ci><ci id="alg5.l3.m1.1.1.2.cmml" xref="alg5.l3.m1.1.1.2">𝜃</ci><apply id="alg5.l3.m1.1.1.3.cmml" xref="alg5.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg5.l3.m1.1.1.3.1.cmml" xref="alg5.l3.m1.1.1.3">subscript</csymbol><ci id="alg5.l3.m1.1.1.3.2.cmml" xref="alg5.l3.m1.1.1.3.2">𝜃</ci><ci id="alg5.l3.m1.1.1.3.3a.cmml" xref="alg5.l3.m1.1.1.3.3"><mtext mathsize="70%" id="alg5.l3.m1.1.1.3.3.cmml" xref="alg5.l3.m1.1.1.3.3">global</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m1.1c">\theta\leftarrow\theta_{\text{global}}</annotation></semantics></math><span id="alg5.l3.2" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l4.2.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg5.l4.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg5.l4.4" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l4.5" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg5.l4.6" class="ltx_text" style="color:#000000;"> = FEDAVG </span><span id="alg5.l4.7" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg5.l4.8" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l4.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg5.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l4.1.m1.1a"><mo mathcolor="#000000" id="alg5.l4.1.m1.1.1" xref="alg5.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l4.1.m1.1b"><ci id="alg5.l4.1.m1.1.1.cmml" xref="alg5.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l4.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l4.1.1" class="ltx_text" style="color:#BF8040;">Run the inner part of FEDAVG</span>
</span>
</span>
<span id="alg5.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg5.l5.2" class="ltx_text" style="color:#000000;">     data </span><math id="alg5.l5.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg5.l5.m1.1a"><mo mathcolor="#000000" stretchy="false" id="alg5.l5.m1.1.1" xref="alg5.l5.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg5.l5.m1.1b"><ci id="alg5.l5.m1.1.1.cmml" xref="alg5.l5.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l5.m1.1c">\leftarrow</annotation></semantics></math><span id="alg5.l5.3" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l5.4" class="ltx_text" style="color:#000066;">DATA_SOURCES(SP_NPUB)</span><span id="alg5.l5.5" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg5.l6.2" class="ltx_text" style="color:#000000;">     </span><math id="alg5.l6.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="alg5.l6.m1.1a"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="alg5.l6.m1.1.1" xref="alg5.l6.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg5.l6.m1.1b"><ci id="alg5.l6.m1.1.1.cmml" xref="alg5.l6.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l6.m1.1c">\mathcal{B}</annotation></semantics></math><span id="alg5.l6.3" class="ltx_text" style="color:#000000;"> </span><math id="alg5.l6.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg5.l6.m2.1a"><mo mathcolor="#000000" stretchy="false" id="alg5.l6.m2.1.1" xref="alg5.l6.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg5.l6.m2.1b"><ci id="alg5.l6.m2.1.1.cmml" xref="alg5.l6.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l6.m2.1c">\leftarrow</annotation></semantics></math><span id="alg5.l6.4" class="ltx_text" style="color:#000000;"> Split data into batches </span>
</span>
<span id="alg5.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg5.l7.2" class="ltx_text" style="color:#000000;">     </span><span id="alg5.l7.3" class="ltx_text ltx_font_bold" style="color:#000000;">for</span><span id="alg5.l7.4" class="ltx_text" style="color:#000000;"> epoch </span><math id="alg5.l7.m1.2" class="ltx_Math" alttext="e\in(1,E)" display="inline"><semantics id="alg5.l7.m1.2a"><mrow id="alg5.l7.m1.2.3" xref="alg5.l7.m1.2.3.cmml"><mi mathcolor="#000000" id="alg5.l7.m1.2.3.2" xref="alg5.l7.m1.2.3.2.cmml">e</mi><mo mathcolor="#000000" id="alg5.l7.m1.2.3.1" xref="alg5.l7.m1.2.3.1.cmml">∈</mo><mrow id="alg5.l7.m1.2.3.3.2" xref="alg5.l7.m1.2.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg5.l7.m1.2.3.3.2.1" xref="alg5.l7.m1.2.3.3.1.cmml">(</mo><mn mathcolor="#000000" id="alg5.l7.m1.1.1" xref="alg5.l7.m1.1.1.cmml">1</mn><mo mathcolor="#000000" id="alg5.l7.m1.2.3.3.2.2" xref="alg5.l7.m1.2.3.3.1.cmml">,</mo><mi mathcolor="#000000" id="alg5.l7.m1.2.2" xref="alg5.l7.m1.2.2.cmml">E</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l7.m1.2.3.3.2.3" xref="alg5.l7.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m1.2b"><apply id="alg5.l7.m1.2.3.cmml" xref="alg5.l7.m1.2.3"><in id="alg5.l7.m1.2.3.1.cmml" xref="alg5.l7.m1.2.3.1"></in><ci id="alg5.l7.m1.2.3.2.cmml" xref="alg5.l7.m1.2.3.2">𝑒</ci><interval closure="open" id="alg5.l7.m1.2.3.3.1.cmml" xref="alg5.l7.m1.2.3.3.2"><cn type="integer" id="alg5.l7.m1.1.1.cmml" xref="alg5.l7.m1.1.1">1</cn><ci id="alg5.l7.m1.2.2.cmml" xref="alg5.l7.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m1.2c">e\in(1,E)</annotation></semantics></math><span id="alg5.l7.5" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l7.6" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg5.l7.7" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg5.l8.3" class="ltx_text" style="color:#000000;">         Publish </span><span id="alg5.l8.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg5.l8.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg5.l8.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg5.l8.7" class="ltx_text" style="color:#000000;"> = processing </span><span id="alg5.l8.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg5.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l8.1.m1.1a"><mo mathcolor="#000000" id="alg5.l8.1.m1.1.1" xref="alg5.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l8.1.m1.1b"><ci id="alg5.l8.1.m1.1.1.cmml" xref="alg5.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l8.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l8.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</span>
<span id="alg5.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg5.l9.2" class="ltx_text" style="color:#000000;">         </span><span id="alg5.l9.3" class="ltx_text ltx_font_bold" style="color:#000000;">for</span><span id="alg5.l9.4" class="ltx_text" style="color:#000000;"> batch </span><math id="alg5.l9.m1.1" class="ltx_Math" alttext="\boldsymbol{b}\in\mathcal{B}" display="inline"><semantics id="alg5.l9.m1.1a"><mrow id="alg5.l9.m1.1.1" xref="alg5.l9.m1.1.1.cmml"><mi mathcolor="#000000" id="alg5.l9.m1.1.1.2" xref="alg5.l9.m1.1.1.2.cmml">𝒃</mi><mo mathcolor="#000000" id="alg5.l9.m1.1.1.1" xref="alg5.l9.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="alg5.l9.m1.1.1.3" xref="alg5.l9.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m1.1b"><apply id="alg5.l9.m1.1.1.cmml" xref="alg5.l9.m1.1.1"><in id="alg5.l9.m1.1.1.1.cmml" xref="alg5.l9.m1.1.1.1"></in><ci id="alg5.l9.m1.1.1.2.cmml" xref="alg5.l9.m1.1.1.2">𝒃</ci><ci id="alg5.l9.m1.1.1.3.cmml" xref="alg5.l9.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m1.1c">\boldsymbol{b}\in\mathcal{B}</annotation></semantics></math><span id="alg5.l9.5" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l9.6" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg5.l9.7" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg5.l10.2" class="ltx_text" style="color:#000000;">              </span><math id="alg5.l10.m1.2" class="ltx_Math" alttext="\theta\leftarrow\theta-\eta\nabla\ell(\theta;\boldsymbol{b})" display="inline"><semantics id="alg5.l10.m1.2a"><mrow id="alg5.l10.m1.2.3" xref="alg5.l10.m1.2.3.cmml"><mi mathcolor="#000000" id="alg5.l10.m1.2.3.2" xref="alg5.l10.m1.2.3.2.cmml">θ</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l10.m1.2.3.1" xref="alg5.l10.m1.2.3.1.cmml">←</mo><mrow id="alg5.l10.m1.2.3.3" xref="alg5.l10.m1.2.3.3.cmml"><mi mathcolor="#000000" id="alg5.l10.m1.2.3.3.2" xref="alg5.l10.m1.2.3.3.2.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l10.m1.2.3.3.1" xref="alg5.l10.m1.2.3.3.1.cmml">−</mo><mrow id="alg5.l10.m1.2.3.3.3" xref="alg5.l10.m1.2.3.3.3.cmml"><mi mathcolor="#000000" id="alg5.l10.m1.2.3.3.3.2" xref="alg5.l10.m1.2.3.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg5.l10.m1.2.3.3.3.1" xref="alg5.l10.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg5.l10.m1.2.3.3.3.3" xref="alg5.l10.m1.2.3.3.3.3.cmml"><mo mathcolor="#000000" rspace="0.167em" id="alg5.l10.m1.2.3.3.3.3.1" xref="alg5.l10.m1.2.3.3.3.3.1.cmml">∇</mo><mi mathcolor="#000000" mathvariant="normal" id="alg5.l10.m1.2.3.3.3.3.2" xref="alg5.l10.m1.2.3.3.3.3.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg5.l10.m1.2.3.3.3.1a" xref="alg5.l10.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg5.l10.m1.2.3.3.3.4.2" xref="alg5.l10.m1.2.3.3.3.4.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg5.l10.m1.2.3.3.3.4.2.1" xref="alg5.l10.m1.2.3.3.3.4.1.cmml">(</mo><mi mathcolor="#000000" id="alg5.l10.m1.1.1" xref="alg5.l10.m1.1.1.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l10.m1.2.3.3.3.4.2.2" xref="alg5.l10.m1.2.3.3.3.4.1.cmml">;</mo><mi mathcolor="#000000" id="alg5.l10.m1.2.2" xref="alg5.l10.m1.2.2.cmml">𝒃</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l10.m1.2.3.3.3.4.2.3" xref="alg5.l10.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg5.l10.m1.2b"><apply id="alg5.l10.m1.2.3.cmml" xref="alg5.l10.m1.2.3"><ci id="alg5.l10.m1.2.3.1.cmml" xref="alg5.l10.m1.2.3.1">←</ci><ci id="alg5.l10.m1.2.3.2.cmml" xref="alg5.l10.m1.2.3.2">𝜃</ci><apply id="alg5.l10.m1.2.3.3.cmml" xref="alg5.l10.m1.2.3.3"><minus id="alg5.l10.m1.2.3.3.1.cmml" xref="alg5.l10.m1.2.3.3.1"></minus><ci id="alg5.l10.m1.2.3.3.2.cmml" xref="alg5.l10.m1.2.3.3.2">𝜃</ci><apply id="alg5.l10.m1.2.3.3.3.cmml" xref="alg5.l10.m1.2.3.3.3"><times id="alg5.l10.m1.2.3.3.3.1.cmml" xref="alg5.l10.m1.2.3.3.3.1"></times><ci id="alg5.l10.m1.2.3.3.3.2.cmml" xref="alg5.l10.m1.2.3.3.3.2">𝜂</ci><apply id="alg5.l10.m1.2.3.3.3.3.cmml" xref="alg5.l10.m1.2.3.3.3.3"><ci id="alg5.l10.m1.2.3.3.3.3.1.cmml" xref="alg5.l10.m1.2.3.3.3.3.1">∇</ci><ci id="alg5.l10.m1.2.3.3.3.3.2.cmml" xref="alg5.l10.m1.2.3.3.3.3.2">ℓ</ci></apply><list id="alg5.l10.m1.2.3.3.3.4.1.cmml" xref="alg5.l10.m1.2.3.3.3.4.2"><ci id="alg5.l10.m1.1.1.cmml" xref="alg5.l10.m1.1.1">𝜃</ci><ci id="alg5.l10.m1.2.2.cmml" xref="alg5.l10.m1.2.2">𝒃</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l10.m1.2c">\theta\leftarrow\theta-\eta\nabla\ell(\theta;\boldsymbol{b})</annotation></semantics></math><span id="alg5.l10.3" class="ltx_text" style="color:#000000;">
              </span>
</span>
<span id="alg5.l11" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg5.l11.2" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg5.l11.3" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l11.4" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg5.l11.5" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l11.6" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg5.l11.7" class="ltx_text" style="color:#000000;"> = DiLoCo </span><span id="alg5.l11.8" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg5.l11.9" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l12" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg5.l12.2" class="ltx_text" style="color:#000000;">     </span><span id="alg5.l12.3" class="ltx_text ltx_font_bold" style="color:#000000;">for</span><span id="alg5.l12.4" class="ltx_text" style="color:#000000;"> epoch </span><math id="alg5.l12.m1.2" class="ltx_Math" alttext="e\in(1,E)" display="inline"><semantics id="alg5.l12.m1.2a"><mrow id="alg5.l12.m1.2.3" xref="alg5.l12.m1.2.3.cmml"><mi mathcolor="#000000" id="alg5.l12.m1.2.3.2" xref="alg5.l12.m1.2.3.2.cmml">e</mi><mo mathcolor="#000000" id="alg5.l12.m1.2.3.1" xref="alg5.l12.m1.2.3.1.cmml">∈</mo><mrow id="alg5.l12.m1.2.3.3.2" xref="alg5.l12.m1.2.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg5.l12.m1.2.3.3.2.1" xref="alg5.l12.m1.2.3.3.1.cmml">(</mo><mn mathcolor="#000000" id="alg5.l12.m1.1.1" xref="alg5.l12.m1.1.1.cmml">1</mn><mo mathcolor="#000000" id="alg5.l12.m1.2.3.3.2.2" xref="alg5.l12.m1.2.3.3.1.cmml">,</mo><mi mathcolor="#000000" id="alg5.l12.m1.2.2" xref="alg5.l12.m1.2.2.cmml">E</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l12.m1.2.3.3.2.3" xref="alg5.l12.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg5.l12.m1.2b"><apply id="alg5.l12.m1.2.3.cmml" xref="alg5.l12.m1.2.3"><in id="alg5.l12.m1.2.3.1.cmml" xref="alg5.l12.m1.2.3.1"></in><ci id="alg5.l12.m1.2.3.2.cmml" xref="alg5.l12.m1.2.3.2">𝑒</ci><interval closure="open" id="alg5.l12.m1.2.3.3.1.cmml" xref="alg5.l12.m1.2.3.3.2"><cn type="integer" id="alg5.l12.m1.1.1.cmml" xref="alg5.l12.m1.1.1">1</cn><ci id="alg5.l12.m1.2.2.cmml" xref="alg5.l12.m1.2.2">𝐸</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l12.m1.2c">e\in(1,E)</annotation></semantics></math><span id="alg5.l12.5" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l12.6" class="ltx_text ltx_font_bold" style="color:#000000;">do</span><span id="alg5.l12.7" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l13" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg5.l13.2" class="ltx_text" style="color:#000000;">         Sample a batch </span><math id="alg5.l13.m1.1" class="ltx_Math" alttext="\boldsymbol{b}" display="inline"><semantics id="alg5.l13.m1.1a"><mi mathcolor="#000000" id="alg5.l13.m1.1.1" xref="alg5.l13.m1.1.1.cmml">𝒃</mi><annotation-xml encoding="MathML-Content" id="alg5.l13.m1.1b"><ci id="alg5.l13.m1.1.1.cmml" xref="alg5.l13.m1.1.1">𝒃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l13.m1.1c">\boldsymbol{b}</annotation></semantics></math><span id="alg5.l13.3" class="ltx_text" style="color:#000000;"> of data from </span><span id="alg5.l13.4" class="ltx_text" style="color:#000066;">DATA_SOURCES(SP_NPUB)</span><span id="alg5.l13.5" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg5.l14" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l14.2.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg5.l14.3" class="ltx_text" style="color:#000000;">         Run AdamW(</span><math id="alg5.l14.m1.4" class="ltx_Math" alttext="\theta,\nabla\ell(\theta,\boldsymbol{b})" display="inline"><semantics id="alg5.l14.m1.4a"><mrow id="alg5.l14.m1.4.4.1" xref="alg5.l14.m1.4.4.2.cmml"><mi mathcolor="#000000" id="alg5.l14.m1.3.3" xref="alg5.l14.m1.3.3.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l14.m1.4.4.1.2" xref="alg5.l14.m1.4.4.2.cmml">,</mo><mrow id="alg5.l14.m1.4.4.1.1" xref="alg5.l14.m1.4.4.1.1.cmml"><mrow id="alg5.l14.m1.4.4.1.1.2" xref="alg5.l14.m1.4.4.1.1.2.cmml"><mo mathcolor="#000000" rspace="0.167em" id="alg5.l14.m1.4.4.1.1.2.1" xref="alg5.l14.m1.4.4.1.1.2.1.cmml">∇</mo><mi mathcolor="#000000" mathvariant="normal" id="alg5.l14.m1.4.4.1.1.2.2" xref="alg5.l14.m1.4.4.1.1.2.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg5.l14.m1.4.4.1.1.1" xref="alg5.l14.m1.4.4.1.1.1.cmml">​</mo><mrow id="alg5.l14.m1.4.4.1.1.3.2" xref="alg5.l14.m1.4.4.1.1.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg5.l14.m1.4.4.1.1.3.2.1" xref="alg5.l14.m1.4.4.1.1.3.1.cmml">(</mo><mi mathcolor="#000000" id="alg5.l14.m1.1.1" xref="alg5.l14.m1.1.1.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l14.m1.4.4.1.1.3.2.2" xref="alg5.l14.m1.4.4.1.1.3.1.cmml">,</mo><mi mathcolor="#000000" id="alg5.l14.m1.2.2" xref="alg5.l14.m1.2.2.cmml">𝒃</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l14.m1.4.4.1.1.3.2.3" xref="alg5.l14.m1.4.4.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg5.l14.m1.4b"><list id="alg5.l14.m1.4.4.2.cmml" xref="alg5.l14.m1.4.4.1"><ci id="alg5.l14.m1.3.3.cmml" xref="alg5.l14.m1.3.3">𝜃</ci><apply id="alg5.l14.m1.4.4.1.1.cmml" xref="alg5.l14.m1.4.4.1.1"><times id="alg5.l14.m1.4.4.1.1.1.cmml" xref="alg5.l14.m1.4.4.1.1.1"></times><apply id="alg5.l14.m1.4.4.1.1.2.cmml" xref="alg5.l14.m1.4.4.1.1.2"><ci id="alg5.l14.m1.4.4.1.1.2.1.cmml" xref="alg5.l14.m1.4.4.1.1.2.1">∇</ci><ci id="alg5.l14.m1.4.4.1.1.2.2.cmml" xref="alg5.l14.m1.4.4.1.1.2.2">ℓ</ci></apply><interval closure="open" id="alg5.l14.m1.4.4.1.1.3.1.cmml" xref="alg5.l14.m1.4.4.1.1.3.2"><ci id="alg5.l14.m1.1.1.cmml" xref="alg5.l14.m1.1.1">𝜃</ci><ci id="alg5.l14.m1.2.2.cmml" xref="alg5.l14.m1.2.2">𝒃</ci></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg5.l14.m1.4c">\theta,\nabla\ell(\theta,\boldsymbol{b})</annotation></semantics></math><span id="alg5.l14.4" class="ltx_text" style="color:#000000;">) </span><span id="alg5.l14.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg5.l14.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l14.1.m1.1a"><mo mathcolor="#000000" id="alg5.l14.1.m1.1.1" xref="alg5.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l14.1.m1.1b"><ci id="alg5.l14.1.m1.1.1.cmml" xref="alg5.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l14.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l14.1.1" class="ltx_text" style="color:#BF8040;"> AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, Algorithm 2]</cite> </span>
</span>
</span>
<span id="alg5.l15" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l15.2.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg5.l15.3" class="ltx_text" style="color:#000000;">         Periodically publish </span><span id="alg5.l15.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg5.l15.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg5.l15.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg5.l15.7" class="ltx_text" style="color:#000000;"> = processing </span><span id="alg5.l15.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg5.l15.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l15.1.m1.1a"><mo mathcolor="#000000" id="alg5.l15.1.m1.1.1" xref="alg5.l15.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l15.1.m1.1b"><ci id="alg5.l15.1.m1.1.1.cmml" xref="alg5.l15.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l15.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l15.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</span>
<span id="alg5.l16" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg5.l16.2" class="ltx_text" style="color:#000000;">         </span><math id="alg5.l16.m1.1" class="ltx_Math" alttext="\theta\leftarrow" display="inline"><semantics id="alg5.l16.m1.1a"><mrow id="alg5.l16.m1.1.1" xref="alg5.l16.m1.1.1.cmml"><mi mathcolor="#000000" id="alg5.l16.m1.1.1.2" xref="alg5.l16.m1.1.1.2.cmml">θ</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l16.m1.1.1.1" xref="alg5.l16.m1.1.1.1.cmml">←</mo><mi id="alg5.l16.m1.1.1.3" xref="alg5.l16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l16.m1.1b"><apply id="alg5.l16.m1.1.1.cmml" xref="alg5.l16.m1.1.1"><ci id="alg5.l16.m1.1.1.1.cmml" xref="alg5.l16.m1.1.1.1">←</ci><ci id="alg5.l16.m1.1.1.2.cmml" xref="alg5.l16.m1.1.1.2">𝜃</ci><csymbol cd="latexml" id="alg5.l16.m1.1.1.3.cmml" xref="alg5.l16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l16.m1.1c">\theta\leftarrow</annotation></semantics></math><span id="alg5.l16.3" class="ltx_text" style="color:#000000;"> AdamW(</span><math id="alg5.l16.m2.4" class="ltx_Math" alttext="\theta,\nabla\ell(\theta,\boldsymbol{b})" display="inline"><semantics id="alg5.l16.m2.4a"><mrow id="alg5.l16.m2.4.4.1" xref="alg5.l16.m2.4.4.2.cmml"><mi mathcolor="#000000" id="alg5.l16.m2.3.3" xref="alg5.l16.m2.3.3.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l16.m2.4.4.1.2" xref="alg5.l16.m2.4.4.2.cmml">,</mo><mrow id="alg5.l16.m2.4.4.1.1" xref="alg5.l16.m2.4.4.1.1.cmml"><mrow id="alg5.l16.m2.4.4.1.1.2" xref="alg5.l16.m2.4.4.1.1.2.cmml"><mo mathcolor="#000000" rspace="0.167em" id="alg5.l16.m2.4.4.1.1.2.1" xref="alg5.l16.m2.4.4.1.1.2.1.cmml">∇</mo><mi mathcolor="#000000" mathvariant="normal" id="alg5.l16.m2.4.4.1.1.2.2" xref="alg5.l16.m2.4.4.1.1.2.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg5.l16.m2.4.4.1.1.1" xref="alg5.l16.m2.4.4.1.1.1.cmml">​</mo><mrow id="alg5.l16.m2.4.4.1.1.3.2" xref="alg5.l16.m2.4.4.1.1.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg5.l16.m2.4.4.1.1.3.2.1" xref="alg5.l16.m2.4.4.1.1.3.1.cmml">(</mo><mi mathcolor="#000000" id="alg5.l16.m2.1.1" xref="alg5.l16.m2.1.1.cmml">θ</mi><mo mathcolor="#000000" id="alg5.l16.m2.4.4.1.1.3.2.2" xref="alg5.l16.m2.4.4.1.1.3.1.cmml">,</mo><mi mathcolor="#000000" id="alg5.l16.m2.2.2" xref="alg5.l16.m2.2.2.cmml">𝒃</mi><mo mathcolor="#000000" stretchy="false" id="alg5.l16.m2.4.4.1.1.3.2.3" xref="alg5.l16.m2.4.4.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg5.l16.m2.4b"><list id="alg5.l16.m2.4.4.2.cmml" xref="alg5.l16.m2.4.4.1"><ci id="alg5.l16.m2.3.3.cmml" xref="alg5.l16.m2.3.3">𝜃</ci><apply id="alg5.l16.m2.4.4.1.1.cmml" xref="alg5.l16.m2.4.4.1.1"><times id="alg5.l16.m2.4.4.1.1.1.cmml" xref="alg5.l16.m2.4.4.1.1.1"></times><apply id="alg5.l16.m2.4.4.1.1.2.cmml" xref="alg5.l16.m2.4.4.1.1.2"><ci id="alg5.l16.m2.4.4.1.1.2.1.cmml" xref="alg5.l16.m2.4.4.1.1.2.1">∇</ci><ci id="alg5.l16.m2.4.4.1.1.2.2.cmml" xref="alg5.l16.m2.4.4.1.1.2.2">ℓ</ci></apply><interval closure="open" id="alg5.l16.m2.4.4.1.1.3.1.cmml" xref="alg5.l16.m2.4.4.1.1.3.2"><ci id="alg5.l16.m2.1.1.cmml" xref="alg5.l16.m2.1.1">𝜃</ci><ci id="alg5.l16.m2.2.2.cmml" xref="alg5.l16.m2.2.2">𝒃</ci></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg5.l16.m2.4c">\theta,\nabla\ell(\theta,\boldsymbol{b})</annotation></semantics></math><span id="alg5.l16.4" class="ltx_text" style="color:#000000;">)      </span>
</span>
<span id="alg5.l17" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg5.l17.3.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg5.l17.4" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg5.l17.5" class="ltx_text" style="color:#000000;"> </span><math id="alg5.l17.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg5.l17.m1.1a"><mi mathcolor="#000000" id="alg5.l17.m1.1.1" xref="alg5.l17.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg5.l17.m1.1b"><ci id="alg5.l17.m1.1.1.cmml" xref="alg5.l17.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l17.m1.1c">\theta</annotation></semantics></math><span id="alg5.l17.6" class="ltx_text" style="color:#000000;"> </span><span id="alg5.l17.2" class="ltx_text" style="color:#000000;float:right;"><math id="alg5.l17.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg5.l17.1.m1.1a"><mo mathcolor="#000000" id="alg5.l17.1.m1.1.1" xref="alg5.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg5.l17.1.m1.1b"><ci id="alg5.l17.1.m1.1.1.cmml" xref="alg5.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l17.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg5.l17.2.1" class="ltx_text" style="color:#BF8040;"> Returns <math id="alg5.l17.2.1.m1.1" class="ltx_Math" alttext="\theta^{({\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{SP\_NPUB}})}_{\text{Inner}}" display="inline"><semantics id="alg5.l17.2.1.m1.1a"><msubsup id="alg5.l17.2.1.m1.1.2" xref="alg5.l17.2.1.m1.1.2.cmml"><mi mathcolor="#BF8040" id="alg5.l17.2.1.m1.1.2.2.2" xref="alg5.l17.2.1.m1.1.2.2.2.cmml">θ</mi><mtext mathcolor="#BF8040" id="alg5.l17.2.1.m1.1.2.3" xref="alg5.l17.2.1.m1.1.2.3a.cmml">Inner</mtext><mrow id="alg5.l17.2.1.m1.1.1.1.3" xref="alg5.l17.2.1.m1.1.1.1.1a.cmml"><mo mathcolor="#BF8040" stretchy="false" id="alg5.l17.2.1.m1.1.1.1.3.1" xref="alg5.l17.2.1.m1.1.1.1.1a.cmml">(</mo><mtext mathcolor="#000066" id="alg5.l17.2.1.m1.1.1.1.1" xref="alg5.l17.2.1.m1.1.1.1.1.cmml">SP_NPUB</mtext><mo mathcolor="#BF8040" stretchy="false" id="alg5.l17.2.1.m1.1.1.1.3.2" xref="alg5.l17.2.1.m1.1.1.1.1a.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg5.l17.2.1.m1.1b"><apply id="alg5.l17.2.1.m1.1.2.cmml" xref="alg5.l17.2.1.m1.1.2"><csymbol cd="ambiguous" id="alg5.l17.2.1.m1.1.2.1.cmml" xref="alg5.l17.2.1.m1.1.2">subscript</csymbol><apply id="alg5.l17.2.1.m1.1.2.2.cmml" xref="alg5.l17.2.1.m1.1.2"><csymbol cd="ambiguous" id="alg5.l17.2.1.m1.1.2.2.1.cmml" xref="alg5.l17.2.1.m1.1.2">superscript</csymbol><ci id="alg5.l17.2.1.m1.1.2.2.2.cmml" xref="alg5.l17.2.1.m1.1.2.2.2">𝜃</ci><ci id="alg5.l17.2.1.m1.1.1.1.1a.cmml" xref="alg5.l17.2.1.m1.1.1.1.3"><mtext mathcolor="#000066" mathsize="70%" id="alg5.l17.2.1.m1.1.1.1.1.cmml" xref="alg5.l17.2.1.m1.1.1.1.1">SP_NPUB</mtext></ci></apply><ci id="alg5.l17.2.1.m1.1.2.3a.cmml" xref="alg5.l17.2.1.m1.1.2.3"><mtext mathcolor="#BF8040" mathsize="70%" id="alg5.l17.2.1.m1.1.2.3.cmml" xref="alg5.l17.2.1.m1.1.2.3">Inner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l17.2.1.m1.1c">\theta^{({\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{SP\_NPUB}})}_{\text{Inner}}</annotation></semantics></math> </span>
</span>
</span>
</span>
</span>
</section>
<section id="S7.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Outer Optimization (Algorithm <a href="#alg6" title="Algorithm 6 ‣ Outer Optimization (Algorithm 6) ‣ 7.2 Service provider ‣ 7 Money-In AI-Out: Marketplace for Federated Learning and LLMs ‣ Receipt Validation ‣ Payment Receipt ‣ Payment Request ‣ 6.1 Payments Implementation ‣ 6 Payments ‣ Discoverability ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)</h4>

<span id="S7.SS2.SSS0.Px3.p1" class="ltx_para">
<span id="S7.SS2.SSS0.Px3.p1.1" class="ltx_p">For the Outer Optimization routine, the customer has the option to run the outer optimization, or assign it to a service provider. Then the customer (or a service provider) runs the outer part of FEDAVG (example aggregation step) or DiLoCo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, Nesterov Momentum]</cite>. The run option is determined by the customer. The algorithm returns the updated model parameter.</span>
</span>
<span id="alg6" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg6.2.1.1" class="ltx_text ltx_font_bold">Algorithm 6</span> </span> Outer_Optimization</span>
<span id="alg6.3" class="ltx_listing ltx_listing">
<span id="alg6.l1" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg6.l1.2" class="ltx_text" style="color:#000066;">RUN_OPTION</span>: &lt;FEDAVG or DiLoCo&gt;, <span id="alg6.l1.3" class="ltx_text" style="color:#000066;">RUN_OPTION</span>: &lt;FEDAVG or DiLoCo&gt;, <span id="alg6.l1.4" class="ltx_text" style="color:#000066;">DATA:</span> <span id="alg6.l1.5" class="ltx_text" style="color:#000066;">DATA_SOURCES</span>, <span id="alg6.l1.6" class="ltx_text ltx_font_italic" style="color:#00260D;">model_parameters</span>: <math id="alg6.l1.m1.1" class="ltx_Math" alttext="\theta_{\text{global}}" display="inline"><semantics id="alg6.l1.m1.1a"><msub id="alg6.l1.m1.1.1" xref="alg6.l1.m1.1.1.cmml"><mi id="alg6.l1.m1.1.1.2" xref="alg6.l1.m1.1.1.2.cmml">θ</mi><mtext id="alg6.l1.m1.1.1.3" xref="alg6.l1.m1.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="alg6.l1.m1.1b"><apply id="alg6.l1.m1.1.1.cmml" xref="alg6.l1.m1.1.1"><csymbol cd="ambiguous" id="alg6.l1.m1.1.1.1.cmml" xref="alg6.l1.m1.1.1">subscript</csymbol><ci id="alg6.l1.m1.1.1.2.cmml" xref="alg6.l1.m1.1.1.2">𝜃</ci><ci id="alg6.l1.m1.1.1.3a.cmml" xref="alg6.l1.m1.1.1.3"><mtext mathsize="70%" id="alg6.l1.m1.1.1.3.cmml" xref="alg6.l1.m1.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l1.m1.1c">\theta_{\text{global}}</annotation></semantics></math>, the last "outputs" of the Inner Optimization jobs: <math id="alg6.l1.m2.1" class="ltx_Math" alttext="\theta_{\text{Inner}}" display="inline"><semantics id="alg6.l1.m2.1a"><msub id="alg6.l1.m2.1.1" xref="alg6.l1.m2.1.1.cmml"><mi id="alg6.l1.m2.1.1.2" xref="alg6.l1.m2.1.1.2.cmml">θ</mi><mtext id="alg6.l1.m2.1.1.3" xref="alg6.l1.m2.1.1.3a.cmml">Inner</mtext></msub><annotation-xml encoding="MathML-Content" id="alg6.l1.m2.1b"><apply id="alg6.l1.m2.1.1.cmml" xref="alg6.l1.m2.1.1"><csymbol cd="ambiguous" id="alg6.l1.m2.1.1.1.cmml" xref="alg6.l1.m2.1.1">subscript</csymbol><ci id="alg6.l1.m2.1.1.2.cmml" xref="alg6.l1.m2.1.1.2">𝜃</ci><ci id="alg6.l1.m2.1.1.3a.cmml" xref="alg6.l1.m2.1.1.3"><mtext mathsize="70%" id="alg6.l1.m2.1.1.3.cmml" xref="alg6.l1.m2.1.1.3">Inner</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l1.m2.1c">\theta_{\text{Inner}}</annotation></semantics></math> 
</span>
<span id="alg6.l2" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Connection through websockets to all <span id="alg6.l2.3" class="ltx_text ltx_font_italic" style="color:#00260D;">relays</span> in <span id="alg6.l2.4" class="ltx_text" style="color:#000066;">RELAYS</span> <span id="alg6.l2.1" class="ltx_text" style="float:right;"><math id="alg6.l2.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l2.1.m1.1a"><mo id="alg6.l2.1.m1.1.1" xref="alg6.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l2.1.m1.1b"><ci id="alg6.l2.1.m1.1.1.cmml" xref="alg6.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l2.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l2.1.1" class="ltx_text" style="color:#BF8040;"> Where events are published at<span id="alg6.l2.1.1.1" class="ltx_text" style="color:#000000;">
</span></span></span>
</span>
<span id="alg6.l3" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg6.l3.3" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg6.l3.4" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l3.5" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg6.l3.6" class="ltx_text" style="color:#000000;"> = FEDAVG </span><span id="alg6.l3.7" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg6.l3.8" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l3.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg6.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l3.1.m1.1a"><mo mathcolor="#000000" id="alg6.l3.1.m1.1.1" xref="alg6.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l3.1.m1.1b"><ci id="alg6.l3.1.m1.1.1.cmml" xref="alg6.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l3.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l3.1.1" class="ltx_text" style="color:#BF8040;">Run the aggregation (outer) part of FEDAVG</span>
</span>
</span>
<span id="alg6.l4" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l4.3.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg6.l4.4" class="ltx_text" style="color:#000000;">     </span><math id="alg6.l4.m1.1" class="ltx_Math" alttext="\theta_{\text{global}}=\frac{1}{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}\sum^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}_{k=1}\eta_{k}\times\theta^{(k)}_{\text{Inner}}" display="inline"><semantics id="alg6.l4.m1.1a"><mrow id="alg6.l4.m1.1.2" xref="alg6.l4.m1.1.2.cmml"><msub id="alg6.l4.m1.1.2.2" xref="alg6.l4.m1.1.2.2.cmml"><mi mathcolor="#000000" id="alg6.l4.m1.1.2.2.2" xref="alg6.l4.m1.1.2.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l4.m1.1.2.2.3" xref="alg6.l4.m1.1.2.2.3a.cmml">global</mtext></msub><mo mathcolor="#000000" id="alg6.l4.m1.1.2.1" xref="alg6.l4.m1.1.2.1.cmml">=</mo><mrow id="alg6.l4.m1.1.2.3" xref="alg6.l4.m1.1.2.3.cmml"><mfrac mathcolor="#000000" id="alg6.l4.m1.1.2.3.2" xref="alg6.l4.m1.1.2.3.2.cmml"><mn mathcolor="#000000" id="alg6.l4.m1.1.2.3.2.2" xref="alg6.l4.m1.1.2.3.2.2.cmml">1</mn><mtext mathcolor="#000066" id="alg6.l4.m1.1.2.3.2.3" xref="alg6.l4.m1.1.2.3.2.3a.cmml">NUM_PR</mtext></mfrac><mo lspace="0em" rspace="0em" id="alg6.l4.m1.1.2.3.1" xref="alg6.l4.m1.1.2.3.1.cmml">​</mo><mrow id="alg6.l4.m1.1.2.3.3" xref="alg6.l4.m1.1.2.3.3.cmml"><msubsup id="alg6.l4.m1.1.2.3.3.1" xref="alg6.l4.m1.1.2.3.3.1.cmml"><mo mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.1.2.2" xref="alg6.l4.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg6.l4.m1.1.2.3.3.1.3" xref="alg6.l4.m1.1.2.3.3.1.3.cmml"><mi mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.1.3.2" xref="alg6.l4.m1.1.2.3.3.1.3.2.cmml">k</mi><mo mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.1.3.1" xref="alg6.l4.m1.1.2.3.3.1.3.1.cmml">=</mo><mn mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.1.3.3" xref="alg6.l4.m1.1.2.3.3.1.3.3.cmml">1</mn></mrow><mtext mathcolor="#000066" id="alg6.l4.m1.1.2.3.3.1.2.3" xref="alg6.l4.m1.1.2.3.3.1.2.3a.cmml">NUM_PR</mtext></msubsup><mrow id="alg6.l4.m1.1.2.3.3.2" xref="alg6.l4.m1.1.2.3.3.2.cmml"><msub id="alg6.l4.m1.1.2.3.3.2.2" xref="alg6.l4.m1.1.2.3.3.2.2.cmml"><mi mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.2.2.2" xref="alg6.l4.m1.1.2.3.3.2.2.2.cmml">η</mi><mi mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.2.2.3" xref="alg6.l4.m1.1.2.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" mathcolor="#000000" rspace="0.222em" id="alg6.l4.m1.1.2.3.3.2.1" xref="alg6.l4.m1.1.2.3.3.2.1.cmml">×</mo><msubsup id="alg6.l4.m1.1.2.3.3.2.3" xref="alg6.l4.m1.1.2.3.3.2.3.cmml"><mi mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.2.3.2.2" xref="alg6.l4.m1.1.2.3.3.2.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l4.m1.1.2.3.3.2.3.3" xref="alg6.l4.m1.1.2.3.3.2.3.3a.cmml">Inner</mtext><mrow id="alg6.l4.m1.1.1.1.3" xref="alg6.l4.m1.1.2.3.3.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="alg6.l4.m1.1.1.1.3.1" xref="alg6.l4.m1.1.2.3.3.2.3.cmml">(</mo><mi mathcolor="#000000" id="alg6.l4.m1.1.1.1.1" xref="alg6.l4.m1.1.1.1.1.cmml">k</mi><mo mathcolor="#000000" stretchy="false" id="alg6.l4.m1.1.1.1.3.2" xref="alg6.l4.m1.1.2.3.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg6.l4.m1.1b"><apply id="alg6.l4.m1.1.2.cmml" xref="alg6.l4.m1.1.2"><eq id="alg6.l4.m1.1.2.1.cmml" xref="alg6.l4.m1.1.2.1"></eq><apply id="alg6.l4.m1.1.2.2.cmml" xref="alg6.l4.m1.1.2.2"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.2.1.cmml" xref="alg6.l4.m1.1.2.2">subscript</csymbol><ci id="alg6.l4.m1.1.2.2.2.cmml" xref="alg6.l4.m1.1.2.2.2">𝜃</ci><ci id="alg6.l4.m1.1.2.2.3a.cmml" xref="alg6.l4.m1.1.2.2.3"><mtext mathsize="70%" id="alg6.l4.m1.1.2.2.3.cmml" xref="alg6.l4.m1.1.2.2.3">global</mtext></ci></apply><apply id="alg6.l4.m1.1.2.3.cmml" xref="alg6.l4.m1.1.2.3"><times id="alg6.l4.m1.1.2.3.1.cmml" xref="alg6.l4.m1.1.2.3.1"></times><apply id="alg6.l4.m1.1.2.3.2.cmml" xref="alg6.l4.m1.1.2.3.2"><divide id="alg6.l4.m1.1.2.3.2.1.cmml" xref="alg6.l4.m1.1.2.3.2"></divide><cn type="integer" id="alg6.l4.m1.1.2.3.2.2.cmml" xref="alg6.l4.m1.1.2.3.2.2">1</cn><ci id="alg6.l4.m1.1.2.3.2.3a.cmml" xref="alg6.l4.m1.1.2.3.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg6.l4.m1.1.2.3.2.3.cmml" xref="alg6.l4.m1.1.2.3.2.3">NUM_PR</mtext></ci></apply><apply id="alg6.l4.m1.1.2.3.3.cmml" xref="alg6.l4.m1.1.2.3.3"><apply id="alg6.l4.m1.1.2.3.3.1.cmml" xref="alg6.l4.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.3.3.1.1.cmml" xref="alg6.l4.m1.1.2.3.3.1">subscript</csymbol><apply id="alg6.l4.m1.1.2.3.3.1.2.cmml" xref="alg6.l4.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.3.3.1.2.1.cmml" xref="alg6.l4.m1.1.2.3.3.1">superscript</csymbol><sum id="alg6.l4.m1.1.2.3.3.1.2.2.cmml" xref="alg6.l4.m1.1.2.3.3.1.2.2"></sum><ci id="alg6.l4.m1.1.2.3.3.1.2.3a.cmml" xref="alg6.l4.m1.1.2.3.3.1.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg6.l4.m1.1.2.3.3.1.2.3.cmml" xref="alg6.l4.m1.1.2.3.3.1.2.3">NUM_PR</mtext></ci></apply><apply id="alg6.l4.m1.1.2.3.3.1.3.cmml" xref="alg6.l4.m1.1.2.3.3.1.3"><eq id="alg6.l4.m1.1.2.3.3.1.3.1.cmml" xref="alg6.l4.m1.1.2.3.3.1.3.1"></eq><ci id="alg6.l4.m1.1.2.3.3.1.3.2.cmml" xref="alg6.l4.m1.1.2.3.3.1.3.2">𝑘</ci><cn type="integer" id="alg6.l4.m1.1.2.3.3.1.3.3.cmml" xref="alg6.l4.m1.1.2.3.3.1.3.3">1</cn></apply></apply><apply id="alg6.l4.m1.1.2.3.3.2.cmml" xref="alg6.l4.m1.1.2.3.3.2"><times id="alg6.l4.m1.1.2.3.3.2.1.cmml" xref="alg6.l4.m1.1.2.3.3.2.1"></times><apply id="alg6.l4.m1.1.2.3.3.2.2.cmml" xref="alg6.l4.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.3.3.2.2.1.cmml" xref="alg6.l4.m1.1.2.3.3.2.2">subscript</csymbol><ci id="alg6.l4.m1.1.2.3.3.2.2.2.cmml" xref="alg6.l4.m1.1.2.3.3.2.2.2">𝜂</ci><ci id="alg6.l4.m1.1.2.3.3.2.2.3.cmml" xref="alg6.l4.m1.1.2.3.3.2.2.3">𝑘</ci></apply><apply id="alg6.l4.m1.1.2.3.3.2.3.cmml" xref="alg6.l4.m1.1.2.3.3.2.3"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.3.3.2.3.1.cmml" xref="alg6.l4.m1.1.2.3.3.2.3">subscript</csymbol><apply id="alg6.l4.m1.1.2.3.3.2.3.2.cmml" xref="alg6.l4.m1.1.2.3.3.2.3"><csymbol cd="ambiguous" id="alg6.l4.m1.1.2.3.3.2.3.2.1.cmml" xref="alg6.l4.m1.1.2.3.3.2.3">superscript</csymbol><ci id="alg6.l4.m1.1.2.3.3.2.3.2.2.cmml" xref="alg6.l4.m1.1.2.3.3.2.3.2.2">𝜃</ci><ci id="alg6.l4.m1.1.1.1.1.cmml" xref="alg6.l4.m1.1.1.1.1">𝑘</ci></apply><ci id="alg6.l4.m1.1.2.3.3.2.3.3a.cmml" xref="alg6.l4.m1.1.2.3.3.2.3.3"><mtext mathsize="70%" id="alg6.l4.m1.1.2.3.3.2.3.3.cmml" xref="alg6.l4.m1.1.2.3.3.2.3.3">Inner</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l4.m1.1c">\theta_{\text{global}}=\frac{1}{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}\sum^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}_{k=1}\eta_{k}\times\theta^{(k)}_{\text{Inner}}</annotation></semantics></math><span id="alg6.l4.5" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l4.2" class="ltx_text" style="color:#000000;float:right;"><math id="alg6.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l4.1.m1.1a"><mo mathcolor="#000000" id="alg6.l4.1.m1.1.1" xref="alg6.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l4.1.m1.1b"><ci id="alg6.l4.1.m1.1.1.cmml" xref="alg6.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l4.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l4.2.1" class="ltx_text" style="color:#BF8040;"> For some weights <math id="alg6.l4.2.1.m1.1" class="ltx_Math" alttext="\eta_{k}" display="inline"><semantics id="alg6.l4.2.1.m1.1a"><msub id="alg6.l4.2.1.m1.1.1" xref="alg6.l4.2.1.m1.1.1.cmml"><mi mathcolor="#BF8040" id="alg6.l4.2.1.m1.1.1.2" xref="alg6.l4.2.1.m1.1.1.2.cmml">η</mi><mi mathcolor="#BF8040" id="alg6.l4.2.1.m1.1.1.3" xref="alg6.l4.2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg6.l4.2.1.m1.1b"><apply id="alg6.l4.2.1.m1.1.1.cmml" xref="alg6.l4.2.1.m1.1.1"><csymbol cd="ambiguous" id="alg6.l4.2.1.m1.1.1.1.cmml" xref="alg6.l4.2.1.m1.1.1">subscript</csymbol><ci id="alg6.l4.2.1.m1.1.1.2.cmml" xref="alg6.l4.2.1.m1.1.1.2">𝜂</ci><ci id="alg6.l4.2.1.m1.1.1.3.cmml" xref="alg6.l4.2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l4.2.1.m1.1c">\eta_{k}</annotation></semantics></math> </span>
</span>
</span>
<span id="alg6.l5" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l5.2.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg6.l5.3" class="ltx_text ltx_font_bold" style="color:#000000;">else</span><span id="alg6.l5.4" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l5.5" class="ltx_text ltx_font_bold" style="color:#000000;">if</span><span id="alg6.l5.6" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l5.7" class="ltx_text" style="color:#000066;">RUN_OPTION</span><span id="alg6.l5.8" class="ltx_text" style="color:#000000;"> = DiLoCo </span><span id="alg6.l5.9" class="ltx_text ltx_font_bold" style="color:#000000;">then</span><span id="alg6.l5.10" class="ltx_text" style="color:#000000;"> </span><span id="alg6.l5.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg6.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l5.1.m1.1a"><mo mathcolor="#000000" id="alg6.l5.1.m1.1.1" xref="alg6.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l5.1.m1.1b"><ci id="alg6.l5.1.m1.1.1.cmml" xref="alg6.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l5.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l5.1.1" class="ltx_text" style="color:#BF8040;"> Run the Outer part of DiLoCo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> </span>
</span>
</span>
<span id="alg6.l6" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg6.l6.2" class="ltx_text" style="color:#000000;">     </span><math id="alg6.l6.m1.2" class="ltx_Math" alttext="\Delta\theta_{\text{Outer}}=\frac{1}{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}\sum^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}_{k=1}\eta_{k}\times(\theta_{\text{global}}-\theta^{(k)}_{\text{Inner}})" display="inline"><semantics id="alg6.l6.m1.2a"><mrow id="alg6.l6.m1.2.2" xref="alg6.l6.m1.2.2.cmml"><mrow id="alg6.l6.m1.2.2.3" xref="alg6.l6.m1.2.2.3.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg6.l6.m1.2.2.3.2" xref="alg6.l6.m1.2.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg6.l6.m1.2.2.3.1" xref="alg6.l6.m1.2.2.3.1.cmml">​</mo><msub id="alg6.l6.m1.2.2.3.3" xref="alg6.l6.m1.2.2.3.3.cmml"><mi mathcolor="#000000" id="alg6.l6.m1.2.2.3.3.2" xref="alg6.l6.m1.2.2.3.3.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l6.m1.2.2.3.3.3" xref="alg6.l6.m1.2.2.3.3.3a.cmml">Outer</mtext></msub></mrow><mo mathcolor="#000000" id="alg6.l6.m1.2.2.2" xref="alg6.l6.m1.2.2.2.cmml">=</mo><mrow id="alg6.l6.m1.2.2.1" xref="alg6.l6.m1.2.2.1.cmml"><mfrac mathcolor="#000000" id="alg6.l6.m1.2.2.1.3" xref="alg6.l6.m1.2.2.1.3.cmml"><mn mathcolor="#000000" id="alg6.l6.m1.2.2.1.3.2" xref="alg6.l6.m1.2.2.1.3.2.cmml">1</mn><mtext mathcolor="#000066" id="alg6.l6.m1.2.2.1.3.3" xref="alg6.l6.m1.2.2.1.3.3a.cmml">NUM_PR</mtext></mfrac><mo lspace="0em" rspace="0em" id="alg6.l6.m1.2.2.1.2" xref="alg6.l6.m1.2.2.1.2.cmml">​</mo><mrow id="alg6.l6.m1.2.2.1.1" xref="alg6.l6.m1.2.2.1.1.cmml"><msubsup id="alg6.l6.m1.2.2.1.1.2" xref="alg6.l6.m1.2.2.1.1.2.cmml"><mo mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.2.2.2" xref="alg6.l6.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="alg6.l6.m1.2.2.1.1.2.3" xref="alg6.l6.m1.2.2.1.1.2.3.cmml"><mi mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.2.3.2" xref="alg6.l6.m1.2.2.1.1.2.3.2.cmml">k</mi><mo mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.2.3.1" xref="alg6.l6.m1.2.2.1.1.2.3.1.cmml">=</mo><mn mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.2.3.3" xref="alg6.l6.m1.2.2.1.1.2.3.3.cmml">1</mn></mrow><mtext mathcolor="#000066" id="alg6.l6.m1.2.2.1.1.2.2.3" xref="alg6.l6.m1.2.2.1.1.2.2.3a.cmml">NUM_PR</mtext></msubsup><mrow id="alg6.l6.m1.2.2.1.1.1" xref="alg6.l6.m1.2.2.1.1.1.cmml"><msub id="alg6.l6.m1.2.2.1.1.1.3" xref="alg6.l6.m1.2.2.1.1.1.3.cmml"><mi mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.3.2" xref="alg6.l6.m1.2.2.1.1.1.3.2.cmml">η</mi><mi mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.3.3" xref="alg6.l6.m1.2.2.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0.222em" mathcolor="#000000" rspace="0.222em" id="alg6.l6.m1.2.2.1.1.1.2" xref="alg6.l6.m1.2.2.1.1.1.2.cmml">×</mo><mrow id="alg6.l6.m1.2.2.1.1.1.1.1" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="alg6.l6.m1.2.2.1.1.1.1.1.2" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg6.l6.m1.2.2.1.1.1.1.1.1" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.cmml"><msub id="alg6.l6.m1.2.2.1.1.1.1.1.1.2" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.2" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3a.cmml">global</mtext></msub><mo mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.1.1.1.1" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="alg6.l6.m1.2.2.1.1.1.1.1.1.3" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.2" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3a.cmml">Inner</mtext><mrow id="alg6.l6.m1.1.1.1.3" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.cmml"><mo mathcolor="#000000" stretchy="false" id="alg6.l6.m1.1.1.1.3.1" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi mathcolor="#000000" id="alg6.l6.m1.1.1.1.1" xref="alg6.l6.m1.1.1.1.1.cmml">k</mi><mo mathcolor="#000000" stretchy="false" id="alg6.l6.m1.1.1.1.3.2" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo mathcolor="#000000" stretchy="false" id="alg6.l6.m1.2.2.1.1.1.1.1.3" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg6.l6.m1.2b"><apply id="alg6.l6.m1.2.2.cmml" xref="alg6.l6.m1.2.2"><eq id="alg6.l6.m1.2.2.2.cmml" xref="alg6.l6.m1.2.2.2"></eq><apply id="alg6.l6.m1.2.2.3.cmml" xref="alg6.l6.m1.2.2.3"><times id="alg6.l6.m1.2.2.3.1.cmml" xref="alg6.l6.m1.2.2.3.1"></times><ci id="alg6.l6.m1.2.2.3.2.cmml" xref="alg6.l6.m1.2.2.3.2">Δ</ci><apply id="alg6.l6.m1.2.2.3.3.cmml" xref="alg6.l6.m1.2.2.3.3"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.3.3.1.cmml" xref="alg6.l6.m1.2.2.3.3">subscript</csymbol><ci id="alg6.l6.m1.2.2.3.3.2.cmml" xref="alg6.l6.m1.2.2.3.3.2">𝜃</ci><ci id="alg6.l6.m1.2.2.3.3.3a.cmml" xref="alg6.l6.m1.2.2.3.3.3"><mtext mathsize="70%" id="alg6.l6.m1.2.2.3.3.3.cmml" xref="alg6.l6.m1.2.2.3.3.3">Outer</mtext></ci></apply></apply><apply id="alg6.l6.m1.2.2.1.cmml" xref="alg6.l6.m1.2.2.1"><times id="alg6.l6.m1.2.2.1.2.cmml" xref="alg6.l6.m1.2.2.1.2"></times><apply id="alg6.l6.m1.2.2.1.3.cmml" xref="alg6.l6.m1.2.2.1.3"><divide id="alg6.l6.m1.2.2.1.3.1.cmml" xref="alg6.l6.m1.2.2.1.3"></divide><cn type="integer" id="alg6.l6.m1.2.2.1.3.2.cmml" xref="alg6.l6.m1.2.2.1.3.2">1</cn><ci id="alg6.l6.m1.2.2.1.3.3a.cmml" xref="alg6.l6.m1.2.2.1.3.3"><mtext mathcolor="#000066" mathsize="70%" id="alg6.l6.m1.2.2.1.3.3.cmml" xref="alg6.l6.m1.2.2.1.3.3">NUM_PR</mtext></ci></apply><apply id="alg6.l6.m1.2.2.1.1.cmml" xref="alg6.l6.m1.2.2.1.1"><apply id="alg6.l6.m1.2.2.1.1.2.cmml" xref="alg6.l6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.2.1.cmml" xref="alg6.l6.m1.2.2.1.1.2">subscript</csymbol><apply id="alg6.l6.m1.2.2.1.1.2.2.cmml" xref="alg6.l6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.2.2.1.cmml" xref="alg6.l6.m1.2.2.1.1.2">superscript</csymbol><sum id="alg6.l6.m1.2.2.1.1.2.2.2.cmml" xref="alg6.l6.m1.2.2.1.1.2.2.2"></sum><ci id="alg6.l6.m1.2.2.1.1.2.2.3a.cmml" xref="alg6.l6.m1.2.2.1.1.2.2.3"><mtext mathcolor="#000066" mathsize="70%" id="alg6.l6.m1.2.2.1.1.2.2.3.cmml" xref="alg6.l6.m1.2.2.1.1.2.2.3">NUM_PR</mtext></ci></apply><apply id="alg6.l6.m1.2.2.1.1.2.3.cmml" xref="alg6.l6.m1.2.2.1.1.2.3"><eq id="alg6.l6.m1.2.2.1.1.2.3.1.cmml" xref="alg6.l6.m1.2.2.1.1.2.3.1"></eq><ci id="alg6.l6.m1.2.2.1.1.2.3.2.cmml" xref="alg6.l6.m1.2.2.1.1.2.3.2">𝑘</ci><cn type="integer" id="alg6.l6.m1.2.2.1.1.2.3.3.cmml" xref="alg6.l6.m1.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="alg6.l6.m1.2.2.1.1.1.cmml" xref="alg6.l6.m1.2.2.1.1.1"><times id="alg6.l6.m1.2.2.1.1.1.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.2"></times><apply id="alg6.l6.m1.2.2.1.1.1.3.cmml" xref="alg6.l6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.1.3.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="alg6.l6.m1.2.2.1.1.1.3.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.3.2">𝜂</ci><ci id="alg6.l6.m1.2.2.1.1.1.3.3.cmml" xref="alg6.l6.m1.2.2.1.1.1.3.3">𝑘</ci></apply><apply id="alg6.l6.m1.2.2.1.1.1.1.1.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1"><minus id="alg6.l6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.2">𝜃</ci><ci id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.2.3">global</mtext></ci></apply><apply id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg6.l6.m1.1.1.1.1.cmml" xref="alg6.l6.m1.1.1.1.1">𝑘</ci></apply><ci id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3a.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="alg6.l6.m1.2.2.1.1.1.1.1.1.3.3">Inner</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l6.m1.2c">\Delta\theta_{\text{Outer}}=\frac{1}{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}\sum^{{\color[rgb]{0.0,0.0,0.4}\definecolor[named]{pgfstrokecolor}{rgb}{0.0,0.0,0.4}\text{NUM\_PR}}}_{k=1}\eta_{k}\times(\theta_{\text{global}}-\theta^{(k)}_{\text{Inner}})</annotation></semantics></math><span id="alg6.l6.3" class="ltx_text" style="color:#000000;">
</span>
</span>
<span id="alg6.l7" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg6.l7.3" class="ltx_text" style="color:#000000;">     Run Nesterov Momentum: </span><span id="alg6.l7.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg6.l7.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l7.1.m1.1a"><mo mathcolor="#000000" id="alg6.l7.1.m1.1.1" xref="alg6.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l7.1.m1.1b"><ci id="alg6.l7.1.m1.1.1.cmml" xref="alg6.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l7.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l7.1.1" class="ltx_text" style="color:#BF8040;"> See FedMom <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, Algorithm 3]</cite> </span>
</span>
</span>
<span id="alg6.l8" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg6.l8.3" class="ltx_text" style="color:#000000;">     (Periodically) publish </span><span id="alg6.l8.4" class="ltx_text" style="color:#78453B;">Job Feedback (KIND: 7000)</span><span id="alg6.l8.5" class="ltx_text" style="color:#000000;"> with </span><span id="alg6.l8.6" class="ltx_text" style="color:#000066;">STATUS</span><span id="alg6.l8.7" class="ltx_text" style="color:#000000;"> = processing </span><span id="alg6.l8.1" class="ltx_text" style="color:#000000;float:right;"><math id="alg6.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg6.l8.1.m1.1a"><mo mathcolor="#000000" id="alg6.l8.1.m1.1.1" xref="alg6.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg6.l8.1.m1.1b"><ci id="alg6.l8.1.m1.1.1.cmml" xref="alg6.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l8.1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg6.l8.1.1" class="ltx_text" style="color:#BF8040;"> Event Type <a href="#LST4" title="Event Type 4 ‣ Job Feedback (kind:7000) ‣ Job Result (kind: 6000-6999) ‣ Job Chaining ‣ Job Request (AI VMs) ‣ Job Request (DVMs) ‣ 5.1 Distributed Computing on the NOSTR Protocol ‣ 5 Protocol Design for Distributed Computing and AI Directories ‣ FEDSTR (f\textepsilondst\textschwar): Money-In AI-Out A Decentralized Marketplace for Federated Learning and LLM Training on the NOSTR Protocol" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>
</span>
</span>
<span id="alg6.l9" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg6.l9.2" class="ltx_text" style="color:#000000;">     </span><math id="alg6.l9.m1.1" class="ltx_Math" alttext="\theta_{\text{global}}\leftarrow" display="inline"><semantics id="alg6.l9.m1.1a"><mrow id="alg6.l9.m1.1.1" xref="alg6.l9.m1.1.1.cmml"><msub id="alg6.l9.m1.1.1.2" xref="alg6.l9.m1.1.1.2.cmml"><mi mathcolor="#000000" id="alg6.l9.m1.1.1.2.2" xref="alg6.l9.m1.1.1.2.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l9.m1.1.1.2.3" xref="alg6.l9.m1.1.1.2.3a.cmml">global</mtext></msub><mo mathcolor="#000000" stretchy="false" id="alg6.l9.m1.1.1.1" xref="alg6.l9.m1.1.1.1.cmml">←</mo><mi id="alg6.l9.m1.1.1.3" xref="alg6.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l9.m1.1b"><apply id="alg6.l9.m1.1.1.cmml" xref="alg6.l9.m1.1.1"><ci id="alg6.l9.m1.1.1.1.cmml" xref="alg6.l9.m1.1.1.1">←</ci><apply id="alg6.l9.m1.1.1.2.cmml" xref="alg6.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg6.l9.m1.1.1.2.1.cmml" xref="alg6.l9.m1.1.1.2">subscript</csymbol><ci id="alg6.l9.m1.1.1.2.2.cmml" xref="alg6.l9.m1.1.1.2.2">𝜃</ci><ci id="alg6.l9.m1.1.1.2.3a.cmml" xref="alg6.l9.m1.1.1.2.3"><mtext mathsize="70%" id="alg6.l9.m1.1.1.2.3.cmml" xref="alg6.l9.m1.1.1.2.3">global</mtext></ci></apply><csymbol cd="latexml" id="alg6.l9.m1.1.1.3.cmml" xref="alg6.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l9.m1.1c">\theta_{\text{global}}\leftarrow</annotation></semantics></math><span id="alg6.l9.3" class="ltx_text" style="color:#000000;"> Nesterov_Momentum (</span><math id="alg6.l9.m2.1" class="ltx_Math" alttext="\theta_{\text{global}}" display="inline"><semantics id="alg6.l9.m2.1a"><msub id="alg6.l9.m2.1.1" xref="alg6.l9.m2.1.1.cmml"><mi mathcolor="#000000" id="alg6.l9.m2.1.1.2" xref="alg6.l9.m2.1.1.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l9.m2.1.1.3" xref="alg6.l9.m2.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="alg6.l9.m2.1b"><apply id="alg6.l9.m2.1.1.cmml" xref="alg6.l9.m2.1.1"><csymbol cd="ambiguous" id="alg6.l9.m2.1.1.1.cmml" xref="alg6.l9.m2.1.1">subscript</csymbol><ci id="alg6.l9.m2.1.1.2.cmml" xref="alg6.l9.m2.1.1.2">𝜃</ci><ci id="alg6.l9.m2.1.1.3a.cmml" xref="alg6.l9.m2.1.1.3"><mtext mathsize="70%" id="alg6.l9.m2.1.1.3.cmml" xref="alg6.l9.m2.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l9.m2.1c">\theta_{\text{global}}</annotation></semantics></math><span id="alg6.l9.4" class="ltx_text" style="color:#000000;"> , </span><math id="alg6.l9.m3.1" class="ltx_Math" alttext="\Delta\theta_{\text{Outer}}" display="inline"><semantics id="alg6.l9.m3.1a"><mrow id="alg6.l9.m3.1.1" xref="alg6.l9.m3.1.1.cmml"><mi mathcolor="#000000" mathvariant="normal" id="alg6.l9.m3.1.1.2" xref="alg6.l9.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg6.l9.m3.1.1.1" xref="alg6.l9.m3.1.1.1.cmml">​</mo><msub id="alg6.l9.m3.1.1.3" xref="alg6.l9.m3.1.1.3.cmml"><mi mathcolor="#000000" id="alg6.l9.m3.1.1.3.2" xref="alg6.l9.m3.1.1.3.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l9.m3.1.1.3.3" xref="alg6.l9.m3.1.1.3.3a.cmml">Outer</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg6.l9.m3.1b"><apply id="alg6.l9.m3.1.1.cmml" xref="alg6.l9.m3.1.1"><times id="alg6.l9.m3.1.1.1.cmml" xref="alg6.l9.m3.1.1.1"></times><ci id="alg6.l9.m3.1.1.2.cmml" xref="alg6.l9.m3.1.1.2">Δ</ci><apply id="alg6.l9.m3.1.1.3.cmml" xref="alg6.l9.m3.1.1.3"><csymbol cd="ambiguous" id="alg6.l9.m3.1.1.3.1.cmml" xref="alg6.l9.m3.1.1.3">subscript</csymbol><ci id="alg6.l9.m3.1.1.3.2.cmml" xref="alg6.l9.m3.1.1.3.2">𝜃</ci><ci id="alg6.l9.m3.1.1.3.3a.cmml" xref="alg6.l9.m3.1.1.3.3"><mtext mathsize="70%" id="alg6.l9.m3.1.1.3.3.cmml" xref="alg6.l9.m3.1.1.3.3">Outer</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l9.m3.1c">\Delta\theta_{\text{Outer}}</annotation></semantics></math><span id="alg6.l9.5" class="ltx_text" style="color:#000000;">)
</span>
</span>
<span id="alg6.l10" class="ltx_listingline"><span class="ltx_tag ltx_tag_listingline"><span id="alg6.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg6.l10.2" class="ltx_text ltx_font_bold" style="color:#000000;">return</span><span id="alg6.l10.3" class="ltx_text" style="color:#000000;"> </span><math id="alg6.l10.m1.1" class="ltx_Math" alttext="\theta_{\text{global}}" display="inline"><semantics id="alg6.l10.m1.1a"><msub id="alg6.l10.m1.1.1" xref="alg6.l10.m1.1.1.cmml"><mi mathcolor="#000000" id="alg6.l10.m1.1.1.2" xref="alg6.l10.m1.1.1.2.cmml">θ</mi><mtext mathcolor="#000000" id="alg6.l10.m1.1.1.3" xref="alg6.l10.m1.1.1.3a.cmml">global</mtext></msub><annotation-xml encoding="MathML-Content" id="alg6.l10.m1.1b"><apply id="alg6.l10.m1.1.1.cmml" xref="alg6.l10.m1.1.1"><csymbol cd="ambiguous" id="alg6.l10.m1.1.1.1.cmml" xref="alg6.l10.m1.1.1">subscript</csymbol><ci id="alg6.l10.m1.1.1.2.cmml" xref="alg6.l10.m1.1.1.2">𝜃</ci><ci id="alg6.l10.m1.1.1.3a.cmml" xref="alg6.l10.m1.1.1.3"><mtext mathsize="70%" id="alg6.l10.m1.1.1.3.cmml" xref="alg6.l10.m1.1.1.3">global</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l10.m1.1c">\theta_{\text{global}}</annotation></semantics></math><span id="alg6.l10.4" class="ltx_text" style="color:#000000;">
</span>
</span>
</span>
</span>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>

<span id="S8.p1" class="ltx_para">
<span id="S8.p1.1" class="ltx_p">The NOSTR protocol is a relatively new paradigm shift for reliable and decentralized social web applications. In this work we introduced a design and protocol flow for LLM and AI training on decentralized marketplace system, that builds upon the NOSTR. The fast communication though websockets and the flexibility of development of the protocol enables the potential for a competitive, open and censorship resistant computation network, at which users (customers) provide data and a payment, and they receive a trained AI model. The integrated payment protocol flow rules and the lightning network offer fast, reliable and with zero transaction fee payments without a trusted party. As a result, service providers can maximize their profit and compete within an open market. Further, this payment system supports microtranscactions with instant settlement, which is essentially useful as anti-spam mechanism, reliable form of handshaking between customers and service providers, on the fly payments upon receiving partial results of the computation, or upon validation of the final output.</span>
</span>
<span id="S8.p2" class="ltx_para">
<span id="S8.p2.1" class="ltx_p">We considered a simple but effective mechanism for validation of the output, by periodically checking the progress of the trained model through a validation dataset. However, we believe that other alternative solutions for verifying accuracy of the computation may be considered as well. Such robust approaches can be designed by considering smart contracts and the BitVM mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, which enables the possibility of any computable function to be verified. Inclusion of such mechanisms for verification, together with a reputation system, or application specific protocol flow variations for alternative AI algorithms such as DeepSpeed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> &amp; Zero Redundancy Optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> or distributed LLM deployment and inference <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> could be potentially considered tasks for future work.</span>
</span>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Nostr - Notes and Other Stuff Transmitted by Relays.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nostr" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nostr</a>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Artur Briugeman.

</span>
<span class="ltx_bibblock">Nostr real time statistics.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://stats.nostr.band" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://stats.nostr.band</a>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Bluesky architecture.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://docs.bsky.app/docs/advanced-guides/federation-architecture" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://docs.bsky.app/docs/advanced-guides/federation-architecture</a>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Martin Kleppmann, Paul Frazee, Jake Gold, Jay Graber, Daniel Holmgren, Devin Ivy, Jeromy Johnson, Bryan Newbold, and Jaz Volpert.

</span>
<span class="ltx_bibblock">Bluesky and the AT protocol: Usable decentralized social media.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2402.03239</span>, 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Seth Gilbert and Nancy Lynch.

</span>
<span class="ltx_bibblock">Perspectives on the CAP Theorem.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Computer</span>, 45(2):30–36, 2012.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Yiluo Wei and Gareth Tyson.

</span>
<span class="ltx_bibblock">Exploring the nostr ecosystem: A study of decentralization and resilience.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2402.05709</span>, 2024.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Joseph Poon and Thaddeus Dryja.

</span>
<span class="ltx_bibblock">The bitcoin lightning network: Scalable off-chain instant payments.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">https://lightning.network/</span>, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Arthur Douillard, Qixuan Feng, Andrei A Rusu, Rachita Chhaparia, Yani Donchev, Adhiguna Kuncoro, Marc’Aurelio Ranzato, Arthur Szlam, and Jiajun Shen.

</span>
<span class="ltx_bibblock">DiLoCo: Distributed low-communication training of language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2311.08105</span>, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Satoshi Nakamoto.

</span>
<span class="ltx_bibblock">Bitcoin: A peer-to-peer electronic cash system.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Decentralized business review</span>, 2008.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Amir Dembo, Sreeram Kannan, Ertem Nusret Tas, David Tse, Pramod Viswanath, Xuechao Wang, and Ofer Zeitouni.

</span>
<span class="ltx_bibblock">Everything is a race and Nakamoto always wins.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security</span>, pages 859–878, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ying Liu and Karanam Nanda Kishore.

</span>
<span class="ltx_bibblock">Sovereign individual system (sis): An autonomous digital platform for sovereign individuals.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proceedings of the Future Technologies Conference</span>, pages 142–153. Springer, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Nip-19: Nostr - Notes and Other Stuff Transmitted by Relays.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nips/blob/master/19.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nips/blob/master/19.md</a>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Tim Ruffing Pieter Wuille, Jonas Nick.

</span>
<span class="ltx_bibblock">Schnorr signatures for secp256k1.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://bips.xyz/340" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://bips.xyz/340</a>, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Ewa Deelman.

</span>
<span class="ltx_bibblock">Mapping abstract complex workflows onto grid environments.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Journal of Grid Computing</span>, 1(1):25–39, 2003.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Ian Taylor, Matthew Shields, and Dr Wang.

</span>
<span class="ltx_bibblock">Resource management of triana p2p services.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Grid Resource Management</span>, 01 2003.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
D.P. Anderson, E. Korpela, and R. Walton.

</span>
<span class="ltx_bibblock">High-performance task distribution for volunteer computing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">First International Conference on e-Science and Grid Computing (e-Science’05)</span>, pages 8 pp.–203, 2005.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
David P. Anderson.

</span>
<span class="ltx_bibblock">Boinc: A platform for volunteer computing.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Journal of Grid Computing</span>, 18(1):99–122, November 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
The gridcoin network and protocol overview.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Anatoly Yakovenko.

</span>
<span class="ltx_bibblock">Solana: A new architecture for a high performance blockchain v0. 8.13.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Whitepaper</span>, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Nostr Apps.

</span>
<span class="ltx_bibblock">Nostr apps.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.nostrapps.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nostrapps.com/</a>, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Data Vending Machines.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/data-vending-machines" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/data-vending-machines</a>, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">VenData.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://vendata.io" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://vendata.io</a>, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Gregory Maxwell, Andrew Poelstra, Yannick Seurin, and Pieter Wuille.

</span>
<span class="ltx_bibblock">Simple schnorr multi-signatures with applications to bitcoin.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Designs, Codes and Cryptography</span>, 87(9):2139–2164, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Nip-90: Nostr - Notes and Other Stuff Transmitted by Relays.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nips/blob/master/90.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nips/blob/master/90.md</a>, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Andreas M Antonopoulos, Olaoluwa Osuntokun, and René Pickhardt.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Mastering the lightning network</span>.

</span>
<span class="ltx_bibblock">" O’Reilly Media, Inc.", 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Rene Pickhardt Andreas M. Antonopoulos, Olaoluwa Osuntokun.

</span>
<span class="ltx_bibblock">Lightning payment requests.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/lnbook/lnbook/blob/develop/15_payment_requests.asciidoc" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/lnbook/lnbook/blob/develop/15_payment_requests.asciidoc</a>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">NOSTR Implementation Possibillities, 89.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nips/blob/master/89.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nips/blob/master/89.md</a>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
John Joseph O’Hare, Allen Fairchild, and Umran Ali.

</span>
<span class="ltx_bibblock">Money &amp; trust in digital society: Bitcoin, nostr, stablecoins, digital objects and generative ai in b2b spatial mixed reality.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2207.09460</span>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Jérémy Robert, Sylvain Kubler, and Sankalp Ghatpande.

</span>
<span class="ltx_bibblock">Enhanced lightning network (off-chain)-based micropayment in iot ecosystems.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Future Generation Computer Systems</span>, 112:283–296, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">NOSTR Implementation Possibillities, 57.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nips/blob/master/57.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nips/blob/master/57.md</a>, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Nostr Zap.

</span>
<span class="ltx_bibblock">Jeffg.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://nostr.how/en/zaps" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://nostr.how/en/zaps</a>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Lnurl.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/GaloyMoney/lnurl-pay" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/GaloyMoney/lnurl-pay</a>, 2023.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Public domain.

</span>
<span class="ltx_bibblock">Nip-01: Nostr - Notes and Other Stuff Transmitted by Relays.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/nostr-protocol/nips/blob/master/01.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/nostr-protocol/nips/blob/master/01.md</a>, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Arjun Nitin Bhagoji, Supriyo Chakraborty, Prateek Mittal, and Seraphin Calo.

</span>
<span class="ltx_bibblock">Analyzing federated learning through an adversarial lens.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri and Ruslan Salakhutdinov, editors, <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</span>, volume 97 of <span id="bib.bib35.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 634–643. PMLR, 09–15 Jun 2019.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Matteo Demartis.

</span>
<span class="ltx_bibblock">Adversarial attacks in federated learning, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Mayank Rathee, Conghao Shen, Sameer Wagh, and Raluca Ada Popa.

</span>
<span class="ltx_bibblock">Elsa: Secure aggregation for federated learning with malicious actors.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">2023 IEEE Symposium on Security and Privacy (SP)</span>, pages 1961–1979. IEEE, 2023.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Sana Awan, Bo Luo, and Fengjun Li.

</span>
<span class="ltx_bibblock">Contra: Defending against poisoning attacks in federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Computer Security–ESORICS 2021: 26th European Symposium on Research in Computer Security, Darmstadt, Germany, October 4–8, 2021, Proceedings, Part I 26</span>, pages 455–475. Springer, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1711.05101</span>, 2017.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Zhouyuan Huo, Qian Yang, Bin Gu, Lawrence Carin Huang, et al.

</span>
<span class="ltx_bibblock">Faster on-device training using new federated momentum algorithm.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.02090</span>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Robin Linus.

</span>
<span class="ltx_bibblock">Bitvm: Compute anything on bitcoin.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">bitvm.org</span>, 2023.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and Yuxiong He.

</span>
<span class="ltx_bibblock">Deepspeed: System optimizations enable training deep learning models with over 100 billion parameters.

</span>
<span class="ltx_bibblock">In <span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</span>, pages 3505–3506, 2020.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Samyam Rajbhandari, Jeff Rasley, Olatunji Ruwase, and Yuxiong He.

</span>
<span class="ltx_bibblock">Zero: Memory optimizations toward training trillion parameter models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">SC20: International Conference for High Performance Computing, Networking, Storage and Analysis</span>, pages 1–16. IEEE, 2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Tao Fan, Yan Kang, Guoqiang Ma, Weijing Chen, Wenbin Wei, Lixin Fan, and Qiang Yang.

</span>
<span class="ltx_bibblock">Fate-LLM: A industrial grade federated learning framework for large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2310.10049</span>, 2023.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Lin Lu, Chenxi Dai, Wangcheng Tao, Binhang Yuan, Yanan Sun, and Pan Zhou.

</span>
<span class="ltx_bibblock">Exploring the robustness of decentralized training for large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2312.00843</span>, 2023.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Zhenheng Tang, Yuxin Wang, Xin He, Longteng Zhang, Xinglin Pan, Qiang Wang, Rongfei Zeng, Kaiyong Zhao, Shaohuai Shi, Bingsheng He, et al.

</span>
<span class="ltx_bibblock">Fusionai: Decentralized training and deploying LLMs with massive consumer-level gpus.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2309.01172</span>, 2023.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Amey Agrawal, Ashish Panwar, Jayashree Mohan, Nipun Kwatra, Bhargav S Gulavani, and Ramachandran Ramjee.

</span>
<span class="ltx_bibblock">Sarathi: Efficient LLM inference by piggybacking decodes with chunked prefills.

</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2308.16369</span>, 2023.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Haihao Shen, Hanwen Chang, Bo Dong, Yu Luo, and Hengyu Meng.

</span>
<span class="ltx_bibblock">Efficient LLM inference on cpus.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2311.00502</span>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Benjamin Spector and Chris Re.

</span>
<span class="ltx_bibblock">Accelerating LLM inference with staged speculative decoding.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2308.04623</span>, 2023.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Tianle Cai, Yuhong Li, Zhengyang Geng, Hongwu Peng, Jason D Lee, Deming Chen, and Tri Dao.

</span>
<span class="ltx_bibblock">Medusa: Simple LLM inference acceleration framework with multiple decoding heads.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2401.10774</span>, 2024.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Luciano Del Corro, Allie Del Giorno, Sahaj Agarwal, Bin Yu, Ahmed Awadallah, and Subhabrata Mukherjee.

</span>
<span class="ltx_bibblock">Skipdecode: Autoregressive skip decoding with batching and caching for efficient LLM inference.

</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2307.02628</span>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</section>
</section>
</span>
</span>
</section>
</span>
</span>
</section>
</section>
</section>
</span></span>
</span>
</section>
</span></span>
</span>
</section>
</span></span>
</span>
</section>
</section>
</span>
</span>
</section>
</span></p>
</div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.15833" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.15834" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.15834">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.15834" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.15835" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 21:40:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
