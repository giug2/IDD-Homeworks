<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Collaborative Cross-modal Fusion with Large Language Model for Recommendation</title>
<!--Generated on Fri Aug 16 06:47:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Large Language Models; Recommendation Systems; Cross-modal; Collaborative Filtering" lang="en" name="keywords"/>
<base href="/html/2408.08564v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S1" title="In Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S2" title="In Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S2.SS0.SSS0.Px1" title="In 2. Related Work ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">CF-based Recommendation System</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S2.SS0.SSS0.Px2" title="In 2. Related Work ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">LLM4Rec Approaches</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3" title="In Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS1" title="In 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS1.SSS0.Px1" title="In 3.1. Preliminaries ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Task Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS1.SSS0.Px2" title="In 3.1. Preliminaries ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Conventional CF-based recommendation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS2" title="In 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Hybrid Prompt Translation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS3" title="In 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Attentive Cross-modal Fusion Strategy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS3.SSS0.Px1" title="In 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Mapping Phase</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS3.SSS0.Px2" title="In 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Fusion Phase</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS4" title="In 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Training</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS4.SSS0.Px1" title="In 3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Learning Objectives</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS4.SSS0.Px2" title="In 3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Two-stage Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS5" title="In 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Comparison to Existing Work</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS5.SSS0.Px1" title="In 3.5. Comparison to Existing Work ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS5.SSS0.Px2" title="In 3.5. Comparison to Existing Work ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Hybrid Prompt Translation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS5.SSS0.Px3" title="In 3.5. Comparison to Existing Work ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Mapping and Fusion of Two Modalities</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4" title="In Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experiment Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1.SSS0.Px1" title="In 4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1.SSS0.Px2" title="In 4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Evaluation Metric</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1.SSS0.Px3" title="In 4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1.SSS0.Px4" title="In 4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Impelmentation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS2" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Pilot Study (RQ1)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS2.SSS0.Px1" title="In 4.2. Pilot Study (RQ1) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Experiment Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS2.SSS0.Px2" title="In 4.2. Pilot Study (RQ1) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Results and Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS3" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Main Results of <span class="ltx_text ltx_font_smallcaps">CCF-LLM</span> (RQ2)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS3.SSS0.Px1" title="In 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Experiment Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS3.SSS0.Px2" title="In 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Results and Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS4" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Study (RQ3)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS4.SSS0.Px1" title="In 4.4. Ablation Study (RQ3) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Experiment Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS4.SSS0.Px2" title="In 4.4. Ablation Study (RQ3) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Results and Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS5" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Model Analyses (RQ4)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS5.SSS0.Px1" title="In 4.5. Model Analyses (RQ4) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Training Steps</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS5.SSS0.Px2" title="In 4.5. Model Analyses (RQ4) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title">Visualization of Cross-modal Fusion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS6" title="In 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S5" title="In Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Collaborative Cross-modal Fusion with Large Language Model for Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhongzhou Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Singapore Management University</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zzliu.2020@phdcs.smu.edu.sg">zzliu.2020@phdcs.smu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Nanyang Technological University</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2">Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hzhang26@outlook.com">hzhang26@outlook.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kuicai Dong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Nanyang Technological University</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2">Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:%20kuicai001@e.ntu.edu.sg"> kuicai001@e.ntu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuan Fang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Singapore Management University</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2">Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:%20yfang@smu.edu.sg"> yfang@smu.edu.sg</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id9.id1">Despite the success of conventional collaborative filtering (CF) approaches for recommendation systems, they exhibit limitations in leveraging semantic knowledge within the textual attributes of users and items. Recent focus on the application of large language models for recommendation (LLM4Rec) has highlighted their capability for effective semantic knowledge capture. However, these methods often overlook the collaborative signals in user behaviors. Some simply instruct-tune a language model, while others directly inject the embeddings of a CF-based model, lacking a synergistic fusion of different modalities. To address these issues, we propose a framework of <span class="ltx_text ltx_font_bold" id="id9.id1.1">C</span>ollaborative <span class="ltx_text ltx_font_bold" id="id9.id1.2">C</span>ross-modal <span class="ltx_text ltx_font_bold" id="id9.id1.3">F</span>usion with <span class="ltx_text ltx_font_bold" id="id9.id1.4">L</span>arge <span class="ltx_text ltx_font_bold" id="id9.id1.5">L</span>anguage <span class="ltx_text ltx_font_bold" id="id9.id1.6">M</span>odels, termed <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="id9.id1.7">CCF-LLM</span>, for recommendation.
In this framework, we translate the user-item interactions into a hybrid prompt to encode both semantic knowledge and collaborative signals, and then employ an attentive cross-modal fusion strategy to effectively fuse latent embeddings of both modalities.
Extensive experiments demonstrate that <span class="ltx_text ltx_font_smallcaps" id="id9.id1.8">CCF-LLM</span> outperforms existing methods by effectively utilizing semantic and collaborative signals in the LLM4Rec context.</p>
</div>
<div class="ltx_keywords">Large Language Models; Recommendation Systems; Cross-modal; Collaborative Filtering
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management; October 21–25, 2024; Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management (CIKM ’24), October 21–25, 2024, Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679596</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Users and interactive retrieval</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Collaborative filtering</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Collaborative filtering (CF)-based recommendation systems, which aim to learn users’ preferences from historical user-item interactions, have demonstrated significant success across multiple domains <cite class="ltx_cite ltx_citemacro_citep">(Keller et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib25" title="">1985</a>; Deshpande and Karypis, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib11" title="">2004</a>; Brand, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib4" title="">2003</a>; Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib37" title="">2010</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib17" title="">2017</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib16" title="">2020</a>)</cite>.
Their success is attributed to effectively modeling the collaborative signal that encapsulates similarities among user-user, item-item, and user-item co-occurrences <cite class="ltx_cite ltx_citemacro_citep">(Su and Khoshgoftaar, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib41" title="">2009</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib6" title="">2018</a>)</cite>.
However, traditional CF models still struggle to process the rich semantic knowledge in users’ and items’ textual features <cite class="ltx_cite ltx_citemacro_citep">(Moshfeghi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib35" title="">2011</a>)</cite>, urging the development of more advanced models with semantic awareness.
Recently, large language models (LLMs) <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib42" title="">2023</a>; Zeng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib49" title="">2023</a>; Achiam et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib2" title="">2023</a>)</cite> have demonstrated their remarkable capabilities in many tasks, given their strong capacity for assimilating human knowledge about society and the physical world. Motivated by the power of LLMs, numerous researchers are exploring their potential in recommendation systems, referred to as LLM4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib22" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib33" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib32" title="">2024</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="404" id="S1.F1.g1" src="x1.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>An illustration of heterogeneous characteristics between the semantic knowledge from LLMs and the collaborative signals from conventional recommendation systems.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Initial efforts <cite class="ltx_cite ltx_citemacro_citep">(Wang and Lim, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib44" title="">2023</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib18" title="">2023</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib20" title="">2024</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib50" title="">2021</a>; Lyu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib34" title="">2024</a>; Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib23" title="">2024</a>)</cite> try to transform user-item interactions into natural language sequences and then instruct LLMs to conduct zero-shot recommendations. However, these approaches usually underperform conventional CF-based systems, <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">e.g.,</em> standard matrix factorization (MF) models <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib27" title="">2009</a>)</cite>. Although LLMs are proficient in grasping the semantic knowledge of users’ or items’ textual attributes, solely relying on semantic relatedness is inadequate for modeling user preferences. This limitation stems from the focus of LLMs on semantic similarities, overlooking the collaborative signals.
Taking the well-known “<span class="ltx_text ltx_font_italic" id="S1.p2.1.2">Beer and Diapers</span>” story as an example<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We use this classical example only for illustrating the limitations of LLMs. We will present a more detailed case study on real-world data in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS6" title="4.6. Case Study ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.6</span></a>.</span></span></span>, beer and diapers indeed are semantically unrelated products but often co-occur in a single transaction <cite class="ltx_cite ltx_citemacro_citep">(Holt and Chung, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib19" title="">1999</a>)</cite>, where such co-occurrence relationship can be easily modeled via collaborative signals. Thus, we posit that the collaborative signal is essential for LLM4Rec. In its absence, LLMs cannot effectively leverage and exploit historical user-item interactions solely from textual descriptions, leading to inaccurate user preference modeling.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the heterogeneous characteristics that diverge between semantic knowledge and collaborative signals.
LLMs are typically trained to capture the semantic knowledge among users and items based on their textual attributes, whereas CF-based systems are trained to model co-occurring correlations based on the patterns of user behaviors.
Due to their different training data and objectives, collaborative signals can be exploited to complement semantic knowledge.
As a result, recent studies <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib13" title="">2022</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite> have explored the incorporation of collaborative signals into LLMs through two primary approaches: (i) transforming user-item interactions into natural language descriptions, or (ii) directly integrating collaborative embeddings into LLMs.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">(i) <span class="ltx_text ltx_font_italic" id="S1.p4.2.1">Collaborative Signals in Natural Language Descriptions.</span>
Some recent work has attempted to integrate the collaborative signals into LLMs by converting them into natural language descriptions. These approaches <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib13" title="">2022</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>)</cite> train or use instruct-tuning on LLMs with the language descriptions of collaborative signals, which implicitly capture such signals during the training process. Specifically, each instance of user-item interaction is processed as a sentence, <em class="ltx_emph ltx_font_italic" id="S1.p4.2.2">e.g.,</em> “Will user <math alttext="u" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_u</annotation></semantics></math> like item <math alttext="i" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_i</annotation></semantics></math>?”, followed by a “Yes” or “No” response as the optimization objective. However, the improvement of these methods is marginal compared to CF-based methods.
The primary reason is that the user-item interactions, as described in unstructured natural language, cannot effectively instruct the LLM to understand the non-linear, high-order correlation concealed in the huge and sparse co-occurrence logs.
In contrast, CF-based systems explicitly model the correlation in a structured manner.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">(ii) <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">Collaborative Signals in Embeddings</span>.
Some approaches attempt to directly insert latent representations of the collaborative signals into the prompts <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite>. For instance, both LLaRA <cite class="ltx_cite ltx_citemacro_citep">(Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite> and CoLLM <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite> represent each item as <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.2">[text_i][emb_i]</span>, where <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.3">[text_i]</span> denotes the textual attributes of item <math alttext="i" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_i</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S1.p5.1.4">e.g.</span>, “Titanic”), and <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.5">[emb_i]</span> is to be replaced by the item embedding extracted from a CF-based model such as LightGCN <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib16" title="">2020</a>)</cite>. That is, these approaches directly inject the embeddings of collaborative signals into the input sequence of LLMs along with the semantic token embeddings.
However, LLMs may not effectively understand the collaborative signals in this form, as the semantic and CF embeddings are from two disparate modalities and reside in two distinct spaces.
Consequently, such a naïve injection leads to only a marginal improvement.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.2">In this paper, we argue that current LLM4Rec methods do not fully leverage the collaborative signals for recommendation due to two major challenges: (1) <span class="ltx_text ltx_font_italic" id="S1.p6.2.1">How to design an input template to assist LLMs in effectively assimilating the collaborative signals</span>; and (2) <span class="ltx_text ltx_font_italic" id="S1.p6.2.2">how to synergistically align and fuse two different modalities capturing semantic knowledge and collaborative signals?</span>
To tackle these challenges, we propose a framework of <span class="ltx_text ltx_font_bold" id="S1.p6.2.3">C</span>ollaborative <span class="ltx_text ltx_font_bold" id="S1.p6.2.4">C</span>ross-modal <span class="ltx_text ltx_font_bold" id="S1.p6.2.5">F</span>usion with <span class="ltx_text ltx_font_bold" id="S1.p6.2.6">L</span>arge <span class="ltx_text ltx_font_bold" id="S1.p6.2.7">L</span>anguage <span class="ltx_text ltx_font_bold" id="S1.p6.2.8">M</span>odels for recommendation (<span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p6.2.9">CCF-LLM</span>) that can adaptively fuse semantic knowledge with collaborative signals.
To mitigate the first challenge, we propose a hybrid prompt translation step to translate user-item interactions into a prompt sequence that encodes collaborative signals and semantic knowledge. Though existing approaches <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite> also encode the two modalities within a prompt, they use two separate tokens for each item to capture the semantic knowledge and collaborative signals, respectively, decoupling
the two modalities.
On the contrary, we employ a <em class="ltx_emph ltx_font_italic" id="S1.p6.2.10">single</em> token to capture both modalities simultaneously, paving the way for the subsequent multi-modal fusion.
To address the second challenge, we propose an attentive cross-modal fusion strategy to fuse information from the two modalities.
Inspired by the cross-gate mechanism <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib40" title="">2015</a>)</cite>, we propose a <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">typewriter_GATE</annotation></semantics></math> network to fuse the two modalities effectively. With the <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><mi id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><ci id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">typewriter_GATE</annotation></semantics></math> network, the fusion process can be optimized adaptively in a finer dimension-wise granularity with more flexibility.
Compared to previous LLM4Rec systems, <span class="ltx_text ltx_font_smallcaps" id="S1.p6.2.11">CCF-LLM</span> makes better use of collaborative signals to achieve optimal recommendation results.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In summary, we highlight our contributions as stated below.
(1) We underscore the significance of integrating both semantic and collaborative signals into LLM4Rec. In particular, in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS2" title="4.2. Pilot Study (RQ1) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.2</span></a> we empirically illustrate the limitations of capturing collaborative signals using solely natural language descriptions. (2) We propose <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.1">CCF-LLM</span>, a novel framework that enhances the current LLM4Rec paradigm through translating user-item interactions into a hybrid prompt sequence, and further mapping the prompt into the LLM and CF embedding spaces for cross-modal fusion.
(3) We conduct extensive experiments on two public datasets. The experimental results demonstrate the importance of integrating collaborative signals and the effectiveness of <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.2">CCF-LLM</span>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we provide a literature review pertaining to CF-based recommendation systems and LLM4Rec approaches. Our work is inspired by them in combining CF and LLM embeddings for cross-modal fusion.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">CF-based Recommendation System</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">The conventional scheme of collaborative filtering (CF)-based recommendation systems involves extracting the user-user and item-item similarities from users’ historical interactions and predicting relatedness scores between user-item pairs <cite class="ltx_cite ltx_citemacro_citep">(Keller et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib25" title="">1985</a>; Deshpande and Karypis, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib11" title="">2004</a>; Brand, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib4" title="">2003</a>; Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib37" title="">2010</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib17" title="">2017</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib16" title="">2020</a>)</cite>. The fundamental assumption of collaborative filtering is that if two users have similar ratings or behaviors on the same items, they will also have similar ratings or behaviors on other items <cite class="ltx_cite ltx_citemacro_citep">(Su and Khoshgoftaar, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib41" title="">2009</a>)</cite>. Though CF has achieved great successes in various domains, the conventional CF-based models still face certain limitations. One of the key issues is that they ignore the rich semantic knowledge within users’ and items’ textual attributes, which significantly limits the generalizability and recommendation capacity of these models <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib39" title="">2014</a>)</cite>. To overcome this limitation, many works incorporate auxiliary information into their modeling process, such as social network <cite class="ltx_cite ltx_citemacro_citep">(Konstas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib26" title="">2009</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib47" title="">2012</a>)</cite>, comments and reviews <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib36" title="">2021</a>)</cite>, multi-behavior interactions <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib8" title="">2018</a>)</cite> and knowledge graphs <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib45" title="">2019</a>)</cite>. While external knowledge can provide some help, the capacity of these models is restricted by the availability of training data, lacking open-world knowledge and reasoning capability.
Moreover, not all types of external knowledge can be generalized to different domains.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">LLM4Rec Approaches</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Recently there has been a growing trend in utilizing large language models (LLMs) for recommendation. Having been pre-trained on a large number of corpora with billions of parameters, LLMs can potentially answer queries for recommendation directly. It has been demonstrated that LLMs can learn to solve unseen tasks through just a few carefully designed instructions, using their inherent reasoning strength and open-world knowledge <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib5" title="">2020</a>)</cite>. They usually take queries and target users’ historical records in natural languages as input and output the recommendation results <cite class="ltx_cite ltx_citemacro_citep">(Wang and Lim, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib44" title="">2023</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib18" title="">2023</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib20" title="">2024</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib50" title="">2021</a>; Lyu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib34" title="">2024</a>; Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib23" title="">2024</a>)</cite>. Note that due to the gap between the pre-training objective and downstream recommendation task, the recommendation performance is often unsatisfactory under zero-shot settings <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib31" title="">2023</a>)</cite>. To solve this problem, a popular trend is to integrate collaborative signals into LLMs to enhance their performance. One way is to conduct instruct-tuning on a pre-trained language model on recommendation tasks <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib13" title="">2022</a>; Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib10" title="">2022</a>; Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib48" title="">2023</a>)</cite>. In their tuning paradigm, each prompt consists of a prompt input and a prompt output. They fed the prompt input to an LLM and optimized it by minimizing the loss between the generated output and prompt output. The prompt input usually contains a fixed task description and personalized input data for a user. The input data can be the user’s historical behavior <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>; Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib10" title="">2022</a>)</cite> or knowledge related to the user’s behavior <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib48" title="">2023</a>)</cite>. Other than fine-tuning, P5 <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib13" title="">2022</a>)</cite> trains a BERT model <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib12" title="">2019</a>)</cite> from scratch to let it adapt to multiple recommendation tasks, which performs well in certain conditions.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">Though the above methods have demonstrated the capabilities of LLMs for recommendation, they failed to explicitly leverage the collaborative signals, which are usually represented by latent user/item embeddings in a CF-based model. Only very few methods have considered this issue <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib29" title="">2023b</a>)</cite>, and tried to feed both CF and LLM embeddings as input to an LLM. What they did was simply inject the CF embeddings at the LLM’s input embedding sequence. To realize the injection, they first align the CF embeddings to the identical dimension as LLM embeddings and then map the pre-defined placeholders to the aligned CF embeddings. However, the naïve injection would suffer from an inconsistency between the semantic and collaborative signals, resulting in negative impact on the recommendation performance. In contrast, our work proposes to fuse the two modalities adaptively to reconcile the inconsistency, which helps LLMs fully leverage and integrate collaborative signals for recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="385" id="S3.F2.g1" src="x2.png" width="730"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The overall framework of the proposed Collaborative Cross-modal Fusion with Large Language Model (<span class="ltx_text ltx_font_smallcaps" id="S3.F2.2.1">CCF-LLM</span>).
</figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The overall framework of <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">CCF-LLM</span> is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
Firstly, it translates the user-item interactions into hybrid prompt sequences (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>a), which encodes heterogeneous modalities from collaborative signals and semantic knowledge.
Subsequently, it utilizes an attentive cross-modal fusion strategy (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>b) to fuse these heterogeneous modalities.
This includes a mapping phase to map the tokens in hybrid prompt to LLM or CF embeddings accordingly (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>b-1), and a fusion phase to adaptively align and fuse the heterogeneous embeddings via a <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">typewriter_GATE</annotation></semantics></math> network (as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>b-2).
The fully fused latent embeddings are integrated with an LLM for recommendation.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">In Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS1" title="3.1. Preliminaries ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we elaborate the preliminaries for the recommendation task.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS2" title="3.2. Hybrid Prompt Translation ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we explain our hybrid prompt translation step.
Following this, we explain the attentive cross-modal strategy in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS3" title="3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>, and summarize the novelty of <span class="ltx_text ltx_font_smallcaps" id="S3.p2.1.1">CCF-LLM</span> in terms of the motivation and techniques, compared to existing works. Finally, we present the training steps in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS4" title="3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Preliminaries</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Task Formulation</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.11">We address the click-through rate (CTR) prediction task.
CTR prediction is the task of predicting the likelihood of a person clicking on an advertisement or item.
The CTR prediction is typically formulated as a supervised binary classification task.
This usually involves a set of users <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.1d">caligraphic_U</annotation></semantics></math> and items <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1d">caligraphic_I</annotation></semantics></math>. Each instance of user-item interaction is represented as a triplet <math alttext="(u,i,y)" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.3"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.3a"><mrow id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2.1" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml">(</mo><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">u</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p1.3.m3.2.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p1.3.m3.3.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.3.cmml">y</mi><mo id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2.4" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.3b"><vector id="S3.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.4.2"><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.2.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.3.3">𝑦</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.3c">(u,i,y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.3d">( italic_u , italic_i , italic_y )</annotation></semantics></math>, where <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">u</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1"><in id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> represents a user, <math alttext="i\in\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1"><in id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2">𝑖</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.1c">i\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.5.m5.1d">italic_i ∈ caligraphic_I</annotation></semantics></math> denotes an item, and <math alttext="y\in\{0,1\}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.6.m6.2"><semantics id="S3.SS1.SSS0.Px1.p1.6.m6.2a"><mrow id="S3.SS1.SSS0.Px1.p1.6.m6.2.3" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.2.cmml">y</mi><mo id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.1" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.1.cmml">∈</mo><mrow id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.1.cmml">{</mo><mn id="S3.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">0</mn><mo id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.2.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S3.SS1.SSS0.Px1.p1.6.m6.2.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.2.cmml">1</mn><mo id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.2.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.6.m6.2b"><apply id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3"><in id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.1"></in><ci id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.2">𝑦</ci><set id="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.3.3.2"><cn id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1">0</cn><cn id="S3.SS1.SSS0.Px1.p1.6.m6.2.2.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.6.m6.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.6.m6.2c">y\in\{0,1\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.6.m6.2d">italic_y ∈ { 0 , 1 }</annotation></semantics></math> indicates the groundtruth interaction status (i.e., clicked or not clicked). Given the feature <math alttext="\mathtt{x}_{u}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS1.SSS0.Px1.p1.7.m7.1a"><msub id="S3.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2">𝚡</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.7.m7.1c">\mathtt{x}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.7.m7.1d">typewriter_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> of the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS1.SSS0.Px1.p1.8.m8.1a"><mi id="S3.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.8.m8.1b"><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.8.m8.1d">italic_u</annotation></semantics></math> and feature <math alttext="\mathtt{x}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S3.SS1.SSS0.Px1.p1.9.m9.1a"><msub id="S3.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.9.m9.1b"><apply id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2">𝚡</ci><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.9.m9.1c">\mathtt{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.9.m9.1d">typewriter_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of the item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS1.SSS0.Px1.p1.10.m10.1a"><mi id="S3.SS1.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.10.m10.1b"><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.10.m10.1d">italic_i</annotation></semantics></math>, the goal of a CTR model is to accurately fit and predict the posterior probability <math alttext="P(y|\mathtt{x}_{u},\mathtt{x}_{i})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS1.SSS0.Px1.p1.11.m11.1a"><mrow id="S3.SS1.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.3" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml">P</mi><mo id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.2" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.4" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.4.cmml">y</mi><mo fence="false" id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.3" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.11.m11.1b"><apply id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1"><times id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.2"></times><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.3">𝑃</ci><apply id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.3">conditional</csymbol><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.4">𝑦</ci><list id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2"><apply id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.2">𝚡</ci><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.2">𝚡</ci><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.11.m11.1c">P(y|\mathtt{x}_{u},\mathtt{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.11.m11.1d">italic_P ( italic_y | typewriter_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , typewriter_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Conventional CF-based recommendation.</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.9">A conventional CF-based recommendation system aims to predict the interaction status given the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.1.m1.1d">italic_l</annotation></semantics></math>-dimensional embeddings representing the collaborative signals <math alttext="\mathtt{x}^{CF}_{u}\in\mathbb{R}^{l}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.1a"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.3.cmml">u</mi><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1"><in id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1"></in><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3"><times id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.3">𝑢</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.1c">\mathtt{x}^{CF}_{u}\in\mathbb{R}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.2.m2.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.3.m3.1d">italic_u</annotation></semantics></math> and <math alttext="\mathtt{x}^{CF}_{i}\in\mathbb{R}^{l}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml"><msubsup id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1"><in id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1"></in><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3"><times id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">\mathtt{x}^{CF}_{i}\in\mathbb{R}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.4.m4.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> for item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.5.m5.1d">italic_i</annotation></semantics></math>. In most conventional CF-based recommendation models like NCF <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib17" title="">2017</a>)</cite> and LightGCN <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib16" title="">2020</a>)</cite>, the embeddings <math alttext="\mathtt{x}^{CF}_{u}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><msubsup id="S3.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml">u</mi><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3"><times id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">\mathtt{x}^{CF}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.6.m6.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathtt{x}^{CF}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS1.SSS0.Px2.p1.7.m7.1a"><msubsup id="S3.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml">i</mi><mrow id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3"><times id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.7.m7.1c">\mathtt{x}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.7.m7.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are derived from the encoding network <math alttext="\mathsf{ENC}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS1.SSS0.Px2.p1.8.m8.1a"><mi id="S3.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.cmml">𝖤𝖭𝖢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.8.m8.1b"><ci id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1">𝖤𝖭𝖢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.8.m8.1c">\mathsf{ENC}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.8.m8.1d">sansserif_ENC</annotation></semantics></math> with the trainable parameters <math alttext="\Theta_{\mathsf{E}}=\left\{\Theta_{\mathsf{E}}^{\mathsf{U}},\Theta_{\mathsf{E}%
}^{\mathsf{I}}\right\}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.9.m9.2"><semantics id="S3.SS1.SSS0.Px2.p1.9.m9.2a"><mrow id="S3.SS1.SSS0.Px2.p1.9.m9.2.2" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.cmml"><msub id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.cmml"><mi id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.3.cmml">𝖤</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.3.cmml">=</mo><mrow id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.3.cmml">{</mo><msubsup id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.3.cmml">𝖤</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.3.cmml">𝖴</mi></msubsup><mo id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.4" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.3.cmml">𝖤</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.3.cmml">𝖨</mi></msubsup><mo id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.5" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.9.m9.2b"><apply id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2"><eq id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.3"></eq><apply id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.4.3">𝖤</ci></apply><set id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2"><apply id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.2.3">𝖤</ci></apply><ci id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.1.1.3">𝖴</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.2.3">𝖤</ci></apply><ci id="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.2.2.2.2.2.3">𝖨</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.9.m9.2c">\Theta_{\mathsf{E}}=\left\{\Theta_{\mathsf{E}}^{\mathsf{U}},\Theta_{\mathsf{E}%
}^{\mathsf{I}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.9.m9.2d">roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT = { roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_U end_POSTSUPERSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_I end_POSTSUPERSCRIPT }</annotation></semantics></math>, as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathtt{x}^{CF}_{u}=\mathsf{ENC}(u;\Theta_{\mathsf{E}}^{\mathsf{U}}),~{}%
\mathtt{x}^{CF}_{i}=\mathsf{ENC}(i;\Theta_{\mathsf{E}}^{\mathsf{I}})." class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1"><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml">𝚡</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.cmml">u</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.2.cmml">C</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">𝖤𝖭𝖢</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">u</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">;</mo><msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2" mathvariant="normal" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">Θ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">𝖤</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">𝖴</mi></msubsup><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.3" rspace="0.497em" xref="S3.E1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><msubsup id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml">𝚡</mi><mi id="S3.E1.m1.3.3.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.3.cmml">i</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml">C</mi><mo id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.1" xref="S3.E1.m1.3.3.1.1.2.2.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.3.cmml">𝖤𝖭𝖢</mi><mo id="S3.E1.m1.3.3.1.1.2.2.1.2" xref="S3.E1.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.1.1.2.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.2.cmml">;</mo><msubsup id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.2" mathvariant="normal" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.2.cmml">Θ</mi><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.3.cmml">𝖤</mi><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.3.cmml">𝖨</mi></msubsup><mo id="S3.E1.m1.3.3.1.1.2.2.1.1.1.4" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2">𝚡</ci><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3"><times id="S3.E1.m1.3.3.1.1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.2">𝐶</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.3.3">𝐹</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3">𝑢</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝖤𝖭𝖢</ci><list id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑢</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2">Θ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝖤</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">𝖴</ci></apply></list></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><eq id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"></eq><apply id="S3.E1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2">𝚡</ci><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3"><times id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2">𝐶</ci><ci id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3">𝐹</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1"><times id="S3.E1.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.2"></times><ci id="S3.E1.m1.3.3.1.1.2.2.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3">𝖤𝖭𝖢</ci><list id="S3.E1.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1"><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑖</ci><apply id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.2">Θ</ci><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.2.3">𝖤</ci></apply><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.3">𝖨</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathtt{x}^{CF}_{u}=\mathsf{ENC}(u;\Theta_{\mathsf{E}}^{\mathsf{U}}),~{}%
\mathtt{x}^{CF}_{i}=\mathsf{ENC}(i;\Theta_{\mathsf{E}}^{\mathsf{I}}).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = sansserif_ENC ( italic_u ; roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_U end_POSTSUPERSCRIPT ) , typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = sansserif_ENC ( italic_i ; roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_I end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.22">Then the encoded user and item embeddings are fed into an interaction network <math alttext="\mathsf{INT}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.10.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.10.m1.1a"><mi id="S3.SS1.SSS0.Px2.p1.10.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.10.m1.1.1.cmml">𝖨𝖭𝖳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.10.m1.1b"><ci id="S3.SS1.SSS0.Px2.p1.10.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.10.m1.1.1">𝖨𝖭𝖳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.10.m1.1c">\mathsf{INT}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.10.m1.1d">sansserif_INT</annotation></semantics></math> to make predictions with <math alttext="\hat{y}=\mathsf{INT}(\mathtt{x}^{CF}_{u},\mathtt{x}^{CF}_{i};\Theta_{\mathsf{T%
}})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.11.m2.3"><semantics id="S3.SS1.SSS0.Px2.p1.11.m2.3a"><mrow id="S3.SS1.SSS0.Px2.p1.11.m2.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.cmml"><mover accent="true" id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.2.cmml">y</mi><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.1" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.1.cmml">^</mo></mover><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.4" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.4.cmml">=</mo><mrow id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.5" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.5.cmml">𝖨𝖭𝖳</mi><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.4" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml"><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.4" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml">(</mo><msubsup id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.3.cmml">u</mi><mrow id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.1" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.5" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.2.cmml">𝚡</mi><mi id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.2" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.2.cmml">C</mi><mo id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.1" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.6" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml">;</mo><msub id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.3" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.3.cmml">𝖳</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.7" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.11.m2.3b"><apply id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3"><eq id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.4.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.4"></eq><apply id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5"><ci id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.1">^</ci><ci id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.5.2">𝑦</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3"><times id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.4.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.4"></times><ci id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.5.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.5">𝖨𝖭𝖳</ci><vector id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.4.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3"><apply id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3"><times id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.2">𝚡</ci><apply id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3"><times id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.2">𝐶</ci><ci id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.11.m2.3.3.3.3.3.3.3">𝖳</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.11.m2.3c">\hat{y}=\mathsf{INT}(\mathtt{x}^{CF}_{u},\mathtt{x}^{CF}_{i};\Theta_{\mathsf{T%
}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.11.m2.3d">over^ start_ARG italic_y end_ARG = sansserif_INT ( typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; roman_Θ start_POSTSUBSCRIPT sansserif_T end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\Theta_{\mathsf{T}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.12.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.12.m3.1a"><msub id="S3.SS1.SSS0.Px2.p1.12.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.3" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1.3.cmml">𝖳</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.12.m3.1b"><apply id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.12.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.12.m3.1.1.3">𝖳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.12.m3.1c">\Theta_{\mathsf{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.12.m3.1d">roman_Θ start_POSTSUBSCRIPT sansserif_T end_POSTSUBSCRIPT</annotation></semantics></math> is the set of trainable parameters of the interaction network. In some models, <math alttext="\mathsf{INT}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.13.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.13.m4.1a"><mi id="S3.SS1.SSS0.Px2.p1.13.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.13.m4.1.1.cmml">𝖨𝖭𝖳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.13.m4.1b"><ci id="S3.SS1.SSS0.Px2.p1.13.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.13.m4.1.1">𝖨𝖭𝖳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.13.m4.1c">\mathsf{INT}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.13.m4.1d">sansserif_INT</annotation></semantics></math> can be a non-parametric function, i.e., <math alttext="\Theta_{\mathsf{T}}=\emptyset" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.14.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.14.m5.1a"><mrow id="S3.SS1.SSS0.Px2.p1.14.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.cmml"><msub id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.2" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.2.cmml">Θ</mi><mi id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.3.cmml">𝖳</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.1" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.1.cmml">=</mo><mi id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.3" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.14.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1"><eq id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.1"></eq><apply id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.2">Θ</ci><ci id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.2.3">𝖳</ci></apply><emptyset id="S3.SS1.SSS0.Px2.p1.14.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.14.m5.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.14.m5.1c">\Theta_{\mathsf{T}}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.14.m5.1d">roman_Θ start_POSTSUBSCRIPT sansserif_T end_POSTSUBSCRIPT = ∅</annotation></semantics></math>. The model is optimized by minimizing the cross-entropy loss function that measures the prediction error between prediction <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.15.m6.1"><semantics id="S3.SS1.SSS0.Px2.p1.15.m6.1a"><mover accent="true" id="S3.SS1.SSS0.Px2.p1.15.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.15.m6.1.1.2" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS0.Px2.p1.15.m6.1.1.1" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.15.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.15.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1"><ci id="S3.SS1.SSS0.Px2.p1.15.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1.1">^</ci><ci id="S3.SS1.SSS0.Px2.p1.15.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.15.m6.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.15.m6.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.15.m6.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> and ground-truth label <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.16.m7.1"><semantics id="S3.SS1.SSS0.Px2.p1.16.m7.1a"><mi id="S3.SS1.SSS0.Px2.p1.16.m7.1.1" xref="S3.SS1.SSS0.Px2.p1.16.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.16.m7.1b"><ci id="S3.SS1.SSS0.Px2.p1.16.m7.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.16.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.16.m7.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.16.m7.1d">italic_y</annotation></semantics></math> on the training data. When conducting recommendation with an LLM, however, we need to convert the interaction history between <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.17.m8.1"><semantics id="S3.SS1.SSS0.Px2.p1.17.m8.1a"><mi id="S3.SS1.SSS0.Px2.p1.17.m8.1.1" xref="S3.SS1.SSS0.Px2.p1.17.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.17.m8.1b"><ci id="S3.SS1.SSS0.Px2.p1.17.m8.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.17.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.17.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.17.m8.1d">italic_u</annotation></semantics></math> and <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.18.m9.1"><semantics id="S3.SS1.SSS0.Px2.p1.18.m9.1a"><mi id="S3.SS1.SSS0.Px2.p1.18.m9.1.1" xref="S3.SS1.SSS0.Px2.p1.18.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.18.m9.1b"><ci id="S3.SS1.SSS0.Px2.p1.18.m9.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.18.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.18.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.18.m9.1d">italic_i</annotation></semantics></math> into a hybrid prompt <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.19.m10.2"><semantics id="S3.SS1.SSS0.Px2.p1.19.m10.2a"><msub id="S3.SS1.SSS0.Px2.p1.19.m10.2.3" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.19.m10.2.3.2" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.3.2.cmml">𝚙</mi><mrow id="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.4" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.19.m10.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.19.m10.1.1.1.1.cmml">u</mi><mo id="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.4.1" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.19.m10.2b"><apply id="S3.SS1.SSS0.Px2.p1.19.m10.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.19.m10.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.19.m10.2.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.3.2">𝚙</ci><list id="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.4"><ci id="S3.SS1.SSS0.Px2.p1.19.m10.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.1.1.1.1">𝑢</ci><ci id="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.19.m10.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.19.m10.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.19.m10.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> via the hybrid prompt translation step (demonstrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS2" title="3.2. Hybrid Prompt Translation ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>), and make predictions with <math alttext="\hat{y}=\mathsf{M}(\mathtt{p}_{u,i};\Theta)" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.20.m11.4"><semantics id="S3.SS1.SSS0.Px2.p1.20.m11.4a"><mrow id="S3.SS1.SSS0.Px2.p1.20.m11.4.4" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.cmml"><mover accent="true" id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.2" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.2.cmml">y</mi><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.1.cmml">^</mo></mover><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.2" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.2.cmml">=</mo><mrow id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.3" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.3.cmml">𝖬</mi><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.2" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.2.cmml">(</mo><msub id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.2.cmml">𝚙</mi><mrow id="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.4" xref="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.20.m11.1.1.1.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.1.1.1.1.cmml">u</mi><mo id="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.4.1" xref="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.2.cmml">;</mo><mi id="S3.SS1.SSS0.Px2.p1.20.m11.3.3" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.20.m11.3.3.cmml">Θ</mi><mo id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.4" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.20.m11.4b"><apply id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4"><eq id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.2"></eq><apply id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3"><ci id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.1">^</ci><ci id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.3.2">𝑦</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1"><times id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.2"></times><ci id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.3">𝖬</ci><list id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1"><apply id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.4.4.1.1.1.1.2">𝚙</ci><list id="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.4"><ci id="S3.SS1.SSS0.Px2.p1.20.m11.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.1.1.1.1">𝑢</ci><ci id="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS0.Px2.p1.20.m11.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.20.m11.3.3">Θ</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.20.m11.4c">\hat{y}=\mathsf{M}(\mathtt{p}_{u,i};\Theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.20.m11.4d">over^ start_ARG italic_y end_ARG = sansserif_M ( typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ; roman_Θ )</annotation></semantics></math>,
where <math alttext="\mathsf{M}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.21.m12.1"><semantics id="S3.SS1.SSS0.Px2.p1.21.m12.1a"><mi id="S3.SS1.SSS0.Px2.p1.21.m12.1.1" xref="S3.SS1.SSS0.Px2.p1.21.m12.1.1.cmml">𝖬</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.21.m12.1b"><ci id="S3.SS1.SSS0.Px2.p1.21.m12.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.21.m12.1.1">𝖬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.21.m12.1c">\mathsf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.21.m12.1d">sansserif_M</annotation></semantics></math> is the LLM4Rec model parameterized by <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.22.m13.1"><semantics id="S3.SS1.SSS0.Px2.p1.22.m13.1a"><mi id="S3.SS1.SSS0.Px2.p1.22.m13.1.1" mathvariant="normal" xref="S3.SS1.SSS0.Px2.p1.22.m13.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.22.m13.1b"><ci id="S3.SS1.SSS0.Px2.p1.22.m13.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.22.m13.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.22.m13.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.22.m13.1d">roman_Θ</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Hybrid Prompt Translation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To work with LLMs, we need to translate the user-item interaction triplets <math alttext="\{(u,i,y)\}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.4.1" xref="S3.SS2.p1.1.m1.4.4.2.cmml"><mo id="S3.SS2.p1.1.m1.4.4.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.2.cmml">{</mo><mrow id="S3.SS2.p1.1.m1.4.4.1.1.2" xref="S3.SS2.p1.1.m1.4.4.1.1.1.cmml"><mo id="S3.SS2.p1.1.m1.4.4.1.1.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">u</mi><mo id="S3.SS2.p1.1.m1.4.4.1.1.2.2" xref="S3.SS2.p1.1.m1.4.4.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">i</mi><mo id="S3.SS2.p1.1.m1.4.4.1.1.2.3" xref="S3.SS2.p1.1.m1.4.4.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">y</mi><mo id="S3.SS2.p1.1.m1.4.4.1.1.2.4" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p1.1.m1.4.4.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><set id="S3.SS2.p1.1.m1.4.4.2.cmml" xref="S3.SS2.p1.1.m1.4.4.1"><vector id="S3.SS2.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS2.p1.1.m1.4.4.1.1.2"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑢</ci><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3">𝑦</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">\{(u,i,y)\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">{ ( italic_u , italic_i , italic_y ) }</annotation></semantics></math> into a prompt sequence. The purpose is twofold: we aim to encode the task description and user-item interactions into natural language, and we also seek to encode the collaborative signals in the form of latent embeddings.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.8">Our prompt template is designed to be similar to the templates used in previous studies <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite>.
Specifically, we formulate two types of item feature <math alttext="\mathtt{x}_{i}=\{\mathtt{x}^{CF}_{i},\mathtt{x}^{SM}_{i}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.2"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><msub id="S3.SS2.p2.1.m1.2.2.4" xref="S3.SS2.p2.1.m1.2.2.4.cmml"><mi id="S3.SS2.p2.1.m1.2.2.4.2" xref="S3.SS2.p2.1.m1.2.2.4.2.cmml">𝚡</mi><mi id="S3.SS2.p2.1.m1.2.2.4.3" xref="S3.SS2.p2.1.m1.2.2.4.3.cmml">i</mi></msub><mo id="S3.SS2.p2.1.m1.2.2.3" xref="S3.SS2.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml"><mo id="S3.SS2.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">{</mo><msubsup id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS2.p2.1.m1.2.2.2.2.4" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p2.1.m1.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.1" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><eq id="S3.SS2.p2.1.m1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.3"></eq><apply id="S3.SS2.p2.1.m1.2.2.4.cmml" xref="S3.SS2.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.4.1.cmml" xref="S3.SS2.p2.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.4.2.cmml" xref="S3.SS2.p2.1.m1.2.2.4.2">𝚡</ci><ci id="S3.SS2.p2.1.m1.2.2.4.3.cmml" xref="S3.SS2.p2.1.m1.2.2.4.3">𝑖</ci></apply><set id="S3.SS2.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2"><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2">𝚡</ci><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3"><times id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.2">𝚡</ci><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3"><times id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.2">𝑆</ci><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">\mathtt{x}_{i}=\{\mathtt{x}^{CF}_{i},\mathtt{x}^{SM}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.2d">typewriter_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> via a hybrid prompt, where <math alttext="\mathtt{x}^{SM}_{i}=\left\{\mathtt{x}^{SM}_{i}[1],\mathtt{x}^{SM}_{i}[2],\dots%
,\mathtt{x}^{SM}_{i}[T_{i}]\right\}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.6"><semantics id="S3.SS2.p2.2.m2.6a"><mrow id="S3.SS2.p2.2.m2.6.6" xref="S3.SS2.p2.2.m2.6.6.cmml"><msubsup id="S3.SS2.p2.2.m2.6.6.5" xref="S3.SS2.p2.2.m2.6.6.5.cmml"><mi id="S3.SS2.p2.2.m2.6.6.5.2.2" xref="S3.SS2.p2.2.m2.6.6.5.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.2.m2.6.6.5.3" xref="S3.SS2.p2.2.m2.6.6.5.3.cmml">i</mi><mrow id="S3.SS2.p2.2.m2.6.6.5.2.3" xref="S3.SS2.p2.2.m2.6.6.5.2.3.cmml"><mi id="S3.SS2.p2.2.m2.6.6.5.2.3.2" xref="S3.SS2.p2.2.m2.6.6.5.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.2.m2.6.6.5.2.3.1" xref="S3.SS2.p2.2.m2.6.6.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.6.6.5.2.3.3" xref="S3.SS2.p2.2.m2.6.6.5.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.2.m2.6.6.4" xref="S3.SS2.p2.2.m2.6.6.4.cmml">=</mo><mrow id="S3.SS2.p2.2.m2.6.6.3.3" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml"><mo id="S3.SS2.p2.2.m2.6.6.3.3.4" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml">{</mo><mrow id="S3.SS2.p2.2.m2.4.4.1.1.1" xref="S3.SS2.p2.2.m2.4.4.1.1.1.cmml"><msubsup id="S3.SS2.p2.2.m2.4.4.1.1.1.2" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.2" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.2.m2.4.4.1.1.1.2.3" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.2" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.1" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.3" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.2.m2.4.4.1.1.1.1" xref="S3.SS2.p2.2.m2.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.4.4.1.1.1.3.2" xref="S3.SS2.p2.2.m2.4.4.1.1.1.3.1.cmml"><mo id="S3.SS2.p2.2.m2.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.4.4.1.1.1.3.1.1.cmml">[</mo><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p2.2.m2.4.4.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p2.2.m2.4.4.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.6.6.3.3.5" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml">,</mo><mrow id="S3.SS2.p2.2.m2.5.5.2.2.2" xref="S3.SS2.p2.2.m2.5.5.2.2.2.cmml"><msubsup id="S3.SS2.p2.2.m2.5.5.2.2.2.2" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.2.m2.5.5.2.2.2.2.3" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.2" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.1" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.3" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.2.m2.5.5.2.2.2.1" xref="S3.SS2.p2.2.m2.5.5.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.5.5.2.2.2.3.2" xref="S3.SS2.p2.2.m2.5.5.2.2.2.3.1.cmml"><mo id="S3.SS2.p2.2.m2.5.5.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.5.5.2.2.2.3.1.1.cmml">[</mo><mn id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">2</mn><mo id="S3.SS2.p2.2.m2.5.5.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.p2.2.m2.5.5.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.6.6.3.3.6" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml">,</mo><mi id="S3.SS2.p2.2.m2.3.3" mathvariant="normal" xref="S3.SS2.p2.2.m2.3.3.cmml">…</mi><mo id="S3.SS2.p2.2.m2.6.6.3.3.7" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml">,</mo><mrow id="S3.SS2.p2.2.m2.6.6.3.3.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.cmml"><msubsup id="S3.SS2.p2.2.m2.6.6.3.3.3.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.2" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.3.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.3.cmml">i</mi><mrow id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.cmml"><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.2" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.1" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.2.m2.6.6.3.3.3.2" xref="S3.SS2.p2.2.m2.6.6.3.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.2.cmml"><mo id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.2.1.cmml">[</mo><msub id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.2" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.2.cmml">T</mi><mi id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.3" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p2.2.m2.6.6.3.3.8" xref="S3.SS2.p2.2.m2.6.6.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.6b"><apply id="S3.SS2.p2.2.m2.6.6.cmml" xref="S3.SS2.p2.2.m2.6.6"><eq id="S3.SS2.p2.2.m2.6.6.4.cmml" xref="S3.SS2.p2.2.m2.6.6.4"></eq><apply id="S3.SS2.p2.2.m2.6.6.5.cmml" xref="S3.SS2.p2.2.m2.6.6.5"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.5.1.cmml" xref="S3.SS2.p2.2.m2.6.6.5">subscript</csymbol><apply id="S3.SS2.p2.2.m2.6.6.5.2.cmml" xref="S3.SS2.p2.2.m2.6.6.5"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.5.2.1.cmml" xref="S3.SS2.p2.2.m2.6.6.5">superscript</csymbol><ci id="S3.SS2.p2.2.m2.6.6.5.2.2.cmml" xref="S3.SS2.p2.2.m2.6.6.5.2.2">𝚡</ci><apply id="S3.SS2.p2.2.m2.6.6.5.2.3.cmml" xref="S3.SS2.p2.2.m2.6.6.5.2.3"><times id="S3.SS2.p2.2.m2.6.6.5.2.3.1.cmml" xref="S3.SS2.p2.2.m2.6.6.5.2.3.1"></times><ci id="S3.SS2.p2.2.m2.6.6.5.2.3.2.cmml" xref="S3.SS2.p2.2.m2.6.6.5.2.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.6.6.5.2.3.3.cmml" xref="S3.SS2.p2.2.m2.6.6.5.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.2.m2.6.6.5.3.cmml" xref="S3.SS2.p2.2.m2.6.6.5.3">𝑖</ci></apply><set id="S3.SS2.p2.2.m2.6.6.3.4.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3"><apply id="S3.SS2.p2.2.m2.4.4.1.1.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1"><times id="S3.SS2.p2.2.m2.4.4.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.1"></times><apply id="S3.SS2.p2.2.m2.4.4.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2">subscript</csymbol><apply id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.2.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.2">𝚡</ci><apply id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3"><times id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.1"></times><ci id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.2.m2.4.4.1.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.4.4.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.3.2"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.4.4.1.1.1.3.1.1.cmml" xref="S3.SS2.p2.2.m2.4.4.1.1.1.3.2.1">delimited-[]</csymbol><cn id="S3.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1">1</cn></apply></apply><apply id="S3.SS2.p2.2.m2.5.5.2.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2"><times id="S3.SS2.p2.2.m2.5.5.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.1"></times><apply id="S3.SS2.p2.2.m2.5.5.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.2">𝚡</ci><apply id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3"><times id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.2.m2.5.5.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.5.5.2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.3.2"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.5.5.2.2.2.3.1.1.cmml" xref="S3.SS2.p2.2.m2.5.5.2.2.2.3.2.1">delimited-[]</csymbol><cn id="S3.SS2.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2">2</cn></apply></apply><ci id="S3.SS2.p2.2.m2.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3">…</ci><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3"><times id="S3.SS2.p2.2.m2.6.6.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.2"></times><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.3.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3">subscript</csymbol><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3">superscript</csymbol><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.2">𝚡</ci><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3"><times id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.1"></times><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.2">𝑆</ci><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.1.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.6.6.3.3.3.1.2.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.2">𝑇</ci><ci id="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.6.6.3.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.6c">\mathtt{x}^{SM}_{i}=\left\{\mathtt{x}^{SM}_{i}[1],\mathtt{x}^{SM}_{i}[2],\dots%
,\mathtt{x}^{SM}_{i}[T_{i}]\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.6d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 1 ] , typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 2 ] , … , typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] }</annotation></semantics></math> is the set of embedding representing the semantic knowledge of item’s textual attributes. <math alttext="T_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">T</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑇</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the total number of tokens in item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_i</annotation></semantics></math>’s attribute.
Each token embedding <math alttext="\mathtt{x}^{SM}_{i}[t]" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><msubsup id="S3.SS2.p2.5.m5.1.2.2" xref="S3.SS2.p2.5.m5.1.2.2.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2.2.2" xref="S3.SS2.p2.5.m5.1.2.2.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.5.m5.1.2.2.3" xref="S3.SS2.p2.5.m5.1.2.2.3.cmml">i</mi><mrow id="S3.SS2.p2.5.m5.1.2.2.2.3" xref="S3.SS2.p2.5.m5.1.2.2.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2.2.3.2" xref="S3.SS2.p2.5.m5.1.2.2.2.3.2.cmml">S</mi><mo id="S3.SS2.p2.5.m5.1.2.2.2.3.1" xref="S3.SS2.p2.5.m5.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.5.m5.1.2.2.2.3.3" xref="S3.SS2.p2.5.m5.1.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.SS2.p2.5.m5.1.2.1" xref="S3.SS2.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.1.2.3.2" xref="S3.SS2.p2.5.m5.1.2.3.1.cmml"><mo id="S3.SS2.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">t</mi><mo id="S3.SS2.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.5.m5.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><times id="S3.SS2.p2.5.m5.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.1"></times><apply id="S3.SS2.p2.5.m5.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2">subscript</csymbol><apply id="S3.SS2.p2.5.m5.1.2.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.2.2.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2">superscript</csymbol><ci id="S3.SS2.p2.5.m5.1.2.2.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.2">𝚡</ci><apply id="S3.SS2.p2.5.m5.1.2.2.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.3"><times id="S3.SS2.p2.5.m5.1.2.2.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.3.1"></times><ci id="S3.SS2.p2.5.m5.1.2.2.2.3.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.3.2">𝑆</ci><ci id="S3.SS2.p2.5.m5.1.2.2.2.3.3.cmml" xref="S3.SS2.p2.5.m5.1.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p2.5.m5.1.2.2.3.cmml" xref="S3.SS2.p2.5.m5.1.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.5.m5.1.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.p2.5.m5.1.2.3.1.1.cmml" xref="S3.SS2.p2.5.m5.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\mathtt{x}^{SM}_{i}[t]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ]</annotation></semantics></math> (<math alttext="1\leq t\leq T_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mrow id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mn id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">1</mn><mo id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">≤</mo><mi id="S3.SS2.p2.6.m6.1.1.4" xref="S3.SS2.p2.6.m6.1.1.4.cmml">t</mi><mo id="S3.SS2.p2.6.m6.1.1.5" xref="S3.SS2.p2.6.m6.1.1.5.cmml">≤</mo><msub id="S3.SS2.p2.6.m6.1.1.6" xref="S3.SS2.p2.6.m6.1.1.6.cmml"><mi id="S3.SS2.p2.6.m6.1.1.6.2" xref="S3.SS2.p2.6.m6.1.1.6.2.cmml">T</mi><mi id="S3.SS2.p2.6.m6.1.1.6.3" xref="S3.SS2.p2.6.m6.1.1.6.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><and id="S3.SS2.p2.6.m6.1.1a.cmml" xref="S3.SS2.p2.6.m6.1.1"></and><apply id="S3.SS2.p2.6.m6.1.1b.cmml" xref="S3.SS2.p2.6.m6.1.1"><leq id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3"></leq><cn id="S3.SS2.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS2.p2.6.m6.1.1.2">1</cn><ci id="S3.SS2.p2.6.m6.1.1.4.cmml" xref="S3.SS2.p2.6.m6.1.1.4">𝑡</ci></apply><apply id="S3.SS2.p2.6.m6.1.1c.cmml" xref="S3.SS2.p2.6.m6.1.1"><leq id="S3.SS2.p2.6.m6.1.1.5.cmml" xref="S3.SS2.p2.6.m6.1.1.5"></leq><share href="https://arxiv.org/html/2408.08564v1#S3.SS2.p2.6.m6.1.1.4.cmml" id="S3.SS2.p2.6.m6.1.1d.cmml" xref="S3.SS2.p2.6.m6.1.1"></share><apply id="S3.SS2.p2.6.m6.1.1.6.cmml" xref="S3.SS2.p2.6.m6.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.6.1.cmml" xref="S3.SS2.p2.6.m6.1.1.6">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.6.2.cmml" xref="S3.SS2.p2.6.m6.1.1.6.2">𝑇</ci><ci id="S3.SS2.p2.6.m6.1.1.6.3.cmml" xref="S3.SS2.p2.6.m6.1.1.6.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">1\leq t\leq T_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">1 ≤ italic_t ≤ italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>) is a <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_d</annotation></semantics></math>-dimensional vector. Similarly, the user feature is defined as <math alttext="\mathtt{x}_{u}=\{\mathtt{x}^{CF}_{u}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mrow id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><msub id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml"><mi id="S3.SS2.p2.8.m8.1.1.3.2" xref="S3.SS2.p2.8.m8.1.1.3.2.cmml">𝚡</mi><mi id="S3.SS2.p2.8.m8.1.1.3.3" xref="S3.SS2.p2.8.m8.1.1.3.3.cmml">u</mi></msub><mo id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">=</mo><mrow id="S3.SS2.p2.8.m8.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.2.cmml"><mo id="S3.SS2.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.8.m8.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p2.8.m8.1.1.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.1.1.1.2.2" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS2.p2.8.m8.1.1.1.1.1.3" xref="S3.SS2.p2.8.m8.1.1.1.1.1.3.cmml">u</mi><mrow id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.2" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.1" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.3" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS2.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.8.m8.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><eq id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2"></eq><apply id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.3.1.cmml" xref="S3.SS2.p2.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.3.2.cmml" xref="S3.SS2.p2.8.m8.1.1.3.2">𝚡</ci><ci id="S3.SS2.p2.8.m8.1.1.3.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3.3">𝑢</ci></apply><set id="S3.SS2.p2.8.m8.1.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1"><apply id="S3.SS2.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.2">𝚡</ci><apply id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3"><times id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS2.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.1.1.1.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\mathtt{x}_{u}=\{\mathtt{x}^{CF}_{u}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">typewriter_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT }</annotation></semantics></math>.
Note that we do not include the user’s semantic knowledge in the framework of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.8.1">CCF-LLM</span> due to two reasons: (1) the availability of the user’s textual attributes is highly inconsistent across different datasets, and (2) evaluating the impact of such inconsistent features is challenging.
Hence, we leave it for future work to incorporate user semantic knowledge.
Finally, we present our hybrid prompt template as follows.</p>
</div>
<div class="ltx_para ltx_noindent ltx_align_center" id="S3.SS2.1.p1">
<p class="ltx_p" id="S3.SS2.1.p1.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle ltx_framed ltx_framed_rectangle" id="S3.SS2.1.p1.1.1" style="width:390.3pt;">
<span class="ltx_p" id="S3.SS2.1.p1.1.1.1"><span class="ltx_text" id="S3.SS2.1.p1.1.1.1.1" style="font-size:90%;">#Question: A user has given high ratings to the following items: <span class="ltx_text ltx_font_typewriter" id="S3.SS2.1.p1.1.1.1.1.1">{[Item_u]}</span>. Additionally, we have information about the user’s preferences encoded in the feature <span class="ltx_text ltx_font_typewriter" id="S3.SS2.1.p1.1.1.1.1.2">[User_u]</span>. Using all available information, make a prediction about whether the user would enjoy the item <span class="ltx_text ltx_font_typewriter" id="S3.SS2.1.p1.1.1.1.1.3">[Item_i]</span>. Answer with ”Yes” or ”No”.
#Answer:</span></span>
</span></p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.5">We use several special tokens as placeholders to represent user and item features within the prompt template. For the item side, we use <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.5.1">[Item_i]</span> to represent the item entity with ID <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_i</annotation></semantics></math>, and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.5.2">{[Item_u]}</span> is a list of special tokens representing the items that have been interacted by user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_u</annotation></semantics></math>. For the user side, we use <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.5.3">[User_u]</span> as a placeholder to represent the user entity with ID <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_u</annotation></semantics></math>. Hence, the prompt template consists of three parts: task descriptions in natural languages, user entities, and item entities. Note that, distinct from previous works <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite> which separates the embeddings for two modalities <math alttext="\mathtt{x}^{CF}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msubsup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">i</mi><mrow id="S3.SS2.p3.4.m4.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.3.2" xref="S3.SS2.p3.4.m4.1.1.2.3.2.cmml">C</mi><mo id="S3.SS2.p3.4.m4.1.1.2.3.1" xref="S3.SS2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.4.m4.1.1.2.3.3" xref="S3.SS2.p3.4.m4.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝚡</ci><apply id="S3.SS2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3"><times id="S3.SS2.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.1"></times><ci id="S3.SS2.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.2">𝐶</ci><ci id="S3.SS2.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\mathtt{x}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathtt{x}^{SM}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msubsup id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2.2" xref="S3.SS2.p3.5.m5.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">i</mi><mrow id="S3.SS2.p3.5.m5.1.1.2.3" xref="S3.SS2.p3.5.m5.1.1.2.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2.3.2" xref="S3.SS2.p3.5.m5.1.1.2.3.2.cmml">S</mi><mo id="S3.SS2.p3.5.m5.1.1.2.3.1" xref="S3.SS2.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.5.m5.1.1.2.3.3" xref="S3.SS2.p3.5.m5.1.1.2.3.3.cmml">M</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2.2">𝚡</ci><apply id="S3.SS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3"><times id="S3.SS2.p3.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3.2">𝑆</ci><ci id="S3.SS2.p3.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\mathtt{x}^{SM}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in the prompt, we utilize a single token to represent the two heterogeneous modalities for each item to facilitate the cross-modal fusion.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Attentive Cross-modal Fusion Strategy</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Our attentive cross-modal fusion strategy consists of two phases, mapping and fusion, that help to fuse information from heterogeneous modalities. Unlike previous works that utilize solely natural languages <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>)</cite> or inject CF embeddings <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite>, our framework adaptively fuse the two modalities into an input embedding sequence for the LLM, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>b. We explain the two phases of mapping and fusion in the following.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Mapping Phase</h4>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.1">The mapping phase aims to convert the prompt sequences to latent embeddings. It has two primary goals: first, for task descriptions and user/item attributes (e.g., title), it maps them to latent embeddings representing semantic knowledge for subsequent processing by an LLM. Second, for the user and item’s collaborative signals, it maps them to the latent embeddings from a pre-trained CF-based recommendation system.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.13">Formally, let the hybrid prompt for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.1.m1.1d">italic_u</annotation></semantics></math> and item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p2.2.m2.1a"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.2.m2.1d">italic_i</annotation></semantics></math> be <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.3.m3.2"><semantics id="S3.SS3.SSS0.Px1.p2.3.m3.2a"><msub id="S3.SS3.SSS0.Px1.p2.3.m3.2.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.2.3.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.3.2.cmml">𝚙</mi><mrow id="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.1.cmml">u</mi><mo id="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.3.m3.2b"><apply id="S3.SS3.SSS0.Px1.p2.3.m3.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.3.m3.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.3.m3.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.3.2">𝚙</ci><list id="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.1">𝑢</ci><ci id="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.3.m3.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.3.m3.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. For each token <math alttext="\mathtt{tk}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS3.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml">𝚝𝚔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.4.m4.1.1">𝚝𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.4.m4.1c">\mathtt{tk}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.4.m4.1d">typewriter_tk</annotation></semantics></math> in the tokenized <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.5.m5.2"><semantics id="S3.SS3.SSS0.Px1.p2.5.m5.2a"><msub id="S3.SS3.SSS0.Px1.p2.5.m5.2.3" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.2.3.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.3.2.cmml">𝚙</mi><mrow id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.4" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.cmml">u</mi><mo id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.5.m5.2b"><apply id="S3.SS3.SSS0.Px1.p2.5.m5.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.5.m5.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.5.m5.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.3.2">𝚙</ci><list id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.1">𝑢</ci><ci id="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.5.m5.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.5.m5.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we obtain its latent embedding with the following rules. (1) If <math alttext="\mathtt{tk}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS3.SSS0.Px1.p2.6.m6.1a"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml">𝚝𝚔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.6.m6.1b"><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1">𝚝𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.6.m6.1c">\mathtt{tk}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.6.m6.1d">typewriter_tk</annotation></semantics></math> is a natural language token, we obtain its corresponding latent embedding directly via the LLM’s input embedding lookup. (2) If <math alttext="\mathtt{tk}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS3.SSS0.Px1.p2.7.m7.1a"><mi id="S3.SS3.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml">𝚝𝚔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.7.m7.1b"><ci id="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1">𝚝𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.7.m7.1c">\mathtt{tk}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.7.m7.1d">typewriter_tk</annotation></semantics></math> is a placeholder for users, i.e., <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS0.Px1.p2.13.1">[User_u]</span>, we obtain the latent embedding <math alttext="\mathtt{x}^{CF}_{u}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.8.m8.1"><semantics id="S3.SS3.SSS0.Px1.p2.8.m8.1a"><msubsup id="S3.SS3.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.3.cmml">u</mi><mrow id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.8.m8.1b"><apply id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.8.m8.1c">\mathtt{x}^{CF}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.8.m8.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> from a pre-trained CF-based model. (3) If <math alttext="\mathtt{tk}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.9.m9.1"><semantics id="S3.SS3.SSS0.Px1.p2.9.m9.1a"><mi id="S3.SS3.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml">𝚝𝚔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.9.m9.1b"><ci id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1">𝚝𝚔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.9.m9.1c">\mathtt{tk}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.9.m9.1d">typewriter_tk</annotation></semantics></math> is a placeholder for items, i.e., <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS0.Px1.p2.13.2">[Item_i]</span> or <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS0.Px1.p2.13.3">[Item_u]</span>, we obtain the embeddings representing the two modalities for semantic knowledge and collaborative signals. Specifically, we first obtain the item’s CF embedding, <math alttext="\mathtt{x}^{CF}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.10.m10.1"><semantics id="S3.SS3.SSS0.Px1.p2.10.m10.1a"><msubsup id="S3.SS3.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.10.m10.1b"><apply id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.10.m10.1c">\mathtt{x}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.10.m10.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, from a CF-based model similarly as the user side. Then, we extract the item’s textual attributes from a database and obtain its LLM embedding, <math alttext="\mathtt{x}^{SM}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.11.m11.1"><semantics id="S3.SS3.SSS0.Px1.p2.11.m11.1a"><msubsup id="S3.SS3.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.3" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.2.cmml">S</mi><mo id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.3.cmml">M</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.11.m11.1b"><apply id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.2">𝑆</ci><ci id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.11.m11.1c">\mathtt{x}^{SM}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.11.m11.1d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, via the LLM’s input embedding lookup. The obtained <math alttext="\mathtt{x}^{CF}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.12.m12.1"><semantics id="S3.SS3.SSS0.Px1.p2.12.m12.1a"><msubsup id="S3.SS3.SSS0.Px1.p2.12.m12.1.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.3" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.12.m12.1b"><apply id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.12.m12.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.12.m12.1c">\mathtt{x}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.12.m12.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathtt{x}^{SM}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p2.13.m13.1"><semantics id="S3.SS3.SSS0.Px1.p2.13.m13.1a"><msubsup id="S3.SS3.SSS0.Px1.p2.13.m13.1.1" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.2" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.3" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.2" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.2.cmml">S</mi><mo id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.1" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.3" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.3.cmml">M</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.13.m13.1b"><apply id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3"><times id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.2">𝑆</ci><ci id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p2.13.m13.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.13.m13.1c">\mathtt{x}^{SM}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p2.13.m13.1d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> will be fused adaptively in the next part.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p3.1">In this way, each token in the prompt sequence <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p3.1.m1.2"><semantics id="S3.SS3.SSS0.Px1.p3.1.m1.2a"><msub id="S3.SS3.SSS0.Px1.p3.1.m1.2.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p3.1.m1.2.3.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.3.2.cmml">𝚙</mi><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.4" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.1.cmml">u</mi><mo id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.4.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.1.m1.2b"><apply id="S3.SS3.SSS0.Px1.p3.1.m1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p3.1.m1.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p3.1.m1.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.3.2">𝚙</ci><list id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.4"><ci id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.1">𝑢</ci><ci id="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.1.m1.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p3.1.m1.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is mapped to its corresponding latent embeddings, which will be used to prepare a fused embedding sequence as the input to the LLM.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Fusion Phase</h4>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.1">The CF embeddings cannot be directly fused with the LLM embeddings due to their inconsistent latent spaces. Similar to prior work <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite>, we utilize an alignment network to map the CF embeddings to the LLM embedding space. Given the alignment network <math alttext="\mathsf{ALG}:\mathbb{R}^{l}\to\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝖠𝖫𝖦</mi><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml"><msup id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.3.cmml">l</mi></msup><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">→</mo><msup id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1">:</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝖠𝖫𝖦</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1">→</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.2">ℝ</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.2">ℝ</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">\mathsf{ALG}:\mathbb{R}^{l}\to\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">sansserif_ALG : blackboard_R start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, this process can be presented as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathtt{x}}^{CF}_{u}=\mathsf{ALG}(\mathtt{x}^{CF}_{u};\Theta_{\mathsf{A%
}}),~{}\tilde{\mathtt{x}}^{CF}_{i}=\mathsf{ALG}(\mathtt{x}^{CF}_{i};\Theta_{%
\mathsf{A}})," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1"><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.3.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.2.cmml">𝚡</mi><mo id="S3.E2.m1.1.1.1.1.1.1.4.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.1.1.4.3.cmml">u</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.4.2.3" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.2.cmml">C</mi><mo id="S3.E2.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.1.1.2.4.cmml">𝖠𝖫𝖦</mi><mo id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝚡</mi><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E2.m1.1.1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.2" mathvariant="normal" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">Θ</mi><mi id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">𝖠</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.2.3" rspace="0.497em" xref="S3.E2.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml"><msubsup id="S3.E2.m1.1.1.1.1.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.4.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.2.2.4.2.2" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.4.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2.2.cmml">𝚡</mi><mo id="S3.E2.m1.1.1.1.1.2.2.4.2.2.1" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.1.1.1.1.2.2.4.3" xref="S3.E2.m1.1.1.1.1.2.2.4.3.cmml">i</mi><mrow id="S3.E2.m1.1.1.1.1.2.2.4.2.3" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.4.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.2.cmml">C</mi><mo id="S3.E2.m1.1.1.1.1.2.2.4.2.3.1" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.2.2.4.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E2.m1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.2.4.cmml">𝖠𝖫𝖦</mi><mo id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.E2.m1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">𝚡</mi><mi id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.3.cmml">i</mi><mrow id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.1" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E2.m1.1.1.1.1.2.2.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">;</mo><msub id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2" mathvariant="normal" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">Θ</mi><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">𝖠</mi></msub><mo id="S3.E2.m1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3a.cmml" xref="S3.E2.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3"></eq><apply id="S3.E2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.1">~</ci><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.2">𝚡</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.2">𝐶</ci><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.3">𝐹</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.3">𝑢</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3"></times><ci id="S3.E2.m1.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.4">𝖠𝖫𝖦</ci><list id="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝚡</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.2">Θ</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.2.3">𝖠</ci></apply></list></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2"><eq id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3"></eq><apply id="S3.E2.m1.1.1.1.1.2.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.2.2.4.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.4.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.2.2.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2"><ci id="S3.E2.m1.1.1.1.1.2.2.4.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2.1">~</ci><ci id="S3.E2.m1.1.1.1.1.2.2.4.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.2.2">𝚡</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3"><times id="S3.E2.m1.1.1.1.1.2.2.4.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.2.2.4.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.2">𝐶</ci><ci id="S3.E2.m1.1.1.1.1.2.2.4.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.2.3.3">𝐹</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.2.2.4.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.4.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><times id="S3.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.3"></times><ci id="S3.E2.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.4">𝖠𝖫𝖦</ci><list id="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.2">𝚡</ci><apply id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3"><times id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2">Θ</ci><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3">𝖠</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\tilde{\mathtt{x}}^{CF}_{u}=\mathsf{ALG}(\mathtt{x}^{CF}_{u};\Theta_{\mathsf{A%
}}),~{}\tilde{\mathtt{x}}^{CF}_{i}=\mathsf{ALG}(\mathtt{x}^{CF}_{i};\Theta_{%
\mathsf{A}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = sansserif_ALG ( typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ; roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT ) , over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = sansserif_ALG ( typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.4">where <math alttext="\Theta_{\mathsf{A}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.2.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.2.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.2" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1.2.cmml">Θ</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1.3.cmml">𝖠</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1.2">Θ</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m1.1.1.3">𝖠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m1.1c">\Theta_{\mathsf{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m1.1d">roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT</annotation></semantics></math> is the set of trainable parameters. <math alttext="\tilde{\mathtt{x}}^{CF}_{u}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m2.1a"><mrow id="S3.SS3.SSS0.Px2.p1.3.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.cmml"><msubsup id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.1" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.3.cmml">u</mi><mrow id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.1" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.3" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1"><in id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.1"></in><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2"><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.2.2">𝚡</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3"><times id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.2.3">𝑢</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m2.1c">\tilde{\mathtt{x}}^{CF}_{u}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m2.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\tilde{\mathtt{x}}^{CF}_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.4.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.4.m3.1a"><mrow id="S3.SS3.SSS0.Px2.p1.4.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.cmml"><msubsup id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.1" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.2" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.1" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.3" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1"><in id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.1"></in><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2"><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.2.2">𝚡</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3"><times id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m3.1c">\tilde{\mathtt{x}}^{CF}_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.4.m3.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are aligned CF embeddings which are ready to be fused. In practice, the alignment network is usually implemented as a multi-layer perceptron (MLP).</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.4">However, only aligning the dimension of latent embeddings between CF embeddings and the LLM embeddings is not enough to fully leverage the collaborative signal for the recommendation. Because it is still hard for LLM to understand the latent embeddings of collaborative signals due to their distinct nature. In response to this challenge, we propose an attentive cross-modal fusion strategy shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>b. Inspired by the cross-gate mechanism <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib40" title="">2015</a>)</cite>, we train a learnable network <math alttext="\mathsf{GATE}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">𝖦𝖠𝖳𝖤</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">𝖦𝖠𝖳𝖤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">\mathsf{GATE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.1.m1.1d">sansserif_GATE</annotation></semantics></math> to fuse the two embeddings in different modalities in a dimension-wise manner adaptively. Specifically, for each token of the item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.2.m2.1d">italic_i</annotation></semantics></math>’s attribute, <math alttext="\mathsf{GATE}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS3.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p2.3.m3.1.1.cmml">𝖦𝖠𝖳𝖤</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS3.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.1.1">𝖦𝖠𝖳𝖤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.3.m3.1c">\mathsf{GATE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.3.m3.1d">sansserif_GATE</annotation></semantics></math> learns a fusion weight vector <math alttext="\alpha\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS3.SSS0.Px2.p2.4.m4.1a"><mrow id="S3.SS3.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.2.cmml">α</mi><mo id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.1" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1"><in id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.1"></in><ci id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.2">𝛼</ci><apply id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.4.m4.1c">\alpha\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.4.m4.1d">italic_α ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, which is defined as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathsf{GATE}(\tilde{\mathtt{x}}^{CF}_{i},\mathtt{x}^{SM}_{i}[t]%
;\Theta_{\mathsf{G}})" class="ltx_Math" display="inline" id="S3.Ex1.m2.4"><semantics id="S3.Ex1.m2.4a"><mrow id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml"><mi id="S3.Ex1.m2.4.4.5" xref="S3.Ex1.m2.4.4.5.cmml"></mi><mo id="S3.Ex1.m2.4.4.4" xref="S3.Ex1.m2.4.4.4.cmml">=</mo><mrow id="S3.Ex1.m2.4.4.3" xref="S3.Ex1.m2.4.4.3.cmml"><mi id="S3.Ex1.m2.4.4.3.5" xref="S3.Ex1.m2.4.4.3.5.cmml">𝖦𝖠𝖳𝖤</mi><mo id="S3.Ex1.m2.4.4.3.4" xref="S3.Ex1.m2.4.4.3.4.cmml">⁢</mo><mrow id="S3.Ex1.m2.4.4.3.3.3" xref="S3.Ex1.m2.4.4.3.3.4.cmml"><mo id="S3.Ex1.m2.4.4.3.3.3.4" stretchy="false" xref="S3.Ex1.m2.4.4.3.3.4.cmml">(</mo><msubsup id="S3.Ex1.m2.2.2.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.cmml"><mover accent="true" id="S3.Ex1.m2.2.2.1.1.1.1.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.2.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2.2.cmml">𝚡</mi><mo id="S3.Ex1.m2.2.2.1.1.1.1.2.2.1" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.Ex1.m2.2.2.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.3.cmml">i</mi><mrow id="S3.Ex1.m2.2.2.1.1.1.1.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.2.3.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.Ex1.m2.2.2.1.1.1.1.2.3.1" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m2.2.2.1.1.1.1.2.3.3" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.Ex1.m2.4.4.3.3.3.5" xref="S3.Ex1.m2.4.4.3.3.4.cmml">,</mo><mrow id="S3.Ex1.m2.3.3.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.cmml"><msubsup id="S3.Ex1.m2.3.3.2.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.2.cmml"><mi id="S3.Ex1.m2.3.3.2.2.2.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.2.cmml">𝚡</mi><mi id="S3.Ex1.m2.3.3.2.2.2.2.2.3" xref="S3.Ex1.m2.3.3.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.2" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.2.cmml">S</mi><mo id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.1" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.3" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.Ex1.m2.3.3.2.2.2.2.1" xref="S3.Ex1.m2.3.3.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.3.3.2.2.2.2.3.2" xref="S3.Ex1.m2.3.3.2.2.2.2.3.1.cmml"><mo id="S3.Ex1.m2.3.3.2.2.2.2.3.2.1" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.2.2.3.1.1.cmml">[</mo><mi id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">t</mi><mo id="S3.Ex1.m2.3.3.2.2.2.2.3.2.2" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex1.m2.4.4.3.3.3.6" xref="S3.Ex1.m2.4.4.3.3.4.cmml">;</mo><msub id="S3.Ex1.m2.4.4.3.3.3.3" xref="S3.Ex1.m2.4.4.3.3.3.3.cmml"><mi id="S3.Ex1.m2.4.4.3.3.3.3.2" mathvariant="normal" xref="S3.Ex1.m2.4.4.3.3.3.3.2.cmml">Θ</mi><mi id="S3.Ex1.m2.4.4.3.3.3.3.3" xref="S3.Ex1.m2.4.4.3.3.3.3.3.cmml">𝖦</mi></msub><mo id="S3.Ex1.m2.4.4.3.3.3.7" stretchy="false" xref="S3.Ex1.m2.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.4b"><apply id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4"><eq id="S3.Ex1.m2.4.4.4.cmml" xref="S3.Ex1.m2.4.4.4"></eq><csymbol cd="latexml" id="S3.Ex1.m2.4.4.5.cmml" xref="S3.Ex1.m2.4.4.5">absent</csymbol><apply id="S3.Ex1.m2.4.4.3.cmml" xref="S3.Ex1.m2.4.4.3"><times id="S3.Ex1.m2.4.4.3.4.cmml" xref="S3.Ex1.m2.4.4.3.4"></times><ci id="S3.Ex1.m2.4.4.3.5.cmml" xref="S3.Ex1.m2.4.4.3.5">𝖦𝖠𝖳𝖤</ci><vector id="S3.Ex1.m2.4.4.3.3.4.cmml" xref="S3.Ex1.m2.4.4.3.3.3"><apply id="S3.Ex1.m2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1">subscript</csymbol><apply id="S3.Ex1.m2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m2.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2"><ci id="S3.Ex1.m2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2.1">~</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.2.2">𝚡</ci></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3"><times id="S3.Ex1.m2.2.2.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.1"></times><ci id="S3.Ex1.m2.2.2.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.Ex1.m2.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Ex1.m2.3.3.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2"><times id="S3.Ex1.m2.3.3.2.2.2.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.1"></times><apply id="S3.Ex1.m2.3.3.2.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.2.2.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2">subscript</csymbol><apply id="S3.Ex1.m2.3.3.2.2.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.2.2.2.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2">superscript</csymbol><ci id="S3.Ex1.m2.3.3.2.2.2.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.2">𝚡</ci><apply id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3"><times id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.1"></times><ci id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.2">𝑆</ci><ci id="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.Ex1.m2.3.3.2.2.2.2.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m2.3.3.2.2.2.2.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.3.2"><csymbol cd="latexml" id="S3.Ex1.m2.3.3.2.2.2.2.3.1.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝑡</ci></apply></apply><apply id="S3.Ex1.m2.4.4.3.3.3.3.cmml" xref="S3.Ex1.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.4.4.3.3.3.3.1.cmml" xref="S3.Ex1.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.Ex1.m2.4.4.3.3.3.3.2.cmml" xref="S3.Ex1.m2.4.4.3.3.3.3.2">Θ</ci><ci id="S3.Ex1.m2.4.4.3.3.3.3.3.cmml" xref="S3.Ex1.m2.4.4.3.3.3.3.3">𝖦</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.4c">\displaystyle=\mathsf{GATE}(\tilde{\mathtt{x}}^{CF}_{i},\mathtt{x}^{SM}_{i}[t]%
;\Theta_{\mathsf{G}})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.4d">= sansserif_GATE ( over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] ; roman_Θ start_POSTSUBSCRIPT sansserif_G end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathsf{MLP}(\tilde{\mathtt{x}}^{CF}_{i};\Theta_{\mathsf{G}_{1}}%
)+\mathsf{MLP}(\mathtt{x}^{SM}_{i}[t];\Theta_{\mathsf{G}_{2}})," class="ltx_Math" display="inline" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.6" xref="S3.E3.m1.2.2.1.1.6.cmml"></mi><mo id="S3.E3.m1.2.2.1.1.5" xref="S3.E3.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml"><mrow id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.4" xref="S3.E3.m1.2.2.1.1.2.2.4.cmml">𝖬𝖫𝖯</mi><mo id="S3.E3.m1.2.2.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝚡</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">C</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">F</mi></mrow></msubsup><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.4" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml">;</mo><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml">Θ</mi><msub id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.cmml">𝖦</mi><mn id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.cmml">1</mn></msub></msub><mo id="S3.E3.m1.2.2.1.1.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.4.5" xref="S3.E3.m1.2.2.1.1.4.5.cmml">+</mo><mrow id="S3.E3.m1.2.2.1.1.4.4" xref="S3.E3.m1.2.2.1.1.4.4.cmml"><mi id="S3.E3.m1.2.2.1.1.4.4.4" xref="S3.E3.m1.2.2.1.1.4.4.4.cmml">𝖬𝖫𝖯</mi><mo id="S3.E3.m1.2.2.1.1.4.4.3" xref="S3.E3.m1.2.2.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.4.4.2.2" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.1.1.1" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.2.cmml">𝚡</mi><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.2" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.2.cmml">S</mi><mo id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.1" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.3" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.E3.m1.2.2.1.1.3.3.1.1.1.1" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.1.cmml"><mo id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">t</mi><mo id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.4" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">;</mo><msub id="S3.E3.m1.2.2.1.1.4.4.2.2.2" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.4.4.2.2.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.2.cmml">Θ</mi><msub id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.2" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.2.cmml">𝖦</mi><mn id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.3" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.E3.m1.2.2.1.1.4.4.2.2.5" stretchy="false" xref="S3.E3.m1.2.2.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.1.1.5"></eq><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.6.cmml" xref="S3.E3.m1.2.2.1.1.6">absent</csymbol><apply id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"><plus id="S3.E3.m1.2.2.1.1.4.5.cmml" xref="S3.E3.m1.2.2.1.1.4.5"></plus><apply id="S3.E3.m1.2.2.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2"><times id="S3.E3.m1.2.2.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.3"></times><ci id="S3.E3.m1.2.2.1.1.2.2.4.cmml" xref="S3.E3.m1.2.2.1.1.2.2.4">𝖬𝖫𝖯</ci><list id="S3.E3.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2"><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝚡</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝐶</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2">Θ</ci><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.2">𝖦</ci><cn id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.E3.m1.2.2.1.1.4.4.cmml" xref="S3.E3.m1.2.2.1.1.4.4"><times id="S3.E3.m1.2.2.1.1.4.4.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.3"></times><ci id="S3.E3.m1.2.2.1.1.4.4.4.cmml" xref="S3.E3.m1.2.2.1.1.4.4.4">𝖬𝖫𝖯</ci><list id="S3.E3.m1.2.2.1.1.4.4.2.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2"><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1"><times id="S3.E3.m1.2.2.1.1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.1"></times><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.2">𝚡</ci><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3"><times id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.2">𝑆</ci><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.2"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.1.1.cmml" xref="S3.E3.m1.2.2.1.1.3.3.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.4.4.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.4.4.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.2">Θ</ci><apply id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.2">𝖦</ci><cn id="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.4.4.2.2.2.3.3">2</cn></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle=\mathsf{MLP}(\tilde{\mathtt{x}}^{CF}_{i};\Theta_{\mathsf{G}_{1}}%
)+\mathsf{MLP}(\mathtt{x}^{SM}_{i}[t];\Theta_{\mathsf{G}_{2}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">= sansserif_MLP ( over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; roman_Θ start_POSTSUBSCRIPT sansserif_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) + sansserif_MLP ( typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] ; roman_Θ start_POSTSUBSCRIPT sansserif_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.9">where <math alttext="\Theta_{\mathsf{G}}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.5.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.5.m1.1a"><msub id="S3.SS3.SSS0.Px2.p2.5.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.2" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1.2.cmml">Θ</mi><mi id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1.3.cmml">𝖦</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.5.m1.1b"><apply id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1.2">Θ</ci><ci id="S3.SS3.SSS0.Px2.p2.5.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.5.m1.1.1.3">𝖦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.5.m1.1c">\Theta_{\mathsf{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.5.m1.1d">roman_Θ start_POSTSUBSCRIPT sansserif_G end_POSTSUBSCRIPT</annotation></semantics></math> = <math alttext="\left\{\Theta_{\mathsf{G}_{1}},\Theta_{\mathsf{G}_{2}}\right\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.6.m2.2"><semantics id="S3.SS3.SSS0.Px2.p2.6.m2.2a"><mrow id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.3.cmml"><mo id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.3.cmml">{</mo><msub id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.2" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.2.cmml">Θ</mi><msub id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.2.cmml">𝖦</mi><mn id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.4" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.2" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.2.cmml">Θ</mi><msub id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.2" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.2.cmml">𝖦</mi><mn id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.3" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.5" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.6.m2.2b"><set id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2"><apply id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.2">Θ</ci><apply id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.2">𝖦</ci><cn id="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.6.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.2">Θ</ci><apply id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.2">𝖦</ci><cn id="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.6.m2.2.2.2.2.3.3">2</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.6.m2.2c">\left\{\Theta_{\mathsf{G}_{1}},\Theta_{\mathsf{G}_{2}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.6.m2.2d">{ roman_Θ start_POSTSUBSCRIPT sansserif_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math> is the set of trainable parameters. Finally, we utilize the weight vector <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.7.m3.1"><semantics id="S3.SS3.SSS0.Px2.p2.7.m3.1a"><mi id="S3.SS3.SSS0.Px2.p2.7.m3.1.1" xref="S3.SS3.SSS0.Px2.p2.7.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.7.m3.1b"><ci id="S3.SS3.SSS0.Px2.p2.7.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.7.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.7.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.7.m3.1d">italic_α</annotation></semantics></math>, which is adapted to the collaborative signal and semantic knowledge of each item, to fuse the LLM embedding <math alttext="\mathtt{x}^{SM}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.8.m4.1"><semantics id="S3.SS3.SSS0.Px2.p2.8.m4.1a"><msubsup id="S3.SS3.SSS0.Px2.p2.8.m4.1.1" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.2.cmml">𝚡</mi><mi id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.3" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.2" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.2.cmml">S</mi><mo id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.1" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.3" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.3.cmml">M</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.8.m4.1b"><apply id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.2">𝚡</ci><apply id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3"><times id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.2">𝑆</ci><ci id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.2.3.3">𝑀</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p2.8.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.8.m4.1c">\mathtt{x}^{SM}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.8.m4.1d">typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the aligned CF embedding <math alttext="\tilde{\mathtt{x}}^{CF}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.9.m5.1"><semantics id="S3.SS3.SSS0.Px2.p2.9.m5.1a"><msubsup id="S3.SS3.SSS0.Px2.p2.9.m5.1.1" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.2" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.1" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.3.cmml">i</mi><mrow id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.2" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.1" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.3" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.9.m5.1b"><apply id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2"><ci id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.2.2">𝚡</ci></apply><apply id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3"><times id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p2.9.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.9.m5.1c">\tilde{\mathtt{x}}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.9.m5.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, as follows.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\alpha\odot%
\tilde{\mathtt{x}}^{CF}_{i}," class="ltx_Math" display="inline" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><msub id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.cmml">𝚡</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.1" xref="S3.E4.m1.3.3.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.E4.m1.3.3.1.1.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.3.3.1.1.2.1" xref="S3.E4.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.2.3.1.cmml"><mo id="S3.E4.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.1.1.cmml">[</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mrow id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><msubsup id="S3.E4.m1.3.3.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml">𝚡</mi><mi id="S3.E4.m1.3.3.1.1.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E4.m1.3.3.1.1.3.2.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.2.cmml">S</mi><mo id="S3.E4.m1.3.3.1.1.3.2.2.2.3.1" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.3.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S3.E4.m1.3.3.1.1.3.2.1" xref="S3.E4.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.3.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.3.1.cmml"><mo id="S3.E4.m1.3.3.1.1.3.2.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.3.2.3.1.1.cmml">[</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.3.2.3.2.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.3.1" xref="S3.E4.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.3.3.2.cmml">α</mi><mo id="S3.E4.m1.3.3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.3.3.1.cmml">⊙</mo><msubsup id="S3.E4.m1.3.3.1.1.3.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.3.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.cmml">𝚡</mi><mo id="S3.E4.m1.3.3.1.1.3.3.3.2.2.1" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.E4.m1.3.3.1.1.3.3.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.3.cmml">i</mi><mrow id="S3.E4.m1.3.3.1.1.3.3.3.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.3.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.2.cmml">C</mi><mo id="S3.E4.m1.3.3.1.1.3.3.3.2.3.1" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.3.cmml">F</mi></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"></eq><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><times id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.1"></times><apply id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2"><ci id="S3.E4.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.1">~</ci><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2">𝚡</ci></apply><ci id="S3.E4.m1.3.3.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.3.3.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.2.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><plus id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1"></plus><apply id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2"><times id="S3.E4.m1.3.3.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.1"></times><apply id="S3.E4.m1.3.3.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2">𝚡</ci><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3"><times id="S3.E4.m1.3.3.1.1.3.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.2">𝑆</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S3.E4.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3.2"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.3.2.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.3.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1">direct-product</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2">𝛼</ci><apply id="S3.E4.m1.3.3.1.1.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2"><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.1">~</ci><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2">𝚡</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3"><times id="S3.E4.m1.3.3.1.1.3.3.3.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.2">𝐶</ci><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.3.3">𝐹</ci></apply></apply><ci id="S3.E4.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\alpha\odot%
\tilde{\mathtt{x}}^{CF}_{i},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] = typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] + italic_α ⊙ over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.10">where the operator <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.10.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.10.m1.1a"><mo id="S3.SS3.SSS0.Px2.p2.10.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.10.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.10.m1.1b"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p2.10.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.10.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.10.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.10.m1.1d">⊙</annotation></semantics></math> represents element-wise multiplication.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p3">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p3.6">Finally, we use the mapped and fused embeddings to assemble the embedding sequence, which is fed into the LLM for prediction. For each token in the prompt <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.1.m1.2"><semantics id="S3.SS3.SSS0.Px2.p3.1.m1.2a"><msub id="S3.SS3.SSS0.Px2.p3.1.m1.2.3" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p3.1.m1.2.3.2" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.3.2.cmml">𝚙</mi><mrow id="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.4" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p3.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p3.1.m1.1.1.1.1.cmml">u</mi><mo id="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.2" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.1.m1.2b"><apply id="S3.SS3.SSS0.Px2.p3.1.m1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.1.m1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p3.1.m1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.3.2">𝚙</ci><list id="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.1.1.1.1">𝑢</ci><ci id="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.1.m1.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.1.m1.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we replace it with the corresponding embedding following the same rules as in the mapping step. (1) If it is a natural language token, we replace it with its LLM embedding, which is denoted by the grey parts in the embedding sequence in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.F2" title="Figure 2 ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(b-2). (2) If it is a placeholder for a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p3.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.2.m2.1d">italic_u</annotation></semantics></math>, we replace it with the aligned CF embedding <math alttext="\tilde{\mathtt{x}}^{CF}_{u}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p3.3.m3.1a"><msubsup id="S3.SS3.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.2" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.1" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.3.cmml">u</mi><mrow id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.2" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.2.cmml">C</mi><mo id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.1" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.3" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2"><ci id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.2.2">𝚡</ci></apply><apply id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3"><times id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p3.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.3.m3.1c">\tilde{\mathtt{x}}^{CF}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.3.m3.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, which is denoted by the purple part. (3) If it is a placeholder for an item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.4.m4.1"><semantics id="S3.SS3.SSS0.Px2.p3.4.m4.1a"><mi id="S3.SS3.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.4.m4.1b"><ci id="S3.SS3.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.4.m4.1d">italic_i</annotation></semantics></math>, we replace it with <math alttext="\tilde{\mathtt{x}}_{i}=\{\tilde{\mathtt{x}}_{i}[1],\tilde{\mathtt{x}}_{i}[2],%
\dots,\tilde{\mathtt{x}}_{i}[T_{i}]\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.5.m5.6"><semantics id="S3.SS3.SSS0.Px2.p3.5.m5.6a"><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.6.6" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.cmml"><msub id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.cmml"><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.4" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.4.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml"><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.4" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml">{</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.cmml"><msub id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.1.cmml"><mo id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.1.1.cmml">[</mo><mn id="S3.SS3.SSS0.Px2.p3.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.1.1.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.2.2" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.5" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml">,</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.cmml"><msub id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.1.cmml"><mo id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.1.1.cmml">[</mo><mn id="S3.SS3.SSS0.Px2.p3.5.m5.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.2.2.cmml">2</mn><mo id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.2.2" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.6" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p3.5.m5.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p3.5.m5.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.7" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml">,</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.cmml"><msub id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.cmml"><mover accent="true" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.cmml"><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.2.cmml">𝚡</mi><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.1.cmml">~</mo></mover><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.2.cmml"><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.2.1.cmml">[</mo><msub id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.2" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.2.cmml">T</mi><mi id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.3" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.8" stretchy="false" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.5.m5.6b"><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6"><eq id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.4.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.4"></eq><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2"><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.2.2">𝚡</ci></apply><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.5.3">𝑖</ci></apply><set id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.4.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3"><apply id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1"><times id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.1"></times><apply id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2"><ci id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.2.2">𝚡</ci></apply><ci id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.4.4.1.1.1.3.2.1">delimited-[]</csymbol><cn id="S3.SS3.SSS0.Px2.p3.5.m5.1.1.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p3.5.m5.1.1">1</cn></apply></apply><apply id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2"><times id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.1"></times><apply id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2"><ci id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.2.2">𝚡</ci></apply><ci id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.5.5.2.2.2.3.2.1">delimited-[]</csymbol><cn id="S3.SS3.SSS0.Px2.p3.5.m5.2.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p3.5.m5.2.2">2</cn></apply></apply><ci id="S3.SS3.SSS0.Px2.p3.5.m5.3.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.3.3">…</ci><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3"><times id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.2"></times><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3">subscript</csymbol><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2"><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.1">~</ci><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.2.2">𝚡</ci></apply><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.2">𝑇</ci><ci id="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p3.5.m5.6.6.3.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.5.m5.6c">\tilde{\mathtt{x}}_{i}=\{\tilde{\mathtt{x}}_{i}[1],\tilde{\mathtt{x}}_{i}[2],%
\dots,\tilde{\mathtt{x}}_{i}[T_{i}]\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.5.m5.6d">over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 1 ] , over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 2 ] , … , over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] }</annotation></semantics></math>, which is denoted by the green-orange mixture. The embeddings are concatenated in the same sequence as the tokens in the prompt sequence <math alttext="\mathtt{p}_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p3.6.m6.2"><semantics id="S3.SS3.SSS0.Px2.p3.6.m6.2a"><msub id="S3.SS3.SSS0.Px2.p3.6.m6.2.3" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p3.6.m6.2.3.2" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.3.2.cmml">𝚙</mi><mrow id="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.4" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p3.6.m6.1.1.1.1" xref="S3.SS3.SSS0.Px2.p3.6.m6.1.1.1.1.cmml">u</mi><mo id="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.4.1" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.2" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p3.6.m6.2b"><apply id="S3.SS3.SSS0.Px2.p3.6.m6.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p3.6.m6.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p3.6.m6.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.3.2">𝚙</ci><list id="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.4"><ci id="S3.SS3.SSS0.Px2.p3.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.1.1.1.1">𝑢</ci><ci id="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p3.6.m6.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p3.6.m6.2c">\mathtt{p}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p3.6.m6.2d">typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Training</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In this section, we describe how we optimize <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.1">CCF-LLM</span>, including the learning objectives as well as our two-stage training strategy.</p>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Learning Objectives</h4>
<div class="ltx_para" id="S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.8">Though a pre-trained LLM can perform many tasks in a zero-shot setting, it has not been specifically trained on collaborative signals. Thus, it is suboptimal to directly utilize the fused embedding sequence for recommendation without fine-tuning.
Following the prevalent training paradigm in existing LLM4Rec works,
we adopt the LoRA module <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib21" title="">2022</a>)</cite> to tune the LLM. LoRA trains pairs of low-rank weights as an adaptor with significantly fewer parameters in comparison to the LLM, instead of updating all its trainable parameters. Hence, the full set of trainable parameters in our <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.SSS0.Px1.p1.8.1">CCF-LLM</span> is <math alttext="\Theta=\left\{\Theta_{\mathsf{E}},\Theta_{\mathsf{A}},\Theta_{\mathsf{G}},%
\Theta_{\mathsf{L}}\right\}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.1.m1.4"><semantics id="S3.SS4.SSS0.Px1.p1.1.m1.4a"><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.4.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.6" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.6.cmml">Θ</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.5" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.5.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml"><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.5" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml">{</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">𝖤</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.6" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml">𝖠</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.7" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.cmml">𝖦</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.8" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml">,</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.3.cmml">𝖫</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.9" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.1.m1.4b"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4"><eq id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.5.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.5"></eq><ci id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.6.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.6">Θ</ci><set id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.5.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">𝖤</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.2.2.2.2.2.3">𝖠</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.3.3.3.3.3.3">𝖦</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.4.4.4.4.4.3">𝖫</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.1.m1.4c">\Theta=\left\{\Theta_{\mathsf{E}},\Theta_{\mathsf{A}},\Theta_{\mathsf{G}},%
\Theta_{\mathsf{L}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.1.m1.4d">roman_Θ = { roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_G end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_L end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="\Theta_{\mathsf{L}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.3.cmml">𝖫</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.3">𝖫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.2.m2.1c">\Theta_{\mathsf{L}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.2.m2.1d">roman_Θ start_POSTSUBSCRIPT sansserif_L end_POSTSUBSCRIPT</annotation></semantics></math> is the set of LoRA weights. Note that the tuning of <math alttext="\Theta_{\mathsf{E}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3.cmml">𝖤</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3">𝖤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.3.m3.1c">\Theta_{\mathsf{E}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.3.m3.1d">roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT</annotation></semantics></math> is optional as it is already pre-trained, and we only use the <math alttext="\mathsf{ENC}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml">𝖤𝖭𝖢</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1">𝖤𝖭𝖢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.4.m4.1c">\mathsf{ENC}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.4.m4.1d">sansserif_ENC</annotation></semantics></math> network from the CF-based model.
<math alttext="\Theta_{\mathsf{A}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS4.SSS0.Px1.p1.5.m5.1a"><msub id="S3.SS4.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.3.cmml">𝖠</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.5.m5.1.1.3">𝖠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.5.m5.1c">\Theta_{\mathsf{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.5.m5.1d">roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Theta_{\mathsf{G}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS4.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS4.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml">𝖦</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.6.m6.1.1.3">𝖦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.6.m6.1c">\Theta_{\mathsf{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.6.m6.1d">roman_Θ start_POSTSUBSCRIPT sansserif_G end_POSTSUBSCRIPT</annotation></semantics></math> are the training parameters of the <math alttext="\mathsf{ALG}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS4.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS4.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS4.SSS0.Px1.p1.7.m7.1.1.cmml">𝖠𝖫𝖦</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS4.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.7.m7.1.1">𝖠𝖫𝖦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.7.m7.1c">\mathsf{ALG}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.7.m7.1d">sansserif_ALG</annotation></semantics></math> and <math alttext="\mathsf{GATE}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS4.SSS0.Px1.p1.8.m8.1a"><mi id="S3.SS4.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1.cmml">𝖦𝖠𝖳𝖤</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.8.m8.1b"><ci id="S3.SS4.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.8.m8.1.1">𝖦𝖠𝖳𝖤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.8.m8.1c">\mathsf{GATE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.8.m8.1d">sansserif_GATE</annotation></semantics></math> networks, respectively.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p2.8">Conventional CTR models generate a Bernoulli distribution indicating the likelihood of interaction. In contrast, language models produce a probability distribution across the entire vocabulary, thereby differing from the output distribution of CTR models.
To align <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS0.Px1.p2.1.m1.1a"><mover accent="true" id="S3.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml">y</mi><mo id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1"><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1">^</ci><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.1.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.1.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> to the output of a conventional CTR model, we define the probability <math alttext="p_{\textit{yes}}=P(\hat{y}=\text{``Yes''}|\mathtt{p}_{u,i})" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.2.m2.3"><semantics id="S3.SS4.SSS0.Px1.p2.2.m2.3a"><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.cmml"><msub id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3a.cmml">yes</mtext></msub><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.2.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.3.cmml">P</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.2" stretchy="false" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.2.cmml">y</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.cmml"><mtext id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2a.cmml">“Yes”</mtext><mo fence="false" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.1.cmml">|</mo><msub id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.2.cmml">𝚙</mi><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.cmml">u</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.4.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.3" stretchy="false" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.2.m2.3b"><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3"><eq id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.2"></eq><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.3.3">yes</mtext></ci></apply><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1"><times id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.2"></times><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.3">𝑃</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1"><eq id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.1"></eq><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2"><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.1">^</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2a.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2"><mtext id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.2">“Yes”</mtext></ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.3.3.1.1.1.1.3.3.2">𝚙</ci><list id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.4"><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1">𝑢</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.2.m2.3c">p_{\textit{yes}}=P(\hat{y}=\text{``Yes''}|\mathtt{p}_{u,i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.2.m2.3d">italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT = italic_P ( over^ start_ARG italic_y end_ARG = “Yes” | typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> as the indicator of a positive prediction, and <math alttext="p_{\textit{no}}=P(\hat{y}=\text{``No''}|\mathtt{p}_{u,i})" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.3.m3.3"><semantics id="S3.SS4.SSS0.Px1.p2.3.m3.3a"><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.3.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.cmml"><msub id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3a.cmml">no</mtext></msub><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.3.cmml">P</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.2" stretchy="false" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.2.cmml">y</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.cmml"><mtext id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2a.cmml">“No”</mtext><mo fence="false" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.1.cmml">|</mo><msub id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.2.cmml">𝚙</mi><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.4" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.cmml">u</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.4.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.3" stretchy="false" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.3.m3.3b"><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3"><eq id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.2"></eq><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.3.3">no</mtext></ci></apply><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1"><times id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.2"></times><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.3">𝑃</ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1"><eq id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.1"></eq><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2"><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.1">^</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2a.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2"><mtext id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.2">“No”</mtext></ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.3.3.1.1.1.1.3.3.2">𝚙</ci><list id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.4"><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1">𝑢</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.3.m3.3c">p_{\textit{no}}=P(\hat{y}=\text{``No''}|\mathtt{p}_{u,i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.3.m3.3d">italic_p start_POSTSUBSCRIPT no end_POSTSUBSCRIPT = italic_P ( over^ start_ARG italic_y end_ARG = “No” | typewriter_p start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> as a negative prediction.
Here, “Yes” and “No” are two tokens in the LLM vocabulary. We optimize the LLM from two perspectives. First, we aim to align the predictions with the ground-truth label <math alttext="y" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS4.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS4.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS4.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.4.m4.1d">italic_y</annotation></semantics></math>. Second, we aim to further constrain the relationship between <math alttext="p_{\textit{yes}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS4.SSS0.Px1.p2.5.m5.1a"><msub id="S3.SS4.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3a.cmml">yes</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.5.m5.1.1.3">yes</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.5.m5.1c">p_{\textit{yes}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.5.m5.1d">italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="p_{\textit{no}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS4.SSS0.Px1.p2.6.m6.1a"><msub id="S3.SS4.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3a.cmml">no</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.6.m6.1.1.3">no</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.6.m6.1c">p_{\textit{no}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.6.m6.1d">italic_p start_POSTSUBSCRIPT no end_POSTSUBSCRIPT</annotation></semantics></math>, so that <math alttext="p_{\textit{yes}}&gt;p_{\textit{no}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS4.SSS0.Px1.p2.7.m7.1a"><mrow id="S3.SS4.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3a.cmml">yes</mtext></msub><mo id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1.cmml">&gt;</mo><msub id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3a.cmml">no</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1"><gt id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.1"></gt><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.2.3">yes</mtext></ci></apply><apply id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.2">𝑝</ci><ci id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3a.cmml" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3"><mtext class="ltx_mathvariant_italic" id="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3.cmml" mathsize="70%" xref="S3.SS4.SSS0.Px1.p2.7.m7.1.1.3.3">no</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.7.m7.1c">p_{\textit{yes}}&gt;p_{\textit{no}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.7.m7.1d">italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT &gt; italic_p start_POSTSUBSCRIPT no end_POSTSUBSCRIPT</annotation></semantics></math> if <math alttext="y=1" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.8.m8.1"><semantics id="S3.SS4.SSS0.Px1.p2.8.m8.1a"><mrow id="S3.SS4.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.2" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.2.cmml">y</mi><mo id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.1" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.3" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.8.m8.1b"><apply id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1"><eq id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.1"></eq><ci id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.2">𝑦</ci><cn id="S3.SS4.SSS0.Px1.p2.8.m8.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.8.m8.1c">y=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.8.m8.1d">italic_y = 1</annotation></semantics></math> and vice versa. Therefore, we optimize the LLM by minimizing the following loss.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\Theta}\mathcal{L}=\mathcal{L}_{1}(p_{\textit{yes}},y)+\mathcal{L}_{1}(p%
_{\textit{no}},1-y)+k\times\mathcal{L}_{2}(p_{\textit{yes}},p_{\textit{no}},y)," class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1.7" xref="S3.E5.m1.3.3.1.1.7.cmml"><munder id="S3.E5.m1.3.3.1.1.7.1" xref="S3.E5.m1.3.3.1.1.7.1.cmml"><mi id="S3.E5.m1.3.3.1.1.7.1.2" xref="S3.E5.m1.3.3.1.1.7.1.2.cmml">min</mi><mi id="S3.E5.m1.3.3.1.1.7.1.3" mathvariant="normal" xref="S3.E5.m1.3.3.1.1.7.1.3.cmml">Θ</mi></munder><mo id="S3.E5.m1.3.3.1.1.7a" lspace="0.167em" xref="S3.E5.m1.3.3.1.1.7.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.7.2" xref="S3.E5.m1.3.3.1.1.7.2.cmml">ℒ</mi></mrow><mo id="S3.E5.m1.3.3.1.1.6" xref="S3.E5.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.5" xref="S3.E5.m1.3.3.1.1.5.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.3.2.cmml">ℒ</mi><mn id="S3.E5.m1.3.3.1.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3a.cmml">yes</mtext></msub><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">y</mi><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.5.6" xref="S3.E5.m1.3.3.1.1.5.6.cmml">+</mo><mrow id="S3.E5.m1.3.3.1.1.3.3" xref="S3.E5.m1.3.3.1.1.3.3.cmml"><msub id="S3.E5.m1.3.3.1.1.3.3.4" xref="S3.E5.m1.3.3.1.1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.3.3.4.2" xref="S3.E5.m1.3.3.1.1.3.3.4.2.cmml">ℒ</mi><mn id="S3.E5.m1.3.3.1.1.3.3.4.3" xref="S3.E5.m1.3.3.1.1.3.3.4.3.cmml">1</mn></msub><mo id="S3.E5.m1.3.3.1.1.3.3.3" xref="S3.E5.m1.3.3.1.1.3.3.3.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.3.3.2.2" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml"><mo id="S3.E5.m1.3.3.1.1.3.3.2.2.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.2.2.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.3a.cmml">no</mtext></msub><mo id="S3.E5.m1.3.3.1.1.3.3.2.2.4" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml">,</mo><mrow id="S3.E5.m1.3.3.1.1.3.3.2.2.2" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.cmml"><mn id="S3.E5.m1.3.3.1.1.3.3.2.2.2.2" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.2.cmml">1</mn><mo id="S3.E5.m1.3.3.1.1.3.3.2.2.2.1" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.1.cmml">−</mo><mi id="S3.E5.m1.3.3.1.1.3.3.2.2.2.3" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.3.cmml">y</mi></mrow><mo id="S3.E5.m1.3.3.1.1.3.3.2.2.5" stretchy="false" xref="S3.E5.m1.3.3.1.1.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.5.6a" xref="S3.E5.m1.3.3.1.1.5.6.cmml">+</mo><mrow id="S3.E5.m1.3.3.1.1.5.5" xref="S3.E5.m1.3.3.1.1.5.5.cmml"><mrow id="S3.E5.m1.3.3.1.1.5.5.4" xref="S3.E5.m1.3.3.1.1.5.5.4.cmml"><mi id="S3.E5.m1.3.3.1.1.5.5.4.2" xref="S3.E5.m1.3.3.1.1.5.5.4.2.cmml">k</mi><mo id="S3.E5.m1.3.3.1.1.5.5.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.3.3.1.1.5.5.4.1.cmml">×</mo><msub id="S3.E5.m1.3.3.1.1.5.5.4.3" xref="S3.E5.m1.3.3.1.1.5.5.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.1.1.5.5.4.3.2" xref="S3.E5.m1.3.3.1.1.5.5.4.3.2.cmml">ℒ</mi><mn id="S3.E5.m1.3.3.1.1.5.5.4.3.3" xref="S3.E5.m1.3.3.1.1.5.5.4.3.3.cmml">2</mn></msub></mrow><mo id="S3.E5.m1.3.3.1.1.5.5.3" xref="S3.E5.m1.3.3.1.1.5.5.3.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.5.5.2.2" xref="S3.E5.m1.3.3.1.1.5.5.2.3.cmml"><mo id="S3.E5.m1.3.3.1.1.5.5.2.2.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.5.5.2.3.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.4.4.1.1.1" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.4.4.1.1.1.2" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.4.4.1.1.1.3" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.3a.cmml">yes</mtext></msub><mo id="S3.E5.m1.3.3.1.1.5.5.2.2.4" xref="S3.E5.m1.3.3.1.1.5.5.2.3.cmml">,</mo><msub id="S3.E5.m1.3.3.1.1.5.5.2.2.2" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.5.5.2.2.2.2" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.5.5.2.2.2.3" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.3a.cmml">no</mtext></msub><mo id="S3.E5.m1.3.3.1.1.5.5.2.2.5" xref="S3.E5.m1.3.3.1.1.5.5.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">y</mi><mo id="S3.E5.m1.3.3.1.1.5.5.2.2.6" stretchy="false" xref="S3.E5.m1.3.3.1.1.5.5.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.6.cmml" xref="S3.E5.m1.3.3.1.1.6"></eq><apply id="S3.E5.m1.3.3.1.1.7.cmml" xref="S3.E5.m1.3.3.1.1.7"><apply id="S3.E5.m1.3.3.1.1.7.1.cmml" xref="S3.E5.m1.3.3.1.1.7.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.7.1.1.cmml" xref="S3.E5.m1.3.3.1.1.7.1">subscript</csymbol><min id="S3.E5.m1.3.3.1.1.7.1.2.cmml" xref="S3.E5.m1.3.3.1.1.7.1.2"></min><ci id="S3.E5.m1.3.3.1.1.7.1.3.cmml" xref="S3.E5.m1.3.3.1.1.7.1.3">Θ</ci></apply><ci id="S3.E5.m1.3.3.1.1.7.2.cmml" xref="S3.E5.m1.3.3.1.1.7.2">ℒ</ci></apply><apply id="S3.E5.m1.3.3.1.1.5.cmml" xref="S3.E5.m1.3.3.1.1.5"><plus id="S3.E5.m1.3.3.1.1.5.6.cmml" xref="S3.E5.m1.3.3.1.1.5.6"></plus><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2"></times><apply id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.2">ℒ</ci><cn id="S3.E5.m1.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.1.1.3.3">1</cn></apply><interval closure="open" id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1"><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.3">yes</mtext></ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑦</ci></interval></apply><apply id="S3.E5.m1.3.3.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3"><times id="S3.E5.m1.3.3.1.1.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.3"></times><apply id="S3.E5.m1.3.3.1.1.3.3.4.cmml" xref="S3.E5.m1.3.3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3.3.4.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.4">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.3.3.4.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.4.2">ℒ</ci><cn id="S3.E5.m1.3.3.1.1.3.3.4.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.3.3.4.3">1</cn></apply><interval closure="open" id="S3.E5.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.2"><apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.3">no</mtext></ci></apply><apply id="S3.E5.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2"><minus id="S3.E5.m1.3.3.1.1.3.3.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.1"></minus><cn id="S3.E5.m1.3.3.1.1.3.3.2.2.2.2.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.2">1</cn><ci id="S3.E5.m1.3.3.1.1.3.3.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.3.3.2.2.2.3">𝑦</ci></apply></interval></apply><apply id="S3.E5.m1.3.3.1.1.5.5.cmml" xref="S3.E5.m1.3.3.1.1.5.5"><times id="S3.E5.m1.3.3.1.1.5.5.3.cmml" xref="S3.E5.m1.3.3.1.1.5.5.3"></times><apply id="S3.E5.m1.3.3.1.1.5.5.4.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4"><times id="S3.E5.m1.3.3.1.1.5.5.4.1.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4.1"></times><ci id="S3.E5.m1.3.3.1.1.5.5.4.2.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4.2">𝑘</ci><apply id="S3.E5.m1.3.3.1.1.5.5.4.3.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.5.5.4.3.1.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.5.5.4.3.2.cmml" xref="S3.E5.m1.3.3.1.1.5.5.4.3.2">ℒ</ci><cn id="S3.E5.m1.3.3.1.1.5.5.4.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.5.5.4.3.3">2</cn></apply></apply><vector id="S3.E5.m1.3.3.1.1.5.5.2.3.cmml" xref="S3.E5.m1.3.3.1.1.5.5.2.2"><apply id="S3.E5.m1.3.3.1.1.4.4.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.4.4.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.3.3.1.1.4.4.1.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.4.4.1.1.1.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.1.1.4.4.1.1.1.3">yes</mtext></ci></apply><apply id="S3.E5.m1.3.3.1.1.5.5.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.5.5.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.5.5.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.2">𝑝</ci><ci id="S3.E5.m1.3.3.1.1.5.5.2.2.2.3a.cmml" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.3"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.3.3.1.1.5.5.2.2.2.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.1.1.5.5.2.2.2.3">no</mtext></ci></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑦</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\min_{\Theta}\mathcal{L}=\mathcal{L}_{1}(p_{\textit{yes}},y)+\mathcal{L}_{1}(p%
_{\textit{no}},1-y)+k\times\mathcal{L}_{2}(p_{\textit{yes}},p_{\textit{no}},y),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">roman_min start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT caligraphic_L = caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT , italic_y ) + caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT no end_POSTSUBSCRIPT , 1 - italic_y ) + italic_k × caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT no end_POSTSUBSCRIPT , italic_y ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p2.13">where <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.9.m1.1"><semantics id="S3.SS4.SSS0.Px1.p2.9.m1.1a"><msub id="S3.SS4.SSS0.Px1.p2.9.m1.1.1" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.9.m1.1b"><apply id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1.2">ℒ</ci><cn id="S3.SS4.SSS0.Px1.p2.9.m1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.9.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.9.m1.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.9.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> denotes a classification loss that corresponds to the first goal and <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.10.m2.1"><semantics id="S3.SS4.SSS0.Px1.p2.10.m2.1a"><msub id="S3.SS4.SSS0.Px1.p2.10.m2.1.1" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.2" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.3" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.10.m2.1b"><apply id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1.2">ℒ</ci><cn id="S3.SS4.SSS0.Px1.p2.10.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.10.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.10.m2.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.10.m2.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is a ranking loss that corresponds to the second goal. We implement <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.11.m3.1"><semantics id="S3.SS4.SSS0.Px1.p2.11.m3.1a"><msub id="S3.SS4.SSS0.Px1.p2.11.m3.1.1" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.2" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.3" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.11.m3.1b"><apply id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1.2">ℒ</ci><cn id="S3.SS4.SSS0.Px1.p2.11.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.11.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.11.m3.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.11.m3.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> as a binary cross-entropy (BCE) loss and <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.12.m4.1"><semantics id="S3.SS4.SSS0.Px1.p2.12.m4.1a"><msub id="S3.SS4.SSS0.Px1.p2.12.m4.1.1" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.2" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.3" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.12.m4.1b"><apply id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1.2">ℒ</ci><cn id="S3.SS4.SSS0.Px1.p2.12.m4.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px1.p2.12.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.12.m4.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.12.m4.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> as a Bayesian personalized ranking (BPR) loss <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib38" title="">2009</a>)</cite>. <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.13.m5.1"><semantics id="S3.SS4.SSS0.Px1.p2.13.m5.1a"><mi id="S3.SS4.SSS0.Px1.p2.13.m5.1.1" xref="S3.SS4.SSS0.Px1.p2.13.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.13.m5.1b"><ci id="S3.SS4.SSS0.Px1.p2.13.m5.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.13.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.13.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.13.m5.1d">italic_k</annotation></semantics></math> is a scalar to balance the weight between the two objectives.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Two-stage Training</h4>
<div class="ltx_para" id="S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.7">A straightforward training strategy is to train all parameters together in an end-to-end manner. Nevertheless, as empirically suggested <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite>, this approach could potentially diminish LLM4Rec performance, particularly in cold-start situations. In particular, before the convergence of the end-to-end tuning,
the LLM may misguide the training of attentive cross-modal fusion. Consequently, we employ a two-stage training setting, a technique also used earlier <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite>. Specifically, we divide <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.1.m1.1d">roman_Θ</annotation></semantics></math> into <math alttext="\Theta_{1}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.2.m2.1c">\Theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.2.m2.1d">roman_Θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Theta_{2}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.3.m3.1c">\Theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.3.m3.1d">roman_Θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, two non-overlapping subsets such that <math alttext="\Theta_{1}=\left\{\Theta_{\mathsf{L}}\right\}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.2.cmml">{</mo><msub id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.3.cmml">𝖫</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1"><eq id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2"></eq><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.3">1</cn></apply><set id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1"><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.1.1.3">𝖫</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.4.m4.1c">\Theta_{1}=\left\{\Theta_{\mathsf{L}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.4.m4.1d">roman_Θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = { roman_Θ start_POSTSUBSCRIPT sansserif_L end_POSTSUBSCRIPT }</annotation></semantics></math>, and <math alttext="\Theta_{2}=\left\{\Theta_{\mathsf{E}},\Theta_{\mathsf{A}},\Theta_{\mathsf{G}}\right\}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.5.m5.3"><semantics id="S3.SS4.SSS0.Px2.p1.5.m5.3a"><mrow id="S3.SS4.SSS0.Px2.p1.5.m5.3.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.cmml"><msub id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.cmml"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.3.cmml">2</mn></msub><mo id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.4" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml"><mo id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.4" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml">{</mo><msub id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.cmml">𝖤</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.5" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml">,</mo><msub id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.3.cmml">𝖠</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.6" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml">,</mo><msub id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml">Θ</mi><mi id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.3" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml">𝖦</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.7" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.5.m5.3b"><apply id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3"><eq id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.4.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.4"></eq><apply id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.5.3">2</cn></apply><set id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.4.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3"><apply id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.2">Θ</ci><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.1.1.1.3">𝖤</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.2">Θ</ci><ci id="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.2.2.2.2.2.3">𝖠</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.2">Θ</ci><ci id="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.3.3.3.3.3.3">𝖦</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.5.m5.3c">\Theta_{2}=\left\{\Theta_{\mathsf{E}},\Theta_{\mathsf{A}},\Theta_{\mathsf{G}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.5.m5.3d">roman_Θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = { roman_Θ start_POSTSUBSCRIPT sansserif_E end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_A end_POSTSUBSCRIPT , roman_Θ start_POSTSUBSCRIPT sansserif_G end_POSTSUBSCRIPT }</annotation></semantics></math>. We first minimize Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E5" title="In Learning Objectives ‣ 3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>), updating only <math alttext="\Theta_{1}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS4.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS4.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.6.m6.1c">\Theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.6.m6.1d">roman_Θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> until it converges, followed by minimizing Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E5" title="In Learning Objectives ‣ 3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>) through the sole updating of <math alttext="\Theta_{2}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS4.SSS0.Px2.p1.7.m7.1a"><msub id="S3.SS4.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.2" mathvariant="normal" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.2.cmml">Θ</mi><mn id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.2">Θ</ci><cn id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.7.m7.1c">\Theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.7.m7.1d">roman_Θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> until it also converges.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p2.2">The intuition of the two-stage training is as follows: after the first stage, the LLM has been adapted to the recommendation task. However, at this point, the collaborative signal is still plagued with noises because both <math alttext="\mathsf{ALG}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS4.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS4.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p2.1.m1.1.1.cmml">𝖠𝖫𝖦</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS4.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.1.m1.1.1">𝖠𝖫𝖦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.1.m1.1c">\mathsf{ALG}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.1.m1.1d">sansserif_ALG</annotation></semantics></math> and <math alttext="\mathsf{GATE}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS4.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.cmml">𝖦𝖠𝖳𝖤</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1">𝖦𝖠𝖳𝖤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.2.m2.1c">\mathsf{GATE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.2.m2.1d">sansserif_GATE</annotation></semantics></math> networks are not trained well, thereby curtailing the recommendation capability. As a result, in the second stage, we strive to augment the representation potential of the collaborative signals by focusing on the attentive cross-modal fusion. Given that the LLM has already been tuned, for efficiency we do not further fine-tune it during the second stage.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Comparison to Existing Work</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">For a fair comparison with existing LLM4Rec, we focus on the different approaches to incorporating collaborative signals. Thus, we intentionally adopt a similar input prompt format as existing work such as CoLLM <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite> and LLaRA <cite class="ltx_cite ltx_citemacro_citep">(Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite>. However, our proposed <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p1.1.1">CCF-LLM</span> is different from them in the following three aspects.</p>
</div>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Motivation</h4>
<div class="ltx_para" id="S3.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px1.p1.1">At a high level, existing work <cite class="ltx_cite ltx_citemacro_citep">(Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite> aims to incorporate the collaborative signals by directly injecting into LLMs the latent embeddings pre-trained by a disparate CF model. However, our <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.SSS0.Px1.p1.1.1">CCF-LLM</span> aims to solve the problem that LLM cannot effectively understand the CF embeddings by unifying both modalities in a single space rather than just introducing a new modality, as further explained below.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Hybrid Prompt Translation</h4>
<div class="ltx_para" id="S3.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px2.p1.1">In existing work <cite class="ltx_cite ltx_citemacro_citep">(Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite>, the hybrid prompt encodes texts and collaborative signals separately in different fields (i.e., tokens) without considering their fusion. In <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.SSS0.Px2.p1.1.1">CCF-LLM</span>, we utilize a single token to unify the representation of the two modalities for each item, and further consider the following fusion steps.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Mapping and Fusion of Two Modalities</h4>
<div class="ltx_para" id="S3.SS5.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px3.p1.1">In existing work, there is no fusion of the two modalities. Both latent embeddings for semantic knowledge (compatible with a pre-trained LLM) and collaborative signals (extracted from a pre-trained CF model) are fed into an LLM as is. However, in <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.SSS0.Px3.p1.1.1">CCF-LLM</span>, we fuse the two modalities with a trainable cross-gate mechanism.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS0.Px3.p2">
<p class="ltx_p" id="S3.SS5.SSS0.Px3.p2.1">To sum up, though some existing work has realized the importance of introducing collaborative signals, they merely inject the pre-trained collaborative signals directly into LLMs, overlooking the disparity between the two modalities. Thus, LLMs may not be able to understand the pre-trained collaborative signals. In contrast, <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.SSS0.Px3.p2.1.1">CCF-LLM</span> utilizes the attentive cross-modal fusion strategy to fully fuse the latent embeddings for these two heterogeneous modalities in a single space for the first time in the field of LLM4Rec. Compared to these previous methods, we offer a new insight into fusing the two modalities in the LLM4Rec paradigm.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we first elaborate on our experimental settings. Then, we evaluate our <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.1">CCF-LLM</span> on the real-world CTR task and address the following research questions (RQs). <span class="ltx_text ltx_font_bold" id="S4.p1.1.2">RQ1</span>: Can LLMs utilize collaborative signals solely through natural language descriptions without CF embeddings? <span class="ltx_text ltx_font_bold" id="S4.p1.1.3">RQ2</span>: Can our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.4">CCF-LLM</span> fully leverage collaborative signals to enhance the recommendation? <span class="ltx_text ltx_font_bold" id="S4.p1.1.5">RQ3</span>: How can we effectively fuse the modalities from LLM and CF embeddings? <span class="ltx_text ltx_font_bold" id="S4.p1.1.6">RQ4</span>: How does our proposed attentive cross-modal fusion strategy benefit recommendation?</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experiment Settings</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">We conduct experiments on the MovieLens-1M <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib14" title="">2015</a>)</cite> and Amazon-Book <cite class="ltx_cite ltx_citemacro_citep">(He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib15" title="">2016</a>)</cite> datasets.
For the MovieLens-1M dataset, the 20 most recent months of user-item interactions are used. The train/validation/test data are split by 10/5/5 months. For the Amazon-Book dataset, a total of 16 months of user-item interactions from 2017 onwards are used. The train/validation/test data are split by 11/2.5/2.5 months. In both datasets, users rate items on a 1 to 5 scale. To convert ratings to binary labels, a threshold of 3 is used for MovieLens-1M and 4 is used for Amazon-Book. The statistics of datasets used in this paper are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.T1" title="Table 1 ‣ Datasets ‣ 4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of Datasets.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.3.1.1.1"><span class="ltx_text" id="S4.T1.3.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.2"><span class="ltx_text" id="S4.T1.3.1.1.2.1" style="font-size:90%;">User</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.3"><span class="ltx_text" id="S4.T1.3.1.1.3.1" style="font-size:90%;">Item</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.4"><span class="ltx_text" id="S4.T1.3.1.1.4.1" style="font-size:90%;">Train</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.5"><span class="ltx_text" id="S4.T1.3.1.1.5.1" style="font-size:90%;">Validation</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.6"><span class="ltx_text" id="S4.T1.3.1.1.6.1" style="font-size:90%;">Test</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.2.1.1"><span class="ltx_text" id="S4.T1.3.2.1.1.1" style="font-size:90%;">MovieLens-1M</span></th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.3.2.1.2"><span class="ltx_text" id="S4.T1.3.2.1.2.1" style="font-size:90%;">839</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.3.2.1.3"><span class="ltx_text" id="S4.T1.3.2.1.3.1" style="font-size:90%;">3,256</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.3.2.1.4"><span class="ltx_text" id="S4.T1.3.2.1.4.1" style="font-size:90%;">33,891</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.3.2.1.5"><span class="ltx_text" id="S4.T1.3.2.1.5.1" style="font-size:90%;">10,401</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.3.2.1.6"><span class="ltx_text" id="S4.T1.3.2.1.6.1" style="font-size:90%;">7,331</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.3.3.2.1"><span class="ltx_text" id="S4.T1.3.3.2.1.1" style="font-size:90%;">Amazon-Books</span></th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.3.3.2.2"><span class="ltx_text" id="S4.T1.3.3.2.2.1" style="font-size:90%;">22,967</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.3.3.2.3"><span class="ltx_text" id="S4.T1.3.3.2.3.1" style="font-size:90%;">34,154</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.3.3.2.4"><span class="ltx_text" id="S4.T1.3.3.2.4.1" style="font-size:90%;">727,468</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.3.3.2.5"><span class="ltx_text" id="S4.T1.3.3.2.5.1" style="font-size:90%;">25,747</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.3.3.2.6"><span class="ltx_text" id="S4.T1.3.3.2.6.1" style="font-size:90%;">25,747</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Evaluation Metric</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">Since our recommendation task is CTR prediction, following the literature <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib28" title="">2023a</a>; Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib46" title="">2023</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib53" title="">2018</a>)</cite> in both conventional CF-based and LLM4Rec models, we adopt the standard Area Under the Curve (AUC) as the metric to evaluate the CTR performance. To compute the AUC of an LLM4Rec approach, we use the normalized <math alttext="p_{\textit{yes}}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3a.cmml">yes</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝑝</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3a.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3">yes</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">p_{\textit{yes}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT yes end_POSTSUBSCRIPT</annotation></semantics></math> as the prediction score. To evaluate the relative improvement, we adopt the RelaImpr metric <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib53" title="">2018</a>)</cite>, which is defined as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="RelaImpr=\left(\frac{\textit{AUC of measured model}-0.5}{\textit{AUC of base %
model}-0.5}-1\right)\times 100\%" class="ltx_Math" display="block" id="S4.E6.m1.1"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mrow id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.3.2" xref="S4.E6.m1.1.1.3.2.cmml">R</mi><mo id="S4.E6.m1.1.1.3.1" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml">e</mi><mo id="S4.E6.m1.1.1.3.1a" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.4" xref="S4.E6.m1.1.1.3.4.cmml">l</mi><mo id="S4.E6.m1.1.1.3.1b" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.5" xref="S4.E6.m1.1.1.3.5.cmml">a</mi><mo id="S4.E6.m1.1.1.3.1c" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.6" xref="S4.E6.m1.1.1.3.6.cmml">I</mi><mo id="S4.E6.m1.1.1.3.1d" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.7" xref="S4.E6.m1.1.1.3.7.cmml">m</mi><mo id="S4.E6.m1.1.1.3.1e" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.8" xref="S4.E6.m1.1.1.3.8.cmml">p</mi><mo id="S4.E6.m1.1.1.3.1f" xref="S4.E6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.3.9" xref="S4.E6.m1.1.1.3.9.cmml">r</mi></mrow><mo id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mfrac id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.1.2.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2a.cmml">AUC of measured model</mtext><mo id="S4.E6.m1.1.1.1.1.1.1.2.2.1" xref="S4.E6.m1.1.1.1.1.1.1.2.2.1.cmml">−</mo><mn id="S4.E6.m1.1.1.1.1.1.1.2.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml">0.5</mn></mrow><mrow id="S4.E6.m1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2a.cmml">AUC of base model</mtext><mo id="S4.E6.m1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S4.E6.m1.1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml">0.5</mn></mrow></mfrac><mo id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.1.1.1.1.1.3" rspace="0.055em" xref="S4.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.1.1.1.2" rspace="0.222em" xref="S4.E6.m1.1.1.1.2.cmml">×</mo><mrow id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml"><mn id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.3.2.cmml">100</mn><mo id="S4.E6.m1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.3.1.cmml">%</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><eq id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></eq><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><times id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3.1"></times><ci id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3.2">𝑅</ci><ci id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3">𝑒</ci><ci id="S4.E6.m1.1.1.3.4.cmml" xref="S4.E6.m1.1.1.3.4">𝑙</ci><ci id="S4.E6.m1.1.1.3.5.cmml" xref="S4.E6.m1.1.1.3.5">𝑎</ci><ci id="S4.E6.m1.1.1.3.6.cmml" xref="S4.E6.m1.1.1.3.6">𝐼</ci><ci id="S4.E6.m1.1.1.3.7.cmml" xref="S4.E6.m1.1.1.3.7">𝑚</ci><ci id="S4.E6.m1.1.1.3.8.cmml" xref="S4.E6.m1.1.1.3.8">𝑝</ci><ci id="S4.E6.m1.1.1.3.9.cmml" xref="S4.E6.m1.1.1.3.9">𝑟</ci></apply><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><times id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></times><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><minus id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"></minus><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"><divide id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"></divide><apply id="S4.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2"><minus id="S4.E6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.1"></minus><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.2a.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2">AUC of measured model</mtext></ci><cn id="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml" type="float" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3">0.5</cn></apply><apply id="S4.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3"><minus id="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1"></minus><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.2a.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2">AUC of base model</mtext></ci><cn id="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml" type="float" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3">0.5</cn></apply></apply><cn id="S4.E6.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.3.1">percent</csymbol><cn id="S4.E6.m1.1.1.1.3.2.cmml" type="integer" xref="S4.E6.m1.1.1.1.3.2">100</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">RelaImpr=\left(\frac{\textit{AUC of measured model}-0.5}{\textit{AUC of base %
model}-0.5}-1\right)\times 100\%</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">italic_R italic_e italic_l italic_a italic_I italic_m italic_p italic_r = ( divide start_ARG AUC of measured model - 0.5 end_ARG start_ARG AUC of base model - 0.5 end_ARG - 1 ) × 100 %</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Baselines</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">We compare our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px3.p1.1.1">CCF-LLM</span> to baselines in various categories to answer the aforementioned research questions. For RQ1, we investigate two well-known LLMs: (1) a widely used <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.2">closed-source LLM</span> that can be accessed via APIs, and (2) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.3">Vicuna-7B</span> <cite class="ltx_cite ltx_citemacro_citep">(Chiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib9" title="">2023</a>)</cite>, a powerful LLM fine-tuned from LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib42" title="">2023</a>)</cite>. For RQ2, we compare <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px3.p1.1.4">CCF-LLM</span> with several conventional CF-based models and the state-of-the-art LLM4Rec models. The CF-based models include: (1) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.5">MF</span> <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib27" title="">2009</a>)</cite>, the classical matrix factorization for recommendation; (2) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.6">LightGCN</span> <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib16" title="">2020</a>)</cite>, a state-of-the-art graph-based recommendation model; (3) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.7">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib24" title="">2018</a>)</cite>, a sequence recommendation model with self-attention. The LLM4Rec models include: (1) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.8">Softprompt</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib52" title="">2023</a>)</cite>, a soft prompt-tuning method; (2) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.9">TallRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>)</cite>, an instruct-tuning-based method; (3) <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px3.p1.1.10">CoLLM</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite>, a method that directly injects aligned collaborative signals into the embedding sequences of an LLM. For RQ3 and RQ4, we compare several variants of <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px3.p1.1.11">CCF-LLM</span>, which will be introduced in Sections <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS3.SSS0.Px2" title="Results and Discussion ‣ 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS5" title="4.5. Model Analyses (RQ4) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.5</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Impelmentation details</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.6">We tune hyper-parameters and configure experiment settings based on the validation set and guidance from the literature. We align the backend LLM for all LLM4Rec approaches to Vicuna-7B, and implement <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px4.p1.6.1">CCF-LLM</span> with three backend CF-based models used as our baselines, denoting them as <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px4.p1.6.2">CCF-LLM</span> (MF), <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px4.p1.6.3">CCF-LLM</span> (LightGCN) and <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px4.p1.6.4">CCF-LLM</span> (SASRec).
We set the dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.1.m1.1d">italic_d</annotation></semantics></math> to 128 for all CF embeddings <math alttext="\mathtt{x}^{CF}_{u}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><msubsup id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.2.cmml">𝚡</mi><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">u</mi><mrow id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.2.cmml">C</mi><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.2">𝚡</ci><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3"><times id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.1"></times><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.2">𝐶</ci><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">\mathtt{x}^{CF}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.2.m2.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathtt{x}^{CF}_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><msubsup id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml">𝚡</mi><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml">i</mi><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2.cmml">C</mi><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3.cmml">F</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2">𝚡</ci><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3"><times id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.1"></times><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.2">𝐶</ci><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.3">𝐹</ci></apply></apply><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">\mathtt{x}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.3.m3.1d">typewriter_x start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The dimension <math alttext="l" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px4.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px4.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px4.p1.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.4.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.4.m4.1d">italic_l</annotation></semantics></math> for the backend Vicuna-7B LLM is 4096. The hyper-parameter <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px4.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px4.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px4.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.5.m5.1d">italic_k</annotation></semantics></math> in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E5" title="In Learning Objectives ‣ 3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>) is set to 2.0. When pre-training CF-based models, we set the batch size to 1024 and use the Adam optimizer with a learning rate of either 1e-3 or 1e-2 until converged. When training <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS0.Px4.p1.6.5">CCF-LLM</span> with the two-stage training strategy, we have referenced the official training script<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/lm-sys/FastChat" title="">https://github.com/lm-sys/FastChat</a></span></span></span> for Vicuna. In particular, we use the AdamW optimizer with a learning rate of 1e-4 and batch size of 3. We also limit the maximum length of the input sequence to 700 tokens to prevent out-of-memory issues, such that inputs exceeding this length are truncated. For other parameters, we adhere to the configurations outlined in their original papers or the default values in their software. All experiments were conducted on a Linux server with 4<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px4.p1.6.m6.1a"><mo id="S4.SS1.SSS0.Px4.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px4.p1.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.6.m6.1b"><times id="S4.SS1.SSS0.Px4.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.6.m6.1d">×</annotation></semantics></math>V100 GPUs and 128GB RAM.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Pilot Study (RQ1)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In this section, we aim to explore a compelling hypothesis: Given the significance of collaborative signals in recommendation systems and the exceptional performance of LLMs on diverse natural language tasks, can LLMs directly leverage collaborative signals encoded using natural language descriptions?</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2. </span>Pilot study on the recommendation capability of LLMs, encoding collaborative signals in natural language.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S4.T2.3.4.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.3.4.1.1.1" style="font-size:90%;">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.3.4.1.2"><span class="ltx_text" id="S4.T2.3.4.1.2.1" style="font-size:90%;">Closed-source LLM</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S4.T2.3.4.1.3"><span class="ltx_text" id="S4.T2.3.4.1.3.1" style="font-size:90%;">Vicuna-7B</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.5.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.5.2.1"><span class="ltx_text" id="S4.T2.3.5.2.1.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.3.5.2.2"><span class="ltx_text" id="S4.T2.3.5.2.2.1" style="font-size:90%;">AUC</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.6.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.6.3.1" rowspan="2"><span class="ltx_text" id="S4.T2.3.6.3.1.1" style="font-size:90%;">Zero-shot</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S4.T2.3.6.3.2"><span class="ltx_text" id="S4.T2.3.6.3.2.1" style="font-size:90%;">w/ CF</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.6.3.3"><span class="ltx_text" id="S4.T2.3.6.3.3.1" style="font-size:90%;">0.5902</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.3.6.3.4"><span class="ltx_text" id="S4.T2.3.6.3.4.1" style="font-size:90%;">0.6202</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.7.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S4.T2.3.7.4.1"><span class="ltx_text" id="S4.T2.3.7.4.1.1" style="font-size:90%;">w/o CF</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.7.4.2"><span class="ltx_text" id="S4.T2.3.7.4.2.1" style="font-size:90%;">0.5783</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.7.4.3"><span class="ltx_text" id="S4.T2.3.7.4.3.1" style="font-size:90%;">0.6184</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.8.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.8.5.1" rowspan="2"><span class="ltx_text" id="S4.T2.3.8.5.1.1" style="font-size:90%;">Instruct-tuning</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S4.T2.3.8.5.2"><span class="ltx_text" id="S4.T2.3.8.5.2.1" style="font-size:90%;">w/ CF</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.8.5.3"><span class="ltx_text" id="S4.T2.3.8.5.3.1" style="font-size:90%;">0.6235</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.3.8.5.4"><span class="ltx_text" id="S4.T2.3.8.5.4.1" style="font-size:90%;">0.7108</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.9.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S4.T2.3.9.6.1"><span class="ltx_text" id="S4.T2.3.9.6.1.1" style="font-size:90%;">w/o CF</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.9.6.2"><span class="ltx_text" id="S4.T2.3.9.6.2.1" style="font-size:90%;">0.5998</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.9.6.3"><span class="ltx_text" id="S4.T2.3.9.6.3.1" style="font-size:90%;">0.7084</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="S4.T2.1.1.2"><span class="ltx_text" id="S4.T2.1.1.2.1" style="font-size:90%;">MF</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.1.1.1">
<span class="ltx_text" id="S4.T2.1.1.1.1" style="font-size:90%;">0.6482</span><sup class="ltx_sup" id="S4.T2.1.1.1.2"><span class="ltx_text" id="S4.T2.1.1.1.2.1" style="font-size:90%;">†</span></sup>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2" id="S4.T2.2.2.2"><span class="ltx_text" id="S4.T2.2.2.2.1" style="font-size:90%;">CoLLM (MF)</span></th>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.T2.2.2.1">
<span class="ltx_text" id="S4.T2.2.2.1.1" style="font-size:90%;">0.7295</span><sup class="ltx_sup" id="S4.T2.2.2.1.2"><span class="ltx_text" id="S4.T2.2.2.1.2.1" style="font-size:90%;">†</span></sup>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.10.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2" id="S4.T2.3.10.7.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T2.3.10.7.1.1" style="font-size:90%;">CCF-LLM</span><span class="ltx_text" id="S4.T2.3.10.7.1.2" style="font-size:90%;"> (MF)</span>
</th>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.T2.3.10.7.2"><span class="ltx_text" id="S4.T2.3.10.7.2.1" style="font-size:90%;">0.7315</span></td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr class="ltx_tr" id="S4.T2.3.11.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S4.T2.3.11.1.1"><span class="ltx_text" id="S4.T2.3.11.1.1.1" style="font-size:90%;">Results are reported as the average of 5 runs.</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" colspan="4" id="S4.T2.3.3.1">
<math alttext="\dagger" class="ltx_Math" display="inline" id="S4.T2.3.3.1.m1.1"><semantics id="S4.T2.3.3.1.m1.1a"><mo id="S4.T2.3.3.1.m1.1.1" mathsize="90%" xref="S4.T2.3.3.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><ci id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.m1.1d">†</annotation></semantics></math><span class="ltx_text" id="S4.T2.3.3.1.1" style="font-size:90%;">Results are reproduced from Zhang et al. </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T2.3.3.1.2.1" style="font-size:90%;">(</span>Zhang et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T2.3.3.1.3.2.1.1" style="font-size:90%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a><span class="ltx_text" id="S4.T2.3.3.1.4.3" style="font-size:90%;">)</span></cite><span class="ltx_text" id="S4.T2.3.3.1.5" style="font-size:90%;">.</span>
</th>
</tr>
</tfoot>
</table>
</figure>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Experiment Setup</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">As mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS1" title="4.1. Experiment Settings ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we resort to two well-known LLMs to evaluate this research question: a widely used closed-source LLM (gpt-3.5-turbo-0613) and Vicuna-7B (the same LLM used in <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px1.p1.1.1">CCF-LLM</span>). The key step is to encode collaborative signals in natural languages. Building on the fundamental assumption of collaborative filtering that items interacted by users of similar interests should be highlighted, we identify items that are potentially interesting to the target user through a pre-trained CF-based model. These potential items are then communicated directly to the LLM as collaborative signals by explicitly mentioning their titles. Specifically, we replace the second sentence of the prompt template described in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS2" title="3.2. Hybrid Prompt Translation ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a> with the following: “<span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.p1.1.2">Additionally, we have information that users like these items may also enjoy: {[sim_items]}.</span>”, where <span class="ltx_text ltx_font_typewriter" id="S4.SS2.SSS0.Px1.p1.1.3">{[sim_items]}</span> is a list of top-10 items out of all items in test set recommended by MF. We assess each LLM through a zero-shot setting and an instruct-tuning setting. In the instruct-tuning setting, we set the prompt output to “Yes” or “No” according to the ground-truth labels. Note that we are unable to access the parameters of the closed-source model. Thus we only evaluate the closed-source model by treating its generated output as a binary value when computing AUC.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results and Discussion</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">We report the results of only using natural language descriptions for LLMs in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.T2" title="Table 2 ‣ 4.2. Pilot Study (RQ1) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. “w/ CF” indicates that we encode the collaborative signals into prompts, and “w/o CF” indicates that no collaborative signal is encoded. Besides, we also report the results of MF, CoLLM, and the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px2.p1.1.1">CCF-LLM</span> for reference, where CoLLM and <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px2.p1.1.2">CCF-LLM</span> use MF as the backend for a fair comparison. It can be observed that collaborative signals improve recommendations by an average of 0.0178 in both zero-shot and instruct-tuning settings for the closed-source LLM and 0.0021 for Vicuna-7B. On the one hand, the improvement confirms that LLM can benefit from collaborative signals in the form of natural language descriptions. Our results also align with previous studies <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib13" title="">2022</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>; Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib7" title="">2023</a>)</cite> that tuning LLMs with user-item interactions can adapt the LLMs to recommendation tasks, thus achieving favorable performance over the zero-shot setting. On the other hand, the improvement is marginal. For LLM4Rec approaches that integrate CF embeddings, CoLLM surpasses the best performance achieved through using solely natural language descriptions by 0.0187, while <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.SSS0.Px2.p1.1.3">CCF-LLM</span> outperforms by 0.0207. We hypothesize that the significant gap arises as natural language descriptions are inadequate to fully convey the collaborative signals, thus making it difficult to instruct LLMs to enhance recommendations. It is more effective to utilize CF embeddings as the carrier for collaborative signals. Therefore, we choose to integrate both modalities in CF and LLM embeddings under the context of LLM4Rec.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>Comparison between the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.T3.24.1">CCF-LLM</span> and the baselines. The best result in each group is bolded.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.19">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.19.20.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T3.19.20.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.19.20.1.1.1" style="font-size:90%;">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T3.19.20.1.2"><span class="ltx_text" id="S4.T3.19.20.1.2.1" style="font-size:90%;">MovieLens-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.19.20.1.3"><span class="ltx_text" id="S4.T3.19.20.1.3.1" style="font-size:90%;">Amazon-Book</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.21.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.19.21.2.1"><span class="ltx_text" id="S4.T3.19.21.2.1.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.19.21.2.2"><span class="ltx_text" id="S4.T3.19.21.2.2.1" style="font-size:90%;">RelaImpr</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.19.21.2.3"><span class="ltx_text" id="S4.T3.19.21.2.3.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.19.21.2.4"><span class="ltx_text" id="S4.T3.19.21.2.4.1" style="font-size:90%;">RelaImpr</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.2.3"><span class="ltx_text" id="S4.T3.2.2.3.1" style="font-size:90%;">MF</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1">
<span class="ltx_text" id="S4.T3.1.1.1.1" style="font-size:90%;">0.6482</span><sup class="ltx_sup" id="S4.T3.1.1.1.2"><span class="ltx_text" id="S4.T3.1.1.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.4"><span class="ltx_text" id="S4.T3.2.2.4.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2">
<span class="ltx_text" id="S4.T3.2.2.2.1" style="font-size:90%;">0.7134</span><sup class="ltx_sup" id="S4.T3.2.2.2.2"><span class="ltx_text" id="S4.T3.2.2.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.2.2.5"><span class="ltx_text" id="S4.T3.2.2.5.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.4.3"><span class="ltx_text" id="S4.T3.4.4.3.1" style="font-size:90%;">CoLLM (MF)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.1">
<span class="ltx_text" id="S4.T3.3.3.1.1" style="font-size:90%;">0.7295</span><sup class="ltx_sup" id="S4.T3.3.3.1.2"><span class="ltx_text" id="S4.T3.3.3.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.4.4.4"><span class="ltx_text" id="S4.T3.4.4.4.1" style="font-size:90%;">54.86%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2">
<span class="ltx_text" id="S4.T3.4.4.2.1" style="font-size:90%;">0.8109</span><sup class="ltx_sup" id="S4.T3.4.4.2.2"><span class="ltx_text" id="S4.T3.4.4.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.4.4.5"><span class="ltx_text" id="S4.T3.4.4.5.1" style="font-size:90%;">45.69%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.22.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.19.22.3.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T3.19.22.3.1.1" style="font-size:90%;">CCF-LLM</span><span class="ltx_text" id="S4.T3.19.22.3.1.2" style="font-size:90%;"> (MF)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.19.22.3.2"><span class="ltx_text ltx_font_bold" id="S4.T3.19.22.3.2.1" style="font-size:90%;">0.7315</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.19.22.3.3"><span class="ltx_text" id="S4.T3.19.22.3.3.1" style="font-size:90%;">56.21%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.19.22.3.4"><span class="ltx_text ltx_font_bold" id="S4.T3.19.22.3.4.1" style="font-size:90%;">0.8150</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.19.22.3.5"><span class="ltx_text" id="S4.T3.19.22.3.5.1" style="font-size:90%;">47.61%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.6.6.3"><span class="ltx_text" id="S4.T3.6.6.3.1" style="font-size:90%;">LightGCN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.1">
<span class="ltx_text" id="S4.T3.5.5.1.1" style="font-size:90%;">0.5959</span><sup class="ltx_sup" id="S4.T3.5.5.1.2"><span class="ltx_text" id="S4.T3.5.5.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.6.6.4"><span class="ltx_text" id="S4.T3.6.6.4.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.6.2">
<span class="ltx_text" id="S4.T3.6.6.2.1" style="font-size:90%;">0.7103</span><sup class="ltx_sup" id="S4.T3.6.6.2.2"><span class="ltx_text" id="S4.T3.6.6.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.6.5"><span class="ltx_text" id="S4.T3.6.6.5.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.8.8.3"><span class="ltx_text" id="S4.T3.8.8.3.1" style="font-size:90%;">CoLLM (LightGCN)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.7.7.1">
<span class="ltx_text" id="S4.T3.7.7.1.1" style="font-size:90%;">0.7100</span><sup class="ltx_sup" id="S4.T3.7.7.1.2"><span class="ltx_text" id="S4.T3.7.7.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.8.8.4"><span class="ltx_text" id="S4.T3.8.8.4.1" style="font-size:90%;">118.98%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.8.8.2">
<span class="ltx_text" id="S4.T3.8.8.2.1" style="font-size:90%;">0.7978</span><sup class="ltx_sup" id="S4.T3.8.8.2.2"><span class="ltx_text" id="S4.T3.8.8.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.8.8.5"><span class="ltx_text" id="S4.T3.8.8.5.1" style="font-size:90%;">41.61%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.23.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.19.23.4.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T3.19.23.4.1.1" style="font-size:90%;">CCF-LLM</span><span class="ltx_text" id="S4.T3.19.23.4.1.2" style="font-size:90%;"> (LightGCN)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.19.23.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.19.23.4.2.1" style="font-size:90%;">0.7427</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.19.23.4.3"><span class="ltx_text" id="S4.T3.19.23.4.3.1" style="font-size:90%;">153.08%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.19.23.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.19.23.4.4.1" style="font-size:90%;">0.8049</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.19.23.4.5"><span class="ltx_text" id="S4.T3.19.23.4.5.1" style="font-size:90%;">44.98%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.10.10.3"><span class="ltx_text" id="S4.T3.10.10.3.1" style="font-size:90%;">SASRec</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.1">
<span class="ltx_text" id="S4.T3.9.9.1.1" style="font-size:90%;">0.7078</span><sup class="ltx_sup" id="S4.T3.9.9.1.2"><span class="ltx_text" id="S4.T3.9.9.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.10.10.4"><span class="ltx_text" id="S4.T3.10.10.4.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.10.10.2">
<span class="ltx_text" id="S4.T3.10.10.2.1" style="font-size:90%;">0.6887</span><sup class="ltx_sup" id="S4.T3.10.10.2.2"><span class="ltx_text" id="S4.T3.10.10.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.10.10.5"><span class="ltx_text" id="S4.T3.10.10.5.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.12.12.3"><span class="ltx_text" id="S4.T3.12.12.3.1" style="font-size:90%;">CoLLM (SASRec)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.11.11.1">
<span class="ltx_text" id="S4.T3.11.11.1.1" style="font-size:90%;">0.7235</span><sup class="ltx_sup" id="S4.T3.11.11.1.2"><span class="ltx_text" id="S4.T3.11.11.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.12.12.4"><span class="ltx_text" id="S4.T3.12.12.4.1" style="font-size:90%;">7.56%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.12.2">
<span class="ltx_text" id="S4.T3.12.12.2.1" style="font-size:90%;">0.7746</span><sup class="ltx_sup" id="S4.T3.12.12.2.2"><span class="ltx_text" id="S4.T3.12.12.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.12.12.5"><span class="ltx_text" id="S4.T3.12.12.5.1" style="font-size:90%;">45.52%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.24.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.19.24.5.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T3.19.24.5.1.1" style="font-size:90%;">CCF-LLM</span><span class="ltx_text" id="S4.T3.19.24.5.1.2" style="font-size:90%;"> (SASRec)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.19.24.5.2"><span class="ltx_text ltx_font_bold" id="S4.T3.19.24.5.2.1" style="font-size:90%;">0.7526</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.19.24.5.3"><span class="ltx_text" id="S4.T3.19.24.5.3.1" style="font-size:90%;">21.56%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.19.24.5.4"><span class="ltx_text ltx_font_bold" id="S4.T3.19.24.5.4.1" style="font-size:90%;">0.7792</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.19.24.5.5"><span class="ltx_text" id="S4.T3.19.24.5.5.1" style="font-size:90%;">47.96%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.14.14.3"><span class="ltx_text" id="S4.T3.14.14.3.1" style="font-size:90%;">Softprompt</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.13.13.1">
<span class="ltx_text" id="S4.T3.13.13.1.1" style="font-size:90%;">0.7071</span><sup class="ltx_sup" id="S4.T3.13.13.1.2"><span class="ltx_text" id="S4.T3.13.13.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.14.14.4"><span class="ltx_text" id="S4.T3.14.14.4.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.14.14.2">
<span class="ltx_text" id="S4.T3.14.14.2.1" style="font-size:90%;">0.7224</span><sup class="ltx_sup" id="S4.T3.14.14.2.2"><span class="ltx_text" id="S4.T3.14.14.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.14.14.5"><span class="ltx_text" id="S4.T3.14.14.5.1" style="font-size:90%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.16.16.3"><span class="ltx_text" id="S4.T3.16.16.3.1" style="font-size:90%;">TallRec</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.15.15.1">
<span class="ltx_text" id="S4.T3.15.15.1.1" style="font-size:90%;">0.7097</span><sup class="ltx_sup" id="S4.T3.15.15.1.2"><span class="ltx_text" id="S4.T3.15.15.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.16.16.4"><span class="ltx_text" id="S4.T3.16.16.4.1" style="font-size:90%;">1.25%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.16.16.2">
<span class="ltx_text" id="S4.T3.16.16.2.1" style="font-size:90%;">0.7375</span><sup class="ltx_sup" id="S4.T3.16.16.2.2"><span class="ltx_text" id="S4.T3.16.16.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.16.16.5"><span class="ltx_text" id="S4.T3.16.16.5.1" style="font-size:90%;">6.79%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.18.18.3"><span class="ltx_text" id="S4.T3.18.18.3.1" style="font-size:90%;">CoLLM (Best)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.17.17.1">
<span class="ltx_text" id="S4.T3.17.17.1.1" style="font-size:90%;">0.7295</span><sup class="ltx_sup" id="S4.T3.17.17.1.2"><span class="ltx_text" id="S4.T3.17.17.1.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.18.18.4"><span class="ltx_text" id="S4.T3.18.18.4.1" style="font-size:90%;">10.82%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.18.18.2">
<span class="ltx_text" id="S4.T3.18.18.2.1" style="font-size:90%;">0.8109</span><sup class="ltx_sup" id="S4.T3.18.18.2.2"><span class="ltx_text" id="S4.T3.18.18.2.2.1" style="font-size:90%;">†</span></sup>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.18.18.5"><span class="ltx_text" id="S4.T3.18.18.5.1" style="font-size:90%;">39.79%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.19.25.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.19.25.6.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T3.19.25.6.1.1" style="font-size:90%;">CCF-LLM</span><span class="ltx_text" id="S4.T3.19.25.6.1.2" style="font-size:90%;"> (Best)</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.19.25.6.2"><span class="ltx_text ltx_font_bold" id="S4.T3.19.25.6.2.1" style="font-size:90%;">0.7526</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.19.25.6.3"><span class="ltx_text" id="S4.T3.19.25.6.3.1" style="font-size:90%;">21.97%</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.19.25.6.4"><span class="ltx_text ltx_font_bold" id="S4.T3.19.25.6.4.1" style="font-size:90%;">0.8150</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.19.25.6.5"><span class="ltx_text" id="S4.T3.19.25.6.5.1" style="font-size:90%;">41.64%</span></td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr class="ltx_tr" id="S4.T3.19.26.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="5" id="S4.T3.19.26.1.1"><span class="ltx_text" id="S4.T3.19.26.1.1.1" style="font-size:90%;">Results are reported as the average of 5 runs.</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" colspan="5" id="S4.T3.19.19.1">
<math alttext="\dagger" class="ltx_Math" display="inline" id="S4.T3.19.19.1.m1.1"><semantics id="S4.T3.19.19.1.m1.1a"><mo id="S4.T3.19.19.1.m1.1.1" mathsize="90%" xref="S4.T3.19.19.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S4.T3.19.19.1.m1.1b"><ci id="S4.T3.19.19.1.m1.1.1.cmml" xref="S4.T3.19.19.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.19.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="S4.T3.19.19.1.m1.1d">†</annotation></semantics></math><span class="ltx_text" id="S4.T3.19.19.1.1" style="font-size:90%;">Results are reproduced from Zhang et al. </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S4.T3.19.19.1.2.1" style="font-size:90%;">(</span>Zhang et al<span class="ltx_text">.</span><span class="ltx_text" id="S4.T3.19.19.1.3.2.1.1" style="font-size:90%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a><span class="ltx_text" id="S4.T3.19.19.1.4.3" style="font-size:90%;">)</span></cite><span class="ltx_text" id="S4.T3.19.19.1.5" style="font-size:90%;">.</span>
</th>
</tr>
</tfoot>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Main Results of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.1.1">CCF-LLM</span> (RQ2)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this section, we investigate the performance of the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.1">CCF-LLM</span> on the MovieLens-1M and Amazon-book datasets.</p>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Experiment Setup</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">We implement our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px1.p1.1.1">CCF-LLM</span> with three backend CF-based models and compare them individually in three subgroups. Besides, we also include CoLLM <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>)</cite> in each subgroup with the corresponding backend CF-based model. Finally, we compare with other state-of-the-art LLM4Rec approaches that do not rely on CF embeddings in the fourth subgroup, including Softprompt <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib52" title="">2023</a>)</cite> and TallRec <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib3" title="">2023</a>)</cite>. We denote <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px1.p1.1.2">CCF-LLM</span> (Best) and CoLLM (Best) as the implementation with the backend CF-based models that have achieved the best performance.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results and Discussion</h4>
<div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.T3" title="Table 3 ‣ Results and Discussion ‣ 4.2. Pilot Study (RQ1) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> displays a comparison of the overall performance. To compute RelaImpr, the base models are the corresponding conventional CF-based models in the first three subgroups. For the fourth subgroup, the base model is Softprompt. Based on the results, we can make the following observations: (1) <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.1">CCF-LLM</span> outperforms all other baselines, including conventional CF-based models and state-of-the-art LLM4Rec methods, demonstrating the effectiveness of our proposed framework. (2) Compared to conventional CF-based models, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.2">CCF-LLM</span> has a relative improvement of up to 153.08% in MovieLens-1M and 47.96% in Amazon-Book. This reveals that the absence of semantic knowledge significantly limits the performance of conventional CF-based models. Thus, it is necessary to explore the potential of LLMs in recommendation. (3) <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.3">CCF-LLM</span> has a relative improvement of up to 41.64% compared to LLM4Rec methods that do not rely on CF embeddings. This observation suggests utilizing latent embeddings for collaborative signals is useful in improving recommendation performance. (4) Compared to CoLLM which also utilizes both CF and LLM embeddings, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.4">CCF-LLM</span> has better performance. This is due to the proposed attentive cross-modal fusion strategy that contributes to a more synergistic integration between the heterogeneous modalities. (5) Our <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.5">CCF-LLM</span> is similar to Softprompt by tuning the embeddings for special tokens. However, the trainable embeddings in Softprompt are not constrained with a CF-based model as <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.SSS0.Px2.p1.1.6">CCF-LLM</span> does. Note that the performance of Softprompt is even worse than TallRec which only relies on natural language descriptions. This observation suggests that improperly tuning the embeddings for an LLM may result in a negative impact.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="355" id="S4.F3.g1" src="x3.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Ablation study on cross-modal fusion strategies.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Ablation Study (RQ3)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In this section, we investigate the influence of the proposed attentive cross-modal fusion strategy. Our default fusion strategy, as illustrated in Equations (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.Ex1" title="Fusion Phase ‣ 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E4" title="In Fusion Phase ‣ 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>), relies on the weight vector <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_α</annotation></semantics></math> to perform an adaptive dimensional-wise fusion between the CF and LLM embeddings. Though our fusion strategy has proven to be effective, we are still curious if there are other alternatives.</p>
</div>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Experiment Setup</h4>
<div class="ltx_para" id="S4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.6">We conduct the ablation studies from two
angles, including <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS0.Px1.p1.6.1">how to fuse</span> and <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS0.Px1.p1.6.2">what to fuse</span>.
For the first angle, we examine two alternatives by modifying Equations (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.Ex1" title="Fusion Phase ‣ 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E4" title="In Fusion Phase ‣ 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>). Firstly, we fix <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.1.m1.1d">italic_α</annotation></semantics></math> to a constant value <math alttext="1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px1.p1.2.m2.1a"><mn id="S4.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.2.m2.1b"><cn id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.2.m2.1d">1</annotation></semantics></math>, so that the fused item embedding will be computed as <math alttext="\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\tilde{\mathtt{x}}^{CF}_{i}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.3.m3.2"><semantics id="S4.SS4.SSS0.Px1.p1.3.m3.2a"><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.cmml"><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.cmml"><msub id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.2.cmml">𝚡</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.1.cmml">~</mo></mover><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.3.cmml">i</mi></msub><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.1.cmml"><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.2.1" stretchy="false" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.1.1.cmml">[</mo><mi id="S4.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.1.cmml">t</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.2.2" stretchy="false" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.cmml"><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.cmml"><msubsup id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.2.cmml">𝚡</mi><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.3.cmml">i</mi><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.2.cmml">S</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.1.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.1.cmml"><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.2.1" stretchy="false" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.1.1.cmml">[</mo><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.2.cmml">t</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.2.2" stretchy="false" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.1.cmml">+</mo><msubsup id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.2.cmml">𝚡</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.1.cmml">~</mo></mover><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.3.cmml">i</mi><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.2.cmml">C</mi><mo id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.3.cmml">F</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.3.m3.2b"><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3"><eq id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.1"></eq><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2"><times id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.1"></times><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2"><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.1">~</ci><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.2.2">𝚡</ci></apply><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.2.3">𝑖</ci></apply><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.2"><csymbol cd="latexml" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.1">𝑡</ci></apply></apply><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3"><plus id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.1"></plus><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2"><times id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.1"></times><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2">superscript</csymbol><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.2">𝚡</ci><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3"><times id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.1"></times><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.2">𝑆</ci><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.2.3">𝑖</ci></apply><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.2"><csymbol cd="latexml" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.2">𝑡</ci></apply></apply><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3">superscript</csymbol><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2"><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.1">~</ci><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.2.2">𝚡</ci></apply><apply id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3"><times id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.1"></times><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.2">𝐶</ci><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.2.3.3">𝐹</ci></apply></apply><ci id="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.3.m3.2.3.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.3.m3.2c">\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\tilde{\mathtt{x}}^{CF}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.3.m3.2d">over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] = typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] + over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We denote this variant as “<math alttext="\alpha=1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS4.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1"><eq id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.1"></eq><ci id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.2">𝛼</ci><cn id="S4.SS4.SSS0.Px1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.4.m4.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.4.m4.1d">italic_α = 1</annotation></semantics></math>”. Then we modify the output dimension of <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS4.SSS0.Px1.p1.5.m5.1a"><mi id="S4.SS4.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p1.5.m5.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.5.m5.1b"><ci id="S4.SS4.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.5.m5.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.5.m5.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.5.m5.1d">typewriter_GATE</annotation></semantics></math> network to 1, i.e., to conduct cross-modal fusion in a token-wise manner. We denote this variant as “<math alttext="\alpha\in R" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS4.SSS0.Px1.p1.6.m6.1a"><mrow id="S4.SS4.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.3" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.6.m6.1b"><apply id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1"><in id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1"></in><ci id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2">𝛼</ci><ci id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.6.m6.1c">\alpha\in R</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.6.m6.1d">italic_α ∈ italic_R</annotation></semantics></math>”. For a fair comparison, we utilize LightGCN as the backend model for all the above variants.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p2.6">Besides, we are also interested in <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS0.Px1.p2.6.1">what to fuse</span>, particularly in fusing multiple CF embeddings from different CF-based models at a time. We denote the implementations of <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.SSS0.Px1.p2.6.2">CCF-LLM</span> with different backend CF-based models in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.SS3" title="4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a> as “L” (for LightGCN), “M” (for MF), and “S” (for SASRec). Here, we further examine the combination of collaborative signals from LightGCN and MF (denoted as “L+M”), LightGCN and SASRec (denoted as “L+S”) as well as MF and SASRec (denoted as “M+S”). In this way, the fusion phase defined in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.E4" title="In Fusion Phase ‣ 3.3. Attentive Cross-modal Fusion Strategy ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>) can be presented as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\alpha\odot\tilde{\mathtt{x}}%
^{CF_{1}}_{i}+\beta\odot\tilde{\mathtt{x}}^{CF_{2}}_{i}," class="ltx_Math" display="block" id="S4.E7.m1.3"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml"><msub id="S4.E7.m1.3.3.1.1.2.2" xref="S4.E7.m1.3.3.1.1.2.2.cmml"><mover accent="true" id="S4.E7.m1.3.3.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.2.cmml">𝚡</mi><mo id="S4.E7.m1.3.3.1.1.2.2.2.1" xref="S4.E7.m1.3.3.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.3.3.1.1.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.3.3.1.1.2.1" xref="S4.E7.m1.3.3.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.2.3.2" xref="S4.E7.m1.3.3.1.1.2.3.1.cmml"><mo id="S4.E7.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S4.E7.m1.3.3.1.1.2.3.1.1.cmml">[</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">t</mi><mo id="S4.E7.m1.3.3.1.1.2.3.2.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mrow id="S4.E7.m1.3.3.1.1.3.2" xref="S4.E7.m1.3.3.1.1.3.2.cmml"><msubsup id="S4.E7.m1.3.3.1.1.3.2.2" xref="S4.E7.m1.3.3.1.1.3.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.3.2.2.2.2" xref="S4.E7.m1.3.3.1.1.3.2.2.2.2.cmml">𝚡</mi><mi id="S4.E7.m1.3.3.1.1.3.2.2.3" xref="S4.E7.m1.3.3.1.1.3.2.2.3.cmml">i</mi><mrow id="S4.E7.m1.3.3.1.1.3.2.2.2.3" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.2.2.2.3.2" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.2.cmml">S</mi><mo id="S4.E7.m1.3.3.1.1.3.2.2.2.3.1" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.3.2.2.2.3.3" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.3.cmml">M</mi></mrow></msubsup><mo id="S4.E7.m1.3.3.1.1.3.2.1" xref="S4.E7.m1.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.3.2.3.2" xref="S4.E7.m1.3.3.1.1.3.2.3.1.cmml"><mo id="S4.E7.m1.3.3.1.1.3.2.3.2.1" stretchy="false" xref="S4.E7.m1.3.3.1.1.3.2.3.1.1.cmml">[</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">t</mi><mo id="S4.E7.m1.3.3.1.1.3.2.3.2.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.3.1" xref="S4.E7.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S4.E7.m1.3.3.1.1.3.3" xref="S4.E7.m1.3.3.1.1.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.2.cmml">α</mi><mo id="S4.E7.m1.3.3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">⊙</mo><msubsup id="S4.E7.m1.3.3.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.cmml"><mover accent="true" id="S4.E7.m1.3.3.1.1.3.3.3.2.2" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.3.2.2.2" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2.2.cmml">𝚡</mi><mo id="S4.E7.m1.3.3.1.1.3.3.3.2.2.1" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.3.3.1.1.3.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.3.cmml">i</mi><mrow id="S4.E7.m1.3.3.1.1.3.3.3.2.3" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.3.2.3.2" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.2.cmml">C</mi><mo id="S4.E7.m1.3.3.1.1.3.3.3.2.3.1" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.1.cmml">⁢</mo><msub id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.2.cmml">F</mi><mn id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.3.cmml">1</mn></msub></mrow></msubsup></mrow><mo id="S4.E7.m1.3.3.1.1.3.1a" xref="S4.E7.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S4.E7.m1.3.3.1.1.3.4" xref="S4.E7.m1.3.3.1.1.3.4.cmml"><mi id="S4.E7.m1.3.3.1.1.3.4.2" xref="S4.E7.m1.3.3.1.1.3.4.2.cmml">β</mi><mo id="S4.E7.m1.3.3.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.3.3.1.1.3.4.1.cmml">⊙</mo><msubsup id="S4.E7.m1.3.3.1.1.3.4.3" xref="S4.E7.m1.3.3.1.1.3.4.3.cmml"><mover accent="true" id="S4.E7.m1.3.3.1.1.3.4.3.2.2" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.3.4.3.2.2.2" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2.2.cmml">𝚡</mi><mo id="S4.E7.m1.3.3.1.1.3.4.3.2.2.1" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.3.3.1.1.3.4.3.3" xref="S4.E7.m1.3.3.1.1.3.4.3.3.cmml">i</mi><mrow id="S4.E7.m1.3.3.1.1.3.4.3.2.3" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.4.3.2.3.2" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.2.cmml">C</mi><mo id="S4.E7.m1.3.3.1.1.3.4.3.2.3.1" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.1.cmml">⁢</mo><msub id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.2" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.2.cmml">F</mi><mn id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.3" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.3.cmml">2</mn></msub></mrow></msubsup></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><eq id="S4.E7.m1.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"></eq><apply id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2"><times id="S4.E7.m1.3.3.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.1"></times><apply id="S4.E7.m1.3.3.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2"><ci id="S4.E7.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.1">~</ci><ci id="S4.E7.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.2">𝚡</ci></apply><ci id="S4.E7.m1.3.3.1.1.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E7.m1.3.3.1.1.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.3.2"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.2.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑡</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><plus id="S4.E7.m1.3.3.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.1"></plus><apply id="S4.E7.m1.3.3.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2"><times id="S4.E7.m1.3.3.1.1.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.1"></times><apply id="S4.E7.m1.3.3.1.1.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.2.2">𝚡</ci><apply id="S4.E7.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3"><times id="S4.E7.m1.3.3.1.1.3.2.2.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.1"></times><ci id="S4.E7.m1.3.3.1.1.3.2.2.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.2">𝑆</ci><ci id="S4.E7.m1.3.3.1.1.3.2.2.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.2.3.3">𝑀</ci></apply></apply><ci id="S4.E7.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E7.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.3.2"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.3.2.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1.3.2.3.2.1">delimited-[]</csymbol><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝑡</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.1">direct-product</csymbol><ci id="S4.E7.m1.3.3.1.1.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2">𝛼</ci><apply id="S4.E7.m1.3.3.1.1.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.3.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2"><ci id="S4.E7.m1.3.3.1.1.3.3.3.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2.1">~</ci><ci id="S4.E7.m1.3.3.1.1.3.3.3.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.2.2">𝚡</ci></apply><apply id="S4.E7.m1.3.3.1.1.3.3.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3"><times id="S4.E7.m1.3.3.1.1.3.3.3.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.1"></times><ci id="S4.E7.m1.3.3.1.1.3.3.3.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.2">𝐶</ci><apply id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.2">𝐹</ci><cn id="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.3.cmml" type="integer" xref="S4.E7.m1.3.3.1.1.3.3.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S4.E7.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3">𝑖</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.3.4.cmml" xref="S4.E7.m1.3.3.1.1.3.4"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.3.4.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.1">direct-product</csymbol><ci id="S4.E7.m1.3.3.1.1.3.4.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.2">𝛽</ci><apply id="S4.E7.m1.3.3.1.1.3.4.3.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.4.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.3.4.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.4.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.3.4.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2"><ci id="S4.E7.m1.3.3.1.1.3.4.3.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2.1">~</ci><ci id="S4.E7.m1.3.3.1.1.3.4.3.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.2.2">𝚡</ci></apply><apply id="S4.E7.m1.3.3.1.1.3.4.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3"><times id="S4.E7.m1.3.3.1.1.3.4.3.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.1"></times><ci id="S4.E7.m1.3.3.1.1.3.4.3.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.2">𝐶</ci><apply id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.2">𝐹</ci><cn id="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.3.cmml" type="integer" xref="S4.E7.m1.3.3.1.1.3.4.3.2.3.3.3">2</cn></apply></apply></apply><ci id="S4.E7.m1.3.3.1.1.3.4.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.4.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\tilde{\mathtt{x}}_{i}[t]=\mathtt{x}^{SM}_{i}[t]+\alpha\odot\tilde{\mathtt{x}}%
^{CF_{1}}_{i}+\beta\odot\tilde{\mathtt{x}}^{CF_{2}}_{i},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.3d">over~ start_ARG typewriter_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] = typewriter_x start_POSTSUPERSCRIPT italic_S italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_t ] + italic_α ⊙ over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_β ⊙ over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p2.5">where <math alttext="\tilde{\mathtt{x}}^{CF_{1}}_{i}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS4.SSS0.Px1.p2.1.m1.1a"><msubsup id="S4.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.cmml"><mi id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.2" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.2.cmml">𝚡</mi><mo id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.1" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.3.cmml">i</mi><mrow id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.2.cmml">C</mi><mo id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.2" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.2.cmml">F</mi><mn id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.3" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.3.cmml">1</mn></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2"><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.1">~</ci><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.2.2">𝚡</ci></apply><apply id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3"><times id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.1"></times><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.2">𝐶</ci><apply id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.2">𝐹</ci><cn id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.3.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.1.m1.1c">\tilde{\mathtt{x}}^{CF_{1}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p2.1.m1.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tilde{\mathtt{x}}^{CF_{2}}_{i}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS4.SSS0.Px1.p2.2.m2.1a"><msubsup id="S4.SS4.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.cmml"><mi id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.2" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.2.cmml">𝚡</mi><mo id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.1" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3.cmml">i</mi><mrow id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.2.cmml">C</mi><mo id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.2" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.2.cmml">F</mi><mn id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.3" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.3.cmml">2</mn></msub></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2"><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.1">~</ci><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.2.2">𝚡</ci></apply><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3"><times id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.1"></times><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.2">𝐶</ci><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.2">𝐹</ci><cn id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.3.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.3.3.3">2</cn></apply></apply></apply><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.2.m2.1c">\tilde{\mathtt{x}}^{CF_{2}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p2.2.m2.1d">over~ start_ARG typewriter_x end_ARG start_POSTSUPERSCRIPT italic_C italic_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are CF embeddings generated from different CF-based models for the same item <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS4.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS4.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p2.3.m3.1d">italic_i</annotation></semantics></math>. <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p2.4.m4.1"><semantics id="S4.SS4.SSS0.Px1.p2.4.m4.1a"><mi id="S4.SS4.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.4.m4.1b"><ci id="S4.SS4.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p2.4.m4.1d">italic_β</annotation></semantics></math> is another fusion weight vector output from a second <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS4.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS4.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.5.m5.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p2.5.m5.1d">typewriter_GATE</annotation></semantics></math> network.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results and Discussion</h4>
<div class="ltx_para" id="S4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.5">We present the findings of our ablation study as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.F3" title="Figure 3 ‣ Results and Discussion ‣ 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Our analysis in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.F3" title="Figure 3 ‣ Results and Discussion ‣ 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>a focuses on <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS0.Px2.p1.5.1">how to fuse</span> and reveals that adding CF embeddings directly onto LLM embeddings (<math alttext="\alpha=1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1"><eq id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2">𝛼</ci><cn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.1.m1.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.1.m1.1d">italic_α = 1</annotation></semantics></math>) results in the worst performance. This is due to the fact that such a fusion strategy completely disregards the correlation between the two modalities. In contrast, <math alttext="\alpha\in R" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1"><in id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1"></in><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2">𝛼</ci><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.2.m2.1c">\alpha\in R</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.2.m2.1d">italic_α ∈ italic_R</annotation></semantics></math> and CoLLM have quite a better performance than <math alttext="\alpha=1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS4.SSS0.Px2.p1.3.m3.1a"><mrow id="S4.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1"><eq id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.2">𝛼</ci><cn id="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.3.m3.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.3.m3.1d">italic_α = 1</annotation></semantics></math>. It is because, though inadequate, they both capture the correlation to some extent. In <math alttext="\alpha\in R" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS4.SSS0.Px2.p1.4.m4.1a"><mrow id="S4.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml">α</mi><mo id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1"><in id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1"></in><ci id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2">𝛼</ci><ci id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.4.m4.1c">\alpha\in R</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.4.m4.1d">italic_α ∈ italic_R</annotation></semantics></math> it is conducted with a <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS4.SSS0.Px2.p1.5.m5.1a"><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.5.m5.1b"><ci id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.5.m5.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.5.m5.1d">typewriter_GATE</annotation></semantics></math> network adaptively in a token-wise manner, and in CoLLM it is conducted with the LLM which applies an attention mechanism on the input token sequence. Our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.SSS0.Px2.p1.5.2">CCF-LLM</span>, however, utilizes the cross-gate mechanism adaptively in a finer dimensional-wise granularity, leading to optimal performance.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p2.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.F3" title="Figure 3 ‣ Results and Discussion ‣ 4.3. Main Results of CCF-LLM (RQ2) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>b, we examine <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS0.Px2.p2.1.1">what to fuse</span> and find that combining multiple CF embeddings does not improve the recommendation performance compared to using only a single backend CF-based model. One possible reason is that the collaborative signals from various models are redundant, offering no additional insight beyond that of a single model. For some items, there could also be conflicting signals that are incompatible for fusion.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Impact of the training strategies.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.1.1.1.1">Training Strategy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.2">AUC</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.3">RelaImpr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.1.2.1.1">Default</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.2">0.7427</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T4.1.2.1.3">-</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.1.3.2.1">Stage 1 Only</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.2.2">0.7025</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.1.3.2.3">-16.56%</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.1.4.3.1">End-to-end</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.4.3.2">0.6390</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T4.1.4.3.3">-42.73%</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Case study of a user who has given high ratings to action, drama, and adventure movies.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.1.1.1.1">Movies</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.1.1.1.2">Genres</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.3">Ground-truth Labels</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.4">Rank by LightGCN</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.5">Rank by Vicuna-7B</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.6">Rank by CCF-LLM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.2.1.1">Deconstructing Harry</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.2.1.2">Comedy, Drama</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.3">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.4">5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.5">2</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T5.1.2.1.6">1</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.3.2.1">Big Daddy</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.3.2.2">Comedy</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.2.3">0</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.2.4">4</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.2.5">1</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.3.2.6">4</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.4.3.1">But I’m a Cheerleader</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.4.3.2">Comedy</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.3">1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.4">2</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.5">3</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.4.3.6">2</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.5.4.1">Desperately Seeking Susan</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.5.4.2">Comedy, Romance</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.4.3">1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.4.4">1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.4.5">4</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.5.4.6">3</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T5.1.6.5.1">Lake Placid</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T5.1.6.5.2">Horror, Thriller</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.6.5.3">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.6.5.4">3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.6.5.5">5</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T5.1.6.5.6">5</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Model Analyses (RQ4)</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">In this section, we aim to analyze several key factors in our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.1">CCF-LLM</span> that can benefit the recommendations, including the training strategies as well as the distribution of fused embeddings.</p>
</div>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Training Steps</h4>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">As demonstrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S3.SS4" title="3.4. Training ‣ 3. Methodology ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">3.4</span></a>, our training strategy involves two stages. We examine two other strategies in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.T4" title="Table 4 ‣ Results and Discussion ‣ 4.4. Ablation Study (RQ3) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, including only training <math alttext="\Theta_{1}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2" mathvariant="normal" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml">Θ</mi><mn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2">Θ</ci><cn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.1.m1.1c">\Theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.1.m1.1d">roman_Θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> without the second stage (denoted as “Stage 1 Only”), and training <math alttext="\Theta_{1}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2" mathvariant="normal" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml">Θ</mi><mn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2">Θ</ci><cn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.2.m2.1c">\Theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.2.m2.1d">roman_Θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Theta_{2}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS5.SSS0.Px1.p1.3.m3.1a"><msub id="S4.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2" mathvariant="normal" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml">Θ</mi><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2">Θ</ci><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.3.m3.1c">\Theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.3.m3.1d">roman_Θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> in an end-to-end manner within a single stage until convergence (denoted as “End-to-end”). Experiments are conducted on the MovieLens-1M dataset with LightGCN as the backend CF-based model.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p2.2">We can observe that without training the attentive cross-modal fusion strategy in the second stage, the fusion between the two modalities are incomplete, resulting in inferior performance. On the other hand, training all parameters in an end-to-end manner will significantly decrease the performance. A possible reason could be that earlier in the training process, an insufficiently tuned LLM may misguide the training of the <math alttext="\mathtt{ALG}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS5.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml">𝙰𝙻𝙶</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1">𝙰𝙻𝙶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.1.m1.1c">\mathtt{ALG}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p2.1.m1.1d">typewriter_ALG</annotation></semantics></math> and <math alttext="\mathtt{GATE}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml">𝙶𝙰𝚃𝙴</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1">𝙶𝙰𝚃𝙴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.2.m2.1c">\mathtt{GATE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p2.2.m2.1d">typewriter_GATE</annotation></semantics></math> networks, leading to undesirable fusion.
In summary, our two-stage training strategy empowers the effective optimization of the cross-modal fusion strategy. It helps us integrate the two modalities in a unified latent space for a synergistic fusion, thereby benefiting the recommendation outcomes.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Visualization of Cross-modal Fusion</h4>
<div class="ltx_para" id="S4.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.1">To further examine how the embeddings are fused into a unified latent space, we randomly select 1,000 items from each dataset and visualize the item embeddings from the two modalities as well as their fused embeddings with t-SNE <cite class="ltx_cite ltx_citemacro_citep">(van der Maaten and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib43" title="">2008</a>)</cite> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.F4" title="Figure 4 ‣ Visualization of Cross-modal Fusion ‣ 4.5. Model Analyses (RQ4) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. The CF embeddings for collaborative signals are extracted from SASRec.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="305" id="S4.F4.g1" src="x4.png" width="582"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Visualization of the item embeddings in different modalities with t-SNE. Green: Aligned CF embeddings; Yellow: LLM embeddings; Purple: fused embeddings.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS5.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p2.1">From Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.F4" title="Figure 4 ‣ Visualization of Cross-modal Fusion ‣ 4.5. Model Analyses (RQ4) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> we can observe that the aligned CF embeddings (green) and LLM embeddings (yellow, which are pre-processed with mean pooling for each item before t-SNE) are clearly separated from each other with well-defined boundaries. This observation suggests that directly injecting collaborative signals into LLMs is infeasible, even after the CF embeddings are already aligned by <math alttext="\mathtt{ALG}" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS5.SSS0.Px2.p2.1.m1.1a"><mi id="S4.SS5.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1.cmml">𝙰𝙻𝙶</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px2.p2.1.m1.1b"><ci id="S4.SS5.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px2.p2.1.m1.1.1">𝙰𝙻𝙶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px2.p2.1.m1.1c">\mathtt{ALG}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px2.p2.1.m1.1d">typewriter_ALG</annotation></semantics></math> as in previous work <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib51" title="">2023</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#bib.bib30" title="">2024</a>)</cite>. In <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.SSS0.Px2.p2.1.1">CCF-LLM</span>, we further fuse the two modalities with an attentive cross-modal fusion strategy. We observe that the fused embeddings (purple) become indistinguishable from the LLM embeddings that capture semantic knowledge, suggesting that the fused embeddings are more consistent with the LLM space. The visualization on the two datasets indicate that our <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.SSS0.Px2.p2.1.2">CCF-LLM</span> can better fuse the two types of modalities with the proposed attentive cross-modal fusion strategy.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Case Study</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">We select a typical case to investigate the impact of fusing collaborative signals and semantic knowledge in LLM4Rec. In the test set of MovieLens-1M, a user with ID 4 has given high ratings to “Star Wars: Episode IV - A New Hope”, “Blade Runner”, “Raiders of the Lost Ark”, “The Godfather”, “Die Hard”, “True Romance”, “Rocky”, “The Untouchables”, and “Diva”. From the list, we observe that those movies are primarily actions, dramas, or adventures. In the case study, we select five movies in the test set to examine the predictions made by LightGCN, the original Vicuna-7B, and our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.1.1">CCF-LLM</span> using LightGCN as the backend model.</p>
</div>
<div class="ltx_para" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.08564v1#S4.T5" title="Table 5 ‣ Results and Discussion ‣ 4.4. Ablation Study (RQ3) ‣ 4. Experiment ‣ Collaborative Cross-modal Fusion with Large Language Model for Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> presents the results of the case study.
On the one hand, we can observe that Vicuna-7B utilizes semantic knowledge to predict high scores for the movies “Deconstructing Harry” and “Big Daddy”, which have similar genres or themes with the user’s previously favored movies. On the other hand, LightGCN makes predictions that benefit from collaborative signals, and it predicts high scores for “But I’m a Cheerleader” and “Desperately Seeking Susan”. Both of these two movies are positive in the test set but are not similar to the user’s previously favored movies in semantics, which shows the significance of collaborative signals for recommendation.</p>
</div>
<div class="ltx_para" id="S4.SS6.p3">
<p class="ltx_p" id="S4.SS6.p3.1">Finally, by fusing collaborative signals with semantic knowledge, <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.1">CCF-LLM</span> can leverage both modalities for recommendation. For instance, <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.2">CCF-LLM</span> shows an increase in ranks for “But I’m a Cheerleader” and “Desperately Seeking Susan” when compared to predictions made solely using natural language input by Vicuna-7B. Moreover, guided by the collaborative signal, <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.3">CCF-LLM</span> decreases the rank for ”Big Daddy” from 1 to 4. The changes in rank illustrate that collaborative signals can help LLMs to improve the predictions. It is worth noting that <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.4">CCF-LLM</span> raises the rank for “Deconstructing Harry” even though LightGCN does not rate it highly. This observation suggests that <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.5">CCF-LLM</span> is robust to noisy collaborative signals and can correct the inaccurate information from CF embeddings. As a result, our proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p3.1.6">CCF-LLM</span> outperforms both CF-based models and LLMs in recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we proposed a novel framework for collaborative cross-modal fusion with large language models for recommendation (<span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">CCF-LLM</span>). Through the hybrid prompt translation and the attentive cross-modal fusion strategy, <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">CCF-LLM</span> enchanced LLM4Rec by adaptively fusing the CF and LLM embeddings, achieving synergy across heterogeneous modalities.
Our work shed light on how to effectively leverage the collaborative signals in the context of LLM4Rec. In future studies, we aim to explore the full potential of LLMs in recommendations with more types of modalities and more advanced fusion strategies.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This research / project is supported by the Ministry of Education, Singapore, under its Academic Research Fund Tier 2 (Proposal ID: T2EP20122-0041). Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not reflect the views of the Ministry of Education, Singapore.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al<span class="ltx_text" id="bib.bib2.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">GPT-4 technical report.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2303.08774

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">TALLRec: An effective and efficient tuning framework to align large language model with recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">RecSys</em>. 1007–1014.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brand (2003)</span>
<span class="ltx_bibblock">
Matthew Brand. 2003.

</span>
<span class="ltx_bibblock">Fast online SVD revisions for lightweight recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">SDM</em>. 37–46.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al<span class="ltx_text" id="bib.bib5.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.4.1">NeurIPS</em>. 1877–1901.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Rui Chen, Qingyi Hua, Yan-Shuo Chang, Bo Wang, Lei Zhang, and Xiangjie Kong. 2018.

</span>
<span class="ltx_bibblock">A survey of collaborative filtering-based recommender systems: From traditional methods to hybrid methods based on social networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">IEEE Access</em> 6 (2018), 64301–64320.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen (2023)</span>
<span class="ltx_bibblock">
Zheng Chen. 2023.

</span>
<span class="ltx_bibblock">PALR: Personalization Aware LLMs for Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.07622

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib8.3.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Zhiyong Cheng, Ying Ding, Xiangnan He, Lei Zhu, Xuemeng Song, and Mohan S Kankanhalli. 2018.

</span>
<span class="ltx_bibblock">A<sup class="ltx_sup" id="bib.bib8.4.1"><span class="ltx_text ltx_font_italic" id="bib.bib8.4.1.1">3</span></sup>NCF: An Adaptive Aspect Attention Model for Rating Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.5.2">IJCAI</em>. 3748–3754.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E Gonzalez, et al<span class="ltx_text" id="bib.bib9.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://vicuna.lmsys.org" title="">https://vicuna.lmsys.org</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zeyu Cui, Jianxin Ma, Chang Zhou, Jingren Zhou, and Hongxia Yang. 2022.

</span>
<span class="ltx_bibblock">M6-rec: Generative pretrained language models are open-ended recommender systems.

</span>
<span class="ltx_bibblock">(2022).

</span>
<span class="ltx_bibblock">arXiv:2205.08084

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deshpande and Karypis (2004)</span>
<span class="ltx_bibblock">
Mukund Deshpande and George Karypis. 2004.

</span>
<span class="ltx_bibblock">Item-based top-n recommendation algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ACM Transactions on Information Systems</em> 22, 1 (2004), 143–177.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">ACL</em>. 4171–4186.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5). In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">RecSys</em>. 299–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
F Maxwell Harper and Joseph A Konstan. 2015.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Acm Transactions on Interactive Intelligent Systems</em> 5, 4 (2015), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock">Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">WWW</em>. 507–517.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">Lightgcn: Simplifying and powering graph convolution network for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">SIGIR</em>. 639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">WWW</em>. 173–182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhankui He, Zhouhang Xie, Rahul Jha, Harald Steck, Dawen Liang, Yesu Feng, Bodhisattwa Prasad Majumder, Nathan Kallus, and Julian McAuley. 2023.

</span>
<span class="ltx_bibblock">Large language models as zero-shot conversational recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">CIKM</em>. 720–730.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holt and Chung (1999)</span>
<span class="ltx_bibblock">
John D Holt and Soon M Chung. 1999.

</span>
<span class="ltx_bibblock">Efficient mining of association rules in text databases. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">CIKM</em>. 234–242.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian McAuley, and Wayne Xin Zhao. 2024.

</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">ECIR</em>. 364–381.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2022.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Lei Li, Shuyuan Xu, Li Chen, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">Tutorial on Large Language Models for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">RecSys</em>. 1281–1283.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jianchao Ji, Zelong Li, Shuyuan Xu, Wenyue Hua, Yingqiang Ge, Juntao Tan, and Yongfeng Zhang. 2024.

</span>
<span class="ltx_bibblock">GenRec: Large language model for generative recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">ECIR</em>. 494–502.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ICDM</em>. 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keller et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (1985)</span>
<span class="ltx_bibblock">
James M Keller, Michael R Gray, and James A Givens. 1985.

</span>
<span class="ltx_bibblock">A fuzzy k-nearest neighbor algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">IEEE transactions on systems, man, and cybernetics</em> 4 (1985), 580–585.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konstas et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Ioannis Konstas, Vassilios Stathopoulos, and Joemon M Jose. 2009.

</span>
<span class="ltx_bibblock">On social networks and collaborative recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">SIGIR</em>. 195–202.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Yehuda Koren, Robert Bell, and Chris Volinsky. 2009.

</span>
<span class="ltx_bibblock">Matrix factorization techniques for recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Computer</em> 42, 8 (2009), 30–37.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xiangyang Li, Bo Chen, Lu Hou, and Ruiming Tang. 2023a.

</span>
<span class="ltx_bibblock">CTRL: Connect Tabular and Language Model for CTR Prediction.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2306.02841

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing. 2023b.

</span>
<span class="ltx_bibblock">E4SRec: An Elegant Effective Efficient Extensible Solution of Large Language Models for Sequential Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2312.02443

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jiayi Liao, Sihang Li, Zhengyi Yang, Jiancan Wu, Yancheng Yuan, Xiang Wang, and Xiangnan He. 2024.

</span>
<span class="ltx_bibblock">Llara: Large language-recommendation assistant. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">SIGIR</em>. 1785–1795.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianghao Lin, Xinyi Dai, Yunjia Xi, Weiwen Liu, Bo Chen, Xiangyang Li, Chenxu Zhu, Huifeng Guo, Yong Yu, Ruiming Tang, et al<span class="ltx_text" id="bib.bib31.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">How Can Recommender Systems Benefit from Large Language Models: A Survey.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">arXiv:2306.05817

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Huanshuo Liu, Bo Chen, Menghui Zhu, Jianghao Lin, Jiarui Qin, Yang Yang, Hao Zhang, and Ruiming Tang. 2024.

</span>
<span class="ltx_bibblock">Retrieval-Oriented Knowledge for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2404.18304

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Peng Liu, Lemei Zhang, and Jon Atle Gulla. 2023.

</span>
<span class="ltx_bibblock">Pre-train, Prompt, and Recommendation: A Comprehensive Survey of Language Modeling Paradigm Adaptations in Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Transactions of the Association for Computational Linguistics</em> 11 (2023), 1553–1571.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyu et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Hanjia Lyu, Song Jiang, Hanqing Zeng, Yinglong Xia, Qifan Wang, Si Zhang, Ren Chen, Chris Leung, Jiajie Tang, and Jiebo Luo. 2024.

</span>
<span class="ltx_bibblock">LLM-Rec: Personalized Recommendation via Prompting Large Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">NAACL</em>. 583–612.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moshfeghi et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Yashar Moshfeghi, Benjamin Piwowarski, and Joemon M Jose. 2011.

</span>
<span class="ltx_bibblock">Handling data sparsity in collaborative filtering using emotion and semantic based features. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">SIGIR</em>. 625–634.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhaopeng Qiu, Xian Wu, Jingyue Gao, and Wei Fan. 2021.

</span>
<span class="ltx_bibblock">U-BERT: Pre-training user representations for improved recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">AAAI</em>. 4320–4327.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010.

</span>
<span class="ltx_bibblock">Factorization machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">ICDM</em>. 995–1000.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock">BPR: Bayesian personalized ranking from implicit feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">UAI</em>. 452–461.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Yue Shi, Martha Larson, and Alan Hanjalic. 2014.

</span>
<span class="ltx_bibblock">Collaborative filtering beyond the user-item matrix: A survey of the state of the art and future challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Comput. Surveys</em> 47, 1 (2014), 1–45.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Rupesh Kumar Srivastava, Klaus Greff, and Jürgen Schmidhuber. 2015.

</span>
<span class="ltx_bibblock">Highway networks.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1505.00387

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su and Khoshgoftaar (2009)</span>
<span class="ltx_bibblock">
Xiaoyuan Su and Taghi M Khoshgoftaar. 2009.

</span>
<span class="ltx_bibblock">A survey of collaborative filtering techniques.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Advances in artificial intelligence</em> (2009).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al<span class="ltx_text" id="bib.bib42.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">arXiv:2302.13971

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van der Maaten and Hinton (2008)</span>
<span class="ltx_bibblock">
Laurens van der Maaten and Geoffrey Hinton. 2008.

</span>
<span class="ltx_bibblock">Visualizing Data using t-SNE.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Journal of Machine Learning Research</em> 9, 86 (2008), 2579–2605.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Lim (2023)</span>
<span class="ltx_bibblock">
Lei Wang and Ee-Peng Lim. 2023.

</span>
<span class="ltx_bibblock">Zero-Shot Next-Item Recommendation using Large Pretrained Language Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2304.03153

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Yixin Cao, Meng Liu, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Kgat: Knowledge graph attention network for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">SIGIR</em>. 950–958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards Open-World Recommendation with Knowledge Augmentation from Large Language Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2306.10933

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Xiwang Yang, Harald Steck, Yang Guo, and Yong Liu. 2012.

</span>
<span class="ltx_bibblock">On top-k recommendation using social networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">RecSys</em>. 67–74.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Bin Yin, Junjie Xie, Yu Qin, Zixiang Ding, Zhichao Feng, Xiang Li, and Wei Lin. 2023.

</span>
<span class="ltx_bibblock">Heterogeneous Knowledge Fusion: A Novel Approach for Personalized Recommendation via LLM. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">RecSys</em>. 599–601.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Aohan Zeng, Xiao Liu, Zhengxiao Du, Zihan Wang, Hanyu Lai, Ming Ding, Zhuoyi Yang, Yifan Xu, Wendi Zheng, Xiao Xia, et al<span class="ltx_text" id="bib.bib49.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Glm-130b: An open bilingual pre-trained model. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.4.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yuhui Zhang, Hao Ding, Zeren Shui, Yifei Ma, James Zou, Anoop Deoras, and Hao Wang. 2021.

</span>
<span class="ltx_bibblock">Language models as recommender systems: Evaluations and limitations. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">NeurIPS Workshop ICBINB</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yang Zhang, Fuli Feng, Jizhi Zhang, Keqin Bao, Qifan Wang, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">Collm: Integrating collaborative embeddings into large language models for recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2310.19488

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Wang (2023)</span>
<span class="ltx_bibblock">
Zizhuo Zhang and Bang Wang. 2023.

</span>
<span class="ltx_bibblock">Prompt Learning for News Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">SIGIR</em>. 227–237.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">KDD</em>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Aug 16 06:47:41 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
