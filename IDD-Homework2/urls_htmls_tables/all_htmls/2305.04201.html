<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2305.04201] MrTF: Model Refinery for Transductive Federated Learning</title><meta property="og:description" content="We consider a real-world scenario in which a newly-established pilot project needs to make inferences for newly-collected data with the help of other parties under privacy protection policies. Current federated learnin…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MrTF: Model Refinery for Transductive Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="MrTF: Model Refinery for Transductive Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2305.04201">

<!--Generated on Thu Feb 29 09:00:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\jyear</span>
<p id="p1.2" class="ltx_p">2021</p>
</div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p">[3,4]<span id="p2.1.1" class="ltx_ERROR undefined">\fnm</span>Yang <span id="p2.1.2" class="ltx_ERROR undefined">\sur</span>Yang</p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p">1]<span id="p3.1.1" class="ltx_ERROR undefined">\orgdiv</span>State Key Laboratory for Novel Software Technology, <span id="p3.1.2" class="ltx_ERROR undefined">\orgname</span>Nanjing University, <span id="p3.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p3.1.4" class="ltx_ERROR undefined">\city</span>Nanjing, <span id="p3.1.5" class="ltx_ERROR undefined">\postcode</span>210023, <span id="p3.1.6" class="ltx_ERROR undefined">\state</span>Jiangsu, <span id="p3.1.7" class="ltx_ERROR undefined">\country</span>China</p>
</div>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p">2]<span id="p4.1.1" class="ltx_ERROR undefined">\orgdiv</span>School of Artificial Intelligence, <span id="p4.1.2" class="ltx_ERROR undefined">\orgname</span>Nanjing University, <span id="p4.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p4.1.4" class="ltx_ERROR undefined">\city</span>Nanjing, <span id="p4.1.5" class="ltx_ERROR undefined">\postcode</span>210023, <span id="p4.1.6" class="ltx_ERROR undefined">\state</span>Jiangsu, <span id="p4.1.7" class="ltx_ERROR undefined">\country</span>China</p>
</div>
<div id="p5" class="ltx_para">
<p id="p5.1" class="ltx_p">3]<span id="p5.1.1" class="ltx_ERROR undefined">\orgdiv</span>School of Computer Science and Engineering, <span id="p5.1.2" class="ltx_ERROR undefined">\orgname</span>Nanjing University of Science and Technology, <span id="p5.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p5.1.4" class="ltx_ERROR undefined">\city</span>Nanjing, <span id="p5.1.5" class="ltx_ERROR undefined">\postcode</span>210094, <span id="p5.1.6" class="ltx_ERROR undefined">\state</span>Jiangsu, <span id="p5.1.7" class="ltx_ERROR undefined">\country</span>China</p>
</div>
<div id="p6" class="ltx_para">
<p id="p6.1" class="ltx_p">4]<span id="p6.1.1" class="ltx_ERROR undefined">\orgdiv</span>Department of Computing, <span id="p6.1.2" class="ltx_ERROR undefined">\orgname</span>The Hong Kong Polytechnic University, <span id="p6.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p6.1.4" class="ltx_ERROR undefined">\city</span>Hong Kong, <span id="p6.1.5" class="ltx_ERROR undefined">\postcode</span>100872, <span id="p6.1.6" class="ltx_ERROR undefined">\country</span>China</p>
</div>
<h1 class="ltx_title ltx_title_document">MrTF: Model Refinery for Transductive Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id1.1.id1" class="ltx_ERROR undefined">\fnm</span>Xin-Chun <span id="id2.2.id2" class="ltx_ERROR undefined">\sur</span>Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lixc@lamda.nju.edu.cn">lixc@lamda.nju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yyang@njust.edu.cn">yyang@njust.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span id="id3.1.id1" class="ltx_ERROR undefined">\fnm</span>De-Chuan <span id="id4.2.id2" class="ltx_ERROR undefined">\sur</span>Zhan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zhandc@nju.edu.cn">zhandc@nju.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">We consider a real-world scenario in which a newly-established pilot project needs to make inferences for newly-collected data with the help of other parties under privacy protection policies. Current federated learning (FL) paradigms are devoted to solving the data heterogeneity problem without considering the to-be-inferred data. We propose a novel learning paradigm named transductive federated learning (TFL) to simultaneously consider the structural information of the to-be-inferred data. On the one hand, the server could use the pre-available test samples to refine the aggregated models for robust model fusion, which tackles the data heterogeneity problem in FL. On the other hand, the refinery process incorporates test samples into training and could generate better predictions in a transductive manner. We propose several techniques including stabilized teachers, rectified distillation, and clustered label refinery to facilitate the model refinery process. Abundant experimental studies verify the superiorities of the proposed <span id="id5.id1.1" class="ltx_text ltx_framed ltx_framed_underline">M</span>odel <span id="id5.id1.2" class="ltx_text ltx_framed ltx_framed_underline">r</span>efinery framework for <span id="id5.id1.3" class="ltx_text ltx_framed ltx_framed_underline">T</span>ransductive <span id="id5.id1.4" class="ltx_text ltx_framed ltx_framed_underline">F</span>ederated learning (MrTF). The source code is available at <a target="_blank" href="https://github.com/lxcnju/MrTF" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/lxcnju/MrTF</a>.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>federated learning, transductive learning, model refinery
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Machine learning techniques, especially deep learning, have been widely applied to various real-world applications <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">ResNet </a>; <a href="#bib.bib2" title="" class="ltx_ref">Transformer </a>; <a href="#bib.bib3" title="" class="ltx_ref">FedKWS-UI </a>; <a href="#bib.bib4" title="" class="ltx_ref">TKDE-Inc </a></cite>, etc. Inductive learning and transductive learning are two common learning paradigms, where the latter could obtain test samples in advance <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">TransductiveSVM </a>; <a href="#bib.bib6" title="" class="ltx_ref">TransferAsTransductive </a>; <a href="#bib.bib7" title="" class="ltx_ref">TransductiveFewShot-ICLR2019 </a></cite>. Fusing to-be-inferred unlabeled data into training could lead to appreciable performances because it simultaneously captures structural information in both train and test data. The settings of these two paradigms are illustrated at the bottom of Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A practical scenario is that a particular party/user is urgent to make predictions for newly-collected unlabeled data while it has no labeled samples for training. Thus, it needs to seek the help of other relevant parties/users (clients) to build a prediction model in collaboration. There is a restriction that the data of other parties cannot be used directly due to privacy protection policies.
Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib8" title="" class="ltx_ref">Fed-Concept </a>; <a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a>; <a href="#bib.bib10" title="" class="ltx_ref">FedPAN </a></cite> has been proposed as an efficient distributed training paradigm to collaborate with isolated parties without sending users’ data out. On the one hand, various challenges have emerged in FL, e.g., the Non-Independent Identically Distributed (Non-I.I.D.) data challenge <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib11" title="" class="ltx_ref">NonIID-Quag </a></cite>. Participating clients may own various data distributions under different contexts, leading to weight divergence in distributed local training <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a></cite>. On the other hand, existing FL follows an inductive manner that aims to build a global model that could generalize well to any possible forthcoming samples without considering the information of the pre-available test samples. The scenario and challenges are illustrated at the right of Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where the newly-established party has 10 classes to infer, while the participating parties may contain only several classes, various classes, or imbalanced classes, etc. These challenges lead to Non-I.I.D. data that hinders the effectiveness of FL.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we abstract the scene mentioned above as <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">transductive federated learning (TFL), where the server owns to-be-inferred data in advance while training data are distributed across clients in a Non-I.I.D. manner</span>. In TFL, the goal of the server is to assign labels to the test samples on hand. There are two fundamental challenges to tackle: (1) <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">how to overcome the Non-I.I.D. challenge across clients during distributed training?</span> (2) <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">how to improve the inference process for unlabeled data on the server?</span> To solve the former, some previous FL works take various techniques. For example, some works <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib13" title="" class="ltx_ref">Fed-Shared-Data </a></cite> allow sending out a small portion of clients’ data. A better way to meet the privacy policy is the recently proposed FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>, which views the local updated models as “teachers" and distills the knowledge to the aggregated model on a publicly available dataset for robust model fusion. However, collecting appropriate public data is also challenging, especially in data-scarce scenarios. For the latter, we should consider the structural information contained in the pre-available test data to assign better predictions. Considering both, FedDF seems to be an appropriate solution. First, the trouble of collecting unlabeled public data is omitted in TFL because the to-be-referred data is a good candidate. What’s more, distilling on the to-be-referred samples also considers their information, which is expected beneficial for making predictions.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2305.04201/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="225" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.2.1" class="ltx_text" style="font-size:90%;">Left: comparisons of several paradigms. TFL could access test data in advance and the training data is decentralized across clients. Right: a real-world scenario formulated as TFL and corresponding challenges.</span></figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Nevertheless, it is not all smooth sailing. FedDF encounters several fatal challenges faced with large amounts of clients and stochastic client selection. Specifically, FedDF takes the “AvgLogi" (i.e., Averaging Logits) of local updated models as the ensemble, while the logits’ magnitudes across local models vary a lot, and directly averaging them as the “teacher" may lead to training instability. Additionally, stochastic client selection does not guarantee that the local model’s ensemble covers all classes, negatively transferring knowledge for missing classes. Correspondingly, we propose a more stable way as an alternative to refine the aggregated model via rectifying the local models’ logits and introducing label clustering techniques. Verified on several benchmarks, our proposed methods show superiorities towards other methods. Our contributions could be briefed as originally introducing the practical TFL framework and proposing an effective solution named MrTF.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Our work is closely related to federated learning (FL), transductive learning (TL), and external data in FL.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Federated Learning (FL).</span> FL <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib8" title="" class="ltx_ref">Fed-Concept </a>; <a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite> aims to organize isolated clients to accomplish the machine learning process following a distributed training style. As the most standard FL algorithm, Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite> follows the parameter server architecture <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib15" title="" class="ltx_ref">ParameterServer </a></cite> where a server coordinates amounts of clients. During the whole process, only model parameters are transmitted, and advanced privacy protection methods (e.g., differential privacy <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib16" title="" class="ltx_ref">DeepDP </a></cite>) could be additionally applied for stricter privacy protections. The Non-I.I.D. challenge in FL refers to that data of participating users are heterogeneous under various contexts, which hinders the aggregation and personalization in FL <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a>; <a href="#bib.bib17" title="" class="ltx_ref">FedRS </a></cite>. Various solutions are proposed for better model fusion via introducing local regularization <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib18" title="" class="ltx_ref">FedProx </a>; <a href="#bib.bib19" title="" class="ltx_ref">FedMMD </a></cite>, reducing gradient variance <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib20" title="" class="ltx_ref">Scaffold </a></cite>, fine-tuning aggregated model via additional data <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib13" title="" class="ltx_ref">Fed-Shared-Data </a>; <a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>, etc. Knowledge distillation <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib21" title="" class="ltx_ref">KD </a></cite> could facilitate the generalization in FL <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib22" title="" class="ltx_ref">FedAgnosticKD </a>; <a href="#bib.bib23" title="" class="ltx_ref">FedDFKD </a></cite>. However, these FL methods are only devoted to solving the data heterogeneity problem and could not be directly applied to simultaneously solve the two major challenges of TFL.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Transductive Learning (TL).</span> Inductive learning assumes test data are not available during training, requiring the trained models to generalize well on any possible test set. As the opposition, TL could access the to-be-inferred data, and the training process could progressively capture the structural information in both train and test data. TL relaxes the requirement of model generalization and only aims to make better predictions on the available test data. Hence, compared with inductive learning, TL could basically achieve better results when the test samples are accessible. TSVM <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">TransductiveSVM </a></cite> utilizes the margin information in test samples and yields better SVM models. A real-world scenario is that we have to make predictions for unlabeled samples in a novel domain, and fusing labeled samples from source domains for together training is a common solution in transfer learning <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib6" title="" class="ltx_ref">TransferAsTransductive </a></cite> or domain adaptation <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib24" title="" class="ltx_ref">DAN </a></cite>. Another advantageous scene for TL is learning with few-shot samples, where some studies <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib7" title="" class="ltx_ref">TransductiveFewShot-ICLR2019 </a></cite> have verified the superiorities of TL.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">External data in FL.</span> To reduce the weight divergence in FL,  <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib13" title="" class="ltx_ref">Fed-Shared-Data </a></cite> utilize additional labeled data on the server to fine-tune the global model, while <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib25" title="" class="ltx_ref">FedMD </a></cite> resorts to publicly available labeled data. Some semi-supervised FL also introduces unlabeled data <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib26" title="" class="ltx_ref">FedMatch </a>; <a href="#bib.bib27" title="" class="ltx_ref">FedConSSL </a></cite>, while they consider the clients own both labeled and unlabeled samples. The most related work to ours is FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>, which utilizes “AvgLogi" to ensemble local models and further distill the knowledge from them to the aggregated model. However, FedDF only considers the cross-silo scenes defined in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib28" title="" class="ltx_ref">Fed-Advances </a></cite> where the amount of local clients is small (e.g., 20 clients on CIFAR <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib29" title="" class="ltx_ref">cifar </a></cite>) and the client participation ratio is high (e.g., 40% on vision tasks and 100% on NLP tasks). With large amounts of local clients and stochastic client selection, FedDF faces several problems. FedED <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib30" title="" class="ltx_ref">FedED </a></cite> extends FedDF for medical relation extraction. More practical scenes of utilizing FedDF are also studied, e.g., the resource-aware scenes <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib31" title="" class="ltx_ref">ResourceFL </a></cite>.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text ltx_font_bold">Other related works.</span> Learning from multiple source domains <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib32" title="" class="ltx_ref">MSTL-CVPR2010 </a></cite> is also related to TFL. The former does not consider the privacy protection policies and could send out source data or source models to facilitate the learning process of the target domain. The fundamental problem in these works is how to measure the transferability <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib33" title="" class="ltx_ref">MSTL-NeurIPS2021 </a>; <a href="#bib.bib34" title="" class="ltx_ref">Explore-ICASSP2022 </a></cite> between source domains and the target domain. TFL considers data privacy protection, making the learning process more challenging. In TFL, we aim to simultaneously tackle the data heterogeneity problem and make better predictions for the to-be-inferred data.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we first detail the setting and goal of TFL. Then, we introduce FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>/FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite> and their drawbacks in TFL.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Transductive Federated Learning (TFL)</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.11" class="ltx_p">TFL also follows the parameter server <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib15" title="" class="ltx_ref">ParameterServer </a></cite> architecture, and assumes training data are decentralized on local clients while the server could previously access the to-be-inferred data. Mathematically, we have <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients and each client owns a unique data distribution <math id="S3.SS1.p1.2.m2.6" class="ltx_Math" alttext="{\mathcal{D}}_{k}=p_{k}({\mathbf{x}},y)=p_{k}({\mathbf{x}})p_{k}(y|{\mathbf{x}}),k\in[K]" display="inline"><semantics id="S3.SS1.p1.2.m2.6a"><mrow id="S3.SS1.p1.2.m2.6.6.2" xref="S3.SS1.p1.2.m2.6.6.3.cmml"><mrow id="S3.SS1.p1.2.m2.5.5.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.cmml"><msub id="S3.SS1.p1.2.m2.5.5.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.5.5.1.1.3.2" xref="S3.SS1.p1.2.m2.5.5.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.3.3" xref="S3.SS1.p1.2.m2.5.5.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS1.p1.2.m2.5.5.1.1.4" xref="S3.SS1.p1.2.m2.5.5.1.1.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.5" xref="S3.SS1.p1.2.m2.5.5.1.1.5.cmml"><msub id="S3.SS1.p1.2.m2.5.5.1.1.5.2" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.5.2.2" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.5.2.3" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.1.1.5.1" xref="S3.SS1.p1.2.m2.5.5.1.1.5.1.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.5.3.2" xref="S3.SS1.p1.2.m2.5.5.1.1.5.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.5.3.2.1" xref="S3.SS1.p1.2.m2.5.5.1.1.5.3.1.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.2.m2.5.5.1.1.5.3.2.2" xref="S3.SS1.p1.2.m2.5.5.1.1.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.5.3.2.3" xref="S3.SS1.p1.2.m2.5.5.1.1.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.2.m2.5.5.1.1.6" xref="S3.SS1.p1.2.m2.5.5.1.1.6.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.cmml"><msub id="S3.SS1.p1.2.m2.5.5.1.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.3.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.1.1.1.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.1.4.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.1.4.2.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml">𝐱</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.1.4.2.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.1.1.1.2a" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.cmml">​</mo><msub id="S3.SS1.p1.2.m2.5.5.1.1.1.5" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.5.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.5.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.1.1.1.2b" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.2.m2.6.6.2.3" xref="S3.SS1.p1.2.m2.6.6.3a.cmml">,</mo><mrow id="S3.SS1.p1.2.m2.6.6.2.2" xref="S3.SS1.p1.2.m2.6.6.2.2.cmml"><mi id="S3.SS1.p1.2.m2.6.6.2.2.2" xref="S3.SS1.p1.2.m2.6.6.2.2.2.cmml">k</mi><mo id="S3.SS1.p1.2.m2.6.6.2.2.1" xref="S3.SS1.p1.2.m2.6.6.2.2.1.cmml">∈</mo><mrow id="S3.SS1.p1.2.m2.6.6.2.2.3.2" xref="S3.SS1.p1.2.m2.6.6.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.2.2.3.2.1" xref="S3.SS1.p1.2.m2.6.6.2.2.3.1.1.cmml">[</mo><mi id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml">K</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.2.2.3.2.2" xref="S3.SS1.p1.2.m2.6.6.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.6b"><apply id="S3.SS1.p1.2.m2.6.6.3.cmml" xref="S3.SS1.p1.2.m2.6.6.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.6.6.3a.cmml" xref="S3.SS1.p1.2.m2.6.6.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p1.2.m2.5.5.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"><and id="S3.SS1.p1.2.m2.5.5.1.1a.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"></and><apply id="S3.SS1.p1.2.m2.5.5.1.1b.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"><eq id="S3.SS1.p1.2.m2.5.5.1.1.4.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.4"></eq><apply id="S3.SS1.p1.2.m2.5.5.1.1.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.3.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.3.3">𝑘</ci></apply><apply id="S3.SS1.p1.2.m2.5.5.1.1.5.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5"><times id="S3.SS1.p1.2.m2.5.5.1.1.5.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.1"></times><apply id="S3.SS1.p1.2.m2.5.5.1.1.5.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.5.2.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.5.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.5.2.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.2.3">𝑘</ci></apply><interval closure="open" id="S3.SS1.p1.2.m2.5.5.1.1.5.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.5.3.2"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐱</ci><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">𝑦</ci></interval></apply></apply><apply id="S3.SS1.p1.2.m2.5.5.1.1c.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"><eq id="S3.SS1.p1.2.m2.5.5.1.1.6.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.6"></eq><share href="#S3.SS1.p1.2.m2.5.5.1.1.5.cmml" id="S3.SS1.p1.2.m2.5.5.1.1d.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1"></share><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1"><times id="S3.SS1.p1.2.m2.5.5.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.2"></times><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.3.3">𝑘</ci></apply><ci id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3">𝐱</ci><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.5.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.1.1.1.5.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.5.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.5.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.5.3">𝑘</ci></apply><apply id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.5.5.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply><apply id="S3.SS1.p1.2.m2.6.6.2.2.cmml" xref="S3.SS1.p1.2.m2.6.6.2.2"><in id="S3.SS1.p1.2.m2.6.6.2.2.1.cmml" xref="S3.SS1.p1.2.m2.6.6.2.2.1"></in><ci id="S3.SS1.p1.2.m2.6.6.2.2.2.cmml" xref="S3.SS1.p1.2.m2.6.6.2.2.2">𝑘</ci><apply id="S3.SS1.p1.2.m2.6.6.2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.6.6.2.2.3.2"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.6.6.2.2.3.1.1.cmml" xref="S3.SS1.p1.2.m2.6.6.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.6c">{\mathcal{D}}_{k}=p_{k}({\mathbf{x}},y)=p_{k}({\mathbf{x}})p_{k}(y|{\mathbf{x}}),k\in[K]</annotation></semantics></math>. We denote the observed samples as <math id="S3.SS1.p1.3.m3.5" class="ltx_Math" alttext="\{({\mathbf{x}}_{k,i},y_{k,i})\}_{i=1}^{n_{k}}" display="inline"><semantics id="S3.SS1.p1.3.m3.5a"><msubsup id="S3.SS1.p1.3.m3.5.5" xref="S3.SS1.p1.3.m3.5.5.cmml"><mrow id="S3.SS1.p1.3.m3.5.5.1.1.1" xref="S3.SS1.p1.3.m3.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.5.5.1.1.1.2" xref="S3.SS1.p1.3.m3.5.5.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.3" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.SS1.p1.3.m3.2.2.2.4" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">k</mi><mo id="S3.SS1.p1.3.m3.2.2.2.4.1" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.4" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.2" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.2.cmml">y</mi><mrow id="S3.SS1.p1.3.m3.4.4.2.4" xref="S3.SS1.p1.3.m3.4.4.2.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.1" xref="S3.SS1.p1.3.m3.3.3.1.1.cmml">k</mi><mo id="S3.SS1.p1.3.m3.4.4.2.4.1" xref="S3.SS1.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.4.4.2.2" xref="S3.SS1.p1.3.m3.4.4.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.5" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.3.m3.5.5.1.1.1.3" xref="S3.SS1.p1.3.m3.5.5.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.3.m3.5.5.1.3" xref="S3.SS1.p1.3.m3.5.5.1.3.cmml"><mi id="S3.SS1.p1.3.m3.5.5.1.3.2" xref="S3.SS1.p1.3.m3.5.5.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.3.m3.5.5.1.3.1" xref="S3.SS1.p1.3.m3.5.5.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.3.m3.5.5.1.3.3" xref="S3.SS1.p1.3.m3.5.5.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.3.m3.5.5.3" xref="S3.SS1.p1.3.m3.5.5.3.cmml"><mi id="S3.SS1.p1.3.m3.5.5.3.2" xref="S3.SS1.p1.3.m3.5.5.3.2.cmml">n</mi><mi id="S3.SS1.p1.3.m3.5.5.3.3" xref="S3.SS1.p1.3.m3.5.5.3.3.cmml">k</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.5b"><apply id="S3.SS1.p1.3.m3.5.5.cmml" xref="S3.SS1.p1.3.m3.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.2.cmml" xref="S3.SS1.p1.3.m3.5.5">superscript</csymbol><apply id="S3.SS1.p1.3.m3.5.5.1.cmml" xref="S3.SS1.p1.3.m3.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.1.2.cmml" xref="S3.SS1.p1.3.m3.5.5">subscript</csymbol><set id="S3.SS1.p1.3.m3.5.5.1.1.2.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1"><interval closure="open" id="S3.SS1.p1.3.m3.5.5.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2"><apply id="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.1.1.2">𝐱</ci><list id="S3.SS1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.4"><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝑘</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.5.5.1.1.1.1.2.2.2">𝑦</ci><list id="S3.SS1.p1.3.m3.4.4.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.2.4"><ci id="S3.SS1.p1.3.m3.3.3.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1">𝑘</ci><ci id="S3.SS1.p1.3.m3.4.4.2.2.cmml" xref="S3.SS1.p1.3.m3.4.4.2.2">𝑖</ci></list></apply></interval></set><apply id="S3.SS1.p1.3.m3.5.5.1.3.cmml" xref="S3.SS1.p1.3.m3.5.5.1.3"><eq id="S3.SS1.p1.3.m3.5.5.1.3.1.cmml" xref="S3.SS1.p1.3.m3.5.5.1.3.1"></eq><ci id="S3.SS1.p1.3.m3.5.5.1.3.2.cmml" xref="S3.SS1.p1.3.m3.5.5.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.3.m3.5.5.1.3.3.cmml" xref="S3.SS1.p1.3.m3.5.5.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.5.5.3.cmml" xref="S3.SS1.p1.3.m3.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.3.1.cmml" xref="S3.SS1.p1.3.m3.5.5.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.5.5.3.2.cmml" xref="S3.SS1.p1.3.m3.5.5.3.2">𝑛</ci><ci id="S3.SS1.p1.3.m3.5.5.3.3.cmml" xref="S3.SS1.p1.3.m3.5.5.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.5c">\{({\mathbf{x}}_{k,i},y_{k,i})\}_{i=1}^{n_{k}}</annotation></semantics></math>, where <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n_{k}</annotation></semantics></math> is the number of training samples on <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">k</annotation></semantics></math>th client. The total number of training samples from all clients is <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="N=\sum_{k=1}^{K}n_{k}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">N</mi><mo rspace="0.111em" id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><msubsup id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml"><mo id="S3.SS1.p1.6.m6.1.1.3.1.2.2" xref="S3.SS1.p1.6.m6.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.6.m6.1.1.3.1.2.3" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.1.2.3.2" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.6.m6.1.1.3.1.2.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.6.m6.1.1.3.1.2.3.3" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.6.m6.1.1.3.1.3" xref="S3.SS1.p1.6.m6.1.1.3.1.3.cmml">K</mi></msubsup><msub id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2.2" xref="S3.SS1.p1.6.m6.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p1.6.m6.1.1.3.2.3" xref="S3.SS1.p1.6.m6.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><eq id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></eq><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑁</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><apply id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p1.6.m6.1.1.3.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p1.6.m6.1.1.3.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.2.2"></sum><apply id="S3.SS1.p1.6.m6.1.1.3.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3"><eq id="S3.SS1.p1.6.m6.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p1.6.m6.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.6.m6.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.6.m6.1.1.3.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p1.6.m6.1.1.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">N=\sum_{k=1}^{K}n_{k}</annotation></semantics></math>. In TFL, we assume the server owns an unlabeled set <math id="S3.SS1.p1.7.m7.2" class="ltx_Math" alttext="\{{\mathbf{x}}_{j}\}_{j=1}^{M}\sim p_{\text{g}}({\mathbf{x}})" display="inline"><semantics id="S3.SS1.p1.7.m7.2a"><mrow id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml"><msubsup id="S3.SS1.p1.7.m7.2.2.1" xref="S3.SS1.p1.7.m7.2.2.1.cmml"><mrow id="S3.SS1.p1.7.m7.2.2.1.1.1.1" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.2.2.1.1.1.1.2" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.2" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.7.m7.2.2.1.1.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.7.m7.2.2.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.2.2.1.1.3.2" xref="S3.SS1.p1.7.m7.2.2.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p1.7.m7.2.2.1.1.3.1" xref="S3.SS1.p1.7.m7.2.2.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.7.m7.2.2.1.1.3.3" xref="S3.SS1.p1.7.m7.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.7.m7.2.2.1.3" xref="S3.SS1.p1.7.m7.2.2.1.3.cmml">M</mi></msubsup><mo id="S3.SS1.p1.7.m7.2.2.2" xref="S3.SS1.p1.7.m7.2.2.2.cmml">∼</mo><mrow id="S3.SS1.p1.7.m7.2.2.3" xref="S3.SS1.p1.7.m7.2.2.3.cmml"><msub id="S3.SS1.p1.7.m7.2.2.3.2" xref="S3.SS1.p1.7.m7.2.2.3.2.cmml"><mi id="S3.SS1.p1.7.m7.2.2.3.2.2" xref="S3.SS1.p1.7.m7.2.2.3.2.2.cmml">p</mi><mtext id="S3.SS1.p1.7.m7.2.2.3.2.3" xref="S3.SS1.p1.7.m7.2.2.3.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.2.2.3.1" xref="S3.SS1.p1.7.m7.2.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m7.2.2.3.3.2" xref="S3.SS1.p1.7.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.2.2.3.3.2.1" xref="S3.SS1.p1.7.m7.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.SS1.p1.7.m7.2.2.3.3.2.2" xref="S3.SS1.p1.7.m7.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.2b"><apply id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.2.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2.2">similar-to</csymbol><apply id="S3.SS1.p1.7.m7.2.2.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1">superscript</csymbol><apply id="S3.SS1.p1.7.m7.2.2.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1">subscript</csymbol><set id="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1"><apply id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS1.p1.7.m7.2.2.1.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.3"><eq id="S3.SS1.p1.7.m7.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.3.1"></eq><ci id="S3.SS1.p1.7.m7.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.7.m7.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.7.m7.2.2.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.3">𝑀</ci></apply><apply id="S3.SS1.p1.7.m7.2.2.3.cmml" xref="S3.SS1.p1.7.m7.2.2.3"><times id="S3.SS1.p1.7.m7.2.2.3.1.cmml" xref="S3.SS1.p1.7.m7.2.2.3.1"></times><apply id="S3.SS1.p1.7.m7.2.2.3.2.cmml" xref="S3.SS1.p1.7.m7.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.3.2.1.cmml" xref="S3.SS1.p1.7.m7.2.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.2.2.3.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2.3.2.2">𝑝</ci><ci id="S3.SS1.p1.7.m7.2.2.3.2.3a.cmml" xref="S3.SS1.p1.7.m7.2.2.3.2.3"><mtext mathsize="70%" id="S3.SS1.p1.7.m7.2.2.3.2.3.cmml" xref="S3.SS1.p1.7.m7.2.2.3.2.3">g</mtext></ci></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.2c">\{{\mathbf{x}}_{j}\}_{j=1}^{M}\sim p_{\text{g}}({\mathbf{x}})</annotation></semantics></math> with <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">M</annotation></semantics></math> samples to be predicted. The goal of TFL is to make good predictions on the test set via collaborating with these <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">K</annotation></semantics></math> clients without transmitting clients’ data. <span id="S3.SS1.p1.11.2" class="ltx_text ltx_font_italic">Generally, we consider the data distribution of the test data (i.e., <math id="S3.SS1.p1.10.1.m1.1" class="ltx_Math" alttext="p_{\text{g}}(\cdot)" display="inline"><semantics id="S3.SS1.p1.10.1.m1.1a"><mrow id="S3.SS1.p1.10.1.m1.1.2" xref="S3.SS1.p1.10.1.m1.1.2.cmml"><msub id="S3.SS1.p1.10.1.m1.1.2.2" xref="S3.SS1.p1.10.1.m1.1.2.2.cmml"><mi id="S3.SS1.p1.10.1.m1.1.2.2.2" xref="S3.SS1.p1.10.1.m1.1.2.2.2.cmml">p</mi><mtext class="ltx_mathvariant_italic" id="S3.SS1.p1.10.1.m1.1.2.2.3" xref="S3.SS1.p1.10.1.m1.1.2.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.1.m1.1.2.1" xref="S3.SS1.p1.10.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.10.1.m1.1.2.3.2" xref="S3.SS1.p1.10.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.10.1.m1.1.2.3.2.1" xref="S3.SS1.p1.10.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.1.m1.1.1" xref="S3.SS1.p1.10.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.10.1.m1.1.2.3.2.2" xref="S3.SS1.p1.10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.1.m1.1b"><apply id="S3.SS1.p1.10.1.m1.1.2.cmml" xref="S3.SS1.p1.10.1.m1.1.2"><times id="S3.SS1.p1.10.1.m1.1.2.1.cmml" xref="S3.SS1.p1.10.1.m1.1.2.1"></times><apply id="S3.SS1.p1.10.1.m1.1.2.2.cmml" xref="S3.SS1.p1.10.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.1.m1.1.2.2.1.cmml" xref="S3.SS1.p1.10.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.1.m1.1.2.2.2.cmml" xref="S3.SS1.p1.10.1.m1.1.2.2.2">𝑝</ci><ci id="S3.SS1.p1.10.1.m1.1.2.2.3a.cmml" xref="S3.SS1.p1.10.1.m1.1.2.2.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.SS1.p1.10.1.m1.1.2.2.3.cmml" xref="S3.SS1.p1.10.1.m1.1.2.2.3">g</mtext></ci></apply><ci id="S3.SS1.p1.10.1.m1.1.1.cmml" xref="S3.SS1.p1.10.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.1.m1.1c">p_{\text{g}}(\cdot)</annotation></semantics></math>) does not diverge a lot from the data distribution if all clients’ data are centralized (i.e., <math id="S3.SS1.p1.11.2.m2.1" class="ltx_Math" alttext="\frac{1}{K}\sum_{k=1}^{K}p_{k}(\cdot)" display="inline"><semantics id="S3.SS1.p1.11.2.m2.1a"><mrow id="S3.SS1.p1.11.2.m2.1.2" xref="S3.SS1.p1.11.2.m2.1.2.cmml"><mfrac id="S3.SS1.p1.11.2.m2.1.2.2" xref="S3.SS1.p1.11.2.m2.1.2.2.cmml"><mn id="S3.SS1.p1.11.2.m2.1.2.2.2" xref="S3.SS1.p1.11.2.m2.1.2.2.2.cmml">1</mn><mi id="S3.SS1.p1.11.2.m2.1.2.2.3" xref="S3.SS1.p1.11.2.m2.1.2.2.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.2.m2.1.2.1" xref="S3.SS1.p1.11.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.11.2.m2.1.2.3" xref="S3.SS1.p1.11.2.m2.1.2.3.cmml"><msubsup id="S3.SS1.p1.11.2.m2.1.2.3.1" xref="S3.SS1.p1.11.2.m2.1.2.3.1.cmml"><mo id="S3.SS1.p1.11.2.m2.1.2.3.1.2.2" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.cmml"><mi id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.2" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.1" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.3" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.11.2.m2.1.2.3.1.3" xref="S3.SS1.p1.11.2.m2.1.2.3.1.3.cmml">K</mi></msubsup><mrow id="S3.SS1.p1.11.2.m2.1.2.3.2" xref="S3.SS1.p1.11.2.m2.1.2.3.2.cmml"><msub id="S3.SS1.p1.11.2.m2.1.2.3.2.2" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2.cmml"><mi id="S3.SS1.p1.11.2.m2.1.2.3.2.2.2" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.11.2.m2.1.2.3.2.2.3" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.2.m2.1.2.3.2.1" xref="S3.SS1.p1.11.2.m2.1.2.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.11.2.m2.1.2.3.2.3.2" xref="S3.SS1.p1.11.2.m2.1.2.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.2.m2.1.2.3.2.3.2.1" xref="S3.SS1.p1.11.2.m2.1.2.3.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.2.m2.1.1" xref="S3.SS1.p1.11.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.11.2.m2.1.2.3.2.3.2.2" xref="S3.SS1.p1.11.2.m2.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.2.m2.1b"><apply id="S3.SS1.p1.11.2.m2.1.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2"><times id="S3.SS1.p1.11.2.m2.1.2.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.1"></times><apply id="S3.SS1.p1.11.2.m2.1.2.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.2"><divide id="S3.SS1.p1.11.2.m2.1.2.2.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.2"></divide><cn type="integer" id="S3.SS1.p1.11.2.m2.1.2.2.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.2.2">1</cn><ci id="S3.SS1.p1.11.2.m2.1.2.2.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.2.3">𝐾</ci></apply><apply id="S3.SS1.p1.11.2.m2.1.2.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3"><apply id="S3.SS1.p1.11.2.m2.1.2.3.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.2.m2.1.2.3.1.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1">superscript</csymbol><apply id="S3.SS1.p1.11.2.m2.1.2.3.1.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.2.m2.1.2.3.1.2.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1">subscript</csymbol><sum id="S3.SS1.p1.11.2.m2.1.2.3.1.2.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.2"></sum><apply id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3"><eq id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.1"></eq><ci id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.11.2.m2.1.2.3.1.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.11.2.m2.1.2.3.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2"><times id="S3.SS1.p1.11.2.m2.1.2.3.2.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2.1"></times><apply id="S3.SS1.p1.11.2.m2.1.2.3.2.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.2.m2.1.2.3.2.2.1.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.2.m2.1.2.3.2.2.2.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2.2">𝑝</ci><ci id="S3.SS1.p1.11.2.m2.1.2.3.2.2.3.cmml" xref="S3.SS1.p1.11.2.m2.1.2.3.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.11.2.m2.1.1.cmml" xref="S3.SS1.p1.11.2.m2.1.1">⋅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.2.m2.1c">\frac{1}{K}\sum_{k=1}^{K}p_{k}(\cdot)</annotation></semantics></math>). We also consider the opposite case in Sect. <a href="#S5.SS4" title="5.4 More Studies: Cross-Domain TFL ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a> (i.e., cross-domain TFL).</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Averaging (FedAvg)</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.22" class="ltx_p">FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite> takes <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">T</annotation></semantics></math> communication rounds of local and global procedures to collaborate with local clients. During local procedures, a small fraction (i.e. <math id="S3.SS2.p1.2.m2.2" class="ltx_Math" alttext="R\in[0,1]" display="inline"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.3" xref="S3.SS2.p1.2.m2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.3.2" xref="S3.SS2.p1.2.m2.2.3.2.cmml">R</mi><mo id="S3.SS2.p1.2.m2.2.3.1" xref="S3.SS2.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p1.2.m2.2.3.3.2" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.2.3.3.2.1" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p1.2.m2.2.3.3.2.2" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p1.2.m2.2.3.3.2.3" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3"><in id="S3.SS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.1"></in><ci id="S3.SS2.p1.2.m2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2">𝑅</ci><interval closure="closed" id="S3.SS2.p1.2.m2.2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.3.2"><cn type="integer" id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">0</cn><cn type="integer" id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">R\in[0,1]</annotation></semantics></math>) of clients <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">S</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑆</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">S_{t}</annotation></semantics></math> download the global model from server and update it on their own local data for <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">E</annotation></semantics></math> epochs. We denote the global model parameters in <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">t</annotation></semantics></math>th round as <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝜃</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\theta_{t}</annotation></semantics></math>, and the updated model on <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">k</annotation></semantics></math>th client is <math id="S3.SS2.p1.8.m8.2" class="ltx_Math" alttext="\theta_{t,k}" display="inline"><semantics id="S3.SS2.p1.8.m8.2a"><msub id="S3.SS2.p1.8.m8.2.3" xref="S3.SS2.p1.8.m8.2.3.cmml"><mi id="S3.SS2.p1.8.m8.2.3.2" xref="S3.SS2.p1.8.m8.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p1.8.m8.2.2.2.4" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p1.8.m8.2.2.2.4.1" xref="S3.SS2.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.8.m8.2.2.2.2" xref="S3.SS2.p1.8.m8.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.2b"><apply id="S3.SS2.p1.8.m8.2.3.cmml" xref="S3.SS2.p1.8.m8.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.2.3.1.cmml" xref="S3.SS2.p1.8.m8.2.3">subscript</csymbol><ci id="S3.SS2.p1.8.m8.2.3.2.cmml" xref="S3.SS2.p1.8.m8.2.3.2">𝜃</ci><list id="S3.SS2.p1.8.m8.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.2.2.2.4"><ci id="S3.SS2.p1.8.m8.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1">𝑡</ci><ci id="S3.SS2.p1.8.m8.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.2c">\theta_{t,k}</annotation></semantics></math>. During the global procedure, the server collects the updated models and takes a simple parameter averaging process as <math id="S3.SS2.p1.9.m9.3" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\theta_{t,k}" display="inline"><semantics id="S3.SS2.p1.9.m9.3a"><mrow id="S3.SS2.p1.9.m9.3.4" xref="S3.SS2.p1.9.m9.3.4.cmml"><msub id="S3.SS2.p1.9.m9.3.4.2" xref="S3.SS2.p1.9.m9.3.4.2.cmml"><mi id="S3.SS2.p1.9.m9.3.4.2.2" xref="S3.SS2.p1.9.m9.3.4.2.2.cmml">θ</mi><mrow id="S3.SS2.p1.9.m9.3.4.2.3" xref="S3.SS2.p1.9.m9.3.4.2.3.cmml"><mi id="S3.SS2.p1.9.m9.3.4.2.3.2" xref="S3.SS2.p1.9.m9.3.4.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.9.m9.3.4.2.3.1" xref="S3.SS2.p1.9.m9.3.4.2.3.1.cmml">+</mo><mn id="S3.SS2.p1.9.m9.3.4.2.3.3" xref="S3.SS2.p1.9.m9.3.4.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS2.p1.9.m9.3.4.1" xref="S3.SS2.p1.9.m9.3.4.1.cmml">←</mo><mrow id="S3.SS2.p1.9.m9.3.4.3" xref="S3.SS2.p1.9.m9.3.4.3.cmml"><mfrac id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mn id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">1</mn><mrow id="S3.SS2.p1.9.m9.1.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m9.1.1.1.1.2" xref="S3.SS2.p1.9.m9.1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p1.9.m9.1.1.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.1.1.1.2" xref="S3.SS2.p1.9.m9.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS2.p1.9.m9.1.1.1.1.1.3" xref="S3.SS2.p1.9.m9.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p1.9.m9.1.1.1.1.3" xref="S3.SS2.p1.9.m9.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m9.3.4.3.1" xref="S3.SS2.p1.9.m9.3.4.3.1.cmml">​</mo><mrow id="S3.SS2.p1.9.m9.3.4.3.2" xref="S3.SS2.p1.9.m9.3.4.3.2.cmml"><msub id="S3.SS2.p1.9.m9.3.4.3.2.1" xref="S3.SS2.p1.9.m9.3.4.3.2.1.cmml"><mo id="S3.SS2.p1.9.m9.3.4.3.2.1.2" xref="S3.SS2.p1.9.m9.3.4.3.2.1.2.cmml">∑</mo><mrow id="S3.SS2.p1.9.m9.3.4.3.2.1.3" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.cmml"><mi id="S3.SS2.p1.9.m9.3.4.3.2.1.3.2" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.2.cmml">k</mi><mo id="S3.SS2.p1.9.m9.3.4.3.2.1.3.1" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.1.cmml">∈</mo><msub id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.cmml"><mi id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.2" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.2.cmml">S</mi><mi id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.3" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S3.SS2.p1.9.m9.3.4.3.2.2" xref="S3.SS2.p1.9.m9.3.4.3.2.2.cmml"><mi id="S3.SS2.p1.9.m9.3.4.3.2.2.2" xref="S3.SS2.p1.9.m9.3.4.3.2.2.2.cmml">θ</mi><mrow id="S3.SS2.p1.9.m9.3.3.2.4" xref="S3.SS2.p1.9.m9.3.3.2.3.cmml"><mi id="S3.SS2.p1.9.m9.2.2.1.1" xref="S3.SS2.p1.9.m9.2.2.1.1.cmml">t</mi><mo id="S3.SS2.p1.9.m9.3.3.2.4.1" xref="S3.SS2.p1.9.m9.3.3.2.3.cmml">,</mo><mi id="S3.SS2.p1.9.m9.3.3.2.2" xref="S3.SS2.p1.9.m9.3.3.2.2.cmml">k</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.3b"><apply id="S3.SS2.p1.9.m9.3.4.cmml" xref="S3.SS2.p1.9.m9.3.4"><ci id="S3.SS2.p1.9.m9.3.4.1.cmml" xref="S3.SS2.p1.9.m9.3.4.1">←</ci><apply id="S3.SS2.p1.9.m9.3.4.2.cmml" xref="S3.SS2.p1.9.m9.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.4.2.1.cmml" xref="S3.SS2.p1.9.m9.3.4.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.3.4.2.2.cmml" xref="S3.SS2.p1.9.m9.3.4.2.2">𝜃</ci><apply id="S3.SS2.p1.9.m9.3.4.2.3.cmml" xref="S3.SS2.p1.9.m9.3.4.2.3"><plus id="S3.SS2.p1.9.m9.3.4.2.3.1.cmml" xref="S3.SS2.p1.9.m9.3.4.2.3.1"></plus><ci id="S3.SS2.p1.9.m9.3.4.2.3.2.cmml" xref="S3.SS2.p1.9.m9.3.4.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.9.m9.3.4.2.3.3.cmml" xref="S3.SS2.p1.9.m9.3.4.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.9.m9.3.4.3.cmml" xref="S3.SS2.p1.9.m9.3.4.3"><times id="S3.SS2.p1.9.m9.3.4.3.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.1"></times><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><divide id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1"></divide><cn type="integer" id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">1</cn><apply id="S3.SS2.p1.9.m9.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1"><abs id="S3.SS2.p1.9.m9.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1.2"></abs><apply id="S3.SS2.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.SS2.p1.9.m9.3.4.3.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2"><apply id="S3.SS2.p1.9.m9.3.4.3.2.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.4.3.2.1.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1">subscript</csymbol><sum id="S3.SS2.p1.9.m9.3.4.3.2.1.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.2"></sum><apply id="S3.SS2.p1.9.m9.3.4.3.2.1.3.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3"><in id="S3.SS2.p1.9.m9.3.4.3.2.1.3.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.1"></in><ci id="S3.SS2.p1.9.m9.3.4.3.2.1.3.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.2">𝑘</ci><apply id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.2">𝑆</ci><ci id="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.3.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.SS2.p1.9.m9.3.4.3.2.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.3.4.3.2.2.1.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.3.4.3.2.2.2.cmml" xref="S3.SS2.p1.9.m9.3.4.3.2.2.2">𝜃</ci><list id="S3.SS2.p1.9.m9.3.3.2.3.cmml" xref="S3.SS2.p1.9.m9.3.3.2.4"><ci id="S3.SS2.p1.9.m9.2.2.1.1.cmml" xref="S3.SS2.p1.9.m9.2.2.1.1">𝑡</ci><ci id="S3.SS2.p1.9.m9.3.3.2.2.cmml" xref="S3.SS2.p1.9.m9.3.3.2.2">𝑘</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.3c">\theta_{t+1}\leftarrow\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\theta_{t,k}</annotation></semantics></math>. Faced with heterogeneous data, the local model update incurs large gradient variance and weight divergence <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a></cite>. In the following, we denote <math id="S3.SS2.p1.10.m10.2" class="ltx_Math" alttext="f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})" display="inline"><semantics id="S3.SS2.p1.10.m10.2a"><mrow id="S3.SS2.p1.10.m10.2.2" xref="S3.SS2.p1.10.m10.2.2.cmml"><msub id="S3.SS2.p1.10.m10.2.2.3" xref="S3.SS2.p1.10.m10.2.2.3.cmml"><mi id="S3.SS2.p1.10.m10.2.2.3.2" xref="S3.SS2.p1.10.m10.2.2.3.2.cmml">f</mi><mi id="S3.SS2.p1.10.m10.2.2.3.3" xref="S3.SS2.p1.10.m10.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m10.2.2.2" xref="S3.SS2.p1.10.m10.2.2.2.cmml">​</mo><mrow id="S3.SS2.p1.10.m10.2.2.1.1" xref="S3.SS2.p1.10.m10.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.10.m10.2.2.1.1.2" xref="S3.SS2.p1.10.m10.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS2.p1.10.m10.2.2.1.1.3" xref="S3.SS2.p1.10.m10.2.2.1.2.cmml">;</mo><msub id="S3.SS2.p1.10.m10.2.2.1.1.1" xref="S3.SS2.p1.10.m10.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.10.m10.2.2.1.1.1.2" xref="S3.SS2.p1.10.m10.2.2.1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.10.m10.2.2.1.1.1.3" xref="S3.SS2.p1.10.m10.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p1.10.m10.2.2.1.1.4" xref="S3.SS2.p1.10.m10.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.2b"><apply id="S3.SS2.p1.10.m10.2.2.cmml" xref="S3.SS2.p1.10.m10.2.2"><times id="S3.SS2.p1.10.m10.2.2.2.cmml" xref="S3.SS2.p1.10.m10.2.2.2"></times><apply id="S3.SS2.p1.10.m10.2.2.3.cmml" xref="S3.SS2.p1.10.m10.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.2.2.3.1.cmml" xref="S3.SS2.p1.10.m10.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.2.2.3.2.cmml" xref="S3.SS2.p1.10.m10.2.2.3.2">𝑓</ci><ci id="S3.SS2.p1.10.m10.2.2.3.3.cmml" xref="S3.SS2.p1.10.m10.2.2.3.3">𝑘</ci></apply><list id="S3.SS2.p1.10.m10.2.2.1.2.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝐱</ci><apply id="S3.SS2.p1.10.m10.2.2.1.1.1.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.10.m10.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.2c">f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})</annotation></semantics></math> or <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="f_{k}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msub id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2">𝑓</ci><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">f_{k}</annotation></semantics></math> as the prediction function of the <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">k</annotation></semantics></math>th local model that outputs the “logits" for <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><mi id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><ci id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">C</annotation></semantics></math> classes, while <math id="S3.SS2.p1.14.m14.2" class="ltx_Math" alttext="f_{\text{g}}({\mathbf{x}}\mathchar 24635\relax\;\theta)" display="inline"><semantics id="S3.SS2.p1.14.m14.2a"><mrow id="S3.SS2.p1.14.m14.2.3" xref="S3.SS2.p1.14.m14.2.3.cmml"><msub id="S3.SS2.p1.14.m14.2.3.2" xref="S3.SS2.p1.14.m14.2.3.2.cmml"><mi id="S3.SS2.p1.14.m14.2.3.2.2" xref="S3.SS2.p1.14.m14.2.3.2.2.cmml">f</mi><mtext id="S3.SS2.p1.14.m14.2.3.2.3" xref="S3.SS2.p1.14.m14.2.3.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.14.m14.2.3.1" xref="S3.SS2.p1.14.m14.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.14.m14.2.3.3.2" xref="S3.SS2.p1.14.m14.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.14.m14.2.3.3.2.1" xref="S3.SS2.p1.14.m14.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS2.p1.14.m14.2.3.3.2.2" xref="S3.SS2.p1.14.m14.2.3.3.1.cmml">;</mo><mi id="S3.SS2.p1.14.m14.2.2" xref="S3.SS2.p1.14.m14.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS2.p1.14.m14.2.3.3.2.3" xref="S3.SS2.p1.14.m14.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.2b"><apply id="S3.SS2.p1.14.m14.2.3.cmml" xref="S3.SS2.p1.14.m14.2.3"><times id="S3.SS2.p1.14.m14.2.3.1.cmml" xref="S3.SS2.p1.14.m14.2.3.1"></times><apply id="S3.SS2.p1.14.m14.2.3.2.cmml" xref="S3.SS2.p1.14.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m14.2.3.2.1.cmml" xref="S3.SS2.p1.14.m14.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.14.m14.2.3.2.2.cmml" xref="S3.SS2.p1.14.m14.2.3.2.2">𝑓</ci><ci id="S3.SS2.p1.14.m14.2.3.2.3a.cmml" xref="S3.SS2.p1.14.m14.2.3.2.3"><mtext mathsize="70%" id="S3.SS2.p1.14.m14.2.3.2.3.cmml" xref="S3.SS2.p1.14.m14.2.3.2.3">g</mtext></ci></apply><list id="S3.SS2.p1.14.m14.2.3.3.1.cmml" xref="S3.SS2.p1.14.m14.2.3.3.2"><ci id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1">𝐱</ci><ci id="S3.SS2.p1.14.m14.2.2.cmml" xref="S3.SS2.p1.14.m14.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.2c">f_{\text{g}}({\mathbf{x}}\mathchar 24635\relax\;\theta)</annotation></semantics></math> or <math id="S3.SS2.p1.15.m15.1" class="ltx_Math" alttext="f_{\text{g}}" display="inline"><semantics id="S3.SS2.p1.15.m15.1a"><msub id="S3.SS2.p1.15.m15.1.1" xref="S3.SS2.p1.15.m15.1.1.cmml"><mi id="S3.SS2.p1.15.m15.1.1.2" xref="S3.SS2.p1.15.m15.1.1.2.cmml">f</mi><mtext id="S3.SS2.p1.15.m15.1.1.3" xref="S3.SS2.p1.15.m15.1.1.3a.cmml">g</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m15.1b"><apply id="S3.SS2.p1.15.m15.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m15.1.1.2.cmml" xref="S3.SS2.p1.15.m15.1.1.2">𝑓</ci><ci id="S3.SS2.p1.15.m15.1.1.3a.cmml" xref="S3.SS2.p1.15.m15.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.15.m15.1.1.3.cmml" xref="S3.SS2.p1.15.m15.1.1.3">g</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m15.1c">f_{\text{g}}</annotation></semantics></math> as the prediction function of the aggregated model. We sometimes omit the communication round index <math id="S3.SS2.p1.16.m16.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.16.m16.1a"><mi id="S3.SS2.p1.16.m16.1.1" xref="S3.SS2.p1.16.m16.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m16.1b"><ci id="S3.SS2.p1.16.m16.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m16.1c">t</annotation></semantics></math> for simplification. We use <math id="S3.SS2.p1.17.m17.4" class="ltx_Math" alttext="q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})=\sigma(f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k}))" display="inline"><semantics id="S3.SS2.p1.17.m17.4a"><mrow id="S3.SS2.p1.17.m17.4.4" xref="S3.SS2.p1.17.m17.4.4.cmml"><mrow id="S3.SS2.p1.17.m17.3.3.1" xref="S3.SS2.p1.17.m17.3.3.1.cmml"><msub id="S3.SS2.p1.17.m17.3.3.1.3" xref="S3.SS2.p1.17.m17.3.3.1.3.cmml"><mi id="S3.SS2.p1.17.m17.3.3.1.3.2" xref="S3.SS2.p1.17.m17.3.3.1.3.2.cmml">q</mi><mi id="S3.SS2.p1.17.m17.3.3.1.3.3" xref="S3.SS2.p1.17.m17.3.3.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.17.m17.3.3.1.2" xref="S3.SS2.p1.17.m17.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p1.17.m17.3.3.1.1.1" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.17.m17.3.3.1.1.1.2" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.17.m17.3.3.1.1.1.1" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.17.m17.3.3.1.1.1.1.3" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S3.SS2.p1.17.m17.3.3.1.1.1.1.2" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.2.cmml">|</mo><mrow id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.17.m17.1.1" xref="S3.SS2.p1.17.m17.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.2.cmml">;</mo><msub id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.17.m17.3.3.1.1.1.3" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.17.m17.4.4.3" xref="S3.SS2.p1.17.m17.4.4.3.cmml">=</mo><mrow id="S3.SS2.p1.17.m17.4.4.2" xref="S3.SS2.p1.17.m17.4.4.2.cmml"><mi id="S3.SS2.p1.17.m17.4.4.2.3" xref="S3.SS2.p1.17.m17.4.4.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.17.m17.4.4.2.2" xref="S3.SS2.p1.17.m17.4.4.2.2.cmml">​</mo><mrow id="S3.SS2.p1.17.m17.4.4.2.1.1" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.17.m17.4.4.2.1.1.2" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.17.m17.4.4.2.1.1.1" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.cmml"><msub id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.cmml"><mi id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.2" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.3" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.2" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.2" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.p1.17.m17.2.2" xref="S3.SS2.p1.17.m17.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.3" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.2.cmml">;</mo><msub id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.2" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.3" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.4" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.17.m17.4.4.2.1.1.3" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m17.4b"><apply id="S3.SS2.p1.17.m17.4.4.cmml" xref="S3.SS2.p1.17.m17.4.4"><eq id="S3.SS2.p1.17.m17.4.4.3.cmml" xref="S3.SS2.p1.17.m17.4.4.3"></eq><apply id="S3.SS2.p1.17.m17.3.3.1.cmml" xref="S3.SS2.p1.17.m17.3.3.1"><times id="S3.SS2.p1.17.m17.3.3.1.2.cmml" xref="S3.SS2.p1.17.m17.3.3.1.2"></times><apply id="S3.SS2.p1.17.m17.3.3.1.3.cmml" xref="S3.SS2.p1.17.m17.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.3.3.1.3.1.cmml" xref="S3.SS2.p1.17.m17.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.17.m17.3.3.1.3.2.cmml" xref="S3.SS2.p1.17.m17.3.3.1.3.2">𝑞</ci><ci id="S3.SS2.p1.17.m17.3.3.1.3.3.cmml" xref="S3.SS2.p1.17.m17.3.3.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p1.17.m17.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.17.m17.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.2">conditional</csymbol><ci id="S3.SS2.p1.17.m17.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.3">𝑦</ci><list id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1"><ci id="S3.SS2.p1.17.m17.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1">𝐱</ci><apply id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.17.m17.3.3.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S3.SS2.p1.17.m17.4.4.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2"><times id="S3.SS2.p1.17.m17.4.4.2.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2.2"></times><ci id="S3.SS2.p1.17.m17.4.4.2.3.cmml" xref="S3.SS2.p1.17.m17.4.4.2.3">𝜎</ci><apply id="S3.SS2.p1.17.m17.4.4.2.1.1.1.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1"><times id="S3.SS2.p1.17.m17.4.4.2.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.2"></times><apply id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.1.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.3.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.3.3">𝑘</ci></apply><list id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1"><ci id="S3.SS2.p1.17.m17.2.2.cmml" xref="S3.SS2.p1.17.m17.2.2">𝐱</ci><apply id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.17.m17.4.4.2.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m17.4c">q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})=\sigma(f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k}))</annotation></semantics></math> to denote the predicted class probability distribution based on the <math id="S3.SS2.p1.18.m18.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.18.m18.1a"><mi id="S3.SS2.p1.18.m18.1.1" xref="S3.SS2.p1.18.m18.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m18.1b"><ci id="S3.SS2.p1.18.m18.1.1.cmml" xref="S3.SS2.p1.18.m18.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m18.1c">k</annotation></semantics></math>th local model, where <math id="S3.SS2.p1.19.m19.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S3.SS2.p1.19.m19.1a"><mrow id="S3.SS2.p1.19.m19.1.2" xref="S3.SS2.p1.19.m19.1.2.cmml"><mi id="S3.SS2.p1.19.m19.1.2.2" xref="S3.SS2.p1.19.m19.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.19.m19.1.2.1" xref="S3.SS2.p1.19.m19.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.19.m19.1.2.3.2" xref="S3.SS2.p1.19.m19.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.19.m19.1.2.3.2.1" xref="S3.SS2.p1.19.m19.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.19.m19.1.1" xref="S3.SS2.p1.19.m19.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.19.m19.1.2.3.2.2" xref="S3.SS2.p1.19.m19.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m19.1b"><apply id="S3.SS2.p1.19.m19.1.2.cmml" xref="S3.SS2.p1.19.m19.1.2"><times id="S3.SS2.p1.19.m19.1.2.1.cmml" xref="S3.SS2.p1.19.m19.1.2.1"></times><ci id="S3.SS2.p1.19.m19.1.2.2.cmml" xref="S3.SS2.p1.19.m19.1.2.2">𝜎</ci><ci id="S3.SS2.p1.19.m19.1.1.cmml" xref="S3.SS2.p1.19.m19.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m19.1c">\sigma(\cdot)</annotation></semantics></math> is the softmax operator. Similarly, <math id="S3.SS2.p1.20.m20.3" class="ltx_Math" alttext="q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta)" display="inline"><semantics id="S3.SS2.p1.20.m20.3a"><mrow id="S3.SS2.p1.20.m20.3.3" xref="S3.SS2.p1.20.m20.3.3.cmml"><msub id="S3.SS2.p1.20.m20.3.3.3" xref="S3.SS2.p1.20.m20.3.3.3.cmml"><mi id="S3.SS2.p1.20.m20.3.3.3.2" xref="S3.SS2.p1.20.m20.3.3.3.2.cmml">q</mi><mtext id="S3.SS2.p1.20.m20.3.3.3.3" xref="S3.SS2.p1.20.m20.3.3.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.20.m20.3.3.2" xref="S3.SS2.p1.20.m20.3.3.2.cmml">​</mo><mrow id="S3.SS2.p1.20.m20.3.3.1.1" xref="S3.SS2.p1.20.m20.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.20.m20.3.3.1.1.2" xref="S3.SS2.p1.20.m20.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.20.m20.3.3.1.1.1" xref="S3.SS2.p1.20.m20.3.3.1.1.1.cmml"><mi id="S3.SS2.p1.20.m20.3.3.1.1.1.2" xref="S3.SS2.p1.20.m20.3.3.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS2.p1.20.m20.3.3.1.1.1.1" xref="S3.SS2.p1.20.m20.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p1.20.m20.3.3.1.1.1.3.2" xref="S3.SS2.p1.20.m20.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p1.20.m20.1.1" xref="S3.SS2.p1.20.m20.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS2.p1.20.m20.3.3.1.1.1.3.2.1" xref="S3.SS2.p1.20.m20.3.3.1.1.1.3.1.cmml">;</mo><mi id="S3.SS2.p1.20.m20.2.2" xref="S3.SS2.p1.20.m20.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.20.m20.3.3.1.1.3" xref="S3.SS2.p1.20.m20.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m20.3b"><apply id="S3.SS2.p1.20.m20.3.3.cmml" xref="S3.SS2.p1.20.m20.3.3"><times id="S3.SS2.p1.20.m20.3.3.2.cmml" xref="S3.SS2.p1.20.m20.3.3.2"></times><apply id="S3.SS2.p1.20.m20.3.3.3.cmml" xref="S3.SS2.p1.20.m20.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m20.3.3.3.1.cmml" xref="S3.SS2.p1.20.m20.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.20.m20.3.3.3.2.cmml" xref="S3.SS2.p1.20.m20.3.3.3.2">𝑞</ci><ci id="S3.SS2.p1.20.m20.3.3.3.3a.cmml" xref="S3.SS2.p1.20.m20.3.3.3.3"><mtext mathsize="70%" id="S3.SS2.p1.20.m20.3.3.3.3.cmml" xref="S3.SS2.p1.20.m20.3.3.3.3">g</mtext></ci></apply><apply id="S3.SS2.p1.20.m20.3.3.1.1.1.cmml" xref="S3.SS2.p1.20.m20.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p1.20.m20.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.20.m20.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.20.m20.3.3.1.1.1.2.cmml" xref="S3.SS2.p1.20.m20.3.3.1.1.1.2">𝑦</ci><list id="S3.SS2.p1.20.m20.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p1.20.m20.3.3.1.1.1.3.2"><ci id="S3.SS2.p1.20.m20.1.1.cmml" xref="S3.SS2.p1.20.m20.1.1">𝐱</ci><ci id="S3.SS2.p1.20.m20.2.2.cmml" xref="S3.SS2.p1.20.m20.2.2">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m20.3c">q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta)</annotation></semantics></math> denotes the predicted probability of the aggregated model. Notably, <math id="S3.SS2.p1.21.m21.2" class="ltx_Math" alttext="q(\cdot\mathchar 24635\relax\;\theta)" display="inline"><semantics id="S3.SS2.p1.21.m21.2a"><mrow id="S3.SS2.p1.21.m21.2.3" xref="S3.SS2.p1.21.m21.2.3.cmml"><mi id="S3.SS2.p1.21.m21.2.3.2" xref="S3.SS2.p1.21.m21.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.21.m21.2.3.1" xref="S3.SS2.p1.21.m21.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.21.m21.2.3.3.2" xref="S3.SS2.p1.21.m21.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.21.m21.2.3.3.2.1" xref="S3.SS2.p1.21.m21.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.21.m21.1.1" xref="S3.SS2.p1.21.m21.1.1.cmml">⋅</mo><mo rspace="0.447em" id="S3.SS2.p1.21.m21.2.3.3.2.2" xref="S3.SS2.p1.21.m21.2.3.3.1.cmml">;</mo><mi id="S3.SS2.p1.21.m21.2.2" xref="S3.SS2.p1.21.m21.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS2.p1.21.m21.2.3.3.2.3" xref="S3.SS2.p1.21.m21.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m21.2b"><apply id="S3.SS2.p1.21.m21.2.3.cmml" xref="S3.SS2.p1.21.m21.2.3"><times id="S3.SS2.p1.21.m21.2.3.1.cmml" xref="S3.SS2.p1.21.m21.2.3.1"></times><ci id="S3.SS2.p1.21.m21.2.3.2.cmml" xref="S3.SS2.p1.21.m21.2.3.2">𝑞</ci><list id="S3.SS2.p1.21.m21.2.3.3.1.cmml" xref="S3.SS2.p1.21.m21.2.3.3.2"><ci id="S3.SS2.p1.21.m21.1.1.cmml" xref="S3.SS2.p1.21.m21.1.1">⋅</ci><ci id="S3.SS2.p1.21.m21.2.2.cmml" xref="S3.SS2.p1.21.m21.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m21.2c">q(\cdot\mathchar 24635\relax\;\theta)</annotation></semantics></math> denotes predicted probabilities while <math id="S3.SS2.p1.22.m22.1" class="ltx_Math" alttext="p(\cdot)" display="inline"><semantics id="S3.SS2.p1.22.m22.1a"><mrow id="S3.SS2.p1.22.m22.1.2" xref="S3.SS2.p1.22.m22.1.2.cmml"><mi id="S3.SS2.p1.22.m22.1.2.2" xref="S3.SS2.p1.22.m22.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.22.m22.1.2.1" xref="S3.SS2.p1.22.m22.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.22.m22.1.2.3.2" xref="S3.SS2.p1.22.m22.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.22.m22.1.2.3.2.1" xref="S3.SS2.p1.22.m22.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.22.m22.1.1" xref="S3.SS2.p1.22.m22.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.22.m22.1.2.3.2.2" xref="S3.SS2.p1.22.m22.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m22.1b"><apply id="S3.SS2.p1.22.m22.1.2.cmml" xref="S3.SS2.p1.22.m22.1.2"><times id="S3.SS2.p1.22.m22.1.2.1.cmml" xref="S3.SS2.p1.22.m22.1.2.1"></times><ci id="S3.SS2.p1.22.m22.1.2.2.cmml" xref="S3.SS2.p1.22.m22.1.2.2">𝑝</ci><ci id="S3.SS2.p1.22.m22.1.1.cmml" xref="S3.SS2.p1.22.m22.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m22.1c">p(\cdot)</annotation></semantics></math> denotes the oracle ones.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Non-I.I.D. Data</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.9" class="ltx_p">Because users’ data is generated from different contexts, the data across federated clients is usually Non-I.I.D.. For experimental studies, previous works distribute a definite public data set (e.g., MNIST <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib35" title="" class="ltx_ref">mnist </a></cite>, CIFAR <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib29" title="" class="ltx_ref">cifar </a></cite>) onto <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">K</annotation></semantics></math> clients according to various split strategies. In classification tasks with <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">C</annotation></semantics></math> classes, two commonly utilized ways are “<span id="S3.SS3.p1.9.1" class="ltx_text ltx_font_italic">split by label</span>" and “<span id="S3.SS3.p1.9.2" class="ltx_text ltx_font_italic">split by dirichlet</span>". The former assumes each client could only observe <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mover accent="true" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">C</mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><ci id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1">¯</ci><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\overline{C}</annotation></semantics></math> classes while other <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="C-\overline{C}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">C</mi><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">−</mo><mover accent="true" id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">C</mi><mo id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><minus id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"></minus><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝐶</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><ci id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1">¯</ci><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">C-\overline{C}</annotation></semantics></math> classes are not accessible <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a>; <a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a>; <a href="#bib.bib17" title="" class="ltx_ref">FedRS </a></cite>. Although some classes are missing, the observed classes are almost balanced. A smaller <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mover accent="true" id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">C</mi><mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><ci id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1">¯</ci><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\overline{C}</annotation></semantics></math> corresponds to more serious Non-I.I.D. data. The latter samples a class distribution from the Dirichlet distribution <math id="S3.SS3.p1.6.m6.2" class="ltx_Math" alttext="p_{k}(y)\sim\text{Dir}(\alpha)" display="inline"><semantics id="S3.SS3.p1.6.m6.2a"><mrow id="S3.SS3.p1.6.m6.2.3" xref="S3.SS3.p1.6.m6.2.3.cmml"><mrow id="S3.SS3.p1.6.m6.2.3.2" xref="S3.SS3.p1.6.m6.2.3.2.cmml"><msub id="S3.SS3.p1.6.m6.2.3.2.2" xref="S3.SS3.p1.6.m6.2.3.2.2.cmml"><mi id="S3.SS3.p1.6.m6.2.3.2.2.2" xref="S3.SS3.p1.6.m6.2.3.2.2.2.cmml">p</mi><mi id="S3.SS3.p1.6.m6.2.3.2.2.3" xref="S3.SS3.p1.6.m6.2.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m6.2.3.2.1" xref="S3.SS3.p1.6.m6.2.3.2.1.cmml">​</mo><mrow id="S3.SS3.p1.6.m6.2.3.2.3.2" xref="S3.SS3.p1.6.m6.2.3.2.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.2.3.2.3.2.1" xref="S3.SS3.p1.6.m6.2.3.2.cmml">(</mo><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS3.p1.6.m6.2.3.2.3.2.2" xref="S3.SS3.p1.6.m6.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.6.m6.2.3.1" xref="S3.SS3.p1.6.m6.2.3.1.cmml">∼</mo><mrow id="S3.SS3.p1.6.m6.2.3.3" xref="S3.SS3.p1.6.m6.2.3.3.cmml"><mtext id="S3.SS3.p1.6.m6.2.3.3.2" xref="S3.SS3.p1.6.m6.2.3.3.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m6.2.3.3.1" xref="S3.SS3.p1.6.m6.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p1.6.m6.2.3.3.3.2" xref="S3.SS3.p1.6.m6.2.3.3.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.2.3.3.3.2.1" xref="S3.SS3.p1.6.m6.2.3.3.cmml">(</mo><mi id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml">α</mi><mo stretchy="false" id="S3.SS3.p1.6.m6.2.3.3.3.2.2" xref="S3.SS3.p1.6.m6.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.2b"><apply id="S3.SS3.p1.6.m6.2.3.cmml" xref="S3.SS3.p1.6.m6.2.3"><csymbol cd="latexml" id="S3.SS3.p1.6.m6.2.3.1.cmml" xref="S3.SS3.p1.6.m6.2.3.1">similar-to</csymbol><apply id="S3.SS3.p1.6.m6.2.3.2.cmml" xref="S3.SS3.p1.6.m6.2.3.2"><times id="S3.SS3.p1.6.m6.2.3.2.1.cmml" xref="S3.SS3.p1.6.m6.2.3.2.1"></times><apply id="S3.SS3.p1.6.m6.2.3.2.2.cmml" xref="S3.SS3.p1.6.m6.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.3.2.2.1.cmml" xref="S3.SS3.p1.6.m6.2.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.6.m6.2.3.2.2.2.cmml" xref="S3.SS3.p1.6.m6.2.3.2.2.2">𝑝</ci><ci id="S3.SS3.p1.6.m6.2.3.2.2.3.cmml" xref="S3.SS3.p1.6.m6.2.3.2.2.3">𝑘</ci></apply><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑦</ci></apply><apply id="S3.SS3.p1.6.m6.2.3.3.cmml" xref="S3.SS3.p1.6.m6.2.3.3"><times id="S3.SS3.p1.6.m6.2.3.3.1.cmml" xref="S3.SS3.p1.6.m6.2.3.3.1"></times><ci id="S3.SS3.p1.6.m6.2.3.3.2a.cmml" xref="S3.SS3.p1.6.m6.2.3.3.2"><mtext id="S3.SS3.p1.6.m6.2.3.3.2.cmml" xref="S3.SS3.p1.6.m6.2.3.3.2">Dir</mtext></ci><ci id="S3.SS3.p1.6.m6.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.2c">p_{k}(y)\sim\text{Dir}(\alpha)</annotation></semantics></math> for each client <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib11" title="" class="ltx_ref">NonIID-Quag </a>; <a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>, where <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\alpha</annotation></semantics></math> controls the Non-I.I.D. level, and a smaller <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\alpha</annotation></semantics></math> corresponds to a more Non-I.I.D. scene. After determining local clients’ class distributions, training data are accordingly allocated to these clients for distributed training. We study both cases in this paper and show the split distributions with <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">K</mi><mo id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><eq id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"></eq><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝐾</ci><cn type="integer" id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">K=5</annotation></semantics></math> clients in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. <span id="S3.SS3.p1.9.3" class="ltx_text ltx_font_italic">These two cases cover both challenges caused by data heterogeneity, data imbalance, amount skew, and missing classes, which are sufficient to verify the effectiveness of proposed FL methods.</span> Aside from these constructed Non-I.I.D. scenes split by classes, we also consider benchmarks split by users in experimental studies.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F2.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:104.1pt;">
<img src="/html/2305.04201/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_portrait" width="462" height="916" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F2.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:104.1pt;">
<img src="/html/2305.04201/assets/x3.png" id="S3.F2.2.g1" class="ltx_graphics ltx_img_portrait" width="461" height="905" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F2.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:104.1pt;">
<img src="/html/2305.04201/assets/x4.png" id="S3.F2.3.g1" class="ltx_graphics ltx_img_portrait" width="462" height="916" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F2.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:104.1pt;">
<img src="/html/2305.04201/assets/x5.png" id="S3.F2.4.g1" class="ltx_graphics ltx_img_portrait" width="462" height="916" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.10.3" class="ltx_text" style="font-size:90%;">Split data distributions with <math id="S3.F2.8.1.m1.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S3.F2.8.1.m1.1b"><mrow id="S3.F2.8.1.m1.1.1" xref="S3.F2.8.1.m1.1.1.cmml"><mi id="S3.F2.8.1.m1.1.1.2" xref="S3.F2.8.1.m1.1.1.2.cmml">K</mi><mo id="S3.F2.8.1.m1.1.1.1" xref="S3.F2.8.1.m1.1.1.1.cmml">=</mo><mn id="S3.F2.8.1.m1.1.1.3" xref="S3.F2.8.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.8.1.m1.1c"><apply id="S3.F2.8.1.m1.1.1.cmml" xref="S3.F2.8.1.m1.1.1"><eq id="S3.F2.8.1.m1.1.1.1.cmml" xref="S3.F2.8.1.m1.1.1.1"></eq><ci id="S3.F2.8.1.m1.1.1.2.cmml" xref="S3.F2.8.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S3.F2.8.1.m1.1.1.3.cmml" xref="S3.F2.8.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.1.m1.1d">K=5</annotation></semantics></math> clients. We split MNIST and SVHN via both “split by label" (<math id="S3.F2.9.2.m2.1" class="ltx_Math" alttext="\overline{C}=5" display="inline"><semantics id="S3.F2.9.2.m2.1b"><mrow id="S3.F2.9.2.m2.1.1" xref="S3.F2.9.2.m2.1.1.cmml"><mover accent="true" id="S3.F2.9.2.m2.1.1.2" xref="S3.F2.9.2.m2.1.1.2.cmml"><mi id="S3.F2.9.2.m2.1.1.2.2" xref="S3.F2.9.2.m2.1.1.2.2.cmml">C</mi><mo id="S3.F2.9.2.m2.1.1.2.1" xref="S3.F2.9.2.m2.1.1.2.1.cmml">¯</mo></mover><mo id="S3.F2.9.2.m2.1.1.1" xref="S3.F2.9.2.m2.1.1.1.cmml">=</mo><mn id="S3.F2.9.2.m2.1.1.3" xref="S3.F2.9.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.9.2.m2.1c"><apply id="S3.F2.9.2.m2.1.1.cmml" xref="S3.F2.9.2.m2.1.1"><eq id="S3.F2.9.2.m2.1.1.1.cmml" xref="S3.F2.9.2.m2.1.1.1"></eq><apply id="S3.F2.9.2.m2.1.1.2.cmml" xref="S3.F2.9.2.m2.1.1.2"><ci id="S3.F2.9.2.m2.1.1.2.1.cmml" xref="S3.F2.9.2.m2.1.1.2.1">¯</ci><ci id="S3.F2.9.2.m2.1.1.2.2.cmml" xref="S3.F2.9.2.m2.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S3.F2.9.2.m2.1.1.3.cmml" xref="S3.F2.9.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.9.2.m2.1d">\overline{C}=5</annotation></semantics></math>) and “split by dirichlet" (<math id="S3.F2.10.3.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S3.F2.10.3.m3.1b"><mrow id="S3.F2.10.3.m3.1.1" xref="S3.F2.10.3.m3.1.1.cmml"><mi id="S3.F2.10.3.m3.1.1.2" xref="S3.F2.10.3.m3.1.1.2.cmml">α</mi><mo id="S3.F2.10.3.m3.1.1.1" xref="S3.F2.10.3.m3.1.1.1.cmml">=</mo><mn id="S3.F2.10.3.m3.1.1.3" xref="S3.F2.10.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.10.3.m3.1c"><apply id="S3.F2.10.3.m3.1.1.cmml" xref="S3.F2.10.3.m3.1.1"><eq id="S3.F2.10.3.m3.1.1.1.cmml" xref="S3.F2.10.3.m3.1.1.1"></eq><ci id="S3.F2.10.3.m3.1.1.2.cmml" xref="S3.F2.10.3.m3.1.1.2">𝛼</ci><cn type="float" id="S3.F2.10.3.m3.1.1.3.cmml" xref="S3.F2.10.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.3.m3.1d">\alpha=1.0</annotation></semantics></math>). Darker colors and larger sizes mean more samples.</span></figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.26" class="ltx_p">We implement FedAvg on several Non-I.I.D. cases via a one-shot FL similar to <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib36" title="" class="ltx_ref">OneShotFL </a></cite> with only one communication round. Specifically, we first pre-train a global model on the centralized training set for <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="r_{0}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">r</mi><mn id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑟</ci><cn type="integer" id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">r_{0}</annotation></semantics></math> steps and denote the obtained parameters as <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\theta_{0}</annotation></semantics></math>. We use <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\theta_{0}</annotation></semantics></math> as initializations for both centralized training and decentralized training. For the former, we continually update <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\theta_{0}</annotation></semantics></math> on the centralized training set for 50 SGD steps, and denote the obtained centralized model as <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\theta_{\text{Cen}}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3a.cmml">Cen</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝜃</ci><ci id="S3.SS3.p2.5.m5.1.1.3a.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">Cen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\theta_{\text{Cen}}</annotation></semantics></math>. Then, we use <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\theta_{0}</annotation></semantics></math> as global parameters and distribute it onto <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">K</mi><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><eq id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1"></eq><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝐾</ci><cn type="integer" id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">K=10</annotation></semantics></math> clients constructed via the aforementioned split ways. We update <math id="S3.SS3.p2.8.m8.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.8.m8.1a"><msub id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">\theta_{0}</annotation></semantics></math> separately on these 10 clients for 50 steps, and denote the updated models as <math id="S3.SS3.p2.9.m9.3" class="ltx_Math" alttext="\{\theta_{\text{Dec},k}\}_{k=1}^{K}" display="inline"><semantics id="S3.SS3.p2.9.m9.3a"><msubsup id="S3.SS3.p2.9.m9.3.3" xref="S3.SS3.p2.9.m9.3.3.cmml"><mrow id="S3.SS3.p2.9.m9.3.3.1.1.1" xref="S3.SS3.p2.9.m9.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.9.m9.3.3.1.1.1.2" xref="S3.SS3.p2.9.m9.3.3.1.1.2.cmml">{</mo><msub id="S3.SS3.p2.9.m9.3.3.1.1.1.1" xref="S3.SS3.p2.9.m9.3.3.1.1.1.1.cmml"><mi id="S3.SS3.p2.9.m9.3.3.1.1.1.1.2" xref="S3.SS3.p2.9.m9.3.3.1.1.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p2.9.m9.2.2.2.4" xref="S3.SS3.p2.9.m9.2.2.2.3.cmml"><mtext id="S3.SS3.p2.9.m9.1.1.1.1" xref="S3.SS3.p2.9.m9.1.1.1.1a.cmml">Dec</mtext><mo id="S3.SS3.p2.9.m9.2.2.2.4.1" xref="S3.SS3.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.9.m9.2.2.2.2" xref="S3.SS3.p2.9.m9.2.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p2.9.m9.3.3.1.1.1.3" xref="S3.SS3.p2.9.m9.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.9.m9.3.3.1.3" xref="S3.SS3.p2.9.m9.3.3.1.3.cmml"><mi id="S3.SS3.p2.9.m9.3.3.1.3.2" xref="S3.SS3.p2.9.m9.3.3.1.3.2.cmml">k</mi><mo id="S3.SS3.p2.9.m9.3.3.1.3.1" xref="S3.SS3.p2.9.m9.3.3.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.9.m9.3.3.1.3.3" xref="S3.SS3.p2.9.m9.3.3.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.9.m9.3.3.3" xref="S3.SS3.p2.9.m9.3.3.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.3b"><apply id="S3.SS3.p2.9.m9.3.3.cmml" xref="S3.SS3.p2.9.m9.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.3.3.2.cmml" xref="S3.SS3.p2.9.m9.3.3">superscript</csymbol><apply id="S3.SS3.p2.9.m9.3.3.1.cmml" xref="S3.SS3.p2.9.m9.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.3.3.1.2.cmml" xref="S3.SS3.p2.9.m9.3.3">subscript</csymbol><set id="S3.SS3.p2.9.m9.3.3.1.1.2.cmml" xref="S3.SS3.p2.9.m9.3.3.1.1.1"><apply id="S3.SS3.p2.9.m9.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p2.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p2.9.m9.3.3.1.1.1.1.2">𝜃</ci><list id="S3.SS3.p2.9.m9.2.2.2.3.cmml" xref="S3.SS3.p2.9.m9.2.2.2.4"><ci id="S3.SS3.p2.9.m9.1.1.1.1a.cmml" xref="S3.SS3.p2.9.m9.1.1.1.1"><mtext mathsize="70%" id="S3.SS3.p2.9.m9.1.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1.1.1">Dec</mtext></ci><ci id="S3.SS3.p2.9.m9.2.2.2.2.cmml" xref="S3.SS3.p2.9.m9.2.2.2.2">𝑘</ci></list></apply></set><apply id="S3.SS3.p2.9.m9.3.3.1.3.cmml" xref="S3.SS3.p2.9.m9.3.3.1.3"><eq id="S3.SS3.p2.9.m9.3.3.1.3.1.cmml" xref="S3.SS3.p2.9.m9.3.3.1.3.1"></eq><ci id="S3.SS3.p2.9.m9.3.3.1.3.2.cmml" xref="S3.SS3.p2.9.m9.3.3.1.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p2.9.m9.3.3.1.3.3.cmml" xref="S3.SS3.p2.9.m9.3.3.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.9.m9.3.3.3.cmml" xref="S3.SS3.p2.9.m9.3.3.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.3c">\{\theta_{\text{Dec},k}\}_{k=1}^{K}</annotation></semantics></math>. In FedAvg, these updated models will be averaged on the server as the aggregated model, i.e., <math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="\theta_{\text{Agg}}" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><msub id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3a.cmml">Agg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝜃</ci><ci id="S3.SS3.p2.10.m10.1.1.3a.cmml" xref="S3.SS3.p2.10.m10.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.10.m10.1.1.3.cmml" xref="S3.SS3.p2.10.m10.1.1.3">Agg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">\theta_{\text{Agg}}</annotation></semantics></math>. We plot the extracted features of <math id="S3.SS3.p2.11.m11.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.11.m11.1a"><msub id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mi id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.11.m11.1.1.3.cmml" xref="S3.SS3.p2.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">\theta_{0}</annotation></semantics></math>, <math id="S3.SS3.p2.12.m12.1" class="ltx_Math" alttext="\theta_{\text{Cen}}" display="inline"><semantics id="S3.SS3.p2.12.m12.1a"><msub id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml"><mi id="S3.SS3.p2.12.m12.1.1.2" xref="S3.SS3.p2.12.m12.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.12.m12.1.1.3" xref="S3.SS3.p2.12.m12.1.1.3a.cmml">Cen</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><apply id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m12.1.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS3.p2.12.m12.1.1.2.cmml" xref="S3.SS3.p2.12.m12.1.1.2">𝜃</ci><ci id="S3.SS3.p2.12.m12.1.1.3a.cmml" xref="S3.SS3.p2.12.m12.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.12.m12.1.1.3.cmml" xref="S3.SS3.p2.12.m12.1.1.3">Cen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">\theta_{\text{Cen}}</annotation></semantics></math>, and <math id="S3.SS3.p2.13.m13.1" class="ltx_Math" alttext="\theta_{\text{Agg}}" display="inline"><semantics id="S3.SS3.p2.13.m13.1a"><msub id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml"><mi id="S3.SS3.p2.13.m13.1.1.2" xref="S3.SS3.p2.13.m13.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.13.m13.1.1.3" xref="S3.SS3.p2.13.m13.1.1.3a.cmml">Agg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><apply id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m13.1.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1">subscript</csymbol><ci id="S3.SS3.p2.13.m13.1.1.2.cmml" xref="S3.SS3.p2.13.m13.1.1.2">𝜃</ci><ci id="S3.SS3.p2.13.m13.1.1.3a.cmml" xref="S3.SS3.p2.13.m13.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.13.m13.1.1.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3">Agg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">\theta_{\text{Agg}}</annotation></semantics></math> under various Non-I.I.D. levels. For MNIST, we set the dimension of the final classification layer as 2 and plot the feature scatters. For SVHN, we extract hidden features and then utilize T-SNE <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib37" title="" class="ltx_ref">TSNE </a></cite> to obtain the 2-dimensional scatters. The figures are plotted in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> where clusters with different colors represent different classes. The decentralized I.I.D. scenes (i.e., <math id="S3.SS3.p2.14.m14.1" class="ltx_Math" alttext="\overline{C}=10" display="inline"><semantics id="S3.SS3.p2.14.m14.1a"><mrow id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml"><mover accent="true" id="S3.SS3.p2.14.m14.1.1.2" xref="S3.SS3.p2.14.m14.1.1.2.cmml"><mi id="S3.SS3.p2.14.m14.1.1.2.2" xref="S3.SS3.p2.14.m14.1.1.2.2.cmml">C</mi><mo id="S3.SS3.p2.14.m14.1.1.2.1" xref="S3.SS3.p2.14.m14.1.1.2.1.cmml">¯</mo></mover><mo id="S3.SS3.p2.14.m14.1.1.1" xref="S3.SS3.p2.14.m14.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.14.m14.1.1.3" xref="S3.SS3.p2.14.m14.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><apply id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1"><eq id="S3.SS3.p2.14.m14.1.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1.1"></eq><apply id="S3.SS3.p2.14.m14.1.1.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2"><ci id="S3.SS3.p2.14.m14.1.1.2.1.cmml" xref="S3.SS3.p2.14.m14.1.1.2.1">¯</ci><ci id="S3.SS3.p2.14.m14.1.1.2.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S3.SS3.p2.14.m14.1.1.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">\overline{C}=10</annotation></semantics></math>, <math id="S3.SS3.p2.15.m15.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="S3.SS3.p2.15.m15.1a"><mrow id="S3.SS3.p2.15.m15.1.1" xref="S3.SS3.p2.15.m15.1.1.cmml"><mi id="S3.SS3.p2.15.m15.1.1.2" xref="S3.SS3.p2.15.m15.1.1.2.cmml">α</mi><mo id="S3.SS3.p2.15.m15.1.1.1" xref="S3.SS3.p2.15.m15.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.15.m15.1.1.3" xref="S3.SS3.p2.15.m15.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m15.1b"><apply id="S3.SS3.p2.15.m15.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1"><eq id="S3.SS3.p2.15.m15.1.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1.1"></eq><ci id="S3.SS3.p2.15.m15.1.1.2.cmml" xref="S3.SS3.p2.15.m15.1.1.2">𝛼</ci><cn type="float" id="S3.SS3.p2.15.m15.1.1.3.cmml" xref="S3.SS3.p2.15.m15.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m15.1c">\alpha=10.0</annotation></semantics></math>) tend to perform better than centralized training because the former uses <math id="S3.SS3.p2.16.m16.1" class="ltx_math_unparsed" alttext="10\times" display="inline"><semantics id="S3.SS3.p2.16.m16.1a"><mrow id="S3.SS3.p2.16.m16.1b"><mn id="S3.SS3.p2.16.m16.1.1">10</mn><mo lspace="0.222em" id="S3.SS3.p2.16.m16.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m16.1c">10\times</annotation></semantics></math> training samples (10 clients). However, Non-I.I.D. data (i.e., <math id="S3.SS3.p2.17.m17.1" class="ltx_Math" alttext="\overline{C}=3" display="inline"><semantics id="S3.SS3.p2.17.m17.1a"><mrow id="S3.SS3.p2.17.m17.1.1" xref="S3.SS3.p2.17.m17.1.1.cmml"><mover accent="true" id="S3.SS3.p2.17.m17.1.1.2" xref="S3.SS3.p2.17.m17.1.1.2.cmml"><mi id="S3.SS3.p2.17.m17.1.1.2.2" xref="S3.SS3.p2.17.m17.1.1.2.2.cmml">C</mi><mo id="S3.SS3.p2.17.m17.1.1.2.1" xref="S3.SS3.p2.17.m17.1.1.2.1.cmml">¯</mo></mover><mo id="S3.SS3.p2.17.m17.1.1.1" xref="S3.SS3.p2.17.m17.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.17.m17.1.1.3" xref="S3.SS3.p2.17.m17.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m17.1b"><apply id="S3.SS3.p2.17.m17.1.1.cmml" xref="S3.SS3.p2.17.m17.1.1"><eq id="S3.SS3.p2.17.m17.1.1.1.cmml" xref="S3.SS3.p2.17.m17.1.1.1"></eq><apply id="S3.SS3.p2.17.m17.1.1.2.cmml" xref="S3.SS3.p2.17.m17.1.1.2"><ci id="S3.SS3.p2.17.m17.1.1.2.1.cmml" xref="S3.SS3.p2.17.m17.1.1.2.1">¯</ci><ci id="S3.SS3.p2.17.m17.1.1.2.2.cmml" xref="S3.SS3.p2.17.m17.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S3.SS3.p2.17.m17.1.1.3.cmml" xref="S3.SS3.p2.17.m17.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m17.1c">\overline{C}=3</annotation></semantics></math>, <math id="S3.SS3.p2.18.m18.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S3.SS3.p2.18.m18.1a"><mrow id="S3.SS3.p2.18.m18.1.1" xref="S3.SS3.p2.18.m18.1.1.cmml"><mi id="S3.SS3.p2.18.m18.1.1.2" xref="S3.SS3.p2.18.m18.1.1.2.cmml">α</mi><mo id="S3.SS3.p2.18.m18.1.1.1" xref="S3.SS3.p2.18.m18.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.18.m18.1.1.3" xref="S3.SS3.p2.18.m18.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m18.1b"><apply id="S3.SS3.p2.18.m18.1.1.cmml" xref="S3.SS3.p2.18.m18.1.1"><eq id="S3.SS3.p2.18.m18.1.1.1.cmml" xref="S3.SS3.p2.18.m18.1.1.1"></eq><ci id="S3.SS3.p2.18.m18.1.1.2.cmml" xref="S3.SS3.p2.18.m18.1.1.2">𝛼</ci><cn type="float" id="S3.SS3.p2.18.m18.1.1.3.cmml" xref="S3.SS3.p2.18.m18.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m18.1c">\alpha=0.1</annotation></semantics></math>) experiences performance degradation and the features are less discriminative. In many FL theoretical analyses, local gradient variance among clients is always assumed to be bounded <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">DANE </a>; <a href="#bib.bib39" title="" class="ltx_ref">OnTheConverge-ICLR2020 </a>; <a href="#bib.bib20" title="" class="ltx_ref">Scaffold </a></cite>, i.e., <math id="S3.SS3.p2.19.m19.4" class="ltx_Math" alttext="E_{k}\left[\lVert\nabla_{\theta_{k}}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\rVert^{2}\right]\leq\delta,\forall{\mathbf{x}}" display="inline"><semantics id="S3.SS3.p2.19.m19.4a"><mrow id="S3.SS3.p2.19.m19.4.4" xref="S3.SS3.p2.19.m19.4.4.cmml"><mrow id="S3.SS3.p2.19.m19.3.3.1" xref="S3.SS3.p2.19.m19.3.3.1.cmml"><msub id="S3.SS3.p2.19.m19.3.3.1.3" xref="S3.SS3.p2.19.m19.3.3.1.3.cmml"><mi id="S3.SS3.p2.19.m19.3.3.1.3.2" xref="S3.SS3.p2.19.m19.3.3.1.3.2.cmml">E</mi><mi id="S3.SS3.p2.19.m19.3.3.1.3.3" xref="S3.SS3.p2.19.m19.3.3.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.19.m19.3.3.1.2" xref="S3.SS3.p2.19.m19.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.p2.19.m19.3.3.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.2.cmml"><mo id="S3.SS3.p2.19.m19.3.3.1.1.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.2.1.cmml">[</mo><msup id="S3.SS3.p2.19.m19.3.3.1.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.cmml"><mrow id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.cmml"><msub id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><msub id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.2.cmml">θ</mi><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.3.cmml">k</mi></msub></msub><msub id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.19.m19.1.1" xref="S3.SS3.p2.19.m19.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS3.p2.19.m19.3.3.1.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS3.p2.19.m19.3.3.1.1.1.3" xref="S3.SS3.p2.19.m19.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.p2.19.m19.4.4.3" xref="S3.SS3.p2.19.m19.4.4.3.cmml">≤</mo><mrow id="S3.SS3.p2.19.m19.4.4.2.1" xref="S3.SS3.p2.19.m19.4.4.2.2.cmml"><mi id="S3.SS3.p2.19.m19.2.2" xref="S3.SS3.p2.19.m19.2.2.cmml">δ</mi><mo id="S3.SS3.p2.19.m19.4.4.2.1.2" xref="S3.SS3.p2.19.m19.4.4.2.2.cmml">,</mo><mrow id="S3.SS3.p2.19.m19.4.4.2.1.1" xref="S3.SS3.p2.19.m19.4.4.2.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.p2.19.m19.4.4.2.1.1.1" xref="S3.SS3.p2.19.m19.4.4.2.1.1.1.cmml">∀</mo><mi id="S3.SS3.p2.19.m19.4.4.2.1.1.2" xref="S3.SS3.p2.19.m19.4.4.2.1.1.2.cmml">𝐱</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.19.m19.4b"><apply id="S3.SS3.p2.19.m19.4.4.cmml" xref="S3.SS3.p2.19.m19.4.4"><leq id="S3.SS3.p2.19.m19.4.4.3.cmml" xref="S3.SS3.p2.19.m19.4.4.3"></leq><apply id="S3.SS3.p2.19.m19.3.3.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1"><times id="S3.SS3.p2.19.m19.3.3.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.2"></times><apply id="S3.SS3.p2.19.m19.3.3.1.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.3.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.3">subscript</csymbol><ci id="S3.SS3.p2.19.m19.3.3.1.3.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.3.2">𝐸</ci><ci id="S3.SS3.p2.19.m19.3.3.1.3.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.3.3">𝑘</ci></apply><apply id="S3.SS3.p2.19.m19.3.3.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.19.m19.3.3.1.1.2.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1"><times id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.2"></times><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3"><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.2">∇</ci><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.2">𝜃</ci><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply></apply><list id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1"><ci id="S3.SS3.p2.19.m19.1.1.cmml" xref="S3.SS3.p2.19.m19.1.1">𝐱</ci><apply id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><cn type="integer" id="S3.SS3.p2.19.m19.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p2.19.m19.3.3.1.1.1.1.3">2</cn></apply></apply></apply><list id="S3.SS3.p2.19.m19.4.4.2.2.cmml" xref="S3.SS3.p2.19.m19.4.4.2.1"><ci id="S3.SS3.p2.19.m19.2.2.cmml" xref="S3.SS3.p2.19.m19.2.2">𝛿</ci><apply id="S3.SS3.p2.19.m19.4.4.2.1.1.cmml" xref="S3.SS3.p2.19.m19.4.4.2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.19.m19.4.4.2.1.1.1.cmml" xref="S3.SS3.p2.19.m19.4.4.2.1.1.1">for-all</csymbol><ci id="S3.SS3.p2.19.m19.4.4.2.1.1.2.cmml" xref="S3.SS3.p2.19.m19.4.4.2.1.1.2">𝐱</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.19.m19.4c">E_{k}\left[\lVert\nabla_{\theta_{k}}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\rVert^{2}\right]\leq\delta,\forall{\mathbf{x}}</annotation></semantics></math>. Intuitively, smaller gradient dissimilarity corresponds to better performances and faster convergence. We calculate the gradient variance as <math id="S3.SS3.p2.20.m20.3" class="ltx_Math" alttext="\frac{1}{K}\sum_{k=1}^{K}\lVert\theta_{\text{Dec},k}-\theta_{\text{Agg}}\rVert^{2}" display="inline"><semantics id="S3.SS3.p2.20.m20.3a"><mrow id="S3.SS3.p2.20.m20.3.3" xref="S3.SS3.p2.20.m20.3.3.cmml"><mfrac id="S3.SS3.p2.20.m20.3.3.3" xref="S3.SS3.p2.20.m20.3.3.3.cmml"><mn id="S3.SS3.p2.20.m20.3.3.3.2" xref="S3.SS3.p2.20.m20.3.3.3.2.cmml">1</mn><mi id="S3.SS3.p2.20.m20.3.3.3.3" xref="S3.SS3.p2.20.m20.3.3.3.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS3.p2.20.m20.3.3.2" xref="S3.SS3.p2.20.m20.3.3.2.cmml">​</mo><mrow id="S3.SS3.p2.20.m20.3.3.1" xref="S3.SS3.p2.20.m20.3.3.1.cmml"><msubsup id="S3.SS3.p2.20.m20.3.3.1.2" xref="S3.SS3.p2.20.m20.3.3.1.2.cmml"><mo rspace="0em" id="S3.SS3.p2.20.m20.3.3.1.2.2.2" xref="S3.SS3.p2.20.m20.3.3.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.20.m20.3.3.1.2.2.3" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.cmml"><mi id="S3.SS3.p2.20.m20.3.3.1.2.2.3.2" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.2.cmml">k</mi><mo id="S3.SS3.p2.20.m20.3.3.1.2.2.3.1" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.20.m20.3.3.1.2.2.3.3" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.20.m20.3.3.1.2.3" xref="S3.SS3.p2.20.m20.3.3.1.2.3.cmml">K</mi></msubsup><msup id="S3.SS3.p2.20.m20.3.3.1.1" xref="S3.SS3.p2.20.m20.3.3.1.1.cmml"><mrow id="S3.SS3.p2.20.m20.3.3.1.1.1.1" xref="S3.SS3.p2.20.m20.3.3.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S3.SS3.p2.20.m20.3.3.1.1.1.1.2" xref="S3.SS3.p2.20.m20.3.3.1.1.1.2.1.cmml">∥</mo><mrow id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.2" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p2.20.m20.2.2.2.4" xref="S3.SS3.p2.20.m20.2.2.2.3.cmml"><mtext id="S3.SS3.p2.20.m20.1.1.1.1" xref="S3.SS3.p2.20.m20.1.1.1.1a.cmml">Dec</mtext><mo id="S3.SS3.p2.20.m20.2.2.2.4.1" xref="S3.SS3.p2.20.m20.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.20.m20.2.2.2.2" xref="S3.SS3.p2.20.m20.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.2" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.2.cmml">θ</mi><mtext id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3a.cmml">Agg</mtext></msub></mrow><mo fence="true" lspace="0em" id="S3.SS3.p2.20.m20.3.3.1.1.1.1.3" xref="S3.SS3.p2.20.m20.3.3.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS3.p2.20.m20.3.3.1.1.3" xref="S3.SS3.p2.20.m20.3.3.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.20.m20.3b"><apply id="S3.SS3.p2.20.m20.3.3.cmml" xref="S3.SS3.p2.20.m20.3.3"><times id="S3.SS3.p2.20.m20.3.3.2.cmml" xref="S3.SS3.p2.20.m20.3.3.2"></times><apply id="S3.SS3.p2.20.m20.3.3.3.cmml" xref="S3.SS3.p2.20.m20.3.3.3"><divide id="S3.SS3.p2.20.m20.3.3.3.1.cmml" xref="S3.SS3.p2.20.m20.3.3.3"></divide><cn type="integer" id="S3.SS3.p2.20.m20.3.3.3.2.cmml" xref="S3.SS3.p2.20.m20.3.3.3.2">1</cn><ci id="S3.SS3.p2.20.m20.3.3.3.3.cmml" xref="S3.SS3.p2.20.m20.3.3.3.3">𝐾</ci></apply><apply id="S3.SS3.p2.20.m20.3.3.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1"><apply id="S3.SS3.p2.20.m20.3.3.1.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m20.3.3.1.2.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2">superscript</csymbol><apply id="S3.SS3.p2.20.m20.3.3.1.2.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m20.3.3.1.2.2.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2">subscript</csymbol><sum id="S3.SS3.p2.20.m20.3.3.1.2.2.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.2.2"></sum><apply id="S3.SS3.p2.20.m20.3.3.1.2.2.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3"><eq id="S3.SS3.p2.20.m20.3.3.1.2.2.3.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.1"></eq><ci id="S3.SS3.p2.20.m20.3.3.1.2.2.3.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p2.20.m20.3.3.1.2.2.3.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.20.m20.3.3.1.2.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.2.3">𝐾</ci></apply><apply id="S3.SS3.p2.20.m20.3.3.1.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m20.3.3.1.1.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1">superscript</csymbol><apply id="S3.SS3.p2.20.m20.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.20.m20.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1"><minus id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.1"></minus><apply id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.2.2">𝜃</ci><list id="S3.SS3.p2.20.m20.2.2.2.3.cmml" xref="S3.SS3.p2.20.m20.2.2.2.4"><ci id="S3.SS3.p2.20.m20.1.1.1.1a.cmml" xref="S3.SS3.p2.20.m20.1.1.1.1"><mtext mathsize="70%" id="S3.SS3.p2.20.m20.1.1.1.1.cmml" xref="S3.SS3.p2.20.m20.1.1.1.1">Dec</mtext></ci><ci id="S3.SS3.p2.20.m20.2.2.2.2.cmml" xref="S3.SS3.p2.20.m20.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3a.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.1.1.1.3.3">Agg</mtext></ci></apply></apply></apply><cn type="integer" id="S3.SS3.p2.20.m20.3.3.1.1.3.cmml" xref="S3.SS3.p2.20.m20.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.20.m20.3c">\frac{1}{K}\sum_{k=1}^{K}\lVert\theta_{\text{Dec},k}-\theta_{\text{Agg}}\rVert^{2}</annotation></semantics></math>. Furthermore, the weight divergence proposed in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a></cite> could also reflect the impact of Non-I.I.D. data, i.e., <math id="S3.SS3.p2.21.m21.2" class="ltx_Math" alttext="\frac{\lVert\theta_{\text{Agg}}-\theta_{\text{Cen}}\rVert^{2}}{\lVert\theta_{\text{Cen}}\rVert^{2}}" display="inline"><semantics id="S3.SS3.p2.21.m21.2a"><mfrac id="S3.SS3.p2.21.m21.2.2" xref="S3.SS3.p2.21.m21.2.2.cmml"><msup id="S3.SS3.p2.21.m21.1.1.1" xref="S3.SS3.p2.21.m21.1.1.1.cmml"><mrow id="S3.SS3.p2.21.m21.1.1.1.1.1" xref="S3.SS3.p2.21.m21.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S3.SS3.p2.21.m21.1.1.1.1.1.2" xref="S3.SS3.p2.21.m21.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.SS3.p2.21.m21.1.1.1.1.1.1" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.2.cmml">θ</mi><mtext id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3a.cmml">Agg</mtext></msub><mo id="S3.SS3.p2.21.m21.1.1.1.1.1.1.1" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.2.cmml">θ</mi><mtext id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3a.cmml">Cen</mtext></msub></mrow><mo fence="true" lspace="0em" id="S3.SS3.p2.21.m21.1.1.1.1.1.3" xref="S3.SS3.p2.21.m21.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS3.p2.21.m21.1.1.1.3" xref="S3.SS3.p2.21.m21.1.1.1.3.cmml">2</mn></msup><msup id="S3.SS3.p2.21.m21.2.2.2" xref="S3.SS3.p2.21.m21.2.2.2.cmml"><mrow id="S3.SS3.p2.21.m21.2.2.2.1.1" xref="S3.SS3.p2.21.m21.2.2.2.1.2.cmml"><mo fence="true" rspace="0em" id="S3.SS3.p2.21.m21.2.2.2.1.1.2" xref="S3.SS3.p2.21.m21.2.2.2.1.2.1.cmml">∥</mo><msub id="S3.SS3.p2.21.m21.2.2.2.1.1.1" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.21.m21.2.2.2.1.1.1.2" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.21.m21.2.2.2.1.1.1.3" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.3a.cmml">Cen</mtext></msub><mo fence="true" lspace="0em" id="S3.SS3.p2.21.m21.2.2.2.1.1.3" xref="S3.SS3.p2.21.m21.2.2.2.1.2.1.cmml">∥</mo></mrow><mn id="S3.SS3.p2.21.m21.2.2.2.3" xref="S3.SS3.p2.21.m21.2.2.2.3.cmml">2</mn></msup></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.21.m21.2b"><apply id="S3.SS3.p2.21.m21.2.2.cmml" xref="S3.SS3.p2.21.m21.2.2"><divide id="S3.SS3.p2.21.m21.2.2.3.cmml" xref="S3.SS3.p2.21.m21.2.2"></divide><apply id="S3.SS3.p2.21.m21.1.1.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m21.1.1.1.2.cmml" xref="S3.SS3.p2.21.m21.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.21.m21.1.1.1.1.2.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.21.m21.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS3.p2.21.m21.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1"><minus id="S3.SS3.p2.21.m21.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.1"></minus><apply id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3a.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3"><mtext mathsize="50%" id="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.2.3">Agg</mtext></ci></apply><apply id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3a.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3"><mtext mathsize="50%" id="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.21.m21.1.1.1.1.1.1.3.3">Cen</mtext></ci></apply></apply></apply><cn type="integer" id="S3.SS3.p2.21.m21.1.1.1.3.cmml" xref="S3.SS3.p2.21.m21.1.1.1.3">2</cn></apply><apply id="S3.SS3.p2.21.m21.2.2.2.cmml" xref="S3.SS3.p2.21.m21.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m21.2.2.2.2.cmml" xref="S3.SS3.p2.21.m21.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.21.m21.2.2.2.1.2.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.21.m21.2.2.2.1.2.1.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.2">delimited-∥∥</csymbol><apply id="S3.SS3.p2.21.m21.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m21.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.21.m21.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.2">𝜃</ci><ci id="S3.SS3.p2.21.m21.2.2.2.1.1.1.3a.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.3"><mtext mathsize="50%" id="S3.SS3.p2.21.m21.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.21.m21.2.2.2.1.1.1.3">Cen</mtext></ci></apply></apply><cn type="integer" id="S3.SS3.p2.21.m21.2.2.2.3.cmml" xref="S3.SS3.p2.21.m21.2.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.21.m21.2c">\frac{\lVert\theta_{\text{Agg}}-\theta_{\text{Cen}}\rVert^{2}}{\lVert\theta_{\text{Cen}}\rVert^{2}}</annotation></semantics></math>. We calculate these two statistical measures under three Non-I.I.D. levels and plot the bars in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, where Non-I.I.D. scenes really lead to larger local gradient variance and weight divergence. These findings conform to previous studies <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib12" title="" class="ltx_ref">Fed-NonIID-Data </a>; <a href="#bib.bib18" title="" class="ltx_ref">FedProx </a>; <a href="#bib.bib17" title="" class="ltx_ref">FedRS </a></cite>. Additionally and originally, we also investigate the performance gap between Non-I.I.D. and I.I.D. training along with the quality of model initialization, i.e., varying pre-training steps to obtain different <math id="S3.SS3.p2.22.m22.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.22.m22.1a"><msub id="S3.SS3.p2.22.m22.1.1" xref="S3.SS3.p2.22.m22.1.1.cmml"><mi id="S3.SS3.p2.22.m22.1.1.2" xref="S3.SS3.p2.22.m22.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.22.m22.1.1.3" xref="S3.SS3.p2.22.m22.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.22.m22.1b"><apply id="S3.SS3.p2.22.m22.1.1.cmml" xref="S3.SS3.p2.22.m22.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.22.m22.1.1.1.cmml" xref="S3.SS3.p2.22.m22.1.1">subscript</csymbol><ci id="S3.SS3.p2.22.m22.1.1.2.cmml" xref="S3.SS3.p2.22.m22.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.22.m22.1.1.3.cmml" xref="S3.SS3.p2.22.m22.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.22.m22.1c">\theta_{0}</annotation></semantics></math>. We plot the performances of <math id="S3.SS3.p2.23.m23.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.23.m23.1a"><msub id="S3.SS3.p2.23.m23.1.1" xref="S3.SS3.p2.23.m23.1.1.cmml"><mi id="S3.SS3.p2.23.m23.1.1.2" xref="S3.SS3.p2.23.m23.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.23.m23.1.1.3" xref="S3.SS3.p2.23.m23.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.23.m23.1b"><apply id="S3.SS3.p2.23.m23.1.1.cmml" xref="S3.SS3.p2.23.m23.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.23.m23.1.1.1.cmml" xref="S3.SS3.p2.23.m23.1.1">subscript</csymbol><ci id="S3.SS3.p2.23.m23.1.1.2.cmml" xref="S3.SS3.p2.23.m23.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.23.m23.1.1.3.cmml" xref="S3.SS3.p2.23.m23.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.23.m23.1c">\theta_{0}</annotation></semantics></math>, <math id="S3.SS3.p2.24.m24.1" class="ltx_Math" alttext="\theta_{\text{Cen}}" display="inline"><semantics id="S3.SS3.p2.24.m24.1a"><msub id="S3.SS3.p2.24.m24.1.1" xref="S3.SS3.p2.24.m24.1.1.cmml"><mi id="S3.SS3.p2.24.m24.1.1.2" xref="S3.SS3.p2.24.m24.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.24.m24.1.1.3" xref="S3.SS3.p2.24.m24.1.1.3a.cmml">Cen</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.24.m24.1b"><apply id="S3.SS3.p2.24.m24.1.1.cmml" xref="S3.SS3.p2.24.m24.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.24.m24.1.1.1.cmml" xref="S3.SS3.p2.24.m24.1.1">subscript</csymbol><ci id="S3.SS3.p2.24.m24.1.1.2.cmml" xref="S3.SS3.p2.24.m24.1.1.2">𝜃</ci><ci id="S3.SS3.p2.24.m24.1.1.3a.cmml" xref="S3.SS3.p2.24.m24.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.24.m24.1.1.3.cmml" xref="S3.SS3.p2.24.m24.1.1.3">Cen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.24.m24.1c">\theta_{\text{Cen}}</annotation></semantics></math>, and <math id="S3.SS3.p2.25.m25.1" class="ltx_Math" alttext="\theta_{\text{Agg}}" display="inline"><semantics id="S3.SS3.p2.25.m25.1a"><msub id="S3.SS3.p2.25.m25.1.1" xref="S3.SS3.p2.25.m25.1.1.cmml"><mi id="S3.SS3.p2.25.m25.1.1.2" xref="S3.SS3.p2.25.m25.1.1.2.cmml">θ</mi><mtext id="S3.SS3.p2.25.m25.1.1.3" xref="S3.SS3.p2.25.m25.1.1.3a.cmml">Agg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.25.m25.1b"><apply id="S3.SS3.p2.25.m25.1.1.cmml" xref="S3.SS3.p2.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.25.m25.1.1.1.cmml" xref="S3.SS3.p2.25.m25.1.1">subscript</csymbol><ci id="S3.SS3.p2.25.m25.1.1.2.cmml" xref="S3.SS3.p2.25.m25.1.1.2">𝜃</ci><ci id="S3.SS3.p2.25.m25.1.1.3a.cmml" xref="S3.SS3.p2.25.m25.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.25.m25.1.1.3.cmml" xref="S3.SS3.p2.25.m25.1.1.3">Agg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.25.m25.1c">\theta_{\text{Agg}}</annotation></semantics></math> under various Non-I.I.D. levels in rightmost of Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The gap is significantly large when the initialization model is worse, while it reduces a lot with <math id="S3.SS3.p2.26.m26.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS3.p2.26.m26.1a"><msub id="S3.SS3.p2.26.m26.1.1" xref="S3.SS3.p2.26.m26.1.1.cmml"><mi id="S3.SS3.p2.26.m26.1.1.2" xref="S3.SS3.p2.26.m26.1.1.2.cmml">θ</mi><mn id="S3.SS3.p2.26.m26.1.1.3" xref="S3.SS3.p2.26.m26.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.26.m26.1b"><apply id="S3.SS3.p2.26.m26.1.1.cmml" xref="S3.SS3.p2.26.m26.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.26.m26.1.1.1.cmml" xref="S3.SS3.p2.26.m26.1.1">subscript</csymbol><ci id="S3.SS3.p2.26.m26.1.1.2.cmml" xref="S3.SS3.p2.26.m26.1.1.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.26.m26.1.1.3.cmml" xref="S3.SS3.p2.26.m26.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.26.m26.1c">\theta_{0}</annotation></semantics></math> becoming better. <span id="S3.SS3.p2.26.1" class="ltx_text ltx_font_italic">This observation inspires us that solving the Non-I.I.D. problem in the beginning communication rounds of FL could be more valuable to accelerate training.</span> To be brief, Non-I.I.D. data lead to performance degradation of FedAvg.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S3.F3.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x6.png" id="S3.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="73" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S3.F3.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x7.png" id="S3.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="73" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.4.1" class="ltx_text" style="font-size:90%;">Performance degradation of FedAvg under Non-I.I.D. scenes. The two rows show “split by dirichlet" on MNIST and “split by label" on SVHN, respectively. In each row, the left five figures show the extracted features and test accuracies (top-right numbers) of the pre-trained model, centralized model, and decentralized model under three levels of Non-I.I.D. data. The bars show two measures to evaluate the divergence of distributed training and centralized training. The rightmost shows the accuracy change of these five models with respect to pre-training steps.</span></figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Federated Ensemble Distillation (FedDF)</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.7" class="ltx_p">FedAvg takes an inductive manner and does not make utilization of the available test data in TFL. FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite> could use ensemble distillation <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib21" title="" class="ltx_ref">KD </a></cite> to fine-tune the aggregated model on the unlabeled test data in TFL. Mathematically, instead of simply averaging parameters as done in FedAvg, FedDF takes additional distillation steps to update the global aggregated model as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E1.m1.7" class="ltx_Math" alttext="{\mathcal{L}}_{\text{KL},j}=\text{KL}\left(\underbrace{\sigma\left(\frac{1}{|S_{t}|}\sum_{k\in S_{t}}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right)}_{\text{Distillation Targets}},\sigma(f({\mathbf{x}}\mathchar 24635\relax\;\theta_{j-1}))\right)," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msub id="S3.E1.m1.7.7.1.1.4" xref="S3.E1.m1.7.7.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.4.2" xref="S3.E1.m1.7.7.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mtext id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1a.cmml">KL</mtext><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mtext id="S3.E1.m1.7.7.1.1.2.4" xref="S3.E1.m1.7.7.1.1.2.4a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.3" xref="S3.E1.m1.7.7.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml"><mo id="S3.E1.m1.7.7.1.1.2.2.2.3" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml">(</mo><munder id="S3.E1.m1.7.7.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><munder accentunder="true" id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><mrow id="S3.E1.m1.5.5.3" xref="S3.E1.m1.5.5.3.cmml"><mi id="S3.E1.m1.5.5.3.5" xref="S3.E1.m1.5.5.3.5.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.3.4" xref="S3.E1.m1.5.5.3.4.cmml">​</mo><mrow id="S3.E1.m1.5.5.3.3.1" xref="S3.E1.m1.5.5.3.3.1.1.cmml"><mo id="S3.E1.m1.5.5.3.3.1.2" xref="S3.E1.m1.5.5.3.3.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.3.3.1.1" xref="S3.E1.m1.5.5.3.3.1.1.cmml"><mfrac id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mn id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">1</mn><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">S</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.3.3.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.3.3.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.cmml"><munder id="S3.E1.m1.5.5.3.3.1.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.3.3.1.1.1.2.2" xref="S3.E1.m1.5.5.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.5.5.3.3.1.1.1.2.3" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.2.3.2" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.2.cmml">k</mi><mo id="S3.E1.m1.5.5.3.3.1.1.1.2.3.1" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.2" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.2.cmml">S</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.3" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="S3.E1.m1.5.5.3.3.1.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.3.3.1.1.1.1.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.3.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.3.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.3.3.1.1.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.4" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.3.3.1.3" xref="S3.E1.m1.5.5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.4" xref="S3.E1.m1.5.5.4.cmml">⏟</mo></munder><mtext id="S3.E1.m1.7.7.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2a.cmml">Distillation Targets</mtext></munder><mo id="S3.E1.m1.7.7.1.1.2.2.2.4" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.2.2.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.2.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">𝐱</mi><mo rspace="0.447em" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.1" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.4" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.3" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.2.2.2.5" xref="S3.E1.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"></eq><apply id="S3.E1.m1.7.7.1.1.4.cmml" xref="S3.E1.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.4.1.cmml" xref="S3.E1.m1.7.7.1.1.4">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.4.2.cmml" xref="S3.E1.m1.7.7.1.1.4.2">ℒ</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1a.cmml" xref="S3.E1.m1.1.1.1.1"><mtext mathsize="70%" id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">KL</mtext></ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><times id="S3.E1.m1.7.7.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.3"></times><ci id="S3.E1.m1.7.7.1.1.2.4a.cmml" xref="S3.E1.m1.7.7.1.1.2.4"><mtext id="S3.E1.m1.7.7.1.1.2.4.cmml" xref="S3.E1.m1.7.7.1.1.2.4">KL</mtext></ci><interval closure="open" id="S3.E1.m1.7.7.1.1.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2"><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><ci id="S3.E1.m1.5.5.4.cmml" xref="S3.E1.m1.5.5.4">⏟</ci><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.3"><times id="S3.E1.m1.5.5.3.4.cmml" xref="S3.E1.m1.5.5.3.4"></times><ci id="S3.E1.m1.5.5.3.5.cmml" xref="S3.E1.m1.5.5.3.5">𝜎</ci><apply id="S3.E1.m1.5.5.3.3.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1"><times id="S3.E1.m1.5.5.3.3.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1"><divide id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1"></divide><cn type="integer" id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3">1</cn><apply id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><abs id="S3.E1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"></abs><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2">𝑆</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.3.3.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1"><apply id="S3.E1.m1.5.5.3.3.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.5.5.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.2"></sum><apply id="S3.E1.m1.5.5.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3"><in id="S3.E1.m1.5.5.3.3.1.1.1.2.3.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.1"></in><ci id="S3.E1.m1.5.5.3.3.1.1.1.2.3.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.2">𝑘</ci><apply id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.2">𝑆</ci><ci id="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1"><times id="S3.E1.m1.5.5.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.2"></times><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.2">𝑓</ci><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.3.3">𝑘</ci></apply><list id="S3.E1.m1.5.5.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1"><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝐱</ci><apply id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></apply><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2a.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2"><mtext mathsize="70%" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2">Distillation Targets</mtext></ci></apply><apply id="S3.E1.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2"><times id="S3.E1.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.2"></times><ci id="S3.E1.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.3">𝜎</ci><apply id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1"><times id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.2"></times><ci id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.3">𝑓</ci><list id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1"><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">𝐱</ci><apply id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3"><minus id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></list></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">{\mathcal{L}}_{\text{KL},j}=\text{KL}\left(\underbrace{\sigma\left(\frac{1}{|S_{t}|}\sum_{k\in S_{t}}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right)}_{\text{Distillation Targets}},\sigma(f({\mathbf{x}}\mathchar 24635\relax\;\theta_{j-1}))\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\theta_{j}\leftarrow\theta_{j-1}-\eta\nabla_{\theta_{j-1}}E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[{\mathcal{L}}_{\text{KL},j}\right]," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml">θ</mi><mi id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">←</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.3.2.cmml">θ</mi><mrow id="S3.E2.m1.4.4.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.3.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.1.3.3.2.cmml">j</mi><mo id="S3.E2.m1.4.4.1.1.1.3.3.1" xref="S3.E2.m1.4.4.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E2.m1.4.4.1.1.1.3.3.3" xref="S3.E2.m1.4.4.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.4" xref="S3.E2.m1.4.4.1.1.1.1.4.cmml"><msub id="S3.E2.m1.4.4.1.1.1.1.4.1" xref="S3.E2.m1.4.4.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E2.m1.4.4.1.1.1.1.4.1.2" xref="S3.E2.m1.4.4.1.1.1.1.4.1.2.cmml">∇</mo><msub id="S3.E2.m1.4.4.1.1.1.1.4.1.3" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.4.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.2.cmml">θ</mi><mrow id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.2" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.2.cmml">j</mi><mo id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.1" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.1.cmml">−</mo><mn id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.3" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.3.cmml">1</mn></mrow></msub></msub><msub id="S3.E2.m1.4.4.1.1.1.1.4.2" xref="S3.E2.m1.4.4.1.1.1.1.4.2.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.4.2.2" xref="S3.E2.m1.4.4.1.1.1.1.4.2.2.cmml">E</mi><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">𝐱</mi><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E2.m1.1.1.1.4" xref="S3.E2.m1.1.1.1.4.cmml"><msub id="S3.E2.m1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.4.2.cmml"><mi id="S3.E2.m1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.4.2.2.cmml">p</mi><mtext id="S3.E2.m1.1.1.1.4.2.3" xref="S3.E2.m1.1.1.1.4.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.4.1" xref="S3.E2.m1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.4.3.2" xref="S3.E2.m1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.4.3.2.1" xref="S3.E2.m1.1.1.1.4.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.4.3.2.2" xref="S3.E2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2a" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">ℒ</mi><mrow id="S3.E2.m1.3.3.2.4" xref="S3.E2.m1.3.3.2.3.cmml"><mtext id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1a.cmml">KL</mtext><mo id="S3.E2.m1.3.3.2.4.1" xref="S3.E2.m1.3.3.2.3.cmml">,</mo><mi id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><ci id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2">←</ci><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2">𝜃</ci><ci id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3">𝑗</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><minus id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2"></minus><apply id="S3.E2.m1.4.4.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.3.2">𝜃</ci><apply id="S3.E2.m1.4.4.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3.3"><minus id="S3.E2.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.3.3.1"></minus><ci id="S3.E2.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.3.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2"></times><ci id="S3.E2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3">𝜂</ci><apply id="S3.E2.m1.4.4.1.1.1.1.4.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4"><apply id="S3.E2.m1.4.4.1.1.1.1.4.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.4.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.2">∇</ci><apply id="S3.E2.m1.4.4.1.1.1.1.4.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.4.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.4.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.2">𝜃</ci><apply id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3"><minus id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.1"></minus><ci id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.4.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.2.2">𝐸</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝐱</ci><apply id="S3.E2.m1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.4"><times id="S3.E2.m1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.4.1"></times><apply id="S3.E2.m1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.1.4.2.2">𝑝</ci><ci id="S3.E2.m1.1.1.1.4.2.3a.cmml" xref="S3.E2.m1.1.1.1.4.2.3"><mtext mathsize="50%" id="S3.E2.m1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.1.4.2.3">g</mtext></ci></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝐱</ci></apply></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2">ℒ</ci><list id="S3.E2.m1.3.3.2.3.cmml" xref="S3.E2.m1.3.3.2.4"><ci id="S3.E2.m1.2.2.1.1a.cmml" xref="S3.E2.m1.2.2.1.1"><mtext mathsize="70%" id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">KL</mtext></ci><ci id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\theta_{j}\leftarrow\theta_{j-1}-\eta\nabla_{\theta_{j-1}}E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[{\mathcal{L}}_{\text{KL},j}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.6" class="ltx_p">where <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\theta_{j}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\theta_{j}</annotation></semantics></math> is the aggregated model after the <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">j</annotation></semantics></math>th distillation step. <span id="S3.SS4.p1.6.1" class="ltx_text ltx_markedasmath">KL</span> denotes KL-divergence usually used in knowledge distillation <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib21" title="" class="ltx_ref">KD </a></cite>. The used <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="{\mathbf{x}}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">{\mathbf{x}}</annotation></semantics></math> is originally obtained from a relevant public data set in FedDF, while we could directly sample <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="{\mathbf{x}}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">{\mathbf{x}}</annotation></semantics></math> from the pre-available test data, i.e. <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="\sim p_{\text{g}}({\mathbf{x}})" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1.2" xref="S3.SS4.p1.6.m6.1.2.cmml"><mi id="S3.SS4.p1.6.m6.1.2.2" xref="S3.SS4.p1.6.m6.1.2.2.cmml"></mi><mo id="S3.SS4.p1.6.m6.1.2.1" xref="S3.SS4.p1.6.m6.1.2.1.cmml">∼</mo><mrow id="S3.SS4.p1.6.m6.1.2.3" xref="S3.SS4.p1.6.m6.1.2.3.cmml"><msub id="S3.SS4.p1.6.m6.1.2.3.2" xref="S3.SS4.p1.6.m6.1.2.3.2.cmml"><mi id="S3.SS4.p1.6.m6.1.2.3.2.2" xref="S3.SS4.p1.6.m6.1.2.3.2.2.cmml">p</mi><mtext id="S3.SS4.p1.6.m6.1.2.3.2.3" xref="S3.SS4.p1.6.m6.1.2.3.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.1.2.3.1" xref="S3.SS4.p1.6.m6.1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p1.6.m6.1.2.3.3.2" xref="S3.SS4.p1.6.m6.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.1.2.3.3.2.1" xref="S3.SS4.p1.6.m6.1.2.3.cmml">(</mo><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.SS4.p1.6.m6.1.2.3.3.2.2" xref="S3.SS4.p1.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.2.cmml" xref="S3.SS4.p1.6.m6.1.2"><csymbol cd="latexml" id="S3.SS4.p1.6.m6.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.2.1">similar-to</csymbol><csymbol cd="latexml" id="S3.SS4.p1.6.m6.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.2.2">absent</csymbol><apply id="S3.SS4.p1.6.m6.1.2.3.cmml" xref="S3.SS4.p1.6.m6.1.2.3"><times id="S3.SS4.p1.6.m6.1.2.3.1.cmml" xref="S3.SS4.p1.6.m6.1.2.3.1"></times><apply id="S3.SS4.p1.6.m6.1.2.3.2.cmml" xref="S3.SS4.p1.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.2.3.2.1.cmml" xref="S3.SS4.p1.6.m6.1.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.6.m6.1.2.3.2.2.cmml" xref="S3.SS4.p1.6.m6.1.2.3.2.2">𝑝</ci><ci id="S3.SS4.p1.6.m6.1.2.3.2.3a.cmml" xref="S3.SS4.p1.6.m6.1.2.3.2.3"><mtext mathsize="70%" id="S3.SS4.p1.6.m6.1.2.3.2.3.cmml" xref="S3.SS4.p1.6.m6.1.2.3.2.3">g</mtext></ci></apply><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\sim p_{\text{g}}({\mathbf{x}})</annotation></semantics></math>, in TFL.</p>
</div>
<figure id="S3.F4" class="ltx_figure">
<div id="S3.F4.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x8.png" id="S3.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="182" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S3.F4.7.3" class="ltx_text" style="font-size:90%;">Performance degradation of FedDF with larger number of clients (e.g., <math id="S3.F4.5.1.m1.2" class="ltx_Math" alttext="K=100,1000" display="inline"><semantics id="S3.F4.5.1.m1.2b"><mrow id="S3.F4.5.1.m1.2.3" xref="S3.F4.5.1.m1.2.3.cmml"><mi id="S3.F4.5.1.m1.2.3.2" xref="S3.F4.5.1.m1.2.3.2.cmml">K</mi><mo id="S3.F4.5.1.m1.2.3.1" xref="S3.F4.5.1.m1.2.3.1.cmml">=</mo><mrow id="S3.F4.5.1.m1.2.3.3.2" xref="S3.F4.5.1.m1.2.3.3.1.cmml"><mn id="S3.F4.5.1.m1.1.1" xref="S3.F4.5.1.m1.1.1.cmml">100</mn><mo id="S3.F4.5.1.m1.2.3.3.2.1" xref="S3.F4.5.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.F4.5.1.m1.2.2" xref="S3.F4.5.1.m1.2.2.cmml">1000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.5.1.m1.2c"><apply id="S3.F4.5.1.m1.2.3.cmml" xref="S3.F4.5.1.m1.2.3"><eq id="S3.F4.5.1.m1.2.3.1.cmml" xref="S3.F4.5.1.m1.2.3.1"></eq><ci id="S3.F4.5.1.m1.2.3.2.cmml" xref="S3.F4.5.1.m1.2.3.2">𝐾</ci><list id="S3.F4.5.1.m1.2.3.3.1.cmml" xref="S3.F4.5.1.m1.2.3.3.2"><cn type="integer" id="S3.F4.5.1.m1.1.1.cmml" xref="S3.F4.5.1.m1.1.1">100</cn><cn type="integer" id="S3.F4.5.1.m1.2.2.cmml" xref="S3.F4.5.1.m1.2.2">1000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.5.1.m1.2d">K=100,1000</annotation></semantics></math>) and lower stochastic participation ratios (e.g., <math id="S3.F4.6.2.m2.2" class="ltx_Math" alttext="10\%,1\%" display="inline"><semantics id="S3.F4.6.2.m2.2b"><mrow id="S3.F4.6.2.m2.2.2.2" xref="S3.F4.6.2.m2.2.2.3.cmml"><mrow id="S3.F4.6.2.m2.1.1.1.1" xref="S3.F4.6.2.m2.1.1.1.1.cmml"><mn id="S3.F4.6.2.m2.1.1.1.1.2" xref="S3.F4.6.2.m2.1.1.1.1.2.cmml">10</mn><mo id="S3.F4.6.2.m2.1.1.1.1.1" xref="S3.F4.6.2.m2.1.1.1.1.1.cmml">%</mo></mrow><mo id="S3.F4.6.2.m2.2.2.2.3" xref="S3.F4.6.2.m2.2.2.3.cmml">,</mo><mrow id="S3.F4.6.2.m2.2.2.2.2" xref="S3.F4.6.2.m2.2.2.2.2.cmml"><mn id="S3.F4.6.2.m2.2.2.2.2.2" xref="S3.F4.6.2.m2.2.2.2.2.2.cmml">1</mn><mo id="S3.F4.6.2.m2.2.2.2.2.1" xref="S3.F4.6.2.m2.2.2.2.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.6.2.m2.2c"><list id="S3.F4.6.2.m2.2.2.3.cmml" xref="S3.F4.6.2.m2.2.2.2"><apply id="S3.F4.6.2.m2.1.1.1.1.cmml" xref="S3.F4.6.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.F4.6.2.m2.1.1.1.1.1.cmml" xref="S3.F4.6.2.m2.1.1.1.1.1">percent</csymbol><cn type="integer" id="S3.F4.6.2.m2.1.1.1.1.2.cmml" xref="S3.F4.6.2.m2.1.1.1.1.2">10</cn></apply><apply id="S3.F4.6.2.m2.2.2.2.2.cmml" xref="S3.F4.6.2.m2.2.2.2.2"><csymbol cd="latexml" id="S3.F4.6.2.m2.2.2.2.2.1.cmml" xref="S3.F4.6.2.m2.2.2.2.2.1">percent</csymbol><cn type="integer" id="S3.F4.6.2.m2.2.2.2.2.2.cmml" xref="S3.F4.6.2.m2.2.2.2.2.2">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.6.2.m2.2d">10\%,1\%</annotation></semantics></math>). Rows show cases split by “label" and “dirichlet". <math id="S3.F4.7.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.F4.7.3.m3.1b"><mi id="S3.F4.7.3.m3.1.1" xref="S3.F4.7.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.F4.7.3.m3.1c"><ci id="S3.F4.7.3.m3.1.1.cmml" xref="S3.F4.7.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.7.3.m3.1d">E</annotation></semantics></math> denotes the number of local training epochs.</span></figcaption>
</figure>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">FedDF significantly depends on the ensemble quality of local models, which is named as <span id="S3.SS4.p2.1.1" class="ltx_text ltx_font_bold">distillation targets</span> in this paper (Eq. <a href="#S3.E1" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The verified FL scenes in FedDF are cross-silo ones <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib28" title="" class="ltx_ref">Fed-Advances </a></cite>, where the number of clients is small (e.g., 20 clients) and clients’ participation is stable (e.g., 40% or 100% client participation ratio). Furthermore, as declared in FedDF, local clients should undertake more local training steps (e.g., 40 or up to 160 epochs) to obtain ensemble models with enough diversity. These conditions may be too rigorous for some edge devices with unstable communication or limited computation.
We consider a larger number of local clients (e.g., 100, 1000) and a smaller client participation ratio (e.g., 10%, 1%) in this paper. We run FedDF on decentralized SVHN as an example and plot the results in Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We record test accuracies of the aggregated model, the ensemble of local updated models via “AvgLogi", and the distilled model obtained via Eq. <a href="#S3.E1" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Eq. <a href="#S3.E2" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Clearly, the “AvgLogi" distillation does not improve the aggregated model, and leads to training instability. Therefore, directly applying FedDF to TFL scenes seems to encounter some issues. We attribute the ineffectiveness of FedDF under these scenes to two reasons: <span id="S3.SS4.p2.1.2" class="ltx_text ltx_font_italic">varying magnitudes</span> and <span id="S3.SS4.p2.1.3" class="ltx_text ltx_font_italic">improper distillation</span>. We will detail these in the next section. <span id="S3.SS4.p2.1.4" class="ltx_text ltx_font_italic">The essence of FedDF inspires us to propose more effective techniques to refine the inaccurate aggregated model.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Methods</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we introduce our proposed methods. We follow FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite> and polish it to be broadly applicable to TFL under more settings. Specifically, we propose <span id="S4.p1.1.1" class="ltx_text ltx_framed ltx_framed_underline">M</span>odel <span id="S4.p1.1.2" class="ltx_text ltx_framed ltx_framed_underline">r</span>efinery for <span id="S4.p1.1.3" class="ltx_text ltx_framed ltx_framed_underline">T</span>ransductive <span id="S4.p1.1.4" class="ltx_text ltx_framed ltx_framed_underline">F</span>ederated learning (MrTF) containing three modules: (1) stabilized teachers; (2) rectified distillation; (3) clustered label refinery.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Stabilized Teachers</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.11" class="ltx_p">FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite> takes “AvgLogi" to generate the distillation targets, i.e.,</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\overline{q}_{\text{AL}}(y|{\mathbf{x}})=\sigma\left(\sum_{k}w_{k}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right)," display="block"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1.1" xref="S4.E3.m1.2.2.1.1.1.cmml"><msub id="S4.E3.m1.2.2.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.3.cmml"><mover accent="true" id="S4.E3.m1.2.2.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.1.3.2.cmml"><mi id="S4.E3.m1.2.2.1.1.1.3.2.2" xref="S4.E3.m1.2.2.1.1.1.3.2.2.cmml">q</mi><mo id="S4.E3.m1.2.2.1.1.1.3.2.1" xref="S4.E3.m1.2.2.1.1.1.3.2.1.cmml">¯</mo></mover><mtext id="S4.E3.m1.2.2.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.1.3.3a.cmml">AL</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E3.m1.2.2.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E3.m1.2.2.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.3" xref="S4.E3.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.cmml"><mi id="S4.E3.m1.2.2.1.1.2.3" xref="S4.E3.m1.2.2.1.1.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.2.2" xref="S4.E3.m1.2.2.1.1.2.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S4.E3.m1.2.2.1.1.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.cmml"><munder id="S4.E3.m1.2.2.1.1.2.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="S4.E3.m1.2.2.1.1.2.1.1.1.2.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2.2.cmml">∑</mo><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2.3.cmml">k</mi></munder><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">w</mi><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><msub id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.2.cmml">f</mi><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2a" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.4" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.2.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.2" xref="S4.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1"><eq id="S4.E3.m1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.3"></eq><apply id="S4.E3.m1.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1"><times id="S4.E3.m1.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.2"></times><apply id="S4.E3.m1.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.3.2"><ci id="S4.E3.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.1.3.2.1">¯</ci><ci id="S4.E3.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.1.3.2.2">𝑞</ci></apply><ci id="S4.E3.m1.2.2.1.1.1.3.3a.cmml" xref="S4.E3.m1.2.2.1.1.1.3.3"><mtext mathsize="70%" id="S4.E3.m1.2.2.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.3.3">AL</mtext></ci></apply><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.E3.m1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2"><times id="S4.E3.m1.2.2.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2"></times><ci id="S4.E3.m1.2.2.1.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.3">𝜎</ci><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1"><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2">subscript</csymbol><sum id="S4.E3.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2.2"></sum><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1"><times id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2"></times><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2">𝑤</ci><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.2">𝑓</ci><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.4.3">𝑘</ci></apply><list id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1"><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝐱</ci><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\overline{q}_{\text{AL}}(y|{\mathbf{x}})=\sigma\left(\sum_{k}w_{k}f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.12" class="ltx_p">while we consider another one via “AvgProb" as follows:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\overline{q}_{\text{AP}}(y|{\mathbf{x}})=\sum_{k}w_{k}\sigma\left(f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right)," display="block"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.3.cmml"><mover accent="true" id="S4.E4.m1.2.2.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.1.3.2.cmml"><mi id="S4.E4.m1.2.2.1.1.1.3.2.2" xref="S4.E4.m1.2.2.1.1.1.3.2.2.cmml">q</mi><mo id="S4.E4.m1.2.2.1.1.1.3.2.1" xref="S4.E4.m1.2.2.1.1.1.3.2.1.cmml">¯</mo></mover><mtext id="S4.E4.m1.2.2.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.1.3.3a.cmml">AP</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E4.m1.2.2.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E4.m1.2.2.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E4.m1.2.2.1.1.3" xref="S4.E4.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.2.cmml"><munder id="S4.E4.m1.2.2.1.1.2.2" xref="S4.E4.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S4.E4.m1.2.2.1.1.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.2.cmml">∑</mo><mi id="S4.E4.m1.2.2.1.1.2.2.3" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">k</mi></munder><mrow id="S4.E4.m1.2.2.1.1.2.1" xref="S4.E4.m1.2.2.1.1.2.1.cmml"><msub id="S4.E4.m1.2.2.1.1.2.1.3" xref="S4.E4.m1.2.2.1.1.2.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.2.1.3.2" xref="S4.E4.m1.2.2.1.1.2.1.3.2.cmml">w</mi><mi id="S4.E4.m1.2.2.1.1.2.1.3.3" xref="S4.E4.m1.2.2.1.1.2.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.2.1.2" xref="S4.E4.m1.2.2.1.1.2.1.2.cmml">​</mo><mi id="S4.E4.m1.2.2.1.1.2.1.4" xref="S4.E4.m1.2.2.1.1.2.1.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.2.1.2a" xref="S4.E4.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1.2.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S4.E4.m1.2.2.1.1.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.2.2.1.1.2.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">f</mi><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.4" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><eq id="S4.E4.m1.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3"></eq><apply id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1"><times id="S4.E4.m1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.2"></times><apply id="S4.E4.m1.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.3">subscript</csymbol><apply id="S4.E4.m1.2.2.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.3.2"><ci id="S4.E4.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E4.m1.2.2.1.1.1.3.2.1">¯</ci><ci id="S4.E4.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E4.m1.2.2.1.1.1.3.2.2">𝑞</ci></apply><ci id="S4.E4.m1.2.2.1.1.1.3.3a.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3"><mtext mathsize="70%" id="S4.E4.m1.2.2.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3">AP</mtext></ci></apply><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2"><apply id="S4.E4.m1.2.2.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S4.E4.m1.2.2.1.1.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2"></sum><ci id="S4.E4.m1.2.2.1.1.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.2.3">𝑘</ci></apply><apply id="S4.E4.m1.2.2.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1"><times id="S4.E4.m1.2.2.1.1.2.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.2"></times><apply id="S4.E4.m1.2.2.1.1.2.1.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.3.2">𝑤</ci><ci id="S4.E4.m1.2.2.1.1.2.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.3.3">𝑘</ci></apply><ci id="S4.E4.m1.2.2.1.1.2.1.4.cmml" xref="S4.E4.m1.2.2.1.1.2.1.4">𝜎</ci><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1"><times id="S4.E4.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.2"></times><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.2">𝑓</ci><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.3.3">𝑘</ci></apply><list id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝐱</ci><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\overline{q}_{\text{AP}}(y|{\mathbf{x}})=\sum_{k}w_{k}\sigma\left(f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.7" class="ltx_p">where we add weights for each client <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="w_{k}\geq 0" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><msub id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">w</mi><mi id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">≥</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><geq id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></geq><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝑤</ci><ci id="S4.SS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">w_{k}\geq 0</annotation></semantics></math> satisfying <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\sum_{k}w_{k}=1" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mrow id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><msub id="S4.SS1.p1.2.m2.1.1.2.1" xref="S4.SS1.p1.2.m2.1.1.2.1.cmml"><mo id="S4.SS1.p1.2.m2.1.1.2.1.2" xref="S4.SS1.p1.2.m2.1.1.2.1.2.cmml">∑</mo><mi id="S4.SS1.p1.2.m2.1.1.2.1.3" xref="S4.SS1.p1.2.m2.1.1.2.1.3.cmml">k</mi></msub><msub id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.2.cmml">w</mi><mi id="S4.SS1.p1.2.m2.1.1.2.2.3" xref="S4.SS1.p1.2.m2.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><apply id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1">subscript</csymbol><sum id="S4.SS1.p1.2.m2.1.1.2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1.2"></sum><ci id="S4.SS1.p1.2.m2.1.1.2.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1.3">𝑘</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.2">𝑤</ci><ci id="S4.SS1.p1.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.3">𝑘</ci></apply></apply><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\sum_{k}w_{k}=1</annotation></semantics></math>, and temporarily omit the client selection process for simplification (i.e., the <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="|S_{t}|" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.1.cmml">|</mo><msub id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.1.1.2.cmml">S</mi><mi id="S4.SS1.p1.3.m3.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1"><abs id="S4.SS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.2"></abs><apply id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.2">𝑆</ci><ci id="S4.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">|S_{t}|</annotation></semantics></math> in Eq. <a href="#S3.E1" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). We calculate the sensitivity of the targets <math id="S4.SS1.p1.4.m4.2" class="ltx_Math" alttext="\overline{q}_{\star,c}" display="inline"><semantics id="S4.SS1.p1.4.m4.2a"><msub id="S4.SS1.p1.4.m4.2.3" xref="S4.SS1.p1.4.m4.2.3.cmml"><mover accent="true" id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.2.cmml"><mi id="S4.SS1.p1.4.m4.2.3.2.2" xref="S4.SS1.p1.4.m4.2.3.2.2.cmml">q</mi><mo id="S4.SS1.p1.4.m4.2.3.2.1" xref="S4.SS1.p1.4.m4.2.3.2.1.cmml">¯</mo></mover><mrow id="S4.SS1.p1.4.m4.2.2.2.4" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml"><mo rspace="0em" id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml">⋆</mo><mo id="S4.SS1.p1.4.m4.2.2.2.4.1" xref="S4.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.4.m4.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3">subscript</csymbol><apply id="S4.SS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2"><ci id="S4.SS1.p1.4.m4.2.3.2.1.cmml" xref="S4.SS1.p1.4.m4.2.3.2.1">¯</ci><ci id="S4.SS1.p1.4.m4.2.3.2.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2.2">𝑞</ci></apply><list id="S4.SS1.p1.4.m4.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.4"><ci id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">⋆</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">\overline{q}_{\star,c}</annotation></semantics></math>, <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="c\in[C]" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.2" xref="S4.SS1.p1.5.m5.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.2.2" xref="S4.SS1.p1.5.m5.1.2.2.cmml">c</mi><mo id="S4.SS1.p1.5.m5.1.2.1" xref="S4.SS1.p1.5.m5.1.2.1.cmml">∈</mo><mrow id="S4.SS1.p1.5.m5.1.2.3.2" xref="S4.SS1.p1.5.m5.1.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m5.1.2.3.2.1" xref="S4.SS1.p1.5.m5.1.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">C</mi><mo stretchy="false" id="S4.SS1.p1.5.m5.1.2.3.2.2" xref="S4.SS1.p1.5.m5.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.2.cmml" xref="S4.SS1.p1.5.m5.1.2"><in id="S4.SS1.p1.5.m5.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2.1"></in><ci id="S4.SS1.p1.5.m5.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.2.2">𝑐</ci><apply id="S4.SS1.p1.5.m5.1.2.3.1.cmml" xref="S4.SS1.p1.5.m5.1.2.3.2"><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.2.3.1.1.cmml" xref="S4.SS1.p1.5.m5.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">c\in[C]</annotation></semantics></math>, <math id="S4.SS1.p1.6.m6.2" class="ltx_math_unparsed" alttext="\star\in\{\text{AL},\text{AP}\}" display="inline"><semantics id="S4.SS1.p1.6.m6.2a"><mrow id="S4.SS1.p1.6.m6.2b"><mo rspace="0em" id="S4.SS1.p1.6.m6.1.1">⋆</mo><mo lspace="0em" id="S4.SS1.p1.6.m6.2.2">∈</mo><mrow id="S4.SS1.p1.6.m6.2.3"><mo stretchy="false" id="S4.SS1.p1.6.m6.2.3.1">{</mo><mtext id="S4.SS1.p1.6.m6.2.3.2">AL</mtext><mo id="S4.SS1.p1.6.m6.2.3.3">,</mo><mtext id="S4.SS1.p1.6.m6.2.3.4">AP</mtext><mo stretchy="false" id="S4.SS1.p1.6.m6.2.3.5">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.2c">\star\in\{\text{AL},\text{AP}\}</annotation></semantics></math> with respect to the local model parameters <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">θ</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝜃</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\theta_{k}</annotation></semantics></math> via calculating the gradients:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E5.m1.11" class="ltx_Math" alttext="\frac{\partial\overline{q}_{\star,c}}{\partial\theta_{k}}=w_{k}J_{\star,c}(y|{\mathbf{x}})\left(\frac{\partial f_{k,c}}{\partial\theta_{k}}-\sum_{j}J_{\star,j}(y|{\mathbf{x}})\frac{\partial f_{k,j}}{\partial\theta_{k}}\right)," display="block"><semantics id="S4.E5.m1.11a"><mrow id="S4.E5.m1.11.11.1" xref="S4.E5.m1.11.11.1.1.cmml"><mrow id="S4.E5.m1.11.11.1.1" xref="S4.E5.m1.11.11.1.1.cmml"><mfrac id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mrow id="S4.E5.m1.2.2.2" xref="S4.E5.m1.2.2.2.cmml"><mo rspace="0em" id="S4.E5.m1.2.2.2.3" xref="S4.E5.m1.2.2.2.3.cmml">∂</mo><msub id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.4.cmml"><mover accent="true" id="S4.E5.m1.2.2.2.4.2" xref="S4.E5.m1.2.2.2.4.2.cmml"><mi id="S4.E5.m1.2.2.2.4.2.2" xref="S4.E5.m1.2.2.2.4.2.2.cmml">q</mi><mo id="S4.E5.m1.2.2.2.4.2.1" xref="S4.E5.m1.2.2.2.4.2.1.cmml">¯</mo></mover><mrow id="S4.E5.m1.2.2.2.2.2.4" xref="S4.E5.m1.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">⋆</mo><mo id="S4.E5.m1.2.2.2.2.2.4.1" xref="S4.E5.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.cmml">c</mi></mrow></msub></mrow><mrow id="S4.E5.m1.2.2.4" xref="S4.E5.m1.2.2.4.cmml"><mo rspace="0em" id="S4.E5.m1.2.2.4.1" xref="S4.E5.m1.2.2.4.1.cmml">∂</mo><msub id="S4.E5.m1.2.2.4.2" xref="S4.E5.m1.2.2.4.2.cmml"><mi id="S4.E5.m1.2.2.4.2.2" xref="S4.E5.m1.2.2.4.2.2.cmml">θ</mi><mi id="S4.E5.m1.2.2.4.2.3" xref="S4.E5.m1.2.2.4.2.3.cmml">k</mi></msub></mrow></mfrac><mo id="S4.E5.m1.11.11.1.1.3" xref="S4.E5.m1.11.11.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.11.11.1.1.2" xref="S4.E5.m1.11.11.1.1.2.cmml"><msub id="S4.E5.m1.11.11.1.1.2.4" xref="S4.E5.m1.11.11.1.1.2.4.cmml"><mi id="S4.E5.m1.11.11.1.1.2.4.2" xref="S4.E5.m1.11.11.1.1.2.4.2.cmml">w</mi><mi id="S4.E5.m1.11.11.1.1.2.4.3" xref="S4.E5.m1.11.11.1.1.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.1.1.2.3" xref="S4.E5.m1.11.11.1.1.2.3.cmml">​</mo><msub id="S4.E5.m1.11.11.1.1.2.5" xref="S4.E5.m1.11.11.1.1.2.5.cmml"><mi id="S4.E5.m1.11.11.1.1.2.5.2" xref="S4.E5.m1.11.11.1.1.2.5.2.cmml">J</mi><mrow id="S4.E5.m1.4.4.2.4" xref="S4.E5.m1.4.4.2.3.cmml"><mo rspace="0em" id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml">⋆</mo><mo id="S4.E5.m1.4.4.2.4.1" xref="S4.E5.m1.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.4.4.2.2" xref="S4.E5.m1.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.1.1.2.3a" xref="S4.E5.m1.11.11.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m1.11.11.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.11.11.1.1.1.1.1.2" xref="S4.E5.m1.11.11.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.11.11.1.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.11.11.1.1.1.1.1.1.2" xref="S4.E5.m1.11.11.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E5.m1.11.11.1.1.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E5.m1.11.11.1.1.1.1.1.1.3" xref="S4.E5.m1.11.11.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E5.m1.11.11.1.1.1.1.1.3" xref="S4.E5.m1.11.11.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.1.1.2.3b" xref="S4.E5.m1.11.11.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m1.11.11.1.1.2.2.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.cmml"><mo id="S4.E5.m1.11.11.1.1.2.2.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.cmml">(</mo><mrow id="S4.E5.m1.11.11.1.1.2.2.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.cmml"><mfrac id="S4.E5.m1.6.6" xref="S4.E5.m1.6.6.cmml"><mrow id="S4.E5.m1.6.6.2" xref="S4.E5.m1.6.6.2.cmml"><mo rspace="0em" id="S4.E5.m1.6.6.2.3" xref="S4.E5.m1.6.6.2.3.cmml">∂</mo><msub id="S4.E5.m1.6.6.2.4" xref="S4.E5.m1.6.6.2.4.cmml"><mi id="S4.E5.m1.6.6.2.4.2" xref="S4.E5.m1.6.6.2.4.2.cmml">f</mi><mrow id="S4.E5.m1.6.6.2.2.2.4" xref="S4.E5.m1.6.6.2.2.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.cmml">k</mi><mo id="S4.E5.m1.6.6.2.2.2.4.1" xref="S4.E5.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.6.6.2.2.2.2" xref="S4.E5.m1.6.6.2.2.2.2.cmml">c</mi></mrow></msub></mrow><mrow id="S4.E5.m1.6.6.4" xref="S4.E5.m1.6.6.4.cmml"><mo rspace="0em" id="S4.E5.m1.6.6.4.1" xref="S4.E5.m1.6.6.4.1.cmml">∂</mo><msub id="S4.E5.m1.6.6.4.2" xref="S4.E5.m1.6.6.4.2.cmml"><mi id="S4.E5.m1.6.6.4.2.2" xref="S4.E5.m1.6.6.4.2.2.cmml">θ</mi><mi id="S4.E5.m1.6.6.4.2.3" xref="S4.E5.m1.6.6.4.2.3.cmml">k</mi></msub></mrow></mfrac><mo rspace="0.055em" id="S4.E5.m1.11.11.1.1.2.2.1.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.2.cmml">−</mo><mrow id="S4.E5.m1.11.11.1.1.2.2.1.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.cmml"><munder id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.3" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.3.cmml">j</mi></munder><mrow id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.cmml"><msub id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.cmml"><mi id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.2.cmml">J</mi><mrow id="S4.E5.m1.8.8.2.4" xref="S4.E5.m1.8.8.2.3.cmml"><mo rspace="0em" id="S4.E5.m1.7.7.1.1" xref="S4.E5.m1.7.7.1.1.cmml">⋆</mo><mo id="S4.E5.m1.8.8.2.4.1" xref="S4.E5.m1.8.8.2.3.cmml">,</mo><mi id="S4.E5.m1.8.8.2.2" xref="S4.E5.m1.8.8.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.2" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.1" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.3" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2a" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2.cmml">​</mo><mfrac id="S4.E5.m1.10.10" xref="S4.E5.m1.10.10.cmml"><mrow id="S4.E5.m1.10.10.2" xref="S4.E5.m1.10.10.2.cmml"><mo rspace="0em" id="S4.E5.m1.10.10.2.3" xref="S4.E5.m1.10.10.2.3.cmml">∂</mo><msub id="S4.E5.m1.10.10.2.4" xref="S4.E5.m1.10.10.2.4.cmml"><mi id="S4.E5.m1.10.10.2.4.2" xref="S4.E5.m1.10.10.2.4.2.cmml">f</mi><mrow id="S4.E5.m1.10.10.2.2.2.4" xref="S4.E5.m1.10.10.2.2.2.3.cmml"><mi id="S4.E5.m1.9.9.1.1.1.1" xref="S4.E5.m1.9.9.1.1.1.1.cmml">k</mi><mo id="S4.E5.m1.10.10.2.2.2.4.1" xref="S4.E5.m1.10.10.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.10.10.2.2.2.2" xref="S4.E5.m1.10.10.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S4.E5.m1.10.10.4" xref="S4.E5.m1.10.10.4.cmml"><mo rspace="0em" id="S4.E5.m1.10.10.4.1" xref="S4.E5.m1.10.10.4.1.cmml">∂</mo><msub id="S4.E5.m1.10.10.4.2" xref="S4.E5.m1.10.10.4.2.cmml"><mi id="S4.E5.m1.10.10.4.2.2" xref="S4.E5.m1.10.10.4.2.2.cmml">θ</mi><mi id="S4.E5.m1.10.10.4.2.3" xref="S4.E5.m1.10.10.4.2.3.cmml">k</mi></msub></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E5.m1.11.11.1.1.2.2.1.3" xref="S4.E5.m1.11.11.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.11.11.1.2" xref="S4.E5.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.11b"><apply id="S4.E5.m1.11.11.1.1.cmml" xref="S4.E5.m1.11.11.1"><eq id="S4.E5.m1.11.11.1.1.3.cmml" xref="S4.E5.m1.11.11.1.1.3"></eq><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2"></divide><apply id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2.2"><partialdiff id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.3"></partialdiff><apply id="S4.E5.m1.2.2.2.4.cmml" xref="S4.E5.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.4.1.cmml" xref="S4.E5.m1.2.2.2.4">subscript</csymbol><apply id="S4.E5.m1.2.2.2.4.2.cmml" xref="S4.E5.m1.2.2.2.4.2"><ci id="S4.E5.m1.2.2.2.4.2.1.cmml" xref="S4.E5.m1.2.2.2.4.2.1">¯</ci><ci id="S4.E5.m1.2.2.2.4.2.2.cmml" xref="S4.E5.m1.2.2.2.4.2.2">𝑞</ci></apply><list id="S4.E5.m1.2.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.2.4"><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">⋆</ci><ci id="S4.E5.m1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2">𝑐</ci></list></apply></apply><apply id="S4.E5.m1.2.2.4.cmml" xref="S4.E5.m1.2.2.4"><partialdiff id="S4.E5.m1.2.2.4.1.cmml" xref="S4.E5.m1.2.2.4.1"></partialdiff><apply id="S4.E5.m1.2.2.4.2.cmml" xref="S4.E5.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.4.2.1.cmml" xref="S4.E5.m1.2.2.4.2">subscript</csymbol><ci id="S4.E5.m1.2.2.4.2.2.cmml" xref="S4.E5.m1.2.2.4.2.2">𝜃</ci><ci id="S4.E5.m1.2.2.4.2.3.cmml" xref="S4.E5.m1.2.2.4.2.3">𝑘</ci></apply></apply></apply><apply id="S4.E5.m1.11.11.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.2"><times id="S4.E5.m1.11.11.1.1.2.3.cmml" xref="S4.E5.m1.11.11.1.1.2.3"></times><apply id="S4.E5.m1.11.11.1.1.2.4.cmml" xref="S4.E5.m1.11.11.1.1.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.11.11.1.1.2.4.1.cmml" xref="S4.E5.m1.11.11.1.1.2.4">subscript</csymbol><ci id="S4.E5.m1.11.11.1.1.2.4.2.cmml" xref="S4.E5.m1.11.11.1.1.2.4.2">𝑤</ci><ci id="S4.E5.m1.11.11.1.1.2.4.3.cmml" xref="S4.E5.m1.11.11.1.1.2.4.3">𝑘</ci></apply><apply id="S4.E5.m1.11.11.1.1.2.5.cmml" xref="S4.E5.m1.11.11.1.1.2.5"><csymbol cd="ambiguous" id="S4.E5.m1.11.11.1.1.2.5.1.cmml" xref="S4.E5.m1.11.11.1.1.2.5">subscript</csymbol><ci id="S4.E5.m1.11.11.1.1.2.5.2.cmml" xref="S4.E5.m1.11.11.1.1.2.5.2">𝐽</ci><list id="S4.E5.m1.4.4.2.3.cmml" xref="S4.E5.m1.4.4.2.4"><ci id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1">⋆</ci><ci id="S4.E5.m1.4.4.2.2.cmml" xref="S4.E5.m1.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E5.m1.11.11.1.1.1.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E5.m1.11.11.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.11.11.1.1.1.1.1.1.3">𝐱</ci></apply><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1"><minus id="S4.E5.m1.11.11.1.1.2.2.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.2"></minus><apply id="S4.E5.m1.6.6.cmml" xref="S4.E5.m1.6.6"><divide id="S4.E5.m1.6.6.3.cmml" xref="S4.E5.m1.6.6"></divide><apply id="S4.E5.m1.6.6.2.cmml" xref="S4.E5.m1.6.6.2"><partialdiff id="S4.E5.m1.6.6.2.3.cmml" xref="S4.E5.m1.6.6.2.3"></partialdiff><apply id="S4.E5.m1.6.6.2.4.cmml" xref="S4.E5.m1.6.6.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.2.4.1.cmml" xref="S4.E5.m1.6.6.2.4">subscript</csymbol><ci id="S4.E5.m1.6.6.2.4.2.cmml" xref="S4.E5.m1.6.6.2.4.2">𝑓</ci><list id="S4.E5.m1.6.6.2.2.2.3.cmml" xref="S4.E5.m1.6.6.2.2.2.4"><ci id="S4.E5.m1.5.5.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1">𝑘</ci><ci id="S4.E5.m1.6.6.2.2.2.2.cmml" xref="S4.E5.m1.6.6.2.2.2.2">𝑐</ci></list></apply></apply><apply id="S4.E5.m1.6.6.4.cmml" xref="S4.E5.m1.6.6.4"><partialdiff id="S4.E5.m1.6.6.4.1.cmml" xref="S4.E5.m1.6.6.4.1"></partialdiff><apply id="S4.E5.m1.6.6.4.2.cmml" xref="S4.E5.m1.6.6.4.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.4.2.1.cmml" xref="S4.E5.m1.6.6.4.2">subscript</csymbol><ci id="S4.E5.m1.6.6.4.2.2.cmml" xref="S4.E5.m1.6.6.4.2.2">𝜃</ci><ci id="S4.E5.m1.6.6.4.2.3.cmml" xref="S4.E5.m1.6.6.4.2.3">𝑘</ci></apply></apply></apply><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1"><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2">subscript</csymbol><sum id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.2"></sum><ci id="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1"><times id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.2"></times><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.3.2">𝐽</ci><list id="S4.E5.m1.8.8.2.3.cmml" xref="S4.E5.m1.8.8.2.4"><ci id="S4.E5.m1.7.7.1.1.cmml" xref="S4.E5.m1.7.7.1.1">⋆</ci><ci id="S4.E5.m1.8.8.2.2.cmml" xref="S4.E5.m1.8.8.2.2">𝑗</ci></list></apply><apply id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.11.11.1.1.2.2.1.1.1.1.1.1.1.3">𝐱</ci></apply><apply id="S4.E5.m1.10.10.cmml" xref="S4.E5.m1.10.10"><divide id="S4.E5.m1.10.10.3.cmml" xref="S4.E5.m1.10.10"></divide><apply id="S4.E5.m1.10.10.2.cmml" xref="S4.E5.m1.10.10.2"><partialdiff id="S4.E5.m1.10.10.2.3.cmml" xref="S4.E5.m1.10.10.2.3"></partialdiff><apply id="S4.E5.m1.10.10.2.4.cmml" xref="S4.E5.m1.10.10.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.2.4.1.cmml" xref="S4.E5.m1.10.10.2.4">subscript</csymbol><ci id="S4.E5.m1.10.10.2.4.2.cmml" xref="S4.E5.m1.10.10.2.4.2">𝑓</ci><list id="S4.E5.m1.10.10.2.2.2.3.cmml" xref="S4.E5.m1.10.10.2.2.2.4"><ci id="S4.E5.m1.9.9.1.1.1.1.cmml" xref="S4.E5.m1.9.9.1.1.1.1">𝑘</ci><ci id="S4.E5.m1.10.10.2.2.2.2.cmml" xref="S4.E5.m1.10.10.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S4.E5.m1.10.10.4.cmml" xref="S4.E5.m1.10.10.4"><partialdiff id="S4.E5.m1.10.10.4.1.cmml" xref="S4.E5.m1.10.10.4.1"></partialdiff><apply id="S4.E5.m1.10.10.4.2.cmml" xref="S4.E5.m1.10.10.4.2"><csymbol cd="ambiguous" id="S4.E5.m1.10.10.4.2.1.cmml" xref="S4.E5.m1.10.10.4.2">subscript</csymbol><ci id="S4.E5.m1.10.10.4.2.2.cmml" xref="S4.E5.m1.10.10.4.2.2">𝜃</ci><ci id="S4.E5.m1.10.10.4.2.3.cmml" xref="S4.E5.m1.10.10.4.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.11c">\frac{\partial\overline{q}_{\star,c}}{\partial\theta_{k}}=w_{k}J_{\star,c}(y|{\mathbf{x}})\left(\frac{\partial f_{k,c}}{\partial\theta_{k}}-\sum_{j}J_{\star,j}(y|{\mathbf{x}})\frac{\partial f_{k,j}}{\partial\theta_{k}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.10" class="ltx_p">where <math id="S4.SS1.p1.8.m1.2" class="ltx_Math" alttext="J_{\text{AL}}(y|{\mathbf{x}})=\overline{q}_{\text{AL}}(y|{\mathbf{x}})" display="inline"><semantics id="S4.SS1.p1.8.m1.2a"><mrow id="S4.SS1.p1.8.m1.2.2" xref="S4.SS1.p1.8.m1.2.2.cmml"><mrow id="S4.SS1.p1.8.m1.1.1.1" xref="S4.SS1.p1.8.m1.1.1.1.cmml"><msub id="S4.SS1.p1.8.m1.1.1.1.3" xref="S4.SS1.p1.8.m1.1.1.1.3.cmml"><mi id="S4.SS1.p1.8.m1.1.1.1.3.2" xref="S4.SS1.p1.8.m1.1.1.1.3.2.cmml">J</mi><mtext id="S4.SS1.p1.8.m1.1.1.1.3.3" xref="S4.SS1.p1.8.m1.1.1.1.3.3a.cmml">AL</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m1.1.1.1.2" xref="S4.SS1.p1.8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.8.m1.1.1.1.1.1" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m1.1.1.1.1.1.2" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.8.m1.1.1.1.1.1.1" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.8.m1.1.1.1.1.1.1.2" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS1.p1.8.m1.1.1.1.1.1.1.1" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p1.8.m1.1.1.1.1.1.1.3" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS1.p1.8.m1.1.1.1.1.1.3" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.8.m1.2.2.3" xref="S4.SS1.p1.8.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p1.8.m1.2.2.2" xref="S4.SS1.p1.8.m1.2.2.2.cmml"><msub id="S4.SS1.p1.8.m1.2.2.2.3" xref="S4.SS1.p1.8.m1.2.2.2.3.cmml"><mover accent="true" id="S4.SS1.p1.8.m1.2.2.2.3.2" xref="S4.SS1.p1.8.m1.2.2.2.3.2.cmml"><mi id="S4.SS1.p1.8.m1.2.2.2.3.2.2" xref="S4.SS1.p1.8.m1.2.2.2.3.2.2.cmml">q</mi><mo id="S4.SS1.p1.8.m1.2.2.2.3.2.1" xref="S4.SS1.p1.8.m1.2.2.2.3.2.1.cmml">¯</mo></mover><mtext id="S4.SS1.p1.8.m1.2.2.2.3.3" xref="S4.SS1.p1.8.m1.2.2.2.3.3a.cmml">AL</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m1.2.2.2.2" xref="S4.SS1.p1.8.m1.2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p1.8.m1.2.2.2.1.1" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m1.2.2.2.1.1.2" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.8.m1.2.2.2.1.1.1" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.8.m1.2.2.2.1.1.1.2" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS1.p1.8.m1.2.2.2.1.1.1.1" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p1.8.m1.2.2.2.1.1.1.3" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS1.p1.8.m1.2.2.2.1.1.3" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m1.2b"><apply id="S4.SS1.p1.8.m1.2.2.cmml" xref="S4.SS1.p1.8.m1.2.2"><eq id="S4.SS1.p1.8.m1.2.2.3.cmml" xref="S4.SS1.p1.8.m1.2.2.3"></eq><apply id="S4.SS1.p1.8.m1.1.1.1.cmml" xref="S4.SS1.p1.8.m1.1.1.1"><times id="S4.SS1.p1.8.m1.1.1.1.2.cmml" xref="S4.SS1.p1.8.m1.1.1.1.2"></times><apply id="S4.SS1.p1.8.m1.1.1.1.3.cmml" xref="S4.SS1.p1.8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m1.1.1.1.3.1.cmml" xref="S4.SS1.p1.8.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.8.m1.1.1.1.3.2.cmml" xref="S4.SS1.p1.8.m1.1.1.1.3.2">𝐽</ci><ci id="S4.SS1.p1.8.m1.1.1.1.3.3a.cmml" xref="S4.SS1.p1.8.m1.1.1.1.3.3"><mtext mathsize="70%" id="S4.SS1.p1.8.m1.1.1.1.3.3.cmml" xref="S4.SS1.p1.8.m1.1.1.1.3.3">AL</mtext></ci></apply><apply id="S4.SS1.p1.8.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.8.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p1.8.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p1.8.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.8.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS1.p1.8.m1.2.2.2.cmml" xref="S4.SS1.p1.8.m1.2.2.2"><times id="S4.SS1.p1.8.m1.2.2.2.2.cmml" xref="S4.SS1.p1.8.m1.2.2.2.2"></times><apply id="S4.SS1.p1.8.m1.2.2.2.3.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m1.2.2.2.3.1.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3">subscript</csymbol><apply id="S4.SS1.p1.8.m1.2.2.2.3.2.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3.2"><ci id="S4.SS1.p1.8.m1.2.2.2.3.2.1.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3.2.1">¯</ci><ci id="S4.SS1.p1.8.m1.2.2.2.3.2.2.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3.2.2">𝑞</ci></apply><ci id="S4.SS1.p1.8.m1.2.2.2.3.3a.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3.3"><mtext mathsize="70%" id="S4.SS1.p1.8.m1.2.2.2.3.3.cmml" xref="S4.SS1.p1.8.m1.2.2.2.3.3">AL</mtext></ci></apply><apply id="S4.SS1.p1.8.m1.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.8.m1.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.p1.8.m1.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p1.8.m1.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.SS1.p1.8.m1.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.8.m1.2.2.2.1.1.1.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m1.2c">J_{\text{AL}}(y|{\mathbf{x}})=\overline{q}_{\text{AL}}(y|{\mathbf{x}})</annotation></semantics></math>, <math id="S4.SS1.p1.9.m2.3" class="ltx_Math" alttext="J_{\text{AP}}(y|{\mathbf{x}})=q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})" display="inline"><semantics id="S4.SS1.p1.9.m2.3a"><mrow id="S4.SS1.p1.9.m2.3.3" xref="S4.SS1.p1.9.m2.3.3.cmml"><mrow id="S4.SS1.p1.9.m2.2.2.1" xref="S4.SS1.p1.9.m2.2.2.1.cmml"><msub id="S4.SS1.p1.9.m2.2.2.1.3" xref="S4.SS1.p1.9.m2.2.2.1.3.cmml"><mi id="S4.SS1.p1.9.m2.2.2.1.3.2" xref="S4.SS1.p1.9.m2.2.2.1.3.2.cmml">J</mi><mtext id="S4.SS1.p1.9.m2.2.2.1.3.3" xref="S4.SS1.p1.9.m2.2.2.1.3.3a.cmml">AP</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m2.2.2.1.2" xref="S4.SS1.p1.9.m2.2.2.1.2.cmml">​</mo><mrow id="S4.SS1.p1.9.m2.2.2.1.1.1" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.9.m2.2.2.1.1.1.2" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.9.m2.2.2.1.1.1.1" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p1.9.m2.2.2.1.1.1.1.2" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS1.p1.9.m2.2.2.1.1.1.1.1" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p1.9.m2.2.2.1.1.1.1.3" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS1.p1.9.m2.2.2.1.1.1.3" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.9.m2.3.3.3" xref="S4.SS1.p1.9.m2.3.3.3.cmml">=</mo><mrow id="S4.SS1.p1.9.m2.3.3.2" xref="S4.SS1.p1.9.m2.3.3.2.cmml"><msub id="S4.SS1.p1.9.m2.3.3.2.3" xref="S4.SS1.p1.9.m2.3.3.2.3.cmml"><mi id="S4.SS1.p1.9.m2.3.3.2.3.2" xref="S4.SS1.p1.9.m2.3.3.2.3.2.cmml">q</mi><mi id="S4.SS1.p1.9.m2.3.3.2.3.3" xref="S4.SS1.p1.9.m2.3.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.9.m2.3.3.2.2" xref="S4.SS1.p1.9.m2.3.3.2.2.cmml">​</mo><mrow id="S4.SS1.p1.9.m2.3.3.2.1.1" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.9.m2.3.3.2.1.1.2" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.9.m2.3.3.2.1.1.1" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.cmml"><mi id="S4.SS1.p1.9.m2.3.3.2.1.1.1.3" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.SS1.p1.9.m2.3.3.2.1.1.1.2" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.2.cmml">|</mo><mrow id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.2.cmml"><mi id="S4.SS1.p1.9.m2.1.1" xref="S4.SS1.p1.9.m2.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.2" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.2.cmml">;</mo><msub id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.2" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.3" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.9.m2.3.3.2.1.1.3" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m2.3b"><apply id="S4.SS1.p1.9.m2.3.3.cmml" xref="S4.SS1.p1.9.m2.3.3"><eq id="S4.SS1.p1.9.m2.3.3.3.cmml" xref="S4.SS1.p1.9.m2.3.3.3"></eq><apply id="S4.SS1.p1.9.m2.2.2.1.cmml" xref="S4.SS1.p1.9.m2.2.2.1"><times id="S4.SS1.p1.9.m2.2.2.1.2.cmml" xref="S4.SS1.p1.9.m2.2.2.1.2"></times><apply id="S4.SS1.p1.9.m2.2.2.1.3.cmml" xref="S4.SS1.p1.9.m2.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m2.2.2.1.3.1.cmml" xref="S4.SS1.p1.9.m2.2.2.1.3">subscript</csymbol><ci id="S4.SS1.p1.9.m2.2.2.1.3.2.cmml" xref="S4.SS1.p1.9.m2.2.2.1.3.2">𝐽</ci><ci id="S4.SS1.p1.9.m2.2.2.1.3.3a.cmml" xref="S4.SS1.p1.9.m2.2.2.1.3.3"><mtext mathsize="70%" id="S4.SS1.p1.9.m2.2.2.1.3.3.cmml" xref="S4.SS1.p1.9.m2.2.2.1.3.3">AP</mtext></ci></apply><apply id="S4.SS1.p1.9.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.9.m2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.9.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p1.9.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p1.9.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p1.9.m2.2.2.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS1.p1.9.m2.3.3.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2"><times id="S4.SS1.p1.9.m2.3.3.2.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2.2"></times><apply id="S4.SS1.p1.9.m2.3.3.2.3.cmml" xref="S4.SS1.p1.9.m2.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m2.3.3.2.3.1.cmml" xref="S4.SS1.p1.9.m2.3.3.2.3">subscript</csymbol><ci id="S4.SS1.p1.9.m2.3.3.2.3.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2.3.2">𝑞</ci><ci id="S4.SS1.p1.9.m2.3.3.2.3.3.cmml" xref="S4.SS1.p1.9.m2.3.3.2.3.3">𝑘</ci></apply><apply id="S4.SS1.p1.9.m2.3.3.2.1.1.1.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1"><csymbol cd="latexml" id="S4.SS1.p1.9.m2.3.3.2.1.1.1.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.2">conditional</csymbol><ci id="S4.SS1.p1.9.m2.3.3.2.1.1.1.3.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.3">𝑦</ci><list id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1"><ci id="S4.SS1.p1.9.m2.1.1.cmml" xref="S4.SS1.p1.9.m2.1.1">𝐱</ci><apply id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.9.m2.3.3.2.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m2.3c">J_{\text{AP}}(y|{\mathbf{x}})=q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})</annotation></semantics></math>. Obviously, the sensitivity is partially determined by the absolute value of the predicted probabilities <math id="S4.SS1.p1.10.m3.1" class="ltx_Math" alttext="J_{\star}(y|{\mathbf{x}})" display="inline"><semantics id="S4.SS1.p1.10.m3.1a"><mrow id="S4.SS1.p1.10.m3.1.1" xref="S4.SS1.p1.10.m3.1.1.cmml"><msub id="S4.SS1.p1.10.m3.1.1.3" xref="S4.SS1.p1.10.m3.1.1.3.cmml"><mi id="S4.SS1.p1.10.m3.1.1.3.2" xref="S4.SS1.p1.10.m3.1.1.3.2.cmml">J</mi><mo id="S4.SS1.p1.10.m3.1.1.3.3" xref="S4.SS1.p1.10.m3.1.1.3.3.cmml">⋆</mo></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m3.1.1.2" xref="S4.SS1.p1.10.m3.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.10.m3.1.1.1.1" xref="S4.SS1.p1.10.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.10.m3.1.1.1.1.2" xref="S4.SS1.p1.10.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.10.m3.1.1.1.1.1" xref="S4.SS1.p1.10.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.10.m3.1.1.1.1.1.2" xref="S4.SS1.p1.10.m3.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS1.p1.10.m3.1.1.1.1.1.1" xref="S4.SS1.p1.10.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p1.10.m3.1.1.1.1.1.3" xref="S4.SS1.p1.10.m3.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS1.p1.10.m3.1.1.1.1.3" xref="S4.SS1.p1.10.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m3.1b"><apply id="S4.SS1.p1.10.m3.1.1.cmml" xref="S4.SS1.p1.10.m3.1.1"><times id="S4.SS1.p1.10.m3.1.1.2.cmml" xref="S4.SS1.p1.10.m3.1.1.2"></times><apply id="S4.SS1.p1.10.m3.1.1.3.cmml" xref="S4.SS1.p1.10.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m3.1.1.3.1.cmml" xref="S4.SS1.p1.10.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.10.m3.1.1.3.2.cmml" xref="S4.SS1.p1.10.m3.1.1.3.2">𝐽</ci><ci id="S4.SS1.p1.10.m3.1.1.3.3.cmml" xref="S4.SS1.p1.10.m3.1.1.3.3">⋆</ci></apply><apply id="S4.SS1.p1.10.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.10.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p1.10.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.10.m3.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p1.10.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.10.m3.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m3.1c">J_{\star}(y|{\mathbf{x}})</annotation></semantics></math>. <span id="S4.SS1.p1.10.1" class="ltx_text ltx_font_italic">This implies that large probabilities make the distillation process sensitive to local models, while moderate prediction results are more stable.</span> This also consists with some previous distillation research that find tolerant teachers will educate better students <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib40" title="" class="ltx_ref">TolerantKD </a></cite>. Actually, we find that local updated models could generate “logits" with varying magnitudes on the same class, making “AvgLogi" suffer from large variance, and the predicted probabilities vary significantly across classes. We will show observations in experiments (Sect. <a href="#S5.SS1" title="5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.4" class="ltx_p">To further reduce the “logits" variance and the sensitivity, we also normalize the “logits" before calculating probabilities in Eq. <a href="#S4.E4" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> as follows:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E6.m1.12" class="ltx_Math" alttext="q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})=\sigma\left(\tau*\frac{f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})}{\text{std}\left(\{f_{k,c}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\}_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}}),c\in[C]}\right)}\right)," display="block"><semantics id="S4.E6.m1.12a"><mrow id="S4.E6.m1.12.12.1" xref="S4.E6.m1.12.12.1.1.cmml"><mrow id="S4.E6.m1.12.12.1.1" xref="S4.E6.m1.12.12.1.1.cmml"><mrow id="S4.E6.m1.12.12.1.1.1" xref="S4.E6.m1.12.12.1.1.1.cmml"><msub id="S4.E6.m1.12.12.1.1.1.3" xref="S4.E6.m1.12.12.1.1.1.3.cmml"><mi id="S4.E6.m1.12.12.1.1.1.3.2" xref="S4.E6.m1.12.12.1.1.1.3.2.cmml">q</mi><mi id="S4.E6.m1.12.12.1.1.1.3.3" xref="S4.E6.m1.12.12.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.12.12.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.12.12.1.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.12.12.1.1.1.1.1.1.3" xref="S4.E6.m1.12.12.1.1.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.E6.m1.12.12.1.1.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.11.11" xref="S4.E6.m1.11.11.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.E6.m1.12.12.1.1.1.1.1.3" xref="S4.E6.m1.12.12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.12.12.1.1.3" xref="S4.E6.m1.12.12.1.1.3.cmml">=</mo><mrow id="S4.E6.m1.12.12.1.1.2" xref="S4.E6.m1.12.12.1.1.2.cmml"><mi id="S4.E6.m1.12.12.1.1.2.3" xref="S4.E6.m1.12.12.1.1.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.12.12.1.1.2.2" xref="S4.E6.m1.12.12.1.1.2.2.cmml">​</mo><mrow id="S4.E6.m1.12.12.1.1.2.1.1" xref="S4.E6.m1.12.12.1.1.2.1.1.1.cmml"><mo id="S4.E6.m1.12.12.1.1.2.1.1.2" xref="S4.E6.m1.12.12.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.12.12.1.1.2.1.1.1" xref="S4.E6.m1.12.12.1.1.2.1.1.1.cmml"><mi id="S4.E6.m1.12.12.1.1.2.1.1.1.2" xref="S4.E6.m1.12.12.1.1.2.1.1.1.2.cmml">τ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.12.12.1.1.2.1.1.1.1" xref="S4.E6.m1.12.12.1.1.2.1.1.1.1.cmml">∗</mo><mfrac id="S4.E6.m1.10.10" xref="S4.E6.m1.10.10.cmml"><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><msub id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.4.cmml"><mi id="S4.E6.m1.2.2.2.4.2" xref="S4.E6.m1.2.2.2.4.2.cmml">f</mi><mi id="S4.E6.m1.2.2.2.4.3" xref="S4.E6.m1.2.2.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.2.3" xref="S4.E6.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.2.2.1.2" xref="S4.E6.m1.2.2.2.2.2.cmml">(</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E6.m1.2.2.2.2.1.3" xref="S4.E6.m1.2.2.2.2.2.cmml">;</mo><msub id="S4.E6.m1.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.1.1.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2" xref="S4.E6.m1.2.2.2.2.1.1.2.cmml">θ</mi><mi id="S4.E6.m1.2.2.2.2.1.1.3" xref="S4.E6.m1.2.2.2.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E6.m1.2.2.2.2.1.4" xref="S4.E6.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.10.10.10" xref="S4.E6.m1.10.10.10.cmml"><mtext id="S4.E6.m1.10.10.10.10" xref="S4.E6.m1.10.10.10.10a.cmml">std</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.10.10.10.9" xref="S4.E6.m1.10.10.10.9.cmml">​</mo><mrow id="S4.E6.m1.10.10.10.8.1" xref="S4.E6.m1.10.10.10.8.1.1.cmml"><mo id="S4.E6.m1.10.10.10.8.1.2" xref="S4.E6.m1.10.10.10.8.1.1.cmml">(</mo><msub id="S4.E6.m1.10.10.10.8.1.1" xref="S4.E6.m1.10.10.10.8.1.1.cmml"><mrow id="S4.E6.m1.10.10.10.8.1.1.1.1" xref="S4.E6.m1.10.10.10.8.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.10.10.10.8.1.1.1.1.2" xref="S4.E6.m1.10.10.10.8.1.1.1.2.cmml">{</mo><mrow id="S4.E6.m1.10.10.10.8.1.1.1.1.1" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.cmml"><msub id="S4.E6.m1.10.10.10.8.1.1.1.1.1.3" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.2" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S4.E6.m1.4.4.4.2.2.4" xref="S4.E6.m1.4.4.4.2.2.3.cmml"><mi id="S4.E6.m1.3.3.3.1.1.1" xref="S4.E6.m1.3.3.3.1.1.1.cmml">k</mi><mo id="S4.E6.m1.4.4.4.2.2.4.1" xref="S4.E6.m1.4.4.4.2.2.3.cmml">,</mo><mi id="S4.E6.m1.4.4.4.2.2.2" xref="S4.E6.m1.4.4.4.2.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.2" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.2" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E6.m1.9.9.9.7" xref="S4.E6.m1.9.9.9.7.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.3" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.4" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E6.m1.10.10.10.8.1.1.1.1.3" xref="S4.E6.m1.10.10.10.8.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E6.m1.8.8.8.6.4.4" xref="S4.E6.m1.8.8.8.6.4.5.cmml"><mrow id="S4.E6.m1.7.7.7.5.3.3.1" xref="S4.E6.m1.7.7.7.5.3.3.1.cmml"><mi id="S4.E6.m1.7.7.7.5.3.3.1.2" xref="S4.E6.m1.7.7.7.5.3.3.1.2.cmml">𝐱</mi><mo id="S4.E6.m1.7.7.7.5.3.3.1.1" xref="S4.E6.m1.7.7.7.5.3.3.1.1.cmml">∼</mo><mrow id="S4.E6.m1.7.7.7.5.3.3.1.3" xref="S4.E6.m1.7.7.7.5.3.3.1.3.cmml"><msub id="S4.E6.m1.7.7.7.5.3.3.1.3.2" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.cmml"><mi id="S4.E6.m1.7.7.7.5.3.3.1.3.2.2" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.2.cmml">p</mi><mtext id="S4.E6.m1.7.7.7.5.3.3.1.3.2.3" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.7.7.7.5.3.3.1.3.1" xref="S4.E6.m1.7.7.7.5.3.3.1.3.1.cmml">​</mo><mrow id="S4.E6.m1.7.7.7.5.3.3.1.3.3.2" xref="S4.E6.m1.7.7.7.5.3.3.1.3.cmml"><mo stretchy="false" id="S4.E6.m1.7.7.7.5.3.3.1.3.3.2.1" xref="S4.E6.m1.7.7.7.5.3.3.1.3.cmml">(</mo><mi id="S4.E6.m1.5.5.5.3.1.1" xref="S4.E6.m1.5.5.5.3.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E6.m1.7.7.7.5.3.3.1.3.3.2.2" xref="S4.E6.m1.7.7.7.5.3.3.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.8.8.8.6.4.4.3" xref="S4.E6.m1.8.8.8.6.4.5a.cmml">,</mo><mrow id="S4.E6.m1.8.8.8.6.4.4.2" xref="S4.E6.m1.8.8.8.6.4.4.2.cmml"><mi id="S4.E6.m1.8.8.8.6.4.4.2.2" xref="S4.E6.m1.8.8.8.6.4.4.2.2.cmml">c</mi><mo id="S4.E6.m1.8.8.8.6.4.4.2.1" xref="S4.E6.m1.8.8.8.6.4.4.2.1.cmml">∈</mo><mrow id="S4.E6.m1.8.8.8.6.4.4.2.3.2" xref="S4.E6.m1.8.8.8.6.4.4.2.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.8.8.8.6.4.4.2.3.2.1" xref="S4.E6.m1.8.8.8.6.4.4.2.3.1.1.cmml">[</mo><mi id="S4.E6.m1.6.6.6.4.2.2" xref="S4.E6.m1.6.6.6.4.2.2.cmml">C</mi><mo stretchy="false" id="S4.E6.m1.8.8.8.6.4.4.2.3.2.2" xref="S4.E6.m1.8.8.8.6.4.4.2.3.1.1.cmml">]</mo></mrow></mrow></mrow></msub><mo id="S4.E6.m1.10.10.10.8.1.3" xref="S4.E6.m1.10.10.10.8.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S4.E6.m1.12.12.1.1.2.1.1.3" xref="S4.E6.m1.12.12.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.12.12.1.2" xref="S4.E6.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.12b"><apply id="S4.E6.m1.12.12.1.1.cmml" xref="S4.E6.m1.12.12.1"><eq id="S4.E6.m1.12.12.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.3"></eq><apply id="S4.E6.m1.12.12.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1"><times id="S4.E6.m1.12.12.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.1.2"></times><apply id="S4.E6.m1.12.12.1.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.1.1.1.3.1.cmml" xref="S4.E6.m1.12.12.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.12.12.1.1.1.3.2.cmml" xref="S4.E6.m1.12.12.1.1.1.3.2">𝑞</ci><ci id="S4.E6.m1.12.12.1.1.1.3.3.cmml" xref="S4.E6.m1.12.12.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E6.m1.12.12.1.1.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.E6.m1.12.12.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.3">𝑦</ci><list id="S4.E6.m1.12.12.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1"><ci id="S4.E6.m1.11.11.cmml" xref="S4.E6.m1.11.11">𝐱</ci><apply id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.12.12.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S4.E6.m1.12.12.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.2"><times id="S4.E6.m1.12.12.1.1.2.2.cmml" xref="S4.E6.m1.12.12.1.1.2.2"></times><ci id="S4.E6.m1.12.12.1.1.2.3.cmml" xref="S4.E6.m1.12.12.1.1.2.3">𝜎</ci><apply id="S4.E6.m1.12.12.1.1.2.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.2.1.1"><times id="S4.E6.m1.12.12.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.12.12.1.1.2.1.1.1.1"></times><ci id="S4.E6.m1.12.12.1.1.2.1.1.1.2.cmml" xref="S4.E6.m1.12.12.1.1.2.1.1.1.2">𝜏</ci><apply id="S4.E6.m1.10.10.cmml" xref="S4.E6.m1.10.10"><divide id="S4.E6.m1.10.10.11.cmml" xref="S4.E6.m1.10.10"></divide><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><times id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.3"></times><apply id="S4.E6.m1.2.2.2.4.cmml" xref="S4.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.4.1.cmml" xref="S4.E6.m1.2.2.2.4">subscript</csymbol><ci id="S4.E6.m1.2.2.2.4.2.cmml" xref="S4.E6.m1.2.2.2.4.2">𝑓</ci><ci id="S4.E6.m1.2.2.2.4.3.cmml" xref="S4.E6.m1.2.2.2.4.3">𝑘</ci></apply><list id="S4.E6.m1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝐱</ci><apply id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2">𝜃</ci><ci id="S4.E6.m1.2.2.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.3">𝑘</ci></apply></list></apply><apply id="S4.E6.m1.10.10.10.cmml" xref="S4.E6.m1.10.10.10"><times id="S4.E6.m1.10.10.10.9.cmml" xref="S4.E6.m1.10.10.10.9"></times><ci id="S4.E6.m1.10.10.10.10a.cmml" xref="S4.E6.m1.10.10.10.10"><mtext id="S4.E6.m1.10.10.10.10.cmml" xref="S4.E6.m1.10.10.10.10">std</mtext></ci><apply id="S4.E6.m1.10.10.10.8.1.1.cmml" xref="S4.E6.m1.10.10.10.8.1"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.10.8.1.1.2.cmml" xref="S4.E6.m1.10.10.10.8.1">subscript</csymbol><set id="S4.E6.m1.10.10.10.8.1.1.1.2.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1"><apply id="S4.E6.m1.10.10.10.8.1.1.1.1.1.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1"><times id="S4.E6.m1.10.10.10.8.1.1.1.1.1.2.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.2"></times><apply id="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.3.2">𝑓</ci><list id="S4.E6.m1.4.4.4.2.2.3.cmml" xref="S4.E6.m1.4.4.4.2.2.4"><ci id="S4.E6.m1.3.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.3.1.1.1">𝑘</ci><ci id="S4.E6.m1.4.4.4.2.2.2.cmml" xref="S4.E6.m1.4.4.4.2.2.2">𝑐</ci></list></apply><list id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1"><ci id="S4.E6.m1.9.9.9.7.cmml" xref="S4.E6.m1.9.9.9.7">𝐱</ci><apply id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.10.10.10.8.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></set><apply id="S4.E6.m1.8.8.8.6.4.5.cmml" xref="S4.E6.m1.8.8.8.6.4.4"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.8.6.4.5a.cmml" xref="S4.E6.m1.8.8.8.6.4.4.3">formulae-sequence</csymbol><apply id="S4.E6.m1.7.7.7.5.3.3.1.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1"><csymbol cd="latexml" id="S4.E6.m1.7.7.7.5.3.3.1.1.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.1">similar-to</csymbol><ci id="S4.E6.m1.7.7.7.5.3.3.1.2.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.2">𝐱</ci><apply id="S4.E6.m1.7.7.7.5.3.3.1.3.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3"><times id="S4.E6.m1.7.7.7.5.3.3.1.3.1.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.1"></times><apply id="S4.E6.m1.7.7.7.5.3.3.1.3.2.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.7.5.3.3.1.3.2.1.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2">subscript</csymbol><ci id="S4.E6.m1.7.7.7.5.3.3.1.3.2.2.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.2">𝑝</ci><ci id="S4.E6.m1.7.7.7.5.3.3.1.3.2.3a.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.3"><mtext mathsize="50%" id="S4.E6.m1.7.7.7.5.3.3.1.3.2.3.cmml" xref="S4.E6.m1.7.7.7.5.3.3.1.3.2.3">g</mtext></ci></apply><ci id="S4.E6.m1.5.5.5.3.1.1.cmml" xref="S4.E6.m1.5.5.5.3.1.1">𝐱</ci></apply></apply><apply id="S4.E6.m1.8.8.8.6.4.4.2.cmml" xref="S4.E6.m1.8.8.8.6.4.4.2"><in id="S4.E6.m1.8.8.8.6.4.4.2.1.cmml" xref="S4.E6.m1.8.8.8.6.4.4.2.1"></in><ci id="S4.E6.m1.8.8.8.6.4.4.2.2.cmml" xref="S4.E6.m1.8.8.8.6.4.4.2.2">𝑐</ci><apply id="S4.E6.m1.8.8.8.6.4.4.2.3.1.cmml" xref="S4.E6.m1.8.8.8.6.4.4.2.3.2"><csymbol cd="latexml" id="S4.E6.m1.8.8.8.6.4.4.2.3.1.1.cmml" xref="S4.E6.m1.8.8.8.6.4.4.2.3.2.1">delimited-[]</csymbol><ci id="S4.E6.m1.6.6.6.4.2.2.cmml" xref="S4.E6.m1.6.6.6.4.2.2">𝐶</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.12c">q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})=\sigma\left(\tau*\frac{f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})}{\text{std}\left(\{f_{k,c}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\}_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}}),c\in[C]}\right)}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E7.m1.2" class="ltx_Math" alttext="\overline{q}_{\text{AP}}(y|{\mathbf{x}})=\sum_{k}w_{k}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})," display="block"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><msub id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.3.cmml"><mover accent="true" id="S4.E7.m1.2.2.1.1.1.3.2" xref="S4.E7.m1.2.2.1.1.1.3.2.cmml"><mi id="S4.E7.m1.2.2.1.1.1.3.2.2" xref="S4.E7.m1.2.2.1.1.1.3.2.2.cmml">q</mi><mo id="S4.E7.m1.2.2.1.1.1.3.2.1" xref="S4.E7.m1.2.2.1.1.1.3.2.1.cmml">¯</mo></mover><mtext id="S4.E7.m1.2.2.1.1.1.3.3" xref="S4.E7.m1.2.2.1.1.1.3.3a.cmml">AP</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E7.m1.2.2.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E7.m1.2.2.1.1.2" xref="S4.E7.m1.2.2.1.1.2.cmml"><munder id="S4.E7.m1.2.2.1.1.2.2" xref="S4.E7.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S4.E7.m1.2.2.1.1.2.2.2" xref="S4.E7.m1.2.2.1.1.2.2.2.cmml">∑</mo><mi id="S4.E7.m1.2.2.1.1.2.2.3" xref="S4.E7.m1.2.2.1.1.2.2.3.cmml">k</mi></munder><mrow id="S4.E7.m1.2.2.1.1.2.1" xref="S4.E7.m1.2.2.1.1.2.1.cmml"><msub id="S4.E7.m1.2.2.1.1.2.1.3" xref="S4.E7.m1.2.2.1.1.2.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.2.1.3.2" xref="S4.E7.m1.2.2.1.1.2.1.3.2.cmml">w</mi><mi id="S4.E7.m1.2.2.1.1.2.1.3.3" xref="S4.E7.m1.2.2.1.1.2.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.1.2.1.2" xref="S4.E7.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="S4.E7.m1.2.2.1.1.2.1.4" xref="S4.E7.m1.2.2.1.1.2.1.4.cmml"><mi id="S4.E7.m1.2.2.1.1.2.1.4.2" xref="S4.E7.m1.2.2.1.1.2.1.4.2.cmml">q</mi><mi id="S4.E7.m1.2.2.1.1.2.1.4.3" xref="S4.E7.m1.2.2.1.1.2.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.1.2.1.2a" xref="S4.E7.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.1.1.2.1.1.1" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.2.2.1.1.2.1.1.1.1" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.E7.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.2.cmml">|</mo><mrow id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.E7.m1.2.2.1.1.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1"><eq id="S4.E7.m1.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.3"></eq><apply id="S4.E7.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1"><times id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2"></times><apply id="S4.E7.m1.2.2.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.1.3">subscript</csymbol><apply id="S4.E7.m1.2.2.1.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.1.3.2"><ci id="S4.E7.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.3.2.1">¯</ci><ci id="S4.E7.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E7.m1.2.2.1.1.1.3.2.2">𝑞</ci></apply><ci id="S4.E7.m1.2.2.1.1.1.3.3a.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3"><mtext mathsize="70%" id="S4.E7.m1.2.2.1.1.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3.3">AP</mtext></ci></apply><apply id="S4.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.E7.m1.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2"><apply id="S4.E7.m1.2.2.1.1.2.2.cmml" xref="S4.E7.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.2.2.1.cmml" xref="S4.E7.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S4.E7.m1.2.2.1.1.2.2.2.cmml" xref="S4.E7.m1.2.2.1.1.2.2.2"></sum><ci id="S4.E7.m1.2.2.1.1.2.2.3.cmml" xref="S4.E7.m1.2.2.1.1.2.2.3">𝑘</ci></apply><apply id="S4.E7.m1.2.2.1.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1"><times id="S4.E7.m1.2.2.1.1.2.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.2"></times><apply id="S4.E7.m1.2.2.1.1.2.1.3.cmml" xref="S4.E7.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.2.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.2.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.3.2">𝑤</ci><ci id="S4.E7.m1.2.2.1.1.2.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.2.1.3.3">𝑘</ci></apply><apply id="S4.E7.m1.2.2.1.1.2.1.4.cmml" xref="S4.E7.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.2.1.4.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.2.1.4.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.4.2">𝑞</ci><ci id="S4.E7.m1.2.2.1.1.2.1.4.3.cmml" xref="S4.E7.m1.2.2.1.1.2.1.4.3">𝑘</ci></apply><apply id="S4.E7.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.2">conditional</csymbol><ci id="S4.E7.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.3">𝑦</ci><list id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝐱</ci><apply id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">\overline{q}_{\text{AP}}(y|{\mathbf{x}})=\sum_{k}w_{k}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.3" class="ltx_p">where <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="\text{std}(\{\cdot\})" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml"><mtext id="S4.SS1.p2.1.m1.2.2.3" xref="S4.SS1.p2.1.m1.2.2.3a.cmml">std</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S4.SS1.p2.1.m1.2.2.1.1" xref="S4.SS1.p2.1.m1.2.2.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.1.1.2" xref="S4.SS1.p2.1.m1.2.2.cmml">(</mo><mrow id="S4.SS1.p2.1.m1.2.2.1.1.1.2" xref="S4.SS1.p2.1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.1.1.1.2.1" xref="S4.SS1.p2.1.m1.2.2.1.1.1.1.cmml">{</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.1.1.1.2.2" xref="S4.SS1.p2.1.m1.2.2.1.1.1.1.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.1.1.3" xref="S4.SS1.p2.1.m1.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2"><times id="S4.SS1.p2.1.m1.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2"></times><ci id="S4.SS1.p2.1.m1.2.2.3a.cmml" xref="S4.SS1.p2.1.m1.2.2.3"><mtext id="S4.SS1.p2.1.m1.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.3">std</mtext></ci><set id="S4.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">⋅</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">\text{std}(\{\cdot\})</annotation></semantics></math> calculates the standard deviation of a set of values, i.e., all “logit" values of all classes on all test samples. <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\tau</annotation></semantics></math> is the temperature that controls the entropy and we use <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\tau=4.0" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">τ</mi><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">4.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></eq><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝜏</ci><cn type="float" id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">4.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\tau=4.0</annotation></semantics></math>. <span id="S4.SS1.p2.3.1" class="ltx_text ltx_font_italic">This normalization process could generate magnitude-invariant distillation targets among local models, which are more robust to averaging.</span></p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Rectified Distillation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.25" class="ltx_p">From another aspect, the distillation in FedDF aims to optimize:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E8.m1.4" class="ltx_Math" alttext="\min_{\theta}E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[-\sum_{c=1}^{C}\overline{q}(y=c|{\mathbf{x}})\log q_{\text{g}}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta)\right]," display="block"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.4.1" xref="S4.E8.m1.4.4.1.1.cmml"><mrow id="S4.E8.m1.4.4.1.1" xref="S4.E8.m1.4.4.1.1.cmml"><mrow id="S4.E8.m1.4.4.1.1.3" xref="S4.E8.m1.4.4.1.1.3.cmml"><munder id="S4.E8.m1.4.4.1.1.3.1" xref="S4.E8.m1.4.4.1.1.3.1.cmml"><mi id="S4.E8.m1.4.4.1.1.3.1.2" xref="S4.E8.m1.4.4.1.1.3.1.2.cmml">min</mi><mi id="S4.E8.m1.4.4.1.1.3.1.3" xref="S4.E8.m1.4.4.1.1.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S4.E8.m1.4.4.1.1.3a" xref="S4.E8.m1.4.4.1.1.3.cmml">⁡</mo><msub id="S4.E8.m1.4.4.1.1.3.2" xref="S4.E8.m1.4.4.1.1.3.2.cmml"><mi id="S4.E8.m1.4.4.1.1.3.2.2" xref="S4.E8.m1.4.4.1.1.3.2.2.cmml">E</mi><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml">𝐱</mi><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">∼</mo><mrow id="S4.E8.m1.1.1.1.4" xref="S4.E8.m1.1.1.1.4.cmml"><msub id="S4.E8.m1.1.1.1.4.2" xref="S4.E8.m1.1.1.1.4.2.cmml"><mi id="S4.E8.m1.1.1.1.4.2.2" xref="S4.E8.m1.1.1.1.4.2.2.cmml">p</mi><mtext id="S4.E8.m1.1.1.1.4.2.3" xref="S4.E8.m1.1.1.1.4.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.4.1" xref="S4.E8.m1.1.1.1.4.1.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.4.3.2" xref="S4.E8.m1.1.1.1.4.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.4.3.2.1" xref="S4.E8.m1.1.1.1.4.cmml">(</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E8.m1.1.1.1.4.3.2.2" xref="S4.E8.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.1.2" xref="S4.E8.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.4.4.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.2.cmml"><mo id="S4.E8.m1.4.4.1.1.1.1.2" xref="S4.E8.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml"><mo id="S4.E8.m1.4.4.1.1.1.1.1a" xref="S4.E8.m1.4.4.1.1.1.1.1.cmml">−</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.cmml"><munderover id="S4.E8.m1.4.4.1.1.1.1.1.2.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.2.cmml">c</mi><mo id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.3.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.3.cmml">C</mi></munderover><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.2.cmml">q</mi><mo id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo fence="false" id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.3a" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.1.cmml">log</mi><mo lspace="0.167em" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5a" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.cmml">⁡</mo><msub id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.2.cmml">q</mi><mtext id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3a.cmml">g</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.3b" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.2.cmml">y</mi><mo id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.2.cmml">c</mi><mo fence="false" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.1.cmml">|</mo><mrow id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.2" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml"><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.2.1" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml">;</mo><mi id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">θ</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.3" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.4.4.1.1.1.1.3" xref="S4.E8.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E8.m1.4.4.1.2" xref="S4.E8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.4b"><apply id="S4.E8.m1.4.4.1.1.cmml" xref="S4.E8.m1.4.4.1"><times id="S4.E8.m1.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.2"></times><apply id="S4.E8.m1.4.4.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.3"><apply id="S4.E8.m1.4.4.1.1.3.1.cmml" xref="S4.E8.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.3.1.1.cmml" xref="S4.E8.m1.4.4.1.1.3.1">subscript</csymbol><min id="S4.E8.m1.4.4.1.1.3.1.2.cmml" xref="S4.E8.m1.4.4.1.1.3.1.2"></min><ci id="S4.E8.m1.4.4.1.1.3.1.3.cmml" xref="S4.E8.m1.4.4.1.1.3.1.3">𝜃</ci></apply><apply id="S4.E8.m1.4.4.1.1.3.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.3.2.1.cmml" xref="S4.E8.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.3.2.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2.2">𝐸</ci><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2">similar-to</csymbol><ci id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3">𝐱</ci><apply id="S4.E8.m1.1.1.1.4.cmml" xref="S4.E8.m1.1.1.1.4"><times id="S4.E8.m1.1.1.1.4.1.cmml" xref="S4.E8.m1.1.1.1.4.1"></times><apply id="S4.E8.m1.1.1.1.4.2.cmml" xref="S4.E8.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.4.2.1.cmml" xref="S4.E8.m1.1.1.1.4.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.4.2.2.cmml" xref="S4.E8.m1.1.1.1.4.2.2">𝑝</ci><ci id="S4.E8.m1.1.1.1.4.2.3a.cmml" xref="S4.E8.m1.1.1.1.4.2.3"><mtext mathsize="50%" id="S4.E8.m1.1.1.1.4.2.3.cmml" xref="S4.E8.m1.1.1.1.4.2.3">g</mtext></ci></apply><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝐱</ci></apply></apply></apply></apply><apply id="S4.E8.m1.4.4.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.4.4.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.4.4.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1"><minus id="S4.E8.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1"></minus><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2"><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3">subscript</csymbol><sum id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.2"></sum><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3"><eq id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.1"></eq><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.2">𝑐</ci><cn type="integer" id="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.3.3">𝐶</ci></apply><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2"><times id="S4.E8.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.3"></times><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4"><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.1">¯</ci><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.4.2">𝑞</ci></apply><apply id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1"><eq id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝐱</ci></apply></apply><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5"><log id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.1"></log><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.2">𝑞</ci><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3a.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3"><mtext mathsize="70%" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.5.2.3">g</mtext></ci></apply></apply><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1"><eq id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.1"></eq><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.2">𝑦</ci><apply id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3"><csymbol cd="latexml" id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.1">conditional</csymbol><ci id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.2">𝑐</ci><list id="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1.1.2.2.2.1.1.3.3.2"><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">𝐱</ci><ci id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3">𝜃</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.4c">\min_{\theta}E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[-\sum_{c=1}^{C}\overline{q}(y=c|{\mathbf{x}})\log q_{\text{g}}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.1" class="ltx_p">where we use <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="\overline{q}(y|{\mathbf{x}})=\overline{q}_{\text{AP}}(y|{\mathbf{x}})" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml"><mover accent="true" id="S4.SS2.p1.1.m1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.1.3.2.cmml">q</mi><mo id="S4.SS2.p1.1.m1.1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.1.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.1.m1.2.2.3" xref="S4.SS2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS2.p1.1.m1.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.cmml"><msub id="S4.SS2.p1.1.m1.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml"><mover accent="true" id="S4.SS2.p1.1.m1.2.2.2.3.2" xref="S4.SS2.p1.1.m1.2.2.2.3.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.3.2.2" xref="S4.SS2.p1.1.m1.2.2.2.3.2.2.cmml">q</mi><mo id="S4.SS2.p1.1.m1.2.2.2.3.2.1" xref="S4.SS2.p1.1.m1.2.2.2.3.2.1.cmml">¯</mo></mover><mtext id="S4.SS2.p1.1.m1.2.2.2.3.3" xref="S4.SS2.p1.1.m1.2.2.2.3.3a.cmml">AP</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.1.1" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.2.2.2.1.1.2" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.1.1.1" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.1.1.1.2" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.1.m1.2.2.2.1.1.1.1" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.1.m1.2.2.2.1.1.1.3" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.1.m1.2.2.2.1.1.3" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2"><eq id="S4.SS2.p1.1.m1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.3"></eq><apply id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.2"></times><apply id="S4.SS2.p1.1.m1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.3"><ci id="S4.SS2.p1.1.m1.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.3.1">¯</ci><ci id="S4.SS2.p1.1.m1.1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.3.2">𝑞</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS2.p1.1.m1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2"><times id="S4.SS2.p1.1.m1.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2"></times><apply id="S4.SS2.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3">subscript</csymbol><apply id="S4.SS2.p1.1.m1.2.2.2.3.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3.2"><ci id="S4.SS2.p1.1.m1.2.2.2.3.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3.2.1">¯</ci><ci id="S4.SS2.p1.1.m1.2.2.2.3.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3.2.2">𝑞</ci></apply><ci id="S4.SS2.p1.1.m1.2.2.2.3.3a.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3.3"><mtext mathsize="70%" id="S4.SS2.p1.1.m1.2.2.2.3.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3.3">AP</mtext></ci></apply><apply id="S4.SS2.p1.1.m1.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.1.1.1.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">\overline{q}(y|{\mathbf{x}})=\overline{q}_{\text{AP}}(y|{\mathbf{x}})</annotation></semantics></math> in Eq. <a href="#S4.E7" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> without any more consideration of “AvgLogi". This is just the KL-divergence in Eq. <a href="#S3.E1" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Then, we rewrite the distillation process as:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E9.m1.4" class="ltx_Math" alttext="\min_{\theta}E_{{\mathbf{x}}}\left[-\sum_{c=1}^{C}\left[\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\log q_{\text{g}}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta)\right]\right]," display="block"><semantics id="S4.E9.m1.4a"><mrow id="S4.E9.m1.4.4.1" xref="S4.E9.m1.4.4.1.1.cmml"><mrow id="S4.E9.m1.4.4.1.1" xref="S4.E9.m1.4.4.1.1.cmml"><mrow id="S4.E9.m1.4.4.1.1.3" xref="S4.E9.m1.4.4.1.1.3.cmml"><munder id="S4.E9.m1.4.4.1.1.3.1" xref="S4.E9.m1.4.4.1.1.3.1.cmml"><mi id="S4.E9.m1.4.4.1.1.3.1.2" xref="S4.E9.m1.4.4.1.1.3.1.2.cmml">min</mi><mi id="S4.E9.m1.4.4.1.1.3.1.3" xref="S4.E9.m1.4.4.1.1.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S4.E9.m1.4.4.1.1.3a" xref="S4.E9.m1.4.4.1.1.3.cmml">⁡</mo><msub id="S4.E9.m1.4.4.1.1.3.2" xref="S4.E9.m1.4.4.1.1.3.2.cmml"><mi id="S4.E9.m1.4.4.1.1.3.2.2" xref="S4.E9.m1.4.4.1.1.3.2.2.cmml">E</mi><mi id="S4.E9.m1.4.4.1.1.3.2.3" xref="S4.E9.m1.4.4.1.1.3.2.3.cmml">𝐱</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.1.1.2" xref="S4.E9.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.4.4.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.2.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1a" xref="S4.E9.m1.4.4.1.1.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.cmml"><munderover id="S4.E9.m1.4.4.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><munder id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mo lspace="0em" movablelimits="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml">∈</mo><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3.cmml">S</mi></mrow></munder><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mfrac id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml"><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">w</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml">k</mi></msub><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.cmml"><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.2.cmml">j</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.1.cmml">∈</mo><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.3.cmml">S</mi></mrow></msub><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.2.cmml">w</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.2.cmml">q</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3a" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">y</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi><mo fence="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow></mrow><mo stretchy="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3b" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6a" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.cmml">⁡</mo><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.2.cmml">q</mi><mtext id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3a.cmml">g</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3c" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">y</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml">c</mi><mo fence="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml">|</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.1.cmml"><mi id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.2.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.1.cmml">;</mo><mi id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml">θ</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E9.m1.4.4.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E9.m1.4.4.1.2" xref="S4.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.4b"><apply id="S4.E9.m1.4.4.1.1.cmml" xref="S4.E9.m1.4.4.1"><times id="S4.E9.m1.4.4.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.2"></times><apply id="S4.E9.m1.4.4.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.3"><apply id="S4.E9.m1.4.4.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.3.1.1.cmml" xref="S4.E9.m1.4.4.1.1.3.1">subscript</csymbol><min id="S4.E9.m1.4.4.1.1.3.1.2.cmml" xref="S4.E9.m1.4.4.1.1.3.1.2"></min><ci id="S4.E9.m1.4.4.1.1.3.1.3.cmml" xref="S4.E9.m1.4.4.1.1.3.1.3">𝜃</ci></apply><apply id="S4.E9.m1.4.4.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.3.2.1.cmml" xref="S4.E9.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.3.2.2.cmml" xref="S4.E9.m1.4.4.1.1.3.2.2">𝐸</ci><ci id="S4.E9.m1.4.4.1.1.3.2.3.cmml" xref="S4.E9.m1.4.4.1.1.3.2.3">𝐱</ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.4.4.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1"><minus id="S4.E9.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1"></minus><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1"><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3"><eq id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1"><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><sum id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"></sum><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3"><in id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1"></in><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2">𝑘</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3">𝑆</ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2"><times id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4"><divide id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4"></divide><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.2">𝑤</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.2.3">𝑘</ci></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3"><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1">subscript</csymbol><sum id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.2"></sum><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3"><in id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.1"></in><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.2">𝑗</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.2">𝑤</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.4.3.2.3">𝑗</ci></apply></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.2">𝑞</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.5.3">𝑘</ci></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><eq id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></eq><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑦</ci><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci><list id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">𝐱</ci><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6"><log id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.1"></log><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.2">𝑞</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3a.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3"><mtext mathsize="70%" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.6.2.3">g</mtext></ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1"><eq id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.1"></eq><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.2">𝑦</ci><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3"><csymbol cd="latexml" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1">conditional</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2">𝑐</ci><list id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.2"><ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">𝐱</ci><ci id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3">𝜃</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.4c">\min_{\theta}E_{{\mathbf{x}}}\left[-\sum_{c=1}^{C}\left[\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})\log q_{\text{g}}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta)\right]\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.24" class="ltx_p">where we consider stochastic client participation (i.e., only <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="|S|" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><mrow id="S4.SS2.p1.2.m1.1.2.2" xref="S4.SS2.p1.2.m1.1.2.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m1.1.2.2.1" xref="S4.SS2.p1.2.m1.1.2.1.1.cmml">|</mo><mi id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml">S</mi><mo stretchy="false" id="S4.SS2.p1.2.m1.1.2.2.2" xref="S4.SS2.p1.2.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.2.1.cmml" xref="S4.SS2.p1.2.m1.1.2.2"><abs id="S4.SS2.p1.2.m1.1.2.1.1.cmml" xref="S4.SS2.p1.2.m1.1.2.2.1"></abs><ci id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">|S|</annotation></semantics></math> clients) resulted from limited or unstable communication. The ideal optimization of <math id="S4.SS2.p1.3.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS2.p1.3.m2.1a"><mi id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><ci id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">\theta</annotation></semantics></math> should be minimizing <math id="S4.SS2.p1.4.m3.4" class="ltx_Math" alttext="\text{KL}(p_{\text{g}}(y|{\mathbf{x}}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))" display="inline"><semantics id="S4.SS2.p1.4.m3.4a"><mrow id="S4.SS2.p1.4.m3.4.4" xref="S4.SS2.p1.4.m3.4.4.cmml"><mtext id="S4.SS2.p1.4.m3.4.4.4" xref="S4.SS2.p1.4.m3.4.4.4a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m3.4.4.3" xref="S4.SS2.p1.4.m3.4.4.3.cmml">​</mo><mrow id="S4.SS2.p1.4.m3.4.4.2.2" xref="S4.SS2.p1.4.m3.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m3.4.4.2.2.3" xref="S4.SS2.p1.4.m3.4.4.2.3.cmml">(</mo><mrow id="S4.SS2.p1.4.m3.3.3.1.1.1" xref="S4.SS2.p1.4.m3.3.3.1.1.1.cmml"><msub id="S4.SS2.p1.4.m3.3.3.1.1.1.3" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.cmml"><mi id="S4.SS2.p1.4.m3.3.3.1.1.1.3.2" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.2.cmml">p</mi><mtext id="S4.SS2.p1.4.m3.3.3.1.1.1.3.3" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m3.3.3.1.1.1.2" xref="S4.SS2.p1.4.m3.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.2" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.2" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.1" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.3" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.3" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.4.m3.4.4.2.2.4" xref="S4.SS2.p1.4.m3.4.4.2.3.cmml">,</mo><mrow id="S4.SS2.p1.4.m3.4.4.2.2.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.cmml"><msub id="S4.SS2.p1.4.m3.4.4.2.2.2.3" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m3.4.4.2.2.2.3.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.2.cmml">q</mi><mtext id="S4.SS2.p1.4.m3.4.4.2.2.2.3.3" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m3.4.4.2.2.2.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.2.cmml">​</mo><mrow id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.1" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.2" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.1.cmml"><mi id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.2.1" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.1.cmml">;</mo><mi id="S4.SS2.p1.4.m3.2.2" xref="S4.SS2.p1.4.m3.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.3" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.4.m3.4.4.2.2.5" xref="S4.SS2.p1.4.m3.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.4b"><apply id="S4.SS2.p1.4.m3.4.4.cmml" xref="S4.SS2.p1.4.m3.4.4"><times id="S4.SS2.p1.4.m3.4.4.3.cmml" xref="S4.SS2.p1.4.m3.4.4.3"></times><ci id="S4.SS2.p1.4.m3.4.4.4a.cmml" xref="S4.SS2.p1.4.m3.4.4.4"><mtext id="S4.SS2.p1.4.m3.4.4.4.cmml" xref="S4.SS2.p1.4.m3.4.4.4">KL</mtext></ci><interval closure="open" id="S4.SS2.p1.4.m3.4.4.2.3.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2"><apply id="S4.SS2.p1.4.m3.3.3.1.1.1.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1"><times id="S4.SS2.p1.4.m3.3.3.1.1.1.2.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.2"></times><apply id="S4.SS2.p1.4.m3.3.3.1.1.1.3.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.3.3.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.4.m3.3.3.1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.4.m3.3.3.1.1.1.3.3a.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.3"><mtext mathsize="70%" id="S4.SS2.p1.4.m3.3.3.1.1.1.3.3.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.3.3">g</mtext></ci></apply><apply id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m3.3.3.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS2.p1.4.m3.4.4.2.2.2.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2"><times id="S4.SS2.p1.4.m3.4.4.2.2.2.2.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.2"></times><apply id="S4.SS2.p1.4.m3.4.4.2.2.2.3.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.4.4.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m3.4.4.2.2.2.3.2.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.2">𝑞</ci><ci id="S4.SS2.p1.4.m3.4.4.2.2.2.3.3a.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.3"><mtext mathsize="70%" id="S4.SS2.p1.4.m3.4.4.2.2.2.3.3.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.3.3">g</mtext></ci></apply><apply id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.2">𝑦</ci><list id="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m3.4.4.2.2.2.1.1.1.3.2"><ci id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1">𝐱</ci><ci id="S4.SS2.p1.4.m3.2.2.cmml" xref="S4.SS2.p1.4.m3.2.2">𝜃</ci></list></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.4c">\text{KL}(p_{\text{g}}(y|{\mathbf{x}}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))</annotation></semantics></math>, <math id="S4.SS2.p1.5.m4.1" class="ltx_Math" alttext="\forall{\mathbf{x}}\sim p_{\text{g}}(x)" display="inline"><semantics id="S4.SS2.p1.5.m4.1a"><mrow id="S4.SS2.p1.5.m4.1.2" xref="S4.SS2.p1.5.m4.1.2.cmml"><mrow id="S4.SS2.p1.5.m4.1.2.2" xref="S4.SS2.p1.5.m4.1.2.2.cmml"><mo rspace="0.167em" id="S4.SS2.p1.5.m4.1.2.2.1" xref="S4.SS2.p1.5.m4.1.2.2.1.cmml">∀</mo><mi id="S4.SS2.p1.5.m4.1.2.2.2" xref="S4.SS2.p1.5.m4.1.2.2.2.cmml">𝐱</mi></mrow><mo id="S4.SS2.p1.5.m4.1.2.1" xref="S4.SS2.p1.5.m4.1.2.1.cmml">∼</mo><mrow id="S4.SS2.p1.5.m4.1.2.3" xref="S4.SS2.p1.5.m4.1.2.3.cmml"><msub id="S4.SS2.p1.5.m4.1.2.3.2" xref="S4.SS2.p1.5.m4.1.2.3.2.cmml"><mi id="S4.SS2.p1.5.m4.1.2.3.2.2" xref="S4.SS2.p1.5.m4.1.2.3.2.2.cmml">p</mi><mtext id="S4.SS2.p1.5.m4.1.2.3.2.3" xref="S4.SS2.p1.5.m4.1.2.3.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m4.1.2.3.1" xref="S4.SS2.p1.5.m4.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p1.5.m4.1.2.3.3.2" xref="S4.SS2.p1.5.m4.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.5.m4.1.2.3.3.2.1" xref="S4.SS2.p1.5.m4.1.2.3.cmml">(</mo><mi id="S4.SS2.p1.5.m4.1.1" xref="S4.SS2.p1.5.m4.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS2.p1.5.m4.1.2.3.3.2.2" xref="S4.SS2.p1.5.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.1b"><apply id="S4.SS2.p1.5.m4.1.2.cmml" xref="S4.SS2.p1.5.m4.1.2"><csymbol cd="latexml" id="S4.SS2.p1.5.m4.1.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2.1">similar-to</csymbol><apply id="S4.SS2.p1.5.m4.1.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2.2"><csymbol cd="latexml" id="S4.SS2.p1.5.m4.1.2.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2.2.1">for-all</csymbol><ci id="S4.SS2.p1.5.m4.1.2.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2.2.2">𝐱</ci></apply><apply id="S4.SS2.p1.5.m4.1.2.3.cmml" xref="S4.SS2.p1.5.m4.1.2.3"><times id="S4.SS2.p1.5.m4.1.2.3.1.cmml" xref="S4.SS2.p1.5.m4.1.2.3.1"></times><apply id="S4.SS2.p1.5.m4.1.2.3.2.cmml" xref="S4.SS2.p1.5.m4.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.2.3.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2.3.2">subscript</csymbol><ci id="S4.SS2.p1.5.m4.1.2.3.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2.3.2.2">𝑝</ci><ci id="S4.SS2.p1.5.m4.1.2.3.2.3a.cmml" xref="S4.SS2.p1.5.m4.1.2.3.2.3"><mtext mathsize="70%" id="S4.SS2.p1.5.m4.1.2.3.2.3.cmml" xref="S4.SS2.p1.5.m4.1.2.3.2.3">g</mtext></ci></apply><ci id="S4.SS2.p1.5.m4.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.1c">\forall{\mathbf{x}}\sim p_{\text{g}}(x)</annotation></semantics></math>. If we could guarantee <math id="S4.SS2.p1.6.m5.2" class="ltx_Math" alttext="\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})" display="inline"><semantics id="S4.SS2.p1.6.m5.2a"><mrow id="S4.SS2.p1.6.m5.2.2" xref="S4.SS2.p1.6.m5.2.2.cmml"><msub id="S4.SS2.p1.6.m5.2.2.2" xref="S4.SS2.p1.6.m5.2.2.2.cmml"><mo id="S4.SS2.p1.6.m5.2.2.2.2" xref="S4.SS2.p1.6.m5.2.2.2.2.cmml">∑</mo><mrow id="S4.SS2.p1.6.m5.2.2.2.3" xref="S4.SS2.p1.6.m5.2.2.2.3.cmml"><mi id="S4.SS2.p1.6.m5.2.2.2.3.2" xref="S4.SS2.p1.6.m5.2.2.2.3.2.cmml">k</mi><mo id="S4.SS2.p1.6.m5.2.2.2.3.1" xref="S4.SS2.p1.6.m5.2.2.2.3.1.cmml">∈</mo><mi id="S4.SS2.p1.6.m5.2.2.2.3.3" xref="S4.SS2.p1.6.m5.2.2.2.3.3.cmml">S</mi></mrow></msub><mrow id="S4.SS2.p1.6.m5.2.2.1" xref="S4.SS2.p1.6.m5.2.2.1.cmml"><mfrac id="S4.SS2.p1.6.m5.2.2.1.3" xref="S4.SS2.p1.6.m5.2.2.1.3.cmml"><msub id="S4.SS2.p1.6.m5.2.2.1.3.2" xref="S4.SS2.p1.6.m5.2.2.1.3.2.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.3.2.2" xref="S4.SS2.p1.6.m5.2.2.1.3.2.2.cmml">w</mi><mi id="S4.SS2.p1.6.m5.2.2.1.3.2.3" xref="S4.SS2.p1.6.m5.2.2.1.3.2.3.cmml">k</mi></msub><mrow id="S4.SS2.p1.6.m5.2.2.1.3.3" xref="S4.SS2.p1.6.m5.2.2.1.3.3.cmml"><mstyle displaystyle="false" id="S4.SS2.p1.6.m5.2.2.1.3.3.1" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.cmml"><msub id="S4.SS2.p1.6.m5.2.2.1.3.3.1a" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.cmml"><mo id="S4.SS2.p1.6.m5.2.2.1.3.3.1.2" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.2.cmml">∑</mo><mrow id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.2" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.2.cmml">j</mi><mo id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.1" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.1.cmml">∈</mo><mi id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.3" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.3.cmml">S</mi></mrow></msub></mstyle><msub id="S4.SS2.p1.6.m5.2.2.1.3.3.2" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.3.3.2.2" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2.2.cmml">w</mi><mi id="S4.SS2.p1.6.m5.2.2.1.3.3.2.3" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m5.2.2.1.2" xref="S4.SS2.p1.6.m5.2.2.1.2.cmml">​</mo><msub id="S4.SS2.p1.6.m5.2.2.1.4" xref="S4.SS2.p1.6.m5.2.2.1.4.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.4.2" xref="S4.SS2.p1.6.m5.2.2.1.4.2.cmml">q</mi><mi id="S4.SS2.p1.6.m5.2.2.1.4.3" xref="S4.SS2.p1.6.m5.2.2.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m5.2.2.1.2a" xref="S4.SS2.p1.6.m5.2.2.1.2.cmml">​</mo><mrow id="S4.SS2.p1.6.m5.2.2.1.1.1" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m5.2.2.1.1.1.2" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.6.m5.2.2.1.1.1.1" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.1.1.1.3" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.SS2.p1.6.m5.2.2.1.1.1.1.2" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.2" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.2.cmml">;</mo><msub id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.6.m5.2.2.1.1.1.3" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.2b"><apply id="S4.SS2.p1.6.m5.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2"><apply id="S4.SS2.p1.6.m5.2.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.2">subscript</csymbol><sum id="S4.SS2.p1.6.m5.2.2.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.2.2"></sum><apply id="S4.SS2.p1.6.m5.2.2.2.3.cmml" xref="S4.SS2.p1.6.m5.2.2.2.3"><in id="S4.SS2.p1.6.m5.2.2.2.3.1.cmml" xref="S4.SS2.p1.6.m5.2.2.2.3.1"></in><ci id="S4.SS2.p1.6.m5.2.2.2.3.2.cmml" xref="S4.SS2.p1.6.m5.2.2.2.3.2">𝑘</ci><ci id="S4.SS2.p1.6.m5.2.2.2.3.3.cmml" xref="S4.SS2.p1.6.m5.2.2.2.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.6.m5.2.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1"><times id="S4.SS2.p1.6.m5.2.2.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.2"></times><apply id="S4.SS2.p1.6.m5.2.2.1.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3"><divide id="S4.SS2.p1.6.m5.2.2.1.3.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3"></divide><apply id="S4.SS2.p1.6.m5.2.2.1.3.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.3.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.2">subscript</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.3.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.2.2">𝑤</ci><ci id="S4.SS2.p1.6.m5.2.2.1.3.2.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.2.3">𝑘</ci></apply><apply id="S4.SS2.p1.6.m5.2.2.1.3.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3"><apply id="S4.SS2.p1.6.m5.2.2.1.3.3.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.3.3.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1">subscript</csymbol><sum id="S4.SS2.p1.6.m5.2.2.1.3.3.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.2"></sum><apply id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3"><in id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.1"></in><ci id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.2">𝑗</ci><ci id="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.6.m5.2.2.1.3.3.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.3.3.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.3.3.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2.2">𝑤</ci><ci id="S4.SS2.p1.6.m5.2.2.1.3.3.2.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="S4.SS2.p1.6.m5.2.2.1.4.cmml" xref="S4.SS2.p1.6.m5.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.4.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.4">subscript</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.4.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.4.2">𝑞</ci><ci id="S4.SS2.p1.6.m5.2.2.1.4.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.4.3">𝑘</ci></apply><apply id="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.6.m5.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.2">conditional</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.3">𝑦</ci><list id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1"><ci id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1">𝐱</ci><apply id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.2c">\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})</annotation></semantics></math> approximates <math id="S4.SS2.p1.7.m6.1" class="ltx_Math" alttext="p_{\text{g}}(y|{\mathbf{x}})" display="inline"><semantics id="S4.SS2.p1.7.m6.1a"><mrow id="S4.SS2.p1.7.m6.1.1" xref="S4.SS2.p1.7.m6.1.1.cmml"><msub id="S4.SS2.p1.7.m6.1.1.3" xref="S4.SS2.p1.7.m6.1.1.3.cmml"><mi id="S4.SS2.p1.7.m6.1.1.3.2" xref="S4.SS2.p1.7.m6.1.1.3.2.cmml">p</mi><mtext id="S4.SS2.p1.7.m6.1.1.3.3" xref="S4.SS2.p1.7.m6.1.1.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m6.1.1.2" xref="S4.SS2.p1.7.m6.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.7.m6.1.1.1.1" xref="S4.SS2.p1.7.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m6.1.1.1.1.2" xref="S4.SS2.p1.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.7.m6.1.1.1.1.1" xref="S4.SS2.p1.7.m6.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.7.m6.1.1.1.1.1.2" xref="S4.SS2.p1.7.m6.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.7.m6.1.1.1.1.1.1" xref="S4.SS2.p1.7.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.7.m6.1.1.1.1.1.3" xref="S4.SS2.p1.7.m6.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.7.m6.1.1.1.1.3" xref="S4.SS2.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m6.1b"><apply id="S4.SS2.p1.7.m6.1.1.cmml" xref="S4.SS2.p1.7.m6.1.1"><times id="S4.SS2.p1.7.m6.1.1.2.cmml" xref="S4.SS2.p1.7.m6.1.1.2"></times><apply id="S4.SS2.p1.7.m6.1.1.3.cmml" xref="S4.SS2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m6.1.1.3.1.cmml" xref="S4.SS2.p1.7.m6.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.7.m6.1.1.3.2.cmml" xref="S4.SS2.p1.7.m6.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.7.m6.1.1.3.3a.cmml" xref="S4.SS2.p1.7.m6.1.1.3.3"><mtext mathsize="70%" id="S4.SS2.p1.7.m6.1.1.3.3.cmml" xref="S4.SS2.p1.7.m6.1.1.3.3">g</mtext></ci></apply><apply id="S4.SS2.p1.7.m6.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.7.m6.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.7.m6.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m6.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.7.m6.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m6.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m6.1c">p_{\text{g}}(y|{\mathbf{x}})</annotation></semantics></math>, the distillation process is unbiased and beneficial. This condition could be basically met in TFL if at least one of the following satisfies: (1) the clients’ data distributions are the same with the global one, i.e., the I.I.D. case; (2) full or higher client participation in Non-I.I.D. case. The latter one explains why FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite> is useful in cross-silo FL scenes. However, with a smaller set of participating clients, and supposing only the <math id="S4.SS2.p1.8.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.8.m7.1a"><mi id="S4.SS2.p1.8.m7.1.1" xref="S4.SS2.p1.8.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m7.1b"><ci id="S4.SS2.p1.8.m7.1.1.cmml" xref="S4.SS2.p1.8.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m7.1c">k</annotation></semantics></math>th client is selected as an extreme case, we actually minimize <math id="S4.SS2.p1.9.m8.5" class="ltx_Math" alttext="\text{KL}(q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))" display="inline"><semantics id="S4.SS2.p1.9.m8.5a"><mrow id="S4.SS2.p1.9.m8.5.5" xref="S4.SS2.p1.9.m8.5.5.cmml"><mtext id="S4.SS2.p1.9.m8.5.5.4" xref="S4.SS2.p1.9.m8.5.5.4a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m8.5.5.3" xref="S4.SS2.p1.9.m8.5.5.3.cmml">​</mo><mrow id="S4.SS2.p1.9.m8.5.5.2.2" xref="S4.SS2.p1.9.m8.5.5.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m8.5.5.2.2.3" xref="S4.SS2.p1.9.m8.5.5.2.3.cmml">(</mo><mrow id="S4.SS2.p1.9.m8.4.4.1.1.1" xref="S4.SS2.p1.9.m8.4.4.1.1.1.cmml"><msub id="S4.SS2.p1.9.m8.4.4.1.1.1.3" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3.cmml"><mi id="S4.SS2.p1.9.m8.4.4.1.1.1.3.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3.2.cmml">q</mi><mi id="S4.SS2.p1.9.m8.4.4.1.1.1.3.3" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m8.4.4.1.1.1.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.3" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.9.m8.1.1" xref="S4.SS2.p1.9.m8.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.3" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.9.m8.5.5.2.2.4" xref="S4.SS2.p1.9.m8.5.5.2.3.cmml">,</mo><mrow id="S4.SS2.p1.9.m8.5.5.2.2.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.cmml"><msub id="S4.SS2.p1.9.m8.5.5.2.2.2.3" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.cmml"><mi id="S4.SS2.p1.9.m8.5.5.2.2.2.3.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.2.cmml">q</mi><mtext id="S4.SS2.p1.9.m8.5.5.2.2.2.3.3" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m8.5.5.2.2.2.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.2.cmml">​</mo><mrow id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.1" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.2" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.1.cmml"><mi id="S4.SS2.p1.9.m8.2.2" xref="S4.SS2.p1.9.m8.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.2.1" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.1.cmml">;</mo><mi id="S4.SS2.p1.9.m8.3.3" xref="S4.SS2.p1.9.m8.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.3" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.9.m8.5.5.2.2.5" xref="S4.SS2.p1.9.m8.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m8.5b"><apply id="S4.SS2.p1.9.m8.5.5.cmml" xref="S4.SS2.p1.9.m8.5.5"><times id="S4.SS2.p1.9.m8.5.5.3.cmml" xref="S4.SS2.p1.9.m8.5.5.3"></times><ci id="S4.SS2.p1.9.m8.5.5.4a.cmml" xref="S4.SS2.p1.9.m8.5.5.4"><mtext id="S4.SS2.p1.9.m8.5.5.4.cmml" xref="S4.SS2.p1.9.m8.5.5.4">KL</mtext></ci><interval closure="open" id="S4.SS2.p1.9.m8.5.5.2.3.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2"><apply id="S4.SS2.p1.9.m8.4.4.1.1.1.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1"><times id="S4.SS2.p1.9.m8.4.4.1.1.1.2.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.2"></times><apply id="S4.SS2.p1.9.m8.4.4.1.1.1.3.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m8.4.4.1.1.1.3.1.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.9.m8.4.4.1.1.1.3.2.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3.2">𝑞</ci><ci id="S4.SS2.p1.9.m8.4.4.1.1.1.3.3.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.3">𝑦</ci><list id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1"><ci id="S4.SS2.p1.9.m8.1.1.cmml" xref="S4.SS2.p1.9.m8.1.1">𝐱</ci><apply id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m8.4.4.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S4.SS2.p1.9.m8.5.5.2.2.2.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2"><times id="S4.SS2.p1.9.m8.5.5.2.2.2.2.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.2"></times><apply id="S4.SS2.p1.9.m8.5.5.2.2.2.3.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m8.5.5.2.2.2.3.1.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.9.m8.5.5.2.2.2.3.2.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.2">𝑞</ci><ci id="S4.SS2.p1.9.m8.5.5.2.2.2.3.3a.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.3"><mtext mathsize="70%" id="S4.SS2.p1.9.m8.5.5.2.2.2.3.3.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.3.3">g</mtext></ci></apply><apply id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.2">𝑦</ci><list id="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p1.9.m8.5.5.2.2.2.1.1.1.3.2"><ci id="S4.SS2.p1.9.m8.2.2.cmml" xref="S4.SS2.p1.9.m8.2.2">𝐱</ci><ci id="S4.SS2.p1.9.m8.3.3.cmml" xref="S4.SS2.p1.9.m8.3.3">𝜃</ci></list></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m8.5c">\text{KL}(q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))</annotation></semantics></math>. Because <math id="S4.SS2.p1.10.m9.2" class="ltx_Math" alttext="q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})" display="inline"><semantics id="S4.SS2.p1.10.m9.2a"><mrow id="S4.SS2.p1.10.m9.2.2" xref="S4.SS2.p1.10.m9.2.2.cmml"><msub id="S4.SS2.p1.10.m9.2.2.3" xref="S4.SS2.p1.10.m9.2.2.3.cmml"><mi id="S4.SS2.p1.10.m9.2.2.3.2" xref="S4.SS2.p1.10.m9.2.2.3.2.cmml">q</mi><mi id="S4.SS2.p1.10.m9.2.2.3.3" xref="S4.SS2.p1.10.m9.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.10.m9.2.2.2" xref="S4.SS2.p1.10.m9.2.2.2.cmml">​</mo><mrow id="S4.SS2.p1.10.m9.2.2.1.1" xref="S4.SS2.p1.10.m9.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m9.2.2.1.1.2" xref="S4.SS2.p1.10.m9.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.10.m9.2.2.1.1.1" xref="S4.SS2.p1.10.m9.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.10.m9.2.2.1.1.1.3" xref="S4.SS2.p1.10.m9.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.SS2.p1.10.m9.2.2.1.1.1.2" xref="S4.SS2.p1.10.m9.2.2.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.10.m9.1.1" xref="S4.SS2.p1.10.m9.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.2" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.2.cmml">;</mo><msub id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.2" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.3" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.10.m9.2.2.1.1.3" xref="S4.SS2.p1.10.m9.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m9.2b"><apply id="S4.SS2.p1.10.m9.2.2.cmml" xref="S4.SS2.p1.10.m9.2.2"><times id="S4.SS2.p1.10.m9.2.2.2.cmml" xref="S4.SS2.p1.10.m9.2.2.2"></times><apply id="S4.SS2.p1.10.m9.2.2.3.cmml" xref="S4.SS2.p1.10.m9.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m9.2.2.3.1.cmml" xref="S4.SS2.p1.10.m9.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.10.m9.2.2.3.2.cmml" xref="S4.SS2.p1.10.m9.2.2.3.2">𝑞</ci><ci id="S4.SS2.p1.10.m9.2.2.3.3.cmml" xref="S4.SS2.p1.10.m9.2.2.3.3">𝑘</ci></apply><apply id="S4.SS2.p1.10.m9.2.2.1.1.1.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.10.m9.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.2">conditional</csymbol><ci id="S4.SS2.p1.10.m9.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.3">𝑦</ci><list id="S4.SS2.p1.10.m9.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1"><ci id="S4.SS2.p1.10.m9.1.1.cmml" xref="S4.SS2.p1.10.m9.1.1">𝐱</ci><apply id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.10.m9.2.2.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m9.2c">q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k})</annotation></semantics></math> is fitted to <math id="S4.SS2.p1.11.m10.1" class="ltx_Math" alttext="p_{k}(y|{\mathbf{x}})" display="inline"><semantics id="S4.SS2.p1.11.m10.1a"><mrow id="S4.SS2.p1.11.m10.1.1" xref="S4.SS2.p1.11.m10.1.1.cmml"><msub id="S4.SS2.p1.11.m10.1.1.3" xref="S4.SS2.p1.11.m10.1.1.3.cmml"><mi id="S4.SS2.p1.11.m10.1.1.3.2" xref="S4.SS2.p1.11.m10.1.1.3.2.cmml">p</mi><mi id="S4.SS2.p1.11.m10.1.1.3.3" xref="S4.SS2.p1.11.m10.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m10.1.1.2" xref="S4.SS2.p1.11.m10.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.11.m10.1.1.1.1" xref="S4.SS2.p1.11.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.11.m10.1.1.1.1.2" xref="S4.SS2.p1.11.m10.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.11.m10.1.1.1.1.1" xref="S4.SS2.p1.11.m10.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.11.m10.1.1.1.1.1.2" xref="S4.SS2.p1.11.m10.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.11.m10.1.1.1.1.1.1" xref="S4.SS2.p1.11.m10.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.11.m10.1.1.1.1.1.3" xref="S4.SS2.p1.11.m10.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.11.m10.1.1.1.1.3" xref="S4.SS2.p1.11.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m10.1b"><apply id="S4.SS2.p1.11.m10.1.1.cmml" xref="S4.SS2.p1.11.m10.1.1"><times id="S4.SS2.p1.11.m10.1.1.2.cmml" xref="S4.SS2.p1.11.m10.1.1.2"></times><apply id="S4.SS2.p1.11.m10.1.1.3.cmml" xref="S4.SS2.p1.11.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m10.1.1.3.1.cmml" xref="S4.SS2.p1.11.m10.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.11.m10.1.1.3.2.cmml" xref="S4.SS2.p1.11.m10.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.11.m10.1.1.3.3.cmml" xref="S4.SS2.p1.11.m10.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.p1.11.m10.1.1.1.1.1.cmml" xref="S4.SS2.p1.11.m10.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.11.m10.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.11.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.11.m10.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.11.m10.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.11.m10.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.11.m10.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m10.1c">p_{k}(y|{\mathbf{x}})</annotation></semantics></math> and <math id="S4.SS2.p1.12.m11.3" class="ltx_Math" alttext="p_{k}(y|{\mathbf{x}})\propto p_{k}(y)p_{k}({\mathbf{x}}|y)" display="inline"><semantics id="S4.SS2.p1.12.m11.3a"><mrow id="S4.SS2.p1.12.m11.3.3" xref="S4.SS2.p1.12.m11.3.3.cmml"><mrow id="S4.SS2.p1.12.m11.2.2.1" xref="S4.SS2.p1.12.m11.2.2.1.cmml"><msub id="S4.SS2.p1.12.m11.2.2.1.3" xref="S4.SS2.p1.12.m11.2.2.1.3.cmml"><mi id="S4.SS2.p1.12.m11.2.2.1.3.2" xref="S4.SS2.p1.12.m11.2.2.1.3.2.cmml">p</mi><mi id="S4.SS2.p1.12.m11.2.2.1.3.3" xref="S4.SS2.p1.12.m11.2.2.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m11.2.2.1.2" xref="S4.SS2.p1.12.m11.2.2.1.2.cmml">​</mo><mrow id="S4.SS2.p1.12.m11.2.2.1.1.1" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.12.m11.2.2.1.1.1.2" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.12.m11.2.2.1.1.1.1" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.12.m11.2.2.1.1.1.1.2" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS2.p1.12.m11.2.2.1.1.1.1.1" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.12.m11.2.2.1.1.1.1.3" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS2.p1.12.m11.2.2.1.1.1.3" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.12.m11.3.3.3" xref="S4.SS2.p1.12.m11.3.3.3.cmml">∝</mo><mrow id="S4.SS2.p1.12.m11.3.3.2" xref="S4.SS2.p1.12.m11.3.3.2.cmml"><msub id="S4.SS2.p1.12.m11.3.3.2.3" xref="S4.SS2.p1.12.m11.3.3.2.3.cmml"><mi id="S4.SS2.p1.12.m11.3.3.2.3.2" xref="S4.SS2.p1.12.m11.3.3.2.3.2.cmml">p</mi><mi id="S4.SS2.p1.12.m11.3.3.2.3.3" xref="S4.SS2.p1.12.m11.3.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m11.3.3.2.2" xref="S4.SS2.p1.12.m11.3.3.2.2.cmml">​</mo><mrow id="S4.SS2.p1.12.m11.3.3.2.4.2" xref="S4.SS2.p1.12.m11.3.3.2.cmml"><mo stretchy="false" id="S4.SS2.p1.12.m11.3.3.2.4.2.1" xref="S4.SS2.p1.12.m11.3.3.2.cmml">(</mo><mi id="S4.SS2.p1.12.m11.1.1" xref="S4.SS2.p1.12.m11.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.12.m11.3.3.2.4.2.2" xref="S4.SS2.p1.12.m11.3.3.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m11.3.3.2.2a" xref="S4.SS2.p1.12.m11.3.3.2.2.cmml">​</mo><msub id="S4.SS2.p1.12.m11.3.3.2.5" xref="S4.SS2.p1.12.m11.3.3.2.5.cmml"><mi id="S4.SS2.p1.12.m11.3.3.2.5.2" xref="S4.SS2.p1.12.m11.3.3.2.5.2.cmml">p</mi><mi id="S4.SS2.p1.12.m11.3.3.2.5.3" xref="S4.SS2.p1.12.m11.3.3.2.5.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m11.3.3.2.2b" xref="S4.SS2.p1.12.m11.3.3.2.2.cmml">​</mo><mrow id="S4.SS2.p1.12.m11.3.3.2.1.1" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.12.m11.3.3.2.1.1.2" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.12.m11.3.3.2.1.1.1" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.cmml"><mi id="S4.SS2.p1.12.m11.3.3.2.1.1.1.2" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S4.SS2.p1.12.m11.3.3.2.1.1.1.1" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p1.12.m11.3.3.2.1.1.1.3" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S4.SS2.p1.12.m11.3.3.2.1.1.3" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m11.3b"><apply id="S4.SS2.p1.12.m11.3.3.cmml" xref="S4.SS2.p1.12.m11.3.3"><csymbol cd="latexml" id="S4.SS2.p1.12.m11.3.3.3.cmml" xref="S4.SS2.p1.12.m11.3.3.3">proportional-to</csymbol><apply id="S4.SS2.p1.12.m11.2.2.1.cmml" xref="S4.SS2.p1.12.m11.2.2.1"><times id="S4.SS2.p1.12.m11.2.2.1.2.cmml" xref="S4.SS2.p1.12.m11.2.2.1.2"></times><apply id="S4.SS2.p1.12.m11.2.2.1.3.cmml" xref="S4.SS2.p1.12.m11.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m11.2.2.1.3.1.cmml" xref="S4.SS2.p1.12.m11.2.2.1.3">subscript</csymbol><ci id="S4.SS2.p1.12.m11.2.2.1.3.2.cmml" xref="S4.SS2.p1.12.m11.2.2.1.3.2">𝑝</ci><ci id="S4.SS2.p1.12.m11.2.2.1.3.3.cmml" xref="S4.SS2.p1.12.m11.2.2.1.3.3">𝑘</ci></apply><apply id="S4.SS2.p1.12.m11.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.12.m11.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.12.m11.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.12.m11.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p1.12.m11.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.12.m11.2.2.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS2.p1.12.m11.3.3.2.cmml" xref="S4.SS2.p1.12.m11.3.3.2"><times id="S4.SS2.p1.12.m11.3.3.2.2.cmml" xref="S4.SS2.p1.12.m11.3.3.2.2"></times><apply id="S4.SS2.p1.12.m11.3.3.2.3.cmml" xref="S4.SS2.p1.12.m11.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m11.3.3.2.3.1.cmml" xref="S4.SS2.p1.12.m11.3.3.2.3">subscript</csymbol><ci id="S4.SS2.p1.12.m11.3.3.2.3.2.cmml" xref="S4.SS2.p1.12.m11.3.3.2.3.2">𝑝</ci><ci id="S4.SS2.p1.12.m11.3.3.2.3.3.cmml" xref="S4.SS2.p1.12.m11.3.3.2.3.3">𝑘</ci></apply><ci id="S4.SS2.p1.12.m11.1.1.cmml" xref="S4.SS2.p1.12.m11.1.1">𝑦</ci><apply id="S4.SS2.p1.12.m11.3.3.2.5.cmml" xref="S4.SS2.p1.12.m11.3.3.2.5"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m11.3.3.2.5.1.cmml" xref="S4.SS2.p1.12.m11.3.3.2.5">subscript</csymbol><ci id="S4.SS2.p1.12.m11.3.3.2.5.2.cmml" xref="S4.SS2.p1.12.m11.3.3.2.5.2">𝑝</ci><ci id="S4.SS2.p1.12.m11.3.3.2.5.3.cmml" xref="S4.SS2.p1.12.m11.3.3.2.5.3">𝑘</ci></apply><apply id="S4.SS2.p1.12.m11.3.3.2.1.1.1.cmml" xref="S4.SS2.p1.12.m11.3.3.2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.12.m11.3.3.2.1.1.1.1.cmml" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p1.12.m11.3.3.2.1.1.1.2.cmml" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.2">𝐱</ci><ci id="S4.SS2.p1.12.m11.3.3.2.1.1.1.3.cmml" xref="S4.SS2.p1.12.m11.3.3.2.1.1.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m11.3c">p_{k}(y|{\mathbf{x}})\propto p_{k}(y)p_{k}({\mathbf{x}}|y)</annotation></semantics></math>, the distillation implicitly biases the global model <math id="S4.SS2.p1.13.m12.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS2.p1.13.m12.1a"><mi id="S4.SS2.p1.13.m12.1.1" xref="S4.SS2.p1.13.m12.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m12.1b"><ci id="S4.SS2.p1.13.m12.1.1.cmml" xref="S4.SS2.p1.13.m12.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m12.1c">\theta</annotation></semantics></math> to the <math id="S4.SS2.p1.14.m13.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.14.m13.1a"><mi id="S4.SS2.p1.14.m13.1.1" xref="S4.SS2.p1.14.m13.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m13.1b"><ci id="S4.SS2.p1.14.m13.1.1.cmml" xref="S4.SS2.p1.14.m13.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m13.1c">k</annotation></semantics></math>th client’s prior distribution <math id="S4.SS2.p1.15.m14.1" class="ltx_Math" alttext="p_{k}(y)" display="inline"><semantics id="S4.SS2.p1.15.m14.1a"><mrow id="S4.SS2.p1.15.m14.1.2" xref="S4.SS2.p1.15.m14.1.2.cmml"><msub id="S4.SS2.p1.15.m14.1.2.2" xref="S4.SS2.p1.15.m14.1.2.2.cmml"><mi id="S4.SS2.p1.15.m14.1.2.2.2" xref="S4.SS2.p1.15.m14.1.2.2.2.cmml">p</mi><mi id="S4.SS2.p1.15.m14.1.2.2.3" xref="S4.SS2.p1.15.m14.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.15.m14.1.2.1" xref="S4.SS2.p1.15.m14.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.15.m14.1.2.3.2" xref="S4.SS2.p1.15.m14.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.15.m14.1.2.3.2.1" xref="S4.SS2.p1.15.m14.1.2.cmml">(</mo><mi id="S4.SS2.p1.15.m14.1.1" xref="S4.SS2.p1.15.m14.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.15.m14.1.2.3.2.2" xref="S4.SS2.p1.15.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m14.1b"><apply id="S4.SS2.p1.15.m14.1.2.cmml" xref="S4.SS2.p1.15.m14.1.2"><times id="S4.SS2.p1.15.m14.1.2.1.cmml" xref="S4.SS2.p1.15.m14.1.2.1"></times><apply id="S4.SS2.p1.15.m14.1.2.2.cmml" xref="S4.SS2.p1.15.m14.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.15.m14.1.2.2.1.cmml" xref="S4.SS2.p1.15.m14.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.15.m14.1.2.2.2.cmml" xref="S4.SS2.p1.15.m14.1.2.2.2">𝑝</ci><ci id="S4.SS2.p1.15.m14.1.2.2.3.cmml" xref="S4.SS2.p1.15.m14.1.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p1.15.m14.1.1.cmml" xref="S4.SS2.p1.15.m14.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m14.1c">p_{k}(y)</annotation></semantics></math>. Similarly, with a set of clients <math id="S4.SS2.p1.16.m15.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS2.p1.16.m15.1a"><mi id="S4.SS2.p1.16.m15.1.1" xref="S4.SS2.p1.16.m15.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m15.1b"><ci id="S4.SS2.p1.16.m15.1.1.cmml" xref="S4.SS2.p1.16.m15.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m15.1c">S</annotation></semantics></math>, the aggregated model will be updated towards <math id="S4.SS2.p1.17.m16.1" class="ltx_Math" alttext="\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}p_{k}(y)" display="inline"><semantics id="S4.SS2.p1.17.m16.1a"><mrow id="S4.SS2.p1.17.m16.1.2" xref="S4.SS2.p1.17.m16.1.2.cmml"><msub id="S4.SS2.p1.17.m16.1.2.1" xref="S4.SS2.p1.17.m16.1.2.1.cmml"><mo id="S4.SS2.p1.17.m16.1.2.1.2" xref="S4.SS2.p1.17.m16.1.2.1.2.cmml">∑</mo><mrow id="S4.SS2.p1.17.m16.1.2.1.3" xref="S4.SS2.p1.17.m16.1.2.1.3.cmml"><mi id="S4.SS2.p1.17.m16.1.2.1.3.2" xref="S4.SS2.p1.17.m16.1.2.1.3.2.cmml">k</mi><mo id="S4.SS2.p1.17.m16.1.2.1.3.1" xref="S4.SS2.p1.17.m16.1.2.1.3.1.cmml">∈</mo><mi id="S4.SS2.p1.17.m16.1.2.1.3.3" xref="S4.SS2.p1.17.m16.1.2.1.3.3.cmml">S</mi></mrow></msub><mrow id="S4.SS2.p1.17.m16.1.2.2" xref="S4.SS2.p1.17.m16.1.2.2.cmml"><mfrac id="S4.SS2.p1.17.m16.1.2.2.2" xref="S4.SS2.p1.17.m16.1.2.2.2.cmml"><msub id="S4.SS2.p1.17.m16.1.2.2.2.2" xref="S4.SS2.p1.17.m16.1.2.2.2.2.cmml"><mi id="S4.SS2.p1.17.m16.1.2.2.2.2.2" xref="S4.SS2.p1.17.m16.1.2.2.2.2.2.cmml">w</mi><mi id="S4.SS2.p1.17.m16.1.2.2.2.2.3" xref="S4.SS2.p1.17.m16.1.2.2.2.2.3.cmml">k</mi></msub><mrow id="S4.SS2.p1.17.m16.1.2.2.2.3" xref="S4.SS2.p1.17.m16.1.2.2.2.3.cmml"><mstyle displaystyle="false" id="S4.SS2.p1.17.m16.1.2.2.2.3.1" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.cmml"><msub id="S4.SS2.p1.17.m16.1.2.2.2.3.1a" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.cmml"><mo id="S4.SS2.p1.17.m16.1.2.2.2.3.1.2" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.2.cmml">∑</mo><mrow id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.cmml"><mi id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.2" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.2.cmml">j</mi><mo id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.1" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.1.cmml">∈</mo><mi id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.3" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.3.cmml">S</mi></mrow></msub></mstyle><msub id="S4.SS2.p1.17.m16.1.2.2.2.3.2" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2.cmml"><mi id="S4.SS2.p1.17.m16.1.2.2.2.3.2.2" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2.2.cmml">w</mi><mi id="S4.SS2.p1.17.m16.1.2.2.2.3.2.3" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p1.17.m16.1.2.2.1" xref="S4.SS2.p1.17.m16.1.2.2.1.cmml">​</mo><msub id="S4.SS2.p1.17.m16.1.2.2.3" xref="S4.SS2.p1.17.m16.1.2.2.3.cmml"><mi id="S4.SS2.p1.17.m16.1.2.2.3.2" xref="S4.SS2.p1.17.m16.1.2.2.3.2.cmml">p</mi><mi id="S4.SS2.p1.17.m16.1.2.2.3.3" xref="S4.SS2.p1.17.m16.1.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.17.m16.1.2.2.1a" xref="S4.SS2.p1.17.m16.1.2.2.1.cmml">​</mo><mrow id="S4.SS2.p1.17.m16.1.2.2.4.2" xref="S4.SS2.p1.17.m16.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.17.m16.1.2.2.4.2.1" xref="S4.SS2.p1.17.m16.1.2.2.cmml">(</mo><mi id="S4.SS2.p1.17.m16.1.1" xref="S4.SS2.p1.17.m16.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.17.m16.1.2.2.4.2.2" xref="S4.SS2.p1.17.m16.1.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.17.m16.1b"><apply id="S4.SS2.p1.17.m16.1.2.cmml" xref="S4.SS2.p1.17.m16.1.2"><apply id="S4.SS2.p1.17.m16.1.2.1.cmml" xref="S4.SS2.p1.17.m16.1.2.1"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m16.1.2.1.1.cmml" xref="S4.SS2.p1.17.m16.1.2.1">subscript</csymbol><sum id="S4.SS2.p1.17.m16.1.2.1.2.cmml" xref="S4.SS2.p1.17.m16.1.2.1.2"></sum><apply id="S4.SS2.p1.17.m16.1.2.1.3.cmml" xref="S4.SS2.p1.17.m16.1.2.1.3"><in id="S4.SS2.p1.17.m16.1.2.1.3.1.cmml" xref="S4.SS2.p1.17.m16.1.2.1.3.1"></in><ci id="S4.SS2.p1.17.m16.1.2.1.3.2.cmml" xref="S4.SS2.p1.17.m16.1.2.1.3.2">𝑘</ci><ci id="S4.SS2.p1.17.m16.1.2.1.3.3.cmml" xref="S4.SS2.p1.17.m16.1.2.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.17.m16.1.2.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2"><times id="S4.SS2.p1.17.m16.1.2.2.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.1"></times><apply id="S4.SS2.p1.17.m16.1.2.2.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2"><divide id="S4.SS2.p1.17.m16.1.2.2.2.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2"></divide><apply id="S4.SS2.p1.17.m16.1.2.2.2.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m16.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.17.m16.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.2.2">𝑤</ci><ci id="S4.SS2.p1.17.m16.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.2.3">𝑘</ci></apply><apply id="S4.SS2.p1.17.m16.1.2.2.2.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3"><apply id="S4.SS2.p1.17.m16.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m16.1.2.2.2.3.1.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1">subscript</csymbol><sum id="S4.SS2.p1.17.m16.1.2.2.2.3.1.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.2"></sum><apply id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3"><in id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.1"></in><ci id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.2">𝑗</ci><ci id="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.17.m16.1.2.2.2.3.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m16.1.2.2.2.3.2.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2">subscript</csymbol><ci id="S4.SS2.p1.17.m16.1.2.2.2.3.2.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2.2">𝑤</ci><ci id="S4.SS2.p1.17.m16.1.2.2.2.3.2.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S4.SS2.p1.17.m16.1.2.2.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m16.1.2.2.3.1.cmml" xref="S4.SS2.p1.17.m16.1.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.17.m16.1.2.2.3.2.cmml" xref="S4.SS2.p1.17.m16.1.2.2.3.2">𝑝</ci><ci id="S4.SS2.p1.17.m16.1.2.2.3.3.cmml" xref="S4.SS2.p1.17.m16.1.2.2.3.3">𝑘</ci></apply><ci id="S4.SS2.p1.17.m16.1.1.cmml" xref="S4.SS2.p1.17.m16.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.17.m16.1c">\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}p_{k}(y)</annotation></semantics></math>. <span id="S4.SS2.p1.19.2" class="ltx_text ltx_font_italic">In Non-I.I.D. cases, <math id="S4.SS2.p1.18.1.m1.1" class="ltx_Math" alttext="\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}p_{k}(y)" display="inline"><semantics id="S4.SS2.p1.18.1.m1.1a"><mrow id="S4.SS2.p1.18.1.m1.1.2" xref="S4.SS2.p1.18.1.m1.1.2.cmml"><msub id="S4.SS2.p1.18.1.m1.1.2.1" xref="S4.SS2.p1.18.1.m1.1.2.1.cmml"><mo id="S4.SS2.p1.18.1.m1.1.2.1.2" xref="S4.SS2.p1.18.1.m1.1.2.1.2.cmml">∑</mo><mrow id="S4.SS2.p1.18.1.m1.1.2.1.3" xref="S4.SS2.p1.18.1.m1.1.2.1.3.cmml"><mi id="S4.SS2.p1.18.1.m1.1.2.1.3.2" xref="S4.SS2.p1.18.1.m1.1.2.1.3.2.cmml">k</mi><mo id="S4.SS2.p1.18.1.m1.1.2.1.3.1" xref="S4.SS2.p1.18.1.m1.1.2.1.3.1.cmml">∈</mo><mi id="S4.SS2.p1.18.1.m1.1.2.1.3.3" xref="S4.SS2.p1.18.1.m1.1.2.1.3.3.cmml">S</mi></mrow></msub><mrow id="S4.SS2.p1.18.1.m1.1.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.cmml"><mfrac id="S4.SS2.p1.18.1.m1.1.2.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.cmml"><msub id="S4.SS2.p1.18.1.m1.1.2.2.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2.cmml"><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2.2.cmml">w</mi><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.2.3" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2.3.cmml">k</mi></msub><mrow id="S4.SS2.p1.18.1.m1.1.2.2.2.3" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.cmml"><mstyle displaystyle="false" id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.cmml"><msub id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1a" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.cmml"><mo id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.2.cmml">∑</mo><mrow id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.cmml"><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.2.cmml">j</mi><mo id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.1" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.1.cmml">∈</mo><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.3" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.3.cmml">S</mi></mrow></msub></mstyle><msub id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.cmml"><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.2.cmml">w</mi><mi id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.3" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p1.18.1.m1.1.2.2.1" xref="S4.SS2.p1.18.1.m1.1.2.2.1.cmml">​</mo><msub id="S4.SS2.p1.18.1.m1.1.2.2.3" xref="S4.SS2.p1.18.1.m1.1.2.2.3.cmml"><mi id="S4.SS2.p1.18.1.m1.1.2.2.3.2" xref="S4.SS2.p1.18.1.m1.1.2.2.3.2.cmml">p</mi><mi id="S4.SS2.p1.18.1.m1.1.2.2.3.3" xref="S4.SS2.p1.18.1.m1.1.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.18.1.m1.1.2.2.1a" xref="S4.SS2.p1.18.1.m1.1.2.2.1.cmml">​</mo><mrow id="S4.SS2.p1.18.1.m1.1.2.2.4.2" xref="S4.SS2.p1.18.1.m1.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.18.1.m1.1.2.2.4.2.1" xref="S4.SS2.p1.18.1.m1.1.2.2.cmml">(</mo><mi id="S4.SS2.p1.18.1.m1.1.1" xref="S4.SS2.p1.18.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.18.1.m1.1.2.2.4.2.2" xref="S4.SS2.p1.18.1.m1.1.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.18.1.m1.1b"><apply id="S4.SS2.p1.18.1.m1.1.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2"><apply id="S4.SS2.p1.18.1.m1.1.2.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1"><csymbol cd="ambiguous" id="S4.SS2.p1.18.1.m1.1.2.1.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1">subscript</csymbol><sum id="S4.SS2.p1.18.1.m1.1.2.1.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1.2"></sum><apply id="S4.SS2.p1.18.1.m1.1.2.1.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1.3"><in id="S4.SS2.p1.18.1.m1.1.2.1.3.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1.3.1"></in><ci id="S4.SS2.p1.18.1.m1.1.2.1.3.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1.3.2">𝑘</ci><ci id="S4.SS2.p1.18.1.m1.1.2.1.3.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.18.1.m1.1.2.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2"><times id="S4.SS2.p1.18.1.m1.1.2.2.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.1"></times><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2"><divide id="S4.SS2.p1.18.1.m1.1.2.2.2.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2"></divide><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.18.1.m1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2.2">𝑤</ci><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.2.3">𝑘</ci></apply><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3"><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1">subscript</csymbol><sum id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.2"></sum><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3"><in id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.1"></in><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.2">𝑗</ci><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2">subscript</csymbol><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.2">𝑤</ci><ci id="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S4.SS2.p1.18.1.m1.1.2.2.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.18.1.m1.1.2.2.3.1.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.18.1.m1.1.2.2.3.2.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.3.2">𝑝</ci><ci id="S4.SS2.p1.18.1.m1.1.2.2.3.3.cmml" xref="S4.SS2.p1.18.1.m1.1.2.2.3.3">𝑘</ci></apply><ci id="S4.SS2.p1.18.1.m1.1.1.cmml" xref="S4.SS2.p1.18.1.m1.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.18.1.m1.1c">\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}p_{k}(y)</annotation></semantics></math> is not guaranteed to cover proper probabilities for all classes and experiences high variance with smaller set of <math id="S4.SS2.p1.19.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS2.p1.19.2.m2.1a"><mi id="S4.SS2.p1.19.2.m2.1.1" xref="S4.SS2.p1.19.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.19.2.m2.1b"><ci id="S4.SS2.p1.19.2.m2.1.1.cmml" xref="S4.SS2.p1.19.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.19.2.m2.1c">S</annotation></semantics></math>.</span> For example, we have <math id="S4.SS2.p1.20.m17.1" class="ltx_Math" alttext="C=4" display="inline"><semantics id="S4.SS2.p1.20.m17.1a"><mrow id="S4.SS2.p1.20.m17.1.1" xref="S4.SS2.p1.20.m17.1.1.cmml"><mi id="S4.SS2.p1.20.m17.1.1.2" xref="S4.SS2.p1.20.m17.1.1.2.cmml">C</mi><mo id="S4.SS2.p1.20.m17.1.1.1" xref="S4.SS2.p1.20.m17.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.20.m17.1.1.3" xref="S4.SS2.p1.20.m17.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.20.m17.1b"><apply id="S4.SS2.p1.20.m17.1.1.cmml" xref="S4.SS2.p1.20.m17.1.1"><eq id="S4.SS2.p1.20.m17.1.1.1.cmml" xref="S4.SS2.p1.20.m17.1.1.1"></eq><ci id="S4.SS2.p1.20.m17.1.1.2.cmml" xref="S4.SS2.p1.20.m17.1.1.2">𝐶</ci><cn type="integer" id="S4.SS2.p1.20.m17.1.1.3.cmml" xref="S4.SS2.p1.20.m17.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.20.m17.1c">C=4</annotation></semantics></math> classes and select <math id="S4.SS2.p1.21.m18.2" class="ltx_Math" alttext="S=\{1,2\}" display="inline"><semantics id="S4.SS2.p1.21.m18.2a"><mrow id="S4.SS2.p1.21.m18.2.3" xref="S4.SS2.p1.21.m18.2.3.cmml"><mi id="S4.SS2.p1.21.m18.2.3.2" xref="S4.SS2.p1.21.m18.2.3.2.cmml">S</mi><mo id="S4.SS2.p1.21.m18.2.3.1" xref="S4.SS2.p1.21.m18.2.3.1.cmml">=</mo><mrow id="S4.SS2.p1.21.m18.2.3.3.2" xref="S4.SS2.p1.21.m18.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.21.m18.2.3.3.2.1" xref="S4.SS2.p1.21.m18.2.3.3.1.cmml">{</mo><mn id="S4.SS2.p1.21.m18.1.1" xref="S4.SS2.p1.21.m18.1.1.cmml">1</mn><mo id="S4.SS2.p1.21.m18.2.3.3.2.2" xref="S4.SS2.p1.21.m18.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p1.21.m18.2.2" xref="S4.SS2.p1.21.m18.2.2.cmml">2</mn><mo stretchy="false" id="S4.SS2.p1.21.m18.2.3.3.2.3" xref="S4.SS2.p1.21.m18.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.21.m18.2b"><apply id="S4.SS2.p1.21.m18.2.3.cmml" xref="S4.SS2.p1.21.m18.2.3"><eq id="S4.SS2.p1.21.m18.2.3.1.cmml" xref="S4.SS2.p1.21.m18.2.3.1"></eq><ci id="S4.SS2.p1.21.m18.2.3.2.cmml" xref="S4.SS2.p1.21.m18.2.3.2">𝑆</ci><set id="S4.SS2.p1.21.m18.2.3.3.1.cmml" xref="S4.SS2.p1.21.m18.2.3.3.2"><cn type="integer" id="S4.SS2.p1.21.m18.1.1.cmml" xref="S4.SS2.p1.21.m18.1.1">1</cn><cn type="integer" id="S4.SS2.p1.21.m18.2.2.cmml" xref="S4.SS2.p1.21.m18.2.2">2</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.21.m18.2c">S=\{1,2\}</annotation></semantics></math> with <math id="S4.SS2.p1.22.m19.5" class="ltx_Math" alttext="p_{1}(y)=[0.5,0.5,0.0,0.0]" display="inline"><semantics id="S4.SS2.p1.22.m19.5a"><mrow id="S4.SS2.p1.22.m19.5.6" xref="S4.SS2.p1.22.m19.5.6.cmml"><mrow id="S4.SS2.p1.22.m19.5.6.2" xref="S4.SS2.p1.22.m19.5.6.2.cmml"><msub id="S4.SS2.p1.22.m19.5.6.2.2" xref="S4.SS2.p1.22.m19.5.6.2.2.cmml"><mi id="S4.SS2.p1.22.m19.5.6.2.2.2" xref="S4.SS2.p1.22.m19.5.6.2.2.2.cmml">p</mi><mn id="S4.SS2.p1.22.m19.5.6.2.2.3" xref="S4.SS2.p1.22.m19.5.6.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.22.m19.5.6.2.1" xref="S4.SS2.p1.22.m19.5.6.2.1.cmml">​</mo><mrow id="S4.SS2.p1.22.m19.5.6.2.3.2" xref="S4.SS2.p1.22.m19.5.6.2.cmml"><mo stretchy="false" id="S4.SS2.p1.22.m19.5.6.2.3.2.1" xref="S4.SS2.p1.22.m19.5.6.2.cmml">(</mo><mi id="S4.SS2.p1.22.m19.1.1" xref="S4.SS2.p1.22.m19.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.22.m19.5.6.2.3.2.2" xref="S4.SS2.p1.22.m19.5.6.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.22.m19.5.6.1" xref="S4.SS2.p1.22.m19.5.6.1.cmml">=</mo><mrow id="S4.SS2.p1.22.m19.5.6.3.2" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.22.m19.5.6.3.2.1" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml">[</mo><mn id="S4.SS2.p1.22.m19.2.2" xref="S4.SS2.p1.22.m19.2.2.cmml">0.5</mn><mo id="S4.SS2.p1.22.m19.5.6.3.2.2" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.22.m19.3.3" xref="S4.SS2.p1.22.m19.3.3.cmml">0.5</mn><mo id="S4.SS2.p1.22.m19.5.6.3.2.3" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.22.m19.4.4" xref="S4.SS2.p1.22.m19.4.4.cmml">0.0</mn><mo id="S4.SS2.p1.22.m19.5.6.3.2.4" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.22.m19.5.5" xref="S4.SS2.p1.22.m19.5.5.cmml">0.0</mn><mo stretchy="false" id="S4.SS2.p1.22.m19.5.6.3.2.5" xref="S4.SS2.p1.22.m19.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.22.m19.5b"><apply id="S4.SS2.p1.22.m19.5.6.cmml" xref="S4.SS2.p1.22.m19.5.6"><eq id="S4.SS2.p1.22.m19.5.6.1.cmml" xref="S4.SS2.p1.22.m19.5.6.1"></eq><apply id="S4.SS2.p1.22.m19.5.6.2.cmml" xref="S4.SS2.p1.22.m19.5.6.2"><times id="S4.SS2.p1.22.m19.5.6.2.1.cmml" xref="S4.SS2.p1.22.m19.5.6.2.1"></times><apply id="S4.SS2.p1.22.m19.5.6.2.2.cmml" xref="S4.SS2.p1.22.m19.5.6.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.22.m19.5.6.2.2.1.cmml" xref="S4.SS2.p1.22.m19.5.6.2.2">subscript</csymbol><ci id="S4.SS2.p1.22.m19.5.6.2.2.2.cmml" xref="S4.SS2.p1.22.m19.5.6.2.2.2">𝑝</ci><cn type="integer" id="S4.SS2.p1.22.m19.5.6.2.2.3.cmml" xref="S4.SS2.p1.22.m19.5.6.2.2.3">1</cn></apply><ci id="S4.SS2.p1.22.m19.1.1.cmml" xref="S4.SS2.p1.22.m19.1.1">𝑦</ci></apply><list id="S4.SS2.p1.22.m19.5.6.3.1.cmml" xref="S4.SS2.p1.22.m19.5.6.3.2"><cn type="float" id="S4.SS2.p1.22.m19.2.2.cmml" xref="S4.SS2.p1.22.m19.2.2">0.5</cn><cn type="float" id="S4.SS2.p1.22.m19.3.3.cmml" xref="S4.SS2.p1.22.m19.3.3">0.5</cn><cn type="float" id="S4.SS2.p1.22.m19.4.4.cmml" xref="S4.SS2.p1.22.m19.4.4">0.0</cn><cn type="float" id="S4.SS2.p1.22.m19.5.5.cmml" xref="S4.SS2.p1.22.m19.5.5">0.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.22.m19.5c">p_{1}(y)=[0.5,0.5,0.0,0.0]</annotation></semantics></math> and <math id="S4.SS2.p1.23.m20.5" class="ltx_Math" alttext="p_{2}(y)=[0.5,0.0,0.5,0.0]" display="inline"><semantics id="S4.SS2.p1.23.m20.5a"><mrow id="S4.SS2.p1.23.m20.5.6" xref="S4.SS2.p1.23.m20.5.6.cmml"><mrow id="S4.SS2.p1.23.m20.5.6.2" xref="S4.SS2.p1.23.m20.5.6.2.cmml"><msub id="S4.SS2.p1.23.m20.5.6.2.2" xref="S4.SS2.p1.23.m20.5.6.2.2.cmml"><mi id="S4.SS2.p1.23.m20.5.6.2.2.2" xref="S4.SS2.p1.23.m20.5.6.2.2.2.cmml">p</mi><mn id="S4.SS2.p1.23.m20.5.6.2.2.3" xref="S4.SS2.p1.23.m20.5.6.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.23.m20.5.6.2.1" xref="S4.SS2.p1.23.m20.5.6.2.1.cmml">​</mo><mrow id="S4.SS2.p1.23.m20.5.6.2.3.2" xref="S4.SS2.p1.23.m20.5.6.2.cmml"><mo stretchy="false" id="S4.SS2.p1.23.m20.5.6.2.3.2.1" xref="S4.SS2.p1.23.m20.5.6.2.cmml">(</mo><mi id="S4.SS2.p1.23.m20.1.1" xref="S4.SS2.p1.23.m20.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.23.m20.5.6.2.3.2.2" xref="S4.SS2.p1.23.m20.5.6.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.23.m20.5.6.1" xref="S4.SS2.p1.23.m20.5.6.1.cmml">=</mo><mrow id="S4.SS2.p1.23.m20.5.6.3.2" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.23.m20.5.6.3.2.1" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml">[</mo><mn id="S4.SS2.p1.23.m20.2.2" xref="S4.SS2.p1.23.m20.2.2.cmml">0.5</mn><mo id="S4.SS2.p1.23.m20.5.6.3.2.2" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.23.m20.3.3" xref="S4.SS2.p1.23.m20.3.3.cmml">0.0</mn><mo id="S4.SS2.p1.23.m20.5.6.3.2.3" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.23.m20.4.4" xref="S4.SS2.p1.23.m20.4.4.cmml">0.5</mn><mo id="S4.SS2.p1.23.m20.5.6.3.2.4" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml">,</mo><mn id="S4.SS2.p1.23.m20.5.5" xref="S4.SS2.p1.23.m20.5.5.cmml">0.0</mn><mo stretchy="false" id="S4.SS2.p1.23.m20.5.6.3.2.5" xref="S4.SS2.p1.23.m20.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.23.m20.5b"><apply id="S4.SS2.p1.23.m20.5.6.cmml" xref="S4.SS2.p1.23.m20.5.6"><eq id="S4.SS2.p1.23.m20.5.6.1.cmml" xref="S4.SS2.p1.23.m20.5.6.1"></eq><apply id="S4.SS2.p1.23.m20.5.6.2.cmml" xref="S4.SS2.p1.23.m20.5.6.2"><times id="S4.SS2.p1.23.m20.5.6.2.1.cmml" xref="S4.SS2.p1.23.m20.5.6.2.1"></times><apply id="S4.SS2.p1.23.m20.5.6.2.2.cmml" xref="S4.SS2.p1.23.m20.5.6.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.23.m20.5.6.2.2.1.cmml" xref="S4.SS2.p1.23.m20.5.6.2.2">subscript</csymbol><ci id="S4.SS2.p1.23.m20.5.6.2.2.2.cmml" xref="S4.SS2.p1.23.m20.5.6.2.2.2">𝑝</ci><cn type="integer" id="S4.SS2.p1.23.m20.5.6.2.2.3.cmml" xref="S4.SS2.p1.23.m20.5.6.2.2.3">2</cn></apply><ci id="S4.SS2.p1.23.m20.1.1.cmml" xref="S4.SS2.p1.23.m20.1.1">𝑦</ci></apply><list id="S4.SS2.p1.23.m20.5.6.3.1.cmml" xref="S4.SS2.p1.23.m20.5.6.3.2"><cn type="float" id="S4.SS2.p1.23.m20.2.2.cmml" xref="S4.SS2.p1.23.m20.2.2">0.5</cn><cn type="float" id="S4.SS2.p1.23.m20.3.3.cmml" xref="S4.SS2.p1.23.m20.3.3">0.0</cn><cn type="float" id="S4.SS2.p1.23.m20.4.4.cmml" xref="S4.SS2.p1.23.m20.4.4">0.5</cn><cn type="float" id="S4.SS2.p1.23.m20.5.5.cmml" xref="S4.SS2.p1.23.m20.5.5">0.0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.23.m20.5c">p_{2}(y)=[0.5,0.0,0.5,0.0]</annotation></semantics></math>. We use uniform weights. Then the distillation process will be biased towards the distribution <math id="S4.SS2.p1.24.m21.4" class="ltx_Math" alttext="[0.5,0.25,0.25,0.0]" display="inline"><semantics id="S4.SS2.p1.24.m21.4a"><mrow id="S4.SS2.p1.24.m21.4.5.2" xref="S4.SS2.p1.24.m21.4.5.1.cmml"><mo stretchy="false" id="S4.SS2.p1.24.m21.4.5.2.1" xref="S4.SS2.p1.24.m21.4.5.1.cmml">[</mo><mn id="S4.SS2.p1.24.m21.1.1" xref="S4.SS2.p1.24.m21.1.1.cmml">0.5</mn><mo id="S4.SS2.p1.24.m21.4.5.2.2" xref="S4.SS2.p1.24.m21.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.24.m21.2.2" xref="S4.SS2.p1.24.m21.2.2.cmml">0.25</mn><mo id="S4.SS2.p1.24.m21.4.5.2.3" xref="S4.SS2.p1.24.m21.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.24.m21.3.3" xref="S4.SS2.p1.24.m21.3.3.cmml">0.25</mn><mo id="S4.SS2.p1.24.m21.4.5.2.4" xref="S4.SS2.p1.24.m21.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.24.m21.4.4" xref="S4.SS2.p1.24.m21.4.4.cmml">0.0</mn><mo stretchy="false" id="S4.SS2.p1.24.m21.4.5.2.5" xref="S4.SS2.p1.24.m21.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.24.m21.4b"><list id="S4.SS2.p1.24.m21.4.5.1.cmml" xref="S4.SS2.p1.24.m21.4.5.2"><cn type="float" id="S4.SS2.p1.24.m21.1.1.cmml" xref="S4.SS2.p1.24.m21.1.1">0.5</cn><cn type="float" id="S4.SS2.p1.24.m21.2.2.cmml" xref="S4.SS2.p1.24.m21.2.2">0.25</cn><cn type="float" id="S4.SS2.p1.24.m21.3.3.cmml" xref="S4.SS2.p1.24.m21.3.3">0.25</cn><cn type="float" id="S4.SS2.p1.24.m21.4.4.cmml" xref="S4.SS2.p1.24.m21.4.4">0.0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.24.m21.4c">[0.5,0.25,0.25,0.0]</annotation></semantics></math>, which brings a negative transfer to the fourth class. We will verify this more in Sect. <a href="#S5.SS1" title="5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.5" class="ltx_p">We propose two techniques to rectify the distillation targets. The first one is <span id="S4.SS2.p2.5.1" class="ltx_text ltx_font_italic">enlarging the ensemble</span>. The initial global model and the aggregated model in the <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">t</annotation></semantics></math>th round are <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">θ</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝜃</ci><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\theta_{t}</annotation></semantics></math> and <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.3.m3.1.1.3.1" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝜃</ci><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><plus id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.1"></plus><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\theta_{t+1}</annotation></semantics></math>, respectively, while the collected local models are <math id="S4.SS2.p2.4.m4.3" class="ltx_Math" alttext="\{\theta_{t,k}\}_{k\in S_{t}}" display="inline"><semantics id="S4.SS2.p2.4.m4.3a"><msub id="S4.SS2.p2.4.m4.3.3" xref="S4.SS2.p2.4.m4.3.3.cmml"><mrow id="S4.SS2.p2.4.m4.3.3.1.1" xref="S4.SS2.p2.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.3.3.1.1.2" xref="S4.SS2.p2.4.m4.3.3.1.2.cmml">{</mo><msub id="S4.SS2.p2.4.m4.3.3.1.1.1" xref="S4.SS2.p2.4.m4.3.3.1.1.1.cmml"><mi id="S4.SS2.p2.4.m4.3.3.1.1.1.2" xref="S4.SS2.p2.4.m4.3.3.1.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p2.4.m4.2.2.2.4" xref="S4.SS2.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.1.cmml">t</mi><mo id="S4.SS2.p2.4.m4.2.2.2.4.1" xref="S4.SS2.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.4.m4.2.2.2.2" xref="S4.SS2.p2.4.m4.2.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p2.4.m4.3.3.1.1.3" xref="S4.SS2.p2.4.m4.3.3.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.4.m4.3.3.3" xref="S4.SS2.p2.4.m4.3.3.3.cmml"><mi id="S4.SS2.p2.4.m4.3.3.3.2" xref="S4.SS2.p2.4.m4.3.3.3.2.cmml">k</mi><mo id="S4.SS2.p2.4.m4.3.3.3.1" xref="S4.SS2.p2.4.m4.3.3.3.1.cmml">∈</mo><msub id="S4.SS2.p2.4.m4.3.3.3.3" xref="S4.SS2.p2.4.m4.3.3.3.3.cmml"><mi id="S4.SS2.p2.4.m4.3.3.3.3.2" xref="S4.SS2.p2.4.m4.3.3.3.3.2.cmml">S</mi><mi id="S4.SS2.p2.4.m4.3.3.3.3.3" xref="S4.SS2.p2.4.m4.3.3.3.3.3.cmml">t</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.3b"><apply id="S4.SS2.p2.4.m4.3.3.cmml" xref="S4.SS2.p2.4.m4.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.3.3.2.cmml" xref="S4.SS2.p2.4.m4.3.3">subscript</csymbol><set id="S4.SS2.p2.4.m4.3.3.1.2.cmml" xref="S4.SS2.p2.4.m4.3.3.1.1"><apply id="S4.SS2.p2.4.m4.3.3.1.1.1.cmml" xref="S4.SS2.p2.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.3.3.1.1.1.2.cmml" xref="S4.SS2.p2.4.m4.3.3.1.1.1.2">𝜃</ci><list id="S4.SS2.p2.4.m4.2.2.2.3.cmml" xref="S4.SS2.p2.4.m4.2.2.2.4"><ci id="S4.SS2.p2.4.m4.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1">𝑡</ci><ci id="S4.SS2.p2.4.m4.2.2.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2.2.2">𝑘</ci></list></apply></set><apply id="S4.SS2.p2.4.m4.3.3.3.cmml" xref="S4.SS2.p2.4.m4.3.3.3"><in id="S4.SS2.p2.4.m4.3.3.3.1.cmml" xref="S4.SS2.p2.4.m4.3.3.3.1"></in><ci id="S4.SS2.p2.4.m4.3.3.3.2.cmml" xref="S4.SS2.p2.4.m4.3.3.3.2">𝑘</ci><apply id="S4.SS2.p2.4.m4.3.3.3.3.cmml" xref="S4.SS2.p2.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.3.3.3.3.1.cmml" xref="S4.SS2.p2.4.m4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p2.4.m4.3.3.3.3.2.cmml" xref="S4.SS2.p2.4.m4.3.3.3.3.2">𝑆</ci><ci id="S4.SS2.p2.4.m4.3.3.3.3.3.cmml" xref="S4.SS2.p2.4.m4.3.3.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.3c">\{\theta_{t,k}\}_{k\in S_{t}}</annotation></semantics></math>. We use all of these models to generate distillation targets. Considering the aggregated models may perform worse in the beginning, we set a lower weight for them at previous communication rounds and gradually increase the weight. The second technique considers <span id="S4.SS2.p2.5.2" class="ltx_text ltx_font_italic">a certain local model could only perform well on a portion of test data</span>. For example, if a local model only or majorly observes dogs and cats during local training, it could not teach or negatively teach the aggregated model to identify cars. We propose using the predicted entropy to measure how confident is the local model on the predicted sample, i.e., <math id="S4.SS2.p2.5.m5.11" class="ltx_Math" alttext="e_{t,k}({\mathbf{x}})=-\sum_{c=1}^{C}q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})\log q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})" display="inline"><semantics id="S4.SS2.p2.5.m5.11a"><mrow id="S4.SS2.p2.5.m5.11.11" xref="S4.SS2.p2.5.m5.11.11.cmml"><mrow id="S4.SS2.p2.5.m5.11.11.4" xref="S4.SS2.p2.5.m5.11.11.4.cmml"><msub id="S4.SS2.p2.5.m5.11.11.4.2" xref="S4.SS2.p2.5.m5.11.11.4.2.cmml"><mi id="S4.SS2.p2.5.m5.11.11.4.2.2" xref="S4.SS2.p2.5.m5.11.11.4.2.2.cmml">e</mi><mrow id="S4.SS2.p2.5.m5.2.2.2.4" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.1.cmml">t</mi><mo id="S4.SS2.p2.5.m5.2.2.2.4.1" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.5.m5.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.11.11.4.1" xref="S4.SS2.p2.5.m5.11.11.4.1.cmml">​</mo><mrow id="S4.SS2.p2.5.m5.11.11.4.3.2" xref="S4.SS2.p2.5.m5.11.11.4.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.11.11.4.3.2.1" xref="S4.SS2.p2.5.m5.11.11.4.cmml">(</mo><mi id="S4.SS2.p2.5.m5.7.7" xref="S4.SS2.p2.5.m5.7.7.cmml">𝐱</mi><mo stretchy="false" id="S4.SS2.p2.5.m5.11.11.4.3.2.2" xref="S4.SS2.p2.5.m5.11.11.4.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.5.m5.11.11.3" xref="S4.SS2.p2.5.m5.11.11.3.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.11.11.2" xref="S4.SS2.p2.5.m5.11.11.2.cmml"><mo id="S4.SS2.p2.5.m5.11.11.2a" xref="S4.SS2.p2.5.m5.11.11.2.cmml">−</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2" xref="S4.SS2.p2.5.m5.11.11.2.2.cmml"><msubsup id="S4.SS2.p2.5.m5.11.11.2.2.3" xref="S4.SS2.p2.5.m5.11.11.2.2.3.cmml"><mo id="S4.SS2.p2.5.m5.11.11.2.2.3.2.2" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.2.cmml">∑</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.2" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.2.cmml">c</mi><mo id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.1" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.1.cmml">=</mo><mn id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.3" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p2.5.m5.11.11.2.2.3.3" xref="S4.SS2.p2.5.m5.11.11.2.2.3.3.cmml">C</mi></msubsup><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.cmml"><msub id="S4.SS2.p2.5.m5.11.11.2.2.2.4" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.4.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4.2.cmml">q</mi><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.4.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.11.11.2.2.2.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.3.cmml">​</mo><mrow id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.3.cmml">y</mi><mo id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.3.cmml">c</mi><mo fence="false" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.8.8" xref="S4.SS2.p2.5.m5.8.8.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p2.5.m5.4.4.2.4" xref="S4.SS2.p2.5.m5.4.4.2.3.cmml"><mi id="S4.SS2.p2.5.m5.3.3.1.1" xref="S4.SS2.p2.5.m5.3.3.1.1.cmml">t</mi><mo id="S4.SS2.p2.5.m5.4.4.2.4.1" xref="S4.SS2.p2.5.m5.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.5.m5.4.4.2.2" xref="S4.SS2.p2.5.m5.4.4.2.2.cmml">k</mi></mrow></msub></mrow></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.SS2.p2.5.m5.11.11.2.2.2.3a" xref="S4.SS2.p2.5.m5.11.11.2.2.2.3.cmml">​</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2.5" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.5.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS2.p2.5.m5.11.11.2.2.2.5a" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.cmml">⁡</mo><msub id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.2.cmml">q</mi><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.11.11.2.2.2.3b" xref="S4.SS2.p2.5.m5.11.11.2.2.2.3.cmml">​</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.3.cmml">y</mi><mo id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.2.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.3.cmml">c</mi><mo fence="false" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.2.cmml">|</mo><mrow id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.9.9" xref="S4.SS2.p2.5.m5.9.9.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p2.5.m5.6.6.2.4" xref="S4.SS2.p2.5.m5.6.6.2.3.cmml"><mi id="S4.SS2.p2.5.m5.5.5.1.1" xref="S4.SS2.p2.5.m5.5.5.1.1.cmml">t</mi><mo id="S4.SS2.p2.5.m5.6.6.2.4.1" xref="S4.SS2.p2.5.m5.6.6.2.3.cmml">,</mo><mi id="S4.SS2.p2.5.m5.6.6.2.2" xref="S4.SS2.p2.5.m5.6.6.2.2.cmml">k</mi></mrow></msub></mrow></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.3" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.11b"><apply id="S4.SS2.p2.5.m5.11.11.cmml" xref="S4.SS2.p2.5.m5.11.11"><eq id="S4.SS2.p2.5.m5.11.11.3.cmml" xref="S4.SS2.p2.5.m5.11.11.3"></eq><apply id="S4.SS2.p2.5.m5.11.11.4.cmml" xref="S4.SS2.p2.5.m5.11.11.4"><times id="S4.SS2.p2.5.m5.11.11.4.1.cmml" xref="S4.SS2.p2.5.m5.11.11.4.1"></times><apply id="S4.SS2.p2.5.m5.11.11.4.2.cmml" xref="S4.SS2.p2.5.m5.11.11.4.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.4.2.1.cmml" xref="S4.SS2.p2.5.m5.11.11.4.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.11.11.4.2.2.cmml" xref="S4.SS2.p2.5.m5.11.11.4.2.2">𝑒</ci><list id="S4.SS2.p2.5.m5.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.4"><ci id="S4.SS2.p2.5.m5.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1">𝑡</ci><ci id="S4.SS2.p2.5.m5.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2">𝑘</ci></list></apply><ci id="S4.SS2.p2.5.m5.7.7.cmml" xref="S4.SS2.p2.5.m5.7.7">𝐱</ci></apply><apply id="S4.SS2.p2.5.m5.11.11.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2"><minus id="S4.SS2.p2.5.m5.11.11.2.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2"></minus><apply id="S4.SS2.p2.5.m5.11.11.2.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2"><apply id="S4.SS2.p2.5.m5.11.11.2.2.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.2.2.3.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3">superscript</csymbol><apply id="S4.SS2.p2.5.m5.11.11.2.2.3.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.2.2.3.2.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3">subscript</csymbol><sum id="S4.SS2.p2.5.m5.11.11.2.2.3.2.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.2"></sum><apply id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3"><eq id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.1"></eq><ci id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.2">𝑐</ci><cn type="integer" id="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p2.5.m5.11.11.2.2.3.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.3.3">𝐶</ci></apply><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2"><times id="S4.SS2.p2.5.m5.11.11.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.3"></times><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.4.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.2.2.2.4.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.4.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4.2">𝑞</ci><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.4.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.4.3">𝑘</ci></apply><apply id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1"><eq id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.2"></eq><ci id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.3">𝑦</ci><apply id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.3">𝑐</ci><list id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1"><ci id="S4.SS2.p2.5.m5.8.8.cmml" xref="S4.SS2.p2.5.m5.8.8">𝐱</ci><apply id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.10.10.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><list id="S4.SS2.p2.5.m5.4.4.2.3.cmml" xref="S4.SS2.p2.5.m5.4.4.2.4"><ci id="S4.SS2.p2.5.m5.3.3.1.1.cmml" xref="S4.SS2.p2.5.m5.3.3.1.1">𝑡</ci><ci id="S4.SS2.p2.5.m5.4.4.2.2.cmml" xref="S4.SS2.p2.5.m5.4.4.2.2">𝑘</ci></list></apply></list></apply></apply><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.5.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5"><log id="S4.SS2.p2.5.m5.11.11.2.2.2.5.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.1"></log><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.2">𝑞</ci><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.5.2.3">𝑘</ci></apply></apply><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1"><eq id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.2"></eq><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.3">𝑦</ci><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.2">conditional</csymbol><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.3">𝑐</ci><list id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1"><ci id="S4.SS2.p2.5.m5.9.9.cmml" xref="S4.SS2.p2.5.m5.9.9">𝐱</ci><apply id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.11.11.2.2.2.2.1.1.1.1.1.1.2">𝜃</ci><list id="S4.SS2.p2.5.m5.6.6.2.3.cmml" xref="S4.SS2.p2.5.m5.6.6.2.4"><ci id="S4.SS2.p2.5.m5.5.5.1.1.cmml" xref="S4.SS2.p2.5.m5.5.5.1.1">𝑡</ci><ci id="S4.SS2.p2.5.m5.6.6.2.2.cmml" xref="S4.SS2.p2.5.m5.6.6.2.2">𝑘</ci></list></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.11c">e_{t,k}({\mathbf{x}})=-\sum_{c=1}^{C}q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})\log q_{k}(y=c|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})</annotation></semantics></math>. A smaller entropy corresponds to more confidence, and we let this model contribute more to the distillation process on this sample. Mathematically, the proposed rectified distillation targets are formulated as:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E10">
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.3" class="ltx_Math" alttext="\displaystyle\overline{q}_{\text{RAP},t}(y|{\mathbf{x}})" display="inline"><semantics id="S4.Ex1.m1.3a"><mrow id="S4.Ex1.m1.3.3" xref="S4.Ex1.m1.3.3.cmml"><msub id="S4.Ex1.m1.3.3.3" xref="S4.Ex1.m1.3.3.3.cmml"><mover accent="true" id="S4.Ex1.m1.3.3.3.2" xref="S4.Ex1.m1.3.3.3.2.cmml"><mi id="S4.Ex1.m1.3.3.3.2.2" xref="S4.Ex1.m1.3.3.3.2.2.cmml">q</mi><mo id="S4.Ex1.m1.3.3.3.2.1" xref="S4.Ex1.m1.3.3.3.2.1.cmml">¯</mo></mover><mrow id="S4.Ex1.m1.2.2.2.4" xref="S4.Ex1.m1.2.2.2.3.cmml"><mtext id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1a.cmml">RAP</mtext><mo id="S4.Ex1.m1.2.2.2.4.1" xref="S4.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.3.3.2" xref="S4.Ex1.m1.3.3.2.cmml">​</mo><mrow id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.3.3.1.1.2" xref="S4.Ex1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.3.3.1.1.1" xref="S4.Ex1.m1.3.3.1.1.1.cmml"><mi id="S4.Ex1.m1.3.3.1.1.1.2" xref="S4.Ex1.m1.3.3.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.Ex1.m1.3.3.1.1.1.1" xref="S4.Ex1.m1.3.3.1.1.1.1.cmml">|</mo><mi id="S4.Ex1.m1.3.3.1.1.1.3" xref="S4.Ex1.m1.3.3.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.Ex1.m1.3.3.1.1.3" xref="S4.Ex1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.3b"><apply id="S4.Ex1.m1.3.3.cmml" xref="S4.Ex1.m1.3.3"><times id="S4.Ex1.m1.3.3.2.cmml" xref="S4.Ex1.m1.3.3.2"></times><apply id="S4.Ex1.m1.3.3.3.cmml" xref="S4.Ex1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.1.cmml" xref="S4.Ex1.m1.3.3.3">subscript</csymbol><apply id="S4.Ex1.m1.3.3.3.2.cmml" xref="S4.Ex1.m1.3.3.3.2"><ci id="S4.Ex1.m1.3.3.3.2.1.cmml" xref="S4.Ex1.m1.3.3.3.2.1">¯</ci><ci id="S4.Ex1.m1.3.3.3.2.2.cmml" xref="S4.Ex1.m1.3.3.3.2.2">𝑞</ci></apply><list id="S4.Ex1.m1.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.4"><ci id="S4.Ex1.m1.1.1.1.1a.cmml" xref="S4.Ex1.m1.1.1.1.1"><mtext mathsize="70%" id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">RAP</mtext></ci><ci id="S4.Ex1.m1.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.Ex1.m1.3.3.1.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.3.3.1.1.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S4.Ex1.m1.3.3.1.1.1.2.cmml" xref="S4.Ex1.m1.3.3.1.1.1.2">𝑦</ci><ci id="S4.Ex1.m1.3.3.1.1.1.3.cmml" xref="S4.Ex1.m1.3.3.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.3c">\displaystyle\overline{q}_{\text{RAP},t}(y|{\mathbf{x}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.Ex1.m2.10" class="ltx_Math" alttext="\displaystyle=u_{t}*\left(\sum_{k\in S_{t}}\frac{w_{t,k}({\mathbf{x}})}{\sum_{j\in S_{t}}w_{t,j}({\mathbf{x}})}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})\right)" display="inline"><semantics id="S4.Ex1.m2.10a"><mrow id="S4.Ex1.m2.10.10" xref="S4.Ex1.m2.10.10.cmml"><mi id="S4.Ex1.m2.10.10.3" xref="S4.Ex1.m2.10.10.3.cmml"></mi><mo id="S4.Ex1.m2.10.10.2" xref="S4.Ex1.m2.10.10.2.cmml">=</mo><mrow id="S4.Ex1.m2.10.10.1" xref="S4.Ex1.m2.10.10.1.cmml"><msub id="S4.Ex1.m2.10.10.1.3" xref="S4.Ex1.m2.10.10.1.3.cmml"><mi id="S4.Ex1.m2.10.10.1.3.2" xref="S4.Ex1.m2.10.10.1.3.2.cmml">u</mi><mi id="S4.Ex1.m2.10.10.1.3.3" xref="S4.Ex1.m2.10.10.1.3.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m2.10.10.1.2" xref="S4.Ex1.m2.10.10.1.2.cmml">∗</mo><mrow id="S4.Ex1.m2.10.10.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.cmml"><mo id="S4.Ex1.m2.10.10.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m2.10.10.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.10.10.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.2.cmml"><munder id="S4.Ex1.m2.10.10.1.1.1.1.2a" xref="S4.Ex1.m2.10.10.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.Ex1.m2.10.10.1.1.1.1.2.2" xref="S4.Ex1.m2.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.10.10.1.1.1.1.2.3" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.cmml"><mi id="S4.Ex1.m2.10.10.1.1.1.1.2.3.2" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.2.cmml">k</mi><mo id="S4.Ex1.m2.10.10.1.1.1.1.2.3.1" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.cmml"><mi id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.2" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.2.cmml">S</mi><mi id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.3" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></munder></mstyle><mrow id="S4.Ex1.m2.10.10.1.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.6.6" xref="S4.Ex1.m2.6.6.cmml"><mfrac id="S4.Ex1.m2.6.6a" xref="S4.Ex1.m2.6.6.cmml"><mrow id="S4.Ex1.m2.3.3.3" xref="S4.Ex1.m2.3.3.3.cmml"><msub id="S4.Ex1.m2.3.3.3.5" xref="S4.Ex1.m2.3.3.3.5.cmml"><mi id="S4.Ex1.m2.3.3.3.5.2" xref="S4.Ex1.m2.3.3.3.5.2.cmml">w</mi><mrow id="S4.Ex1.m2.2.2.2.2.2.4" xref="S4.Ex1.m2.2.2.2.2.2.3.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.cmml">t</mi><mo id="S4.Ex1.m2.2.2.2.2.2.4.1" xref="S4.Ex1.m2.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m2.2.2.2.2.2.2" xref="S4.Ex1.m2.2.2.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.3.3.3.4" xref="S4.Ex1.m2.3.3.3.4.cmml">​</mo><mrow id="S4.Ex1.m2.3.3.3.6.2" xref="S4.Ex1.m2.3.3.3.cmml"><mo stretchy="false" id="S4.Ex1.m2.3.3.3.6.2.1" xref="S4.Ex1.m2.3.3.3.cmml">(</mo><mi id="S4.Ex1.m2.3.3.3.3" xref="S4.Ex1.m2.3.3.3.3.cmml">𝐱</mi><mo stretchy="false" id="S4.Ex1.m2.3.3.3.6.2.2" xref="S4.Ex1.m2.3.3.3.cmml">)</mo></mrow></mrow><mrow id="S4.Ex1.m2.6.6.6" xref="S4.Ex1.m2.6.6.6.cmml"><msub id="S4.Ex1.m2.6.6.6.4" xref="S4.Ex1.m2.6.6.6.4.cmml"><mo id="S4.Ex1.m2.6.6.6.4.2" xref="S4.Ex1.m2.6.6.6.4.2.cmml">∑</mo><mrow id="S4.Ex1.m2.6.6.6.4.3" xref="S4.Ex1.m2.6.6.6.4.3.cmml"><mi id="S4.Ex1.m2.6.6.6.4.3.2" xref="S4.Ex1.m2.6.6.6.4.3.2.cmml">j</mi><mo id="S4.Ex1.m2.6.6.6.4.3.1" xref="S4.Ex1.m2.6.6.6.4.3.1.cmml">∈</mo><msub id="S4.Ex1.m2.6.6.6.4.3.3" xref="S4.Ex1.m2.6.6.6.4.3.3.cmml"><mi id="S4.Ex1.m2.6.6.6.4.3.3.2" xref="S4.Ex1.m2.6.6.6.4.3.3.2.cmml">S</mi><mi id="S4.Ex1.m2.6.6.6.4.3.3.3" xref="S4.Ex1.m2.6.6.6.4.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="S4.Ex1.m2.6.6.6.5" xref="S4.Ex1.m2.6.6.6.5.cmml"><msub id="S4.Ex1.m2.6.6.6.5.2" xref="S4.Ex1.m2.6.6.6.5.2.cmml"><mi id="S4.Ex1.m2.6.6.6.5.2.2" xref="S4.Ex1.m2.6.6.6.5.2.2.cmml">w</mi><mrow id="S4.Ex1.m2.5.5.5.2.2.4" xref="S4.Ex1.m2.5.5.5.2.2.3.cmml"><mi id="S4.Ex1.m2.4.4.4.1.1.1" xref="S4.Ex1.m2.4.4.4.1.1.1.cmml">t</mi><mo id="S4.Ex1.m2.5.5.5.2.2.4.1" xref="S4.Ex1.m2.5.5.5.2.2.3.cmml">,</mo><mi id="S4.Ex1.m2.5.5.5.2.2.2" xref="S4.Ex1.m2.5.5.5.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.6.6.6.5.1" xref="S4.Ex1.m2.6.6.6.5.1.cmml">​</mo><mrow id="S4.Ex1.m2.6.6.6.5.3.2" xref="S4.Ex1.m2.6.6.6.5.cmml"><mo stretchy="false" id="S4.Ex1.m2.6.6.6.5.3.2.1" xref="S4.Ex1.m2.6.6.6.5.cmml">(</mo><mi id="S4.Ex1.m2.6.6.6.3" xref="S4.Ex1.m2.6.6.6.3.cmml">𝐱</mi><mo stretchy="false" id="S4.Ex1.m2.6.6.6.5.3.2.2" xref="S4.Ex1.m2.6.6.6.5.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.10.10.1.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.2.cmml">​</mo><msub id="S4.Ex1.m2.10.10.1.1.1.1.1.3" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m2.10.10.1.1.1.1.1.3.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3.2.cmml">q</mi><mi id="S4.Ex1.m2.10.10.1.1.1.1.1.3.3" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex1.m2.10.10.1.1.1.1.1.2a" xref="S4.Ex1.m2.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex1.m2.9.9" xref="S4.Ex1.m2.9.9.cmml">𝐱</mi><mo rspace="0.447em" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.Ex1.m2.8.8.2.4" xref="S4.Ex1.m2.8.8.2.3.cmml"><mi id="S4.Ex1.m2.7.7.1.1" xref="S4.Ex1.m2.7.7.1.1.cmml">t</mi><mo id="S4.Ex1.m2.8.8.2.4.1" xref="S4.Ex1.m2.8.8.2.3.cmml">,</mo><mi id="S4.Ex1.m2.8.8.2.2" xref="S4.Ex1.m2.8.8.2.2.cmml">k</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex1.m2.10.10.1.1.1.3" xref="S4.Ex1.m2.10.10.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m2.10b"><apply id="S4.Ex1.m2.10.10.cmml" xref="S4.Ex1.m2.10.10"><eq id="S4.Ex1.m2.10.10.2.cmml" xref="S4.Ex1.m2.10.10.2"></eq><csymbol cd="latexml" id="S4.Ex1.m2.10.10.3.cmml" xref="S4.Ex1.m2.10.10.3">absent</csymbol><apply id="S4.Ex1.m2.10.10.1.cmml" xref="S4.Ex1.m2.10.10.1"><times id="S4.Ex1.m2.10.10.1.2.cmml" xref="S4.Ex1.m2.10.10.1.2"></times><apply id="S4.Ex1.m2.10.10.1.3.cmml" xref="S4.Ex1.m2.10.10.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.10.10.1.3.1.cmml" xref="S4.Ex1.m2.10.10.1.3">subscript</csymbol><ci id="S4.Ex1.m2.10.10.1.3.2.cmml" xref="S4.Ex1.m2.10.10.1.3.2">𝑢</ci><ci id="S4.Ex1.m2.10.10.1.3.3.cmml" xref="S4.Ex1.m2.10.10.1.3.3">𝑡</ci></apply><apply id="S4.Ex1.m2.10.10.1.1.1.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1"><apply id="S4.Ex1.m2.10.10.1.1.1.1.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.10.10.1.1.1.1.2.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2">subscript</csymbol><sum id="S4.Ex1.m2.10.10.1.1.1.1.2.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.2"></sum><apply id="S4.Ex1.m2.10.10.1.1.1.1.2.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3"><in id="S4.Ex1.m2.10.10.1.1.1.1.2.3.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.1"></in><ci id="S4.Ex1.m2.10.10.1.1.1.1.2.3.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.2">𝑘</ci><apply id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.2">𝑆</ci><ci id="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.Ex1.m2.10.10.1.1.1.1.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1"><times id="S4.Ex1.m2.10.10.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.2"></times><apply id="S4.Ex1.m2.6.6.cmml" xref="S4.Ex1.m2.6.6"><divide id="S4.Ex1.m2.6.6.7.cmml" xref="S4.Ex1.m2.6.6"></divide><apply id="S4.Ex1.m2.3.3.3.cmml" xref="S4.Ex1.m2.3.3.3"><times id="S4.Ex1.m2.3.3.3.4.cmml" xref="S4.Ex1.m2.3.3.3.4"></times><apply id="S4.Ex1.m2.3.3.3.5.cmml" xref="S4.Ex1.m2.3.3.3.5"><csymbol cd="ambiguous" id="S4.Ex1.m2.3.3.3.5.1.cmml" xref="S4.Ex1.m2.3.3.3.5">subscript</csymbol><ci id="S4.Ex1.m2.3.3.3.5.2.cmml" xref="S4.Ex1.m2.3.3.3.5.2">𝑤</ci><list id="S4.Ex1.m2.2.2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.2.2.2.4"><ci id="S4.Ex1.m2.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1">𝑡</ci><ci id="S4.Ex1.m2.2.2.2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2.2.2.2">𝑘</ci></list></apply><ci id="S4.Ex1.m2.3.3.3.3.cmml" xref="S4.Ex1.m2.3.3.3.3">𝐱</ci></apply><apply id="S4.Ex1.m2.6.6.6.cmml" xref="S4.Ex1.m2.6.6.6"><apply id="S4.Ex1.m2.6.6.6.4.cmml" xref="S4.Ex1.m2.6.6.6.4"><csymbol cd="ambiguous" id="S4.Ex1.m2.6.6.6.4.1.cmml" xref="S4.Ex1.m2.6.6.6.4">subscript</csymbol><sum id="S4.Ex1.m2.6.6.6.4.2.cmml" xref="S4.Ex1.m2.6.6.6.4.2"></sum><apply id="S4.Ex1.m2.6.6.6.4.3.cmml" xref="S4.Ex1.m2.6.6.6.4.3"><in id="S4.Ex1.m2.6.6.6.4.3.1.cmml" xref="S4.Ex1.m2.6.6.6.4.3.1"></in><ci id="S4.Ex1.m2.6.6.6.4.3.2.cmml" xref="S4.Ex1.m2.6.6.6.4.3.2">𝑗</ci><apply id="S4.Ex1.m2.6.6.6.4.3.3.cmml" xref="S4.Ex1.m2.6.6.6.4.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.6.6.6.4.3.3.1.cmml" xref="S4.Ex1.m2.6.6.6.4.3.3">subscript</csymbol><ci id="S4.Ex1.m2.6.6.6.4.3.3.2.cmml" xref="S4.Ex1.m2.6.6.6.4.3.3.2">𝑆</ci><ci id="S4.Ex1.m2.6.6.6.4.3.3.3.cmml" xref="S4.Ex1.m2.6.6.6.4.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.Ex1.m2.6.6.6.5.cmml" xref="S4.Ex1.m2.6.6.6.5"><times id="S4.Ex1.m2.6.6.6.5.1.cmml" xref="S4.Ex1.m2.6.6.6.5.1"></times><apply id="S4.Ex1.m2.6.6.6.5.2.cmml" xref="S4.Ex1.m2.6.6.6.5.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.6.6.6.5.2.1.cmml" xref="S4.Ex1.m2.6.6.6.5.2">subscript</csymbol><ci id="S4.Ex1.m2.6.6.6.5.2.2.cmml" xref="S4.Ex1.m2.6.6.6.5.2.2">𝑤</ci><list id="S4.Ex1.m2.5.5.5.2.2.3.cmml" xref="S4.Ex1.m2.5.5.5.2.2.4"><ci id="S4.Ex1.m2.4.4.4.1.1.1.cmml" xref="S4.Ex1.m2.4.4.4.1.1.1">𝑡</ci><ci id="S4.Ex1.m2.5.5.5.2.2.2.cmml" xref="S4.Ex1.m2.5.5.5.2.2.2">𝑗</ci></list></apply><ci id="S4.Ex1.m2.6.6.6.3.cmml" xref="S4.Ex1.m2.6.6.6.3">𝐱</ci></apply></apply></apply><apply id="S4.Ex1.m2.10.10.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.10.10.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m2.10.10.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3.2">𝑞</ci><ci id="S4.Ex1.m2.10.10.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.3">𝑦</ci><list id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1"><ci id="S4.Ex1.m2.9.9.cmml" xref="S4.Ex1.m2.9.9">𝐱</ci><apply id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.10.10.1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><list id="S4.Ex1.m2.8.8.2.3.cmml" xref="S4.Ex1.m2.8.8.2.4"><ci id="S4.Ex1.m2.7.7.1.1.cmml" xref="S4.Ex1.m2.7.7.1.1">𝑡</ci><ci id="S4.Ex1.m2.8.8.2.2.cmml" xref="S4.Ex1.m2.8.8.2.2">𝑘</ci></list></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m2.10c">\displaystyle=u_{t}*\left(\sum_{k\in S_{t}}\frac{w_{t,k}({\mathbf{x}})}{\sum_{j\in S_{t}}w_{t,j}({\mathbf{x}})}q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t,k})\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr>
<tr class="ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E10.m1.4" class="ltx_Math" alttext="\displaystyle+\frac{1-u_{t}}{2}*\underbrace{\left(q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t})+q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t+1})\right)}_{\text{Self Teaching}}," display="inline"><semantics id="S4.E10.m1.4a"><mrow id="S4.E10.m1.4.4.1" xref="S4.E10.m1.4.4.1.1.cmml"><mrow id="S4.E10.m1.4.4.1.1" xref="S4.E10.m1.4.4.1.1.cmml"><mo id="S4.E10.m1.4.4.1.1a" xref="S4.E10.m1.4.4.1.1.cmml">+</mo><mrow id="S4.E10.m1.4.4.1.1.2" xref="S4.E10.m1.4.4.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E10.m1.4.4.1.1.2.2" xref="S4.E10.m1.4.4.1.1.2.2.cmml"><mfrac id="S4.E10.m1.4.4.1.1.2.2a" xref="S4.E10.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E10.m1.4.4.1.1.2.2.2" xref="S4.E10.m1.4.4.1.1.2.2.2.cmml"><mn id="S4.E10.m1.4.4.1.1.2.2.2.2" xref="S4.E10.m1.4.4.1.1.2.2.2.2.cmml">1</mn><mo id="S4.E10.m1.4.4.1.1.2.2.2.1" xref="S4.E10.m1.4.4.1.1.2.2.2.1.cmml">−</mo><msub id="S4.E10.m1.4.4.1.1.2.2.2.3" xref="S4.E10.m1.4.4.1.1.2.2.2.3.cmml"><mi id="S4.E10.m1.4.4.1.1.2.2.2.3.2" xref="S4.E10.m1.4.4.1.1.2.2.2.3.2.cmml">u</mi><mi id="S4.E10.m1.4.4.1.1.2.2.2.3.3" xref="S4.E10.m1.4.4.1.1.2.2.2.3.3.cmml">t</mi></msub></mrow><mn id="S4.E10.m1.4.4.1.1.2.2.3" xref="S4.E10.m1.4.4.1.1.2.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S4.E10.m1.4.4.1.1.2.1" xref="S4.E10.m1.4.4.1.1.2.1.cmml">∗</mo><munder id="S4.E10.m1.4.4.1.1.2.3" xref="S4.E10.m1.4.4.1.1.2.3.cmml"><munder accentunder="true" id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml"><mrow id="S4.E10.m1.3.3.3.3" xref="S4.E10.m1.3.3.3.3.1.cmml"><mo id="S4.E10.m1.3.3.3.3.2" xref="S4.E10.m1.3.3.3.3.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.3.3.1" xref="S4.E10.m1.3.3.3.3.1.cmml"><mrow id="S4.E10.m1.3.3.3.3.1.1" xref="S4.E10.m1.3.3.3.3.1.1.cmml"><msub id="S4.E10.m1.3.3.3.3.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.3.2" xref="S4.E10.m1.3.3.3.3.1.1.3.2.cmml">q</mi><mtext id="S4.E10.m1.3.3.3.3.1.1.3.3" xref="S4.E10.m1.3.3.3.3.1.1.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.3.3.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.E10.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow></mrow><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.3.3.1.3" xref="S4.E10.m1.3.3.3.3.1.3.cmml">+</mo><mrow id="S4.E10.m1.3.3.3.3.1.2" xref="S4.E10.m1.3.3.3.3.1.2.cmml"><msub id="S4.E10.m1.3.3.3.3.1.2.3" xref="S4.E10.m1.3.3.3.3.1.2.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.2.3.2" xref="S4.E10.m1.3.3.3.3.1.2.3.2.cmml">q</mi><mtext id="S4.E10.m1.3.3.3.3.1.2.3.3" xref="S4.E10.m1.3.3.3.3.1.2.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.3.3.1.2.2" xref="S4.E10.m1.3.3.3.3.1.2.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.3.3.1.2.1.1" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.2.1.1.2" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.3.3.1.2.1.1.1" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.cmml"><mi id="S4.E10.m1.3.3.3.3.1.2.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.E10.m1.3.3.3.3.1.2.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.2.cmml">|</mo><mrow id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.2.cmml"><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.2.cmml">;</mo><msub id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.2" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.1" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.3" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S4.E10.m1.3.3.3.3.1.2.1.1.3" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E10.m1.3.3.3.3.3" xref="S4.E10.m1.3.3.3.3.1.cmml">)</mo></mrow><mo id="S4.E10.m1.3.3.4" xref="S4.E10.m1.3.3.4.cmml">⏟</mo></munder><mtext id="S4.E10.m1.4.4.1.1.2.3.2" xref="S4.E10.m1.4.4.1.1.2.3.2a.cmml">Self Teaching</mtext></munder></mrow></mrow><mo id="S4.E10.m1.4.4.1.2" xref="S4.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.4b"><apply id="S4.E10.m1.4.4.1.1.cmml" xref="S4.E10.m1.4.4.1"><plus id="S4.E10.m1.4.4.1.1.1.cmml" xref="S4.E10.m1.4.4.1"></plus><apply id="S4.E10.m1.4.4.1.1.2.cmml" xref="S4.E10.m1.4.4.1.1.2"><times id="S4.E10.m1.4.4.1.1.2.1.cmml" xref="S4.E10.m1.4.4.1.1.2.1"></times><apply id="S4.E10.m1.4.4.1.1.2.2.cmml" xref="S4.E10.m1.4.4.1.1.2.2"><divide id="S4.E10.m1.4.4.1.1.2.2.1.cmml" xref="S4.E10.m1.4.4.1.1.2.2"></divide><apply id="S4.E10.m1.4.4.1.1.2.2.2.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2"><minus id="S4.E10.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.1"></minus><cn type="integer" id="S4.E10.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.2">1</cn><apply id="S4.E10.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.1.1.2.2.2.3.1.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.3">subscript</csymbol><ci id="S4.E10.m1.4.4.1.1.2.2.2.3.2.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.3.2">𝑢</ci><ci id="S4.E10.m1.4.4.1.1.2.2.2.3.3.cmml" xref="S4.E10.m1.4.4.1.1.2.2.2.3.3">𝑡</ci></apply></apply><cn type="integer" id="S4.E10.m1.4.4.1.1.2.2.3.cmml" xref="S4.E10.m1.4.4.1.1.2.2.3">2</cn></apply><apply id="S4.E10.m1.4.4.1.1.2.3.cmml" xref="S4.E10.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.1.1.2.3.1.cmml" xref="S4.E10.m1.4.4.1.1.2.3">subscript</csymbol><apply id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3"><ci id="S4.E10.m1.3.3.4.cmml" xref="S4.E10.m1.3.3.4">⏟</ci><apply id="S4.E10.m1.3.3.3.3.1.cmml" xref="S4.E10.m1.3.3.3.3"><plus id="S4.E10.m1.3.3.3.3.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.3"></plus><apply id="S4.E10.m1.3.3.3.3.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1"><times id="S4.E10.m1.3.3.3.3.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.2"></times><apply id="S4.E10.m1.3.3.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.3.2">𝑞</ci><ci id="S4.E10.m1.3.3.3.3.1.1.3.3a.cmml" xref="S4.E10.m1.3.3.3.3.1.1.3.3"><mtext mathsize="70%" id="S4.E10.m1.3.3.3.3.1.1.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.3.3">g</mtext></ci></apply><apply id="S4.E10.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E10.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.2">conditional</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.3">𝑦</ci><list id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1"><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝐱</ci><apply id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply></apply><apply id="S4.E10.m1.3.3.3.3.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2"><times id="S4.E10.m1.3.3.3.3.1.2.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.2"></times><apply id="S4.E10.m1.3.3.3.3.1.2.3.cmml" xref="S4.E10.m1.3.3.3.3.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.2.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.2.3">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.2.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.3.2">𝑞</ci><ci id="S4.E10.m1.3.3.3.3.1.2.3.3a.cmml" xref="S4.E10.m1.3.3.3.3.1.2.3.3"><mtext mathsize="70%" id="S4.E10.m1.3.3.3.3.1.2.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.2.3.3">g</mtext></ci></apply><apply id="S4.E10.m1.3.3.3.3.1.2.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1"><csymbol cd="latexml" id="S4.E10.m1.3.3.3.3.1.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.2">conditional</csymbol><ci id="S4.E10.m1.3.3.3.3.1.2.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.3">𝑦</ci><list id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1"><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">𝐱</ci><apply id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3"><plus id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.1"></plus><ci id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.3.3.1.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></list></apply></apply></apply></apply><ci id="S4.E10.m1.4.4.1.1.2.3.2a.cmml" xref="S4.E10.m1.4.4.1.1.2.3.2"><mtext mathsize="70%" id="S4.E10.m1.4.4.1.1.2.3.2.cmml" xref="S4.E10.m1.4.4.1.1.2.3.2">Self Teaching</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.4c">\displaystyle+\frac{1-u_{t}}{2}*\underbrace{\left(q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t})+q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{t+1})\right)}_{\text{Self Teaching}},</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p2.14" class="ltx_p">where utilizing <math id="S4.SS2.p2.6.m1.8" class="ltx_Math" alttext="\{w_{t,k}({\mathbf{x}})\}_{k\sim S_{t}}=\sigma\left(-1.0*\{e_{t,k}({\mathbf{x}})\}_{k\in S_{t}}\right)" display="inline"><semantics id="S4.SS2.p2.6.m1.8a"><mrow id="S4.SS2.p2.6.m1.8.8" xref="S4.SS2.p2.6.m1.8.8.cmml"><msub id="S4.SS2.p2.6.m1.7.7.1" xref="S4.SS2.p2.6.m1.7.7.1.cmml"><mrow id="S4.SS2.p2.6.m1.7.7.1.1.1" xref="S4.SS2.p2.6.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m1.7.7.1.1.1.2" xref="S4.SS2.p2.6.m1.7.7.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.6.m1.7.7.1.1.1.1" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.cmml"><msub id="S4.SS2.p2.6.m1.7.7.1.1.1.1.2" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.cmml"><mi id="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.2" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.2.cmml">w</mi><mrow id="S4.SS2.p2.6.m1.2.2.2.4" xref="S4.SS2.p2.6.m1.2.2.2.3.cmml"><mi id="S4.SS2.p2.6.m1.1.1.1.1" xref="S4.SS2.p2.6.m1.1.1.1.1.cmml">t</mi><mo id="S4.SS2.p2.6.m1.2.2.2.4.1" xref="S4.SS2.p2.6.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.6.m1.2.2.2.2" xref="S4.SS2.p2.6.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.7.7.1.1.1.1.1" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS2.p2.6.m1.7.7.1.1.1.1.3.2" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m1.7.7.1.1.1.1.3.2.1" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.cmml">(</mo><mi id="S4.SS2.p2.6.m1.5.5" xref="S4.SS2.p2.6.m1.5.5.cmml">𝐱</mi><mo stretchy="false" id="S4.SS2.p2.6.m1.7.7.1.1.1.1.3.2.2" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.6.m1.7.7.1.1.1.3" xref="S4.SS2.p2.6.m1.7.7.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.6.m1.7.7.1.3" xref="S4.SS2.p2.6.m1.7.7.1.3.cmml"><mi id="S4.SS2.p2.6.m1.7.7.1.3.2" xref="S4.SS2.p2.6.m1.7.7.1.3.2.cmml">k</mi><mo id="S4.SS2.p2.6.m1.7.7.1.3.1" xref="S4.SS2.p2.6.m1.7.7.1.3.1.cmml">∼</mo><msub id="S4.SS2.p2.6.m1.7.7.1.3.3" xref="S4.SS2.p2.6.m1.7.7.1.3.3.cmml"><mi id="S4.SS2.p2.6.m1.7.7.1.3.3.2" xref="S4.SS2.p2.6.m1.7.7.1.3.3.2.cmml">S</mi><mi id="S4.SS2.p2.6.m1.7.7.1.3.3.3" xref="S4.SS2.p2.6.m1.7.7.1.3.3.3.cmml">t</mi></msub></mrow></msub><mo id="S4.SS2.p2.6.m1.8.8.3" xref="S4.SS2.p2.6.m1.8.8.3.cmml">=</mo><mrow id="S4.SS2.p2.6.m1.8.8.2" xref="S4.SS2.p2.6.m1.8.8.2.cmml"><mi id="S4.SS2.p2.6.m1.8.8.2.3" xref="S4.SS2.p2.6.m1.8.8.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.8.8.2.2" xref="S4.SS2.p2.6.m1.8.8.2.2.cmml">​</mo><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml"><mo id="S4.SS2.p2.6.m1.8.8.2.1.1.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml"><mo id="S4.SS2.p2.6.m1.8.8.2.1.1.1a" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml">−</mo><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.cmml"><mn id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.3.cmml">1.0</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.2.cmml">∗</mo><msub id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.SS2.p2.6.m1.4.4.2.4" xref="S4.SS2.p2.6.m1.4.4.2.3.cmml"><mi id="S4.SS2.p2.6.m1.3.3.1.1" xref="S4.SS2.p2.6.m1.3.3.1.1.cmml">t</mi><mo id="S4.SS2.p2.6.m1.4.4.2.4.1" xref="S4.SS2.p2.6.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS2.p2.6.m1.4.4.2.2" xref="S4.SS2.p2.6.m1.4.4.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.3.2.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.SS2.p2.6.m1.6.6" xref="S4.SS2.p2.6.m1.6.6.cmml">𝐱</mi><mo stretchy="false" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.3.2.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.1" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.2" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.2.cmml">S</mi><mi id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></msub></mrow></mrow><mo id="S4.SS2.p2.6.m1.8.8.2.1.1.3" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m1.8b"><apply id="S4.SS2.p2.6.m1.8.8.cmml" xref="S4.SS2.p2.6.m1.8.8"><eq id="S4.SS2.p2.6.m1.8.8.3.cmml" xref="S4.SS2.p2.6.m1.8.8.3"></eq><apply id="S4.SS2.p2.6.m1.7.7.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.7.7.1.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1">subscript</csymbol><set id="S4.SS2.p2.6.m1.7.7.1.1.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1"><apply id="S4.SS2.p2.6.m1.7.7.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1"><times id="S4.SS2.p2.6.m1.7.7.1.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.1"></times><apply id="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1.1.1.1.2.2">𝑤</ci><list id="S4.SS2.p2.6.m1.2.2.2.3.cmml" xref="S4.SS2.p2.6.m1.2.2.2.4"><ci id="S4.SS2.p2.6.m1.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.1.1.1.1">𝑡</ci><ci id="S4.SS2.p2.6.m1.2.2.2.2.cmml" xref="S4.SS2.p2.6.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S4.SS2.p2.6.m1.5.5.cmml" xref="S4.SS2.p2.6.m1.5.5">𝐱</ci></apply></set><apply id="S4.SS2.p2.6.m1.7.7.1.3.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3"><csymbol cd="latexml" id="S4.SS2.p2.6.m1.7.7.1.3.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.1">similar-to</csymbol><ci id="S4.SS2.p2.6.m1.7.7.1.3.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.2">𝑘</ci><apply id="S4.SS2.p2.6.m1.7.7.1.3.3.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.7.7.1.3.3.1.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.6.m1.7.7.1.3.3.2.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.3.2">𝑆</ci><ci id="S4.SS2.p2.6.m1.7.7.1.3.3.3.cmml" xref="S4.SS2.p2.6.m1.7.7.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS2.p2.6.m1.8.8.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2"><times id="S4.SS2.p2.6.m1.8.8.2.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.2"></times><ci id="S4.SS2.p2.6.m1.8.8.2.3.cmml" xref="S4.SS2.p2.6.m1.8.8.2.3">𝜎</ci><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1"><minus id="S4.SS2.p2.6.m1.8.8.2.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1"></minus><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1"><times id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.2"></times><cn type="float" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.3.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.3">1.0</cn><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1">subscript</csymbol><set id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1"><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1"><times id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.1"></times><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.1.1.1.2.2">𝑒</ci><list id="S4.SS2.p2.6.m1.4.4.2.3.cmml" xref="S4.SS2.p2.6.m1.4.4.2.4"><ci id="S4.SS2.p2.6.m1.3.3.1.1.cmml" xref="S4.SS2.p2.6.m1.3.3.1.1">𝑡</ci><ci id="S4.SS2.p2.6.m1.4.4.2.2.cmml" xref="S4.SS2.p2.6.m1.4.4.2.2">𝑘</ci></list></apply><ci id="S4.SS2.p2.6.m1.6.6.cmml" xref="S4.SS2.p2.6.m1.6.6">𝐱</ci></apply></set><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3"><in id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.1"></in><ci id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.2">𝑘</ci><apply id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.2">𝑆</ci><ci id="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p2.6.m1.8.8.2.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m1.8c">\{w_{t,k}({\mathbf{x}})\}_{k\sim S_{t}}=\sigma\left(-1.0*\{e_{t,k}({\mathbf{x}})\}_{k\in S_{t}}\right)</annotation></semantics></math> can choose appropriate local models for each test sample to generate distillation targets. <math id="S4.SS2.p2.7.m2.1" class="ltx_Math" alttext="q_{k}(\cdot)" display="inline"><semantics id="S4.SS2.p2.7.m2.1a"><mrow id="S4.SS2.p2.7.m2.1.2" xref="S4.SS2.p2.7.m2.1.2.cmml"><msub id="S4.SS2.p2.7.m2.1.2.2" xref="S4.SS2.p2.7.m2.1.2.2.cmml"><mi id="S4.SS2.p2.7.m2.1.2.2.2" xref="S4.SS2.p2.7.m2.1.2.2.2.cmml">q</mi><mi id="S4.SS2.p2.7.m2.1.2.2.3" xref="S4.SS2.p2.7.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m2.1.2.1" xref="S4.SS2.p2.7.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.7.m2.1.2.3.2" xref="S4.SS2.p2.7.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.7.m2.1.2.3.2.1" xref="S4.SS2.p2.7.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m2.1.1" xref="S4.SS2.p2.7.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.7.m2.1.2.3.2.2" xref="S4.SS2.p2.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m2.1b"><apply id="S4.SS2.p2.7.m2.1.2.cmml" xref="S4.SS2.p2.7.m2.1.2"><times id="S4.SS2.p2.7.m2.1.2.1.cmml" xref="S4.SS2.p2.7.m2.1.2.1"></times><apply id="S4.SS2.p2.7.m2.1.2.2.cmml" xref="S4.SS2.p2.7.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m2.1.2.2.1.cmml" xref="S4.SS2.p2.7.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.7.m2.1.2.2.2.cmml" xref="S4.SS2.p2.7.m2.1.2.2.2">𝑞</ci><ci id="S4.SS2.p2.7.m2.1.2.2.3.cmml" xref="S4.SS2.p2.7.m2.1.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p2.7.m2.1.1.cmml" xref="S4.SS2.p2.7.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m2.1c">q_{k}(\cdot)</annotation></semantics></math> and <math id="S4.SS2.p2.8.m3.1" class="ltx_Math" alttext="q_{\text{g}}(\cdot)" display="inline"><semantics id="S4.SS2.p2.8.m3.1a"><mrow id="S4.SS2.p2.8.m3.1.2" xref="S4.SS2.p2.8.m3.1.2.cmml"><msub id="S4.SS2.p2.8.m3.1.2.2" xref="S4.SS2.p2.8.m3.1.2.2.cmml"><mi id="S4.SS2.p2.8.m3.1.2.2.2" xref="S4.SS2.p2.8.m3.1.2.2.2.cmml">q</mi><mtext id="S4.SS2.p2.8.m3.1.2.2.3" xref="S4.SS2.p2.8.m3.1.2.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m3.1.2.1" xref="S4.SS2.p2.8.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.8.m3.1.2.3.2" xref="S4.SS2.p2.8.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m3.1.2.3.2.1" xref="S4.SS2.p2.8.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m3.1.1" xref="S4.SS2.p2.8.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.8.m3.1.2.3.2.2" xref="S4.SS2.p2.8.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m3.1b"><apply id="S4.SS2.p2.8.m3.1.2.cmml" xref="S4.SS2.p2.8.m3.1.2"><times id="S4.SS2.p2.8.m3.1.2.1.cmml" xref="S4.SS2.p2.8.m3.1.2.1"></times><apply id="S4.SS2.p2.8.m3.1.2.2.cmml" xref="S4.SS2.p2.8.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m3.1.2.2.1.cmml" xref="S4.SS2.p2.8.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.8.m3.1.2.2.2.cmml" xref="S4.SS2.p2.8.m3.1.2.2.2">𝑞</ci><ci id="S4.SS2.p2.8.m3.1.2.2.3a.cmml" xref="S4.SS2.p2.8.m3.1.2.2.3"><mtext mathsize="70%" id="S4.SS2.p2.8.m3.1.2.2.3.cmml" xref="S4.SS2.p2.8.m3.1.2.2.3">g</mtext></ci></apply><ci id="S4.SS2.p2.8.m3.1.1.cmml" xref="S4.SS2.p2.8.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m3.1c">q_{\text{g}}(\cdot)</annotation></semantics></math> are calculated as in Eq. <a href="#S4.E6" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. <math id="S4.SS2.p2.9.m4.1" class="ltx_Math" alttext="u_{t}" display="inline"><semantics id="S4.SS2.p2.9.m4.1a"><msub id="S4.SS2.p2.9.m4.1.1" xref="S4.SS2.p2.9.m4.1.1.cmml"><mi id="S4.SS2.p2.9.m4.1.1.2" xref="S4.SS2.p2.9.m4.1.1.2.cmml">u</mi><mi id="S4.SS2.p2.9.m4.1.1.3" xref="S4.SS2.p2.9.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m4.1b"><apply id="S4.SS2.p2.9.m4.1.1.cmml" xref="S4.SS2.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m4.1.1.1.cmml" xref="S4.SS2.p2.9.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.9.m4.1.1.2.cmml" xref="S4.SS2.p2.9.m4.1.1.2">𝑢</ci><ci id="S4.SS2.p2.9.m4.1.1.3.cmml" xref="S4.SS2.p2.9.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m4.1c">u_{t}</annotation></semantics></math> balances the influence of local and global models. We adjust <math id="S4.SS2.p2.10.m5.1" class="ltx_Math" alttext="u_{t}" display="inline"><semantics id="S4.SS2.p2.10.m5.1a"><msub id="S4.SS2.p2.10.m5.1.1" xref="S4.SS2.p2.10.m5.1.1.cmml"><mi id="S4.SS2.p2.10.m5.1.1.2" xref="S4.SS2.p2.10.m5.1.1.2.cmml">u</mi><mi id="S4.SS2.p2.10.m5.1.1.3" xref="S4.SS2.p2.10.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m5.1b"><apply id="S4.SS2.p2.10.m5.1.1.cmml" xref="S4.SS2.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m5.1.1.1.cmml" xref="S4.SS2.p2.10.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m5.1.1.2.cmml" xref="S4.SS2.p2.10.m5.1.1.2">𝑢</ci><ci id="S4.SS2.p2.10.m5.1.1.3.cmml" xref="S4.SS2.p2.10.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m5.1c">u_{t}</annotation></semantics></math> via <math id="S4.SS2.p2.11.m6.4" class="ltx_Math" alttext="u_{t}=0.25+0.75*\left(\frac{1}{|S_{t}|}\sum_{k\in S_{t}}{\mathcal{L}}_{t,k}\right)/\log C" display="inline"><semantics id="S4.SS2.p2.11.m6.4a"><mrow id="S4.SS2.p2.11.m6.4.4" xref="S4.SS2.p2.11.m6.4.4.cmml"><msub id="S4.SS2.p2.11.m6.4.4.3" xref="S4.SS2.p2.11.m6.4.4.3.cmml"><mi id="S4.SS2.p2.11.m6.4.4.3.2" xref="S4.SS2.p2.11.m6.4.4.3.2.cmml">u</mi><mi id="S4.SS2.p2.11.m6.4.4.3.3" xref="S4.SS2.p2.11.m6.4.4.3.3.cmml">t</mi></msub><mo id="S4.SS2.p2.11.m6.4.4.2" xref="S4.SS2.p2.11.m6.4.4.2.cmml">=</mo><mrow id="S4.SS2.p2.11.m6.4.4.1" xref="S4.SS2.p2.11.m6.4.4.1.cmml"><mn id="S4.SS2.p2.11.m6.4.4.1.3" xref="S4.SS2.p2.11.m6.4.4.1.3.cmml">0.25</mn><mo id="S4.SS2.p2.11.m6.4.4.1.2" xref="S4.SS2.p2.11.m6.4.4.1.2.cmml">+</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1" xref="S4.SS2.p2.11.m6.4.4.1.1.cmml"><mrow id="S4.SS2.p2.11.m6.4.4.1.1.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.cmml"><mn id="S4.SS2.p2.11.m6.4.4.1.1.1.3" xref="S4.SS2.p2.11.m6.4.4.1.1.1.3.cmml">0.75</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.11.m6.4.4.1.1.1.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.2.cmml">∗</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.cmml"><mfrac id="S4.SS2.p2.11.m6.1.1" xref="S4.SS2.p2.11.m6.1.1.cmml"><mn id="S4.SS2.p2.11.m6.1.1.3" xref="S4.SS2.p2.11.m6.1.1.3.cmml">1</mn><mrow id="S4.SS2.p2.11.m6.1.1.1.1" xref="S4.SS2.p2.11.m6.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.11.m6.1.1.1.1.2" xref="S4.SS2.p2.11.m6.1.1.1.2.1.cmml">|</mo><msub id="S4.SS2.p2.11.m6.1.1.1.1.1" xref="S4.SS2.p2.11.m6.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.11.m6.1.1.1.1.1.2" xref="S4.SS2.p2.11.m6.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS2.p2.11.m6.1.1.1.1.1.3" xref="S4.SS2.p2.11.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS2.p2.11.m6.1.1.1.1.3" xref="S4.SS2.p2.11.m6.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.cmml"><msub id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.cmml"><mo id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.cmml"><mi id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.2.cmml">k</mi><mo id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.1" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.1.cmml">∈</mo><msub id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.cmml"><mi id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.2.cmml">S</mi><mi id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.3" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mrow id="S4.SS2.p2.11.m6.3.3.2.4" xref="S4.SS2.p2.11.m6.3.3.2.3.cmml"><mi id="S4.SS2.p2.11.m6.2.2.1.1" xref="S4.SS2.p2.11.m6.2.2.1.1.cmml">t</mi><mo id="S4.SS2.p2.11.m6.3.3.2.4.1" xref="S4.SS2.p2.11.m6.3.3.2.3.cmml">,</mo><mi id="S4.SS2.p2.11.m6.3.3.2.2" xref="S4.SS2.p2.11.m6.3.3.2.2.cmml">k</mi></mrow></msub></mrow></mrow><mo id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.3" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.11.m6.4.4.1.1.2" xref="S4.SS2.p2.11.m6.4.4.1.1.2.cmml">/</mo><mrow id="S4.SS2.p2.11.m6.4.4.1.1.3" xref="S4.SS2.p2.11.m6.4.4.1.1.3.cmml"><mi id="S4.SS2.p2.11.m6.4.4.1.1.3.1" xref="S4.SS2.p2.11.m6.4.4.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS2.p2.11.m6.4.4.1.1.3a" xref="S4.SS2.p2.11.m6.4.4.1.1.3.cmml">⁡</mo><mi id="S4.SS2.p2.11.m6.4.4.1.1.3.2" xref="S4.SS2.p2.11.m6.4.4.1.1.3.2.cmml">C</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m6.4b"><apply id="S4.SS2.p2.11.m6.4.4.cmml" xref="S4.SS2.p2.11.m6.4.4"><eq id="S4.SS2.p2.11.m6.4.4.2.cmml" xref="S4.SS2.p2.11.m6.4.4.2"></eq><apply id="S4.SS2.p2.11.m6.4.4.3.cmml" xref="S4.SS2.p2.11.m6.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m6.4.4.3.1.cmml" xref="S4.SS2.p2.11.m6.4.4.3">subscript</csymbol><ci id="S4.SS2.p2.11.m6.4.4.3.2.cmml" xref="S4.SS2.p2.11.m6.4.4.3.2">𝑢</ci><ci id="S4.SS2.p2.11.m6.4.4.3.3.cmml" xref="S4.SS2.p2.11.m6.4.4.3.3">𝑡</ci></apply><apply id="S4.SS2.p2.11.m6.4.4.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1"><plus id="S4.SS2.p2.11.m6.4.4.1.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.2"></plus><cn type="float" id="S4.SS2.p2.11.m6.4.4.1.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.3">0.25</cn><apply id="S4.SS2.p2.11.m6.4.4.1.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1"><divide id="S4.SS2.p2.11.m6.4.4.1.1.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.2"></divide><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1"><times id="S4.SS2.p2.11.m6.4.4.1.1.1.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.2"></times><cn type="float" id="S4.SS2.p2.11.m6.4.4.1.1.1.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.3">0.75</cn><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1"><times id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.1"></times><apply id="S4.SS2.p2.11.m6.1.1.cmml" xref="S4.SS2.p2.11.m6.1.1"><divide id="S4.SS2.p2.11.m6.1.1.2.cmml" xref="S4.SS2.p2.11.m6.1.1"></divide><cn type="integer" id="S4.SS2.p2.11.m6.1.1.3.cmml" xref="S4.SS2.p2.11.m6.1.1.3">1</cn><apply id="S4.SS2.p2.11.m6.1.1.1.2.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1"><abs id="S4.SS2.p2.11.m6.1.1.1.2.1.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1.2"></abs><apply id="S4.SS2.p2.11.m6.1.1.1.1.1.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m6.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.11.m6.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS2.p2.11.m6.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.11.m6.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2"><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.2"></sum><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3"><in id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.1"></in><ci id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.2">𝑘</ci><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.2">𝑆</ci><ci id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.1.1.1.1.2.2.2">ℒ</ci><list id="S4.SS2.p2.11.m6.3.3.2.3.cmml" xref="S4.SS2.p2.11.m6.3.3.2.4"><ci id="S4.SS2.p2.11.m6.2.2.1.1.cmml" xref="S4.SS2.p2.11.m6.2.2.1.1">𝑡</ci><ci id="S4.SS2.p2.11.m6.3.3.2.2.cmml" xref="S4.SS2.p2.11.m6.3.3.2.2">𝑘</ci></list></apply></apply></apply></apply><apply id="S4.SS2.p2.11.m6.4.4.1.1.3.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.3"><log id="S4.SS2.p2.11.m6.4.4.1.1.3.1.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.3.1"></log><ci id="S4.SS2.p2.11.m6.4.4.1.1.3.2.cmml" xref="S4.SS2.p2.11.m6.4.4.1.1.3.2">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m6.4c">u_{t}=0.25+0.75*\left(\frac{1}{|S_{t}|}\sum_{k\in S_{t}}{\mathcal{L}}_{t,k}\right)/\log C</annotation></semantics></math>. <math id="S4.SS2.p2.12.m7.2" class="ltx_Math" alttext="{\mathcal{L}}_{t,k}" display="inline"><semantics id="S4.SS2.p2.12.m7.2a"><msub id="S4.SS2.p2.12.m7.2.3" xref="S4.SS2.p2.12.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.12.m7.2.3.2" xref="S4.SS2.p2.12.m7.2.3.2.cmml">ℒ</mi><mrow id="S4.SS2.p2.12.m7.2.2.2.4" xref="S4.SS2.p2.12.m7.2.2.2.3.cmml"><mi id="S4.SS2.p2.12.m7.1.1.1.1" xref="S4.SS2.p2.12.m7.1.1.1.1.cmml">t</mi><mo id="S4.SS2.p2.12.m7.2.2.2.4.1" xref="S4.SS2.p2.12.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.12.m7.2.2.2.2" xref="S4.SS2.p2.12.m7.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m7.2b"><apply id="S4.SS2.p2.12.m7.2.3.cmml" xref="S4.SS2.p2.12.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m7.2.3.1.cmml" xref="S4.SS2.p2.12.m7.2.3">subscript</csymbol><ci id="S4.SS2.p2.12.m7.2.3.2.cmml" xref="S4.SS2.p2.12.m7.2.3.2">ℒ</ci><list id="S4.SS2.p2.12.m7.2.2.2.3.cmml" xref="S4.SS2.p2.12.m7.2.2.2.4"><ci id="S4.SS2.p2.12.m7.1.1.1.1.cmml" xref="S4.SS2.p2.12.m7.1.1.1.1">𝑡</ci><ci id="S4.SS2.p2.12.m7.2.2.2.2.cmml" xref="S4.SS2.p2.12.m7.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m7.2c">{\mathcal{L}}_{t,k}</annotation></semantics></math> denotes the local cross-entropy loss. With the loss becoming smaller, the aggregated models usually perform better and we enhance their influences. <span id="S4.SS2.p2.14.2" class="ltx_text ltx_font_italic">Notably, fusing the initial model <math id="S4.SS2.p2.13.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S4.SS2.p2.13.1.m1.1a"><msub id="S4.SS2.p2.13.1.m1.1.1" xref="S4.SS2.p2.13.1.m1.1.1.cmml"><mi id="S4.SS2.p2.13.1.m1.1.1.2" xref="S4.SS2.p2.13.1.m1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p2.13.1.m1.1.1.3" xref="S4.SS2.p2.13.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.1.m1.1b"><apply id="S4.SS2.p2.13.1.m1.1.1.cmml" xref="S4.SS2.p2.13.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.1.m1.1.1.1.cmml" xref="S4.SS2.p2.13.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.13.1.m1.1.1.2.cmml" xref="S4.SS2.p2.13.1.m1.1.1.2">𝜃</ci><ci id="S4.SS2.p2.13.1.m1.1.1.3.cmml" xref="S4.SS2.p2.13.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.1.m1.1c">\theta_{t}</annotation></semantics></math> (i.e., the aggregated model in previous round) and the aggregated model <math id="S4.SS2.p2.14.2.m2.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="S4.SS2.p2.14.2.m2.1a"><msub id="S4.SS2.p2.14.2.m2.1.1" xref="S4.SS2.p2.14.2.m2.1.1.cmml"><mi id="S4.SS2.p2.14.2.m2.1.1.2" xref="S4.SS2.p2.14.2.m2.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p2.14.2.m2.1.1.3" xref="S4.SS2.p2.14.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.14.2.m2.1.1.3.2" xref="S4.SS2.p2.14.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.14.2.m2.1.1.3.1" xref="S4.SS2.p2.14.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p2.14.2.m2.1.1.3.3" xref="S4.SS2.p2.14.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.2.m2.1b"><apply id="S4.SS2.p2.14.2.m2.1.1.cmml" xref="S4.SS2.p2.14.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.14.2.m2.1.1.1.cmml" xref="S4.SS2.p2.14.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.14.2.m2.1.1.2.cmml" xref="S4.SS2.p2.14.2.m2.1.1.2">𝜃</ci><apply id="S4.SS2.p2.14.2.m2.1.1.3.cmml" xref="S4.SS2.p2.14.2.m2.1.1.3"><plus id="S4.SS2.p2.14.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.14.2.m2.1.1.3.1"></plus><ci id="S4.SS2.p2.14.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.14.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p2.14.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.14.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.2.m2.1c">\theta_{t+1}</annotation></semantics></math> could work as temporal ensembling or self-teaching such as in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib41" title="" class="ltx_ref">TemporalEnsembling </a>; <a href="#bib.bib42" title="" class="ltx_ref">MeanTeacher </a>; <a href="#bib.bib43" title="" class="ltx_ref">FedPHP </a></cite>.</span></p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Clustered Label Refinery</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.3" class="ltx_p">The aforementioned two modules separately provide solutions for the problem of varying magnitudes and improper distillation in FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>. Only with these two modules, we could already yield better performances compared with FedDF. However, we additionally introduce other techniques to further enhance the stability and quality of the distillation targets. We take advantage of deep clustering <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib44" title="" class="ltx_ref">DeepCluster </a></cite> to <span id="S4.SS3.p1.3.1" class="ltx_text ltx_font_italic">consider feature structural information</span>. This technique has been verified beneficial in domain adaptation <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib45" title="" class="ltx_ref">SHOT </a></cite> and transductive few-shot learning <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib7" title="" class="ltx_ref">TransductiveFewShot-ICLR2019 </a></cite>. Formally, we denote the obtained distillation targets as <math id="S4.SS3.p1.1.m1.3" class="ltx_Math" alttext="\overline{q}(y|{\mathbf{x}})=\overline{q}_{\text{RAP},t}" display="inline"><semantics id="S4.SS3.p1.1.m1.3a"><mrow id="S4.SS3.p1.1.m1.3.3" xref="S4.SS3.p1.1.m1.3.3.cmml"><mrow id="S4.SS3.p1.1.m1.3.3.1" xref="S4.SS3.p1.1.m1.3.3.1.cmml"><mover accent="true" id="S4.SS3.p1.1.m1.3.3.1.3" xref="S4.SS3.p1.1.m1.3.3.1.3.cmml"><mi id="S4.SS3.p1.1.m1.3.3.1.3.2" xref="S4.SS3.p1.1.m1.3.3.1.3.2.cmml">q</mi><mo id="S4.SS3.p1.1.m1.3.3.1.3.1" xref="S4.SS3.p1.1.m1.3.3.1.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.3.3.1.2" xref="S4.SS3.p1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S4.SS3.p1.1.m1.3.3.1.1.1" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.3.3.1.1.1.2" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.1.m1.3.3.1.1.1.1" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.3.3.1.1.1.1.2" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS3.p1.1.m1.3.3.1.1.1.1.1" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="S4.SS3.p1.1.m1.3.3.1.1.1.1.3" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.SS3.p1.1.m1.3.3.1.1.1.3" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.1.m1.3.3.2" xref="S4.SS3.p1.1.m1.3.3.2.cmml">=</mo><msub id="S4.SS3.p1.1.m1.3.3.3" xref="S4.SS3.p1.1.m1.3.3.3.cmml"><mover accent="true" id="S4.SS3.p1.1.m1.3.3.3.2" xref="S4.SS3.p1.1.m1.3.3.3.2.cmml"><mi id="S4.SS3.p1.1.m1.3.3.3.2.2" xref="S4.SS3.p1.1.m1.3.3.3.2.2.cmml">q</mi><mo id="S4.SS3.p1.1.m1.3.3.3.2.1" xref="S4.SS3.p1.1.m1.3.3.3.2.1.cmml">¯</mo></mover><mrow id="S4.SS3.p1.1.m1.2.2.2.4" xref="S4.SS3.p1.1.m1.2.2.2.3.cmml"><mtext id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1a.cmml">RAP</mtext><mo id="S4.SS3.p1.1.m1.2.2.2.4.1" xref="S4.SS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p1.1.m1.2.2.2.2" xref="S4.SS3.p1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.3b"><apply id="S4.SS3.p1.1.m1.3.3.cmml" xref="S4.SS3.p1.1.m1.3.3"><eq id="S4.SS3.p1.1.m1.3.3.2.cmml" xref="S4.SS3.p1.1.m1.3.3.2"></eq><apply id="S4.SS3.p1.1.m1.3.3.1.cmml" xref="S4.SS3.p1.1.m1.3.3.1"><times id="S4.SS3.p1.1.m1.3.3.1.2.cmml" xref="S4.SS3.p1.1.m1.3.3.1.2"></times><apply id="S4.SS3.p1.1.m1.3.3.1.3.cmml" xref="S4.SS3.p1.1.m1.3.3.1.3"><ci id="S4.SS3.p1.1.m1.3.3.1.3.1.cmml" xref="S4.SS3.p1.1.m1.3.3.1.3.1">¯</ci><ci id="S4.SS3.p1.1.m1.3.3.1.3.2.cmml" xref="S4.SS3.p1.1.m1.3.3.1.3.2">𝑞</ci></apply><apply id="S4.SS3.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="S4.SS3.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.3.3.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.SS3.p1.1.m1.3.3.3.cmml" xref="S4.SS3.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.3.3.3.1.cmml" xref="S4.SS3.p1.1.m1.3.3.3">subscript</csymbol><apply id="S4.SS3.p1.1.m1.3.3.3.2.cmml" xref="S4.SS3.p1.1.m1.3.3.3.2"><ci id="S4.SS3.p1.1.m1.3.3.3.2.1.cmml" xref="S4.SS3.p1.1.m1.3.3.3.2.1">¯</ci><ci id="S4.SS3.p1.1.m1.3.3.3.2.2.cmml" xref="S4.SS3.p1.1.m1.3.3.3.2.2">𝑞</ci></apply><list id="S4.SS3.p1.1.m1.2.2.2.3.cmml" xref="S4.SS3.p1.1.m1.2.2.2.4"><ci id="S4.SS3.p1.1.m1.1.1.1.1a.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1">RAP</mtext></ci><ci id="S4.SS3.p1.1.m1.2.2.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2.2.2">𝑡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.3c">\overline{q}(y|{\mathbf{x}})=\overline{q}_{\text{RAP},t}</annotation></semantics></math> (Eq. <a href="#S4.E10" title="In 4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). We extract hidden feature representations via the aggregated global model <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">θ</mi><mrow id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p1.2.m2.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝜃</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><plus id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.1"></plus><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\theta_{t+1}</annotation></semantics></math> and denote the features as <math id="S4.SS3.p1.3.m3.3" class="ltx_Math" alttext="\{h({\mathbf{x}})\}_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}" display="inline"><semantics id="S4.SS3.p1.3.m3.3a"><msub id="S4.SS3.p1.3.m3.3.3" xref="S4.SS3.p1.3.m3.3.3.cmml"><mrow id="S4.SS3.p1.3.m3.3.3.1.1" xref="S4.SS3.p1.3.m3.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.1.1.2" xref="S4.SS3.p1.3.m3.3.3.1.2.cmml">{</mo><mrow id="S4.SS3.p1.3.m3.3.3.1.1.1" xref="S4.SS3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS3.p1.3.m3.3.3.1.1.1.2" xref="S4.SS3.p1.3.m3.3.3.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.3.3.1.1.1.1" xref="S4.SS3.p1.3.m3.3.3.1.1.1.1.cmml">​</mo><mrow id="S4.SS3.p1.3.m3.3.3.1.1.1.3.2" xref="S4.SS3.p1.3.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.1.1.1.3.2.1" xref="S4.SS3.p1.3.m3.3.3.1.1.1.cmml">(</mo><mi id="S4.SS3.p1.3.m3.2.2" xref="S4.SS3.p1.3.m3.2.2.cmml">𝐱</mi><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.1.1.1.3.2.2" xref="S4.SS3.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.1.1.3" xref="S4.SS3.p1.3.m3.3.3.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.3.cmml">𝐱</mi><mo id="S4.SS3.p1.3.m3.1.1.1.2" xref="S4.SS3.p1.3.m3.1.1.1.2.cmml">∼</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.4" xref="S4.SS3.p1.3.m3.1.1.1.4.cmml"><msub id="S4.SS3.p1.3.m3.1.1.1.4.2" xref="S4.SS3.p1.3.m3.1.1.1.4.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.4.2.2" xref="S4.SS3.p1.3.m3.1.1.1.4.2.2.cmml">p</mi><mtext id="S4.SS3.p1.3.m3.1.1.1.4.2.3" xref="S4.SS3.p1.3.m3.1.1.1.4.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.1.4.1" xref="S4.SS3.p1.3.m3.1.1.1.4.1.cmml">​</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.4.3.2" xref="S4.SS3.p1.3.m3.1.1.1.4.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.1.1.1.4.3.2.1" xref="S4.SS3.p1.3.m3.1.1.1.4.cmml">(</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.SS3.p1.3.m3.1.1.1.4.3.2.2" xref="S4.SS3.p1.3.m3.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.3b"><apply id="S4.SS3.p1.3.m3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.3.3.2.cmml" xref="S4.SS3.p1.3.m3.3.3">subscript</csymbol><set id="S4.SS3.p1.3.m3.3.3.1.2.cmml" xref="S4.SS3.p1.3.m3.3.3.1.1"><apply id="S4.SS3.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.3.3.1.1.1"><times id="S4.SS3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.3.3.1.1.1.1"></times><ci id="S4.SS3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.3.3.1.1.1.2">ℎ</ci><ci id="S4.SS3.p1.3.m3.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2">𝐱</ci></apply></set><apply id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.3.m3.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.2">similar-to</csymbol><ci id="S4.SS3.p1.3.m3.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3">𝐱</ci><apply id="S4.SS3.p1.3.m3.1.1.1.4.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4"><times id="S4.SS3.p1.3.m3.1.1.1.4.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.1"></times><apply id="S4.SS3.p1.3.m3.1.1.1.4.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.4.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.1.4.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.2.2">𝑝</ci><ci id="S4.SS3.p1.3.m3.1.1.1.4.2.3a.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.2.3"><mtext mathsize="50%" id="S4.SS3.p1.3.m3.1.1.1.4.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.4.2.3">g</mtext></ci></apply><ci id="S4.SS3.p1.3.m3.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.3c">\{h({\mathbf{x}})\}_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}</annotation></semantics></math>. Then we further improve the distillation targets:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E11.m1.6" class="ltx_Math" alttext="{\mathbf{v}}_{c}=\frac{E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[\overline{q}_{c}(y|{\mathbf{x}})h({\mathbf{x}})\right]}{E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[\overline{q}_{c}(y|{\mathbf{x}})\right]}," display="block"><semantics id="S4.E11.m1.6a"><mrow id="S4.E11.m1.6.6.1" xref="S4.E11.m1.6.6.1.1.cmml"><mrow id="S4.E11.m1.6.6.1.1" xref="S4.E11.m1.6.6.1.1.cmml"><msub id="S4.E11.m1.6.6.1.1.2" xref="S4.E11.m1.6.6.1.1.2.cmml"><mi id="S4.E11.m1.6.6.1.1.2.2" xref="S4.E11.m1.6.6.1.1.2.2.cmml">𝐯</mi><mi id="S4.E11.m1.6.6.1.1.2.3" xref="S4.E11.m1.6.6.1.1.2.3.cmml">c</mi></msub><mo id="S4.E11.m1.6.6.1.1.1" xref="S4.E11.m1.6.6.1.1.1.cmml">=</mo><mfrac id="S4.E11.m1.5.5" xref="S4.E11.m1.5.5.cmml"><mrow id="S4.E11.m1.3.3.3" xref="S4.E11.m1.3.3.3.cmml"><msub id="S4.E11.m1.3.3.3.5" xref="S4.E11.m1.3.3.3.5.cmml"><mi id="S4.E11.m1.3.3.3.5.2" xref="S4.E11.m1.3.3.3.5.2.cmml">E</mi><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml">𝐱</mi><mo id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S4.E11.m1.1.1.1.1.1.4" xref="S4.E11.m1.1.1.1.1.1.4.cmml"><msub id="S4.E11.m1.1.1.1.1.1.4.2" xref="S4.E11.m1.1.1.1.1.1.4.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.4.2.2" xref="S4.E11.m1.1.1.1.1.1.4.2.2.cmml">p</mi><mtext id="S4.E11.m1.1.1.1.1.1.4.2.3" xref="S4.E11.m1.1.1.1.1.1.4.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.1.1.1.1.4.1" xref="S4.E11.m1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="S4.E11.m1.1.1.1.1.1.4.3.2" xref="S4.E11.m1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.4.3.2.1" xref="S4.E11.m1.1.1.1.1.1.4.cmml">(</mo><mi id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.4.3.2.2" xref="S4.E11.m1.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.4" xref="S4.E11.m1.3.3.3.4.cmml">​</mo><mrow id="S4.E11.m1.3.3.3.3.1" xref="S4.E11.m1.3.3.3.3.2.cmml"><mo id="S4.E11.m1.3.3.3.3.1.2" xref="S4.E11.m1.3.3.3.3.2.1.cmml">[</mo><mrow id="S4.E11.m1.3.3.3.3.1.1" xref="S4.E11.m1.3.3.3.3.1.1.cmml"><msub id="S4.E11.m1.3.3.3.3.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.3.cmml"><mover accent="true" id="S4.E11.m1.3.3.3.3.1.1.3.2" xref="S4.E11.m1.3.3.3.3.1.1.3.2.cmml"><mi id="S4.E11.m1.3.3.3.3.1.1.3.2.2" xref="S4.E11.m1.3.3.3.3.1.1.3.2.2.cmml">q</mi><mo id="S4.E11.m1.3.3.3.3.1.1.3.2.1" xref="S4.E11.m1.3.3.3.3.1.1.3.2.1.cmml">¯</mo></mover><mi id="S4.E11.m1.3.3.3.3.1.1.3.3" xref="S4.E11.m1.3.3.3.3.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.3.1.1.2" xref="S4.E11.m1.3.3.3.3.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.3.3.3.3.1.1.1.1" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.1.1.2" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.3.3.3.3.1.1.1.1.1" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E11.m1.3.3.3.3.1.1.1.1.1.1" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E11.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.3.1.1.2a" xref="S4.E11.m1.3.3.3.3.1.1.2.cmml">​</mo><mi id="S4.E11.m1.3.3.3.3.1.1.4" xref="S4.E11.m1.3.3.3.3.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.3.3.3.3.1.1.2b" xref="S4.E11.m1.3.3.3.3.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.3.3.3.3.1.1.5.2" xref="S4.E11.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.5.2.1" xref="S4.E11.m1.3.3.3.3.1.1.cmml">(</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">𝐱</mi><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.5.2.2" xref="S4.E11.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.3.3.3.3.1.3" xref="S4.E11.m1.3.3.3.3.2.1.cmml">]</mo></mrow></mrow><mrow id="S4.E11.m1.5.5.5" xref="S4.E11.m1.5.5.5.cmml"><msub id="S4.E11.m1.5.5.5.4" xref="S4.E11.m1.5.5.5.4.cmml"><mi id="S4.E11.m1.5.5.5.4.2" xref="S4.E11.m1.5.5.5.4.2.cmml">E</mi><mrow id="S4.E11.m1.4.4.4.1.1" xref="S4.E11.m1.4.4.4.1.1.cmml"><mi id="S4.E11.m1.4.4.4.1.1.3" xref="S4.E11.m1.4.4.4.1.1.3.cmml">𝐱</mi><mo id="S4.E11.m1.4.4.4.1.1.2" xref="S4.E11.m1.4.4.4.1.1.2.cmml">∼</mo><mrow id="S4.E11.m1.4.4.4.1.1.4" xref="S4.E11.m1.4.4.4.1.1.4.cmml"><msub id="S4.E11.m1.4.4.4.1.1.4.2" xref="S4.E11.m1.4.4.4.1.1.4.2.cmml"><mi id="S4.E11.m1.4.4.4.1.1.4.2.2" xref="S4.E11.m1.4.4.4.1.1.4.2.2.cmml">p</mi><mtext id="S4.E11.m1.4.4.4.1.1.4.2.3" xref="S4.E11.m1.4.4.4.1.1.4.2.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.1.1.4.1" xref="S4.E11.m1.4.4.4.1.1.4.1.cmml">​</mo><mrow id="S4.E11.m1.4.4.4.1.1.4.3.2" xref="S4.E11.m1.4.4.4.1.1.4.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.4.1.1.4.3.2.1" xref="S4.E11.m1.4.4.4.1.1.4.cmml">(</mo><mi id="S4.E11.m1.4.4.4.1.1.1" xref="S4.E11.m1.4.4.4.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E11.m1.4.4.4.1.1.4.3.2.2" xref="S4.E11.m1.4.4.4.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.5.3" xref="S4.E11.m1.5.5.5.3.cmml">​</mo><mrow id="S4.E11.m1.5.5.5.2.1" xref="S4.E11.m1.5.5.5.2.2.cmml"><mo id="S4.E11.m1.5.5.5.2.1.2" xref="S4.E11.m1.5.5.5.2.2.1.cmml">[</mo><mrow id="S4.E11.m1.5.5.5.2.1.1" xref="S4.E11.m1.5.5.5.2.1.1.cmml"><msub id="S4.E11.m1.5.5.5.2.1.1.3" xref="S4.E11.m1.5.5.5.2.1.1.3.cmml"><mover accent="true" id="S4.E11.m1.5.5.5.2.1.1.3.2" xref="S4.E11.m1.5.5.5.2.1.1.3.2.cmml"><mi id="S4.E11.m1.5.5.5.2.1.1.3.2.2" xref="S4.E11.m1.5.5.5.2.1.1.3.2.2.cmml">q</mi><mo id="S4.E11.m1.5.5.5.2.1.1.3.2.1" xref="S4.E11.m1.5.5.5.2.1.1.3.2.1.cmml">¯</mo></mover><mi id="S4.E11.m1.5.5.5.2.1.1.3.3" xref="S4.E11.m1.5.5.5.2.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.5.2.1.1.2" xref="S4.E11.m1.5.5.5.2.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.5.5.5.2.1.1.1.1" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.5.5.5.2.1.1.1.1.2" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.5.5.5.2.1.1.1.1.1" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.cmml"><mi id="S4.E11.m1.5.5.5.2.1.1.1.1.1.2" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E11.m1.5.5.5.2.1.1.1.1.1.1" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E11.m1.5.5.5.2.1.1.1.1.1.3" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E11.m1.5.5.5.2.1.1.1.1.3" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.5.2.1.3" xref="S4.E11.m1.5.5.5.2.2.1.cmml">]</mo></mrow></mrow></mfrac></mrow><mo id="S4.E11.m1.6.6.1.2" xref="S4.E11.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.6b"><apply id="S4.E11.m1.6.6.1.1.cmml" xref="S4.E11.m1.6.6.1"><eq id="S4.E11.m1.6.6.1.1.1.cmml" xref="S4.E11.m1.6.6.1.1.1"></eq><apply id="S4.E11.m1.6.6.1.1.2.cmml" xref="S4.E11.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.6.6.1.1.2.1.cmml" xref="S4.E11.m1.6.6.1.1.2">subscript</csymbol><ci id="S4.E11.m1.6.6.1.1.2.2.cmml" xref="S4.E11.m1.6.6.1.1.2.2">𝐯</ci><ci id="S4.E11.m1.6.6.1.1.2.3.cmml" xref="S4.E11.m1.6.6.1.1.2.3">𝑐</ci></apply><apply id="S4.E11.m1.5.5.cmml" xref="S4.E11.m1.5.5"><divide id="S4.E11.m1.5.5.6.cmml" xref="S4.E11.m1.5.5"></divide><apply id="S4.E11.m1.3.3.3.cmml" xref="S4.E11.m1.3.3.3"><times id="S4.E11.m1.3.3.3.4.cmml" xref="S4.E11.m1.3.3.3.4"></times><apply id="S4.E11.m1.3.3.3.5.cmml" xref="S4.E11.m1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.5.1.cmml" xref="S4.E11.m1.3.3.3.5">subscript</csymbol><ci id="S4.E11.m1.3.3.3.5.2.cmml" xref="S4.E11.m1.3.3.3.5.2">𝐸</ci><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2">similar-to</csymbol><ci id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3">𝐱</ci><apply id="S4.E11.m1.1.1.1.1.1.4.cmml" xref="S4.E11.m1.1.1.1.1.1.4"><times id="S4.E11.m1.1.1.1.1.1.4.1.cmml" xref="S4.E11.m1.1.1.1.1.1.4.1"></times><apply id="S4.E11.m1.1.1.1.1.1.4.2.cmml" xref="S4.E11.m1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.4.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.4.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.4.2.2">𝑝</ci><ci id="S4.E11.m1.1.1.1.1.1.4.2.3a.cmml" xref="S4.E11.m1.1.1.1.1.1.4.2.3"><mtext mathsize="50%" id="S4.E11.m1.1.1.1.1.1.4.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.4.2.3">g</mtext></ci></apply><ci id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">𝐱</ci></apply></apply></apply><apply id="S4.E11.m1.3.3.3.3.2.cmml" xref="S4.E11.m1.3.3.3.3.1"><csymbol cd="latexml" id="S4.E11.m1.3.3.3.3.2.1.cmml" xref="S4.E11.m1.3.3.3.3.1.2">delimited-[]</csymbol><apply id="S4.E11.m1.3.3.3.3.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1"><times id="S4.E11.m1.3.3.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1.2"></times><apply id="S4.E11.m1.3.3.3.3.1.1.3.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3">subscript</csymbol><apply id="S4.E11.m1.3.3.3.3.1.1.3.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3.2"><ci id="S4.E11.m1.3.3.3.3.1.1.3.2.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3.2.1">¯</ci><ci id="S4.E11.m1.3.3.3.3.1.1.3.2.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3.2.2">𝑞</ci></apply><ci id="S4.E11.m1.3.3.3.3.1.1.3.3.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3.3">𝑐</ci></apply><apply id="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E11.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.2">𝑦</ci><ci id="S4.E11.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.3">𝐱</ci></apply><ci id="S4.E11.m1.3.3.3.3.1.1.4.cmml" xref="S4.E11.m1.3.3.3.3.1.1.4">ℎ</ci><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">𝐱</ci></apply></apply></apply><apply id="S4.E11.m1.5.5.5.cmml" xref="S4.E11.m1.5.5.5"><times id="S4.E11.m1.5.5.5.3.cmml" xref="S4.E11.m1.5.5.5.3"></times><apply id="S4.E11.m1.5.5.5.4.cmml" xref="S4.E11.m1.5.5.5.4"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.5.4.1.cmml" xref="S4.E11.m1.5.5.5.4">subscript</csymbol><ci id="S4.E11.m1.5.5.5.4.2.cmml" xref="S4.E11.m1.5.5.5.4.2">𝐸</ci><apply id="S4.E11.m1.4.4.4.1.1.cmml" xref="S4.E11.m1.4.4.4.1.1"><csymbol cd="latexml" id="S4.E11.m1.4.4.4.1.1.2.cmml" xref="S4.E11.m1.4.4.4.1.1.2">similar-to</csymbol><ci id="S4.E11.m1.4.4.4.1.1.3.cmml" xref="S4.E11.m1.4.4.4.1.1.3">𝐱</ci><apply id="S4.E11.m1.4.4.4.1.1.4.cmml" xref="S4.E11.m1.4.4.4.1.1.4"><times id="S4.E11.m1.4.4.4.1.1.4.1.cmml" xref="S4.E11.m1.4.4.4.1.1.4.1"></times><apply id="S4.E11.m1.4.4.4.1.1.4.2.cmml" xref="S4.E11.m1.4.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.1.1.4.2.1.cmml" xref="S4.E11.m1.4.4.4.1.1.4.2">subscript</csymbol><ci id="S4.E11.m1.4.4.4.1.1.4.2.2.cmml" xref="S4.E11.m1.4.4.4.1.1.4.2.2">𝑝</ci><ci id="S4.E11.m1.4.4.4.1.1.4.2.3a.cmml" xref="S4.E11.m1.4.4.4.1.1.4.2.3"><mtext mathsize="50%" id="S4.E11.m1.4.4.4.1.1.4.2.3.cmml" xref="S4.E11.m1.4.4.4.1.1.4.2.3">g</mtext></ci></apply><ci id="S4.E11.m1.4.4.4.1.1.1.cmml" xref="S4.E11.m1.4.4.4.1.1.1">𝐱</ci></apply></apply></apply><apply id="S4.E11.m1.5.5.5.2.2.cmml" xref="S4.E11.m1.5.5.5.2.1"><csymbol cd="latexml" id="S4.E11.m1.5.5.5.2.2.1.cmml" xref="S4.E11.m1.5.5.5.2.1.2">delimited-[]</csymbol><apply id="S4.E11.m1.5.5.5.2.1.1.cmml" xref="S4.E11.m1.5.5.5.2.1.1"><times id="S4.E11.m1.5.5.5.2.1.1.2.cmml" xref="S4.E11.m1.5.5.5.2.1.1.2"></times><apply id="S4.E11.m1.5.5.5.2.1.1.3.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.5.2.1.1.3.1.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3">subscript</csymbol><apply id="S4.E11.m1.5.5.5.2.1.1.3.2.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3.2"><ci id="S4.E11.m1.5.5.5.2.1.1.3.2.1.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3.2.1">¯</ci><ci id="S4.E11.m1.5.5.5.2.1.1.3.2.2.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3.2.2">𝑞</ci></apply><ci id="S4.E11.m1.5.5.5.2.1.1.3.3.cmml" xref="S4.E11.m1.5.5.5.2.1.1.3.3">𝑐</ci></apply><apply id="S4.E11.m1.5.5.5.2.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.5.2.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.5.5.5.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E11.m1.5.5.5.2.1.1.1.1.1.2.cmml" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.2">𝑦</ci><ci id="S4.E11.m1.5.5.5.2.1.1.1.1.1.3.cmml" xref="S4.E11.m1.5.5.5.2.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.6c">{\mathbf{v}}_{c}=\frac{E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[\overline{q}_{c}(y|{\mathbf{x}})h({\mathbf{x}})\right]}{E_{{\mathbf{x}}\sim p_{\text{g}}({\mathbf{x}})}\left[\overline{q}_{c}(y|{\mathbf{x}})\right]},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E12.m1.2" class="ltx_Math" alttext="\overline{q}(y|{\mathbf{x}})=\sigma\left(\{-1.0*\tau*D_{f}(h({\mathbf{x}}),{\mathbf{v}}_{c})\}_{c=1}^{C}\right)," display="block"><semantics id="S4.E12.m1.2a"><mrow id="S4.E12.m1.2.2.1" xref="S4.E12.m1.2.2.1.1.cmml"><mrow id="S4.E12.m1.2.2.1.1" xref="S4.E12.m1.2.2.1.1.cmml"><mrow id="S4.E12.m1.2.2.1.1.1" xref="S4.E12.m1.2.2.1.1.1.cmml"><mover accent="true" id="S4.E12.m1.2.2.1.1.1.3" xref="S4.E12.m1.2.2.1.1.1.3.cmml"><mi id="S4.E12.m1.2.2.1.1.1.3.2" xref="S4.E12.m1.2.2.1.1.1.3.2.cmml">q</mi><mo id="S4.E12.m1.2.2.1.1.1.3.1" xref="S4.E12.m1.2.2.1.1.1.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.1.1.2" xref="S4.E12.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.2.2.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.2.2.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.2.2.1.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.E12.m1.2.2.1.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E12.m1.2.2.1.1.1.1.1.1.3" xref="S4.E12.m1.2.2.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.E12.m1.2.2.1.1.1.1.1.3" xref="S4.E12.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.2.2.1.1.3" xref="S4.E12.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E12.m1.2.2.1.1.2" xref="S4.E12.m1.2.2.1.1.2.cmml"><mi id="S4.E12.m1.2.2.1.1.2.3" xref="S4.E12.m1.2.2.1.1.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.1.2.2" xref="S4.E12.m1.2.2.1.1.2.2.cmml">​</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S4.E12.m1.2.2.1.1.2.1.1.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.cmml">(</mo><msubsup id="S4.E12.m1.2.2.1.1.2.1.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.cmml"><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1a" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.cmml"><mn id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.2.cmml">1.0</mn><mo lspace="0.222em" rspace="0.222em" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1.cmml">∗</mo><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.3.cmml">τ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1a" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1.cmml">∗</mo><msub id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.cmml"><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.2.cmml">D</mi><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.3.cmml">f</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐯</mi><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">c</mi><mo id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.1" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">=</mo><mn id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.2.2.1.1.2.1.1.1.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.3.cmml">C</mi></msubsup><mo id="S4.E12.m1.2.2.1.1.2.1.1.3" xref="S4.E12.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.2.2.1.2" xref="S4.E12.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.2b"><apply id="S4.E12.m1.2.2.1.1.cmml" xref="S4.E12.m1.2.2.1"><eq id="S4.E12.m1.2.2.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.3"></eq><apply id="S4.E12.m1.2.2.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1"><times id="S4.E12.m1.2.2.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.1.2"></times><apply id="S4.E12.m1.2.2.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.1.3"><ci id="S4.E12.m1.2.2.1.1.1.3.1.cmml" xref="S4.E12.m1.2.2.1.1.1.3.1">¯</ci><ci id="S4.E12.m1.2.2.1.1.1.3.2.cmml" xref="S4.E12.m1.2.2.1.1.1.3.2">𝑞</ci></apply><apply id="S4.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S4.E12.m1.2.2.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2"><times id="S4.E12.m1.2.2.1.1.2.2.cmml" xref="S4.E12.m1.2.2.1.1.2.2"></times><ci id="S4.E12.m1.2.2.1.1.2.3.cmml" xref="S4.E12.m1.2.2.1.1.2.3">𝜎</ci><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1">superscript</csymbol><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1">subscript</csymbol><set id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1"><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1"><minus id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2"><times id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4"><times id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.1"></times><cn type="float" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.2">1.0</cn><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.3">𝜏</ci><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4">subscript</csymbol><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.2">𝐷</ci><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.4.4.3">𝑓</ci></apply></apply><interval closure="open" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1">𝐱</ci></apply><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.2">𝐯</ci><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.2.2.3">𝑐</ci></apply></interval></apply></apply></set><apply id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3"><eq id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.1"></eq><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E12.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S4.E12.m1.2.2.1.1.2.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.2c">\overline{q}(y|{\mathbf{x}})=\sigma\left(\{-1.0*\tau*D_{f}(h({\mathbf{x}}),{\mathbf{v}}_{c})\}_{c=1}^{C}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.7" class="ltx_p">where <math id="S4.SS3.p1.4.m1.2" class="ltx_Math" alttext="D_{f}(\cdot,\cdot)" display="inline"><semantics id="S4.SS3.p1.4.m1.2a"><mrow id="S4.SS3.p1.4.m1.2.3" xref="S4.SS3.p1.4.m1.2.3.cmml"><msub id="S4.SS3.p1.4.m1.2.3.2" xref="S4.SS3.p1.4.m1.2.3.2.cmml"><mi id="S4.SS3.p1.4.m1.2.3.2.2" xref="S4.SS3.p1.4.m1.2.3.2.2.cmml">D</mi><mi id="S4.SS3.p1.4.m1.2.3.2.3" xref="S4.SS3.p1.4.m1.2.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m1.2.3.1" xref="S4.SS3.p1.4.m1.2.3.1.cmml">​</mo><mrow id="S4.SS3.p1.4.m1.2.3.3.2" xref="S4.SS3.p1.4.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m1.2.3.3.2.1" xref="S4.SS3.p1.4.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m1.1.1" xref="S4.SS3.p1.4.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS3.p1.4.m1.2.3.3.2.2" xref="S4.SS3.p1.4.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m1.2.2" xref="S4.SS3.p1.4.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p1.4.m1.2.3.3.2.3" xref="S4.SS3.p1.4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m1.2b"><apply id="S4.SS3.p1.4.m1.2.3.cmml" xref="S4.SS3.p1.4.m1.2.3"><times id="S4.SS3.p1.4.m1.2.3.1.cmml" xref="S4.SS3.p1.4.m1.2.3.1"></times><apply id="S4.SS3.p1.4.m1.2.3.2.cmml" xref="S4.SS3.p1.4.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m1.2.3.2.1.cmml" xref="S4.SS3.p1.4.m1.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.4.m1.2.3.2.2.cmml" xref="S4.SS3.p1.4.m1.2.3.2.2">𝐷</ci><ci id="S4.SS3.p1.4.m1.2.3.2.3.cmml" xref="S4.SS3.p1.4.m1.2.3.2.3">𝑓</ci></apply><interval closure="open" id="S4.SS3.p1.4.m1.2.3.3.1.cmml" xref="S4.SS3.p1.4.m1.2.3.3.2"><ci id="S4.SS3.p1.4.m1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1">⋅</ci><ci id="S4.SS3.p1.4.m1.2.2.cmml" xref="S4.SS3.p1.4.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m1.2c">D_{f}(\cdot,\cdot)</annotation></semantics></math> is a distance metric and we use <math id="S4.SS3.p1.5.m2.4" class="ltx_Math" alttext="D_{f}({\mathbf{x}}_{1},{\mathbf{x}}_{2})=1.0-\frac{{\mathbf{x}}_{1}^{T}{\mathbf{x}}_{2}}{\lVert{\mathbf{x}}_{1}\rVert\lVert{\mathbf{x}}_{2}\rVert}" display="inline"><semantics id="S4.SS3.p1.5.m2.4a"><mrow id="S4.SS3.p1.5.m2.4.4" xref="S4.SS3.p1.5.m2.4.4.cmml"><mrow id="S4.SS3.p1.5.m2.4.4.2" xref="S4.SS3.p1.5.m2.4.4.2.cmml"><msub id="S4.SS3.p1.5.m2.4.4.2.4" xref="S4.SS3.p1.5.m2.4.4.2.4.cmml"><mi id="S4.SS3.p1.5.m2.4.4.2.4.2" xref="S4.SS3.p1.5.m2.4.4.2.4.2.cmml">D</mi><mi id="S4.SS3.p1.5.m2.4.4.2.4.3" xref="S4.SS3.p1.5.m2.4.4.2.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m2.4.4.2.3" xref="S4.SS3.p1.5.m2.4.4.2.3.cmml">​</mo><mrow id="S4.SS3.p1.5.m2.4.4.2.2.2" xref="S4.SS3.p1.5.m2.4.4.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.5.m2.4.4.2.2.2.3" xref="S4.SS3.p1.5.m2.4.4.2.2.3.cmml">(</mo><msub id="S4.SS3.p1.5.m2.3.3.1.1.1.1" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS3.p1.5.m2.3.3.1.1.1.1.2" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.3.3.1.1.1.1.3" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p1.5.m2.4.4.2.2.2.4" xref="S4.SS3.p1.5.m2.4.4.2.2.3.cmml">,</mo><msub id="S4.SS3.p1.5.m2.4.4.2.2.2.2" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2.cmml"><mi id="S4.SS3.p1.5.m2.4.4.2.2.2.2.2" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.4.4.2.2.2.2.3" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S4.SS3.p1.5.m2.4.4.2.2.2.5" xref="S4.SS3.p1.5.m2.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.5.m2.4.4.3" xref="S4.SS3.p1.5.m2.4.4.3.cmml">=</mo><mrow id="S4.SS3.p1.5.m2.4.4.4" xref="S4.SS3.p1.5.m2.4.4.4.cmml"><mn id="S4.SS3.p1.5.m2.4.4.4.2" xref="S4.SS3.p1.5.m2.4.4.4.2.cmml">1.0</mn><mo id="S4.SS3.p1.5.m2.4.4.4.1" xref="S4.SS3.p1.5.m2.4.4.4.1.cmml">−</mo><mfrac id="S4.SS3.p1.5.m2.2.2" xref="S4.SS3.p1.5.m2.2.2.cmml"><mrow id="S4.SS3.p1.5.m2.2.2.4" xref="S4.SS3.p1.5.m2.2.2.4.cmml"><msubsup id="S4.SS3.p1.5.m2.2.2.4.2" xref="S4.SS3.p1.5.m2.2.2.4.2.cmml"><mi id="S4.SS3.p1.5.m2.2.2.4.2.2.2" xref="S4.SS3.p1.5.m2.2.2.4.2.2.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.2.2.4.2.2.3" xref="S4.SS3.p1.5.m2.2.2.4.2.2.3.cmml">1</mn><mi id="S4.SS3.p1.5.m2.2.2.4.2.3" xref="S4.SS3.p1.5.m2.2.2.4.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m2.2.2.4.1" xref="S4.SS3.p1.5.m2.2.2.4.1.cmml">​</mo><msub id="S4.SS3.p1.5.m2.2.2.4.3" xref="S4.SS3.p1.5.m2.2.2.4.3.cmml"><mi id="S4.SS3.p1.5.m2.2.2.4.3.2" xref="S4.SS3.p1.5.m2.2.2.4.3.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.2.2.4.3.3" xref="S4.SS3.p1.5.m2.2.2.4.3.3.cmml">2</mn></msub></mrow><mrow id="S4.SS3.p1.5.m2.2.2.2" xref="S4.SS3.p1.5.m2.2.2.2.cmml"><mrow id="S4.SS3.p1.5.m2.1.1.1.1.1" xref="S4.SS3.p1.5.m2.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S4.SS3.p1.5.m2.1.1.1.1.1.2" xref="S4.SS3.p1.5.m2.1.1.1.1.2.1.cmml">∥</mo><msub id="S4.SS3.p1.5.m2.1.1.1.1.1.1" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.5.m2.1.1.1.1.1.1.2" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.1.1.1.1.1.1.3" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo fence="true" lspace="0em" id="S4.SS3.p1.5.m2.1.1.1.1.1.3" xref="S4.SS3.p1.5.m2.1.1.1.1.2.1.cmml">∥</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m2.2.2.2.3" xref="S4.SS3.p1.5.m2.2.2.2.3.cmml">​</mo><mrow id="S4.SS3.p1.5.m2.2.2.2.2.1" xref="S4.SS3.p1.5.m2.2.2.2.2.2.cmml"><mo fence="true" rspace="0em" id="S4.SS3.p1.5.m2.2.2.2.2.1.2" xref="S4.SS3.p1.5.m2.2.2.2.2.2.1.cmml">∥</mo><msub id="S4.SS3.p1.5.m2.2.2.2.2.1.1" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1.cmml"><mi id="S4.SS3.p1.5.m2.2.2.2.2.1.1.2" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1.2.cmml">𝐱</mi><mn id="S4.SS3.p1.5.m2.2.2.2.2.1.1.3" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1.3.cmml">2</mn></msub><mo fence="true" lspace="0em" id="S4.SS3.p1.5.m2.2.2.2.2.1.3" xref="S4.SS3.p1.5.m2.2.2.2.2.2.1.cmml">∥</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m2.4b"><apply id="S4.SS3.p1.5.m2.4.4.cmml" xref="S4.SS3.p1.5.m2.4.4"><eq id="S4.SS3.p1.5.m2.4.4.3.cmml" xref="S4.SS3.p1.5.m2.4.4.3"></eq><apply id="S4.SS3.p1.5.m2.4.4.2.cmml" xref="S4.SS3.p1.5.m2.4.4.2"><times id="S4.SS3.p1.5.m2.4.4.2.3.cmml" xref="S4.SS3.p1.5.m2.4.4.2.3"></times><apply id="S4.SS3.p1.5.m2.4.4.2.4.cmml" xref="S4.SS3.p1.5.m2.4.4.2.4"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.4.4.2.4.1.cmml" xref="S4.SS3.p1.5.m2.4.4.2.4">subscript</csymbol><ci id="S4.SS3.p1.5.m2.4.4.2.4.2.cmml" xref="S4.SS3.p1.5.m2.4.4.2.4.2">𝐷</ci><ci id="S4.SS3.p1.5.m2.4.4.2.4.3.cmml" xref="S4.SS3.p1.5.m2.4.4.2.4.3">𝑓</ci></apply><interval closure="open" id="S4.SS3.p1.5.m2.4.4.2.2.3.cmml" xref="S4.SS3.p1.5.m2.4.4.2.2.2"><apply id="S4.SS3.p1.5.m2.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.3.3.1.1.1.1.3.cmml" xref="S4.SS3.p1.5.m2.3.3.1.1.1.1.3">1</cn></apply><apply id="S4.SS3.p1.5.m2.4.4.2.2.2.2.cmml" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.4.4.2.2.2.2.1.cmml" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.5.m2.4.4.2.2.2.2.2.cmml" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.4.4.2.2.2.2.3.cmml" xref="S4.SS3.p1.5.m2.4.4.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S4.SS3.p1.5.m2.4.4.4.cmml" xref="S4.SS3.p1.5.m2.4.4.4"><minus id="S4.SS3.p1.5.m2.4.4.4.1.cmml" xref="S4.SS3.p1.5.m2.4.4.4.1"></minus><cn type="float" id="S4.SS3.p1.5.m2.4.4.4.2.cmml" xref="S4.SS3.p1.5.m2.4.4.4.2">1.0</cn><apply id="S4.SS3.p1.5.m2.2.2.cmml" xref="S4.SS3.p1.5.m2.2.2"><divide id="S4.SS3.p1.5.m2.2.2.3.cmml" xref="S4.SS3.p1.5.m2.2.2"></divide><apply id="S4.SS3.p1.5.m2.2.2.4.cmml" xref="S4.SS3.p1.5.m2.2.2.4"><times id="S4.SS3.p1.5.m2.2.2.4.1.cmml" xref="S4.SS3.p1.5.m2.2.2.4.1"></times><apply id="S4.SS3.p1.5.m2.2.2.4.2.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.2.2.4.2.1.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2">superscript</csymbol><apply id="S4.SS3.p1.5.m2.2.2.4.2.2.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.2.2.4.2.2.1.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2">subscript</csymbol><ci id="S4.SS3.p1.5.m2.2.2.4.2.2.2.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2.2.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.2.2.4.2.2.3.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2.2.3">1</cn></apply><ci id="S4.SS3.p1.5.m2.2.2.4.2.3.cmml" xref="S4.SS3.p1.5.m2.2.2.4.2.3">𝑇</ci></apply><apply id="S4.SS3.p1.5.m2.2.2.4.3.cmml" xref="S4.SS3.p1.5.m2.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.2.2.4.3.1.cmml" xref="S4.SS3.p1.5.m2.2.2.4.3">subscript</csymbol><ci id="S4.SS3.p1.5.m2.2.2.4.3.2.cmml" xref="S4.SS3.p1.5.m2.2.2.4.3.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.2.2.4.3.3.cmml" xref="S4.SS3.p1.5.m2.2.2.4.3.3">2</cn></apply></apply><apply id="S4.SS3.p1.5.m2.2.2.2.cmml" xref="S4.SS3.p1.5.m2.2.2.2"><times id="S4.SS3.p1.5.m2.2.2.2.3.cmml" xref="S4.SS3.p1.5.m2.2.2.2.3"></times><apply id="S4.SS3.p1.5.m2.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.5.m2.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.SS3.p1.5.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.5.m2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS3.p1.5.m2.2.2.2.2.2.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1"><csymbol cd="latexml" id="S4.SS3.p1.5.m2.2.2.2.2.2.1.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1.2">delimited-∥∥</csymbol><apply id="S4.SS3.p1.5.m2.2.2.2.2.1.1.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m2.2.2.2.2.1.1.1.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m2.2.2.2.2.1.1.2.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1.2">𝐱</ci><cn type="integer" id="S4.SS3.p1.5.m2.2.2.2.2.1.1.3.cmml" xref="S4.SS3.p1.5.m2.2.2.2.2.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m2.4c">D_{f}({\mathbf{x}}_{1},{\mathbf{x}}_{2})=1.0-\frac{{\mathbf{x}}_{1}^{T}{\mathbf{x}}_{2}}{\lVert{\mathbf{x}}_{1}\rVert\lVert{\mathbf{x}}_{2}\rVert}</annotation></semantics></math>. <math id="S4.SS3.p1.6.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS3.p1.6.m3.1a"><mi id="S4.SS3.p1.6.m3.1.1" xref="S4.SS3.p1.6.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m3.1b"><ci id="S4.SS3.p1.6.m3.1.1.cmml" xref="S4.SS3.p1.6.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m3.1c">\tau</annotation></semantics></math> is the temperature which is also set as <math id="S4.SS3.p1.7.m4.1" class="ltx_Math" alttext="4.0" display="inline"><semantics id="S4.SS3.p1.7.m4.1a"><mn id="S4.SS3.p1.7.m4.1.1" xref="S4.SS3.p1.7.m4.1.1.cmml">4.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m4.1b"><cn type="float" id="S4.SS3.p1.7.m4.1.1.cmml" xref="S4.SS3.p1.7.m4.1.1">4.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m4.1c">4.0</annotation></semantics></math>. The two steps in Eq. <a href="#S4.E11" title="In 4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and Eq. <a href="#S4.E12" title="In 4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> could be iterated for several steps as done in unsupervised clustering <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib44" title="" class="ltx_ref">DeepCluster </a></cite>, while we only take one step and it is enough to generate better distillation targets. <span id="S4.SS3.p1.7.1" class="ltx_text ltx_font_italic">Notably, the aggregated model could not extract discriminative features in the beginning, thus we omit this process in the first several rounds (e.g., 5).</span></p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2305.04201/assets/x9.png" id="S4.F5.g1" class="ltx_graphics ltx_img_landscape" width="461" height="180" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.2.1" class="ltx_text" style="font-size:90%;">The training procedure of the proposed MrTF. The proposed three techniques (i.e., stabilized teachers, rectified distillation, and clustered label refinery) could generate better distillation targets and facilitate the model refinery process.</span></figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>MrTF</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.5" class="ltx_p">With the three modules, we propose MrTF as follows. During the <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">t</annotation></semantics></math>th communication round, the local procedure is the same as FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>, while the global procedure takes several steps: (1) collect <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><msub id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝜃</ci><ci id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\theta_{t}</annotation></semantics></math>, the updated models <math id="S4.SS4.p1.3.m3.3" class="ltx_Math" alttext="\{\theta_{t,k}\}_{k\in S_{t}}" display="inline"><semantics id="S4.SS4.p1.3.m3.3a"><msub id="S4.SS4.p1.3.m3.3.3" xref="S4.SS4.p1.3.m3.3.3.cmml"><mrow id="S4.SS4.p1.3.m3.3.3.1.1" xref="S4.SS4.p1.3.m3.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS4.p1.3.m3.3.3.1.1.2" xref="S4.SS4.p1.3.m3.3.3.1.2.cmml">{</mo><msub id="S4.SS4.p1.3.m3.3.3.1.1.1" xref="S4.SS4.p1.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS4.p1.3.m3.3.3.1.1.1.2" xref="S4.SS4.p1.3.m3.3.3.1.1.1.2.cmml">θ</mi><mrow id="S4.SS4.p1.3.m3.2.2.2.4" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml"><mi id="S4.SS4.p1.3.m3.1.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.1.cmml">t</mi><mo id="S4.SS4.p1.3.m3.2.2.2.4.1" xref="S4.SS4.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS4.p1.3.m3.2.2.2.2" xref="S4.SS4.p1.3.m3.2.2.2.2.cmml">k</mi></mrow></msub><mo stretchy="false" id="S4.SS4.p1.3.m3.3.3.1.1.3" xref="S4.SS4.p1.3.m3.3.3.1.2.cmml">}</mo></mrow><mrow id="S4.SS4.p1.3.m3.3.3.3" xref="S4.SS4.p1.3.m3.3.3.3.cmml"><mi id="S4.SS4.p1.3.m3.3.3.3.2" xref="S4.SS4.p1.3.m3.3.3.3.2.cmml">k</mi><mo id="S4.SS4.p1.3.m3.3.3.3.1" xref="S4.SS4.p1.3.m3.3.3.3.1.cmml">∈</mo><msub id="S4.SS4.p1.3.m3.3.3.3.3" xref="S4.SS4.p1.3.m3.3.3.3.3.cmml"><mi id="S4.SS4.p1.3.m3.3.3.3.3.2" xref="S4.SS4.p1.3.m3.3.3.3.3.2.cmml">S</mi><mi id="S4.SS4.p1.3.m3.3.3.3.3.3" xref="S4.SS4.p1.3.m3.3.3.3.3.3.cmml">t</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.3b"><apply id="S4.SS4.p1.3.m3.3.3.cmml" xref="S4.SS4.p1.3.m3.3.3"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.3.3.2.cmml" xref="S4.SS4.p1.3.m3.3.3">subscript</csymbol><set id="S4.SS4.p1.3.m3.3.3.1.2.cmml" xref="S4.SS4.p1.3.m3.3.3.1.1"><apply id="S4.SS4.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS4.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS4.p1.3.m3.3.3.1.1.1.2">𝜃</ci><list id="S4.SS4.p1.3.m3.2.2.2.3.cmml" xref="S4.SS4.p1.3.m3.2.2.2.4"><ci id="S4.SS4.p1.3.m3.1.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1.1">𝑡</ci><ci id="S4.SS4.p1.3.m3.2.2.2.2.cmml" xref="S4.SS4.p1.3.m3.2.2.2.2">𝑘</ci></list></apply></set><apply id="S4.SS4.p1.3.m3.3.3.3.cmml" xref="S4.SS4.p1.3.m3.3.3.3"><in id="S4.SS4.p1.3.m3.3.3.3.1.cmml" xref="S4.SS4.p1.3.m3.3.3.3.1"></in><ci id="S4.SS4.p1.3.m3.3.3.3.2.cmml" xref="S4.SS4.p1.3.m3.3.3.3.2">𝑘</ci><apply id="S4.SS4.p1.3.m3.3.3.3.3.cmml" xref="S4.SS4.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.3.3.3.3.1.cmml" xref="S4.SS4.p1.3.m3.3.3.3.3">subscript</csymbol><ci id="S4.SS4.p1.3.m3.3.3.3.3.2.cmml" xref="S4.SS4.p1.3.m3.3.3.3.3.2">𝑆</ci><ci id="S4.SS4.p1.3.m3.3.3.3.3.3.cmml" xref="S4.SS4.p1.3.m3.3.3.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.3c">\{\theta_{t,k}\}_{k\in S_{t}}</annotation></semantics></math>, and the aggregated model <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">θ</mi><mrow id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml"><mi id="S4.SS4.p1.4.m4.1.1.3.2" xref="S4.SS4.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p1.4.m4.1.1.3.1" xref="S4.SS4.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p1.4.m4.1.1.3.3" xref="S4.SS4.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝜃</ci><apply id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3"><plus id="S4.SS4.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.p1.4.m4.1.1.3.1"></plus><ci id="S4.SS4.p1.4.m4.1.1.3.2.cmml" xref="S4.SS4.p1.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p1.4.m4.1.1.3.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\theta_{t+1}</annotation></semantics></math>; (2) make predictions for the global test set using these models in Eq. <a href="#S4.E6" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>; (3) rectify these predicted probabilities in Eq. <a href="#S4.E10" title="In 4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>; (4) generate distillation targets via considering feature clusters in Eq. <a href="#S4.E11" title="In 4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and Eq. <a href="#S4.E12" title="In 4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>; (5) refine the aggregated model <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="\theta_{t+1}" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><msub id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">θ</mi><mrow id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.3.2" xref="S4.SS4.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p1.5.m5.1.1.3.1" xref="S4.SS4.p1.5.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p1.5.m5.1.1.3.3" xref="S4.SS4.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝜃</ci><apply id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3"><plus id="S4.SS4.p1.5.m5.1.1.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.3.1"></plus><ci id="S4.SS4.p1.5.m5.1.1.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p1.5.m5.1.1.3.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">\theta_{t+1}</annotation></semantics></math> on the global test set in Eq. <a href="#S3.E1" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Eq. <a href="#S3.E2" title="In 3.4 Federated Ensemble Distillation (FedDF) ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> with the replaced distillation targets. The refined global model is then distributed onto another set of clients for the next round of learning. The procedure of MrTF is illustrated in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The upload and download process is the same as FedAvg. The proposed stabilized teachers, rectified distillation, and clustered label refinery are aimed at generating better distillation targets. The refined model could simultaneously tackle the data heterogeneity challenge across clients and fuse the structural information of the to-be-inferred data.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>More Discussion</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We present more analysis of MrTF from other relevant aspects.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_bold">Individual Distillation.</span> “AvgProb" in Eq. <a href="#S4.E4" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> could bring another advantage that the distillation could be clearly decomposed into each client, which is more intuitive to analyze. Specifically, the loss in Eq. <a href="#S4.E9" title="In 4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> could be viewed as <math id="S4.SS5.p2.1.m1.5" class="ltx_Math" alttext="\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}\text{KL}(q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))" display="inline"><semantics id="S4.SS5.p2.1.m1.5a"><mrow id="S4.SS5.p2.1.m1.5.5" xref="S4.SS5.p2.1.m1.5.5.cmml"><msub id="S4.SS5.p2.1.m1.5.5.3" xref="S4.SS5.p2.1.m1.5.5.3.cmml"><mo id="S4.SS5.p2.1.m1.5.5.3.2" xref="S4.SS5.p2.1.m1.5.5.3.2.cmml">∑</mo><mrow id="S4.SS5.p2.1.m1.5.5.3.3" xref="S4.SS5.p2.1.m1.5.5.3.3.cmml"><mi id="S4.SS5.p2.1.m1.5.5.3.3.2" xref="S4.SS5.p2.1.m1.5.5.3.3.2.cmml">k</mi><mo id="S4.SS5.p2.1.m1.5.5.3.3.1" xref="S4.SS5.p2.1.m1.5.5.3.3.1.cmml">∈</mo><mi id="S4.SS5.p2.1.m1.5.5.3.3.3" xref="S4.SS5.p2.1.m1.5.5.3.3.3.cmml">S</mi></mrow></msub><mrow id="S4.SS5.p2.1.m1.5.5.2" xref="S4.SS5.p2.1.m1.5.5.2.cmml"><mfrac id="S4.SS5.p2.1.m1.5.5.2.4" xref="S4.SS5.p2.1.m1.5.5.2.4.cmml"><msub id="S4.SS5.p2.1.m1.5.5.2.4.2" xref="S4.SS5.p2.1.m1.5.5.2.4.2.cmml"><mi id="S4.SS5.p2.1.m1.5.5.2.4.2.2" xref="S4.SS5.p2.1.m1.5.5.2.4.2.2.cmml">w</mi><mi id="S4.SS5.p2.1.m1.5.5.2.4.2.3" xref="S4.SS5.p2.1.m1.5.5.2.4.2.3.cmml">k</mi></msub><mrow id="S4.SS5.p2.1.m1.5.5.2.4.3" xref="S4.SS5.p2.1.m1.5.5.2.4.3.cmml"><mstyle displaystyle="false" id="S4.SS5.p2.1.m1.5.5.2.4.3.1" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.cmml"><msub id="S4.SS5.p2.1.m1.5.5.2.4.3.1a" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.cmml"><mo id="S4.SS5.p2.1.m1.5.5.2.4.3.1.2" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.2.cmml">∑</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.cmml"><mi id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.2" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.2.cmml">j</mi><mo id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.1" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.1.cmml">∈</mo><mi id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.3" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.3.cmml">S</mi></mrow></msub></mstyle><msub id="S4.SS5.p2.1.m1.5.5.2.4.3.2" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2.cmml"><mi id="S4.SS5.p2.1.m1.5.5.2.4.3.2.2" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2.2.cmml">w</mi><mi id="S4.SS5.p2.1.m1.5.5.2.4.3.2.3" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.5.5.2.3" xref="S4.SS5.p2.1.m1.5.5.2.3.cmml">​</mo><mtext id="S4.SS5.p2.1.m1.5.5.2.5" xref="S4.SS5.p2.1.m1.5.5.2.5a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.5.5.2.3a" xref="S4.SS5.p2.1.m1.5.5.2.3.cmml">​</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.2.2" xref="S4.SS5.p2.1.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p2.1.m1.5.5.2.2.2.3" xref="S4.SS5.p2.1.m1.5.5.2.2.3.cmml">(</mo><mrow id="S4.SS5.p2.1.m1.4.4.1.1.1.1" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.cmml"><msub id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.cmml"><mi id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.2.cmml">q</mi><mi id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.3" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.3" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS5.p2.1.m1.5.5.2.2.2.4" xref="S4.SS5.p2.1.m1.5.5.2.2.3.cmml">,</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.2.2.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.cmml"><msub id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.cmml"><mi id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.2.cmml">q</mi><mtext id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3a.cmml">g</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.1" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.2" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.1.cmml"><mi id="S4.SS5.p2.1.m1.2.2" xref="S4.SS5.p2.1.m1.2.2.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.2.1" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.1.cmml">;</mo><mi id="S4.SS5.p2.1.m1.3.3" xref="S4.SS5.p2.1.m1.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.3" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS5.p2.1.m1.5.5.2.2.2.5" xref="S4.SS5.p2.1.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.5b"><apply id="S4.SS5.p2.1.m1.5.5.cmml" xref="S4.SS5.p2.1.m1.5.5"><apply id="S4.SS5.p2.1.m1.5.5.3.cmml" xref="S4.SS5.p2.1.m1.5.5.3"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.5.5.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.3">subscript</csymbol><sum id="S4.SS5.p2.1.m1.5.5.3.2.cmml" xref="S4.SS5.p2.1.m1.5.5.3.2"></sum><apply id="S4.SS5.p2.1.m1.5.5.3.3.cmml" xref="S4.SS5.p2.1.m1.5.5.3.3"><in id="S4.SS5.p2.1.m1.5.5.3.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.3.3.1"></in><ci id="S4.SS5.p2.1.m1.5.5.3.3.2.cmml" xref="S4.SS5.p2.1.m1.5.5.3.3.2">𝑘</ci><ci id="S4.SS5.p2.1.m1.5.5.3.3.3.cmml" xref="S4.SS5.p2.1.m1.5.5.3.3.3">𝑆</ci></apply></apply><apply id="S4.SS5.p2.1.m1.5.5.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2"><times id="S4.SS5.p2.1.m1.5.5.2.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.3"></times><apply id="S4.SS5.p2.1.m1.5.5.2.4.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4"><divide id="S4.SS5.p2.1.m1.5.5.2.4.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4"></divide><apply id="S4.SS5.p2.1.m1.5.5.2.4.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.2"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.5.5.2.4.2.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.2">subscript</csymbol><ci id="S4.SS5.p2.1.m1.5.5.2.4.2.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.2.2">𝑤</ci><ci id="S4.SS5.p2.1.m1.5.5.2.4.2.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.2.3">𝑘</ci></apply><apply id="S4.SS5.p2.1.m1.5.5.2.4.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3"><apply id="S4.SS5.p2.1.m1.5.5.2.4.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.5.5.2.4.3.1.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1">subscript</csymbol><sum id="S4.SS5.p2.1.m1.5.5.2.4.3.1.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.2"></sum><apply id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3"><in id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.1"></in><ci id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.2">𝑗</ci><ci id="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.1.3.3">𝑆</ci></apply></apply><apply id="S4.SS5.p2.1.m1.5.5.2.4.3.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.5.5.2.4.3.2.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2">subscript</csymbol><ci id="S4.SS5.p2.1.m1.5.5.2.4.3.2.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2.2">𝑤</ci><ci id="S4.SS5.p2.1.m1.5.5.2.4.3.2.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.4.3.2.3">𝑗</ci></apply></apply></apply><ci id="S4.SS5.p2.1.m1.5.5.2.5a.cmml" xref="S4.SS5.p2.1.m1.5.5.2.5"><mtext id="S4.SS5.p2.1.m1.5.5.2.5.cmml" xref="S4.SS5.p2.1.m1.5.5.2.5">KL</mtext></ci><interval closure="open" id="S4.SS5.p2.1.m1.5.5.2.2.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2"><apply id="S4.SS5.p2.1.m1.4.4.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1"><times id="S4.SS5.p2.1.m1.4.4.1.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.2"></times><apply id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.2">𝑞</ci><ci id="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.3">𝑦</ci><list id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝐱</ci><apply id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S4.SS5.p2.1.m1.5.5.2.2.2.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2"><times id="S4.SS5.p2.1.m1.5.5.2.2.2.2.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.2"></times><apply id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3">subscript</csymbol><ci id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.2">𝑞</ci><ci id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3a.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3"><mtext mathsize="70%" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.3.3">g</mtext></ci></apply><apply id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.2">𝑦</ci><list id="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.1.cmml" xref="S4.SS5.p2.1.m1.5.5.2.2.2.2.1.1.1.3.2"><ci id="S4.SS5.p2.1.m1.2.2.cmml" xref="S4.SS5.p2.1.m1.2.2">𝐱</ci><ci id="S4.SS5.p2.1.m1.3.3.cmml" xref="S4.SS5.p2.1.m1.3.3">𝜃</ci></list></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.5c">\sum_{k\in S}\frac{w_{k}}{\sum_{j\in S}w_{j}}\text{KL}(q_{k}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta_{k}),q_{\text{g}}(y|{\mathbf{x}}\mathchar 24635\relax\;\theta))</annotation></semantics></math>, where each client’s model individually serves as a teacher. <span id="S4.SS5.p2.1.2" class="ltx_text ltx_font_italic">Hence, we expect different teachers transfer different knowledge, i.e., their confident samples, implying the applied weights in Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> are more rational.</span></p>
</div>
<div id="S4.SS5.p3" class="ltx_para ltx_noindent">
<p id="S4.SS5.p3.7" class="ltx_p"><span id="S4.SS5.p3.7.1" class="ltx_text ltx_font_bold">Sensitivity to Weights.</span> We apply weights <math id="S4.SS5.p3.1.m1.1" class="ltx_Math" alttext="w_{k}({\mathbf{x}})" display="inline"><semantics id="S4.SS5.p3.1.m1.1a"><mrow id="S4.SS5.p3.1.m1.1.2" xref="S4.SS5.p3.1.m1.1.2.cmml"><msub id="S4.SS5.p3.1.m1.1.2.2" xref="S4.SS5.p3.1.m1.1.2.2.cmml"><mi id="S4.SS5.p3.1.m1.1.2.2.2" xref="S4.SS5.p3.1.m1.1.2.2.2.cmml">w</mi><mi id="S4.SS5.p3.1.m1.1.2.2.3" xref="S4.SS5.p3.1.m1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.p3.1.m1.1.2.1" xref="S4.SS5.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS5.p3.1.m1.1.2.3.2" xref="S4.SS5.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS5.p3.1.m1.1.2.3.2.1" xref="S4.SS5.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.SS5.p3.1.m1.1.2.3.2.2" xref="S4.SS5.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.2"><times id="S4.SS5.p3.1.m1.1.2.1.cmml" xref="S4.SS5.p3.1.m1.1.2.1"></times><apply id="S4.SS5.p3.1.m1.1.2.2.cmml" xref="S4.SS5.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS5.p3.1.m1.1.2.2.1.cmml" xref="S4.SS5.p3.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS5.p3.1.m1.1.2.2.2.cmml" xref="S4.SS5.p3.1.m1.1.2.2.2">𝑤</ci><ci id="S4.SS5.p3.1.m1.1.2.2.3.cmml" xref="S4.SS5.p3.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">w_{k}({\mathbf{x}})</annotation></semantics></math> in Eq. <a href="#S4.E10" title="In 4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, and we could also add a uniform weight <math id="S4.SS5.p3.2.m2.1" class="ltx_Math" alttext="w_{k}=1/K" display="inline"><semantics id="S4.SS5.p3.2.m2.1a"><mrow id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml"><msub id="S4.SS5.p3.2.m2.1.1.2" xref="S4.SS5.p3.2.m2.1.1.2.cmml"><mi id="S4.SS5.p3.2.m2.1.1.2.2" xref="S4.SS5.p3.2.m2.1.1.2.2.cmml">w</mi><mi id="S4.SS5.p3.2.m2.1.1.2.3" xref="S4.SS5.p3.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS5.p3.2.m2.1.1.1" xref="S4.SS5.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS5.p3.2.m2.1.1.3" xref="S4.SS5.p3.2.m2.1.1.3.cmml"><mn id="S4.SS5.p3.2.m2.1.1.3.2" xref="S4.SS5.p3.2.m2.1.1.3.2.cmml">1</mn><mo id="S4.SS5.p3.2.m2.1.1.3.1" xref="S4.SS5.p3.2.m2.1.1.3.1.cmml">/</mo><mi id="S4.SS5.p3.2.m2.1.1.3.3" xref="S4.SS5.p3.2.m2.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><apply id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1"><eq id="S4.SS5.p3.2.m2.1.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1.1"></eq><apply id="S4.SS5.p3.2.m2.1.1.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.p3.2.m2.1.1.2.1.cmml" xref="S4.SS5.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS5.p3.2.m2.1.1.2.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2.2">𝑤</ci><ci id="S4.SS5.p3.2.m2.1.1.2.3.cmml" xref="S4.SS5.p3.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.SS5.p3.2.m2.1.1.3.cmml" xref="S4.SS5.p3.2.m2.1.1.3"><divide id="S4.SS5.p3.2.m2.1.1.3.1.cmml" xref="S4.SS5.p3.2.m2.1.1.3.1"></divide><cn type="integer" id="S4.SS5.p3.2.m2.1.1.3.2.cmml" xref="S4.SS5.p3.2.m2.1.1.3.2">1</cn><ci id="S4.SS5.p3.2.m2.1.1.3.3.cmml" xref="S4.SS5.p3.2.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">w_{k}=1/K</annotation></semantics></math>. If we do not use “AvgProb", directly utilizing “AvgLogi" has been verified sensitive to different weighting, shown in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Theoretically, the sensitivity of <math id="S4.SS5.p3.3.m3.1" class="ltx_Math" alttext="\overline{q}_{\text{AL}}" display="inline"><semantics id="S4.SS5.p3.3.m3.1a"><msub id="S4.SS5.p3.3.m3.1.1" xref="S4.SS5.p3.3.m3.1.1.cmml"><mover accent="true" id="S4.SS5.p3.3.m3.1.1.2" xref="S4.SS5.p3.3.m3.1.1.2.cmml"><mi id="S4.SS5.p3.3.m3.1.1.2.2" xref="S4.SS5.p3.3.m3.1.1.2.2.cmml">q</mi><mo id="S4.SS5.p3.3.m3.1.1.2.1" xref="S4.SS5.p3.3.m3.1.1.2.1.cmml">¯</mo></mover><mtext id="S4.SS5.p3.3.m3.1.1.3" xref="S4.SS5.p3.3.m3.1.1.3a.cmml">AL</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.3.m3.1b"><apply id="S4.SS5.p3.3.m3.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.3.m3.1.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1">subscript</csymbol><apply id="S4.SS5.p3.3.m3.1.1.2.cmml" xref="S4.SS5.p3.3.m3.1.1.2"><ci id="S4.SS5.p3.3.m3.1.1.2.1.cmml" xref="S4.SS5.p3.3.m3.1.1.2.1">¯</ci><ci id="S4.SS5.p3.3.m3.1.1.2.2.cmml" xref="S4.SS5.p3.3.m3.1.1.2.2">𝑞</ci></apply><ci id="S4.SS5.p3.3.m3.1.1.3a.cmml" xref="S4.SS5.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S4.SS5.p3.3.m3.1.1.3.cmml" xref="S4.SS5.p3.3.m3.1.1.3">AL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.3.m3.1c">\overline{q}_{\text{AL}}</annotation></semantics></math> with respect to <math id="S4.SS5.p3.4.m4.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S4.SS5.p3.4.m4.1a"><msub id="S4.SS5.p3.4.m4.1.1" xref="S4.SS5.p3.4.m4.1.1.cmml"><mi id="S4.SS5.p3.4.m4.1.1.2" xref="S4.SS5.p3.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS5.p3.4.m4.1.1.3" xref="S4.SS5.p3.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.4.m4.1b"><apply id="S4.SS5.p3.4.m4.1.1.cmml" xref="S4.SS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.4.m4.1.1.1.cmml" xref="S4.SS5.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS5.p3.4.m4.1.1.2.cmml" xref="S4.SS5.p3.4.m4.1.1.2">𝑤</ci><ci id="S4.SS5.p3.4.m4.1.1.3.cmml" xref="S4.SS5.p3.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.4.m4.1c">w_{k}</annotation></semantics></math> is relevant to the absolute value of <math id="S4.SS5.p3.5.m5.2" class="ltx_Math" alttext="f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})" display="inline"><semantics id="S4.SS5.p3.5.m5.2a"><mrow id="S4.SS5.p3.5.m5.2.2" xref="S4.SS5.p3.5.m5.2.2.cmml"><msub id="S4.SS5.p3.5.m5.2.2.3" xref="S4.SS5.p3.5.m5.2.2.3.cmml"><mi id="S4.SS5.p3.5.m5.2.2.3.2" xref="S4.SS5.p3.5.m5.2.2.3.2.cmml">f</mi><mi id="S4.SS5.p3.5.m5.2.2.3.3" xref="S4.SS5.p3.5.m5.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.p3.5.m5.2.2.2" xref="S4.SS5.p3.5.m5.2.2.2.cmml">​</mo><mrow id="S4.SS5.p3.5.m5.2.2.1.1" xref="S4.SS5.p3.5.m5.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS5.p3.5.m5.2.2.1.1.2" xref="S4.SS5.p3.5.m5.2.2.1.2.cmml">(</mo><mi id="S4.SS5.p3.5.m5.1.1" xref="S4.SS5.p3.5.m5.1.1.cmml">𝐱</mi><mo rspace="0.447em" id="S4.SS5.p3.5.m5.2.2.1.1.3" xref="S4.SS5.p3.5.m5.2.2.1.2.cmml">;</mo><msub id="S4.SS5.p3.5.m5.2.2.1.1.1" xref="S4.SS5.p3.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS5.p3.5.m5.2.2.1.1.1.2" xref="S4.SS5.p3.5.m5.2.2.1.1.1.2.cmml">θ</mi><mi id="S4.SS5.p3.5.m5.2.2.1.1.1.3" xref="S4.SS5.p3.5.m5.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS5.p3.5.m5.2.2.1.1.4" xref="S4.SS5.p3.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.5.m5.2b"><apply id="S4.SS5.p3.5.m5.2.2.cmml" xref="S4.SS5.p3.5.m5.2.2"><times id="S4.SS5.p3.5.m5.2.2.2.cmml" xref="S4.SS5.p3.5.m5.2.2.2"></times><apply id="S4.SS5.p3.5.m5.2.2.3.cmml" xref="S4.SS5.p3.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS5.p3.5.m5.2.2.3.1.cmml" xref="S4.SS5.p3.5.m5.2.2.3">subscript</csymbol><ci id="S4.SS5.p3.5.m5.2.2.3.2.cmml" xref="S4.SS5.p3.5.m5.2.2.3.2">𝑓</ci><ci id="S4.SS5.p3.5.m5.2.2.3.3.cmml" xref="S4.SS5.p3.5.m5.2.2.3.3">𝑘</ci></apply><list id="S4.SS5.p3.5.m5.2.2.1.2.cmml" xref="S4.SS5.p3.5.m5.2.2.1.1"><ci id="S4.SS5.p3.5.m5.1.1.cmml" xref="S4.SS5.p3.5.m5.1.1">𝐱</ci><apply id="S4.SS5.p3.5.m5.2.2.1.1.1.cmml" xref="S4.SS5.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS5.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS5.p3.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS5.p3.5.m5.2.2.1.1.1.2">𝜃</ci><ci id="S4.SS5.p3.5.m5.2.2.1.1.1.3.cmml" xref="S4.SS5.p3.5.m5.2.2.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.5.m5.2c">f_{k}({\mathbf{x}}\mathchar 24635\relax\;\theta_{k})</annotation></semantics></math> (Eq. <a href="#S4.E3" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), while in <math id="S4.SS5.p3.6.m6.1" class="ltx_Math" alttext="\overline{q}_{\text{AP}}" display="inline"><semantics id="S4.SS5.p3.6.m6.1a"><msub id="S4.SS5.p3.6.m6.1.1" xref="S4.SS5.p3.6.m6.1.1.cmml"><mover accent="true" id="S4.SS5.p3.6.m6.1.1.2" xref="S4.SS5.p3.6.m6.1.1.2.cmml"><mi id="S4.SS5.p3.6.m6.1.1.2.2" xref="S4.SS5.p3.6.m6.1.1.2.2.cmml">q</mi><mo id="S4.SS5.p3.6.m6.1.1.2.1" xref="S4.SS5.p3.6.m6.1.1.2.1.cmml">¯</mo></mover><mtext id="S4.SS5.p3.6.m6.1.1.3" xref="S4.SS5.p3.6.m6.1.1.3a.cmml">AP</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.6.m6.1b"><apply id="S4.SS5.p3.6.m6.1.1.cmml" xref="S4.SS5.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.6.m6.1.1.1.cmml" xref="S4.SS5.p3.6.m6.1.1">subscript</csymbol><apply id="S4.SS5.p3.6.m6.1.1.2.cmml" xref="S4.SS5.p3.6.m6.1.1.2"><ci id="S4.SS5.p3.6.m6.1.1.2.1.cmml" xref="S4.SS5.p3.6.m6.1.1.2.1">¯</ci><ci id="S4.SS5.p3.6.m6.1.1.2.2.cmml" xref="S4.SS5.p3.6.m6.1.1.2.2">𝑞</ci></apply><ci id="S4.SS5.p3.6.m6.1.1.3a.cmml" xref="S4.SS5.p3.6.m6.1.1.3"><mtext mathsize="70%" id="S4.SS5.p3.6.m6.1.1.3.cmml" xref="S4.SS5.p3.6.m6.1.1.3">AP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.6.m6.1c">\overline{q}_{\text{AP}}</annotation></semantics></math>, it is relevant to <math id="S4.SS5.p3.7.m7.4" class="ltx_Math" alttext="\sigma(f_{k}(x\mathchar 24635\relax\;\theta_{k}))\in[0,1]" display="inline"><semantics id="S4.SS5.p3.7.m7.4a"><mrow id="S4.SS5.p3.7.m7.4.4" xref="S4.SS5.p3.7.m7.4.4.cmml"><mrow id="S4.SS5.p3.7.m7.4.4.1" xref="S4.SS5.p3.7.m7.4.4.1.cmml"><mi id="S4.SS5.p3.7.m7.4.4.1.3" xref="S4.SS5.p3.7.m7.4.4.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.SS5.p3.7.m7.4.4.1.2" xref="S4.SS5.p3.7.m7.4.4.1.2.cmml">​</mo><mrow id="S4.SS5.p3.7.m7.4.4.1.1.1" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.1.1.1.2" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p3.7.m7.4.4.1.1.1.1" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.cmml"><msub id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.cmml"><mi id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.2" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.2.cmml">f</mi><mi id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.3" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.2" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.2" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="S4.SS5.p3.7.m7.1.1" xref="S4.SS5.p3.7.m7.1.1.cmml">x</mi><mo rspace="0.447em" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.3" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml">;</mo><msub id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.2" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.3" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.4" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.1.1.1.3" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS5.p3.7.m7.4.4.2" xref="S4.SS5.p3.7.m7.4.4.2.cmml">∈</mo><mrow id="S4.SS5.p3.7.m7.4.4.3.2" xref="S4.SS5.p3.7.m7.4.4.3.1.cmml"><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.3.2.1" xref="S4.SS5.p3.7.m7.4.4.3.1.cmml">[</mo><mn id="S4.SS5.p3.7.m7.2.2" xref="S4.SS5.p3.7.m7.2.2.cmml">0</mn><mo id="S4.SS5.p3.7.m7.4.4.3.2.2" xref="S4.SS5.p3.7.m7.4.4.3.1.cmml">,</mo><mn id="S4.SS5.p3.7.m7.3.3" xref="S4.SS5.p3.7.m7.3.3.cmml">1</mn><mo stretchy="false" id="S4.SS5.p3.7.m7.4.4.3.2.3" xref="S4.SS5.p3.7.m7.4.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.7.m7.4b"><apply id="S4.SS5.p3.7.m7.4.4.cmml" xref="S4.SS5.p3.7.m7.4.4"><in id="S4.SS5.p3.7.m7.4.4.2.cmml" xref="S4.SS5.p3.7.m7.4.4.2"></in><apply id="S4.SS5.p3.7.m7.4.4.1.cmml" xref="S4.SS5.p3.7.m7.4.4.1"><times id="S4.SS5.p3.7.m7.4.4.1.2.cmml" xref="S4.SS5.p3.7.m7.4.4.1.2"></times><ci id="S4.SS5.p3.7.m7.4.4.1.3.cmml" xref="S4.SS5.p3.7.m7.4.4.1.3">𝜎</ci><apply id="S4.SS5.p3.7.m7.4.4.1.1.1.1.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1"><times id="S4.SS5.p3.7.m7.4.4.1.1.1.1.2.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.2"></times><apply id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.1.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.2.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.2">𝑓</ci><ci id="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.3.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.3.3">𝑘</ci></apply><list id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.2.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1"><ci id="S4.SS5.p3.7.m7.1.1.cmml" xref="S4.SS5.p3.7.m7.1.1">𝑥</ci><apply id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.p3.7.m7.4.4.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><interval closure="closed" id="S4.SS5.p3.7.m7.4.4.3.1.cmml" xref="S4.SS5.p3.7.m7.4.4.3.2"><cn type="integer" id="S4.SS5.p3.7.m7.2.2.cmml" xref="S4.SS5.p3.7.m7.2.2">0</cn><cn type="integer" id="S4.SS5.p3.7.m7.3.3.cmml" xref="S4.SS5.p3.7.m7.3.3">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.7.m7.4c">\sigma(f_{k}(x\mathchar 24635\relax\;\theta_{k}))\in[0,1]</annotation></semantics></math>. Obviously, the latter is more robust to the applied weights. This paves the foundation for adding two-level weights in rectified distillation (Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>).</p>
</div>
<div id="S4.SS5.p4" class="ltx_para ltx_noindent">
<p id="S4.SS5.p4.3" class="ltx_p"><span id="S4.SS5.p4.3.1" class="ltx_text ltx_font_bold">Self Teaching.</span> In the module of rectified distillation (Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>), we add global aggregated models into the ensemble. We could decompose Eq. <a href="#S4.E10" title="In 4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> into three parts: (1) the first is distilling local models’ ability to the aggregated model; (2) the second is like <math id="S4.SS5.p4.1.m1.2" class="ltx_Math" alttext="\text{KD}(\theta_{t},\theta_{t+1})" display="inline"><semantics id="S4.SS5.p4.1.m1.2a"><mrow id="S4.SS5.p4.1.m1.2.2" xref="S4.SS5.p4.1.m1.2.2.cmml"><mtext id="S4.SS5.p4.1.m1.2.2.4" xref="S4.SS5.p4.1.m1.2.2.4a.cmml">KD</mtext><mo lspace="0em" rspace="0em" id="S4.SS5.p4.1.m1.2.2.3" xref="S4.SS5.p4.1.m1.2.2.3.cmml">​</mo><mrow id="S4.SS5.p4.1.m1.2.2.2.2" xref="S4.SS5.p4.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p4.1.m1.2.2.2.2.3" xref="S4.SS5.p4.1.m1.2.2.2.3.cmml">(</mo><msub id="S4.SS5.p4.1.m1.1.1.1.1.1" xref="S4.SS5.p4.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS5.p4.1.m1.1.1.1.1.1.2" xref="S4.SS5.p4.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.SS5.p4.1.m1.1.1.1.1.1.3" xref="S4.SS5.p4.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS5.p4.1.m1.2.2.2.2.4" xref="S4.SS5.p4.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS5.p4.1.m1.2.2.2.2.2" xref="S4.SS5.p4.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS5.p4.1.m1.2.2.2.2.2.2" xref="S4.SS5.p4.1.m1.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.SS5.p4.1.m1.2.2.2.2.2.3" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.cmml"><mi id="S4.SS5.p4.1.m1.2.2.2.2.2.3.2" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS5.p4.1.m1.2.2.2.2.2.3.1" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S4.SS5.p4.1.m1.2.2.2.2.2.3.3" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS5.p4.1.m1.2.2.2.2.5" xref="S4.SS5.p4.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.1.m1.2b"><apply id="S4.SS5.p4.1.m1.2.2.cmml" xref="S4.SS5.p4.1.m1.2.2"><times id="S4.SS5.p4.1.m1.2.2.3.cmml" xref="S4.SS5.p4.1.m1.2.2.3"></times><ci id="S4.SS5.p4.1.m1.2.2.4a.cmml" xref="S4.SS5.p4.1.m1.2.2.4"><mtext id="S4.SS5.p4.1.m1.2.2.4.cmml" xref="S4.SS5.p4.1.m1.2.2.4">KD</mtext></ci><interval closure="open" id="S4.SS5.p4.1.m1.2.2.2.3.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2"><apply id="S4.SS5.p4.1.m1.1.1.1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p4.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS5.p4.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="S4.SS5.p4.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS5.p4.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS5.p4.1.m1.2.2.2.2.2.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p4.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS5.p4.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2.2">𝜃</ci><apply id="S4.SS5.p4.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3"><plus id="S4.SS5.p4.1.m1.2.2.2.2.2.3.1.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.1"></plus><ci id="S4.SS5.p4.1.m1.2.2.2.2.2.3.2.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.p4.1.m1.2.2.2.2.2.3.3.cmml" xref="S4.SS5.p4.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.1.m1.2c">\text{KD}(\theta_{t},\theta_{t+1})</annotation></semantics></math>, which utilizes historical prediction to supervise the current learning; (3) the third part is <math id="S4.SS5.p4.2.m2.2" class="ltx_Math" alttext="\text{KD}(\theta_{t+1},\theta_{t+1})" display="inline"><semantics id="S4.SS5.p4.2.m2.2a"><mrow id="S4.SS5.p4.2.m2.2.2" xref="S4.SS5.p4.2.m2.2.2.cmml"><mtext id="S4.SS5.p4.2.m2.2.2.4" xref="S4.SS5.p4.2.m2.2.2.4a.cmml">KD</mtext><mo lspace="0em" rspace="0em" id="S4.SS5.p4.2.m2.2.2.3" xref="S4.SS5.p4.2.m2.2.2.3.cmml">​</mo><mrow id="S4.SS5.p4.2.m2.2.2.2.2" xref="S4.SS5.p4.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS5.p4.2.m2.2.2.2.2.3" xref="S4.SS5.p4.2.m2.2.2.2.3.cmml">(</mo><msub id="S4.SS5.p4.2.m2.1.1.1.1.1" xref="S4.SS5.p4.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS5.p4.2.m2.1.1.1.1.1.2" xref="S4.SS5.p4.2.m2.1.1.1.1.1.2.cmml">θ</mi><mrow id="S4.SS5.p4.2.m2.1.1.1.1.1.3" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.cmml"><mi id="S4.SS5.p4.2.m2.1.1.1.1.1.3.2" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS5.p4.2.m2.1.1.1.1.1.3.1" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS5.p4.2.m2.1.1.1.1.1.3.3" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS5.p4.2.m2.2.2.2.2.4" xref="S4.SS5.p4.2.m2.2.2.2.3.cmml">,</mo><msub id="S4.SS5.p4.2.m2.2.2.2.2.2" xref="S4.SS5.p4.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS5.p4.2.m2.2.2.2.2.2.2" xref="S4.SS5.p4.2.m2.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.SS5.p4.2.m2.2.2.2.2.2.3" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.cmml"><mi id="S4.SS5.p4.2.m2.2.2.2.2.2.3.2" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS5.p4.2.m2.2.2.2.2.2.3.1" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.1.cmml">+</mo><mn id="S4.SS5.p4.2.m2.2.2.2.2.2.3.3" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS5.p4.2.m2.2.2.2.2.5" xref="S4.SS5.p4.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.2.m2.2b"><apply id="S4.SS5.p4.2.m2.2.2.cmml" xref="S4.SS5.p4.2.m2.2.2"><times id="S4.SS5.p4.2.m2.2.2.3.cmml" xref="S4.SS5.p4.2.m2.2.2.3"></times><ci id="S4.SS5.p4.2.m2.2.2.4a.cmml" xref="S4.SS5.p4.2.m2.2.2.4"><mtext id="S4.SS5.p4.2.m2.2.2.4.cmml" xref="S4.SS5.p4.2.m2.2.2.4">KD</mtext></ci><interval closure="open" id="S4.SS5.p4.2.m2.2.2.2.3.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2"><apply id="S4.SS5.p4.2.m2.1.1.1.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS5.p4.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1.2">𝜃</ci><apply id="S4.SS5.p4.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3"><plus id="S4.SS5.p4.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.1"></plus><ci id="S4.SS5.p4.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS5.p4.2.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS5.p4.2.m2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS5.p4.2.m2.2.2.2.2.2.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.p4.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS5.p4.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2.2">𝜃</ci><apply id="S4.SS5.p4.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3"><plus id="S4.SS5.p4.2.m2.2.2.2.2.2.3.1.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.1"></plus><ci id="S4.SS5.p4.2.m2.2.2.2.2.2.3.2.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.p4.2.m2.2.2.2.2.2.3.3.cmml" xref="S4.SS5.p4.2.m2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.2.m2.2c">\text{KD}(\theta_{t+1},\theta_{t+1})</annotation></semantics></math>, which is similar to self-teaching. <math id="S4.SS5.p4.3.m3.2" class="ltx_Math" alttext="\text{KD}(\cdot,\cdot)" display="inline"><semantics id="S4.SS5.p4.3.m3.2a"><mrow id="S4.SS5.p4.3.m3.2.3" xref="S4.SS5.p4.3.m3.2.3.cmml"><mtext id="S4.SS5.p4.3.m3.2.3.2" xref="S4.SS5.p4.3.m3.2.3.2a.cmml">KD</mtext><mo lspace="0em" rspace="0em" id="S4.SS5.p4.3.m3.2.3.1" xref="S4.SS5.p4.3.m3.2.3.1.cmml">​</mo><mrow id="S4.SS5.p4.3.m3.2.3.3.2" xref="S4.SS5.p4.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS5.p4.3.m3.2.3.3.2.1" xref="S4.SS5.p4.3.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS5.p4.3.m3.1.1" xref="S4.SS5.p4.3.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS5.p4.3.m3.2.3.3.2.2" xref="S4.SS5.p4.3.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS5.p4.3.m3.2.2" xref="S4.SS5.p4.3.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS5.p4.3.m3.2.3.3.2.3" xref="S4.SS5.p4.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.3.m3.2b"><apply id="S4.SS5.p4.3.m3.2.3.cmml" xref="S4.SS5.p4.3.m3.2.3"><times id="S4.SS5.p4.3.m3.2.3.1.cmml" xref="S4.SS5.p4.3.m3.2.3.1"></times><ci id="S4.SS5.p4.3.m3.2.3.2a.cmml" xref="S4.SS5.p4.3.m3.2.3.2"><mtext id="S4.SS5.p4.3.m3.2.3.2.cmml" xref="S4.SS5.p4.3.m3.2.3.2">KD</mtext></ci><interval closure="open" id="S4.SS5.p4.3.m3.2.3.3.1.cmml" xref="S4.SS5.p4.3.m3.2.3.3.2"><ci id="S4.SS5.p4.3.m3.1.1.cmml" xref="S4.SS5.p4.3.m3.1.1">⋅</ci><ci id="S4.SS5.p4.3.m3.2.2.cmml" xref="S4.SS5.p4.3.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.3.m3.2c">\text{KD}(\cdot,\cdot)</annotation></semantics></math> denotes the knowledge distillation process.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.2.1" class="ltx_text" style="font-size:90%;">Statistics of utilized datasets. We take <math id="S4.T1.2.1.m1.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S4.T1.2.1.m1.1b"><mrow id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml"><mi id="S4.T1.2.1.m1.1.1.2" xref="S4.T1.2.1.m1.1.1.2.cmml">K</mi><mo id="S4.T1.2.1.m1.1.1.1" xref="S4.T1.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.1.m1.1.1.3" xref="S4.T1.2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><apply id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1"><eq id="S4.T1.2.1.m1.1.1.1.cmml" xref="S4.T1.2.1.m1.1.1.1"></eq><ci id="S4.T1.2.1.m1.1.1.2.cmml" xref="S4.T1.2.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.T1.2.1.m1.1.1.3.cmml" xref="S4.T1.2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">K=100</annotation></semantics></math> for an example.</span></figcaption>
<table id="S4.T1.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.8.6" class="ltx_tr">
<td id="S4.T1.8.6.7" class="ltx_td ltx_border_r ltx_border_tt"></td>
<td id="S4.T1.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="S4.T1.3.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T1.3.1.1.m1.1a"><mi id="S4.T1.3.1.1.m1.1.1" xref="S4.T1.3.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.m1.1b"><ci id="S4.T1.3.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.m1.1c">N</annotation></semantics></math></td>
<td id="S4.T1.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="S4.T1.4.2.2.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.T1.4.2.2.m1.1a"><mi id="S4.T1.4.2.2.m1.1.1" xref="S4.T1.4.2.2.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.m1.1b"><ci id="S4.T1.4.2.2.m1.1.1.cmml" xref="S4.T1.4.2.2.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.m1.1c">M</annotation></semantics></math></td>
<td id="S4.T1.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="S4.T1.5.3.3.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.5.3.3.m1.1a"><mi id="S4.T1.5.3.3.m1.1.1" xref="S4.T1.5.3.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.m1.1b"><ci id="S4.T1.5.3.3.m1.1.1.cmml" xref="S4.T1.5.3.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.m1.1c">C</annotation></semantics></math></td>
<td id="S4.T1.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="S4.T1.6.4.4.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.6.4.4.m1.1a"><mi id="S4.T1.6.4.4.m1.1.1" xref="S4.T1.6.4.4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.4.4.m1.1b"><ci id="S4.T1.6.4.4.m1.1.1.cmml" xref="S4.T1.6.4.4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.4.4.m1.1c">K</annotation></semantics></math></td>
<td id="S4.T1.7.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><math id="S4.T1.7.5.5.m1.1" class="ltx_Math" alttext="\overline{N_{k}}" display="inline"><semantics id="S4.T1.7.5.5.m1.1a"><mover accent="true" id="S4.T1.7.5.5.m1.1.1" xref="S4.T1.7.5.5.m1.1.1.cmml"><msub id="S4.T1.7.5.5.m1.1.1.2" xref="S4.T1.7.5.5.m1.1.1.2.cmml"><mi id="S4.T1.7.5.5.m1.1.1.2.2" xref="S4.T1.7.5.5.m1.1.1.2.2.cmml">N</mi><mi id="S4.T1.7.5.5.m1.1.1.2.3" xref="S4.T1.7.5.5.m1.1.1.2.3.cmml">k</mi></msub><mo id="S4.T1.7.5.5.m1.1.1.1" xref="S4.T1.7.5.5.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.7.5.5.m1.1b"><apply id="S4.T1.7.5.5.m1.1.1.cmml" xref="S4.T1.7.5.5.m1.1.1"><ci id="S4.T1.7.5.5.m1.1.1.1.cmml" xref="S4.T1.7.5.5.m1.1.1.1">¯</ci><apply id="S4.T1.7.5.5.m1.1.1.2.cmml" xref="S4.T1.7.5.5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.7.5.5.m1.1.1.2.1.cmml" xref="S4.T1.7.5.5.m1.1.1.2">subscript</csymbol><ci id="S4.T1.7.5.5.m1.1.1.2.2.cmml" xref="S4.T1.7.5.5.m1.1.1.2.2">𝑁</ci><ci id="S4.T1.7.5.5.m1.1.1.2.3.cmml" xref="S4.T1.7.5.5.m1.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.5.5.m1.1c">\overline{N_{k}}</annotation></semantics></math></td>
<td id="S4.T1.8.6.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt"><math id="S4.T1.8.6.6.m1.1" class="ltx_Math" alttext="\overline{C_{k}}" display="inline"><semantics id="S4.T1.8.6.6.m1.1a"><mover accent="true" id="S4.T1.8.6.6.m1.1.1" xref="S4.T1.8.6.6.m1.1.1.cmml"><msub id="S4.T1.8.6.6.m1.1.1.2" xref="S4.T1.8.6.6.m1.1.1.2.cmml"><mi id="S4.T1.8.6.6.m1.1.1.2.2" xref="S4.T1.8.6.6.m1.1.1.2.2.cmml">C</mi><mi id="S4.T1.8.6.6.m1.1.1.2.3" xref="S4.T1.8.6.6.m1.1.1.2.3.cmml">k</mi></msub><mo id="S4.T1.8.6.6.m1.1.1.1" xref="S4.T1.8.6.6.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.8.6.6.m1.1b"><apply id="S4.T1.8.6.6.m1.1.1.cmml" xref="S4.T1.8.6.6.m1.1.1"><ci id="S4.T1.8.6.6.m1.1.1.1.cmml" xref="S4.T1.8.6.6.m1.1.1.1">¯</ci><apply id="S4.T1.8.6.6.m1.1.1.2.cmml" xref="S4.T1.8.6.6.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.8.6.6.m1.1.1.2.1.cmml" xref="S4.T1.8.6.6.m1.1.1.2">subscript</csymbol><ci id="S4.T1.8.6.6.m1.1.1.2.2.cmml" xref="S4.T1.8.6.6.m1.1.1.2.2">𝐶</ci><ci id="S4.T1.8.6.6.m1.1.1.2.3.cmml" xref="S4.T1.8.6.6.m1.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.6.6.m1.1c">\overline{C_{k}}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.9.7" class="ltx_tr">
<td id="S4.T1.9.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MNIST <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib35" title="" class="ltx_ref">mnist </a></cite>
</td>
<td id="S4.T1.9.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55k</td>
<td id="S4.T1.9.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10k</td>
<td id="S4.T1.9.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10</td>
<td id="S4.T1.9.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T1.9.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">550</td>
<td id="S4.T1.9.7.1" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">3.0 <math id="S4.T1.9.7.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.9.7.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.9.7.1.m1.1.1" xref="S4.T1.9.7.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.7.1.m1.1b"><ci id="S4.T1.9.7.1.m1.1.1.cmml" xref="S4.T1.9.7.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.7.1.m1.1c">|</annotation></semantics></math> 3.6</td>
</tr>
<tr id="S4.T1.10.8" class="ltx_tr">
<td id="S4.T1.10.8.2" class="ltx_td ltx_align_left ltx_border_r">MNISTm  <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib46" title="" class="ltx_ref">Mnistm-DaNN </a></cite>
</td>
<td id="S4.T1.10.8.3" class="ltx_td ltx_align_center ltx_border_r">55k</td>
<td id="S4.T1.10.8.4" class="ltx_td ltx_align_center ltx_border_r">10k</td>
<td id="S4.T1.10.8.5" class="ltx_td ltx_align_center ltx_border_r">10</td>
<td id="S4.T1.10.8.6" class="ltx_td ltx_align_center ltx_border_r">100</td>
<td id="S4.T1.10.8.7" class="ltx_td ltx_align_center ltx_border_r">550</td>
<td id="S4.T1.10.8.1" class="ltx_td ltx_nopad_r ltx_align_center">3.0 <math id="S4.T1.10.8.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.10.8.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.10.8.1.m1.1.1" xref="S4.T1.10.8.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.8.1.m1.1b"><ci id="S4.T1.10.8.1.m1.1.1.cmml" xref="S4.T1.10.8.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.8.1.m1.1c">|</annotation></semantics></math> 3.6</td>
</tr>
<tr id="S4.T1.11.9" class="ltx_tr">
<td id="S4.T1.11.9.2" class="ltx_td ltx_align_left ltx_border_r">SVHN <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib47" title="" class="ltx_ref">Svhn </a></cite>
</td>
<td id="S4.T1.11.9.3" class="ltx_td ltx_align_center ltx_border_r">73k</td>
<td id="S4.T1.11.9.4" class="ltx_td ltx_align_center ltx_border_r">26k</td>
<td id="S4.T1.11.9.5" class="ltx_td ltx_align_center ltx_border_r">10</td>
<td id="S4.T1.11.9.6" class="ltx_td ltx_align_center ltx_border_r">100</td>
<td id="S4.T1.11.9.7" class="ltx_td ltx_align_center ltx_border_r">730</td>
<td id="S4.T1.11.9.1" class="ltx_td ltx_nopad_r ltx_align_center">3.0 <math id="S4.T1.11.9.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.11.9.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.11.9.1.m1.1.1" xref="S4.T1.11.9.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.9.1.m1.1b"><ci id="S4.T1.11.9.1.m1.1.1.cmml" xref="S4.T1.11.9.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.9.1.m1.1c">|</annotation></semantics></math> 3.9</td>
</tr>
<tr id="S4.T1.12.10" class="ltx_tr">
<td id="S4.T1.12.10.2" class="ltx_td ltx_align_left ltx_border_r">CIFAR10 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib29" title="" class="ltx_ref">cifar </a></cite>
</td>
<td id="S4.T1.12.10.3" class="ltx_td ltx_align_center ltx_border_r">50k</td>
<td id="S4.T1.12.10.4" class="ltx_td ltx_align_center ltx_border_r">10k</td>
<td id="S4.T1.12.10.5" class="ltx_td ltx_align_center ltx_border_r">10</td>
<td id="S4.T1.12.10.6" class="ltx_td ltx_align_center ltx_border_r">100</td>
<td id="S4.T1.12.10.7" class="ltx_td ltx_align_center ltx_border_r">500</td>
<td id="S4.T1.12.10.1" class="ltx_td ltx_nopad_r ltx_align_center">3.0 <math id="S4.T1.12.10.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.12.10.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.12.10.1.m1.1.1" xref="S4.T1.12.10.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.10.1.m1.1b"><ci id="S4.T1.12.10.1.m1.1.1.cmml" xref="S4.T1.12.10.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.10.1.m1.1c">|</annotation></semantics></math> 3.6</td>
</tr>
<tr id="S4.T1.13.11" class="ltx_tr">
<td id="S4.T1.13.11.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CIFAR100 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib29" title="" class="ltx_ref">cifar </a></cite>
</td>
<td id="S4.T1.13.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50k</td>
<td id="S4.T1.13.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10k</td>
<td id="S4.T1.13.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T1.13.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T1.13.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T1.13.11.1" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">30 <math id="S4.T1.13.11.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.13.11.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.13.11.1.m1.1.1" xref="S4.T1.13.11.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.13.11.1.m1.1b"><ci id="S4.T1.13.11.1.m1.1.1.cmml" xref="S4.T1.13.11.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.11.1.m1.1c">|</annotation></semantics></math> 17.5</td>
</tr>
<tr id="S4.T1.14.12" class="ltx_tr">
<td id="S4.T1.14.12.2" class="ltx_td ltx_align_left ltx_border_r">FeMnist <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib48" title="" class="ltx_ref">LEAF </a></cite>
</td>
<td id="S4.T1.14.12.3" class="ltx_td ltx_align_center ltx_border_r">85k</td>
<td id="S4.T1.14.12.4" class="ltx_td ltx_align_center ltx_border_r">16k</td>
<td id="S4.T1.14.12.5" class="ltx_td ltx_align_center ltx_border_r">62</td>
<td id="S4.T1.14.12.6" class="ltx_td ltx_align_center ltx_border_r">359</td>
<td id="S4.T1.14.12.7" class="ltx_td ltx_align_center ltx_border_r">236</td>
<td id="S4.T1.14.12.1" class="ltx_td ltx_nopad_r ltx_align_center">15.3 <math id="S4.T1.14.12.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.14.12.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.14.12.1.m1.1.1" xref="S4.T1.14.12.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.14.12.1.m1.1b"><ci id="S4.T1.14.12.1.m1.1.1.cmml" xref="S4.T1.14.12.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.12.1.m1.1c">|</annotation></semantics></math> 14.4</td>
</tr>
<tr id="S4.T1.15.13" class="ltx_tr">
<td id="S4.T1.15.13.2" class="ltx_td ltx_align_left ltx_border_r">Shakespeare <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib48" title="" class="ltx_ref">LEAF </a></cite>
</td>
<td id="S4.T1.15.13.3" class="ltx_td ltx_align_center ltx_border_r">437k</td>
<td id="S4.T1.15.13.4" class="ltx_td ltx_align_center ltx_border_r">84k</td>
<td id="S4.T1.15.13.5" class="ltx_td ltx_align_center ltx_border_r">80</td>
<td id="S4.T1.15.13.6" class="ltx_td ltx_align_center ltx_border_r">112</td>
<td id="S4.T1.15.13.7" class="ltx_td ltx_align_center ltx_border_r">3.9k</td>
<td id="S4.T1.15.13.1" class="ltx_td ltx_nopad_r ltx_align_center">28.7 <math id="S4.T1.15.13.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S4.T1.15.13.1.m1.1a"><mo fence="false" stretchy="false" id="S4.T1.15.13.1.m1.1.1" xref="S4.T1.15.13.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.13.1.m1.1b"><ci id="S4.T1.15.13.1.m1.1.1.cmml" xref="S4.T1.15.13.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.13.1.m1.1c">|</annotation></semantics></math> 29.2</td>
</tr>
<tr id="S4.T1.15.14.1" class="ltx_tr">
<td id="S4.T1.15.14.1.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T1.15.14.1.1.1" class="ltx_ERROR undefined">\botrule</span></td>
<td id="S4.T1.15.14.1.2" class="ltx_td"></td>
<td id="S4.T1.15.14.1.3" class="ltx_td"></td>
<td id="S4.T1.15.14.1.4" class="ltx_td"></td>
<td id="S4.T1.15.14.1.5" class="ltx_td"></td>
<td id="S4.T1.15.14.1.6" class="ltx_td"></td>
<td id="S4.T1.15.14.1.7" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.15" class="ltx_p">We use datasets from: (a) digits recognition: MNIST <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib35" title="" class="ltx_ref">mnist </a></cite>, MNISTm <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib46" title="" class="ltx_ref">Mnistm-DaNN </a></cite>, SVHN <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib47" title="" class="ltx_ref">Svhn </a></cite>; (b) image classification: CIFAR10/100 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib29" title="" class="ltx_ref">cifar </a></cite>, recommended by FedML <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib49" title="" class="ltx_ref">FedML </a></cite>; (c) FeMnist and Shakespeare, recommended by LEAF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib48" title="" class="ltx_ref">LEAF </a></cite>. Datasets in (a) and (b) are commonly utilized as benchmarks in centralized training. In our work, we split the corresponding training set onto <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">K</annotation></semantics></math> clients according to “split by label" with different <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S5.p1.2.m2.1a"><mover accent="true" id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">C</mi><mo id="S5.p1.2.m2.1.1.1" xref="S5.p1.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><ci id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1.1">¯</ci><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\overline{C}</annotation></semantics></math> or “split by dirichlet" with different <math id="S5.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p1.3.m3.1a"><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">\alpha</annotation></semantics></math>. Smaller <math id="S5.p1.4.m4.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S5.p1.4.m4.1a"><mover accent="true" id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml"><mi id="S5.p1.4.m4.1.1.2" xref="S5.p1.4.m4.1.1.2.cmml">C</mi><mo id="S5.p1.4.m4.1.1.1" xref="S5.p1.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.1b"><apply id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1"><ci id="S5.p1.4.m4.1.1.1.cmml" xref="S5.p1.4.m4.1.1.1">¯</ci><ci id="S5.p1.4.m4.1.1.2.cmml" xref="S5.p1.4.m4.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.1c">\overline{C}</annotation></semantics></math> and <math id="S5.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p1.5.m5.1a"><mi id="S5.p1.5.m5.1.1" xref="S5.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p1.5.m5.1b"><ci id="S5.p1.5.m5.1.1.cmml" xref="S5.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.5.m5.1c">\alpha</annotation></semantics></math> lead to more Non-I.I.D. scenes, i.e., clients’ data distributions differ a lot. Benchmarks in (c) provide a user list, and we construct Non-I.I.D. FL scenes via taking each user as an individual client. Specifically, Shakespeare is a dataset built from the Complete Works of William Shakespeare, which is originally used in FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>. It is constructed by viewing each speaking role in each play as a different device, and the target is to predict the next character based on the previous characters. FeMnist is a task to classify the mixture of digits and characters, where data from each writer is considered as a client. These two benchmarks contain amounts of training samples and we only select <math id="S5.p1.6.m6.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S5.p1.6.m6.1a"><mrow id="S5.p1.6.m6.1.1" xref="S5.p1.6.m6.1.1.cmml"><mn id="S5.p1.6.m6.1.1.2" xref="S5.p1.6.m6.1.1.2.cmml">10</mn><mo id="S5.p1.6.m6.1.1.1" xref="S5.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.6.m6.1b"><apply id="S5.p1.6.m6.1.1.cmml" xref="S5.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.p1.6.m6.1.1.1.cmml" xref="S5.p1.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S5.p1.6.m6.1.1.2.cmml" xref="S5.p1.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.6.m6.1c">10\%</annotation></semantics></math> data for training. We list statistics of these benchmarks in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.5 More Discussion ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> including: (1) the total amount of training samples of all clients (<math id="S5.p1.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.p1.7.m7.1a"><mi id="S5.p1.7.m7.1.1" xref="S5.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.p1.7.m7.1b"><ci id="S5.p1.7.m7.1.1.cmml" xref="S5.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.7.m7.1c">N</annotation></semantics></math>); (2) the total number of test samples on the server (<math id="S5.p1.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S5.p1.8.m8.1a"><mi id="S5.p1.8.m8.1.1" xref="S5.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.p1.8.m8.1b"><ci id="S5.p1.8.m8.1.1.cmml" xref="S5.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.8.m8.1c">M</annotation></semantics></math>); (3) the number of classes (<math id="S5.p1.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.p1.9.m9.1a"><mi id="S5.p1.9.m9.1.1" xref="S5.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.p1.9.m9.1b"><ci id="S5.p1.9.m9.1.1.cmml" xref="S5.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.9.m9.1c">C</annotation></semantics></math>); (4) the number of clients (<math id="S5.p1.10.m10.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p1.10.m10.1a"><mi id="S5.p1.10.m10.1.1" xref="S5.p1.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p1.10.m10.1b"><ci id="S5.p1.10.m10.1.1.cmml" xref="S5.p1.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.10.m10.1c">K</annotation></semantics></math>); (5) the number of training samples of each client on average (<math id="S5.p1.11.m11.1" class="ltx_Math" alttext="\overline{N_{k}}" display="inline"><semantics id="S5.p1.11.m11.1a"><mover accent="true" id="S5.p1.11.m11.1.1" xref="S5.p1.11.m11.1.1.cmml"><msub id="S5.p1.11.m11.1.1.2" xref="S5.p1.11.m11.1.1.2.cmml"><mi id="S5.p1.11.m11.1.1.2.2" xref="S5.p1.11.m11.1.1.2.2.cmml">N</mi><mi id="S5.p1.11.m11.1.1.2.3" xref="S5.p1.11.m11.1.1.2.3.cmml">k</mi></msub><mo id="S5.p1.11.m11.1.1.1" xref="S5.p1.11.m11.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p1.11.m11.1b"><apply id="S5.p1.11.m11.1.1.cmml" xref="S5.p1.11.m11.1.1"><ci id="S5.p1.11.m11.1.1.1.cmml" xref="S5.p1.11.m11.1.1.1">¯</ci><apply id="S5.p1.11.m11.1.1.2.cmml" xref="S5.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S5.p1.11.m11.1.1.2.1.cmml" xref="S5.p1.11.m11.1.1.2">subscript</csymbol><ci id="S5.p1.11.m11.1.1.2.2.cmml" xref="S5.p1.11.m11.1.1.2.2">𝑁</ci><ci id="S5.p1.11.m11.1.1.2.3.cmml" xref="S5.p1.11.m11.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.11.m11.1c">\overline{N_{k}}</annotation></semantics></math>); (6) the number of observed classes (i.e., at least 5 training samples) of each client on average when split by label (<math id="S5.p1.12.m12.1" class="ltx_Math" alttext="\overline{C}=3" display="inline"><semantics id="S5.p1.12.m12.1a"><mrow id="S5.p1.12.m12.1.1" xref="S5.p1.12.m12.1.1.cmml"><mover accent="true" id="S5.p1.12.m12.1.1.2" xref="S5.p1.12.m12.1.1.2.cmml"><mi id="S5.p1.12.m12.1.1.2.2" xref="S5.p1.12.m12.1.1.2.2.cmml">C</mi><mo id="S5.p1.12.m12.1.1.2.1" xref="S5.p1.12.m12.1.1.2.1.cmml">¯</mo></mover><mo id="S5.p1.12.m12.1.1.1" xref="S5.p1.12.m12.1.1.1.cmml">=</mo><mn id="S5.p1.12.m12.1.1.3" xref="S5.p1.12.m12.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.12.m12.1b"><apply id="S5.p1.12.m12.1.1.cmml" xref="S5.p1.12.m12.1.1"><eq id="S5.p1.12.m12.1.1.1.cmml" xref="S5.p1.12.m12.1.1.1"></eq><apply id="S5.p1.12.m12.1.1.2.cmml" xref="S5.p1.12.m12.1.1.2"><ci id="S5.p1.12.m12.1.1.2.1.cmml" xref="S5.p1.12.m12.1.1.2.1">¯</ci><ci id="S5.p1.12.m12.1.1.2.2.cmml" xref="S5.p1.12.m12.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S5.p1.12.m12.1.1.3.cmml" xref="S5.p1.12.m12.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.12.m12.1c">\overline{C}=3</annotation></semantics></math>) or dirichlet (<math id="S5.p1.13.m13.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.p1.13.m13.1a"><mrow id="S5.p1.13.m13.1.1" xref="S5.p1.13.m13.1.1.cmml"><mi id="S5.p1.13.m13.1.1.2" xref="S5.p1.13.m13.1.1.2.cmml">α</mi><mo id="S5.p1.13.m13.1.1.1" xref="S5.p1.13.m13.1.1.1.cmml">=</mo><mn id="S5.p1.13.m13.1.1.3" xref="S5.p1.13.m13.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.13.m13.1b"><apply id="S5.p1.13.m13.1.1.cmml" xref="S5.p1.13.m13.1.1"><eq id="S5.p1.13.m13.1.1.1.cmml" xref="S5.p1.13.m13.1.1.1"></eq><ci id="S5.p1.13.m13.1.1.2.cmml" xref="S5.p1.13.m13.1.1.2">𝛼</ci><cn type="float" id="S5.p1.13.m13.1.1.3.cmml" xref="S5.p1.13.m13.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.13.m13.1c">\alpha=0.1</annotation></semantics></math>), denoted as <math id="S5.p1.14.m14.1" class="ltx_Math" alttext="\overline{C_{k}}" display="inline"><semantics id="S5.p1.14.m14.1a"><mover accent="true" id="S5.p1.14.m14.1.1" xref="S5.p1.14.m14.1.1.cmml"><msub id="S5.p1.14.m14.1.1.2" xref="S5.p1.14.m14.1.1.2.cmml"><mi id="S5.p1.14.m14.1.1.2.2" xref="S5.p1.14.m14.1.1.2.2.cmml">C</mi><mi id="S5.p1.14.m14.1.1.2.3" xref="S5.p1.14.m14.1.1.2.3.cmml">k</mi></msub><mo id="S5.p1.14.m14.1.1.1" xref="S5.p1.14.m14.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p1.14.m14.1b"><apply id="S5.p1.14.m14.1.1.cmml" xref="S5.p1.14.m14.1.1"><ci id="S5.p1.14.m14.1.1.1.cmml" xref="S5.p1.14.m14.1.1.1">¯</ci><apply id="S5.p1.14.m14.1.1.2.cmml" xref="S5.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S5.p1.14.m14.1.1.2.1.cmml" xref="S5.p1.14.m14.1.1.2">subscript</csymbol><ci id="S5.p1.14.m14.1.1.2.2.cmml" xref="S5.p1.14.m14.1.1.2.2">𝐶</ci><ci id="S5.p1.14.m14.1.1.2.3.cmml" xref="S5.p1.14.m14.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.14.m14.1c">\overline{C_{k}}</annotation></semantics></math> separated by "<math id="S5.p1.15.m15.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S5.p1.15.m15.1a"><mo fence="false" stretchy="false" id="S5.p1.15.m15.1.1" xref="S5.p1.15.m15.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S5.p1.15.m15.1b"><ci id="S5.p1.15.m15.1.1.cmml" xref="S5.p1.15.m15.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.15.m15.1c">|</annotation></semantics></math>".</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">For different datasets, we use corresponding deep neural networks, including: (1) MLPNet for MNIST with three layers, the hidden size of each hidden layer is 1024, and the last layer’s size is 2 for visualization in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and 128 for performance comparisons; (2) LeNet <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib35" title="" class="ltx_ref">mnist </a></cite> for MNISTm; (3) ConvNet for SVHN as used in FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>, we use T-SNE <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib37" title="" class="ltx_ref">TSNE </a></cite> for visualization in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>; (4) VGG8 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib50" title="" class="ltx_ref">VGG </a></cite> for CIFAR10/100 with 5 convolution layers and 3 fully-connected layers; (5) ResNet8/20 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">ResNet </a></cite> for CIFAR100; (6) FeCNN for FeMnist as used in LEAF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib48" title="" class="ltx_ref">LEAF </a></cite>; (7) CharLSTM for Shakespeare as used in FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>. For our proposed MrTF, we extract features for further label refinery as introduced in Sect. <a href="#S4.SS3" title="4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>. For MLPNet and CharLSTM, we utilize the last hidden layer’s output as features; for convolution networks, we use the flattened convolution features.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.24" class="ltx_p">In TFL, the number of clients <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p3.1.m1.1a"><mi id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><ci id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">K</annotation></semantics></math>, the client participation ratio <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.p3.2.m2.1a"><mi id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><ci id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">R</annotation></semantics></math>, the split parameters <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S5.p3.3.m3.1a"><mover accent="true" id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">C</mi><mo id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><ci id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1">¯</ci><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\overline{C}</annotation></semantics></math> and <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p3.4.m4.1a"><mi id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><ci id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\alpha</annotation></semantics></math> determine a FL scene. Usually, <math id="S5.p3.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p3.5.m5.1a"><mi id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b"><ci id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">K</annotation></semantics></math> is large in FL, and <math id="S5.p3.6.m6.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.p3.6.m6.1a"><mi id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b"><ci id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">R</annotation></semantics></math> could be small due to limited or unstable communication. <math id="S5.p3.7.m7.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S5.p3.7.m7.1a"><mover accent="true" id="S5.p3.7.m7.1.1" xref="S5.p3.7.m7.1.1.cmml"><mi id="S5.p3.7.m7.1.1.2" xref="S5.p3.7.m7.1.1.2.cmml">C</mi><mo id="S5.p3.7.m7.1.1.1" xref="S5.p3.7.m7.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p3.7.m7.1b"><apply id="S5.p3.7.m7.1.1.cmml" xref="S5.p3.7.m7.1.1"><ci id="S5.p3.7.m7.1.1.1.cmml" xref="S5.p3.7.m7.1.1.1">¯</ci><ci id="S5.p3.7.m7.1.1.2.cmml" xref="S5.p3.7.m7.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.7.m7.1c">\overline{C}</annotation></semantics></math> and <math id="S5.p3.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p3.8.m8.1a"><mi id="S5.p3.8.m8.1.1" xref="S5.p3.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p3.8.m8.1b"><ci id="S5.p3.8.m8.1.1.cmml" xref="S5.p3.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.8.m8.1c">\alpha</annotation></semantics></math> are introduced to split the centralized training data for simulating a decentralized setting. We investigate <math id="S5.p3.9.m9.2" class="ltx_Math" alttext="K=100,1000" display="inline"><semantics id="S5.p3.9.m9.2a"><mrow id="S5.p3.9.m9.2.3" xref="S5.p3.9.m9.2.3.cmml"><mi id="S5.p3.9.m9.2.3.2" xref="S5.p3.9.m9.2.3.2.cmml">K</mi><mo id="S5.p3.9.m9.2.3.1" xref="S5.p3.9.m9.2.3.1.cmml">=</mo><mrow id="S5.p3.9.m9.2.3.3.2" xref="S5.p3.9.m9.2.3.3.1.cmml"><mn id="S5.p3.9.m9.1.1" xref="S5.p3.9.m9.1.1.cmml">100</mn><mo id="S5.p3.9.m9.2.3.3.2.1" xref="S5.p3.9.m9.2.3.3.1.cmml">,</mo><mn id="S5.p3.9.m9.2.2" xref="S5.p3.9.m9.2.2.cmml">1000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.9.m9.2b"><apply id="S5.p3.9.m9.2.3.cmml" xref="S5.p3.9.m9.2.3"><eq id="S5.p3.9.m9.2.3.1.cmml" xref="S5.p3.9.m9.2.3.1"></eq><ci id="S5.p3.9.m9.2.3.2.cmml" xref="S5.p3.9.m9.2.3.2">𝐾</ci><list id="S5.p3.9.m9.2.3.3.1.cmml" xref="S5.p3.9.m9.2.3.3.2"><cn type="integer" id="S5.p3.9.m9.1.1.cmml" xref="S5.p3.9.m9.1.1">100</cn><cn type="integer" id="S5.p3.9.m9.2.2.cmml" xref="S5.p3.9.m9.2.2">1000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.9.m9.2c">K=100,1000</annotation></semantics></math>, <math id="S5.p3.10.m10.2" class="ltx_Math" alttext="R=10\%,1\%" display="inline"><semantics id="S5.p3.10.m10.2a"><mrow id="S5.p3.10.m10.2.2" xref="S5.p3.10.m10.2.2.cmml"><mi id="S5.p3.10.m10.2.2.4" xref="S5.p3.10.m10.2.2.4.cmml">R</mi><mo id="S5.p3.10.m10.2.2.3" xref="S5.p3.10.m10.2.2.3.cmml">=</mo><mrow id="S5.p3.10.m10.2.2.2.2" xref="S5.p3.10.m10.2.2.2.3.cmml"><mrow id="S5.p3.10.m10.1.1.1.1.1" xref="S5.p3.10.m10.1.1.1.1.1.cmml"><mn id="S5.p3.10.m10.1.1.1.1.1.2" xref="S5.p3.10.m10.1.1.1.1.1.2.cmml">10</mn><mo id="S5.p3.10.m10.1.1.1.1.1.1" xref="S5.p3.10.m10.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="S5.p3.10.m10.2.2.2.2.3" xref="S5.p3.10.m10.2.2.2.3.cmml">,</mo><mrow id="S5.p3.10.m10.2.2.2.2.2" xref="S5.p3.10.m10.2.2.2.2.2.cmml"><mn id="S5.p3.10.m10.2.2.2.2.2.2" xref="S5.p3.10.m10.2.2.2.2.2.2.cmml">1</mn><mo id="S5.p3.10.m10.2.2.2.2.2.1" xref="S5.p3.10.m10.2.2.2.2.2.1.cmml">%</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.10.m10.2b"><apply id="S5.p3.10.m10.2.2.cmml" xref="S5.p3.10.m10.2.2"><eq id="S5.p3.10.m10.2.2.3.cmml" xref="S5.p3.10.m10.2.2.3"></eq><ci id="S5.p3.10.m10.2.2.4.cmml" xref="S5.p3.10.m10.2.2.4">𝑅</ci><list id="S5.p3.10.m10.2.2.2.3.cmml" xref="S5.p3.10.m10.2.2.2.2"><apply id="S5.p3.10.m10.1.1.1.1.1.cmml" xref="S5.p3.10.m10.1.1.1.1.1"><csymbol cd="latexml" id="S5.p3.10.m10.1.1.1.1.1.1.cmml" xref="S5.p3.10.m10.1.1.1.1.1.1">percent</csymbol><cn type="integer" id="S5.p3.10.m10.1.1.1.1.1.2.cmml" xref="S5.p3.10.m10.1.1.1.1.1.2">10</cn></apply><apply id="S5.p3.10.m10.2.2.2.2.2.cmml" xref="S5.p3.10.m10.2.2.2.2.2"><csymbol cd="latexml" id="S5.p3.10.m10.2.2.2.2.2.1.cmml" xref="S5.p3.10.m10.2.2.2.2.2.1">percent</csymbol><cn type="integer" id="S5.p3.10.m10.2.2.2.2.2.2.cmml" xref="S5.p3.10.m10.2.2.2.2.2.2">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.10.m10.2c">R=10\%,1\%</annotation></semantics></math> in our experiments. We also investigate several data split ways, e.g., <math id="S5.p3.11.m11.2" class="ltx_Math" alttext="\overline{C}=5,3" display="inline"><semantics id="S5.p3.11.m11.2a"><mrow id="S5.p3.11.m11.2.3" xref="S5.p3.11.m11.2.3.cmml"><mover accent="true" id="S5.p3.11.m11.2.3.2" xref="S5.p3.11.m11.2.3.2.cmml"><mi id="S5.p3.11.m11.2.3.2.2" xref="S5.p3.11.m11.2.3.2.2.cmml">C</mi><mo id="S5.p3.11.m11.2.3.2.1" xref="S5.p3.11.m11.2.3.2.1.cmml">¯</mo></mover><mo id="S5.p3.11.m11.2.3.1" xref="S5.p3.11.m11.2.3.1.cmml">=</mo><mrow id="S5.p3.11.m11.2.3.3.2" xref="S5.p3.11.m11.2.3.3.1.cmml"><mn id="S5.p3.11.m11.1.1" xref="S5.p3.11.m11.1.1.cmml">5</mn><mo id="S5.p3.11.m11.2.3.3.2.1" xref="S5.p3.11.m11.2.3.3.1.cmml">,</mo><mn id="S5.p3.11.m11.2.2" xref="S5.p3.11.m11.2.2.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.11.m11.2b"><apply id="S5.p3.11.m11.2.3.cmml" xref="S5.p3.11.m11.2.3"><eq id="S5.p3.11.m11.2.3.1.cmml" xref="S5.p3.11.m11.2.3.1"></eq><apply id="S5.p3.11.m11.2.3.2.cmml" xref="S5.p3.11.m11.2.3.2"><ci id="S5.p3.11.m11.2.3.2.1.cmml" xref="S5.p3.11.m11.2.3.2.1">¯</ci><ci id="S5.p3.11.m11.2.3.2.2.cmml" xref="S5.p3.11.m11.2.3.2.2">𝐶</ci></apply><list id="S5.p3.11.m11.2.3.3.1.cmml" xref="S5.p3.11.m11.2.3.3.2"><cn type="integer" id="S5.p3.11.m11.1.1.cmml" xref="S5.p3.11.m11.1.1">5</cn><cn type="integer" id="S5.p3.11.m11.2.2.cmml" xref="S5.p3.11.m11.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.11.m11.2c">\overline{C}=5,3</annotation></semantics></math> for <math id="S5.p3.12.m12.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="S5.p3.12.m12.1a"><mrow id="S5.p3.12.m12.1.1" xref="S5.p3.12.m12.1.1.cmml"><mi id="S5.p3.12.m12.1.1.2" xref="S5.p3.12.m12.1.1.2.cmml">C</mi><mo id="S5.p3.12.m12.1.1.1" xref="S5.p3.12.m12.1.1.1.cmml">=</mo><mn id="S5.p3.12.m12.1.1.3" xref="S5.p3.12.m12.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.12.m12.1b"><apply id="S5.p3.12.m12.1.1.cmml" xref="S5.p3.12.m12.1.1"><eq id="S5.p3.12.m12.1.1.1.cmml" xref="S5.p3.12.m12.1.1.1"></eq><ci id="S5.p3.12.m12.1.1.2.cmml" xref="S5.p3.12.m12.1.1.2">𝐶</ci><cn type="integer" id="S5.p3.12.m12.1.1.3.cmml" xref="S5.p3.12.m12.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.12.m12.1c">C=10</annotation></semantics></math>, <math id="S5.p3.13.m13.2" class="ltx_Math" alttext="\alpha=1.0,0.1" display="inline"><semantics id="S5.p3.13.m13.2a"><mrow id="S5.p3.13.m13.2.3" xref="S5.p3.13.m13.2.3.cmml"><mi id="S5.p3.13.m13.2.3.2" xref="S5.p3.13.m13.2.3.2.cmml">α</mi><mo id="S5.p3.13.m13.2.3.1" xref="S5.p3.13.m13.2.3.1.cmml">=</mo><mrow id="S5.p3.13.m13.2.3.3.2" xref="S5.p3.13.m13.2.3.3.1.cmml"><mn id="S5.p3.13.m13.1.1" xref="S5.p3.13.m13.1.1.cmml">1.0</mn><mo id="S5.p3.13.m13.2.3.3.2.1" xref="S5.p3.13.m13.2.3.3.1.cmml">,</mo><mn id="S5.p3.13.m13.2.2" xref="S5.p3.13.m13.2.2.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.13.m13.2b"><apply id="S5.p3.13.m13.2.3.cmml" xref="S5.p3.13.m13.2.3"><eq id="S5.p3.13.m13.2.3.1.cmml" xref="S5.p3.13.m13.2.3.1"></eq><ci id="S5.p3.13.m13.2.3.2.cmml" xref="S5.p3.13.m13.2.3.2">𝛼</ci><list id="S5.p3.13.m13.2.3.3.1.cmml" xref="S5.p3.13.m13.2.3.3.2"><cn type="float" id="S5.p3.13.m13.1.1.cmml" xref="S5.p3.13.m13.1.1">1.0</cn><cn type="float" id="S5.p3.13.m13.2.2.cmml" xref="S5.p3.13.m13.2.2">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.13.m13.2c">\alpha=1.0,0.1</annotation></semantics></math>. Smaller <math id="S5.p3.14.m14.1" class="ltx_Math" alttext="\overline{C}" display="inline"><semantics id="S5.p3.14.m14.1a"><mover accent="true" id="S5.p3.14.m14.1.1" xref="S5.p3.14.m14.1.1.cmml"><mi id="S5.p3.14.m14.1.1.2" xref="S5.p3.14.m14.1.1.2.cmml">C</mi><mo id="S5.p3.14.m14.1.1.1" xref="S5.p3.14.m14.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.p3.14.m14.1b"><apply id="S5.p3.14.m14.1.1.cmml" xref="S5.p3.14.m14.1.1"><ci id="S5.p3.14.m14.1.1.1.cmml" xref="S5.p3.14.m14.1.1.1">¯</ci><ci id="S5.p3.14.m14.1.1.2.cmml" xref="S5.p3.14.m14.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.14.m14.1c">\overline{C}</annotation></semantics></math> or <math id="S5.p3.15.m15.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p3.15.m15.1a"><mi id="S5.p3.15.m15.1.1" xref="S5.p3.15.m15.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p3.15.m15.1b"><ci id="S5.p3.15.m15.1.1.cmml" xref="S5.p3.15.m15.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.15.m15.1c">\alpha</annotation></semantics></math> corresponds to more Non-I.I.D. scenes. Other important hyper-parameters include the number of global communication rounds <math id="S5.p3.16.m16.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.p3.16.m16.1a"><mi id="S5.p3.16.m16.1.1" xref="S5.p3.16.m16.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.p3.16.m16.1b"><ci id="S5.p3.16.m16.1.1.cmml" xref="S5.p3.16.m16.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.16.m16.1c">T</annotation></semantics></math> and the local training epochs <math id="S5.p3.17.m17.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.p3.17.m17.1a"><mi id="S5.p3.17.m17.1.1" xref="S5.p3.17.m17.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.p3.17.m17.1b"><ci id="S5.p3.17.m17.1.1.cmml" xref="S5.p3.17.m17.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.17.m17.1c">E</annotation></semantics></math>. We also study our method on various settings of <math id="S5.p3.18.m18.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.p3.18.m18.1a"><mi id="S5.p3.18.m18.1.1" xref="S5.p3.18.m18.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.p3.18.m18.1b"><ci id="S5.p3.18.m18.1.1.cmml" xref="S5.p3.18.m18.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.18.m18.1c">T</annotation></semantics></math> and <math id="S5.p3.19.m19.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.p3.19.m19.1a"><mi id="S5.p3.19.m19.1.1" xref="S5.p3.19.m19.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.p3.19.m19.1b"><ci id="S5.p3.19.m19.1.1.cmml" xref="S5.p3.19.m19.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.19.m19.1c">E</annotation></semantics></math>. We use SGD with a momentum of 0.9 as the local optimizer. For digits recognition scenes, we vary learning rate in <math id="S5.p3.20.m20.3" class="ltx_Math" alttext="\{0.1,0.05,0.01\}" display="inline"><semantics id="S5.p3.20.m20.3a"><mrow id="S5.p3.20.m20.3.4.2" xref="S5.p3.20.m20.3.4.1.cmml"><mo stretchy="false" id="S5.p3.20.m20.3.4.2.1" xref="S5.p3.20.m20.3.4.1.cmml">{</mo><mn id="S5.p3.20.m20.1.1" xref="S5.p3.20.m20.1.1.cmml">0.1</mn><mo id="S5.p3.20.m20.3.4.2.2" xref="S5.p3.20.m20.3.4.1.cmml">,</mo><mn id="S5.p3.20.m20.2.2" xref="S5.p3.20.m20.2.2.cmml">0.05</mn><mo id="S5.p3.20.m20.3.4.2.3" xref="S5.p3.20.m20.3.4.1.cmml">,</mo><mn id="S5.p3.20.m20.3.3" xref="S5.p3.20.m20.3.3.cmml">0.01</mn><mo stretchy="false" id="S5.p3.20.m20.3.4.2.4" xref="S5.p3.20.m20.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.20.m20.3b"><set id="S5.p3.20.m20.3.4.1.cmml" xref="S5.p3.20.m20.3.4.2"><cn type="float" id="S5.p3.20.m20.1.1.cmml" xref="S5.p3.20.m20.1.1">0.1</cn><cn type="float" id="S5.p3.20.m20.2.2.cmml" xref="S5.p3.20.m20.2.2">0.05</cn><cn type="float" id="S5.p3.20.m20.3.3.cmml" xref="S5.p3.20.m20.3.3">0.01</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.20.m20.3c">\{0.1,0.05,0.01\}</annotation></semantics></math> and report the best one for comparison; for CIFAR scenes, we vary learning rate in <math id="S5.p3.21.m21.3" class="ltx_Math" alttext="\{0.05,0.03,0.01\}" display="inline"><semantics id="S5.p3.21.m21.3a"><mrow id="S5.p3.21.m21.3.4.2" xref="S5.p3.21.m21.3.4.1.cmml"><mo stretchy="false" id="S5.p3.21.m21.3.4.2.1" xref="S5.p3.21.m21.3.4.1.cmml">{</mo><mn id="S5.p3.21.m21.1.1" xref="S5.p3.21.m21.1.1.cmml">0.05</mn><mo id="S5.p3.21.m21.3.4.2.2" xref="S5.p3.21.m21.3.4.1.cmml">,</mo><mn id="S5.p3.21.m21.2.2" xref="S5.p3.21.m21.2.2.cmml">0.03</mn><mo id="S5.p3.21.m21.3.4.2.3" xref="S5.p3.21.m21.3.4.1.cmml">,</mo><mn id="S5.p3.21.m21.3.3" xref="S5.p3.21.m21.3.3.cmml">0.01</mn><mo stretchy="false" id="S5.p3.21.m21.3.4.2.4" xref="S5.p3.21.m21.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.21.m21.3b"><set id="S5.p3.21.m21.3.4.1.cmml" xref="S5.p3.21.m21.3.4.2"><cn type="float" id="S5.p3.21.m21.1.1.cmml" xref="S5.p3.21.m21.1.1">0.05</cn><cn type="float" id="S5.p3.21.m21.2.2.cmml" xref="S5.p3.21.m21.2.2">0.03</cn><cn type="float" id="S5.p3.21.m21.3.3.cmml" xref="S5.p3.21.m21.3.3">0.01</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.21.m21.3c">\{0.05,0.03,0.01\}</annotation></semantics></math>; for FeMnist, we use <math id="S5.p3.22.m22.1" class="ltx_Math" alttext="0.004" display="inline"><semantics id="S5.p3.22.m22.1a"><mn id="S5.p3.22.m22.1.1" xref="S5.p3.22.m22.1.1.cmml">0.004</mn><annotation-xml encoding="MathML-Content" id="S5.p3.22.m22.1b"><cn type="float" id="S5.p3.22.m22.1.1.cmml" xref="S5.p3.22.m22.1.1">0.004</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.22.m22.1c">0.004</annotation></semantics></math>; for Shakespeare, we use <math id="S5.p3.23.m23.1" class="ltx_Math" alttext="1.47" display="inline"><semantics id="S5.p3.23.m23.1a"><mn id="S5.p3.23.m23.1.1" xref="S5.p3.23.m23.1.1.cmml">1.47</mn><annotation-xml encoding="MathML-Content" id="S5.p3.23.m23.1b"><cn type="float" id="S5.p3.23.m23.1.1.cmml" xref="S5.p3.23.m23.1.1">1.47</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.23.m23.1c">1.47</annotation></semantics></math>. For digits and CIFAR scenes, we use a batch size of 64; for FeMnist and Shakespeare, we use 10. We use Adam with a learning rate <math id="S5.p3.24.m24.1" class="ltx_Math" alttext="0.0003" display="inline"><semantics id="S5.p3.24.m24.1a"><mn id="S5.p3.24.m24.1.1" xref="S5.p3.24.m24.1.1.cmml">0.0003</mn><annotation-xml encoding="MathML-Content" id="S5.p3.24.m24.1b"><cn type="float" id="S5.p3.24.m24.1.1.cmml" xref="S5.p3.24.m24.1.1">0.0003</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.24.m24.1c">0.0003</annotation></semantics></math> as the global optimizer in FedDF and MrTF (Ours) and take 500 distillation steps.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div id="S5.F6.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x10.png" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="246" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S5.F6.3.1" class="ltx_text" style="font-size:90%;">Comparisons of “AvgLogi" and “AvgProb" across three clients on MNIST, each client only observes 2 classes. The top shows the instance-averaged “logits" and “probs" on global test set of each local model. The bottom shows the distillation targets generated via: uniform averaging, non-uniform averaging, averaging after adding aggregated models.</span></figcaption>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Demo Analysis</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We first verify the success of the first two modules in MrTF, which are proposed to tackle the varying magnitudes and improper distillation drawbacks in FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>.
We experiment on MNIST with three clients and each client could only observe two classes. We init a global model and distribute it to the three clients. After local training, we use these three local models to predict on the global test set, recording the accuracy and each instance’s “logits" and “probs". We average the class “logits" or “probs" across test samples for better presentation. Because the global test set is uniformly distributed across 10 classes, and <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_italic">we expect the average results of both “logits" and “probs" are also uniform</span>. The results are shown in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.6" class="ltx_p">First, the top three figures show the results of each local model. The accuracies are low, i.e., 17.6%, 19.2%, 20.4%. The reasons are intuitive: they are trained with only 2 classes, while the global test set contains 10 classes. The “logits" across clients vary greatly, with the largest ranging from 9.0 to 20.0, while the corresponding “probs" are limited to <math id="S5.SS1.p2.1.m1.2" class="ltx_Math" alttext="[0,0.5]" display="inline"><semantics id="S5.SS1.p2.1.m1.2a"><mrow id="S5.SS1.p2.1.m1.2.3.2" xref="S5.SS1.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S5.SS1.p2.1.m1.2.3.2.1" xref="S5.SS1.p2.1.m1.2.3.1.cmml">[</mo><mn id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">0</mn><mo id="S5.SS1.p2.1.m1.2.3.2.2" xref="S5.SS1.p2.1.m1.2.3.1.cmml">,</mo><mn id="S5.SS1.p2.1.m1.2.2" xref="S5.SS1.p2.1.m1.2.2.cmml">0.5</mn><mo stretchy="false" id="S5.SS1.p2.1.m1.2.3.2.3" xref="S5.SS1.p2.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.2b"><interval closure="closed" id="S5.SS1.p2.1.m1.2.3.1.cmml" xref="S5.SS1.p2.1.m1.2.3.2"><cn type="integer" id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">0</cn><cn type="float" id="S5.SS1.p2.1.m1.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2">0.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.2c">[0,0.5]</annotation></semantics></math>. If we uniformly (<math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="w_{k}=1/K" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><msub id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml"><mi id="S5.SS1.p2.2.m2.1.1.2.2" xref="S5.SS1.p2.2.m2.1.1.2.2.cmml">w</mi><mi id="S5.SS1.p2.2.m2.1.1.2.3" xref="S5.SS1.p2.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S5.SS1.p2.2.m2.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml"><mn id="S5.SS1.p2.2.m2.1.1.3.2" xref="S5.SS1.p2.2.m2.1.1.3.2.cmml">1</mn><mo id="S5.SS1.p2.2.m2.1.1.3.1" xref="S5.SS1.p2.2.m2.1.1.3.1.cmml">/</mo><mi id="S5.SS1.p2.2.m2.1.1.3.3" xref="S5.SS1.p2.2.m2.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><eq id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1"></eq><apply id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.2.1.cmml" xref="S5.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.2.m2.1.1.2.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2.2">𝑤</ci><ci id="S5.SS1.p2.2.m2.1.1.2.3.cmml" xref="S5.SS1.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3"><divide id="S5.SS1.p2.2.m2.1.1.3.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3.1"></divide><cn type="integer" id="S5.SS1.p2.2.m2.1.1.3.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2">1</cn><ci id="S5.SS1.p2.2.m2.1.1.3.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">w_{k}=1/K</annotation></semantics></math>) average “logits" and “probs" of three local models for each test instance as done in Eq. <a href="#S4.E3" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Eq. <a href="#S4.E4" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the results are shown at the bottom left of Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Because the 9th class (showed in red) generally has large “logits" (i.e., around 20.0) predicted by the first local model, it dominates the <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mrow id="S5.SS1.p2.3.m3.1.2" xref="S5.SS1.p2.3.m3.1.2.cmml"><mi id="S5.SS1.p2.3.m3.1.2.2" xref="S5.SS1.p2.3.m3.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.2.1" xref="S5.SS1.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S5.SS1.p2.3.m3.1.2.3.2" xref="S5.SS1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.3.m3.1.2.3.2.1" xref="S5.SS1.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S5.SS1.p2.3.m3.1.2.3.2.2" xref="S5.SS1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.2.cmml" xref="S5.SS1.p2.3.m3.1.2"><times id="S5.SS1.p2.3.m3.1.2.1.cmml" xref="S5.SS1.p2.3.m3.1.2.1"></times><ci id="S5.SS1.p2.3.m3.1.2.2.cmml" xref="S5.SS1.p2.3.m3.1.2.2">𝜎</ci><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\sigma(\cdot)</annotation></semantics></math> operation and makes “AvgLogi" output much higher probabilities on the 9th class. However, using “AvgProb" leads to smoother class probabilities and the test accuracy improves from 33.1% to 44.0%. If we apply <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="w_{1}=0.6" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><msub id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml"><mi id="S5.SS1.p2.4.m4.1.1.2.2" xref="S5.SS1.p2.4.m4.1.1.2.2.cmml">w</mi><mn id="S5.SS1.p2.4.m4.1.1.2.3" xref="S5.SS1.p2.4.m4.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS1.p2.4.m4.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><eq id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1"></eq><apply id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2.2">𝑤</ci><cn type="integer" id="S5.SS1.p2.4.m4.1.1.2.3.cmml" xref="S5.SS1.p2.4.m4.1.1.2.3">1</cn></apply><cn type="float" id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">w_{1}=0.6</annotation></semantics></math>,<math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="w_{2}=0.3" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><mrow id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><msub id="S5.SS1.p2.5.m5.1.1.2" xref="S5.SS1.p2.5.m5.1.1.2.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2.2" xref="S5.SS1.p2.5.m5.1.1.2.2.cmml">w</mi><mn id="S5.SS1.p2.5.m5.1.1.2.3" xref="S5.SS1.p2.5.m5.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS1.p2.5.m5.1.1.1" xref="S5.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.5.m5.1.1.3" xref="S5.SS1.p2.5.m5.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><eq id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1.1"></eq><apply id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.2.1.cmml" xref="S5.SS1.p2.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2.2">𝑤</ci><cn type="integer" id="S5.SS1.p2.5.m5.1.1.2.3.cmml" xref="S5.SS1.p2.5.m5.1.1.2.3">2</cn></apply><cn type="float" id="S5.SS1.p2.5.m5.1.1.3.cmml" xref="S5.SS1.p2.5.m5.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">w_{2}=0.3</annotation></semantics></math>,<math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="w_{3}=0.1" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><mrow id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml"><msub id="S5.SS1.p2.6.m6.1.1.2" xref="S5.SS1.p2.6.m6.1.1.2.cmml"><mi id="S5.SS1.p2.6.m6.1.1.2.2" xref="S5.SS1.p2.6.m6.1.1.2.2.cmml">w</mi><mn id="S5.SS1.p2.6.m6.1.1.2.3" xref="S5.SS1.p2.6.m6.1.1.2.3.cmml">3</mn></msub><mo id="S5.SS1.p2.6.m6.1.1.1" xref="S5.SS1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.6.m6.1.1.3" xref="S5.SS1.p2.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><apply id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1"><eq id="S5.SS1.p2.6.m6.1.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1.1"></eq><apply id="S5.SS1.p2.6.m6.1.1.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m6.1.1.2.1.cmml" xref="S5.SS1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.6.m6.1.1.2.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2">𝑤</ci><cn type="integer" id="S5.SS1.p2.6.m6.1.1.2.3.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3">3</cn></apply><cn type="float" id="S5.SS1.p2.6.m6.1.1.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">w_{3}=0.1</annotation></semantics></math> for averaging, the results of “AvgLogi" are worse as shown in the bottom middle of Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (the 9th stem is higher). However, “AvgProb" performs more stably and the class probabilities are more uniform. <span id="S5.SS1.p2.6.1" class="ltx_text ltx_font_italic">These observations show that replacing “AvgLogi" with “AvgProb" could really mitigate the problem of the varying magnitude, leading to moderate teachers and better ensemble performances.</span></p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">From another aspect, because these three clients only observe at most 6 classes in total, some unseen classes’ “logits" will be inaccurate. Illustrated in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, some classes’ probabilities become zero. That is, the stochastic client participation will lead to inaccurate distillation targets, and directly using “AvgLogi" or “AvgProb" for distillation is improper. Instead, we fuse the global aggregated models and rectify the probabilities as done in Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. Then the results shown at the bottom right of Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> are better. That is, the probabilities of “AvgLogi" and “AvgProb" become more smooth and the test accuracies are improved to 39.4% and 79.9%, respectively. All observations verify the rationality and effectiveness of our solutions in Sect. <a href="#S4.SS1" title="4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> and Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div id="S5.F7.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x11.png" id="S5.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="277" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S5.F7.3.1" class="ltx_text" style="font-size:90%;">Performance comparisons on several FL scenes. Row shows each dataset and column shows each data split way.</span></figcaption>
</figure>
<figure id="S5.F8" class="ltx_figure">
<div id="S5.F8.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x12.png" id="S5.F8.1.g1" class="ltx_graphics ltx_img_square" width="461" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S5.F8.3.1" class="ltx_text" style="font-size:90%;">Performance comparisons on CIFAR100 based on VGG8 and ResNet8/20. Row shows FL scene with different data split ways.</span></figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure">
<div id="S5.F9.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x13.png" id="S5.F9.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="215" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span id="S5.F9.3.1" class="ltx_text" style="font-size:90%;">Performance comparisons on LEAF benchmarks.</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance Comparisons</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We compare MrTF with FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib18" title="" class="ltx_ref">FedProx </a></cite>, FedMMD <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib19" title="" class="ltx_ref">FedMMD </a></cite>, FedOpt <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib51" title="" class="ltx_ref">FedOpt </a></cite>, Scaffold <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib20" title="" class="ltx_ref">Scaffold </a></cite>, and FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>. The first five algorithms do not access the global test set during training, while they utilize various techniques to solve Non-I.I.D. problems. FedDF utilizes “AvgLogi" to refine the aggregated model, which is the most similar to ours. Details of these algorithms are presented as follows.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite></span>: the most standard FL algorithm that utilizes parameter averaging for model aggregation.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">FedProx <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib18" title="" class="ltx_ref">FedProx </a></cite></span>: introduces a proximal term during local procedures to constrain the model parameters’ update.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">FedMMD <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib19" title="" class="ltx_ref">FedMMD </a></cite></span>: introduces the discrepancy minimizing optimization (i.e., MMD) in local procedures and regularizes the local model not diverge a lot from the global model too much.</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p"><span id="S5.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">FedOpt <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib51" title="" class="ltx_ref">FedOpt </a></cite></span>: updates the global model via momentum or adaptive optimization techniques to stabilize the global model’s update.</p>
</div>
</li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p id="S5.I1.i5.p1.1" class="ltx_p"><span id="S5.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">Scaffold <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib20" title="" class="ltx_ref">Scaffold </a></cite></span>: points out the local update will diverge from the global direction and utilizes control variates to reduce local gradient variance.</p>
</div>
</li>
<li id="S5.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i6.p1" class="ltx_para">
<p id="S5.I1.i6.p1.1" class="ltx_p"><span id="S5.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite></span>: uses local models’ ensemble, i.e., “AvgLogi", to finetune the global model on a relevant public data set.</p>
</div>
</li>
</ul>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.7" class="ltx_p"><span id="S5.SS2.p2.7.1" class="ltx_text ltx_font_bold">Part I</span> We first study on MNIST, MNISTm, SVHN, and CIFAR10, which have 10 classes to identify. We construct four FL scenes for each dataset via “split by label" with <math id="S5.SS2.p2.1.m1.2" class="ltx_Math" alttext="\overline{C}\in\{5,3\}" display="inline"><semantics id="S5.SS2.p2.1.m1.2a"><mrow id="S5.SS2.p2.1.m1.2.3" xref="S5.SS2.p2.1.m1.2.3.cmml"><mover accent="true" id="S5.SS2.p2.1.m1.2.3.2" xref="S5.SS2.p2.1.m1.2.3.2.cmml"><mi id="S5.SS2.p2.1.m1.2.3.2.2" xref="S5.SS2.p2.1.m1.2.3.2.2.cmml">C</mi><mo id="S5.SS2.p2.1.m1.2.3.2.1" xref="S5.SS2.p2.1.m1.2.3.2.1.cmml">¯</mo></mover><mo id="S5.SS2.p2.1.m1.2.3.1" xref="S5.SS2.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS2.p2.1.m1.2.3.3.2" xref="S5.SS2.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.p2.1.m1.2.3.3.2.1" xref="S5.SS2.p2.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">5</mn><mo id="S5.SS2.p2.1.m1.2.3.3.2.2" xref="S5.SS2.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p2.1.m1.2.2" xref="S5.SS2.p2.1.m1.2.2.cmml">3</mn><mo stretchy="false" id="S5.SS2.p2.1.m1.2.3.3.2.3" xref="S5.SS2.p2.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.2b"><apply id="S5.SS2.p2.1.m1.2.3.cmml" xref="S5.SS2.p2.1.m1.2.3"><in id="S5.SS2.p2.1.m1.2.3.1.cmml" xref="S5.SS2.p2.1.m1.2.3.1"></in><apply id="S5.SS2.p2.1.m1.2.3.2.cmml" xref="S5.SS2.p2.1.m1.2.3.2"><ci id="S5.SS2.p2.1.m1.2.3.2.1.cmml" xref="S5.SS2.p2.1.m1.2.3.2.1">¯</ci><ci id="S5.SS2.p2.1.m1.2.3.2.2.cmml" xref="S5.SS2.p2.1.m1.2.3.2.2">𝐶</ci></apply><set id="S5.SS2.p2.1.m1.2.3.3.1.cmml" xref="S5.SS2.p2.1.m1.2.3.3.2"><cn type="integer" id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">5</cn><cn type="integer" id="S5.SS2.p2.1.m1.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2">3</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.2c">\overline{C}\in\{5,3\}</annotation></semantics></math> and “split by dirichlet" with <math id="S5.SS2.p2.2.m2.2" class="ltx_Math" alttext="\alpha\in\{1.0,0.1\}" display="inline"><semantics id="S5.SS2.p2.2.m2.2a"><mrow id="S5.SS2.p2.2.m2.2.3" xref="S5.SS2.p2.2.m2.2.3.cmml"><mi id="S5.SS2.p2.2.m2.2.3.2" xref="S5.SS2.p2.2.m2.2.3.2.cmml">α</mi><mo id="S5.SS2.p2.2.m2.2.3.1" xref="S5.SS2.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S5.SS2.p2.2.m2.2.3.3.2" xref="S5.SS2.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.p2.2.m2.2.3.3.2.1" xref="S5.SS2.p2.2.m2.2.3.3.1.cmml">{</mo><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">1.0</mn><mo id="S5.SS2.p2.2.m2.2.3.3.2.2" xref="S5.SS2.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.2.2" xref="S5.SS2.p2.2.m2.2.2.cmml">0.1</mn><mo stretchy="false" id="S5.SS2.p2.2.m2.2.3.3.2.3" xref="S5.SS2.p2.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.2b"><apply id="S5.SS2.p2.2.m2.2.3.cmml" xref="S5.SS2.p2.2.m2.2.3"><in id="S5.SS2.p2.2.m2.2.3.1.cmml" xref="S5.SS2.p2.2.m2.2.3.1"></in><ci id="S5.SS2.p2.2.m2.2.3.2.cmml" xref="S5.SS2.p2.2.m2.2.3.2">𝛼</ci><set id="S5.SS2.p2.2.m2.2.3.3.1.cmml" xref="S5.SS2.p2.2.m2.2.3.3.2"><cn type="float" id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">1.0</cn><cn type="float" id="S5.SS2.p2.2.m2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.2c">\alpha\in\{1.0,0.1\}</annotation></semantics></math>. We take <math id="S5.SS2.p2.3.m3.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS2.p2.3.m3.1a"><mrow id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">K</mi><mo id="S5.SS2.p2.3.m3.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1"><eq id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1"></eq><ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.p2.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">K=100</annotation></semantics></math> clients and only select <math id="S5.SS2.p2.4.m4.1" class="ltx_Math" alttext="R=10\%" display="inline"><semantics id="S5.SS2.p2.4.m4.1a"><mrow id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml"><mi id="S5.SS2.p2.4.m4.1.1.2" xref="S5.SS2.p2.4.m4.1.1.2.cmml">R</mi><mo id="S5.SS2.p2.4.m4.1.1.1" xref="S5.SS2.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S5.SS2.p2.4.m4.1.1.3" xref="S5.SS2.p2.4.m4.1.1.3.cmml"><mn id="S5.SS2.p2.4.m4.1.1.3.2" xref="S5.SS2.p2.4.m4.1.1.3.2.cmml">10</mn><mo id="S5.SS2.p2.4.m4.1.1.3.1" xref="S5.SS2.p2.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><apply id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1"><eq id="S5.SS2.p2.4.m4.1.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1.1"></eq><ci id="S5.SS2.p2.4.m4.1.1.2.cmml" xref="S5.SS2.p2.4.m4.1.1.2">𝑅</ci><apply id="S5.SS2.p2.4.m4.1.1.3.cmml" xref="S5.SS2.p2.4.m4.1.1.3"><csymbol cd="latexml" id="S5.SS2.p2.4.m4.1.1.3.1.cmml" xref="S5.SS2.p2.4.m4.1.1.3.1">percent</csymbol><cn type="integer" id="S5.SS2.p2.4.m4.1.1.3.2.cmml" xref="S5.SS2.p2.4.m4.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">R=10\%</annotation></semantics></math> clients in each communication round. We update <math id="S5.SS2.p2.5.m5.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S5.SS2.p2.5.m5.1a"><mrow id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml"><mi id="S5.SS2.p2.5.m5.1.1.2" xref="S5.SS2.p2.5.m5.1.1.2.cmml">E</mi><mo id="S5.SS2.p2.5.m5.1.1.1" xref="S5.SS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.5.m5.1.1.3" xref="S5.SS2.p2.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.1b"><apply id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1"><eq id="S5.SS2.p2.5.m5.1.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1.1"></eq><ci id="S5.SS2.p2.5.m5.1.1.2.cmml" xref="S5.SS2.p2.5.m5.1.1.2">𝐸</ci><cn type="integer" id="S5.SS2.p2.5.m5.1.1.3.cmml" xref="S5.SS2.p2.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.1c">E=3</annotation></semantics></math> epochs for each client during local procedures and take <math id="S5.SS2.p2.6.m6.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S5.SS2.p2.6.m6.1a"><mrow id="S5.SS2.p2.6.m6.1.1" xref="S5.SS2.p2.6.m6.1.1.cmml"><mi id="S5.SS2.p2.6.m6.1.1.2" xref="S5.SS2.p2.6.m6.1.1.2.cmml">T</mi><mo id="S5.SS2.p2.6.m6.1.1.1" xref="S5.SS2.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.6.m6.1.1.3" xref="S5.SS2.p2.6.m6.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m6.1b"><apply id="S5.SS2.p2.6.m6.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1"><eq id="S5.SS2.p2.6.m6.1.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1.1"></eq><ci id="S5.SS2.p2.6.m6.1.1.2.cmml" xref="S5.SS2.p2.6.m6.1.1.2">𝑇</ci><cn type="integer" id="S5.SS2.p2.6.m6.1.1.3.cmml" xref="S5.SS2.p2.6.m6.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m6.1c">T=200</annotation></semantics></math>, <math id="S5.SS2.p2.7.m7.1" class="ltx_Math" alttext="1500" display="inline"><semantics id="S5.SS2.p2.7.m7.1a"><mn id="S5.SS2.p2.7.m7.1.1" xref="S5.SS2.p2.7.m7.1.1.cmml">1500</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.7.m7.1b"><cn type="integer" id="S5.SS2.p2.7.m7.1.1.cmml" xref="S5.SS2.p2.7.m7.1.1">1500</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.7.m7.1c">1500</annotation></semantics></math> communication rounds for digits and CIFAR scenes, respectively. The results are shown in Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, where MrTF converges faster and performs better on all scenes. First, MrTF could surpass other methods by a large margin especially in the beginning, verifying that learning from local models’ ensemble significantly helps and lays the foundation for subsequent improvements. This conforms to the observation in Sect. <a href="#S3.SS3" title="3.3 Non-I.I.D. Data ‣ 3 Preliminaries ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Some compared algorithms could only improve FL on certain scenes. For example, Scaffold performs better than others on CIFAR10, while worse on other datasets.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.5" class="ltx_p"><span id="S5.SS2.p3.5.1" class="ltx_text ltx_font_bold">Part II</span> Then, we vary the utilized networks and compare the performances on CIFAR100 using VGG8<cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib50" title="" class="ltx_ref">VGG </a></cite> and ResNet8/20 <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">ResNet </a></cite>. We take <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mrow id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">K</mi><mo id="S5.SS2.p3.1.m1.1.1.1" xref="S5.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><eq id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1.1"></eq><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">K=100</annotation></semantics></math> clients and <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="R=10\%" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mrow id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">R</mi><mo id="S5.SS2.p3.2.m2.1.1.1" xref="S5.SS2.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml"><mn id="S5.SS2.p3.2.m2.1.1.3.2" xref="S5.SS2.p3.2.m2.1.1.3.2.cmml">10</mn><mo id="S5.SS2.p3.2.m2.1.1.3.1" xref="S5.SS2.p3.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><eq id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1.1"></eq><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">𝑅</ci><apply id="S5.SS2.p3.2.m2.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3"><csymbol cd="latexml" id="S5.SS2.p3.2.m2.1.1.3.1.cmml" xref="S5.SS2.p3.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S5.SS2.p3.2.m2.1.1.3.2.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">R=10\%</annotation></semantics></math>. The results are shown in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. For each scene, we run 500 communication rounds and each client takes on <math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mrow id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml"><mi id="S5.SS2.p3.3.m3.1.1.2" xref="S5.SS2.p3.3.m3.1.1.2.cmml">E</mi><mo id="S5.SS2.p3.3.m3.1.1.1" xref="S5.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.3.m3.1.1.3" xref="S5.SS2.p3.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><apply id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1"><eq id="S5.SS2.p3.3.m3.1.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1.1"></eq><ci id="S5.SS2.p3.3.m3.1.1.2.cmml" xref="S5.SS2.p3.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S5.SS2.p3.3.m3.1.1.3.cmml" xref="S5.SS2.p3.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">E=20</annotation></semantics></math> epochs. In some cases, MrTF performs worse than Scaffold, attributed to the control variates used in Scaffold. However, MrTF could obtain better results on most of the cases, especially in more Non-I.I.D. scenes, i.e., <math id="S5.SS2.p3.4.m4.1" class="ltx_Math" alttext="\overline{C}=30" display="inline"><semantics id="S5.SS2.p3.4.m4.1a"><mrow id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S5.SS2.p3.4.m4.1.1.2" xref="S5.SS2.p3.4.m4.1.1.2.cmml"><mi id="S5.SS2.p3.4.m4.1.1.2.2" xref="S5.SS2.p3.4.m4.1.1.2.2.cmml">C</mi><mo id="S5.SS2.p3.4.m4.1.1.2.1" xref="S5.SS2.p3.4.m4.1.1.2.1.cmml">¯</mo></mover><mo id="S5.SS2.p3.4.m4.1.1.1" xref="S5.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.4.m4.1.1.3" xref="S5.SS2.p3.4.m4.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.1b"><apply id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1"><eq id="S5.SS2.p3.4.m4.1.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1.1"></eq><apply id="S5.SS2.p3.4.m4.1.1.2.cmml" xref="S5.SS2.p3.4.m4.1.1.2"><ci id="S5.SS2.p3.4.m4.1.1.2.1.cmml" xref="S5.SS2.p3.4.m4.1.1.2.1">¯</ci><ci id="S5.SS2.p3.4.m4.1.1.2.2.cmml" xref="S5.SS2.p3.4.m4.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S5.SS2.p3.4.m4.1.1.3.cmml" xref="S5.SS2.p3.4.m4.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.1c">\overline{C}=30</annotation></semantics></math> and <math id="S5.SS2.p3.5.m5.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS2.p3.5.m5.1a"><mrow id="S5.SS2.p3.5.m5.1.1" xref="S5.SS2.p3.5.m5.1.1.cmml"><mi id="S5.SS2.p3.5.m5.1.1.2" xref="S5.SS2.p3.5.m5.1.1.2.cmml">α</mi><mo id="S5.SS2.p3.5.m5.1.1.1" xref="S5.SS2.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.5.m5.1.1.3" xref="S5.SS2.p3.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.5.m5.1b"><apply id="S5.SS2.p3.5.m5.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1"><eq id="S5.SS2.p3.5.m5.1.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1.1"></eq><ci id="S5.SS2.p3.5.m5.1.1.2.cmml" xref="S5.SS2.p3.5.m5.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.p3.5.m5.1.1.3.cmml" xref="S5.SS2.p3.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.5.m5.1c">\alpha=0.1</annotation></semantics></math> (the 2nd and 4th row in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). Because we have 100 classes, the possibility that participating clients cannot cover all classes greatly increases, making FedDF ineffective.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Part III</span> We also investigate our method on LEAF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib48" title="" class="ltx_ref">LEAF </a></cite> benchmarks, i.e., FeMnist and Shakespeare. These two benchmarks are split by users, where the distribution skew dominates the Non-I.I.D. <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib28" title="" class="ltx_ref">Fed-Advances </a></cite> problem. We show the results in Fig. <a href="#S5.F9" title="Figure 9 ‣ 5.1 Demo Analysis ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. Our proposed MrTF could still show effectiveness towards other methods. Although Scaffold could achieve faster convergence in the beginning, the performance degrades a lot with a larger communication round. The training instability limits the application of Scaffold to TFL. Compared with this, our proposed MrTF could achieve the Scaffold’s best performance and is more stable.</p>
</div>
<figure id="S5.F10" class="ltx_figure">
<div id="S5.F10.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x14.png" id="S5.F10.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="225" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="S5.F10.5.2" class="ltx_text" style="font-size:90%;">Comparison results with FedAvg and FedDF on more FL scenes. Row shows dataset and corresponding split strategy, and column shows the number of clients <math id="S5.F10.4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.F10.4.1.m1.1b"><mi id="S5.F10.4.1.m1.1.1" xref="S5.F10.4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.F10.4.1.m1.1c"><ci id="S5.F10.4.1.m1.1.1.cmml" xref="S5.F10.4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.4.1.m1.1d">K</annotation></semantics></math> and the number of local training epochs <math id="S5.F10.5.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.F10.5.2.m2.1b"><mi id="S5.F10.5.2.m2.1.1" xref="S5.F10.5.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.F10.5.2.m2.1c"><ci id="S5.F10.5.2.m2.1.1.cmml" xref="S5.F10.5.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.5.2.m2.1d">E</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S5.SS2.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.p5.10" class="ltx_p"><span id="S5.SS2.p5.10.1" class="ltx_text ltx_font_bold">Part IV</span> We then majorly compare with FedAvg and FedDF on various scenes. Specifically, we vary <math id="S5.SS2.p5.1.m1.2" class="ltx_Math" alttext="K\in\{100,1000\}" display="inline"><semantics id="S5.SS2.p5.1.m1.2a"><mrow id="S5.SS2.p5.1.m1.2.3" xref="S5.SS2.p5.1.m1.2.3.cmml"><mi id="S5.SS2.p5.1.m1.2.3.2" xref="S5.SS2.p5.1.m1.2.3.2.cmml">K</mi><mo id="S5.SS2.p5.1.m1.2.3.1" xref="S5.SS2.p5.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS2.p5.1.m1.2.3.3.2" xref="S5.SS2.p5.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.p5.1.m1.2.3.3.2.1" xref="S5.SS2.p5.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS2.p5.1.m1.1.1" xref="S5.SS2.p5.1.m1.1.1.cmml">100</mn><mo id="S5.SS2.p5.1.m1.2.3.3.2.2" xref="S5.SS2.p5.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p5.1.m1.2.2" xref="S5.SS2.p5.1.m1.2.2.cmml">1000</mn><mo stretchy="false" id="S5.SS2.p5.1.m1.2.3.3.2.3" xref="S5.SS2.p5.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.2b"><apply id="S5.SS2.p5.1.m1.2.3.cmml" xref="S5.SS2.p5.1.m1.2.3"><in id="S5.SS2.p5.1.m1.2.3.1.cmml" xref="S5.SS2.p5.1.m1.2.3.1"></in><ci id="S5.SS2.p5.1.m1.2.3.2.cmml" xref="S5.SS2.p5.1.m1.2.3.2">𝐾</ci><set id="S5.SS2.p5.1.m1.2.3.3.1.cmml" xref="S5.SS2.p5.1.m1.2.3.3.2"><cn type="integer" id="S5.SS2.p5.1.m1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1">100</cn><cn type="integer" id="S5.SS2.p5.1.m1.2.2.cmml" xref="S5.SS2.p5.1.m1.2.2">1000</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.2c">K\in\{100,1000\}</annotation></semantics></math> to investigate large amounts of clients. For <math id="S5.SS2.p5.2.m2.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS2.p5.2.m2.1a"><mrow id="S5.SS2.p5.2.m2.1.1" xref="S5.SS2.p5.2.m2.1.1.cmml"><mi id="S5.SS2.p5.2.m2.1.1.2" xref="S5.SS2.p5.2.m2.1.1.2.cmml">K</mi><mo id="S5.SS2.p5.2.m2.1.1.1" xref="S5.SS2.p5.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p5.2.m2.1.1.3" xref="S5.SS2.p5.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.2.m2.1b"><apply id="S5.SS2.p5.2.m2.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1"><eq id="S5.SS2.p5.2.m2.1.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1.1"></eq><ci id="S5.SS2.p5.2.m2.1.1.2.cmml" xref="S5.SS2.p5.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p5.2.m2.1.1.3.cmml" xref="S5.SS2.p5.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.2.m2.1c">K=100</annotation></semantics></math>, we take <math id="S5.SS2.p5.3.m3.1" class="ltx_Math" alttext="R=10\%" display="inline"><semantics id="S5.SS2.p5.3.m3.1a"><mrow id="S5.SS2.p5.3.m3.1.1" xref="S5.SS2.p5.3.m3.1.1.cmml"><mi id="S5.SS2.p5.3.m3.1.1.2" xref="S5.SS2.p5.3.m3.1.1.2.cmml">R</mi><mo id="S5.SS2.p5.3.m3.1.1.1" xref="S5.SS2.p5.3.m3.1.1.1.cmml">=</mo><mrow id="S5.SS2.p5.3.m3.1.1.3" xref="S5.SS2.p5.3.m3.1.1.3.cmml"><mn id="S5.SS2.p5.3.m3.1.1.3.2" xref="S5.SS2.p5.3.m3.1.1.3.2.cmml">10</mn><mo id="S5.SS2.p5.3.m3.1.1.3.1" xref="S5.SS2.p5.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.3.m3.1b"><apply id="S5.SS2.p5.3.m3.1.1.cmml" xref="S5.SS2.p5.3.m3.1.1"><eq id="S5.SS2.p5.3.m3.1.1.1.cmml" xref="S5.SS2.p5.3.m3.1.1.1"></eq><ci id="S5.SS2.p5.3.m3.1.1.2.cmml" xref="S5.SS2.p5.3.m3.1.1.2">𝑅</ci><apply id="S5.SS2.p5.3.m3.1.1.3.cmml" xref="S5.SS2.p5.3.m3.1.1.3"><csymbol cd="latexml" id="S5.SS2.p5.3.m3.1.1.3.1.cmml" xref="S5.SS2.p5.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S5.SS2.p5.3.m3.1.1.3.2.cmml" xref="S5.SS2.p5.3.m3.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.3.m3.1c">R=10\%</annotation></semantics></math> to select only 10 clients in each round and each client updates <math id="S5.SS2.p5.4.m4.3" class="ltx_Math" alttext="E\in\{2,10,50\}" display="inline"><semantics id="S5.SS2.p5.4.m4.3a"><mrow id="S5.SS2.p5.4.m4.3.4" xref="S5.SS2.p5.4.m4.3.4.cmml"><mi id="S5.SS2.p5.4.m4.3.4.2" xref="S5.SS2.p5.4.m4.3.4.2.cmml">E</mi><mo id="S5.SS2.p5.4.m4.3.4.1" xref="S5.SS2.p5.4.m4.3.4.1.cmml">∈</mo><mrow id="S5.SS2.p5.4.m4.3.4.3.2" xref="S5.SS2.p5.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.p5.4.m4.3.4.3.2.1" xref="S5.SS2.p5.4.m4.3.4.3.1.cmml">{</mo><mn id="S5.SS2.p5.4.m4.1.1" xref="S5.SS2.p5.4.m4.1.1.cmml">2</mn><mo id="S5.SS2.p5.4.m4.3.4.3.2.2" xref="S5.SS2.p5.4.m4.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p5.4.m4.2.2" xref="S5.SS2.p5.4.m4.2.2.cmml">10</mn><mo id="S5.SS2.p5.4.m4.3.4.3.2.3" xref="S5.SS2.p5.4.m4.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p5.4.m4.3.3" xref="S5.SS2.p5.4.m4.3.3.cmml">50</mn><mo stretchy="false" id="S5.SS2.p5.4.m4.3.4.3.2.4" xref="S5.SS2.p5.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.4.m4.3b"><apply id="S5.SS2.p5.4.m4.3.4.cmml" xref="S5.SS2.p5.4.m4.3.4"><in id="S5.SS2.p5.4.m4.3.4.1.cmml" xref="S5.SS2.p5.4.m4.3.4.1"></in><ci id="S5.SS2.p5.4.m4.3.4.2.cmml" xref="S5.SS2.p5.4.m4.3.4.2">𝐸</ci><set id="S5.SS2.p5.4.m4.3.4.3.1.cmml" xref="S5.SS2.p5.4.m4.3.4.3.2"><cn type="integer" id="S5.SS2.p5.4.m4.1.1.cmml" xref="S5.SS2.p5.4.m4.1.1">2</cn><cn type="integer" id="S5.SS2.p5.4.m4.2.2.cmml" xref="S5.SS2.p5.4.m4.2.2">10</cn><cn type="integer" id="S5.SS2.p5.4.m4.3.3.cmml" xref="S5.SS2.p5.4.m4.3.3">50</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.4.m4.3c">E\in\{2,10,50\}</annotation></semantics></math> local epochs; for <math id="S5.SS2.p5.5.m5.1" class="ltx_Math" alttext="K=1000" display="inline"><semantics id="S5.SS2.p5.5.m5.1a"><mrow id="S5.SS2.p5.5.m5.1.1" xref="S5.SS2.p5.5.m5.1.1.cmml"><mi id="S5.SS2.p5.5.m5.1.1.2" xref="S5.SS2.p5.5.m5.1.1.2.cmml">K</mi><mo id="S5.SS2.p5.5.m5.1.1.1" xref="S5.SS2.p5.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.p5.5.m5.1.1.3" xref="S5.SS2.p5.5.m5.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.5.m5.1b"><apply id="S5.SS2.p5.5.m5.1.1.cmml" xref="S5.SS2.p5.5.m5.1.1"><eq id="S5.SS2.p5.5.m5.1.1.1.cmml" xref="S5.SS2.p5.5.m5.1.1.1"></eq><ci id="S5.SS2.p5.5.m5.1.1.2.cmml" xref="S5.SS2.p5.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p5.5.m5.1.1.3.cmml" xref="S5.SS2.p5.5.m5.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.5.m5.1c">K=1000</annotation></semantics></math>, we use <math id="S5.SS2.p5.6.m6.1" class="ltx_Math" alttext="R=1\%" display="inline"><semantics id="S5.SS2.p5.6.m6.1a"><mrow id="S5.SS2.p5.6.m6.1.1" xref="S5.SS2.p5.6.m6.1.1.cmml"><mi id="S5.SS2.p5.6.m6.1.1.2" xref="S5.SS2.p5.6.m6.1.1.2.cmml">R</mi><mo id="S5.SS2.p5.6.m6.1.1.1" xref="S5.SS2.p5.6.m6.1.1.1.cmml">=</mo><mrow id="S5.SS2.p5.6.m6.1.1.3" xref="S5.SS2.p5.6.m6.1.1.3.cmml"><mn id="S5.SS2.p5.6.m6.1.1.3.2" xref="S5.SS2.p5.6.m6.1.1.3.2.cmml">1</mn><mo id="S5.SS2.p5.6.m6.1.1.3.1" xref="S5.SS2.p5.6.m6.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.6.m6.1b"><apply id="S5.SS2.p5.6.m6.1.1.cmml" xref="S5.SS2.p5.6.m6.1.1"><eq id="S5.SS2.p5.6.m6.1.1.1.cmml" xref="S5.SS2.p5.6.m6.1.1.1"></eq><ci id="S5.SS2.p5.6.m6.1.1.2.cmml" xref="S5.SS2.p5.6.m6.1.1.2">𝑅</ci><apply id="S5.SS2.p5.6.m6.1.1.3.cmml" xref="S5.SS2.p5.6.m6.1.1.3"><csymbol cd="latexml" id="S5.SS2.p5.6.m6.1.1.3.1.cmml" xref="S5.SS2.p5.6.m6.1.1.3.1">percent</csymbol><cn type="integer" id="S5.SS2.p5.6.m6.1.1.3.2.cmml" xref="S5.SS2.p5.6.m6.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.6.m6.1c">R=1\%</annotation></semantics></math> and <math id="S5.SS2.p5.7.m7.3" class="ltx_Math" alttext="E\in\{5,50,100\}" display="inline"><semantics id="S5.SS2.p5.7.m7.3a"><mrow id="S5.SS2.p5.7.m7.3.4" xref="S5.SS2.p5.7.m7.3.4.cmml"><mi id="S5.SS2.p5.7.m7.3.4.2" xref="S5.SS2.p5.7.m7.3.4.2.cmml">E</mi><mo id="S5.SS2.p5.7.m7.3.4.1" xref="S5.SS2.p5.7.m7.3.4.1.cmml">∈</mo><mrow id="S5.SS2.p5.7.m7.3.4.3.2" xref="S5.SS2.p5.7.m7.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.p5.7.m7.3.4.3.2.1" xref="S5.SS2.p5.7.m7.3.4.3.1.cmml">{</mo><mn id="S5.SS2.p5.7.m7.1.1" xref="S5.SS2.p5.7.m7.1.1.cmml">5</mn><mo id="S5.SS2.p5.7.m7.3.4.3.2.2" xref="S5.SS2.p5.7.m7.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p5.7.m7.2.2" xref="S5.SS2.p5.7.m7.2.2.cmml">50</mn><mo id="S5.SS2.p5.7.m7.3.4.3.2.3" xref="S5.SS2.p5.7.m7.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p5.7.m7.3.3" xref="S5.SS2.p5.7.m7.3.3.cmml">100</mn><mo stretchy="false" id="S5.SS2.p5.7.m7.3.4.3.2.4" xref="S5.SS2.p5.7.m7.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.7.m7.3b"><apply id="S5.SS2.p5.7.m7.3.4.cmml" xref="S5.SS2.p5.7.m7.3.4"><in id="S5.SS2.p5.7.m7.3.4.1.cmml" xref="S5.SS2.p5.7.m7.3.4.1"></in><ci id="S5.SS2.p5.7.m7.3.4.2.cmml" xref="S5.SS2.p5.7.m7.3.4.2">𝐸</ci><set id="S5.SS2.p5.7.m7.3.4.3.1.cmml" xref="S5.SS2.p5.7.m7.3.4.3.2"><cn type="integer" id="S5.SS2.p5.7.m7.1.1.cmml" xref="S5.SS2.p5.7.m7.1.1">5</cn><cn type="integer" id="S5.SS2.p5.7.m7.2.2.cmml" xref="S5.SS2.p5.7.m7.2.2">50</cn><cn type="integer" id="S5.SS2.p5.7.m7.3.3.cmml" xref="S5.SS2.p5.7.m7.3.3">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.7.m7.3c">E\in\{5,50,100\}</annotation></semantics></math>. We experiment on SVHN and CIFAR10 under two split strategies, i.e., “split by label" with <math id="S5.SS2.p5.8.m8.1" class="ltx_Math" alttext="\overline{C}=5" display="inline"><semantics id="S5.SS2.p5.8.m8.1a"><mrow id="S5.SS2.p5.8.m8.1.1" xref="S5.SS2.p5.8.m8.1.1.cmml"><mover accent="true" id="S5.SS2.p5.8.m8.1.1.2" xref="S5.SS2.p5.8.m8.1.1.2.cmml"><mi id="S5.SS2.p5.8.m8.1.1.2.2" xref="S5.SS2.p5.8.m8.1.1.2.2.cmml">C</mi><mo id="S5.SS2.p5.8.m8.1.1.2.1" xref="S5.SS2.p5.8.m8.1.1.2.1.cmml">¯</mo></mover><mo id="S5.SS2.p5.8.m8.1.1.1" xref="S5.SS2.p5.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS2.p5.8.m8.1.1.3" xref="S5.SS2.p5.8.m8.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.8.m8.1b"><apply id="S5.SS2.p5.8.m8.1.1.cmml" xref="S5.SS2.p5.8.m8.1.1"><eq id="S5.SS2.p5.8.m8.1.1.1.cmml" xref="S5.SS2.p5.8.m8.1.1.1"></eq><apply id="S5.SS2.p5.8.m8.1.1.2.cmml" xref="S5.SS2.p5.8.m8.1.1.2"><ci id="S5.SS2.p5.8.m8.1.1.2.1.cmml" xref="S5.SS2.p5.8.m8.1.1.2.1">¯</ci><ci id="S5.SS2.p5.8.m8.1.1.2.2.cmml" xref="S5.SS2.p5.8.m8.1.1.2.2">𝐶</ci></apply><cn type="integer" id="S5.SS2.p5.8.m8.1.1.3.cmml" xref="S5.SS2.p5.8.m8.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.8.m8.1c">\overline{C}=5</annotation></semantics></math> and “split by dirichlet" with <math id="S5.SS2.p5.9.m9.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS2.p5.9.m9.1a"><mrow id="S5.SS2.p5.9.m9.1.1" xref="S5.SS2.p5.9.m9.1.1.cmml"><mi id="S5.SS2.p5.9.m9.1.1.2" xref="S5.SS2.p5.9.m9.1.1.2.cmml">α</mi><mo id="S5.SS2.p5.9.m9.1.1.1" xref="S5.SS2.p5.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS2.p5.9.m9.1.1.3" xref="S5.SS2.p5.9.m9.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.9.m9.1b"><apply id="S5.SS2.p5.9.m9.1.1.cmml" xref="S5.SS2.p5.9.m9.1.1"><eq id="S5.SS2.p5.9.m9.1.1.1.cmml" xref="S5.SS2.p5.9.m9.1.1.1"></eq><ci id="S5.SS2.p5.9.m9.1.1.2.cmml" xref="S5.SS2.p5.9.m9.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.p5.9.m9.1.1.3.cmml" xref="S5.SS2.p5.9.m9.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.9.m9.1c">\alpha=1.0</annotation></semantics></math>. The results are plotted in Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. MrTF can basically surpass FedAvg and FedDF on all scenes. Additionally, MrTF behaves more stably even with larger number of clients (e.g., <math id="S5.SS2.p5.10.m10.1" class="ltx_Math" alttext="K=1000" display="inline"><semantics id="S5.SS2.p5.10.m10.1a"><mrow id="S5.SS2.p5.10.m10.1.1" xref="S5.SS2.p5.10.m10.1.1.cmml"><mi id="S5.SS2.p5.10.m10.1.1.2" xref="S5.SS2.p5.10.m10.1.1.2.cmml">K</mi><mo id="S5.SS2.p5.10.m10.1.1.1" xref="S5.SS2.p5.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS2.p5.10.m10.1.1.3" xref="S5.SS2.p5.10.m10.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.10.m10.1b"><apply id="S5.SS2.p5.10.m10.1.1.cmml" xref="S5.SS2.p5.10.m10.1.1"><eq id="S5.SS2.p5.10.m10.1.1.1.cmml" xref="S5.SS2.p5.10.m10.1.1.1"></eq><ci id="S5.SS2.p5.10.m10.1.1.2.cmml" xref="S5.SS2.p5.10.m10.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p5.10.m10.1.1.3.cmml" xref="S5.SS2.p5.10.m10.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.10.m10.1c">K=1000</annotation></semantics></math>), contributed to the stabilized teachers and rectified distillation.</p>
</div>
<figure id="S5.F11" class="ltx_figure">
<div id="S5.F11.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2305.04201/assets/x15.png" id="S5.F11.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="105" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span id="S5.F11.9.4" class="ltx_text" style="font-size:90%;">Ablation studies of the modules in MrTF. Each row shows a data set. Each column shows the split strategy (<math id="S5.F11.6.1.m1.2" class="ltx_Math" alttext="\overline{C}\in[5,3]" display="inline"><semantics id="S5.F11.6.1.m1.2b"><mrow id="S5.F11.6.1.m1.2.3" xref="S5.F11.6.1.m1.2.3.cmml"><mover accent="true" id="S5.F11.6.1.m1.2.3.2" xref="S5.F11.6.1.m1.2.3.2.cmml"><mi id="S5.F11.6.1.m1.2.3.2.2" xref="S5.F11.6.1.m1.2.3.2.2.cmml">C</mi><mo id="S5.F11.6.1.m1.2.3.2.1" xref="S5.F11.6.1.m1.2.3.2.1.cmml">¯</mo></mover><mo id="S5.F11.6.1.m1.2.3.1" xref="S5.F11.6.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.F11.6.1.m1.2.3.3.2" xref="S5.F11.6.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.F11.6.1.m1.2.3.3.2.1" xref="S5.F11.6.1.m1.2.3.3.1.cmml">[</mo><mn id="S5.F11.6.1.m1.1.1" xref="S5.F11.6.1.m1.1.1.cmml">5</mn><mo id="S5.F11.6.1.m1.2.3.3.2.2" xref="S5.F11.6.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.F11.6.1.m1.2.2" xref="S5.F11.6.1.m1.2.2.cmml">3</mn><mo stretchy="false" id="S5.F11.6.1.m1.2.3.3.2.3" xref="S5.F11.6.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F11.6.1.m1.2c"><apply id="S5.F11.6.1.m1.2.3.cmml" xref="S5.F11.6.1.m1.2.3"><in id="S5.F11.6.1.m1.2.3.1.cmml" xref="S5.F11.6.1.m1.2.3.1"></in><apply id="S5.F11.6.1.m1.2.3.2.cmml" xref="S5.F11.6.1.m1.2.3.2"><ci id="S5.F11.6.1.m1.2.3.2.1.cmml" xref="S5.F11.6.1.m1.2.3.2.1">¯</ci><ci id="S5.F11.6.1.m1.2.3.2.2.cmml" xref="S5.F11.6.1.m1.2.3.2.2">𝐶</ci></apply><interval closure="closed" id="S5.F11.6.1.m1.2.3.3.1.cmml" xref="S5.F11.6.1.m1.2.3.3.2"><cn type="integer" id="S5.F11.6.1.m1.1.1.cmml" xref="S5.F11.6.1.m1.1.1">5</cn><cn type="integer" id="S5.F11.6.1.m1.2.2.cmml" xref="S5.F11.6.1.m1.2.2">3</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.6.1.m1.2d">\overline{C}\in[5,3]</annotation></semantics></math>, <math id="S5.F11.7.2.m2.2" class="ltx_Math" alttext="\alpha\in[1.0,0.1]" display="inline"><semantics id="S5.F11.7.2.m2.2b"><mrow id="S5.F11.7.2.m2.2.3" xref="S5.F11.7.2.m2.2.3.cmml"><mi id="S5.F11.7.2.m2.2.3.2" xref="S5.F11.7.2.m2.2.3.2.cmml">α</mi><mo id="S5.F11.7.2.m2.2.3.1" xref="S5.F11.7.2.m2.2.3.1.cmml">∈</mo><mrow id="S5.F11.7.2.m2.2.3.3.2" xref="S5.F11.7.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.F11.7.2.m2.2.3.3.2.1" xref="S5.F11.7.2.m2.2.3.3.1.cmml">[</mo><mn id="S5.F11.7.2.m2.1.1" xref="S5.F11.7.2.m2.1.1.cmml">1.0</mn><mo id="S5.F11.7.2.m2.2.3.3.2.2" xref="S5.F11.7.2.m2.2.3.3.1.cmml">,</mo><mn id="S5.F11.7.2.m2.2.2" xref="S5.F11.7.2.m2.2.2.cmml">0.1</mn><mo stretchy="false" id="S5.F11.7.2.m2.2.3.3.2.3" xref="S5.F11.7.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F11.7.2.m2.2c"><apply id="S5.F11.7.2.m2.2.3.cmml" xref="S5.F11.7.2.m2.2.3"><in id="S5.F11.7.2.m2.2.3.1.cmml" xref="S5.F11.7.2.m2.2.3.1"></in><ci id="S5.F11.7.2.m2.2.3.2.cmml" xref="S5.F11.7.2.m2.2.3.2">𝛼</ci><interval closure="closed" id="S5.F11.7.2.m2.2.3.3.1.cmml" xref="S5.F11.7.2.m2.2.3.3.2"><cn type="float" id="S5.F11.7.2.m2.1.1.cmml" xref="S5.F11.7.2.m2.1.1">1.0</cn><cn type="float" id="S5.F11.7.2.m2.2.2.cmml" xref="S5.F11.7.2.m2.2.2">0.1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.7.2.m2.2d">\alpha\in[1.0,0.1]</annotation></semantics></math>) and corresponding <math id="S5.F11.8.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.F11.8.3.m3.1b"><mi id="S5.F11.8.3.m3.1.1" xref="S5.F11.8.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.F11.8.3.m3.1c"><ci id="S5.F11.8.3.m3.1.1.cmml" xref="S5.F11.8.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.8.3.m3.1d">K</annotation></semantics></math>, <math id="S5.F11.9.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.F11.9.4.m4.1b"><mi id="S5.F11.9.4.m4.1.1" xref="S5.F11.9.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.F11.9.4.m4.1c"><ci id="S5.F11.9.4.m4.1.1.cmml" xref="S5.F11.9.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.9.4.m4.1d">E</annotation></semantics></math>. The five bars refer to test accuracy of: (1) PA (parameter averaging in FedAvg); (2) AL (“AvgLogi" in FedDF); (3) ST (Stabilized Teachers, Sect. <a href="#S4.SS1" title="4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>); (4) ST + RD (Rectified Distillation, Sect. <a href="#S4.SS2" title="4.2 Rectified Distillation ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>); (5) ST + RD + CLR (Clustered Label Refinery, Sect. <a href="#S4.SS3" title="4.3 Clustered Label Refinery ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>) (MrTF).</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Studies</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">Our proposed MrTF contains three modules: (1) we use “AvgProb" in Eq. <a href="#S4.E7" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> instead of “AvgLogi" to obtain stabilized teachers; (2) we fuse aggregated models into local models and apply two-level weights for rectified distillation; (3) we additionally take clustering techniques to refine the distillation targets. We incrementally add these modules for ablation studies. We denote these three components as “ST", “RD", and “CLR". Correspondingly, we compare performances of: (1) simple parameter averaging without any refinery (i.e., FedAvg); (2) averaging logits (i.e., “AvgLogi" in FedDF); (3) ST; (4) ST + RD; (5) ST + RD + CLR (i.e., proposed MrTF). We compare them on SVHN and CIFAR10 under various FL scenes, and the results could be found in Fig. <a href="#S5.F11" title="Figure 11 ‣ 5.2 Performance Comparisons ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>. For each scene, we run 50 communication rounds. “AvgLogi" is not stable and sometimes surpasses parameter averaging while sometimes does not. Only using the “AvgProb" in Eq. <a href="#S4.E7" title="In 4.1 Stabilized Teachers ‣ 4 Proposed Methods ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> (i.e., ST) could already yield notable performances, while fusing RD and CLR could lead to higher results.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>More Studies: Cross-Domain TFL</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.2" class="ltx_p">In some cases, although a party could collaborate with other parties to help infer the handy unlabeled data via the proposed TFL framework, the distribution of the unlabeled data may also be heterogeneous from others. We call this case cross-domain TFL, which is similar to the scene studied in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib52" title="" class="ltx_ref">FADA </a>; <a href="#bib.bib53" title="" class="ltx_ref">KD3A </a></cite>. These works only consider several heterogeneous domains (e.g., 5), which are more similar to domain adaptation under privacy protection <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib24" title="" class="ltx_ref">DAN </a>; <a href="#bib.bib45" title="" class="ltx_ref">SHOT </a></cite>. That is, they do not consider some other challenges in our work, i.e., stochastic client participation, low-shot training samples, class imbalance, etc. In cross-domain TFL, we have to simultaneously tackle these challenges aside from Non-I.I.D. data and cross-domain knowledge transfer. We preliminarily apply MrTF to this scene. Specifically, we split SVHN (MNISTm) data across <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">K</mi><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><eq id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></eq><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">K=100</annotation></semantics></math> clients with <math id="S5.SS4.p1.2.m2.2" class="ltx_Math" alttext="\alpha\in\{1.0,0.1\}" display="inline"><semantics id="S5.SS4.p1.2.m2.2a"><mrow id="S5.SS4.p1.2.m2.2.3" xref="S5.SS4.p1.2.m2.2.3.cmml"><mi id="S5.SS4.p1.2.m2.2.3.2" xref="S5.SS4.p1.2.m2.2.3.2.cmml">α</mi><mo id="S5.SS4.p1.2.m2.2.3.1" xref="S5.SS4.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="S5.SS4.p1.2.m2.2.3.3.2" xref="S5.SS4.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS4.p1.2.m2.2.3.3.2.1" xref="S5.SS4.p1.2.m2.2.3.3.1.cmml">{</mo><mn id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">1.0</mn><mo id="S5.SS4.p1.2.m2.2.3.3.2.2" xref="S5.SS4.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S5.SS4.p1.2.m2.2.2" xref="S5.SS4.p1.2.m2.2.2.cmml">0.1</mn><mo stretchy="false" id="S5.SS4.p1.2.m2.2.3.3.2.3" xref="S5.SS4.p1.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.2b"><apply id="S5.SS4.p1.2.m2.2.3.cmml" xref="S5.SS4.p1.2.m2.2.3"><in id="S5.SS4.p1.2.m2.2.3.1.cmml" xref="S5.SS4.p1.2.m2.2.3.1"></in><ci id="S5.SS4.p1.2.m2.2.3.2.cmml" xref="S5.SS4.p1.2.m2.2.3.2">𝛼</ci><set id="S5.SS4.p1.2.m2.2.3.3.1.cmml" xref="S5.SS4.p1.2.m2.2.3.3.2"><cn type="float" id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">1.0</cn><cn type="float" id="S5.SS4.p1.2.m2.2.2.cmml" xref="S5.SS4.p1.2.m2.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.2c">\alpha\in\{1.0,0.1\}</annotation></semantics></math>. The server aims to make predictions for MNISTm (SVHN). In each round, we select 10 clients and each client takes on 5 epochs. We run 200 communication rounds and report the final accuracies averaged by 5 independent experiments. We compare with FedAvg and FedDF. Results are listed in Tab <a href="#S5.T2" title="Table 2 ‣ 5.4 More Studies: Cross-Domain TFL ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. MrTF could still surpass FedAvg and FedDF by a significant margin even in cross-domain TFL. However, the overall cross-domain transfer performance is still lower compared with in-domain learning, which means that more advanced domain adaptaion <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib24" title="" class="ltx_ref">DAN </a></cite> techniques should be considered for cross-domain TFL.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S5.T2.8.1" class="ltx_text" style="font-size:90%;">Performance comparisons in cross-domain TFL.</span></figcaption>
<table id="S5.T2.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.2.2" class="ltx_tr">
<th id="S5.T2.2.2.3" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">SVHN<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo stretchy="false" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\rightarrow</annotation></semantics></math>MNISTm</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">MNISTm<math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo stretchy="false" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\rightarrow</annotation></semantics></math>SVHN</td>
</tr>
<tr id="S5.T2.6.6" class="ltx_tr">
<th id="S5.T2.6.6.5" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S5.T2.3.3.1" class="ltx_td ltx_align_center ltx_border_r">
<math id="S5.T2.3.3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.3.3.1.m1.1a"><mi id="S5.T2.3.3.1.m1.1.1" xref="S5.T2.3.3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.1.m1.1b"><ci id="S5.T2.3.3.1.m1.1.1.cmml" xref="S5.T2.3.3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.1.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S5.T2.4.4.2" class="ltx_td ltx_align_center ltx_border_r">
<math id="S5.T2.4.4.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.4.4.2.m1.1a"><mi id="S5.T2.4.4.2.m1.1.1" xref="S5.T2.4.4.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.2.m1.1b"><ci id="S5.T2.4.4.2.m1.1.1.cmml" xref="S5.T2.4.4.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.2.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
<td id="S5.T2.5.5.3" class="ltx_td ltx_align_center ltx_border_r">
<math id="S5.T2.5.5.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.5.5.3.m1.1a"><mi id="S5.T2.5.5.3.m1.1.1" xref="S5.T2.5.5.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.3.m1.1b"><ci id="S5.T2.5.5.3.m1.1.1.cmml" xref="S5.T2.5.5.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.3.m1.1c">\alpha</annotation></semantics></math>=1.0</td>
<td id="S5.T2.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center">
<math id="S5.T2.6.6.4.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.6.6.4.m1.1a"><mi id="S5.T2.6.6.4.m1.1.1" xref="S5.T2.6.6.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.4.m1.1b"><ci id="S5.T2.6.6.4.m1.1.1.cmml" xref="S5.T2.6.6.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.4.m1.1c">\alpha</annotation></semantics></math>=0.1</td>
</tr>
<tr id="S5.T2.6.7.1" class="ltx_tr">
<th id="S5.T2.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>
</th>
<td id="S5.T2.6.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">40.26</td>
<td id="S5.T2.6.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.52</td>
<td id="S5.T2.6.7.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">32.09</td>
<td id="S5.T2.6.7.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">31.06</td>
</tr>
<tr id="S5.T2.6.8.2" class="ltx_tr">
<th id="S5.T2.6.8.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedDF <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">FedDF </a></cite>
</th>
<td id="S5.T2.6.8.2.2" class="ltx_td ltx_align_center ltx_border_r">41.90</td>
<td id="S5.T2.6.8.2.3" class="ltx_td ltx_align_center ltx_border_r">35.91</td>
<td id="S5.T2.6.8.2.4" class="ltx_td ltx_align_center ltx_border_r">33.06</td>
<td id="S5.T2.6.8.2.5" class="ltx_td ltx_nopad_r ltx_align_center">28.84</td>
</tr>
<tr id="S5.T2.6.9.3" class="ltx_tr">
<th id="S5.T2.6.9.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MrTF (Ours)</th>
<td id="S5.T2.6.9.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.6.9.3.2.1" class="ltx_text ltx_font_bold">44.78</span></td>
<td id="S5.T2.6.9.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.6.9.3.3.1" class="ltx_text ltx_font_bold">41.70</span></td>
<td id="S5.T2.6.9.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.6.9.3.4.1" class="ltx_text ltx_font_bold">35.32</span></td>
<td id="S5.T2.6.9.3.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.6.9.3.5.1" class="ltx_text ltx_font_bold">34.55</span></td>
</tr>
<tr id="S5.T2.6.10.4" class="ltx_tr">
<th id="S5.T2.6.10.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S5.T2.6.10.4.1.1" class="ltx_ERROR undefined">\botrule</span></th>
<td id="S5.T2.6.10.4.2" class="ltx_td"></td>
<td id="S5.T2.6.10.4.3" class="ltx_td"></td>
<td id="S5.T2.6.10.4.4" class="ltx_td"></td>
<td id="S5.T2.6.10.4.5" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>More Studies: Privacy Protection</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.4" class="ltx_p">FedAvg could only provide basic privacy protection for users, while some advanced attacks could still break privacy via inverting local gradients <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib54" title="" class="ltx_ref">DLG </a>; <a href="#bib.bib55" title="" class="ltx_ref">InvGradFL </a></cite>. Hence, techniques such as differential privacy <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib16" title="" class="ltx_ref">DeepDP </a></cite> should be considered for stricter privacy protections. To guarantee <math id="S5.SS5.p1.1.m1.2" class="ltx_Math" alttext="(\epsilon,\delta)" display="inline"><semantics id="S5.SS5.p1.1.m1.2a"><mrow id="S5.SS5.p1.1.m1.2.3.2" xref="S5.SS5.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S5.SS5.p1.1.m1.2.3.2.1" xref="S5.SS5.p1.1.m1.2.3.1.cmml">(</mo><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">ϵ</mi><mo id="S5.SS5.p1.1.m1.2.3.2.2" xref="S5.SS5.p1.1.m1.2.3.1.cmml">,</mo><mi id="S5.SS5.p1.1.m1.2.2" xref="S5.SS5.p1.1.m1.2.2.cmml">δ</mi><mo stretchy="false" id="S5.SS5.p1.1.m1.2.3.2.3" xref="S5.SS5.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.2b"><interval closure="open" id="S5.SS5.p1.1.m1.2.3.1.cmml" xref="S5.SS5.p1.1.m1.2.3.2"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">italic-ϵ</ci><ci id="S5.SS5.p1.1.m1.2.2.cmml" xref="S5.SS5.p1.1.m1.2.2">𝛿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.2c">(\epsilon,\delta)</annotation></semantics></math>-DP in FL, gradient clipping is applied to local model updates, and gaussian noises <math id="S5.SS5.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{N}(0,\sigma^{2})" display="inline"><semantics id="S5.SS5.p1.2.m2.2a"><mrow id="S5.SS5.p1.2.m2.2.2" xref="S5.SS5.p1.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS5.p1.2.m2.2.2.3" xref="S5.SS5.p1.2.m2.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.2.m2.2.2.2" xref="S5.SS5.p1.2.m2.2.2.2.cmml">​</mo><mrow id="S5.SS5.p1.2.m2.2.2.1.1" xref="S5.SS5.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S5.SS5.p1.2.m2.2.2.1.1.2" xref="S5.SS5.p1.2.m2.2.2.1.2.cmml">(</mo><mn id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml">0</mn><mo id="S5.SS5.p1.2.m2.2.2.1.1.3" xref="S5.SS5.p1.2.m2.2.2.1.2.cmml">,</mo><msup id="S5.SS5.p1.2.m2.2.2.1.1.1" xref="S5.SS5.p1.2.m2.2.2.1.1.1.cmml"><mi id="S5.SS5.p1.2.m2.2.2.1.1.1.2" xref="S5.SS5.p1.2.m2.2.2.1.1.1.2.cmml">σ</mi><mn id="S5.SS5.p1.2.m2.2.2.1.1.1.3" xref="S5.SS5.p1.2.m2.2.2.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S5.SS5.p1.2.m2.2.2.1.1.4" xref="S5.SS5.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.2b"><apply id="S5.SS5.p1.2.m2.2.2.cmml" xref="S5.SS5.p1.2.m2.2.2"><times id="S5.SS5.p1.2.m2.2.2.2.cmml" xref="S5.SS5.p1.2.m2.2.2.2"></times><ci id="S5.SS5.p1.2.m2.2.2.3.cmml" xref="S5.SS5.p1.2.m2.2.2.3">𝒩</ci><interval closure="open" id="S5.SS5.p1.2.m2.2.2.1.2.cmml" xref="S5.SS5.p1.2.m2.2.2.1.1"><cn type="integer" id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1">0</cn><apply id="S5.SS5.p1.2.m2.2.2.1.1.1.cmml" xref="S5.SS5.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p1.2.m2.2.2.1.1.1.1.cmml" xref="S5.SS5.p1.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S5.SS5.p1.2.m2.2.2.1.1.1.2.cmml" xref="S5.SS5.p1.2.m2.2.2.1.1.1.2">𝜎</ci><cn type="integer" id="S5.SS5.p1.2.m2.2.2.1.1.1.3.cmml" xref="S5.SS5.p1.2.m2.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.2c">\mathcal{N}(0,\sigma^{2})</annotation></semantics></math> are added before being sent to the server. With added noise, the aggregated model will be more inaccurate. However, we expect our model refinery process could mitigate the performance degradation. We experiment on CIFAR10 with <math id="S5.SS5.p1.3.m3.2" class="ltx_Math" alttext="\alpha=1.0,K=100,E=5,T=200" display="inline"><semantics id="S5.SS5.p1.3.m3.2a"><mrow id="S5.SS5.p1.3.m3.2.2.2" xref="S5.SS5.p1.3.m3.2.2.3.cmml"><mrow id="S5.SS5.p1.3.m3.1.1.1.1" xref="S5.SS5.p1.3.m3.1.1.1.1.cmml"><mi id="S5.SS5.p1.3.m3.1.1.1.1.2" xref="S5.SS5.p1.3.m3.1.1.1.1.2.cmml">α</mi><mo id="S5.SS5.p1.3.m3.1.1.1.1.1" xref="S5.SS5.p1.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S5.SS5.p1.3.m3.1.1.1.1.3" xref="S5.SS5.p1.3.m3.1.1.1.1.3.cmml">1.0</mn></mrow><mo id="S5.SS5.p1.3.m3.2.2.2.3" xref="S5.SS5.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S5.SS5.p1.3.m3.2.2.2.2.2" xref="S5.SS5.p1.3.m3.2.2.2.2.3.cmml"><mrow id="S5.SS5.p1.3.m3.2.2.2.2.1.1" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.cmml"><mi id="S5.SS5.p1.3.m3.2.2.2.2.1.1.2" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.2.cmml">K</mi><mo id="S5.SS5.p1.3.m3.2.2.2.2.1.1.1" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS5.p1.3.m3.2.2.2.2.1.1.3" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.3.cmml">100</mn></mrow><mo id="S5.SS5.p1.3.m3.2.2.2.2.2.3" xref="S5.SS5.p1.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.3.cmml"><mrow id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.cmml"><mi id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.2" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.2.cmml">E</mi><mo id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.1" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.3" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.3.cmml">5</mn></mrow><mo id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.3" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.2" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.2.cmml">T</mi><mo id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.1" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.3" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.3.cmml">200</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.2b"><apply id="S5.SS5.p1.3.m3.2.2.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S5.SS5.p1.3.m3.2.2.3a.cmml" xref="S5.SS5.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS5.p1.3.m3.1.1.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1.1.1"><eq id="S5.SS5.p1.3.m3.1.1.1.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1.1.1.1"></eq><ci id="S5.SS5.p1.3.m3.1.1.1.1.2.cmml" xref="S5.SS5.p1.3.m3.1.1.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p1.3.m3.1.1.1.1.3.cmml" xref="S5.SS5.p1.3.m3.1.1.1.1.3">1.0</cn></apply><apply id="S5.SS5.p1.3.m3.2.2.2.2.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS5.p1.3.m3.2.2.2.2.3a.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS5.p1.3.m3.2.2.2.2.1.1.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1"><eq id="S5.SS5.p1.3.m3.2.2.2.2.1.1.1.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.1"></eq><ci id="S5.SS5.p1.3.m3.2.2.2.2.1.1.2.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.2">𝐾</ci><cn type="integer" id="S5.SS5.p1.3.m3.2.2.2.2.1.1.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.1.1.3">100</cn></apply><apply id="S5.SS5.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS5.p1.3.m3.2.2.2.2.2.2.3a.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1"><eq id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.1.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.1"></eq><ci id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.2.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.2">𝐸</ci><cn type="integer" id="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.1.1.3">5</cn></apply><apply id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2"><eq id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.1"></eq><ci id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.2">𝑇</ci><cn type="integer" id="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="S5.SS5.p1.3.m3.2.2.2.2.2.2.2.2.3">200</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.2c">\alpha=1.0,K=100,E=5,T=200</annotation></semantics></math>. We use VGG8 and add noise <math id="S5.SS5.p1.4.m4.4" class="ltx_Math" alttext="\sigma\in\{0.0,0.001,0.01,0.1\}" display="inline"><semantics id="S5.SS5.p1.4.m4.4a"><mrow id="S5.SS5.p1.4.m4.4.5" xref="S5.SS5.p1.4.m4.4.5.cmml"><mi id="S5.SS5.p1.4.m4.4.5.2" xref="S5.SS5.p1.4.m4.4.5.2.cmml">σ</mi><mo id="S5.SS5.p1.4.m4.4.5.1" xref="S5.SS5.p1.4.m4.4.5.1.cmml">∈</mo><mrow id="S5.SS5.p1.4.m4.4.5.3.2" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS5.p1.4.m4.4.5.3.2.1" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml">{</mo><mn id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml">0.0</mn><mo id="S5.SS5.p1.4.m4.4.5.3.2.2" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S5.SS5.p1.4.m4.2.2" xref="S5.SS5.p1.4.m4.2.2.cmml">0.001</mn><mo id="S5.SS5.p1.4.m4.4.5.3.2.3" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S5.SS5.p1.4.m4.3.3" xref="S5.SS5.p1.4.m4.3.3.cmml">0.01</mn><mo id="S5.SS5.p1.4.m4.4.5.3.2.4" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S5.SS5.p1.4.m4.4.4" xref="S5.SS5.p1.4.m4.4.4.cmml">0.1</mn><mo stretchy="false" id="S5.SS5.p1.4.m4.4.5.3.2.5" xref="S5.SS5.p1.4.m4.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.4b"><apply id="S5.SS5.p1.4.m4.4.5.cmml" xref="S5.SS5.p1.4.m4.4.5"><in id="S5.SS5.p1.4.m4.4.5.1.cmml" xref="S5.SS5.p1.4.m4.4.5.1"></in><ci id="S5.SS5.p1.4.m4.4.5.2.cmml" xref="S5.SS5.p1.4.m4.4.5.2">𝜎</ci><set id="S5.SS5.p1.4.m4.4.5.3.1.cmml" xref="S5.SS5.p1.4.m4.4.5.3.2"><cn type="float" id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1">0.0</cn><cn type="float" id="S5.SS5.p1.4.m4.2.2.cmml" xref="S5.SS5.p1.4.m4.2.2">0.001</cn><cn type="float" id="S5.SS5.p1.4.m4.3.3.cmml" xref="S5.SS5.p1.4.m4.3.3">0.01</cn><cn type="float" id="S5.SS5.p1.4.m4.4.4.cmml" xref="S5.SS5.p1.4.m4.4.4">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.4c">\sigma\in\{0.0,0.001,0.01,0.1\}</annotation></semantics></math>. We report the results of FedAvg and MrTF in Tab. <a href="#S5.T3" title="Table 3 ‣ 5.5 More Studies: Privacy Protection ‣ 5 Experiments ‣ MrTF: Model Refinery for Transductive Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. With higher noise, FedAvg’s performance degrades seriously while MrTF could maintain a better prediction.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S5.T3.6.1" class="ltx_text" style="font-size:90%;">Performances when adding differential privacy.</span></figcaption>
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.4.4" class="ltx_tr">
<th id="S5.T3.4.4.5" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\sigma</annotation></semantics></math>=0.0</td>
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><mi id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><ci id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">\sigma</annotation></semantics></math>=0.001</td>
<td id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<math id="S5.T3.3.3.3.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.T3.3.3.3.m1.1a"><mi id="S5.T3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.m1.1b"><ci id="S5.T3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.m1.1c">\sigma</annotation></semantics></math>=0.01</td>
<td id="S5.T3.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">
<math id="S5.T3.4.4.4.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.T3.4.4.4.m1.1a"><mi id="S5.T3.4.4.4.m1.1.1" xref="S5.T3.4.4.4.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.m1.1b"><ci id="S5.T3.4.4.4.m1.1.1.cmml" xref="S5.T3.4.4.4.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.m1.1c">\sigma</annotation></semantics></math>=0.1</td>
</tr>
<tr id="S5.T3.4.5.1" class="ltx_tr">
<th id="S5.T3.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">FedAvg </a></cite>
</th>
<td id="S5.T3.4.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79.46</td>
<td id="S5.T3.4.5.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.98</td>
<td id="S5.T3.4.5.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">69.08</td>
<td id="S5.T3.4.5.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">38.27</td>
</tr>
<tr id="S5.T3.4.6.2" class="ltx_tr">
<th id="S5.T3.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MrTF (Ours)</th>
<td id="S5.T3.4.6.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.4.6.2.2.1" class="ltx_text ltx_font_bold">82.31</span></td>
<td id="S5.T3.4.6.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.4.6.2.3.1" class="ltx_text ltx_font_bold">81.76</span></td>
<td id="S5.T3.4.6.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.4.6.2.4.1" class="ltx_text ltx_font_bold">76.54</span></td>
<td id="S5.T3.4.6.2.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.4.6.2.5.1" class="ltx_text ltx_font_bold">47.11</span></td>
</tr>
<tr id="S5.T3.4.7.3" class="ltx_tr">
<th id="S5.T3.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S5.T3.4.7.3.1.1" class="ltx_ERROR undefined">\botrule</span></th>
<td id="S5.T3.4.7.3.2" class="ltx_td"></td>
<td id="S5.T3.4.7.3.3" class="ltx_td"></td>
<td id="S5.T3.4.7.3.4" class="ltx_td"></td>
<td id="S5.T3.4.7.3.5" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Limitations and Future Work</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.1" class="ltx_p">Our proposed MrTF is a novel and practical solution to the introduced real-world scenario in that a newly-established pilot project needs to build a machine-learning model with the help of other isolated parties. However, MrTF does not consider the existing models of these parties and trains local models from scratch, making the convergence slower. Utilizing the available pre-trained models and accelerating the training process may be interesting for future work.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We consider transductive federated learning (TFL), where the server owns to-be-referred data while the training data are distributed across other parties. We in-depth analyze some existing FL works and point out their drawbacks. As an alternative, we propose MrTF with three modules, i.e., stabilized teachers, rectified distillation, and clustered label refinery, to refine the global aggregated model and make predictions in a transductive manner. Our proposed method shows superiorities towards compared methods on various investigated scenes.</p>
</div>
<div id="S6.p2" class="ltx_para">
<span id="S6.p2.1" class="ltx_ERROR undefined">\bmhead</span>
<p id="S6.p2.2" class="ltx_p">Acknowledgments
This work is partially supported by the National Natural Science Foundation of China (Grant No. 61921006, 62006118, 62276131), the National Key RD Program of China (Grant No. 2022YFF0712100) and the Fundamental Research Funds for the Central Universities (NO.NJ2022028, No.30922010317). Thanks to Huawei Noah’s Ark Lab NetMIND Research Team.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.1.1" class="ltx_bibitem">
<span class="ltx_bibblock"><span id="bib.1.1.1.1" class="ltx_ERROR undefined">\bibcommenthead</span>
</span>
</li>
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
He, K.,
Zhang, X.,
Ren, S.,
Sun, J.:
Deep residual learning for image recognition.
In: IEEE Conference on Computer Vision and Pattern Recognition,
pp. 770–778
(2016)


</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(2)</span>
<span class="ltx_bibblock">
Vaswani, A.,
Shazeer, N.,
Parmar, N.,
Uszkoreit, J.,
Jones, L.,
Gomez, A.N.,
Kaiser, L.,
Polosukhin, I.:
Attention is all you need.
In: Advances in Neural Information Processing Systems 30,
pp. 5998–6008
(2017)


</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
Li, X.,
Tang, J.,
Song, S.,
Li, B.,
Li, Y.,
Shao, Y.,
Gan, L.,
Zhan, D.:
Avoid overfitting user specific information in federated keyword
spotting.
In: Proceedings of the 23rd Annual Conference of the International
Speech Communication Association,
pp. 3869–3873
(2022)


</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
Yang, Y.,
Sun, Z.-Q.,
Zhu, H.,
Fu, Y.,
Zhou, Y.,
Xiong, H.,
Yang, J.:
Learning adaptive embedding considering incremental class.
IEEE Transactions on Knowledge and Data Engineering
(2021)


</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
Chen, Y.,
Wang, G.,
Dong, S.:
Learning with progressive transductive support vector machine.
In: Proceedings of the IEEE International Conference on Data
Mining,
pp. 67–74
(2002)


</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(6)</span>
<span class="ltx_bibblock">
Rohrbach, M.,
Ebert, S.,
Schiele, B.:
Transfer learning in a transductive setting.
In: Advances in Neural Information Processing Systems 26,
pp. 46–54
(2013)


</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(7)</span>
<span class="ltx_bibblock">
Liu, Y.,
Lee, J.,
Park, M.,
Kim, S.,
Yang, E.,
Hwang, S.J.,
Yang, Y.:
Learning to propagate labels: Transductive propagation network for
few-shot learning.
In: 7th International Conference on Learning Representations
(2019)


</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(8)</span>
<span class="ltx_bibblock">
Yang, Q.,
Liu, Y.,
Chen, T.,
Tong, Y.:
Federated machine learning: Concept and applications.
ACM Transactions on Intelligent Systems and Technology
<span id="bib.bib8.1.1" class="ltx_text ltx_font_bold">10</span>(2),
12–11219
(2019)


</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(9)</span>
<span class="ltx_bibblock">
McMahan, B.,
Moore, E.,
Ramage, D.,
Hampson, S.,
y Arcas, B.A.:
Communication-efficient learning of deep networks from decentralized
data.
In: Proceedings of the 20th International Conference on Artificial
Intelligence and Statistics,
pp. 1273–1282
(2017)


</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(10)</span>
<span class="ltx_bibblock">
Li, X.,
Xu, Y.,
Song, S.,
Li, B.,
Li, Y.,
Shao, Y.,
Zhan, D.:
Federated learning with position-aware neurons.
In: IEEE/CVF Conference on Computer Vision and Pattern Recognition,
pp. 10072–10081
(2022)


</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(11)</span>
<span class="ltx_bibblock">
Hsieh, K.,
Phanishayee, A.,
Mutlu, O.,
Gibbons, P.B.:
The non-iid data quagmire of decentralized machine learning.
In: Proceedings of the 37th International Conference on Machine
Learning,
pp. 4387–4398
(2020)


</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
Zhao, Y.,
Li, M.,
Lai, L.,
Suda, N.,
Civin, D.,
Chandra, V.:
Federated learning with non-iid data.
CoRR
<span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">abs/1806.00582</span>
(2018)


</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
Jeong, E.,
Oh, S.,
Kim, H.,
Park, J.,
Bennis, M.,
Kim, S.:
Communication-efficient on-device machine learning: Federated distillation and
augmentation under non-iid private data.
CoRR
<span id="bib.bib13.1.1" class="ltx_text ltx_font_bold">abs/1811.11479</span>
(2018)


</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(14)</span>
<span class="ltx_bibblock">
Lin, T.,
Kong, L.,
Stich, S.U.,
Jaggi, M.:
Ensemble distillation for robust model fusion in federated learning.
In: Advances in Neural Information Processing Systems 33
(2020)


</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(15)</span>
<span class="ltx_bibblock">
Li, M.,
Zhou, L.,
Yang, Z.,
Li, A.,
Xia, F.,
Andersen, D.G.,
Smola, A.:
Parameter server for distributed machine learning.
In: Big Learning NeurIPS Workshop,
vol. 6,
p. 2
(2013)


</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(16)</span>
<span class="ltx_bibblock">
Abadi, M.,
Chu, A.,
Goodfellow, I.J.,
McMahan, H.B.,
Mironov, I.,
Talwar, K.,
Zhang, L.:
Deep learning with differential privacy.
In: Proceedings of the ACM SIGSAC Conference on Computer and
Communications Security,
pp. 308–318
(2016)


</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(17)</span>
<span class="ltx_bibblock">
Li, X.,
Zhan, D.:
Fedrs: Federated learning with restricted softmax for label
distribution non-iid data.
In: The 27th ACM SIGKDD Conference on Knowledge Discovery and Data
Mining,
pp. 995–1005
(2021)


</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(18)</span>
<span class="ltx_bibblock">
Li, T.,
Sahu, A.K.,
Zaheer, M.,
Sanjabi, M.,
Talwalkar, A.,
Smith, V.:
Federated optimization in heterogeneous networks.
In: Proceedings of Machine Learning and Systems
(2020)


</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(19)</span>
<span class="ltx_bibblock">
Yao, X.,
Huang, C.,
Sun, L.:
Two-stream federated learning: Reduce the communication costs.
In: IEEE Visual Communications and Image Processing,
pp. 1–4
(2018)


</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(20)</span>
<span class="ltx_bibblock">
Karimireddy, S.P.,
Kale, S.,
Mohri, M.,
Reddi, S.J.,
Stich, S.U.,
Suresh, A.T.:
SCAFFOLD: stochastic controlled averaging for federated learning.
In: Proceedings of the 37th International Conference on Machine
Learning,
pp. 5132–5143
(2020)


</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(21)</span>
<span class="ltx_bibblock">
Hinton, G.E.,
Vinyals, O.,
Dean, J.:
Distilling the knowledge in a neural network.
CoRR
<span id="bib.bib21.1.1" class="ltx_text ltx_font_bold">abs/1503.02531</span>
(2015)


</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(22)</span>
<span class="ltx_bibblock">
Afonin, A.,
Karimireddy, S.P.:
Towards model agnostic federated learning using knowledge
distillation.
In: The Tenth International Conference on Learning Representations
(2022)


</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(23)</span>
<span class="ltx_bibblock">
Zhang, L.,
Shen, L.,
Ding, L.,
Tao, D.,
Duan, L.:
Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning.
In: IEEE/CVF Conference on Computer Vision and Pattern Recognition,
pp. 10164–10173
(2022)


</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(24)</span>
<span class="ltx_bibblock">
Long, M.,
Cao, Y.,
Wang, J.,
Jordan, M.I.:
Learning transferable features with deep adaptation networks.
In: Proceedings of the 32nd International Conference on Machine
Learning,
pp. 97–105
(2015)


</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(25)</span>
<span class="ltx_bibblock">
Li, D.,
Wang, J.:
Fedmd: Heterogenous federated learning via model distillation.
CoRR
<span id="bib.bib25.1.1" class="ltx_text ltx_font_bold">abs/1910.03581</span>
(2019)


</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(26)</span>
<span class="ltx_bibblock">
Jeong, W.,
Yoon, J.,
Yang, E.,
Hwang, S.J.:
Federated semi-supervised learning with inter-client consistency &amp;
disjoint learning.
In: 9th International Conference on Learning Representations
(2021)


</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(27)</span>
<span class="ltx_bibblock">
Long, Z.,
Wang, J.,
Wang, Y.,
Xiao, H.,
Ma, F.:
Fedcon: A contrastive framework for federated semi-supervised learning.
CoRR
<span id="bib.bib27.1.1" class="ltx_text ltx_font_bold">abs/2109.04533</span>
(2021)


</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(28)</span>
<span class="ltx_bibblock">
Kairouz, P.,
McMahan, H.B.,
et al.:
Advances and open problems in federated learning.
CoRR
<span id="bib.bib28.1.1" class="ltx_text ltx_font_bold">abs/1912.04977</span>
(2019)


</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(29)</span>
<span class="ltx_bibblock">
Krizhevsky, A.:
Learning multiple layers of features from tiny images
(2012)


</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(30)</span>
<span class="ltx_bibblock">
Sui, D.,
Chen, Y.,
Zhao, J.,
Jia, Y.,
Xie, Y.,
Sun, W.:
Feded: Federated learning via ensemble distillation for medical
relation extraction.
In: Proceedings of the Conference on Empirical Methods in Natural
Language Processing,
pp. 2118–2128
(2020)


</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(31)</span>
<span class="ltx_bibblock">
Yu, S.,
Qian, W.,
Jannesari, A.:
Resource-aware federated learning using knowledge extraction and multi-model
fusion.
CoRR
<span id="bib.bib31.1.1" class="ltx_text ltx_font_bold">abs/2208.07978</span>
(2022)


</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(32)</span>
<span class="ltx_bibblock">
Yao, Y.,
Doretto, G.:
Boosting for transfer learning with multiple sources.
In: The Twenty-Third IEEE Conference on Computer Vision and Pattern
Recognition,
pp. 1855–1862
(2010)


</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(33)</span>
<span class="ltx_bibblock">
Tong, X.,
Xu, X.,
Huang, S.,
Zheng, L.:
A mathematical framework for quantifying transferability in
multi-source transfer learning.
In: Advances in Neural Information Processing Systems 34,
pp. 26103–26116
(2021)


</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(34)</span>
<span class="ltx_bibblock">
Li, X.,
Wang, Y.,
Gan, L.,
Zhan, D.:
Exploring transferability measures and domain selection in
cross-domain slot filling.
In: IEEE International Conference on Acoustics, Speech and Signal
Processing,
pp. 3758–3762
(2022)


</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(35)</span>
<span class="ltx_bibblock">
Lecun, Y.,
Bottou, L.,
Bengio, Y.,
Haffner, P.:
Gradient-based learning applied to document recognition.
Proceedings of the IEEE
<span id="bib.bib35.1.1" class="ltx_text ltx_font_bold">86</span>(11),
2278–2324
(1998)


</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
Guha, N.,
Talwalkar, A.,
Smith, V.:
One-shot federated learning.
CoRR
<span id="bib.bib36.1.1" class="ltx_text ltx_font_bold">abs/1902.11175</span>
(2019)


</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(37)</span>
<span class="ltx_bibblock">
van der Maaten, L.:
Barnes-hut-sne.
In: 1st International Conference on Learning Representations
(2013)


</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(38)</span>
<span class="ltx_bibblock">
Shamir, O.,
Srebro, N.,
Zhang, T.:
Communication-efficient distributed optimization using an approximate
newton-type method.
In: Proceedings of the 31th International Conference on Machine
Learning,
pp. 1000–1008
(2014)


</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(39)</span>
<span class="ltx_bibblock">
Li, X.,
Huang, K.,
Yang, W.,
Wang, S.,
Zhang, Z.:
On the convergence of fedavg on non-iid data.
In: 8th International Conference on Learning Representations
(2020)


</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(40)</span>
<span class="ltx_bibblock">
Yang, C.,
Xie, L.,
Qiao, S.,
Yuille, A.L.:
Training deep neural networks in generations: A more tolerant
teacher educates better students.
In: Proceedings of the 33rd AAAI Conference on Artificial
Intelligence,
pp. 5628–5635
(2019)


</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(41)</span>
<span class="ltx_bibblock">
Laine, S.,
Aila, T.:
Temporal ensembling for semi-supervised learning.
In: 5th International Conference on Learning Representations
(2017)


</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(42)</span>
<span class="ltx_bibblock">
Tarvainen, A.,
Valpola, H.:
Mean teachers are better role models: Weight-averaged consistency
targets improve semi-supervised deep learning results.
In: 5th International Conference on Learning Representations
(2017)


</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(43)</span>
<span class="ltx_bibblock">
Li, X.,
Zhan, D.,
Shao, Y.,
Li, B.,
Song, S.:
Fedphp: Federated personalization with inherited private models.
In: Proceedings of the Machine Learning and Knowledge Discovery in
Databases - European Conference,
pp. 587–602
(2021)


</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(44)</span>
<span class="ltx_bibblock">
Caron, M.,
Bojanowski, P.,
Joulin, A.,
Douze, M.:
Deep clustering for unsupervised learning of visual features.
In: Computer Vision – ECCV 2018,
pp. 139–156
(2018)


</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(45)</span>
<span class="ltx_bibblock">
Liang, J.,
Hu, D.,
Feng, J.:
Do we really need to access the source data? source hypothesis
transfer for unsupervised domain adaptation.
In: Proceedings of the 37th International Conference on Machine
Learning,
pp. 6028–6039
(2020)


</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(46)</span>
<span class="ltx_bibblock">
Ganin, Y.,
Lempitsky, V.S.:
Unsupervised domain adaptation by backpropagation.
In: Proceedings of the 32nd International Conference on Machine
Learning,
pp. 1180–1189
(2015)


</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(47)</span>
<span class="ltx_bibblock">
Netzer, Y.,
Wang, T.,
Coates, A.,
Bissacco, A.,
Wu, B.,
Ng, A.:
Reading digits in natural images with unsupervised feature learning.
(2011)


</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(48)</span>
<span class="ltx_bibblock">
Caldas, S.,
Wu, P.,
Li, T.,
Konecný, J.,
McMahan, H.B.,
Smith, V.,
Talwalkar, A.:
LEAF: A benchmark for federated settings.
CoRR
<span id="bib.bib48.1.1" class="ltx_text ltx_font_bold">abs/1812.01097</span>
(2018)


</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(49)</span>
<span class="ltx_bibblock">
He, C.,
Li, S.,
So, J.,
Zhang, M.,
Wang, H.,
Wang, X.,
Vepakomma, P.,
Singh, A.,
Qiu, H.,
Shen, L.,
Zhao, P.,
Kang, Y.,
Liu, Y.,
Raskar, R.,
Yang, Q.,
Annavaram, M.,
Avestimehr, S.:
Fedml: A research library and benchmark for federated machine learning.
CoRR
<span id="bib.bib49.1.1" class="ltx_text ltx_font_bold">abs/2007.13518</span>
(2020)


</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(50)</span>
<span class="ltx_bibblock">
Simonyan, K.,
Zisserman, A.:
Very deep convolutional networks for large-scale image recognition.
In: 3rd International Conference on Learning Representations
(2015)


</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(51)</span>
<span class="ltx_bibblock">
Reddi, S.J.,
Charles, Z.,
Zaheer, M.,
Garrett, Z.,
Rush, K.,
Konečný, J.,
Kumar, S.,
McMahan, H.B.:
Adaptive federated optimization.
In: 9th International Conference on Learning Representations
(2021)


</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(52)</span>
<span class="ltx_bibblock">
Peng, X.,
Huang, Z.,
Zhu, Y.,
Saenko, K.:
Federated adversarial domain adaptation.
In: 8th International Conference on Learning Representations
(2020)


</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(53)</span>
<span class="ltx_bibblock">
Feng, H.,
You, Z.,
Chen, M.,
Zhang, T.,
Zhu, M.,
Wu, F.,
Wu, C.,
Chen, W.:
KD3A: unsupervised multi-source decentralized domain adaptation via
knowledge distillation.
In: Proceedings of the 38th International Conference on Machine
Learning,
pp. 3274–3283
(2021)


</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(54)</span>
<span class="ltx_bibblock">
Zhu, L.,
Liu, Z.,
Han, S.:
Deep leakage from gradients.
In: Advances in Neural Information Processing Systems 32,
pp. 14747–14756
(2019)


</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(55)</span>
<span class="ltx_bibblock">
Geiping, J.,
Bauermeister, H.,
Dröge, H.,
Moeller, M.:
Inverting gradients - how easy is it to break privacy in federated
learning?
In: Advances in Neural Information Processing Systems 33
(2020)


</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2305.04200" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2305.04201" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2305.04201">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2305.04201" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2305.04203" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 09:00:54 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
