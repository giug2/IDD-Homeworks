<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.02420] FedL2P: Federated Learning to Personalize</title><meta property="og:description" content="Federated learning (FL) research has made progress in developing algorithms for distributed learning of global models, as well as algorithms for local personalization of those common models to the specifics of each cli…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedL2P: Federated Learning to Personalize">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedL2P: Federated Learning to Personalize">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.02420">

<!--Generated on Wed Feb 28 02:21:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\backgroundsetup</span>
<p id="p1.2" class="ltx_p">angle=0,
scale=1,
color=black,
firstpage=true,
position=current page.north,
hshift=0pt,
vshift=-20pt,
contents=</p>
</div>
<h1 class="ltx_title ltx_title_document">FedL2P: Federated Learning to Personalize</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Royson Lee<sup id="id1.1.id1" class="ltx_sup">1,2</sup> , Minyoung Kim<sup id="id2.2.id2" class="ltx_sup">2</sup>, Da Li<sup id="id3.3.id3" class="ltx_sup">2</sup> 
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_bold">Xinchi Qiu<sup id="id4.4.id4.1" class="ltx_sup">1</sup>, Timothy Hospedales<sup id="id4.4.id4.2" class="ltx_sup">2,3</sup>, Ferenc Huszár<sup id="id4.4.id4.3" class="ltx_sup">1</sup>, Nicholas D. Lane<sup id="id4.4.id4.4" class="ltx_sup">1,4</sup></span> 
<br class="ltx_break">
<br class="ltx_break"><sup id="id5.5.id5" class="ltx_sup">1</sup> University of Cambridge, UK    
<sup id="id6.6.id6" class="ltx_sup">2</sup> Samsung AI Center, Cambridge, UK
<br class="ltx_break"><sup id="id7.7.id7" class="ltx_sup">3</sup> University of Edinburgh, UK    
<sup id="id8.8.id8" class="ltx_sup">4</sup> Flower Labs 
<br class="ltx_break">
</span><span class="ltx_author_notes">Corresponding Author: <span id="id9.9.id1" class="ltx_text ltx_font_typewriter">dsrl2@cam.ac.uk</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">Federated learning (FL) research has made progress in developing algorithms for distributed learning of global models, as well as algorithms for local personalization of those common models to the specifics of each client’s local data distribution. However, different FL problems may require different personalization strategies, and it may not even be possible to define an effective one-size-fits-all personalization strategy for all clients: depending on how similar each client’s optimal predictor is to that of the global model, different personalization strategies may be preferred. In this paper, we consider the federated meta-learning problem of learning personalization strategies. Specifically, we consider meta-nets that induce the batch-norm and learning rate parameters for each client given local data statistics. By learning these meta-nets through FL, we allow the whole FL network to collaborate in learning a customized personalization strategy for each client. Empirical results show that this framework improves on a range of standard hand-crafted personalization baselines in both label and feature shift situations.<span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_tag ltx_tag_note">0</span>Code is available at https://github.com/royson/fedl2p</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) is an emerging approach to enable privacy-preserving collaborative learning among clients who hold their own data. A major challenge of FL is to learn from differing degrees of statistical data heterogeneity among clients. This makes it hard to reliably learn a global model and also that the global model may perform sub-optimally for each local client. These two issues are often dealt with respectively by developing robust algorithms for learning the global model <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>, <a href="#bib.bib32" title="" class="ltx_ref">2021a</a>); Luo et al. (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> and then offering each client the opportunity to personalize the global model to its own unique local statistics via fine-tuning. In this paper, we focus on improving the fine-tuning process by learning a personalization strategy for each client.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A variety of approaches have been proposed for client personalization. Some algorithms directly learn the personalized models <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a href="#bib.bib62" title="" class="ltx_ref">2021</a>); Marfoq et al. (<a href="#bib.bib43" title="" class="ltx_ref">2021</a>)</cite>,
but the majority obtain the personalized model after global model learning by fine-tuning techniques such as basic fine-tuning <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>); Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>)</cite>, regularised fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib34" title="" class="ltx_ref">2021b</a>); T Dinh et al. (<a href="#bib.bib59" title="" class="ltx_ref">2020</a>)</cite>, and selective parameter fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Ghosh et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>); Collins et al. (<a href="#bib.bib11" title="" class="ltx_ref">2021</a>); Arivazhagan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>); Liang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>. Recent benchmarks <cite class="ltx_cite ltx_citemacro_cite">Matsuda et al. (<a href="#bib.bib45" title="" class="ltx_ref">2022b</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> showed that different personalized FL methods suffer from lack of comparable evaluation setups. In particular, dataset- and experiment-specific personalization strategies are often required to achieve state-of-the-art performance. Intuitively, different datasets and FL scenarios require different personalization strategies. For example, scenarios with greater or lesser heterogeneity among clients, would imply different strengths of personalization are optimal. Furthermore, exactly how that personalization should be conducted might depend on whether the heterogeneity is primarily in marginal label shift, marginal feature shift, or conditional shift. None of these facets can be well addressed by a one size fits all personalization algorithm.
Furthermore, we identify a previously understudied issue: even for a single federated learning scenario, heterogeneous clients may require different personalization strategies. For example, the optimal personalization strategy will have client-wise dependence on whether that client is more or less similar to the global model in either marginal or conditional data distributions. Existing works that learn personalized strategies through the use of personalized weights are not scalable to larger setups and models <cite class="ltx_cite ltx_citemacro_cite">Shamsian et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>); Deng et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>. On the other hand, the few studies that attempt to optimize hyperparameters for fine-tuning do not sufficiently address this issue as they either learn a single set of personalization hyperparameters <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>); Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> and/or learn a hyperparameter distribution without taking account of the client’s data distribution <cite class="ltx_cite ltx_citemacro_cite">Khodak et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we address the issues above by considering the challenge of federated meta-learning of personalization strategies. Rather than manually defining a personalization strategy as is mainstream in FL <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a href="#bib.bib27" title="" class="ltx_ref">2019</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>, we use hyper-gradient meta-learning strategies to efficiently estimate personalized hyperparameters. However, apart from standard centralised meta-learning and hyperparameter optimization (HPO) studies which only need to learn a single set of hyperparameters, we learn meta-nets which inductively map from local client statistics to client-specific personalization hyperparameters. More specifically, our approach FedL2P introduces meta-nets to estimate the extent in which to utilize the client-wise BN statistics as opposed to the global model’s BN statistics, as well as to infer layer-wise learning rates given each client’s metadata.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our FedL2P thus enables per-dataset/scenario, as well as per-client, personalization strategy learning. By conducting federated meta-learning of the personalization hyperparameter networks, we simultaneously allow each client to benefit from its own personalization strategy, (e.g., learning rapidly, depending on similarity to the global model), and also enable all the clients to collaborate by learning the overall hyperparameter networks that map local meta-data to local personalization strategy. Our FedL2P generalizes many existing frameworks as special cases, such as FedBN <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021c</a>)</cite>, which makes a manual choice to normalize features using the client BN’s statistics, and various selective fine-tuning approaches <cite class="ltx_cite ltx_citemacro_cite">Liang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>); Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Collins et al. (<a href="#bib.bib11" title="" class="ltx_ref">2021</a>); Arivazhagan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, which make manual choices on which layers to personalize.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Existing FL works aim to tackle the statistical heterogeneity of learning personalized models by either first learning a global model <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>); Luo et al. (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>); Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2021a</a>); Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Karimireddy et al. (<a href="#bib.bib29" title="" class="ltx_ref">2020</a>)</cite> and then fine-tuning it on local data or directly learning the local models, which can often be further personalized using fine-tuning.
Many personalized FL approaches include the use of transfer learning between global <cite class="ltx_cite ltx_citemacro_cite">Shen et al. (<a href="#bib.bib56" title="" class="ltx_ref">2020</a>)</cite> and local models <cite class="ltx_cite ltx_citemacro_cite">Matsuda et al. (<a href="#bib.bib44" title="" class="ltx_ref">2022a</a>)</cite>, model regularization <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib34" title="" class="ltx_ref">2021b</a>)</cite>, Moreau envelopes <cite class="ltx_cite ltx_citemacro_cite">T Dinh et al. (<a href="#bib.bib59" title="" class="ltx_ref">2020</a>)</cite>, and meta-learning <cite class="ltx_cite ltx_citemacro_cite">Fallah et al. (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>); Chen et al. (<a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>. Besides algorithmic changes, many works also proposed model decoupling, in which layers are either shared or personalized <cite class="ltx_cite ltx_citemacro_cite">Arivazhagan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>); Collins et al. (<a href="#bib.bib11" title="" class="ltx_ref">2021</a>); Zhong et al. (<a href="#bib.bib64" title="" class="ltx_ref">2023</a>); Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Liang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>); Ghosh et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>); <a href="#bib.bib54" title="" class="ltx_ref">Setayesh et al. </a></cite> or client clustering, which assumes a local model for each cluster <cite class="ltx_cite ltx_citemacro_cite">Mansour et al. (<a href="#bib.bib42" title="" class="ltx_ref">2020</a>); Matsuda et al. (<a href="#bib.bib44" title="" class="ltx_ref">2022a</a>); Sattler et al. (<a href="#bib.bib53" title="" class="ltx_ref">2020</a>); Briggs et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>.
These methods often rely on or adopt a fixed personalization policy for local fine-tuning in order to adapt a global model or further improve personalized performance.
Although there exists numerous FL approaches that propose adaptable personalization policies <cite class="ltx_cite ltx_citemacro_cite">Shamsian et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>); Ma et al. (<a href="#bib.bib40" title="" class="ltx_ref">2022</a>); Deng et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, these works are memory intensive and do not scale to larger setups and models.
On the other hand, our approach has a low memory footprint (Appendix <a href="#A3" title="Appendix C Cost of FedL2P ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>) and is directly applicable and complementary to existing FL approaches as it aims to solely improve the fine-tuning process.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Another line of work involves HPO for FL (or FL for HPO).
These methods either learn one set of hyperparameters for all clients <cite class="ltx_cite ltx_citemacro_cite">Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>); Khodak et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>); Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>)</cite> or random sample from learnt hyperparameter categorical distributions which does not take into account of the client’s meta-data <cite class="ltx_cite ltx_citemacro_cite">Khodak et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>.
Moreover, some of these methods <cite class="ltx_cite ltx_citemacro_cite">Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>); Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>)</cite> search for a set of hyperparameters based on the local validation loss given the initial set of weights prior to the federated learning of the model <cite class="ltx_cite ltx_citemacro_cite">Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>); Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>)</cite>, which might be an inaccurate proxy to the final performance.
Unlike previous works which directly learn hyperparameters, we deploy FL to learn meta-nets that take in, as inputs, the client meta-data to generate personalized hyperparameters for a given pretrained model. A detailed positioning of our work in comparison with existing literature can be found in Appendix <a href="#A2" title="Appendix B Positioning of FedL2P. ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Background &amp; Preliminaries</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.26" class="ltx_p"><span id="S3.SS1.p1.26.1" class="ltx_text ltx_font_bold">Centralized FL.</span>
A typical centralized FL setup using FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>)</cite> involves training a global model <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\theta_{g}</annotation></semantics></math> from <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">C</annotation></semantics></math> clients whose data are kept private. At round <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">t</annotation></semantics></math>, <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\theta_{g}^{t-1}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msubsup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">g</mi><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝜃</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑔</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><minus id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></minus><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\theta_{g}^{t-1}</annotation></semantics></math> is broadcast to a subset of clients selected, <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\tilde{C}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mover accent="true" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">C</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><ci id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">~</ci><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\tilde{C}</annotation></semantics></math>, using a fraction ratio <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">r</annotation></semantics></math>. Each selected client, <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="i\in\tilde{C}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">i</mi><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><mover accent="true" id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">C</mi><mo id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑖</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><ci id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1">~</ci><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i\in\tilde{C}</annotation></semantics></math>, would then update the model using a set of hyperparameters and its own data samples, which are drawn from its local distribution <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">P</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑃</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">P_{i}</annotation></semantics></math> defined over <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{X}\times\mathcal{Y}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><times id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></times><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝒳</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{X}\times\mathcal{Y}</annotation></semantics></math> for a compact space <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\mathcal{X}</annotation></semantics></math> and a label space <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mathcal{Y}</annotation></semantics></math> for <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">e</annotation></semantics></math> epochs. After which, the learned local models, <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\theta_{i}^{t-1}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msubsup id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2.2" xref="S3.SS1.p1.13.m13.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p1.13.m13.1.1.2.3" xref="S3.SS1.p1.13.m13.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3.2" xref="S3.SS1.p1.13.m13.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.13.m13.1.1.3.1" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.13.m13.1.1.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2">𝜃</ci><ci id="S3.SS1.p1.13.m13.1.1.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3"><minus id="S3.SS1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.1"></minus><ci id="S3.SS1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.13.m13.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\theta_{i}^{t-1}</annotation></semantics></math>, are sent back to the server for aggregation <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="\theta_{g}^{t}=\sum^{\tilde{C}}_{i}\frac{N_{i}}{\sum_{i^{\prime}}N_{i^{\prime}}}\theta_{i}^{t-1}" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><msubsup id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2.2.2" xref="S3.SS1.p1.14.m14.1.1.2.2.2.cmml">θ</mi><mi id="S3.SS1.p1.14.m14.1.1.2.2.3" xref="S3.SS1.p1.14.m14.1.1.2.2.3.cmml">g</mi><mi id="S3.SS1.p1.14.m14.1.1.2.3" xref="S3.SS1.p1.14.m14.1.1.2.3.cmml">t</mi></msubsup><mo rspace="0.111em" id="S3.SS1.p1.14.m14.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml"><msubsup id="S3.SS1.p1.14.m14.1.1.3.1" xref="S3.SS1.p1.14.m14.1.1.3.1.cmml"><mo id="S3.SS1.p1.14.m14.1.1.3.1.2.2" xref="S3.SS1.p1.14.m14.1.1.3.1.2.2.cmml">∑</mo><mi id="S3.SS1.p1.14.m14.1.1.3.1.3" xref="S3.SS1.p1.14.m14.1.1.3.1.3.cmml">i</mi><mover accent="true" id="S3.SS1.p1.14.m14.1.1.3.1.2.3" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.1.2.3.2" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3.2.cmml">C</mi><mo id="S3.SS1.p1.14.m14.1.1.3.1.2.3.1" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3.1.cmml">~</mo></mover></msubsup><mrow id="S3.SS1.p1.14.m14.1.1.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.cmml"><mfrac id="S3.SS1.p1.14.m14.1.1.3.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.cmml"><msub id="S3.SS1.p1.14.m14.1.1.3.2.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.2.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2.2.cmml">N</mi><mi id="S3.SS1.p1.14.m14.1.1.3.2.2.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2.3.cmml">i</mi></msub><mrow id="S3.SS1.p1.14.m14.1.1.3.2.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.cmml"><mstyle displaystyle="false" id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.cmml"><msub id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1a" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.cmml"><mo id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.2.cmml">∑</mo><msup id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.3.cmml">′</mo></msup></msub></mstyle><msub id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.2.cmml">N</mi><msup id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.3" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.3.cmml">′</mo></msup></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.3.2.1" xref="S3.SS1.p1.14.m14.1.1.3.2.1.cmml">​</mo><msubsup id="S3.SS1.p1.14.m14.1.1.3.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.3.2.2" xref="S3.SS1.p1.14.m14.1.1.3.2.3.2.2.cmml">θ</mi><mi id="S3.SS1.p1.14.m14.1.1.3.2.3.2.3" xref="S3.SS1.p1.14.m14.1.1.3.2.3.2.3.cmml">i</mi><mrow id="S3.SS1.p1.14.m14.1.1.3.2.3.3" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3.2.3.3.2" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.2.cmml">t</mi><mo id="S3.SS1.p1.14.m14.1.1.3.2.3.3.1" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.14.m14.1.1.3.2.3.3.3" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><eq id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1"></eq><apply id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.14.m14.1.1.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2.2.2">𝜃</ci><ci id="S3.SS1.p1.14.m14.1.1.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.2.2.3">𝑔</ci></apply><ci id="S3.SS1.p1.14.m14.1.1.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3"><apply id="S3.SS1.p1.14.m14.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1">subscript</csymbol><apply id="S3.SS1.p1.14.m14.1.1.3.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1">superscript</csymbol><sum id="S3.SS1.p1.14.m14.1.1.3.1.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1.2.2"></sum><apply id="S3.SS1.p1.14.m14.1.1.3.1.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3"><ci id="S3.SS1.p1.14.m14.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3.1">~</ci><ci id="S3.SS1.p1.14.m14.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1.2.3.2">𝐶</ci></apply></apply><ci id="S3.SS1.p1.14.m14.1.1.3.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2"><times id="S3.SS1.p1.14.m14.1.1.3.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.1"></times><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2"><divide id="S3.SS1.p1.14.m14.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2"></divide><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2.2">𝑁</ci><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3"><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.2"></sum><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3">superscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.2">𝑖</ci><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.1.3.3">′</ci></apply></apply><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.2">𝑁</ci><apply id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3">superscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.2">𝑖</ci><ci id="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.2.3.2.3.3">′</ci></apply></apply></apply></apply><apply id="S3.SS1.p1.14.m14.1.1.3.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3">superscript</csymbol><apply id="S3.SS1.p1.14.m14.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.3.2.3.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.3.2.3.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.2.2">𝜃</ci><ci id="S3.SS1.p1.14.m14.1.1.3.2.3.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.14.m14.1.1.3.2.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3"><minus id="S3.SS1.p1.14.m14.1.1.3.2.3.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.1"></minus><ci id="S3.SS1.p1.14.m14.1.1.3.2.3.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.14.m14.1.1.3.2.3.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\theta_{g}^{t}=\sum^{\tilde{C}}_{i}\frac{N_{i}}{\sum_{i^{\prime}}N_{i^{\prime}}}\theta_{i}^{t-1}</annotation></semantics></math> where <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑁</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">N_{i}</annotation></semantics></math> is the total number of local data samples in client <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">i</annotation></semantics></math> and the resulting <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="\theta_{g}^{t}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><msubsup id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.p1.17.m17.1.1.2.2" xref="S3.SS1.p1.17.m17.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p1.17.m17.1.1.2.3" xref="S3.SS1.p1.17.m17.1.1.2.3.cmml">g</mi><mi id="S3.SS1.p1.17.m17.1.1.3" xref="S3.SS1.p1.17.m17.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">superscript</csymbol><apply id="S3.SS1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.2.1.cmml" xref="S3.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.p1.17.m17.1.1.2.2.cmml" xref="S3.SS1.p1.17.m17.1.1.2.2">𝜃</ci><ci id="S3.SS1.p1.17.m17.1.1.2.3.cmml" xref="S3.SS1.p1.17.m17.1.1.2.3">𝑔</ci></apply><ci id="S3.SS1.p1.17.m17.1.1.3.cmml" xref="S3.SS1.p1.17.m17.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">\theta_{g}^{t}</annotation></semantics></math> is used for the next round. The aim of FL is either to minimize the global objective <math id="S3.SS1.p1.18.m18.5" class="ltx_Math" alttext="\mathbb{E}_{(x,y)\sim P}\mathcal{L}(\theta_{g};x,y)" display="inline"><semantics id="S3.SS1.p1.18.m18.5a"><mrow id="S3.SS1.p1.18.m18.5.5" xref="S3.SS1.p1.18.m18.5.5.cmml"><msub id="S3.SS1.p1.18.m18.5.5.3" xref="S3.SS1.p1.18.m18.5.5.3.cmml"><mi id="S3.SS1.p1.18.m18.5.5.3.2" xref="S3.SS1.p1.18.m18.5.5.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.18.m18.2.2.2" xref="S3.SS1.p1.18.m18.2.2.2.cmml"><mrow id="S3.SS1.p1.18.m18.2.2.2.4.2" xref="S3.SS1.p1.18.m18.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.18.m18.2.2.2.4.2.1" xref="S3.SS1.p1.18.m18.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p1.18.m18.1.1.1.1" xref="S3.SS1.p1.18.m18.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p1.18.m18.2.2.2.4.2.2" xref="S3.SS1.p1.18.m18.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p1.18.m18.2.2.2.2" xref="S3.SS1.p1.18.m18.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.18.m18.2.2.2.4.2.3" xref="S3.SS1.p1.18.m18.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.18.m18.2.2.2.3" xref="S3.SS1.p1.18.m18.2.2.2.3.cmml">∼</mo><mi id="S3.SS1.p1.18.m18.2.2.2.5" xref="S3.SS1.p1.18.m18.2.2.2.5.cmml">P</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.18.m18.5.5.2" xref="S3.SS1.p1.18.m18.5.5.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.18.m18.5.5.4" xref="S3.SS1.p1.18.m18.5.5.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.18.m18.5.5.2a" xref="S3.SS1.p1.18.m18.5.5.2.cmml">​</mo><mrow id="S3.SS1.p1.18.m18.5.5.1.1" xref="S3.SS1.p1.18.m18.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.18.m18.5.5.1.1.2" xref="S3.SS1.p1.18.m18.5.5.1.2.cmml">(</mo><msub id="S3.SS1.p1.18.m18.5.5.1.1.1" xref="S3.SS1.p1.18.m18.5.5.1.1.1.cmml"><mi id="S3.SS1.p1.18.m18.5.5.1.1.1.2" xref="S3.SS1.p1.18.m18.5.5.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.18.m18.5.5.1.1.1.3" xref="S3.SS1.p1.18.m18.5.5.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS1.p1.18.m18.5.5.1.1.3" xref="S3.SS1.p1.18.m18.5.5.1.2.cmml">;</mo><mi id="S3.SS1.p1.18.m18.3.3" xref="S3.SS1.p1.18.m18.3.3.cmml">x</mi><mo id="S3.SS1.p1.18.m18.5.5.1.1.4" xref="S3.SS1.p1.18.m18.5.5.1.2.cmml">,</mo><mi id="S3.SS1.p1.18.m18.4.4" xref="S3.SS1.p1.18.m18.4.4.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.18.m18.5.5.1.1.5" xref="S3.SS1.p1.18.m18.5.5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.5b"><apply id="S3.SS1.p1.18.m18.5.5.cmml" xref="S3.SS1.p1.18.m18.5.5"><times id="S3.SS1.p1.18.m18.5.5.2.cmml" xref="S3.SS1.p1.18.m18.5.5.2"></times><apply id="S3.SS1.p1.18.m18.5.5.3.cmml" xref="S3.SS1.p1.18.m18.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.5.5.3.1.cmml" xref="S3.SS1.p1.18.m18.5.5.3">subscript</csymbol><ci id="S3.SS1.p1.18.m18.5.5.3.2.cmml" xref="S3.SS1.p1.18.m18.5.5.3.2">𝔼</ci><apply id="S3.SS1.p1.18.m18.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.18.m18.2.2.2.3.cmml" xref="S3.SS1.p1.18.m18.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p1.18.m18.2.2.2.4.1.cmml" xref="S3.SS1.p1.18.m18.2.2.2.4.2"><ci id="S3.SS1.p1.18.m18.1.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1">𝑥</ci><ci id="S3.SS1.p1.18.m18.2.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2">𝑦</ci></interval><ci id="S3.SS1.p1.18.m18.2.2.2.5.cmml" xref="S3.SS1.p1.18.m18.2.2.2.5">𝑃</ci></apply></apply><ci id="S3.SS1.p1.18.m18.5.5.4.cmml" xref="S3.SS1.p1.18.m18.5.5.4">ℒ</ci><list id="S3.SS1.p1.18.m18.5.5.1.2.cmml" xref="S3.SS1.p1.18.m18.5.5.1.1"><apply id="S3.SS1.p1.18.m18.5.5.1.1.1.cmml" xref="S3.SS1.p1.18.m18.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.5.5.1.1.1.1.cmml" xref="S3.SS1.p1.18.m18.5.5.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m18.5.5.1.1.1.2.cmml" xref="S3.SS1.p1.18.m18.5.5.1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.18.m18.5.5.1.1.1.3.cmml" xref="S3.SS1.p1.18.m18.5.5.1.1.1.3">𝑔</ci></apply><ci id="S3.SS1.p1.18.m18.3.3.cmml" xref="S3.SS1.p1.18.m18.3.3">𝑥</ci><ci id="S3.SS1.p1.18.m18.4.4.cmml" xref="S3.SS1.p1.18.m18.4.4">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.5c">\mathbb{E}_{(x,y)\sim P}\mathcal{L}(\theta_{g};x,y)</annotation></semantics></math> for the global data distribution <math id="S3.SS1.p1.19.m19.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS1.p1.19.m19.1a"><mi id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><ci id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">P</annotation></semantics></math> or local objective <math id="S3.SS1.p1.20.m20.5" class="ltx_Math" alttext="\mathbb{E}_{(x,y)\sim P_{i}}\mathcal{L}_{i}(\theta_{i};x,y)" display="inline"><semantics id="S3.SS1.p1.20.m20.5a"><mrow id="S3.SS1.p1.20.m20.5.5" xref="S3.SS1.p1.20.m20.5.5.cmml"><msub id="S3.SS1.p1.20.m20.5.5.3" xref="S3.SS1.p1.20.m20.5.5.3.cmml"><mi id="S3.SS1.p1.20.m20.5.5.3.2" xref="S3.SS1.p1.20.m20.5.5.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.20.m20.2.2.2" xref="S3.SS1.p1.20.m20.2.2.2.cmml"><mrow id="S3.SS1.p1.20.m20.2.2.2.4.2" xref="S3.SS1.p1.20.m20.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.20.m20.2.2.2.4.2.1" xref="S3.SS1.p1.20.m20.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p1.20.m20.1.1.1.1" xref="S3.SS1.p1.20.m20.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p1.20.m20.2.2.2.4.2.2" xref="S3.SS1.p1.20.m20.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p1.20.m20.2.2.2.2" xref="S3.SS1.p1.20.m20.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.20.m20.2.2.2.4.2.3" xref="S3.SS1.p1.20.m20.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.20.m20.2.2.2.3" xref="S3.SS1.p1.20.m20.2.2.2.3.cmml">∼</mo><msub id="S3.SS1.p1.20.m20.2.2.2.5" xref="S3.SS1.p1.20.m20.2.2.2.5.cmml"><mi id="S3.SS1.p1.20.m20.2.2.2.5.2" xref="S3.SS1.p1.20.m20.2.2.2.5.2.cmml">P</mi><mi id="S3.SS1.p1.20.m20.2.2.2.5.3" xref="S3.SS1.p1.20.m20.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.20.m20.5.5.2" xref="S3.SS1.p1.20.m20.5.5.2.cmml">​</mo><msub id="S3.SS1.p1.20.m20.5.5.4" xref="S3.SS1.p1.20.m20.5.5.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.20.m20.5.5.4.2" xref="S3.SS1.p1.20.m20.5.5.4.2.cmml">ℒ</mi><mi id="S3.SS1.p1.20.m20.5.5.4.3" xref="S3.SS1.p1.20.m20.5.5.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.20.m20.5.5.2a" xref="S3.SS1.p1.20.m20.5.5.2.cmml">​</mo><mrow id="S3.SS1.p1.20.m20.5.5.1.1" xref="S3.SS1.p1.20.m20.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.20.m20.5.5.1.1.2" xref="S3.SS1.p1.20.m20.5.5.1.2.cmml">(</mo><msub id="S3.SS1.p1.20.m20.5.5.1.1.1" xref="S3.SS1.p1.20.m20.5.5.1.1.1.cmml"><mi id="S3.SS1.p1.20.m20.5.5.1.1.1.2" xref="S3.SS1.p1.20.m20.5.5.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.20.m20.5.5.1.1.1.3" xref="S3.SS1.p1.20.m20.5.5.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.20.m20.5.5.1.1.3" xref="S3.SS1.p1.20.m20.5.5.1.2.cmml">;</mo><mi id="S3.SS1.p1.20.m20.3.3" xref="S3.SS1.p1.20.m20.3.3.cmml">x</mi><mo id="S3.SS1.p1.20.m20.5.5.1.1.4" xref="S3.SS1.p1.20.m20.5.5.1.2.cmml">,</mo><mi id="S3.SS1.p1.20.m20.4.4" xref="S3.SS1.p1.20.m20.4.4.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.20.m20.5.5.1.1.5" xref="S3.SS1.p1.20.m20.5.5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.5b"><apply id="S3.SS1.p1.20.m20.5.5.cmml" xref="S3.SS1.p1.20.m20.5.5"><times id="S3.SS1.p1.20.m20.5.5.2.cmml" xref="S3.SS1.p1.20.m20.5.5.2"></times><apply id="S3.SS1.p1.20.m20.5.5.3.cmml" xref="S3.SS1.p1.20.m20.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.5.5.3.1.cmml" xref="S3.SS1.p1.20.m20.5.5.3">subscript</csymbol><ci id="S3.SS1.p1.20.m20.5.5.3.2.cmml" xref="S3.SS1.p1.20.m20.5.5.3.2">𝔼</ci><apply id="S3.SS1.p1.20.m20.2.2.2.cmml" xref="S3.SS1.p1.20.m20.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.20.m20.2.2.2.3.cmml" xref="S3.SS1.p1.20.m20.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p1.20.m20.2.2.2.4.1.cmml" xref="S3.SS1.p1.20.m20.2.2.2.4.2"><ci id="S3.SS1.p1.20.m20.1.1.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1.1.1">𝑥</ci><ci id="S3.SS1.p1.20.m20.2.2.2.2.cmml" xref="S3.SS1.p1.20.m20.2.2.2.2">𝑦</ci></interval><apply id="S3.SS1.p1.20.m20.2.2.2.5.cmml" xref="S3.SS1.p1.20.m20.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.2.2.2.5.1.cmml" xref="S3.SS1.p1.20.m20.2.2.2.5">subscript</csymbol><ci id="S3.SS1.p1.20.m20.2.2.2.5.2.cmml" xref="S3.SS1.p1.20.m20.2.2.2.5.2">𝑃</ci><ci id="S3.SS1.p1.20.m20.2.2.2.5.3.cmml" xref="S3.SS1.p1.20.m20.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p1.20.m20.5.5.4.cmml" xref="S3.SS1.p1.20.m20.5.5.4"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.5.5.4.1.cmml" xref="S3.SS1.p1.20.m20.5.5.4">subscript</csymbol><ci id="S3.SS1.p1.20.m20.5.5.4.2.cmml" xref="S3.SS1.p1.20.m20.5.5.4.2">ℒ</ci><ci id="S3.SS1.p1.20.m20.5.5.4.3.cmml" xref="S3.SS1.p1.20.m20.5.5.4.3">𝑖</ci></apply><list id="S3.SS1.p1.20.m20.5.5.1.2.cmml" xref="S3.SS1.p1.20.m20.5.5.1.1"><apply id="S3.SS1.p1.20.m20.5.5.1.1.1.cmml" xref="S3.SS1.p1.20.m20.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.5.5.1.1.1.1.cmml" xref="S3.SS1.p1.20.m20.5.5.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m20.5.5.1.1.1.2.cmml" xref="S3.SS1.p1.20.m20.5.5.1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.20.m20.5.5.1.1.1.3.cmml" xref="S3.SS1.p1.20.m20.5.5.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.p1.20.m20.3.3.cmml" xref="S3.SS1.p1.20.m20.3.3">𝑥</ci><ci id="S3.SS1.p1.20.m20.4.4.cmml" xref="S3.SS1.p1.20.m20.4.4">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.5c">\mathbb{E}_{(x,y)\sim P_{i}}\mathcal{L}_{i}(\theta_{i};x,y)</annotation></semantics></math> for all <math id="S3.SS1.p1.21.m21.1" class="ltx_Math" alttext="i\in C" display="inline"><semantics id="S3.SS1.p1.21.m21.1a"><mrow id="S3.SS1.p1.21.m21.1.1" xref="S3.SS1.p1.21.m21.1.1.cmml"><mi id="S3.SS1.p1.21.m21.1.1.2" xref="S3.SS1.p1.21.m21.1.1.2.cmml">i</mi><mo id="S3.SS1.p1.21.m21.1.1.1" xref="S3.SS1.p1.21.m21.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.21.m21.1.1.3" xref="S3.SS1.p1.21.m21.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.1b"><apply id="S3.SS1.p1.21.m21.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1"><in id="S3.SS1.p1.21.m21.1.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1.1"></in><ci id="S3.SS1.p1.21.m21.1.1.2.cmml" xref="S3.SS1.p1.21.m21.1.1.2">𝑖</ci><ci id="S3.SS1.p1.21.m21.1.1.3.cmml" xref="S3.SS1.p1.21.m21.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.1c">i\in C</annotation></semantics></math> where <math id="S3.SS1.p1.22.m22.3" class="ltx_Math" alttext="\mathcal{L}_{i}(\theta;x,y)" display="inline"><semantics id="S3.SS1.p1.22.m22.3a"><mrow id="S3.SS1.p1.22.m22.3.4" xref="S3.SS1.p1.22.m22.3.4.cmml"><msub id="S3.SS1.p1.22.m22.3.4.2" xref="S3.SS1.p1.22.m22.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.22.m22.3.4.2.2" xref="S3.SS1.p1.22.m22.3.4.2.2.cmml">ℒ</mi><mi id="S3.SS1.p1.22.m22.3.4.2.3" xref="S3.SS1.p1.22.m22.3.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.22.m22.3.4.1" xref="S3.SS1.p1.22.m22.3.4.1.cmml">​</mo><mrow id="S3.SS1.p1.22.m22.3.4.3.2" xref="S3.SS1.p1.22.m22.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.22.m22.3.4.3.2.1" xref="S3.SS1.p1.22.m22.3.4.3.1.cmml">(</mo><mi id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml">θ</mi><mo id="S3.SS1.p1.22.m22.3.4.3.2.2" xref="S3.SS1.p1.22.m22.3.4.3.1.cmml">;</mo><mi id="S3.SS1.p1.22.m22.2.2" xref="S3.SS1.p1.22.m22.2.2.cmml">x</mi><mo id="S3.SS1.p1.22.m22.3.4.3.2.3" xref="S3.SS1.p1.22.m22.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.22.m22.3.3" xref="S3.SS1.p1.22.m22.3.3.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.22.m22.3.4.3.2.4" xref="S3.SS1.p1.22.m22.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.3b"><apply id="S3.SS1.p1.22.m22.3.4.cmml" xref="S3.SS1.p1.22.m22.3.4"><times id="S3.SS1.p1.22.m22.3.4.1.cmml" xref="S3.SS1.p1.22.m22.3.4.1"></times><apply id="S3.SS1.p1.22.m22.3.4.2.cmml" xref="S3.SS1.p1.22.m22.3.4.2"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.3.4.2.1.cmml" xref="S3.SS1.p1.22.m22.3.4.2">subscript</csymbol><ci id="S3.SS1.p1.22.m22.3.4.2.2.cmml" xref="S3.SS1.p1.22.m22.3.4.2.2">ℒ</ci><ci id="S3.SS1.p1.22.m22.3.4.2.3.cmml" xref="S3.SS1.p1.22.m22.3.4.2.3">𝑖</ci></apply><list id="S3.SS1.p1.22.m22.3.4.3.1.cmml" xref="S3.SS1.p1.22.m22.3.4.3.2"><ci id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1">𝜃</ci><ci id="S3.SS1.p1.22.m22.2.2.cmml" xref="S3.SS1.p1.22.m22.2.2">𝑥</ci><ci id="S3.SS1.p1.22.m22.3.3.cmml" xref="S3.SS1.p1.22.m22.3.3">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.3c">\mathcal{L}_{i}(\theta;x,y)</annotation></semantics></math> is the loss given the model parameters <math id="S3.SS1.p1.23.m23.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p1.23.m23.1a"><mi id="S3.SS1.p1.23.m23.1.1" xref="S3.SS1.p1.23.m23.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m23.1b"><ci id="S3.SS1.p1.23.m23.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m23.1c">\theta</annotation></semantics></math> at data point <math id="S3.SS1.p1.24.m24.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS1.p1.24.m24.2a"><mrow id="S3.SS1.p1.24.m24.2.3.2" xref="S3.SS1.p1.24.m24.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.24.m24.2.3.2.1" xref="S3.SS1.p1.24.m24.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.24.m24.1.1" xref="S3.SS1.p1.24.m24.1.1.cmml">x</mi><mo id="S3.SS1.p1.24.m24.2.3.2.2" xref="S3.SS1.p1.24.m24.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.24.m24.2.2" xref="S3.SS1.p1.24.m24.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.24.m24.2.3.2.3" xref="S3.SS1.p1.24.m24.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m24.2b"><interval closure="open" id="S3.SS1.p1.24.m24.2.3.1.cmml" xref="S3.SS1.p1.24.m24.2.3.2"><ci id="S3.SS1.p1.24.m24.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1">𝑥</ci><ci id="S3.SS1.p1.24.m24.2.2.cmml" xref="S3.SS1.p1.24.m24.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m24.2c">(x,y)</annotation></semantics></math>. As fine-tuning is the dominant approach to either personalize from a high-performing <math id="S3.SS1.p1.25.m25.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS1.p1.25.m25.1a"><msub id="S3.SS1.p1.25.m25.1.1" xref="S3.SS1.p1.25.m25.1.1.cmml"><mi id="S3.SS1.p1.25.m25.1.1.2" xref="S3.SS1.p1.25.m25.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.25.m25.1.1.3" xref="S3.SS1.p1.25.m25.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.25.m25.1b"><apply id="S3.SS1.p1.25.m25.1.1.cmml" xref="S3.SS1.p1.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.25.m25.1.1.1.cmml" xref="S3.SS1.p1.25.m25.1.1">subscript</csymbol><ci id="S3.SS1.p1.25.m25.1.1.2.cmml" xref="S3.SS1.p1.25.m25.1.1.2">𝜃</ci><ci id="S3.SS1.p1.25.m25.1.1.3.cmml" xref="S3.SS1.p1.25.m25.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.25.m25.1c">\theta_{g}</annotation></semantics></math> or to optimize <math id="S3.SS1.p1.26.m26.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS1.p1.26.m26.1a"><msub id="S3.SS1.p1.26.m26.1.1" xref="S3.SS1.p1.26.m26.1.1.cmml"><mi id="S3.SS1.p1.26.m26.1.1.2" xref="S3.SS1.p1.26.m26.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.26.m26.1.1.3" xref="S3.SS1.p1.26.m26.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.26.m26.1b"><apply id="S3.SS1.p1.26.m26.1.1.cmml" xref="S3.SS1.p1.26.m26.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.26.m26.1.1.1.cmml" xref="S3.SS1.p1.26.m26.1.1">subscript</csymbol><ci id="S3.SS1.p1.26.m26.1.1.2.cmml" xref="S3.SS1.p1.26.m26.1.1.2">𝜃</ci><ci id="S3.SS1.p1.26.m26.1.1.3.cmml" xref="S3.SS1.p1.26.m26.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.26.m26.1c">\theta_{i}</annotation></semantics></math> further for each client, achieving competitive or state-of-the-art results in recent benchmarks <cite class="ltx_cite ltx_citemacro_cite">Matsuda et al. (<a href="#bib.bib45" title="" class="ltx_ref">2022b</a>); Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>, we focus on the collaborative learning of meta-nets which generates a personalized set of hyperparameters used during fine-tuning to further improve personalized performance without compromising global performance.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p"><span id="S3.SS1.p2.8.1" class="ltx_text ltx_font_bold">Non-IID Problem Setup.</span>
Unlike many previous works, our method aims to handle both common label and feature distribution shift across clients. Specifically, given features <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">x</annotation></semantics></math> and labels <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">y</annotation></semantics></math>, we can rewrite the joint probability <math id="S3.SS1.p2.3.m3.2" class="ltx_Math" alttext="P_{i}(x,y)" display="inline"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.3" xref="S3.SS1.p2.3.m3.2.3.cmml"><msub id="S3.SS1.p2.3.m3.2.3.2" xref="S3.SS1.p2.3.m3.2.3.2.cmml"><mi id="S3.SS1.p2.3.m3.2.3.2.2" xref="S3.SS1.p2.3.m3.2.3.2.2.cmml">P</mi><mi id="S3.SS1.p2.3.m3.2.3.2.3" xref="S3.SS1.p2.3.m3.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.2.3.1" xref="S3.SS1.p2.3.m3.2.3.1.cmml">​</mo><mrow id="S3.SS1.p2.3.m3.2.3.3.2" xref="S3.SS1.p2.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.2.3.3.2.1" xref="S3.SS1.p2.3.m3.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">x</mi><mo id="S3.SS1.p2.3.m3.2.3.3.2.2" xref="S3.SS1.p2.3.m3.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.2.3.3.2.3" xref="S3.SS1.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><apply id="S3.SS1.p2.3.m3.2.3.cmml" xref="S3.SS1.p2.3.m3.2.3"><times id="S3.SS1.p2.3.m3.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.3.1"></times><apply id="S3.SS1.p2.3.m3.2.3.2.cmml" xref="S3.SS1.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.3.2.1.cmml" xref="S3.SS1.p2.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.3.2.2">𝑃</ci><ci id="S3.SS1.p2.3.m3.2.3.2.3.cmml" xref="S3.SS1.p2.3.m3.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p2.3.m3.2.3.3.1.cmml" xref="S3.SS1.p2.3.m3.2.3.3.2"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑥</ci><ci id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">P_{i}(x,y)</annotation></semantics></math> as <math id="S3.SS1.p2.4.m4.2" class="ltx_Math" alttext="P_{i}(x|y)P_{i}(y)" display="inline"><semantics id="S3.SS1.p2.4.m4.2a"><mrow id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml"><msub id="S3.SS1.p2.4.m4.2.2.3" xref="S3.SS1.p2.4.m4.2.2.3.cmml"><mi id="S3.SS1.p2.4.m4.2.2.3.2" xref="S3.SS1.p2.4.m4.2.2.3.2.cmml">P</mi><mi id="S3.SS1.p2.4.m4.2.2.3.3" xref="S3.SS1.p2.4.m4.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.4.m4.2.2.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.1.1.2" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.2.2.1.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.2.2.1.1.1.2" xref="S3.SS1.p2.4.m4.2.2.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS1.p2.4.m4.2.2.1.1.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.4.m4.2.2.1.1.1.3" xref="S3.SS1.p2.4.m4.2.2.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.1.1.3" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.2.2.2a" xref="S3.SS1.p2.4.m4.2.2.2.cmml">​</mo><msub id="S3.SS1.p2.4.m4.2.2.4" xref="S3.SS1.p2.4.m4.2.2.4.cmml"><mi id="S3.SS1.p2.4.m4.2.2.4.2" xref="S3.SS1.p2.4.m4.2.2.4.2.cmml">P</mi><mi id="S3.SS1.p2.4.m4.2.2.4.3" xref="S3.SS1.p2.4.m4.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.2.2.2b" xref="S3.SS1.p2.4.m4.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.4.m4.2.2.5.2" xref="S3.SS1.p2.4.m4.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.5.2.1" xref="S3.SS1.p2.4.m4.2.2.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.5.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.2b"><apply id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2"><times id="S3.SS1.p2.4.m4.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2"></times><apply id="S3.SS1.p2.4.m4.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.3.1.cmml" xref="S3.SS1.p2.4.m4.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.3.2.cmml" xref="S3.SS1.p2.4.m4.2.2.3.2">𝑃</ci><ci id="S3.SS1.p2.4.m4.2.2.3.3.cmml" xref="S3.SS1.p2.4.m4.2.2.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1.1.3">𝑦</ci></apply><apply id="S3.SS1.p2.4.m4.2.2.4.cmml" xref="S3.SS1.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.4.1.cmml" xref="S3.SS1.p2.4.m4.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.4.2.cmml" xref="S3.SS1.p2.4.m4.2.2.4.2">𝑃</ci><ci id="S3.SS1.p2.4.m4.2.2.4.3.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.2c">P_{i}(x|y)P_{i}(y)</annotation></semantics></math> and <math id="S3.SS1.p2.5.m5.2" class="ltx_Math" alttext="P_{i}(y|x)P_{i}(x)" display="inline"><semantics id="S3.SS1.p2.5.m5.2a"><mrow id="S3.SS1.p2.5.m5.2.2" xref="S3.SS1.p2.5.m5.2.2.cmml"><msub id="S3.SS1.p2.5.m5.2.2.3" xref="S3.SS1.p2.5.m5.2.2.3.cmml"><mi id="S3.SS1.p2.5.m5.2.2.3.2" xref="S3.SS1.p2.5.m5.2.2.3.2.cmml">P</mi><mi id="S3.SS1.p2.5.m5.2.2.3.3" xref="S3.SS1.p2.5.m5.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.2.2.2" xref="S3.SS1.p2.5.m5.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.5.m5.2.2.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.1.1.2" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.5.m5.2.2.1.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.2.2.1.1.1.2" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS1.p2.5.m5.2.2.1.1.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.5.m5.2.2.1.1.1.3" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.1.1.3" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.2.2.2a" xref="S3.SS1.p2.5.m5.2.2.2.cmml">​</mo><msub id="S3.SS1.p2.5.m5.2.2.4" xref="S3.SS1.p2.5.m5.2.2.4.cmml"><mi id="S3.SS1.p2.5.m5.2.2.4.2" xref="S3.SS1.p2.5.m5.2.2.4.2.cmml">P</mi><mi id="S3.SS1.p2.5.m5.2.2.4.3" xref="S3.SS1.p2.5.m5.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.2.2.2b" xref="S3.SS1.p2.5.m5.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.5.m5.2.2.5.2" xref="S3.SS1.p2.5.m5.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.5.2.1" xref="S3.SS1.p2.5.m5.2.2.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.2.2.5.2.2" xref="S3.SS1.p2.5.m5.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.2b"><apply id="S3.SS1.p2.5.m5.2.2.cmml" xref="S3.SS1.p2.5.m5.2.2"><times id="S3.SS1.p2.5.m5.2.2.2.cmml" xref="S3.SS1.p2.5.m5.2.2.2"></times><apply id="S3.SS1.p2.5.m5.2.2.3.cmml" xref="S3.SS1.p2.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.2.3.1.cmml" xref="S3.SS1.p2.5.m5.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.2.3.2.cmml" xref="S3.SS1.p2.5.m5.2.2.3.2">𝑃</ci><ci id="S3.SS1.p2.5.m5.2.2.3.3.cmml" xref="S3.SS1.p2.5.m5.2.2.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2">𝑦</ci><ci id="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3">𝑥</ci></apply><apply id="S3.SS1.p2.5.m5.2.2.4.cmml" xref="S3.SS1.p2.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.2.4.1.cmml" xref="S3.SS1.p2.5.m5.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.2.4.2.cmml" xref="S3.SS1.p2.5.m5.2.2.4.2">𝑃</ci><ci id="S3.SS1.p2.5.m5.2.2.4.3.cmml" xref="S3.SS1.p2.5.m5.2.2.4.3">𝑖</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.2c">P_{i}(y|x)P_{i}(x)</annotation></semantics></math> following <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>. We focus on three data heterogeneity settings found in many realistic settings: both label &amp; distribution skew in which the marginal distributions <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="P_{i}(y)" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><msub id="S3.SS1.p2.6.m6.1.2.2" xref="S3.SS1.p2.6.m6.1.2.2.cmml"><mi id="S3.SS1.p2.6.m6.1.2.2.2" xref="S3.SS1.p2.6.m6.1.2.2.2.cmml">P</mi><mi id="S3.SS1.p2.6.m6.1.2.2.3" xref="S3.SS1.p2.6.m6.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.1.2.1" xref="S3.SS1.p2.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.6.m6.1.2.3.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.2.3.2.1" xref="S3.SS1.p2.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.6.m6.1.2.3.2.2" xref="S3.SS1.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><times id="S3.SS1.p2.6.m6.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2.1"></times><apply id="S3.SS1.p2.6.m6.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.2.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2.2">𝑃</ci><ci id="S3.SS1.p2.6.m6.1.2.2.3.cmml" xref="S3.SS1.p2.6.m6.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">P_{i}(y)</annotation></semantics></math> &amp; <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="P_{i}(x)" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><msub id="S3.SS1.p2.7.m7.1.2.2" xref="S3.SS1.p2.7.m7.1.2.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2.2" xref="S3.SS1.p2.7.m7.1.2.2.2.cmml">P</mi><mi id="S3.SS1.p2.7.m7.1.2.2.3" xref="S3.SS1.p2.7.m7.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.1.2.1" xref="S3.SS1.p2.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.7.m7.1.2.3.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.1.2.3.2.1" xref="S3.SS1.p2.7.m7.1.2.cmml">(</mo><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.1.2.3.2.2" xref="S3.SS1.p2.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><times id="S3.SS1.p2.7.m7.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.1"></times><apply id="S3.SS1.p2.7.m7.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2.2">𝑃</ci><ci id="S3.SS1.p2.7.m7.1.2.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">P_{i}(x)</annotation></semantics></math> may vary across clients, respectively, and concept drift in which the conditional distribution <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="P_{i}(x|y)" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><msub id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml">P</mi><mi id="S3.SS1.p2.8.m8.1.1.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.8.m8.1.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.8.m8.1.1.1.1.2" xref="S3.SS1.p2.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.8.m8.1.1.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.1.1.1.2" xref="S3.SS1.p2.8.m8.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS1.p2.8.m8.1.1.1.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p2.8.m8.1.1.1.1.1.3" xref="S3.SS1.p2.8.m8.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.SS1.p2.8.m8.1.1.1.1.3" xref="S3.SS1.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><times id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"></times><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">𝑃</ci><ci id="S3.SS1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">P_{i}(x|y)</annotation></semantics></math> may vary across clients.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>FedL2P: FL of Personalization Strategies</h3>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2310.02420/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>FedL2P’s workflow. For each client, the meta-net (parameterized by <math id="S3.F1.4.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.F1.4.m1.1b"><mi id="S3.F1.4.m1.1.1" xref="S3.F1.4.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.F1.4.m1.1c"><ci id="S3.F1.4.m1.1.1.cmml" xref="S3.F1.4.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.m1.1d">\lambda</annotation></semantics></math>) takes the client meta-data (e.g., local data profile) and outputs hyperparameters. We update <math id="S3.F1.5.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.F1.5.m2.1b"><mi id="S3.F1.5.m2.1.1" xref="S3.F1.5.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.F1.5.m2.1c"><ci id="S3.F1.5.m2.1.1.cmml" xref="S3.F1.5.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.5.m2.1d">\lambda</annotation></semantics></math> by optimizing the meta objective which is the validation loss of the model finetuned with the hyperparameters returned by the meta-net. The updated personalization strategies <math id="S3.F1.6.m3.1" class="ltx_Math" alttext="\lambda^{*}" display="inline"><semantics id="S3.F1.6.m3.1b"><msup id="S3.F1.6.m3.1.1" xref="S3.F1.6.m3.1.1.cmml"><mi id="S3.F1.6.m3.1.1.2" xref="S3.F1.6.m3.1.1.2.cmml">λ</mi><mo id="S3.F1.6.m3.1.1.3" xref="S3.F1.6.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.F1.6.m3.1c"><apply id="S3.F1.6.m3.1.1.cmml" xref="S3.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.F1.6.m3.1.1.1.cmml" xref="S3.F1.6.m3.1.1">superscript</csymbol><ci id="S3.F1.6.m3.1.1.2.cmml" xref="S3.F1.6.m3.1.1.2">𝜆</ci><times id="S3.F1.6.m3.1.1.3.cmml" xref="S3.F1.6.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.6.m3.1d">\lambda^{*}</annotation></semantics></math> from clients are collected/aggregated (via FedAvg) in the server for the next round.
</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We now present our proposed method, FedL2P, to tackle collaborative learning of personalization strategies under data heterogeneity. Our main motivation is that the choice of the hyperparameters for the personalized fine-tuning, such as the learning rates and feature mean and standard deviations (SD) statistics of the batch normalization <cite class="ltx_cite ltx_citemacro_cite">Ioffe and Szegedy (<a href="#bib.bib26" title="" class="ltx_ref">2015</a>)</cite> (BN) layers, is very crucial. Although existing FL-HPO approaches aim to learn these hyperparameters <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_italic">directly<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_upright">1</span></span><span id="footnote1.9" class="ltx_text ltx_font_upright">To our knowledge, no previous FL-HPO works learn BN statistics, crucial for dealing with feature shifts.</span></span></span></span></span> <cite class="ltx_cite ltx_citemacro_cite">Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>); Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>); Khodak et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>, we aim to do it in a meta learning or hypernetwork-like fashion: learning a neural network (dubbed <span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_italic">meta-net</span>) that takes certain profiles of client data (e.g., summary statistics of personalized data) as input and outputs near-optimal hyperparameters. The meta-net is learned collaboratively in an FL manner without sharing local data.
The returned hyperparameters from the meta-net are then deployed in client’s personalized fine-tuning.
The main advantage of this meta-net approach over the direct HPO is that a brand new client needs not do time-consuming HPO, but just gets their optimal hyperpameters by a single feed-forward pass through the meta-net.
Our idea is visualized in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
For each FL round, the latest meta-net is distributed to the participating clients; each client then performs meta learning to update the meta-net; the local updated meta-nets are sent to the server for aggregation. Details of our algorithm are described below.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Hyperparameter Selection.</span> There is a wide range of local training hyperparameters that can be optimized, some of which were explored in previous FL works <cite class="ltx_cite ltx_citemacro_cite">Holly et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>); Zhou et al. (<a href="#bib.bib65" title="" class="ltx_ref">2023</a>); Khodak et al. (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>.
As local training is often a costly process, we narrowed it down to two main sets of hyperparameters based on previous works that showed promising results in dealing with non-IID data: <span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_italic">BN hyperparameters</span> and <span id="S3.SS2.p2.1.3" class="ltx_text ltx_font_italic">selective update hyperparameters</span>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.12" class="ltx_p"><span id="S3.SS2.p3.12.1" class="ltx_text ltx_font_bold">Batch Normalization Hyperparameters.</span> The first set of hyperparameters involves BN and explicitly deals with feature shift. Notably, FedBN <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021c</a>)</cite> proposed keeping the BN layers local and the other layers global to better handle feature shift across clients; BN has found success at mitigating domain shifts in various domain adaptation tasks <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib36" title="" class="ltx_ref">2016</a>); Chang et al. (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite> and can be formulated as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="g(x)=\frac{x-\hat{\mu}}{\sqrt{\hat{\sigma}^{2}+\epsilon}}*\gamma+\delta" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><mrow id="S3.E1.m1.1.2.2" xref="S3.E1.m1.1.2.2.cmml"><mi id="S3.E1.m1.1.2.2.2" xref="S3.E1.m1.1.2.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.2.2.1" xref="S3.E1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.1.2.2.3.2" xref="S3.E1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.2.2.3.2.1" xref="S3.E1.m1.1.2.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.1.2.2.3.2.2" xref="S3.E1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.2.1" xref="S3.E1.m1.1.2.1.cmml">=</mo><mrow id="S3.E1.m1.1.2.3" xref="S3.E1.m1.1.2.3.cmml"><mrow id="S3.E1.m1.1.2.3.2" xref="S3.E1.m1.1.2.3.2.cmml"><mfrac id="S3.E1.m1.1.2.3.2.2" xref="S3.E1.m1.1.2.3.2.2.cmml"><mrow id="S3.E1.m1.1.2.3.2.2.2" xref="S3.E1.m1.1.2.3.2.2.2.cmml"><mi id="S3.E1.m1.1.2.3.2.2.2.2" xref="S3.E1.m1.1.2.3.2.2.2.2.cmml">x</mi><mo id="S3.E1.m1.1.2.3.2.2.2.1" xref="S3.E1.m1.1.2.3.2.2.2.1.cmml">−</mo><mover accent="true" id="S3.E1.m1.1.2.3.2.2.2.3" xref="S3.E1.m1.1.2.3.2.2.2.3.cmml"><mi id="S3.E1.m1.1.2.3.2.2.2.3.2" xref="S3.E1.m1.1.2.3.2.2.2.3.2.cmml">μ</mi><mo id="S3.E1.m1.1.2.3.2.2.2.3.1" xref="S3.E1.m1.1.2.3.2.2.2.3.1.cmml">^</mo></mover></mrow><msqrt id="S3.E1.m1.1.2.3.2.2.3" xref="S3.E1.m1.1.2.3.2.2.3.cmml"><mrow id="S3.E1.m1.1.2.3.2.2.3.2" xref="S3.E1.m1.1.2.3.2.2.3.2.cmml"><msup id="S3.E1.m1.1.2.3.2.2.3.2.2" xref="S3.E1.m1.1.2.3.2.2.3.2.2.cmml"><mover accent="true" id="S3.E1.m1.1.2.3.2.2.3.2.2.2" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2.cmml"><mi id="S3.E1.m1.1.2.3.2.2.3.2.2.2.2" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2.2.cmml">σ</mi><mo id="S3.E1.m1.1.2.3.2.2.3.2.2.2.1" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2.1.cmml">^</mo></mover><mn id="S3.E1.m1.1.2.3.2.2.3.2.2.3" xref="S3.E1.m1.1.2.3.2.2.3.2.2.3.cmml">2</mn></msup><mo id="S3.E1.m1.1.2.3.2.2.3.2.1" xref="S3.E1.m1.1.2.3.2.2.3.2.1.cmml">+</mo><mi id="S3.E1.m1.1.2.3.2.2.3.2.3" xref="S3.E1.m1.1.2.3.2.2.3.2.3.cmml">ϵ</mi></mrow></msqrt></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.1.2.3.2.1" xref="S3.E1.m1.1.2.3.2.1.cmml">∗</mo><mi id="S3.E1.m1.1.2.3.2.3" xref="S3.E1.m1.1.2.3.2.3.cmml">γ</mi></mrow><mo id="S3.E1.m1.1.2.3.1" xref="S3.E1.m1.1.2.3.1.cmml">+</mo><mi id="S3.E1.m1.1.2.3.3" xref="S3.E1.m1.1.2.3.3.cmml">δ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><eq id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2.1"></eq><apply id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2.2"><times id="S3.E1.m1.1.2.2.1.cmml" xref="S3.E1.m1.1.2.2.1"></times><ci id="S3.E1.m1.1.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2">𝑔</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑥</ci></apply><apply id="S3.E1.m1.1.2.3.cmml" xref="S3.E1.m1.1.2.3"><plus id="S3.E1.m1.1.2.3.1.cmml" xref="S3.E1.m1.1.2.3.1"></plus><apply id="S3.E1.m1.1.2.3.2.cmml" xref="S3.E1.m1.1.2.3.2"><times id="S3.E1.m1.1.2.3.2.1.cmml" xref="S3.E1.m1.1.2.3.2.1"></times><apply id="S3.E1.m1.1.2.3.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2"><divide id="S3.E1.m1.1.2.3.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2"></divide><apply id="S3.E1.m1.1.2.3.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.2"><minus id="S3.E1.m1.1.2.3.2.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2.2.1"></minus><ci id="S3.E1.m1.1.2.3.2.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.2.2">𝑥</ci><apply id="S3.E1.m1.1.2.3.2.2.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.2.3"><ci id="S3.E1.m1.1.2.3.2.2.2.3.1.cmml" xref="S3.E1.m1.1.2.3.2.2.2.3.1">^</ci><ci id="S3.E1.m1.1.2.3.2.2.2.3.2.cmml" xref="S3.E1.m1.1.2.3.2.2.2.3.2">𝜇</ci></apply></apply><apply id="S3.E1.m1.1.2.3.2.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.3"><root id="S3.E1.m1.1.2.3.2.2.3a.cmml" xref="S3.E1.m1.1.2.3.2.2.3"></root><apply id="S3.E1.m1.1.2.3.2.2.3.2.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2"><plus id="S3.E1.m1.1.2.3.2.2.3.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.1"></plus><apply id="S3.E1.m1.1.2.3.2.2.3.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.3.2.2.3.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2">superscript</csymbol><apply id="S3.E1.m1.1.2.3.2.2.3.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2"><ci id="S3.E1.m1.1.2.3.2.2.3.2.2.2.1.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2.1">^</ci><ci id="S3.E1.m1.1.2.3.2.2.3.2.2.2.2.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2.2.2">𝜎</ci></apply><cn type="integer" id="S3.E1.m1.1.2.3.2.2.3.2.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.2.3">2</cn></apply><ci id="S3.E1.m1.1.2.3.2.2.3.2.3.cmml" xref="S3.E1.m1.1.2.3.2.2.3.2.3">italic-ϵ</ci></apply></apply></apply><ci id="S3.E1.m1.1.2.3.2.3.cmml" xref="S3.E1.m1.1.2.3.2.3">𝛾</ci></apply><ci id="S3.E1.m1.1.2.3.3.cmml" xref="S3.E1.m1.1.2.3.3">𝛿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">g(x)=\frac{x-\hat{\mu}}{\sqrt{\hat{\sigma}^{2}+\epsilon}}*\gamma+\delta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.11" class="ltx_p">where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">g</annotation></semantics></math> is a BN layer, <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">x</annotation></semantics></math> is its input features, (<math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\hat{\mu}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mover accent="true" id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">μ</mi><mo id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><ci id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1">^</ci><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\hat{\mu}</annotation></semantics></math>, <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\hat{\sigma}^{2}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">σ</mi><mo id="S3.SS2.p3.4.m4.1.1.2.1" xref="S3.SS2.p3.4.m4.1.1.2.1.cmml">^</mo></mover><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2"><ci id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.1">^</ci><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝜎</ci></apply><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\hat{\sigma}^{2}</annotation></semantics></math>) are the estimated running mean, variance, and <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\epsilon</annotation></semantics></math> is used for numerical stability. During training, the batch statistics <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="E(x)" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.2" xref="S3.SS2.p3.6.m6.1.2.cmml"><mi id="S3.SS2.p3.6.m6.1.2.2" xref="S3.SS2.p3.6.m6.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.6.m6.1.2.1" xref="S3.SS2.p3.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.6.m6.1.2.3.2" xref="S3.SS2.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.6.m6.1.2.3.2.1" xref="S3.SS2.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p3.6.m6.1.2.3.2.2" xref="S3.SS2.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.2.cmml" xref="S3.SS2.p3.6.m6.1.2"><times id="S3.SS2.p3.6.m6.1.2.1.cmml" xref="S3.SS2.p3.6.m6.1.2.1"></times><ci id="S3.SS2.p3.6.m6.1.2.2.cmml" xref="S3.SS2.p3.6.m6.1.2.2">𝐸</ci><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">E(x)</annotation></semantics></math> and <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="Var(x)" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.2" xref="S3.SS2.p3.7.m7.1.2.cmml"><mi id="S3.SS2.p3.7.m7.1.2.2" xref="S3.SS2.p3.7.m7.1.2.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m7.1.2.1" xref="S3.SS2.p3.7.m7.1.2.1.cmml">​</mo><mi id="S3.SS2.p3.7.m7.1.2.3" xref="S3.SS2.p3.7.m7.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m7.1.2.1a" xref="S3.SS2.p3.7.m7.1.2.1.cmml">​</mo><mi id="S3.SS2.p3.7.m7.1.2.4" xref="S3.SS2.p3.7.m7.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m7.1.2.1b" xref="S3.SS2.p3.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.7.m7.1.2.5.2" xref="S3.SS2.p3.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.7.m7.1.2.5.2.1" xref="S3.SS2.p3.7.m7.1.2.cmml">(</mo><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p3.7.m7.1.2.5.2.2" xref="S3.SS2.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.2.cmml" xref="S3.SS2.p3.7.m7.1.2"><times id="S3.SS2.p3.7.m7.1.2.1.cmml" xref="S3.SS2.p3.7.m7.1.2.1"></times><ci id="S3.SS2.p3.7.m7.1.2.2.cmml" xref="S3.SS2.p3.7.m7.1.2.2">𝑉</ci><ci id="S3.SS2.p3.7.m7.1.2.3.cmml" xref="S3.SS2.p3.7.m7.1.2.3">𝑎</ci><ci id="S3.SS2.p3.7.m7.1.2.4.cmml" xref="S3.SS2.p3.7.m7.1.2.4">𝑟</ci><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">Var(x)</annotation></semantics></math> are used instead, keeping running estimates of them, <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="\hat{\mu}" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mover accent="true" id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">μ</mi><mo id="S3.SS2.p3.8.m8.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><ci id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1">^</ci><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">\hat{\mu}</annotation></semantics></math> and <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="\hat{\sigma}^{2}" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><msup id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><mover accent="true" id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2.2" xref="S3.SS2.p3.9.m9.1.1.2.2.cmml">σ</mi><mo id="S3.SS2.p3.9.m9.1.1.2.1" xref="S3.SS2.p3.9.m9.1.1.2.1.cmml">^</mo></mover><mn id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">superscript</csymbol><apply id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2"><ci id="S3.SS2.p3.9.m9.1.1.2.1.cmml" xref="S3.SS2.p3.9.m9.1.1.2.1">^</ci><ci id="S3.SS2.p3.9.m9.1.1.2.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2.2">𝜎</ci></apply><cn type="integer" id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">\hat{\sigma}^{2}</annotation></semantics></math>. During inference, these estimates are used<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>When the running mean <math id="footnote2.m1.1" class="ltx_Math" alttext="\&amp;" display="inline"><semantics id="footnote2.m1.1b"><mo id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><and id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">\&amp;</annotation></semantics></math> variance are not tracked, the batch statistics is used in both training and inference.</span></span></span>. Both <math id="S3.SS2.p3.10.m10.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS2.p3.10.m10.1a"><mi id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><ci id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">\gamma</annotation></semantics></math> and <math id="S3.SS2.p3.11.m11.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS2.p3.11.m11.1a"><mi id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><ci id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">\delta</annotation></semantics></math> are learnable parameters used to scale and shift the normalized features.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Although deploying local BN layers is useful to counteract the drawbacks of feature shift, using global BN layers is often beneficial for local fine-tuning in cases where the feature shift is minimal as it helps speed-up convergence and reduces overfitting. Hence, we propose learning a hyperparameter <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\beta</annotation></semantics></math> for each BN layer as follows:
</p>
<table id="A6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E2.m1.36" class="ltx_math_unparsed" alttext="\displaystyle\vspace{-1.0em}\begin{split}\hat{\mu}=(1-\beta)*\hat{\mu}_{pt}+\beta*\hat{\mu}_{i},\ \ \ \ \ \ \ \ \hat{\sigma}^{2}=(1-\beta)*\hat{\sigma}^{2}_{pt}+\beta*\hat{\sigma}^{2}_{i}\end{split}" display="inline"><semantics id="S3.E2.m1.36a"><mtable id="S3.E2.m1.36.36.2"><mtr id="S3.E2.m1.36.36.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.36.36.2b"><mrow id="S3.E2.m1.36.36.2.36.36.36.36"><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1"><mi id="S3.E2.m1.1.1.1.1.1.1.2">μ</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1">^</mo></mover><mo id="S3.E2.m1.2.2.2.2.2.2">=</mo><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1.1"><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1.1.1"><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1.1.1.1.1"><mo stretchy="false" id="S3.E2.m1.3.3.3.3.3.3">(</mo><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1.1.1.1.1.1"><mn id="S3.E2.m1.4.4.4.4.4.4">1</mn><mo id="S3.E2.m1.5.5.5.5.5.5">−</mo><mi id="S3.E2.m1.6.6.6.6.6.6">β</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.7.7.7.7.7.7">)</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.8.8.8.8.8.8">∗</mo><msub id="S3.E2.m1.35.35.1.35.35.35.35.1.1.1.2"><mover accent="true" id="S3.E2.m1.9.9.9.9.9.9"><mi id="S3.E2.m1.9.9.9.9.9.9.2">μ</mi><mo id="S3.E2.m1.9.9.9.9.9.9.1">^</mo></mover><mrow id="S3.E2.m1.10.10.10.10.10.10.1"><mi id="S3.E2.m1.10.10.10.10.10.10.1.2">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.10.10.10.10.1.1">​</mo><mi id="S3.E2.m1.10.10.10.10.10.10.1.3">t</mi></mrow></msub></mrow><mo id="S3.E2.m1.11.11.11.11.11.11">+</mo><mrow id="S3.E2.m1.35.35.1.35.35.35.35.1.1.2"><mi id="S3.E2.m1.12.12.12.12.12.12">β</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.13.13.13.13.13.13">∗</mo><msub id="S3.E2.m1.35.35.1.35.35.35.35.1.1.2.1"><mover accent="true" id="S3.E2.m1.14.14.14.14.14.14"><mi id="S3.E2.m1.14.14.14.14.14.14.2">μ</mi><mo id="S3.E2.m1.14.14.14.14.14.14.1">^</mo></mover><mi id="S3.E2.m1.15.15.15.15.15.15.1">i</mi></msub></mrow></mrow></mrow><mo rspace="4.167em" id="S3.E2.m1.16.16.16.16.16.16">,</mo><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2"><msup id="S3.E2.m1.36.36.2.36.36.36.36.2.2"><mover accent="true" id="S3.E2.m1.17.17.17.17.17.17"><mi id="S3.E2.m1.17.17.17.17.17.17.2">σ</mi><mo id="S3.E2.m1.17.17.17.17.17.17.1">^</mo></mover><mn id="S3.E2.m1.18.18.18.18.18.18.1">2</mn></msup><mo id="S3.E2.m1.19.19.19.19.19.19">=</mo><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2.1"><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2.1.1"><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2.1.1.1.1"><mo stretchy="false" id="S3.E2.m1.20.20.20.20.20.20">(</mo><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2.1.1.1.1.1"><mn id="S3.E2.m1.21.21.21.21.21.21">1</mn><mo id="S3.E2.m1.22.22.22.22.22.22">−</mo><mi id="S3.E2.m1.23.23.23.23.23.23">β</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.24.24.24.24.24.24">)</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.25.25.25.25.25.25">∗</mo><msubsup id="S3.E2.m1.36.36.2.36.36.36.36.2.1.1.2"><mover accent="true" id="S3.E2.m1.26.26.26.26.26.26"><mi id="S3.E2.m1.26.26.26.26.26.26.2">σ</mi><mo id="S3.E2.m1.26.26.26.26.26.26.1">^</mo></mover><mrow id="S3.E2.m1.28.28.28.28.28.28.1"><mi id="S3.E2.m1.28.28.28.28.28.28.1.2">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.28.28.28.28.28.28.1.1">​</mo><mi id="S3.E2.m1.28.28.28.28.28.28.1.3">t</mi></mrow><mn id="S3.E2.m1.27.27.27.27.27.27.1">2</mn></msubsup></mrow><mo id="S3.E2.m1.29.29.29.29.29.29">+</mo><mrow id="S3.E2.m1.36.36.2.36.36.36.36.2.1.2"><mi id="S3.E2.m1.30.30.30.30.30.30">β</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.31.31.31.31.31.31">∗</mo><msubsup id="S3.E2.m1.36.36.2.36.36.36.36.2.1.2.1"><mover accent="true" id="S3.E2.m1.32.32.32.32.32.32"><mi id="S3.E2.m1.32.32.32.32.32.32.2">σ</mi><mo id="S3.E2.m1.32.32.32.32.32.32.1">^</mo></mover><mi id="S3.E2.m1.34.34.34.34.34.34.1">i</mi><mn id="S3.E2.m1.33.33.33.33.33.33.1">2</mn></msubsup></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E2.m1.36b">\displaystyle\vspace{-1.0em}\begin{split}\hat{\mu}=(1-\beta)*\hat{\mu}_{pt}+\beta*\hat{\mu}_{i},\ \ \ \ \ \ \ \ \hat{\sigma}^{2}=(1-\beta)*\hat{\sigma}^{2}_{pt}+\beta*\hat{\sigma}^{2}_{i}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.8" class="ltx_p">where <math id="S3.SS2.p4.2.m1.1" class="ltx_Math" alttext="\hat{\mu}_{pt}" display="inline"><semantics id="S3.SS2.p4.2.m1.1a"><msub id="S3.SS2.p4.2.m1.1.1" xref="S3.SS2.p4.2.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p4.2.m1.1.1.2" xref="S3.SS2.p4.2.m1.1.1.2.cmml"><mi id="S3.SS2.p4.2.m1.1.1.2.2" xref="S3.SS2.p4.2.m1.1.1.2.2.cmml">μ</mi><mo id="S3.SS2.p4.2.m1.1.1.2.1" xref="S3.SS2.p4.2.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p4.2.m1.1.1.3" xref="S3.SS2.p4.2.m1.1.1.3.cmml"><mi id="S3.SS2.p4.2.m1.1.1.3.2" xref="S3.SS2.p4.2.m1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m1.1.1.3.1" xref="S3.SS2.p4.2.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m1.1.1.3.3" xref="S3.SS2.p4.2.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m1.1b"><apply id="S3.SS2.p4.2.m1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1">subscript</csymbol><apply id="S3.SS2.p4.2.m1.1.1.2.cmml" xref="S3.SS2.p4.2.m1.1.1.2"><ci id="S3.SS2.p4.2.m1.1.1.2.1.cmml" xref="S3.SS2.p4.2.m1.1.1.2.1">^</ci><ci id="S3.SS2.p4.2.m1.1.1.2.2.cmml" xref="S3.SS2.p4.2.m1.1.1.2.2">𝜇</ci></apply><apply id="S3.SS2.p4.2.m1.1.1.3.cmml" xref="S3.SS2.p4.2.m1.1.1.3"><times id="S3.SS2.p4.2.m1.1.1.3.1.cmml" xref="S3.SS2.p4.2.m1.1.1.3.1"></times><ci id="S3.SS2.p4.2.m1.1.1.3.2.cmml" xref="S3.SS2.p4.2.m1.1.1.3.2">𝑝</ci><ci id="S3.SS2.p4.2.m1.1.1.3.3.cmml" xref="S3.SS2.p4.2.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m1.1c">\hat{\mu}_{pt}</annotation></semantics></math> and <math id="S3.SS2.p4.3.m2.1" class="ltx_Math" alttext="\hat{\sigma}^{2}_{pt}" display="inline"><semantics id="S3.SS2.p4.3.m2.1a"><msubsup id="S3.SS2.p4.3.m2.1.1" xref="S3.SS2.p4.3.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p4.3.m2.1.1.2.2" xref="S3.SS2.p4.3.m2.1.1.2.2.cmml"><mi id="S3.SS2.p4.3.m2.1.1.2.2.2" xref="S3.SS2.p4.3.m2.1.1.2.2.2.cmml">σ</mi><mo id="S3.SS2.p4.3.m2.1.1.2.2.1" xref="S3.SS2.p4.3.m2.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p4.3.m2.1.1.3" xref="S3.SS2.p4.3.m2.1.1.3.cmml"><mi id="S3.SS2.p4.3.m2.1.1.3.2" xref="S3.SS2.p4.3.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.3.m2.1.1.3.1" xref="S3.SS2.p4.3.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.3.m2.1.1.3.3" xref="S3.SS2.p4.3.m2.1.1.3.3.cmml">t</mi></mrow><mn id="S3.SS2.p4.3.m2.1.1.2.3" xref="S3.SS2.p4.3.m2.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m2.1b"><apply id="S3.SS2.p4.3.m2.1.1.cmml" xref="S3.SS2.p4.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m2.1.1.1.cmml" xref="S3.SS2.p4.3.m2.1.1">subscript</csymbol><apply id="S3.SS2.p4.3.m2.1.1.2.cmml" xref="S3.SS2.p4.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m2.1.1.2.1.cmml" xref="S3.SS2.p4.3.m2.1.1">superscript</csymbol><apply id="S3.SS2.p4.3.m2.1.1.2.2.cmml" xref="S3.SS2.p4.3.m2.1.1.2.2"><ci id="S3.SS2.p4.3.m2.1.1.2.2.1.cmml" xref="S3.SS2.p4.3.m2.1.1.2.2.1">^</ci><ci id="S3.SS2.p4.3.m2.1.1.2.2.2.cmml" xref="S3.SS2.p4.3.m2.1.1.2.2.2">𝜎</ci></apply><cn type="integer" id="S3.SS2.p4.3.m2.1.1.2.3.cmml" xref="S3.SS2.p4.3.m2.1.1.2.3">2</cn></apply><apply id="S3.SS2.p4.3.m2.1.1.3.cmml" xref="S3.SS2.p4.3.m2.1.1.3"><times id="S3.SS2.p4.3.m2.1.1.3.1.cmml" xref="S3.SS2.p4.3.m2.1.1.3.1"></times><ci id="S3.SS2.p4.3.m2.1.1.3.2.cmml" xref="S3.SS2.p4.3.m2.1.1.3.2">𝑝</ci><ci id="S3.SS2.p4.3.m2.1.1.3.3.cmml" xref="S3.SS2.p4.3.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m2.1c">\hat{\sigma}^{2}_{pt}</annotation></semantics></math> are the estimated running mean and variance by the given pretrained model; <math id="S3.SS2.p4.4.m3.1" class="ltx_Math" alttext="\hat{\mu}_{i}" display="inline"><semantics id="S3.SS2.p4.4.m3.1a"><msub id="S3.SS2.p4.4.m3.1.1" xref="S3.SS2.p4.4.m3.1.1.cmml"><mover accent="true" id="S3.SS2.p4.4.m3.1.1.2" xref="S3.SS2.p4.4.m3.1.1.2.cmml"><mi id="S3.SS2.p4.4.m3.1.1.2.2" xref="S3.SS2.p4.4.m3.1.1.2.2.cmml">μ</mi><mo id="S3.SS2.p4.4.m3.1.1.2.1" xref="S3.SS2.p4.4.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p4.4.m3.1.1.3" xref="S3.SS2.p4.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m3.1b"><apply id="S3.SS2.p4.4.m3.1.1.cmml" xref="S3.SS2.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m3.1.1.1.cmml" xref="S3.SS2.p4.4.m3.1.1">subscript</csymbol><apply id="S3.SS2.p4.4.m3.1.1.2.cmml" xref="S3.SS2.p4.4.m3.1.1.2"><ci id="S3.SS2.p4.4.m3.1.1.2.1.cmml" xref="S3.SS2.p4.4.m3.1.1.2.1">^</ci><ci id="S3.SS2.p4.4.m3.1.1.2.2.cmml" xref="S3.SS2.p4.4.m3.1.1.2.2">𝜇</ci></apply><ci id="S3.SS2.p4.4.m3.1.1.3.cmml" xref="S3.SS2.p4.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m3.1c">\hat{\mu}_{i}</annotation></semantics></math> and <math id="S3.SS2.p4.5.m4.1" class="ltx_Math" alttext="\hat{\sigma}^{2}_{i}" display="inline"><semantics id="S3.SS2.p4.5.m4.1a"><msubsup id="S3.SS2.p4.5.m4.1.1" xref="S3.SS2.p4.5.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p4.5.m4.1.1.2.2" xref="S3.SS2.p4.5.m4.1.1.2.2.cmml"><mi id="S3.SS2.p4.5.m4.1.1.2.2.2" xref="S3.SS2.p4.5.m4.1.1.2.2.2.cmml">σ</mi><mo id="S3.SS2.p4.5.m4.1.1.2.2.1" xref="S3.SS2.p4.5.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p4.5.m4.1.1.3" xref="S3.SS2.p4.5.m4.1.1.3.cmml">i</mi><mn id="S3.SS2.p4.5.m4.1.1.2.3" xref="S3.SS2.p4.5.m4.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m4.1b"><apply id="S3.SS2.p4.5.m4.1.1.cmml" xref="S3.SS2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m4.1.1.1.cmml" xref="S3.SS2.p4.5.m4.1.1">subscript</csymbol><apply id="S3.SS2.p4.5.m4.1.1.2.cmml" xref="S3.SS2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m4.1.1.2.1.cmml" xref="S3.SS2.p4.5.m4.1.1">superscript</csymbol><apply id="S3.SS2.p4.5.m4.1.1.2.2.cmml" xref="S3.SS2.p4.5.m4.1.1.2.2"><ci id="S3.SS2.p4.5.m4.1.1.2.2.1.cmml" xref="S3.SS2.p4.5.m4.1.1.2.2.1">^</ci><ci id="S3.SS2.p4.5.m4.1.1.2.2.2.cmml" xref="S3.SS2.p4.5.m4.1.1.2.2.2">𝜎</ci></apply><cn type="integer" id="S3.SS2.p4.5.m4.1.1.2.3.cmml" xref="S3.SS2.p4.5.m4.1.1.2.3">2</cn></apply><ci id="S3.SS2.p4.5.m4.1.1.3.cmml" xref="S3.SS2.p4.5.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m4.1c">\hat{\sigma}^{2}_{i}</annotation></semantics></math> are the running mean and variance estimated by the client. When <math id="S3.SS2.p4.6.m5.1" class="ltx_Math" alttext="\beta\!\rightarrow\!0" display="inline"><semantics id="S3.SS2.p4.6.m5.1a"><mrow id="S3.SS2.p4.6.m5.1.1" xref="S3.SS2.p4.6.m5.1.1.cmml"><mi id="S3.SS2.p4.6.m5.1.1.2" xref="S3.SS2.p4.6.m5.1.1.2.cmml">β</mi><mo lspace="0.108em" rspace="0.108em" stretchy="false" id="S3.SS2.p4.6.m5.1.1.1" xref="S3.SS2.p4.6.m5.1.1.1.cmml">→</mo><mn id="S3.SS2.p4.6.m5.1.1.3" xref="S3.SS2.p4.6.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m5.1b"><apply id="S3.SS2.p4.6.m5.1.1.cmml" xref="S3.SS2.p4.6.m5.1.1"><ci id="S3.SS2.p4.6.m5.1.1.1.cmml" xref="S3.SS2.p4.6.m5.1.1.1">→</ci><ci id="S3.SS2.p4.6.m5.1.1.2.cmml" xref="S3.SS2.p4.6.m5.1.1.2">𝛽</ci><cn type="integer" id="S3.SS2.p4.6.m5.1.1.3.cmml" xref="S3.SS2.p4.6.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m5.1c">\beta\!\rightarrow\!0</annotation></semantics></math>, the client solely uses pretrained model’s BN statistics and when <math id="S3.SS2.p4.7.m6.1" class="ltx_Math" alttext="\beta\!\rightarrow\!1" display="inline"><semantics id="S3.SS2.p4.7.m6.1a"><mrow id="S3.SS2.p4.7.m6.1.1" xref="S3.SS2.p4.7.m6.1.1.cmml"><mi id="S3.SS2.p4.7.m6.1.1.2" xref="S3.SS2.p4.7.m6.1.1.2.cmml">β</mi><mo lspace="0.108em" rspace="0.108em" stretchy="false" id="S3.SS2.p4.7.m6.1.1.1" xref="S3.SS2.p4.7.m6.1.1.1.cmml">→</mo><mn id="S3.SS2.p4.7.m6.1.1.3" xref="S3.SS2.p4.7.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m6.1b"><apply id="S3.SS2.p4.7.m6.1.1.cmml" xref="S3.SS2.p4.7.m6.1.1"><ci id="S3.SS2.p4.7.m6.1.1.1.cmml" xref="S3.SS2.p4.7.m6.1.1.1">→</ci><ci id="S3.SS2.p4.7.m6.1.1.2.cmml" xref="S3.SS2.p4.7.m6.1.1.2">𝛽</ci><cn type="integer" id="S3.SS2.p4.7.m6.1.1.3.cmml" xref="S3.SS2.p4.7.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m6.1c">\beta\!\rightarrow\!1</annotation></semantics></math>, it uses its local statistics to normalize features. Thus <math id="S3.SS2.p4.8.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.p4.8.m7.1a"><mi id="S3.SS2.p4.8.m7.1.1" xref="S3.SS2.p4.8.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m7.1b"><ci id="S3.SS2.p4.8.m7.1.1.cmml" xref="S3.SS2.p4.8.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m7.1c">\beta</annotation></semantics></math> indicates the degree in which the client should utilize its own BN statistics against pretrained model’s, to handle the feature shift in its local data distribution.</p>
</div>
<figure id="S3.SS2.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:225.5pt;">
<figure id="alg1" class="ltx_float ltx_figure_panel ltx_minipage ltx_align_top ltx_framed ltx_framed_top" style="width:225.5pt;">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.16.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedL2P: FL of meta-nets for Personalization Hyperparameters</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.11" class="ltx_p ltx_figure_panel"><span id="alg1.11.11" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:<span id="alg1.11.11.11" class="ltx_text ltx_font_medium"> <span id="alg1.11.11.11.11" class="ltx_text" style="font-size:89%;">Pretrained global model <math id="alg1.1.1.1.1.m1.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="alg1.1.1.1.1.m1.1a"><msub id="alg1.1.1.1.1.m1.1.1" xref="alg1.1.1.1.1.m1.1.1.cmml"><mi id="alg1.1.1.1.1.m1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.1.1.1.1.m1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.1.m1.1b"><apply id="alg1.1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.2">𝜃</ci><ci id="alg1.1.1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.1.m1.1c">\theta_{g}</annotation></semantics></math> with <math id="alg1.2.2.2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.2.2.2.2.m2.1a"><mi id="alg1.2.2.2.2.m2.1.1" xref="alg1.2.2.2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.2.m2.1b"><ci id="alg1.2.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.2.m2.1c">M</annotation></semantics></math> layers and <math id="alg1.3.3.3.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.3.3.3.3.m3.1a"><mi id="alg1.3.3.3.3.m3.1.1" xref="alg1.3.3.3.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.3.3.m3.1b"><ci id="alg1.3.3.3.3.m3.1.1.cmml" xref="alg1.3.3.3.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.3.3.m3.1c">B</annotation></semantics></math> BN layers, each has <math id="alg1.4.4.4.4.m4.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.4.4.4.4.m4.1a"><mi id="alg1.4.4.4.4.m4.1.1" xref="alg1.4.4.4.4.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.4.4.m4.1b"><ci id="alg1.4.4.4.4.m4.1.1.cmml" xref="alg1.4.4.4.4.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.4.4.m4.1c">J</annotation></semantics></math> input channels. Fraction ratio <math id="alg1.5.5.5.5.m5.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.5.5.5.5.m5.1a"><mi id="alg1.5.5.5.5.m5.1.1" xref="alg1.5.5.5.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.5.5.5.5.m5.1b"><ci id="alg1.5.5.5.5.m5.1.1.cmml" xref="alg1.5.5.5.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.5.5.m5.1c">r</annotation></semantics></math>. Total no. of clients <math id="alg1.6.6.6.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.6.6.6.6.m6.1a"><mi id="alg1.6.6.6.6.m6.1.1" xref="alg1.6.6.6.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.6.6.6.6.m6.1b"><ci id="alg1.6.6.6.6.m6.1.1.cmml" xref="alg1.6.6.6.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.6.6.m6.1c">C</annotation></semantics></math>. No. of update iterations <math id="alg1.7.7.7.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.7.7.7.7.m7.1a"><mi id="alg1.7.7.7.7.m7.1.1" xref="alg1.7.7.7.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.7.7.7.7.m7.1b"><ci id="alg1.7.7.7.7.m7.1.1.cmml" xref="alg1.7.7.7.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.7.7.m7.1c">K</annotation></semantics></math>. Training loss <math id="alg1.8.8.8.8.m8.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="alg1.8.8.8.8.m8.1a"><msub id="alg1.8.8.8.8.m8.1.1" xref="alg1.8.8.8.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.8.8.8.8.m8.1.1.2" xref="alg1.8.8.8.8.m8.1.1.2.cmml">ℒ</mi><mi id="alg1.8.8.8.8.m8.1.1.3" xref="alg1.8.8.8.8.m8.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.8.8.8.m8.1b"><apply id="alg1.8.8.8.8.m8.1.1.cmml" xref="alg1.8.8.8.8.m8.1.1"><csymbol cd="ambiguous" id="alg1.8.8.8.8.m8.1.1.1.cmml" xref="alg1.8.8.8.8.m8.1.1">subscript</csymbol><ci id="alg1.8.8.8.8.m8.1.1.2.cmml" xref="alg1.8.8.8.8.m8.1.1.2">ℒ</ci><ci id="alg1.8.8.8.8.m8.1.1.3.cmml" xref="alg1.8.8.8.8.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.8.8.m8.1c">\mathcal{L}_{T}</annotation></semantics></math> and validation loss <math id="alg1.9.9.9.9.m9.1" class="ltx_Math" alttext="\mathcal{L}_{V}" display="inline"><semantics id="alg1.9.9.9.9.m9.1a"><msub id="alg1.9.9.9.9.m9.1.1" xref="alg1.9.9.9.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.9.9.9.9.m9.1.1.2" xref="alg1.9.9.9.9.m9.1.1.2.cmml">ℒ</mi><mi id="alg1.9.9.9.9.m9.1.1.3" xref="alg1.9.9.9.9.m9.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.9.9.9.9.m9.1b"><apply id="alg1.9.9.9.9.m9.1.1.cmml" xref="alg1.9.9.9.9.m9.1.1"><csymbol cd="ambiguous" id="alg1.9.9.9.9.m9.1.1.1.cmml" xref="alg1.9.9.9.9.m9.1.1">subscript</csymbol><ci id="alg1.9.9.9.9.m9.1.1.2.cmml" xref="alg1.9.9.9.9.m9.1.1.2">ℒ</ci><ci id="alg1.9.9.9.9.m9.1.1.3.cmml" xref="alg1.9.9.9.9.m9.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.9.9.m9.1c">\mathcal{L}_{V}</annotation></semantics></math>. <math id="alg1.10.10.10.10.m10.1" class="ltx_Math" alttext="\zeta" display="inline"><semantics id="alg1.10.10.10.10.m10.1a"><mi id="alg1.10.10.10.10.m10.1.1" xref="alg1.10.10.10.10.m10.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="alg1.10.10.10.10.m10.1b"><ci id="alg1.10.10.10.10.m10.1.1.cmml" xref="alg1.10.10.10.10.m10.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.10.10.m10.1c">\zeta</annotation></semantics></math> is the learning rate for <math id="alg1.11.11.11.11.m11.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.11.11.11.11.m11.1a"><mi id="alg1.11.11.11.11.m11.1.1" xref="alg1.11.11.11.11.m11.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.11.11.11.11.m11.1b"><ci id="alg1.11.11.11.11.m11.1.1.cmml" xref="alg1.11.11.11.11.m11.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.11.11.m11.1c">\lambda</annotation></semantics></math>.</span></span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.17" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="font-size:80%;">  initialize </span><math id="alg1.l1.m1.3" class="ltx_Math" alttext="\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mi mathsize="80%" id="alg1.l1.m1.3.3.4" xref="alg1.l1.m1.3.3.4.cmml">λ</mi><mo mathsize="80%" id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml">=</mo><mrow id="alg1.l1.m1.3.3.2.2" xref="alg1.l1.m1.3.3.2.3.cmml"><mo maxsize="80%" minsize="80%" id="alg1.l1.m1.3.3.2.2.3" xref="alg1.l1.m1.3.3.2.3.cmml">{</mo><msub id="alg1.l1.m1.2.2.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.cmml"><mi mathsize="80%" id="alg1.l1.m1.2.2.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.2.cmml">𝒘</mi><mrow id="alg1.l1.m1.2.2.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.3.cmml"><mi mathsize="80%" id="alg1.l1.m1.2.2.1.1.1.3.2" xref="alg1.l1.m1.2.2.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.1.1.3.1" xref="alg1.l1.m1.2.2.1.1.1.3.1.cmml">​</mo><mi mathsize="80%" id="alg1.l1.m1.2.2.1.1.1.3.3" xref="alg1.l1.m1.2.2.1.1.1.3.3.cmml">n</mi></mrow></msub><mo mathsize="80%" id="alg1.l1.m1.3.3.2.2.4" xref="alg1.l1.m1.3.3.2.3.cmml">,</mo><msub id="alg1.l1.m1.3.3.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.cmml"><mi mathsize="80%" id="alg1.l1.m1.3.3.2.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.2.cmml">𝒘</mi><mrow id="alg1.l1.m1.3.3.2.2.2.3" xref="alg1.l1.m1.3.3.2.2.2.3.cmml"><mi mathsize="80%" id="alg1.l1.m1.3.3.2.2.2.3.2" xref="alg1.l1.m1.3.3.2.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.3.3.2.2.2.3.1" xref="alg1.l1.m1.3.3.2.2.2.3.1.cmml">​</mo><mi mathsize="80%" id="alg1.l1.m1.3.3.2.2.2.3.3" xref="alg1.l1.m1.3.3.2.2.2.3.3.cmml">r</mi></mrow></msub><mo mathsize="80%" id="alg1.l1.m1.3.3.2.2.5" xref="alg1.l1.m1.3.3.2.3.cmml">,</mo><mover accent="true" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">𝜼</mi><mo mathsize="80%" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">~</mo></mover><mo maxsize="80%" minsize="80%" id="alg1.l1.m1.3.3.2.2.6" xref="alg1.l1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3"></eq><ci id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.4">𝜆</ci><set id="alg1.l1.m1.3.3.2.3.cmml" xref="alg1.l1.m1.3.3.2.2"><apply id="alg1.l1.m1.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.2">𝒘</ci><apply id="alg1.l1.m1.2.2.1.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.3"><times id="alg1.l1.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.3.1"></times><ci id="alg1.l1.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.3.2">𝑏</ci><ci id="alg1.l1.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="alg1.l1.m1.3.3.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.2.2.1.cmml" xref="alg1.l1.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2.2">𝒘</ci><apply id="alg1.l1.m1.3.3.2.2.2.3.cmml" xref="alg1.l1.m1.3.3.2.2.2.3"><times id="alg1.l1.m1.3.3.2.2.2.3.1.cmml" xref="alg1.l1.m1.3.3.2.2.2.3.1"></times><ci id="alg1.l1.m1.3.3.2.2.2.3.2.cmml" xref="alg1.l1.m1.3.3.2.2.2.3.2">𝑙</ci><ci id="alg1.l1.m1.3.3.2.2.2.3.3.cmml" xref="alg1.l1.m1.3.3.2.2.2.3.3">𝑟</ci></apply></apply><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">~</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝜼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:80%;">
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text" style="font-size:80%;">  </span><span id="alg1.l2.3" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="alg1.l2.4" class="ltx_text" style="font-size:80%;"> round </span><math id="alg1.l2.m1.3" class="ltx_Math" alttext="t=1,\ldots,T" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><mi mathsize="80%" id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2.cmml">t</mi><mo mathsize="80%" id="alg1.l2.m1.3.4.1" xref="alg1.l2.m1.3.4.1.cmml">=</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mn mathsize="80%" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo mathsize="80%" id="alg1.l2.m1.3.4.3.2.1" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi mathsize="80%" mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">…</mi><mo mathsize="80%" id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi mathsize="80%" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><eq id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1"></eq><ci id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2">𝑡</ci><list id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">…</ci><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">t=1,\ldots,T</annotation></semantics></math><span id="alg1.l2.5" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l2.6" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span><span id="alg1.l2.7" class="ltx_text" style="font-size:80%;">


</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text" style="font-size:80%;">   </span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="\tilde{C}" display="inline"><semantics id="alg1.l3.m1.1a"><mover accent="true" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">C</mi><mo mathsize="80%" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">~</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\tilde{C}</annotation></semantics></math><span id="alg1.l3.3" class="ltx_text" style="font-size:80%;"> </span><math id="alg1.l3.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l3.m2.1a"><mo mathsize="80%" stretchy="false" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\leftarrow</annotation></semantics></math><span id="alg1.l3.4" class="ltx_text" style="font-size:80%;"> Random sample </span><math id="alg1.l3.m3.1" class="ltx_Math" alttext="Cr" display="inline"><semantics id="alg1.l3.m3.1a"><mrow id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml"><mi mathsize="80%" id="alg1.l3.m3.1.1.2" xref="alg1.l3.m3.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m3.1.1.1" xref="alg1.l3.m3.1.1.1.cmml">​</mo><mi mathsize="80%" id="alg1.l3.m3.1.1.3" xref="alg1.l3.m3.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><apply id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1"><times id="alg1.l3.m3.1.1.1.cmml" xref="alg1.l3.m3.1.1.1"></times><ci id="alg1.l3.m3.1.1.2.cmml" xref="alg1.l3.m3.1.1.2">𝐶</ci><ci id="alg1.l3.m3.1.1.3.cmml" xref="alg1.l3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">Cr</annotation></semantics></math><span id="alg1.l3.5" class="ltx_text" style="font-size:80%;"> clients
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text" style="font-size:80%;">   </span><span id="alg1.l4.3" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="alg1.l4.4" class="ltx_text" style="font-size:80%;"> client </span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="i\in\tilde{C}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo mathsize="80%" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mover accent="true" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi mathsize="80%" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">C</mi><mo mathsize="80%" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><ci id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1">~</ci><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i\in\tilde{C}</annotation></semantics></math><span id="alg1.l4.5" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l4.6" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span><span id="alg1.l4.7" class="ltx_text" style="font-size:80%;">


</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text" style="font-size:80%;">    send </span><math id="alg1.l5.m1.2" class="ltx_Math" alttext="\theta_{g},\lambda" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.1" xref="alg1.l5.m1.2.2.2.cmml"><msub id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.1.cmml"><mi mathsize="80%" id="alg1.l5.m1.2.2.1.1.2" xref="alg1.l5.m1.2.2.1.1.2.cmml">θ</mi><mi mathsize="80%" id="alg1.l5.m1.2.2.1.1.3" xref="alg1.l5.m1.2.2.1.1.3.cmml">g</mi></msub><mo mathsize="80%" id="alg1.l5.m1.2.2.1.2" xref="alg1.l5.m1.2.2.2.cmml">,</mo><mi mathsize="80%" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><list id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.1"><apply id="alg1.l5.m1.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.2">𝜃</ci><ci id="alg1.l5.m1.2.2.1.1.3.cmml" xref="alg1.l5.m1.2.2.1.1.3">𝑔</ci></apply><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝜆</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\theta_{g},\lambda</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:80%;"> to client
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="font-size:80%;">    Forward pass of local dataset to compute 1) </span><math id="alg1.l6.m1.2" class="ltx_Math" alttext="E(x_{m}),SD(x_{m})" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.3.cmml"><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><mi mathsize="80%" id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="80%" id="alg1.l6.m1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi mathsize="80%" id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo maxsize="80%" minsize="80%" id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="80%" id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">,</mo><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml"><mi mathsize="80%" id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml">​</mo><mi mathsize="80%" id="alg1.l6.m1.2.2.2.2.4" xref="alg1.l6.m1.2.2.2.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2a" xref="alg1.l6.m1.2.2.2.2.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="alg1.l6.m1.2.2.2.2.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg1.l6.m1.2.2.2.2.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml"><mi mathsize="80%" id="alg1.l6.m1.2.2.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml">x</mi><mi mathsize="80%" id="alg1.l6.m1.2.2.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml">m</mi></msub><mo maxsize="80%" minsize="80%" id="alg1.l6.m1.2.2.2.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><list id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.2"><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3">𝐸</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2"><times id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"></times><ci id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3">𝑆</ci><ci id="alg1.l6.m1.2.2.2.2.4.cmml" xref="alg1.l6.m1.2.2.2.2.4">𝐷</ci><apply id="alg1.l6.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.2">𝑥</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3">𝑚</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">E(x_{m}),SD(x_{m})</annotation></semantics></math><span id="alg1.l6.3" class="ltx_text" style="font-size:80%;"> for </span><math id="alg1.l6.m2.1" class="ltx_Math" alttext="1\leq m\leq M-1" display="inline"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mn mathsize="80%" id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">1</mn><mo mathsize="80%" id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">≤</mo><mi mathsize="80%" id="alg1.l6.m2.1.1.4" xref="alg1.l6.m2.1.1.4.cmml">m</mi><mo mathsize="80%" id="alg1.l6.m2.1.1.5" xref="alg1.l6.m2.1.1.5.cmml">≤</mo><mrow id="alg1.l6.m2.1.1.6" xref="alg1.l6.m2.1.1.6.cmml"><mi mathsize="80%" id="alg1.l6.m2.1.1.6.2" xref="alg1.l6.m2.1.1.6.2.cmml">M</mi><mo mathsize="80%" id="alg1.l6.m2.1.1.6.1" xref="alg1.l6.m2.1.1.6.1.cmml">−</mo><mn mathsize="80%" id="alg1.l6.m2.1.1.6.3" xref="alg1.l6.m2.1.1.6.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><and id="alg1.l6.m2.1.1a.cmml" xref="alg1.l6.m2.1.1"></and><apply id="alg1.l6.m2.1.1b.cmml" xref="alg1.l6.m2.1.1"><leq id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"></leq><cn type="integer" id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">1</cn><ci id="alg1.l6.m2.1.1.4.cmml" xref="alg1.l6.m2.1.1.4">𝑚</ci></apply><apply id="alg1.l6.m2.1.1c.cmml" xref="alg1.l6.m2.1.1"><leq id="alg1.l6.m2.1.1.5.cmml" xref="alg1.l6.m2.1.1.5"></leq><share href="#alg1.l6.m2.1.1.4.cmml" id="alg1.l6.m2.1.1d.cmml" xref="alg1.l6.m2.1.1"></share><apply id="alg1.l6.m2.1.1.6.cmml" xref="alg1.l6.m2.1.1.6"><minus id="alg1.l6.m2.1.1.6.1.cmml" xref="alg1.l6.m2.1.1.6.1"></minus><ci id="alg1.l6.m2.1.1.6.2.cmml" xref="alg1.l6.m2.1.1.6.2">𝑀</ci><cn type="integer" id="alg1.l6.m2.1.1.6.3.cmml" xref="alg1.l6.m2.1.1.6.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">1\leq m\leq M-1</annotation></semantics></math><span id="alg1.l6.4" class="ltx_text" style="font-size:80%;"> 2) </span><math id="alg1.l6.m3.6" class="ltx_Math" alttext="\mu_{b,j},\sigma^{2}_{b,j}" display="inline"><semantics id="alg1.l6.m3.6a"><mrow id="alg1.l6.m3.6.6.2" xref="alg1.l6.m3.6.6.3.cmml"><msub id="alg1.l6.m3.5.5.1.1" xref="alg1.l6.m3.5.5.1.1.cmml"><mi mathsize="80%" id="alg1.l6.m3.5.5.1.1.2" xref="alg1.l6.m3.5.5.1.1.2.cmml">μ</mi><mrow id="alg1.l6.m3.2.2.2.4" xref="alg1.l6.m3.2.2.2.3.cmml"><mi mathsize="80%" id="alg1.l6.m3.1.1.1.1" xref="alg1.l6.m3.1.1.1.1.cmml">b</mi><mo mathsize="80%" id="alg1.l6.m3.2.2.2.4.1" xref="alg1.l6.m3.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="alg1.l6.m3.2.2.2.2" xref="alg1.l6.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo mathsize="80%" id="alg1.l6.m3.6.6.2.3" xref="alg1.l6.m3.6.6.3.cmml">,</mo><msubsup id="alg1.l6.m3.6.6.2.2" xref="alg1.l6.m3.6.6.2.2.cmml"><mi mathsize="80%" id="alg1.l6.m3.6.6.2.2.2.2" xref="alg1.l6.m3.6.6.2.2.2.2.cmml">σ</mi><mrow id="alg1.l6.m3.4.4.2.4" xref="alg1.l6.m3.4.4.2.3.cmml"><mi mathsize="80%" id="alg1.l6.m3.3.3.1.1" xref="alg1.l6.m3.3.3.1.1.cmml">b</mi><mo mathsize="80%" id="alg1.l6.m3.4.4.2.4.1" xref="alg1.l6.m3.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="alg1.l6.m3.4.4.2.2" xref="alg1.l6.m3.4.4.2.2.cmml">j</mi></mrow><mn mathsize="80%" id="alg1.l6.m3.6.6.2.2.2.3" xref="alg1.l6.m3.6.6.2.2.2.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.6b"><list id="alg1.l6.m3.6.6.3.cmml" xref="alg1.l6.m3.6.6.2"><apply id="alg1.l6.m3.5.5.1.1.cmml" xref="alg1.l6.m3.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.5.5.1.1.1.cmml" xref="alg1.l6.m3.5.5.1.1">subscript</csymbol><ci id="alg1.l6.m3.5.5.1.1.2.cmml" xref="alg1.l6.m3.5.5.1.1.2">𝜇</ci><list id="alg1.l6.m3.2.2.2.3.cmml" xref="alg1.l6.m3.2.2.2.4"><ci id="alg1.l6.m3.1.1.1.1.cmml" xref="alg1.l6.m3.1.1.1.1">𝑏</ci><ci id="alg1.l6.m3.2.2.2.2.cmml" xref="alg1.l6.m3.2.2.2.2">𝑗</ci></list></apply><apply id="alg1.l6.m3.6.6.2.2.cmml" xref="alg1.l6.m3.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l6.m3.6.6.2.2.1.cmml" xref="alg1.l6.m3.6.6.2.2">subscript</csymbol><apply id="alg1.l6.m3.6.6.2.2.2.cmml" xref="alg1.l6.m3.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l6.m3.6.6.2.2.2.1.cmml" xref="alg1.l6.m3.6.6.2.2">superscript</csymbol><ci id="alg1.l6.m3.6.6.2.2.2.2.cmml" xref="alg1.l6.m3.6.6.2.2.2.2">𝜎</ci><cn type="integer" id="alg1.l6.m3.6.6.2.2.2.3.cmml" xref="alg1.l6.m3.6.6.2.2.2.3">2</cn></apply><list id="alg1.l6.m3.4.4.2.3.cmml" xref="alg1.l6.m3.4.4.2.4"><ci id="alg1.l6.m3.3.3.1.1.cmml" xref="alg1.l6.m3.3.3.1.1">𝑏</ci><ci id="alg1.l6.m3.4.4.2.2.cmml" xref="alg1.l6.m3.4.4.2.2">𝑗</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.6c">\mu_{b,j},\sigma^{2}_{b,j}</annotation></semantics></math><span id="alg1.l6.5" class="ltx_text" style="font-size:80%;"> for </span><math id="alg1.l6.m4.3" class="ltx_Math" alttext="b=1,\ldots,B" display="inline"><semantics id="alg1.l6.m4.3a"><mrow id="alg1.l6.m4.3.4" xref="alg1.l6.m4.3.4.cmml"><mi mathsize="80%" id="alg1.l6.m4.3.4.2" xref="alg1.l6.m4.3.4.2.cmml">b</mi><mo mathsize="80%" id="alg1.l6.m4.3.4.1" xref="alg1.l6.m4.3.4.1.cmml">=</mo><mrow id="alg1.l6.m4.3.4.3.2" xref="alg1.l6.m4.3.4.3.1.cmml"><mn mathsize="80%" id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml">1</mn><mo mathsize="80%" id="alg1.l6.m4.3.4.3.2.1" xref="alg1.l6.m4.3.4.3.1.cmml">,</mo><mi mathsize="80%" mathvariant="normal" id="alg1.l6.m4.2.2" xref="alg1.l6.m4.2.2.cmml">…</mi><mo mathsize="80%" id="alg1.l6.m4.3.4.3.2.2" xref="alg1.l6.m4.3.4.3.1.cmml">,</mo><mi mathsize="80%" id="alg1.l6.m4.3.3" xref="alg1.l6.m4.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.3b"><apply id="alg1.l6.m4.3.4.cmml" xref="alg1.l6.m4.3.4"><eq id="alg1.l6.m4.3.4.1.cmml" xref="alg1.l6.m4.3.4.1"></eq><ci id="alg1.l6.m4.3.4.2.cmml" xref="alg1.l6.m4.3.4.2">𝑏</ci><list id="alg1.l6.m4.3.4.3.1.cmml" xref="alg1.l6.m4.3.4.3.2"><cn type="integer" id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1">1</cn><ci id="alg1.l6.m4.2.2.cmml" xref="alg1.l6.m4.2.2">…</ci><ci id="alg1.l6.m4.3.3.cmml" xref="alg1.l6.m4.3.3">𝐵</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.3c">b=1,\ldots,B</annotation></semantics></math><span id="alg1.l6.6" class="ltx_text" style="font-size:80%;"> and </span><math id="alg1.l6.m5.3" class="ltx_Math" alttext="j=1,\ldots,J" display="inline"><semantics id="alg1.l6.m5.3a"><mrow id="alg1.l6.m5.3.4" xref="alg1.l6.m5.3.4.cmml"><mi mathsize="80%" id="alg1.l6.m5.3.4.2" xref="alg1.l6.m5.3.4.2.cmml">j</mi><mo mathsize="80%" id="alg1.l6.m5.3.4.1" xref="alg1.l6.m5.3.4.1.cmml">=</mo><mrow id="alg1.l6.m5.3.4.3.2" xref="alg1.l6.m5.3.4.3.1.cmml"><mn mathsize="80%" id="alg1.l6.m5.1.1" xref="alg1.l6.m5.1.1.cmml">1</mn><mo mathsize="80%" id="alg1.l6.m5.3.4.3.2.1" xref="alg1.l6.m5.3.4.3.1.cmml">,</mo><mi mathsize="80%" mathvariant="normal" id="alg1.l6.m5.2.2" xref="alg1.l6.m5.2.2.cmml">…</mi><mo mathsize="80%" id="alg1.l6.m5.3.4.3.2.2" xref="alg1.l6.m5.3.4.3.1.cmml">,</mo><mi mathsize="80%" id="alg1.l6.m5.3.3" xref="alg1.l6.m5.3.3.cmml">J</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m5.3b"><apply id="alg1.l6.m5.3.4.cmml" xref="alg1.l6.m5.3.4"><eq id="alg1.l6.m5.3.4.1.cmml" xref="alg1.l6.m5.3.4.1"></eq><ci id="alg1.l6.m5.3.4.2.cmml" xref="alg1.l6.m5.3.4.2">𝑗</ci><list id="alg1.l6.m5.3.4.3.1.cmml" xref="alg1.l6.m5.3.4.3.2"><cn type="integer" id="alg1.l6.m5.1.1.cmml" xref="alg1.l6.m5.1.1">1</cn><ci id="alg1.l6.m5.2.2.cmml" xref="alg1.l6.m5.2.2">…</ci><ci id="alg1.l6.m5.3.3.cmml" xref="alg1.l6.m5.3.3">𝐽</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m5.3c">j=1,\ldots,J</annotation></semantics></math><span id="alg1.l6.7" class="ltx_text" style="font-size:80%;">.
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text" style="font-size:80%;">    Compute </span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="\xi_{b}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">ξ</mi><mi mathsize="80%" id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝜉</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\xi_{b}</annotation></semantics></math><span id="alg1.l7.3" class="ltx_text" style="font-size:80%;"> for </span><math id="alg1.l7.m2.3" class="ltx_Math" alttext="b=1,\ldots,B" display="inline"><semantics id="alg1.l7.m2.3a"><mrow id="alg1.l7.m2.3.4" xref="alg1.l7.m2.3.4.cmml"><mi mathsize="80%" id="alg1.l7.m2.3.4.2" xref="alg1.l7.m2.3.4.2.cmml">b</mi><mo mathsize="80%" id="alg1.l7.m2.3.4.1" xref="alg1.l7.m2.3.4.1.cmml">=</mo><mrow id="alg1.l7.m2.3.4.3.2" xref="alg1.l7.m2.3.4.3.1.cmml"><mn mathsize="80%" id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">1</mn><mo mathsize="80%" id="alg1.l7.m2.3.4.3.2.1" xref="alg1.l7.m2.3.4.3.1.cmml">,</mo><mi mathsize="80%" mathvariant="normal" id="alg1.l7.m2.2.2" xref="alg1.l7.m2.2.2.cmml">…</mi><mo mathsize="80%" id="alg1.l7.m2.3.4.3.2.2" xref="alg1.l7.m2.3.4.3.1.cmml">,</mo><mi mathsize="80%" id="alg1.l7.m2.3.3" xref="alg1.l7.m2.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.3b"><apply id="alg1.l7.m2.3.4.cmml" xref="alg1.l7.m2.3.4"><eq id="alg1.l7.m2.3.4.1.cmml" xref="alg1.l7.m2.3.4.1"></eq><ci id="alg1.l7.m2.3.4.2.cmml" xref="alg1.l7.m2.3.4.2">𝑏</ci><list id="alg1.l7.m2.3.4.3.1.cmml" xref="alg1.l7.m2.3.4.3.2"><cn type="integer" id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">1</cn><ci id="alg1.l7.m2.2.2.cmml" xref="alg1.l7.m2.2.2">…</ci><ci id="alg1.l7.m2.3.3.cmml" xref="alg1.l7.m2.3.3">𝐵</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.3c">b=1,\ldots,B</annotation></semantics></math><span id="alg1.l7.4" class="ltx_text" style="font-size:80%;"> using Eq. </span><a href="#S3.E3" title="Equation 3 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref" style="font-size:80%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="alg1.l7.5" class="ltx_text" style="font-size:80%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.2" class="ltx_text" style="font-size:80%;">    </span><span id="alg1.l8.3" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span><span id="alg1.l8.4" class="ltx_text" style="font-size:80%;"> iteration </span><math id="alg1.l8.m1.3" class="ltx_Math" alttext="k=1,\ldots,K" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.4" xref="alg1.l8.m1.3.4.cmml"><mi mathsize="80%" id="alg1.l8.m1.3.4.2" xref="alg1.l8.m1.3.4.2.cmml">k</mi><mo mathsize="80%" id="alg1.l8.m1.3.4.1" xref="alg1.l8.m1.3.4.1.cmml">=</mo><mrow id="alg1.l8.m1.3.4.3.2" xref="alg1.l8.m1.3.4.3.1.cmml"><mn mathsize="80%" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">1</mn><mo mathsize="80%" id="alg1.l8.m1.3.4.3.2.1" xref="alg1.l8.m1.3.4.3.1.cmml">,</mo><mi mathsize="80%" mathvariant="normal" id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">…</mi><mo mathsize="80%" id="alg1.l8.m1.3.4.3.2.2" xref="alg1.l8.m1.3.4.3.1.cmml">,</mo><mi mathsize="80%" id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.4.cmml" xref="alg1.l8.m1.3.4"><eq id="alg1.l8.m1.3.4.1.cmml" xref="alg1.l8.m1.3.4.1"></eq><ci id="alg1.l8.m1.3.4.2.cmml" xref="alg1.l8.m1.3.4.2">𝑘</ci><list id="alg1.l8.m1.3.4.3.1.cmml" xref="alg1.l8.m1.3.4.3.2"><cn type="integer" id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">1</cn><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">…</ci><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">k=1,\ldots,K</annotation></semantics></math><span id="alg1.l8.5" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l8.6" class="ltx_text ltx_font_bold" style="font-size:80%;">do</span><span id="alg1.l8.7" class="ltx_text" style="font-size:80%;">


</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="font-size:80%;">      </span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="\theta_{i}\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi mathsize="80%" id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">θ</mi><mi mathsize="80%" id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">i</mi></msub><mo mathsize="80%" stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝜃</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\theta_{i}\leftarrow</annotation></semantics></math><span id="alg1.l9.3" class="ltx_text" style="font-size:80%;"> Finetune </span><math id="alg1.l9.m2.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi mathsize="80%" id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">θ</mi><mi mathsize="80%" id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝜃</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\theta_{g}</annotation></semantics></math><span id="alg1.l9.4" class="ltx_text" style="font-size:80%;"> using </span><math id="alg1.l9.m3.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="alg1.l9.m3.1a"><msub id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="alg1.l9.m3.1.1.2" xref="alg1.l9.m3.1.1.2.cmml">ℒ</mi><mi mathsize="80%" id="alg1.l9.m3.1.1.3" xref="alg1.l9.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><apply id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.1.cmml" xref="alg1.l9.m3.1.1">subscript</csymbol><ci id="alg1.l9.m3.1.1.2.cmml" xref="alg1.l9.m3.1.1.2">ℒ</ci><ci id="alg1.l9.m3.1.1.3.cmml" xref="alg1.l9.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">\mathcal{L}_{T}</annotation></semantics></math><span id="alg1.l9.5" class="ltx_text" style="font-size:80%;"> for </span><math id="alg1.l9.m4.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg1.l9.m4.1a"><mi mathsize="80%" id="alg1.l9.m4.1.1" xref="alg1.l9.m4.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m4.1b"><ci id="alg1.l9.m4.1.1.cmml" xref="alg1.l9.m4.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m4.1c">e</annotation></semantics></math><span id="alg1.l9.6" class="ltx_text" style="font-size:80%;"> epochs
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text" style="font-size:80%;">      </span><math id="alg1.l10.m1.1" class="ltx_Math" alttext="\lambda\leftarrow\lambda-\zeta\&gt;" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">λ</mi><mo mathsize="80%" stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi mathsize="80%" id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">λ</mi><mo mathsize="80%" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">−</mo><mi mathsize="80%" id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">ζ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝜆</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><minus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></minus><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝜆</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝜁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\lambda\leftarrow\lambda-\zeta\&gt;</annotation></semantics></math><span id="alg1.l10.3" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l10.4" class="ltx_text ltx_font_italic" style="font-size:80%;">Hypergradient</span><span id="alg1.l10.5" class="ltx_text" style="font-size:80%;">(</span><math id="alg1.l10.m2.1" class="ltx_Math" alttext="\mathcal{L}_{V}" display="inline"><semantics id="alg1.l10.m2.1a"><msub id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">ℒ</mi><mi mathsize="80%" id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">ℒ</ci><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\mathcal{L}_{V}</annotation></semantics></math><span id="alg1.l10.6" class="ltx_text" style="font-size:80%;">, </span><math id="alg1.l10.m3.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="alg1.l10.m3.1a"><msub id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="alg1.l10.m3.1.1.2" xref="alg1.l10.m3.1.1.2.cmml">ℒ</mi><mi mathsize="80%" id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.cmml" xref="alg1.l10.m3.1.1">subscript</csymbol><ci id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1.2">ℒ</ci><ci id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">\mathcal{L}_{T}</annotation></semantics></math><span id="alg1.l10.7" class="ltx_text" style="font-size:80%;">, </span><math id="alg1.l10.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.l10.m4.1a"><mi mathsize="80%" id="alg1.l10.m4.1.1" xref="alg1.l10.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m4.1b"><ci id="alg1.l10.m4.1.1.cmml" xref="alg1.l10.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m4.1c">\lambda</annotation></semantics></math><span id="alg1.l10.8" class="ltx_text" style="font-size:80%;">, </span><math id="alg1.l10.m5.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l10.m5.1a"><msub id="alg1.l10.m5.1.1" xref="alg1.l10.m5.1.1.cmml"><mi mathsize="80%" id="alg1.l10.m5.1.1.2" xref="alg1.l10.m5.1.1.2.cmml">θ</mi><mi mathsize="80%" id="alg1.l10.m5.1.1.3" xref="alg1.l10.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m5.1b"><apply id="alg1.l10.m5.1.1.cmml" xref="alg1.l10.m5.1.1"><csymbol cd="ambiguous" id="alg1.l10.m5.1.1.1.cmml" xref="alg1.l10.m5.1.1">subscript</csymbol><ci id="alg1.l10.m5.1.1.2.cmml" xref="alg1.l10.m5.1.1.2">𝜃</ci><ci id="alg1.l10.m5.1.1.3.cmml" xref="alg1.l10.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m5.1c">\theta_{i}</annotation></semantics></math><span id="alg1.l10.9" class="ltx_text" style="font-size:80%;">)
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg1.l11.2" class="ltx_text" style="font-size:80%;">    </span><span id="alg1.l11.3" class="ltx_text ltx_font_bold" style="font-size:80%;">end</span><span id="alg1.l11.4" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l11.5" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text" style="font-size:80%;">    send </span><math id="alg1.l12.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.l12.m1.1a"><mi mathsize="80%" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\lambda</annotation></semantics></math><span id="alg1.l12.3" class="ltx_text" style="font-size:80%;"> and num of data samples </span><math id="alg1.l12.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l12.m2.1a"><mi mathsize="80%" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">N</annotation></semantics></math><span id="alg1.l12.4" class="ltx_text" style="font-size:80%;"> to server
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg1.l13.2" class="ltx_text" style="font-size:80%;">   </span><span id="alg1.l13.3" class="ltx_text ltx_font_bold" style="font-size:80%;">end</span><span id="alg1.l13.4" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l13.5" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><span id="alg1.l14.2" class="ltx_text" style="font-size:80%;">   </span><math id="alg1.l14.m1.1" class="ltx_Math" alttext="\lambda\leftarrow\sum^{\tilde{C}}_{i}\frac{N_{i}}{\sum N_{i}}\lambda_{i}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi mathsize="80%" id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">λ</mi><mo mathsize="80%" rspace="0.111em" stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><msubsup id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml"><mo maxsize="80%" minsize="80%" stretchy="true" id="alg1.l14.m1.1.1.3.1.2.2" xref="alg1.l14.m1.1.1.3.1.2.2.cmml">∑</mo><mi mathsize="80%" id="alg1.l14.m1.1.1.3.1.3" xref="alg1.l14.m1.1.1.3.1.3.cmml">i</mi><mover accent="true" id="alg1.l14.m1.1.1.3.1.2.3" xref="alg1.l14.m1.1.1.3.1.2.3.cmml"><mi mathsize="80%" id="alg1.l14.m1.1.1.3.1.2.3.2" xref="alg1.l14.m1.1.1.3.1.2.3.2.cmml">C</mi><mo mathsize="80%" id="alg1.l14.m1.1.1.3.1.2.3.1" xref="alg1.l14.m1.1.1.3.1.2.3.1.cmml">~</mo></mover></msubsup><mrow id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><mfrac id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml"><msub id="alg1.l14.m1.1.1.3.2.2.2" xref="alg1.l14.m1.1.1.3.2.2.2.cmml"><mi mathsize="80%" id="alg1.l14.m1.1.1.3.2.2.2.2" xref="alg1.l14.m1.1.1.3.2.2.2.2.cmml">N</mi><mi mathsize="80%" id="alg1.l14.m1.1.1.3.2.2.2.3" xref="alg1.l14.m1.1.1.3.2.2.2.3.cmml">i</mi></msub><mstyle scriptlevel="-1" id="alg1.l14.m1.1.1.3.2.2.3" xref="alg1.l14.m1.1.1.3.2.2.3.cmml"><mrow id="alg1.l14.m1.1.1.3.2.2.3a" xref="alg1.l14.m1.1.1.3.2.2.3.cmml"><mo maxsize="56%" minsize="56%" stretchy="true" id="alg1.l14.m1.1.1.3.2.2.3.1" xref="alg1.l14.m1.1.1.3.2.2.3.1.cmml">∑</mo><msub id="alg1.l14.m1.1.1.3.2.2.3.2" xref="alg1.l14.m1.1.1.3.2.2.3.2.cmml"><mi mathsize="56%" id="alg1.l14.m1.1.1.3.2.2.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.3.2.2.cmml">N</mi><mi mathsize="57%" id="alg1.l14.m1.1.1.3.2.2.3.2.3" xref="alg1.l14.m1.1.1.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mstyle></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.2.1" xref="alg1.l14.m1.1.1.3.2.1.cmml">​</mo><msub id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml"><mi mathsize="80%" id="alg1.l14.m1.1.1.3.2.3.2" xref="alg1.l14.m1.1.1.3.2.3.2.cmml">λ</mi><mi mathsize="80%" id="alg1.l14.m1.1.1.3.2.3.3" xref="alg1.l14.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝜆</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><apply id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.1.cmml" xref="alg1.l14.m1.1.1.3.1">subscript</csymbol><apply id="alg1.l14.m1.1.1.3.1.2.cmml" xref="alg1.l14.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.2.1.cmml" xref="alg1.l14.m1.1.1.3.1">superscript</csymbol><sum id="alg1.l14.m1.1.1.3.1.2.2.cmml" xref="alg1.l14.m1.1.1.3.1.2.2"></sum><apply id="alg1.l14.m1.1.1.3.1.2.3.cmml" xref="alg1.l14.m1.1.1.3.1.2.3"><ci id="alg1.l14.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.1.2.3.1">~</ci><ci id="alg1.l14.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.1.2.3.2">𝐶</ci></apply></apply><ci id="alg1.l14.m1.1.1.3.1.3.cmml" xref="alg1.l14.m1.1.1.3.1.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><times id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.1"></times><apply id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2"><divide id="alg1.l14.m1.1.1.3.2.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.2"></divide><apply id="alg1.l14.m1.1.1.3.2.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2.2.2">𝑁</ci><ci id="alg1.l14.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.3.2.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.2.3"><sum id="alg1.l14.m1.1.1.3.2.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.2.2.3.1"></sum><apply id="alg1.l14.m1.1.1.3.2.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.2.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2.3.2.2">𝑁</ci><ci id="alg1.l14.m1.1.1.3.2.2.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.2.3.2">𝜆</ci><ci id="alg1.l14.m1.1.1.3.2.3.3.cmml" xref="alg1.l14.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\lambda\leftarrow\sum^{\tilde{C}}_{i}\frac{N_{i}}{\sum N_{i}}\lambda_{i}</annotation></semantics></math><span id="alg1.l14.3" class="ltx_text" style="font-size:80%;">
</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text" style="font-size:80%;">  </span><span id="alg1.l15.3" class="ltx_text ltx_font_bold" style="font-size:80%;">end</span><span id="alg1.l15.4" class="ltx_text" style="font-size:80%;"> </span><span id="alg1.l15.5" class="ltx_text ltx_font_bold" style="font-size:80%;">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.12" class="ltx_p ltx_figure_panel"><span id="alg1.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Output:<span id="alg1.12.1.1" class="ltx_text ltx_font_medium"> <math id="alg1.12.1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.12.1.1.m1.1a"><mi id="alg1.12.1.1.m1.1.1" xref="alg1.12.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.12.1.1.m1.1b"><ci id="alg1.12.1.1.m1.1.1.cmml" xref="alg1.12.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.1.1.m1.1c">\lambda</annotation></semantics></math></span></span></p>
</div>
</div>
</figure>
<br class="ltx_break ltx_break">
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.10.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Hypergradient</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.5.5" class="ltx_p ltx_figure_panel ltx_align_left"><span id="alg2.5.5.6" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:</span><span id="alg2.5.5.7" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.5.5.5" class="ltx_text" style="font-size:80%;">Validation Loss <math id="alg2.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{V}" display="inline"><semantics id="alg2.1.1.1.m1.1a"><msub id="alg2.1.1.1.m1.1.1" xref="alg2.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.1.1.1.m1.1.1.2" xref="alg2.1.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="alg2.1.1.1.m1.1.1.3" xref="alg2.1.1.1.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.m1.1b"><apply id="alg2.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.1.m1.1.1.1.cmml" xref="alg2.1.1.1.m1.1.1">subscript</csymbol><ci id="alg2.1.1.1.m1.1.1.2.cmml" xref="alg2.1.1.1.m1.1.1.2">ℒ</ci><ci id="alg2.1.1.1.m1.1.1.3.cmml" xref="alg2.1.1.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.m1.1c">\mathcal{L}_{V}</annotation></semantics></math> and training Loss <math id="alg2.2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="alg2.2.2.2.m2.1a"><msub id="alg2.2.2.2.m2.1.1" xref="alg2.2.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.2.2.m2.1.1.2" xref="alg2.2.2.2.m2.1.1.2.cmml">ℒ</mi><mi id="alg2.2.2.2.m2.1.1.3" xref="alg2.2.2.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.2.2.2.m2.1b"><apply id="alg2.2.2.2.m2.1.1.cmml" xref="alg2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.2.2.2.m2.1.1.1.cmml" xref="alg2.2.2.2.m2.1.1">subscript</csymbol><ci id="alg2.2.2.2.m2.1.1.2.cmml" xref="alg2.2.2.2.m2.1.1.2">ℒ</ci><ci id="alg2.2.2.2.m2.1.1.3.cmml" xref="alg2.2.2.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.2.m2.1c">\mathcal{L}_{T}</annotation></semantics></math>. Learning rate <math id="alg2.3.3.3.m3.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="alg2.3.3.3.m3.1a"><mi id="alg2.3.3.3.m3.1.1" xref="alg2.3.3.3.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.3.m3.1b"><ci id="alg2.3.3.3.m3.1.1.cmml" xref="alg2.3.3.3.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.3.m3.1c">\psi</annotation></semantics></math> and no. of iterations <math id="alg2.4.4.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="alg2.4.4.4.m4.1a"><mi id="alg2.4.4.4.m4.1.1" xref="alg2.4.4.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg2.4.4.4.m4.1b"><ci id="alg2.4.4.4.m4.1.1.cmml" xref="alg2.4.4.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.4.m4.1c">Q</annotation></semantics></math>.
Fixed point <math id="alg2.5.5.5.m5.2" class="ltx_Math" alttext="(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))" display="inline"><semantics id="alg2.5.5.5.m5.2a"><mrow id="alg2.5.5.5.m5.2.2.2" xref="alg2.5.5.5.m5.2.2.3.cmml"><mo stretchy="false" id="alg2.5.5.5.m5.2.2.2.3" xref="alg2.5.5.5.m5.2.2.3.cmml">(</mo><msup id="alg2.5.5.5.m5.1.1.1.1" xref="alg2.5.5.5.m5.1.1.1.1.cmml"><mi id="alg2.5.5.5.m5.1.1.1.1.2" xref="alg2.5.5.5.m5.1.1.1.1.2.cmml">λ</mi><msup id="alg2.5.5.5.m5.1.1.1.1.3" xref="alg2.5.5.5.m5.1.1.1.1.3.cmml"><mi id="alg2.5.5.5.m5.1.1.1.1.3a" xref="alg2.5.5.5.m5.1.1.1.1.3.cmml"></mi><mo id="alg2.5.5.5.m5.1.1.1.1.3.1" xref="alg2.5.5.5.m5.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="alg2.5.5.5.m5.2.2.2.4" xref="alg2.5.5.5.m5.2.2.3.cmml">,</mo><mrow id="alg2.5.5.5.m5.2.2.2.2" xref="alg2.5.5.5.m5.2.2.2.2.cmml"><msup id="alg2.5.5.5.m5.2.2.2.2.3" xref="alg2.5.5.5.m5.2.2.2.2.3.cmml"><mi id="alg2.5.5.5.m5.2.2.2.2.3.2" xref="alg2.5.5.5.m5.2.2.2.2.3.2.cmml">θ</mi><mo id="alg2.5.5.5.m5.2.2.2.2.3.3" xref="alg2.5.5.5.m5.2.2.2.2.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="alg2.5.5.5.m5.2.2.2.2.2" xref="alg2.5.5.5.m5.2.2.2.2.2.cmml">​</mo><mrow id="alg2.5.5.5.m5.2.2.2.2.1.1" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.5.5.5.m5.2.2.2.2.1.1.2" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.cmml">(</mo><msup id="alg2.5.5.5.m5.2.2.2.2.1.1.1" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.cmml"><mi id="alg2.5.5.5.m5.2.2.2.2.1.1.1.2" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.2.cmml">λ</mi><msup id="alg2.5.5.5.m5.2.2.2.2.1.1.1.3" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.cmml"><mi id="alg2.5.5.5.m5.2.2.2.2.1.1.1.3a" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.cmml"></mi><mo id="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.1" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="alg2.5.5.5.m5.2.2.2.2.1.1.3" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.5.5.5.m5.2.2.2.5" xref="alg2.5.5.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.5.5.m5.2b"><interval closure="open" id="alg2.5.5.5.m5.2.2.3.cmml" xref="alg2.5.5.5.m5.2.2.2"><apply id="alg2.5.5.5.m5.1.1.1.1.cmml" xref="alg2.5.5.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.5.m5.1.1.1.1.1.cmml" xref="alg2.5.5.5.m5.1.1.1.1">superscript</csymbol><ci id="alg2.5.5.5.m5.1.1.1.1.2.cmml" xref="alg2.5.5.5.m5.1.1.1.1.2">𝜆</ci><apply id="alg2.5.5.5.m5.1.1.1.1.3.cmml" xref="alg2.5.5.5.m5.1.1.1.1.3"><ci id="alg2.5.5.5.m5.1.1.1.1.3.1.cmml" xref="alg2.5.5.5.m5.1.1.1.1.3.1">′</ci></apply></apply><apply id="alg2.5.5.5.m5.2.2.2.2.cmml" xref="alg2.5.5.5.m5.2.2.2.2"><times id="alg2.5.5.5.m5.2.2.2.2.2.cmml" xref="alg2.5.5.5.m5.2.2.2.2.2"></times><apply id="alg2.5.5.5.m5.2.2.2.2.3.cmml" xref="alg2.5.5.5.m5.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.5.5.5.m5.2.2.2.2.3.1.cmml" xref="alg2.5.5.5.m5.2.2.2.2.3">superscript</csymbol><ci id="alg2.5.5.5.m5.2.2.2.2.3.2.cmml" xref="alg2.5.5.5.m5.2.2.2.2.3.2">𝜃</ci><times id="alg2.5.5.5.m5.2.2.2.2.3.3.cmml" xref="alg2.5.5.5.m5.2.2.2.2.3.3"></times></apply><apply id="alg2.5.5.5.m5.2.2.2.2.1.1.1.cmml" xref="alg2.5.5.5.m5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.5.5.5.m5.2.2.2.2.1.1.1.1.cmml" xref="alg2.5.5.5.m5.2.2.2.2.1.1">superscript</csymbol><ci id="alg2.5.5.5.m5.2.2.2.2.1.1.1.2.cmml" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.2">𝜆</ci><apply id="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.cmml" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.3"><ci id="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.1.cmml" xref="alg2.5.5.5.m5.2.2.2.2.1.1.1.3.1">′</ci></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.5.m5.2c">(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))</annotation></semantics></math>.</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.11" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text" style="font-size:90%;">  </span><math id="alg2.l1.m1.3" class="ltx_Math" alttext="p=v=\partial_{\theta}\mathcal{L}_{V}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}" display="inline"><semantics id="alg2.l1.m1.3a"><mrow id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml"><mi mathsize="90%" id="alg2.l1.m1.3.3.3" xref="alg2.l1.m1.3.3.3.cmml">p</mi><mo mathsize="90%" id="alg2.l1.m1.3.3.4" xref="alg2.l1.m1.3.3.4.cmml">=</mo><mi mathsize="90%" id="alg2.l1.m1.3.3.5" xref="alg2.l1.m1.3.3.5.cmml">v</mi><mo mathsize="90%" rspace="0.1389em" id="alg2.l1.m1.3.3.6" xref="alg2.l1.m1.3.3.6.cmml">=</mo><msub id="alg2.l1.m1.3.3.1.1" xref="alg2.l1.m1.3.3.1.2.cmml"><mrow id="alg2.l1.m1.3.3.1.1.1" xref="alg2.l1.m1.3.3.1.2.cmml"><mrow id="alg2.l1.m1.3.3.1.1.1.1" xref="alg2.l1.m1.3.3.1.1.1.1.cmml"><msub id="alg2.l1.m1.3.3.1.1.1.1.1" xref="alg2.l1.m1.3.3.1.1.1.1.1.cmml"><mo lspace="0.1389em" mathsize="90%" rspace="0em" id="alg2.l1.m1.3.3.1.1.1.1.1.2" xref="alg2.l1.m1.3.3.1.1.1.1.1.2.cmml">∂</mo><mi mathsize="90%" id="alg2.l1.m1.3.3.1.1.1.1.1.3" xref="alg2.l1.m1.3.3.1.1.1.1.1.3.cmml">θ</mi></msub><msub id="alg2.l1.m1.3.3.1.1.1.1.2" xref="alg2.l1.m1.3.3.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l1.m1.3.3.1.1.1.1.2.2" xref="alg2.l1.m1.3.3.1.1.1.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="alg2.l1.m1.3.3.1.1.1.1.2.3" xref="alg2.l1.m1.3.3.1.1.1.1.2.3.cmml">V</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.3.3.1.1.1.2" xref="alg2.l1.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="alg2.l1.m1.2.2.2.2" xref="alg2.l1.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.3.cmml">(</mo><msup id="alg2.l1.m1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l1.m1.1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.1.2.cmml">λ</mi><msup id="alg2.l1.m1.1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.1.3.cmml"><mi id="alg2.l1.m1.1.1.1.1.1.3a" xref="alg2.l1.m1.1.1.1.1.1.3.cmml"></mi><mo mathsize="90%" id="alg2.l1.m1.1.1.1.1.1.3.1" xref="alg2.l1.m1.1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo mathsize="90%" id="alg2.l1.m1.2.2.2.2.4" xref="alg2.l1.m1.2.2.2.3.cmml">,</mo><mrow id="alg2.l1.m1.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.cmml"><msup id="alg2.l1.m1.2.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.l1.m1.2.2.2.2.2.3.2" xref="alg2.l1.m1.2.2.2.2.2.3.2.cmml">θ</mi><mo mathsize="90%" id="alg2.l1.m1.2.2.2.2.2.3.3" xref="alg2.l1.m1.2.2.2.2.2.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="alg2.l1.m1.2.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="alg2.l1.m1.2.2.2.2.2.1.1" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.2.2.2.1.1.2" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="alg2.l1.m1.2.2.2.2.2.1.1.1" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg2.l1.m1.2.2.2.2.2.1.1.1.2" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.2.cmml">λ</mi><msup id="alg2.l1.m1.2.2.2.2.2.1.1.1.3" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="alg2.l1.m1.2.2.2.2.2.1.1.1.3a" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.3.cmml"></mi><mo mathsize="90%" id="alg2.l1.m1.2.2.2.2.2.1.1.1.3.1" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.3.1.cmml">′</mo></msup></msup><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.2.2.2.1.1.3" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.2.2.5" xref="alg2.l1.m1.2.2.2.3.cmml">)</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.3b"><apply id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3"><and id="alg2.l1.m1.3.3a.cmml" xref="alg2.l1.m1.3.3"></and><apply id="alg2.l1.m1.3.3b.cmml" xref="alg2.l1.m1.3.3"><eq id="alg2.l1.m1.3.3.4.cmml" xref="alg2.l1.m1.3.3.4"></eq><ci id="alg2.l1.m1.3.3.3.cmml" xref="alg2.l1.m1.3.3.3">𝑝</ci><ci id="alg2.l1.m1.3.3.5.cmml" xref="alg2.l1.m1.3.3.5">𝑣</ci></apply><apply id="alg2.l1.m1.3.3c.cmml" xref="alg2.l1.m1.3.3"><eq id="alg2.l1.m1.3.3.6.cmml" xref="alg2.l1.m1.3.3.6"></eq><share href="#alg2.l1.m1.3.3.5.cmml" id="alg2.l1.m1.3.3d.cmml" xref="alg2.l1.m1.3.3"></share><apply id="alg2.l1.m1.3.3.1.2.cmml" xref="alg2.l1.m1.3.3.1.1"><csymbol cd="latexml" id="alg2.l1.m1.3.3.1.2.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.2">evaluated-at</csymbol><apply id="alg2.l1.m1.3.3.1.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1"><apply id="alg2.l1.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1">subscript</csymbol><partialdiff id="alg2.l1.m1.3.3.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.2"></partialdiff><ci id="alg2.l1.m1.3.3.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.1.3">𝜃</ci></apply><apply id="alg2.l1.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.1.1.2.1.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg2.l1.m1.3.3.1.1.1.1.2.2.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.2.2">ℒ</ci><ci id="alg2.l1.m1.3.3.1.1.1.1.2.3.cmml" xref="alg2.l1.m1.3.3.1.1.1.1.2.3">𝑉</ci></apply></apply><interval closure="open" id="alg2.l1.m1.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2"><apply id="alg2.l1.m1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.1.2">𝜆</ci><apply id="alg2.l1.m1.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.1.3"><ci id="alg2.l1.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l1.m1.1.1.1.1.1.3.1">′</ci></apply></apply><apply id="alg2.l1.m1.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2"><times id="alg2.l1.m1.2.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.2"></times><apply id="alg2.l1.m1.2.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.2.3.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.3">superscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.3.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.3.2">𝜃</ci><times id="alg2.l1.m1.2.2.2.2.2.3.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.3.3"></times></apply><apply id="alg2.l1.m1.2.2.2.2.2.1.1.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.1.1">superscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.2">𝜆</ci><apply id="alg2.l1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.3"><ci id="alg2.l1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="alg2.l1.m1.2.2.2.2.2.1.1.1.3.1">′</ci></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.3c">p=v=\partial_{\theta}\mathcal{L}_{V}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}</annotation></semantics></math><span id="alg2.l1.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg2.l2.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg2.l2.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l2.4" class="ltx_text" style="font-size:90%;"> iteration </span><math id="alg2.l2.m1.3" class="ltx_Math" alttext="1,\ldots,Q" display="inline"><semantics id="alg2.l2.m1.3a"><mrow id="alg2.l2.m1.3.4.2" xref="alg2.l2.m1.3.4.1.cmml"><mn mathsize="90%" id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">1</mn><mo mathsize="90%" id="alg2.l2.m1.3.4.2.1" xref="alg2.l2.m1.3.4.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml">…</mi><mo mathsize="90%" id="alg2.l2.m1.3.4.2.2" xref="alg2.l2.m1.3.4.1.cmml">,</mo><mi mathsize="90%" id="alg2.l2.m1.3.3" xref="alg2.l2.m1.3.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.3b"><list id="alg2.l2.m1.3.4.1.cmml" xref="alg2.l2.m1.3.4.2"><cn type="integer" id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">1</cn><ci id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2">…</ci><ci id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3">𝑄</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.3c">1,\ldots,Q</annotation></semantics></math><span id="alg2.l2.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l2.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l2.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg2.l3.2" class="ltx_text" style="font-size:90%;">   </span><math id="alg2.l3.m1.1" class="ltx_Math" alttext="v\leftarrow v-\psi\&gt;v\&gt;\partial^{2}_{\theta^{*}}\mathcal{L}_{T}" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">v</mi><mo mathsize="90%" stretchy="false" id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">←</mo><mrow id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">v</mi><mo mathsize="90%" id="alg2.l3.m1.1.1.3.1" xref="alg2.l3.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.3.2" xref="alg2.l3.m1.1.1.3.3.2.cmml">ψ</mi><mo lspace="0.220em" rspace="0em" id="alg2.l3.m1.1.1.3.3.1" xref="alg2.l3.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l3.m1.1.1.3.3.3" xref="alg2.l3.m1.1.1.3.3.3.cmml">v</mi><mo lspace="0.220em" rspace="0em" id="alg2.l3.m1.1.1.3.3.1a" xref="alg2.l3.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg2.l3.m1.1.1.3.3.4" xref="alg2.l3.m1.1.1.3.3.4.cmml"><msubsup id="alg2.l3.m1.1.1.3.3.4.1" xref="alg2.l3.m1.1.1.3.3.4.1.cmml"><mo mathsize="90%" rspace="0em" id="alg2.l3.m1.1.1.3.3.4.1.2.2" xref="alg2.l3.m1.1.1.3.3.4.1.2.2.cmml">∂</mo><msup id="alg2.l3.m1.1.1.3.3.4.1.3" xref="alg2.l3.m1.1.1.3.3.4.1.3.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.3.3.4.1.3.2" xref="alg2.l3.m1.1.1.3.3.4.1.3.2.cmml">θ</mi><mo mathsize="90%" id="alg2.l3.m1.1.1.3.3.4.1.3.3" xref="alg2.l3.m1.1.1.3.3.4.1.3.3.cmml">∗</mo></msup><mn mathsize="90%" id="alg2.l3.m1.1.1.3.3.4.1.2.3" xref="alg2.l3.m1.1.1.3.3.4.1.2.3.cmml">2</mn></msubsup><msub id="alg2.l3.m1.1.1.3.3.4.2" xref="alg2.l3.m1.1.1.3.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.l3.m1.1.1.3.3.4.2.2" xref="alg2.l3.m1.1.1.3.3.4.2.2.cmml">ℒ</mi><mi mathsize="90%" id="alg2.l3.m1.1.1.3.3.4.2.3" xref="alg2.l3.m1.1.1.3.3.4.2.3.cmml">T</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">←</ci><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑣</ci><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><minus id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3.1"></minus><ci id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2">𝑣</ci><apply id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3"><times id="alg2.l3.m1.1.1.3.3.1.cmml" xref="alg2.l3.m1.1.1.3.3.1"></times><ci id="alg2.l3.m1.1.1.3.3.2.cmml" xref="alg2.l3.m1.1.1.3.3.2">𝜓</ci><ci id="alg2.l3.m1.1.1.3.3.3.cmml" xref="alg2.l3.m1.1.1.3.3.3">𝑣</ci><apply id="alg2.l3.m1.1.1.3.3.4.cmml" xref="alg2.l3.m1.1.1.3.3.4"><apply id="alg2.l3.m1.1.1.3.3.4.1.cmml" xref="alg2.l3.m1.1.1.3.3.4.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.3.4.1.1.cmml" xref="alg2.l3.m1.1.1.3.3.4.1">subscript</csymbol><apply id="alg2.l3.m1.1.1.3.3.4.1.2.cmml" xref="alg2.l3.m1.1.1.3.3.4.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.3.4.1.2.1.cmml" xref="alg2.l3.m1.1.1.3.3.4.1">superscript</csymbol><partialdiff id="alg2.l3.m1.1.1.3.3.4.1.2.2.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.2.2"></partialdiff><cn type="integer" id="alg2.l3.m1.1.1.3.3.4.1.2.3.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.2.3">2</cn></apply><apply id="alg2.l3.m1.1.1.3.3.4.1.3.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.3.4.1.3.1.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.3">superscript</csymbol><ci id="alg2.l3.m1.1.1.3.3.4.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.3.2">𝜃</ci><times id="alg2.l3.m1.1.1.3.3.4.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3.4.1.3.3"></times></apply></apply><apply id="alg2.l3.m1.1.1.3.3.4.2.cmml" xref="alg2.l3.m1.1.1.3.3.4.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.3.4.2.1.cmml" xref="alg2.l3.m1.1.1.3.3.4.2">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.3.4.2.2.cmml" xref="alg2.l3.m1.1.1.3.3.4.2.2">ℒ</ci><ci id="alg2.l3.m1.1.1.3.3.4.2.3.cmml" xref="alg2.l3.m1.1.1.3.3.4.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">v\leftarrow v-\psi\&gt;v\&gt;\partial^{2}_{\theta^{*}}\mathcal{L}_{T}</annotation></semantics></math><span id="alg2.l3.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg2.l4.2" class="ltx_text" style="font-size:90%;">   </span><math id="alg2.l4.m1.1" class="ltx_Math" alttext="p\leftarrow p+v" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi mathsize="90%" id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">p</mi><mo mathsize="90%" stretchy="false" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">←</mo><mrow id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">p</mi><mo mathsize="90%" id="alg2.l4.m1.1.1.3.1" xref="alg2.l4.m1.1.1.3.1.cmml">+</mo><mi mathsize="90%" id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">v</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑝</ci><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><plus id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3.1"></plus><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝑝</ci><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">p\leftarrow p+v</annotation></semantics></math><span id="alg2.l4.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg2.l5.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg2.l5.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg2.l5.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l5.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.6" class="ltx_p ltx_figure_panel"><span id="alg2.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Output: <math id="alg2.6.1.m1.6" class="ltx_Math" alttext="\partial_{\lambda}\mathcal{L}_{V}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}-p\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}" display="inline"><semantics id="alg2.6.1.m1.6a"><mrow id="alg2.6.1.m1.6.6" xref="alg2.6.1.m1.6.6.cmml"><msub id="alg2.6.1.m1.5.5.1.1" xref="alg2.6.1.m1.5.5.1.2.cmml"><mrow id="alg2.6.1.m1.5.5.1.1.1" xref="alg2.6.1.m1.5.5.1.2.cmml"><mrow id="alg2.6.1.m1.5.5.1.1.1.1" xref="alg2.6.1.m1.5.5.1.1.1.1.cmml"><msub id="alg2.6.1.m1.5.5.1.1.1.1.1" xref="alg2.6.1.m1.5.5.1.1.1.1.1.cmml"><mo id="alg2.6.1.m1.5.5.1.1.1.1.1.2" xref="alg2.6.1.m1.5.5.1.1.1.1.1.2.cmml">∂</mo><mi id="alg2.6.1.m1.5.5.1.1.1.1.1.3" xref="alg2.6.1.m1.5.5.1.1.1.1.1.3.cmml">λ</mi></msub><msub id="alg2.6.1.m1.5.5.1.1.1.1.2" xref="alg2.6.1.m1.5.5.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.6.1.m1.5.5.1.1.1.1.2.2" xref="alg2.6.1.m1.5.5.1.1.1.1.2.2.cmml">ℒ</mi><mi id="alg2.6.1.m1.5.5.1.1.1.1.2.3" xref="alg2.6.1.m1.5.5.1.1.1.1.2.3.cmml">V</mi></msub></mrow><mo stretchy="false" id="alg2.6.1.m1.5.5.1.1.1.2" xref="alg2.6.1.m1.5.5.1.2.1.cmml">|</mo></mrow><mrow id="alg2.6.1.m1.2.2.2.2" xref="alg2.6.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.6.1.m1.2.2.2.2.3" xref="alg2.6.1.m1.2.2.2.3.cmml">(</mo><msup id="alg2.6.1.m1.1.1.1.1.1" xref="alg2.6.1.m1.1.1.1.1.1.cmml"><mi id="alg2.6.1.m1.1.1.1.1.1.2" xref="alg2.6.1.m1.1.1.1.1.1.2.cmml">λ</mi><msup id="alg2.6.1.m1.1.1.1.1.1.3" xref="alg2.6.1.m1.1.1.1.1.1.3.cmml"><mi id="alg2.6.1.m1.1.1.1.1.1.3a" xref="alg2.6.1.m1.1.1.1.1.1.3.cmml"></mi><mo id="alg2.6.1.m1.1.1.1.1.1.3.1" xref="alg2.6.1.m1.1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="alg2.6.1.m1.2.2.2.2.4" xref="alg2.6.1.m1.2.2.2.3.cmml">,</mo><mrow id="alg2.6.1.m1.2.2.2.2.2" xref="alg2.6.1.m1.2.2.2.2.2.cmml"><msup id="alg2.6.1.m1.2.2.2.2.2.3" xref="alg2.6.1.m1.2.2.2.2.2.3.cmml"><mi id="alg2.6.1.m1.2.2.2.2.2.3.2" xref="alg2.6.1.m1.2.2.2.2.2.3.2.cmml">θ</mi><mo id="alg2.6.1.m1.2.2.2.2.2.3.3" xref="alg2.6.1.m1.2.2.2.2.2.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.2.2.2.2.2" xref="alg2.6.1.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="alg2.6.1.m1.2.2.2.2.2.1.1" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.6.1.m1.2.2.2.2.2.1.1.2" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="alg2.6.1.m1.2.2.2.2.2.1.1.1" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.cmml"><mi id="alg2.6.1.m1.2.2.2.2.2.1.1.1.2" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.2.cmml">λ</mi><msup id="alg2.6.1.m1.2.2.2.2.2.1.1.1.3" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="alg2.6.1.m1.2.2.2.2.2.1.1.1.3a" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.cmml"></mi><mo id="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.1" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="alg2.6.1.m1.2.2.2.2.2.1.1.3" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.6.1.m1.2.2.2.2.5" xref="alg2.6.1.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="alg2.6.1.m1.6.6.3" xref="alg2.6.1.m1.6.6.3.cmml">−</mo><msub id="alg2.6.1.m1.6.6.2.1" xref="alg2.6.1.m1.6.6.2.2.cmml"><mrow id="alg2.6.1.m1.6.6.2.1.1" xref="alg2.6.1.m1.6.6.2.2.cmml"><mrow id="alg2.6.1.m1.6.6.2.1.1.1" xref="alg2.6.1.m1.6.6.2.1.1.1.cmml"><mi id="alg2.6.1.m1.6.6.2.1.1.1.2" xref="alg2.6.1.m1.6.6.2.1.1.1.2.cmml">p</mi><mo lspace="0.220em" rspace="0em" id="alg2.6.1.m1.6.6.2.1.1.1.1" xref="alg2.6.1.m1.6.6.2.1.1.1.1.cmml">​</mo><mrow id="alg2.6.1.m1.6.6.2.1.1.1.3" xref="alg2.6.1.m1.6.6.2.1.1.1.3.cmml"><msub id="alg2.6.1.m1.6.6.2.1.1.1.3.1" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.cmml"><mo rspace="0em" id="alg2.6.1.m1.6.6.2.1.1.1.3.1.2" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.2.cmml">∂</mo><mrow id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.cmml"><mi id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.2" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.1" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.1.cmml">​</mo><mi id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.3" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.3.cmml">θ</mi></mrow></msub><msub id="alg2.6.1.m1.6.6.2.1.1.1.3.2" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.6.1.m1.6.6.2.1.1.1.3.2.2" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2.2.cmml">ℒ</mi><mi id="alg2.6.1.m1.6.6.2.1.1.1.3.2.3" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2.3.cmml">T</mi></msub></mrow></mrow><mo stretchy="false" id="alg2.6.1.m1.6.6.2.1.1.2" xref="alg2.6.1.m1.6.6.2.2.1.cmml">|</mo></mrow><mrow id="alg2.6.1.m1.4.4.2.2" xref="alg2.6.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="alg2.6.1.m1.4.4.2.2.3" xref="alg2.6.1.m1.4.4.2.3.cmml">(</mo><msup id="alg2.6.1.m1.3.3.1.1.1" xref="alg2.6.1.m1.3.3.1.1.1.cmml"><mi id="alg2.6.1.m1.3.3.1.1.1.2" xref="alg2.6.1.m1.3.3.1.1.1.2.cmml">λ</mi><msup id="alg2.6.1.m1.3.3.1.1.1.3" xref="alg2.6.1.m1.3.3.1.1.1.3.cmml"><mi id="alg2.6.1.m1.3.3.1.1.1.3a" xref="alg2.6.1.m1.3.3.1.1.1.3.cmml"></mi><mo id="alg2.6.1.m1.3.3.1.1.1.3.1" xref="alg2.6.1.m1.3.3.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="alg2.6.1.m1.4.4.2.2.4" xref="alg2.6.1.m1.4.4.2.3.cmml">,</mo><mrow id="alg2.6.1.m1.4.4.2.2.2" xref="alg2.6.1.m1.4.4.2.2.2.cmml"><msup id="alg2.6.1.m1.4.4.2.2.2.3" xref="alg2.6.1.m1.4.4.2.2.2.3.cmml"><mi id="alg2.6.1.m1.4.4.2.2.2.3.2" xref="alg2.6.1.m1.4.4.2.2.2.3.2.cmml">θ</mi><mo id="alg2.6.1.m1.4.4.2.2.2.3.3" xref="alg2.6.1.m1.4.4.2.2.2.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.4.4.2.2.2.2" xref="alg2.6.1.m1.4.4.2.2.2.2.cmml">​</mo><mrow id="alg2.6.1.m1.4.4.2.2.2.1.1" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.6.1.m1.4.4.2.2.2.1.1.2" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.cmml">(</mo><msup id="alg2.6.1.m1.4.4.2.2.2.1.1.1" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.cmml"><mi id="alg2.6.1.m1.4.4.2.2.2.1.1.1.2" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.2.cmml">λ</mi><msup id="alg2.6.1.m1.4.4.2.2.2.1.1.1.3" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.cmml"><mi id="alg2.6.1.m1.4.4.2.2.2.1.1.1.3a" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.cmml"></mi><mo id="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.1" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="alg2.6.1.m1.4.4.2.2.2.1.1.3" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.6.1.m1.4.4.2.2.5" xref="alg2.6.1.m1.4.4.2.3.cmml">)</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.1.m1.6b"><apply id="alg2.6.1.m1.6.6.cmml" xref="alg2.6.1.m1.6.6"><minus id="alg2.6.1.m1.6.6.3.cmml" xref="alg2.6.1.m1.6.6.3"></minus><apply id="alg2.6.1.m1.5.5.1.2.cmml" xref="alg2.6.1.m1.5.5.1.1"><csymbol cd="latexml" id="alg2.6.1.m1.5.5.1.2.1.cmml" xref="alg2.6.1.m1.5.5.1.1.1.2">evaluated-at</csymbol><apply id="alg2.6.1.m1.5.5.1.1.1.1.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1"><apply id="alg2.6.1.m1.5.5.1.1.1.1.1.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.5.5.1.1.1.1.1.1.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.1">subscript</csymbol><partialdiff id="alg2.6.1.m1.5.5.1.1.1.1.1.2.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.1.2"></partialdiff><ci id="alg2.6.1.m1.5.5.1.1.1.1.1.3.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.1.3">𝜆</ci></apply><apply id="alg2.6.1.m1.5.5.1.1.1.1.2.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.6.1.m1.5.5.1.1.1.1.2.1.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="alg2.6.1.m1.5.5.1.1.1.1.2.2.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.2.2">ℒ</ci><ci id="alg2.6.1.m1.5.5.1.1.1.1.2.3.cmml" xref="alg2.6.1.m1.5.5.1.1.1.1.2.3">𝑉</ci></apply></apply><interval closure="open" id="alg2.6.1.m1.2.2.2.3.cmml" xref="alg2.6.1.m1.2.2.2.2"><apply id="alg2.6.1.m1.1.1.1.1.1.cmml" xref="alg2.6.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.1.1.1.1.1.1.cmml" xref="alg2.6.1.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.6.1.m1.1.1.1.1.1.2.cmml" xref="alg2.6.1.m1.1.1.1.1.1.2">𝜆</ci><apply id="alg2.6.1.m1.1.1.1.1.1.3.cmml" xref="alg2.6.1.m1.1.1.1.1.1.3"><ci id="alg2.6.1.m1.1.1.1.1.1.3.1.cmml" xref="alg2.6.1.m1.1.1.1.1.1.3.1">′</ci></apply></apply><apply id="alg2.6.1.m1.2.2.2.2.2.cmml" xref="alg2.6.1.m1.2.2.2.2.2"><times id="alg2.6.1.m1.2.2.2.2.2.2.cmml" xref="alg2.6.1.m1.2.2.2.2.2.2"></times><apply id="alg2.6.1.m1.2.2.2.2.2.3.cmml" xref="alg2.6.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.6.1.m1.2.2.2.2.2.3.1.cmml" xref="alg2.6.1.m1.2.2.2.2.2.3">superscript</csymbol><ci id="alg2.6.1.m1.2.2.2.2.2.3.2.cmml" xref="alg2.6.1.m1.2.2.2.2.2.3.2">𝜃</ci><times id="alg2.6.1.m1.2.2.2.2.2.3.3.cmml" xref="alg2.6.1.m1.2.2.2.2.2.3.3"></times></apply><apply id="alg2.6.1.m1.2.2.2.2.2.1.1.1.cmml" xref="alg2.6.1.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg2.6.1.m1.2.2.2.2.2.1.1">superscript</csymbol><ci id="alg2.6.1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.2">𝜆</ci><apply id="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.3"><ci id="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="alg2.6.1.m1.2.2.2.2.2.1.1.1.3.1">′</ci></apply></apply></apply></interval></apply><apply id="alg2.6.1.m1.6.6.2.2.cmml" xref="alg2.6.1.m1.6.6.2.1"><csymbol cd="latexml" id="alg2.6.1.m1.6.6.2.2.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.2">evaluated-at</csymbol><apply id="alg2.6.1.m1.6.6.2.1.1.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1"><times id="alg2.6.1.m1.6.6.2.1.1.1.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.1"></times><ci id="alg2.6.1.m1.6.6.2.1.1.1.2.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.2">𝑝</ci><apply id="alg2.6.1.m1.6.6.2.1.1.1.3.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3"><apply id="alg2.6.1.m1.6.6.2.1.1.1.3.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.6.6.2.1.1.1.3.1.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1">subscript</csymbol><partialdiff id="alg2.6.1.m1.6.6.2.1.1.1.3.1.2.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.2"></partialdiff><apply id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3"><times id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.1"></times><ci id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.2.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.2">𝜆</ci><ci id="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.3.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.1.3.3">𝜃</ci></apply></apply><apply id="alg2.6.1.m1.6.6.2.1.1.1.3.2.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.6.1.m1.6.6.2.1.1.1.3.2.1.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2">subscript</csymbol><ci id="alg2.6.1.m1.6.6.2.1.1.1.3.2.2.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2.2">ℒ</ci><ci id="alg2.6.1.m1.6.6.2.1.1.1.3.2.3.cmml" xref="alg2.6.1.m1.6.6.2.1.1.1.3.2.3">𝑇</ci></apply></apply></apply><interval closure="open" id="alg2.6.1.m1.4.4.2.3.cmml" xref="alg2.6.1.m1.4.4.2.2"><apply id="alg2.6.1.m1.3.3.1.1.1.cmml" xref="alg2.6.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.3.3.1.1.1.1.cmml" xref="alg2.6.1.m1.3.3.1.1.1">superscript</csymbol><ci id="alg2.6.1.m1.3.3.1.1.1.2.cmml" xref="alg2.6.1.m1.3.3.1.1.1.2">𝜆</ci><apply id="alg2.6.1.m1.3.3.1.1.1.3.cmml" xref="alg2.6.1.m1.3.3.1.1.1.3"><ci id="alg2.6.1.m1.3.3.1.1.1.3.1.cmml" xref="alg2.6.1.m1.3.3.1.1.1.3.1">′</ci></apply></apply><apply id="alg2.6.1.m1.4.4.2.2.2.cmml" xref="alg2.6.1.m1.4.4.2.2.2"><times id="alg2.6.1.m1.4.4.2.2.2.2.cmml" xref="alg2.6.1.m1.4.4.2.2.2.2"></times><apply id="alg2.6.1.m1.4.4.2.2.2.3.cmml" xref="alg2.6.1.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="alg2.6.1.m1.4.4.2.2.2.3.1.cmml" xref="alg2.6.1.m1.4.4.2.2.2.3">superscript</csymbol><ci id="alg2.6.1.m1.4.4.2.2.2.3.2.cmml" xref="alg2.6.1.m1.4.4.2.2.2.3.2">𝜃</ci><times id="alg2.6.1.m1.4.4.2.2.2.3.3.cmml" xref="alg2.6.1.m1.4.4.2.2.2.3.3"></times></apply><apply id="alg2.6.1.m1.4.4.2.2.2.1.1.1.cmml" xref="alg2.6.1.m1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.6.1.m1.4.4.2.2.2.1.1.1.1.cmml" xref="alg2.6.1.m1.4.4.2.2.2.1.1">superscript</csymbol><ci id="alg2.6.1.m1.4.4.2.2.2.1.1.1.2.cmml" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.2">𝜆</ci><apply id="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.cmml" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.3"><ci id="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.1.cmml" xref="alg2.6.1.m1.4.4.2.2.2.1.1.1.3.1">′</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.1.m1.6c">\partial_{\lambda}\mathcal{L}_{V}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}-p\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}|_{(\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}}))}</annotation></semantics></math><span id="alg2.6.1.1" class="ltx_text ltx_font_medium"></span></span></p>
</div>
</div>
</figure>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.2" class="ltx_p"><span id="S3.SS2.p5.2.1" class="ltx_text ltx_font_bold">Selective Update Hyperparameters.</span> A variety of recent personalized FL works achieved promising results by manually selecting and fine-tuning a sub-module of <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\theta_{g}</annotation></semantics></math> during personalization <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Arivazhagan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>); Liang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>, (<span id="S3.SS2.p5.2.2" class="ltx_text ltx_font_italic">e.g.</span>, the feature extractor or the classifier layers), while leaving the remaining modules in <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\theta_{g}</annotation></semantics></math> frozen. It is beneficial because it allows the designer to manage over- vs under-fitting in personalization. <span id="S3.SS2.p5.2.3" class="ltx_text ltx_font_italic">e.g.</span>, if the per-client dataset is small, then fine-tuning many parameters can easily lead to overfitting, and thus better freezing some layers during personalization. Alternatively, if the clients differ significantly from the global model and/or if the per-client dataset is larger, then more layers could be beneficially personalised without underfitting. Clearly the optimal configuration for allowing model updates depends on the specific scenario and the specific client. Furthermore, it may be beneficial to consider a more flexible range of hyper-parameters that control a continuous degree of fine-tuning strength, rather than a binary frozen/updated decision per module.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.3" class="ltx_p">To automate the search for good personalization strategies covering a range of wider and more challenging non-IID setups, we consider layer-wise learning rates, <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\eta</annotation></semantics></math> for all learnable weights and biases. This parameterization of personalization encompasses all the previous manual frozen/updated split approaches as special cases. Furthermore, while these approaches have primarily considered heterogeneity in the marginal label distribution, we also aim to cover feature distribution shift between clients. Thus we also include the learning rates for the BN parameters, <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mi id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">\gamma</annotation></semantics></math> and <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><mi id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><ci id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\delta</annotation></semantics></math>, allowing us to further tackle feature shift by adjusting the means and SD of the normalized features.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.6" class="ltx_p"><span id="S3.SS2.p7.6.1" class="ltx_text ltx_font_bold">Hyperparameter Inference for Personalization.</span> We aim to estimate a set of local hyperparameters that can best personalize the pretrained model for each client given a group of clients whose data might not be used for pretraining. To accomplish this, we learn to estimate hyperparameters based on the degree of data heterogeneity of the client’s local data with respect to the data that the model is pretrained on.
There are many ways to quantify data heterogeneity, such as utilizing the earth mover’s distance between the client’s data distribution and the population distribution for label distribution skew <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib63" title="" class="ltx_ref">2018</a>)</cite> or taking the difference in local covariance among clients for feature shift <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021c</a>)</cite>. In our case, we aim to distinguish both label and feature data heterogeneity across clients. To this end, we utilize the client’s local input features to each layer with respect to the given pretrained model.
Given a pretrained model with <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">M</annotation></semantics></math> layers and <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><mi id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><ci id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">B</annotation></semantics></math> BN layers, we learn <math id="S3.SS2.p7.3.m3.3" class="ltx_Math" alttext="\boldsymbol{\eta}=\eta_{1},\ldots,\eta_{2M}" display="inline"><semantics id="S3.SS2.p7.3.m3.3a"><mrow id="S3.SS2.p7.3.m3.3.3" xref="S3.SS2.p7.3.m3.3.3.cmml"><mi id="S3.SS2.p7.3.m3.3.3.4" xref="S3.SS2.p7.3.m3.3.3.4.cmml">𝜼</mi><mo id="S3.SS2.p7.3.m3.3.3.3" xref="S3.SS2.p7.3.m3.3.3.3.cmml">=</mo><mrow id="S3.SS2.p7.3.m3.3.3.2.2" xref="S3.SS2.p7.3.m3.3.3.2.3.cmml"><msub id="S3.SS2.p7.3.m3.2.2.1.1.1" xref="S3.SS2.p7.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.p7.3.m3.2.2.1.1.1.2" xref="S3.SS2.p7.3.m3.2.2.1.1.1.2.cmml">η</mi><mn id="S3.SS2.p7.3.m3.2.2.1.1.1.3" xref="S3.SS2.p7.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p7.3.m3.3.3.2.2.3" xref="S3.SS2.p7.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p7.3.m3.3.3.2.2.4" xref="S3.SS2.p7.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p7.3.m3.3.3.2.2.2" xref="S3.SS2.p7.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS2.p7.3.m3.3.3.2.2.2.2" xref="S3.SS2.p7.3.m3.3.3.2.2.2.2.cmml">η</mi><mrow id="S3.SS2.p7.3.m3.3.3.2.2.2.3" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.cmml"><mn id="S3.SS2.p7.3.m3.3.3.2.2.2.3.2" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p7.3.m3.3.3.2.2.2.3.1" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p7.3.m3.3.3.2.2.2.3.3" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.3.cmml">M</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.3b"><apply id="S3.SS2.p7.3.m3.3.3.cmml" xref="S3.SS2.p7.3.m3.3.3"><eq id="S3.SS2.p7.3.m3.3.3.3.cmml" xref="S3.SS2.p7.3.m3.3.3.3"></eq><ci id="S3.SS2.p7.3.m3.3.3.4.cmml" xref="S3.SS2.p7.3.m3.3.3.4">𝜼</ci><list id="S3.SS2.p7.3.m3.3.3.2.3.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2"><apply id="S3.SS2.p7.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p7.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p7.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.p7.3.m3.2.2.1.1.1.2">𝜂</ci><cn type="integer" id="S3.SS2.p7.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.p7.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">…</ci><apply id="S3.SS2.p7.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p7.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2.2">𝜂</ci><apply id="S3.SS2.p7.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3"><times id="S3.SS2.p7.3.m3.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.1"></times><cn type="integer" id="S3.SS2.p7.3.m3.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.2">2</cn><ci id="S3.SS2.p7.3.m3.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p7.3.m3.3.3.2.2.2.3.3">𝑀</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.3c">\boldsymbol{\eta}=\eta_{1},\ldots,\eta_{2M}</annotation></semantics></math><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We assume all layers have weights and biases here.</span></span></span> and <math id="S3.SS2.p7.4.m4.3" class="ltx_Math" alttext="\boldsymbol{\beta}=\beta_{1},\ldots,\beta_{B}" display="inline"><semantics id="S3.SS2.p7.4.m4.3a"><mrow id="S3.SS2.p7.4.m4.3.3" xref="S3.SS2.p7.4.m4.3.3.cmml"><mi id="S3.SS2.p7.4.m4.3.3.4" xref="S3.SS2.p7.4.m4.3.3.4.cmml">𝜷</mi><mo id="S3.SS2.p7.4.m4.3.3.3" xref="S3.SS2.p7.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS2.p7.4.m4.3.3.2.2" xref="S3.SS2.p7.4.m4.3.3.2.3.cmml"><msub id="S3.SS2.p7.4.m4.2.2.1.1.1" xref="S3.SS2.p7.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p7.4.m4.2.2.1.1.1.2" xref="S3.SS2.p7.4.m4.2.2.1.1.1.2.cmml">β</mi><mn id="S3.SS2.p7.4.m4.2.2.1.1.1.3" xref="S3.SS2.p7.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p7.4.m4.3.3.2.2.3" xref="S3.SS2.p7.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p7.4.m4.1.1" xref="S3.SS2.p7.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.p7.4.m4.3.3.2.2.4" xref="S3.SS2.p7.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p7.4.m4.3.3.2.2.2" xref="S3.SS2.p7.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.p7.4.m4.3.3.2.2.2.2" xref="S3.SS2.p7.4.m4.3.3.2.2.2.2.cmml">β</mi><mi id="S3.SS2.p7.4.m4.3.3.2.2.2.3" xref="S3.SS2.p7.4.m4.3.3.2.2.2.3.cmml">B</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m4.3b"><apply id="S3.SS2.p7.4.m4.3.3.cmml" xref="S3.SS2.p7.4.m4.3.3"><eq id="S3.SS2.p7.4.m4.3.3.3.cmml" xref="S3.SS2.p7.4.m4.3.3.3"></eq><ci id="S3.SS2.p7.4.m4.3.3.4.cmml" xref="S3.SS2.p7.4.m4.3.3.4">𝜷</ci><list id="S3.SS2.p7.4.m4.3.3.2.3.cmml" xref="S3.SS2.p7.4.m4.3.3.2.2"><apply id="S3.SS2.p7.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p7.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p7.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p7.4.m4.2.2.1.1.1.2">𝛽</ci><cn type="integer" id="S3.SS2.p7.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p7.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p7.4.m4.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1">…</ci><apply id="S3.SS2.p7.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.p7.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p7.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p7.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p7.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p7.4.m4.3.3.2.2.2.2">𝛽</ci><ci id="S3.SS2.p7.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.p7.4.m4.3.3.2.2.2.3">𝐵</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.4.m4.3c">\boldsymbol{\beta}=\beta_{1},\ldots,\beta_{B}</annotation></semantics></math>, using two functions, each of which is parameterized as a multilayer perceptron (MLP), named meta-net, with one hidden layer due to its ability to theoretically approximate almost any continuous function <cite class="ltx_cite ltx_citemacro_cite">Csáji et al. (<a href="#bib.bib12" title="" class="ltx_ref">2001</a>); Shu et al. (<a href="#bib.bib57" title="" class="ltx_ref">2019</a>)</cite>. We named the meta-net that estimates <math id="S3.SS2.p7.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S3.SS2.p7.5.m5.1a"><mi id="S3.SS2.p7.5.m5.1.1" xref="S3.SS2.p7.5.m5.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m5.1b"><ci id="S3.SS2.p7.5.m5.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.5.m5.1c">\boldsymbol{\beta}</annotation></semantics></math> and the meta-net that estimates <math id="S3.SS2.p7.6.m6.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S3.SS2.p7.6.m6.1a"><mi id="S3.SS2.p7.6.m6.1.1" xref="S3.SS2.p7.6.m6.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.6.m6.1b"><ci id="S3.SS2.p7.6.m6.1.1.cmml" xref="S3.SS2.p7.6.m6.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.6.m6.1c">\boldsymbol{\eta}</annotation></semantics></math> as BNNet and LRNet respectively. Details about the architecture can be found in Appendix. <a href="#A5" title="Appendix E Architecture &amp; Initialization Details ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.2" class="ltx_p">To estimate <math id="S3.SS2.p8.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S3.SS2.p8.1.m1.1a"><mi id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><ci id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">\boldsymbol{\beta}</annotation></semantics></math>, we first perform a forward pass of the local dataset on the given pretrained model, computing the mean and SD of each channel of each input feature for each BN layer. We then measure the distance between the local feature distributions and the pretrained model’s running estimated feature distributions of the <math id="S3.SS2.p8.2.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS2.p8.2.m2.1a"><mi id="S3.SS2.p8.2.m2.1.1" xref="S3.SS2.p8.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.1b"><ci id="S3.SS2.p8.2.m2.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.1c">b</annotation></semantics></math>-th BN layer as follows:
</p>
<table id="A6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\xi_{i,b}=\frac{1}{J}\sum\nolimits^{J}_{j=1}\frac{1}{2}\Big{(}D_{KL}(P_{j}||Q_{j})+D_{KL}(Q_{j}||P_{j})\Big{)}," display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2b"><msub id="S3.E3.m1.2.3"><mi id="S3.E3.m1.2.3.2">ξ</mi><mrow id="S3.E3.m1.2.2.2.4"><mi id="S3.E3.m1.1.1.1.1">i</mi><mo id="S3.E3.m1.2.2.2.4.1">,</mo><mi id="S3.E3.m1.2.2.2.2">b</mi></mrow></msub><mo id="S3.E3.m1.2.4">=</mo><mstyle displaystyle="true" id="S3.E3.m1.2.5"><mfrac id="S3.E3.m1.2.5a"><mn id="S3.E3.m1.2.5.2">1</mn><mi id="S3.E3.m1.2.5.3">J</mi></mfrac></mstyle><mstyle displaystyle="true" id="S3.E3.m1.2.6"><msubsup id="S3.E3.m1.2.6a"><mo id="S3.E3.m1.2.6.2.2">∑</mo><mrow id="S3.E3.m1.2.6.3"><mi id="S3.E3.m1.2.6.3.2">j</mi><mo id="S3.E3.m1.2.6.3.1">=</mo><mn id="S3.E3.m1.2.6.3.3">1</mn></mrow><mi id="S3.E3.m1.2.6.2.3">J</mi></msubsup></mstyle><mstyle displaystyle="true" id="S3.E3.m1.2.7"><mfrac id="S3.E3.m1.2.7a"><mn id="S3.E3.m1.2.7.2">1</mn><mn id="S3.E3.m1.2.7.3">2</mn></mfrac></mstyle><mrow id="S3.E3.m1.2.8"><mo maxsize="160%" minsize="160%" id="S3.E3.m1.2.8.1">(</mo><msub id="S3.E3.m1.2.8.2"><mi id="S3.E3.m1.2.8.2.2">D</mi><mrow id="S3.E3.m1.2.8.2.3"><mi id="S3.E3.m1.2.8.2.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.8.2.3.1">​</mo><mi id="S3.E3.m1.2.8.2.3.3">L</mi></mrow></msub><mrow id="S3.E3.m1.2.8.3"><mo stretchy="false" id="S3.E3.m1.2.8.3.1">(</mo><msub id="S3.E3.m1.2.8.3.2"><mi id="S3.E3.m1.2.8.3.2.2">P</mi><mi id="S3.E3.m1.2.8.3.2.3">j</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.2.8.3.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.2.8.3.4">|</mo><msub id="S3.E3.m1.2.8.3.5"><mi id="S3.E3.m1.2.8.3.5.2">Q</mi><mi id="S3.E3.m1.2.8.3.5.3">j</mi></msub><mo stretchy="false" id="S3.E3.m1.2.8.3.6">)</mo></mrow><mo id="S3.E3.m1.2.8.4">+</mo><msub id="S3.E3.m1.2.8.5"><mi id="S3.E3.m1.2.8.5.2">D</mi><mrow id="S3.E3.m1.2.8.5.3"><mi id="S3.E3.m1.2.8.5.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.8.5.3.1">​</mo><mi id="S3.E3.m1.2.8.5.3.3">L</mi></mrow></msub><mrow id="S3.E3.m1.2.8.6"><mo stretchy="false" id="S3.E3.m1.2.8.6.1">(</mo><msub id="S3.E3.m1.2.8.6.2"><mi id="S3.E3.m1.2.8.6.2.2">Q</mi><mi id="S3.E3.m1.2.8.6.2.3">j</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.2.8.6.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.2.8.6.4">|</mo><msub id="S3.E3.m1.2.8.6.5"><mi id="S3.E3.m1.2.8.6.5.2">P</mi><mi id="S3.E3.m1.2.8.6.5.3">j</mi></msub><mo stretchy="false" id="S3.E3.m1.2.8.6.6">)</mo></mrow><mo maxsize="160%" minsize="160%" id="S3.E3.m1.2.8.7">)</mo></mrow><mo id="S3.E3.m1.2.9">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\xi_{i,b}=\frac{1}{J}\sum\nolimits^{J}_{j=1}\frac{1}{2}\Big{(}D_{KL}(P_{j}||Q_{j})+D_{KL}(Q_{j}||P_{j})\Big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p8.8" class="ltx_p">where <math id="S3.SS2.p8.3.m1.8" class="ltx_Math" alttext="P_{j}=\mathcal{N}(\mu_{i,b,j},\sigma^{2}_{i,b,j})" display="inline"><semantics id="S3.SS2.p8.3.m1.8a"><mrow id="S3.SS2.p8.3.m1.8.8" xref="S3.SS2.p8.3.m1.8.8.cmml"><msub id="S3.SS2.p8.3.m1.8.8.4" xref="S3.SS2.p8.3.m1.8.8.4.cmml"><mi id="S3.SS2.p8.3.m1.8.8.4.2" xref="S3.SS2.p8.3.m1.8.8.4.2.cmml">P</mi><mi id="S3.SS2.p8.3.m1.8.8.4.3" xref="S3.SS2.p8.3.m1.8.8.4.3.cmml">j</mi></msub><mo id="S3.SS2.p8.3.m1.8.8.3" xref="S3.SS2.p8.3.m1.8.8.3.cmml">=</mo><mrow id="S3.SS2.p8.3.m1.8.8.2" xref="S3.SS2.p8.3.m1.8.8.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p8.3.m1.8.8.2.4" xref="S3.SS2.p8.3.m1.8.8.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.3.m1.8.8.2.3" xref="S3.SS2.p8.3.m1.8.8.2.3.cmml">​</mo><mrow id="S3.SS2.p8.3.m1.8.8.2.2.2" xref="S3.SS2.p8.3.m1.8.8.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p8.3.m1.8.8.2.2.2.3" xref="S3.SS2.p8.3.m1.8.8.2.2.3.cmml">(</mo><msub id="S3.SS2.p8.3.m1.7.7.1.1.1.1" xref="S3.SS2.p8.3.m1.7.7.1.1.1.1.cmml"><mi id="S3.SS2.p8.3.m1.7.7.1.1.1.1.2" xref="S3.SS2.p8.3.m1.7.7.1.1.1.1.2.cmml">μ</mi><mrow id="S3.SS2.p8.3.m1.3.3.3.5" xref="S3.SS2.p8.3.m1.3.3.3.4.cmml"><mi id="S3.SS2.p8.3.m1.1.1.1.1" xref="S3.SS2.p8.3.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p8.3.m1.3.3.3.5.1" xref="S3.SS2.p8.3.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p8.3.m1.2.2.2.2" xref="S3.SS2.p8.3.m1.2.2.2.2.cmml">b</mi><mo id="S3.SS2.p8.3.m1.3.3.3.5.2" xref="S3.SS2.p8.3.m1.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p8.3.m1.3.3.3.3" xref="S3.SS2.p8.3.m1.3.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS2.p8.3.m1.8.8.2.2.2.4" xref="S3.SS2.p8.3.m1.8.8.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p8.3.m1.8.8.2.2.2.2" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2.cmml"><mi id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.2" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.2.cmml">σ</mi><mrow id="S3.SS2.p8.3.m1.6.6.3.5" xref="S3.SS2.p8.3.m1.6.6.3.4.cmml"><mi id="S3.SS2.p8.3.m1.4.4.1.1" xref="S3.SS2.p8.3.m1.4.4.1.1.cmml">i</mi><mo id="S3.SS2.p8.3.m1.6.6.3.5.1" xref="S3.SS2.p8.3.m1.6.6.3.4.cmml">,</mo><mi id="S3.SS2.p8.3.m1.5.5.2.2" xref="S3.SS2.p8.3.m1.5.5.2.2.cmml">b</mi><mo id="S3.SS2.p8.3.m1.6.6.3.5.2" xref="S3.SS2.p8.3.m1.6.6.3.4.cmml">,</mo><mi id="S3.SS2.p8.3.m1.6.6.3.3" xref="S3.SS2.p8.3.m1.6.6.3.3.cmml">j</mi></mrow><mn id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.3" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.3.cmml">2</mn></msubsup><mo stretchy="false" id="S3.SS2.p8.3.m1.8.8.2.2.2.5" xref="S3.SS2.p8.3.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.3.m1.8b"><apply id="S3.SS2.p8.3.m1.8.8.cmml" xref="S3.SS2.p8.3.m1.8.8"><eq id="S3.SS2.p8.3.m1.8.8.3.cmml" xref="S3.SS2.p8.3.m1.8.8.3"></eq><apply id="S3.SS2.p8.3.m1.8.8.4.cmml" xref="S3.SS2.p8.3.m1.8.8.4"><csymbol cd="ambiguous" id="S3.SS2.p8.3.m1.8.8.4.1.cmml" xref="S3.SS2.p8.3.m1.8.8.4">subscript</csymbol><ci id="S3.SS2.p8.3.m1.8.8.4.2.cmml" xref="S3.SS2.p8.3.m1.8.8.4.2">𝑃</ci><ci id="S3.SS2.p8.3.m1.8.8.4.3.cmml" xref="S3.SS2.p8.3.m1.8.8.4.3">𝑗</ci></apply><apply id="S3.SS2.p8.3.m1.8.8.2.cmml" xref="S3.SS2.p8.3.m1.8.8.2"><times id="S3.SS2.p8.3.m1.8.8.2.3.cmml" xref="S3.SS2.p8.3.m1.8.8.2.3"></times><ci id="S3.SS2.p8.3.m1.8.8.2.4.cmml" xref="S3.SS2.p8.3.m1.8.8.2.4">𝒩</ci><interval closure="open" id="S3.SS2.p8.3.m1.8.8.2.2.3.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2"><apply id="S3.SS2.p8.3.m1.7.7.1.1.1.1.cmml" xref="S3.SS2.p8.3.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.3.m1.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p8.3.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p8.3.m1.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p8.3.m1.7.7.1.1.1.1.2">𝜇</ci><list id="S3.SS2.p8.3.m1.3.3.3.4.cmml" xref="S3.SS2.p8.3.m1.3.3.3.5"><ci id="S3.SS2.p8.3.m1.1.1.1.1.cmml" xref="S3.SS2.p8.3.m1.1.1.1.1">𝑖</ci><ci id="S3.SS2.p8.3.m1.2.2.2.2.cmml" xref="S3.SS2.p8.3.m1.2.2.2.2">𝑏</ci><ci id="S3.SS2.p8.3.m1.3.3.3.3.cmml" xref="S3.SS2.p8.3.m1.3.3.3.3">𝑗</ci></list></apply><apply id="S3.SS2.p8.3.m1.8.8.2.2.2.2.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p8.3.m1.8.8.2.2.2.2.1.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.1.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2">superscript</csymbol><ci id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.2.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.2">𝜎</ci><cn type="integer" id="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.3.cmml" xref="S3.SS2.p8.3.m1.8.8.2.2.2.2.2.3">2</cn></apply><list id="S3.SS2.p8.3.m1.6.6.3.4.cmml" xref="S3.SS2.p8.3.m1.6.6.3.5"><ci id="S3.SS2.p8.3.m1.4.4.1.1.cmml" xref="S3.SS2.p8.3.m1.4.4.1.1">𝑖</ci><ci id="S3.SS2.p8.3.m1.5.5.2.2.cmml" xref="S3.SS2.p8.3.m1.5.5.2.2">𝑏</ci><ci id="S3.SS2.p8.3.m1.6.6.3.3.cmml" xref="S3.SS2.p8.3.m1.6.6.3.3">𝑗</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.3.m1.8c">P_{j}=\mathcal{N}(\mu_{i,b,j},\sigma^{2}_{i,b,j})</annotation></semantics></math>,
<math id="S3.SS2.p8.4.m2.8" class="ltx_Math" alttext="Q_{j}=\mathcal{N}(\hat{\mu}_{pt,b,j},\hat{\sigma}^{2}_{pt,b,j})" display="inline"><semantics id="S3.SS2.p8.4.m2.8a"><mrow id="S3.SS2.p8.4.m2.8.8" xref="S3.SS2.p8.4.m2.8.8.cmml"><msub id="S3.SS2.p8.4.m2.8.8.4" xref="S3.SS2.p8.4.m2.8.8.4.cmml"><mi id="S3.SS2.p8.4.m2.8.8.4.2" xref="S3.SS2.p8.4.m2.8.8.4.2.cmml">Q</mi><mi id="S3.SS2.p8.4.m2.8.8.4.3" xref="S3.SS2.p8.4.m2.8.8.4.3.cmml">j</mi></msub><mo id="S3.SS2.p8.4.m2.8.8.3" xref="S3.SS2.p8.4.m2.8.8.3.cmml">=</mo><mrow id="S3.SS2.p8.4.m2.8.8.2" xref="S3.SS2.p8.4.m2.8.8.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p8.4.m2.8.8.2.4" xref="S3.SS2.p8.4.m2.8.8.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.4.m2.8.8.2.3" xref="S3.SS2.p8.4.m2.8.8.2.3.cmml">​</mo><mrow id="S3.SS2.p8.4.m2.8.8.2.2.2" xref="S3.SS2.p8.4.m2.8.8.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p8.4.m2.8.8.2.2.2.3" xref="S3.SS2.p8.4.m2.8.8.2.2.3.cmml">(</mo><msub id="S3.SS2.p8.4.m2.7.7.1.1.1.1" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.cmml"><mi id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.2" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.2.cmml">μ</mi><mo id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.1" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p8.4.m2.3.3.3.3" xref="S3.SS2.p8.4.m2.3.3.3.4.cmml"><mrow id="S3.SS2.p8.4.m2.3.3.3.3.1" xref="S3.SS2.p8.4.m2.3.3.3.3.1.cmml"><mi id="S3.SS2.p8.4.m2.3.3.3.3.1.2" xref="S3.SS2.p8.4.m2.3.3.3.3.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.4.m2.3.3.3.3.1.1" xref="S3.SS2.p8.4.m2.3.3.3.3.1.1.cmml">​</mo><mi id="S3.SS2.p8.4.m2.3.3.3.3.1.3" xref="S3.SS2.p8.4.m2.3.3.3.3.1.3.cmml">t</mi></mrow><mo id="S3.SS2.p8.4.m2.3.3.3.3.2" xref="S3.SS2.p8.4.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p8.4.m2.1.1.1.1" xref="S3.SS2.p8.4.m2.1.1.1.1.cmml">b</mi><mo id="S3.SS2.p8.4.m2.3.3.3.3.3" xref="S3.SS2.p8.4.m2.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p8.4.m2.2.2.2.2" xref="S3.SS2.p8.4.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p8.4.m2.8.8.2.2.2.4" xref="S3.SS2.p8.4.m2.8.8.2.2.3.cmml">,</mo><msubsup id="S3.SS2.p8.4.m2.8.8.2.2.2.2" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.2" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.2.cmml">σ</mi><mo id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.1" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p8.4.m2.6.6.3.3" xref="S3.SS2.p8.4.m2.6.6.3.4.cmml"><mrow id="S3.SS2.p8.4.m2.6.6.3.3.1" xref="S3.SS2.p8.4.m2.6.6.3.3.1.cmml"><mi id="S3.SS2.p8.4.m2.6.6.3.3.1.2" xref="S3.SS2.p8.4.m2.6.6.3.3.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.4.m2.6.6.3.3.1.1" xref="S3.SS2.p8.4.m2.6.6.3.3.1.1.cmml">​</mo><mi id="S3.SS2.p8.4.m2.6.6.3.3.1.3" xref="S3.SS2.p8.4.m2.6.6.3.3.1.3.cmml">t</mi></mrow><mo id="S3.SS2.p8.4.m2.6.6.3.3.2" xref="S3.SS2.p8.4.m2.6.6.3.4.cmml">,</mo><mi id="S3.SS2.p8.4.m2.4.4.1.1" xref="S3.SS2.p8.4.m2.4.4.1.1.cmml">b</mi><mo id="S3.SS2.p8.4.m2.6.6.3.3.3" xref="S3.SS2.p8.4.m2.6.6.3.4.cmml">,</mo><mi id="S3.SS2.p8.4.m2.5.5.2.2" xref="S3.SS2.p8.4.m2.5.5.2.2.cmml">j</mi></mrow><mn id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.3" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.3.cmml">2</mn></msubsup><mo stretchy="false" id="S3.SS2.p8.4.m2.8.8.2.2.2.5" xref="S3.SS2.p8.4.m2.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.4.m2.8b"><apply id="S3.SS2.p8.4.m2.8.8.cmml" xref="S3.SS2.p8.4.m2.8.8"><eq id="S3.SS2.p8.4.m2.8.8.3.cmml" xref="S3.SS2.p8.4.m2.8.8.3"></eq><apply id="S3.SS2.p8.4.m2.8.8.4.cmml" xref="S3.SS2.p8.4.m2.8.8.4"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m2.8.8.4.1.cmml" xref="S3.SS2.p8.4.m2.8.8.4">subscript</csymbol><ci id="S3.SS2.p8.4.m2.8.8.4.2.cmml" xref="S3.SS2.p8.4.m2.8.8.4.2">𝑄</ci><ci id="S3.SS2.p8.4.m2.8.8.4.3.cmml" xref="S3.SS2.p8.4.m2.8.8.4.3">𝑗</ci></apply><apply id="S3.SS2.p8.4.m2.8.8.2.cmml" xref="S3.SS2.p8.4.m2.8.8.2"><times id="S3.SS2.p8.4.m2.8.8.2.3.cmml" xref="S3.SS2.p8.4.m2.8.8.2.3"></times><ci id="S3.SS2.p8.4.m2.8.8.2.4.cmml" xref="S3.SS2.p8.4.m2.8.8.2.4">𝒩</ci><interval closure="open" id="S3.SS2.p8.4.m2.8.8.2.2.3.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2"><apply id="S3.SS2.p8.4.m2.7.7.1.1.1.1.cmml" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m2.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2"><ci id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.1.cmml" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.2.cmml" xref="S3.SS2.p8.4.m2.7.7.1.1.1.1.2.2">𝜇</ci></apply><list id="S3.SS2.p8.4.m2.3.3.3.4.cmml" xref="S3.SS2.p8.4.m2.3.3.3.3"><apply id="S3.SS2.p8.4.m2.3.3.3.3.1.cmml" xref="S3.SS2.p8.4.m2.3.3.3.3.1"><times id="S3.SS2.p8.4.m2.3.3.3.3.1.1.cmml" xref="S3.SS2.p8.4.m2.3.3.3.3.1.1"></times><ci id="S3.SS2.p8.4.m2.3.3.3.3.1.2.cmml" xref="S3.SS2.p8.4.m2.3.3.3.3.1.2">𝑝</ci><ci id="S3.SS2.p8.4.m2.3.3.3.3.1.3.cmml" xref="S3.SS2.p8.4.m2.3.3.3.3.1.3">𝑡</ci></apply><ci id="S3.SS2.p8.4.m2.1.1.1.1.cmml" xref="S3.SS2.p8.4.m2.1.1.1.1">𝑏</ci><ci id="S3.SS2.p8.4.m2.2.2.2.2.cmml" xref="S3.SS2.p8.4.m2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p8.4.m2.8.8.2.2.2.2.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m2.8.8.2.2.2.2.1.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2">subscript</csymbol><apply id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.1.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2"><ci id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.1">^</ci><ci id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.2.2">𝜎</ci></apply><cn type="integer" id="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.3.cmml" xref="S3.SS2.p8.4.m2.8.8.2.2.2.2.2.3">2</cn></apply><list id="S3.SS2.p8.4.m2.6.6.3.4.cmml" xref="S3.SS2.p8.4.m2.6.6.3.3"><apply id="S3.SS2.p8.4.m2.6.6.3.3.1.cmml" xref="S3.SS2.p8.4.m2.6.6.3.3.1"><times id="S3.SS2.p8.4.m2.6.6.3.3.1.1.cmml" xref="S3.SS2.p8.4.m2.6.6.3.3.1.1"></times><ci id="S3.SS2.p8.4.m2.6.6.3.3.1.2.cmml" xref="S3.SS2.p8.4.m2.6.6.3.3.1.2">𝑝</ci><ci id="S3.SS2.p8.4.m2.6.6.3.3.1.3.cmml" xref="S3.SS2.p8.4.m2.6.6.3.3.1.3">𝑡</ci></apply><ci id="S3.SS2.p8.4.m2.4.4.1.1.cmml" xref="S3.SS2.p8.4.m2.4.4.1.1">𝑏</ci><ci id="S3.SS2.p8.4.m2.5.5.2.2.cmml" xref="S3.SS2.p8.4.m2.5.5.2.2">𝑗</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.4.m2.8c">Q_{j}=\mathcal{N}(\hat{\mu}_{pt,b,j},\hat{\sigma}^{2}_{pt,b,j})</annotation></semantics></math>, <math id="S3.SS2.p8.5.m3.1" class="ltx_Math" alttext="D_{KL}" display="inline"><semantics id="S3.SS2.p8.5.m3.1a"><msub id="S3.SS2.p8.5.m3.1.1" xref="S3.SS2.p8.5.m3.1.1.cmml"><mi id="S3.SS2.p8.5.m3.1.1.2" xref="S3.SS2.p8.5.m3.1.1.2.cmml">D</mi><mrow id="S3.SS2.p8.5.m3.1.1.3" xref="S3.SS2.p8.5.m3.1.1.3.cmml"><mi id="S3.SS2.p8.5.m3.1.1.3.2" xref="S3.SS2.p8.5.m3.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.5.m3.1.1.3.1" xref="S3.SS2.p8.5.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p8.5.m3.1.1.3.3" xref="S3.SS2.p8.5.m3.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.5.m3.1b"><apply id="S3.SS2.p8.5.m3.1.1.cmml" xref="S3.SS2.p8.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.5.m3.1.1.1.cmml" xref="S3.SS2.p8.5.m3.1.1">subscript</csymbol><ci id="S3.SS2.p8.5.m3.1.1.2.cmml" xref="S3.SS2.p8.5.m3.1.1.2">𝐷</ci><apply id="S3.SS2.p8.5.m3.1.1.3.cmml" xref="S3.SS2.p8.5.m3.1.1.3"><times id="S3.SS2.p8.5.m3.1.1.3.1.cmml" xref="S3.SS2.p8.5.m3.1.1.3.1"></times><ci id="S3.SS2.p8.5.m3.1.1.3.2.cmml" xref="S3.SS2.p8.5.m3.1.1.3.2">𝐾</ci><ci id="S3.SS2.p8.5.m3.1.1.3.3.cmml" xref="S3.SS2.p8.5.m3.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.5.m3.1c">D_{KL}</annotation></semantics></math> is the KL divergence and <math id="S3.SS2.p8.6.m4.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S3.SS2.p8.6.m4.1a"><mi id="S3.SS2.p8.6.m4.1.1" xref="S3.SS2.p8.6.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.6.m4.1b"><ci id="S3.SS2.p8.6.m4.1.1.cmml" xref="S3.SS2.p8.6.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.6.m4.1c">J</annotation></semantics></math> is the number of channels of the input feature. <math id="S3.SS2.p8.7.m5.1" class="ltx_Math" alttext="\xi" display="inline"><semantics id="S3.SS2.p8.7.m5.1a"><mi id="S3.SS2.p8.7.m5.1.1" xref="S3.SS2.p8.7.m5.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.7.m5.1b"><ci id="S3.SS2.p8.7.m5.1.1.cmml" xref="S3.SS2.p8.7.m5.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.7.m5.1c">\xi</annotation></semantics></math> is then used as an input to BNNet, which learns to estimate <math id="S3.SS2.p8.8.m6.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S3.SS2.p8.8.m6.1a"><mi id="S3.SS2.p8.8.m6.1.1" xref="S3.SS2.p8.8.m6.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.8.m6.1b"><ci id="S3.SS2.p8.8.m6.1.1.cmml" xref="S3.SS2.p8.8.m6.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.8.m6.1c">\boldsymbol{\beta}</annotation></semantics></math> as shown in Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.1" class="ltx_p">Similarly, we compute the mean and SD of each input feature per layer by performing a forward pass of the local dataset on the pretrained model and use it as an input to LRNet. Following best practices from previous non-FL hyperparameter optimization works <cite class="ltx_cite ltx_citemacro_cite">Oreshkin et al. (<a href="#bib.bib49" title="" class="ltx_ref">2018</a>); Baik et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>, we use a learnable post-multiplier <math id="S3.SS2.p9.1.m1.3" class="ltx_Math" alttext="\tilde{\boldsymbol{\eta}}=\tilde{\eta}_{1},\ldots,\tilde{\eta}_{2M}" display="inline"><semantics id="S3.SS2.p9.1.m1.3a"><mrow id="S3.SS2.p9.1.m1.3.3" xref="S3.SS2.p9.1.m1.3.3.cmml"><mover accent="true" id="S3.SS2.p9.1.m1.3.3.4" xref="S3.SS2.p9.1.m1.3.3.4.cmml"><mi id="S3.SS2.p9.1.m1.3.3.4.2" xref="S3.SS2.p9.1.m1.3.3.4.2.cmml">𝜼</mi><mo id="S3.SS2.p9.1.m1.3.3.4.1" xref="S3.SS2.p9.1.m1.3.3.4.1.cmml">~</mo></mover><mo id="S3.SS2.p9.1.m1.3.3.3" xref="S3.SS2.p9.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p9.1.m1.3.3.2.2" xref="S3.SS2.p9.1.m1.3.3.2.3.cmml"><msub id="S3.SS2.p9.1.m1.2.2.1.1.1" xref="S3.SS2.p9.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="S3.SS2.p9.1.m1.2.2.1.1.1.2" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p9.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2.2.cmml">η</mi><mo id="S3.SS2.p9.1.m1.2.2.1.1.1.2.1" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2.1.cmml">~</mo></mover><mn id="S3.SS2.p9.1.m1.2.2.1.1.1.3" xref="S3.SS2.p9.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p9.1.m1.3.3.2.2.3" xref="S3.SS2.p9.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p9.1.m1.3.3.2.2.4" xref="S3.SS2.p9.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p9.1.m1.3.3.2.2.2" xref="S3.SS2.p9.1.m1.3.3.2.2.2.cmml"><mover accent="true" id="S3.SS2.p9.1.m1.3.3.2.2.2.2" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS2.p9.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2.2.cmml">η</mi><mo id="S3.SS2.p9.1.m1.3.3.2.2.2.2.1" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS2.p9.1.m1.3.3.2.2.2.3" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.cmml"><mn id="S3.SS2.p9.1.m1.3.3.2.2.2.3.2" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p9.1.m1.3.3.2.2.2.3.1" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p9.1.m1.3.3.2.2.2.3.3" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.3.cmml">M</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.3b"><apply id="S3.SS2.p9.1.m1.3.3.cmml" xref="S3.SS2.p9.1.m1.3.3"><eq id="S3.SS2.p9.1.m1.3.3.3.cmml" xref="S3.SS2.p9.1.m1.3.3.3"></eq><apply id="S3.SS2.p9.1.m1.3.3.4.cmml" xref="S3.SS2.p9.1.m1.3.3.4"><ci id="S3.SS2.p9.1.m1.3.3.4.1.cmml" xref="S3.SS2.p9.1.m1.3.3.4.1">~</ci><ci id="S3.SS2.p9.1.m1.3.3.4.2.cmml" xref="S3.SS2.p9.1.m1.3.3.4.2">𝜼</ci></apply><list id="S3.SS2.p9.1.m1.3.3.2.3.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2"><apply id="S3.SS2.p9.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p9.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2"><ci id="S3.SS2.p9.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2.1">~</ci><ci id="S3.SS2.p9.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1.2.2">𝜂</ci></apply><cn type="integer" id="S3.SS2.p9.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">…</ci><apply id="S3.SS2.p9.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p9.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2"><ci id="S3.SS2.p9.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2.1">~</ci><ci id="S3.SS2.p9.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.2.2">𝜂</ci></apply><apply id="S3.SS2.p9.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3"><times id="S3.SS2.p9.1.m1.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.1"></times><cn type="integer" id="S3.SS2.p9.1.m1.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.2">2</cn><ci id="S3.SS2.p9.1.m1.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p9.1.m1.3.3.2.2.2.3.3">𝑀</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.3c">\tilde{\boldsymbol{\eta}}=\tilde{\eta}_{1},\ldots,\tilde{\eta}_{2M}</annotation></semantics></math> to avoid limiting the range of the resulting learning rates (Eq <a href="#S3.E4" title="Equation 4 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). </p>
<table id="A6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E4.m1.94" class="ltx_Math" alttext="\displaystyle\begin{split}\boldsymbol{\beta}=\text{BNNet}&amp;(\boldsymbol{w}_{bn};\xi_{1},\xi_{2},\ldots,\xi_{B-1},\xi_{B})\\
\boldsymbol{\eta}=\text{LRNet}&amp;(\boldsymbol{w}_{lr};E(x_{0}),SD(x_{0}),E(x_{1}),SD(x_{1})\ldots,E(x_{M-1}),SD(x_{M-1}))\odot\tilde{\boldsymbol{\eta}}\end{split}" display="inline"><semantics id="S3.E4.m1.94a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E4.m1.94.94.24" xref="S3.E4.m1.82.82.12.cmml"><mtr id="S3.E4.m1.94.94.24a" xref="S3.E4.m1.82.82.12.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.94.94.24b" xref="S3.E4.m1.82.82.12.cmml"><mrow id="S3.E4.m1.3.3.3.3.3a" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">𝜷</mi><mo id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">=</mo><mtext id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3a.cmml">BNNet</mtext></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.94.94.24c" xref="S3.E4.m1.82.82.12.cmml"><mrow id="S3.E4.m1.87.87.17.75.26.23.23" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.4.1.1" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.83.83.13.71.22.19.19.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.5.5.5.5.2.2" xref="S3.E4.m1.5.5.5.5.2.2.cmml">𝒘</mi><mrow id="S3.E4.m1.6.6.6.6.3.3.1" xref="S3.E4.m1.6.6.6.6.3.3.1.cmml"><mi id="S3.E4.m1.6.6.6.6.3.3.1.2" xref="S3.E4.m1.6.6.6.6.3.3.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.6.6.3.3.1.1" xref="S3.E4.m1.6.6.6.6.3.3.1.1.cmml">​</mo><mi id="S3.E4.m1.6.6.6.6.3.3.1.3" xref="S3.E4.m1.6.6.6.6.3.3.1.3.cmml">n</mi></mrow></msub><mo id="S3.E4.m1.7.7.7.7.4.4" xref="S3.E4.m1.82.82.12a.cmml">;</mo><msub id="S3.E4.m1.84.84.14.72.23.20.20.2" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.8.8.8.8.5.5" xref="S3.E4.m1.8.8.8.8.5.5.cmml">ξ</mi><mn id="S3.E4.m1.9.9.9.9.6.6.1" xref="S3.E4.m1.9.9.9.9.6.6.1.cmml">1</mn></msub><mo id="S3.E4.m1.10.10.10.10.7.7" xref="S3.E4.m1.82.82.12a.cmml">,</mo><msub id="S3.E4.m1.85.85.15.73.24.21.21.3" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.11.11.11.11.8.8" xref="S3.E4.m1.11.11.11.11.8.8.cmml">ξ</mi><mn id="S3.E4.m1.12.12.12.12.9.9.1" xref="S3.E4.m1.12.12.12.12.9.9.1.cmml">2</mn></msub><mo id="S3.E4.m1.13.13.13.13.10.10" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.14.14.14.14.11.11" xref="S3.E4.m1.14.14.14.14.11.11.cmml">…</mi><mo id="S3.E4.m1.15.15.15.15.12.12" xref="S3.E4.m1.82.82.12a.cmml">,</mo><msub id="S3.E4.m1.86.86.16.74.25.22.22.4" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.16.16.16.16.13.13" xref="S3.E4.m1.16.16.16.16.13.13.cmml">ξ</mi><mrow id="S3.E4.m1.17.17.17.17.14.14.1" xref="S3.E4.m1.17.17.17.17.14.14.1.cmml"><mi id="S3.E4.m1.17.17.17.17.14.14.1.2" xref="S3.E4.m1.17.17.17.17.14.14.1.2.cmml">B</mi><mo id="S3.E4.m1.17.17.17.17.14.14.1.1" xref="S3.E4.m1.17.17.17.17.14.14.1.1.cmml">−</mo><mn id="S3.E4.m1.17.17.17.17.14.14.1.3" xref="S3.E4.m1.17.17.17.17.14.14.1.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.18.18.18.18.15.15" xref="S3.E4.m1.82.82.12a.cmml">,</mo><msub id="S3.E4.m1.87.87.17.75.26.23.23.5" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.19.19.19.19.16.16" xref="S3.E4.m1.19.19.19.19.16.16.cmml">ξ</mi><mi id="S3.E4.m1.20.20.20.20.17.17.1" xref="S3.E4.m1.20.20.20.20.17.17.1.cmml">B</mi></msub><mo stretchy="false" id="S3.E4.m1.21.21.21.21.18.18" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mtd></mtr><mtr id="S3.E4.m1.94.94.24d" xref="S3.E4.m1.82.82.12.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.94.94.24e" xref="S3.E4.m1.82.82.12.cmml"><mrow id="S3.E4.m1.24.24.24.3.3a" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.22.22.22.1.1.1" xref="S3.E4.m1.22.22.22.1.1.1.cmml">𝜼</mi><mo id="S3.E4.m1.23.23.23.2.2.2" xref="S3.E4.m1.23.23.23.2.2.2.cmml">=</mo><mtext id="S3.E4.m1.24.24.24.3.3.3" xref="S3.E4.m1.24.24.24.3.3.3a.cmml">LRNet</mtext></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.94.94.24f" xref="S3.E4.m1.82.82.12.cmml"><mrow id="S3.E4.m1.94.94.24.82.56.53" xref="S3.E4.m1.82.82.12.cmml"><mrow id="S3.E4.m1.94.94.24.82.56.53.53.7" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.25.25.25.4.1.1" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.88.88.18.76.50.47.47.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.26.26.26.5.2.2" xref="S3.E4.m1.26.26.26.5.2.2.cmml">𝒘</mi><mrow id="S3.E4.m1.27.27.27.6.3.3.1" xref="S3.E4.m1.27.27.27.6.3.3.1.cmml"><mi id="S3.E4.m1.27.27.27.6.3.3.1.2" xref="S3.E4.m1.27.27.27.6.3.3.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.27.27.27.6.3.3.1.1" xref="S3.E4.m1.27.27.27.6.3.3.1.1.cmml">​</mo><mi id="S3.E4.m1.27.27.27.6.3.3.1.3" xref="S3.E4.m1.27.27.27.6.3.3.1.3.cmml">r</mi></mrow></msub><mo id="S3.E4.m1.28.28.28.7.4.4" xref="S3.E4.m1.82.82.12a.cmml">;</mo><mrow id="S3.E4.m1.89.89.19.77.51.48.48.2.2" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.29.29.29.8.5.5" xref="S3.E4.m1.29.29.29.8.5.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.89.89.19.77.51.48.48.2.2.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.89.89.19.77.51.48.48.2.2.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.30.30.30.9.6.6" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.89.89.19.77.51.48.48.2.2.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.31.31.31.10.7.7" xref="S3.E4.m1.31.31.31.10.7.7.cmml">x</mi><mn id="S3.E4.m1.32.32.32.11.8.8.1" xref="S3.E4.m1.32.32.32.11.8.8.1.cmml">0</mn></msub><mo stretchy="false" id="S3.E4.m1.33.33.33.12.9.9" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.34.34.34.13.10.10" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mrow id="S3.E4.m1.90.90.20.78.52.49.49.3.3" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.35.35.35.14.11.11" xref="S3.E4.m1.35.35.35.14.11.11.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.90.90.20.78.52.49.49.3.3.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mi id="S3.E4.m1.36.36.36.15.12.12" xref="S3.E4.m1.36.36.36.15.12.12.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.90.90.20.78.52.49.49.3.3.2a" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.90.90.20.78.52.49.49.3.3.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.37.37.37.16.13.13" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.90.90.20.78.52.49.49.3.3.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.38.38.38.17.14.14" xref="S3.E4.m1.38.38.38.17.14.14.cmml">x</mi><mn id="S3.E4.m1.39.39.39.18.15.15.1" xref="S3.E4.m1.39.39.39.18.15.15.1.cmml">0</mn></msub><mo stretchy="false" id="S3.E4.m1.40.40.40.19.16.16" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.41.41.41.20.17.17" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mrow id="S3.E4.m1.91.91.21.79.53.50.50.4.4" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.42.42.42.21.18.18" xref="S3.E4.m1.42.42.42.21.18.18.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.91.91.21.79.53.50.50.4.4.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.91.91.21.79.53.50.50.4.4.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.43.43.43.22.19.19" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.91.91.21.79.53.50.50.4.4.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.44.44.44.23.20.20" xref="S3.E4.m1.44.44.44.23.20.20.cmml">x</mi><mn id="S3.E4.m1.45.45.45.24.21.21.1" xref="S3.E4.m1.45.45.45.24.21.21.1.cmml">1</mn></msub><mo stretchy="false" id="S3.E4.m1.46.46.46.25.22.22" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.47.47.47.26.23.23" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mrow id="S3.E4.m1.92.92.22.80.54.51.51.5.5" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.48.48.48.27.24.24" xref="S3.E4.m1.48.48.48.27.24.24.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.92.92.22.80.54.51.51.5.5.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mi id="S3.E4.m1.49.49.49.28.25.25" xref="S3.E4.m1.49.49.49.28.25.25.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.92.92.22.80.54.51.51.5.5.2a" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.92.92.22.80.54.51.51.5.5.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.50.50.50.29.26.26" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.92.92.22.80.54.51.51.5.5.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.51.51.51.30.27.27" xref="S3.E4.m1.51.51.51.30.27.27.cmml">x</mi><mn id="S3.E4.m1.52.52.52.31.28.28.1" xref="S3.E4.m1.52.52.52.31.28.28.1.cmml">1</mn></msub><mo stretchy="false" id="S3.E4.m1.53.53.53.32.29.29" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.92.92.22.80.54.51.51.5.5.2b" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.54.54.54.33.30.30" xref="S3.E4.m1.54.54.54.33.30.30.cmml">…</mi></mrow><mo id="S3.E4.m1.55.55.55.34.31.31" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mrow id="S3.E4.m1.93.93.23.81.55.52.52.6.6" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.56.56.56.35.32.32" xref="S3.E4.m1.56.56.56.35.32.32.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.93.93.23.81.55.52.52.6.6.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.93.93.23.81.55.52.52.6.6.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.57.57.57.36.33.33" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.93.93.23.81.55.52.52.6.6.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.58.58.58.37.34.34" xref="S3.E4.m1.58.58.58.37.34.34.cmml">x</mi><mrow id="S3.E4.m1.59.59.59.38.35.35.1" xref="S3.E4.m1.59.59.59.38.35.35.1.cmml"><mi id="S3.E4.m1.59.59.59.38.35.35.1.2" xref="S3.E4.m1.59.59.59.38.35.35.1.2.cmml">M</mi><mo id="S3.E4.m1.59.59.59.38.35.35.1.1" xref="S3.E4.m1.59.59.59.38.35.35.1.1.cmml">−</mo><mn id="S3.E4.m1.59.59.59.38.35.35.1.3" xref="S3.E4.m1.59.59.59.38.35.35.1.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E4.m1.60.60.60.39.36.36" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.61.61.61.40.37.37" xref="S3.E4.m1.82.82.12a.cmml">,</mo><mrow id="S3.E4.m1.94.94.24.82.56.53.53.7.7" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.62.62.62.41.38.38" xref="S3.E4.m1.62.62.62.41.38.38.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.94.94.24.82.56.53.53.7.7.2" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mi id="S3.E4.m1.63.63.63.42.39.39" xref="S3.E4.m1.63.63.63.42.39.39.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.94.94.24.82.56.53.53.7.7.2a" xref="S3.E4.m1.82.82.12a.cmml">​</mo><mrow id="S3.E4.m1.94.94.24.82.56.53.53.7.7.1.1" xref="S3.E4.m1.82.82.12.cmml"><mo stretchy="false" id="S3.E4.m1.64.64.64.43.40.40" xref="S3.E4.m1.82.82.12a.cmml">(</mo><msub id="S3.E4.m1.94.94.24.82.56.53.53.7.7.1.1.1" xref="S3.E4.m1.82.82.12.cmml"><mi id="S3.E4.m1.65.65.65.44.41.41" xref="S3.E4.m1.65.65.65.44.41.41.cmml">x</mi><mrow id="S3.E4.m1.66.66.66.45.42.42.1" xref="S3.E4.m1.66.66.66.45.42.42.1.cmml"><mi id="S3.E4.m1.66.66.66.45.42.42.1.2" xref="S3.E4.m1.66.66.66.45.42.42.1.2.cmml">M</mi><mo id="S3.E4.m1.66.66.66.45.42.42.1.1" xref="S3.E4.m1.66.66.66.45.42.42.1.1.cmml">−</mo><mn id="S3.E4.m1.66.66.66.45.42.42.1.3" xref="S3.E4.m1.66.66.66.45.42.42.1.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E4.m1.67.67.67.46.43.43" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.68.68.68.47.44.44" xref="S3.E4.m1.82.82.12a.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.69.69.69.48.45.45" xref="S3.E4.m1.69.69.69.48.45.45.cmml">⊙</mo><mover accent="true" id="S3.E4.m1.70.70.70.49.46.46" xref="S3.E4.m1.70.70.70.49.46.46.cmml"><mi id="S3.E4.m1.70.70.70.49.46.46.2" xref="S3.E4.m1.70.70.70.49.46.46.2.cmml">𝜼</mi><mo id="S3.E4.m1.70.70.70.49.46.46.1" xref="S3.E4.m1.70.70.70.49.46.46.1.cmml">~</mo></mover></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.94b"><apply id="S3.E4.m1.82.82.12.cmml" xref="S3.E4.m1.94.94.24"><and id="S3.E4.m1.82.82.12a.cmml" xref="S3.E4.m1.4.4.4.4.1.1"></and><apply id="S3.E4.m1.82.82.12b.cmml" xref="S3.E4.m1.94.94.24"><eq id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"></eq><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝜷</ci><apply id="S3.E4.m1.75.75.5.5.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.75.75.5.5.6.cmml" xref="S3.E4.m1.4.4.4.4.1.1"></times><ci id="S3.E4.m1.3.3.3.3.3.3a.cmml" xref="S3.E4.m1.3.3.3.3.3.3"><mtext id="S3.E4.m1.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3">BNNet</mtext></ci><list id="S3.E4.m1.75.75.5.5.5.6.cmml" xref="S3.E4.m1.94.94.24"><apply id="S3.E4.m1.71.71.1.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.71.71.1.1.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.5.5.5.5.2.2.cmml" xref="S3.E4.m1.5.5.5.5.2.2">𝒘</ci><apply id="S3.E4.m1.6.6.6.6.3.3.1.cmml" xref="S3.E4.m1.6.6.6.6.3.3.1"><times id="S3.E4.m1.6.6.6.6.3.3.1.1.cmml" xref="S3.E4.m1.6.6.6.6.3.3.1.1"></times><ci id="S3.E4.m1.6.6.6.6.3.3.1.2.cmml" xref="S3.E4.m1.6.6.6.6.3.3.1.2">𝑏</ci><ci id="S3.E4.m1.6.6.6.6.3.3.1.3.cmml" xref="S3.E4.m1.6.6.6.6.3.3.1.3">𝑛</ci></apply></apply><apply id="S3.E4.m1.72.72.2.2.2.2.2.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.72.72.2.2.2.2.2.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.8.8.8.8.5.5.cmml" xref="S3.E4.m1.8.8.8.8.5.5">𝜉</ci><cn type="integer" id="S3.E4.m1.9.9.9.9.6.6.1.cmml" xref="S3.E4.m1.9.9.9.9.6.6.1">1</cn></apply><apply id="S3.E4.m1.73.73.3.3.3.3.3.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.73.73.3.3.3.3.3.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.11.11.11.11.8.8.cmml" xref="S3.E4.m1.11.11.11.11.8.8">𝜉</ci><cn type="integer" id="S3.E4.m1.12.12.12.12.9.9.1.cmml" xref="S3.E4.m1.12.12.12.12.9.9.1">2</cn></apply><ci id="S3.E4.m1.14.14.14.14.11.11.cmml" xref="S3.E4.m1.14.14.14.14.11.11">…</ci><apply id="S3.E4.m1.74.74.4.4.4.4.4.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.74.74.4.4.4.4.4.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.16.16.16.16.13.13.cmml" xref="S3.E4.m1.16.16.16.16.13.13">𝜉</ci><apply id="S3.E4.m1.17.17.17.17.14.14.1.cmml" xref="S3.E4.m1.17.17.17.17.14.14.1"><minus id="S3.E4.m1.17.17.17.17.14.14.1.1.cmml" xref="S3.E4.m1.17.17.17.17.14.14.1.1"></minus><ci id="S3.E4.m1.17.17.17.17.14.14.1.2.cmml" xref="S3.E4.m1.17.17.17.17.14.14.1.2">𝐵</ci><cn type="integer" id="S3.E4.m1.17.17.17.17.14.14.1.3.cmml" xref="S3.E4.m1.17.17.17.17.14.14.1.3">1</cn></apply></apply><apply id="S3.E4.m1.75.75.5.5.5.5.5.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.75.75.5.5.5.5.5.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.19.19.19.19.16.16.cmml" xref="S3.E4.m1.19.19.19.19.16.16">𝜉</ci><ci id="S3.E4.m1.20.20.20.20.17.17.1.cmml" xref="S3.E4.m1.20.20.20.20.17.17.1">𝐵</ci></apply></list><ci id="S3.E4.m1.22.22.22.1.1.1.cmml" xref="S3.E4.m1.22.22.22.1.1.1">𝜼</ci></apply></apply><apply id="S3.E4.m1.82.82.12c.cmml" xref="S3.E4.m1.94.94.24"><eq id="S3.E4.m1.23.23.23.2.2.2.cmml" xref="S3.E4.m1.23.23.23.2.2.2"></eq><share href="#S3.E4.m1.75.75.5.5.cmml" id="S3.E4.m1.82.82.12d.cmml" xref="S3.E4.m1.4.4.4.4.1.1"></share><apply id="S3.E4.m1.82.82.12.12.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="latexml" id="S3.E4.m1.69.69.69.48.45.45.cmml" xref="S3.E4.m1.69.69.69.48.45.45">direct-product</csymbol><apply id="S3.E4.m1.82.82.12.12.7.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.82.82.12.12.7.8.cmml" xref="S3.E4.m1.4.4.4.4.1.1"></times><ci id="S3.E4.m1.24.24.24.3.3.3a.cmml" xref="S3.E4.m1.24.24.24.3.3.3"><mtext id="S3.E4.m1.24.24.24.3.3.3.cmml" xref="S3.E4.m1.24.24.24.3.3.3">LRNet</mtext></ci><list id="S3.E4.m1.82.82.12.12.7.7.8.cmml" xref="S3.E4.m1.94.94.24"><apply id="S3.E4.m1.76.76.6.6.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.76.76.6.6.1.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.26.26.26.5.2.2.cmml" xref="S3.E4.m1.26.26.26.5.2.2">𝒘</ci><apply id="S3.E4.m1.27.27.27.6.3.3.1.cmml" xref="S3.E4.m1.27.27.27.6.3.3.1"><times id="S3.E4.m1.27.27.27.6.3.3.1.1.cmml" xref="S3.E4.m1.27.27.27.6.3.3.1.1"></times><ci id="S3.E4.m1.27.27.27.6.3.3.1.2.cmml" xref="S3.E4.m1.27.27.27.6.3.3.1.2">𝑙</ci><ci id="S3.E4.m1.27.27.27.6.3.3.1.3.cmml" xref="S3.E4.m1.27.27.27.6.3.3.1.3">𝑟</ci></apply></apply><apply id="S3.E4.m1.77.77.7.7.2.2.2.2.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.77.77.7.7.2.2.2.2.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.29.29.29.8.5.5.cmml" xref="S3.E4.m1.29.29.29.8.5.5">𝐸</ci><apply id="S3.E4.m1.77.77.7.7.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.77.77.7.7.2.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.31.31.31.10.7.7.cmml" xref="S3.E4.m1.31.31.31.10.7.7">𝑥</ci><cn type="integer" id="S3.E4.m1.32.32.32.11.8.8.1.cmml" xref="S3.E4.m1.32.32.32.11.8.8.1">0</cn></apply></apply><apply id="S3.E4.m1.78.78.8.8.3.3.3.3.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.78.78.8.8.3.3.3.3.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.35.35.35.14.11.11.cmml" xref="S3.E4.m1.35.35.35.14.11.11">𝑆</ci><ci id="S3.E4.m1.36.36.36.15.12.12.cmml" xref="S3.E4.m1.36.36.36.15.12.12">𝐷</ci><apply id="S3.E4.m1.78.78.8.8.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.78.78.8.8.3.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.38.38.38.17.14.14.cmml" xref="S3.E4.m1.38.38.38.17.14.14">𝑥</ci><cn type="integer" id="S3.E4.m1.39.39.39.18.15.15.1.cmml" xref="S3.E4.m1.39.39.39.18.15.15.1">0</cn></apply></apply><apply id="S3.E4.m1.79.79.9.9.4.4.4.4.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.79.79.9.9.4.4.4.4.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.42.42.42.21.18.18.cmml" xref="S3.E4.m1.42.42.42.21.18.18">𝐸</ci><apply id="S3.E4.m1.79.79.9.9.4.4.4.4.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.79.79.9.9.4.4.4.4.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.44.44.44.23.20.20.cmml" xref="S3.E4.m1.44.44.44.23.20.20">𝑥</ci><cn type="integer" id="S3.E4.m1.45.45.45.24.21.21.1.cmml" xref="S3.E4.m1.45.45.45.24.21.21.1">1</cn></apply></apply><apply id="S3.E4.m1.80.80.10.10.5.5.5.5.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.80.80.10.10.5.5.5.5.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.48.48.48.27.24.24.cmml" xref="S3.E4.m1.48.48.48.27.24.24">𝑆</ci><ci id="S3.E4.m1.49.49.49.28.25.25.cmml" xref="S3.E4.m1.49.49.49.28.25.25">𝐷</ci><apply id="S3.E4.m1.80.80.10.10.5.5.5.5.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.80.80.10.10.5.5.5.5.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.51.51.51.30.27.27.cmml" xref="S3.E4.m1.51.51.51.30.27.27">𝑥</ci><cn type="integer" id="S3.E4.m1.52.52.52.31.28.28.1.cmml" xref="S3.E4.m1.52.52.52.31.28.28.1">1</cn></apply><ci id="S3.E4.m1.54.54.54.33.30.30.cmml" xref="S3.E4.m1.54.54.54.33.30.30">…</ci></apply><apply id="S3.E4.m1.81.81.11.11.6.6.6.6.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.81.81.11.11.6.6.6.6.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.56.56.56.35.32.32.cmml" xref="S3.E4.m1.56.56.56.35.32.32">𝐸</ci><apply id="S3.E4.m1.81.81.11.11.6.6.6.6.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.81.81.11.11.6.6.6.6.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.58.58.58.37.34.34.cmml" xref="S3.E4.m1.58.58.58.37.34.34">𝑥</ci><apply id="S3.E4.m1.59.59.59.38.35.35.1.cmml" xref="S3.E4.m1.59.59.59.38.35.35.1"><minus id="S3.E4.m1.59.59.59.38.35.35.1.1.cmml" xref="S3.E4.m1.59.59.59.38.35.35.1.1"></minus><ci id="S3.E4.m1.59.59.59.38.35.35.1.2.cmml" xref="S3.E4.m1.59.59.59.38.35.35.1.2">𝑀</ci><cn type="integer" id="S3.E4.m1.59.59.59.38.35.35.1.3.cmml" xref="S3.E4.m1.59.59.59.38.35.35.1.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.82.82.12.12.7.7.7.7.cmml" xref="S3.E4.m1.94.94.24"><times id="S3.E4.m1.82.82.12.12.7.7.7.7.2.cmml" xref="S3.E4.m1.94.94.24"></times><ci id="S3.E4.m1.62.62.62.41.38.38.cmml" xref="S3.E4.m1.62.62.62.41.38.38">𝑆</ci><ci id="S3.E4.m1.63.63.63.42.39.39.cmml" xref="S3.E4.m1.63.63.63.42.39.39">𝐷</ci><apply id="S3.E4.m1.82.82.12.12.7.7.7.7.1.1.1.cmml" xref="S3.E4.m1.94.94.24"><csymbol cd="ambiguous" id="S3.E4.m1.82.82.12.12.7.7.7.7.1.1.1.1.cmml" xref="S3.E4.m1.94.94.24">subscript</csymbol><ci id="S3.E4.m1.65.65.65.44.41.41.cmml" xref="S3.E4.m1.65.65.65.44.41.41">𝑥</ci><apply id="S3.E4.m1.66.66.66.45.42.42.1.cmml" xref="S3.E4.m1.66.66.66.45.42.42.1"><minus id="S3.E4.m1.66.66.66.45.42.42.1.1.cmml" xref="S3.E4.m1.66.66.66.45.42.42.1.1"></minus><ci id="S3.E4.m1.66.66.66.45.42.42.1.2.cmml" xref="S3.E4.m1.66.66.66.45.42.42.1.2">𝑀</ci><cn type="integer" id="S3.E4.m1.66.66.66.45.42.42.1.3.cmml" xref="S3.E4.m1.66.66.66.45.42.42.1.3">1</cn></apply></apply></apply></list></apply><apply id="S3.E4.m1.70.70.70.49.46.46.cmml" xref="S3.E4.m1.70.70.70.49.46.46"><ci id="S3.E4.m1.70.70.70.49.46.46.1.cmml" xref="S3.E4.m1.70.70.70.49.46.46.1">~</ci><ci id="S3.E4.m1.70.70.70.49.46.46.2.cmml" xref="S3.E4.m1.70.70.70.49.46.46.2">𝜼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.94c">\displaystyle\begin{split}\boldsymbol{\beta}=\text{BNNet}&amp;(\boldsymbol{w}_{bn};\xi_{1},\xi_{2},\ldots,\xi_{B-1},\xi_{B})\\
\boldsymbol{\eta}=\text{LRNet}&amp;(\boldsymbol{w}_{lr};E(x_{0}),SD(x_{0}),E(x_{1}),SD(x_{1})\ldots,E(x_{M-1}),SD(x_{M-1}))\odot\tilde{\boldsymbol{\eta}}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p9.9" class="ltx_p">where <math id="S3.SS2.p9.2.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS2.p9.2.m1.1a"><mo id="S3.SS2.p9.2.m1.1.1" xref="S3.SS2.p9.2.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m1.1b"><csymbol cd="latexml" id="S3.SS2.p9.2.m1.1.1.cmml" xref="S3.SS2.p9.2.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m1.1c">\odot</annotation></semantics></math> is the Hadamard product, <math id="S3.SS2.p9.3.m2.1" class="ltx_Math" alttext="x_{m-1}" display="inline"><semantics id="S3.SS2.p9.3.m2.1a"><msub id="S3.SS2.p9.3.m2.1.1" xref="S3.SS2.p9.3.m2.1.1.cmml"><mi id="S3.SS2.p9.3.m2.1.1.2" xref="S3.SS2.p9.3.m2.1.1.2.cmml">x</mi><mrow id="S3.SS2.p9.3.m2.1.1.3" xref="S3.SS2.p9.3.m2.1.1.3.cmml"><mi id="S3.SS2.p9.3.m2.1.1.3.2" xref="S3.SS2.p9.3.m2.1.1.3.2.cmml">m</mi><mo id="S3.SS2.p9.3.m2.1.1.3.1" xref="S3.SS2.p9.3.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p9.3.m2.1.1.3.3" xref="S3.SS2.p9.3.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.3.m2.1b"><apply id="S3.SS2.p9.3.m2.1.1.cmml" xref="S3.SS2.p9.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m2.1.1.1.cmml" xref="S3.SS2.p9.3.m2.1.1">subscript</csymbol><ci id="S3.SS2.p9.3.m2.1.1.2.cmml" xref="S3.SS2.p9.3.m2.1.1.2">𝑥</ci><apply id="S3.SS2.p9.3.m2.1.1.3.cmml" xref="S3.SS2.p9.3.m2.1.1.3"><minus id="S3.SS2.p9.3.m2.1.1.3.1.cmml" xref="S3.SS2.p9.3.m2.1.1.3.1"></minus><ci id="S3.SS2.p9.3.m2.1.1.3.2.cmml" xref="S3.SS2.p9.3.m2.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p9.3.m2.1.1.3.3.cmml" xref="S3.SS2.p9.3.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.3.m2.1c">x_{m-1}</annotation></semantics></math> is the input feature to the <math id="S3.SS2.p9.4.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p9.4.m3.1a"><mi id="S3.SS2.p9.4.m3.1.1" xref="S3.SS2.p9.4.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.4.m3.1b"><ci id="S3.SS2.p9.4.m3.1.1.cmml" xref="S3.SS2.p9.4.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.4.m3.1c">m</annotation></semantics></math>-th layer, and <math id="S3.SS2.p9.5.m4.1" class="ltx_Math" alttext="\boldsymbol{w}_{bn}" display="inline"><semantics id="S3.SS2.p9.5.m4.1a"><msub id="S3.SS2.p9.5.m4.1.1" xref="S3.SS2.p9.5.m4.1.1.cmml"><mi id="S3.SS2.p9.5.m4.1.1.2" xref="S3.SS2.p9.5.m4.1.1.2.cmml">𝒘</mi><mrow id="S3.SS2.p9.5.m4.1.1.3" xref="S3.SS2.p9.5.m4.1.1.3.cmml"><mi id="S3.SS2.p9.5.m4.1.1.3.2" xref="S3.SS2.p9.5.m4.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p9.5.m4.1.1.3.1" xref="S3.SS2.p9.5.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p9.5.m4.1.1.3.3" xref="S3.SS2.p9.5.m4.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.5.m4.1b"><apply id="S3.SS2.p9.5.m4.1.1.cmml" xref="S3.SS2.p9.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.5.m4.1.1.1.cmml" xref="S3.SS2.p9.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.p9.5.m4.1.1.2.cmml" xref="S3.SS2.p9.5.m4.1.1.2">𝒘</ci><apply id="S3.SS2.p9.5.m4.1.1.3.cmml" xref="S3.SS2.p9.5.m4.1.1.3"><times id="S3.SS2.p9.5.m4.1.1.3.1.cmml" xref="S3.SS2.p9.5.m4.1.1.3.1"></times><ci id="S3.SS2.p9.5.m4.1.1.3.2.cmml" xref="S3.SS2.p9.5.m4.1.1.3.2">𝑏</ci><ci id="S3.SS2.p9.5.m4.1.1.3.3.cmml" xref="S3.SS2.p9.5.m4.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.5.m4.1c">\boldsymbol{w}_{bn}</annotation></semantics></math> and <math id="S3.SS2.p9.6.m5.1" class="ltx_Math" alttext="\boldsymbol{w}_{lr}" display="inline"><semantics id="S3.SS2.p9.6.m5.1a"><msub id="S3.SS2.p9.6.m5.1.1" xref="S3.SS2.p9.6.m5.1.1.cmml"><mi id="S3.SS2.p9.6.m5.1.1.2" xref="S3.SS2.p9.6.m5.1.1.2.cmml">𝒘</mi><mrow id="S3.SS2.p9.6.m5.1.1.3" xref="S3.SS2.p9.6.m5.1.1.3.cmml"><mi id="S3.SS2.p9.6.m5.1.1.3.2" xref="S3.SS2.p9.6.m5.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p9.6.m5.1.1.3.1" xref="S3.SS2.p9.6.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p9.6.m5.1.1.3.3" xref="S3.SS2.p9.6.m5.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.6.m5.1b"><apply id="S3.SS2.p9.6.m5.1.1.cmml" xref="S3.SS2.p9.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.6.m5.1.1.1.cmml" xref="S3.SS2.p9.6.m5.1.1">subscript</csymbol><ci id="S3.SS2.p9.6.m5.1.1.2.cmml" xref="S3.SS2.p9.6.m5.1.1.2">𝒘</ci><apply id="S3.SS2.p9.6.m5.1.1.3.cmml" xref="S3.SS2.p9.6.m5.1.1.3"><times id="S3.SS2.p9.6.m5.1.1.3.1.cmml" xref="S3.SS2.p9.6.m5.1.1.3.1"></times><ci id="S3.SS2.p9.6.m5.1.1.3.2.cmml" xref="S3.SS2.p9.6.m5.1.1.3.2">𝑙</ci><ci id="S3.SS2.p9.6.m5.1.1.3.3.cmml" xref="S3.SS2.p9.6.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.6.m5.1c">\boldsymbol{w}_{lr}</annotation></semantics></math> are the parameters of BNNet and LRNet respectively. <math id="S3.SS2.p9.7.m6.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S3.SS2.p9.7.m6.1a"><mi id="S3.SS2.p9.7.m6.1.1" xref="S3.SS2.p9.7.m6.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.7.m6.1b"><ci id="S3.SS2.p9.7.m6.1.1.cmml" xref="S3.SS2.p9.7.m6.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.7.m6.1c">\boldsymbol{\beta}</annotation></semantics></math> is used to compute the running mean and variance in the forward pass for each BN layer as shown in Eq. <a href="#S3.E2" title="Equation 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <math id="S3.SS2.p9.8.m7.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S3.SS2.p9.8.m7.1a"><mi id="S3.SS2.p9.8.m7.1.1" xref="S3.SS2.p9.8.m7.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.8.m7.1b"><ci id="S3.SS2.p9.8.m7.1.1.cmml" xref="S3.SS2.p9.8.m7.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.8.m7.1c">\boldsymbol{\eta}</annotation></semantics></math> is used as the learning rate for each weight and bias in the backward pass. We do not restrict <math id="S3.SS2.p9.9.m8.1" class="ltx_Math" alttext="\tilde{\boldsymbol{\eta}}" display="inline"><semantics id="S3.SS2.p9.9.m8.1a"><mover accent="true" id="S3.SS2.p9.9.m8.1.1" xref="S3.SS2.p9.9.m8.1.1.cmml"><mi id="S3.SS2.p9.9.m8.1.1.2" xref="S3.SS2.p9.9.m8.1.1.2.cmml">𝜼</mi><mo id="S3.SS2.p9.9.m8.1.1.1" xref="S3.SS2.p9.9.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.9.m8.1b"><apply id="S3.SS2.p9.9.m8.1.1.cmml" xref="S3.SS2.p9.9.m8.1.1"><ci id="S3.SS2.p9.9.m8.1.1.1.cmml" xref="S3.SS2.p9.9.m8.1.1.1">~</ci><ci id="S3.SS2.p9.9.m8.1.1.2.cmml" xref="S3.SS2.p9.9.m8.1.1.2">𝜼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.9.m8.1c">\tilde{\boldsymbol{\eta}}</annotation></semantics></math> to be positive as the optimal learning rate might be negative <cite class="ltx_cite ltx_citemacro_cite">Bernacchia (<a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S3.SS2.p10" class="ltx_para">
<p id="S3.SS2.p10.3" class="ltx_p"><span id="S3.SS2.p10.3.1" class="ltx_text ltx_font_bold">Federated Hyperparameter Learning.</span>
We deploy FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>)</cite> to federatedly learn a set of client-specific personalization strategies. Specifically, we learn the common meta-net <math id="S3.SS2.p10.1.m1.3" class="ltx_Math" alttext="\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}" display="inline"><semantics id="S3.SS2.p10.1.m1.3a"><mrow id="S3.SS2.p10.1.m1.3.3" xref="S3.SS2.p10.1.m1.3.3.cmml"><mi id="S3.SS2.p10.1.m1.3.3.4" xref="S3.SS2.p10.1.m1.3.3.4.cmml">λ</mi><mo id="S3.SS2.p10.1.m1.3.3.3" xref="S3.SS2.p10.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p10.1.m1.3.3.2.2" xref="S3.SS2.p10.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p10.1.m1.3.3.2.2.3" xref="S3.SS2.p10.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p10.1.m1.2.2.1.1.1" xref="S3.SS2.p10.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p10.1.m1.2.2.1.1.1.2" xref="S3.SS2.p10.1.m1.2.2.1.1.1.2.cmml">𝒘</mi><mrow id="S3.SS2.p10.1.m1.2.2.1.1.1.3" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p10.1.m1.2.2.1.1.1.3.2" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p10.1.m1.2.2.1.1.1.3.1" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p10.1.m1.2.2.1.1.1.3.3" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.p10.1.m1.3.3.2.2.4" xref="S3.SS2.p10.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p10.1.m1.3.3.2.2.2" xref="S3.SS2.p10.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p10.1.m1.3.3.2.2.2.2" xref="S3.SS2.p10.1.m1.3.3.2.2.2.2.cmml">𝒘</mi><mrow id="S3.SS2.p10.1.m1.3.3.2.2.2.3" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p10.1.m1.3.3.2.2.2.3.2" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p10.1.m1.3.3.2.2.2.3.1" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p10.1.m1.3.3.2.2.2.3.3" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.3.cmml">r</mi></mrow></msub><mo id="S3.SS2.p10.1.m1.3.3.2.2.5" xref="S3.SS2.p10.1.m1.3.3.2.3.cmml">,</mo><mover accent="true" id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml"><mi id="S3.SS2.p10.1.m1.1.1.2" xref="S3.SS2.p10.1.m1.1.1.2.cmml">𝜼</mi><mo id="S3.SS2.p10.1.m1.1.1.1" xref="S3.SS2.p10.1.m1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S3.SS2.p10.1.m1.3.3.2.2.6" xref="S3.SS2.p10.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.3b"><apply id="S3.SS2.p10.1.m1.3.3.cmml" xref="S3.SS2.p10.1.m1.3.3"><eq id="S3.SS2.p10.1.m1.3.3.3.cmml" xref="S3.SS2.p10.1.m1.3.3.3"></eq><ci id="S3.SS2.p10.1.m1.3.3.4.cmml" xref="S3.SS2.p10.1.m1.3.3.4">𝜆</ci><set id="S3.SS2.p10.1.m1.3.3.2.3.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2"><apply id="S3.SS2.p10.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p10.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1.2">𝒘</ci><apply id="S3.SS2.p10.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3"><times id="S3.SS2.p10.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.1"></times><ci id="S3.SS2.p10.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.2">𝑏</ci><ci id="S3.SS2.p10.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p10.1.m1.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S3.SS2.p10.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p10.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2.2">𝒘</ci><apply id="S3.SS2.p10.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3"><times id="S3.SS2.p10.1.m1.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.1"></times><ci id="S3.SS2.p10.1.m1.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.2">𝑙</ci><ci id="S3.SS2.p10.1.m1.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p10.1.m1.3.3.2.2.2.3.3">𝑟</ci></apply></apply><apply id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1"><ci id="S3.SS2.p10.1.m1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1">~</ci><ci id="S3.SS2.p10.1.m1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.1.2">𝜼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.3c">\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}</annotation></semantics></math> that generates client-wise personalization hyperparameters <math id="S3.SS2.p10.2.m2.2" class="ltx_Math" alttext="\{{\boldsymbol{\beta}_{i},\boldsymbol{\eta}_{i}\}}" display="inline"><semantics id="S3.SS2.p10.2.m2.2a"><mrow id="S3.SS2.p10.2.m2.2.2.2" xref="S3.SS2.p10.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p10.2.m2.2.2.2.3" xref="S3.SS2.p10.2.m2.2.2.3.cmml">{</mo><msub id="S3.SS2.p10.2.m2.1.1.1.1" xref="S3.SS2.p10.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p10.2.m2.1.1.1.1.2" xref="S3.SS2.p10.2.m2.1.1.1.1.2.cmml">𝜷</mi><mi id="S3.SS2.p10.2.m2.1.1.1.1.3" xref="S3.SS2.p10.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p10.2.m2.2.2.2.4" xref="S3.SS2.p10.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS2.p10.2.m2.2.2.2.2" xref="S3.SS2.p10.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.p10.2.m2.2.2.2.2.2" xref="S3.SS2.p10.2.m2.2.2.2.2.2.cmml">𝜼</mi><mi id="S3.SS2.p10.2.m2.2.2.2.2.3" xref="S3.SS2.p10.2.m2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p10.2.m2.2.2.2.5" xref="S3.SS2.p10.2.m2.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m2.2b"><set id="S3.SS2.p10.2.m2.2.2.3.cmml" xref="S3.SS2.p10.2.m2.2.2.2"><apply id="S3.SS2.p10.2.m2.1.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p10.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p10.2.m2.1.1.1.1.2">𝜷</ci><ci id="S3.SS2.p10.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p10.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p10.2.m2.2.2.2.2.cmml" xref="S3.SS2.p10.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p10.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p10.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p10.2.m2.2.2.2.2.2">𝜼</ci><ci id="S3.SS2.p10.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p10.2.m2.2.2.2.2.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m2.2c">\{{\boldsymbol{\beta}_{i},\boldsymbol{\eta}_{i}\}}</annotation></semantics></math>, such that a group of clients can better adapt a pre-trained model <math id="S3.SS2.p10.3.m3.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS2.p10.3.m3.1a"><msub id="S3.SS2.p10.3.m3.1.1" xref="S3.SS2.p10.3.m3.1.1.cmml"><mi id="S3.SS2.p10.3.m3.1.1.2" xref="S3.SS2.p10.3.m3.1.1.2.cmml">θ</mi><mi id="S3.SS2.p10.3.m3.1.1.3" xref="S3.SS2.p10.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m3.1b"><apply id="S3.SS2.p10.3.m3.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.3.m3.1.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p10.3.m3.1.1.2.cmml" xref="S3.SS2.p10.3.m3.1.1.2">𝜃</ci><ci id="S3.SS2.p10.3.m3.1.1.3.cmml" xref="S3.SS2.p10.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m3.1c">\theta_{g}</annotation></semantics></math> by fine-tuning to their local data distribution. So we solve:
</p>
<table id="A6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle\vspace{-2.5em}\min_{\lambda}\mathcal{F}(\lambda,\theta_{g})" display="inline"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml"><mrow id="S3.Ex1.m1.2.2.3" xref="S3.Ex1.m1.2.2.3.cmml"><munder id="S3.Ex1.m1.2.2.3.1" xref="S3.Ex1.m1.2.2.3.1.cmml"><mi id="S3.Ex1.m1.2.2.3.1.2" xref="S3.Ex1.m1.2.2.3.1.2.cmml">min</mi><mi id="S3.Ex1.m1.2.2.3.1.3" xref="S3.Ex1.m1.2.2.3.1.3.cmml">λ</mi></munder><mo lspace="0.167em" id="S3.Ex1.m1.2.2.3a" xref="S3.Ex1.m1.2.2.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.3.2" xref="S3.Ex1.m1.2.2.3.2.cmml">ℱ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.2" xref="S3.Ex1.m1.2.2.1.2.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">λ</mi><mo id="S3.Ex1.m1.2.2.1.1.3" xref="S3.Ex1.m1.2.2.1.2.cmml">,</mo><msub id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.2.cmml">θ</mi><mi id="S3.Ex1.m1.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.4" xref="S3.Ex1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2"><times id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2"></times><apply id="S3.Ex1.m1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.3"><apply id="S3.Ex1.m1.2.2.3.1.cmml" xref="S3.Ex1.m1.2.2.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.3.1.1.cmml" xref="S3.Ex1.m1.2.2.3.1">subscript</csymbol><min id="S3.Ex1.m1.2.2.3.1.2.cmml" xref="S3.Ex1.m1.2.2.3.1.2"></min><ci id="S3.Ex1.m1.2.2.3.1.3.cmml" xref="S3.Ex1.m1.2.2.3.1.3">𝜆</ci></apply><ci id="S3.Ex1.m1.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.3.2">ℱ</ci></apply><interval closure="open" id="S3.Ex1.m1.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝜆</ci><apply id="S3.Ex1.m1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2">𝜃</ci><ci id="S3.Ex1.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">\displaystyle\vspace{-2.5em}\min_{\lambda}\mathcal{F}(\lambda,\theta_{g})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.5" class="ltx_Math" alttext="\displaystyle=\sum^{C}_{i=1}\frac{N_{i}}{\sum_{i^{\prime}}N_{i^{\prime}}}\mathcal{L}_{i,V}(\theta_{i}^{*}(\lambda),\lambda)\;\;" display="inline"><semantics id="S3.Ex1.m2.5a"><mrow id="S3.Ex1.m2.5.5" xref="S3.Ex1.m2.5.5.cmml"><mi id="S3.Ex1.m2.5.5.3" xref="S3.Ex1.m2.5.5.3.cmml"></mi><mo id="S3.Ex1.m2.5.5.2" xref="S3.Ex1.m2.5.5.2.cmml">=</mo><mrow id="S3.Ex1.m2.5.5.1" xref="S3.Ex1.m2.5.5.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.5.5.1.2" xref="S3.Ex1.m2.5.5.1.2.cmml"><munderover id="S3.Ex1.m2.5.5.1.2a" xref="S3.Ex1.m2.5.5.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.5.5.1.2.2.2" xref="S3.Ex1.m2.5.5.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.5.5.1.2.3" xref="S3.Ex1.m2.5.5.1.2.3.cmml"><mi id="S3.Ex1.m2.5.5.1.2.3.2" xref="S3.Ex1.m2.5.5.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.5.5.1.2.3.1" xref="S3.Ex1.m2.5.5.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.5.5.1.2.3.3" xref="S3.Ex1.m2.5.5.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m2.5.5.1.2.2.3" xref="S3.Ex1.m2.5.5.1.2.2.3.cmml">C</mi></munderover></mstyle><mrow id="S3.Ex1.m2.5.5.1.1" xref="S3.Ex1.m2.5.5.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.5.5.1.1.3" xref="S3.Ex1.m2.5.5.1.1.3.cmml"><mfrac id="S3.Ex1.m2.5.5.1.1.3a" xref="S3.Ex1.m2.5.5.1.1.3.cmml"><msub id="S3.Ex1.m2.5.5.1.1.3.2" xref="S3.Ex1.m2.5.5.1.1.3.2.cmml"><mi id="S3.Ex1.m2.5.5.1.1.3.2.2" xref="S3.Ex1.m2.5.5.1.1.3.2.2.cmml">N</mi><mi id="S3.Ex1.m2.5.5.1.1.3.2.3" xref="S3.Ex1.m2.5.5.1.1.3.2.3.cmml">i</mi></msub><mrow id="S3.Ex1.m2.5.5.1.1.3.3" xref="S3.Ex1.m2.5.5.1.1.3.3.cmml"><msub id="S3.Ex1.m2.5.5.1.1.3.3.1" xref="S3.Ex1.m2.5.5.1.1.3.3.1.cmml"><mo id="S3.Ex1.m2.5.5.1.1.3.3.1.2" xref="S3.Ex1.m2.5.5.1.1.3.3.1.2.cmml">∑</mo><msup id="S3.Ex1.m2.5.5.1.1.3.3.1.3" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1.3.3.1.3.2" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3.2.cmml">i</mi><mo id="S3.Ex1.m2.5.5.1.1.3.3.1.3.3" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3.3.cmml">′</mo></msup></msub><msub id="S3.Ex1.m2.5.5.1.1.3.3.2" xref="S3.Ex1.m2.5.5.1.1.3.3.2.cmml"><mi id="S3.Ex1.m2.5.5.1.1.3.3.2.2" xref="S3.Ex1.m2.5.5.1.1.3.3.2.2.cmml">N</mi><msup id="S3.Ex1.m2.5.5.1.1.3.3.2.3" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1.3.3.2.3.2" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.5.5.1.1.3.3.2.3.3" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3.3.cmml">′</mo></msup></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.5.5.1.1.2" xref="S3.Ex1.m2.5.5.1.1.2.cmml">​</mo><msub id="S3.Ex1.m2.5.5.1.1.4" xref="S3.Ex1.m2.5.5.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.5.5.1.1.4.2" xref="S3.Ex1.m2.5.5.1.1.4.2.cmml">ℒ</mi><mrow id="S3.Ex1.m2.2.2.2.4" xref="S3.Ex1.m2.2.2.2.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml">i</mi><mo id="S3.Ex1.m2.2.2.2.4.1" xref="S3.Ex1.m2.2.2.2.3.cmml">,</mo><mi id="S3.Ex1.m2.2.2.2.2" xref="S3.Ex1.m2.2.2.2.2.cmml">V</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.5.5.1.1.2a" xref="S3.Ex1.m2.5.5.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.5.5.1.1.1.1.2" xref="S3.Ex1.m2.5.5.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.cmml"><msubsup id="S3.Ex1.m2.5.5.1.1.1.1.1.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.3" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.3.cmml">i</mi><mo id="S3.Ex1.m2.5.5.1.1.1.1.1.2.3" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.5.5.1.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml">λ</mi><mo stretchy="false" id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.5.5.1.1.1.1.3" xref="S3.Ex1.m2.5.5.1.1.1.2.cmml">,</mo><mi id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml">λ</mi><mo stretchy="false" id="S3.Ex1.m2.5.5.1.1.1.1.4" xref="S3.Ex1.m2.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.5b"><apply id="S3.Ex1.m2.5.5.cmml" xref="S3.Ex1.m2.5.5"><eq id="S3.Ex1.m2.5.5.2.cmml" xref="S3.Ex1.m2.5.5.2"></eq><csymbol cd="latexml" id="S3.Ex1.m2.5.5.3.cmml" xref="S3.Ex1.m2.5.5.3">absent</csymbol><apply id="S3.Ex1.m2.5.5.1.cmml" xref="S3.Ex1.m2.5.5.1"><apply id="S3.Ex1.m2.5.5.1.2.cmml" xref="S3.Ex1.m2.5.5.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.2.1.cmml" xref="S3.Ex1.m2.5.5.1.2">subscript</csymbol><apply id="S3.Ex1.m2.5.5.1.2.2.cmml" xref="S3.Ex1.m2.5.5.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.2.2.1.cmml" xref="S3.Ex1.m2.5.5.1.2">superscript</csymbol><sum id="S3.Ex1.m2.5.5.1.2.2.2.cmml" xref="S3.Ex1.m2.5.5.1.2.2.2"></sum><ci id="S3.Ex1.m2.5.5.1.2.2.3.cmml" xref="S3.Ex1.m2.5.5.1.2.2.3">𝐶</ci></apply><apply id="S3.Ex1.m2.5.5.1.2.3.cmml" xref="S3.Ex1.m2.5.5.1.2.3"><eq id="S3.Ex1.m2.5.5.1.2.3.1.cmml" xref="S3.Ex1.m2.5.5.1.2.3.1"></eq><ci id="S3.Ex1.m2.5.5.1.2.3.2.cmml" xref="S3.Ex1.m2.5.5.1.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex1.m2.5.5.1.2.3.3.cmml" xref="S3.Ex1.m2.5.5.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex1.m2.5.5.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1"><times id="S3.Ex1.m2.5.5.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.2"></times><apply id="S3.Ex1.m2.5.5.1.1.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3"><divide id="S3.Ex1.m2.5.5.1.1.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3"></divide><apply id="S3.Ex1.m2.5.5.1.1.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.3.2.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.2.2">𝑁</ci><ci id="S3.Ex1.m2.5.5.1.1.3.2.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.2.3">𝑖</ci></apply><apply id="S3.Ex1.m2.5.5.1.1.3.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3"><apply id="S3.Ex1.m2.5.5.1.1.3.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.3.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1">subscript</csymbol><sum id="S3.Ex1.m2.5.5.1.1.3.3.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1.2"></sum><apply id="S3.Ex1.m2.5.5.1.1.3.3.1.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.3.1.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3">superscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.3.3.1.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3.2">𝑖</ci><ci id="S3.Ex1.m2.5.5.1.1.3.3.1.3.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.1.3.3">′</ci></apply></apply><apply id="S3.Ex1.m2.5.5.1.1.3.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.3.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.3.3.2.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2.2">𝑁</ci><apply id="S3.Ex1.m2.5.5.1.1.3.3.2.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.3.2.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3">superscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.3.3.2.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.Ex1.m2.5.5.1.1.3.3.2.3.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3.2.3.3">′</ci></apply></apply></apply></apply><apply id="S3.Ex1.m2.5.5.1.1.4.cmml" xref="S3.Ex1.m2.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.4.1.cmml" xref="S3.Ex1.m2.5.5.1.1.4">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.4.2.cmml" xref="S3.Ex1.m2.5.5.1.1.4.2">ℒ</ci><list id="S3.Ex1.m2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.2.4"><ci id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1">𝑖</ci><ci id="S3.Ex1.m2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2.2">𝑉</ci></list></apply><interval closure="open" id="S3.Ex1.m2.5.5.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1"><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1"><times id="S3.Ex1.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1"></times><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.2">𝜃</ci><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.2.3">𝑖</ci></apply><times id="S3.Ex1.m2.5.5.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.3"></times></apply><ci id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3">𝜆</ci></apply><ci id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.5c">\displaystyle=\sum^{C}_{i=1}\frac{N_{i}}{\sum_{i^{\prime}}N_{i^{\prime}}}\mathcal{L}_{i,V}(\theta_{i}^{*}(\lambda),\lambda)\;\;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle\text{s.t.}\;\;\theta_{i}^{*}(\lambda)" display="inline"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><mtext id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2a.cmml">s.t.</mtext><mo lspace="0.560em" rspace="0em" id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">​</mo><msubsup id="S3.E5.m1.1.2.3" xref="S3.E5.m1.1.2.3.cmml"><mi id="S3.E5.m1.1.2.3.2.2" xref="S3.E5.m1.1.2.3.2.2.cmml">θ</mi><mi id="S3.E5.m1.1.2.3.2.3" xref="S3.E5.m1.1.2.3.2.3.cmml">i</mi><mo id="S3.E5.m1.1.2.3.3" xref="S3.E5.m1.1.2.3.3.cmml">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.1a" xref="S3.E5.m1.1.2.1.cmml">​</mo><mrow id="S3.E5.m1.1.2.4.2" xref="S3.E5.m1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.1.2.4.2.1" xref="S3.E5.m1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">λ</mi><mo stretchy="false" id="S3.E5.m1.1.2.4.2.2" xref="S3.E5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><times id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></times><ci id="S3.E5.m1.1.2.2a.cmml" xref="S3.E5.m1.1.2.2"><mtext id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2">s.t.</mtext></ci><apply id="S3.E5.m1.1.2.3.cmml" xref="S3.E5.m1.1.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.1.cmml" xref="S3.E5.m1.1.2.3">superscript</csymbol><apply id="S3.E5.m1.1.2.3.2.cmml" xref="S3.E5.m1.1.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.3.2.1.cmml" xref="S3.E5.m1.1.2.3">subscript</csymbol><ci id="S3.E5.m1.1.2.3.2.2.cmml" xref="S3.E5.m1.1.2.3.2.2">𝜃</ci><ci id="S3.E5.m1.1.2.3.2.3.cmml" xref="S3.E5.m1.1.2.3.2.3">𝑖</ci></apply><times id="S3.E5.m1.1.2.3.3.cmml" xref="S3.E5.m1.1.2.3.3"></times></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\text{s.t.}\;\;\theta_{i}^{*}(\lambda)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m2.4" class="ltx_Math" alttext="\displaystyle=\operatorname*{arg\,min}_{\theta_{i}}\mathcal{L}_{i,T}(\theta_{i},\lambda)\vspace{-2.5em}" display="inline"><semantics id="S3.E5.m2.4a"><mrow id="S3.E5.m2.4.4" xref="S3.E5.m2.4.4.cmml"><mi id="S3.E5.m2.4.4.3" xref="S3.E5.m2.4.4.3.cmml"></mi><mo id="S3.E5.m2.4.4.2" xref="S3.E5.m2.4.4.2.cmml">=</mo><mrow id="S3.E5.m2.4.4.1" xref="S3.E5.m2.4.4.1.cmml"><mrow id="S3.E5.m2.4.4.1.3" xref="S3.E5.m2.4.4.1.3.cmml"><munder id="S3.E5.m2.4.4.1.3.1" xref="S3.E5.m2.4.4.1.3.1.cmml"><mrow id="S3.E5.m2.4.4.1.3.1.2" xref="S3.E5.m2.4.4.1.3.1.2.cmml"><mi id="S3.E5.m2.4.4.1.3.1.2.2" xref="S3.E5.m2.4.4.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E5.m2.4.4.1.3.1.2.1" xref="S3.E5.m2.4.4.1.3.1.2.1.cmml">​</mo><mi id="S3.E5.m2.4.4.1.3.1.2.3" xref="S3.E5.m2.4.4.1.3.1.2.3.cmml">min</mi></mrow><msub id="S3.E5.m2.4.4.1.3.1.3" xref="S3.E5.m2.4.4.1.3.1.3.cmml"><mi id="S3.E5.m2.4.4.1.3.1.3.2" xref="S3.E5.m2.4.4.1.3.1.3.2.cmml">θ</mi><mi id="S3.E5.m2.4.4.1.3.1.3.3" xref="S3.E5.m2.4.4.1.3.1.3.3.cmml">i</mi></msub></munder><mo id="S3.E5.m2.4.4.1.3a" xref="S3.E5.m2.4.4.1.3.cmml">⁡</mo><msub id="S3.E5.m2.4.4.1.3.2" xref="S3.E5.m2.4.4.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m2.4.4.1.3.2.2" xref="S3.E5.m2.4.4.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E5.m2.2.2.2.4" xref="S3.E5.m2.2.2.2.3.cmml"><mi id="S3.E5.m2.1.1.1.1" xref="S3.E5.m2.1.1.1.1.cmml">i</mi><mo id="S3.E5.m2.2.2.2.4.1" xref="S3.E5.m2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m2.2.2.2.2" xref="S3.E5.m2.2.2.2.2.cmml">T</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m2.4.4.1.2" xref="S3.E5.m2.4.4.1.2.cmml">​</mo><mrow id="S3.E5.m2.4.4.1.1.1" xref="S3.E5.m2.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m2.4.4.1.1.1.2" xref="S3.E5.m2.4.4.1.1.2.cmml">(</mo><msub id="S3.E5.m2.4.4.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.cmml"><mi id="S3.E5.m2.4.4.1.1.1.1.2" xref="S3.E5.m2.4.4.1.1.1.1.2.cmml">θ</mi><mi id="S3.E5.m2.4.4.1.1.1.1.3" xref="S3.E5.m2.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m2.4.4.1.1.1.3" xref="S3.E5.m2.4.4.1.1.2.cmml">,</mo><mi id="S3.E5.m2.3.3" xref="S3.E5.m2.3.3.cmml">λ</mi><mo stretchy="false" id="S3.E5.m2.4.4.1.1.1.4" xref="S3.E5.m2.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.4b"><apply id="S3.E5.m2.4.4.cmml" xref="S3.E5.m2.4.4"><eq id="S3.E5.m2.4.4.2.cmml" xref="S3.E5.m2.4.4.2"></eq><csymbol cd="latexml" id="S3.E5.m2.4.4.3.cmml" xref="S3.E5.m2.4.4.3">absent</csymbol><apply id="S3.E5.m2.4.4.1.cmml" xref="S3.E5.m2.4.4.1"><times id="S3.E5.m2.4.4.1.2.cmml" xref="S3.E5.m2.4.4.1.2"></times><apply id="S3.E5.m2.4.4.1.3.cmml" xref="S3.E5.m2.4.4.1.3"><apply id="S3.E5.m2.4.4.1.3.1.cmml" xref="S3.E5.m2.4.4.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m2.4.4.1.3.1.1.cmml" xref="S3.E5.m2.4.4.1.3.1">subscript</csymbol><apply id="S3.E5.m2.4.4.1.3.1.2.cmml" xref="S3.E5.m2.4.4.1.3.1.2"><times id="S3.E5.m2.4.4.1.3.1.2.1.cmml" xref="S3.E5.m2.4.4.1.3.1.2.1"></times><ci id="S3.E5.m2.4.4.1.3.1.2.2.cmml" xref="S3.E5.m2.4.4.1.3.1.2.2">arg</ci><ci id="S3.E5.m2.4.4.1.3.1.2.3.cmml" xref="S3.E5.m2.4.4.1.3.1.2.3">min</ci></apply><apply id="S3.E5.m2.4.4.1.3.1.3.cmml" xref="S3.E5.m2.4.4.1.3.1.3"><csymbol cd="ambiguous" id="S3.E5.m2.4.4.1.3.1.3.1.cmml" xref="S3.E5.m2.4.4.1.3.1.3">subscript</csymbol><ci id="S3.E5.m2.4.4.1.3.1.3.2.cmml" xref="S3.E5.m2.4.4.1.3.1.3.2">𝜃</ci><ci id="S3.E5.m2.4.4.1.3.1.3.3.cmml" xref="S3.E5.m2.4.4.1.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E5.m2.4.4.1.3.2.cmml" xref="S3.E5.m2.4.4.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m2.4.4.1.3.2.1.cmml" xref="S3.E5.m2.4.4.1.3.2">subscript</csymbol><ci id="S3.E5.m2.4.4.1.3.2.2.cmml" xref="S3.E5.m2.4.4.1.3.2.2">ℒ</ci><list id="S3.E5.m2.2.2.2.3.cmml" xref="S3.E5.m2.2.2.2.4"><ci id="S3.E5.m2.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1">𝑖</ci><ci id="S3.E5.m2.2.2.2.2.cmml" xref="S3.E5.m2.2.2.2.2">𝑇</ci></list></apply></apply><interval closure="open" id="S3.E5.m2.4.4.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1"><apply id="S3.E5.m2.4.4.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.4.4.1.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.4.4.1.1.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.2">𝜃</ci><ci id="S3.E5.m2.4.4.1.1.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E5.m2.3.3.cmml" xref="S3.E5.m2.3.3">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.4c">\displaystyle=\operatorname*{arg\,min}_{\theta_{i}}\mathcal{L}_{i,T}(\theta_{i},\lambda)\vspace{-2.5em}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p10.11" class="ltx_p">where <math id="S3.SS2.p10.4.m1.1" class="ltx_Math" alttext="\theta_{i}^{*}" display="inline"><semantics id="S3.SS2.p10.4.m1.1a"><msubsup id="S3.SS2.p10.4.m1.1.1" xref="S3.SS2.p10.4.m1.1.1.cmml"><mi id="S3.SS2.p10.4.m1.1.1.2.2" xref="S3.SS2.p10.4.m1.1.1.2.2.cmml">θ</mi><mi id="S3.SS2.p10.4.m1.1.1.2.3" xref="S3.SS2.p10.4.m1.1.1.2.3.cmml">i</mi><mo id="S3.SS2.p10.4.m1.1.1.3" xref="S3.SS2.p10.4.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.4.m1.1b"><apply id="S3.SS2.p10.4.m1.1.1.cmml" xref="S3.SS2.p10.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.4.m1.1.1.1.cmml" xref="S3.SS2.p10.4.m1.1.1">superscript</csymbol><apply id="S3.SS2.p10.4.m1.1.1.2.cmml" xref="S3.SS2.p10.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.4.m1.1.1.2.1.cmml" xref="S3.SS2.p10.4.m1.1.1">subscript</csymbol><ci id="S3.SS2.p10.4.m1.1.1.2.2.cmml" xref="S3.SS2.p10.4.m1.1.1.2.2">𝜃</ci><ci id="S3.SS2.p10.4.m1.1.1.2.3.cmml" xref="S3.SS2.p10.4.m1.1.1.2.3">𝑖</ci></apply><times id="S3.SS2.p10.4.m1.1.1.3.cmml" xref="S3.SS2.p10.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.4.m1.1c">\theta_{i}^{*}</annotation></semantics></math> is the set of optimal personalized model parameters after fine-tuning <math id="S3.SS2.p10.5.m2.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS2.p10.5.m2.1a"><msub id="S3.SS2.p10.5.m2.1.1" xref="S3.SS2.p10.5.m2.1.1.cmml"><mi id="S3.SS2.p10.5.m2.1.1.2" xref="S3.SS2.p10.5.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p10.5.m2.1.1.3" xref="S3.SS2.p10.5.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.5.m2.1b"><apply id="S3.SS2.p10.5.m2.1.1.cmml" xref="S3.SS2.p10.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m2.1.1.1.cmml" xref="S3.SS2.p10.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p10.5.m2.1.1.2.cmml" xref="S3.SS2.p10.5.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p10.5.m2.1.1.3.cmml" xref="S3.SS2.p10.5.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.5.m2.1c">\theta_{g}</annotation></semantics></math> for <math id="S3.SS2.p10.6.m3.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p10.6.m3.1a"><mi id="S3.SS2.p10.6.m3.1.1" xref="S3.SS2.p10.6.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.6.m3.1b"><ci id="S3.SS2.p10.6.m3.1.1.cmml" xref="S3.SS2.p10.6.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.6.m3.1c">e</annotation></semantics></math> epochs on the local dataset, <math id="S3.SS2.p10.7.m4.10" class="ltx_Math" alttext="\mathcal{L}_{i,V}(\theta,\lambda)=\mathbb{E}_{(x,y)\sim V_{i}}\mathcal{L}_{i}(\theta,\lambda;x,y)" display="inline"><semantics id="S3.SS2.p10.7.m4.10a"><mrow id="S3.SS2.p10.7.m4.10.11" xref="S3.SS2.p10.7.m4.10.11.cmml"><mrow id="S3.SS2.p10.7.m4.10.11.2" xref="S3.SS2.p10.7.m4.10.11.2.cmml"><msub id="S3.SS2.p10.7.m4.10.11.2.2" xref="S3.SS2.p10.7.m4.10.11.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p10.7.m4.10.11.2.2.2" xref="S3.SS2.p10.7.m4.10.11.2.2.2.cmml">ℒ</mi><mrow id="S3.SS2.p10.7.m4.2.2.2.4" xref="S3.SS2.p10.7.m4.2.2.2.3.cmml"><mi id="S3.SS2.p10.7.m4.1.1.1.1" xref="S3.SS2.p10.7.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p10.7.m4.2.2.2.4.1" xref="S3.SS2.p10.7.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p10.7.m4.2.2.2.2" xref="S3.SS2.p10.7.m4.2.2.2.2.cmml">V</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p10.7.m4.10.11.2.1" xref="S3.SS2.p10.7.m4.10.11.2.1.cmml">​</mo><mrow id="S3.SS2.p10.7.m4.10.11.2.3.2" xref="S3.SS2.p10.7.m4.10.11.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p10.7.m4.10.11.2.3.2.1" xref="S3.SS2.p10.7.m4.10.11.2.3.1.cmml">(</mo><mi id="S3.SS2.p10.7.m4.5.5" xref="S3.SS2.p10.7.m4.5.5.cmml">θ</mi><mo id="S3.SS2.p10.7.m4.10.11.2.3.2.2" xref="S3.SS2.p10.7.m4.10.11.2.3.1.cmml">,</mo><mi id="S3.SS2.p10.7.m4.6.6" xref="S3.SS2.p10.7.m4.6.6.cmml">λ</mi><mo stretchy="false" id="S3.SS2.p10.7.m4.10.11.2.3.2.3" xref="S3.SS2.p10.7.m4.10.11.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p10.7.m4.10.11.1" xref="S3.SS2.p10.7.m4.10.11.1.cmml">=</mo><mrow id="S3.SS2.p10.7.m4.10.11.3" xref="S3.SS2.p10.7.m4.10.11.3.cmml"><msub id="S3.SS2.p10.7.m4.10.11.3.2" xref="S3.SS2.p10.7.m4.10.11.3.2.cmml"><mi id="S3.SS2.p10.7.m4.10.11.3.2.2" xref="S3.SS2.p10.7.m4.10.11.3.2.2.cmml">𝔼</mi><mrow id="S3.SS2.p10.7.m4.4.4.2" xref="S3.SS2.p10.7.m4.4.4.2.cmml"><mrow id="S3.SS2.p10.7.m4.4.4.2.4.2" xref="S3.SS2.p10.7.m4.4.4.2.4.1.cmml"><mo stretchy="false" id="S3.SS2.p10.7.m4.4.4.2.4.2.1" xref="S3.SS2.p10.7.m4.4.4.2.4.1.cmml">(</mo><mi id="S3.SS2.p10.7.m4.3.3.1.1" xref="S3.SS2.p10.7.m4.3.3.1.1.cmml">x</mi><mo id="S3.SS2.p10.7.m4.4.4.2.4.2.2" xref="S3.SS2.p10.7.m4.4.4.2.4.1.cmml">,</mo><mi id="S3.SS2.p10.7.m4.4.4.2.2" xref="S3.SS2.p10.7.m4.4.4.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS2.p10.7.m4.4.4.2.4.2.3" xref="S3.SS2.p10.7.m4.4.4.2.4.1.cmml">)</mo></mrow><mo id="S3.SS2.p10.7.m4.4.4.2.3" xref="S3.SS2.p10.7.m4.4.4.2.3.cmml">∼</mo><msub id="S3.SS2.p10.7.m4.4.4.2.5" xref="S3.SS2.p10.7.m4.4.4.2.5.cmml"><mi id="S3.SS2.p10.7.m4.4.4.2.5.2" xref="S3.SS2.p10.7.m4.4.4.2.5.2.cmml">V</mi><mi id="S3.SS2.p10.7.m4.4.4.2.5.3" xref="S3.SS2.p10.7.m4.4.4.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p10.7.m4.10.11.3.1" xref="S3.SS2.p10.7.m4.10.11.3.1.cmml">​</mo><msub id="S3.SS2.p10.7.m4.10.11.3.3" xref="S3.SS2.p10.7.m4.10.11.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p10.7.m4.10.11.3.3.2" xref="S3.SS2.p10.7.m4.10.11.3.3.2.cmml">ℒ</mi><mi id="S3.SS2.p10.7.m4.10.11.3.3.3" xref="S3.SS2.p10.7.m4.10.11.3.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p10.7.m4.10.11.3.1a" xref="S3.SS2.p10.7.m4.10.11.3.1.cmml">​</mo><mrow id="S3.SS2.p10.7.m4.10.11.3.4.2" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml"><mo stretchy="false" id="S3.SS2.p10.7.m4.10.11.3.4.2.1" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml">(</mo><mi id="S3.SS2.p10.7.m4.7.7" xref="S3.SS2.p10.7.m4.7.7.cmml">θ</mi><mo id="S3.SS2.p10.7.m4.10.11.3.4.2.2" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml">,</mo><mi id="S3.SS2.p10.7.m4.8.8" xref="S3.SS2.p10.7.m4.8.8.cmml">λ</mi><mo id="S3.SS2.p10.7.m4.10.11.3.4.2.3" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml">;</mo><mi id="S3.SS2.p10.7.m4.9.9" xref="S3.SS2.p10.7.m4.9.9.cmml">x</mi><mo id="S3.SS2.p10.7.m4.10.11.3.4.2.4" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml">,</mo><mi id="S3.SS2.p10.7.m4.10.10" xref="S3.SS2.p10.7.m4.10.10.cmml">y</mi><mo stretchy="false" id="S3.SS2.p10.7.m4.10.11.3.4.2.5" xref="S3.SS2.p10.7.m4.10.11.3.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.7.m4.10b"><apply id="S3.SS2.p10.7.m4.10.11.cmml" xref="S3.SS2.p10.7.m4.10.11"><eq id="S3.SS2.p10.7.m4.10.11.1.cmml" xref="S3.SS2.p10.7.m4.10.11.1"></eq><apply id="S3.SS2.p10.7.m4.10.11.2.cmml" xref="S3.SS2.p10.7.m4.10.11.2"><times id="S3.SS2.p10.7.m4.10.11.2.1.cmml" xref="S3.SS2.p10.7.m4.10.11.2.1"></times><apply id="S3.SS2.p10.7.m4.10.11.2.2.cmml" xref="S3.SS2.p10.7.m4.10.11.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.7.m4.10.11.2.2.1.cmml" xref="S3.SS2.p10.7.m4.10.11.2.2">subscript</csymbol><ci id="S3.SS2.p10.7.m4.10.11.2.2.2.cmml" xref="S3.SS2.p10.7.m4.10.11.2.2.2">ℒ</ci><list id="S3.SS2.p10.7.m4.2.2.2.3.cmml" xref="S3.SS2.p10.7.m4.2.2.2.4"><ci id="S3.SS2.p10.7.m4.1.1.1.1.cmml" xref="S3.SS2.p10.7.m4.1.1.1.1">𝑖</ci><ci id="S3.SS2.p10.7.m4.2.2.2.2.cmml" xref="S3.SS2.p10.7.m4.2.2.2.2">𝑉</ci></list></apply><interval closure="open" id="S3.SS2.p10.7.m4.10.11.2.3.1.cmml" xref="S3.SS2.p10.7.m4.10.11.2.3.2"><ci id="S3.SS2.p10.7.m4.5.5.cmml" xref="S3.SS2.p10.7.m4.5.5">𝜃</ci><ci id="S3.SS2.p10.7.m4.6.6.cmml" xref="S3.SS2.p10.7.m4.6.6">𝜆</ci></interval></apply><apply id="S3.SS2.p10.7.m4.10.11.3.cmml" xref="S3.SS2.p10.7.m4.10.11.3"><times id="S3.SS2.p10.7.m4.10.11.3.1.cmml" xref="S3.SS2.p10.7.m4.10.11.3.1"></times><apply id="S3.SS2.p10.7.m4.10.11.3.2.cmml" xref="S3.SS2.p10.7.m4.10.11.3.2"><csymbol cd="ambiguous" id="S3.SS2.p10.7.m4.10.11.3.2.1.cmml" xref="S3.SS2.p10.7.m4.10.11.3.2">subscript</csymbol><ci id="S3.SS2.p10.7.m4.10.11.3.2.2.cmml" xref="S3.SS2.p10.7.m4.10.11.3.2.2">𝔼</ci><apply id="S3.SS2.p10.7.m4.4.4.2.cmml" xref="S3.SS2.p10.7.m4.4.4.2"><csymbol cd="latexml" id="S3.SS2.p10.7.m4.4.4.2.3.cmml" xref="S3.SS2.p10.7.m4.4.4.2.3">similar-to</csymbol><interval closure="open" id="S3.SS2.p10.7.m4.4.4.2.4.1.cmml" xref="S3.SS2.p10.7.m4.4.4.2.4.2"><ci id="S3.SS2.p10.7.m4.3.3.1.1.cmml" xref="S3.SS2.p10.7.m4.3.3.1.1">𝑥</ci><ci id="S3.SS2.p10.7.m4.4.4.2.2.cmml" xref="S3.SS2.p10.7.m4.4.4.2.2">𝑦</ci></interval><apply id="S3.SS2.p10.7.m4.4.4.2.5.cmml" xref="S3.SS2.p10.7.m4.4.4.2.5"><csymbol cd="ambiguous" id="S3.SS2.p10.7.m4.4.4.2.5.1.cmml" xref="S3.SS2.p10.7.m4.4.4.2.5">subscript</csymbol><ci id="S3.SS2.p10.7.m4.4.4.2.5.2.cmml" xref="S3.SS2.p10.7.m4.4.4.2.5.2">𝑉</ci><ci id="S3.SS2.p10.7.m4.4.4.2.5.3.cmml" xref="S3.SS2.p10.7.m4.4.4.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS2.p10.7.m4.10.11.3.3.cmml" xref="S3.SS2.p10.7.m4.10.11.3.3"><csymbol cd="ambiguous" id="S3.SS2.p10.7.m4.10.11.3.3.1.cmml" xref="S3.SS2.p10.7.m4.10.11.3.3">subscript</csymbol><ci id="S3.SS2.p10.7.m4.10.11.3.3.2.cmml" xref="S3.SS2.p10.7.m4.10.11.3.3.2">ℒ</ci><ci id="S3.SS2.p10.7.m4.10.11.3.3.3.cmml" xref="S3.SS2.p10.7.m4.10.11.3.3.3">𝑖</ci></apply><vector id="S3.SS2.p10.7.m4.10.11.3.4.1.cmml" xref="S3.SS2.p10.7.m4.10.11.3.4.2"><ci id="S3.SS2.p10.7.m4.7.7.cmml" xref="S3.SS2.p10.7.m4.7.7">𝜃</ci><ci id="S3.SS2.p10.7.m4.8.8.cmml" xref="S3.SS2.p10.7.m4.8.8">𝜆</ci><ci id="S3.SS2.p10.7.m4.9.9.cmml" xref="S3.SS2.p10.7.m4.9.9">𝑥</ci><ci id="S3.SS2.p10.7.m4.10.10.cmml" xref="S3.SS2.p10.7.m4.10.10">𝑦</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.7.m4.10c">\mathcal{L}_{i,V}(\theta,\lambda)=\mathbb{E}_{(x,y)\sim V_{i}}\mathcal{L}_{i}(\theta,\lambda;x,y)</annotation></semantics></math> and <math id="S3.SS2.p10.8.m5.1" class="ltx_Math" alttext="V_{i}" display="inline"><semantics id="S3.SS2.p10.8.m5.1a"><msub id="S3.SS2.p10.8.m5.1.1" xref="S3.SS2.p10.8.m5.1.1.cmml"><mi id="S3.SS2.p10.8.m5.1.1.2" xref="S3.SS2.p10.8.m5.1.1.2.cmml">V</mi><mi id="S3.SS2.p10.8.m5.1.1.3" xref="S3.SS2.p10.8.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.8.m5.1b"><apply id="S3.SS2.p10.8.m5.1.1.cmml" xref="S3.SS2.p10.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.8.m5.1.1.1.cmml" xref="S3.SS2.p10.8.m5.1.1">subscript</csymbol><ci id="S3.SS2.p10.8.m5.1.1.2.cmml" xref="S3.SS2.p10.8.m5.1.1.2">𝑉</ci><ci id="S3.SS2.p10.8.m5.1.1.3.cmml" xref="S3.SS2.p10.8.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.8.m5.1c">V_{i}</annotation></semantics></math> is the validation set (samples from <math id="S3.SS2.p10.9.m6.1" class="ltx_Math" alttext="P_{i}" display="inline"><semantics id="S3.SS2.p10.9.m6.1a"><msub id="S3.SS2.p10.9.m6.1.1" xref="S3.SS2.p10.9.m6.1.1.cmml"><mi id="S3.SS2.p10.9.m6.1.1.2" xref="S3.SS2.p10.9.m6.1.1.2.cmml">P</mi><mi id="S3.SS2.p10.9.m6.1.1.3" xref="S3.SS2.p10.9.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.9.m6.1b"><apply id="S3.SS2.p10.9.m6.1.1.cmml" xref="S3.SS2.p10.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.9.m6.1.1.1.cmml" xref="S3.SS2.p10.9.m6.1.1">subscript</csymbol><ci id="S3.SS2.p10.9.m6.1.1.2.cmml" xref="S3.SS2.p10.9.m6.1.1.2">𝑃</ci><ci id="S3.SS2.p10.9.m6.1.1.3.cmml" xref="S3.SS2.p10.9.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.9.m6.1c">P_{i}</annotation></semantics></math>) for the client <math id="S3.SS2.p10.10.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p10.10.m7.1a"><mi id="S3.SS2.p10.10.m7.1.1" xref="S3.SS2.p10.10.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.10.m7.1b"><ci id="S3.SS2.p10.10.m7.1.1.cmml" xref="S3.SS2.p10.10.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.10.m7.1c">i</annotation></semantics></math> - similarity for <math id="S3.SS2.p10.11.m8.2" class="ltx_Math" alttext="L_{i,T}" display="inline"><semantics id="S3.SS2.p10.11.m8.2a"><msub id="S3.SS2.p10.11.m8.2.3" xref="S3.SS2.p10.11.m8.2.3.cmml"><mi id="S3.SS2.p10.11.m8.2.3.2" xref="S3.SS2.p10.11.m8.2.3.2.cmml">L</mi><mrow id="S3.SS2.p10.11.m8.2.2.2.4" xref="S3.SS2.p10.11.m8.2.2.2.3.cmml"><mi id="S3.SS2.p10.11.m8.1.1.1.1" xref="S3.SS2.p10.11.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p10.11.m8.2.2.2.4.1" xref="S3.SS2.p10.11.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p10.11.m8.2.2.2.2" xref="S3.SS2.p10.11.m8.2.2.2.2.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.11.m8.2b"><apply id="S3.SS2.p10.11.m8.2.3.cmml" xref="S3.SS2.p10.11.m8.2.3"><csymbol cd="ambiguous" id="S3.SS2.p10.11.m8.2.3.1.cmml" xref="S3.SS2.p10.11.m8.2.3">subscript</csymbol><ci id="S3.SS2.p10.11.m8.2.3.2.cmml" xref="S3.SS2.p10.11.m8.2.3.2">𝐿</ci><list id="S3.SS2.p10.11.m8.2.2.2.3.cmml" xref="S3.SS2.p10.11.m8.2.2.2.4"><ci id="S3.SS2.p10.11.m8.1.1.1.1.cmml" xref="S3.SS2.p10.11.m8.1.1.1.1">𝑖</ci><ci id="S3.SS2.p10.11.m8.2.2.2.2.cmml" xref="S3.SS2.p10.11.m8.2.2.2.2">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.11.m8.2c">L_{i,T}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p11" class="ltx_para">
<p id="S3.SS2.p11.2" class="ltx_p">For each client <math id="S3.SS2.p11.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p11.1.m1.1a"><mi id="S3.SS2.p11.1.m1.1.1" xref="S3.SS2.p11.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.1.m1.1b"><ci id="S3.SS2.p11.1.m1.1.1.cmml" xref="S3.SS2.p11.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.1.m1.1c">i</annotation></semantics></math>, the validation loss gradient with respect to <math id="S3.SS2.p11.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p11.2.m2.1a"><mi id="S3.SS2.p11.2.m2.1.1" xref="S3.SS2.p11.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.2.m2.1b"><ci id="S3.SS2.p11.2.m2.1.1.cmml" xref="S3.SS2.p11.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.2.m2.1c">\lambda</annotation></semantics></math>, known as the hypergradient, can be computed as follows:
</p>
<table id="A6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E6.m1.54" class="ltx_Math" alttext="\displaystyle\begin{split}d_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)=\partial_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)+\partial_{\theta^{*}(\lambda)}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)\&gt;\partial_{\lambda}\theta^{*}(\lambda)\end{split}" display="inline"><semantics id="S3.E6.m1.54a"><mtable id="S3.E6.m1.54.54.6" xref="S3.E6.m1.51.51.3.cmml"><mtr id="S3.E6.m1.54.54.6a" xref="S3.E6.m1.51.51.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.54.54.6b" xref="S3.E6.m1.51.51.3.cmml"><mrow id="S3.E6.m1.54.54.6.51.51.51" xref="S3.E6.m1.51.51.3.cmml"><mrow id="S3.E6.m1.52.52.4.49.49.49.49" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.52.52.4.49.49.49.49.3" xref="S3.E6.m1.51.51.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">d</mi><mi id="S3.E6.m1.2.2.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.2.2.1.cmml">λ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.52.52.4.49.49.49.49.2" xref="S3.E6.m1.51.51.3.cmml">​</mo><msub id="S3.E6.m1.52.52.4.49.49.49.49.4" xref="S3.E6.m1.51.51.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml">ℒ</mi><mi id="S3.E6.m1.4.4.4.4.4.4.1" xref="S3.E6.m1.4.4.4.4.4.4.1.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.52.52.4.49.49.49.49.2a" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.52.52.4.49.49.49.49.1.1" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.5.5.5.5" xref="S3.E6.m1.51.51.3.cmml">(</mo><mrow id="S3.E6.m1.52.52.4.49.49.49.49.1.1.1" xref="S3.E6.m1.51.51.3.cmml"><msup id="S3.E6.m1.52.52.4.49.49.49.49.1.1.1.2" xref="S3.E6.m1.51.51.3.cmml"><mi id="S3.E6.m1.6.6.6.6.6.6" xref="S3.E6.m1.6.6.6.6.6.6.cmml">θ</mi><mo id="S3.E6.m1.7.7.7.7.7.7.1" xref="S3.E6.m1.7.7.7.7.7.7.1.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.52.52.4.49.49.49.49.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.52.52.4.49.49.49.49.1.1.1.3" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.8.8.8.8" xref="S3.E6.m1.51.51.3.cmml">(</mo><mi id="S3.E6.m1.9.9.9.9.9.9" xref="S3.E6.m1.9.9.9.9.9.9.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.10.10.10.10.10.10" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.11.11.11.11.11.11" xref="S3.E6.m1.51.51.3.cmml">,</mo><mi id="S3.E6.m1.12.12.12.12.12.12" xref="S3.E6.m1.12.12.12.12.12.12.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.13.13.13.13.13.13" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow><mo rspace="0.1389em" id="S3.E6.m1.14.14.14.14.14.14" xref="S3.E6.m1.14.14.14.14.14.14.cmml">=</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51" xref="S3.E6.m1.51.51.3.cmml"><mrow id="S3.E6.m1.53.53.5.50.50.50.50.1" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.53.53.5.50.50.50.50.1.2" xref="S3.E6.m1.51.51.3.cmml"><mo lspace="0.1389em" rspace="0em" id="S3.E6.m1.15.15.15.15.15.15" xref="S3.E6.m1.15.15.15.15.15.15.cmml">∂</mo><mi id="S3.E6.m1.16.16.16.16.16.16.1" xref="S3.E6.m1.16.16.16.16.16.16.1.cmml">λ</mi></msub><mrow id="S3.E6.m1.53.53.5.50.50.50.50.1.1" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.53.53.5.50.50.50.50.1.1.3" xref="S3.E6.m1.51.51.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.17.17.17.17.17.17" xref="S3.E6.m1.17.17.17.17.17.17.cmml">ℒ</mi><mi id="S3.E6.m1.18.18.18.18.18.18.1" xref="S3.E6.m1.18.18.18.18.18.18.1.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.53.53.5.50.50.50.50.1.1.2" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.53.53.5.50.50.50.50.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.19.19.19.19.19.19" xref="S3.E6.m1.51.51.3.cmml">(</mo><mrow id="S3.E6.m1.53.53.5.50.50.50.50.1.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml"><msup id="S3.E6.m1.53.53.5.50.50.50.50.1.1.1.1.1.2" xref="S3.E6.m1.51.51.3.cmml"><mi id="S3.E6.m1.20.20.20.20.20.20" xref="S3.E6.m1.20.20.20.20.20.20.cmml">θ</mi><mo id="S3.E6.m1.21.21.21.21.21.21.1" xref="S3.E6.m1.21.21.21.21.21.21.1.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.53.53.5.50.50.50.50.1.1.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.53.53.5.50.50.50.50.1.1.1.1.1.3" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.22.22.22.22.22.22" xref="S3.E6.m1.51.51.3.cmml">(</mo><mi id="S3.E6.m1.23.23.23.23.23.23" xref="S3.E6.m1.23.23.23.23.23.23.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.24.24.24.24.24.24" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.25.25.25.25.25.25" xref="S3.E6.m1.51.51.3.cmml">,</mo><mi id="S3.E6.m1.26.26.26.26.26.26" xref="S3.E6.m1.26.26.26.26.26.26.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.27.27.27.27.27.27" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.28.28.28.28.28.28" xref="S3.E6.m1.28.28.28.28.28.28.cmml">+</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.54.54.6.51.51.51.51.2.2" xref="S3.E6.m1.51.51.3.cmml"><mo lspace="0em" rspace="0em" id="S3.E6.m1.29.29.29.29.29.29" xref="S3.E6.m1.29.29.29.29.29.29.cmml">∂</mo><mrow id="S3.E6.m1.30.30.30.30.30.30.1" xref="S3.E6.m1.30.30.30.30.30.30.1.cmml"><msup id="S3.E6.m1.30.30.30.30.30.30.1.3" xref="S3.E6.m1.30.30.30.30.30.30.1.3.cmml"><mi id="S3.E6.m1.30.30.30.30.30.30.1.3.2" xref="S3.E6.m1.30.30.30.30.30.30.1.3.2.cmml">θ</mi><mo id="S3.E6.m1.30.30.30.30.30.30.1.3.3" xref="S3.E6.m1.30.30.30.30.30.30.1.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.30.30.30.30.30.30.1.2" xref="S3.E6.m1.30.30.30.30.30.30.1.2.cmml">​</mo><mrow id="S3.E6.m1.30.30.30.30.30.30.1.4.2" xref="S3.E6.m1.30.30.30.30.30.30.1.cmml"><mo stretchy="false" id="S3.E6.m1.30.30.30.30.30.30.1.4.2.1" xref="S3.E6.m1.30.30.30.30.30.30.1.cmml">(</mo><mi id="S3.E6.m1.30.30.30.30.30.30.1.1" xref="S3.E6.m1.30.30.30.30.30.30.1.1.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.30.30.30.30.30.30.1.4.2.2" xref="S3.E6.m1.30.30.30.30.30.30.1.cmml">)</mo></mrow></mrow></msub><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.54.54.6.51.51.51.51.2.1.3" xref="S3.E6.m1.51.51.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.31.31.31.31.31.31" xref="S3.E6.m1.31.31.31.31.31.31.cmml">ℒ</mi><mi id="S3.E6.m1.32.32.32.32.32.32.1" xref="S3.E6.m1.32.32.32.32.32.32.1.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.54.54.6.51.51.51.51.2.1.2" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.1.1" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.33.33.33.33.33.33" xref="S3.E6.m1.51.51.3.cmml">(</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml"><msup id="S3.E6.m1.54.54.6.51.51.51.51.2.1.1.1.1.2" xref="S3.E6.m1.51.51.3.cmml"><mi id="S3.E6.m1.34.34.34.34.34.34" xref="S3.E6.m1.34.34.34.34.34.34.cmml">θ</mi><mo id="S3.E6.m1.35.35.35.35.35.35.1" xref="S3.E6.m1.35.35.35.35.35.35.1.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.54.54.6.51.51.51.51.2.1.1.1.1.1" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.1.1.1.3" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.36.36.36.36.36.36" xref="S3.E6.m1.51.51.3.cmml">(</mo><mi id="S3.E6.m1.37.37.37.37.37.37" xref="S3.E6.m1.37.37.37.37.37.37.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.38.38.38.38.38.38" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.39.39.39.39.39.39" xref="S3.E6.m1.51.51.3.cmml">,</mo><mi id="S3.E6.m1.40.40.40.40.40.40" xref="S3.E6.m1.40.40.40.40.40.40.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.41.41.41.41.41.41" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow><mo lspace="0.220em" rspace="0em" id="S3.E6.m1.54.54.6.51.51.51.51.2.1.2a" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4" xref="S3.E6.m1.51.51.3.cmml"><msub id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4.1" xref="S3.E6.m1.51.51.3.cmml"><mo rspace="0em" id="S3.E6.m1.42.42.42.42.42.42" xref="S3.E6.m1.42.42.42.42.42.42.cmml">∂</mo><mi id="S3.E6.m1.43.43.43.43.43.43.1" xref="S3.E6.m1.43.43.43.43.43.43.1.cmml">λ</mi></msub><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4.2" xref="S3.E6.m1.51.51.3.cmml"><msup id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4.2.2" xref="S3.E6.m1.51.51.3.cmml"><mi id="S3.E6.m1.44.44.44.44.44.44" xref="S3.E6.m1.44.44.44.44.44.44.cmml">θ</mi><mo id="S3.E6.m1.45.45.45.45.45.45.1" xref="S3.E6.m1.45.45.45.45.45.45.1.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4.2.1" xref="S3.E6.m1.51.51.3.cmml">​</mo><mrow id="S3.E6.m1.54.54.6.51.51.51.51.2.1.4.2.3" xref="S3.E6.m1.51.51.3.cmml"><mo stretchy="false" id="S3.E6.m1.46.46.46.46.46.46" xref="S3.E6.m1.51.51.3.cmml">(</mo><mi id="S3.E6.m1.47.47.47.47.47.47" xref="S3.E6.m1.47.47.47.47.47.47.cmml">λ</mi><mo stretchy="false" id="S3.E6.m1.48.48.48.48.48.48" xref="S3.E6.m1.51.51.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.54b"><apply id="S3.E6.m1.51.51.3.cmml" xref="S3.E6.m1.54.54.6"><eq id="S3.E6.m1.14.14.14.14.14.14.cmml" xref="S3.E6.m1.14.14.14.14.14.14"></eq><apply id="S3.E6.m1.49.49.1.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.49.49.1.1.2.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.49.49.1.1.3.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.49.49.1.1.3.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑑</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1">𝜆</ci></apply><apply id="S3.E6.m1.49.49.1.1.4.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.49.49.1.1.4.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3">ℒ</ci><ci id="S3.E6.m1.4.4.4.4.4.4.1.cmml" xref="S3.E6.m1.4.4.4.4.4.4.1">𝑉</ci></apply><interval closure="open" id="S3.E6.m1.49.49.1.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.49.49.1.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.49.49.1.1.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.49.49.1.1.1.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.49.49.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.54.54.6">superscript</csymbol><ci id="S3.E6.m1.6.6.6.6.6.6.cmml" xref="S3.E6.m1.6.6.6.6.6.6">𝜃</ci><times id="S3.E6.m1.7.7.7.7.7.7.1.cmml" xref="S3.E6.m1.7.7.7.7.7.7.1"></times></apply><ci id="S3.E6.m1.9.9.9.9.9.9.cmml" xref="S3.E6.m1.9.9.9.9.9.9">𝜆</ci></apply><ci id="S3.E6.m1.12.12.12.12.12.12.cmml" xref="S3.E6.m1.12.12.12.12.12.12">𝜆</ci></interval></apply><apply id="S3.E6.m1.51.51.3.3.cmml" xref="S3.E6.m1.54.54.6"><plus id="S3.E6.m1.28.28.28.28.28.28.cmml" xref="S3.E6.m1.28.28.28.28.28.28"></plus><apply id="S3.E6.m1.50.50.2.2.1.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.50.50.2.2.1.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.50.50.2.2.1.2.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><partialdiff id="S3.E6.m1.15.15.15.15.15.15.cmml" xref="S3.E6.m1.15.15.15.15.15.15"></partialdiff><ci id="S3.E6.m1.16.16.16.16.16.16.1.cmml" xref="S3.E6.m1.16.16.16.16.16.16.1">𝜆</ci></apply><apply id="S3.E6.m1.50.50.2.2.1.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.50.50.2.2.1.1.2.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.50.50.2.2.1.1.3.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.50.50.2.2.1.1.3.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><ci id="S3.E6.m1.17.17.17.17.17.17.cmml" xref="S3.E6.m1.17.17.17.17.17.17">ℒ</ci><ci id="S3.E6.m1.18.18.18.18.18.18.1.cmml" xref="S3.E6.m1.18.18.18.18.18.18.1">𝑉</ci></apply><interval closure="open" id="S3.E6.m1.50.50.2.2.1.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.50.50.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.50.50.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.50.50.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.50.50.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.54.54.6">superscript</csymbol><ci id="S3.E6.m1.20.20.20.20.20.20.cmml" xref="S3.E6.m1.20.20.20.20.20.20">𝜃</ci><times id="S3.E6.m1.21.21.21.21.21.21.1.cmml" xref="S3.E6.m1.21.21.21.21.21.21.1"></times></apply><ci id="S3.E6.m1.23.23.23.23.23.23.cmml" xref="S3.E6.m1.23.23.23.23.23.23">𝜆</ci></apply><ci id="S3.E6.m1.26.26.26.26.26.26.cmml" xref="S3.E6.m1.26.26.26.26.26.26">𝜆</ci></interval></apply></apply><apply id="S3.E6.m1.51.51.3.3.2.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.51.51.3.3.2.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.51.51.3.3.2.2.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><partialdiff id="S3.E6.m1.29.29.29.29.29.29.cmml" xref="S3.E6.m1.29.29.29.29.29.29"></partialdiff><apply id="S3.E6.m1.30.30.30.30.30.30.1.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1"><times id="S3.E6.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.2"></times><apply id="S3.E6.m1.30.30.30.30.30.30.1.3.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.30.30.30.30.30.30.1.3.1.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.3">superscript</csymbol><ci id="S3.E6.m1.30.30.30.30.30.30.1.3.2.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.3.2">𝜃</ci><times id="S3.E6.m1.30.30.30.30.30.30.1.3.3.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.3.3"></times></apply><ci id="S3.E6.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E6.m1.30.30.30.30.30.30.1.1">𝜆</ci></apply></apply><apply id="S3.E6.m1.51.51.3.3.2.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.51.51.3.3.2.1.2.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.51.51.3.3.2.1.3.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.51.51.3.3.2.1.3.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><ci id="S3.E6.m1.31.31.31.31.31.31.cmml" xref="S3.E6.m1.31.31.31.31.31.31">ℒ</ci><ci id="S3.E6.m1.32.32.32.32.32.32.1.cmml" xref="S3.E6.m1.32.32.32.32.32.32.1">𝑉</ci></apply><interval closure="open" id="S3.E6.m1.51.51.3.3.2.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.51.51.3.3.2.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.51.51.3.3.2.1.1.1.1.1.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.51.51.3.3.2.1.1.1.1.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.51.51.3.3.2.1.1.1.1.2.1.cmml" xref="S3.E6.m1.54.54.6">superscript</csymbol><ci id="S3.E6.m1.34.34.34.34.34.34.cmml" xref="S3.E6.m1.34.34.34.34.34.34">𝜃</ci><times id="S3.E6.m1.35.35.35.35.35.35.1.cmml" xref="S3.E6.m1.35.35.35.35.35.35.1"></times></apply><ci id="S3.E6.m1.37.37.37.37.37.37.cmml" xref="S3.E6.m1.37.37.37.37.37.37">𝜆</ci></apply><ci id="S3.E6.m1.40.40.40.40.40.40.cmml" xref="S3.E6.m1.40.40.40.40.40.40">𝜆</ci></interval><apply id="S3.E6.m1.51.51.3.3.2.1.4.cmml" xref="S3.E6.m1.54.54.6"><apply id="S3.E6.m1.51.51.3.3.2.1.4.1.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.51.51.3.3.2.1.4.1.1.cmml" xref="S3.E6.m1.54.54.6">subscript</csymbol><partialdiff id="S3.E6.m1.42.42.42.42.42.42.cmml" xref="S3.E6.m1.42.42.42.42.42.42"></partialdiff><ci id="S3.E6.m1.43.43.43.43.43.43.1.cmml" xref="S3.E6.m1.43.43.43.43.43.43.1">𝜆</ci></apply><apply id="S3.E6.m1.51.51.3.3.2.1.4.2.cmml" xref="S3.E6.m1.54.54.6"><times id="S3.E6.m1.51.51.3.3.2.1.4.2.1.cmml" xref="S3.E6.m1.54.54.6"></times><apply id="S3.E6.m1.51.51.3.3.2.1.4.2.2.cmml" xref="S3.E6.m1.54.54.6"><csymbol cd="ambiguous" id="S3.E6.m1.51.51.3.3.2.1.4.2.2.1.cmml" xref="S3.E6.m1.54.54.6">superscript</csymbol><ci id="S3.E6.m1.44.44.44.44.44.44.cmml" xref="S3.E6.m1.44.44.44.44.44.44">𝜃</ci><times id="S3.E6.m1.45.45.45.45.45.45.1.cmml" xref="S3.E6.m1.45.45.45.45.45.45.1"></times></apply><ci id="S3.E6.m1.47.47.47.47.47.47.cmml" xref="S3.E6.m1.47.47.47.47.47.47">𝜆</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.54c">\displaystyle\begin{split}d_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)=\partial_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)+\partial_{\theta^{*}(\lambda)}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)\&gt;\partial_{\lambda}\theta^{*}(\lambda)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p11.3" class="ltx_p">To compute <math id="S3.SS2.p11.3.m1.1" class="ltx_Math" alttext="\partial_{\lambda}\theta^{*}" display="inline"><semantics id="S3.SS2.p11.3.m1.1a"><mrow id="S3.SS2.p11.3.m1.1.1" xref="S3.SS2.p11.3.m1.1.1.cmml"><msub id="S3.SS2.p11.3.m1.1.1.1" xref="S3.SS2.p11.3.m1.1.1.1.cmml"><mo id="S3.SS2.p11.3.m1.1.1.1.2" xref="S3.SS2.p11.3.m1.1.1.1.2.cmml">∂</mo><mi id="S3.SS2.p11.3.m1.1.1.1.3" xref="S3.SS2.p11.3.m1.1.1.1.3.cmml">λ</mi></msub><msup id="S3.SS2.p11.3.m1.1.1.2" xref="S3.SS2.p11.3.m1.1.1.2.cmml"><mi id="S3.SS2.p11.3.m1.1.1.2.2" xref="S3.SS2.p11.3.m1.1.1.2.2.cmml">θ</mi><mo id="S3.SS2.p11.3.m1.1.1.2.3" xref="S3.SS2.p11.3.m1.1.1.2.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.3.m1.1b"><apply id="S3.SS2.p11.3.m1.1.1.cmml" xref="S3.SS2.p11.3.m1.1.1"><apply id="S3.SS2.p11.3.m1.1.1.1.cmml" xref="S3.SS2.p11.3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.3.m1.1.1.1.1.cmml" xref="S3.SS2.p11.3.m1.1.1.1">subscript</csymbol><partialdiff id="S3.SS2.p11.3.m1.1.1.1.2.cmml" xref="S3.SS2.p11.3.m1.1.1.1.2"></partialdiff><ci id="S3.SS2.p11.3.m1.1.1.1.3.cmml" xref="S3.SS2.p11.3.m1.1.1.1.3">𝜆</ci></apply><apply id="S3.SS2.p11.3.m1.1.1.2.cmml" xref="S3.SS2.p11.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p11.3.m1.1.1.2.1.cmml" xref="S3.SS2.p11.3.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.p11.3.m1.1.1.2.2.cmml" xref="S3.SS2.p11.3.m1.1.1.2.2">𝜃</ci><times id="S3.SS2.p11.3.m1.1.1.2.3.cmml" xref="S3.SS2.p11.3.m1.1.1.2.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.3.m1.1c">\partial_{\lambda}\theta^{*}</annotation></semantics></math> in Eq. <a href="#S3.E6" title="Equation 6 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we use the implicit function theorem (IFT):</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.9" class="ltx_Math" alttext="\partial_{\lambda}\theta^{*}|_{\lambda^{{}^{\prime}}}=-(\partial_{\theta}^{2}\mathcal{L}_{T}(\theta,\lambda))^{-1}\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}(\theta,\lambda)|_{\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}})}" display="block"><semantics id="S3.E7.m1.9a"><mrow id="S3.E7.m1.9.9" xref="S3.E7.m1.9.9.cmml"><msub id="S3.E7.m1.8.8.1.1" xref="S3.E7.m1.8.8.1.2.cmml"><mrow id="S3.E7.m1.8.8.1.1.1" xref="S3.E7.m1.8.8.1.2.cmml"><mrow id="S3.E7.m1.8.8.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.cmml"><msub id="S3.E7.m1.8.8.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.cmml"><mo id="S3.E7.m1.8.8.1.1.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.1.1.2.cmml">∂</mo><mi id="S3.E7.m1.8.8.1.1.1.1.1.3" xref="S3.E7.m1.8.8.1.1.1.1.1.3.cmml">λ</mi></msub><msup id="S3.E7.m1.8.8.1.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.1.2.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.2.2" xref="S3.E7.m1.8.8.1.1.1.1.2.2.cmml">θ</mi><mo id="S3.E7.m1.8.8.1.1.1.1.2.3" xref="S3.E7.m1.8.8.1.1.1.1.2.3.cmml">∗</mo></msup></mrow><mo stretchy="false" id="S3.E7.m1.8.8.1.1.1.2" xref="S3.E7.m1.8.8.1.2.1.cmml">|</mo></mrow><msup id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.cmml"><mi id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.2.cmml">λ</mi><msup id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.3.3.1.3.cmml"><mi id="S3.E7.m1.3.3.1.3a" xref="S3.E7.m1.3.3.1.3.cmml"></mi><mo id="S3.E7.m1.3.3.1.3.1" xref="S3.E7.m1.3.3.1.3.1.cmml">′</mo></msup></msup></msub><mo id="S3.E7.m1.9.9.3" xref="S3.E7.m1.9.9.3.cmml">=</mo><mrow id="S3.E7.m1.9.9.2" xref="S3.E7.m1.9.9.2.cmml"><mo id="S3.E7.m1.9.9.2a" xref="S3.E7.m1.9.9.2.cmml">−</mo><msub id="S3.E7.m1.9.9.2.1.1" xref="S3.E7.m1.9.9.2.1.2.cmml"><mrow id="S3.E7.m1.9.9.2.1.1.1" xref="S3.E7.m1.9.9.2.1.2.cmml"><mrow id="S3.E7.m1.9.9.2.1.1.1.1" xref="S3.E7.m1.9.9.2.1.1.1.1.cmml"><msup id="S3.E7.m1.9.9.2.1.1.1.1.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.2.cmml">∂</mo><mi id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi><mn id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mrow id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.2.1" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">θ</mi><mo id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml">λ</mi><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E7.m1.9.9.2.1.1.1.1.1.3" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3.cmml"><mo id="S3.E7.m1.9.9.2.1.1.1.1.1.3a" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3.cmml">−</mo><mn id="S3.E7.m1.9.9.2.1.1.1.1.1.3.2" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.2" xref="S3.E7.m1.9.9.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.9.9.2.1.1.1.1.3" xref="S3.E7.m1.9.9.2.1.1.1.1.3.cmml"><msub id="S3.E7.m1.9.9.2.1.1.1.1.3.1" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.cmml"><mo rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.3.1.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.2.cmml">∂</mo><mrow id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.cmml"><mi id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.1" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.1.cmml">​</mo><mi id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.3" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.3.cmml">θ</mi></mrow></msub><mrow id="S3.E7.m1.9.9.2.1.1.1.1.3.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.cmml"><msub id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mi id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.3" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.1" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.1.cmml">​</mo><mrow id="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.2.1" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.1.cmml">(</mo><mi id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml">θ</mi><mo id="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.2.2" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.1.cmml">,</mo><mi id="S3.E7.m1.7.7" xref="S3.E7.m1.7.7.cmml">λ</mi><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.2.3" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m1.9.9.2.1.1.1.2" xref="S3.E7.m1.9.9.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.3.cmml"><msup id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">λ</mi><msup id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3a" xref="S3.E7.m1.1.1.1.1.1.3.cmml"></mi><mo id="S3.E7.m1.1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><msup id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.2.3.2.cmml">θ</mi><mo id="S3.E7.m1.2.2.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.2.3.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E7.m1.2.2.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E7.m1.2.2.2.2.2.1.1.1.2" xref="S3.E7.m1.2.2.2.2.2.1.1.1.2.cmml">λ</mi><msup id="S3.E7.m1.2.2.2.2.2.1.1.1.3" xref="S3.E7.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.1.1.1.3a" xref="S3.E7.m1.2.2.2.2.2.1.1.1.3.cmml"></mi><mo id="S3.E7.m1.2.2.2.2.2.1.1.1.3.1" xref="S3.E7.m1.2.2.2.2.2.1.1.1.3.1.cmml">′</mo></msup></msup><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.9b"><apply id="S3.E7.m1.9.9.cmml" xref="S3.E7.m1.9.9"><eq id="S3.E7.m1.9.9.3.cmml" xref="S3.E7.m1.9.9.3"></eq><apply id="S3.E7.m1.8.8.1.2.cmml" xref="S3.E7.m1.8.8.1.1"><csymbol cd="latexml" id="S3.E7.m1.8.8.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.2">evaluated-at</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1"><apply id="S3.E7.m1.8.8.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1">subscript</csymbol><partialdiff id="S3.E7.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2"></partialdiff><ci id="S3.E7.m1.8.8.1.1.1.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3">𝜆</ci></apply><apply id="S3.E7.m1.8.8.1.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.2">superscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.2.2">𝜃</ci><times id="S3.E7.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.2.3"></times></apply></apply><apply id="S3.E7.m1.3.3.1.cmml" xref="S3.E7.m1.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1">superscript</csymbol><ci id="S3.E7.m1.3.3.1.2.cmml" xref="S3.E7.m1.3.3.1.2">𝜆</ci><apply id="S3.E7.m1.3.3.1.3.cmml" xref="S3.E7.m1.3.3.1.3"><ci id="S3.E7.m1.3.3.1.3.1.cmml" xref="S3.E7.m1.3.3.1.3.1">′</ci></apply></apply></apply><apply id="S3.E7.m1.9.9.2.cmml" xref="S3.E7.m1.9.9.2"><minus id="S3.E7.m1.9.9.2.2.cmml" xref="S3.E7.m1.9.9.2"></minus><apply id="S3.E7.m1.9.9.2.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.9.9.2.1.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.2">evaluated-at</csymbol><apply id="S3.E7.m1.9.9.2.1.1.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1"><times id="S3.E7.m1.9.9.2.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.2"></times><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1"><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><partialdiff id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.2"></partialdiff><ci id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><cn type="integer" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2"><times id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><interval closure="open" id="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝜃</ci><ci id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5">𝜆</ci></interval></apply></apply><apply id="S3.E7.m1.9.9.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3"><minus id="S3.E7.m1.9.9.2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3"></minus><cn type="integer" id="S3.E7.m1.9.9.2.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S3.E7.m1.9.9.2.1.1.1.1.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3"><apply id="S3.E7.m1.9.9.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.3.1.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1">subscript</csymbol><partialdiff id="S3.E7.m1.9.9.2.1.1.1.1.3.1.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.2"></partialdiff><apply id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3"><times id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.1"></times><ci id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.2">𝜆</ci><ci id="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.1.3.3">𝜃</ci></apply></apply><apply id="S3.E7.m1.9.9.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2"><times id="S3.E7.m1.9.9.2.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.1"></times><apply id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.3.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.2.3">𝑇</ci></apply><interval closure="open" id="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.9.9.2.1.1.1.1.3.2.3.2"><ci id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6">𝜃</ci><ci id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7">𝜆</ci></interval></apply></apply></apply><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2"><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝜆</ci><apply id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3.1">′</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><times id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"></times><apply id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.3">superscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.3.2">𝜃</ci><times id="S3.E7.m1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3.3"></times></apply><apply id="S3.E7.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1.1.2">𝜆</ci><apply id="S3.E7.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1.1.3"><ci id="S3.E7.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.1.1.1.3.1">′</ci></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.9c">\partial_{\lambda}\theta^{*}|_{\lambda^{{}^{\prime}}}=-(\partial_{\theta}^{2}\mathcal{L}_{T}(\theta,\lambda))^{-1}\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}(\theta,\lambda)|_{\lambda^{{}^{\prime}},\theta^{*}(\lambda^{{}^{\prime}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p11.9" class="ltx_p">The full derivation is shown in Appendix <a href="#A1" title="Appendix A Derivation of Equation (7) ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.
We use Neumann approximation and efficient vector-Jacobian product as proposed by <cite class="ltx_cite ltx_citemacro_citet">Lorraine et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite> to approximate the Hessian inverse in Eq. <a href="#S3.E7" title="Equation 7 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and compute the hypergradient, which is further summarized in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In practice, <math id="S3.SS2.p11.4.m1.1" class="ltx_Math" alttext="\theta^{*}" display="inline"><semantics id="S3.SS2.p11.4.m1.1a"><msup id="S3.SS2.p11.4.m1.1.1" xref="S3.SS2.p11.4.m1.1.1.cmml"><mi id="S3.SS2.p11.4.m1.1.1.2" xref="S3.SS2.p11.4.m1.1.1.2.cmml">θ</mi><mo id="S3.SS2.p11.4.m1.1.1.3" xref="S3.SS2.p11.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.4.m1.1b"><apply id="S3.SS2.p11.4.m1.1.1.cmml" xref="S3.SS2.p11.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.4.m1.1.1.1.cmml" xref="S3.SS2.p11.4.m1.1.1">superscript</csymbol><ci id="S3.SS2.p11.4.m1.1.1.2.cmml" xref="S3.SS2.p11.4.m1.1.1.2">𝜃</ci><times id="S3.SS2.p11.4.m1.1.1.3.cmml" xref="S3.SS2.p11.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.4.m1.1c">\theta^{*}</annotation></semantics></math> is approximated by fine-tuning <math id="S3.SS2.p11.5.m2.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS2.p11.5.m2.1a"><msub id="S3.SS2.p11.5.m2.1.1" xref="S3.SS2.p11.5.m2.1.1.cmml"><mi id="S3.SS2.p11.5.m2.1.1.2" xref="S3.SS2.p11.5.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p11.5.m2.1.1.3" xref="S3.SS2.p11.5.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.5.m2.1b"><apply id="S3.SS2.p11.5.m2.1.1.cmml" xref="S3.SS2.p11.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.5.m2.1.1.1.cmml" xref="S3.SS2.p11.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p11.5.m2.1.1.2.cmml" xref="S3.SS2.p11.5.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p11.5.m2.1.1.3.cmml" xref="S3.SS2.p11.5.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.5.m2.1c">\theta_{g}</annotation></semantics></math> on <math id="S3.SS2.p11.6.m3.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="S3.SS2.p11.6.m3.1a"><msub id="S3.SS2.p11.6.m3.1.1" xref="S3.SS2.p11.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p11.6.m3.1.1.2" xref="S3.SS2.p11.6.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p11.6.m3.1.1.3" xref="S3.SS2.p11.6.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.6.m3.1b"><apply id="S3.SS2.p11.6.m3.1.1.cmml" xref="S3.SS2.p11.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.6.m3.1.1.1.cmml" xref="S3.SS2.p11.6.m3.1.1">subscript</csymbol><ci id="S3.SS2.p11.6.m3.1.1.2.cmml" xref="S3.SS2.p11.6.m3.1.1.2">ℒ</ci><ci id="S3.SS2.p11.6.m3.1.1.3.cmml" xref="S3.SS2.p11.6.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.6.m3.1c">\mathcal{L}_{T}</annotation></semantics></math> using the client’s dataset.
Note that unlike in many previous works <cite class="ltx_cite ltx_citemacro_cite">Lorraine et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>); Navon et al. (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> where <math id="S3.SS2.p11.7.m4.1" class="ltx_Math" alttext="\partial_{\lambda}\mathcal{L}_{V}" display="inline"><semantics id="S3.SS2.p11.7.m4.1a"><mrow id="S3.SS2.p11.7.m4.1.1" xref="S3.SS2.p11.7.m4.1.1.cmml"><msub id="S3.SS2.p11.7.m4.1.1.1" xref="S3.SS2.p11.7.m4.1.1.1.cmml"><mo id="S3.SS2.p11.7.m4.1.1.1.2" xref="S3.SS2.p11.7.m4.1.1.1.2.cmml">∂</mo><mi id="S3.SS2.p11.7.m4.1.1.1.3" xref="S3.SS2.p11.7.m4.1.1.1.3.cmml">λ</mi></msub><msub id="S3.SS2.p11.7.m4.1.1.2" xref="S3.SS2.p11.7.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p11.7.m4.1.1.2.2" xref="S3.SS2.p11.7.m4.1.1.2.2.cmml">ℒ</mi><mi id="S3.SS2.p11.7.m4.1.1.2.3" xref="S3.SS2.p11.7.m4.1.1.2.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.7.m4.1b"><apply id="S3.SS2.p11.7.m4.1.1.cmml" xref="S3.SS2.p11.7.m4.1.1"><apply id="S3.SS2.p11.7.m4.1.1.1.cmml" xref="S3.SS2.p11.7.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p11.7.m4.1.1.1.1.cmml" xref="S3.SS2.p11.7.m4.1.1.1">subscript</csymbol><partialdiff id="S3.SS2.p11.7.m4.1.1.1.2.cmml" xref="S3.SS2.p11.7.m4.1.1.1.2"></partialdiff><ci id="S3.SS2.p11.7.m4.1.1.1.3.cmml" xref="S3.SS2.p11.7.m4.1.1.1.3">𝜆</ci></apply><apply id="S3.SS2.p11.7.m4.1.1.2.cmml" xref="S3.SS2.p11.7.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p11.7.m4.1.1.2.1.cmml" xref="S3.SS2.p11.7.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p11.7.m4.1.1.2.2.cmml" xref="S3.SS2.p11.7.m4.1.1.2.2">ℒ</ci><ci id="S3.SS2.p11.7.m4.1.1.2.3.cmml" xref="S3.SS2.p11.7.m4.1.1.2.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.7.m4.1c">\partial_{\lambda}\mathcal{L}_{V}</annotation></semantics></math> is often <math id="S3.SS2.p11.8.m5.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p11.8.m5.1a"><mn id="S3.SS2.p11.8.m5.1.1" xref="S3.SS2.p11.8.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.8.m5.1b"><cn type="integer" id="S3.SS2.p11.8.m5.1.1.cmml" xref="S3.SS2.p11.8.m5.1.1">0</cn></annotation-xml></semantics></math> as the hyperparameters often do not directly affect the validation loss, in our case <math id="S3.SS2.p11.9.m6.1" class="ltx_Math" alttext="\partial_{\boldsymbol{w}_{bn}}\mathcal{L}_{V}\neq 0" display="inline"><semantics id="S3.SS2.p11.9.m6.1a"><mrow id="S3.SS2.p11.9.m6.1.1" xref="S3.SS2.p11.9.m6.1.1.cmml"><mrow id="S3.SS2.p11.9.m6.1.1.2" xref="S3.SS2.p11.9.m6.1.1.2.cmml"><msub id="S3.SS2.p11.9.m6.1.1.2.1" xref="S3.SS2.p11.9.m6.1.1.2.1.cmml"><mo id="S3.SS2.p11.9.m6.1.1.2.1.2" xref="S3.SS2.p11.9.m6.1.1.2.1.2.cmml">∂</mo><msub id="S3.SS2.p11.9.m6.1.1.2.1.3" xref="S3.SS2.p11.9.m6.1.1.2.1.3.cmml"><mi id="S3.SS2.p11.9.m6.1.1.2.1.3.2" xref="S3.SS2.p11.9.m6.1.1.2.1.3.2.cmml">𝒘</mi><mrow id="S3.SS2.p11.9.m6.1.1.2.1.3.3" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.cmml"><mi id="S3.SS2.p11.9.m6.1.1.2.1.3.3.2" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p11.9.m6.1.1.2.1.3.3.1" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p11.9.m6.1.1.2.1.3.3.3" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.3.cmml">n</mi></mrow></msub></msub><msub id="S3.SS2.p11.9.m6.1.1.2.2" xref="S3.SS2.p11.9.m6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p11.9.m6.1.1.2.2.2" xref="S3.SS2.p11.9.m6.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p11.9.m6.1.1.2.2.3" xref="S3.SS2.p11.9.m6.1.1.2.2.3.cmml">V</mi></msub></mrow><mo id="S3.SS2.p11.9.m6.1.1.1" xref="S3.SS2.p11.9.m6.1.1.1.cmml">≠</mo><mn id="S3.SS2.p11.9.m6.1.1.3" xref="S3.SS2.p11.9.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.9.m6.1b"><apply id="S3.SS2.p11.9.m6.1.1.cmml" xref="S3.SS2.p11.9.m6.1.1"><neq id="S3.SS2.p11.9.m6.1.1.1.cmml" xref="S3.SS2.p11.9.m6.1.1.1"></neq><apply id="S3.SS2.p11.9.m6.1.1.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2"><apply id="S3.SS2.p11.9.m6.1.1.2.1.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p11.9.m6.1.1.2.1.1.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1">subscript</csymbol><partialdiff id="S3.SS2.p11.9.m6.1.1.2.1.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.2"></partialdiff><apply id="S3.SS2.p11.9.m6.1.1.2.1.3.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p11.9.m6.1.1.2.1.3.1.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3">subscript</csymbol><ci id="S3.SS2.p11.9.m6.1.1.2.1.3.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3.2">𝒘</ci><apply id="S3.SS2.p11.9.m6.1.1.2.1.3.3.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3"><times id="S3.SS2.p11.9.m6.1.1.2.1.3.3.1.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.1"></times><ci id="S3.SS2.p11.9.m6.1.1.2.1.3.3.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.2">𝑏</ci><ci id="S3.SS2.p11.9.m6.1.1.2.1.3.3.3.cmml" xref="S3.SS2.p11.9.m6.1.1.2.1.3.3.3">𝑛</ci></apply></apply></apply><apply id="S3.SS2.p11.9.m6.1.1.2.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p11.9.m6.1.1.2.2.1.cmml" xref="S3.SS2.p11.9.m6.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p11.9.m6.1.1.2.2.2.cmml" xref="S3.SS2.p11.9.m6.1.1.2.2.2">ℒ</ci><ci id="S3.SS2.p11.9.m6.1.1.2.2.3.cmml" xref="S3.SS2.p11.9.m6.1.1.2.2.3">𝑉</ci></apply></apply><cn type="integer" id="S3.SS2.p11.9.m6.1.1.3.cmml" xref="S3.SS2.p11.9.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.9.m6.1c">\partial_{\boldsymbol{w}_{bn}}\mathcal{L}_{V}\neq 0</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p12" class="ltx_para">
<p id="S3.SS2.p12.14" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes FedL2P. Given a pretrained model and a new group of clients to personalize, we first initialize <math id="S3.SS2.p12.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.1.m1.1a"><mi id="S3.SS2.p12.1.m1.1.1" xref="S3.SS2.p12.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.1.m1.1b"><ci id="S3.SS2.p12.1.m1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.1.m1.1c">\lambda</annotation></semantics></math> (line 1). For every FL round, we sample <math id="S3.SS2.p12.2.m2.1" class="ltx_Math" alttext="Cr" display="inline"><semantics id="S3.SS2.p12.2.m2.1a"><mrow id="S3.SS2.p12.2.m2.1.1" xref="S3.SS2.p12.2.m2.1.1.cmml"><mi id="S3.SS2.p12.2.m2.1.1.2" xref="S3.SS2.p12.2.m2.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p12.2.m2.1.1.1" xref="S3.SS2.p12.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.p12.2.m2.1.1.3" xref="S3.SS2.p12.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.2.m2.1b"><apply id="S3.SS2.p12.2.m2.1.1.cmml" xref="S3.SS2.p12.2.m2.1.1"><times id="S3.SS2.p12.2.m2.1.1.1.cmml" xref="S3.SS2.p12.2.m2.1.1.1"></times><ci id="S3.SS2.p12.2.m2.1.1.2.cmml" xref="S3.SS2.p12.2.m2.1.1.2">𝐶</ci><ci id="S3.SS2.p12.2.m2.1.1.3.cmml" xref="S3.SS2.p12.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.2.m2.1c">Cr</annotation></semantics></math> clients and send both the parameters of the pretrained model and <math id="S3.SS2.p12.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.3.m3.1a"><mi id="S3.SS2.p12.3.m3.1.1" xref="S3.SS2.p12.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.3.m3.1b"><ci id="S3.SS2.p12.3.m3.1.1.cmml" xref="S3.SS2.p12.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.3.m3.1c">\lambda</annotation></semantics></math> to each client (lines 3-5). Each client then performs a forward pass of their local dataset to compute the mean (E) and standard deviation (SD) of the input features to each layer and the statistical distance between the local feature distributions and the pretrained model’s running estimated feature distributions for each BN layer (lines 6-7). <math id="S3.SS2.p12.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.4.m4.1a"><mi id="S3.SS2.p12.4.m4.1.1" xref="S3.SS2.p12.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.4.m4.1b"><ci id="S3.SS2.p12.4.m4.1.1.cmml" xref="S3.SS2.p12.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.4.m4.1c">\lambda</annotation></semantics></math> is then trained for <math id="S3.SS2.p12.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p12.5.m5.1a"><mi id="S3.SS2.p12.5.m5.1.1" xref="S3.SS2.p12.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.5.m5.1b"><ci id="S3.SS2.p12.5.m5.1.1.cmml" xref="S3.SS2.p12.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.5.m5.1c">K</annotation></semantics></math> iterations; each iteration optimizes the pretrained model on <math id="S3.SS2.p12.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="S3.SS2.p12.6.m6.1a"><msub id="S3.SS2.p12.6.m6.1.1" xref="S3.SS2.p12.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p12.6.m6.1.1.2" xref="S3.SS2.p12.6.m6.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p12.6.m6.1.1.3" xref="S3.SS2.p12.6.m6.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.6.m6.1b"><apply id="S3.SS2.p12.6.m6.1.1.cmml" xref="S3.SS2.p12.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p12.6.m6.1.1.1.cmml" xref="S3.SS2.p12.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p12.6.m6.1.1.2.cmml" xref="S3.SS2.p12.6.m6.1.1.2">ℒ</ci><ci id="S3.SS2.p12.6.m6.1.1.3.cmml" xref="S3.SS2.p12.6.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.6.m6.1c">\mathcal{L}_{T}</annotation></semantics></math> for <math id="S3.SS2.p12.7.m7.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p12.7.m7.1a"><mi id="S3.SS2.p12.7.m7.1.1" xref="S3.SS2.p12.7.m7.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.7.m7.1b"><ci id="S3.SS2.p12.7.m7.1.1.cmml" xref="S3.SS2.p12.7.m7.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.7.m7.1c">e</annotation></semantics></math> epochs, applying <math id="S3.SS2.p12.8.m8.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S3.SS2.p12.8.m8.1a"><mi id="S3.SS2.p12.8.m8.1.1" xref="S3.SS2.p12.8.m8.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.8.m8.1b"><ci id="S3.SS2.p12.8.m8.1.1.cmml" xref="S3.SS2.p12.8.m8.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.8.m8.1c">\boldsymbol{\beta}</annotation></semantics></math> and <math id="S3.SS2.p12.9.m9.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S3.SS2.p12.9.m9.1a"><mi id="S3.SS2.p12.9.m9.1.1" xref="S3.SS2.p12.9.m9.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.9.m9.1b"><ci id="S3.SS2.p12.9.m9.1.1.cmml" xref="S3.SS2.p12.9.m9.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.9.m9.1c">\boldsymbol{\eta}</annotation></semantics></math> computed using Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (lines 8-9) at every forward and backward pass respectively. Each client then computes the hypergradient of <math id="S3.SS2.p12.10.m10.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.10.m10.1a"><mi id="S3.SS2.p12.10.m10.1.1" xref="S3.SS2.p12.10.m10.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.10.m10.1b"><ci id="S3.SS2.p12.10.m10.1.1.cmml" xref="S3.SS2.p12.10.m10.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.10.m10.1c">\lambda</annotation></semantics></math> as per Algorithm. <a href="#alg2" title="Algorithm 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and update <math id="S3.SS2.p12.11.m11.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.11.m11.1a"><mi id="S3.SS2.p12.11.m11.1.1" xref="S3.SS2.p12.11.m11.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.11.m11.1b"><ci id="S3.SS2.p12.11.m11.1.1.cmml" xref="S3.SS2.p12.11.m11.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.11.m11.1c">\lambda</annotation></semantics></math> at the end of every iteration (line 10). Finally, after <math id="S3.SS2.p12.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p12.12.m12.1a"><mi id="S3.SS2.p12.12.m12.1.1" xref="S3.SS2.p12.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.12.m12.1b"><ci id="S3.SS2.p12.12.m12.1.1.cmml" xref="S3.SS2.p12.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.12.m12.1c">K</annotation></semantics></math> iterations, each client sends back the updated <math id="S3.SS2.p12.13.m13.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.13.m13.1a"><mi id="S3.SS2.p12.13.m13.1.1" xref="S3.SS2.p12.13.m13.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.13.m13.1b"><ci id="S3.SS2.p12.13.m13.1.1.cmml" xref="S3.SS2.p12.13.m13.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.13.m13.1c">\lambda</annotation></semantics></math> and its number of data samples, which is used for aggregation using FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>)</cite> (lines 12-14). The resulting <math id="S3.SS2.p12.14.m14.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p12.14.m14.1a"><mi id="S3.SS2.p12.14.m14.1.1" xref="S3.SS2.p12.14.m14.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.14.m14.1b"><ci id="S3.SS2.p12.14.m14.1.1.cmml" xref="S3.SS2.p12.14.m14.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.14.m14.1c">\lambda</annotation></semantics></math> is then used for personalization: each client finetunes the model using its training set and evaluates it using its test set.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Adapting the Losses for IFT</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.21" class="ltx_p">In the IFT, we solve the following problem:
</p>
<table id="A6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.7" class="ltx_Math" alttext="\displaystyle\min_{\lambda}\ \mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)\ \ \textrm{s.t.}\ \ \theta^{*}(\lambda)=\arg\min_{\theta}\mathcal{L}_{T}(\theta,\lambda)." display="inline"><semantics id="S3.E8.m1.7a"><mrow id="S3.E8.m1.7.7.1" xref="S3.E8.m1.7.7.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1" xref="S3.E8.m1.7.7.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1.2.2" xref="S3.E8.m1.7.7.1.1.2.3.cmml"><mrow id="S3.E8.m1.7.7.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.7.7.1.1.1.1.1.3" xref="S3.E8.m1.7.7.1.1.1.1.1.3.cmml"><munder id="S3.E8.m1.7.7.1.1.1.1.1.3.1" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1.cmml"><mi id="S3.E8.m1.7.7.1.1.1.1.1.3.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1.2.cmml">min</mi><mi id="S3.E8.m1.7.7.1.1.1.1.1.3.1.3" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1.3.cmml">λ</mi></munder><mo lspace="0.667em" id="S3.E8.m1.7.7.1.1.1.1.1.3a" xref="S3.E8.m1.7.7.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E8.m1.7.7.1.1.1.1.1.3.2" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.7.7.1.1.1.1.1.3.2.2" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.7.7.1.1.1.1.1.3.2.3" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2.3.cmml">V</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.1.1.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.7.7.1.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">λ</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">λ</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.4" xref="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mspace width="1em" id="S3.E8.m1.7.7.1.1.2.2.3" xref="S3.E8.m1.7.7.1.1.2.3.cmml"></mspace><mtext id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6a.cmml">s.t.</mtext><mspace width="1em" id="S3.E8.m1.7.7.1.1.2.2.4" xref="S3.E8.m1.7.7.1.1.2.3.cmml"></mspace><mrow id="S3.E8.m1.7.7.1.1.2.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.cmml"><msup id="S3.E8.m1.7.7.1.1.2.2.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.7.7.1.1.2.2.2.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2.cmml">θ</mi><mo id="S3.E8.m1.7.7.1.1.2.2.2.2.3" xref="S3.E8.m1.7.7.1.1.2.2.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.1.1.2.2.2.1" xref="S3.E8.m1.7.7.1.1.2.2.2.1.cmml">​</mo><mrow id="S3.E8.m1.7.7.1.1.2.2.2.3.2" xref="S3.E8.m1.7.7.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.2.2.2.3.2.1" xref="S3.E8.m1.7.7.1.1.2.2.2.cmml">(</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">λ</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.2.2.2.3.2.2" xref="S3.E8.m1.7.7.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.7.7.1.1.3" xref="S3.E8.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.7.7.1.1.4" xref="S3.E8.m1.7.7.1.1.4.cmml"><mrow id="S3.E8.m1.7.7.1.1.4.2" xref="S3.E8.m1.7.7.1.1.4.2.cmml"><mi id="S3.E8.m1.7.7.1.1.4.2.1" xref="S3.E8.m1.7.7.1.1.4.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E8.m1.7.7.1.1.4.2a" xref="S3.E8.m1.7.7.1.1.4.2.cmml">⁡</mo><mrow id="S3.E8.m1.7.7.1.1.4.2.2" xref="S3.E8.m1.7.7.1.1.4.2.2.cmml"><munder id="S3.E8.m1.7.7.1.1.4.2.2.1" xref="S3.E8.m1.7.7.1.1.4.2.2.1.cmml"><mi id="S3.E8.m1.7.7.1.1.4.2.2.1.2" xref="S3.E8.m1.7.7.1.1.4.2.2.1.2.cmml">min</mi><mi id="S3.E8.m1.7.7.1.1.4.2.2.1.3" xref="S3.E8.m1.7.7.1.1.4.2.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E8.m1.7.7.1.1.4.2.2a" xref="S3.E8.m1.7.7.1.1.4.2.2.cmml">⁡</mo><msub id="S3.E8.m1.7.7.1.1.4.2.2.2" xref="S3.E8.m1.7.7.1.1.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.7.7.1.1.4.2.2.2.2" xref="S3.E8.m1.7.7.1.1.4.2.2.2.2.cmml">ℒ</mi><mi id="S3.E8.m1.7.7.1.1.4.2.2.2.3" xref="S3.E8.m1.7.7.1.1.4.2.2.2.3.cmml">T</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.7.7.1.1.4.1" xref="S3.E8.m1.7.7.1.1.4.1.cmml">​</mo><mrow id="S3.E8.m1.7.7.1.1.4.3.2" xref="S3.E8.m1.7.7.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E8.m1.7.7.1.1.4.3.2.1" xref="S3.E8.m1.7.7.1.1.4.3.1.cmml">(</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">θ</mi><mo id="S3.E8.m1.7.7.1.1.4.3.2.2" xref="S3.E8.m1.7.7.1.1.4.3.1.cmml">,</mo><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">λ</mi><mo stretchy="false" id="S3.E8.m1.7.7.1.1.4.3.2.3" xref="S3.E8.m1.7.7.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E8.m1.7.7.1.2" xref="S3.E8.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.7b"><apply id="S3.E8.m1.7.7.1.1.cmml" xref="S3.E8.m1.7.7.1"><eq id="S3.E8.m1.7.7.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.3"></eq><list id="S3.E8.m1.7.7.1.1.2.3.cmml" xref="S3.E8.m1.7.7.1.1.2.2"><apply id="S3.E8.m1.7.7.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1"><times id="S3.E8.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.2"></times><apply id="S3.E8.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3"><apply id="S3.E8.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><min id="S3.E8.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1.2"></min><ci id="S3.E8.m1.7.7.1.1.1.1.1.3.1.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.1.3">𝜆</ci></apply><apply id="S3.E8.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E8.m1.7.7.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.3.2.3">𝑉</ci></apply></apply><interval closure="open" id="S3.E8.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1"><apply id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2">𝜃</ci><times id="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.7.7.1.1.1.1.1.1.1.1.2.3"></times></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝜆</ci></apply><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝜆</ci></interval></apply><ci id="S3.E8.m1.6.6a.cmml" xref="S3.E8.m1.6.6"><mtext id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6">s.t.</mtext></ci><apply id="S3.E8.m1.7.7.1.1.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2"><times id="S3.E8.m1.7.7.1.1.2.2.2.1.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.1"></times><apply id="S3.E8.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E8.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.2">𝜃</ci><times id="S3.E8.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.7.7.1.1.2.2.2.2.3"></times></apply><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝜆</ci></apply></list><apply id="S3.E8.m1.7.7.1.1.4.cmml" xref="S3.E8.m1.7.7.1.1.4"><times id="S3.E8.m1.7.7.1.1.4.1.cmml" xref="S3.E8.m1.7.7.1.1.4.1"></times><apply id="S3.E8.m1.7.7.1.1.4.2.cmml" xref="S3.E8.m1.7.7.1.1.4.2"><arg id="S3.E8.m1.7.7.1.1.4.2.1.cmml" xref="S3.E8.m1.7.7.1.1.4.2.1"></arg><apply id="S3.E8.m1.7.7.1.1.4.2.2.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2"><apply id="S3.E8.m1.7.7.1.1.4.2.2.1.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.4.2.2.1.1.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.1">subscript</csymbol><min id="S3.E8.m1.7.7.1.1.4.2.2.1.2.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.1.2"></min><ci id="S3.E8.m1.7.7.1.1.4.2.2.1.3.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.1.3">𝜃</ci></apply><apply id="S3.E8.m1.7.7.1.1.4.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.7.7.1.1.4.2.2.2.1.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E8.m1.7.7.1.1.4.2.2.2.2.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.2.2">ℒ</ci><ci id="S3.E8.m1.7.7.1.1.4.2.2.2.3.cmml" xref="S3.E8.m1.7.7.1.1.4.2.2.2.3">𝑇</ci></apply></apply></apply><interval closure="open" id="S3.E8.m1.7.7.1.1.4.3.1.cmml" xref="S3.E8.m1.7.7.1.1.4.3.2"><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝜃</ci><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.7c">\displaystyle\min_{\lambda}\ \mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)\ \ \textrm{s.t.}\ \ \theta^{*}(\lambda)=\arg\min_{\theta}\mathcal{L}_{T}(\theta,\lambda).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.8" class="ltx_p">For the current <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\lambda</annotation></semantics></math>, we first find <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\theta^{*}(\lambda)" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><msup id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2.2" xref="S3.SS3.p1.2.m2.1.2.2.2.cmml">θ</mi><mo id="S3.SS3.p1.2.m2.1.2.2.3" xref="S3.SS3.p1.2.m2.1.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.2.1" xref="S3.SS3.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.2.3.2.1" xref="S3.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.2.m2.1.2.3.2.2" xref="S3.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><times id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1"></times><apply id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2.2">𝜃</ci><times id="S3.SS3.p1.2.m2.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.2.2.3"></times></apply><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\theta^{*}(\lambda)</annotation></semantics></math> in (<a href="#S3.E8" title="Equation 8 ‣ 3.3 Adapting the Losses for IFT ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) by performing several SGD steps with the training loss <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{T}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">ℒ</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathcal{L}_{T}</annotation></semantics></math>. Once <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\theta^{*}(\lambda)" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.2" xref="S3.SS3.p1.4.m4.1.2.cmml"><msup id="S3.SS3.p1.4.m4.1.2.2" xref="S3.SS3.p1.4.m4.1.2.2.cmml"><mi id="S3.SS3.p1.4.m4.1.2.2.2" xref="S3.SS3.p1.4.m4.1.2.2.2.cmml">θ</mi><mo id="S3.SS3.p1.4.m4.1.2.2.3" xref="S3.SS3.p1.4.m4.1.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.2.1" xref="S3.SS3.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.4.m4.1.2.3.2" xref="S3.SS3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.1.2.3.2.1" xref="S3.SS3.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.4.m4.1.2.3.2.2" xref="S3.SS3.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.2.cmml" xref="S3.SS3.p1.4.m4.1.2"><times id="S3.SS3.p1.4.m4.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2.1"></times><apply id="S3.SS3.p1.4.m4.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.2.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.2.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2.2.2">𝜃</ci><times id="S3.SS3.p1.4.m4.1.2.2.3.cmml" xref="S3.SS3.p1.4.m4.1.2.2.3"></times></apply><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\theta^{*}(\lambda)</annotation></semantics></math> is obtained, we can compute the hypergradient <math id="S3.SS3.p1.5.m5.3" class="ltx_Math" alttext="d_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)" display="inline"><semantics id="S3.SS3.p1.5.m5.3a"><mrow id="S3.SS3.p1.5.m5.3.3" xref="S3.SS3.p1.5.m5.3.3.cmml"><msub id="S3.SS3.p1.5.m5.3.3.3" xref="S3.SS3.p1.5.m5.3.3.3.cmml"><mi id="S3.SS3.p1.5.m5.3.3.3.2" xref="S3.SS3.p1.5.m5.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p1.5.m5.3.3.3.3" xref="S3.SS3.p1.5.m5.3.3.3.3.cmml">λ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.3.3.2" xref="S3.SS3.p1.5.m5.3.3.2.cmml">​</mo><msub id="S3.SS3.p1.5.m5.3.3.4" xref="S3.SS3.p1.5.m5.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.3.3.4.2" xref="S3.SS3.p1.5.m5.3.3.4.2.cmml">ℒ</mi><mi id="S3.SS3.p1.5.m5.3.3.4.3" xref="S3.SS3.p1.5.m5.3.3.4.3.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.3.3.2a" xref="S3.SS3.p1.5.m5.3.3.2.cmml">​</mo><mrow id="S3.SS3.p1.5.m5.3.3.1.1" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.2" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml">(</mo><mrow id="S3.SS3.p1.5.m5.3.3.1.1.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml"><msup id="S3.SS3.p1.5.m5.3.3.1.1.1.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml"><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.2.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.2.cmml">θ</mi><mo id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.3.3.1.1.1.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.1.cmml">​</mo><mrow id="S3.SS3.p1.5.m5.3.3.1.1.1.3.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.1.3.2.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.1.3.2.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.5.m5.3.3.1.1.3" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml">,</mo><mi id="S3.SS3.p1.5.m5.2.2" xref="S3.SS3.p1.5.m5.2.2.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.5.m5.3.3.1.1.4" xref="S3.SS3.p1.5.m5.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.3b"><apply id="S3.SS3.p1.5.m5.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3"><times id="S3.SS3.p1.5.m5.3.3.2.cmml" xref="S3.SS3.p1.5.m5.3.3.2"></times><apply id="S3.SS3.p1.5.m5.3.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.3.1.cmml" xref="S3.SS3.p1.5.m5.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.3.2.cmml" xref="S3.SS3.p1.5.m5.3.3.3.2">𝑑</ci><ci id="S3.SS3.p1.5.m5.3.3.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.3.3">𝜆</ci></apply><apply id="S3.SS3.p1.5.m5.3.3.4.cmml" xref="S3.SS3.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.4.1.cmml" xref="S3.SS3.p1.5.m5.3.3.4">subscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.4.2.cmml" xref="S3.SS3.p1.5.m5.3.3.4.2">ℒ</ci><ci id="S3.SS3.p1.5.m5.3.3.4.3.cmml" xref="S3.SS3.p1.5.m5.3.3.4.3">𝑉</ci></apply><interval closure="open" id="S3.SS3.p1.5.m5.3.3.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1"><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1"><times id="S3.SS3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.1"></times><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2">superscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.2">𝜃</ci><times id="S3.SS3.p1.5.m5.3.3.1.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.3"></times></apply><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝜆</ci></apply><ci id="S3.SS3.p1.5.m5.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.3c">d_{\lambda}\mathcal{L}_{V}(\theta^{*}(\lambda),\lambda)</annotation></semantics></math> by the IFT, which is used for updating <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\lambda</annotation></semantics></math>. As described in (<a href="#S3.E6" title="Equation 6 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) and (<a href="#S3.E7" title="Equation 7 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), this hypergradient requires <math id="S3.SS3.p1.7.m7.2" class="ltx_Math" alttext="\partial_{\lambda}\mathcal{L}_{T}(\theta,\lambda)" display="inline"><semantics id="S3.SS3.p1.7.m7.2a"><mrow id="S3.SS3.p1.7.m7.2.3" xref="S3.SS3.p1.7.m7.2.3.cmml"><msub id="S3.SS3.p1.7.m7.2.3.1" xref="S3.SS3.p1.7.m7.2.3.1.cmml"><mo id="S3.SS3.p1.7.m7.2.3.1.2" xref="S3.SS3.p1.7.m7.2.3.1.2.cmml">∂</mo><mi id="S3.SS3.p1.7.m7.2.3.1.3" xref="S3.SS3.p1.7.m7.2.3.1.3.cmml">λ</mi></msub><mrow id="S3.SS3.p1.7.m7.2.3.2" xref="S3.SS3.p1.7.m7.2.3.2.cmml"><msub id="S3.SS3.p1.7.m7.2.3.2.2" xref="S3.SS3.p1.7.m7.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.7.m7.2.3.2.2.2" xref="S3.SS3.p1.7.m7.2.3.2.2.2.cmml">ℒ</mi><mi id="S3.SS3.p1.7.m7.2.3.2.2.3" xref="S3.SS3.p1.7.m7.2.3.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.7.m7.2.3.2.1" xref="S3.SS3.p1.7.m7.2.3.2.1.cmml">​</mo><mrow id="S3.SS3.p1.7.m7.2.3.2.3.2" xref="S3.SS3.p1.7.m7.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.7.m7.2.3.2.3.2.1" xref="S3.SS3.p1.7.m7.2.3.2.3.1.cmml">(</mo><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">θ</mi><mo id="S3.SS3.p1.7.m7.2.3.2.3.2.2" xref="S3.SS3.p1.7.m7.2.3.2.3.1.cmml">,</mo><mi id="S3.SS3.p1.7.m7.2.2" xref="S3.SS3.p1.7.m7.2.2.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.7.m7.2.3.2.3.2.3" xref="S3.SS3.p1.7.m7.2.3.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.2b"><apply id="S3.SS3.p1.7.m7.2.3.cmml" xref="S3.SS3.p1.7.m7.2.3"><apply id="S3.SS3.p1.7.m7.2.3.1.cmml" xref="S3.SS3.p1.7.m7.2.3.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.2.3.1.1.cmml" xref="S3.SS3.p1.7.m7.2.3.1">subscript</csymbol><partialdiff id="S3.SS3.p1.7.m7.2.3.1.2.cmml" xref="S3.SS3.p1.7.m7.2.3.1.2"></partialdiff><ci id="S3.SS3.p1.7.m7.2.3.1.3.cmml" xref="S3.SS3.p1.7.m7.2.3.1.3">𝜆</ci></apply><apply id="S3.SS3.p1.7.m7.2.3.2.cmml" xref="S3.SS3.p1.7.m7.2.3.2"><times id="S3.SS3.p1.7.m7.2.3.2.1.cmml" xref="S3.SS3.p1.7.m7.2.3.2.1"></times><apply id="S3.SS3.p1.7.m7.2.3.2.2.cmml" xref="S3.SS3.p1.7.m7.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.2.3.2.2.1.cmml" xref="S3.SS3.p1.7.m7.2.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.7.m7.2.3.2.2.2.cmml" xref="S3.SS3.p1.7.m7.2.3.2.2.2">ℒ</ci><ci id="S3.SS3.p1.7.m7.2.3.2.2.3.cmml" xref="S3.SS3.p1.7.m7.2.3.2.2.3">𝑇</ci></apply><interval closure="open" id="S3.SS3.p1.7.m7.2.3.2.3.1.cmml" xref="S3.SS3.p1.7.m7.2.3.2.3.2"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝜃</ci><ci id="S3.SS3.p1.7.m7.2.2.cmml" xref="S3.SS3.p1.7.m7.2.2">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.2c">\partial_{\lambda}\mathcal{L}_{T}(\theta,\lambda)</annotation></semantics></math>, implying that the training loss has to be explicitly dependent on the hyperparameter <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\lambda</annotation></semantics></math>. As alluded in <cite class="ltx_cite ltx_citemacro_citet">Lorraine et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, it is usually not straightforward to optimize the learning rate hyperparameter via the IFT, mainly due to the difficulty of expressing the dependency of the training loss on learning rates. To address this issue, we define the training loss as follows:</p>
<table id="A6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m1.11" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{T}(\theta,\lambda)=\mathbb{E}_{(x,y)\sim P_{T}}CE(f_{\theta^{\prime},{\boldsymbol{\beta}}(\lambda)}(x),y)\ \ \textrm{where}" display="inline"><semantics id="S3.E9.m1.11a"><mrow id="S3.E9.m1.11.11" xref="S3.E9.m1.11.11.cmml"><mrow id="S3.E9.m1.11.11.3" xref="S3.E9.m1.11.11.3.cmml"><msub id="S3.E9.m1.11.11.3.2" xref="S3.E9.m1.11.11.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.11.11.3.2.2" xref="S3.E9.m1.11.11.3.2.2.cmml">ℒ</mi><mi id="S3.E9.m1.11.11.3.2.3" xref="S3.E9.m1.11.11.3.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.3.1" xref="S3.E9.m1.11.11.3.1.cmml">​</mo><mrow id="S3.E9.m1.11.11.3.3.2" xref="S3.E9.m1.11.11.3.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.3.3.2.1" xref="S3.E9.m1.11.11.3.3.1.cmml">(</mo><mi id="S3.E9.m1.6.6" xref="S3.E9.m1.6.6.cmml">θ</mi><mo id="S3.E9.m1.11.11.3.3.2.2" xref="S3.E9.m1.11.11.3.3.1.cmml">,</mo><mi id="S3.E9.m1.7.7" xref="S3.E9.m1.7.7.cmml">λ</mi><mo stretchy="false" id="S3.E9.m1.11.11.3.3.2.3" xref="S3.E9.m1.11.11.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.11.11.2" xref="S3.E9.m1.11.11.2.cmml">=</mo><mrow id="S3.E9.m1.11.11.1.1" xref="S3.E9.m1.11.11.1.2.cmml"><mrow id="S3.E9.m1.11.11.1.1.1" xref="S3.E9.m1.11.11.1.1.1.cmml"><msub id="S3.E9.m1.11.11.1.1.1.3" xref="S3.E9.m1.11.11.1.1.1.3.cmml"><mi id="S3.E9.m1.11.11.1.1.1.3.2" xref="S3.E9.m1.11.11.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mrow id="S3.E9.m1.2.2.2.4.2" xref="S3.E9.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.4.2.1" xref="S3.E9.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">x</mi><mo id="S3.E9.m1.2.2.2.4.2.2" xref="S3.E9.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E9.m1.2.2.2.4.2.3" xref="S3.E9.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E9.m1.2.2.2.5" xref="S3.E9.m1.2.2.2.5.cmml"><mi id="S3.E9.m1.2.2.2.5.2" xref="S3.E9.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.E9.m1.2.2.2.5.3" xref="S3.E9.m1.2.2.2.5.3.cmml">T</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.2.cmml">​</mo><mi id="S3.E9.m1.11.11.1.1.1.4" xref="S3.E9.m1.11.11.1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.2a" xref="S3.E9.m1.11.11.1.1.1.2.cmml">​</mo><mi id="S3.E9.m1.11.11.1.1.1.5" xref="S3.E9.m1.11.11.1.1.1.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.2b" xref="S3.E9.m1.11.11.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.2.cmml">(</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.11.11.1.1.1.1.1.1.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.11.11.1.1.1.1.1.1.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.2.cmml">f</mi><mrow id="S3.E9.m1.5.5.3.3" xref="S3.E9.m1.5.5.3.4.cmml"><msup id="S3.E9.m1.4.4.2.2.1" xref="S3.E9.m1.4.4.2.2.1.cmml"><mi id="S3.E9.m1.4.4.2.2.1.2" xref="S3.E9.m1.4.4.2.2.1.2.cmml">θ</mi><mo id="S3.E9.m1.4.4.2.2.1.3" xref="S3.E9.m1.4.4.2.2.1.3.cmml">′</mo></msup><mo id="S3.E9.m1.5.5.3.3.3" xref="S3.E9.m1.5.5.3.4.cmml">,</mo><mrow id="S3.E9.m1.5.5.3.3.2" xref="S3.E9.m1.5.5.3.3.2.cmml"><mi id="S3.E9.m1.5.5.3.3.2.2" xref="S3.E9.m1.5.5.3.3.2.2.cmml">𝜷</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.3.3.2.1" xref="S3.E9.m1.5.5.3.3.2.1.cmml">​</mo><mrow id="S3.E9.m1.5.5.3.3.2.3.2" xref="S3.E9.m1.5.5.3.3.2.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.3.3.2.3.2.1" xref="S3.E9.m1.5.5.3.3.2.cmml">(</mo><mi id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">λ</mi><mo stretchy="false" id="S3.E9.m1.5.5.3.3.2.3.2.2" xref="S3.E9.m1.5.5.3.3.2.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.11.11.1.1.1.1.1.1.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.11.11.1.1.1.1.1.1.3.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.11.11.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.8.8" xref="S3.E9.m1.8.8.cmml">x</mi><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.11.11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.11.11.1.1.1.1.1.3" xref="S3.E9.m1.11.11.1.1.1.1.2.cmml">,</mo><mi id="S3.E9.m1.9.9" xref="S3.E9.m1.9.9.cmml">y</mi><mo stretchy="false" id="S3.E9.m1.11.11.1.1.1.1.1.4" xref="S3.E9.m1.11.11.1.1.1.1.2.cmml">)</mo></mrow></mrow><mspace width="1em" id="S3.E9.m1.11.11.1.1.2" xref="S3.E9.m1.11.11.1.2.cmml"></mspace><mtext id="S3.E9.m1.10.10" xref="S3.E9.m1.10.10a.cmml">where</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.11b"><apply id="S3.E9.m1.11.11.cmml" xref="S3.E9.m1.11.11"><eq id="S3.E9.m1.11.11.2.cmml" xref="S3.E9.m1.11.11.2"></eq><apply id="S3.E9.m1.11.11.3.cmml" xref="S3.E9.m1.11.11.3"><times id="S3.E9.m1.11.11.3.1.cmml" xref="S3.E9.m1.11.11.3.1"></times><apply id="S3.E9.m1.11.11.3.2.cmml" xref="S3.E9.m1.11.11.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.3.2.1.cmml" xref="S3.E9.m1.11.11.3.2">subscript</csymbol><ci id="S3.E9.m1.11.11.3.2.2.cmml" xref="S3.E9.m1.11.11.3.2.2">ℒ</ci><ci id="S3.E9.m1.11.11.3.2.3.cmml" xref="S3.E9.m1.11.11.3.2.3">𝑇</ci></apply><interval closure="open" id="S3.E9.m1.11.11.3.3.1.cmml" xref="S3.E9.m1.11.11.3.3.2"><ci id="S3.E9.m1.6.6.cmml" xref="S3.E9.m1.6.6">𝜃</ci><ci id="S3.E9.m1.7.7.cmml" xref="S3.E9.m1.7.7">𝜆</ci></interval></apply><list id="S3.E9.m1.11.11.1.2.cmml" xref="S3.E9.m1.11.11.1.1"><apply id="S3.E9.m1.11.11.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1"><times id="S3.E9.m1.11.11.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.2"></times><apply id="S3.E9.m1.11.11.1.1.1.3.cmml" xref="S3.E9.m1.11.11.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.3.1.cmml" xref="S3.E9.m1.11.11.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.1.3.2.cmml" xref="S3.E9.m1.11.11.1.1.1.3.2">𝔼</ci><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><csymbol cd="latexml" id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E9.m1.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.4.2"><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑥</ci><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E9.m1.2.2.2.5.cmml" xref="S3.E9.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.5.1.cmml" xref="S3.E9.m1.2.2.2.5">subscript</csymbol><ci id="S3.E9.m1.2.2.2.5.2.cmml" xref="S3.E9.m1.2.2.2.5.2">𝑃</ci><ci id="S3.E9.m1.2.2.2.5.3.cmml" xref="S3.E9.m1.2.2.2.5.3">𝑇</ci></apply></apply></apply><ci id="S3.E9.m1.11.11.1.1.1.4.cmml" xref="S3.E9.m1.11.11.1.1.1.4">𝐶</ci><ci id="S3.E9.m1.11.11.1.1.1.5.cmml" xref="S3.E9.m1.11.11.1.1.1.5">𝐸</ci><interval closure="open" id="S3.E9.m1.11.11.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1"><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1"><times id="S3.E9.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.1"></times><apply id="S3.E9.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.11.11.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.11.11.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.11.11.1.1.1.1.1.1.2.2">𝑓</ci><list id="S3.E9.m1.5.5.3.4.cmml" xref="S3.E9.m1.5.5.3.3"><apply id="S3.E9.m1.4.4.2.2.1.cmml" xref="S3.E9.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.2.2.1.1.cmml" xref="S3.E9.m1.4.4.2.2.1">superscript</csymbol><ci id="S3.E9.m1.4.4.2.2.1.2.cmml" xref="S3.E9.m1.4.4.2.2.1.2">𝜃</ci><ci id="S3.E9.m1.4.4.2.2.1.3.cmml" xref="S3.E9.m1.4.4.2.2.1.3">′</ci></apply><apply id="S3.E9.m1.5.5.3.3.2.cmml" xref="S3.E9.m1.5.5.3.3.2"><times id="S3.E9.m1.5.5.3.3.2.1.cmml" xref="S3.E9.m1.5.5.3.3.2.1"></times><ci id="S3.E9.m1.5.5.3.3.2.2.cmml" xref="S3.E9.m1.5.5.3.3.2.2">𝜷</ci><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">𝜆</ci></apply></list></apply><ci id="S3.E9.m1.8.8.cmml" xref="S3.E9.m1.8.8">𝑥</ci></apply><ci id="S3.E9.m1.9.9.cmml" xref="S3.E9.m1.9.9">𝑦</ci></interval></apply><ci id="S3.E9.m1.10.10a.cmml" xref="S3.E9.m1.10.10"><mtext id="S3.E9.m1.10.10.cmml" xref="S3.E9.m1.10.10">where</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.11c">\displaystyle\mathcal{L}_{T}(\theta,\lambda)=\mathbb{E}_{(x,y)\sim P_{T}}CE(f_{\theta^{\prime},{\boldsymbol{\beta}}(\lambda)}(x),y)\ \ \textrm{where}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m1.9" class="ltx_Math" alttext="\displaystyle\ \ \ \ \theta^{\prime}=\theta-{\boldsymbol{\eta}}(\lambda)\nabla_{\theta}\mathbb{E}_{(x,y)\sim P_{T}}CE(f_{\theta,{\boldsymbol{\beta}}(\lambda)}(x),y)." display="inline"><semantics id="S3.E10.m1.9a"><mrow id="S3.E10.m1.9.9.1" xref="S3.E10.m1.9.9.1.1.cmml"><mrow id="S3.E10.m1.9.9.1.1" xref="S3.E10.m1.9.9.1.1.cmml"><msup id="S3.E10.m1.9.9.1.1.3" xref="S3.E10.m1.9.9.1.1.3.cmml"><mi id="S3.E10.m1.9.9.1.1.3.2" xref="S3.E10.m1.9.9.1.1.3.2.cmml">θ</mi><mo id="S3.E10.m1.9.9.1.1.3.3" xref="S3.E10.m1.9.9.1.1.3.3.cmml">′</mo></msup><mo id="S3.E10.m1.9.9.1.1.2" xref="S3.E10.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.9.9.1.1.1" xref="S3.E10.m1.9.9.1.1.1.cmml"><mi id="S3.E10.m1.9.9.1.1.1.3" xref="S3.E10.m1.9.9.1.1.1.3.cmml">θ</mi><mo id="S3.E10.m1.9.9.1.1.1.2" xref="S3.E10.m1.9.9.1.1.1.2.cmml">−</mo><mrow id="S3.E10.m1.9.9.1.1.1.1" xref="S3.E10.m1.9.9.1.1.1.1.cmml"><mi id="S3.E10.m1.9.9.1.1.1.1.3" xref="S3.E10.m1.9.9.1.1.1.1.3.cmml">𝜼</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.2" xref="S3.E10.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.9.9.1.1.1.1.4.2" xref="S3.E10.m1.9.9.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.4.2.1" xref="S3.E10.m1.9.9.1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.6.6" xref="S3.E10.m1.6.6.cmml">λ</mi><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.4.2.2" xref="S3.E10.m1.9.9.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.2a" xref="S3.E10.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.9.9.1.1.1.1.5" xref="S3.E10.m1.9.9.1.1.1.1.5.cmml"><msub id="S3.E10.m1.9.9.1.1.1.1.5.1" xref="S3.E10.m1.9.9.1.1.1.1.5.1.cmml"><mo rspace="0.167em" id="S3.E10.m1.9.9.1.1.1.1.5.1.2" xref="S3.E10.m1.9.9.1.1.1.1.5.1.2.cmml">∇</mo><mi id="S3.E10.m1.9.9.1.1.1.1.5.1.3" xref="S3.E10.m1.9.9.1.1.1.1.5.1.3.cmml">θ</mi></msub><mrow id="S3.E10.m1.9.9.1.1.1.1.5.2" xref="S3.E10.m1.9.9.1.1.1.1.5.2.cmml"><msub id="S3.E10.m1.9.9.1.1.1.1.5.2.2" xref="S3.E10.m1.9.9.1.1.1.1.5.2.2.cmml"><mi id="S3.E10.m1.9.9.1.1.1.1.5.2.2.2" xref="S3.E10.m1.9.9.1.1.1.1.5.2.2.2.cmml">𝔼</mi><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><mrow id="S3.E10.m1.2.2.2.4.2" xref="S3.E10.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.4.2.1" xref="S3.E10.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">x</mi><mo id="S3.E10.m1.2.2.2.4.2.2" xref="S3.E10.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E10.m1.2.2.2.4.2.3" xref="S3.E10.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E10.m1.2.2.2.5" xref="S3.E10.m1.2.2.2.5.cmml"><mi id="S3.E10.m1.2.2.2.5.2" xref="S3.E10.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.E10.m1.2.2.2.5.3" xref="S3.E10.m1.2.2.2.5.3.cmml">T</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.5.2.1" xref="S3.E10.m1.9.9.1.1.1.1.5.2.1.cmml">​</mo><mi id="S3.E10.m1.9.9.1.1.1.1.5.2.3" xref="S3.E10.m1.9.9.1.1.1.1.5.2.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.5.2.1a" xref="S3.E10.m1.9.9.1.1.1.1.5.2.1.cmml">​</mo><mi id="S3.E10.m1.9.9.1.1.1.1.5.2.4" xref="S3.E10.m1.9.9.1.1.1.1.5.2.4.cmml">E</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.2b" xref="S3.E10.m1.9.9.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.9.9.1.1.1.1.1.1" xref="S3.E10.m1.9.9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.1.1.2" xref="S3.E10.m1.9.9.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E10.m1.9.9.1.1.1.1.1.1.1" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.2.cmml">f</mi><mrow id="S3.E10.m1.5.5.3.3" xref="S3.E10.m1.5.5.3.4.cmml"><mi id="S3.E10.m1.4.4.2.2" xref="S3.E10.m1.4.4.2.2.cmml">θ</mi><mo id="S3.E10.m1.5.5.3.3.2" xref="S3.E10.m1.5.5.3.4.cmml">,</mo><mrow id="S3.E10.m1.5.5.3.3.1" xref="S3.E10.m1.5.5.3.3.1.cmml"><mi id="S3.E10.m1.5.5.3.3.1.2" xref="S3.E10.m1.5.5.3.3.1.2.cmml">𝜷</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.5.5.3.3.1.1" xref="S3.E10.m1.5.5.3.3.1.1.cmml">​</mo><mrow id="S3.E10.m1.5.5.3.3.1.3.2" xref="S3.E10.m1.5.5.3.3.1.cmml"><mo stretchy="false" id="S3.E10.m1.5.5.3.3.1.3.2.1" xref="S3.E10.m1.5.5.3.3.1.cmml">(</mo><mi id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml">λ</mi><mo stretchy="false" id="S3.E10.m1.5.5.3.3.1.3.2.2" xref="S3.E10.m1.5.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E10.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.1.1.1.3.2.1" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml">x</mi><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.9.9.1.1.1.1.1.1.3" xref="S3.E10.m1.9.9.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E10.m1.8.8" xref="S3.E10.m1.8.8.cmml">y</mi><mo stretchy="false" id="S3.E10.m1.9.9.1.1.1.1.1.1.4" xref="S3.E10.m1.9.9.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E10.m1.9.9.1.2" xref="S3.E10.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.9b"><apply id="S3.E10.m1.9.9.1.1.cmml" xref="S3.E10.m1.9.9.1"><eq id="S3.E10.m1.9.9.1.1.2.cmml" xref="S3.E10.m1.9.9.1.1.2"></eq><apply id="S3.E10.m1.9.9.1.1.3.cmml" xref="S3.E10.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.1.1.3.1.cmml" xref="S3.E10.m1.9.9.1.1.3">superscript</csymbol><ci id="S3.E10.m1.9.9.1.1.3.2.cmml" xref="S3.E10.m1.9.9.1.1.3.2">𝜃</ci><ci id="S3.E10.m1.9.9.1.1.3.3.cmml" xref="S3.E10.m1.9.9.1.1.3.3">′</ci></apply><apply id="S3.E10.m1.9.9.1.1.1.cmml" xref="S3.E10.m1.9.9.1.1.1"><minus id="S3.E10.m1.9.9.1.1.1.2.cmml" xref="S3.E10.m1.9.9.1.1.1.2"></minus><ci id="S3.E10.m1.9.9.1.1.1.3.cmml" xref="S3.E10.m1.9.9.1.1.1.3">𝜃</ci><apply id="S3.E10.m1.9.9.1.1.1.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1"><times id="S3.E10.m1.9.9.1.1.1.1.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.2"></times><ci id="S3.E10.m1.9.9.1.1.1.1.3.cmml" xref="S3.E10.m1.9.9.1.1.1.1.3">𝜼</ci><ci id="S3.E10.m1.6.6.cmml" xref="S3.E10.m1.6.6">𝜆</ci><apply id="S3.E10.m1.9.9.1.1.1.1.5.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5"><apply id="S3.E10.m1.9.9.1.1.1.1.5.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.1.1.1.1.5.1.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.1">subscript</csymbol><ci id="S3.E10.m1.9.9.1.1.1.1.5.1.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.1.2">∇</ci><ci id="S3.E10.m1.9.9.1.1.1.1.5.1.3.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.1.3">𝜃</ci></apply><apply id="S3.E10.m1.9.9.1.1.1.1.5.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2"><times id="S3.E10.m1.9.9.1.1.1.1.5.2.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.1"></times><apply id="S3.E10.m1.9.9.1.1.1.1.5.2.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.1.1.1.1.5.2.2.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.2">subscript</csymbol><ci id="S3.E10.m1.9.9.1.1.1.1.5.2.2.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.2.2">𝔼</ci><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><csymbol cd="latexml" id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E10.m1.2.2.2.4.1.cmml" xref="S3.E10.m1.2.2.2.4.2"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑥</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E10.m1.2.2.2.5.cmml" xref="S3.E10.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.5.1.cmml" xref="S3.E10.m1.2.2.2.5">subscript</csymbol><ci id="S3.E10.m1.2.2.2.5.2.cmml" xref="S3.E10.m1.2.2.2.5.2">𝑃</ci><ci id="S3.E10.m1.2.2.2.5.3.cmml" xref="S3.E10.m1.2.2.2.5.3">𝑇</ci></apply></apply></apply><ci id="S3.E10.m1.9.9.1.1.1.1.5.2.3.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.3">𝐶</ci><ci id="S3.E10.m1.9.9.1.1.1.1.5.2.4.cmml" xref="S3.E10.m1.9.9.1.1.1.1.5.2.4">𝐸</ci></apply></apply><interval closure="open" id="S3.E10.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1"><apply id="S3.E10.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1"><times id="S3.E10.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.1"></times><apply id="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.9.9.1.1.1.1.1.1.1.2.2">𝑓</ci><list id="S3.E10.m1.5.5.3.4.cmml" xref="S3.E10.m1.5.5.3.3"><ci id="S3.E10.m1.4.4.2.2.cmml" xref="S3.E10.m1.4.4.2.2">𝜃</ci><apply id="S3.E10.m1.5.5.3.3.1.cmml" xref="S3.E10.m1.5.5.3.3.1"><times id="S3.E10.m1.5.5.3.3.1.1.cmml" xref="S3.E10.m1.5.5.3.3.1.1"></times><ci id="S3.E10.m1.5.5.3.3.1.2.cmml" xref="S3.E10.m1.5.5.3.3.1.2">𝜷</ci><ci id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1.1">𝜆</ci></apply></list></apply><ci id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7">𝑥</ci></apply><ci id="S3.E10.m1.8.8.cmml" xref="S3.E10.m1.8.8">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.9c">\displaystyle\ \ \ \ \theta^{\prime}=\theta-{\boldsymbol{\eta}}(\lambda)\nabla_{\theta}\mathbb{E}_{(x,y)\sim P_{T}}CE(f_{\theta,{\boldsymbol{\beta}}(\lambda)}(x),y).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.19" class="ltx_p">Here <math id="S3.SS3.p1.9.m1.3" class="ltx_Math" alttext="f_{\theta,{\boldsymbol{\beta}}}(x)" display="inline"><semantics id="S3.SS3.p1.9.m1.3a"><mrow id="S3.SS3.p1.9.m1.3.4" xref="S3.SS3.p1.9.m1.3.4.cmml"><msub id="S3.SS3.p1.9.m1.3.4.2" xref="S3.SS3.p1.9.m1.3.4.2.cmml"><mi id="S3.SS3.p1.9.m1.3.4.2.2" xref="S3.SS3.p1.9.m1.3.4.2.2.cmml">f</mi><mrow id="S3.SS3.p1.9.m1.2.2.2.4" xref="S3.SS3.p1.9.m1.2.2.2.3.cmml"><mi id="S3.SS3.p1.9.m1.1.1.1.1" xref="S3.SS3.p1.9.m1.1.1.1.1.cmml">θ</mi><mo id="S3.SS3.p1.9.m1.2.2.2.4.1" xref="S3.SS3.p1.9.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.9.m1.2.2.2.2" xref="S3.SS3.p1.9.m1.2.2.2.2.cmml">𝜷</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m1.3.4.1" xref="S3.SS3.p1.9.m1.3.4.1.cmml">​</mo><mrow id="S3.SS3.p1.9.m1.3.4.3.2" xref="S3.SS3.p1.9.m1.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.9.m1.3.4.3.2.1" xref="S3.SS3.p1.9.m1.3.4.cmml">(</mo><mi id="S3.SS3.p1.9.m1.3.3" xref="S3.SS3.p1.9.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.SS3.p1.9.m1.3.4.3.2.2" xref="S3.SS3.p1.9.m1.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m1.3b"><apply id="S3.SS3.p1.9.m1.3.4.cmml" xref="S3.SS3.p1.9.m1.3.4"><times id="S3.SS3.p1.9.m1.3.4.1.cmml" xref="S3.SS3.p1.9.m1.3.4.1"></times><apply id="S3.SS3.p1.9.m1.3.4.2.cmml" xref="S3.SS3.p1.9.m1.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m1.3.4.2.1.cmml" xref="S3.SS3.p1.9.m1.3.4.2">subscript</csymbol><ci id="S3.SS3.p1.9.m1.3.4.2.2.cmml" xref="S3.SS3.p1.9.m1.3.4.2.2">𝑓</ci><list id="S3.SS3.p1.9.m1.2.2.2.3.cmml" xref="S3.SS3.p1.9.m1.2.2.2.4"><ci id="S3.SS3.p1.9.m1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m1.1.1.1.1">𝜃</ci><ci id="S3.SS3.p1.9.m1.2.2.2.2.cmml" xref="S3.SS3.p1.9.m1.2.2.2.2">𝜷</ci></list></apply><ci id="S3.SS3.p1.9.m1.3.3.cmml" xref="S3.SS3.p1.9.m1.3.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m1.3c">f_{\theta,{\boldsymbol{\beta}}}(x)</annotation></semantics></math> indicates the forward pass with network weights <math id="S3.SS3.p1.10.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p1.10.m2.1a"><mi id="S3.SS3.p1.10.m2.1.1" xref="S3.SS3.p1.10.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m2.1b"><ci id="S3.SS3.p1.10.m2.1.1.cmml" xref="S3.SS3.p1.10.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m2.1c">\theta</annotation></semantics></math> and the batch norm statistics <math id="S3.SS3.p1.11.m3.1" class="ltx_Math" alttext="{\boldsymbol{\beta}}" display="inline"><semantics id="S3.SS3.p1.11.m3.1a"><mi id="S3.SS3.p1.11.m3.1.1" xref="S3.SS3.p1.11.m3.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m3.1b"><ci id="S3.SS3.p1.11.m3.1.1.cmml" xref="S3.SS3.p1.11.m3.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m3.1c">{\boldsymbol{\beta}}</annotation></semantics></math>, and <math id="S3.SS3.p1.12.m4.1" class="ltx_Math" alttext="CE()" display="inline"><semantics id="S3.SS3.p1.12.m4.1a"><mrow id="S3.SS3.p1.12.m4.1.1" xref="S3.SS3.p1.12.m4.1.1.cmml"><mi id="S3.SS3.p1.12.m4.1.1.2" xref="S3.SS3.p1.12.m4.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.12.m4.1.1.1" xref="S3.SS3.p1.12.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.p1.12.m4.1.1.3" xref="S3.SS3.p1.12.m4.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.12.m4.1.1.1a" xref="S3.SS3.p1.12.m4.1.1.1.cmml">​</mo><mrow id="S3.SS3.p1.12.m4.1.1.4.2" xref="S3.SS3.p1.12.m4.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.12.m4.1.1.4.2.1" xref="S3.SS3.p1.12.m4.1.1.4.1.cmml">(</mo><mo stretchy="false" id="S3.SS3.p1.12.m4.1.1.4.2.2" xref="S3.SS3.p1.12.m4.1.1.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m4.1b"><apply id="S3.SS3.p1.12.m4.1.1.cmml" xref="S3.SS3.p1.12.m4.1.1"><times id="S3.SS3.p1.12.m4.1.1.1.cmml" xref="S3.SS3.p1.12.m4.1.1.1"></times><ci id="S3.SS3.p1.12.m4.1.1.2.cmml" xref="S3.SS3.p1.12.m4.1.1.2">𝐶</ci><ci id="S3.SS3.p1.12.m4.1.1.3.cmml" xref="S3.SS3.p1.12.m4.1.1.3">𝐸</ci><list id="S3.SS3.p1.12.m4.1.1.4.1.cmml" xref="S3.SS3.p1.12.m4.1.1.4.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m4.1c">CE()</annotation></semantics></math> is the cross-entropy loss. Note that in (<a href="#S3.E10" title="Equation 10 ‣ 3.3 Adapting the Losses for IFT ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), we can take several (not just one) gradient update steps to obtain <math id="S3.SS3.p1.13.m5.1" class="ltx_Math" alttext="\theta^{\prime}" display="inline"><semantics id="S3.SS3.p1.13.m5.1a"><msup id="S3.SS3.p1.13.m5.1.1" xref="S3.SS3.p1.13.m5.1.1.cmml"><mi id="S3.SS3.p1.13.m5.1.1.2" xref="S3.SS3.p1.13.m5.1.1.2.cmml">θ</mi><mo id="S3.SS3.p1.13.m5.1.1.3" xref="S3.SS3.p1.13.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m5.1b"><apply id="S3.SS3.p1.13.m5.1.1.cmml" xref="S3.SS3.p1.13.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m5.1.1.1.cmml" xref="S3.SS3.p1.13.m5.1.1">superscript</csymbol><ci id="S3.SS3.p1.13.m5.1.1.2.cmml" xref="S3.SS3.p1.13.m5.1.1.2">𝜃</ci><ci id="S3.SS3.p1.13.m5.1.1.3.cmml" xref="S3.SS3.p1.13.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m5.1c">\theta^{\prime}</annotation></semantics></math>.
Now, we can see that <math id="S3.SS3.p1.14.m6.2" class="ltx_Math" alttext="\mathcal{L}_{T}(\theta,\lambda)" display="inline"><semantics id="S3.SS3.p1.14.m6.2a"><mrow id="S3.SS3.p1.14.m6.2.3" xref="S3.SS3.p1.14.m6.2.3.cmml"><msub id="S3.SS3.p1.14.m6.2.3.2" xref="S3.SS3.p1.14.m6.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m6.2.3.2.2" xref="S3.SS3.p1.14.m6.2.3.2.2.cmml">ℒ</mi><mi id="S3.SS3.p1.14.m6.2.3.2.3" xref="S3.SS3.p1.14.m6.2.3.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m6.2.3.1" xref="S3.SS3.p1.14.m6.2.3.1.cmml">​</mo><mrow id="S3.SS3.p1.14.m6.2.3.3.2" xref="S3.SS3.p1.14.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.14.m6.2.3.3.2.1" xref="S3.SS3.p1.14.m6.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p1.14.m6.1.1" xref="S3.SS3.p1.14.m6.1.1.cmml">θ</mi><mo id="S3.SS3.p1.14.m6.2.3.3.2.2" xref="S3.SS3.p1.14.m6.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p1.14.m6.2.2" xref="S3.SS3.p1.14.m6.2.2.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.14.m6.2.3.3.2.3" xref="S3.SS3.p1.14.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m6.2b"><apply id="S3.SS3.p1.14.m6.2.3.cmml" xref="S3.SS3.p1.14.m6.2.3"><times id="S3.SS3.p1.14.m6.2.3.1.cmml" xref="S3.SS3.p1.14.m6.2.3.1"></times><apply id="S3.SS3.p1.14.m6.2.3.2.cmml" xref="S3.SS3.p1.14.m6.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m6.2.3.2.1.cmml" xref="S3.SS3.p1.14.m6.2.3.2">subscript</csymbol><ci id="S3.SS3.p1.14.m6.2.3.2.2.cmml" xref="S3.SS3.p1.14.m6.2.3.2.2">ℒ</ci><ci id="S3.SS3.p1.14.m6.2.3.2.3.cmml" xref="S3.SS3.p1.14.m6.2.3.2.3">𝑇</ci></apply><interval closure="open" id="S3.SS3.p1.14.m6.2.3.3.1.cmml" xref="S3.SS3.p1.14.m6.2.3.3.2"><ci id="S3.SS3.p1.14.m6.1.1.cmml" xref="S3.SS3.p1.14.m6.1.1">𝜃</ci><ci id="S3.SS3.p1.14.m6.2.2.cmml" xref="S3.SS3.p1.14.m6.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m6.2c">\mathcal{L}_{T}(\theta,\lambda)</annotation></semantics></math> defined as above has explicit dependency on the learning rates <math id="S3.SS3.p1.15.m7.1" class="ltx_Math" alttext="{\boldsymbol{\eta}}(\lambda)" display="inline"><semantics id="S3.SS3.p1.15.m7.1a"><mrow id="S3.SS3.p1.15.m7.1.2" xref="S3.SS3.p1.15.m7.1.2.cmml"><mi id="S3.SS3.p1.15.m7.1.2.2" xref="S3.SS3.p1.15.m7.1.2.2.cmml">𝜼</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.15.m7.1.2.1" xref="S3.SS3.p1.15.m7.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.15.m7.1.2.3.2" xref="S3.SS3.p1.15.m7.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.15.m7.1.2.3.2.1" xref="S3.SS3.p1.15.m7.1.2.cmml">(</mo><mi id="S3.SS3.p1.15.m7.1.1" xref="S3.SS3.p1.15.m7.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.15.m7.1.2.3.2.2" xref="S3.SS3.p1.15.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m7.1b"><apply id="S3.SS3.p1.15.m7.1.2.cmml" xref="S3.SS3.p1.15.m7.1.2"><times id="S3.SS3.p1.15.m7.1.2.1.cmml" xref="S3.SS3.p1.15.m7.1.2.1"></times><ci id="S3.SS3.p1.15.m7.1.2.2.cmml" xref="S3.SS3.p1.15.m7.1.2.2">𝜼</ci><ci id="S3.SS3.p1.15.m7.1.1.cmml" xref="S3.SS3.p1.15.m7.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m7.1c">{\boldsymbol{\eta}}(\lambda)</annotation></semantics></math>. Interestingly, the stationary point <math id="S3.SS3.p1.16.m8.1" class="ltx_Math" alttext="\theta^{*}(\lambda)" display="inline"><semantics id="S3.SS3.p1.16.m8.1a"><mrow id="S3.SS3.p1.16.m8.1.2" xref="S3.SS3.p1.16.m8.1.2.cmml"><msup id="S3.SS3.p1.16.m8.1.2.2" xref="S3.SS3.p1.16.m8.1.2.2.cmml"><mi id="S3.SS3.p1.16.m8.1.2.2.2" xref="S3.SS3.p1.16.m8.1.2.2.2.cmml">θ</mi><mo id="S3.SS3.p1.16.m8.1.2.2.3" xref="S3.SS3.p1.16.m8.1.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.16.m8.1.2.1" xref="S3.SS3.p1.16.m8.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.16.m8.1.2.3.2" xref="S3.SS3.p1.16.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.16.m8.1.2.3.2.1" xref="S3.SS3.p1.16.m8.1.2.cmml">(</mo><mi id="S3.SS3.p1.16.m8.1.1" xref="S3.SS3.p1.16.m8.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.16.m8.1.2.3.2.2" xref="S3.SS3.p1.16.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m8.1b"><apply id="S3.SS3.p1.16.m8.1.2.cmml" xref="S3.SS3.p1.16.m8.1.2"><times id="S3.SS3.p1.16.m8.1.2.1.cmml" xref="S3.SS3.p1.16.m8.1.2.1"></times><apply id="S3.SS3.p1.16.m8.1.2.2.cmml" xref="S3.SS3.p1.16.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m8.1.2.2.1.cmml" xref="S3.SS3.p1.16.m8.1.2.2">superscript</csymbol><ci id="S3.SS3.p1.16.m8.1.2.2.2.cmml" xref="S3.SS3.p1.16.m8.1.2.2.2">𝜃</ci><times id="S3.SS3.p1.16.m8.1.2.2.3.cmml" xref="S3.SS3.p1.16.m8.1.2.2.3"></times></apply><ci id="S3.SS3.p1.16.m8.1.1.cmml" xref="S3.SS3.p1.16.m8.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m8.1c">\theta^{*}(\lambda)</annotation></semantics></math> of <math id="S3.SS3.p1.17.m9.2" class="ltx_Math" alttext="\mathcal{L}_{T}(\theta,\lambda)" display="inline"><semantics id="S3.SS3.p1.17.m9.2a"><mrow id="S3.SS3.p1.17.m9.2.3" xref="S3.SS3.p1.17.m9.2.3.cmml"><msub id="S3.SS3.p1.17.m9.2.3.2" xref="S3.SS3.p1.17.m9.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.17.m9.2.3.2.2" xref="S3.SS3.p1.17.m9.2.3.2.2.cmml">ℒ</mi><mi id="S3.SS3.p1.17.m9.2.3.2.3" xref="S3.SS3.p1.17.m9.2.3.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.17.m9.2.3.1" xref="S3.SS3.p1.17.m9.2.3.1.cmml">​</mo><mrow id="S3.SS3.p1.17.m9.2.3.3.2" xref="S3.SS3.p1.17.m9.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.17.m9.2.3.3.2.1" xref="S3.SS3.p1.17.m9.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p1.17.m9.1.1" xref="S3.SS3.p1.17.m9.1.1.cmml">θ</mi><mo id="S3.SS3.p1.17.m9.2.3.3.2.2" xref="S3.SS3.p1.17.m9.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p1.17.m9.2.2" xref="S3.SS3.p1.17.m9.2.2.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.17.m9.2.3.3.2.3" xref="S3.SS3.p1.17.m9.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m9.2b"><apply id="S3.SS3.p1.17.m9.2.3.cmml" xref="S3.SS3.p1.17.m9.2.3"><times id="S3.SS3.p1.17.m9.2.3.1.cmml" xref="S3.SS3.p1.17.m9.2.3.1"></times><apply id="S3.SS3.p1.17.m9.2.3.2.cmml" xref="S3.SS3.p1.17.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m9.2.3.2.1.cmml" xref="S3.SS3.p1.17.m9.2.3.2">subscript</csymbol><ci id="S3.SS3.p1.17.m9.2.3.2.2.cmml" xref="S3.SS3.p1.17.m9.2.3.2.2">ℒ</ci><ci id="S3.SS3.p1.17.m9.2.3.2.3.cmml" xref="S3.SS3.p1.17.m9.2.3.2.3">𝑇</ci></apply><interval closure="open" id="S3.SS3.p1.17.m9.2.3.3.1.cmml" xref="S3.SS3.p1.17.m9.2.3.3.2"><ci id="S3.SS3.p1.17.m9.1.1.cmml" xref="S3.SS3.p1.17.m9.1.1">𝜃</ci><ci id="S3.SS3.p1.17.m9.2.2.cmml" xref="S3.SS3.p1.17.m9.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m9.2c">\mathcal{L}_{T}(\theta,\lambda)</annotation></semantics></math> coincides with <math id="S3.SS3.p1.18.m10.1" class="ltx_Math" alttext="\theta^{\prime}" display="inline"><semantics id="S3.SS3.p1.18.m10.1a"><msup id="S3.SS3.p1.18.m10.1.1" xref="S3.SS3.p1.18.m10.1.1.cmml"><mi id="S3.SS3.p1.18.m10.1.1.2" xref="S3.SS3.p1.18.m10.1.1.2.cmml">θ</mi><mo id="S3.SS3.p1.18.m10.1.1.3" xref="S3.SS3.p1.18.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m10.1b"><apply id="S3.SS3.p1.18.m10.1.1.cmml" xref="S3.SS3.p1.18.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.18.m10.1.1.1.cmml" xref="S3.SS3.p1.18.m10.1.1">superscript</csymbol><ci id="S3.SS3.p1.18.m10.1.1.2.cmml" xref="S3.SS3.p1.18.m10.1.1.2">𝜃</ci><ci id="S3.SS3.p1.18.m10.1.1.3.cmml" xref="S3.SS3.p1.18.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m10.1c">\theta^{\prime}</annotation></semantics></math>, that is, <math id="S3.SS3.p1.19.m11.1" class="ltx_Math" alttext="\theta^{*}(\lambda)=\theta^{\prime}" display="inline"><semantics id="S3.SS3.p1.19.m11.1a"><mrow id="S3.SS3.p1.19.m11.1.2" xref="S3.SS3.p1.19.m11.1.2.cmml"><mrow id="S3.SS3.p1.19.m11.1.2.2" xref="S3.SS3.p1.19.m11.1.2.2.cmml"><msup id="S3.SS3.p1.19.m11.1.2.2.2" xref="S3.SS3.p1.19.m11.1.2.2.2.cmml"><mi id="S3.SS3.p1.19.m11.1.2.2.2.2" xref="S3.SS3.p1.19.m11.1.2.2.2.2.cmml">θ</mi><mo id="S3.SS3.p1.19.m11.1.2.2.2.3" xref="S3.SS3.p1.19.m11.1.2.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p1.19.m11.1.2.2.1" xref="S3.SS3.p1.19.m11.1.2.2.1.cmml">​</mo><mrow id="S3.SS3.p1.19.m11.1.2.2.3.2" xref="S3.SS3.p1.19.m11.1.2.2.cmml"><mo stretchy="false" id="S3.SS3.p1.19.m11.1.2.2.3.2.1" xref="S3.SS3.p1.19.m11.1.2.2.cmml">(</mo><mi id="S3.SS3.p1.19.m11.1.1" xref="S3.SS3.p1.19.m11.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.19.m11.1.2.2.3.2.2" xref="S3.SS3.p1.19.m11.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.19.m11.1.2.1" xref="S3.SS3.p1.19.m11.1.2.1.cmml">=</mo><msup id="S3.SS3.p1.19.m11.1.2.3" xref="S3.SS3.p1.19.m11.1.2.3.cmml"><mi id="S3.SS3.p1.19.m11.1.2.3.2" xref="S3.SS3.p1.19.m11.1.2.3.2.cmml">θ</mi><mo id="S3.SS3.p1.19.m11.1.2.3.3" xref="S3.SS3.p1.19.m11.1.2.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m11.1b"><apply id="S3.SS3.p1.19.m11.1.2.cmml" xref="S3.SS3.p1.19.m11.1.2"><eq id="S3.SS3.p1.19.m11.1.2.1.cmml" xref="S3.SS3.p1.19.m11.1.2.1"></eq><apply id="S3.SS3.p1.19.m11.1.2.2.cmml" xref="S3.SS3.p1.19.m11.1.2.2"><times id="S3.SS3.p1.19.m11.1.2.2.1.cmml" xref="S3.SS3.p1.19.m11.1.2.2.1"></times><apply id="S3.SS3.p1.19.m11.1.2.2.2.cmml" xref="S3.SS3.p1.19.m11.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m11.1.2.2.2.1.cmml" xref="S3.SS3.p1.19.m11.1.2.2.2">superscript</csymbol><ci id="S3.SS3.p1.19.m11.1.2.2.2.2.cmml" xref="S3.SS3.p1.19.m11.1.2.2.2.2">𝜃</ci><times id="S3.SS3.p1.19.m11.1.2.2.2.3.cmml" xref="S3.SS3.p1.19.m11.1.2.2.2.3"></times></apply><ci id="S3.SS3.p1.19.m11.1.1.cmml" xref="S3.SS3.p1.19.m11.1.1">𝜆</ci></apply><apply id="S3.SS3.p1.19.m11.1.2.3.cmml" xref="S3.SS3.p1.19.m11.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m11.1.2.3.1.cmml" xref="S3.SS3.p1.19.m11.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.19.m11.1.2.3.2.cmml" xref="S3.SS3.p1.19.m11.1.2.3.2">𝜃</ci><ci id="S3.SS3.p1.19.m11.1.2.3.3.cmml" xref="S3.SS3.p1.19.m11.1.2.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m11.1c">\theta^{*}(\lambda)=\theta^{\prime}</annotation></semantics></math>, which allows for a single instance of inner-loop iterations as Line 9 in Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Finally, the validation loss is defined as:</p>
<table id="A6.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.10" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{V}(\theta,\lambda)\!=\!\mathbb{E}_{(x,y)\sim P_{V}}CE(f_{\theta,{\boldsymbol{\beta}}(\lambda)}(x),y)," display="inline"><semantics id="S3.Ex2.m1.10a"><mrow id="S3.Ex2.m1.10.10.1" xref="S3.Ex2.m1.10.10.1.1.cmml"><mrow id="S3.Ex2.m1.10.10.1.1" xref="S3.Ex2.m1.10.10.1.1.cmml"><mrow id="S3.Ex2.m1.10.10.1.1.3" xref="S3.Ex2.m1.10.10.1.1.3.cmml"><msub id="S3.Ex2.m1.10.10.1.1.3.2" xref="S3.Ex2.m1.10.10.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.10.10.1.1.3.2.2" xref="S3.Ex2.m1.10.10.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.Ex2.m1.10.10.1.1.3.2.3" xref="S3.Ex2.m1.10.10.1.1.3.2.3.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.10.10.1.1.3.1" xref="S3.Ex2.m1.10.10.1.1.3.1.cmml">​</mo><mrow id="S3.Ex2.m1.10.10.1.1.3.3.2" xref="S3.Ex2.m1.10.10.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.3.3.2.1" xref="S3.Ex2.m1.10.10.1.1.3.3.1.cmml">(</mo><mi id="S3.Ex2.m1.6.6" xref="S3.Ex2.m1.6.6.cmml">θ</mi><mo id="S3.Ex2.m1.10.10.1.1.3.3.2.2" xref="S3.Ex2.m1.10.10.1.1.3.3.1.cmml">,</mo><mi id="S3.Ex2.m1.7.7" xref="S3.Ex2.m1.7.7.cmml">λ</mi><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.3.3.2.3" xref="S3.Ex2.m1.10.10.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo lspace="0.108em" rspace="0.108em" id="S3.Ex2.m1.10.10.1.1.2" xref="S3.Ex2.m1.10.10.1.1.2.cmml">=</mo><mrow id="S3.Ex2.m1.10.10.1.1.1" xref="S3.Ex2.m1.10.10.1.1.1.cmml"><msub id="S3.Ex2.m1.10.10.1.1.1.3" xref="S3.Ex2.m1.10.10.1.1.1.3.cmml"><mi id="S3.Ex2.m1.10.10.1.1.1.3.2" xref="S3.Ex2.m1.10.10.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.Ex2.m1.2.2.2" xref="S3.Ex2.m1.2.2.2.cmml"><mrow id="S3.Ex2.m1.2.2.2.4.2" xref="S3.Ex2.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.2.2.2.4.2.1" xref="S3.Ex2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml">x</mi><mo id="S3.Ex2.m1.2.2.2.4.2.2" xref="S3.Ex2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.Ex2.m1.2.2.2.2" xref="S3.Ex2.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.Ex2.m1.2.2.2.4.2.3" xref="S3.Ex2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.Ex2.m1.2.2.2.3" xref="S3.Ex2.m1.2.2.2.3.cmml">∼</mo><msub id="S3.Ex2.m1.2.2.2.5" xref="S3.Ex2.m1.2.2.2.5.cmml"><mi id="S3.Ex2.m1.2.2.2.5.2" xref="S3.Ex2.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.Ex2.m1.2.2.2.5.3" xref="S3.Ex2.m1.2.2.2.5.3.cmml">V</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.10.10.1.1.1.2" xref="S3.Ex2.m1.10.10.1.1.1.2.cmml">​</mo><mi id="S3.Ex2.m1.10.10.1.1.1.4" xref="S3.Ex2.m1.10.10.1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.10.10.1.1.1.2a" xref="S3.Ex2.m1.10.10.1.1.1.2.cmml">​</mo><mi id="S3.Ex2.m1.10.10.1.1.1.5" xref="S3.Ex2.m1.10.10.1.1.1.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.10.10.1.1.1.2b" xref="S3.Ex2.m1.10.10.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.10.10.1.1.1.1.1" xref="S3.Ex2.m1.10.10.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.1.1.1.2" xref="S3.Ex2.m1.10.10.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex2.m1.10.10.1.1.1.1.1.1" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.10.10.1.1.1.1.1.1.2" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.2.cmml">f</mi><mrow id="S3.Ex2.m1.5.5.3.3" xref="S3.Ex2.m1.5.5.3.4.cmml"><mi id="S3.Ex2.m1.4.4.2.2" xref="S3.Ex2.m1.4.4.2.2.cmml">θ</mi><mo id="S3.Ex2.m1.5.5.3.3.2" xref="S3.Ex2.m1.5.5.3.4.cmml">,</mo><mrow id="S3.Ex2.m1.5.5.3.3.1" xref="S3.Ex2.m1.5.5.3.3.1.cmml"><mi id="S3.Ex2.m1.5.5.3.3.1.2" xref="S3.Ex2.m1.5.5.3.3.1.2.cmml">𝜷</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.5.5.3.3.1.1" xref="S3.Ex2.m1.5.5.3.3.1.1.cmml">​</mo><mrow id="S3.Ex2.m1.5.5.3.3.1.3.2" xref="S3.Ex2.m1.5.5.3.3.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.5.5.3.3.1.3.2.1" xref="S3.Ex2.m1.5.5.3.3.1.cmml">(</mo><mi id="S3.Ex2.m1.3.3.1.1" xref="S3.Ex2.m1.3.3.1.1.cmml">λ</mi><mo stretchy="false" id="S3.Ex2.m1.5.5.3.3.1.3.2.2" xref="S3.Ex2.m1.5.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.10.10.1.1.1.1.1.1.1" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m1.10.10.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.1.1.1.1.3.2.1" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex2.m1.8.8" xref="S3.Ex2.m1.8.8.cmml">x</mi><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.1.1.1.1.3.2.2" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.10.10.1.1.1.1.1.3" xref="S3.Ex2.m1.10.10.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2.m1.9.9" xref="S3.Ex2.m1.9.9.cmml">y</mi><mo stretchy="false" id="S3.Ex2.m1.10.10.1.1.1.1.1.4" xref="S3.Ex2.m1.10.10.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex2.m1.10.10.1.2" xref="S3.Ex2.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.10b"><apply id="S3.Ex2.m1.10.10.1.1.cmml" xref="S3.Ex2.m1.10.10.1"><eq id="S3.Ex2.m1.10.10.1.1.2.cmml" xref="S3.Ex2.m1.10.10.1.1.2"></eq><apply id="S3.Ex2.m1.10.10.1.1.3.cmml" xref="S3.Ex2.m1.10.10.1.1.3"><times id="S3.Ex2.m1.10.10.1.1.3.1.cmml" xref="S3.Ex2.m1.10.10.1.1.3.1"></times><apply id="S3.Ex2.m1.10.10.1.1.3.2.cmml" xref="S3.Ex2.m1.10.10.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.10.10.1.1.3.2.1.cmml" xref="S3.Ex2.m1.10.10.1.1.3.2">subscript</csymbol><ci id="S3.Ex2.m1.10.10.1.1.3.2.2.cmml" xref="S3.Ex2.m1.10.10.1.1.3.2.2">ℒ</ci><ci id="S3.Ex2.m1.10.10.1.1.3.2.3.cmml" xref="S3.Ex2.m1.10.10.1.1.3.2.3">𝑉</ci></apply><interval closure="open" id="S3.Ex2.m1.10.10.1.1.3.3.1.cmml" xref="S3.Ex2.m1.10.10.1.1.3.3.2"><ci id="S3.Ex2.m1.6.6.cmml" xref="S3.Ex2.m1.6.6">𝜃</ci><ci id="S3.Ex2.m1.7.7.cmml" xref="S3.Ex2.m1.7.7">𝜆</ci></interval></apply><apply id="S3.Ex2.m1.10.10.1.1.1.cmml" xref="S3.Ex2.m1.10.10.1.1.1"><times id="S3.Ex2.m1.10.10.1.1.1.2.cmml" xref="S3.Ex2.m1.10.10.1.1.1.2"></times><apply id="S3.Ex2.m1.10.10.1.1.1.3.cmml" xref="S3.Ex2.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.10.10.1.1.1.3.1.cmml" xref="S3.Ex2.m1.10.10.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.10.10.1.1.1.3.2.cmml" xref="S3.Ex2.m1.10.10.1.1.1.3.2">𝔼</ci><apply id="S3.Ex2.m1.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2"><csymbol cd="latexml" id="S3.Ex2.m1.2.2.2.3.cmml" xref="S3.Ex2.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.Ex2.m1.2.2.2.4.1.cmml" xref="S3.Ex2.m1.2.2.2.4.2"><ci id="S3.Ex2.m1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1">𝑥</ci><ci id="S3.Ex2.m1.2.2.2.2.cmml" xref="S3.Ex2.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.Ex2.m1.2.2.2.5.cmml" xref="S3.Ex2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.2.5.1.cmml" xref="S3.Ex2.m1.2.2.2.5">subscript</csymbol><ci id="S3.Ex2.m1.2.2.2.5.2.cmml" xref="S3.Ex2.m1.2.2.2.5.2">𝑃</ci><ci id="S3.Ex2.m1.2.2.2.5.3.cmml" xref="S3.Ex2.m1.2.2.2.5.3">𝑉</ci></apply></apply></apply><ci id="S3.Ex2.m1.10.10.1.1.1.4.cmml" xref="S3.Ex2.m1.10.10.1.1.1.4">𝐶</ci><ci id="S3.Ex2.m1.10.10.1.1.1.5.cmml" xref="S3.Ex2.m1.10.10.1.1.1.5">𝐸</ci><interval closure="open" id="S3.Ex2.m1.10.10.1.1.1.1.2.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1"><apply id="S3.Ex2.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1"><times id="S3.Ex2.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.1"></times><apply id="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.10.10.1.1.1.1.1.1.2.2">𝑓</ci><list id="S3.Ex2.m1.5.5.3.4.cmml" xref="S3.Ex2.m1.5.5.3.3"><ci id="S3.Ex2.m1.4.4.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2">𝜃</ci><apply id="S3.Ex2.m1.5.5.3.3.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1"><times id="S3.Ex2.m1.5.5.3.3.1.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1"></times><ci id="S3.Ex2.m1.5.5.3.3.1.2.cmml" xref="S3.Ex2.m1.5.5.3.3.1.2">𝜷</ci><ci id="S3.Ex2.m1.3.3.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1">𝜆</ci></apply></list></apply><ci id="S3.Ex2.m1.8.8.cmml" xref="S3.Ex2.m1.8.8">𝑥</ci></apply><ci id="S3.Ex2.m1.9.9.cmml" xref="S3.Ex2.m1.9.9">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.10c">\displaystyle\mathcal{L}_{V}(\theta,\lambda)\!=\!\mathbb{E}_{(x,y)\sim P_{V}}CE(f_{\theta,{\boldsymbol{\beta}}(\lambda)}(x),y),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.20" class="ltx_p">showing clear dependency on BNNet parameters through <math id="S3.SS3.p1.20.m1.1" class="ltx_Math" alttext="{\boldsymbol{\beta}}(\lambda)" display="inline"><semantics id="S3.SS3.p1.20.m1.1a"><mrow id="S3.SS3.p1.20.m1.1.2" xref="S3.SS3.p1.20.m1.1.2.cmml"><mi id="S3.SS3.p1.20.m1.1.2.2" xref="S3.SS3.p1.20.m1.1.2.2.cmml">𝜷</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.20.m1.1.2.1" xref="S3.SS3.p1.20.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.20.m1.1.2.3.2" xref="S3.SS3.p1.20.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.20.m1.1.2.3.2.1" xref="S3.SS3.p1.20.m1.1.2.cmml">(</mo><mi id="S3.SS3.p1.20.m1.1.1" xref="S3.SS3.p1.20.m1.1.1.cmml">λ</mi><mo stretchy="false" id="S3.SS3.p1.20.m1.1.2.3.2.2" xref="S3.SS3.p1.20.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m1.1b"><apply id="S3.SS3.p1.20.m1.1.2.cmml" xref="S3.SS3.p1.20.m1.1.2"><times id="S3.SS3.p1.20.m1.1.2.1.cmml" xref="S3.SS3.p1.20.m1.1.2.1"></times><ci id="S3.SS3.p1.20.m1.1.2.2.cmml" xref="S3.SS3.p1.20.m1.1.2.2">𝜷</ci><ci id="S3.SS3.p1.20.m1.1.1.cmml" xref="S3.SS3.p1.20.m1.1.1">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m1.1c">{\boldsymbol{\beta}}(\lambda)</annotation></semantics></math> as discussed in the previous section.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>

<figure id="S4.T1" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.7.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.2.1" class="ltx_text" style="font-size:90%;">FedL2P complements existing FL methods by improving on the finetuning process. Experiments on CIFAR10 (<math id="S4.T1.2.1.m1.1" class="ltx_Math" alttext="e=15" display="inline"><semantics id="S4.T1.2.1.m1.1b"><mrow id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml"><mi id="S4.T1.2.1.m1.1.1.2" xref="S4.T1.2.1.m1.1.1.2.cmml">e</mi><mo id="S4.T1.2.1.m1.1.1.1" xref="S4.T1.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.1.m1.1.1.3" xref="S4.T1.2.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><apply id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1"><eq id="S4.T1.2.1.m1.1.1.1.cmml" xref="S4.T1.2.1.m1.1.1.1"></eq><ci id="S4.T1.2.1.m1.1.1.2.cmml" xref="S4.T1.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.T1.2.1.m1.1.1.3.cmml" xref="S4.T1.2.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">e=15</annotation></semantics></math>).</span></figcaption>
<div id="S4.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:372.9pt;height:202.1pt;vertical-align:-99.4pt;"><span class="ltx_transformed_inner" style="transform:translate(-30.4pt,8.4pt) scale(0.860000591180432,0.860000591180432) ;">
<table id="S4.T1.5.3.3" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T1.3.1.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="S4.T1.3.1.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T1.3.1.1.1.1.m1.1.1" xref="S4.T1.3.1.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.1.1.1.1.m1.1b"><ci id="S4.T1.3.1.1.1.1.m1.1.1.cmml" xref="S4.T1.3.1.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.1.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></th>
<th id="S4.T1.3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.3.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Approach</span></th>
<th id="S4.T1.3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T1.3.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></th>
<th id="S4.T1.3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T1.3.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.5.3.3.4.1" class="ltx_tr">
<td id="S4.T1.5.3.3.4.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1000</span></td>
<td id="S4.T1.5.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.4.1.2.1" class="ltx_text" style="font-size:70%;">FedAvg</span></td>
<td id="S4.T1.5.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.4.1.3.1" class="ltx_text" style="font-size:70%;">63.04±0.02</span></td>
<td id="S4.T1.5.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.4.1.4.1" class="ltx_text" style="font-size:70%;">65.13±0.02</span></td>
</tr>
<tr id="S4.T1.4.2.2.2" class="ltx_tr">
<td id="S4.T1.4.2.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.4.2.2.2.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T1.4.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T1.4.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S4.T1.4.2.2.2.1.1.m1.1.1" xref="S4.T1.4.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.2.2.2.1.1.m1.1b"><ci id="S4.T1.4.2.2.2.1.1.m1.1.1.cmml" xref="S4.T1.4.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.2.2.2.1.1.m1.1c">\downarrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T1.4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.4.2.2.2.2.1" class="ltx_text" style="font-size:70%;">PerFedAvg(HF)</span></td>
<td id="S4.T1.4.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.4.2.2.2.3.1" class="ltx_text" style="font-size:70%;">34.58±0.13</span></td>
<td id="S4.T1.4.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.4.2.2.2.4.1" class="ltx_text" style="font-size:70%;">47.58±0.01</span></td>
</tr>
<tr id="S4.T1.5.3.3.5.2" class="ltx_tr">
<td id="S4.T1.5.3.3.5.2.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.5.2.2.1" class="ltx_text" style="font-size:70%;">FedBABU</span></td>
<td id="S4.T1.5.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.5.2.3.1" class="ltx_text" style="font-size:70%;">65.00±0.07</span></td>
<td id="S4.T1.5.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.5.2.4.1" class="ltx_text" style="font-size:70%;">66.49±0.03</span></td>
</tr>
<tr id="S4.T1.5.3.3.6.3" class="ltx_tr">
<td id="S4.T1.5.3.3.6.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.6.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1.0</span></td>
<td id="S4.T1.5.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.6.3.2.1" class="ltx_text" style="font-size:70%;">FedAvg</span></td>
<td id="S4.T1.5.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.6.3.3.1" class="ltx_text" style="font-size:70%;">61.42±0.13</span></td>
<td id="S4.T1.5.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.6.3.4.1" class="ltx_text" style="font-size:70%;">65.76±0.31</span></td>
</tr>
<tr id="S4.T1.5.3.3.7.4" class="ltx_tr">
<td id="S4.T1.5.3.3.7.4.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.7.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.7.4.2.1" class="ltx_text" style="font-size:70%;">PerFedAvg(HF)</span></td>
<td id="S4.T1.5.3.3.7.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.7.4.3.1" class="ltx_text" style="font-size:70%;">44.85±0.28</span></td>
<td id="S4.T1.5.3.3.7.4.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.7.4.4.1" class="ltx_text" style="font-size:70%;">50.2±1.26</span></td>
</tr>
<tr id="S4.T1.5.3.3.8.5" class="ltx_tr">
<td id="S4.T1.5.3.3.8.5.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.8.5.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.8.5.2.1" class="ltx_text" style="font-size:70%;">FedBABU</span></td>
<td id="S4.T1.5.3.3.8.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.8.5.3.1" class="ltx_text" style="font-size:70%;">68.92±0.11</span></td>
<td id="S4.T1.5.3.3.8.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.8.5.4.1" class="ltx_text" style="font-size:70%;">70.71±0.28</span></td>
</tr>
<tr id="S4.T1.5.3.3.9.6" class="ltx_tr">
<td id="S4.T1.5.3.3.9.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.9.6.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.5</span></td>
<td id="S4.T1.5.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.9.6.2.1" class="ltx_text" style="font-size:70%;">FedAvg</span></td>
<td id="S4.T1.5.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.9.6.3.1" class="ltx_text" style="font-size:70%;">62.34±0.14</span></td>
<td id="S4.T1.5.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.9.6.4.1" class="ltx_text" style="font-size:70%;">68.45±0.5</span></td>
</tr>
<tr id="S4.T1.5.3.3.10.7" class="ltx_tr">
<td id="S4.T1.5.3.3.10.7.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.10.7.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.10.7.2.1" class="ltx_text" style="font-size:70%;">PerFedAvg(HF)</span></td>
<td id="S4.T1.5.3.3.10.7.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.10.7.3.1" class="ltx_text" style="font-size:70%;">52.43±0.16</span></td>
<td id="S4.T1.5.3.3.10.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.10.7.4.1" class="ltx_text" style="font-size:70%;">55.05±0.53</span></td>
</tr>
<tr id="S4.T1.5.3.3.11.8" class="ltx_tr">
<td id="S4.T1.5.3.3.11.8.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.11.8.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.11.8.2.1" class="ltx_text" style="font-size:70%;">FedBABU</span></td>
<td id="S4.T1.5.3.3.11.8.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.11.8.3.1" class="ltx_text" style="font-size:70%;">72.26±0.1</span></td>
<td id="S4.T1.5.3.3.11.8.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.11.8.4.1" class="ltx_text" style="font-size:70%;">72.87±0.42</span></td>
</tr>
<tr id="S4.T1.5.3.3.12.9" class="ltx_tr">
<td id="S4.T1.5.3.3.12.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.12.9.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.1</span></td>
<td id="S4.T1.5.3.3.12.9.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.12.9.2.1" class="ltx_text" style="font-size:70%;">FedAvg</span></td>
<td id="S4.T1.5.3.3.12.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.12.9.3.1" class="ltx_text" style="font-size:70%;">79.15±0.07</span></td>
<td id="S4.T1.5.3.3.12.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.5.3.3.12.9.4.1" class="ltx_text" style="font-size:70%;">80.28±0.07</span></td>
</tr>
<tr id="S4.T1.5.3.3.3" class="ltx_tr">
<td id="S4.T1.5.3.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.3.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T1.5.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T1.5.3.3.3.1.1.m1.1a"><mo stretchy="false" id="S4.T1.5.3.3.3.1.1.m1.1.1" xref="S4.T1.5.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.3.3.3.1.1.m1.1b"><ci id="S4.T1.5.3.3.3.1.1.m1.1.1.cmml" xref="S4.T1.5.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.3.3.3.1.1.m1.1c">\uparrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T1.5.3.3.3.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.3.2.1" class="ltx_text" style="font-size:70%;">PerFedAvg(HF)</span></td>
<td id="S4.T1.5.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.3.3.1" class="ltx_text" style="font-size:70%;">77.31±0.05</span></td>
<td id="S4.T1.5.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.5.3.3.3.4.1" class="ltx_text" style="font-size:70%;">77.68±0.13</span></td>
</tr>
<tr id="S4.T1.5.3.3.13.10" class="ltx_tr">
<td id="S4.T1.5.3.3.13.10.1" class="ltx_td ltx_border_b ltx_border_l ltx_border_r"></td>
<td id="S4.T1.5.3.3.13.10.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="S4.T1.5.3.3.13.10.2.1" class="ltx_text" style="font-size:70%;">FedBABU</span></td>
<td id="S4.T1.5.3.3.13.10.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.5.3.3.13.10.3.1" class="ltx_text" style="font-size:70%;">79.50±0.08</span></td>
<td id="S4.T1.5.3.3.13.10.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.5.3.3.13.10.4.1" class="ltx_text" style="font-size:70%;">79.58±0.04</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.19" class="ltx_p">Experiments are conducted on image classification tasks of different complexity.
We use ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a href="#bib.bib20" title="" class="ltx_ref">2016</a>)</cite> for all experiments and SGD for all optimizers. All details of the pretrained models can be found in Appendix. <a href="#A4" title="Appendix D Pretrained Model and Setup Details ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.
Additionally, the batch size is set to <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">32</annotation></semantics></math> and the number of local epochs, <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">e</annotation></semantics></math>, is set to <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">15</annotation></semantics></math> unless stated otherwise.
The learning rate (<math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\zeta" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\zeta</annotation></semantics></math>) for <math id="S4.SS1.p1.5.m5.3" class="ltx_Math" alttext="\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}" display="inline"><semantics id="S4.SS1.p1.5.m5.3a"><mrow id="S4.SS1.p1.5.m5.3.3" xref="S4.SS1.p1.5.m5.3.3.cmml"><mi id="S4.SS1.p1.5.m5.3.3.4" xref="S4.SS1.p1.5.m5.3.3.4.cmml">λ</mi><mo id="S4.SS1.p1.5.m5.3.3.3" xref="S4.SS1.p1.5.m5.3.3.3.cmml">=</mo><mrow id="S4.SS1.p1.5.m5.3.3.2.2" xref="S4.SS1.p1.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m5.3.3.2.2.3" xref="S4.SS1.p1.5.m5.3.3.2.3.cmml">{</mo><msub id="S4.SS1.p1.5.m5.2.2.1.1.1" xref="S4.SS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.5.m5.2.2.1.1.1.2" xref="S4.SS1.p1.5.m5.2.2.1.1.1.2.cmml">𝒘</mi><mrow id="S4.SS1.p1.5.m5.2.2.1.1.1.3" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.cmml"><mi id="S4.SS1.p1.5.m5.2.2.1.1.1.3.2" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.2.2.1.1.1.3.1" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.2.2.1.1.1.3.3" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S4.SS1.p1.5.m5.3.3.2.2.4" xref="S4.SS1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p1.5.m5.3.3.2.2.2" xref="S4.SS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.5.m5.3.3.2.2.2.2" xref="S4.SS1.p1.5.m5.3.3.2.2.2.2.cmml">𝒘</mi><mrow id="S4.SS1.p1.5.m5.3.3.2.2.2.3" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.cmml"><mi id="S4.SS1.p1.5.m5.3.3.2.2.2.3.2" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.3.3.2.2.2.3.1" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.3.3.2.2.2.3.3" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.3.cmml">r</mi></mrow></msub><mo id="S4.SS1.p1.5.m5.3.3.2.2.5" xref="S4.SS1.p1.5.m5.3.3.2.3.cmml">,</mo><mover accent="true" id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">𝜼</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S4.SS1.p1.5.m5.3.3.2.2.6" xref="S4.SS1.p1.5.m5.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.3b"><apply id="S4.SS1.p1.5.m5.3.3.cmml" xref="S4.SS1.p1.5.m5.3.3"><eq id="S4.SS1.p1.5.m5.3.3.3.cmml" xref="S4.SS1.p1.5.m5.3.3.3"></eq><ci id="S4.SS1.p1.5.m5.3.3.4.cmml" xref="S4.SS1.p1.5.m5.3.3.4">𝜆</ci><set id="S4.SS1.p1.5.m5.3.3.2.3.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2"><apply id="S4.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1.2">𝒘</ci><apply id="S4.SS1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3"><times id="S4.SS1.p1.5.m5.2.2.1.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.1"></times><ci id="S4.SS1.p1.5.m5.2.2.1.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.2">𝑏</ci><ci id="S4.SS1.p1.5.m5.2.2.1.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S4.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2.2">𝒘</ci><apply id="S4.SS1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3"><times id="S4.SS1.p1.5.m5.3.3.2.2.2.3.1.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.1"></times><ci id="S4.SS1.p1.5.m5.3.3.2.2.2.3.2.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.2">𝑙</ci><ci id="S4.SS1.p1.5.m5.3.3.2.2.2.3.3.cmml" xref="S4.SS1.p1.5.m5.3.3.2.2.2.3.3">𝑟</ci></apply></apply><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><ci id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1">~</ci><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝜼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.3c">\lambda=\{\boldsymbol{w}_{bn},\boldsymbol{w}_{lr},\tilde{\boldsymbol{\eta}}\}</annotation></semantics></math> is set to {<math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msup id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mn id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">10</mn><mrow id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml"><mo id="S4.SS1.p1.6.m6.1.1.3a" xref="S4.SS1.p1.6.m6.1.1.3.cmml">−</mo><mn id="S4.SS1.p1.6.m6.1.1.3.2" xref="S4.SS1.p1.6.m6.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">10</cn><apply id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3"><minus id="S4.SS1.p1.6.m6.1.1.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3"></minus><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">10^{-3}</annotation></semantics></math>,<math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msup id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mn id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">10</mn><mrow id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml"><mo id="S4.SS1.p1.7.m7.1.1.3a" xref="S4.SS1.p1.7.m7.1.1.3.cmml">−</mo><mn id="S4.SS1.p1.7.m7.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">10</cn><apply id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><minus id="S4.SS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3"></minus><cn type="integer" id="S4.SS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">10^{-3}</annotation></semantics></math>,<math id="S4.SS1.p1.8.m8.1" class="ltx_math_unparsed" alttext="10^{-4}\}" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mrow id="S4.SS1.p1.8.m8.1b"><msup id="S4.SS1.p1.8.m8.1.1"><mn id="S4.SS1.p1.8.m8.1.1.2">10</mn><mrow id="S4.SS1.p1.8.m8.1.1.3"><mo id="S4.SS1.p1.8.m8.1.1.3a">−</mo><mn id="S4.SS1.p1.8.m8.1.1.3.2">4</mn></mrow></msup><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2">}</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">10^{-4}\}</annotation></semantics></math>, respectively.
The hypergradient is clipped by value <math id="S4.SS1.p1.9.m9.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S4.SS1.p1.9.m9.2a"><mrow id="S4.SS1.p1.9.m9.2.2.1" xref="S4.SS1.p1.9.m9.2.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.9.m9.2.2.1.2" xref="S4.SS1.p1.9.m9.2.2.2.cmml">[</mo><mrow id="S4.SS1.p1.9.m9.2.2.1.1" xref="S4.SS1.p1.9.m9.2.2.1.1.cmml"><mo id="S4.SS1.p1.9.m9.2.2.1.1a" xref="S4.SS1.p1.9.m9.2.2.1.1.cmml">−</mo><mn id="S4.SS1.p1.9.m9.2.2.1.1.2" xref="S4.SS1.p1.9.m9.2.2.1.1.2.cmml">1</mn></mrow><mo id="S4.SS1.p1.9.m9.2.2.1.3" xref="S4.SS1.p1.9.m9.2.2.2.cmml">,</mo><mn id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.9.m9.2.2.1.4" xref="S4.SS1.p1.9.m9.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.2b"><interval closure="closed" id="S4.SS1.p1.9.m9.2.2.2.cmml" xref="S4.SS1.p1.9.m9.2.2.1"><apply id="S4.SS1.p1.9.m9.2.2.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1"><minus id="S4.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1"></minus><cn type="integer" id="S4.SS1.p1.9.m9.2.2.1.1.2.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1.2">1</cn></apply><cn type="integer" id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.2c">[-1,1]</annotation></semantics></math>, <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="Q=3" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mrow id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml">Q</mi><mo id="S4.SS1.p1.10.m10.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><eq id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1"></eq><ci id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2">𝑄</ci><cn type="integer" id="S4.SS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">Q=3</annotation></semantics></math>, and <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="\psi=0.1" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mrow id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">ψ</mi><mo id="S4.SS1.p1.11.m11.1.1.1" xref="S4.SS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><eq id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1.1"></eq><ci id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">𝜓</ci><cn type="float" id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\psi=0.1</annotation></semantics></math> in Alg. <a href="#alg2" title="Algorithm 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
The maximum number of communication rounds is set to <math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><mn id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><cn type="integer" id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">500</annotation></semantics></math>, and over the rounds we save the <math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><mi id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><ci id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">\lambda</annotation></semantics></math> value that leads to the lowest validation loss, averaged over the participating clients, as the final learned <math id="S4.SS1.p1.14.m14.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.p1.14.m14.1a"><mi id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><ci id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">\lambda</annotation></semantics></math>. The fraction ratio <math id="S4.SS1.p1.15.m15.1" class="ltx_Math" alttext="r\!=\!0.1" display="inline"><semantics id="S4.SS1.p1.15.m15.1a"><mrow id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml"><mi id="S4.SS1.p1.15.m15.1.1.2" xref="S4.SS1.p1.15.m15.1.1.2.cmml">r</mi><mo lspace="0.108em" rspace="0.108em" id="S4.SS1.p1.15.m15.1.1.1" xref="S4.SS1.p1.15.m15.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.15.m15.1.1.3" xref="S4.SS1.p1.15.m15.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b"><apply id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1"><eq id="S4.SS1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1"></eq><ci id="S4.SS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.2">𝑟</ci><cn type="float" id="S4.SS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">r\!=\!0.1</annotation></semantics></math> unless stated otherwise, sampling <math id="S4.SS1.p1.16.m16.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.SS1.p1.16.m16.1a"><mrow id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml"><mn id="S4.SS1.p1.16.m16.1.1.2" xref="S4.SS1.p1.16.m16.1.1.2.cmml">10</mn><mo id="S4.SS1.p1.16.m16.1.1.1" xref="S4.SS1.p1.16.m16.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><apply id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1"><csymbol cd="latexml" id="S4.SS1.p1.16.m16.1.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.16.m16.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">10\%</annotation></semantics></math> of the total number of clients per FL round.
We focus on non-IID labels and feature shifts while assuming that each client has an equal number of samples.
Finally, to generate heterogeneity in label distributions, we follow the latent Dirichlet allocation (LDA) partition method <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib24" title="" class="ltx_ref">2019</a>; Yurochkin et al., <a href="#bib.bib61" title="" class="ltx_ref">2019</a>; Qiu et al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite>: <math id="S4.SS1.p1.17.m17.1" class="ltx_Math" alttext="y\sim Dir(\alpha)" display="inline"><semantics id="S4.SS1.p1.17.m17.1a"><mrow id="S4.SS1.p1.17.m17.1.2" xref="S4.SS1.p1.17.m17.1.2.cmml"><mi id="S4.SS1.p1.17.m17.1.2.2" xref="S4.SS1.p1.17.m17.1.2.2.cmml">y</mi><mo id="S4.SS1.p1.17.m17.1.2.1" xref="S4.SS1.p1.17.m17.1.2.1.cmml">∼</mo><mrow id="S4.SS1.p1.17.m17.1.2.3" xref="S4.SS1.p1.17.m17.1.2.3.cmml"><mi id="S4.SS1.p1.17.m17.1.2.3.2" xref="S4.SS1.p1.17.m17.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.17.m17.1.2.3.1" xref="S4.SS1.p1.17.m17.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.17.m17.1.2.3.3" xref="S4.SS1.p1.17.m17.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.17.m17.1.2.3.1a" xref="S4.SS1.p1.17.m17.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.17.m17.1.2.3.4" xref="S4.SS1.p1.17.m17.1.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.17.m17.1.2.3.1b" xref="S4.SS1.p1.17.m17.1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.17.m17.1.2.3.5.2" xref="S4.SS1.p1.17.m17.1.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.17.m17.1.2.3.5.2.1" xref="S4.SS1.p1.17.m17.1.2.3.cmml">(</mo><mi id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS1.p1.17.m17.1.2.3.5.2.2" xref="S4.SS1.p1.17.m17.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.1b"><apply id="S4.SS1.p1.17.m17.1.2.cmml" xref="S4.SS1.p1.17.m17.1.2"><csymbol cd="latexml" id="S4.SS1.p1.17.m17.1.2.1.cmml" xref="S4.SS1.p1.17.m17.1.2.1">similar-to</csymbol><ci id="S4.SS1.p1.17.m17.1.2.2.cmml" xref="S4.SS1.p1.17.m17.1.2.2">𝑦</ci><apply id="S4.SS1.p1.17.m17.1.2.3.cmml" xref="S4.SS1.p1.17.m17.1.2.3"><times id="S4.SS1.p1.17.m17.1.2.3.1.cmml" xref="S4.SS1.p1.17.m17.1.2.3.1"></times><ci id="S4.SS1.p1.17.m17.1.2.3.2.cmml" xref="S4.SS1.p1.17.m17.1.2.3.2">𝐷</ci><ci id="S4.SS1.p1.17.m17.1.2.3.3.cmml" xref="S4.SS1.p1.17.m17.1.2.3.3">𝑖</ci><ci id="S4.SS1.p1.17.m17.1.2.3.4.cmml" xref="S4.SS1.p1.17.m17.1.2.3.4">𝑟</ci><ci id="S4.SS1.p1.17.m17.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.1c">y\sim Dir(\alpha)</annotation></semantics></math> for each client. Hence, the degree of heterogeneity in label distributions is controlled by <math id="S4.SS1.p1.18.m18.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.18.m18.1a"><mi id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m18.1b"><ci id="S4.SS1.p1.18.m18.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.18.m18.1c">\alpha</annotation></semantics></math>; as <math id="S4.SS1.p1.19.m19.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.19.m19.1a"><mi id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m19.1b"><ci id="S4.SS1.p1.19.m19.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.19.m19.1c">\alpha</annotation></semantics></math> decreases, the label non-IIDness increases, and vice versa.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.3" class="ltx_p"><span id="S4.SS1.SSS1.p1.3.1" class="ltx_text ltx_font_bold">CIFAR10 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky et al. (<a href="#bib.bib31" title="" class="ltx_ref">2009</a>)</cite>.</span> A widely-used image classification dataset, also popular as an FL benchmark. The number of clients <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mi id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><ci id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">C</annotation></semantics></math> is set to <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mn id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">1000</annotation></semantics></math> and <math id="S4.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><mrow id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.SSS1.p1.3.m3.1.1.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml">20</mn><mo id="S4.SS1.SSS1.p1.3.m3.1.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><apply id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">20\%</annotation></semantics></math> of the training data is used for validation.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.7" class="ltx_p"><span id="S4.SS1.SSS1.p2.7.1" class="ltx_text ltx_font_bold">CIFAR-10-C <cite class="ltx_cite ltx_citemacro_cite">Hendrycks and Dietterich (<a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>.</span> The test split of the CIFAR10 dataset is corrupted with common corruptions. We used <math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><mn id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><cn type="integer" id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">10</annotation></semantics></math> corruption types<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span id="footnote4.1" class="ltx_text ltx_font_italic">brightness</span>, <span id="footnote4.2" class="ltx_text ltx_font_italic">frost</span>, <span id="footnote4.3" class="ltx_text ltx_font_italic">jpeg_compression</span>, <span id="footnote4.4" class="ltx_text ltx_font_italic">contrast</span>, <span id="footnote4.5" class="ltx_text ltx_font_italic">snow</span>, <span id="footnote4.6" class="ltx_text ltx_font_italic">motion_blur</span>, <span id="footnote4.7" class="ltx_text ltx_font_italic">pixelate</span>, <span id="footnote4.8" class="ltx_text ltx_font_italic">speckle_noise</span>, <span id="footnote4.9" class="ltx_text ltx_font_italic">fog</span>, <span id="footnote4.10" class="ltx_text ltx_font_italic">saturate</span></span></span></span> with severity level <math id="S4.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.SS1.SSS1.p2.2.m2.1a"><mn id="S4.SS1.SSS1.p2.2.m2.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.1b"><cn type="integer" id="S4.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.1c">3</annotation></semantics></math> and split each corruption dataset into <math id="S4.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="80\%/20\%" display="inline"><semantics id="S4.SS1.SSS1.p2.3.m3.1a"><mrow id="S4.SS1.SSS1.p2.3.m3.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.cmml"><mrow id="S4.SS1.SSS1.p2.3.m3.1.1.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml"><mn id="S4.SS1.SSS1.p2.3.m3.1.1.2.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.2.cmml">80</mn><mo id="S4.SS1.SSS1.p2.3.m3.1.1.2.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.1.cmml">%</mo></mrow><mo id="S4.SS1.SSS1.p2.3.m3.1.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml">/</mo><mrow id="S4.SS1.SSS1.p2.3.m3.1.1.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml"><mn id="S4.SS1.SSS1.p2.3.m3.1.1.3.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml">20</mn><mo id="S4.SS1.SSS1.p2.3.m3.1.1.3.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m3.1b"><apply id="S4.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1"><divide id="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.1"></divide><apply id="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.2">80</cn></apply><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m3.1c">80\%/20\%</annotation></semantics></math> training/test sets. A subset (<math id="S4.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS1.SSS1.p2.4.m4.1a"><mrow id="S4.SS1.SSS1.p2.4.m4.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.cmml"><mn id="S4.SS1.SSS1.p2.4.m4.1.1.2" xref="S4.SS1.SSS1.p2.4.m4.1.1.2.cmml">20</mn><mo id="S4.SS1.SSS1.p2.4.m4.1.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.4.m4.1b"><apply id="S4.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.4.m4.1c">20\%</annotation></semantics></math>) of the train set is further held out to form a validation set. Each corruption type is partitioned by <math id="S4.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="Dir(\alpha)" display="inline"><semantics id="S4.SS1.SSS1.p2.5.m5.1a"><mrow id="S4.SS1.SSS1.p2.5.m5.1.2" xref="S4.SS1.SSS1.p2.5.m5.1.2.cmml"><mi id="S4.SS1.SSS1.p2.5.m5.1.2.2" xref="S4.SS1.SSS1.p2.5.m5.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.5.m5.1.2.1" xref="S4.SS1.SSS1.p2.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.5.m5.1.2.3" xref="S4.SS1.SSS1.p2.5.m5.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.5.m5.1.2.1a" xref="S4.SS1.SSS1.p2.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.5.m5.1.2.4" xref="S4.SS1.SSS1.p2.5.m5.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.5.m5.1.2.1b" xref="S4.SS1.SSS1.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p2.5.m5.1.2.5.2" xref="S4.SS1.SSS1.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p2.5.m5.1.2.5.2.1" xref="S4.SS1.SSS1.p2.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p2.5.m5.1.1" xref="S4.SS1.SSS1.p2.5.m5.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS1.SSS1.p2.5.m5.1.2.5.2.2" xref="S4.SS1.SSS1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.5.m5.1b"><apply id="S4.SS1.SSS1.p2.5.m5.1.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.2"><times id="S4.SS1.SSS1.p2.5.m5.1.2.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.2.1"></times><ci id="S4.SS1.SSS1.p2.5.m5.1.2.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.2.2">𝐷</ci><ci id="S4.SS1.SSS1.p2.5.m5.1.2.3.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.2.3">𝑖</ci><ci id="S4.SS1.SSS1.p2.5.m5.1.2.4.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.2.4">𝑟</ci><ci id="S4.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.5.m5.1c">Dir(\alpha)</annotation></semantics></math> among <math id="S4.SS1.SSS1.p2.6.m6.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S4.SS1.SSS1.p2.6.m6.1a"><mn id="S4.SS1.SSS1.p2.6.m6.1.1" xref="S4.SS1.SSS1.p2.6.m6.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.6.m6.1b"><cn type="integer" id="S4.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.6.m6.1c">25</annotation></semantics></math> clients, hence <math id="S4.SS1.SSS1.p2.7.m7.1" class="ltx_Math" alttext="C=250" display="inline"><semantics id="S4.SS1.SSS1.p2.7.m7.1a"><mrow id="S4.SS1.SSS1.p2.7.m7.1.1" xref="S4.SS1.SSS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.SSS1.p2.7.m7.1.1.2" xref="S4.SS1.SSS1.p2.7.m7.1.1.2.cmml">C</mi><mo id="S4.SS1.SSS1.p2.7.m7.1.1.1" xref="S4.SS1.SSS1.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p2.7.m7.1.1.3" xref="S4.SS1.SSS1.p2.7.m7.1.1.3.cmml">250</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.7.m7.1b"><apply id="S4.SS1.SSS1.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p2.7.m7.1.1"><eq id="S4.SS1.SSS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p2.7.m7.1.1.1"></eq><ci id="S4.SS1.SSS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p2.7.m7.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.SSS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p2.7.m7.1.1.3">250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.7.m7.1c">C=250</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.6" class="ltx_p"><span id="S4.SS1.SSS1.p3.6.1" class="ltx_text ltx_font_bold">Office-Caltech-10 <cite class="ltx_cite ltx_citemacro_cite">Gong et al. (<a href="#bib.bib19" title="" class="ltx_ref">2012</a>)</cite> &amp; DomainNet <cite class="ltx_cite ltx_citemacro_cite">Peng et al. (<a href="#bib.bib51" title="" class="ltx_ref">2019</a>)</cite>.</span> These datasets
are specifically designed to
contain several domains that exhibit different feature shifts. We set the no. of samples of each domain to be the smallest of the domains, random sampling the larger domains. For Caltech-10, we set <math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="r=1.0" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><mrow id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p3.1.m1.1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml">r</mi><mo id="S4.SS1.SSS1.p3.1.m1.1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p3.1.m1.1.1.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><eq id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2">𝑟</ci><cn type="float" id="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">r=1.0</annotation></semantics></math> and <math id="S4.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="C=4" display="inline"><semantics id="S4.SS1.SSS1.p3.2.m2.1a"><mrow id="S4.SS1.SSS1.p3.2.m2.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p3.2.m2.1.1.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml">C</mi><mo id="S4.SS1.SSS1.p3.2.m2.1.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p3.2.m2.1.1.3" xref="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.2.m2.1b"><apply id="S4.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><eq id="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.1"></eq><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.2.m2.1c">C=4</annotation></semantics></math>, one for each domain and thus partitioned labels are IID. For DomainNet, we set <math id="S4.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="C=150" display="inline"><semantics id="S4.SS1.SSS1.p3.3.m3.1a"><mrow id="S4.SS1.SSS1.p3.3.m3.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p3.3.m3.1.1.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml">C</mi><mo id="S4.SS1.SSS1.p3.3.m3.1.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p3.3.m3.1.1.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.3.m3.1b"><apply id="S4.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><eq id="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.1"></eq><ci id="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.3.m3.1c">C=150</annotation></semantics></math>, of which each of the <math id="S4.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S4.SS1.SSS1.p3.4.m4.1a"><mn id="S4.SS1.SSS1.p3.4.m4.1.1" xref="S4.SS1.SSS1.p3.4.m4.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.4.m4.1b"><cn type="integer" id="S4.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.4.m4.1c">6</annotation></semantics></math> domain datasets are partitioned by <math id="S4.SS1.SSS1.p3.5.m5.1" class="ltx_Math" alttext="Dir(\alpha)" display="inline"><semantics id="S4.SS1.SSS1.p3.5.m5.1a"><mrow id="S4.SS1.SSS1.p3.5.m5.1.2" xref="S4.SS1.SSS1.p3.5.m5.1.2.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.1.2.2" xref="S4.SS1.SSS1.p3.5.m5.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.5.m5.1.2.1" xref="S4.SS1.SSS1.p3.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p3.5.m5.1.2.3" xref="S4.SS1.SSS1.p3.5.m5.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.5.m5.1.2.1a" xref="S4.SS1.SSS1.p3.5.m5.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p3.5.m5.1.2.4" xref="S4.SS1.SSS1.p3.5.m5.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.5.m5.1.2.1b" xref="S4.SS1.SSS1.p3.5.m5.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p3.5.m5.1.2.5.2" xref="S4.SS1.SSS1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p3.5.m5.1.2.5.2.1" xref="S4.SS1.SSS1.p3.5.m5.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p3.5.m5.1.1" xref="S4.SS1.SSS1.p3.5.m5.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS1.SSS1.p3.5.m5.1.2.5.2.2" xref="S4.SS1.SSS1.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.5.m5.1b"><apply id="S4.SS1.SSS1.p3.5.m5.1.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.2"><times id="S4.SS1.SSS1.p3.5.m5.1.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.2.1"></times><ci id="S4.SS1.SSS1.p3.5.m5.1.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.2.2">𝐷</ci><ci id="S4.SS1.SSS1.p3.5.m5.1.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.2.3">𝑖</ci><ci id="S4.SS1.SSS1.p3.5.m5.1.2.4.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.2.4">𝑟</ci><ci id="S4.SS1.SSS1.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.5.m5.1c">Dir(\alpha)</annotation></semantics></math> among <math id="S4.SS1.SSS1.p3.6.m6.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S4.SS1.SSS1.p3.6.m6.1a"><mn id="S4.SS1.SSS1.p3.6.m6.1.1" xref="S4.SS1.SSS1.p3.6.m6.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.6.m6.1b"><cn type="integer" id="S4.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p3.6.m6.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.6.m6.1c">25</annotation></semantics></math> clients, resulting in a challenging setup with both feature &amp; label shifts. Following FedBN <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021c</a>)</cite>, we take the top 10 most commonly used classes in DomainNet.</p>
</div>
<div id="S4.SS1.SSS1.p4" class="ltx_para">
<p id="S4.SS1.SSS1.p4.1" class="ltx_p"><span id="S4.SS1.SSS1.p4.1.1" class="ltx_text ltx_font_bold">Speech Commands V2 <cite class="ltx_cite ltx_citemacro_cite">Warden (<a href="#bib.bib60" title="" class="ltx_ref">2018</a>)</cite>.</span> We use the 12-class version that is naturally partitioned by speaker, with one client per speaker. It is naturally imbalanced in skew and frequency, with 2112, 256, 250 clients/speakers for train, validation, and test. We sampled 250 of 2112 training clients with the most data for our <span id="S4.SS1.SSS1.p4.1.2" class="ltx_text ltx_font_italic">seen</span> pool of clients and sampled 50 out of 256+250 validation and test clients for our <span id="S4.SS1.SSS1.p4.1.3" class="ltx_text ltx_font_italic">unseen</span> client pool. Each client’s data is then split 80%/20% for train and test sets, with a further 20% of the resulting train set held out to form a validation set.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Baselines</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We run all experiments three times and report the mean and SD of the test accuracy. We consider three different setups of fine-tuning in our experiments as below. As basic fine-tuning (FT) is used ubiquitously in FL, our experiments directly compare FT with FedL2P in different non-IID scenarios. We are agnostic to the FL method used to obtain the global model or to train the meta-nets.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.1" class="ltx_p"><span id="S4.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_bold">FT (BN C).</span> Client BN Statistics. Equivalent to setting <math id="S4.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.1a"><mrow id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml">β</mi><mo id="S4.SS1.SSS2.p2.1.m1.1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS2.p2.1.m1.1.1.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.1b"><apply id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1"><eq id="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.1c">\beta=1</annotation></semantics></math> in Eq. <a href="#S3.E2" title="Equation 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, thus using client statistics to normalize features during fine-tuning. This is similar to FedBN <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021c</a>)</cite>, and is adopted by FL works such as Ditto <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib34" title="" class="ltx_ref">2021b</a>)</cite> and PerFedAvg <cite class="ltx_cite ltx_citemacro_cite">Fallah et al. (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.1" class="ltx_p"><span id="S4.SS1.SSS2.p3.1.1" class="ltx_text ltx_font_bold">FT (BN G).</span> Equivalent to setting <math id="S4.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><mrow id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p3.1.m1.1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml">β</mi><mo id="S4.SS1.SSS2.p3.1.m1.1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS2.p3.1.m1.1.1.3" xref="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1"><eq id="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">\beta=0</annotation></semantics></math> in Eq. <a href="#S3.E2" title="Equation 2 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. BN layers use the pretrained global model’s BN statistics to normalize its features during fine-tuning.</p>
</div>
<div id="S4.SS1.SSS2.p4" class="ltx_para">
<p id="S4.SS1.SSS2.p4.1" class="ltx_p"><span id="S4.SS1.SSS2.p4.1.1" class="ltx_text ltx_font_bold">FT (BN I).</span> BN layers use the incoming feature batch statistics to normalize its features during fine-tuning. This setting is adopted by FL works such as FedBABU <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS2.p5" class="ltx_para">
<p id="S4.SS1.SSS2.p5.1" class="ltx_p"><span id="S4.SS1.SSS2.p5.1.1" class="ltx_text ltx_font_bold">L2P.</span> Our proposed method without FL; <math id="S4.SS1.SSS2.p5.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.SSS2.p5.1.m1.1a"><mi id="S4.SS1.SSS2.p5.1.m1.1.1" xref="S4.SS1.SSS2.p5.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p5.1.m1.1b"><ci id="S4.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p5.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p5.1.m1.1c">\lambda</annotation></semantics></math> is learnt locally given the same compute budget before being used for personalization. Hence, L2P does client-wise HPO independently.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiments on Marginal Label Shift</h3>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.6.2" class="ltx_text" style="font-size:90%;">Experiments on CIFAR-10 using pretrained model trained using FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>)</cite>. Both initial &amp; personalized accuracies are learnt and personalized on the same set of clients.</span></figcaption>
<div id="S4.T2.3" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:168.4pt;vertical-align:-82.3pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<table id="S4.T2.3.3.3.3" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T2.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="S4.T2.1.1.1.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T2.1.1.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></th>
<th id="S4.T2.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S4.T2.1.1.1.1.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1.1.1.2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.1.1.1.1.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Epochs (e)</span></td>
</tr>
</table>
</th>
<th id="S4.T2.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S4.T2.1.1.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.1.1.1.1.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Global Accuracy</span></td>
</tr>
</table>
</th>
<th id="S4.T2.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></th>
<th id="S4.T2.1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN G)</span></th>
<th id="S4.T2.1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN I)</span></th>
<th id="S4.T2.1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+L2P</span></th>
<th id="S4.T2.1.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.3.3.3.4.1" class="ltx_tr">
<td id="S4.T2.3.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1000</span></td>
<td id="S4.T2.3.3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T2.3.3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.3.1" class="ltx_text" style="font-size:70%;">65.13</span></td>
<td id="S4.T2.3.3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.4.1" class="ltx_text" style="font-size:70%;">64.35±0.03</span></td>
<td id="S4.T2.3.3.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.5.1" class="ltx_text" style="font-size:70%;">62.14±0.13</span></td>
<td id="S4.T2.3.3.3.3.4.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.6.1" class="ltx_text" style="font-size:70%;">56.58±0.08</span></td>
<td id="S4.T2.3.3.3.3.4.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.7.1" class="ltx_text" style="font-size:70%;">53.61±0.12</span></td>
<td id="S4.T2.3.3.3.3.4.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.4.1.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">64.53±0.06</span></td>
</tr>
<tr id="S4.T2.2.2.2.2.2" class="ltx_tr">
<td id="S4.T2.2.2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T2.2.2.2.2.2.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T2.2.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.2.2.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S4.T2.2.2.2.2.2.1.1.m1.1.1" xref="S4.T2.2.2.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.2.1.1.m1.1b"><ci id="S4.T2.2.2.2.2.2.1.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.2.1.1.m1.1c">\downarrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T2.2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T2.2.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.3.1" class="ltx_text" style="font-size:70%;">65.13</span></td>
<td id="S4.T2.2.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.4.1" class="ltx_text" style="font-size:70%;">63.04±0.02</span></td>
<td id="S4.T2.2.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.5.1" class="ltx_text" style="font-size:70%;">59.85±0.04</span></td>
<td id="S4.T2.2.2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.6.1" class="ltx_text" style="font-size:70%;">55.72±0.03</span></td>
<td id="S4.T2.2.2.2.2.2.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.2.2.2.2.2.7.1" class="ltx_text" style="font-size:70%;">58.41±0.38</span></td>
<td id="S4.T2.2.2.2.2.2.8" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T2.2.2.2.2.2.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">65.13±0.02</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.5.2" class="ltx_tr">
<td id="S4.T2.3.3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1.0</span></td>
<td id="S4.T2.3.3.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T2.3.3.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.3.1" class="ltx_text" style="font-size:70%;">60.19</span></td>
<td id="S4.T2.3.3.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.4.1" class="ltx_text" style="font-size:70%;">59.72±0.18</span></td>
<td id="S4.T2.3.3.3.3.5.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.5.1" class="ltx_text" style="font-size:70%;">63.45±0.04</span></td>
<td id="S4.T2.3.3.3.3.5.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.6.1" class="ltx_text" style="font-size:70%;">50.8±0.06</span></td>
<td id="S4.T2.3.3.3.3.5.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.7.1" class="ltx_text" style="font-size:70%;">55.81±0.03</span></td>
<td id="S4.T2.3.3.3.3.5.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.5.2.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">66.05±0.09</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.6.3" class="ltx_tr">
<td id="S4.T2.3.3.3.3.6.3.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T2.3.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T2.3.3.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.3.1" class="ltx_text" style="font-size:70%;">60.19</span></td>
<td id="S4.T2.3.3.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.4.1" class="ltx_text" style="font-size:70%;">61.42±0.13</span></td>
<td id="S4.T2.3.3.3.3.6.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.5.1" class="ltx_text" style="font-size:70%;">63.23±0.15</span></td>
<td id="S4.T2.3.3.3.3.6.3.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.6.1" class="ltx_text" style="font-size:70%;">54.94±0.07</span></td>
<td id="S4.T2.3.3.3.3.6.3.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.7.1" class="ltx_text" style="font-size:70%;">61.77±0.25</span></td>
<td id="S4.T2.3.3.3.3.6.3.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.6.3.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">65.76±0.31</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.7.4" class="ltx_tr">
<td id="S4.T2.3.3.3.3.7.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.5</span></td>
<td id="S4.T2.3.3.3.3.7.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T2.3.3.3.3.7.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.3.1" class="ltx_text" style="font-size:70%;">57.12</span></td>
<td id="S4.T2.3.3.3.3.7.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.4.1" class="ltx_text" style="font-size:70%;">58.22±0.02</span></td>
<td id="S4.T2.3.3.3.3.7.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.5.1" class="ltx_text" style="font-size:70%;">67.16±0.11</span></td>
<td id="S4.T2.3.3.3.3.7.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.6.1" class="ltx_text" style="font-size:70%;">50.33±0.01</span></td>
<td id="S4.T2.3.3.3.3.7.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.7.1" class="ltx_text" style="font-size:70%;">59.79±0.09</span></td>
<td id="S4.T2.3.3.3.3.7.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.7.4.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">68.96±0.09</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.8.5" class="ltx_tr">
<td id="S4.T2.3.3.3.3.8.5.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T2.3.3.3.3.8.5.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T2.3.3.3.3.8.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.3.1" class="ltx_text" style="font-size:70%;">57.12</span></td>
<td id="S4.T2.3.3.3.3.8.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.4.1" class="ltx_text" style="font-size:70%;">62.34±0.14</span></td>
<td id="S4.T2.3.3.3.3.8.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.5.1" class="ltx_text" style="font-size:70%;">67.4±0.06</span></td>
<td id="S4.T2.3.3.3.3.8.5.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.6.1" class="ltx_text" style="font-size:70%;">58.12±0.07</span></td>
<td id="S4.T2.3.3.3.3.8.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.7.1" class="ltx_text" style="font-size:70%;">65.28±0.23</span></td>
<td id="S4.T2.3.3.3.3.8.5.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.3.3.3.8.5.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">68.45±0.5</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.9.6" class="ltx_tr">
<td id="S4.T2.3.3.3.3.9.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.1</span></td>
<td id="S4.T2.3.3.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T2.3.3.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.3.1" class="ltx_text" style="font-size:70%;">44.86</span></td>
<td id="S4.T2.3.3.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.4.1" class="ltx_text" style="font-size:70%;">68.04±0.05</span></td>
<td id="S4.T2.3.3.3.3.9.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.5.1" class="ltx_text" style="font-size:70%;">78.73±0.04</span></td>
<td id="S4.T2.3.3.3.3.9.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.6.1" class="ltx_text" style="font-size:70%;">61.91±0.06</span></td>
<td id="S4.T2.3.3.3.3.9.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.7.1" class="ltx_text" style="font-size:70%;">74.26±0.29</span></td>
<td id="S4.T2.3.3.3.3.9.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.9.6.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">80.33±0.13</span></td>
</tr>
<tr id="S4.T2.3.3.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="S4.T2.3.3.3.3.3.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T2.3.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.3.3.3.3.3.1.1.m1.1a"><mo stretchy="false" id="S4.T2.3.3.3.3.3.1.1.m1.1.1" xref="S4.T2.3.3.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.3.1.1.m1.1b"><ci id="S4.T2.3.3.3.3.3.1.1.m1.1.1.cmml" xref="S4.T2.3.3.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.3.1.1.m1.1c">\uparrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T2.3.3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T2.3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.3.1" class="ltx_text" style="font-size:70%;">44.86</span></td>
<td id="S4.T2.3.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.4.1" class="ltx_text" style="font-size:70%;">79.15±0.07</span></td>
<td id="S4.T2.3.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.5.1" class="ltx_text" style="font-size:70%;">78.97±0.07</span></td>
<td id="S4.T2.3.3.3.3.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.6.1" class="ltx_text" style="font-size:70%;">75.94±0.0</span></td>
<td id="S4.T2.3.3.3.3.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.7.1" class="ltx_text" style="font-size:70%;">78.6±0.21</span></td>
<td id="S4.T2.3.3.3.3.3.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.3.3.3.3.3.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">80.28±0.07</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">We evaluate our approach based on the conventional setup of personalized FL approaches <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a href="#bib.bib9" title="" class="ltx_ref">2022</a>); Matsuda et al. (<a href="#bib.bib45" title="" class="ltx_ref">2022b</a>)</cite>, where a global model, <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝜃</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\theta_{g}</annotation></semantics></math>, is first learned federatedly using existing algorithms
and then personalized to the same set of clients via fine-tuning. To this end, given the CIFAR-10 dataset partitioned among a group of clients, we pretrained <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\theta_{g}</annotation></semantics></math> following best practices from <cite class="ltx_cite ltx_citemacro_cite">Horvath et al. (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> using FedAvg and finetune it on the same set of clients. Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the personalized accuracy of the various fine-tuning baselines (Section <a href="#S4.SS1.SSS2" title="4.1.2 Baselines ‣ 4.1 Experimental Setup ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>) and FedL2P using <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="e=5\&amp;15" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">e</mi><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mn id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.3.m3.1.1.3.1" xref="S4.SS2.p1.3.m3.1.1.3.1.cmml">&amp;</mo><mn id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml">15</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></eq><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑒</ci><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><and id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.1"></and><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">5</cn><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3">15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">e=5\&amp;15</annotation></semantics></math> local epochs on groups of clients with varying label distribution, <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="P_{i}(y)" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><msub id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml"><mi id="S4.SS2.p1.4.m4.1.2.2.2" xref="S4.SS2.p1.4.m4.1.2.2.2.cmml">P</mi><mi id="S4.SS2.p1.4.m4.1.2.2.3" xref="S4.SS2.p1.4.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.2.1" xref="S4.SS2.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.4.m4.1.2.3.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.1" xref="S4.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">y</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.2" xref="S4.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><times id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.1"></times><apply id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.2.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.2.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2.2">𝑃</ci><ci id="S4.SS2.p1.4.m4.1.2.2.3.cmml" xref="S4.SS2.p1.4.m4.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">P_{i}(y)</annotation></semantics></math>; <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">α</mi><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝛼</ci><cn type="integer" id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\alpha=1000</annotation></semantics></math> represents the IID case and <math id="S4.SS2.p1.6.m6.3" class="ltx_Math" alttext="\alpha=1.0,0.5,0.1" display="inline"><semantics id="S4.SS2.p1.6.m6.3a"><mrow id="S4.SS2.p1.6.m6.3.4" xref="S4.SS2.p1.6.m6.3.4.cmml"><mi id="S4.SS2.p1.6.m6.3.4.2" xref="S4.SS2.p1.6.m6.3.4.2.cmml">α</mi><mo id="S4.SS2.p1.6.m6.3.4.1" xref="S4.SS2.p1.6.m6.3.4.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m6.3.4.3.2" xref="S4.SS2.p1.6.m6.3.4.3.1.cmml"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">1.0</mn><mo id="S4.SS2.p1.6.m6.3.4.3.2.1" xref="S4.SS2.p1.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">0.5</mn><mo id="S4.SS2.p1.6.m6.3.4.3.2.2" xref="S4.SS2.p1.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.3.3" xref="S4.SS2.p1.6.m6.3.3.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.3b"><apply id="S4.SS2.p1.6.m6.3.4.cmml" xref="S4.SS2.p1.6.m6.3.4"><eq id="S4.SS2.p1.6.m6.3.4.1.cmml" xref="S4.SS2.p1.6.m6.3.4.1"></eq><ci id="S4.SS2.p1.6.m6.3.4.2.cmml" xref="S4.SS2.p1.6.m6.3.4.2">𝛼</ci><list id="S4.SS2.p1.6.m6.3.4.3.1.cmml" xref="S4.SS2.p1.6.m6.3.4.3.2"><cn type="float" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">1.0</cn><cn type="float" id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">0.5</cn><cn type="float" id="S4.SS2.p1.6.m6.3.3.cmml" xref="S4.SS2.p1.6.m6.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.3c">\alpha=1.0,0.5,0.1</annotation></semantics></math> represents more heterogeneous case. As observed in many previous works <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Jiang et al. (<a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite>, increasing label heterogeneity would result in a better initial global model at a expense of personalized performance. Our method instead retains the initial global performance and focuses on improving personalized performance.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.7" class="ltx_p">We also show that in many cases, especially for clients with limited local compute budget <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="e=5" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">e</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">e=5</annotation></semantics></math>, utilizing the pretrained model’s BN statistics result (<span id="S4.SS2.p2.7.1" class="ltx_text ltx_font_bold">BN G</span>) can be more beneficial as CIFAR-10 consists of images from the same natural image domain; in contrast, previous works mainly use either the client’s BN statistics (<span id="S4.SS2.p2.7.2" class="ltx_text ltx_font_bold">BN C</span>) or the incoming feature batch statistics (<span id="S4.SS2.p2.7.3" class="ltx_text ltx_font_bold">BN I</span>) to normalize the features. This strategy is discovered by FedL2P, as illustrated in Fig. <a href="#S4.F2.sf1" title="Figure 2(a) ‣ Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a> where the learned <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\boldsymbol{\beta}</annotation></semantics></math> is <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn type="integer" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">0</cn></annotation-xml></semantics></math> for all BN layers of all clients. For the IID case in particular, FedL2P learns a sparsity<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Sparsity refers to the percent of parameters whose learned learning rate for FT is 0.</span></span></span> of <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><cn type="float" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">1.0</annotation></semantics></math>, learning rate <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\eta=0" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">η</mi><mo id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><eq id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></eq><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝜂</ci><cn type="integer" id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\eta=0</annotation></semantics></math>, for all layers in all clients, forgoing fine-tuning and using the initial global model as the personalized model. For <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><eq id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></eq><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\alpha=1.0</annotation></semantics></math> and <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mn id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><cn type="float" id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">0.1</annotation></semantics></math>, FedL2P learns highly sparse models similar to recent works that proposed fine-tuning only a subset of hand-picked layers <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>); Ghosh et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>); Collins et al. (<a href="#bib.bib11" title="" class="ltx_ref">2021</a>); Arivazhagan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>); Liang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> to obtain performance gains.
Lastly, L2P performs worse than some standard fine-tuning baselines as it meta-overfits on each client’s validation set, highlighting the benefits of FL over local HPO.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p"><span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_bold">FedL2P’s Complementability with previous FL works.</span> As our proposed FedL2P learns to improve the FT process, it is complementary, not competing, with other FL methods that learn shared model(s). Hence, besides FedAvg, we utilize FedL2P to better personalize <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">θ</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝜃</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\theta_{g}</annotation></semantics></math> pretrained using PerFedAvg(HF) <cite class="ltx_cite ltx_citemacro_cite">Fallah et al. (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite> and FedBABU <cite class="ltx_cite ltx_citemacro_cite">Oh et al. (<a href="#bib.bib48" title="" class="ltx_ref">2021</a>)</cite> as shown in Table. <a href="#S4.T1" title="Table 1 ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where we compare FedL2P against the most commonly used FT approach, <span id="S4.SS2.p3.3.2" class="ltx_text ltx_font_bold">BN C</span>.
Our results show that applying FedL2P to all three FL methods can lead to further gains, in most cases outperforming FT in each respective method.
This performance improvement can also bridge the performance gap between different methods. For instance, while FedAvg+FT has worse performance than FedBABU+FT in all cases, FedAvg+FedL2P obtained comparable or better performance than FedBABU+FT for <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\alpha=1000</annotation></semantics></math> &amp; <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><cn type="float" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">0.1</annotation></semantics></math>.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x2.png" id="S4.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="322" height="128" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf1.4.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F2.sf1.2.1" class="ltx_text" style="font-size:90%;">CIFAR10 (<math id="S4.F2.sf1.2.1.m1.1" class="ltx_Math" alttext="e=15" display="inline"><semantics id="S4.F2.sf1.2.1.m1.1b"><mrow id="S4.F2.sf1.2.1.m1.1.1" xref="S4.F2.sf1.2.1.m1.1.1.cmml"><mi id="S4.F2.sf1.2.1.m1.1.1.2" xref="S4.F2.sf1.2.1.m1.1.1.2.cmml">e</mi><mo id="S4.F2.sf1.2.1.m1.1.1.1" xref="S4.F2.sf1.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.sf1.2.1.m1.1.1.3" xref="S4.F2.sf1.2.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf1.2.1.m1.1c"><apply id="S4.F2.sf1.2.1.m1.1.1.cmml" xref="S4.F2.sf1.2.1.m1.1.1"><eq id="S4.F2.sf1.2.1.m1.1.1.1.cmml" xref="S4.F2.sf1.2.1.m1.1.1.1"></eq><ci id="S4.F2.sf1.2.1.m1.1.1.2.cmml" xref="S4.F2.sf1.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.F2.sf1.2.1.m1.1.1.3.cmml" xref="S4.F2.sf1.2.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf1.2.1.m1.1d">e=15</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x3.png" id="S4.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="322" height="128" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">CIFAR10C</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x4.png" id="S4.F2.sf3.g1" class="ltx_graphics ltx_img_landscape" width="322" height="128" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F2.sf3.3.2" class="ltx_text" style="font-size:90%;">DomainNet</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x5.png" id="S4.F2.sf4.g1" class="ltx_graphics ltx_img_landscape" width="332" height="133" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F2.sf4.3.2" class="ltx_text" style="font-size:90%;">Office-Caltech-10</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.6.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text" style="font-size:90%;">Locality, spread, and skewness of FedL2P’s learned hyperparameters, <math id="S4.F2.3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.F2.3.1.m1.1b"><mi id="S4.F2.3.1.m1.1.1" xref="S4.F2.3.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.F2.3.1.m1.1c"><ci id="S4.F2.3.1.m1.1.1.cmml" xref="S4.F2.3.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.1.m1.1d">\boldsymbol{\beta}</annotation></semantics></math> and <math id="S4.F2.4.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S4.F2.4.2.m2.1b"><mi id="S4.F2.4.2.m2.1.1" xref="S4.F2.4.2.m2.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S4.F2.4.2.m2.1c"><ci id="S4.F2.4.2.m2.1.1.cmml" xref="S4.F2.4.2.m2.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.2.m2.1d">\boldsymbol{\eta}</annotation></semantics></math>, of different layers across clients and the model’s sparsity of all clients for each personalization scenario.</span></figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Personalizing to Unseen Clients</h3>

<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.7.2.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.2.1" class="ltx_text" style="font-size:90%;">Personalized test accuracies of CIFAR-10-C, Office-Caltech-10, Domainnet (<math id="S4.T3.2.1.m1.1" class="ltx_Math" alttext="e=15" display="inline"><semantics id="S4.T3.2.1.m1.1b"><mrow id="S4.T3.2.1.m1.1.1" xref="S4.T3.2.1.m1.1.1.cmml"><mi id="S4.T3.2.1.m1.1.1.2" xref="S4.T3.2.1.m1.1.1.2.cmml">e</mi><mo id="S4.T3.2.1.m1.1.1.1" xref="S4.T3.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.2.1.m1.1.1.3" xref="S4.T3.2.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><apply id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1"><eq id="S4.T3.2.1.m1.1.1.1.cmml" xref="S4.T3.2.1.m1.1.1.1"></eq><ci id="S4.T3.2.1.m1.1.1.2.cmml" xref="S4.T3.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.T3.2.1.m1.1.1.3.cmml" xref="S4.T3.2.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">e=15</annotation></semantics></math>).</span></figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:181pt;vertical-align:-88.6pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<table id="S4.T3.5.3.3.3" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1.1.1" class="ltx_tr">
<td id="S4.T3.3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T3.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="S4.T3.3.1.1.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T3.3.1.1.1.1.1.m1.1.1" xref="S4.T3.3.1.1.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.1.1.1.m1.1b"><ci id="S4.T3.3.1.1.1.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></td>
<td id="S4.T3.3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Dataset</span></td>
<td id="S4.T3.3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></td>
<td id="S4.T3.3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN G)</span></td>
<td id="S4.T3.3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN I)</span></td>
<td id="S4.T3.3.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+L2P</span></td>
<td id="S4.T3.3.1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.1.1.1.1.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.4.1" class="ltx_tr">
<td id="S4.T3.5.3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1000</span></td>
<td id="S4.T3.5.3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T3.5.3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.3.1" class="ltx_text" style="font-size:70%;">59.58±0.03</span></td>
<td id="S4.T3.5.3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.4.1" class="ltx_text" style="font-size:70%;">57.03±0.08</span></td>
<td id="S4.T3.5.3.3.3.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.5.1" class="ltx_text" style="font-size:70%;">55.77±0.12</span></td>
<td id="S4.T3.5.3.3.3.4.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.6.1" class="ltx_text" style="font-size:70%;">58.80±0.13</span></td>
<td id="S4.T3.5.3.3.3.4.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.4.1.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">59.97±0.22</span></td>
</tr>
<tr id="S4.T3.4.2.2.2.2" class="ltx_tr">
<td id="S4.T3.4.2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T3.4.2.2.2.2.1.1" class="ltx_text" style="font-size:90%;">(<math id="S4.T3.4.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.4.2.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S4.T3.4.2.2.2.2.1.1.m1.1.1" xref="S4.T3.4.2.2.2.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.2.2.1.1.m1.1b"><ci id="S4.T3.4.2.2.2.2.1.1.m1.1.1.cmml" xref="S4.T3.4.2.2.2.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.2.2.1.1.m1.1c">\downarrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T3.4.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T3.4.2.2.2.2.2.1" class="ltx_text" style="font-size:70%;">Caltech-10</span></td>
<td id="S4.T3.4.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.4.2.2.2.2.3.1" class="ltx_text" style="font-size:70%;">80.97±0.33</span></td>
<td id="S4.T3.4.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.4.2.2.2.2.4.1" class="ltx_text" style="font-size:70%;">36.02±25.21</span></td>
<td id="S4.T3.4.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.4.2.2.2.2.5.1" class="ltx_text" style="font-size:70%;">81.43±2.16</span></td>
<td id="S4.T3.4.2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.4.2.2.2.2.6.1" class="ltx_text" style="font-size:70%;">75.52±3.83</span></td>
<td id="S4.T3.4.2.2.2.2.7" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T3.4.2.2.2.2.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">88.85±0.89</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.5.2" class="ltx_tr">
<td id="S4.T3.5.3.3.3.5.2.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T3.5.3.3.3.5.2.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T3.5.3.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.3.1" class="ltx_text" style="font-size:70%;">52.17±1.55</span></td>
<td id="S4.T3.5.3.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.4.1" class="ltx_text" style="font-size:70%;">30.55±1.07</span></td>
<td id="S4.T3.5.3.3.3.5.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.5.1" class="ltx_text" style="font-size:70%;">50.47±0.88</span></td>
<td id="S4.T3.5.3.3.3.5.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.6.1" class="ltx_text" style="font-size:70%;">45.04±1.56</span></td>
<td id="S4.T3.5.3.3.3.5.2.7" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T3.5.3.3.3.5.2.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">54.38±0.45</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.6.3" class="ltx_tr">
<td id="S4.T3.5.3.3.3.6.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1.0</span></td>
<td id="S4.T3.5.3.3.3.6.3.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T3.5.3.3.3.6.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.3.1" class="ltx_text" style="font-size:70%;">67.37±0.08</span></td>
<td id="S4.T3.5.3.3.3.6.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.4.1" class="ltx_text" style="font-size:70%;">66.45±0.03</span></td>
<td id="S4.T3.5.3.3.3.6.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.5.1" class="ltx_text" style="font-size:70%;">63.56±0.07</span></td>
<td id="S4.T3.5.3.3.3.6.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.6.1" class="ltx_text" style="font-size:70%;">66.63±0.09</span></td>
<td id="S4.T3.5.3.3.3.6.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.6.3.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">68.83±0.15</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.7.4" class="ltx_tr">
<td id="S4.T3.5.3.3.3.7.4.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T3.5.3.3.3.7.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T3.5.3.3.3.7.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.3.1" class="ltx_text" style="font-size:70%;">62.27±0.58</span></td>
<td id="S4.T3.5.3.3.3.7.4.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.4.1" class="ltx_text" style="font-size:70%;">44.15±0.11</span></td>
<td id="S4.T3.5.3.3.3.7.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.5.1" class="ltx_text" style="font-size:70%;">59.4±0.7</span></td>
<td id="S4.T3.5.3.3.3.7.4.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.6.1" class="ltx_text" style="font-size:70%;">54.75±0.12</span></td>
<td id="S4.T3.5.3.3.3.7.4.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.7.4.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">63.77±0.44</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.8.5" class="ltx_tr">
<td id="S4.T3.5.3.3.3.8.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.5</span></td>
<td id="S4.T3.5.3.3.3.8.5.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T3.5.3.3.3.8.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.3.1" class="ltx_text" style="font-size:70%;">74.92±0.08</span></td>
<td id="S4.T3.5.3.3.3.8.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.4.1" class="ltx_text" style="font-size:70%;">75.24±0.17</span></td>
<td id="S4.T3.5.3.3.3.8.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.5.1" class="ltx_text" style="font-size:70%;">71.38±0.01</span></td>
<td id="S4.T3.5.3.3.3.8.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.6.1" class="ltx_text" style="font-size:70%;">74.48±0.06</span></td>
<td id="S4.T3.5.3.3.3.8.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.8.5.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">76.78±0.22</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.9.6" class="ltx_tr">
<td id="S4.T3.5.3.3.3.9.6.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T3.5.3.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T3.5.3.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.3.1" class="ltx_text" style="font-size:70%;">71.39±0.97</span></td>
<td id="S4.T3.5.3.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.4.1" class="ltx_text" style="font-size:70%;">49.81±1.98</span></td>
<td id="S4.T3.5.3.3.3.9.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.5.1" class="ltx_text" style="font-size:70%;">68.94±0.71</span></td>
<td id="S4.T3.5.3.3.3.9.6.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.6.1" class="ltx_text" style="font-size:70%;">66.38±0.78</span></td>
<td id="S4.T3.5.3.3.3.9.6.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.5.3.3.3.9.6.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">72.64±0.3</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.10.7" class="ltx_tr">
<td id="S4.T3.5.3.3.3.10.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.1</span></td>
<td id="S4.T3.5.3.3.3.10.7.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T3.5.3.3.3.10.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.3.1" class="ltx_text" style="font-size:70%;">87.25±0.06</span></td>
<td id="S4.T3.5.3.3.3.10.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.4.1" class="ltx_text" style="font-size:70%;">88.5±0.02</span></td>
<td id="S4.T3.5.3.3.3.10.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.5.1" class="ltx_text" style="font-size:70%;">83.93±0.04</span></td>
<td id="S4.T3.5.3.3.3.10.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.6.1" class="ltx_text" style="font-size:70%;">87.93±0.31</span></td>
<td id="S4.T3.5.3.3.3.10.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.5.3.3.3.10.7.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">89.23±0.15</span></td>
</tr>
<tr id="S4.T3.5.3.3.3.3" class="ltx_tr">
<td id="S4.T3.5.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="S4.T3.5.3.3.3.3.1.1" class="ltx_text" style="font-size:90%;">(<math id="S4.T3.5.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.5.3.3.3.3.1.1.m1.1a"><mo stretchy="false" id="S4.T3.5.3.3.3.3.1.1.m1.1.1" xref="S4.T3.5.3.3.3.3.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.3.3.1.1.m1.1b"><ci id="S4.T3.5.3.3.3.3.1.1.m1.1.1.cmml" xref="S4.T3.5.3.3.3.3.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.3.3.1.1.m1.1c">\uparrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T3.5.3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="S4.T3.5.3.3.3.3.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T3.5.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.5.3.3.3.3.3.1" class="ltx_text" style="font-size:70%;">86.03±0.47</span></td>
<td id="S4.T3.5.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.5.3.3.3.3.4.1" class="ltx_text" style="font-size:70%;">69.41±1.95</span></td>
<td id="S4.T3.5.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.5.3.3.3.3.5.1" class="ltx_text" style="font-size:70%;">85.35±1.14</span></td>
<td id="S4.T3.5.3.3.3.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.5.3.3.3.3.6.1" class="ltx_text" style="font-size:70%;">83.93±1.02</span></td>
<td id="S4.T3.5.3.3.3.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.5.3.3.3.3.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">86.36±0.45</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.3.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.4.2" class="ltx_text" style="font-size:90%;">Experiments on Speech Commands. Both the pretrained model and meta-nets are only learned on the <span id="S4.T4.4.2.1" class="ltx_text ltx_font_italic">seen</span> pool of clients.</span></figcaption>
<div id="S4.T4.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:81.9pt;vertical-align:-39.3pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.5pt,3.8pt) scale(0.850006087750882,0.850006087750882) ;">
<table id="S4.T4.5.1" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="S4.T4.5.1.1.1" class="ltx_tr">
<th id="S4.T4.5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Client Pool</span></th>
<th id="S4.T4.5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S4.T4.5.1.1.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.5.1.1.1.2.1.1" class="ltx_tr">
<td id="S4.T4.5.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T4.5.1.1.1.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Epochs (e)</span></td>
</tr>
</table>
</th>
<th id="S4.T4.5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S4.T4.5.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.5.1.1.1.3.1.1" class="ltx_tr">
<td id="S4.T4.5.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T4.5.1.1.1.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Global Accuracy</span></td>
</tr>
</table>
</th>
<th id="S4.T4.5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></th>
<th id="S4.T4.5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN G)</span></th>
<th id="S4.T4.5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN I)</span></th>
<th id="S4.T4.5.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+L2P</span></th>
<th id="S4.T4.5.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S4.T4.5.1.1.1.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.5.1.2.1" class="ltx_tr">
<td id="S4.T4.5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.1.1" class="ltx_text ltx_font_italic" style="font-size:70%;">Seen</span></td>
<td id="S4.T4.5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T4.5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.3.1" class="ltx_text" style="font-size:70%;">82.11</span></td>
<td id="S4.T4.5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.4.1" class="ltx_text" style="font-size:70%;">70.07±0.63</span></td>
<td id="S4.T4.5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.5.1" class="ltx_text" style="font-size:70%;">2.98±0.00</span></td>
<td id="S4.T4.5.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.6.1" class="ltx_text" style="font-size:70%;">65.97±0.43</span></td>
<td id="S4.T4.5.1.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.7.1" class="ltx_text" style="font-size:70%;">64.79±1.84</span></td>
<td id="S4.T4.5.1.2.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T4.5.1.2.1.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">87.77±0.47</span></td>
</tr>
<tr id="S4.T4.5.1.3.2" class="ltx_tr">
<td id="S4.T4.5.1.3.2.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T4.5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T4.5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.3.1" class="ltx_text" style="font-size:70%;">82.11</span></td>
<td id="S4.T4.5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.4.1" class="ltx_text" style="font-size:70%;">74.15±0.70</span></td>
<td id="S4.T4.5.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.5.1" class="ltx_text" style="font-size:70%;">2.98±0.0</span></td>
<td id="S4.T4.5.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.6.1" class="ltx_text" style="font-size:70%;">68.98±0.19</span></td>
<td id="S4.T4.5.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.1.3.2.7.1" class="ltx_text" style="font-size:70%;">65.80±1.66</span></td>
<td id="S4.T4.5.1.3.2.8" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T4.5.1.3.2.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">84.74±0.38</span></td>
</tr>
<tr id="S4.T4.5.1.4.3" class="ltx_tr">
<td id="S4.T4.5.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.1.1" class="ltx_text ltx_font_italic" style="font-size:70%;">Unseen</span></td>
<td id="S4.T4.5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.2.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="S4.T4.5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.3.1" class="ltx_text" style="font-size:70%;">81.62</span></td>
<td id="S4.T4.5.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.4.1" class="ltx_text" style="font-size:70%;">62.76±1.83</span></td>
<td id="S4.T4.5.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.5.1" class="ltx_text" style="font-size:70%;">2.85±0.00</span></td>
<td id="S4.T4.5.1.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.6.1" class="ltx_text" style="font-size:70%;">64.88±0.66</span></td>
<td id="S4.T4.5.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.7.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T4.5.1.4.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T4.5.1.4.3.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">87.85±0.18</span></td>
</tr>
<tr id="S4.T4.5.1.5.4" class="ltx_tr">
<td id="S4.T4.5.1.5.4.1" class="ltx_td ltx_border_b ltx_border_l ltx_border_r"></td>
<td id="S4.T4.5.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.2.1" class="ltx_text" style="font-size:70%;">15</span></td>
<td id="S4.T4.5.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.3.1" class="ltx_text" style="font-size:70%;">81.62</span></td>
<td id="S4.T4.5.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.4.1" class="ltx_text" style="font-size:70%;">68.76±3.40</span></td>
<td id="S4.T4.5.1.5.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.5.1" class="ltx_text" style="font-size:70%;">2.85±0.00</span></td>
<td id="S4.T4.5.1.5.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.6.1" class="ltx_text" style="font-size:70%;">67.28±0.46</span></td>
<td id="S4.T4.5.1.5.4.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.7.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T4.5.1.5.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.1.5.4.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">84.60±0.35</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.3" class="ltx_p"><span id="S4.SS3.p1.3.1" class="ltx_text ltx_font_bold">Unseen during Pretraining.</span> We evaluate the performance of FedL2P on CIFAR-10-C starting from the pretrained model trained using FedAvg on CIFAR-10 in the IID setting <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><eq id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\alpha=1000</annotation></semantics></math> (Section. <a href="#S4.SS2" title="4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) as shown in Table. <a href="#S4.T3" title="Table 3 ‣ 4.3 Personalizing to Unseen Clients ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. These new clients, whose data is partitioned from CIFAR-10-C, did not participate in the pretraining of the global model and, instead, only participate in the training of the meta-nets. As added noise would impact the feature shift among clients, Fig. <a href="#S4.F2.sf2" title="Figure 2(b) ‣ Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a> shows FedL2P learns to use <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">β</mi><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><eq id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></eq><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝛽</ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\beta=1</annotation></semantics></math> as compared to sole use of <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">β</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><eq id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝛽</ci><cn type="integer" id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\beta=0</annotation></semantics></math> in the CIFAR-10 case (Fig. <a href="#S4.F2.sf1" title="Figure 2(a) ‣ Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>); some clients benefit more by using its own BN statistics.
Hence, the performance gap for non-IID cases between <span id="S4.SS3.p1.3.2" class="ltx_text ltx_font_bold">BN C</span> and <span id="S4.SS3.p1.3.3" class="ltx_text ltx_font_bold">BN G</span> is significantly smaller as compared to CIFAR-10 shown in Table. <a href="#S4.T2" title="Table 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Unseen during Learning of Meta-nets.</span> We evaluate the case where some clients are not included in the learning of the meta-nets through our experiments on the Speech Commands dataset. We first pretrain the model using FedAvg and then train the meta-nets using our <span id="S4.SS3.p2.1.2" class="ltx_text ltx_font_italic">seen</span> pool of clients. The learned meta-nets are then used to fine-tune and evaluate both our <span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_italic">seen</span> and <span id="S4.SS3.p2.1.4" class="ltx_text ltx_font_italic">unseen</span> pool of clients as shown in Table. <a href="#S4.T4" title="Table 4 ‣ 4.3 Personalizing to Unseen Clients ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Note that L2P is not evaluated on the <span id="S4.SS3.p2.1.5" class="ltx_text ltx_font_italic">unseen</span> pool of clients as we only evaluate the meta-nets learned on the <span id="S4.SS3.p2.1.6" class="ltx_text ltx_font_italic">seen</span> pool of clients. We see that fine-tuning the pretrained model on each client’s train set resulted in a significant drop in test set performance. Moreover, as each client represents a different speaker, fine-tuning using the pretrained model’s BN statistics (<span id="S4.SS3.p2.1.7" class="ltx_text ltx_font_bold">BN G</span>) fails entirely. FedL2P, on the other hand, led to a significant performance boost on both the <span id="S4.SS3.p2.1.8" class="ltx_text ltx_font_italic">seen</span> and <span id="S4.SS3.p2.1.9" class="ltx_text ltx_font_italic">unseen</span> client pools, e.g. by utilizing a mix of pretrained model’s BN statistics and the client’s BN statistics shown in Appendix <a href="#A6" title="Appendix F Additional Results ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.9.2.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T5.2.1" class="ltx_text" style="font-size:90%;">Ablation study for FedL2P with <math id="S4.T5.2.1.m1.1" class="ltx_Math" alttext="e=15" display="inline"><semantics id="S4.T5.2.1.m1.1b"><mrow id="S4.T5.2.1.m1.1.1" xref="S4.T5.2.1.m1.1.1.cmml"><mi id="S4.T5.2.1.m1.1.1.2" xref="S4.T5.2.1.m1.1.1.2.cmml">e</mi><mo id="S4.T5.2.1.m1.1.1.1" xref="S4.T5.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T5.2.1.m1.1.1.3" xref="S4.T5.2.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.2.1.m1.1c"><apply id="S4.T5.2.1.m1.1.1.cmml" xref="S4.T5.2.1.m1.1.1"><eq id="S4.T5.2.1.m1.1.1.1.cmml" xref="S4.T5.2.1.m1.1.1.1"></eq><ci id="S4.T5.2.1.m1.1.1.2.cmml" xref="S4.T5.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.T5.2.1.m1.1.1.3.cmml" xref="S4.T5.2.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.1.m1.1d">e=15</annotation></semantics></math>.</span></figcaption>
<div id="S4.T5.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:234.9pt;vertical-align:-115.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.5pt,10.5pt) scale(0.850006087750882,0.850006087750882) ;">
<table id="S4.T5.7.5.5.5" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<tbody class="ltx_tbody">
<tr id="S4.T5.5.3.3.3.3" class="ltx_tr">
<td id="S4.T5.3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><math id="S4.T5.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="S4.T5.3.1.1.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T5.3.1.1.1.1.1.m1.1.1" xref="S4.T5.3.1.1.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="S4.T5.3.1.1.1.1.1.m1.1b"><ci id="S4.T5.3.1.1.1.1.1.m1.1.1.cmml" xref="S4.T5.3.1.1.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.1.1.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></td>
<td id="S4.T5.5.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.5.3.3.3.3.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Dataset</span></td>
<td id="S4.T5.5.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.5.3.3.3.3.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></td>
<td id="S4.T5.5.3.3.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.5.3.3.3.3.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN G)</span></td>
<td id="S4.T5.5.3.3.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<table id="S4.T5.5.3.3.3.3.7.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.5.3.3.3.3.7.1.1" class="ltx_tr">
<td id="S4.T5.5.3.3.3.3.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.5.3.3.3.3.7.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></td>
</tr>
<tr id="S4.T5.5.3.3.3.3.7.1.2" class="ltx_tr">
<td id="S4.T5.5.3.3.3.3.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.5.3.3.3.3.7.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">(BNNet)</span></td>
</tr>
</table>
</td>
<td id="S4.T5.4.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<table id="S4.T5.4.2.2.2.2.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.4.2.2.2.2.2.1.2" class="ltx_tr">
<td id="S4.T5.4.2.2.2.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.4.2.2.2.2.2.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></td>
</tr>
<tr id="S4.T5.4.2.2.2.2.2.1.1" class="ltx_tr">
<td id="S4.T5.4.2.2.2.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="S4.T5.4.2.2.2.2.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">(LRNet) </span><math id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1.1" xref="S4.T5.4.2.2.2.2.2.1.1.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1b"><ci id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1.1.cmml" xref="S4.T5.4.2.2.2.2.2.1.1.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.2.2.2.2.2.1.1.1.m1.1c">\boldsymbol{\beta}</annotation></semantics></math><span id="S4.T5.4.2.2.2.2.2.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">=1</span>
</td>
</tr>
</table>
</td>
<td id="S4.T5.5.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<table id="S4.T5.5.3.3.3.3.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.5.3.3.3.3.3.1.2" class="ltx_tr">
<td id="S4.T5.5.3.3.3.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T5.5.3.3.3.3.3.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></td>
</tr>
<tr id="S4.T5.5.3.3.3.3.3.1.1" class="ltx_tr">
<td id="S4.T5.5.3.3.3.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="S4.T5.5.3.3.3.3.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">(LRNet) </span><math id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1a"><mi mathsize="70%" id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1.1" xref="S4.T5.5.3.3.3.3.3.1.1.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1b"><ci id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1.1.cmml" xref="S4.T5.5.3.3.3.3.3.1.1.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.3.3.3.3.3.1.1.1.m1.1c">\boldsymbol{\beta}</annotation></semantics></math><span id="S4.T5.5.3.3.3.3.3.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">=0</span>
</td>
</tr>
</table>
</td>
<td id="S4.T5.5.3.3.3.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.5.3.3.3.3.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.6.1" class="ltx_tr">
<td id="S4.T5.7.5.5.5.6.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1000</span></td>
<td id="S4.T5.7.5.5.5.6.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10</span></td>
<td id="S4.T5.7.5.5.5.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.3.1" class="ltx_text" style="font-size:70%;">63.04±0.02</span></td>
<td id="S4.T5.7.5.5.5.6.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.4.1" class="ltx_text" style="font-size:70%;">59.85±0.04</span></td>
<td id="S4.T5.7.5.5.5.6.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.5.1" class="ltx_text" style="font-size:70%;">62.35±0.24</span></td>
<td id="S4.T5.7.5.5.5.6.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.6.1" class="ltx_text" style="font-size:70%;">62.62±0.21</span></td>
<td id="S4.T5.7.5.5.5.6.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.7.1" class="ltx_text" style="font-size:70%;">65.11±0.02</span></td>
<td id="S4.T5.7.5.5.5.6.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.6.1.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">65.13±0.02</span></td>
</tr>
<tr id="S4.T5.6.4.4.4.4" class="ltx_tr">
<td id="S4.T5.6.4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.6.4.4.4.4.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T5.6.4.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T5.6.4.4.4.4.1.1.m1.1a"><mo stretchy="false" id="S4.T5.6.4.4.4.4.1.1.m1.1.1" xref="S4.T5.6.4.4.4.4.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.4.4.4.4.1.1.m1.1b"><ci id="S4.T5.6.4.4.4.4.1.1.m1.1.1.cmml" xref="S4.T5.6.4.4.4.4.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.4.4.4.4.1.1.m1.1c">\downarrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T5.6.4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.6.4.4.4.4.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T5.6.4.4.4.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.3.1" class="ltx_text" style="font-size:70%;">59.58±0.03</span></td>
<td id="S4.T5.6.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.4.1" class="ltx_text" style="font-size:70%;">57.03±0.08</span></td>
<td id="S4.T5.6.4.4.4.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.5.1" class="ltx_text" style="font-size:70%;">59.57±0.13</span></td>
<td id="S4.T5.6.4.4.4.4.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">60.09±0.02</span></td>
<td id="S4.T5.6.4.4.4.4.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.7.1" class="ltx_text" style="font-size:70%;">59.30±0.11</span></td>
<td id="S4.T5.6.4.4.4.4.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.6.4.4.4.4.8.1" class="ltx_text" style="font-size:70%;">59.97±0.22</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.7.2" class="ltx_tr">
<td id="S4.T5.7.5.5.5.7.2.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.7.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.2.1" class="ltx_text" style="font-size:70%;">Caltech-10</span></td>
<td id="S4.T5.7.5.5.5.7.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.3.1" class="ltx_text" style="font-size:70%;">80.97±0.33</span></td>
<td id="S4.T5.7.5.5.5.7.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.4.1" class="ltx_text" style="font-size:70%;">36.02±25.21</span></td>
<td id="S4.T5.7.5.5.5.7.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.5.1" class="ltx_text" style="font-size:70%;">88.12±1.18</span></td>
<td id="S4.T5.7.5.5.5.7.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.6.1" class="ltx_text" style="font-size:70%;">85.50±5.76</span></td>
<td id="S4.T5.7.5.5.5.7.2.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.7.1" class="ltx_text" style="font-size:70%;">42.59±22.87</span></td>
<td id="S4.T5.7.5.5.5.7.2.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.7.2.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">88.85±0.89</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.8.3" class="ltx_tr">
<td id="S4.T5.7.5.5.5.8.3.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.8.3.2" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T5.7.5.5.5.8.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.3.1" class="ltx_text" style="font-size:70%;">52.17±1.55</span></td>
<td id="S4.T5.7.5.5.5.8.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.4.1" class="ltx_text" style="font-size:70%;">30.55±1.07</span></td>
<td id="S4.T5.7.5.5.5.8.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.5.1" class="ltx_text" style="font-size:70%;">53.39±0.85</span></td>
<td id="S4.T5.7.5.5.5.8.3.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">55.59±2.76</span></td>
<td id="S4.T5.7.5.5.5.8.3.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.7.1" class="ltx_text" style="font-size:70%;">44.43±3.46</span></td>
<td id="S4.T5.7.5.5.5.8.3.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.8.3.8.1" class="ltx_text" style="font-size:70%;">54.38±0.45</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.9.4" class="ltx_tr">
<td id="S4.T5.7.5.5.5.9.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1.0</span></td>
<td id="S4.T5.7.5.5.5.9.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10</span></td>
<td id="S4.T5.7.5.5.5.9.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.3.1" class="ltx_text" style="font-size:70%;">61.42±0.13</span></td>
<td id="S4.T5.7.5.5.5.9.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.4.1" class="ltx_text" style="font-size:70%;">63.23±0.15</span></td>
<td id="S4.T5.7.5.5.5.9.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.5.1" class="ltx_text" style="font-size:70%;">63.75±0.04</span></td>
<td id="S4.T5.7.5.5.5.9.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.6.1" class="ltx_text" style="font-size:70%;">64.67±0.06</span></td>
<td id="S4.T5.7.5.5.5.9.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.7.1" class="ltx_text" style="font-size:70%;">64.61±0.49</span></td>
<td id="S4.T5.7.5.5.5.9.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.9.4.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">65.76±0.31</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.10.5" class="ltx_tr">
<td id="S4.T5.7.5.5.5.10.5.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.10.5.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T5.7.5.5.5.10.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.3.1" class="ltx_text" style="font-size:70%;">67.37±0.08</span></td>
<td id="S4.T5.7.5.5.5.10.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.4.1" class="ltx_text" style="font-size:70%;">66.45±0.03</span></td>
<td id="S4.T5.7.5.5.5.10.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.5.1" class="ltx_text" style="font-size:70%;">68.1±0.07</span></td>
<td id="S4.T5.7.5.5.5.10.5.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.6.1" class="ltx_text" style="font-size:70%;">68.62±0.07</span></td>
<td id="S4.T5.7.5.5.5.10.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.7.1" class="ltx_text" style="font-size:70%;">67.82±0.1</span></td>
<td id="S4.T5.7.5.5.5.10.5.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.10.5.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">68.83±0.15</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.11.6" class="ltx_tr">
<td id="S4.T5.7.5.5.5.11.6.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.11.6.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T5.7.5.5.5.11.6.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.3.1" class="ltx_text" style="font-size:70%;">62.27±0.58</span></td>
<td id="S4.T5.7.5.5.5.11.6.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.4.1" class="ltx_text" style="font-size:70%;">44.15±0.11</span></td>
<td id="S4.T5.7.5.5.5.11.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.5.1" class="ltx_text" style="font-size:70%;">62.73±0.51</span></td>
<td id="S4.T5.7.5.5.5.11.6.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.6.1" class="ltx_text" style="font-size:70%;">63.69±0.43</span></td>
<td id="S4.T5.7.5.5.5.11.6.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.7.1" class="ltx_text" style="font-size:70%;">diverge</span></td>
<td id="S4.T5.7.5.5.5.11.6.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.11.6.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">63.77±0.44</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.12.7" class="ltx_tr">
<td id="S4.T5.7.5.5.5.12.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.5</span></td>
<td id="S4.T5.7.5.5.5.12.7.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10</span></td>
<td id="S4.T5.7.5.5.5.12.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.3.1" class="ltx_text" style="font-size:70%;">62.34±0.14</span></td>
<td id="S4.T5.7.5.5.5.12.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.4.1" class="ltx_text" style="font-size:70%;">67.4±0.06</span></td>
<td id="S4.T5.7.5.5.5.12.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.5.1" class="ltx_text" style="font-size:70%;">67.59±0.15</span></td>
<td id="S4.T5.7.5.5.5.12.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">68.81±0.05</span></td>
<td id="S4.T5.7.5.5.5.12.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.7.1" class="ltx_text" style="font-size:70%;">68.01±0.29</span></td>
<td id="S4.T5.7.5.5.5.12.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.12.7.8.1" class="ltx_text" style="font-size:70%;">68.45±0.50</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.13.8" class="ltx_tr">
<td id="S4.T5.7.5.5.5.13.8.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.13.8.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T5.7.5.5.5.13.8.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.3.1" class="ltx_text" style="font-size:70%;">74.92±0.08</span></td>
<td id="S4.T5.7.5.5.5.13.8.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.4.1" class="ltx_text" style="font-size:70%;">75.24±0.17</span></td>
<td id="S4.T5.7.5.5.5.13.8.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.5.1" class="ltx_text" style="font-size:70%;">76.36±0.08</span></td>
<td id="S4.T5.7.5.5.5.13.8.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">76.86±0.06</span></td>
<td id="S4.T5.7.5.5.5.13.8.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.7.1" class="ltx_text" style="font-size:70%;">76.11±0.07</span></td>
<td id="S4.T5.7.5.5.5.13.8.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.13.8.8.1" class="ltx_text" style="font-size:70%;">76.82±0.19</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.14.9" class="ltx_tr">
<td id="S4.T5.7.5.5.5.14.9.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.14.9.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T5.7.5.5.5.14.9.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.3.1" class="ltx_text" style="font-size:70%;">71.39±0.97</span></td>
<td id="S4.T5.7.5.5.5.14.9.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.4.1" class="ltx_text" style="font-size:70%;">49.81±1.98</span></td>
<td id="S4.T5.7.5.5.5.14.9.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.5.1" class="ltx_text" style="font-size:70%;">70.99±1.15</span></td>
<td id="S4.T5.7.5.5.5.14.9.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">72.74±0.51</span></td>
<td id="S4.T5.7.5.5.5.14.9.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.7.1" class="ltx_text" style="font-size:70%;">diverge</span></td>
<td id="S4.T5.7.5.5.5.14.9.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.14.9.8.1" class="ltx_text" style="font-size:70%;">72.64±0.30</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.15.10" class="ltx_tr">
<td id="S4.T5.7.5.5.5.15.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.1</span></td>
<td id="S4.T5.7.5.5.5.15.10.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10</span></td>
<td id="S4.T5.7.5.5.5.15.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.3.1" class="ltx_text" style="font-size:70%;">79.15±0.07</span></td>
<td id="S4.T5.7.5.5.5.15.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.4.1" class="ltx_text" style="font-size:70%;">78.97±0.07</span></td>
<td id="S4.T5.7.5.5.5.15.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.5.1" class="ltx_text" style="font-size:70%;">79.47±0.2</span></td>
<td id="S4.T5.7.5.5.5.15.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.6.1" class="ltx_text" style="font-size:70%;">80.24±0.09</span></td>
<td id="S4.T5.7.5.5.5.15.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">80.39±0.15</span></td>
<td id="S4.T5.7.5.5.5.15.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.7.5.5.5.15.10.8.1" class="ltx_text" style="font-size:70%;">80.28±0.07</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.5" class="ltx_tr">
<td id="S4.T5.7.5.5.5.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.5.1.1" class="ltx_text" style="font-size:50%;">(<math id="S4.T5.7.5.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T5.7.5.5.5.5.1.1.m1.1a"><mo stretchy="false" id="S4.T5.7.5.5.5.5.1.1.m1.1.1" xref="S4.T5.7.5.5.5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.7.5.5.5.5.1.1.m1.1b"><ci id="S4.T5.7.5.5.5.5.1.1.m1.1.1.cmml" xref="S4.T5.7.5.5.5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.5.5.5.5.1.1.m1.1c">\uparrow</annotation></semantics></math> heterogeneity)</span></td>
<td id="S4.T5.7.5.5.5.5.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.5.2.1" class="ltx_text" style="font-size:70%;">CIFAR-10-C</span></td>
<td id="S4.T5.7.5.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.3.1" class="ltx_text" style="font-size:70%;">87.25±0.06</span></td>
<td id="S4.T5.7.5.5.5.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.4.1" class="ltx_text" style="font-size:70%;">88.5±0.02</span></td>
<td id="S4.T5.7.5.5.5.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.5.1" class="ltx_text" style="font-size:70%;">88.6±0.1</span></td>
<td id="S4.T5.7.5.5.5.5.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.6.1" class="ltx_text" style="font-size:70%;">89.08±0.04</span></td>
<td id="S4.T5.7.5.5.5.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.7.1" class="ltx_text" style="font-size:70%;">89.14±0.13</span></td>
<td id="S4.T5.7.5.5.5.5.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.7.5.5.5.5.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">89.23±0.15</span></td>
</tr>
<tr id="S4.T5.7.5.5.5.16.11" class="ltx_tr">
<td id="S4.T5.7.5.5.5.16.11.1" class="ltx_td ltx_border_b ltx_border_l ltx_border_r"></td>
<td id="S4.T5.7.5.5.5.16.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="S4.T5.7.5.5.5.16.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.3.1" class="ltx_text" style="font-size:70%;">86.03±0.47</span></td>
<td id="S4.T5.7.5.5.5.16.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.4.1" class="ltx_text" style="font-size:70%;">69.41±1.95</span></td>
<td id="S4.T5.7.5.5.5.16.11.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.5.1" class="ltx_text" style="font-size:70%;">85.87±1.31</span></td>
<td id="S4.T5.7.5.5.5.16.11.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.6.1" class="ltx_text" style="font-size:70%;">85.78±0.6</span></td>
<td id="S4.T5.7.5.5.5.16.11.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.7.1" class="ltx_text" style="font-size:70%;">diverge</span></td>
<td id="S4.T5.7.5.5.5.16.11.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.7.5.5.5.16.11.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">86.36±0.45</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Personalizing to Different Domains</h3>

<figure id="S4.T6" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.7.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S4.T6.8.2" class="ltx_text" style="font-size:90%;">ARI values between the clustering of clients by their domains and inputs/outputs of the BNNet and LRNet.
</span></figcaption>
<div id="S4.T6.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:196.0pt;height:75.6pt;vertical-align:-35.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-65.3pt,13.3pt) scale(0.600006087750882,0.600006087750882) ;">
<table id="S4.T6.5.5.5" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T6.1.1.1.1.2.1" class="ltx_text">Dataset</span></th>
<th id="S4.T6.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T6.1.1.1.1.1.1" class="ltx_text"><math id="S4.T6.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T6.1.1.1.1.1.1.m1.1a"><mi id="S4.T6.1.1.1.1.1.1.m1.1.1" xref="S4.T6.1.1.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.1.1.1.m1.1c">\alpha</annotation></semantics></math></span></th>
<th id="S4.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">BNNet</th>
<th id="S4.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">LRNet</th>
</tr>
<tr id="S4.T6.5.5.5.5" class="ltx_tr">
<th id="S4.T6.2.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Input (<math id="S4.T6.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\xi}" display="inline"><semantics id="S4.T6.2.2.2.2.1.m1.1a"><mi id="S4.T6.2.2.2.2.1.m1.1.1" xref="S4.T6.2.2.2.2.1.m1.1.1.cmml">𝝃</mi><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.2.2.1.m1.1b"><ci id="S4.T6.2.2.2.2.1.m1.1.1.cmml" xref="S4.T6.2.2.2.2.1.m1.1.1">𝝃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.2.2.1.m1.1c">\boldsymbol{\xi}</annotation></semantics></math>)</th>
<th id="S4.T6.3.3.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Output (<math id="S4.T6.3.3.3.3.2.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.T6.3.3.3.3.2.m1.1a"><mi id="S4.T6.3.3.3.3.2.m1.1.1" xref="S4.T6.3.3.3.3.2.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.3.3.2.m1.1b"><ci id="S4.T6.3.3.3.3.2.m1.1.1.cmml" xref="S4.T6.3.3.3.3.2.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.3.3.2.m1.1c">\boldsymbol{\beta}</annotation></semantics></math>)</th>
<th id="S4.T6.4.4.4.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Input (<math id="S4.T6.4.4.4.4.3.m1.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S4.T6.4.4.4.4.3.m1.1a"><mi id="S4.T6.4.4.4.4.3.m1.1.1" xref="S4.T6.4.4.4.4.3.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.4.4.3.m1.1b"><ci id="S4.T6.4.4.4.4.3.m1.1.1.cmml" xref="S4.T6.4.4.4.4.3.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.4.4.3.m1.1c">\boldsymbol{x}</annotation></semantics></math>)</th>
<th id="S4.T6.5.5.5.5.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Output (<math id="S4.T6.5.5.5.5.4.m1.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S4.T6.5.5.5.5.4.m1.1a"><mi id="S4.T6.5.5.5.5.4.m1.1.1" xref="S4.T6.5.5.5.5.4.m1.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S4.T6.5.5.5.5.4.m1.1b"><ci id="S4.T6.5.5.5.5.4.m1.1.1.cmml" xref="S4.T6.5.5.5.5.4.m1.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.5.5.5.4.m1.1c">\boldsymbol{\eta}</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T6.5.5.5.6.1" class="ltx_tr">
<th id="S4.T6.5.5.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Caltech-10<span class="ltx_rule" style="width:0.0pt;height:10.8pt;background:black;display:inline-block;"></span>
</th>
<th id="S4.T6.5.5.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">1000</th>
<th id="S4.T6.5.5.5.6.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1.0</th>
<th id="S4.T6.5.5.5.6.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1.0</th>
<th id="S4.T6.5.5.5.6.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1.0</th>
<th id="S4.T6.5.5.5.6.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.5.5.5.7.1" class="ltx_tr">
<th id="S4.T6.5.5.5.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="4">
<span id="S4.T6.5.5.5.7.1.1.1" class="ltx_text">DomainNet</span><span class="ltx_rule" style="width:0.0pt;height:10.8pt;background:black;display:inline-block;"></span>
</th>
<th id="S4.T6.5.5.5.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1000</th>
<td id="S4.T6.5.5.5.7.1.3" class="ltx_td ltx_align_center ltx_border_t">0.65</td>
<td id="S4.T6.5.5.5.7.1.4" class="ltx_td ltx_align_center ltx_border_t">0.64</td>
<td id="S4.T6.5.5.5.7.1.5" class="ltx_td ltx_align_center ltx_border_t">0.76</td>
<td id="S4.T6.5.5.5.7.1.6" class="ltx_td ltx_align_center ltx_border_t">0.77</td>
</tr>
<tr id="S4.T6.5.5.5.8.2" class="ltx_tr">
<th id="S4.T6.5.5.5.8.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">1.0</th>
<td id="S4.T6.5.5.5.8.2.2" class="ltx_td ltx_align_center">0.70</td>
<td id="S4.T6.5.5.5.8.2.3" class="ltx_td ltx_align_center">0.59</td>
<td id="S4.T6.5.5.5.8.2.4" class="ltx_td ltx_align_center">0.77</td>
<td id="S4.T6.5.5.5.8.2.5" class="ltx_td ltx_align_center">0.74</td>
</tr>
<tr id="S4.T6.5.5.5.9.3" class="ltx_tr">
<th id="S4.T6.5.5.5.9.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.5</th>
<td id="S4.T6.5.5.5.9.3.2" class="ltx_td ltx_align_center">0.52</td>
<td id="S4.T6.5.5.5.9.3.3" class="ltx_td ltx_align_center">0.53</td>
<td id="S4.T6.5.5.5.9.3.4" class="ltx_td ltx_align_center">0.72</td>
<td id="S4.T6.5.5.5.9.3.5" class="ltx_td ltx_align_center">0.63</td>
</tr>
<tr id="S4.T6.5.5.5.10.4" class="ltx_tr">
<th id="S4.T6.5.5.5.10.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">0.1</th>
<td id="S4.T6.5.5.5.10.4.2" class="ltx_td ltx_align_center ltx_border_bb">0.27</td>
<td id="S4.T6.5.5.5.10.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.52</td>
<td id="S4.T6.5.5.5.10.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.65</td>
<td id="S4.T6.5.5.5.10.4.5" class="ltx_td ltx_align_center ltx_border_bb">0.59</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We evaluate our method on Office-Caltech-10 and DomainNet datasets commonly used in domain generalization/adaptation, which exhibit both marginal and conditional feature shifts. Differing from the conventional FL setup, we adopted a pretrained model trained using ImageNet <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a href="#bib.bib13" title="" class="ltx_ref">2009</a>)</cite> and attached a prediction head as our global model.
Similar to CIFAR-10-C experiments, we compare our method with the baselines in Table. <a href="#S4.T3" title="Table 3 ‣ 4.3 Personalizing to Unseen Clients ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Unlike CIFAR-10/10-C, Office-Caltech-10 and DomainNet consist of images from distinct domains and adapting to these domain result in a model sparsity of 0 as shown in Fig. <a href="#S4.F2.sf3" title="Figure 2(c) ‣ Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a> and Fig. <a href="#S4.F2.sf4" title="Figure 2(d) ‣ Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(d)</span></a>. Hence, a better personalization performance is achieved using the client’s own local BN statistics (<span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">BN C</span>) or the incoming batch statistics (<span id="S4.SS4.p1.1.2" class="ltx_text ltx_font_bold">BN I</span>) than the pretrained model’s (<span id="S4.SS4.p1.1.3" class="ltx_text ltx_font_bold">BN G</span>). Lastly, each client’s personalized model uses an extent of the pretrained natural image statistics as well as its own domain statistics, for both datasets.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.14" class="ltx_p"><span id="S4.SS4.p2.14.1" class="ltx_text ltx_font_bold">Further Analysis</span> To further investigate how well the hyperparameters returned by our FedL2P-trained meta-nets capture the domain-specific information, we analyze the clustering of local features, namely <math id="S4.SS4.p2.1.m1.3" class="ltx_Math" alttext="\boldsymbol{\xi}=(\xi_{1},\ldots,\xi_{B})" display="inline"><semantics id="S4.SS4.p2.1.m1.3a"><mrow id="S4.SS4.p2.1.m1.3.3" xref="S4.SS4.p2.1.m1.3.3.cmml"><mi id="S4.SS4.p2.1.m1.3.3.4" xref="S4.SS4.p2.1.m1.3.3.4.cmml">𝝃</mi><mo id="S4.SS4.p2.1.m1.3.3.3" xref="S4.SS4.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S4.SS4.p2.1.m1.3.3.2.2" xref="S4.SS4.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS4.p2.1.m1.3.3.2.2.3" xref="S4.SS4.p2.1.m1.3.3.2.3.cmml">(</mo><msub id="S4.SS4.p2.1.m1.2.2.1.1.1" xref="S4.SS4.p2.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.2.2.1.1.1.2" xref="S4.SS4.p2.1.m1.2.2.1.1.1.2.cmml">ξ</mi><mn id="S4.SS4.p2.1.m1.2.2.1.1.1.3" xref="S4.SS4.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS4.p2.1.m1.3.3.2.2.4" xref="S4.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">…</mi><mo id="S4.SS4.p2.1.m1.3.3.2.2.5" xref="S4.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.SS4.p2.1.m1.3.3.2.2.2" xref="S4.SS4.p2.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS4.p2.1.m1.3.3.2.2.2.2" xref="S4.SS4.p2.1.m1.3.3.2.2.2.2.cmml">ξ</mi><mi id="S4.SS4.p2.1.m1.3.3.2.2.2.3" xref="S4.SS4.p2.1.m1.3.3.2.2.2.3.cmml">B</mi></msub><mo stretchy="false" id="S4.SS4.p2.1.m1.3.3.2.2.6" xref="S4.SS4.p2.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.3b"><apply id="S4.SS4.p2.1.m1.3.3.cmml" xref="S4.SS4.p2.1.m1.3.3"><eq id="S4.SS4.p2.1.m1.3.3.3.cmml" xref="S4.SS4.p2.1.m1.3.3.3"></eq><ci id="S4.SS4.p2.1.m1.3.3.4.cmml" xref="S4.SS4.p2.1.m1.3.3.4">𝝃</ci><vector id="S4.SS4.p2.1.m1.3.3.2.3.cmml" xref="S4.SS4.p2.1.m1.3.3.2.2"><apply id="S4.SS4.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.2.2.1.1.1.2">𝜉</ci><cn type="integer" id="S4.SS4.p2.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">…</ci><apply id="S4.SS4.p2.1.m1.3.3.2.2.2.cmml" xref="S4.SS4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS4.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS4.p2.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS4.p2.1.m1.3.3.2.2.2.2">𝜉</ci><ci id="S4.SS4.p2.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS4.p2.1.m1.3.3.2.2.2.3">𝐵</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.3c">\boldsymbol{\xi}=(\xi_{1},\ldots,\xi_{B})</annotation></semantics></math> and <math id="S4.SS4.p2.2.m2.5" class="ltx_Math" alttext="\boldsymbol{x}=(E(x_{0}),SD(x_{0}),\ldots,E(x_{M-1}),SD(x_{M-1}))" display="inline"><semantics id="S4.SS4.p2.2.m2.5a"><mrow id="S4.SS4.p2.2.m2.5.5" xref="S4.SS4.p2.2.m2.5.5.cmml"><mi id="S4.SS4.p2.2.m2.5.5.6" xref="S4.SS4.p2.2.m2.5.5.6.cmml">𝒙</mi><mo id="S4.SS4.p2.2.m2.5.5.5" xref="S4.SS4.p2.2.m2.5.5.5.cmml">=</mo><mrow id="S4.SS4.p2.2.m2.5.5.4.4" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml"><mo stretchy="false" id="S4.SS4.p2.2.m2.5.5.4.4.5" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">(</mo><mrow id="S4.SS4.p2.2.m2.2.2.1.1.1" xref="S4.SS4.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS4.p2.2.m2.2.2.1.1.1.3" xref="S4.SS4.p2.2.m2.2.2.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.2.2.1.1.1.2" xref="S4.SS4.p2.2.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.2" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mn id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.3" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p2.2.m2.5.5.4.4.6" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">,</mo><mrow id="S4.SS4.p2.2.m2.3.3.2.2.2" xref="S4.SS4.p2.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS4.p2.2.m2.3.3.2.2.2.3" xref="S4.SS4.p2.2.m2.3.3.2.2.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.3.3.2.2.2.2" xref="S4.SS4.p2.2.m2.3.3.2.2.2.2.cmml">​</mo><mi id="S4.SS4.p2.2.m2.3.3.2.2.2.4" xref="S4.SS4.p2.2.m2.3.3.2.2.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.3.3.2.2.2.2a" xref="S4.SS4.p2.2.m2.3.3.2.2.2.2.cmml">​</mo><mrow id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.2" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.cmml"><mi id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.2" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.2.cmml">x</mi><mn id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.3" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.3" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p2.2.m2.5.5.4.4.7" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">,</mo><mi mathvariant="normal" id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">…</mi><mo id="S4.SS4.p2.2.m2.5.5.4.4.8" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">,</mo><mrow id="S4.SS4.p2.2.m2.4.4.3.3.3" xref="S4.SS4.p2.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS4.p2.2.m2.4.4.3.3.3.3" xref="S4.SS4.p2.2.m2.4.4.3.3.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.4.4.3.3.3.2" xref="S4.SS4.p2.2.m2.4.4.3.3.3.2.cmml">​</mo><mrow id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.2" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.cmml"><mi id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.2" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.2.cmml">x</mi><mrow id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.cmml"><mi id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.2" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.2.cmml">M</mi><mo id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.1" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.1.cmml">−</mo><mn id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.3" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.3" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p2.2.m2.5.5.4.4.9" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">,</mo><mrow id="S4.SS4.p2.2.m2.5.5.4.4.4" xref="S4.SS4.p2.2.m2.5.5.4.4.4.cmml"><mi id="S4.SS4.p2.2.m2.5.5.4.4.4.3" xref="S4.SS4.p2.2.m2.5.5.4.4.4.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.5.5.4.4.4.2" xref="S4.SS4.p2.2.m2.5.5.4.4.4.2.cmml">​</mo><mi id="S4.SS4.p2.2.m2.5.5.4.4.4.4" xref="S4.SS4.p2.2.m2.5.5.4.4.4.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.2.m2.5.5.4.4.4.2a" xref="S4.SS4.p2.2.m2.5.5.4.4.4.2.cmml">​</mo><mrow id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.2" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.cmml">(</mo><msub id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.cmml"><mi id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.2" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.2.cmml">x</mi><mrow id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.cmml"><mi id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.2" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.2.cmml">M</mi><mo id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.1" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.1.cmml">−</mo><mn id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.3" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.3" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS4.p2.2.m2.5.5.4.4.10" xref="S4.SS4.p2.2.m2.5.5.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.5b"><apply id="S4.SS4.p2.2.m2.5.5.cmml" xref="S4.SS4.p2.2.m2.5.5"><eq id="S4.SS4.p2.2.m2.5.5.5.cmml" xref="S4.SS4.p2.2.m2.5.5.5"></eq><ci id="S4.SS4.p2.2.m2.5.5.6.cmml" xref="S4.SS4.p2.2.m2.5.5.6">𝒙</ci><vector id="S4.SS4.p2.2.m2.5.5.4.5.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4"><apply id="S4.SS4.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1"><times id="S4.SS4.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.2"></times><ci id="S4.SS4.p2.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.3">𝐸</ci><apply id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="S4.SS4.p2.2.m2.3.3.2.2.2.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2"><times id="S4.SS4.p2.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.2"></times><ci id="S4.SS4.p2.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.3">𝑆</ci><ci id="S4.SS4.p2.2.m2.3.3.2.2.2.4.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.4">𝐷</ci><apply id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.1.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.2.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.3.cmml" xref="S4.SS4.p2.2.m2.3.3.2.2.2.1.1.1.3">0</cn></apply></apply><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">…</ci><apply id="S4.SS4.p2.2.m2.4.4.3.3.3.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3"><times id="S4.SS4.p2.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.2"></times><ci id="S4.SS4.p2.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.3">𝐸</ci><apply id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.1.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.2.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.2">𝑥</ci><apply id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3"><minus id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.1"></minus><ci id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.2.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.2">𝑀</ci><cn type="integer" id="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.3.cmml" xref="S4.SS4.p2.2.m2.4.4.3.3.3.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.SS4.p2.2.m2.5.5.4.4.4.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4"><times id="S4.SS4.p2.2.m2.5.5.4.4.4.2.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.2"></times><ci id="S4.SS4.p2.2.m2.5.5.4.4.4.3.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.3">𝑆</ci><ci id="S4.SS4.p2.2.m2.5.5.4.4.4.4.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.4">𝐷</ci><apply id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.1.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.2.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.2">𝑥</ci><apply id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3"><minus id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.1"></minus><ci id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.2.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.2">𝑀</ci><cn type="integer" id="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.3.cmml" xref="S4.SS4.p2.2.m2.5.5.4.4.4.1.1.1.3.3">1</cn></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.5c">\boldsymbol{x}=(E(x_{0}),SD(x_{0}),\ldots,E(x_{M-1}),SD(x_{M-1}))</annotation></semantics></math> (i.e., the inputs to the meta-nets), and the resulting respective hyperparameters, <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">\boldsymbol{\beta}</annotation></semantics></math> and <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">\boldsymbol{\eta}</annotation></semantics></math> (i.e., outputs of the meta-nets), among clients. Specifically, we compute the similarity matrix using the Euclidean distance between the features/hyperparameters of any two clients and perform spectral clustering<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>
We use the default parameters for spectral clustering from <span id="footnote6.1" class="ltx_text ltx_font_typewriter">scikit-learn</span> <cite class="ltx_cite ltx_citemacro_cite">Pedregosa et al. (<a href="#bib.bib50" title="" class="ltx_ref">2011</a>)</cite>.
</span></span></span>, using the discretization approach proposed in <cite class="ltx_cite ltx_citemacro_cite">Stella and Shi (<a href="#bib.bib58" title="" class="ltx_ref">2003</a>)</cite> to assign labels on the normalized Laplacian embedding. We then compute the <span id="S4.SS4.p2.14.2" class="ltx_text ltx_font_italic">Adjusted Rand Index</span> (ARI) <cite class="ltx_cite ltx_citemacro_cite">Hubert and Arabie (<a href="#bib.bib25" title="" class="ltx_ref">1985</a>)</cite> between the estimated clusters and the clusters partitioned by the different data domains as shown in Table. <a href="#S4.T6" title="Table 6 ‣ 4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
We also visualize the alignment between the estimated clusters and the true domains in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, where each block <math id="S4.SS4.p2.5.m5.2" class="ltx_Math" alttext="(j,k)" display="inline"><semantics id="S4.SS4.p2.5.m5.2a"><mrow id="S4.SS4.p2.5.m5.2.3.2" xref="S4.SS4.p2.5.m5.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p2.5.m5.2.3.2.1" xref="S4.SS4.p2.5.m5.2.3.1.cmml">(</mo><mi id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">j</mi><mo id="S4.SS4.p2.5.m5.2.3.2.2" xref="S4.SS4.p2.5.m5.2.3.1.cmml">,</mo><mi id="S4.SS4.p2.5.m5.2.2" xref="S4.SS4.p2.5.m5.2.2.cmml">k</mi><mo stretchy="false" id="S4.SS4.p2.5.m5.2.3.2.3" xref="S4.SS4.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.2b"><interval closure="open" id="S4.SS4.p2.5.m5.2.3.1.cmml" xref="S4.SS4.p2.5.m5.2.3.2"><ci id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">𝑗</ci><ci id="S4.SS4.p2.5.m5.2.2.cmml" xref="S4.SS4.p2.5.m5.2.2">𝑘</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.2c">(j,k)</annotation></semantics></math> represents the <span id="S4.SS4.p2.14.3" class="ltx_text ltx_font_italic">normalized</span> average Euclidean distance between all pairs of clients in domain <math id="S4.SS4.p2.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS4.p2.6.m6.1a"><mi id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><ci id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">j</annotation></semantics></math> and <math id="S4.SS4.p2.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.p2.7.m7.1a"><mi id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><ci id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">k</annotation></semantics></math>. Specifically, we divide the mean distance between domain <math id="S4.SS4.p2.8.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS4.p2.8.m8.1a"><mi id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><ci id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">j</annotation></semantics></math> and <math id="S4.SS4.p2.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.p2.9.m9.1a"><mi id="S4.SS4.p2.9.m9.1.1" xref="S4.SS4.p2.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m9.1b"><ci id="S4.SS4.p2.9.m9.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.9.m9.1c">k</annotation></semantics></math> by the within-domain mean distances and take the log scale for better visualization: <math id="S4.SS4.p2.10.m10.7" class="ltx_Math" alttext="\log(\frac{d(j,k)}{\sqrt{d(j,j)}\sqrt{d(k,k)}})" display="inline"><semantics id="S4.SS4.p2.10.m10.7a"><mrow id="S4.SS4.p2.10.m10.7.8.2" xref="S4.SS4.p2.10.m10.7.8.1.cmml"><mi id="S4.SS4.p2.10.m10.7.7" xref="S4.SS4.p2.10.m10.7.7.cmml">log</mi><mo id="S4.SS4.p2.10.m10.7.8.2a" xref="S4.SS4.p2.10.m10.7.8.1.cmml">⁡</mo><mrow id="S4.SS4.p2.10.m10.7.8.2.1" xref="S4.SS4.p2.10.m10.7.8.1.cmml"><mo stretchy="false" id="S4.SS4.p2.10.m10.7.8.2.1.1" xref="S4.SS4.p2.10.m10.7.8.1.cmml">(</mo><mfrac id="S4.SS4.p2.10.m10.6.6" xref="S4.SS4.p2.10.m10.6.6.cmml"><mrow id="S4.SS4.p2.10.m10.2.2.2" xref="S4.SS4.p2.10.m10.2.2.2.cmml"><mi id="S4.SS4.p2.10.m10.2.2.2.4" xref="S4.SS4.p2.10.m10.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.10.m10.2.2.2.3" xref="S4.SS4.p2.10.m10.2.2.2.3.cmml">​</mo><mrow id="S4.SS4.p2.10.m10.2.2.2.5.2" xref="S4.SS4.p2.10.m10.2.2.2.5.1.cmml"><mo stretchy="false" id="S4.SS4.p2.10.m10.2.2.2.5.2.1" xref="S4.SS4.p2.10.m10.2.2.2.5.1.cmml">(</mo><mi id="S4.SS4.p2.10.m10.1.1.1.1" xref="S4.SS4.p2.10.m10.1.1.1.1.cmml">j</mi><mo id="S4.SS4.p2.10.m10.2.2.2.5.2.2" xref="S4.SS4.p2.10.m10.2.2.2.5.1.cmml">,</mo><mi id="S4.SS4.p2.10.m10.2.2.2.2" xref="S4.SS4.p2.10.m10.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S4.SS4.p2.10.m10.2.2.2.5.2.3" xref="S4.SS4.p2.10.m10.2.2.2.5.1.cmml">)</mo></mrow></mrow><mrow id="S4.SS4.p2.10.m10.6.6.6" xref="S4.SS4.p2.10.m10.6.6.6.cmml"><msqrt id="S4.SS4.p2.10.m10.4.4.4.2" xref="S4.SS4.p2.10.m10.4.4.4.2.cmml"><mrow id="S4.SS4.p2.10.m10.4.4.4.2.2" xref="S4.SS4.p2.10.m10.4.4.4.2.2.cmml"><mi id="S4.SS4.p2.10.m10.4.4.4.2.2.4" xref="S4.SS4.p2.10.m10.4.4.4.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.10.m10.4.4.4.2.2.3" xref="S4.SS4.p2.10.m10.4.4.4.2.2.3.cmml">​</mo><mrow id="S4.SS4.p2.10.m10.4.4.4.2.2.5.2" xref="S4.SS4.p2.10.m10.4.4.4.2.2.5.1.cmml"><mo stretchy="false" id="S4.SS4.p2.10.m10.4.4.4.2.2.5.2.1" xref="S4.SS4.p2.10.m10.4.4.4.2.2.5.1.cmml">(</mo><mi id="S4.SS4.p2.10.m10.3.3.3.1.1.1" xref="S4.SS4.p2.10.m10.3.3.3.1.1.1.cmml">j</mi><mo id="S4.SS4.p2.10.m10.4.4.4.2.2.5.2.2" xref="S4.SS4.p2.10.m10.4.4.4.2.2.5.1.cmml">,</mo><mi id="S4.SS4.p2.10.m10.4.4.4.2.2.2" xref="S4.SS4.p2.10.m10.4.4.4.2.2.2.cmml">j</mi><mo stretchy="false" id="S4.SS4.p2.10.m10.4.4.4.2.2.5.2.3" xref="S4.SS4.p2.10.m10.4.4.4.2.2.5.1.cmml">)</mo></mrow></mrow></msqrt><mo lspace="0em" rspace="0em" id="S4.SS4.p2.10.m10.6.6.6.5" xref="S4.SS4.p2.10.m10.6.6.6.5.cmml">​</mo><msqrt id="S4.SS4.p2.10.m10.6.6.6.4" xref="S4.SS4.p2.10.m10.6.6.6.4.cmml"><mrow id="S4.SS4.p2.10.m10.6.6.6.4.2" xref="S4.SS4.p2.10.m10.6.6.6.4.2.cmml"><mi id="S4.SS4.p2.10.m10.6.6.6.4.2.4" xref="S4.SS4.p2.10.m10.6.6.6.4.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.10.m10.6.6.6.4.2.3" xref="S4.SS4.p2.10.m10.6.6.6.4.2.3.cmml">​</mo><mrow id="S4.SS4.p2.10.m10.6.6.6.4.2.5.2" xref="S4.SS4.p2.10.m10.6.6.6.4.2.5.1.cmml"><mo stretchy="false" id="S4.SS4.p2.10.m10.6.6.6.4.2.5.2.1" xref="S4.SS4.p2.10.m10.6.6.6.4.2.5.1.cmml">(</mo><mi id="S4.SS4.p2.10.m10.5.5.5.3.1.1" xref="S4.SS4.p2.10.m10.5.5.5.3.1.1.cmml">k</mi><mo id="S4.SS4.p2.10.m10.6.6.6.4.2.5.2.2" xref="S4.SS4.p2.10.m10.6.6.6.4.2.5.1.cmml">,</mo><mi id="S4.SS4.p2.10.m10.6.6.6.4.2.2" xref="S4.SS4.p2.10.m10.6.6.6.4.2.2.cmml">k</mi><mo stretchy="false" id="S4.SS4.p2.10.m10.6.6.6.4.2.5.2.3" xref="S4.SS4.p2.10.m10.6.6.6.4.2.5.1.cmml">)</mo></mrow></mrow></msqrt></mrow></mfrac><mo stretchy="false" id="S4.SS4.p2.10.m10.7.8.2.1.2" xref="S4.SS4.p2.10.m10.7.8.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.10.m10.7b"><apply id="S4.SS4.p2.10.m10.7.8.1.cmml" xref="S4.SS4.p2.10.m10.7.8.2"><log id="S4.SS4.p2.10.m10.7.7.cmml" xref="S4.SS4.p2.10.m10.7.7"></log><apply id="S4.SS4.p2.10.m10.6.6.cmml" xref="S4.SS4.p2.10.m10.6.6"><divide id="S4.SS4.p2.10.m10.6.6.7.cmml" xref="S4.SS4.p2.10.m10.6.6"></divide><apply id="S4.SS4.p2.10.m10.2.2.2.cmml" xref="S4.SS4.p2.10.m10.2.2.2"><times id="S4.SS4.p2.10.m10.2.2.2.3.cmml" xref="S4.SS4.p2.10.m10.2.2.2.3"></times><ci id="S4.SS4.p2.10.m10.2.2.2.4.cmml" xref="S4.SS4.p2.10.m10.2.2.2.4">𝑑</ci><interval closure="open" id="S4.SS4.p2.10.m10.2.2.2.5.1.cmml" xref="S4.SS4.p2.10.m10.2.2.2.5.2"><ci id="S4.SS4.p2.10.m10.1.1.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1.1.1">𝑗</ci><ci id="S4.SS4.p2.10.m10.2.2.2.2.cmml" xref="S4.SS4.p2.10.m10.2.2.2.2">𝑘</ci></interval></apply><apply id="S4.SS4.p2.10.m10.6.6.6.cmml" xref="S4.SS4.p2.10.m10.6.6.6"><times id="S4.SS4.p2.10.m10.6.6.6.5.cmml" xref="S4.SS4.p2.10.m10.6.6.6.5"></times><apply id="S4.SS4.p2.10.m10.4.4.4.2.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2"><root id="S4.SS4.p2.10.m10.4.4.4.2a.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2"></root><apply id="S4.SS4.p2.10.m10.4.4.4.2.2.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2.2"><times id="S4.SS4.p2.10.m10.4.4.4.2.2.3.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2.2.3"></times><ci id="S4.SS4.p2.10.m10.4.4.4.2.2.4.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2.2.4">𝑑</ci><interval closure="open" id="S4.SS4.p2.10.m10.4.4.4.2.2.5.1.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2.2.5.2"><ci id="S4.SS4.p2.10.m10.3.3.3.1.1.1.cmml" xref="S4.SS4.p2.10.m10.3.3.3.1.1.1">𝑗</ci><ci id="S4.SS4.p2.10.m10.4.4.4.2.2.2.cmml" xref="S4.SS4.p2.10.m10.4.4.4.2.2.2">𝑗</ci></interval></apply></apply><apply id="S4.SS4.p2.10.m10.6.6.6.4.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4"><root id="S4.SS4.p2.10.m10.6.6.6.4a.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4"></root><apply id="S4.SS4.p2.10.m10.6.6.6.4.2.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4.2"><times id="S4.SS4.p2.10.m10.6.6.6.4.2.3.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4.2.3"></times><ci id="S4.SS4.p2.10.m10.6.6.6.4.2.4.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4.2.4">𝑑</ci><interval closure="open" id="S4.SS4.p2.10.m10.6.6.6.4.2.5.1.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4.2.5.2"><ci id="S4.SS4.p2.10.m10.5.5.5.3.1.1.cmml" xref="S4.SS4.p2.10.m10.5.5.5.3.1.1">𝑘</ci><ci id="S4.SS4.p2.10.m10.6.6.6.4.2.2.cmml" xref="S4.SS4.p2.10.m10.6.6.6.4.2.2">𝑘</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.10.m10.7c">\log(\frac{d(j,k)}{\sqrt{d(j,j)}\sqrt{d(k,k)}})</annotation></semantics></math> where <math id="S4.SS4.p2.11.m11.2" class="ltx_Math" alttext="d(j,k)" display="inline"><semantics id="S4.SS4.p2.11.m11.2a"><mrow id="S4.SS4.p2.11.m11.2.3" xref="S4.SS4.p2.11.m11.2.3.cmml"><mi id="S4.SS4.p2.11.m11.2.3.2" xref="S4.SS4.p2.11.m11.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p2.11.m11.2.3.1" xref="S4.SS4.p2.11.m11.2.3.1.cmml">​</mo><mrow id="S4.SS4.p2.11.m11.2.3.3.2" xref="S4.SS4.p2.11.m11.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.p2.11.m11.2.3.3.2.1" xref="S4.SS4.p2.11.m11.2.3.3.1.cmml">(</mo><mi id="S4.SS4.p2.11.m11.1.1" xref="S4.SS4.p2.11.m11.1.1.cmml">j</mi><mo id="S4.SS4.p2.11.m11.2.3.3.2.2" xref="S4.SS4.p2.11.m11.2.3.3.1.cmml">,</mo><mi id="S4.SS4.p2.11.m11.2.2" xref="S4.SS4.p2.11.m11.2.2.cmml">k</mi><mo stretchy="false" id="S4.SS4.p2.11.m11.2.3.3.2.3" xref="S4.SS4.p2.11.m11.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.11.m11.2b"><apply id="S4.SS4.p2.11.m11.2.3.cmml" xref="S4.SS4.p2.11.m11.2.3"><times id="S4.SS4.p2.11.m11.2.3.1.cmml" xref="S4.SS4.p2.11.m11.2.3.1"></times><ci id="S4.SS4.p2.11.m11.2.3.2.cmml" xref="S4.SS4.p2.11.m11.2.3.2">𝑑</ci><interval closure="open" id="S4.SS4.p2.11.m11.2.3.3.1.cmml" xref="S4.SS4.p2.11.m11.2.3.3.2"><ci id="S4.SS4.p2.11.m11.1.1.cmml" xref="S4.SS4.p2.11.m11.1.1">𝑗</ci><ci id="S4.SS4.p2.11.m11.2.2.cmml" xref="S4.SS4.p2.11.m11.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.11.m11.2c">d(j,k)</annotation></semantics></math> is the mean Euclidean distance between <math id="S4.SS4.p2.12.m12.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS4.p2.12.m12.1a"><mi id="S4.SS4.p2.12.m12.1.1" xref="S4.SS4.p2.12.m12.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.12.m12.1b"><ci id="S4.SS4.p2.12.m12.1.1.cmml" xref="S4.SS4.p2.12.m12.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.12.m12.1c">j</annotation></semantics></math> and <math id="S4.SS4.p2.13.m13.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.p2.13.m13.1a"><mi id="S4.SS4.p2.13.m13.1.1" xref="S4.SS4.p2.13.m13.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.13.m13.1b"><ci id="S4.SS4.p2.13.m13.1.1.cmml" xref="S4.SS4.p2.13.m13.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.13.m13.1c">k</annotation></semantics></math>. Thus, a random clustering has distance close to 0 and <math id="S4.SS4.p2.14.m14.1" class="ltx_Math" alttext="&gt;0" display="inline"><semantics id="S4.SS4.p2.14.m14.1a"><mrow id="S4.SS4.p2.14.m14.1.1" xref="S4.SS4.p2.14.m14.1.1.cmml"><mi id="S4.SS4.p2.14.m14.1.1.2" xref="S4.SS4.p2.14.m14.1.1.2.cmml"></mi><mo id="S4.SS4.p2.14.m14.1.1.1" xref="S4.SS4.p2.14.m14.1.1.1.cmml">&gt;</mo><mn id="S4.SS4.p2.14.m14.1.1.3" xref="S4.SS4.p2.14.m14.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.14.m14.1b"><apply id="S4.SS4.p2.14.m14.1.1.cmml" xref="S4.SS4.p2.14.m14.1.1"><gt id="S4.SS4.p2.14.m14.1.1.1.cmml" xref="S4.SS4.p2.14.m14.1.1.1"></gt><csymbol cd="latexml" id="S4.SS4.p2.14.m14.1.1.2.cmml" xref="S4.SS4.p2.14.m14.1.1.2">absent</csymbol><cn type="integer" id="S4.SS4.p2.14.m14.1.1.3.cmml" xref="S4.SS4.p2.14.m14.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.14.m14.1c">&gt;0</annotation></semantics></math> indicates better alignment between the clustering and the true domains.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x6.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="332" height="142" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Office-Caltech-10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x7.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="332" height="142" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.2.1" class="ltx_text" style="font-size:90%;">DomainNet (<math id="S4.F3.sf2.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.F3.sf2.2.1.m1.1b"><mrow id="S4.F3.sf2.2.1.m1.1.1" xref="S4.F3.sf2.2.1.m1.1.1.cmml"><mi id="S4.F3.sf2.2.1.m1.1.1.2" xref="S4.F3.sf2.2.1.m1.1.1.2.cmml">α</mi><mo id="S4.F3.sf2.2.1.m1.1.1.1" xref="S4.F3.sf2.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.F3.sf2.2.1.m1.1.1.3" xref="S4.F3.sf2.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf2.2.1.m1.1c"><apply id="S4.F3.sf2.2.1.m1.1.1.cmml" xref="S4.F3.sf2.2.1.m1.1.1"><eq id="S4.F3.sf2.2.1.m1.1.1.1.cmml" xref="S4.F3.sf2.2.1.m1.1.1.1"></eq><ci id="S4.F3.sf2.2.1.m1.1.1.2.cmml" xref="S4.F3.sf2.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F3.sf2.2.1.m1.1.1.3.cmml" xref="S4.F3.sf2.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf2.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.15.7.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.12.6" class="ltx_text" style="font-size:90%;">
Cluster distance maps.
Each block represents <span id="S4.F3.12.6.1" class="ltx_text ltx_font_italic">normalized</span> distance, where the distance of the block <math id="S4.F3.7.1.m1.2" class="ltx_Math" alttext="(j,k)" display="inline"><semantics id="S4.F3.7.1.m1.2b"><mrow id="S4.F3.7.1.m1.2.3.2" xref="S4.F3.7.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.F3.7.1.m1.2.3.2.1" xref="S4.F3.7.1.m1.2.3.1.cmml">(</mo><mi id="S4.F3.7.1.m1.1.1" xref="S4.F3.7.1.m1.1.1.cmml">j</mi><mo id="S4.F3.7.1.m1.2.3.2.2" xref="S4.F3.7.1.m1.2.3.1.cmml">,</mo><mi id="S4.F3.7.1.m1.2.2" xref="S4.F3.7.1.m1.2.2.cmml">k</mi><mo stretchy="false" id="S4.F3.7.1.m1.2.3.2.3" xref="S4.F3.7.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.7.1.m1.2c"><interval closure="open" id="S4.F3.7.1.m1.2.3.1.cmml" xref="S4.F3.7.1.m1.2.3.2"><ci id="S4.F3.7.1.m1.1.1.cmml" xref="S4.F3.7.1.m1.1.1">𝑗</ci><ci id="S4.F3.7.1.m1.2.2.cmml" xref="S4.F3.7.1.m1.2.2">𝑘</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.1.m1.2d">(j,k)</annotation></semantics></math> is measured as the average of the Euclidean distances between all pairs of clients’ <math id="S4.F3.8.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.F3.8.2.m2.1b"><mi id="S4.F3.8.2.m2.1.1" xref="S4.F3.8.2.m2.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.F3.8.2.m2.1c"><ci id="S4.F3.8.2.m2.1.1.cmml" xref="S4.F3.8.2.m2.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.2.m2.1d">\boldsymbol{\beta}</annotation></semantics></math> that belong to domain <math id="S4.F3.9.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.F3.9.3.m3.1b"><mi id="S4.F3.9.3.m3.1.1" xref="S4.F3.9.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.F3.9.3.m3.1c"><ci id="S4.F3.9.3.m3.1.1.cmml" xref="S4.F3.9.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.9.3.m3.1d">j</annotation></semantics></math> and domain <math id="S4.F3.10.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.F3.10.4.m4.1b"><mi id="S4.F3.10.4.m4.1.1" xref="S4.F3.10.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.F3.10.4.m4.1c"><ci id="S4.F3.10.4.m4.1.1.cmml" xref="S4.F3.10.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.10.4.m4.1d">k</annotation></semantics></math> (similarly for <math id="S4.F3.11.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="S4.F3.11.5.m5.1b"><mi id="S4.F3.11.5.m5.1.1" xref="S4.F3.11.5.m5.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="S4.F3.11.5.m5.1c"><ci id="S4.F3.11.5.m5.1.1.cmml" xref="S4.F3.11.5.m5.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.11.5.m5.1d">\boldsymbol{\eta}</annotation></semantics></math>’s), normalized by the within-domain distance (see text).
An off-diagonal block <math id="S4.F3.12.6.m6.1" class="ltx_Math" alttext="&gt;0" display="inline"><semantics id="S4.F3.12.6.m6.1b"><mrow id="S4.F3.12.6.m6.1.1" xref="S4.F3.12.6.m6.1.1.cmml"><mi id="S4.F3.12.6.m6.1.1.2" xref="S4.F3.12.6.m6.1.1.2.cmml"></mi><mo id="S4.F3.12.6.m6.1.1.1" xref="S4.F3.12.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.F3.12.6.m6.1.1.3" xref="S4.F3.12.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.12.6.m6.1c"><apply id="S4.F3.12.6.m6.1.1.cmml" xref="S4.F3.12.6.m6.1.1"><gt id="S4.F3.12.6.m6.1.1.1.cmml" xref="S4.F3.12.6.m6.1.1.1"></gt><csymbol cd="latexml" id="S4.F3.12.6.m6.1.1.2.cmml" xref="S4.F3.12.6.m6.1.1.2">absent</csymbol><cn type="integer" id="S4.F3.12.6.m6.1.1.3.cmml" xref="S4.F3.12.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.12.6.m6.1d">&gt;0</annotation></semantics></math> indicates that the corresponding clusters are better aligned with the true domains.
</span></figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.3" class="ltx_p">As shown, for DomainNet, both BNNet and LRNet consistently preserve the cluster information found in their inputs, <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\xi}" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><mi id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">𝝃</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><ci id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">𝝃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\boldsymbol{\xi}</annotation></semantics></math> &amp; <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\boldsymbol{x}</annotation></semantics></math>, respectively. However, perfect clustering is not achieved due to the inherent difficulty. For instance, the <span id="S4.SS4.p3.3.1" class="ltx_text ltx_font_italic">real</span> and <span id="S4.SS4.p3.3.2" class="ltx_text ltx_font_italic">painting</span> domains share similar features, resulting in similar hyperparameters; the cross-domain distance between <span id="S4.SS4.p3.3.3" class="ltx_text ltx_font_italic">real</span> and <span id="S4.SS4.p3.3.4" class="ltx_text ltx_font_italic">painting</span> is <math id="S4.SS4.p3.3.m3.1" class="ltx_Math" alttext="\sim 0" display="inline"><semantics id="S4.SS4.p3.3.m3.1a"><mrow id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml"><mi id="S4.SS4.p3.3.m3.1.1.2" xref="S4.SS4.p3.3.m3.1.1.2.cmml"></mi><mo id="S4.SS4.p3.3.m3.1.1.1" xref="S4.SS4.p3.3.m3.1.1.1.cmml">∼</mo><mn id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS4.p3.3.m3.1.1.2.cmml" xref="S4.SS4.p3.3.m3.1.1.2">absent</csymbol><cn type="integer" id="S4.SS4.p3.3.m3.1.1.3.cmml" xref="S4.SS4.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">\sim 0</annotation></semantics></math> in log-scale in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and hence indistinguishable from their true domains. In contrast, the clients’ features and resulting hyperparameters of the Office-Caltech-10 dataset are perfectly clustered (ARI=1) as visualized in Fig. <a href="#S4.F3.sf1" title="Figure 3(a) ‣ Figure 3 ‣ 4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> and Appendix. <a href="#A6" title="Appendix F Additional Results ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation Study</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.4" class="ltx_p">To elucidate the individual impact of BNNet &amp; LRNet, we run an ablation study of all of the datasets used in our experiments and present the results in Table. <a href="#S4.T5" title="Table 5 ‣ 4.3 Personalizing to Unseen Clients ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, where CIFAR10 adopts the pretrained model trained using FedAvg. As BNNet learns to weight between client’s BN statistics (<span id="S4.SS5.p1.4.1" class="ltx_text ltx_font_bold">BN C</span>) and pretrained model’s BN statistics (<span id="S4.SS5.p1.4.2" class="ltx_text ltx_font_bold">BN G)</span>, running FedL2P with BNNet alone leads to either better or similar performance to the better performing baseline. Running LRNet as a standalone, on the other hand, can result in further gains, surpassing the use of both BNNet and LRNet on some benchmarks. Nonetheless, it requires prior knowledge of the data feature distribution of the client in order to set a suitable <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\boldsymbol{\beta}</annotation></semantics></math>, of which <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\beta}=1" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mrow id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml"><mi id="S4.SS5.p1.2.m2.1.1.2" xref="S4.SS5.p1.2.m2.1.1.2.cmml">𝜷</mi><mo id="S4.SS5.p1.2.m2.1.1.1" xref="S4.SS5.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.2.m2.1.1.3" xref="S4.SS5.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><apply id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1"><eq id="S4.SS5.p1.2.m2.1.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1.1"></eq><ci id="S4.SS5.p1.2.m2.1.1.2.cmml" xref="S4.SS5.p1.2.m2.1.1.2">𝜷</ci><cn type="integer" id="S4.SS5.p1.2.m2.1.1.3.cmml" xref="S4.SS5.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\boldsymbol{\beta}=1</annotation></semantics></math> uses <span id="S4.SS5.p1.4.3" class="ltx_text ltx_font_bold">BN C</span> and <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\beta}=0" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mrow id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml"><mi id="S4.SS5.p1.3.m3.1.1.2" xref="S4.SS5.p1.3.m3.1.1.2.cmml">𝜷</mi><mo id="S4.SS5.p1.3.m3.1.1.1" xref="S4.SS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.3.m3.1.1.3" xref="S4.SS5.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"><eq id="S4.SS5.p1.3.m3.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1"></eq><ci id="S4.SS5.p1.3.m3.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.2">𝜷</ci><cn type="integer" id="S4.SS5.p1.3.m3.1.1.3.cmml" xref="S4.SS5.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\boldsymbol{\beta}=0</annotation></semantics></math> uses <span id="S4.SS5.p1.4.4" class="ltx_text ltx_font_bold">BN G</span>. Our approach assumes no knowledge of the client’s data and learns an estimated <math id="S4.SS5.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="S4.SS5.p1.4.m4.1a"><mi id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><ci id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">\boldsymbol{\beta}</annotation></semantics></math> per-scenario and per-client using BNNet.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose FedL2P, a framework for federated learning of personalization strategies specific to individual FL scenarios and datasets as well as individual clients.
We learned meta-nets that use clients’ local data statistics relative to the pretrained model, to generate hyperparameters that explicitly target the normalization, scaling, and shifting of features as well as layer-wise parameter selection to mitigate the detrimental impacts of both marginal and conditional feature shift and marginal label shift, significantly boosting personalized performance. This framework is complementary to existing FL works that learn shared model(s) and can discover many previous hand-designed heuristics for sparse layer updates and BN parameter selection as special cases, and learns to apply them where appropriate according to the specific scenario for each specific client. As a future work, our approach can be extended to include other hyperparameters and model other forms of heterogeneity, e.g. using the number of samples as an expert input feature to a meta-net.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by Samsung AI and the European
Research Council via the REDIAL project.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarap [2018]</span>
<span class="ltx_bibblock">
Abien Fred Agarap.

</span>
<span class="ltx_bibblock">Deep learning using rectified linear units (relu).

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1803.08375</em>, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. [2019]</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baik et al. [2020]</span>
<span class="ltx_bibblock">
Sungyong Baik, Myungsub Choi, Janghoon Choi, Heewon Kim, and Kyoung Mu Lee.

</span>
<span class="ltx_bibblock">Meta-learning with adaptive hyperparameters.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:20755–20765, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al. [2013]</span>
<span class="ltx_bibblock">
Yoshua Bengio, Nicholas Léonard, and Aaron Courville.

</span>
<span class="ltx_bibblock">Estimating or propagating gradients through stochastic neurons for
conditional computation.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1308.3432</em>, 2013.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bernacchia [2021]</span>
<span class="ltx_bibblock">
Alberto Bernacchia.

</span>
<span class="ltx_bibblock">Meta-learning with negative learning rates.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al. [2020]</span>
<span class="ltx_bibblock">
Daniel J Beutel, Taner Topal, Akhil Mathur, Xinchi Qiu, Titouan Parcollet,
Pedro PB de Gusmão, and Nicholas D Lane.

</span>
<span class="ltx_bibblock">Flower: A friendly federated learning research framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.14390</em>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briggs et al. [2020]</span>
<span class="ltx_bibblock">
Christopher Briggs, Zhong Fan, and Peter Andras.

</span>
<span class="ltx_bibblock">Federated learning with hierarchical clustering of local updates to
improve training on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks
(IJCNN)</em>. IEEE, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al. [2019]</span>
<span class="ltx_bibblock">
Woong-Gi Chang, Tackgeun You, Seonguk Seo, Suha Kwak, and Bohyung Han.

</span>
<span class="ltx_bibblock">Domain-specific batch normalization for unsupervised domain
adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on Computer Vision
and Pattern Recognition (CVPR)</em>, pages 7354–7362, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2022]</span>
<span class="ltx_bibblock">
Daoyuan Chen, Dawei Gao, Weirui Kuang, Yaliang Li, and Bolin Ding.

</span>
<span class="ltx_bibblock">pfl-bench: A comprehensive benchmark for personalized federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2018]</span>
<span class="ltx_bibblock">
Fei Chen, Mi Luo, Zhenhua Dong, Zhenguo Li, and Xiuqiang He.

</span>
<span class="ltx_bibblock">Federated meta-learning with fast convergence and efficient
communication.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.07876</em>, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. [2021]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>. PMLR, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Csáji et al. [2001]</span>
<span class="ltx_bibblock">
Balázs Csanád Csáji et al.

</span>
<span class="ltx_bibblock">Approximation with artificial neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Faculty of Sciences, Etvs Lornd University, Hungary</em>,
24(48):7, 2001.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. [2009]</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">2009 IEEE Conference on Computer Vision and Pattern
Recognition</em>, pages 248–255. IEEE, 2009.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. [2020]</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. [2020]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn et al. [2017]</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>. PMLR, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. [2020]</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan Chung, Dong Yin, and Kannan Ramchandran.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Glorot and Bengio [2010]</span>
<span class="ltx_bibblock">
Xavier Glorot and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Understanding the difficulty of training deep feedforward neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the thirteenth international conference on
artificial intelligence and statistics</em>, pages 249–256. JMLR Workshop and
Conference Proceedings, 2010.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2012]</span>
<span class="ltx_bibblock">
Boqing Gong, Yuan Shi, Fei Sha, and Kristen Grauman.

</span>
<span class="ltx_bibblock">Geodesic flow kernel for unsupervised domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">2012 IEEE Conference on Computer Vision and Pattern
Recognition</em>, pages 2066–2073. IEEE, 2012.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2016]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Dietterich [2019]</span>
<span class="ltx_bibblock">
Dan Hendrycks and Thomas Dietterich.

</span>
<span class="ltx_bibblock">Benchmarking neural network robustness to common corruptions and
perturbations.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning
Representations</em>, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holly et al. [2022]</span>
<span class="ltx_bibblock">
Stephanie Holly, Thomas Hiessl, Safoura Rezapour Lakani, Daniel Schall, Clemens
Heitzinger, and Jana Kemnitz.

</span>
<span class="ltx_bibblock">Evaluation of hyperparameter-optimization approaches in an industrial
federated learning system.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Data Science–Analytics and Applications</em>. Springer, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Horvath et al. [2021]</span>
<span class="ltx_bibblock">
Samuel Horvath, Stefanos Laskaridis, Mario Almeida, Ilias Leontiadis,
Stylianos I Venieris, and Nicholas D Lane.

</span>
<span class="ltx_bibblock">Fjord: Fair and accurate federated learning under heterogeneous
targets with ordered dropout.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.13451</em>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. [2019]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hubert and Arabie [1985]</span>
<span class="ltx_bibblock">
Lawrence Hubert and Phipps Arabie.

</span>
<span class="ltx_bibblock">Comparing partitions.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Journal of Classification</em>, 2(1):193–218,
1985.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ioffe and Szegedy [2015]</span>
<span class="ltx_bibblock">
Sergey Ioffe and Christian Szegedy.

</span>
<span class="ltx_bibblock">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pages
448–456. PMLR, 2015.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2019]</span>
<span class="ltx_bibblock">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via model agnostic meta
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. [2021]</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham
Cormode, Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends in Machine Learning</em>, 14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. [2020]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International Conference on Machine
Learning</em>. PMLR, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khodak et al. [2021]</span>
<span class="ltx_bibblock">
Mikhail Khodak, Renbo Tu, Tian Li, Liam Li, Maria-Florina F Balcan, Virginia
Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Federated hyperparameter tuning: Challenges, baselines, and
connections to weight-sharing.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. [2009]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021a]</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 2021a.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021b]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>. PMLR,
2021b.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021c]</span>
<span class="ltx_bibblock">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou.

</span>
<span class="ltx_bibblock">Fedbn: Federated learning on non-iid features via local batch
normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.07623</em>, 2021c.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2016]</span>
<span class="ltx_bibblock">
Yanghao Li, Naiyan Wang, Jianping Shi, Jiaying Liu, and Xiaodi Hou.

</span>
<span class="ltx_bibblock">Revisiting batch normalization for practical domain adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1603.04779</em>, 2016.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. [2020]</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance Liu, Liu Ziyin, Nicholas B Allen, Randy P Auerbach,
David Brent, Ruslan Salakhutdinov, and Louis-Philippe Morency.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.01523</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lorraine et al. [2020]</span>
<span class="ltx_bibblock">
Jonathan Lorraine, Paul Vicol, and David Duvenaud.

</span>
<span class="ltx_bibblock">Optimizing millions of hyperparameters by implicit differentiation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pages 1540–1552. PMLR, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2021]</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, Jian Liang, and Jiashi Feng.

</span>
<span class="ltx_bibblock">No fear of heterogeneity: Classifier calibration for federated
learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2021.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. [2022]</span>
<span class="ltx_bibblock">
Xiaosong Ma, Jie Zhang, Song Guo, and Wenchao Xu.

</span>
<span class="ltx_bibblock">Layer-wised model aggregation for personalized federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">maintainers and contributors [2016]</span>
<span class="ltx_bibblock">
TorchVision maintainers and contributors.

</span>
<span class="ltx_bibblock">Torchvision: Pytorch’s computer vision library.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/pytorch/vision" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/pytorch/vision</a>, 2016.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansour et al. [2020]</span>
<span class="ltx_bibblock">
Yishay Mansour, Mehryar Mohri, Jae Ro, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Three approaches for personalization with applications to federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marfoq et al. [2021]</span>
<span class="ltx_bibblock">
Othmane Marfoq, Giovanni Neglia, Aurélien Bellet, Laetitia Kameni, and
Richard Vidal.

</span>
<span class="ltx_bibblock">Federated multi-task learning under a mixture of distributions.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2021.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Matsuda et al. [2022a]</span>
<span class="ltx_bibblock">
Koji Matsuda, Yuya Sasaki, Chuan Xiao, and Makoto Onizuka.

</span>
<span class="ltx_bibblock">Fedme: Federated learning via model exchange.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 SIAM International Conference on
Data Mining (SDM)</em>. SIAM, 2022a.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Matsuda et al. [2022b]</span>
<span class="ltx_bibblock">
Koji Matsuda, Yuya Sasaki, Chuan Xiao, and Makoto Onizuka.

</span>
<span class="ltx_bibblock">An empirical study of personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.13190</em>, 2022b.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>. PMLR, 2017.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Navon et al. [2021]</span>
<span class="ltx_bibblock">
Aviv Navon, Idan Achituve, Haggai Maron, Gal Chechik, and Ethan Fetaya.

</span>
<span class="ltx_bibblock">Auxiliary learning by implicit differentiation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. [2021]</span>
<span class="ltx_bibblock">
Jaehoon Oh, Sangmook Kim, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Fedbabu: Towards enhanced representation for federated image
classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.06042</em>, 2021.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oreshkin et al. [2018]</span>
<span class="ltx_bibblock">
Boris Oreshkin, Pau Rodríguez López, and Alexandre Lacoste.

</span>
<span class="ltx_bibblock">Tadam: Task dependent adaptive metric for improved few-shot learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 31, 2018.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pedregosa et al. [2011]</span>
<span class="ltx_bibblock">
F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel,
M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos,
D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay.

</span>
<span class="ltx_bibblock">Scikit-learn: Machine learning in Python.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 12:2825–2830,
2011.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. [2019]</span>
<span class="ltx_bibblock">
Xingchao Peng, Qinxun Bai, Xide Xia, Zijun Huang, Kate Saenko, and Bo Wang.

</span>
<span class="ltx_bibblock">Moment matching for multi-source domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>, pages 1406–1415, 2019.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. [2021]</span>
<span class="ltx_bibblock">
Xinchi Qiu, Javier Fernandez-Marques, Pedro PB Gusmao, Yan Gao, Titouan
Parcollet, and Nicholas Donald Lane.

</span>
<span class="ltx_bibblock">Zerofl: Efficient on-device training for federated learning with
local sparsity.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. [2020]</span>
<span class="ltx_bibblock">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask
optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
2020.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Mehdi Setayesh, Xiaoxiao Li, and Vincent WS Wong.

</span>
<span class="ltx_bibblock">Perfedmask: Personalized federated learning with optimized masking
vectors.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning
Representations</em>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. [2021]</span>
<span class="ltx_bibblock">
Aviv Shamsian, Aviv Navon, Ethan Fetaya, and Gal Chechik.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2021.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. [2020]</span>
<span class="ltx_bibblock">
Tao Shen, Jie Zhang, Xinkang Jia, Fengda Zhang, Gang Huang, Pan Zhou, Kun
Kuang, Fei Wu, and Chao Wu.

</span>
<span class="ltx_bibblock">Federated mutual learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.16765</em>, 2020.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shu et al. [2019]</span>
<span class="ltx_bibblock">
Jun Shu, Qi Xie, Lixuan Yi, Qian Zhao, Sanping Zhou, Zongben Xu, and Deyu Meng.

</span>
<span class="ltx_bibblock">Meta-weight-net: Learning an explicit mapping for sample weighting.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stella and Shi [2003]</span>
<span class="ltx_bibblock">
X Yu Stella and Jianbo Shi.

</span>
<span class="ltx_bibblock">Multiclass spectral clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Computer Vision</em>, volume 2,
pages 313–313. IEEE Computer Society, 2003.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh et al. [2020]</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warden [2018]</span>
<span class="ltx_bibblock">
Pete Warden.

</span>
<span class="ltx_bibblock">Speech commands: A dataset for limited-vocabulary speech recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1804.03209</em>, 2018.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al. [2019]</span>
<span class="ltx_bibblock">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, Nghia
Hoang, and Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages
7252–7261. PMLR, 2019.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2021]</span>
<span class="ltx_bibblock">
Michael Zhang, Karan Sapra, Sanja Fidler, Serena Yeung, and Jose M Alvarez.

</span>
<span class="ltx_bibblock">Personalized federated learning with first order model optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2018]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. [2023]</span>
<span class="ltx_bibblock">
Aoxiao Zhong, Hao He, Zhaolin Ren, Na Li, and Quanzheng Li.

</span>
<span class="ltx_bibblock">Feddar: Federated domain-aware representation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2023]</span>
<span class="ltx_bibblock">
Yi Zhou, Parikshit Ram, Theodoros Salonidis, Nathalie Baracaldo, Horst
Samulowitz, and Heiko Ludwig.

</span>
<span class="ltx_bibblock">Single-shot general hyper-parameter optimization for federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p ltx_align_center"><span id="p2.1.1" class="ltx_text ltx_font_bold" style="font-size:207%;">Appendix</span></p>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Derivation of Equation (<a href="#S3.E7" title="Equation 7 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>)</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">From Eq (<a href="#S3.E5" title="Equation 5 ‣ 3.2 FedL2P: FL of Personalization Strategies ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), we know that:</p>
<table id="A6.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E11.m1.4" class="ltx_Math" alttext="\displaystyle\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta}=0" display="inline"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.5" xref="A1.E11.m1.4.5.cmml"><mstyle displaystyle="true" id="A1.E11.m1.4.4" xref="A1.E11.m1.4.4.cmml"><mfrac id="A1.E11.m1.4.4a" xref="A1.E11.m1.4.4.cmml"><mrow id="A1.E11.m1.4.4.4" xref="A1.E11.m1.4.4.4.cmml"><mi id="A1.E11.m1.4.4.4.6" xref="A1.E11.m1.4.4.4.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.4.4.4.5" xref="A1.E11.m1.4.4.4.5.cmml">​</mo><msub id="A1.E11.m1.4.4.4.7" xref="A1.E11.m1.4.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E11.m1.4.4.4.7.2" xref="A1.E11.m1.4.4.4.7.2.cmml">ℒ</mi><mrow id="A1.E11.m1.2.2.2.2.2.4" xref="A1.E11.m1.2.2.2.2.2.3.cmml"><mi id="A1.E11.m1.1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E11.m1.2.2.2.2.2.4.1" xref="A1.E11.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E11.m1.2.2.2.2.2.2" xref="A1.E11.m1.2.2.2.2.2.2.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E11.m1.4.4.4.5a" xref="A1.E11.m1.4.4.4.5.cmml">​</mo><mrow id="A1.E11.m1.4.4.4.4.1" xref="A1.E11.m1.4.4.4.4.2.cmml"><mo stretchy="false" id="A1.E11.m1.4.4.4.4.1.2" xref="A1.E11.m1.4.4.4.4.2.cmml">(</mo><msubsup id="A1.E11.m1.4.4.4.4.1.1" xref="A1.E11.m1.4.4.4.4.1.1.cmml"><mi id="A1.E11.m1.4.4.4.4.1.1.2.2" xref="A1.E11.m1.4.4.4.4.1.1.2.2.cmml">θ</mi><mi id="A1.E11.m1.4.4.4.4.1.1.2.3" xref="A1.E11.m1.4.4.4.4.1.1.2.3.cmml">i</mi><mo id="A1.E11.m1.4.4.4.4.1.1.3" xref="A1.E11.m1.4.4.4.4.1.1.3.cmml">∗</mo></msubsup><mo id="A1.E11.m1.4.4.4.4.1.3" xref="A1.E11.m1.4.4.4.4.2.cmml">,</mo><mi id="A1.E11.m1.3.3.3.3" xref="A1.E11.m1.3.3.3.3.cmml">λ</mi><mo stretchy="false" id="A1.E11.m1.4.4.4.4.1.4" xref="A1.E11.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow><mrow id="A1.E11.m1.4.4.6" xref="A1.E11.m1.4.4.6.cmml"><mi id="A1.E11.m1.4.4.6.2" xref="A1.E11.m1.4.4.6.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E11.m1.4.4.6.1" xref="A1.E11.m1.4.4.6.1.cmml">​</mo><mi id="A1.E11.m1.4.4.6.3" xref="A1.E11.m1.4.4.6.3.cmml">θ</mi></mrow></mfrac></mstyle><mo id="A1.E11.m1.4.5.1" xref="A1.E11.m1.4.5.1.cmml">=</mo><mn id="A1.E11.m1.4.5.2" xref="A1.E11.m1.4.5.2.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.5.cmml" xref="A1.E11.m1.4.5"><eq id="A1.E11.m1.4.5.1.cmml" xref="A1.E11.m1.4.5.1"></eq><apply id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4"><divide id="A1.E11.m1.4.4.5.cmml" xref="A1.E11.m1.4.4"></divide><apply id="A1.E11.m1.4.4.4.cmml" xref="A1.E11.m1.4.4.4"><times id="A1.E11.m1.4.4.4.5.cmml" xref="A1.E11.m1.4.4.4.5"></times><ci id="A1.E11.m1.4.4.4.6.cmml" xref="A1.E11.m1.4.4.4.6">𝑑</ci><apply id="A1.E11.m1.4.4.4.7.cmml" xref="A1.E11.m1.4.4.4.7"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.7.1.cmml" xref="A1.E11.m1.4.4.4.7">subscript</csymbol><ci id="A1.E11.m1.4.4.4.7.2.cmml" xref="A1.E11.m1.4.4.4.7.2">ℒ</ci><list id="A1.E11.m1.2.2.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2.2.4"><ci id="A1.E11.m1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.E11.m1.2.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2">𝑇</ci></list></apply><interval closure="open" id="A1.E11.m1.4.4.4.4.2.cmml" xref="A1.E11.m1.4.4.4.4.1"><apply id="A1.E11.m1.4.4.4.4.1.1.cmml" xref="A1.E11.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.4.1.1.1.cmml" xref="A1.E11.m1.4.4.4.4.1.1">superscript</csymbol><apply id="A1.E11.m1.4.4.4.4.1.1.2.cmml" xref="A1.E11.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.4.1.1.2.1.cmml" xref="A1.E11.m1.4.4.4.4.1.1">subscript</csymbol><ci id="A1.E11.m1.4.4.4.4.1.1.2.2.cmml" xref="A1.E11.m1.4.4.4.4.1.1.2.2">𝜃</ci><ci id="A1.E11.m1.4.4.4.4.1.1.2.3.cmml" xref="A1.E11.m1.4.4.4.4.1.1.2.3">𝑖</ci></apply><times id="A1.E11.m1.4.4.4.4.1.1.3.cmml" xref="A1.E11.m1.4.4.4.4.1.1.3"></times></apply><ci id="A1.E11.m1.3.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3">𝜆</ci></interval></apply><apply id="A1.E11.m1.4.4.6.cmml" xref="A1.E11.m1.4.4.6"><times id="A1.E11.m1.4.4.6.1.cmml" xref="A1.E11.m1.4.4.6.1"></times><ci id="A1.E11.m1.4.4.6.2.cmml" xref="A1.E11.m1.4.4.6.2">𝑑</ci><ci id="A1.E11.m1.4.4.6.3.cmml" xref="A1.E11.m1.4.4.6.3">𝜃</ci></apply></apply><cn type="integer" id="A1.E11.m1.4.5.2.cmml" xref="A1.E11.m1.4.5.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\displaystyle\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta}=0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.2" class="ltx_p">Based on the implicit functional theorem (IFT), we get that if we have a function <math id="A1.p2.1.m1.2" class="ltx_Math" alttext="F(x,y)=c" display="inline"><semantics id="A1.p2.1.m1.2a"><mrow id="A1.p2.1.m1.2.3" xref="A1.p2.1.m1.2.3.cmml"><mrow id="A1.p2.1.m1.2.3.2" xref="A1.p2.1.m1.2.3.2.cmml"><mi id="A1.p2.1.m1.2.3.2.2" xref="A1.p2.1.m1.2.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A1.p2.1.m1.2.3.2.1" xref="A1.p2.1.m1.2.3.2.1.cmml">​</mo><mrow id="A1.p2.1.m1.2.3.2.3.2" xref="A1.p2.1.m1.2.3.2.3.1.cmml"><mo stretchy="false" id="A1.p2.1.m1.2.3.2.3.2.1" xref="A1.p2.1.m1.2.3.2.3.1.cmml">(</mo><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">x</mi><mo id="A1.p2.1.m1.2.3.2.3.2.2" xref="A1.p2.1.m1.2.3.2.3.1.cmml">,</mo><mi id="A1.p2.1.m1.2.2" xref="A1.p2.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="A1.p2.1.m1.2.3.2.3.2.3" xref="A1.p2.1.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.p2.1.m1.2.3.1" xref="A1.p2.1.m1.2.3.1.cmml">=</mo><mi id="A1.p2.1.m1.2.3.3" xref="A1.p2.1.m1.2.3.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.2b"><apply id="A1.p2.1.m1.2.3.cmml" xref="A1.p2.1.m1.2.3"><eq id="A1.p2.1.m1.2.3.1.cmml" xref="A1.p2.1.m1.2.3.1"></eq><apply id="A1.p2.1.m1.2.3.2.cmml" xref="A1.p2.1.m1.2.3.2"><times id="A1.p2.1.m1.2.3.2.1.cmml" xref="A1.p2.1.m1.2.3.2.1"></times><ci id="A1.p2.1.m1.2.3.2.2.cmml" xref="A1.p2.1.m1.2.3.2.2">𝐹</ci><interval closure="open" id="A1.p2.1.m1.2.3.2.3.1.cmml" xref="A1.p2.1.m1.2.3.2.3.2"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝑥</ci><ci id="A1.p2.1.m1.2.2.cmml" xref="A1.p2.1.m1.2.2">𝑦</ci></interval></apply><ci id="A1.p2.1.m1.2.3.3.cmml" xref="A1.p2.1.m1.2.3.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.2c">F(x,y)=c</annotation></semantics></math>, we can derive that <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="y^{\prime}(x)=-F_{x}/F_{y}" display="inline"><semantics id="A1.p2.2.m2.1a"><mrow id="A1.p2.2.m2.1.2" xref="A1.p2.2.m2.1.2.cmml"><mrow id="A1.p2.2.m2.1.2.2" xref="A1.p2.2.m2.1.2.2.cmml"><msup id="A1.p2.2.m2.1.2.2.2" xref="A1.p2.2.m2.1.2.2.2.cmml"><mi id="A1.p2.2.m2.1.2.2.2.2" xref="A1.p2.2.m2.1.2.2.2.2.cmml">y</mi><mo id="A1.p2.2.m2.1.2.2.2.3" xref="A1.p2.2.m2.1.2.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="A1.p2.2.m2.1.2.2.1" xref="A1.p2.2.m2.1.2.2.1.cmml">​</mo><mrow id="A1.p2.2.m2.1.2.2.3.2" xref="A1.p2.2.m2.1.2.2.cmml"><mo stretchy="false" id="A1.p2.2.m2.1.2.2.3.2.1" xref="A1.p2.2.m2.1.2.2.cmml">(</mo><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="A1.p2.2.m2.1.2.2.3.2.2" xref="A1.p2.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.p2.2.m2.1.2.1" xref="A1.p2.2.m2.1.2.1.cmml">=</mo><mrow id="A1.p2.2.m2.1.2.3" xref="A1.p2.2.m2.1.2.3.cmml"><mo id="A1.p2.2.m2.1.2.3a" xref="A1.p2.2.m2.1.2.3.cmml">−</mo><mrow id="A1.p2.2.m2.1.2.3.2" xref="A1.p2.2.m2.1.2.3.2.cmml"><msub id="A1.p2.2.m2.1.2.3.2.2" xref="A1.p2.2.m2.1.2.3.2.2.cmml"><mi id="A1.p2.2.m2.1.2.3.2.2.2" xref="A1.p2.2.m2.1.2.3.2.2.2.cmml">F</mi><mi id="A1.p2.2.m2.1.2.3.2.2.3" xref="A1.p2.2.m2.1.2.3.2.2.3.cmml">x</mi></msub><mo id="A1.p2.2.m2.1.2.3.2.1" xref="A1.p2.2.m2.1.2.3.2.1.cmml">/</mo><msub id="A1.p2.2.m2.1.2.3.2.3" xref="A1.p2.2.m2.1.2.3.2.3.cmml"><mi id="A1.p2.2.m2.1.2.3.2.3.2" xref="A1.p2.2.m2.1.2.3.2.3.2.cmml">F</mi><mi id="A1.p2.2.m2.1.2.3.2.3.3" xref="A1.p2.2.m2.1.2.3.2.3.3.cmml">y</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.2.cmml" xref="A1.p2.2.m2.1.2"><eq id="A1.p2.2.m2.1.2.1.cmml" xref="A1.p2.2.m2.1.2.1"></eq><apply id="A1.p2.2.m2.1.2.2.cmml" xref="A1.p2.2.m2.1.2.2"><times id="A1.p2.2.m2.1.2.2.1.cmml" xref="A1.p2.2.m2.1.2.2.1"></times><apply id="A1.p2.2.m2.1.2.2.2.cmml" xref="A1.p2.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.2.2.2.1.cmml" xref="A1.p2.2.m2.1.2.2.2">superscript</csymbol><ci id="A1.p2.2.m2.1.2.2.2.2.cmml" xref="A1.p2.2.m2.1.2.2.2.2">𝑦</ci><ci id="A1.p2.2.m2.1.2.2.2.3.cmml" xref="A1.p2.2.m2.1.2.2.2.3">′</ci></apply><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑥</ci></apply><apply id="A1.p2.2.m2.1.2.3.cmml" xref="A1.p2.2.m2.1.2.3"><minus id="A1.p2.2.m2.1.2.3.1.cmml" xref="A1.p2.2.m2.1.2.3"></minus><apply id="A1.p2.2.m2.1.2.3.2.cmml" xref="A1.p2.2.m2.1.2.3.2"><divide id="A1.p2.2.m2.1.2.3.2.1.cmml" xref="A1.p2.2.m2.1.2.3.2.1"></divide><apply id="A1.p2.2.m2.1.2.3.2.2.cmml" xref="A1.p2.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.2.3.2.2.1.cmml" xref="A1.p2.2.m2.1.2.3.2.2">subscript</csymbol><ci id="A1.p2.2.m2.1.2.3.2.2.2.cmml" xref="A1.p2.2.m2.1.2.3.2.2.2">𝐹</ci><ci id="A1.p2.2.m2.1.2.3.2.2.3.cmml" xref="A1.p2.2.m2.1.2.3.2.2.3">𝑥</ci></apply><apply id="A1.p2.2.m2.1.2.3.2.3.cmml" xref="A1.p2.2.m2.1.2.3.2.3"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.2.3.2.3.1.cmml" xref="A1.p2.2.m2.1.2.3.2.3">subscript</csymbol><ci id="A1.p2.2.m2.1.2.3.2.3.2.cmml" xref="A1.p2.2.m2.1.2.3.2.3.2">𝐹</ci><ci id="A1.p2.2.m2.1.2.3.2.3.3.cmml" xref="A1.p2.2.m2.1.2.3.2.3.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">y^{\prime}(x)=-F_{x}/F_{y}</annotation></semantics></math>. Therefore, plus the Eq (<a href="#A1.E11" title="Equation 11 ‣ Appendix A Derivation of Equation (7) ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>) into the theorem, we can get:</p>
</div>
<div id="A1.p3" class="ltx_para">
<table id="A6.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="A1.E12.m1.30" class="ltx_Math" alttext="\displaystyle\begin{split}\frac{d\theta^{*}}{d\lambda}=-\frac{\partial_{\theta}(\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta})}{\partial_{\lambda}\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta}}=-(\partial_{\theta}^{2}\mathcal{L}_{T}(\theta,\lambda))^{-1}\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}(\theta,\lambda)\end{split}" display="inline"><semantics id="A1.E12.m1.30a"><mtable id="A1.E12.m1.30.30.2" xref="A1.E12.m1.29.29.1.cmml"><mtr id="A1.E12.m1.30.30.2a" xref="A1.E12.m1.29.29.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E12.m1.30.30.2b" xref="A1.E12.m1.29.29.1.cmml"><mrow id="A1.E12.m1.30.30.2.29.29.29" xref="A1.E12.m1.29.29.1.cmml"><mstyle displaystyle="true" id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mfrac id="A1.E12.m1.1.1.1.1.1.1a" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.2.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.1.1.1.1.2.1" xref="A1.E12.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msup id="A1.E12.m1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.2.3.2" xref="A1.E12.m1.1.1.1.1.1.1.2.3.2.cmml">θ</mi><mo id="A1.E12.m1.1.1.1.1.1.1.2.3.3" xref="A1.E12.m1.1.1.1.1.1.1.2.3.3.cmml">∗</mo></msup></mrow><mrow id="A1.E12.m1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.1.1.1.1.1.1.3.1" xref="A1.E12.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.E12.m1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.1.1.1.3.3.cmml">λ</mi></mrow></mfrac></mstyle><mo id="A1.E12.m1.2.2.2.2.2.2" xref="A1.E12.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.31" xref="A1.E12.m1.29.29.1.cmml"><mo id="A1.E12.m1.30.30.2.29.29.29.31a" xref="A1.E12.m1.29.29.1a.cmml">−</mo><mstyle displaystyle="true" id="A1.E12.m1.4.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.4.cmml"><mfrac id="A1.E12.m1.4.4.4.4.4.4a" xref="A1.E12.m1.4.4.4.4.4.4.cmml"><mrow id="A1.E12.m1.4.4.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.4.4.cmml"><msub id="A1.E12.m1.4.4.4.4.4.4.4.5" xref="A1.E12.m1.4.4.4.4.4.4.4.5.cmml"><mo id="A1.E12.m1.4.4.4.4.4.4.4.5.2" xref="A1.E12.m1.4.4.4.4.4.4.4.5.2.cmml">∂</mo><mi id="A1.E12.m1.4.4.4.4.4.4.4.5.3" xref="A1.E12.m1.4.4.4.4.4.4.4.5.3.cmml">θ</mi></msub><mrow id="A1.E12.m1.4.4.4.4.4.4.4.6.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.cmml"><mo lspace="0em" stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.4.6.2.1" xref="A1.E12.m1.4.4.4.4.4.4.4.4.cmml">(</mo><mfrac id="A1.E12.m1.4.4.4.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.4.4.4.cmml"><mrow id="A1.E12.m1.4.4.4.4.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.4.4.4.6" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.5" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.5.cmml">​</mo><msub id="A1.E12.m1.4.4.4.4.4.4.4.4.4.7" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.2.cmml">ℒ</mi><mrow id="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.4" xref="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.3.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.1.1" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.4.1" xref="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.2" xref="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.2.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.5a" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.5.cmml">​</mo><mrow id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.2.cmml"><mo stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.2.cmml">(</mo><msubsup id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.2.cmml">θ</mi><mi id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.3" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.3.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.3" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.3.cmml">∗</mo></msubsup><mo id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.3" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.2.cmml">,</mo><mi id="A1.E12.m1.4.4.4.4.4.4.3.3.3.3" xref="A1.E12.m1.4.4.4.4.4.4.3.3.3.3.cmml">λ</mi><mo stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.4" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.2.cmml">)</mo></mrow></mrow><mrow id="A1.E12.m1.4.4.4.4.4.4.4.4.6" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.4.4.6.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.4.4.6.1" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.1.cmml">​</mo><mi id="A1.E12.m1.4.4.4.4.4.4.4.4.6.3" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.3.cmml">θ</mi></mrow></mfrac><mo stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.4.6.2.2" xref="A1.E12.m1.4.4.4.4.4.4.4.4.cmml">)</mo></mrow></mrow><mrow id="A1.E12.m1.4.4.4.4.4.4.8" xref="A1.E12.m1.4.4.4.4.4.4.8.cmml"><msub id="A1.E12.m1.4.4.4.4.4.4.8.5" xref="A1.E12.m1.4.4.4.4.4.4.8.5.cmml"><mo id="A1.E12.m1.4.4.4.4.4.4.8.5.2" xref="A1.E12.m1.4.4.4.4.4.4.8.5.2.cmml">∂</mo><mi id="A1.E12.m1.4.4.4.4.4.4.8.5.3" xref="A1.E12.m1.4.4.4.4.4.4.8.5.3.cmml">λ</mi></msub><mfrac id="A1.E12.m1.4.4.4.4.4.4.8.4" xref="A1.E12.m1.4.4.4.4.4.4.8.4.cmml"><mrow id="A1.E12.m1.4.4.4.4.4.4.8.4.4" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.8.4.4.6" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.5" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.5.cmml">​</mo><msub id="A1.E12.m1.4.4.4.4.4.4.8.4.4.7" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.2" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.2.cmml">ℒ</mi><mrow id="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.4" xref="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.3.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.5.1.1.1.1.1" xref="A1.E12.m1.4.4.4.4.4.4.5.1.1.1.1.1.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.4.1" xref="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.3.cmml">,</mo><mi id="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.2" xref="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.2.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.5a" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.5.cmml">​</mo><mrow id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.2.cmml"><mo stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.2" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.2.cmml">(</mo><msubsup id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.2" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.2.cmml">θ</mi><mi id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.3" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.3.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.3" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.3.cmml">∗</mo></msubsup><mo id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.3" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.2.cmml">,</mo><mi id="A1.E12.m1.4.4.4.4.4.4.7.3.3.3" xref="A1.E12.m1.4.4.4.4.4.4.7.3.3.3.cmml">λ</mi><mo stretchy="false" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.4" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.2.cmml">)</mo></mrow></mrow><mrow id="A1.E12.m1.4.4.4.4.4.4.8.4.6" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.8.4.6.2" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.4.4.4.4.4.4.8.4.6.1" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.1.cmml">​</mo><mi id="A1.E12.m1.4.4.4.4.4.4.8.4.6.3" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.3.cmml">θ</mi></mrow></mfrac></mrow></mfrac></mstyle></mrow><mo id="A1.E12.m1.5.5.5.5.5.5" xref="A1.E12.m1.5.5.5.5.5.5.cmml">=</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29" xref="A1.E12.m1.29.29.1.cmml"><mo id="A1.E12.m1.30.30.2.29.29.29.29a" xref="A1.E12.m1.29.29.1a.cmml">−</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1" xref="A1.E12.m1.29.29.1.cmml"><msup id="A1.E12.m1.30.30.2.29.29.29.29.1.1" xref="A1.E12.m1.29.29.1.cmml"><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1" xref="A1.E12.m1.29.29.1.cmml"><mo stretchy="false" id="A1.E12.m1.7.7.7.7.7.7" xref="A1.E12.m1.29.29.1a.cmml">(</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1" xref="A1.E12.m1.29.29.1.cmml"><msubsup id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1.1" xref="A1.E12.m1.29.29.1.cmml"><mo lspace="0em" rspace="0em" id="A1.E12.m1.8.8.8.8.8.8" xref="A1.E12.m1.8.8.8.8.8.8.cmml">∂</mo><mi id="A1.E12.m1.9.9.9.9.9.9.1" xref="A1.E12.m1.9.9.9.9.9.9.1.cmml">θ</mi><mn id="A1.E12.m1.10.10.10.10.10.10.1" xref="A1.E12.m1.10.10.10.10.10.10.1.cmml">2</mn></msubsup><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1.2" xref="A1.E12.m1.29.29.1.cmml"><msub id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1.2.2" xref="A1.E12.m1.29.29.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.11.11.11.11.11.11" xref="A1.E12.m1.11.11.11.11.11.11.cmml">ℒ</mi><mi id="A1.E12.m1.12.12.12.12.12.12.1" xref="A1.E12.m1.12.12.12.12.12.12.1.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1.2.1" xref="A1.E12.m1.29.29.1a.cmml">​</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.1.1.1.1.2.3" xref="A1.E12.m1.29.29.1.cmml"><mo stretchy="false" id="A1.E12.m1.13.13.13.13.13.13" xref="A1.E12.m1.29.29.1a.cmml">(</mo><mi id="A1.E12.m1.14.14.14.14.14.14" xref="A1.E12.m1.14.14.14.14.14.14.cmml">θ</mi><mo id="A1.E12.m1.15.15.15.15.15.15" xref="A1.E12.m1.29.29.1a.cmml">,</mo><mi id="A1.E12.m1.16.16.16.16.16.16" xref="A1.E12.m1.16.16.16.16.16.16.cmml">λ</mi><mo stretchy="false" id="A1.E12.m1.17.17.17.17.17.17" xref="A1.E12.m1.29.29.1a.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.E12.m1.18.18.18.18.18.18" xref="A1.E12.m1.29.29.1a.cmml">)</mo></mrow><mrow id="A1.E12.m1.19.19.19.19.19.19.1" xref="A1.E12.m1.19.19.19.19.19.19.1.cmml"><mo id="A1.E12.m1.19.19.19.19.19.19.1a" xref="A1.E12.m1.19.19.19.19.19.19.1.cmml">−</mo><mn id="A1.E12.m1.19.19.19.19.19.19.1.2" xref="A1.E12.m1.19.19.19.19.19.19.1.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="A1.E12.m1.30.30.2.29.29.29.29.1.2" xref="A1.E12.m1.29.29.1a.cmml">​</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.3" xref="A1.E12.m1.29.29.1.cmml"><msub id="A1.E12.m1.30.30.2.29.29.29.29.1.3.1" xref="A1.E12.m1.29.29.1.cmml"><mo rspace="0em" id="A1.E12.m1.20.20.20.20.20.20" xref="A1.E12.m1.20.20.20.20.20.20.cmml">∂</mo><mrow id="A1.E12.m1.21.21.21.21.21.21.1" xref="A1.E12.m1.21.21.21.21.21.21.1.cmml"><mi id="A1.E12.m1.21.21.21.21.21.21.1.2" xref="A1.E12.m1.21.21.21.21.21.21.1.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A1.E12.m1.21.21.21.21.21.21.1.1" xref="A1.E12.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="A1.E12.m1.21.21.21.21.21.21.1.3" xref="A1.E12.m1.21.21.21.21.21.21.1.3.cmml">θ</mi></mrow></msub><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.3.2" xref="A1.E12.m1.29.29.1.cmml"><msub id="A1.E12.m1.30.30.2.29.29.29.29.1.3.2.2" xref="A1.E12.m1.29.29.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.22.22.22.22.22.22" xref="A1.E12.m1.22.22.22.22.22.22.cmml">ℒ</mi><mi id="A1.E12.m1.23.23.23.23.23.23.1" xref="A1.E12.m1.23.23.23.23.23.23.1.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12.m1.30.30.2.29.29.29.29.1.3.2.1" xref="A1.E12.m1.29.29.1a.cmml">​</mo><mrow id="A1.E12.m1.30.30.2.29.29.29.29.1.3.2.3" xref="A1.E12.m1.29.29.1.cmml"><mo stretchy="false" id="A1.E12.m1.24.24.24.24.24.24" xref="A1.E12.m1.29.29.1a.cmml">(</mo><mi id="A1.E12.m1.25.25.25.25.25.25" xref="A1.E12.m1.25.25.25.25.25.25.cmml">θ</mi><mo id="A1.E12.m1.26.26.26.26.26.26" xref="A1.E12.m1.29.29.1a.cmml">,</mo><mi id="A1.E12.m1.27.27.27.27.27.27" xref="A1.E12.m1.27.27.27.27.27.27.cmml">λ</mi><mo stretchy="false" id="A1.E12.m1.28.28.28.28.28.28" xref="A1.E12.m1.29.29.1a.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E12.m1.30b"><apply id="A1.E12.m1.29.29.1.cmml" xref="A1.E12.m1.30.30.2"><and id="A1.E12.m1.29.29.1a.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a"></and><apply id="A1.E12.m1.29.29.1b.cmml" xref="A1.E12.m1.30.30.2"><eq id="A1.E12.m1.2.2.2.2.2.2.cmml" xref="A1.E12.m1.2.2.2.2.2.2"></eq><apply id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1"><divide id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1"></divide><apply id="A1.E12.m1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2"><times id="A1.E12.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.1"></times><ci id="A1.E12.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.2">𝑑</ci><apply id="A1.E12.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.3.2">𝜃</ci><times id="A1.E12.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2.3.3"></times></apply></apply><apply id="A1.E12.m1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3"><times id="A1.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.1"></times><ci id="A1.E12.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="A1.E12.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.3">𝜆</ci></apply></apply><apply id="A1.E12.m1.29.29.1.5.cmml" xref="A1.E12.m1.30.30.2"><minus id="A1.E12.m1.3.3.3.3.3.3.cmml" xref="A1.E12.m1.30.30.2"></minus><apply id="A1.E12.m1.4.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4"><divide id="A1.E12.m1.4.4.4.4.4.4.9.cmml" xref="A1.E12.m1.4.4.4.4.4.4"></divide><apply id="A1.E12.m1.4.4.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4"><apply id="A1.E12.m1.4.4.4.4.4.4.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.5"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.4.5.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.5">subscript</csymbol><partialdiff id="A1.E12.m1.4.4.4.4.4.4.4.5.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.5.2"></partialdiff><ci id="A1.E12.m1.4.4.4.4.4.4.4.5.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.5.3">𝜃</ci></apply><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.6.2"><divide id="A1.E12.m1.4.4.4.4.4.4.4.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.6.2"></divide><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4"><times id="A1.E12.m1.4.4.4.4.4.4.4.4.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.5"></times><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.4.6.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.6">𝑑</ci><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.7"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.7">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.7.2">ℒ</ci><list id="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.4"><ci id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.1.1">𝑖</ci><ci id="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.2.2.2.2.2.2">𝑇</ci></list></apply><interval closure="open" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1"><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1">superscript</csymbol><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.2">𝜃</ci><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.2.3">𝑖</ci></apply><times id="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.4.4.1.1.3"></times></apply><ci id="A1.E12.m1.4.4.4.4.4.4.3.3.3.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.3.3.3.3">𝜆</ci></interval></apply><apply id="A1.E12.m1.4.4.4.4.4.4.4.4.6.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6"><times id="A1.E12.m1.4.4.4.4.4.4.4.4.6.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.1"></times><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.6.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.2">𝑑</ci><ci id="A1.E12.m1.4.4.4.4.4.4.4.4.6.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.4.4.6.3">𝜃</ci></apply></apply></apply><apply id="A1.E12.m1.4.4.4.4.4.4.8.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8"><apply id="A1.E12.m1.4.4.4.4.4.4.8.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.5"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.8.5.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.5">subscript</csymbol><partialdiff id="A1.E12.m1.4.4.4.4.4.4.8.5.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.5.2"></partialdiff><ci id="A1.E12.m1.4.4.4.4.4.4.8.5.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.5.3">𝜆</ci></apply><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4"><divide id="A1.E12.m1.4.4.4.4.4.4.8.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4"></divide><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4"><times id="A1.E12.m1.4.4.4.4.4.4.8.4.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.5"></times><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.4.6.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.6">𝑑</ci><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.7"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.7">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.7.2">ℒ</ci><list id="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.4"><ci id="A1.E12.m1.4.4.4.4.4.4.5.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.5.1.1.1.1.1">𝑖</ci><ci id="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.6.2.2.2.2.2">𝑇</ci></list></apply><interval closure="open" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1"><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1">superscript</csymbol><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.2">𝜃</ci><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.2.3">𝑖</ci></apply><times id="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.4.4.1.1.3"></times></apply><ci id="A1.E12.m1.4.4.4.4.4.4.7.3.3.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.7.3.3.3">𝜆</ci></interval></apply><apply id="A1.E12.m1.4.4.4.4.4.4.8.4.6.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6"><times id="A1.E12.m1.4.4.4.4.4.4.8.4.6.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.1"></times><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.6.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.2">𝑑</ci><ci id="A1.E12.m1.4.4.4.4.4.4.8.4.6.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.8.4.6.3">𝜃</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E12.m1.29.29.1c.cmml" xref="A1.E12.m1.30.30.2"><eq id="A1.E12.m1.5.5.5.5.5.5.cmml" xref="A1.E12.m1.5.5.5.5.5.5"></eq><share href="#A1.E12.m1.29.29.1.5.cmml" id="A1.E12.m1.29.29.1d.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a"></share><apply id="A1.E12.m1.29.29.1.1.cmml" xref="A1.E12.m1.30.30.2"><minus id="A1.E12.m1.6.6.6.6.6.6.cmml" xref="A1.E12.m1.30.30.2"></minus><apply id="A1.E12.m1.29.29.1.1.1.cmml" xref="A1.E12.m1.30.30.2"><times id="A1.E12.m1.29.29.1.1.1.2.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a"></times><apply id="A1.E12.m1.29.29.1.1.1.1.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.1.2.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a">superscript</csymbol><apply id="A1.E12.m1.29.29.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.30.30.2"><apply id="A1.E12.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.30.30.2">superscript</csymbol><apply id="A1.E12.m1.29.29.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.30.30.2">subscript</csymbol><partialdiff id="A1.E12.m1.8.8.8.8.8.8.cmml" xref="A1.E12.m1.8.8.8.8.8.8"></partialdiff><ci id="A1.E12.m1.9.9.9.9.9.9.1.cmml" xref="A1.E12.m1.9.9.9.9.9.9.1">𝜃</ci></apply><cn type="integer" id="A1.E12.m1.10.10.10.10.10.10.1.cmml" xref="A1.E12.m1.10.10.10.10.10.10.1">2</cn></apply><apply id="A1.E12.m1.29.29.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.30.30.2"><times id="A1.E12.m1.29.29.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.30.30.2"></times><apply id="A1.E12.m1.29.29.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12.m1.30.30.2">subscript</csymbol><ci id="A1.E12.m1.11.11.11.11.11.11.cmml" xref="A1.E12.m1.11.11.11.11.11.11">ℒ</ci><ci id="A1.E12.m1.12.12.12.12.12.12.1.cmml" xref="A1.E12.m1.12.12.12.12.12.12.1">𝑇</ci></apply><interval closure="open" id="A1.E12.m1.29.29.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.30.30.2"><ci id="A1.E12.m1.14.14.14.14.14.14.cmml" xref="A1.E12.m1.14.14.14.14.14.14">𝜃</ci><ci id="A1.E12.m1.16.16.16.16.16.16.cmml" xref="A1.E12.m1.16.16.16.16.16.16">𝜆</ci></interval></apply></apply><apply id="A1.E12.m1.19.19.19.19.19.19.1.cmml" xref="A1.E12.m1.19.19.19.19.19.19.1"><minus id="A1.E12.m1.19.19.19.19.19.19.1.1.cmml" xref="A1.E12.m1.19.19.19.19.19.19.1"></minus><cn type="integer" id="A1.E12.m1.19.19.19.19.19.19.1.2.cmml" xref="A1.E12.m1.19.19.19.19.19.19.1.2">1</cn></apply></apply><apply id="A1.E12.m1.29.29.1.1.1.3.cmml" xref="A1.E12.m1.30.30.2"><apply id="A1.E12.m1.29.29.1.1.1.3.1.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.3.1.1.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a">subscript</csymbol><partialdiff id="A1.E12.m1.20.20.20.20.20.20.cmml" xref="A1.E12.m1.20.20.20.20.20.20"></partialdiff><apply id="A1.E12.m1.21.21.21.21.21.21.1.cmml" xref="A1.E12.m1.21.21.21.21.21.21.1"><times id="A1.E12.m1.21.21.21.21.21.21.1.1.cmml" xref="A1.E12.m1.21.21.21.21.21.21.1.1"></times><ci id="A1.E12.m1.21.21.21.21.21.21.1.2.cmml" xref="A1.E12.m1.21.21.21.21.21.21.1.2">𝜆</ci><ci id="A1.E12.m1.21.21.21.21.21.21.1.3.cmml" xref="A1.E12.m1.21.21.21.21.21.21.1.3">𝜃</ci></apply></apply><apply id="A1.E12.m1.29.29.1.1.1.3.2.cmml" xref="A1.E12.m1.30.30.2"><times id="A1.E12.m1.29.29.1.1.1.3.2.1.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a"></times><apply id="A1.E12.m1.29.29.1.1.1.3.2.2.cmml" xref="A1.E12.m1.30.30.2"><csymbol cd="ambiguous" id="A1.E12.m1.29.29.1.1.1.3.2.2.1.cmml" xref="A1.E12.m1.30.30.2.29.29.29.31a">subscript</csymbol><ci id="A1.E12.m1.22.22.22.22.22.22.cmml" xref="A1.E12.m1.22.22.22.22.22.22">ℒ</ci><ci id="A1.E12.m1.23.23.23.23.23.23.1.cmml" xref="A1.E12.m1.23.23.23.23.23.23.1">𝑇</ci></apply><interval closure="open" id="A1.E12.m1.29.29.1.1.1.3.2.3.cmml" xref="A1.E12.m1.30.30.2"><ci id="A1.E12.m1.25.25.25.25.25.25.cmml" xref="A1.E12.m1.25.25.25.25.25.25">𝜃</ci><ci id="A1.E12.m1.27.27.27.27.27.27.cmml" xref="A1.E12.m1.27.27.27.27.27.27">𝜆</ci></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.30c">\displaystyle\begin{split}\frac{d\theta^{*}}{d\lambda}=-\frac{\partial_{\theta}(\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta})}{\partial_{\lambda}\frac{d\mathcal{L}_{i,T}(\theta_{i}^{*},\lambda)}{d\theta}}=-(\partial_{\theta}^{2}\mathcal{L}_{T}(\theta,\lambda))^{-1}\&gt;\partial_{\lambda\theta}\mathcal{L}_{T}(\theta,\lambda)\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Positioning of FedL2P.</h2>

<figure id="A2.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A2.T7.2.1.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="A2.T7.3.2" class="ltx_text" style="font-size:90%;">Positioning of FedL2P with existing FL approaches. C is the total number of clients, M is the number of layers in the model, B is the number of BN layers in the model, D is the number of data domains, H is the number of hidden layers in the hypernetwork. </span></figcaption>
<div id="A2.T7.4" class="ltx_inline-block ltx_transformed_outer" style="width:368.6pt;height:408pt;vertical-align:-202.3pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.5pt,18.1pt) scale(0.850006087750882,0.850006087750882) ;">
<table id="A2.T7.4.1" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="A2.T7.4.1.1.1" class="ltx_tr">
<th id="A2.T7.4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.1.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">FL</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.1.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Approach</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.2.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Learns</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.2.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.2.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Shared</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.2.1.3" class="ltx_tr">
<td id="A2.T7.4.1.1.1.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.2.1.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Model(s)</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.3.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Personalized</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.3.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.3.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Layers</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.4.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.4.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Personalized</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.4.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.4.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Policy</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.4.1.3" class="ltx_tr">
<td id="A2.T7.4.1.1.1.4.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.4.1.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Obtained by?</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.5.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.5.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.5.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Personalized</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.5.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.5.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.5.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Policy</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.5.1.3" class="ltx_tr">
<td id="A2.T7.4.1.1.1.5.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.5.1.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Data Dependent?</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.6.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.6.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.6.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Targets</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.6.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.6.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Label Shift</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.7.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.7.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.7.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.7.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Targets</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.7.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.7.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.7.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Feature Shift</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.8.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.8.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.8.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.8.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Memory</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.8.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.8.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.8.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Cost</span></td>
</tr>
</table>
</th>
<th id="A2.T7.4.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.1.1.9.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.1.1.9.1.1" class="ltx_tr">
<td id="A2.T7.4.1.1.1.9.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.9.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Scale to</span></td>
</tr>
<tr id="A2.T7.4.1.1.1.9.1.2" class="ltx_tr">
<td id="A2.T7.4.1.1.1.9.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A2.T7.4.1.1.1.9.1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Large Networks</span></td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T7.4.1.2.1" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.2.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.2.1.1.1.1" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.1.1.1" class="ltx_text" style="font-size:70%;">FedProx </span><cite class="ltx_cite ltx_citemacro_cite">Li et al. <span id="A2.T7.4.1.2.1.1.1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.2.1.1.1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.2.1.1.1.2" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.2.1.1" class="ltx_text" style="font-size:70%;">PerFedAvg </span><cite class="ltx_cite ltx_citemacro_cite">Fallah et al. <span id="A2.T7.4.1.2.1.1.1.2.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.2.1.1.1.2.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.2.1.1.1.3" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.3.1.1" class="ltx_text" style="font-size:70%;">pFedMe </span><cite class="ltx_cite ltx_citemacro_cite">T Dinh et al. <span id="A2.T7.4.1.2.1.1.1.3.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib59" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.2.1.1.1.3.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.2.1.1.1.4" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.4.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.4.1.1" class="ltx_text" style="font-size:70%;">Ditto </span><cite class="ltx_cite ltx_citemacro_cite">Li et al. <span id="A2.T7.4.1.2.1.1.1.4.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib34" title="" class="ltx_ref">2021b</a><span id="A2.T7.4.1.2.1.1.1.4.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.2.1.1.1.5" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.5.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.5.1.1" class="ltx_text" style="font-size:70%;">MOON </span><cite class="ltx_cite ltx_citemacro_cite">Li et al. <span id="A2.T7.4.1.2.1.1.1.5.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">2021a</a><span id="A2.T7.4.1.2.1.1.1.5.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.2.1.1.1.6" class="ltx_tr">
<td id="A2.T7.4.1.2.1.1.1.6.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.2.1.1.1.6.1.1" class="ltx_text" style="font-size:70%;">FedBABU </span><cite class="ltx_cite ltx_citemacro_cite">Oh et al. <span id="A2.T7.4.1.2.1.1.1.6.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib48" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.2.1.1.1.6.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
</table>
</td>
<td id="A2.T7.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.3.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.2.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.2.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.2.1.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.3.2" class="ltx_tr">
<td id="A2.T7.4.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.3.2.1.1" class="ltx_text" style="font-size:70%;">PerFedMask </span><cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib54" title="" class="ltx_ref">Setayesh et al. </a></cite>
</td>
<td id="A2.T7.4.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.3.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.3.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.3.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.3.2.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.4.3" class="ltx_tr">
<td id="A2.T7.4.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.4.3.1.1" class="ltx_text" style="font-size:70%;">FedBN </span><cite class="ltx_cite ltx_citemacro_cite">Li et al. <span id="A2.T7.4.1.4.3.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib35" title="" class="ltx_ref">2021c</a><span id="A2.T7.4.1.4.3.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="A2.T7.4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.3.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.6.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.7.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.4.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.8.1" class="ltx_text" style="font-size:70%;">O(CB)</span></td>
<td id="A2.T7.4.1.4.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.4.3.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.5.4" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.5.4.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.5.4.1.1.1" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.5.4.1.1.1.1.1" class="ltx_text" style="font-size:70%;">FedPer </span><cite class="ltx_cite ltx_citemacro_cite">Arivazhagan et al. <span id="A2.T7.4.1.5.4.1.1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2019</a><span id="A2.T7.4.1.5.4.1.1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.5.4.1.1.2" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.5.4.1.1.2.1.1" class="ltx_text" style="font-size:70%;">FedRep </span><cite class="ltx_cite ltx_citemacro_cite">Collins et al. <span id="A2.T7.4.1.5.4.1.1.2.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.5.4.1.1.2.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.5.4.1.1.3" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.5.4.1.1.3.1.1" class="ltx_text" style="font-size:70%;">APFL </span><cite class="ltx_cite ltx_citemacro_cite">Deng et al. <span id="A2.T7.4.1.5.4.1.1.3.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.5.4.1.1.3.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.5.4.1.1.4" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1.1.4.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.5.4.1.1.4.1.1" class="ltx_text" style="font-size:70%;">LG-FedAvg </span><cite class="ltx_cite ltx_citemacro_cite">Liang et al. <span id="A2.T7.4.1.5.4.1.1.4.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib37" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.5.4.1.1.4.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.5.4.1.1.5" class="ltx_tr">
<td id="A2.T7.4.1.5.4.1.1.5.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.5.4.1.1.5.1.1" class="ltx_text" style="font-size:70%;">IFCA </span><cite class="ltx_cite ltx_citemacro_cite">Ghosh et al. <span id="A2.T7.4.1.5.4.1.1.5.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">2020</a><span id="A2.T7.4.1.5.4.1.1.5.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
</table>
</td>
<td id="A2.T7.4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.3.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.5.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.8.1" class="ltx_text" style="font-size:70%;">O(CM)</span></td>
<td id="A2.T7.4.1.5.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.5.4.9.1" class="ltx_text" style="font-size:70%;">✗</span></td>
</tr>
<tr id="A2.T7.4.1.6.5" class="ltx_tr">
<td id="A2.T7.4.1.6.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.6.5.1.1" class="ltx_text" style="font-size:70%;">FedDAR </span><cite class="ltx_cite ltx_citemacro_cite">Zhong et al. <span id="A2.T7.4.1.6.5.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib64" title="" class="ltx_ref">2023</a><span id="A2.T7.4.1.6.5.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="A2.T7.4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.3.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.6.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.6.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.7.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.6.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.8.1" class="ltx_text" style="font-size:70%;">O(DM)</span></td>
<td id="A2.T7.4.1.6.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.6.5.9.1" class="ltx_text" style="font-size:70%;">✗</span></td>
</tr>
<tr id="A2.T7.4.1.7.6" class="ltx_tr">
<td id="A2.T7.4.1.7.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.7.6.1.1" class="ltx_text" style="font-size:70%;">FLoRA </span><cite class="ltx_cite ltx_citemacro_cite">Zhou et al. <span id="A2.T7.4.1.7.6.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib65" title="" class="ltx_ref">2023</a><span id="A2.T7.4.1.7.6.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="A2.T7.4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.3.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.7.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.7.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.7.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.7.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.7.6.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.8.7" class="ltx_tr">
<td id="A2.T7.4.1.8.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.8.7.1.1" class="ltx_text" style="font-size:70%;">FedEx </span><cite class="ltx_cite ltx_citemacro_cite">Khodak et al. <span id="A2.T7.4.1.8.7.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib30" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.8.7.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="A2.T7.4.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.3.1" class="ltx_text" style="font-size:70%;">Supported</span></td>
<td id="A2.T7.4.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.4.1" class="ltx_text" style="font-size:70%;">Learned</span></td>
<td id="A2.T7.4.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.8.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.8.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.8.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.8.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.8.7.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.9.8" class="ltx_tr">
<td id="A2.T7.4.1.9.8.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="A2.T7.4.1.9.8.1.1" class="ltx_text" style="font-size:70%;">FedEM </span><cite class="ltx_cite ltx_citemacro_cite">Marfoq et al. <span id="A2.T7.4.1.9.8.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib43" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.9.8.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="A2.T7.4.1.9.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.3.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.9.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.9.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.9.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.9.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.9.8.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
<tr id="A2.T7.4.1.10.9" class="ltx_tr">
<td id="A2.T7.4.1.10.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.10.9.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.10.9.1.1.1" class="ltx_tr">
<td id="A2.T7.4.1.10.9.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.10.9.1.1.1.1.1" class="ltx_text" style="font-size:70%;">FedFOMO </span><cite class="ltx_cite ltx_citemacro_cite">Zhang et al. <span id="A2.T7.4.1.10.9.1.1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib62" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.10.9.1.1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.10.9.1.1.2" class="ltx_tr">
<td id="A2.T7.4.1.10.9.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.10.9.1.1.2.1.1" class="ltx_text" style="font-size:70%;">FedMe </span><cite class="ltx_cite ltx_citemacro_cite">Matsuda et al. <span id="A2.T7.4.1.10.9.1.1.2.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib44" title="" class="ltx_ref">2022a</a><span id="A2.T7.4.1.10.9.1.1.2.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
</table>
</td>
<td id="A2.T7.4.1.10.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.10.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.3.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.4.1" class="ltx_text" style="font-size:70%;">Fixed</span></td>
<td id="A2.T7.4.1.10.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.5.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.10.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.10.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.7.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.10.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.8.1" class="ltx_text" style="font-size:70%;">O(CM)</span></td>
<td id="A2.T7.4.1.10.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.10.9.9.1" class="ltx_text" style="font-size:70%;">✗</span></td>
</tr>
<tr id="A2.T7.4.1.11.10" class="ltx_tr">
<td id="A2.T7.4.1.11.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<table id="A2.T7.4.1.11.10.1.1" class="ltx_tabular ltx_align_middle">
<tr id="A2.T7.4.1.11.10.1.1.1" class="ltx_tr">
<td id="A2.T7.4.1.11.10.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.11.10.1.1.1.1.1" class="ltx_text" style="font-size:70%;">pFedHN </span><cite class="ltx_cite ltx_citemacro_cite">Shamsian et al. <span id="A2.T7.4.1.11.10.1.1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib55" title="" class="ltx_ref">2021</a><span id="A2.T7.4.1.11.10.1.1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
<tr id="A2.T7.4.1.11.10.1.1.2" class="ltx_tr">
<td id="A2.T7.4.1.11.10.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">
<span id="A2.T7.4.1.11.10.1.1.2.1.1" class="ltx_text" style="font-size:70%;">pFedLA </span><cite class="ltx_cite ltx_citemacro_cite">Ma et al. <span id="A2.T7.4.1.11.10.1.1.2.1.2.1.1.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib40" title="" class="ltx_ref">2022</a><span id="A2.T7.4.1.11.10.1.1.2.1.3.2.2.1" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
</tr>
</table>
</td>
<td id="A2.T7.4.1.11.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.11.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.3.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.11.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.4.1" class="ltx_text" style="font-size:70%;">Learned</span></td>
<td id="A2.T7.4.1.11.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.5.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.11.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.11.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.7.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.11.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.8.1" class="ltx_text" style="font-size:70%;">O(CMH)</span></td>
<td id="A2.T7.4.1.11.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T7.4.1.11.10.9.1" class="ltx_text" style="font-size:70%;">✗</span></td>
</tr>
<tr id="A2.T7.4.1.12.11" class="ltx_tr">
<td id="A2.T7.4.1.12.11.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.1.1" class="ltx_text" style="font-size:70%;">FedL2P (Ours)</span></td>
<td id="A2.T7.4.1.12.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="A2.T7.4.1.12.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.3.1" class="ltx_text" style="font-size:70%;">Supported</span></td>
<td id="A2.T7.4.1.12.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.4.1" class="ltx_text" style="font-size:70%;">Learned</span></td>
<td id="A2.T7.4.1.12.11.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.5.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.12.11.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.6.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.12.11.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.7.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="A2.T7.4.1.12.11.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.8.1" class="ltx_text" style="font-size:70%;">O(M)</span></td>
<td id="A2.T7.4.1.12.11.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A2.T7.4.1.12.11.9.1" class="ltx_text" style="font-size:70%;">✓</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">Table <a href="#A2.T7" title="Table 7 ‣ Appendix B Positioning of FedL2P. ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the positioning of FedL2P against existing literature. Note that this list is by no means exhaustive but representative to highlight the position of our work. Most existing approaches obtained personalized models using a personalized policy and local data, often through a finetuning-based approach. This personalized policy can either 1) be fixed, <span id="A2.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span> hand-crafting hyperparameters, layers to freeze, selecting number of mixture components, number of clusters or 2) learned, <span id="A2.p1.1.2" class="ltx_text ltx_font_italic">e.g.</span> learning a hypernetwork to generate weights or meta-nets to generate hyperparameters. These approaches are also grouped based on whether this personalized policy is dependent on the local data during inference, <span id="A2.p1.1.3" class="ltx_text ltx_font_italic">e.g.</span> meta-nets require local client meta-data to generate hyperparameters.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">In order to adapt to per-dataset per-client scenarios, many works rely on storing per-client personalized layers, which are trained only on each client’s local data. Unfortunately, the memory cost of storing these models scales with the number of clients, C, restricting previous works to small scale experiments. We show that these works are impractical in our CIFAR-10 setup of 1000 clients in Appendix. <a href="#A3" title="Appendix C Cost of FedL2P ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.
Moreover, most existing methods rely on a fixed personalized policy, such as deriving shared global hyperparameters for all clients in FLoRA, or they do not dependent on local data, such as FedEx which randomly samples per-client hyperparameters from learned categorical distributions. Hence, these methods do not adapt as well to per-dataset per-client scenarios and are ineffective at targeting both label and feature shifts. Lastly, although pFedHN and pFedLA target both label and feature shift cases, they do not scale well to our experiments as shown in Appendix. <a href="#A3" title="Appendix C Cost of FedL2P ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">Most importantly, all existing FL approaches shown in Table <a href="#A2.T7" title="Table 7 ‣ Appendix B Positioning of FedL2P. ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> can use finetuning either to personalize shared global model(s) or as a complementary personalization strategy to further adapt their personalized models. Since our proposed FedL2P focus on better personalizing shared global model(s) by learning better a personalized policy which leverages the clients’ local data statistics relative to the given pretrain model(s), our approach is complementary to all existing FL solutions that learn shared model(s); we showed improvements over a few of these works in Table <a href="#S4.T1" title="Table 1 ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.1" class="ltx_p"><span id="A2.p4.1.1" class="ltx_text ltx_font_bold">Use Cases of FedL2P</span> Mainstream FL focuses on training from scratch, but we focus on federated learning of a strategy to adapt an existing pre-trained model (whether obtained by FL or not) on an unseen group of clients with heterogeneous data. There are several scenarios where this setup and our solution would be useful:</p>
<ol id="A2.I1" class="ltx_enumerate">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.1" class="ltx_p">Scenarios where it’s expensive to train from scratch for a new group of clients, e.g. adopting FedEx <cite class="ltx_cite ltx_citemacro_cite">Khodak et al. [<a href="#bib.bib30" title="" class="ltx_ref">2021</a>]</cite> from scratch for a new group of clients would require thousands of rounds to retrain the model and HP while our method takes hundreds to learn two tiny meta-nets (Appendix. <a href="#A3" title="Appendix C Cost of FedL2P ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>).</p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.1" class="ltx_p">Scenarios where there is a publicly available pre-trained foundation model that can be exploited. This is illustrated in Section <a href="#S4.SS4" title="4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a> where we adapt a publicly available pretrained model trained using ImageNet on domain generalization datasets.</p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.1" class="ltx_p">Scenarios where it’s important to also maintain a global model with high initial accuracy - often neglected by previous personalized FL works.</p>
</div>
</li>
</ol>
</div>
<div id="A2.p5" class="ltx_para">
<p id="A2.p5.1" class="ltx_p">Note that our approach also does not critically depend on the global model’s performance. Even in the worst case where the input statistics derived from the global model are junk (e.g., they degenerate to a constant vector, or are simply a random noise vector), then it just means the hyperparameters learned are no longer input-dependent. In this case, FedL2P would effectively learn a constant vector of layer-wise learning rates + BN mixing ratio, as opposed to a function that predicts them. Thus, in this worst case we would lose the ability to customize the hyperparameters differently to different heterogeneous clients, but we would still be better off than the standard approach where these optimization hyperparameters are not learned. In the case where our global-model derived input features are better than this degenerate worst case, FedL2P’s meta-nets will improve on this already strong starting point.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Cost of FedL2P</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_bold">Computational Cost of Hessian Approximation.</span>
We compare with hessian-free approaches, namely first-order (FO) MAML and hessian-free (HF) MAML, both of which are used by PerFedAvg, and measure the time it took to compute the meta-gradient after fine-tuning. Specifically, we run 100 iterations of each algorithm and report the mean of the walltime. Our proposed method takes 0.24 seconds to compute the hypergradient, 0.12 seconds of which is used to approximate the Hessian. In comparison, FO-MAML took 0.08 seconds and HF-MAML took 0.16 seconds to compute the meta-gradient. Hence, our proposed method is not a significant overhead relative to simpler non-Hessian methods. It is also worth noting that the number of fine-tuning epochs would not impact the cost of computing the hypergradient.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p"><span id="A3.p2.1.1" class="ltx_text ltx_font_bold">Memory Cost.</span>
In our CIFAR10 experiments, the meta-update of FedL2P has a peak memory usage of 1.3GB. In contrast, existing FL methods that generate personalized policies require an order(s) of magnitude more memory and hence only evaluated in relatively small setups with smaller networks. For instance, pFedHN <cite class="ltx_cite ltx_citemacro_cite">Shamsian et al. [<a href="#bib.bib55" title="" class="ltx_ref">2021</a>]</cite> requires in a peak memory usage of 17.93GB in our CIFAR10 setup as its user embeddings and hypernetwork scale up with the number of clients and model size. Moreover, they fail to generate reasonable client weights as these techniques do not scale to larger ResNets used in our experiments. APFL <cite class="ltx_cite ltx_citemacro_cite">Deng et al. [<a href="#bib.bib14" title="" class="ltx_ref">2020</a>]</cite>, on the other hand, requires each client to maintain three models: local, global, and mixed personalized. Adopting APFL in our CIFAR10 setup of 1000 clients requires over 134GB of memory just to store the models per experiment, which is infeasible.</p>
</div>
<div id="A3.p3" class="ltx_para">
<p id="A3.p3.2" class="ltx_p"><span id="A3.p3.2.1" class="ltx_text ltx_font_bold">Communication Cost.</span>
For each FL round, we transmit the parameters of the meta-nets, which are lightweight MLP networks to from server to client and vice versa. Note that transmitting the global pretrained model to each new client is a one-time cost. Office-Caltech-10, DomainNet, and Speech Commands setups take a maximum of <math id="A3.p3.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A3.p3.1.m1.1a"><mn id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><cn type="integer" id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">100</annotation></semantics></math> communication rounds, 0.24% of the pretraining cost, to learn the meta-nets. CIFAR-10 and CIFAR-10-C, on the other hand, can take hundreds of rounds up to a maximum of <math id="A3.p3.2.m2.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A3.p3.2.m2.1a"><mn id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><cn type="integer" id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">500</annotation></semantics></math> rounds, 0.38% of the pretraining cost. In contrast, joint model and hyperparameter optimization typically takes thousands of rounds <cite class="ltx_cite ltx_citemacro_cite">Khodak et al. [<a href="#bib.bib30" title="" class="ltx_ref">2021</a>]</cite>, having to transmit both the model and the hyperparameter distribution across the network.
In summary, FedL2P incurs &lt;1% additional costs on top of pretraining and forgoes the cost of federatedly learning a model from scratch, which can be advantageous in certain scenarios as listed in Section. <a href="#A2" title="Appendix B Positioning of FedL2P. ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div id="A3.p4" class="ltx_para">
<p id="A3.p4.1" class="ltx_p"><span id="A3.p4.1.1" class="ltx_text ltx_font_bold">Inference Cost.</span>
During the fine-tuning stage, given the learned meta-nets, FedL2P requires 2 forward pass of the model per image and one forward pass of each meta-net to compute the personalized hyperparameters. This equates to  0.55GFLOPs per image and would incur a minor additional cost of 4.4% more than the regular finetuning process of 15 finetune epochs.

</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Pretrained Model and Setup Details</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">We use the Flower federated learning framework <cite class="ltx_cite ltx_citemacro_cite">Beutel et al. [<a href="#bib.bib6" title="" class="ltx_ref">2020</a>]</cite> and 8 NVIDIA GeForce RTX 2080 Ti GPUs for all experiments. ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">He et al. [<a href="#bib.bib20" title="" class="ltx_ref">2016</a>]</cite> is adopted with minor differences in the various setups:</p>
</div>
<div id="A4.p2" class="ltx_para">
<p id="A4.p2.16" class="ltx_p"><span id="A4.p2.16.1" class="ltx_text ltx_font_bold">CIFAR-10.</span> We replaced the first convolution with a smaller convolution <math id="A4.p2.1.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="A4.p2.1.m1.1a"><mrow id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml"><mn id="A4.p2.1.m1.1.1.2" xref="A4.p2.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A4.p2.1.m1.1.1.1" xref="A4.p2.1.m1.1.1.1.cmml">×</mo><mn id="A4.p2.1.m1.1.1.3" xref="A4.p2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><apply id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1"><times id="A4.p2.1.m1.1.1.1.cmml" xref="A4.p2.1.m1.1.1.1"></times><cn type="integer" id="A4.p2.1.m1.1.1.2.cmml" xref="A4.p2.1.m1.1.1.2">3</cn><cn type="integer" id="A4.p2.1.m1.1.1.3.cmml" xref="A4.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">3\times 3</annotation></semantics></math> kernel with stride<math id="A4.p2.2.m2.1" class="ltx_Math" alttext="=1" display="inline"><semantics id="A4.p2.2.m2.1a"><mrow id="A4.p2.2.m2.1.1" xref="A4.p2.2.m2.1.1.cmml"><mi id="A4.p2.2.m2.1.1.2" xref="A4.p2.2.m2.1.1.2.cmml"></mi><mo id="A4.p2.2.m2.1.1.1" xref="A4.p2.2.m2.1.1.1.cmml">=</mo><mn id="A4.p2.2.m2.1.1.3" xref="A4.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.2.m2.1b"><apply id="A4.p2.2.m2.1.1.cmml" xref="A4.p2.2.m2.1.1"><eq id="A4.p2.2.m2.1.1.1.cmml" xref="A4.p2.2.m2.1.1.1"></eq><csymbol cd="latexml" id="A4.p2.2.m2.1.1.2.cmml" xref="A4.p2.2.m2.1.1.2">absent</csymbol><cn type="integer" id="A4.p2.2.m2.1.1.3.cmml" xref="A4.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.2.m2.1c">=1</annotation></semantics></math> and padding<math id="A4.p2.3.m3.1" class="ltx_Math" alttext="=1" display="inline"><semantics id="A4.p2.3.m3.1a"><mrow id="A4.p2.3.m3.1.1" xref="A4.p2.3.m3.1.1.cmml"><mi id="A4.p2.3.m3.1.1.2" xref="A4.p2.3.m3.1.1.2.cmml"></mi><mo id="A4.p2.3.m3.1.1.1" xref="A4.p2.3.m3.1.1.1.cmml">=</mo><mn id="A4.p2.3.m3.1.1.3" xref="A4.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.3.m3.1b"><apply id="A4.p2.3.m3.1.1.cmml" xref="A4.p2.3.m3.1.1"><eq id="A4.p2.3.m3.1.1.1.cmml" xref="A4.p2.3.m3.1.1.1"></eq><csymbol cd="latexml" id="A4.p2.3.m3.1.1.2.cmml" xref="A4.p2.3.m3.1.1.2">absent</csymbol><cn type="integer" id="A4.p2.3.m3.1.1.3.cmml" xref="A4.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.3.m3.1c">=1</annotation></semantics></math> instead of the regular <math id="A4.p2.4.m4.1" class="ltx_Math" alttext="7\times 7" display="inline"><semantics id="A4.p2.4.m4.1a"><mrow id="A4.p2.4.m4.1.1" xref="A4.p2.4.m4.1.1.cmml"><mn id="A4.p2.4.m4.1.1.2" xref="A4.p2.4.m4.1.1.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="A4.p2.4.m4.1.1.1" xref="A4.p2.4.m4.1.1.1.cmml">×</mo><mn id="A4.p2.4.m4.1.1.3" xref="A4.p2.4.m4.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.4.m4.1b"><apply id="A4.p2.4.m4.1.1.cmml" xref="A4.p2.4.m4.1.1"><times id="A4.p2.4.m4.1.1.1.cmml" xref="A4.p2.4.m4.1.1.1"></times><cn type="integer" id="A4.p2.4.m4.1.1.2.cmml" xref="A4.p2.4.m4.1.1.2">7</cn><cn type="integer" id="A4.p2.4.m4.1.1.3.cmml" xref="A4.p2.4.m4.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.4.m4.1c">7\times 7</annotation></semantics></math> kernel. We also replaced the max pooling operation with the identity operation and set the number of output features of the last fully connected layer to 10. The model is pretrained in a federated manner using FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. [<a href="#bib.bib46" title="" class="ltx_ref">2017</a>]</cite> or FedBABU <cite class="ltx_cite ltx_citemacro_cite">Oh et al. [<a href="#bib.bib48" title="" class="ltx_ref">2021</a>]</cite> or PerFedAvg(HF) <cite class="ltx_cite ltx_citemacro_cite">Fallah et al. [<a href="#bib.bib15" title="" class="ltx_ref">2020</a>]</cite> with a starting learning rate of <math id="A4.p2.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A4.p2.5.m5.1a"><mn id="A4.p2.5.m5.1.1" xref="A4.p2.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A4.p2.5.m5.1b"><cn type="float" id="A4.p2.5.m5.1.1.cmml" xref="A4.p2.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.5.m5.1c">0.1</annotation></semantics></math> for <math id="A4.p2.6.m6.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A4.p2.6.m6.1a"><mn id="A4.p2.6.m6.1.1" xref="A4.p2.6.m6.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A4.p2.6.m6.1b"><cn type="integer" id="A4.p2.6.m6.1.1.cmml" xref="A4.p2.6.m6.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.6.m6.1c">500</annotation></semantics></math> communication rounds. For PerFedAvg, we adopted the recommended hyperparameters used by the authors to meta-train the model. The fraction ratio is set to <math id="A4.p2.7.m7.1" class="ltx_Math" alttext="r=0.1" display="inline"><semantics id="A4.p2.7.m7.1a"><mrow id="A4.p2.7.m7.1.1" xref="A4.p2.7.m7.1.1.cmml"><mi id="A4.p2.7.m7.1.1.2" xref="A4.p2.7.m7.1.1.2.cmml">r</mi><mo id="A4.p2.7.m7.1.1.1" xref="A4.p2.7.m7.1.1.1.cmml">=</mo><mn id="A4.p2.7.m7.1.1.3" xref="A4.p2.7.m7.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.7.m7.1b"><apply id="A4.p2.7.m7.1.1.cmml" xref="A4.p2.7.m7.1.1"><eq id="A4.p2.7.m7.1.1.1.cmml" xref="A4.p2.7.m7.1.1.1"></eq><ci id="A4.p2.7.m7.1.1.2.cmml" xref="A4.p2.7.m7.1.1.2">𝑟</ci><cn type="float" id="A4.p2.7.m7.1.1.3.cmml" xref="A4.p2.7.m7.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.7.m7.1c">r=0.1</annotation></semantics></math>; <math id="A4.p2.8.m8.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A4.p2.8.m8.1a"><mn id="A4.p2.8.m8.1.1" xref="A4.p2.8.m8.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A4.p2.8.m8.1b"><cn type="integer" id="A4.p2.8.m8.1.1.cmml" xref="A4.p2.8.m8.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.8.m8.1c">100</annotation></semantics></math> clients, each of who perform a single epoch update on its own local dataset before sending the updated model back to the server, participate per round. We dropped the learning rate by a factor of <math id="A4.p2.9.m9.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A4.p2.9.m9.1a"><mn id="A4.p2.9.m9.1.1" xref="A4.p2.9.m9.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A4.p2.9.m9.1b"><cn type="float" id="A4.p2.9.m9.1.1.cmml" xref="A4.p2.9.m9.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.9.m9.1c">0.1</annotation></semantics></math> at round <math id="A4.p2.10.m10.1" class="ltx_Math" alttext="250" display="inline"><semantics id="A4.p2.10.m10.1a"><mn id="A4.p2.10.m10.1.1" xref="A4.p2.10.m10.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="A4.p2.10.m10.1b"><cn type="integer" id="A4.p2.10.m10.1.1.cmml" xref="A4.p2.10.m10.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.10.m10.1c">250</annotation></semantics></math> and <math id="A4.p2.11.m11.1" class="ltx_Math" alttext="375" display="inline"><semantics id="A4.p2.11.m11.1a"><mn id="A4.p2.11.m11.1.1" xref="A4.p2.11.m11.1.1.cmml">375</mn><annotation-xml encoding="MathML-Content" id="A4.p2.11.m11.1b"><cn type="integer" id="A4.p2.11.m11.1.1.cmml" xref="A4.p2.11.m11.1.1">375</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.11.m11.1c">375</annotation></semantics></math>. This process is repeated for each <math id="A4.p2.12.m12.4" class="ltx_Math" alttext="\alpha={1000,1.0,0.5,0.1}" display="inline"><semantics id="A4.p2.12.m12.4a"><mrow id="A4.p2.12.m12.4.5" xref="A4.p2.12.m12.4.5.cmml"><mi id="A4.p2.12.m12.4.5.2" xref="A4.p2.12.m12.4.5.2.cmml">α</mi><mo id="A4.p2.12.m12.4.5.1" xref="A4.p2.12.m12.4.5.1.cmml">=</mo><mrow id="A4.p2.12.m12.4.5.3.2" xref="A4.p2.12.m12.4.5.3.1.cmml"><mn id="A4.p2.12.m12.1.1" xref="A4.p2.12.m12.1.1.cmml">1000</mn><mo id="A4.p2.12.m12.4.5.3.2.1" xref="A4.p2.12.m12.4.5.3.1.cmml">,</mo><mn id="A4.p2.12.m12.2.2" xref="A4.p2.12.m12.2.2.cmml">1.0</mn><mo id="A4.p2.12.m12.4.5.3.2.2" xref="A4.p2.12.m12.4.5.3.1.cmml">,</mo><mn id="A4.p2.12.m12.3.3" xref="A4.p2.12.m12.3.3.cmml">0.5</mn><mo id="A4.p2.12.m12.4.5.3.2.3" xref="A4.p2.12.m12.4.5.3.1.cmml">,</mo><mn id="A4.p2.12.m12.4.4" xref="A4.p2.12.m12.4.4.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.12.m12.4b"><apply id="A4.p2.12.m12.4.5.cmml" xref="A4.p2.12.m12.4.5"><eq id="A4.p2.12.m12.4.5.1.cmml" xref="A4.p2.12.m12.4.5.1"></eq><ci id="A4.p2.12.m12.4.5.2.cmml" xref="A4.p2.12.m12.4.5.2">𝛼</ci><list id="A4.p2.12.m12.4.5.3.1.cmml" xref="A4.p2.12.m12.4.5.3.2"><cn type="integer" id="A4.p2.12.m12.1.1.cmml" xref="A4.p2.12.m12.1.1">1000</cn><cn type="float" id="A4.p2.12.m12.2.2.cmml" xref="A4.p2.12.m12.2.2">1.0</cn><cn type="float" id="A4.p2.12.m12.3.3.cmml" xref="A4.p2.12.m12.3.3">0.5</cn><cn type="float" id="A4.p2.12.m12.4.4.cmml" xref="A4.p2.12.m12.4.4">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.12.m12.4c">\alpha={1000,1.0,0.5,0.1}</annotation></semantics></math>, resulting in a pretrained model for each group of clients. We experiment with various fine-tuning learning rates <math id="A4.p2.13.m13.6" class="ltx_Math" alttext="\{1.0,0.1,0.01,1e-3,1e-4,1e-5\}" display="inline"><semantics id="A4.p2.13.m13.6a"><mrow id="A4.p2.13.m13.6.6.3" xref="A4.p2.13.m13.6.6.4.cmml"><mo stretchy="false" id="A4.p2.13.m13.6.6.3.4" xref="A4.p2.13.m13.6.6.4.cmml">{</mo><mn id="A4.p2.13.m13.1.1" xref="A4.p2.13.m13.1.1.cmml">1.0</mn><mo id="A4.p2.13.m13.6.6.3.5" xref="A4.p2.13.m13.6.6.4.cmml">,</mo><mn id="A4.p2.13.m13.2.2" xref="A4.p2.13.m13.2.2.cmml">0.1</mn><mo id="A4.p2.13.m13.6.6.3.6" xref="A4.p2.13.m13.6.6.4.cmml">,</mo><mn id="A4.p2.13.m13.3.3" xref="A4.p2.13.m13.3.3.cmml">0.01</mn><mo id="A4.p2.13.m13.6.6.3.7" xref="A4.p2.13.m13.6.6.4.cmml">,</mo><mrow id="A4.p2.13.m13.4.4.1.1" xref="A4.p2.13.m13.4.4.1.1.cmml"><mrow id="A4.p2.13.m13.4.4.1.1.2" xref="A4.p2.13.m13.4.4.1.1.2.cmml"><mn id="A4.p2.13.m13.4.4.1.1.2.2" xref="A4.p2.13.m13.4.4.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p2.13.m13.4.4.1.1.2.1" xref="A4.p2.13.m13.4.4.1.1.2.1.cmml">​</mo><mi id="A4.p2.13.m13.4.4.1.1.2.3" xref="A4.p2.13.m13.4.4.1.1.2.3.cmml">e</mi></mrow><mo id="A4.p2.13.m13.4.4.1.1.1" xref="A4.p2.13.m13.4.4.1.1.1.cmml">−</mo><mn id="A4.p2.13.m13.4.4.1.1.3" xref="A4.p2.13.m13.4.4.1.1.3.cmml">3</mn></mrow><mo id="A4.p2.13.m13.6.6.3.8" xref="A4.p2.13.m13.6.6.4.cmml">,</mo><mrow id="A4.p2.13.m13.5.5.2.2" xref="A4.p2.13.m13.5.5.2.2.cmml"><mrow id="A4.p2.13.m13.5.5.2.2.2" xref="A4.p2.13.m13.5.5.2.2.2.cmml"><mn id="A4.p2.13.m13.5.5.2.2.2.2" xref="A4.p2.13.m13.5.5.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p2.13.m13.5.5.2.2.2.1" xref="A4.p2.13.m13.5.5.2.2.2.1.cmml">​</mo><mi id="A4.p2.13.m13.5.5.2.2.2.3" xref="A4.p2.13.m13.5.5.2.2.2.3.cmml">e</mi></mrow><mo id="A4.p2.13.m13.5.5.2.2.1" xref="A4.p2.13.m13.5.5.2.2.1.cmml">−</mo><mn id="A4.p2.13.m13.5.5.2.2.3" xref="A4.p2.13.m13.5.5.2.2.3.cmml">4</mn></mrow><mo id="A4.p2.13.m13.6.6.3.9" xref="A4.p2.13.m13.6.6.4.cmml">,</mo><mrow id="A4.p2.13.m13.6.6.3.3" xref="A4.p2.13.m13.6.6.3.3.cmml"><mrow id="A4.p2.13.m13.6.6.3.3.2" xref="A4.p2.13.m13.6.6.3.3.2.cmml"><mn id="A4.p2.13.m13.6.6.3.3.2.2" xref="A4.p2.13.m13.6.6.3.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p2.13.m13.6.6.3.3.2.1" xref="A4.p2.13.m13.6.6.3.3.2.1.cmml">​</mo><mi id="A4.p2.13.m13.6.6.3.3.2.3" xref="A4.p2.13.m13.6.6.3.3.2.3.cmml">e</mi></mrow><mo id="A4.p2.13.m13.6.6.3.3.1" xref="A4.p2.13.m13.6.6.3.3.1.cmml">−</mo><mn id="A4.p2.13.m13.6.6.3.3.3" xref="A4.p2.13.m13.6.6.3.3.3.cmml">5</mn></mrow><mo stretchy="false" id="A4.p2.13.m13.6.6.3.10" xref="A4.p2.13.m13.6.6.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.13.m13.6b"><set id="A4.p2.13.m13.6.6.4.cmml" xref="A4.p2.13.m13.6.6.3"><cn type="float" id="A4.p2.13.m13.1.1.cmml" xref="A4.p2.13.m13.1.1">1.0</cn><cn type="float" id="A4.p2.13.m13.2.2.cmml" xref="A4.p2.13.m13.2.2">0.1</cn><cn type="float" id="A4.p2.13.m13.3.3.cmml" xref="A4.p2.13.m13.3.3">0.01</cn><apply id="A4.p2.13.m13.4.4.1.1.cmml" xref="A4.p2.13.m13.4.4.1.1"><minus id="A4.p2.13.m13.4.4.1.1.1.cmml" xref="A4.p2.13.m13.4.4.1.1.1"></minus><apply id="A4.p2.13.m13.4.4.1.1.2.cmml" xref="A4.p2.13.m13.4.4.1.1.2"><times id="A4.p2.13.m13.4.4.1.1.2.1.cmml" xref="A4.p2.13.m13.4.4.1.1.2.1"></times><cn type="integer" id="A4.p2.13.m13.4.4.1.1.2.2.cmml" xref="A4.p2.13.m13.4.4.1.1.2.2">1</cn><ci id="A4.p2.13.m13.4.4.1.1.2.3.cmml" xref="A4.p2.13.m13.4.4.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A4.p2.13.m13.4.4.1.1.3.cmml" xref="A4.p2.13.m13.4.4.1.1.3">3</cn></apply><apply id="A4.p2.13.m13.5.5.2.2.cmml" xref="A4.p2.13.m13.5.5.2.2"><minus id="A4.p2.13.m13.5.5.2.2.1.cmml" xref="A4.p2.13.m13.5.5.2.2.1"></minus><apply id="A4.p2.13.m13.5.5.2.2.2.cmml" xref="A4.p2.13.m13.5.5.2.2.2"><times id="A4.p2.13.m13.5.5.2.2.2.1.cmml" xref="A4.p2.13.m13.5.5.2.2.2.1"></times><cn type="integer" id="A4.p2.13.m13.5.5.2.2.2.2.cmml" xref="A4.p2.13.m13.5.5.2.2.2.2">1</cn><ci id="A4.p2.13.m13.5.5.2.2.2.3.cmml" xref="A4.p2.13.m13.5.5.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A4.p2.13.m13.5.5.2.2.3.cmml" xref="A4.p2.13.m13.5.5.2.2.3">4</cn></apply><apply id="A4.p2.13.m13.6.6.3.3.cmml" xref="A4.p2.13.m13.6.6.3.3"><minus id="A4.p2.13.m13.6.6.3.3.1.cmml" xref="A4.p2.13.m13.6.6.3.3.1"></minus><apply id="A4.p2.13.m13.6.6.3.3.2.cmml" xref="A4.p2.13.m13.6.6.3.3.2"><times id="A4.p2.13.m13.6.6.3.3.2.1.cmml" xref="A4.p2.13.m13.6.6.3.3.2.1"></times><cn type="integer" id="A4.p2.13.m13.6.6.3.3.2.2.cmml" xref="A4.p2.13.m13.6.6.3.3.2.2">1</cn><ci id="A4.p2.13.m13.6.6.3.3.2.3.cmml" xref="A4.p2.13.m13.6.6.3.3.2.3">𝑒</ci></apply><cn type="integer" id="A4.p2.13.m13.6.6.3.3.3.cmml" xref="A4.p2.13.m13.6.6.3.3.3">5</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.13.m13.6c">\{1.0,0.1,0.01,1e-3,1e-4,1e-5\}</annotation></semantics></math> and pick the best-performing one, <math id="A4.p2.14.m14.1" class="ltx_Math" alttext="1e-3" display="inline"><semantics id="A4.p2.14.m14.1a"><mrow id="A4.p2.14.m14.1.1" xref="A4.p2.14.m14.1.1.cmml"><mrow id="A4.p2.14.m14.1.1.2" xref="A4.p2.14.m14.1.1.2.cmml"><mn id="A4.p2.14.m14.1.1.2.2" xref="A4.p2.14.m14.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p2.14.m14.1.1.2.1" xref="A4.p2.14.m14.1.1.2.1.cmml">​</mo><mi id="A4.p2.14.m14.1.1.2.3" xref="A4.p2.14.m14.1.1.2.3.cmml">e</mi></mrow><mo id="A4.p2.14.m14.1.1.1" xref="A4.p2.14.m14.1.1.1.cmml">−</mo><mn id="A4.p2.14.m14.1.1.3" xref="A4.p2.14.m14.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.14.m14.1b"><apply id="A4.p2.14.m14.1.1.cmml" xref="A4.p2.14.m14.1.1"><minus id="A4.p2.14.m14.1.1.1.cmml" xref="A4.p2.14.m14.1.1.1"></minus><apply id="A4.p2.14.m14.1.1.2.cmml" xref="A4.p2.14.m14.1.1.2"><times id="A4.p2.14.m14.1.1.2.1.cmml" xref="A4.p2.14.m14.1.1.2.1"></times><cn type="integer" id="A4.p2.14.m14.1.1.2.2.cmml" xref="A4.p2.14.m14.1.1.2.2">1</cn><ci id="A4.p2.14.m14.1.1.2.3.cmml" xref="A4.p2.14.m14.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A4.p2.14.m14.1.1.3.cmml" xref="A4.p2.14.m14.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.14.m14.1c">1e-3</annotation></semantics></math> for all experiments; the initial value of <math id="A4.p2.15.m15.1" class="ltx_Math" alttext="\tilde{\boldsymbol{\eta}}" display="inline"><semantics id="A4.p2.15.m15.1a"><mover accent="true" id="A4.p2.15.m15.1.1" xref="A4.p2.15.m15.1.1.cmml"><mi id="A4.p2.15.m15.1.1.2" xref="A4.p2.15.m15.1.1.2.cmml">𝜼</mi><mo id="A4.p2.15.m15.1.1.1" xref="A4.p2.15.m15.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A4.p2.15.m15.1b"><apply id="A4.p2.15.m15.1.1.cmml" xref="A4.p2.15.m15.1.1"><ci id="A4.p2.15.m15.1.1.1.cmml" xref="A4.p2.15.m15.1.1.1">~</ci><ci id="A4.p2.15.m15.1.1.2.cmml" xref="A4.p2.15.m15.1.1.2">𝜼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.15.m15.1c">\tilde{\boldsymbol{\eta}}</annotation></semantics></math> in FedL2P is also set at <math id="A4.p2.16.m16.1" class="ltx_Math" alttext="1e-3" display="inline"><semantics id="A4.p2.16.m16.1a"><mrow id="A4.p2.16.m16.1.1" xref="A4.p2.16.m16.1.1.cmml"><mrow id="A4.p2.16.m16.1.1.2" xref="A4.p2.16.m16.1.1.2.cmml"><mn id="A4.p2.16.m16.1.1.2.2" xref="A4.p2.16.m16.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p2.16.m16.1.1.2.1" xref="A4.p2.16.m16.1.1.2.1.cmml">​</mo><mi id="A4.p2.16.m16.1.1.2.3" xref="A4.p2.16.m16.1.1.2.3.cmml">e</mi></mrow><mo id="A4.p2.16.m16.1.1.1" xref="A4.p2.16.m16.1.1.1.cmml">−</mo><mn id="A4.p2.16.m16.1.1.3" xref="A4.p2.16.m16.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.16.m16.1b"><apply id="A4.p2.16.m16.1.1.cmml" xref="A4.p2.16.m16.1.1"><minus id="A4.p2.16.m16.1.1.1.cmml" xref="A4.p2.16.m16.1.1.1"></minus><apply id="A4.p2.16.m16.1.1.2.cmml" xref="A4.p2.16.m16.1.1.2"><times id="A4.p2.16.m16.1.1.2.1.cmml" xref="A4.p2.16.m16.1.1.2.1"></times><cn type="integer" id="A4.p2.16.m16.1.1.2.2.cmml" xref="A4.p2.16.m16.1.1.2.2">1</cn><ci id="A4.p2.16.m16.1.1.2.3.cmml" xref="A4.p2.16.m16.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A4.p2.16.m16.1.1.3.cmml" xref="A4.p2.16.m16.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.16.m16.1c">1e-3</annotation></semantics></math>.</p>
</div>
<div id="A4.p3" class="ltx_para">
<p id="A4.p3.1" class="ltx_p"><span id="A4.p3.1.1" class="ltx_text ltx_font_bold">CIFAR-10-C.</span> We adopted the pretrained model trained in CIFAR-10 for <math id="A4.p3.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A4.p3.1.m1.1a"><mrow id="A4.p3.1.m1.1.1" xref="A4.p3.1.m1.1.1.cmml"><mi id="A4.p3.1.m1.1.1.2" xref="A4.p3.1.m1.1.1.2.cmml">α</mi><mo id="A4.p3.1.m1.1.1.1" xref="A4.p3.1.m1.1.1.1.cmml">=</mo><mn id="A4.p3.1.m1.1.1.3" xref="A4.p3.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.1.m1.1b"><apply id="A4.p3.1.m1.1.1.cmml" xref="A4.p3.1.m1.1.1"><eq id="A4.p3.1.m1.1.1.1.cmml" xref="A4.p3.1.m1.1.1.1"></eq><ci id="A4.p3.1.m1.1.1.2.cmml" xref="A4.p3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A4.p3.1.m1.1.1.3.cmml" xref="A4.p3.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.1.m1.1c">\alpha=1000</annotation></semantics></math> and used the same fine-tuning learning rate for all experiments.</p>
</div>
<div id="A4.p4" class="ltx_para">
<p id="A4.p4.1" class="ltx_p"><span id="A4.p4.1.1" class="ltx_text ltx_font_bold">Office-Caltech-10 &amp; DomainNet.</span> We adopted a Resnet-18 model that was pretrained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">Deng et al. [<a href="#bib.bib13" title="" class="ltx_ref">2009</a>]</cite> and provided by torchvision <cite class="ltx_cite ltx_citemacro_cite">maintainers and contributors [<a href="#bib.bib41" title="" class="ltx_ref">2016</a>]</cite>. We replaced the number of output features of the last fully connected layer to 10. Similar to CIFAR-10 setup, we experiment with the same set of learning rates and pick the best-performing one, <math id="A4.p4.1.m1.1" class="ltx_Math" alttext="1e-2" display="inline"><semantics id="A4.p4.1.m1.1a"><mrow id="A4.p4.1.m1.1.1" xref="A4.p4.1.m1.1.1.cmml"><mrow id="A4.p4.1.m1.1.1.2" xref="A4.p4.1.m1.1.1.2.cmml"><mn id="A4.p4.1.m1.1.1.2.2" xref="A4.p4.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A4.p4.1.m1.1.1.2.1" xref="A4.p4.1.m1.1.1.2.1.cmml">​</mo><mi id="A4.p4.1.m1.1.1.2.3" xref="A4.p4.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A4.p4.1.m1.1.1.1" xref="A4.p4.1.m1.1.1.1.cmml">−</mo><mn id="A4.p4.1.m1.1.1.3" xref="A4.p4.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p4.1.m1.1b"><apply id="A4.p4.1.m1.1.1.cmml" xref="A4.p4.1.m1.1.1"><minus id="A4.p4.1.m1.1.1.1.cmml" xref="A4.p4.1.m1.1.1.1"></minus><apply id="A4.p4.1.m1.1.1.2.cmml" xref="A4.p4.1.m1.1.1.2"><times id="A4.p4.1.m1.1.1.2.1.cmml" xref="A4.p4.1.m1.1.1.2.1"></times><cn type="integer" id="A4.p4.1.m1.1.1.2.2.cmml" xref="A4.p4.1.m1.1.1.2.2">1</cn><ci id="A4.p4.1.m1.1.1.2.3.cmml" xref="A4.p4.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A4.p4.1.m1.1.1.3.cmml" xref="A4.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p4.1.m1.1c">1e-2</annotation></semantics></math> for our experiments.</p>
</div>
<div id="A4.p5" class="ltx_para">
<p id="A4.p5.2" class="ltx_p"><span id="A4.p5.2.1" class="ltx_text ltx_font_bold">Speech Commands.</span> We adopted the setup and hyperparameters from ZeroFL <cite class="ltx_cite ltx_citemacro_cite">Qiu et al. [<a href="#bib.bib52" title="" class="ltx_ref">2021</a>]</cite>; a Resnet-18 model is trained using FedAvg for 500 rounds using a starting learning rate of <math id="A4.p5.1.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A4.p5.1.m1.1a"><mn id="A4.p5.1.m1.1.1" xref="A4.p5.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A4.p5.1.m1.1b"><cn type="float" id="A4.p5.1.m1.1.1.cmml" xref="A4.p5.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p5.1.m1.1c">0.1</annotation></semantics></math> and an exponential learning rate decay schedule with a base learning rate of <math id="A4.p5.2.m2.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A4.p5.2.m2.1a"><mn id="A4.p5.2.m2.1.1" xref="A4.p5.2.m2.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A4.p5.2.m2.1b"><cn type="float" id="A4.p5.2.m2.1.1.cmml" xref="A4.p5.2.m2.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p5.2.m2.1c">0.01</annotation></semantics></math>. We use the base learning rate for fine-tuning for all experiments.</p>
</div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Architecture &amp; Initialization Details</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.8" class="ltx_p">We present the architecture of our proposed meta-nets, BNNet and LRNet. Both networks are 3-layer MLP models with 100 hidden layer neurons and ReLU <cite class="ltx_cite ltx_citemacro_cite">Agarap [<a href="#bib.bib1" title="" class="ltx_ref">2018</a>]</cite> activations in-between layers. BNNet and LRNet clamp the output to a value of <math id="A5.p1.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="A5.p1.1.m1.2a"><mrow id="A5.p1.1.m1.2.3.2" xref="A5.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="A5.p1.1.m1.2.3.2.1" xref="A5.p1.1.m1.2.3.1.cmml">[</mo><mn id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">0</mn><mo id="A5.p1.1.m1.2.3.2.2" xref="A5.p1.1.m1.2.3.1.cmml">,</mo><mn id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="A5.p1.1.m1.2.3.2.3" xref="A5.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.2b"><interval closure="closed" id="A5.p1.1.m1.2.3.1.cmml" xref="A5.p1.1.m1.2.3.2"><cn type="integer" id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1">0</cn><cn type="integer" id="A5.p1.1.m1.2.2.cmml" xref="A5.p1.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.2c">[0,1]</annotation></semantics></math> and <math id="A5.p1.2.m2.2" class="ltx_Math" alttext="[0,1000]" display="inline"><semantics id="A5.p1.2.m2.2a"><mrow id="A5.p1.2.m2.2.3.2" xref="A5.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="A5.p1.2.m2.2.3.2.1" xref="A5.p1.2.m2.2.3.1.cmml">[</mo><mn id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml">0</mn><mo id="A5.p1.2.m2.2.3.2.2" xref="A5.p1.2.m2.2.3.1.cmml">,</mo><mn id="A5.p1.2.m2.2.2" xref="A5.p1.2.m2.2.2.cmml">1000</mn><mo stretchy="false" id="A5.p1.2.m2.2.3.2.3" xref="A5.p1.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.2b"><interval closure="closed" id="A5.p1.2.m2.2.3.1.cmml" xref="A5.p1.2.m2.2.3.2"><cn type="integer" id="A5.p1.2.m2.1.1.cmml" xref="A5.p1.2.m2.1.1">0</cn><cn type="integer" id="A5.p1.2.m2.2.2.cmml" xref="A5.p1.2.m2.2.2">1000</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.2c">[0,1000]</annotation></semantics></math> respectively and use a straight-through estimator <cite class="ltx_cite ltx_citemacro_cite">Bengio et al. [<a href="#bib.bib4" title="" class="ltx_ref">2013</a>]</cite> (STE) to propagate gradients. We also tried using a sigmoid function for BNNet which converges to the same solution but at a much slower pace. We initialize the weights of BNNet and LRNet with Xavier initialization <cite class="ltx_cite ltx_citemacro_cite">Glorot and Bengio [<a href="#bib.bib18" title="" class="ltx_ref">2010</a>]</cite> using the normal distribution with a gain value of <math id="A5.p1.3.m3.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A5.p1.3.m3.1a"><mn id="A5.p1.3.m3.1.1" xref="A5.p1.3.m3.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A5.p1.3.m3.1b"><cn type="float" id="A5.p1.3.m3.1.1.cmml" xref="A5.p1.3.m3.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.m3.1c">0.1</annotation></semantics></math>. To control the starting initial value of BNNet and LRNet, we initialize the biases of BNNet and LRNet with constants <math id="A5.p1.4.m4.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A5.p1.4.m4.1a"><mn id="A5.p1.4.m4.1.1" xref="A5.p1.4.m4.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A5.p1.4.m4.1b"><cn type="float" id="A5.p1.4.m4.1.1.cmml" xref="A5.p1.4.m4.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m4.1c">0.5</annotation></semantics></math> and <math id="A5.p1.5.m5.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A5.p1.5.m5.1a"><mn id="A5.p1.5.m5.1.1" xref="A5.p1.5.m5.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A5.p1.5.m5.1b"><cn type="float" id="A5.p1.5.m5.1.1.cmml" xref="A5.p1.5.m5.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.5.m5.1c">1.0</annotation></semantics></math>, resulting in initial values of <math id="A5.p1.6.m6.1" class="ltx_Math" alttext="\sim 0.5" display="inline"><semantics id="A5.p1.6.m6.1a"><mrow id="A5.p1.6.m6.1.1" xref="A5.p1.6.m6.1.1.cmml"><mi id="A5.p1.6.m6.1.1.2" xref="A5.p1.6.m6.1.1.2.cmml"></mi><mo id="A5.p1.6.m6.1.1.1" xref="A5.p1.6.m6.1.1.1.cmml">∼</mo><mn id="A5.p1.6.m6.1.1.3" xref="A5.p1.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.6.m6.1b"><apply id="A5.p1.6.m6.1.1.cmml" xref="A5.p1.6.m6.1.1"><csymbol cd="latexml" id="A5.p1.6.m6.1.1.1.cmml" xref="A5.p1.6.m6.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A5.p1.6.m6.1.1.2.cmml" xref="A5.p1.6.m6.1.1.2">absent</csymbol><cn type="float" id="A5.p1.6.m6.1.1.3.cmml" xref="A5.p1.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.6.m6.1c">\sim 0.5</annotation></semantics></math> and <math id="A5.p1.7.m7.1" class="ltx_Math" alttext="\sim 1.0" display="inline"><semantics id="A5.p1.7.m7.1a"><mrow id="A5.p1.7.m7.1.1" xref="A5.p1.7.m7.1.1.cmml"><mi id="A5.p1.7.m7.1.1.2" xref="A5.p1.7.m7.1.1.2.cmml"></mi><mo id="A5.p1.7.m7.1.1.1" xref="A5.p1.7.m7.1.1.1.cmml">∼</mo><mn id="A5.p1.7.m7.1.1.3" xref="A5.p1.7.m7.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.7.m7.1b"><apply id="A5.p1.7.m7.1.1.cmml" xref="A5.p1.7.m7.1.1"><csymbol cd="latexml" id="A5.p1.7.m7.1.1.1.cmml" xref="A5.p1.7.m7.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A5.p1.7.m7.1.1.2.cmml" xref="A5.p1.7.m7.1.1.2">absent</csymbol><cn type="float" id="A5.p1.7.m7.1.1.3.cmml" xref="A5.p1.7.m7.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.7.m7.1c">\sim 1.0</annotation></semantics></math> respectively. We also tried experimenting BNNet with different initializations by setting the biases to <math id="A5.p1.8.m8.3" class="ltx_Math" alttext="[0.2,0.5,0.8]" display="inline"><semantics id="A5.p1.8.m8.3a"><mrow id="A5.p1.8.m8.3.4.2" xref="A5.p1.8.m8.3.4.1.cmml"><mo stretchy="false" id="A5.p1.8.m8.3.4.2.1" xref="A5.p1.8.m8.3.4.1.cmml">[</mo><mn id="A5.p1.8.m8.1.1" xref="A5.p1.8.m8.1.1.cmml">0.2</mn><mo id="A5.p1.8.m8.3.4.2.2" xref="A5.p1.8.m8.3.4.1.cmml">,</mo><mn id="A5.p1.8.m8.2.2" xref="A5.p1.8.m8.2.2.cmml">0.5</mn><mo id="A5.p1.8.m8.3.4.2.3" xref="A5.p1.8.m8.3.4.1.cmml">,</mo><mn id="A5.p1.8.m8.3.3" xref="A5.p1.8.m8.3.3.cmml">0.8</mn><mo stretchy="false" id="A5.p1.8.m8.3.4.2.4" xref="A5.p1.8.m8.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.8.m8.3b"><list id="A5.p1.8.m8.3.4.1.cmml" xref="A5.p1.8.m8.3.4.2"><cn type="float" id="A5.p1.8.m8.1.1.cmml" xref="A5.p1.8.m8.1.1">0.2</cn><cn type="float" id="A5.p1.8.m8.2.2.cmml" xref="A5.p1.8.m8.2.2">0.5</cn><cn type="float" id="A5.p1.8.m8.3.3.cmml" xref="A5.p1.8.m8.3.3">0.8</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.8.m8.3c">[0.2,0.5,0.8]</annotation></semantics></math> and got similar results.</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Additional Results</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.4" class="ltx_p"><span id="A6.p1.4.1" class="ltx_text ltx_font_bold">Relative Clustered Distance Maps</span>.
We present an extension of Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for both the inputs, <math id="A6.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\xi}" display="inline"><semantics id="A6.p1.1.m1.1a"><mi id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml">𝝃</mi><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.1b"><ci id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1">𝝃</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.1c">\boldsymbol{\xi}</annotation></semantics></math> &amp; <math id="A6.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{x}" display="inline"><semantics id="A6.p1.2.m2.1a"><mi id="A6.p1.2.m2.1.1" xref="A6.p1.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A6.p1.2.m2.1b"><ci id="A6.p1.2.m2.1.1.cmml" xref="A6.p1.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m2.1c">\boldsymbol{x}</annotation></semantics></math>, and outputs, <math id="A6.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="A6.p1.3.m3.1a"><mi id="A6.p1.3.m3.1.1" xref="A6.p1.3.m3.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A6.p1.3.m3.1b"><ci id="A6.p1.3.m3.1.1.cmml" xref="A6.p1.3.m3.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m3.1c">\boldsymbol{\beta}</annotation></semantics></math> &amp; <math id="A6.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="A6.p1.4.m4.1a"><mi id="A6.p1.4.m4.1.1" xref="A6.p1.4.m4.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="A6.p1.4.m4.1b"><ci id="A6.p1.4.m4.1.1.cmml" xref="A6.p1.4.m4.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.4.m4.1c">\boldsymbol{\eta}</annotation></semantics></math>, of the meta-nets in Fig. <a href="#A6.F5" title="Figure 5 ‣ Appendix F Additional Results ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="A6.p2" class="ltx_para">
<p id="A6.p2.1" class="ltx_p"><span id="A6.p2.1.1" class="ltx_text ltx_font_bold">Learned Personalized Hyperparameters</span>.
We present the learned hyperparameters for the other client groups not shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.2 Experiments on Marginal Label Shift ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in Fig. <a href="#A6.F4" title="Figure 4 ‣ Appendix F Additional Results ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="A6.p3" class="ltx_para">
<p id="A6.p3.2" class="ltx_p"><span id="A6.p3.2.1" class="ltx_text ltx_font_bold">Comparison with FOMAML</span>.
We remark that off-the-shelf FOMAML <cite class="ltx_cite ltx_citemacro_cite">Finn et al. [<a href="#bib.bib16" title="" class="ltx_ref">2017</a>]</cite> (as an initial condition learner) is not a meaningful point of comparison because our problem is to fine-tune/personalize pre-trained models. Therefore, to compare with FOMAML, we focus on learning our FedL2P meta-nets with FOMAML style meta-gradients instead of IFT meta-gradients. In order to apply FOMAML to learning rate optimization, this also required extending FOMAML with the same trick as we did for our IFT approach as shown in Eq. <a href="#S3.E9" title="Equation 9 ‣ 3.3 Adapting the Losses for IFT ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> &amp;  <a href="#S3.E10" title="Equation 10 ‣ 3.3 Adapting the Losses for IFT ‣ 3 Proposed Method ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. However, FOMAML ignores the learning trajectory except the last step, which may result in performance degradation over longer horizons. We term this baseline FOMAML+. Table. <a href="#A6.T8" title="Table 8 ‣ Appendix F Additional Results ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> reports results on the multi-domain datasets as described in Section. <a href="#S4.SS4" title="4.4 Personalizing to Different Domains ‣ 4 Evaluation ‣ FedL2P: Federated Learning to Personalize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>, keeping the same initial condition and meta representation (LRNet and BNNet meta-nets), and varying only the optimization algorithm. Our approach of using IFT to compute the best response Jacobian, outperforms FOMAML+ for <math id="A6.p3.1.m1.3" class="ltx_Math" alttext="\alpha=1000,1.0,0.5" display="inline"><semantics id="A6.p3.1.m1.3a"><mrow id="A6.p3.1.m1.3.4" xref="A6.p3.1.m1.3.4.cmml"><mi id="A6.p3.1.m1.3.4.2" xref="A6.p3.1.m1.3.4.2.cmml">α</mi><mo id="A6.p3.1.m1.3.4.1" xref="A6.p3.1.m1.3.4.1.cmml">=</mo><mrow id="A6.p3.1.m1.3.4.3.2" xref="A6.p3.1.m1.3.4.3.1.cmml"><mn id="A6.p3.1.m1.1.1" xref="A6.p3.1.m1.1.1.cmml">1000</mn><mo id="A6.p3.1.m1.3.4.3.2.1" xref="A6.p3.1.m1.3.4.3.1.cmml">,</mo><mn id="A6.p3.1.m1.2.2" xref="A6.p3.1.m1.2.2.cmml">1.0</mn><mo id="A6.p3.1.m1.3.4.3.2.2" xref="A6.p3.1.m1.3.4.3.1.cmml">,</mo><mn id="A6.p3.1.m1.3.3" xref="A6.p3.1.m1.3.3.cmml">0.5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.1.m1.3b"><apply id="A6.p3.1.m1.3.4.cmml" xref="A6.p3.1.m1.3.4"><eq id="A6.p3.1.m1.3.4.1.cmml" xref="A6.p3.1.m1.3.4.1"></eq><ci id="A6.p3.1.m1.3.4.2.cmml" xref="A6.p3.1.m1.3.4.2">𝛼</ci><list id="A6.p3.1.m1.3.4.3.1.cmml" xref="A6.p3.1.m1.3.4.3.2"><cn type="integer" id="A6.p3.1.m1.1.1.cmml" xref="A6.p3.1.m1.1.1">1000</cn><cn type="float" id="A6.p3.1.m1.2.2.cmml" xref="A6.p3.1.m1.2.2">1.0</cn><cn type="float" id="A6.p3.1.m1.3.3.cmml" xref="A6.p3.1.m1.3.3">0.5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.1.m1.3c">\alpha=1000,1.0,0.5</annotation></semantics></math> and has comparable performance for <math id="A6.p3.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A6.p3.2.m2.1a"><mrow id="A6.p3.2.m2.1.1" xref="A6.p3.2.m2.1.1.cmml"><mi id="A6.p3.2.m2.1.1.2" xref="A6.p3.2.m2.1.1.2.cmml">α</mi><mo id="A6.p3.2.m2.1.1.1" xref="A6.p3.2.m2.1.1.1.cmml">=</mo><mn id="A6.p3.2.m2.1.1.3" xref="A6.p3.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p3.2.m2.1b"><apply id="A6.p3.2.m2.1.1.cmml" xref="A6.p3.2.m2.1.1"><eq id="A6.p3.2.m2.1.1.1.cmml" xref="A6.p3.2.m2.1.1.1"></eq><ci id="A6.p3.2.m2.1.1.2.cmml" xref="A6.p3.2.m2.1.1.2">𝛼</ci><cn type="float" id="A6.p3.2.m2.1.1.3.cmml" xref="A6.p3.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p3.2.m2.1c">\alpha=0.1</annotation></semantics></math>.</p>
</div>
<figure id="A6.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A6.T8.5.2.1" class="ltx_text" style="font-size:90%;">Table 8</span>: </span><span id="A6.T8.2.1" class="ltx_text" style="font-size:90%;">Comparison between using FOMAML+ and IFT in FedL2P for Office-Caltech-10 and Domainnet (<math id="A6.T8.2.1.m1.1" class="ltx_Math" alttext="e=15" display="inline"><semantics id="A6.T8.2.1.m1.1b"><mrow id="A6.T8.2.1.m1.1.1" xref="A6.T8.2.1.m1.1.1.cmml"><mi id="A6.T8.2.1.m1.1.1.2" xref="A6.T8.2.1.m1.1.1.2.cmml">e</mi><mo id="A6.T8.2.1.m1.1.1.1" xref="A6.T8.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.T8.2.1.m1.1.1.3" xref="A6.T8.2.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.T8.2.1.m1.1c"><apply id="A6.T8.2.1.m1.1.1.cmml" xref="A6.T8.2.1.m1.1.1"><eq id="A6.T8.2.1.m1.1.1.1.cmml" xref="A6.T8.2.1.m1.1.1.1"></eq><ci id="A6.T8.2.1.m1.1.1.2.cmml" xref="A6.T8.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="A6.T8.2.1.m1.1.1.3.cmml" xref="A6.T8.2.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T8.2.1.m1.1d">e=15</annotation></semantics></math>).</span></figcaption>
<div id="A6.T8.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:109pt;vertical-align:-52.6pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<table id="A6.T8.3.1.1.1" class="ltx_tabular ltx_minipage ltx_align_middle" style="width:433.6pt;">
<thead class="ltx_thead">
<tr id="A6.T8.3.1.1.1.1" class="ltx_tr">
<th id="A6.T8.3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><math id="A6.T8.3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="A6.T8.3.1.1.1.1.1.m1.1a"><mi mathsize="70%" id="A6.T8.3.1.1.1.1.1.m1.1.1" xref="A6.T8.3.1.1.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A6.T8.3.1.1.1.1.1.m1.1b"><ci id="A6.T8.3.1.1.1.1.1.m1.1.1.cmml" xref="A6.T8.3.1.1.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T8.3.1.1.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></th>
<th id="A6.T8.3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Dataset</span></th>
<th id="A6.T8.3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FT (BN C)</span></th>
<th id="A6.T8.3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P (FOMAML+)</span></th>
<th id="A6.T8.3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">+FedL2P (IFT)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A6.T8.3.1.1.1.2.1" class="ltx_tr">
<td id="A6.T8.3.1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1000</span></td>
<td id="A6.T8.3.1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.2.1.2.1" class="ltx_text" style="font-size:70%;">Caltech-10</span></td>
<td id="A6.T8.3.1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.2.1.3.1" class="ltx_text" style="font-size:70%;">80.97±0.33</span></td>
<td id="A6.T8.3.1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.2.1.4.1" class="ltx_text" style="font-size:70%;">83.20±1.92</span></td>
<td id="A6.T8.3.1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.2.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">88.85±0.89</span></td>
</tr>
<tr id="A6.T8.3.1.1.1.3.2" class="ltx_tr">
<td id="A6.T8.3.1.1.1.3.2.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="A6.T8.3.1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r"><span id="A6.T8.3.1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="A6.T8.3.1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="A6.T8.3.1.1.1.3.2.3.1" class="ltx_text" style="font-size:70%;">52.17±1.55</span></td>
<td id="A6.T8.3.1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="A6.T8.3.1.1.1.3.2.4.1" class="ltx_text" style="font-size:70%;">52.70±0.17</span></td>
<td id="A6.T8.3.1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r"><span id="A6.T8.3.1.1.1.3.2.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">54.38±0.45</span></td>
</tr>
<tr id="A6.T8.3.1.1.1.4.3" class="ltx_tr">
<td id="A6.T8.3.1.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.4.3.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">1.0</span></td>
<td id="A6.T8.3.1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.4.3.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="A6.T8.3.1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.4.3.3.1" class="ltx_text" style="font-size:70%;">62.27±0.58</span></td>
<td id="A6.T8.3.1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.4.3.4.1" class="ltx_text" style="font-size:70%;">63.14±0.38</span></td>
<td id="A6.T8.3.1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.4.3.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">63.77±0.44</span></td>
</tr>
<tr id="A6.T8.3.1.1.1.5.4" class="ltx_tr">
<td id="A6.T8.3.1.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.5.4.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.5</span></td>
<td id="A6.T8.3.1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.5.4.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="A6.T8.3.1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.5.4.3.1" class="ltx_text" style="font-size:70%;">71.39±0.97</span></td>
<td id="A6.T8.3.1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.5.4.4.1" class="ltx_text" style="font-size:70%;">71.37±0.79</span></td>
<td id="A6.T8.3.1.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.5.4.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">72.64±0.3</span></td>
</tr>
<tr id="A6.T8.3.1.1.1.6.5" class="ltx_tr">
<td id="A6.T8.3.1.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.6.5.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">0.1</span></td>
<td id="A6.T8.3.1.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.6.5.2.1" class="ltx_text" style="font-size:70%;">DomainNet</span></td>
<td id="A6.T8.3.1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.6.5.3.1" class="ltx_text" style="font-size:70%;">86.03±0.47</span></td>
<td id="A6.T8.3.1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.6.5.4.1" class="ltx_text" style="font-size:70%;">86.22±0.16</span></td>
<td id="A6.T8.3.1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="A6.T8.3.1.1.1.6.5.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">86.36±0.45</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A6.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="" id="A6.F4.sf1.g1" class="ltx_graphics ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F4.sf1.4.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A6.F4.sf1.2.1" class="ltx_text" style="font-size:90%;">CIFAR10 (<math id="A6.F4.sf1.2.1.m1.1" class="ltx_Math" alttext="e=5" display="inline"><semantics id="A6.F4.sf1.2.1.m1.1b"><mrow id="A6.F4.sf1.2.1.m1.1.1" xref="A6.F4.sf1.2.1.m1.1.1.cmml"><mi id="A6.F4.sf1.2.1.m1.1.1.2" xref="A6.F4.sf1.2.1.m1.1.1.2.cmml">e</mi><mo id="A6.F4.sf1.2.1.m1.1.1.1" xref="A6.F4.sf1.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F4.sf1.2.1.m1.1.1.3" xref="A6.F4.sf1.2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F4.sf1.2.1.m1.1c"><apply id="A6.F4.sf1.2.1.m1.1.1.cmml" xref="A6.F4.sf1.2.1.m1.1.1"><eq id="A6.F4.sf1.2.1.m1.1.1.1.cmml" xref="A6.F4.sf1.2.1.m1.1.1.1"></eq><ci id="A6.F4.sf1.2.1.m1.1.1.2.cmml" xref="A6.F4.sf1.2.1.m1.1.1.2">𝑒</ci><cn type="integer" id="A6.F4.sf1.2.1.m1.1.1.3.cmml" xref="A6.F4.sf1.2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F4.sf1.2.1.m1.1d">e=5</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x9.png" id="A6.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="298" height="112" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A6.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Speech Commands</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A6.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="A6.F4.4.2" class="ltx_text" style="font-size:90%;">Locality, spread, and skewness of FedL2P’s learned hyperparameters, <math id="A6.F4.3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="A6.F4.3.1.m1.1b"><mi id="A6.F4.3.1.m1.1.1" xref="A6.F4.3.1.m1.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A6.F4.3.1.m1.1c"><ci id="A6.F4.3.1.m1.1.1.cmml" xref="A6.F4.3.1.m1.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F4.3.1.m1.1d">\boldsymbol{\beta}</annotation></semantics></math> and <math id="A6.F4.4.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="A6.F4.4.2.m2.1b"><mi id="A6.F4.4.2.m2.1.1" xref="A6.F4.4.2.m2.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="A6.F4.4.2.m2.1c"><ci id="A6.F4.4.2.m2.1.1.cmml" xref="A6.F4.4.2.m2.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F4.4.2.m2.1d">\boldsymbol{\eta}</annotation></semantics></math>, of different layers across clients and the model’s sparsity of all clients for each personalization scenario.</span></figcaption>
</figure>
<figure id="A6.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x10.png" id="A6.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="332" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.sf1.4.2.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A6.F5.sf1.2.1" class="ltx_text" style="font-size:90%;">Office-Caltech-10 (<math id="A6.F5.sf1.2.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A6.F5.sf1.2.1.m1.1b"><mrow id="A6.F5.sf1.2.1.m1.1.1" xref="A6.F5.sf1.2.1.m1.1.1.cmml"><mi id="A6.F5.sf1.2.1.m1.1.1.2" xref="A6.F5.sf1.2.1.m1.1.1.2.cmml">α</mi><mo id="A6.F5.sf1.2.1.m1.1.1.1" xref="A6.F5.sf1.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F5.sf1.2.1.m1.1.1.3" xref="A6.F5.sf1.2.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.sf1.2.1.m1.1c"><apply id="A6.F5.sf1.2.1.m1.1.1.cmml" xref="A6.F5.sf1.2.1.m1.1.1"><eq id="A6.F5.sf1.2.1.m1.1.1.1.cmml" xref="A6.F5.sf1.2.1.m1.1.1.1"></eq><ci id="A6.F5.sf1.2.1.m1.1.1.2.cmml" xref="A6.F5.sf1.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A6.F5.sf1.2.1.m1.1.1.3.cmml" xref="A6.F5.sf1.2.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.sf1.2.1.m1.1d">\alpha=1000</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x11.png" id="A6.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="332" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A6.F5.sf2.2.1" class="ltx_text" style="font-size:90%;">DomainNet (<math id="A6.F5.sf2.2.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="A6.F5.sf2.2.1.m1.1b"><mrow id="A6.F5.sf2.2.1.m1.1.1" xref="A6.F5.sf2.2.1.m1.1.1.cmml"><mi id="A6.F5.sf2.2.1.m1.1.1.2" xref="A6.F5.sf2.2.1.m1.1.1.2.cmml">α</mi><mo id="A6.F5.sf2.2.1.m1.1.1.1" xref="A6.F5.sf2.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F5.sf2.2.1.m1.1.1.3" xref="A6.F5.sf2.2.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.sf2.2.1.m1.1c"><apply id="A6.F5.sf2.2.1.m1.1.1.cmml" xref="A6.F5.sf2.2.1.m1.1.1"><eq id="A6.F5.sf2.2.1.m1.1.1.1.cmml" xref="A6.F5.sf2.2.1.m1.1.1.1"></eq><ci id="A6.F5.sf2.2.1.m1.1.1.2.cmml" xref="A6.F5.sf2.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A6.F5.sf2.2.1.m1.1.1.3.cmml" xref="A6.F5.sf2.2.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.sf2.2.1.m1.1d">\alpha=1000</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x12.png" id="A6.F5.sf3.g1" class="ltx_graphics ltx_img_landscape" width="332" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.sf3.4.2.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="A6.F5.sf3.2.1" class="ltx_text" style="font-size:90%;">DomainNet (<math id="A6.F5.sf3.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A6.F5.sf3.2.1.m1.1b"><mrow id="A6.F5.sf3.2.1.m1.1.1" xref="A6.F5.sf3.2.1.m1.1.1.cmml"><mi id="A6.F5.sf3.2.1.m1.1.1.2" xref="A6.F5.sf3.2.1.m1.1.1.2.cmml">α</mi><mo id="A6.F5.sf3.2.1.m1.1.1.1" xref="A6.F5.sf3.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F5.sf3.2.1.m1.1.1.3" xref="A6.F5.sf3.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.sf3.2.1.m1.1c"><apply id="A6.F5.sf3.2.1.m1.1.1.cmml" xref="A6.F5.sf3.2.1.m1.1.1"><eq id="A6.F5.sf3.2.1.m1.1.1.1.cmml" xref="A6.F5.sf3.2.1.m1.1.1.1"></eq><ci id="A6.F5.sf3.2.1.m1.1.1.2.cmml" xref="A6.F5.sf3.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A6.F5.sf3.2.1.m1.1.1.3.cmml" xref="A6.F5.sf3.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.sf3.2.1.m1.1d">\alpha=1.0</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F5.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x13.png" id="A6.F5.sf4.g1" class="ltx_graphics ltx_img_landscape" width="332" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.sf4.4.2.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="A6.F5.sf4.2.1" class="ltx_text" style="font-size:90%;">DomainNet (<math id="A6.F5.sf4.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A6.F5.sf4.2.1.m1.1b"><mrow id="A6.F5.sf4.2.1.m1.1.1" xref="A6.F5.sf4.2.1.m1.1.1.cmml"><mi id="A6.F5.sf4.2.1.m1.1.1.2" xref="A6.F5.sf4.2.1.m1.1.1.2.cmml">α</mi><mo id="A6.F5.sf4.2.1.m1.1.1.1" xref="A6.F5.sf4.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F5.sf4.2.1.m1.1.1.3" xref="A6.F5.sf4.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.sf4.2.1.m1.1c"><apply id="A6.F5.sf4.2.1.m1.1.1.cmml" xref="A6.F5.sf4.2.1.m1.1.1"><eq id="A6.F5.sf4.2.1.m1.1.1.1.cmml" xref="A6.F5.sf4.2.1.m1.1.1.1"></eq><ci id="A6.F5.sf4.2.1.m1.1.1.2.cmml" xref="A6.F5.sf4.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A6.F5.sf4.2.1.m1.1.1.3.cmml" xref="A6.F5.sf4.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.sf4.2.1.m1.1d">\alpha=0.5</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A6.F5.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02420/assets/x14.png" id="A6.F5.sf5.g1" class="ltx_graphics ltx_img_landscape" width="332" height="71" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.sf5.4.2.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="A6.F5.sf5.2.1" class="ltx_text" style="font-size:90%;">DomainNet (<math id="A6.F5.sf5.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A6.F5.sf5.2.1.m1.1b"><mrow id="A6.F5.sf5.2.1.m1.1.1" xref="A6.F5.sf5.2.1.m1.1.1.cmml"><mi id="A6.F5.sf5.2.1.m1.1.1.2" xref="A6.F5.sf5.2.1.m1.1.1.2.cmml">α</mi><mo id="A6.F5.sf5.2.1.m1.1.1.1" xref="A6.F5.sf5.2.1.m1.1.1.1.cmml">=</mo><mn id="A6.F5.sf5.2.1.m1.1.1.3" xref="A6.F5.sf5.2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.sf5.2.1.m1.1c"><apply id="A6.F5.sf5.2.1.m1.1.1.cmml" xref="A6.F5.sf5.2.1.m1.1.1"><eq id="A6.F5.sf5.2.1.m1.1.1.1.cmml" xref="A6.F5.sf5.2.1.m1.1.1.1"></eq><ci id="A6.F5.sf5.2.1.m1.1.1.2.cmml" xref="A6.F5.sf5.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A6.F5.sf5.2.1.m1.1.1.3.cmml" xref="A6.F5.sf5.2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.sf5.2.1.m1.1d">\alpha=0.1</annotation></semantics></math>)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A6.F5.17.8.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A6.F5.14.7" class="ltx_text" style="font-size:90%;">Cluster distance maps. Each block represents <span id="A6.F5.14.7.1" class="ltx_text ltx_font_italic">normalized</span> distance between two domains (e.g., Caltech vs. DSLR), where the distance of the block <math id="A6.F5.8.1.m1.2" class="ltx_Math" alttext="(j,k)" display="inline"><semantics id="A6.F5.8.1.m1.2b"><mrow id="A6.F5.8.1.m1.2.3.2" xref="A6.F5.8.1.m1.2.3.1.cmml"><mo stretchy="false" id="A6.F5.8.1.m1.2.3.2.1" xref="A6.F5.8.1.m1.2.3.1.cmml">(</mo><mi id="A6.F5.8.1.m1.1.1" xref="A6.F5.8.1.m1.1.1.cmml">j</mi><mo id="A6.F5.8.1.m1.2.3.2.2" xref="A6.F5.8.1.m1.2.3.1.cmml">,</mo><mi id="A6.F5.8.1.m1.2.2" xref="A6.F5.8.1.m1.2.2.cmml">k</mi><mo stretchy="false" id="A6.F5.8.1.m1.2.3.2.3" xref="A6.F5.8.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.F5.8.1.m1.2c"><interval closure="open" id="A6.F5.8.1.m1.2.3.1.cmml" xref="A6.F5.8.1.m1.2.3.2"><ci id="A6.F5.8.1.m1.1.1.cmml" xref="A6.F5.8.1.m1.1.1">𝑗</ci><ci id="A6.F5.8.1.m1.2.2.cmml" xref="A6.F5.8.1.m1.2.2">𝑘</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.8.1.m1.2d">(j,k)</annotation></semantics></math> is measured as the average of the Euclidean distances between all pairs of clients’ <math id="A6.F5.9.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\beta}" display="inline"><semantics id="A6.F5.9.2.m2.1b"><mi id="A6.F5.9.2.m2.1.1" xref="A6.F5.9.2.m2.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="A6.F5.9.2.m2.1c"><ci id="A6.F5.9.2.m2.1.1.cmml" xref="A6.F5.9.2.m2.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.9.2.m2.1d">\boldsymbol{\beta}</annotation></semantics></math> that belong to domain <math id="A6.F5.10.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="A6.F5.10.3.m3.1b"><mi id="A6.F5.10.3.m3.1.1" xref="A6.F5.10.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A6.F5.10.3.m3.1c"><ci id="A6.F5.10.3.m3.1.1.cmml" xref="A6.F5.10.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.10.3.m3.1d">j</annotation></semantics></math> and domain <math id="A6.F5.11.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A6.F5.11.4.m4.1b"><mi id="A6.F5.11.4.m4.1.1" xref="A6.F5.11.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A6.F5.11.4.m4.1c"><ci id="A6.F5.11.4.m4.1.1.cmml" xref="A6.F5.11.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.11.4.m4.1d">k</annotation></semantics></math> (similarly for <math id="A6.F5.12.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\eta}" display="inline"><semantics id="A6.F5.12.5.m5.1b"><mi id="A6.F5.12.5.m5.1.1" xref="A6.F5.12.5.m5.1.1.cmml">𝜼</mi><annotation-xml encoding="MathML-Content" id="A6.F5.12.5.m5.1c"><ci id="A6.F5.12.5.m5.1.1.cmml" xref="A6.F5.12.5.m5.1.1">𝜼</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.12.5.m5.1d">\boldsymbol{\eta}</annotation></semantics></math>’s). We normalize distance by the within-domain distances (see text), and take <math id="A6.F5.13.6.m6.1" class="ltx_Math" alttext="\log" display="inline"><semantics id="A6.F5.13.6.m6.1b"><mi id="A6.F5.13.6.m6.1.1" xref="A6.F5.13.6.m6.1.1.cmml">log</mi><annotation-xml encoding="MathML-Content" id="A6.F5.13.6.m6.1c"><log id="A6.F5.13.6.m6.1.1.cmml" xref="A6.F5.13.6.m6.1.1"></log></annotation-xml><annotation encoding="application/x-tex" id="A6.F5.13.6.m6.1d">\log</annotation></semantics></math> for better visualization. Hence, an off-diagonal block greater than <math id="A6.F5.14.7.m7.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A6.F5.14.7.m7.1b"><mn id="A6.F5.14.7.m7.1.1" xref="A6.F5.14.7.m7.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A6.F5.14.7.m7.1c"><cn type="integer" id="A6.F5.14.7.m7.1.1.cmml" xref="A6.F5.14.7.m7.1.1">0</cn></annotation-xml></semantics></math> indicates that the corresponding clusters are better aligned with the true domains.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.02419" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.02420" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.02420">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.02420" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.02421" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 02:21:17 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
