<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1511.05960] ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering</title><meta property="og:description" content="We propose a novel attention based deep learning architecture for visual question answering task (VQA).
Given an image and an image-related question, VQA returns a natural language answer.
Since different questions inq…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1511.05960">

<!--Generated on Sat Mar 16 01:23:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kan Chen
<br class="ltx_break">University of Southern California
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">kanchen@usc.edu</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiang Wang
<br class="ltx_break">Baidu Research - IDL
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">wangjiang03@baidu.com</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liang-Chieh Chen
<br class="ltx_break">UCLA
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">lcchen@cs.ucla.edu</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haoyuan Gao
<br class="ltx_break">Baidu Research - IDL
<br class="ltx_break"><span id="id4.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">gaohaoyuan@baidu.com</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wei Xu
<br class="ltx_break">Baidu Research - IDL
<br class="ltx_break"><span id="id5.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">wei.xu@baidu.com</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ram Nevatia
<br class="ltx_break">University of Southern California
<br class="ltx_break"><span id="id6.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">nevatia@usc.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">We propose a novel attention based deep learning architecture for visual question answering task (VQA).
Given an image and an image-related question, VQA returns a natural language answer.
Since different questions inquire about the attributes of different image regions, generating correct answers requires the model to have question-guided attention,
i.e., the attention on the regions corresponding to the input question’s intent.
We introduce an attention-based configurable convolutional neural network (ABC-CNN) to locate the question-guided attention based on input queries.
ABC-CNN determines the attention regions by finding the corresponding visual features in the visual feature maps with a “configurable convolution” operation.
With the help of the question-guided attention, ABC-CNN can achieve both higher VQA accuracy and better understanding of the visual question answering process.
We evaluate the ABC-CNN architecture on three benchmark VQA datasets: Toronto COCO-QA, DAQUAR, and VQA dataset. ABC-CNN model achieves significant improvements over state-of-the-art methods.
The question-guided attention generated by ABC-CNN is also shown to be the regions that are highly relevant to the questions’ intents.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is the task of answering questions, posed in natural language, about the semantic content in an image (or video).
Given an image and an image related question, VQA answers the question in one word or a natural language sentence.
VQA is of great importance to many applications, including image retrieval, early education, and navigation for blind people as it provides user-specific information through the understanding of both the natural language questions and image content.
VQA is a highly challenging problem as it requires the machine to understand natural language queries, extract semantic contents from images, and relate them in a unified framework.
In spite of these challenges, an exciting set of methods have been developed by the research community in recent years.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1511.05960/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="253" height="162" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Attention in visual question answering. For different questions, the corresponding attention region varies from white dashed box “coat” in the left image to the one “umbrella” in the right image.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Current state-of-the-art VQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> generally contain a vision part, a question understanding part and an answer generation part.
The vision part extracts visual features through a deep convolutional neural network (CNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> or using a traditional visual feature extractor.
The question understanding part learns a dense question embedding feature vector to encode question semantics, either with a Bag-of-Words model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> or a recurrent neural network (RNN)  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> model.
The answer generation part produces an answer conditioned on the visual features and the question embeddings.
The answer can either be a single word generated by a multi-class classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> or a full sentence generated by an additional RNN decoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
The visual features and dense question embeddings are integrated through a linear <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> / non-linear <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> transform which jointly projects the features from image space and semantic space into answer space.
This integration is normally not sufficient to fully exploit the relationship of the vision part and the question understanding part
because it loses the opportunity to exploit the intent of queries to focus on different regions in an image.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">When trying to answer a question about an image, humans tend to search the informative regions according to the question’s intent before giving the answer.
For example, in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, considering the query “What is the color of the coat?”, it is common for humans to focus attention on the region of coat before judging its color to answer the question.
Based on this observation, we propose a novel attention-based configurable convolutional neural network (ABC-CNN) to locate such informative regions and give more correct answers for VQA.
We call the mechanism of finding informative regions based on the input question’s intent as “<em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">question-guided attention</em>”, because these regions are determined by both images and image-related questions.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">As shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, ABC-CNN contains a vision part, a question understanding part, an answer generation part, and an attention extraction part.
We employ a CNN to extract visual features in the vision part. Instead of extracting a single global visual feature, we extract a spatial feature map to retain crucial spatial information, by either applying a CNN in a sliding window way or with a fully convolutional neural network.
A long-short term memory (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> model is used to obtain question embeddings in the question understanding part.
In this paper, we only consider the VQA task with single word answers which can be generated by utilizing a multi-class classifier in the answer generating part.
Our method can be extended to generate full sentences by using an RNN decoder.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We present the question-guided attention information as a question-guided attention map (QAM), which is the core of the ABC-CNN framework.
We model the QAM as latent information, and do not require explicit labeling of such maps for all kinds of possible queries.
The QAM is generated by searching for visual features that correspond to the input query’s semantics in the spatial image feature map.
We achieve the search via a configurable convolution neural network, which convolves the visual feature map with a configurable convolutional kernel (CCK).
This kernel is generated by transforming the question embeddings from the semantic space into the visual space, which contains the visual information determined by the intent of the question.
For example, in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the question “what is the color of the umbrella?” should generate a CCK that corresponds to the “umbrella” visual features.
Convolving the CCK with image feature map adaptively represents each region’s importance for answering the given question as a QAM.
The generated QAMs can be utilized to spatially weight the visual feature maps to filter out noise and unrelated information.
With the visual features conditioned on the input query, ABC-CNN can return more accurate answers from the multi-class classifier in answer generation part.
The whole framework can be trained in an end-to-end way without requiring any manual labeling of attention regions in images.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In the experiments, we evaluate the ABC-CNN framework on three benchmark VQA datasets: Toronto COCO-QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
Our method significantly outperforms state-of-the-art methods.
Visualization of attention maps demonstrates that the ABC-CNN architecture is capable of generating attention maps that well reflect the regions queried by questions.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, we propose a unified ABC-CNN framework to effectively integrate the visual and semantic information for VQA via question-guided attention.
Not only does the question guided attention significantly improve the performance of VQA systems, but it also helps us gain a better understanding of the question answering process.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/1511.05960/assets/x2.png" id="S1.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="196" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The framework of ABC-CNN. The green box denotes the image feature extraction part using CNN; the blue box is the question understanding part using LSTM; the yellow box illustrates the attention extraction part with configurable convolution; the red box is the answer generation part using multi-class classification based on attention weighted image feature maps. The orange letters are corresponding variables explained in Eq. (<a href="#S3.E1" title="In 3.1 Attention Extraction ‣ 3 Attention Based Configurable CNN ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) - (<a href="#S3.E6" title="In 3.4 Answer Generation ‣ 3 Attention Based Configurable CNN ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Image captioning:</span> VQA and image captioning are highly related because both of them need to reason about the visual contents and present the results in a full natural language sentence or in a word.
Current state-of-the-art methods in VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> generally apply a CNN to extract visual features and an LSTM model as a decoder to generate answers or captions.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> apply a multi-modal layer to combine the visual features and word embedding vectors by a joint projection during the caption generation in the LSTM decoder.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> employs the projected image features as the starting states of the LSTM decoder, similar to the encoder-decoder framework in sequence to sequence learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Treating image features as global visual features, these studies in VQA and image captioning fail to exploit the valuable information in questions to focus their attention on the corresponding regions in images.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Attention models:</span> Attention models have been successfully adopted in many computer vision tasks, including object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, fine-grained image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, and image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
Attention can be modeled as a region sequence in an image. An RNN model is utilized to predict the next attention region based on the current attention region’s location and visual features.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> employ this framework for object recognition, object detection, and fine-grained object recognition, respectively.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> develops an attention-based model for image captioning that uses an RNN as a decoder.
It extracts a set of proposal regions in each image, and learns their attention weights using the decoding LSTM decoder’s hidden states and the visual features extracted in each proposal region.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, a bilinear CNN structure utilizes two separate branches to combine the location and content information for fine-grained image classification.
ABC-CNN is inspired by the successful application of attention on these vision tasks and utilize <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">question-guided</span> attention to improve VQA performance.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Configurable convolutional neural network:</span>
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, a dynamic convolutional layer architecture is proposed for short range weather prediction.
The convolutional kernels in the dynamic convolutional layer are determined by a neural network encoding the information of weather images in previous time steps.
In VQA, the most important clue to determine the attention regions is the question.
Thus, the CCKs in ABC-CNN framework are determined by the question embedding.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Attention Based Configurable CNN</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The framework of ABC-CNN is illustrated in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
We restrict to QA pairs with single-word answers in this paper; this allows us to treat the task as a multi-class classification problem, which simplifies the evaluation metrics
so that we can concentrate on developing question-guided attention models.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.4" class="ltx_p">ABC-CNN is composed of four components: (1) the image feature extraction part, (2) the question understanding part, (3) the attention extraction part and (4) the answer generation part.
In the image feature extraction part (green box), a deep CNN is used to extract an image feature map <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathbf{I}</annotation></semantics></math> for each image as the image representation.
We utilize the VGG-19 deep convolutional neural network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> pretrained on 1000-class ImageNet classification challenge 2012 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and a fully convolutional segmentation neural network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> pretrained on PASCAL 2007 segmentation dataset.
The question understanding part (blue box) adopts an LSTM to learn a dense question embedding vector <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\bm{s}</annotation></semantics></math> to encode semantic information of an image-related question.
The attention extraction part (yellow box) configures a set of configurable convolutional kernels (CCK) according to different dense question embeddings.
These kernels, emphasizing the visual features of objects asked in the question, are convolved with the image feature maps to generate question-guided attention maps (QAM).
The answer generation part, shown in the red box, answers a question using a multi-class classifier based on the image feature map <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathbf{I}</annotation></semantics></math>, the attention weighted image feature map, and the dense question embedding vector <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\bm{s}</annotation></semantics></math>.
The rest of this section will describe each component of ABC-CNN framework in details.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Attention Extraction</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">A QAM, <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bm{m}</annotation></semantics></math>, capturing the image regions queried by the question, is generated for each image-question pair using a configurable convolutional neural network.
The configurable convolution operation can be thought of as searching spatial image feature maps for specific visual features that correspond to the question’s intent.
The specific visual features are encoded as a CCK <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{k}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒌</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\bm{k}</annotation></semantics></math> in this network, which is configured by projecting the dense question embedding <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\bm{s}</annotation></semantics></math> from semantic space to visual space.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\bm{k}=\sigma(\mathbf{W}_{sk}\bm{s}+\bm{b}_{k}),\text{\ \ \ }\sigma(x)=\frac{1}{1+e^{-x}}" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.3.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml">𝒌</mi><mo id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.cmml">𝒔</mi></mrow><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝒃</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.2.3" xref="S3.E1.m1.3.3.3a.cmml">,</mo><mrow id="S3.E1.m1.3.3.2.2" xref="S3.E1.m1.3.3.2.2.cmml"><mrow id="S3.E1.m1.3.3.2.2.2" xref="S3.E1.m1.3.3.2.2.2.cmml"><mtext id="S3.E1.m1.3.3.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2a.cmml"> </mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.2.2.1" xref="S3.E1.m1.3.3.2.2.2.1.cmml">​</mo><mi id="S3.E1.m1.3.3.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.2.2.1a" xref="S3.E1.m1.3.3.2.2.2.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.2.2.2.4.2" xref="S3.E1.m1.3.3.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.2.2.2.4.2.1" xref="S3.E1.m1.3.3.2.2.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.3.3.2.2.2.4.2.2" xref="S3.E1.m1.3.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.2.2.1" xref="S3.E1.m1.3.3.2.2.1.cmml">=</mo><mfrac id="S3.E1.m1.3.3.2.2.3" xref="S3.E1.m1.3.3.2.2.3.cmml"><mn id="S3.E1.m1.3.3.2.2.3.2" xref="S3.E1.m1.3.3.2.2.3.2.cmml">1</mn><mrow id="S3.E1.m1.3.3.2.2.3.3" xref="S3.E1.m1.3.3.2.2.3.3.cmml"><mn id="S3.E1.m1.3.3.2.2.3.3.2" xref="S3.E1.m1.3.3.2.2.3.3.2.cmml">1</mn><mo id="S3.E1.m1.3.3.2.2.3.3.1" xref="S3.E1.m1.3.3.2.2.3.3.1.cmml">+</mo><msup id="S3.E1.m1.3.3.2.2.3.3.3" xref="S3.E1.m1.3.3.2.2.3.3.3.cmml"><mi id="S3.E1.m1.3.3.2.2.3.3.3.2" xref="S3.E1.m1.3.3.2.2.3.3.3.2.cmml">e</mi><mrow id="S3.E1.m1.3.3.2.2.3.3.3.3" xref="S3.E1.m1.3.3.2.2.3.3.3.3.cmml"><mo id="S3.E1.m1.3.3.2.2.3.3.3.3a" xref="S3.E1.m1.3.3.2.2.3.3.3.3.cmml">−</mo><mi id="S3.E1.m1.3.3.2.2.3.3.3.3.2" xref="S3.E1.m1.3.3.2.2.3.3.3.3.2.cmml">x</mi></mrow></msup></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3a.cmml" xref="S3.E1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1"><eq id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></eq><ci id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3">𝒌</ci><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"></times><ci id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3">𝜎</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1"><plus id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2"><times id="S3.E1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.2">𝐖</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3"><times id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.3">𝒔</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.2">𝒃</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E1.m1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.2.2"><eq id="S3.E1.m1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1"></eq><apply id="S3.E1.m1.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2"><times id="S3.E1.m1.3.3.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2.1"></times><ci id="S3.E1.m1.3.3.2.2.2.2a.cmml" xref="S3.E1.m1.3.3.2.2.2.2"><mtext id="S3.E1.m1.3.3.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2"> </mtext></ci><ci id="S3.E1.m1.3.3.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.3">𝜎</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑥</ci></apply><apply id="S3.E1.m1.3.3.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.3"><divide id="S3.E1.m1.3.3.2.2.3.1.cmml" xref="S3.E1.m1.3.3.2.2.3"></divide><cn type="integer" id="S3.E1.m1.3.3.2.2.3.2.cmml" xref="S3.E1.m1.3.3.2.2.3.2">1</cn><apply id="S3.E1.m1.3.3.2.2.3.3.cmml" xref="S3.E1.m1.3.3.2.2.3.3"><plus id="S3.E1.m1.3.3.2.2.3.3.1.cmml" xref="S3.E1.m1.3.3.2.2.3.3.1"></plus><cn type="integer" id="S3.E1.m1.3.3.2.2.3.3.2.cmml" xref="S3.E1.m1.3.3.2.2.3.3.2">1</cn><apply id="S3.E1.m1.3.3.2.2.3.3.3.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.3.3.3.1.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3">superscript</csymbol><ci id="S3.E1.m1.3.3.2.2.3.3.3.2.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3.2">𝑒</ci><apply id="S3.E1.m1.3.3.2.2.3.3.3.3.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3.3"><minus id="S3.E1.m1.3.3.2.2.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3.3"></minus><ci id="S3.E1.m1.3.3.2.2.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.2.2.3.3.3.3.2">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\bm{k}=\sigma(\mathbf{W}_{sk}\bm{s}+\bm{b}_{k}),\text{\ \ \ }\sigma(x)=\frac{1}{1+e^{-x}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.1" class="ltx_p">where <math id="S3.SS1.p2.1.m1.1" class="ltx_math_unparsed" alttext="\sigma(.)" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1b"><mi id="S3.SS1.p2.1.m1.1.1">σ</mi><mrow id="S3.SS1.p2.1.m1.1.2"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS1.p2.1.m1.1.2.2">.</mo><mo stretchy="false" id="S3.SS1.p2.1.m1.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\sigma(.)</annotation></semantics></math> is a sigmoid function.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.2" class="ltx_p">The dense question embedding <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\bm{s}</annotation></semantics></math> encodes the semantic object information asked in the question.
The projection transforms the semantic information into the corresponding visual information as a CCK, which has the same number of channels as the image feature map <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{I}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.2" class="ltx_p">The QAM is generated by convolving the CCK <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\bm{k}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">𝒌</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝒌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\bm{k}</annotation></semantics></math> with the image feature map <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\mathbf{I}</annotation></semantics></math>,
and applying softmax normalization:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\bm{m}_{ij}=P(\text{ATT}_{ij}|\mathbf{I},\bm{s})=\frac{e^{\bm{z}_{ij}}}{\sum_{i}\sum_{j}e^{\bm{z}_{ij}}},\text{\ \ \ }\bm{z}=\bm{k}*\mathbf{I}" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.3.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">𝒎</mi><mrow id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.3.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.3.3.1.1.4" xref="S3.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml"><mtext id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2a.cmml">ATT</mtext><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐈</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝒔</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.5" xref="S3.E2.m1.3.3.1.1.5.cmml">=</mo><mfrac id="S3.E2.m1.3.3.1.1.6" xref="S3.E2.m1.3.3.1.1.6.cmml"><msup id="S3.E2.m1.3.3.1.1.6.2" xref="S3.E2.m1.3.3.1.1.6.2.cmml"><mi id="S3.E2.m1.3.3.1.1.6.2.2" xref="S3.E2.m1.3.3.1.1.6.2.2.cmml">e</mi><msub id="S3.E2.m1.3.3.1.1.6.2.3" xref="S3.E2.m1.3.3.1.1.6.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.6.2.3.2" xref="S3.E2.m1.3.3.1.1.6.2.3.2.cmml">𝒛</mi><mrow id="S3.E2.m1.3.3.1.1.6.2.3.3" xref="S3.E2.m1.3.3.1.1.6.2.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.6.2.3.3.2" xref="S3.E2.m1.3.3.1.1.6.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.6.2.3.3.1" xref="S3.E2.m1.3.3.1.1.6.2.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.6.2.3.3.3" xref="S3.E2.m1.3.3.1.1.6.2.3.3.3.cmml">j</mi></mrow></msub></msup><mrow id="S3.E2.m1.3.3.1.1.6.3" xref="S3.E2.m1.3.3.1.1.6.3.cmml"><msub id="S3.E2.m1.3.3.1.1.6.3.1" xref="S3.E2.m1.3.3.1.1.6.3.1.cmml"><mo id="S3.E2.m1.3.3.1.1.6.3.1.2" xref="S3.E2.m1.3.3.1.1.6.3.1.2.cmml">∑</mo><mi id="S3.E2.m1.3.3.1.1.6.3.1.3" xref="S3.E2.m1.3.3.1.1.6.3.1.3.cmml">i</mi></msub><mrow id="S3.E2.m1.3.3.1.1.6.3.2" xref="S3.E2.m1.3.3.1.1.6.3.2.cmml"><msub id="S3.E2.m1.3.3.1.1.6.3.2.1" xref="S3.E2.m1.3.3.1.1.6.3.2.1.cmml"><mo lspace="0.167em" id="S3.E2.m1.3.3.1.1.6.3.2.1.2" xref="S3.E2.m1.3.3.1.1.6.3.2.1.2.cmml">∑</mo><mi id="S3.E2.m1.3.3.1.1.6.3.2.1.3" xref="S3.E2.m1.3.3.1.1.6.3.2.1.3.cmml">j</mi></msub><msup id="S3.E2.m1.3.3.1.1.6.3.2.2" xref="S3.E2.m1.3.3.1.1.6.3.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.6.3.2.2.2" xref="S3.E2.m1.3.3.1.1.6.3.2.2.2.cmml">e</mi><msub id="S3.E2.m1.3.3.1.1.6.3.2.2.3" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.6.3.2.2.3.2" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.2.cmml">𝒛</mi><mrow id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.2" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.1" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.3" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.3.cmml">j</mi></mrow></msub></msup></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.3a.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mrow id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.2.2.cmml"><mtext id="S3.E2.m1.4.4.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2a.cmml"> </mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.2.1" xref="S3.E2.m1.4.4.2.2.2.1.cmml">​</mo><mi id="S3.E2.m1.4.4.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.3.cmml">𝒛</mi></mrow><mo id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.2.2.3.cmml"><mi id="S3.E2.m1.4.4.2.2.3.2" xref="S3.E2.m1.4.4.2.2.3.2.cmml">𝒌</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.4.4.2.2.3.1" xref="S3.E2.m1.4.4.2.2.3.1.cmml">∗</mo><mi id="S3.E2.m1.4.4.2.2.3.3" xref="S3.E2.m1.4.4.2.2.3.3.cmml">𝐈</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3a.cmml" xref="S3.E2.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><and id="S3.E2.m1.3.3.1.1a.cmml" xref="S3.E2.m1.3.3.1.1"></and><apply id="S3.E2.m1.3.3.1.1b.cmml" xref="S3.E2.m1.3.3.1.1"><eq id="S3.E2.m1.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.4"></eq><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">𝒎</ci><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><times id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2"></times><ci id="S3.E2.m1.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3">𝑃</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2"><mtext id="S3.E2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.2">ATT</mtext></ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3"><times id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><list id="S3.E2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐈</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝒔</ci></list></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1c.cmml" xref="S3.E2.m1.3.3.1.1"><eq id="S3.E2.m1.3.3.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.5"></eq><share href="#S3.E2.m1.3.3.1.1.1.cmml" id="S3.E2.m1.3.3.1.1d.cmml" xref="S3.E2.m1.3.3.1.1"></share><apply id="S3.E2.m1.3.3.1.1.6.cmml" xref="S3.E2.m1.3.3.1.1.6"><divide id="S3.E2.m1.3.3.1.1.6.1.cmml" xref="S3.E2.m1.3.3.1.1.6"></divide><apply id="S3.E2.m1.3.3.1.1.6.2.cmml" xref="S3.E2.m1.3.3.1.1.6.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.2.1.cmml" xref="S3.E2.m1.3.3.1.1.6.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.6.2.2.cmml" xref="S3.E2.m1.3.3.1.1.6.2.2">𝑒</ci><apply id="S3.E2.m1.3.3.1.1.6.2.3.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.6.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3.2">𝒛</ci><apply id="S3.E2.m1.3.3.1.1.6.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3.3"><times id="S3.E2.m1.3.3.1.1.6.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3.3.1"></times><ci id="S3.E2.m1.3.3.1.1.6.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.6.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.6.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1.6.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3"><apply id="S3.E2.m1.3.3.1.1.6.3.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.6.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.1.2"></sum><ci id="S3.E2.m1.3.3.1.1.6.3.1.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3.1.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.1.1.6.3.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2"><apply id="S3.E2.m1.3.3.1.1.6.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.3.2.1.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.6.3.2.1.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.1.2"></sum><ci id="S3.E2.m1.3.3.1.1.6.3.2.1.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.1.3">𝑗</ci></apply><apply id="S3.E2.m1.3.3.1.1.6.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.6.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.2">𝑒</ci><apply id="S3.E2.m1.3.3.1.1.6.3.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.6.3.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.6.3.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.2">𝒛</ci><apply id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3"><times id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.1"></times><ci id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.6.3.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><eq id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1"></eq><apply id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2"><times id="S3.E2.m1.4.4.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.1"></times><ci id="S3.E2.m1.4.4.2.2.2.2a.cmml" xref="S3.E2.m1.4.4.2.2.2.2"><mtext id="S3.E2.m1.4.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2"> </mtext></ci><ci id="S3.E2.m1.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3">𝒛</ci></apply><apply id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3"><times id="S3.E2.m1.4.4.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.3.1"></times><ci id="S3.E2.m1.4.4.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.3.2">𝒌</ci><ci id="S3.E2.m1.4.4.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3">𝐈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\bm{m}_{ij}=P(\text{ATT}_{ij}|\mathbf{I},\bm{s})=\frac{e^{\bm{z}_{ij}}}{\sum_{i}\sum_{j}e^{\bm{z}_{ij}}},\text{\ \ \ }\bm{z}=\bm{k}*\mathbf{I}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p5.4" class="ltx_p">where <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\bm{m}_{ij}" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">𝒎</mi><mrow id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml"><mi id="S3.SS1.p5.1.m1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.1.3.1" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p5.1.m1.1.1.3.3" xref="S3.SS1.p5.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝒎</ci><apply id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3"><times id="S3.SS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.1"></times><ci id="S3.SS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p5.1.m1.1.1.3.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\bm{m}_{ij}</annotation></semantics></math> is the element of the QAM at position <math id="S3.SS1.p5.2.m2.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS1.p5.2.m2.2a"><mrow id="S3.SS1.p5.2.m2.2.3.2" xref="S3.SS1.p5.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p5.2.m2.2.3.2.1" xref="S3.SS1.p5.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">i</mi><mo id="S3.SS1.p5.2.m2.2.3.2.2" xref="S3.SS1.p5.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.p5.2.m2.2.2" xref="S3.SS1.p5.2.m2.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS1.p5.2.m2.2.3.2.3" xref="S3.SS1.p5.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.2b"><interval closure="open" id="S3.SS1.p5.2.m2.2.3.1.cmml" xref="S3.SS1.p5.2.m2.2.3.2"><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝑖</ci><ci id="S3.SS1.p5.2.m2.2.2.cmml" xref="S3.SS1.p5.2.m2.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.2c">(i,j)</annotation></semantics></math>, and the symbol * represents the convolution operation.
The QAM characterizes the attention distribution across the image feature map.
The convolution is padded so that the QAM <math id="S3.SS1.p5.3.m3.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">\bm{m}</annotation></semantics></math> has the same size as the image feature map <math id="S3.SS1.p5.4.m4.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS1.p5.4.m4.1a"><mi id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><ci id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\mathbf{I}</annotation></semantics></math>.
The QAM corresponds to the regions asked by the question.
For example, the question “What is the color of the umbrella?” can generate an attention map focusing on umbrella image regions
because the CCK is configured to find umbrella visual features.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.1" class="ltx_p">With the attention map <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\bm{m}" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\bm{m}</annotation></semantics></math>, we can improve the question answering accuracy on various classes of questions for the following reasons:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">For counting questions, such as “how many cars in the image?”, the attention map filters out the unrelated regions, which makes it easier for the model to infer the number of objects in an image.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">For color (and more general attribute) questions, such as “what is the color of the coat?”, the color of the specific object can be answered more effectively by focusing on the object of interest.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">For object questions, such as “what is sitting on top of the desk?”, the attention map can filter out less relevant regions such as background and infer better locations to look for objects according to their spatial relationship.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">For location questions, such as “where is the car in the image?”, the attention map is crucial for generating the correct answers because it evidently describes where the object is in the image.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Question Understanding</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Question understanding is crucial for visual question answering.
The semantic meaning of questions not only provides the most important clue for answer generation, but also determines the CCKs to generate attention maps.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.9" class="ltx_p">Recently, LSTM model has shown good performances in language understanding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
We employ an LSTM model to generate a dense question embedding to characterize the semantic meaning of questions.
A question <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\bm{q}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bm{q}</annotation></semantics></math> is first tokenized into word sequence <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\{\bm{v}_{t}\}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">{</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p2.2.m2.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><set id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1"><apply id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2">𝒗</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\{\bm{v}_{t}\}</annotation></semantics></math>.
We convert all the upper case characters to lower case characters, and remove all the punctuations.
The words that appear in training set but are absent in test set are replaced with a special symbol <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\#OOV\#" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1a" xref="S3.SS2.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.4" xref="S3.SS2.p2.3.m3.1.1.4.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1b" xref="S3.SS2.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.5" xref="S3.SS2.p2.3.m3.1.1.5.cmml">V</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1c" xref="S3.SS2.p2.3.m3.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.3.m3.1.1.6" xref="S3.SS2.p2.3.m3.1.1.6.cmml">#</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><times id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></times><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">#</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑂</ci><ci id="S3.SS2.p2.3.m3.1.1.4.cmml" xref="S3.SS2.p2.3.m3.1.1.4">𝑂</ci><ci id="S3.SS2.p2.3.m3.1.1.5.cmml" xref="S3.SS2.p2.3.m3.1.1.5">𝑉</ci><ci id="S3.SS2.p2.3.m3.1.1.6.cmml" xref="S3.SS2.p2.3.m3.1.1.6">#</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\#OOV\#</annotation></semantics></math>.
Besides, <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\#B\#" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.1.1.1a" xref="S3.SS2.p2.4.m4.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.4.m4.1.1.4" xref="S3.SS2.p2.4.m4.1.1.4.cmml">#</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><times id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></times><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">#</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝐵</ci><ci id="S3.SS2.p2.4.m4.1.1.4.cmml" xref="S3.SS2.p2.4.m4.1.1.4">#</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\#B\#</annotation></semantics></math> and <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\#E\#" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">#</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.1.1a" xref="S3.SS2.p2.5.m5.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.5.m5.1.1.4" xref="S3.SS2.p2.5.m5.1.1.4.cmml">#</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><times id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1"></times><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">#</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝐸</ci><ci id="S3.SS2.p2.5.m5.1.1.4.cmml" xref="S3.SS2.p2.5.m5.1.1.4">#</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\#E\#</annotation></semantics></math> special symbols are added to the head and end of the sequence.
According to a <span id="S3.SS2.p2.9.1" class="ltx_text ltx_font_italic">question dictionary</span>, each word is represented as a dense word embedding vector, which is learned in an end-to-end way.
An LSTM is applied to the word embedding sequence to generate a state <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">𝒉</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝒉</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\bm{h}_{t}</annotation></semantics></math> from each vector <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\bm{v}_{t}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">𝒗</mi><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝒗</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\bm{v}_{t}</annotation></semantics></math>, using memory gate <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="\bm{c}_{t}" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><msub id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">𝒄</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝒄</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\bm{c}_{t}</annotation></semantics></math> and forget gate <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="\bm{f}_{t}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">𝒇</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝒇</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\bm{f}_{t}</annotation></semantics></math>, which is illustrated in Eq. <a href="#S3.E3" title="In 3.2 Question Understanding ‣ 3 Attention Based Configurable CNN ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E3.m1.107" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{i}_{t}&amp;=\sigma(\mathbf{W}_{vi}\bm{v}_{t}+\mathbf{W}_{hi}\bm{h}_{t-1}+\bm{b}_{i})\\
\bm{f}_{t}&amp;=\sigma(\mathbf{W}_{vf}\bm{v}_{t}+\mathbf{W}_{hf}\bm{h}_{t-1}+\bm{b}_{f})\\
\bm{o}_{t}&amp;=\sigma(\mathbf{W}_{vo}\bm{v}_{t}+\mathbf{W}_{ho}\bm{h}_{t-1}+\bm{b}_{o})\\
\bm{g}_{t}&amp;=\phi(\mathbf{W}_{vg}\bm{v}_{t}+\mathbf{W}_{hg}\bm{h}_{t-1}+\bm{b}_{g})\\
\bm{c}_{t}&amp;=\bm{f}_{t}\odot\bm{c}_{t-1}+\bm{i}_{t}\odot\bm{g}_{t}\\
\bm{h}_{t}&amp;=\bm{o}_{t}\odot\phi(\bm{c}_{t})\\
\end{split}" display="inline"><semantics id="S3.E3.m1.107a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E3.m1.107.107.10" xref="S3.E3.m1.102.102.5.cmml"><mtr id="S3.E3.m1.107.107.10a" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10b" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.2.2.2.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">𝒊</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10c" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.103.103.6.98.19.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.103.103.6.98.19.17.18" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.3.3.3.3.1.1" xref="S3.E3.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.103.103.6.98.19.17.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.4.4.4.4.2.2" xref="S3.E3.m1.4.4.4.4.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.103.103.6.98.19.17.17.2" xref="S3.E3.m1.102.102.5a.cmml">​</mo><mrow id="S3.E3.m1.103.103.6.98.19.17.17.1.1" xref="S3.E3.m1.102.102.5.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.5.5.3.3" xref="S3.E3.m1.102.102.5a.cmml">(</mo><mrow id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.6.6.6.6.4.4" xref="S3.E3.m1.6.6.6.6.4.4.cmml">𝐖</mi><mrow id="S3.E3.m1.7.7.7.7.5.5.1" xref="S3.E3.m1.7.7.7.7.5.5.1.cmml"><mi id="S3.E3.m1.7.7.7.7.5.5.1.2" xref="S3.E3.m1.7.7.7.7.5.5.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.7.7.7.7.5.5.1.1" xref="S3.E3.m1.7.7.7.7.5.5.1.1.cmml">​</mo><mi id="S3.E3.m1.7.7.7.7.5.5.1.3" xref="S3.E3.m1.7.7.7.7.5.5.1.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.1.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.8.8.8.8.6.6" xref="S3.E3.m1.8.8.8.8.6.6.cmml">𝒗</mi><mi id="S3.E3.m1.9.9.9.9.7.7.1" xref="S3.E3.m1.9.9.9.9.7.7.1.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.10.10.10.10.8.8" xref="S3.E3.m1.10.10.10.10.8.8.cmml">+</mo><mrow id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.2.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.11.11.11.11.9.9" xref="S3.E3.m1.11.11.11.11.9.9.cmml">𝐖</mi><mrow id="S3.E3.m1.12.12.12.12.10.10.1" xref="S3.E3.m1.12.12.12.12.10.10.1.cmml"><mi id="S3.E3.m1.12.12.12.12.10.10.1.2" xref="S3.E3.m1.12.12.12.12.10.10.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.12.12.12.12.10.10.1.1" xref="S3.E3.m1.12.12.12.12.10.10.1.1.cmml">​</mo><mi id="S3.E3.m1.12.12.12.12.10.10.1.3" xref="S3.E3.m1.12.12.12.12.10.10.1.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.2.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.2.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.13.13.13.13.11.11" xref="S3.E3.m1.13.13.13.13.11.11.cmml">𝒉</mi><mrow id="S3.E3.m1.14.14.14.14.12.12.1" xref="S3.E3.m1.14.14.14.14.12.12.1.cmml"><mi id="S3.E3.m1.14.14.14.14.12.12.1.2" xref="S3.E3.m1.14.14.14.14.12.12.1.2.cmml">t</mi><mo id="S3.E3.m1.14.14.14.14.12.12.1.1" xref="S3.E3.m1.14.14.14.14.12.12.1.1.cmml">−</mo><mn id="S3.E3.m1.14.14.14.14.12.12.1.3" xref="S3.E3.m1.14.14.14.14.12.12.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.10.10.10.10.8.8a" xref="S3.E3.m1.10.10.10.10.8.8.cmml">+</mo><msub id="S3.E3.m1.103.103.6.98.19.17.17.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.16.16.16.16.14.14" xref="S3.E3.m1.16.16.16.16.14.14.cmml">𝒃</mi><mi id="S3.E3.m1.17.17.17.17.15.15.1" xref="S3.E3.m1.17.17.17.17.15.15.1.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.18.18.18.18.16.16" xref="S3.E3.m1.102.102.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.107.107.10d" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10e" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.20.20.20.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.19.19.19.1.1.1" xref="S3.E3.m1.19.19.19.1.1.1.cmml">𝒇</mi><mi id="S3.E3.m1.20.20.20.2.2.2.1" xref="S3.E3.m1.20.20.20.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10f" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.104.104.7.99.19.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.104.104.7.99.19.17.18" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.21.21.21.3.1.1" xref="S3.E3.m1.21.21.21.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.104.104.7.99.19.17.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.22.22.22.4.2.2" xref="S3.E3.m1.22.22.22.4.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.104.104.7.99.19.17.17.2" xref="S3.E3.m1.102.102.5a.cmml">​</mo><mrow id="S3.E3.m1.104.104.7.99.19.17.17.1.1" xref="S3.E3.m1.102.102.5.cmml"><mo stretchy="false" id="S3.E3.m1.23.23.23.5.3.3" xref="S3.E3.m1.102.102.5a.cmml">(</mo><mrow id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.24.24.24.6.4.4" xref="S3.E3.m1.24.24.24.6.4.4.cmml">𝐖</mi><mrow id="S3.E3.m1.25.25.25.7.5.5.1" xref="S3.E3.m1.25.25.25.7.5.5.1.cmml"><mi id="S3.E3.m1.25.25.25.7.5.5.1.2" xref="S3.E3.m1.25.25.25.7.5.5.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.25.25.25.7.5.5.1.1" xref="S3.E3.m1.25.25.25.7.5.5.1.1.cmml">​</mo><mi id="S3.E3.m1.25.25.25.7.5.5.1.3" xref="S3.E3.m1.25.25.25.7.5.5.1.3.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.1.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.26.26.26.8.6.6" xref="S3.E3.m1.26.26.26.8.6.6.cmml">𝒗</mi><mi id="S3.E3.m1.27.27.27.9.7.7.1" xref="S3.E3.m1.27.27.27.9.7.7.1.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.28.28.28.10.8.8" xref="S3.E3.m1.28.28.28.10.8.8.cmml">+</mo><mrow id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.2.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.29.29.29.11.9.9" xref="S3.E3.m1.29.29.29.11.9.9.cmml">𝐖</mi><mrow id="S3.E3.m1.30.30.30.12.10.10.1" xref="S3.E3.m1.30.30.30.12.10.10.1.cmml"><mi id="S3.E3.m1.30.30.30.12.10.10.1.2" xref="S3.E3.m1.30.30.30.12.10.10.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.30.30.30.12.10.10.1.1" xref="S3.E3.m1.30.30.30.12.10.10.1.1.cmml">​</mo><mi id="S3.E3.m1.30.30.30.12.10.10.1.3" xref="S3.E3.m1.30.30.30.12.10.10.1.3.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.2.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.2.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.31.31.31.13.11.11" xref="S3.E3.m1.31.31.31.13.11.11.cmml">𝒉</mi><mrow id="S3.E3.m1.32.32.32.14.12.12.1" xref="S3.E3.m1.32.32.32.14.12.12.1.cmml"><mi id="S3.E3.m1.32.32.32.14.12.12.1.2" xref="S3.E3.m1.32.32.32.14.12.12.1.2.cmml">t</mi><mo id="S3.E3.m1.32.32.32.14.12.12.1.1" xref="S3.E3.m1.32.32.32.14.12.12.1.1.cmml">−</mo><mn id="S3.E3.m1.32.32.32.14.12.12.1.3" xref="S3.E3.m1.32.32.32.14.12.12.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.28.28.28.10.8.8a" xref="S3.E3.m1.28.28.28.10.8.8.cmml">+</mo><msub id="S3.E3.m1.104.104.7.99.19.17.17.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.34.34.34.16.14.14" xref="S3.E3.m1.34.34.34.16.14.14.cmml">𝒃</mi><mi id="S3.E3.m1.35.35.35.17.15.15.1" xref="S3.E3.m1.35.35.35.17.15.15.1.cmml">f</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.36.36.36.18.16.16" xref="S3.E3.m1.102.102.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.107.107.10g" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10h" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.38.38.38.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.37.37.37.1.1.1" xref="S3.E3.m1.37.37.37.1.1.1.cmml">𝒐</mi><mi id="S3.E3.m1.38.38.38.2.2.2.1" xref="S3.E3.m1.38.38.38.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10i" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.105.105.8.100.19.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.105.105.8.100.19.17.18" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.39.39.39.3.1.1" xref="S3.E3.m1.39.39.39.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.105.105.8.100.19.17.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.40.40.40.4.2.2" xref="S3.E3.m1.40.40.40.4.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.105.105.8.100.19.17.17.2" xref="S3.E3.m1.102.102.5a.cmml">​</mo><mrow id="S3.E3.m1.105.105.8.100.19.17.17.1.1" xref="S3.E3.m1.102.102.5.cmml"><mo stretchy="false" id="S3.E3.m1.41.41.41.5.3.3" xref="S3.E3.m1.102.102.5a.cmml">(</mo><mrow id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.42.42.42.6.4.4" xref="S3.E3.m1.42.42.42.6.4.4.cmml">𝐖</mi><mrow id="S3.E3.m1.43.43.43.7.5.5.1" xref="S3.E3.m1.43.43.43.7.5.5.1.cmml"><mi id="S3.E3.m1.43.43.43.7.5.5.1.2" xref="S3.E3.m1.43.43.43.7.5.5.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.43.43.43.7.5.5.1.1" xref="S3.E3.m1.43.43.43.7.5.5.1.1.cmml">​</mo><mi id="S3.E3.m1.43.43.43.7.5.5.1.3" xref="S3.E3.m1.43.43.43.7.5.5.1.3.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.1.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.44.44.44.8.6.6" xref="S3.E3.m1.44.44.44.8.6.6.cmml">𝒗</mi><mi id="S3.E3.m1.45.45.45.9.7.7.1" xref="S3.E3.m1.45.45.45.9.7.7.1.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.46.46.46.10.8.8" xref="S3.E3.m1.46.46.46.10.8.8.cmml">+</mo><mrow id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.2.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.47.47.47.11.9.9" xref="S3.E3.m1.47.47.47.11.9.9.cmml">𝐖</mi><mrow id="S3.E3.m1.48.48.48.12.10.10.1" xref="S3.E3.m1.48.48.48.12.10.10.1.cmml"><mi id="S3.E3.m1.48.48.48.12.10.10.1.2" xref="S3.E3.m1.48.48.48.12.10.10.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.48.48.48.12.10.10.1.1" xref="S3.E3.m1.48.48.48.12.10.10.1.1.cmml">​</mo><mi id="S3.E3.m1.48.48.48.12.10.10.1.3" xref="S3.E3.m1.48.48.48.12.10.10.1.3.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.2.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.2.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.49.49.49.13.11.11" xref="S3.E3.m1.49.49.49.13.11.11.cmml">𝒉</mi><mrow id="S3.E3.m1.50.50.50.14.12.12.1" xref="S3.E3.m1.50.50.50.14.12.12.1.cmml"><mi id="S3.E3.m1.50.50.50.14.12.12.1.2" xref="S3.E3.m1.50.50.50.14.12.12.1.2.cmml">t</mi><mo id="S3.E3.m1.50.50.50.14.12.12.1.1" xref="S3.E3.m1.50.50.50.14.12.12.1.1.cmml">−</mo><mn id="S3.E3.m1.50.50.50.14.12.12.1.3" xref="S3.E3.m1.50.50.50.14.12.12.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.46.46.46.10.8.8a" xref="S3.E3.m1.46.46.46.10.8.8.cmml">+</mo><msub id="S3.E3.m1.105.105.8.100.19.17.17.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.52.52.52.16.14.14" xref="S3.E3.m1.52.52.52.16.14.14.cmml">𝒃</mi><mi id="S3.E3.m1.53.53.53.17.15.15.1" xref="S3.E3.m1.53.53.53.17.15.15.1.cmml">o</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.54.54.54.18.16.16" xref="S3.E3.m1.102.102.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.107.107.10j" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10k" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.56.56.56.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.55.55.55.1.1.1" xref="S3.E3.m1.55.55.55.1.1.1.cmml">𝒈</mi><mi id="S3.E3.m1.56.56.56.2.2.2.1" xref="S3.E3.m1.56.56.56.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10l" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.106.106.9.101.19.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.106.106.9.101.19.17.18" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.57.57.57.3.1.1" xref="S3.E3.m1.57.57.57.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.106.106.9.101.19.17.17" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.58.58.58.4.2.2" xref="S3.E3.m1.58.58.58.4.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.106.106.9.101.19.17.17.2" xref="S3.E3.m1.102.102.5a.cmml">​</mo><mrow id="S3.E3.m1.106.106.9.101.19.17.17.1.1" xref="S3.E3.m1.102.102.5.cmml"><mo stretchy="false" id="S3.E3.m1.59.59.59.5.3.3" xref="S3.E3.m1.102.102.5a.cmml">(</mo><mrow id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.60.60.60.6.4.4" xref="S3.E3.m1.60.60.60.6.4.4.cmml">𝐖</mi><mrow id="S3.E3.m1.61.61.61.7.5.5.1" xref="S3.E3.m1.61.61.61.7.5.5.1.cmml"><mi id="S3.E3.m1.61.61.61.7.5.5.1.2" xref="S3.E3.m1.61.61.61.7.5.5.1.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.61.61.61.7.5.5.1.1" xref="S3.E3.m1.61.61.61.7.5.5.1.1.cmml">​</mo><mi id="S3.E3.m1.61.61.61.7.5.5.1.3" xref="S3.E3.m1.61.61.61.7.5.5.1.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.1.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.62.62.62.8.6.6" xref="S3.E3.m1.62.62.62.8.6.6.cmml">𝒗</mi><mi id="S3.E3.m1.63.63.63.9.7.7.1" xref="S3.E3.m1.63.63.63.9.7.7.1.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.64.64.64.10.8.8" xref="S3.E3.m1.64.64.64.10.8.8.cmml">+</mo><mrow id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.2" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.2.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.65.65.65.11.9.9" xref="S3.E3.m1.65.65.65.11.9.9.cmml">𝐖</mi><mrow id="S3.E3.m1.66.66.66.12.10.10.1" xref="S3.E3.m1.66.66.66.12.10.10.1.cmml"><mi id="S3.E3.m1.66.66.66.12.10.10.1.2" xref="S3.E3.m1.66.66.66.12.10.10.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.66.66.66.12.10.10.1.1" xref="S3.E3.m1.66.66.66.12.10.10.1.1.cmml">​</mo><mi id="S3.E3.m1.66.66.66.12.10.10.1.3" xref="S3.E3.m1.66.66.66.12.10.10.1.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.2.1" xref="S3.E3.m1.102.102.5a.cmml">​</mo><msub id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.2.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.67.67.67.13.11.11" xref="S3.E3.m1.67.67.67.13.11.11.cmml">𝒉</mi><mrow id="S3.E3.m1.68.68.68.14.12.12.1" xref="S3.E3.m1.68.68.68.14.12.12.1.cmml"><mi id="S3.E3.m1.68.68.68.14.12.12.1.2" xref="S3.E3.m1.68.68.68.14.12.12.1.2.cmml">t</mi><mo id="S3.E3.m1.68.68.68.14.12.12.1.1" xref="S3.E3.m1.68.68.68.14.12.12.1.1.cmml">−</mo><mn id="S3.E3.m1.68.68.68.14.12.12.1.3" xref="S3.E3.m1.68.68.68.14.12.12.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.64.64.64.10.8.8a" xref="S3.E3.m1.64.64.64.10.8.8.cmml">+</mo><msub id="S3.E3.m1.106.106.9.101.19.17.17.1.1.1.3" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.70.70.70.16.14.14" xref="S3.E3.m1.70.70.70.16.14.14.cmml">𝒃</mi><mi id="S3.E3.m1.71.71.71.17.15.15.1" xref="S3.E3.m1.71.71.71.17.15.15.1.cmml">g</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.72.72.72.18.16.16" xref="S3.E3.m1.102.102.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.107.107.10m" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10n" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.74.74.74.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.73.73.73.1.1.1" xref="S3.E3.m1.73.73.73.1.1.1.cmml">𝒄</mi><mi id="S3.E3.m1.74.74.74.2.2.2.1" xref="S3.E3.m1.74.74.74.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10o" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.86.86.86.14.12a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.86.86.86.14.12a.13" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.75.75.75.3.1.1" xref="S3.E3.m1.75.75.75.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.86.86.86.14.12a.14" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.86.86.86.14.12a.14.1" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.86.86.86.14.12a.14.1.1" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.76.76.76.4.2.2" xref="S3.E3.m1.76.76.76.4.2.2.cmml">𝒇</mi><mi id="S3.E3.m1.77.77.77.5.3.3.1" xref="S3.E3.m1.77.77.77.5.3.3.1.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.78.78.78.6.4.4" xref="S3.E3.m1.78.78.78.6.4.4.cmml">⊙</mo><msub id="S3.E3.m1.86.86.86.14.12a.14.1.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.79.79.79.7.5.5" xref="S3.E3.m1.79.79.79.7.5.5.cmml">𝒄</mi><mrow id="S3.E3.m1.80.80.80.8.6.6.1" xref="S3.E3.m1.80.80.80.8.6.6.1.cmml"><mi id="S3.E3.m1.80.80.80.8.6.6.1.2" xref="S3.E3.m1.80.80.80.8.6.6.1.2.cmml">t</mi><mo id="S3.E3.m1.80.80.80.8.6.6.1.1" xref="S3.E3.m1.80.80.80.8.6.6.1.1.cmml">−</mo><mn id="S3.E3.m1.80.80.80.8.6.6.1.3" xref="S3.E3.m1.80.80.80.8.6.6.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.81.81.81.9.7.7" xref="S3.E3.m1.81.81.81.9.7.7.cmml">+</mo><mrow id="S3.E3.m1.86.86.86.14.12a.14.2" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.86.86.86.14.12a.14.2.1" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.82.82.82.10.8.8" xref="S3.E3.m1.82.82.82.10.8.8.cmml">𝒊</mi><mi id="S3.E3.m1.83.83.83.11.9.9.1" xref="S3.E3.m1.83.83.83.11.9.9.1.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.84.84.84.12.10.10" xref="S3.E3.m1.84.84.84.12.10.10.cmml">⊙</mo><msub id="S3.E3.m1.86.86.86.14.12a.14.2.2" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.85.85.85.13.11.11" xref="S3.E3.m1.85.85.85.13.11.11.cmml">𝒈</mi><mi id="S3.E3.m1.86.86.86.14.12.12.1" xref="S3.E3.m1.86.86.86.14.12.12.1.cmml">t</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.107.107.10p" xref="S3.E3.m1.102.102.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.107.107.10q" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.88.88.88.2.2a" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.87.87.87.1.1.1" xref="S3.E3.m1.87.87.87.1.1.1.cmml">𝒉</mi><mi id="S3.E3.m1.88.88.88.2.2.2.1" xref="S3.E3.m1.88.88.88.2.2.2.1.cmml">t</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.107.107.10r" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.107.107.10.102.12.10" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.107.107.10.102.12.10.11" xref="S3.E3.m1.102.102.5a.cmml"></mi><mo id="S3.E3.m1.89.89.89.3.1.1" xref="S3.E3.m1.89.89.89.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.107.107.10.102.12.10.10" xref="S3.E3.m1.102.102.5.cmml"><mrow id="S3.E3.m1.107.107.10.102.12.10.10.3" xref="S3.E3.m1.102.102.5.cmml"><msub id="S3.E3.m1.107.107.10.102.12.10.10.3.1" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.90.90.90.4.2.2" xref="S3.E3.m1.90.90.90.4.2.2.cmml">𝒐</mi><mi id="S3.E3.m1.91.91.91.5.3.3.1" xref="S3.E3.m1.91.91.91.5.3.3.1.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.92.92.92.6.4.4" xref="S3.E3.m1.92.92.92.6.4.4.cmml">⊙</mo><mi id="S3.E3.m1.93.93.93.7.5.5" xref="S3.E3.m1.93.93.93.7.5.5.cmml">ϕ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.107.107.10.102.12.10.10.2" xref="S3.E3.m1.102.102.5a.cmml">​</mo><mrow id="S3.E3.m1.107.107.10.102.12.10.10.1.1" xref="S3.E3.m1.102.102.5.cmml"><mo stretchy="false" id="S3.E3.m1.94.94.94.8.6.6" xref="S3.E3.m1.102.102.5a.cmml">(</mo><msub id="S3.E3.m1.107.107.10.102.12.10.10.1.1.1" xref="S3.E3.m1.102.102.5.cmml"><mi id="S3.E3.m1.95.95.95.9.7.7" xref="S3.E3.m1.95.95.95.9.7.7.cmml">𝒄</mi><mi id="S3.E3.m1.96.96.96.10.8.8.1" xref="S3.E3.m1.96.96.96.10.8.8.1.cmml">t</mi></msub><mo stretchy="false" id="S3.E3.m1.97.97.97.11.9.9" xref="S3.E3.m1.102.102.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.107b"><apply id="S3.E3.m1.102.102.5.cmml" xref="S3.E3.m1.107.107.10"><and id="S3.E3.m1.102.102.5a.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></and><apply id="S3.E3.m1.102.102.5b.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.3.3.3.3.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1"></eq><apply id="S3.E3.m1.102.102.5.7.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.7.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝒊</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S3.E3.m1.98.98.1.1.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.98.98.1.1.2.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><ci id="S3.E3.m1.4.4.4.4.2.2.cmml" xref="S3.E3.m1.4.4.4.4.2.2">𝜎</ci><apply id="S3.E3.m1.98.98.1.1.1.1.1.cmml" xref="S3.E3.m1.107.107.10"><plus id="S3.E3.m1.10.10.10.10.8.8.cmml" xref="S3.E3.m1.10.10.10.10.8.8"></plus><apply id="S3.E3.m1.98.98.1.1.1.1.1.2.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.98.98.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.98.98.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.6.6.6.6.4.4.cmml" xref="S3.E3.m1.6.6.6.6.4.4">𝐖</ci><apply id="S3.E3.m1.7.7.7.7.5.5.1.cmml" xref="S3.E3.m1.7.7.7.7.5.5.1"><times id="S3.E3.m1.7.7.7.7.5.5.1.1.cmml" xref="S3.E3.m1.7.7.7.7.5.5.1.1"></times><ci id="S3.E3.m1.7.7.7.7.5.5.1.2.cmml" xref="S3.E3.m1.7.7.7.7.5.5.1.2">𝑣</ci><ci id="S3.E3.m1.7.7.7.7.5.5.1.3.cmml" xref="S3.E3.m1.7.7.7.7.5.5.1.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.98.98.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.8.8.8.8.6.6.cmml" xref="S3.E3.m1.8.8.8.8.6.6">𝒗</ci><ci id="S3.E3.m1.9.9.9.9.7.7.1.cmml" xref="S3.E3.m1.9.9.9.9.7.7.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.98.98.1.1.1.1.1.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.98.98.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.98.98.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.11.11.11.11.9.9.cmml" xref="S3.E3.m1.11.11.11.11.9.9">𝐖</ci><apply id="S3.E3.m1.12.12.12.12.10.10.1.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1"><times id="S3.E3.m1.12.12.12.12.10.10.1.1.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.1"></times><ci id="S3.E3.m1.12.12.12.12.10.10.1.2.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.2">ℎ</ci><ci id="S3.E3.m1.12.12.12.12.10.10.1.3.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.98.98.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.13.13.13.13.11.11.cmml" xref="S3.E3.m1.13.13.13.13.11.11">𝒉</ci><apply id="S3.E3.m1.14.14.14.14.12.12.1.cmml" xref="S3.E3.m1.14.14.14.14.12.12.1"><minus id="S3.E3.m1.14.14.14.14.12.12.1.1.cmml" xref="S3.E3.m1.14.14.14.14.12.12.1.1"></minus><ci id="S3.E3.m1.14.14.14.14.12.12.1.2.cmml" xref="S3.E3.m1.14.14.14.14.12.12.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.14.14.14.14.12.12.1.3.cmml" xref="S3.E3.m1.14.14.14.14.12.12.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.98.98.1.1.1.1.1.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.16.16.16.16.14.14.cmml" xref="S3.E3.m1.16.16.16.16.14.14">𝒃</ci><ci id="S3.E3.m1.17.17.17.17.15.15.1.cmml" xref="S3.E3.m1.17.17.17.17.15.15.1">𝑖</ci></apply></apply><apply id="S3.E3.m1.98.98.1.1.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.98.98.1.1.4.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.19.19.19.1.1.1.cmml" xref="S3.E3.m1.19.19.19.1.1.1">𝒇</ci><ci id="S3.E3.m1.20.20.20.2.2.2.1.cmml" xref="S3.E3.m1.20.20.20.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.102.102.5c.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.21.21.21.3.1.1.cmml" xref="S3.E3.m1.21.21.21.3.1.1"></eq><share href="#S3.E3.m1.98.98.1.1.cmml" id="S3.E3.m1.102.102.5d.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></share><apply id="S3.E3.m1.99.99.2.2.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.99.99.2.2.2.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><ci id="S3.E3.m1.22.22.22.4.2.2.cmml" xref="S3.E3.m1.22.22.22.4.2.2">𝜎</ci><apply id="S3.E3.m1.99.99.2.2.1.1.1.cmml" xref="S3.E3.m1.107.107.10"><plus id="S3.E3.m1.28.28.28.10.8.8.cmml" xref="S3.E3.m1.28.28.28.10.8.8"></plus><apply id="S3.E3.m1.99.99.2.2.1.1.1.2.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.99.99.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.99.99.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.1.1.1.2.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.24.24.24.6.4.4.cmml" xref="S3.E3.m1.24.24.24.6.4.4">𝐖</ci><apply id="S3.E3.m1.25.25.25.7.5.5.1.cmml" xref="S3.E3.m1.25.25.25.7.5.5.1"><times id="S3.E3.m1.25.25.25.7.5.5.1.1.cmml" xref="S3.E3.m1.25.25.25.7.5.5.1.1"></times><ci id="S3.E3.m1.25.25.25.7.5.5.1.2.cmml" xref="S3.E3.m1.25.25.25.7.5.5.1.2">𝑣</ci><ci id="S3.E3.m1.25.25.25.7.5.5.1.3.cmml" xref="S3.E3.m1.25.25.25.7.5.5.1.3">𝑓</ci></apply></apply><apply id="S3.E3.m1.99.99.2.2.1.1.1.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.1.1.1.2.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.26.26.26.8.6.6.cmml" xref="S3.E3.m1.26.26.26.8.6.6">𝒗</ci><ci id="S3.E3.m1.27.27.27.9.7.7.1.cmml" xref="S3.E3.m1.27.27.27.9.7.7.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.99.99.2.2.1.1.1.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.99.99.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.99.99.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.1.1.1.3.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.29.29.29.11.9.9.cmml" xref="S3.E3.m1.29.29.29.11.9.9">𝐖</ci><apply id="S3.E3.m1.30.30.30.12.10.10.1.cmml" xref="S3.E3.m1.30.30.30.12.10.10.1"><times id="S3.E3.m1.30.30.30.12.10.10.1.1.cmml" xref="S3.E3.m1.30.30.30.12.10.10.1.1"></times><ci id="S3.E3.m1.30.30.30.12.10.10.1.2.cmml" xref="S3.E3.m1.30.30.30.12.10.10.1.2">ℎ</ci><ci id="S3.E3.m1.30.30.30.12.10.10.1.3.cmml" xref="S3.E3.m1.30.30.30.12.10.10.1.3">𝑓</ci></apply></apply><apply id="S3.E3.m1.99.99.2.2.1.1.1.3.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.1.1.1.3.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.31.31.31.13.11.11.cmml" xref="S3.E3.m1.31.31.31.13.11.11">𝒉</ci><apply id="S3.E3.m1.32.32.32.14.12.12.1.cmml" xref="S3.E3.m1.32.32.32.14.12.12.1"><minus id="S3.E3.m1.32.32.32.14.12.12.1.1.cmml" xref="S3.E3.m1.32.32.32.14.12.12.1.1"></minus><ci id="S3.E3.m1.32.32.32.14.12.12.1.2.cmml" xref="S3.E3.m1.32.32.32.14.12.12.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.32.32.32.14.12.12.1.3.cmml" xref="S3.E3.m1.32.32.32.14.12.12.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.99.99.2.2.1.1.1.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.1.1.1.4.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.34.34.34.16.14.14.cmml" xref="S3.E3.m1.34.34.34.16.14.14">𝒃</ci><ci id="S3.E3.m1.35.35.35.17.15.15.1.cmml" xref="S3.E3.m1.35.35.35.17.15.15.1">𝑓</ci></apply></apply><apply id="S3.E3.m1.99.99.2.2.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.99.99.2.2.4.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.37.37.37.1.1.1.cmml" xref="S3.E3.m1.37.37.37.1.1.1">𝒐</ci><ci id="S3.E3.m1.38.38.38.2.2.2.1.cmml" xref="S3.E3.m1.38.38.38.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.102.102.5e.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.39.39.39.3.1.1.cmml" xref="S3.E3.m1.39.39.39.3.1.1"></eq><share href="#S3.E3.m1.99.99.2.2.cmml" id="S3.E3.m1.102.102.5f.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></share><apply id="S3.E3.m1.100.100.3.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.100.100.3.3.2.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><ci id="S3.E3.m1.40.40.40.4.2.2.cmml" xref="S3.E3.m1.40.40.40.4.2.2">𝜎</ci><apply id="S3.E3.m1.100.100.3.3.1.1.1.cmml" xref="S3.E3.m1.107.107.10"><plus id="S3.E3.m1.46.46.46.10.8.8.cmml" xref="S3.E3.m1.46.46.46.10.8.8"></plus><apply id="S3.E3.m1.100.100.3.3.1.1.1.2.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.100.100.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.100.100.3.3.1.1.1.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.1.1.1.2.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.42.42.42.6.4.4.cmml" xref="S3.E3.m1.42.42.42.6.4.4">𝐖</ci><apply id="S3.E3.m1.43.43.43.7.5.5.1.cmml" xref="S3.E3.m1.43.43.43.7.5.5.1"><times id="S3.E3.m1.43.43.43.7.5.5.1.1.cmml" xref="S3.E3.m1.43.43.43.7.5.5.1.1"></times><ci id="S3.E3.m1.43.43.43.7.5.5.1.2.cmml" xref="S3.E3.m1.43.43.43.7.5.5.1.2">𝑣</ci><ci id="S3.E3.m1.43.43.43.7.5.5.1.3.cmml" xref="S3.E3.m1.43.43.43.7.5.5.1.3">𝑜</ci></apply></apply><apply id="S3.E3.m1.100.100.3.3.1.1.1.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.1.1.1.2.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.44.44.44.8.6.6.cmml" xref="S3.E3.m1.44.44.44.8.6.6">𝒗</ci><ci id="S3.E3.m1.45.45.45.9.7.7.1.cmml" xref="S3.E3.m1.45.45.45.9.7.7.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.100.100.3.3.1.1.1.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.100.100.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.100.100.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.1.1.1.3.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.47.47.47.11.9.9.cmml" xref="S3.E3.m1.47.47.47.11.9.9">𝐖</ci><apply id="S3.E3.m1.48.48.48.12.10.10.1.cmml" xref="S3.E3.m1.48.48.48.12.10.10.1"><times id="S3.E3.m1.48.48.48.12.10.10.1.1.cmml" xref="S3.E3.m1.48.48.48.12.10.10.1.1"></times><ci id="S3.E3.m1.48.48.48.12.10.10.1.2.cmml" xref="S3.E3.m1.48.48.48.12.10.10.1.2">ℎ</ci><ci id="S3.E3.m1.48.48.48.12.10.10.1.3.cmml" xref="S3.E3.m1.48.48.48.12.10.10.1.3">𝑜</ci></apply></apply><apply id="S3.E3.m1.100.100.3.3.1.1.1.3.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.1.1.1.3.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.49.49.49.13.11.11.cmml" xref="S3.E3.m1.49.49.49.13.11.11">𝒉</ci><apply id="S3.E3.m1.50.50.50.14.12.12.1.cmml" xref="S3.E3.m1.50.50.50.14.12.12.1"><minus id="S3.E3.m1.50.50.50.14.12.12.1.1.cmml" xref="S3.E3.m1.50.50.50.14.12.12.1.1"></minus><ci id="S3.E3.m1.50.50.50.14.12.12.1.2.cmml" xref="S3.E3.m1.50.50.50.14.12.12.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.50.50.50.14.12.12.1.3.cmml" xref="S3.E3.m1.50.50.50.14.12.12.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.100.100.3.3.1.1.1.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.1.1.1.4.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.52.52.52.16.14.14.cmml" xref="S3.E3.m1.52.52.52.16.14.14">𝒃</ci><ci id="S3.E3.m1.53.53.53.17.15.15.1.cmml" xref="S3.E3.m1.53.53.53.17.15.15.1">𝑜</ci></apply></apply><apply id="S3.E3.m1.100.100.3.3.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.100.100.3.3.4.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.55.55.55.1.1.1.cmml" xref="S3.E3.m1.55.55.55.1.1.1">𝒈</ci><ci id="S3.E3.m1.56.56.56.2.2.2.1.cmml" xref="S3.E3.m1.56.56.56.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.102.102.5g.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.57.57.57.3.1.1.cmml" xref="S3.E3.m1.57.57.57.3.1.1"></eq><share href="#S3.E3.m1.100.100.3.3.cmml" id="S3.E3.m1.102.102.5h.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></share><apply id="S3.E3.m1.101.101.4.4.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.101.101.4.4.2.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><ci id="S3.E3.m1.58.58.58.4.2.2.cmml" xref="S3.E3.m1.58.58.58.4.2.2">italic-ϕ</ci><apply id="S3.E3.m1.101.101.4.4.1.1.1.cmml" xref="S3.E3.m1.107.107.10"><plus id="S3.E3.m1.64.64.64.10.8.8.cmml" xref="S3.E3.m1.64.64.64.10.8.8"></plus><apply id="S3.E3.m1.101.101.4.4.1.1.1.2.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.101.101.4.4.1.1.1.2.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.101.101.4.4.1.1.1.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.1.1.1.2.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.60.60.60.6.4.4.cmml" xref="S3.E3.m1.60.60.60.6.4.4">𝐖</ci><apply id="S3.E3.m1.61.61.61.7.5.5.1.cmml" xref="S3.E3.m1.61.61.61.7.5.5.1"><times id="S3.E3.m1.61.61.61.7.5.5.1.1.cmml" xref="S3.E3.m1.61.61.61.7.5.5.1.1"></times><ci id="S3.E3.m1.61.61.61.7.5.5.1.2.cmml" xref="S3.E3.m1.61.61.61.7.5.5.1.2">𝑣</ci><ci id="S3.E3.m1.61.61.61.7.5.5.1.3.cmml" xref="S3.E3.m1.61.61.61.7.5.5.1.3">𝑔</ci></apply></apply><apply id="S3.E3.m1.101.101.4.4.1.1.1.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.1.1.1.2.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.62.62.62.8.6.6.cmml" xref="S3.E3.m1.62.62.62.8.6.6">𝒗</ci><ci id="S3.E3.m1.63.63.63.9.7.7.1.cmml" xref="S3.E3.m1.63.63.63.9.7.7.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.101.101.4.4.1.1.1.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.101.101.4.4.1.1.1.3.1.cmml" xref="S3.E3.m1.107.107.10"></times><apply id="S3.E3.m1.101.101.4.4.1.1.1.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.1.1.1.3.2.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.65.65.65.11.9.9.cmml" xref="S3.E3.m1.65.65.65.11.9.9">𝐖</ci><apply id="S3.E3.m1.66.66.66.12.10.10.1.cmml" xref="S3.E3.m1.66.66.66.12.10.10.1"><times id="S3.E3.m1.66.66.66.12.10.10.1.1.cmml" xref="S3.E3.m1.66.66.66.12.10.10.1.1"></times><ci id="S3.E3.m1.66.66.66.12.10.10.1.2.cmml" xref="S3.E3.m1.66.66.66.12.10.10.1.2">ℎ</ci><ci id="S3.E3.m1.66.66.66.12.10.10.1.3.cmml" xref="S3.E3.m1.66.66.66.12.10.10.1.3">𝑔</ci></apply></apply><apply id="S3.E3.m1.101.101.4.4.1.1.1.3.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.1.1.1.3.3.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.67.67.67.13.11.11.cmml" xref="S3.E3.m1.67.67.67.13.11.11">𝒉</ci><apply id="S3.E3.m1.68.68.68.14.12.12.1.cmml" xref="S3.E3.m1.68.68.68.14.12.12.1"><minus id="S3.E3.m1.68.68.68.14.12.12.1.1.cmml" xref="S3.E3.m1.68.68.68.14.12.12.1.1"></minus><ci id="S3.E3.m1.68.68.68.14.12.12.1.2.cmml" xref="S3.E3.m1.68.68.68.14.12.12.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.68.68.68.14.12.12.1.3.cmml" xref="S3.E3.m1.68.68.68.14.12.12.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.101.101.4.4.1.1.1.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.1.1.1.4.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.70.70.70.16.14.14.cmml" xref="S3.E3.m1.70.70.70.16.14.14">𝒃</ci><ci id="S3.E3.m1.71.71.71.17.15.15.1.cmml" xref="S3.E3.m1.71.71.71.17.15.15.1">𝑔</ci></apply></apply><apply id="S3.E3.m1.101.101.4.4.4.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.101.101.4.4.4.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.73.73.73.1.1.1.cmml" xref="S3.E3.m1.73.73.73.1.1.1">𝒄</ci><ci id="S3.E3.m1.74.74.74.2.2.2.1.cmml" xref="S3.E3.m1.74.74.74.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.102.102.5i.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.75.75.75.3.1.1.cmml" xref="S3.E3.m1.75.75.75.3.1.1"></eq><share href="#S3.E3.m1.101.101.4.4.cmml" id="S3.E3.m1.102.102.5j.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></share><apply id="S3.E3.m1.102.102.5.13.cmml" xref="S3.E3.m1.107.107.10"><plus id="S3.E3.m1.81.81.81.9.7.7.cmml" xref="S3.E3.m1.81.81.81.9.7.7"></plus><apply id="S3.E3.m1.102.102.5.13.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="latexml" id="S3.E3.m1.78.78.78.6.4.4.cmml" xref="S3.E3.m1.78.78.78.6.4.4">direct-product</csymbol><apply id="S3.E3.m1.102.102.5.13.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.13.2.2.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.76.76.76.4.2.2.cmml" xref="S3.E3.m1.76.76.76.4.2.2">𝒇</ci><ci id="S3.E3.m1.77.77.77.5.3.3.1.cmml" xref="S3.E3.m1.77.77.77.5.3.3.1">𝑡</ci></apply><apply id="S3.E3.m1.102.102.5.13.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.13.2.3.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.79.79.79.7.5.5.cmml" xref="S3.E3.m1.79.79.79.7.5.5">𝒄</ci><apply id="S3.E3.m1.80.80.80.8.6.6.1.cmml" xref="S3.E3.m1.80.80.80.8.6.6.1"><minus id="S3.E3.m1.80.80.80.8.6.6.1.1.cmml" xref="S3.E3.m1.80.80.80.8.6.6.1.1"></minus><ci id="S3.E3.m1.80.80.80.8.6.6.1.2.cmml" xref="S3.E3.m1.80.80.80.8.6.6.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.80.80.80.8.6.6.1.3.cmml" xref="S3.E3.m1.80.80.80.8.6.6.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.102.102.5.13.3.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.102.102.5.13.3.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><apply id="S3.E3.m1.102.102.5.13.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="latexml" id="S3.E3.m1.84.84.84.12.10.10.cmml" xref="S3.E3.m1.84.84.84.12.10.10">direct-product</csymbol><apply id="S3.E3.m1.102.102.5.13.3.2.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.13.3.2.2.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.82.82.82.10.8.8.cmml" xref="S3.E3.m1.82.82.82.10.8.8">𝒊</ci><ci id="S3.E3.m1.83.83.83.11.9.9.1.cmml" xref="S3.E3.m1.83.83.83.11.9.9.1">𝑡</ci></apply><apply id="S3.E3.m1.102.102.5.13.3.2.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.13.3.2.3.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.85.85.85.13.11.11.cmml" xref="S3.E3.m1.85.85.85.13.11.11">𝒈</ci><ci id="S3.E3.m1.86.86.86.14.12.12.1.cmml" xref="S3.E3.m1.86.86.86.14.12.12.1">𝑡</ci></apply></apply><apply id="S3.E3.m1.102.102.5.13.3.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.13.3.3.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.87.87.87.1.1.1.cmml" xref="S3.E3.m1.87.87.87.1.1.1">𝒉</ci><ci id="S3.E3.m1.88.88.88.2.2.2.1.cmml" xref="S3.E3.m1.88.88.88.2.2.2.1">𝑡</ci></apply></apply></apply></apply><apply id="S3.E3.m1.102.102.5k.cmml" xref="S3.E3.m1.107.107.10"><eq id="S3.E3.m1.89.89.89.3.1.1.cmml" xref="S3.E3.m1.89.89.89.3.1.1"></eq><share href="#S3.E3.m1.102.102.5.13.cmml" id="S3.E3.m1.102.102.5l.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></share><apply id="S3.E3.m1.102.102.5.5.cmml" xref="S3.E3.m1.107.107.10"><times id="S3.E3.m1.102.102.5.5.2.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18"></times><apply id="S3.E3.m1.102.102.5.5.3.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="latexml" id="S3.E3.m1.92.92.92.6.4.4.cmml" xref="S3.E3.m1.92.92.92.6.4.4">direct-product</csymbol><apply id="S3.E3.m1.102.102.5.5.3.2.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.5.3.2.1.cmml" xref="S3.E3.m1.103.103.6.98.19.17.18">subscript</csymbol><ci id="S3.E3.m1.90.90.90.4.2.2.cmml" xref="S3.E3.m1.90.90.90.4.2.2">𝒐</ci><ci id="S3.E3.m1.91.91.91.5.3.3.1.cmml" xref="S3.E3.m1.91.91.91.5.3.3.1">𝑡</ci></apply><ci id="S3.E3.m1.93.93.93.7.5.5.cmml" xref="S3.E3.m1.93.93.93.7.5.5">italic-ϕ</ci></apply><apply id="S3.E3.m1.102.102.5.5.1.1.1.cmml" xref="S3.E3.m1.107.107.10"><csymbol cd="ambiguous" id="S3.E3.m1.102.102.5.5.1.1.1.1.cmml" xref="S3.E3.m1.107.107.10">subscript</csymbol><ci id="S3.E3.m1.95.95.95.9.7.7.cmml" xref="S3.E3.m1.95.95.95.9.7.7">𝒄</ci><ci id="S3.E3.m1.96.96.96.10.8.8.1.cmml" xref="S3.E3.m1.96.96.96.10.8.8.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.107c">\displaystyle\begin{split}\bm{i}_{t}&amp;=\sigma(\mathbf{W}_{vi}\bm{v}_{t}+\mathbf{W}_{hi}\bm{h}_{t-1}+\bm{b}_{i})\\
\bm{f}_{t}&amp;=\sigma(\mathbf{W}_{vf}\bm{v}_{t}+\mathbf{W}_{hf}\bm{h}_{t-1}+\bm{b}_{f})\\
\bm{o}_{t}&amp;=\sigma(\mathbf{W}_{vo}\bm{v}_{t}+\mathbf{W}_{ho}\bm{h}_{t-1}+\bm{b}_{o})\\
\bm{g}_{t}&amp;=\phi(\mathbf{W}_{vg}\bm{v}_{t}+\mathbf{W}_{hg}\bm{h}_{t-1}+\bm{b}_{g})\\
\bm{c}_{t}&amp;=\bm{f}_{t}\odot\bm{c}_{t-1}+\bm{i}_{t}\odot\bm{g}_{t}\\
\bm{h}_{t}&amp;=\bm{o}_{t}\odot\phi(\bm{c}_{t})\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.14" class="ltx_p">where <math id="S3.SS2.p2.10.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS2.p2.10.m1.1a"><mi id="S3.SS2.p2.10.m1.1.1" xref="S3.SS2.p2.10.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m1.1b"><ci id="S3.SS2.p2.10.m1.1.1.cmml" xref="S3.SS2.p2.10.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m1.1c">\phi</annotation></semantics></math> is the hyperbolic tangent function and <math id="S3.SS2.p2.11.m2.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS2.p2.11.m2.1a"><mo id="S3.SS2.p2.11.m2.1.1" xref="S3.SS2.p2.11.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m2.1b"><csymbol cd="latexml" id="S3.SS2.p2.11.m2.1.1.cmml" xref="S3.SS2.p2.11.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m2.1c">\odot</annotation></semantics></math> represents the element-wise production between two vectors. The LSTM’s structure is shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.2 Question Understanding ‣ 3 Attention Based Configurable CNN ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
The semantic information <math id="S3.SS2.p2.12.m3.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.SS2.p2.12.m3.1a"><mi id="S3.SS2.p2.12.m3.1.1" xref="S3.SS2.p2.12.m3.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m3.1b"><ci id="S3.SS2.p2.12.m3.1.1.cmml" xref="S3.SS2.p2.12.m3.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m3.1c">\bm{s}</annotation></semantics></math> of the input question <math id="S3.SS2.p2.13.m4.1" class="ltx_Math" alttext="\bm{q}" display="inline"><semantics id="S3.SS2.p2.13.m4.1a"><mi id="S3.SS2.p2.13.m4.1.1" xref="S3.SS2.p2.13.m4.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m4.1b"><ci id="S3.SS2.p2.13.m4.1.1.cmml" xref="S3.SS2.p2.13.m4.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m4.1c">\bm{q}</annotation></semantics></math> is obtained by averaging the LSTM states <math id="S3.SS2.p2.14.m5.1" class="ltx_Math" alttext="\{\bm{h}_{t}\}" display="inline"><semantics id="S3.SS2.p2.14.m5.1a"><mrow id="S3.SS2.p2.14.m5.1.1.1" xref="S3.SS2.p2.14.m5.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.14.m5.1.1.1.2" xref="S3.SS2.p2.14.m5.1.1.2.cmml">{</mo><msub id="S3.SS2.p2.14.m5.1.1.1.1" xref="S3.SS2.p2.14.m5.1.1.1.1.cmml"><mi id="S3.SS2.p2.14.m5.1.1.1.1.2" xref="S3.SS2.p2.14.m5.1.1.1.1.2.cmml">𝒉</mi><mi id="S3.SS2.p2.14.m5.1.1.1.1.3" xref="S3.SS2.p2.14.m5.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p2.14.m5.1.1.1.3" xref="S3.SS2.p2.14.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m5.1b"><set id="S3.SS2.p2.14.m5.1.1.2.cmml" xref="S3.SS2.p2.14.m5.1.1.1"><apply id="S3.SS2.p2.14.m5.1.1.1.1.cmml" xref="S3.SS2.p2.14.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m5.1.1.1.1.1.cmml" xref="S3.SS2.p2.14.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.14.m5.1.1.1.1.2.cmml" xref="S3.SS2.p2.14.m5.1.1.1.1.2">𝒉</ci><ci id="S3.SS2.p2.14.m5.1.1.1.1.3.cmml" xref="S3.SS2.p2.14.m5.1.1.1.1.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m5.1c">\{\bm{h}_{t}\}</annotation></semantics></math> over all time steps .</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/1511.05960/assets/x3.png" id="S3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="145" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The structure of LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for query processing</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Image Feature Extraction</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.9" class="ltx_p">The visual information in each image is represented as an <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="N\times N\times D" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.1.m1.1.1.1a" xref="S3.SS3.p1.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.1.m1.1.1.4" xref="S3.SS3.p1.1.m1.1.1.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1"></times><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑁</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑁</ci><ci id="S3.SS3.p1.1.m1.1.1.4.cmml" xref="S3.SS3.p1.1.m1.1.1.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">N\times N\times D</annotation></semantics></math> image feature map.
The feature map is generated by dividing an image into an <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="N\times N" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></times><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N\times N</annotation></semantics></math> grid, and extracting a <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">D</annotation></semantics></math>-dimensional feature vector <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">f</annotation></semantics></math> in each cell of the grid.
The VGG-19 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> deep convolutional neural network extracts a <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">D</annotation></semantics></math>-dimensional feature vector for each window. The <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">D</annotation></semantics></math>-dimensional feature vector for each cell is the average of all the 10 <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">D</annotation></semantics></math>-dimensional feature vectors.
The final <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="N\times N\times D" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mrow id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.8.m8.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.8.m8.1.1.1a" xref="S3.SS3.p1.8.m8.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.8.m8.1.1.4" xref="S3.SS3.p1.8.m8.1.1.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><times id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1"></times><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">𝑁</ci><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑁</ci><ci id="S3.SS3.p1.8.m8.1.1.4.cmml" xref="S3.SS3.p1.8.m8.1.1.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">N\times N\times D</annotation></semantics></math> image feature map is the concatenation of <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="N\times N\times D" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p1.9.m9.1.1.1a" xref="S3.SS3.p1.9.m9.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.9.m9.1.1.4" xref="S3.SS3.p1.9.m9.1.1.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><times id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"></times><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝑁</ci><ci id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3">𝑁</ci><ci id="S3.SS3.p1.9.m9.1.1.4.cmml" xref="S3.SS3.p1.9.m9.1.1.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">N\times N\times D</annotation></semantics></math>-dimensional feature vectors.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">It is also possible to exploit a fully convolutional neural network architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to extract image feature maps more efficiently. We employ the segmentation model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> pretrained on PASCAL 2007 segmentation dataset and find it leads to slightly better performance.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Answer Generation</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">The answer generation part is a multi-class classifier based on the original image feature map, the dense question embedding, and the attention weighted feature map.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">We employ the attention map to spatially weight the image feature map <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathbf{I}</annotation></semantics></math>.
The weighted image feature map focuses on the objects asked in the question.
The spatial weighting is achieved by the element-wise production between each channel of the image feature map and the attention map.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\mathbf{I}^{\prime}_{i}=\mathbf{I}_{i}\odot\bm{m}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msubsup id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2.2" xref="S3.E4.m1.1.1.2.2.2.cmml">𝐈</mi><mi id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml">i</mi><mo id="S3.E4.m1.1.1.2.2.3" xref="S3.E4.m1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">𝐈</mi><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">⊙</mo><mi id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">𝒎</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">subscript</csymbol><apply id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.2.2.2">𝐈</ci><ci id="S3.E4.m1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.2.2.3">′</ci></apply><ci id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1">direct-product</csymbol><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">𝐈</ci><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">𝒎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathbf{I}^{\prime}_{i}=\mathbf{I}_{i}\odot\bm{m}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.11" class="ltx_p">where <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><mo id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><csymbol cd="latexml" id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\odot</annotation></semantics></math> represents element-wise production.
<math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{I}^{\prime}_{i}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">𝐈</mi><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">i</mi><mo id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝐈</ci><ci id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3">′</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\mathbf{I}^{\prime}_{i}</annotation></semantics></math> and <math id="S3.SS4.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{I}_{i}" display="inline"><semantics id="S3.SS4.p3.3.m3.1a"><msub id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">𝐈</mi><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">𝐈</ci><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">\mathbf{I}_{i}</annotation></semantics></math> represent the <math id="S3.SS4.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">i</annotation></semantics></math>-th channel of attention weighted feature map <math id="S3.SS4.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{I}^{\prime}" display="inline"><semantics id="S3.SS4.p3.5.m5.1a"><msup id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mi id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">𝐈</mi><mo id="S3.SS4.p3.5.m5.1.1.3" xref="S3.SS4.p3.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS4.p3.5.m5.1.1.2.cmml" xref="S3.SS4.p3.5.m5.1.1.2">𝐈</ci><ci id="S3.SS4.p3.5.m5.1.1.3.cmml" xref="S3.SS4.p3.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">\mathbf{I}^{\prime}</annotation></semantics></math> and original image feature map <math id="S3.SS4.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS4.p3.6.m6.1a"><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">\mathbf{I}</annotation></semantics></math>, respectively.
The attention weighted feature map lowers the weights of the regions that are irrelevant to the meaning of question.
To avoid overfitting, we apply an 1<math id="S3.SS4.p3.7.m7.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.SS4.p3.7.m7.1a"><mo id="S3.SS4.p3.7.m7.1.1" xref="S3.SS4.p3.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m7.1b"><times id="S3.SS4.p3.7.m7.1.1.cmml" xref="S3.SS4.p3.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m7.1c">\times</annotation></semantics></math>1 convolution on the attention weighted feature map to reduce the number of channels, resulting in a reduced feature map <math id="S3.SS4.p3.8.m8.1" class="ltx_Math" alttext="\mathbf{I}_{r}" display="inline"><semantics id="S3.SS4.p3.8.m8.1a"><msub id="S3.SS4.p3.8.m8.1.1" xref="S3.SS4.p3.8.m8.1.1.cmml"><mi id="S3.SS4.p3.8.m8.1.1.2" xref="S3.SS4.p3.8.m8.1.1.2.cmml">𝐈</mi><mi id="S3.SS4.p3.8.m8.1.1.3" xref="S3.SS4.p3.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m8.1b"><apply id="S3.SS4.p3.8.m8.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m8.1.1.1.cmml" xref="S3.SS4.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p3.8.m8.1.1.2.cmml" xref="S3.SS4.p3.8.m8.1.1.2">𝐈</ci><ci id="S3.SS4.p3.8.m8.1.1.3.cmml" xref="S3.SS4.p3.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m8.1c">\mathbf{I}_{r}</annotation></semantics></math>.
The question’s semantic information <math id="S3.SS4.p3.9.m9.1" class="ltx_Math" alttext="\bm{s}" display="inline"><semantics id="S3.SS4.p3.9.m9.1a"><mi id="S3.SS4.p3.9.m9.1.1" xref="S3.SS4.p3.9.m9.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m9.1b"><ci id="S3.SS4.p3.9.m9.1.1.cmml" xref="S3.SS4.p3.9.m9.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m9.1c">\bm{s}</annotation></semantics></math>, the image feature map <math id="S3.SS4.p3.10.m10.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S3.SS4.p3.10.m10.1a"><mi id="S3.SS4.p3.10.m10.1.1" xref="S3.SS4.p3.10.m10.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m10.1b"><ci id="S3.SS4.p3.10.m10.1.1.cmml" xref="S3.SS4.p3.10.m10.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m10.1c">\mathbf{I}</annotation></semantics></math> and the reduced feature map <math id="S3.SS4.p3.11.m11.1" class="ltx_Math" alttext="\mathbf{I}_{r}" display="inline"><semantics id="S3.SS4.p3.11.m11.1a"><msub id="S3.SS4.p3.11.m11.1.1" xref="S3.SS4.p3.11.m11.1.1.cmml"><mi id="S3.SS4.p3.11.m11.1.1.2" xref="S3.SS4.p3.11.m11.1.1.2.cmml">𝐈</mi><mi id="S3.SS4.p3.11.m11.1.1.3" xref="S3.SS4.p3.11.m11.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m11.1b"><apply id="S3.SS4.p3.11.m11.1.1.cmml" xref="S3.SS4.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.11.m11.1.1.1.cmml" xref="S3.SS4.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS4.p3.11.m11.1.1.2.cmml" xref="S3.SS4.p3.11.m11.1.1.2">𝐈</ci><ci id="S3.SS4.p3.11.m11.1.1.3.cmml" xref="S3.SS4.p3.11.m11.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.11.m11.1c">\mathbf{I}_{r}</annotation></semantics></math> are then fused by a nonlinear projection.</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\bm{h}=g(\mathbf{W}_{ih}\mathbf{I}+\mathbf{W}_{rh}\mathbf{I}_{r}+\mathbf{W}_{sh}\bm{s}+\bm{b}_{h})" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml">𝒉</mi><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.2.1" xref="S3.E5.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.3.cmml">𝐈</mi></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E5.m1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.cmml">𝐈</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.4.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.2.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.2.cmml">𝐖</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.4.2.3" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.4.1" xref="S3.E5.m1.1.1.1.1.1.1.4.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.1.1.1.4.3.cmml">𝒔</mi></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.1b" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E5.m1.1.1.1.1.1.1.5" xref="S3.E5.m1.1.1.1.1.1.1.5.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.5.2" xref="S3.E5.m1.1.1.1.1.1.1.5.2.cmml">𝒃</mi><mi id="S3.E5.m1.1.1.1.1.1.1.5.3" xref="S3.E5.m1.1.1.1.1.1.1.5.3.cmml">h</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><ci id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3">𝒉</ci><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">𝑔</ci><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><plus id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"><times id="S3.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2">𝐖</ci><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E5.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.3">ℎ</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.3">𝐈</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><times id="S3.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2">𝐖</ci><apply id="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3"><times id="S3.E5.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.2">𝑟</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2">𝐈</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"><times id="S3.E5.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.1"></times><apply id="S3.E5.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.2">𝐖</ci><apply id="S3.E5.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E5.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.3">ℎ</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3">𝒔</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.5.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.5.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5.2">𝒃</ci><ci id="S3.E5.m1.1.1.1.1.1.1.5.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\bm{h}=g(\mathbf{W}_{ih}\mathbf{I}+\mathbf{W}_{rh}\mathbf{I}_{r}+\mathbf{W}_{sh}\bm{s}+\bm{b}_{h})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p3.14" class="ltx_p">where <math id="S3.SS4.p3.12.m1.1" class="ltx_Math" alttext="\bm{h}" display="inline"><semantics id="S3.SS4.p3.12.m1.1a"><mi id="S3.SS4.p3.12.m1.1.1" xref="S3.SS4.p3.12.m1.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.12.m1.1b"><ci id="S3.SS4.p3.12.m1.1.1.cmml" xref="S3.SS4.p3.12.m1.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.12.m1.1c">\bm{h}</annotation></semantics></math> denotes the final projected feature, and <math id="S3.SS4.p3.13.m2.1" class="ltx_math_unparsed" alttext="g(.)" display="inline"><semantics id="S3.SS4.p3.13.m2.1a"><mrow id="S3.SS4.p3.13.m2.1b"><mi id="S3.SS4.p3.13.m2.1.1">g</mi><mrow id="S3.SS4.p3.13.m2.1.2"><mo stretchy="false" id="S3.SS4.p3.13.m2.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS4.p3.13.m2.1.2.2">.</mo><mo stretchy="false" id="S3.SS4.p3.13.m2.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p3.13.m2.1c">g(.)</annotation></semantics></math> is the element-wise scaled hyperbolic tangent function: <math id="S3.SS4.p3.14.m3.3" class="ltx_Math" alttext="g(x)=1.7159\cdot\tanh(\frac{2}{3}x)" display="inline"><semantics id="S3.SS4.p3.14.m3.3a"><mrow id="S3.SS4.p3.14.m3.3.3" xref="S3.SS4.p3.14.m3.3.3.cmml"><mrow id="S3.SS4.p3.14.m3.3.3.3" xref="S3.SS4.p3.14.m3.3.3.3.cmml"><mi id="S3.SS4.p3.14.m3.3.3.3.2" xref="S3.SS4.p3.14.m3.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.14.m3.3.3.3.1" xref="S3.SS4.p3.14.m3.3.3.3.1.cmml">​</mo><mrow id="S3.SS4.p3.14.m3.3.3.3.3.2" xref="S3.SS4.p3.14.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS4.p3.14.m3.3.3.3.3.2.1" xref="S3.SS4.p3.14.m3.3.3.3.cmml">(</mo><mi id="S3.SS4.p3.14.m3.1.1" xref="S3.SS4.p3.14.m3.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS4.p3.14.m3.3.3.3.3.2.2" xref="S3.SS4.p3.14.m3.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p3.14.m3.3.3.2" xref="S3.SS4.p3.14.m3.3.3.2.cmml">=</mo><mrow id="S3.SS4.p3.14.m3.3.3.1" xref="S3.SS4.p3.14.m3.3.3.1.cmml"><mn id="S3.SS4.p3.14.m3.3.3.1.3" xref="S3.SS4.p3.14.m3.3.3.1.3.cmml">1.7159</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p3.14.m3.3.3.1.2" xref="S3.SS4.p3.14.m3.3.3.1.2.cmml">⋅</mo><mrow id="S3.SS4.p3.14.m3.3.3.1.1.1" xref="S3.SS4.p3.14.m3.3.3.1.1.2.cmml"><mi id="S3.SS4.p3.14.m3.2.2" xref="S3.SS4.p3.14.m3.2.2.cmml">tanh</mi><mo id="S3.SS4.p3.14.m3.3.3.1.1.1a" xref="S3.SS4.p3.14.m3.3.3.1.1.2.cmml">⁡</mo><mrow id="S3.SS4.p3.14.m3.3.3.1.1.1.1" xref="S3.SS4.p3.14.m3.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p3.14.m3.3.3.1.1.1.1.2" xref="S3.SS4.p3.14.m3.3.3.1.1.2.cmml">(</mo><mrow id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.cmml"><mfrac id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.cmml"><mn id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.2" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.2.cmml">2</mn><mn id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.3" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.3.cmml">3</mn></mfrac><mo lspace="0em" rspace="0em" id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.1" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.3" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS4.p3.14.m3.3.3.1.1.1.1.3" xref="S3.SS4.p3.14.m3.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.14.m3.3b"><apply id="S3.SS4.p3.14.m3.3.3.cmml" xref="S3.SS4.p3.14.m3.3.3"><eq id="S3.SS4.p3.14.m3.3.3.2.cmml" xref="S3.SS4.p3.14.m3.3.3.2"></eq><apply id="S3.SS4.p3.14.m3.3.3.3.cmml" xref="S3.SS4.p3.14.m3.3.3.3"><times id="S3.SS4.p3.14.m3.3.3.3.1.cmml" xref="S3.SS4.p3.14.m3.3.3.3.1"></times><ci id="S3.SS4.p3.14.m3.3.3.3.2.cmml" xref="S3.SS4.p3.14.m3.3.3.3.2">𝑔</ci><ci id="S3.SS4.p3.14.m3.1.1.cmml" xref="S3.SS4.p3.14.m3.1.1">𝑥</ci></apply><apply id="S3.SS4.p3.14.m3.3.3.1.cmml" xref="S3.SS4.p3.14.m3.3.3.1"><ci id="S3.SS4.p3.14.m3.3.3.1.2.cmml" xref="S3.SS4.p3.14.m3.3.3.1.2">⋅</ci><cn type="float" id="S3.SS4.p3.14.m3.3.3.1.3.cmml" xref="S3.SS4.p3.14.m3.3.3.1.3">1.7159</cn><apply id="S3.SS4.p3.14.m3.3.3.1.1.2.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1"><tanh id="S3.SS4.p3.14.m3.2.2.cmml" xref="S3.SS4.p3.14.m3.2.2"></tanh><apply id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1"><times id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.1"></times><apply id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2"><divide id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2"></divide><cn type="integer" id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.2">2</cn><cn type="integer" id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.2.3">3</cn></apply><ci id="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.14.m3.3.3.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.14.m3.3c">g(x)=1.7159\cdot\tanh(\frac{2}{3}x)</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
This function leads the gradients into the most non-linear range of value and enables a higher training speed.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.1" class="ltx_p">A multi-class classifier with softmax activation, which is trained on the final projected features, predicts the index of an answer word specified in an answer dictionary.
The answer generated by ABC-CNN is the word with the maximum probability.</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="a^{*}=\arg\max_{a\in\mathcal{V}_{a}}\bm{p}_{a}\text{\ \ \ s.t.\ \ \ }\bm{p}_{a}=g(\mathbf{W}_{ha}\bm{h}+\bm{b}_{a})" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msup id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">a</mi><mo id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E6.m1.1.1.4" xref="S3.E6.m1.1.1.4.cmml">=</mo><mrow id="S3.E6.m1.1.1.5" xref="S3.E6.m1.1.1.5.cmml"><mi id="S3.E6.m1.1.1.5.1" xref="S3.E6.m1.1.1.5.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E6.m1.1.1.5a" xref="S3.E6.m1.1.1.5.cmml">⁡</mo><mrow id="S3.E6.m1.1.1.5.2" xref="S3.E6.m1.1.1.5.2.cmml"><munder id="S3.E6.m1.1.1.5.2.1" xref="S3.E6.m1.1.1.5.2.1.cmml"><mi id="S3.E6.m1.1.1.5.2.1.2" xref="S3.E6.m1.1.1.5.2.1.2.cmml">max</mi><mrow id="S3.E6.m1.1.1.5.2.1.3" xref="S3.E6.m1.1.1.5.2.1.3.cmml"><mi id="S3.E6.m1.1.1.5.2.1.3.2" xref="S3.E6.m1.1.1.5.2.1.3.2.cmml">a</mi><mo id="S3.E6.m1.1.1.5.2.1.3.1" xref="S3.E6.m1.1.1.5.2.1.3.1.cmml">∈</mo><msub id="S3.E6.m1.1.1.5.2.1.3.3" xref="S3.E6.m1.1.1.5.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.5.2.1.3.3.2" xref="S3.E6.m1.1.1.5.2.1.3.3.2.cmml">𝒱</mi><mi id="S3.E6.m1.1.1.5.2.1.3.3.3" xref="S3.E6.m1.1.1.5.2.1.3.3.3.cmml">a</mi></msub></mrow></munder><mo lspace="0.167em" id="S3.E6.m1.1.1.5.2a" xref="S3.E6.m1.1.1.5.2.cmml">⁡</mo><mrow id="S3.E6.m1.1.1.5.2.2" xref="S3.E6.m1.1.1.5.2.2.cmml"><msub id="S3.E6.m1.1.1.5.2.2.2" xref="S3.E6.m1.1.1.5.2.2.2.cmml"><mi id="S3.E6.m1.1.1.5.2.2.2.2" xref="S3.E6.m1.1.1.5.2.2.2.2.cmml">𝒑</mi><mi id="S3.E6.m1.1.1.5.2.2.2.3" xref="S3.E6.m1.1.1.5.2.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.5.2.2.1" xref="S3.E6.m1.1.1.5.2.2.1.cmml">​</mo><mtext id="S3.E6.m1.1.1.5.2.2.3" xref="S3.E6.m1.1.1.5.2.2.3a.cmml"> s.t. </mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.5.2.2.1a" xref="S3.E6.m1.1.1.5.2.2.1.cmml">​</mo><msub id="S3.E6.m1.1.1.5.2.2.4" xref="S3.E6.m1.1.1.5.2.2.4.cmml"><mi id="S3.E6.m1.1.1.5.2.2.4.2" xref="S3.E6.m1.1.1.5.2.2.4.2.cmml">𝒑</mi><mi id="S3.E6.m1.1.1.5.2.2.4.3" xref="S3.E6.m1.1.1.5.2.2.4.3.cmml">a</mi></msub></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.6" xref="S3.E6.m1.1.1.6.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.3.cmml">a</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">𝒉</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">𝒃</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml">a</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><and id="S3.E6.m1.1.1a.cmml" xref="S3.E6.m1.1.1"></and><apply id="S3.E6.m1.1.1b.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.4.cmml" xref="S3.E6.m1.1.1.4"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝑎</ci><times id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"></times></apply><apply id="S3.E6.m1.1.1.5.cmml" xref="S3.E6.m1.1.1.5"><arg id="S3.E6.m1.1.1.5.1.cmml" xref="S3.E6.m1.1.1.5.1"></arg><apply id="S3.E6.m1.1.1.5.2.cmml" xref="S3.E6.m1.1.1.5.2"><apply id="S3.E6.m1.1.1.5.2.1.cmml" xref="S3.E6.m1.1.1.5.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.5.2.1.1.cmml" xref="S3.E6.m1.1.1.5.2.1">subscript</csymbol><max id="S3.E6.m1.1.1.5.2.1.2.cmml" xref="S3.E6.m1.1.1.5.2.1.2"></max><apply id="S3.E6.m1.1.1.5.2.1.3.cmml" xref="S3.E6.m1.1.1.5.2.1.3"><in id="S3.E6.m1.1.1.5.2.1.3.1.cmml" xref="S3.E6.m1.1.1.5.2.1.3.1"></in><ci id="S3.E6.m1.1.1.5.2.1.3.2.cmml" xref="S3.E6.m1.1.1.5.2.1.3.2">𝑎</ci><apply id="S3.E6.m1.1.1.5.2.1.3.3.cmml" xref="S3.E6.m1.1.1.5.2.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.5.2.1.3.3.1.cmml" xref="S3.E6.m1.1.1.5.2.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.5.2.1.3.3.2.cmml" xref="S3.E6.m1.1.1.5.2.1.3.3.2">𝒱</ci><ci id="S3.E6.m1.1.1.5.2.1.3.3.3.cmml" xref="S3.E6.m1.1.1.5.2.1.3.3.3">𝑎</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.5.2.2.cmml" xref="S3.E6.m1.1.1.5.2.2"><times id="S3.E6.m1.1.1.5.2.2.1.cmml" xref="S3.E6.m1.1.1.5.2.2.1"></times><apply id="S3.E6.m1.1.1.5.2.2.2.cmml" xref="S3.E6.m1.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.5.2.2.2.1.cmml" xref="S3.E6.m1.1.1.5.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.5.2.2.2.2.cmml" xref="S3.E6.m1.1.1.5.2.2.2.2">𝒑</ci><ci id="S3.E6.m1.1.1.5.2.2.2.3.cmml" xref="S3.E6.m1.1.1.5.2.2.2.3">𝑎</ci></apply><ci id="S3.E6.m1.1.1.5.2.2.3a.cmml" xref="S3.E6.m1.1.1.5.2.2.3"><mtext id="S3.E6.m1.1.1.5.2.2.3.cmml" xref="S3.E6.m1.1.1.5.2.2.3"> s.t. </mtext></ci><apply id="S3.E6.m1.1.1.5.2.2.4.cmml" xref="S3.E6.m1.1.1.5.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.5.2.2.4.1.cmml" xref="S3.E6.m1.1.1.5.2.2.4">subscript</csymbol><ci id="S3.E6.m1.1.1.5.2.2.4.2.cmml" xref="S3.E6.m1.1.1.5.2.2.4.2">𝒑</ci><ci id="S3.E6.m1.1.1.5.2.2.4.3.cmml" xref="S3.E6.m1.1.1.5.2.2.4.3">𝑎</ci></apply></apply></apply></apply></apply><apply id="S3.E6.m1.1.1c.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.6.cmml" xref="S3.E6.m1.1.1.6"></eq><share href="#S3.E6.m1.1.1.5.cmml" id="S3.E6.m1.1.1d.cmml" xref="S3.E6.m1.1.1"></share><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">𝑔</ci><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><times id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.2">𝐖</ci><apply id="S3.E6.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E6.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.2">ℎ</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2.3.3">𝑎</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">𝒉</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">𝒃</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">a^{*}=\arg\max_{a\in\mathcal{V}_{a}}\bm{p}_{a}\text{\ \ \ s.t.\ \ \ }\bm{p}_{a}=g(\mathbf{W}_{ha}\bm{h}+\bm{b}_{a})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p4.2" class="ltx_p">Notice that we do not share the word dictionary for questions and answers, i.e., one word can have different indices in the question dictionary and answer dictionary.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Training and Testing</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">Our whole framework is trained in an end-to-end way with stochastic gradient descent and <em id="S3.SS5.p1.1.1" class="ltx_emph ltx_font_italic">adadelta</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> algorithm.
Each batch of the stochastic gradient descent randomly samples 64 image question pairs independently, and back propagation is applied to learn all the weights of the ABC-CNN architecture.
We randomly adjust the initialization weights of all the layers to ensure that each dimension of the activations in all layers has zero mean and one standard variation.
The initial learning rate is set to be 0.1.
In our experiments, the weights in image feature extraction part are fixed to allow faster training speed, although it is possible to train all the weights in ABC-CNN in an end-to-end way.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">During the testing stage, an image feature map is extracted for each image.
Given a question, we can produce its dense question embedding, and utilize the question embedding to configure the CCK to generate the attention map.
The multi-class classifier generates the answer using the original feature map, the question embedding, and the attention weighted feature map.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate our model on Toronto COCO-QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and VQA datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
We evaluate our method on the QA pairs with single word answers, which accounts for (100%, 85%, 90%) of Toronto-QA, VQA, DAQUAR datasets, respectively.
It is also consistent with the evaluation in  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.
Besides, our framework can be easily extended to generate answers in full sentences by using an RNN decoder in the answer generation part.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.8" class="ltx_p">In experiments, we first choose the resolution of both the image feature map and the attention map to be 3<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><times id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\times</annotation></semantics></math>3, which is called “ATT” model.
Each image cell generates a 4096-dimensional image feature vector using a pre-trained <em id="S4.SS1.p1.8.1" class="ltx_emph ltx_font_italic">VGG</em> network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and we extend each feature vector with the HSV histogram of the cell, resulting in a 4276-dimensional image feature vector for each cell.
The image feature vectors from all the image cells constitute an image feature map with dimension 4276<math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mo id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><times id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\times</annotation></semantics></math>3<math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><times id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\times</annotation></semantics></math>3.
To avoid overfitting, we reduce the dimension of the feature map to 256<math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mo id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><times id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\times</annotation></semantics></math>3<math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mo id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><times id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\times</annotation></semantics></math>3 with an 1<math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mo id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><times id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\times</annotation></semantics></math>1 convolution.
The dimension of the dense question embedding is 256.
We also try a second model called “ATT-SEG”, which employs a fully convolutional neural network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> pretrained on PASCAL 2007 segmentation dataset to generate 16<math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mo id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><times id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\times</annotation></semantics></math>16<math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mo id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><times id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\times</annotation></semantics></math>1024 feature maps, and concatenates them with HSV histograms in each cell as image feature maps.
In the end, we combine the VGG features, HSV features and segmentation features together, obtaining a model called “ATT-VGG-SEG”.
It takes around 24 hours to train the network ATT on Toronto COCO-QA dataset with four K40 Nvidia GPUs.
The system can generate an answer at 9.89 ms per question on a single K40 GPU.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Datasets</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We evaluate our models on three datasets: DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, Toronto COCO-QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">DAQUAR dataset has two versions: the full dataset (DQ-full) and the reduced one (DQ-reduced).
DQ-reduced has question answer pairs of 37 object classes, which is a subset of DQ-full dataset that has 894 object classes.
Both versions use the indoor scenes images from NYU-Depth V2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
The DQ-full dataset contains 795 training images with 6794 QA pairs, and 654 test images with 5674 QA pairs.
The DQ-reduced dataset contains 781 training images with 3825 QA pairs and 25 test images with 286 QA pairs.
We only train and test DAQUAR dataset on QA pairs with single word answers, which is consistent with the evaluation in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.
Such QA pairs constitute (90.6%, 89.5%) and (98.7%, 97.6%) in the training and test sets for DQ-full and DQ-reduced datasets, respectively.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Toronto COCO-QA dataset uses images from Microsoft COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> (MS-COCO).
Its QA pairs only contain single word answers. Its basic statistics is summarized in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Datasets ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is a recently collected dataset which is also built with images in MS-COCO dataset.
We evaluate the proposed model on VQA Real Image (Open-Ended) task in VQA dataset.
It contains 82783 training images, 40504 validation images, and 81434 testing images.
Each image in MS-COCO dataset is annotated with 3 questions, and each question has 10 candidate answers.
The total number of QA pairs for training, testing, and validation is 248349, 121512, 244302, respectively.
We only evaluate our method on the single-word answer QA pairs in VQA dataset, which constitute 86.88% of the total QA pairs in this dataset.
Some examples from the three datasets are shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.2 Datasets ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1511.05960/assets/dataset_demo.jpg" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="698" height="366" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Example images and image-related QA pairs in Toronto COCO-QA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, DAQUAR dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. For VQA dataset, every question has 10 candidate answers. We show the answer with most votes for each question.</figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Category</span></th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Train</span></th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">%</span></th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Test</span></th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">%</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Object</th>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">54992</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">69.84</td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">27206</td>
<td id="S4.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">69.85</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Number</th>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_center">5885</td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_center">7.47</td>
<td id="S4.T1.1.3.2.4" class="ltx_td ltx_align_center">2755</td>
<td id="S4.T1.1.3.2.5" class="ltx_td ltx_align_center">7.07</td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Color</th>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_center">13059</td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_center">16.59</td>
<td id="S4.T1.1.4.3.4" class="ltx_td ltx_align_center">6509</td>
<td id="S4.T1.1.4.3.5" class="ltx_td ltx_align_center">16.71</td>
</tr>
<tr id="S4.T1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Location</th>
<td id="S4.T1.1.5.4.2" class="ltx_td ltx_align_center">4800</td>
<td id="S4.T1.1.5.4.3" class="ltx_td ltx_align_center">6.10</td>
<td id="S4.T1.1.5.4.4" class="ltx_td ltx_align_center">2478</td>
<td id="S4.T1.1.5.4.5" class="ltx_td ltx_align_center">6.36</td>
</tr>
<tr id="S4.T1.1.6.5" class="ltx_tr">
<th id="S4.T1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Total</th>
<td id="S4.T1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">78736</td>
<td id="S4.T1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">100.00</td>
<td id="S4.T1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">38948</td>
<td id="S4.T1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">100.00</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Toronto COCO-QA question type break-down <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. </figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation Metrics</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p">As in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, we evaluate the performance of the VQA models with “answer accuracy” (ACC.) and “Wu-Palmer similarity measure Set” (WUPS) score <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
The answer accuracy computes the percentage of the generated answers that exactly match the ground truth answers.
The WUPS score is derived from the Wu-Palmer (WUP) similarity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, whose value is in the range of <math id="S4.SS3.p1.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.2.3.2.1" xref="S4.SS3.p1.1.m1.2.3.1.cmml">[</mo><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.p1.1.m1.2.3.2.2" xref="S4.SS3.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p1.1.m1.2.3.2.3" xref="S4.SS3.p1.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><interval closure="closed" id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.2"><cn type="integer" id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">0</cn><cn type="integer" id="S4.SS3.p1.1.m1.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">[0,1]</annotation></semantics></math>.
WUP similarity measures the similarity of two words based on the depth of their lowest common ancestor in the taxonomy tree <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
The WUPS score with threshold is the average of the down-weighted WUPS score for all the generated answers and ground truth.
If WUPS score of two words <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="s_{wups}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.3.1a" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.3.4" xref="S4.SS3.p1.2.m2.1.1.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.3.1b" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.3.5" xref="S4.SS3.p1.2.m2.1.1.3.5.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑠</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><times id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑤</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑢</ci><ci id="S4.SS3.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.p1.2.m2.1.1.3.4">𝑝</ci><ci id="S4.SS3.p1.2.m2.1.1.3.5.cmml" xref="S4.SS3.p1.2.m2.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">s_{wups}</annotation></semantics></math> is below a threshold, their down-weighted WUPS score is <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="0.1s_{wups}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mn id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">0.1</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">​</mo><msub id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml">s</mi><mrow id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.3.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.3.3.1" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.3.3.1a" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.4" xref="S4.SS3.p1.3.m3.1.1.3.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.3.3.1b" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.5" xref="S4.SS3.p1.3.m3.1.1.3.3.5.cmml">s</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><times id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></times><cn type="float" id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">0.1</cn><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2">𝑠</ci><apply id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3"><times id="S4.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1"></times><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2">𝑤</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.3">𝑢</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.4.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.4">𝑝</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.5.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.5">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">0.1s_{wups}</annotation></semantics></math>. Otherwise, its down-weighted WUPS is <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="s_{wups}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.3.1" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.3.1a" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3.4" xref="S4.SS3.p1.4.m4.1.1.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.3.1b" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3.5" xref="S4.SS3.p1.4.m4.1.1.3.5.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝑠</ci><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><times id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.1"></times><ci id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">𝑤</ci><ci id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3">𝑢</ci><ci id="S4.SS3.p1.4.m4.1.1.3.4.cmml" xref="S4.SS3.p1.4.m4.1.1.3.4">𝑝</ci><ci id="S4.SS3.p1.4.m4.1.1.3.5.cmml" xref="S4.SS3.p1.4.m4.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">s_{wups}</annotation></semantics></math>.
We use WUPS scores with thresholds 0.0 and 0.9 in our experiments, which are the same as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Baseline Methods</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We compare the proposed method with different benchmark methods used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
All the baseline models are listed below:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">VIS+LSTM (VL)</span>: It is the framework proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, with a CNN extracting image features followed by a dimension reduction layer.
The image features are then inserted into the head position of the question word embedding sequences as inputs for question LSTM.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">2-VIS+BLSTM (2VB)</span>: The image features are inserted at the head and the tail of question word embedding sequences.
Besides, the question LSTM in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> is set to go in both forward and backward directions.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">IMG+BOW (IB)</span>: Ren et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> use Bag-of-Words features to generate the dense question embedding.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">IMG</span>: Only the image features are used for answering the questions. It is called a “deaf” model.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><span id="S4.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">LSTM</span>: The answers are generated only using the dense question embedding from LSTM. It is called a “blind” model.</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para">
<p id="S4.I1.i6.p1.1" class="ltx_p"><span id="S4.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">ENSEMBLE</span>: Ren et al. in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> evaluated the fusion model by using an ensemble of all the above methods.</p>
</div>
</li>
<li id="S4.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i7.p1" class="ltx_para">
<p id="S4.I1.i7.p1.1" class="ltx_p"><span id="S4.I1.i7.p1.1.1" class="ltx_text ltx_font_bold">Q+I</span>: In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, the question answering is achieved by training a multi-class classifier using both the dense question embeddings and image features.</p>
</div>
</li>
<li id="S4.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i8.p1" class="ltx_para">
<p id="S4.I1.i8.p1.1" class="ltx_p"><span id="S4.I1.i8.p1.1.1" class="ltx_text ltx_font_bold">Q+I+C</span>: Compared to Q+I model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, the Q+I+C model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> adopts the dense embeddings of labeled image captions as an additional input.</p>
</div>
</li>
<li id="S4.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i9.p1" class="ltx_para">
<p id="S4.I1.i9.p1.1" class="ltx_p"><span id="S4.I1.i9.p1.1.1" class="ltx_text ltx_font_bold">ASK</span>: In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, the answers are generated by linearly combining CNN features and question embeddings in an LSTM decoder.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Results and Analysis</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Tables <a href="#S4.T2" title="Table 2 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S4.T3" title="Table 3 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and <a href="#S4.T4" title="Table 4 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> summarize the performance of different models on Toronto COCO-QA, DQ-reduced and DQ-full datasets, respectively.
Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> breaks down the performance of different methods in each category on Toronto COCO-QA dataset.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></th>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Object</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Number</span></td>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Color</span></td>
<td id="S4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Location</span></td>
<td id="S4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ACC.</span></td>
<td id="S4.T2.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">WUPS 0.9</span></td>
<td id="S4.T2.1.1.1.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">WUPS 0.0</span></td>
</tr>
<tr id="S4.T2.1.2.2" class="ltx_tr">
<th id="S4.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T2.1.2.2.1.1" class="ltx_text" style="font-size:90%;">LSTM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.2.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.2.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.2.1" class="ltx_text" style="font-size:90%;">0.3587</span></td>
<td id="S4.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.3.1" class="ltx_text" style="font-size:90%;">0.4534</span></td>
<td id="S4.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.4.1" class="ltx_text" style="font-size:90%;">0.3626</span></td>
<td id="S4.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.1.2.2.5.1" class="ltx_text" style="font-size:90%;">0.3842</span></td>
<td id="S4.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.6.1" class="ltx_text" style="font-size:90%;">0.3676</span></td>
<td id="S4.T2.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.7.1" class="ltx_text" style="font-size:90%;">0.4758</span></td>
<td id="S4.T2.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.2.2.8.1" class="ltx_text" style="font-size:90%;">0.8234</span></td>
</tr>
<tr id="S4.T2.1.3.3" class="ltx_tr">
<th id="S4.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T2.1.3.3.1.1" class="ltx_text" style="font-size:90%;">IMG </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.3.3.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.2.1" class="ltx_text" style="font-size:90%;">0.4073</span></td>
<td id="S4.T2.1.3.3.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.3.1" class="ltx_text" style="font-size:90%;">0.2926</span></td>
<td id="S4.T2.1.3.3.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.4.1" class="ltx_text" style="font-size:90%;">0.4268</span></td>
<td id="S4.T2.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.3.3.5.1" class="ltx_text" style="font-size:90%;">0.4419</span></td>
<td id="S4.T2.1.3.3.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.6.1" class="ltx_text" style="font-size:90%;">0.4302</span></td>
<td id="S4.T2.1.3.3.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.7.1" class="ltx_text" style="font-size:90%;">0.5864</span></td>
<td id="S4.T2.1.3.3.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.3.3.8.1" class="ltx_text" style="font-size:90%;">0.8585</span></td>
</tr>
<tr id="S4.T2.1.4.4" class="ltx_tr">
<th id="S4.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T2.1.4.4.1.1" class="ltx_text" style="font-size:90%;">IB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.2.1" class="ltx_text" style="font-size:90%;">0.5866</span></td>
<td id="S4.T2.1.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.3.1" class="ltx_text" style="font-size:90%;">0.4410</span></td>
<td id="S4.T2.1.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.5196</span></td>
<td id="S4.T2.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.4.4.5.1" class="ltx_text" style="font-size:90%;">0.4939</span></td>
<td id="S4.T2.1.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.6.1" class="ltx_text" style="font-size:90%;">0.5592</span></td>
<td id="S4.T2.1.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.7.1" class="ltx_text" style="font-size:90%;">0.6678</span></td>
<td id="S4.T2.1.4.4.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.4.4.8.1" class="ltx_text" style="font-size:90%;">0.8899</span></td>
</tr>
<tr id="S4.T2.1.5.5" class="ltx_tr">
<th id="S4.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T2.1.5.5.1.1" class="ltx_text" style="font-size:90%;">VL </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.5.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.5.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.2.1" class="ltx_text" style="font-size:90%;">0.5653</span></td>
<td id="S4.T2.1.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.3.1" class="ltx_text" style="font-size:90%;">0.4610</span></td>
<td id="S4.T2.1.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.4.1" class="ltx_text" style="font-size:90%;">0.4587</span></td>
<td id="S4.T2.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.5.5.5.1" class="ltx_text" style="font-size:90%;">0.4552</span></td>
<td id="S4.T2.1.5.5.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.6.1" class="ltx_text" style="font-size:90%;">0.5331</span></td>
<td id="S4.T2.1.5.5.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.7.1" class="ltx_text" style="font-size:90%;">0.6391</span></td>
<td id="S4.T2.1.5.5.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.5.5.8.1" class="ltx_text" style="font-size:90%;">0.8825</span></td>
</tr>
<tr id="S4.T2.1.6.6" class="ltx_tr">
<th id="S4.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T2.1.6.6.1.1" class="ltx_text" style="font-size:90%;">2VB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.6.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.6.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.2.1" class="ltx_text" style="font-size:90%;">0.5817</span></td>
<td id="S4.T2.1.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.3.1" class="ltx_text" style="font-size:90%;">0.4479</span></td>
<td id="S4.T2.1.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.4.1" class="ltx_text" style="font-size:90%;">0.4953</span></td>
<td id="S4.T2.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.6.6.5.1" class="ltx_text" style="font-size:90%;">0.4734</span></td>
<td id="S4.T2.1.6.6.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.6.1" class="ltx_text" style="font-size:90%;">0.5509</span></td>
<td id="S4.T2.1.6.6.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.7.1" class="ltx_text" style="font-size:90%;">0.6534</span></td>
<td id="S4.T2.1.6.6.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.6.6.8.1" class="ltx_text" style="font-size:90%;">0.8864</span></td>
</tr>
<tr id="S4.T2.1.7.7" class="ltx_tr">
<th id="S4.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T2.1.7.7.1.1" class="ltx_text" style="font-size:90%;">ENSEMBLE </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.1.7.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T2.1.7.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T2.1.7.7.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.2.1" class="ltx_text" style="font-size:90%;">0.6108</span></td>
<td id="S4.T2.1.7.7.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.3.1" class="ltx_text" style="font-size:90%;">0.4766</span></td>
<td id="S4.T2.1.7.7.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.4.1" class="ltx_text" style="font-size:90%;">0.5148</span></td>
<td id="S4.T2.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.7.7.5.1" class="ltx_text" style="font-size:90%;">0.5028</span></td>
<td id="S4.T2.1.7.7.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.6.1" class="ltx_text" style="font-size:90%;">0.5784</span></td>
<td id="S4.T2.1.7.7.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.7.1" class="ltx_text" style="font-size:90%;">0.6790</span></td>
<td id="S4.T2.1.7.7.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.7.7.8.1" class="ltx_text" style="font-size:90%;">0.8952</span></td>
</tr>
<tr id="S4.T2.1.8.8" class="ltx_tr">
<th id="S4.T2.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T2.1.8.8.1.1" class="ltx_text" style="font-size:90%;">NO-ATT</span></th>
<td id="S4.T2.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.2.1" class="ltx_text" style="font-size:90%;">0.5882</span></td>
<td id="S4.T2.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.3.1" class="ltx_text" style="font-size:90%;">0.4319</span></td>
<td id="S4.T2.1.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.4.1" class="ltx_text" style="font-size:90%;">0.4168</span></td>
<td id="S4.T2.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.1.8.8.5.1" class="ltx_text" style="font-size:90%;">0.4762</span></td>
<td id="S4.T2.1.8.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.6.1" class="ltx_text" style="font-size:90%;">0.5414</span></td>
<td id="S4.T2.1.8.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.7.1" class="ltx_text" style="font-size:90%;">0.6483</span></td>
<td id="S4.T2.1.8.8.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.8.8.8.1" class="ltx_text" style="font-size:90%;">0.8855</span></td>
</tr>
<tr id="S4.T2.1.9.9" class="ltx_tr">
<th id="S4.T2.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.1.9.9.1.1" class="ltx_text" style="font-size:90%;">ATT</span></th>
<td id="S4.T2.1.9.9.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.2.1" class="ltx_text" style="font-size:90%;">0.6217</span></td>
<td id="S4.T2.1.9.9.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.4799</span></td>
<td id="S4.T2.1.9.9.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.4.1" class="ltx_text" style="font-size:90%;">0.4727</span></td>
<td id="S4.T2.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.9.9.5.1" class="ltx_text" style="font-size:90%;">0.5194</span></td>
<td id="S4.T2.1.9.9.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.6.1" class="ltx_text" style="font-size:90%;">0.5803</span></td>
<td id="S4.T2.1.9.9.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.7.1" class="ltx_text" style="font-size:90%;">0.6814</span></td>
<td id="S4.T2.1.9.9.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.9.8.1" class="ltx_text" style="font-size:90%;">0.8966</span></td>
</tr>
<tr id="S4.T2.1.10.10" class="ltx_tr">
<th id="S4.T2.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.1.10.10.1.1" class="ltx_text" style="font-size:90%;">ATT-SEG</span></th>
<td id="S4.T2.1.10.10.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.2.1" class="ltx_text" style="font-size:90%;">0.6238</span></td>
<td id="S4.T2.1.10.10.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.3.1" class="ltx_text" style="font-size:90%;">0.4617</span></td>
<td id="S4.T2.1.10.10.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.4.1" class="ltx_text" style="font-size:90%;">0.4694</span></td>
<td id="S4.T2.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.10.10.5.1" class="ltx_text" style="font-size:90%;">0.5278</span></td>
<td id="S4.T2.1.10.10.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.6.1" class="ltx_text" style="font-size:90%;">0.5804</span></td>
<td id="S4.T2.1.10.10.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.7.1" class="ltx_text" style="font-size:90%;">0.6833</span></td>
<td id="S4.T2.1.10.10.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.10.10.8.1" class="ltx_text" style="font-size:90%;">0.8979</span></td>
</tr>
<tr id="S4.T2.1.11.11" class="ltx_tr">
<th id="S4.T2.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S4.T2.1.11.11.1.1" class="ltx_text" style="font-size:90%;">ATT-VGG-SEG</span></th>
<td id="S4.T2.1.11.11.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.6246</span></td>
<td id="S4.T2.1.11.11.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.3.1" class="ltx_text" style="font-size:90%;">0.4570</span></td>
<td id="S4.T2.1.11.11.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.4.1" class="ltx_text" style="font-size:90%;">0.4681</span></td>
<td id="S4.T2.1.11.11.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.1.11.11.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.5367</span></td>
<td id="S4.T2.1.11.11.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.5810</span></td>
<td id="S4.T2.1.11.11.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.6844</span></td>
<td id="S4.T2.1.11.11.8" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.1.11.11.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8985</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results on Toronto COCO-QA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> in four different kinds of questions and overall accuracy (ACC.), WUPS score at threshold of 0.9 (WUPS 0.9) and 0.0 (WUPS 0.0)</figcaption>
</figure>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">In Table <a href="#S4.T2" title="Table 2 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, ABC-CNN using only ATT model surpasses all the baseline models.
It also outperforms the ENSEMBLE model by 0.3% in term of answer accuracy, although we only employ a single model.
The ABC-CNN outperforms the baseline methods in “object”, “number” and “location” categories, because question-guided attention exploits semantics of questions and the contextual information in images to answer the questions.
Its accuracy is slightly lower than IB and ENSEMBLE models in the “color” category.
We also find the performance of the fully convolutional model ATT-SEG is slightly better than ATT, while extracting feature maps with fully convolutional neural networks is much faster.
Combination of the features in ATT and ATT-SEG together (ATT-VGG-SEG) results in the best performance.
In particular, adding fully convolutional model helps correctly answer the location questions.
We also try to remove the attention in ABC-CNN (NO-ATT) as an ablative experiment, and it results in 1.34% , 0.85%, and 0.35% loss in accuracy, WUPS 0.9 and WUPS 0.0 scores, respectively.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">In Table <a href="#S4.T3" title="Table 3 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we compare ABC-CNN model with the baseline models on DQ-reduced dataset. Its performance is higher than all the single models on all the metrics. It is only 0.53% lower than the ENSEMBLE model on WUPS 0.9 measure.</p>
</div>
<div id="S4.SS5.p4" class="ltx_para">
<p id="S4.SS5.p4.1" class="ltx_p">On DQ-full and VQA datasets, ABC-CNN outperforms state-of-the-art methods on both datasets in Table. <a href="#S4.T4" title="Table 4 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T5" title="Table 5 ‣ 4.5 Results and Analysis ‣ 4 Experiments ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
On DQ-full dataset, the ABC-CNN model is the same as the models on Toronto COCO-QA and DQ-reduced dataset.
On VQA dataset, to make a fair evaluation, we employ the same answer dictionary that contains the 1000 most frequent answers (ATT 1000) as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
We also evaluate the ABC-CNN model using the answer dictionary that contains all the answers (ATT Full).</p>
</div>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></th>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ACC.</span></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">WUPS 0.9</span></td>
<td id="S4.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">WUPS 0.0</span></td>
</tr>
<tr id="S4.T3.1.2.2" class="ltx_tr">
<th id="S4.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T3.1.2.2.1.1" class="ltx_text" style="font-size:90%;">LSTM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.2.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T3.1.2.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.2.1" class="ltx_text" style="font-size:90%;">0.3273</span></td>
<td id="S4.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.3.1" class="ltx_text" style="font-size:90%;">0.4350</span></td>
<td id="S4.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.4.1" class="ltx_text" style="font-size:90%;">0.8162</span></td>
</tr>
<tr id="S4.T3.1.3.3" class="ltx_tr">
<th id="S4.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T3.1.3.3.1.1" class="ltx_text" style="font-size:90%;">IB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T3.1.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.1.3.3.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.3.3.2.1" class="ltx_text" style="font-size:90%;">0.3417</span></td>
<td id="S4.T3.1.3.3.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.3.3.3.1" class="ltx_text" style="font-size:90%;">0.4499</span></td>
<td id="S4.T3.1.3.3.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.3.3.4.1" class="ltx_text" style="font-size:90%;">0.8148</span></td>
</tr>
<tr id="S4.T3.1.4.4" class="ltx_tr">
<th id="S4.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T3.1.4.4.1.1" class="ltx_text" style="font-size:90%;">VL </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T3.1.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.1.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.2.1" class="ltx_text" style="font-size:90%;">0.3441</span></td>
<td id="S4.T3.1.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.3.1" class="ltx_text" style="font-size:90%;">0.4605</span></td>
<td id="S4.T3.1.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.4.1" class="ltx_text" style="font-size:90%;">0.8223</span></td>
</tr>
<tr id="S4.T3.1.5.5" class="ltx_tr">
<th id="S4.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T3.1.5.5.1.1" class="ltx_text" style="font-size:90%;">2VB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.5.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T3.1.5.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.1.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.2.1" class="ltx_text" style="font-size:90%;">0.3578</span></td>
<td id="S4.T3.1.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.3.1" class="ltx_text" style="font-size:90%;">0.4683</span></td>
<td id="S4.T3.1.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.4.1" class="ltx_text" style="font-size:90%;">0.8215</span></td>
</tr>
<tr id="S4.T3.1.6.6" class="ltx_tr">
<th id="S4.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T3.1.6.6.1.1" class="ltx_text" style="font-size:90%;">ENSEMBLE </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.6.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S4.T3.1.6.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T3.1.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.2.1" class="ltx_text" style="font-size:90%;">0.3694</span></td>
<td id="S4.T3.1.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.4815</span></td>
<td id="S4.T3.1.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.4.1" class="ltx_text" style="font-size:90%;">0.8268</span></td>
</tr>
<tr id="S4.T3.1.7.7" class="ltx_tr">
<th id="S4.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T3.1.7.7.1.1" class="ltx_text" style="font-size:90%;">NO-ATT</span></th>
<td id="S4.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.2.1" class="ltx_text" style="font-size:90%;">0.3931</span></td>
<td id="S4.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.3.1" class="ltx_text" style="font-size:90%;">0.4445</span></td>
<td id="S4.T3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.4.1" class="ltx_text" style="font-size:90%;">0.8230</span></td>
</tr>
<tr id="S4.T3.1.8.8" class="ltx_tr">
<th id="S4.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T3.1.8.8.1.1" class="ltx_text" style="font-size:90%;">ATT</span></th>
<td id="S4.T3.1.8.8.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.8.8.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.4276</span></td>
<td id="S4.T3.1.8.8.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.8.8.3.1" class="ltx_text" style="font-size:90%;">0.4762</span></td>
<td id="S4.T3.1.8.8.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.8304</span></td>
</tr>
<tr id="S4.T3.1.9.9" class="ltx_tr">
<th id="S4.T3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><span id="S4.T3.1.9.9.1.1" class="ltx_text" style="font-size:90%;">HUMAN</span></th>
<td id="S4.T3.1.9.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.1.9.9.2.1" class="ltx_text" style="font-size:90%;">0.6027</span></td>
<td id="S4.T3.1.9.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.1.9.9.3.1" class="ltx_text" style="font-size:90%;">0.6104</span></td>
<td id="S4.T3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.1.9.9.4.1" class="ltx_text" style="font-size:90%;">0.7896</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results on DAQUAR-reduced dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">ACC.</span></th>
<th id="S4.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">WUPS 0.9</span></th>
<th id="S4.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.1.1.1.4.1" class="ltx_text ltx_font_bold">WUPS 0.0</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.2.1" class="ltx_tr">
<th id="S4.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ASK <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</th>
<td id="S4.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.1943</td>
<td id="S4.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.2528</td>
<td id="S4.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.6200</td>
</tr>
<tr id="S4.T4.1.3.2" class="ltx_tr">
<th id="S4.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ATT</th>
<td id="S4.T4.1.3.2.2" class="ltx_td ltx_align_center"><span id="S4.T4.1.3.2.2.1" class="ltx_text ltx_font_bold">0.2537</span></td>
<td id="S4.T4.1.3.2.3" class="ltx_td ltx_align_center"><span id="S4.T4.1.3.2.3.1" class="ltx_text ltx_font_bold">0.3135</span></td>
<td id="S4.T4.1.3.2.4" class="ltx_td ltx_align_center">0.6589</td>
</tr>
<tr id="S4.T4.1.4.3" class="ltx_tr">
<th id="S4.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">HUMAN</th>
<td id="S4.T4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.5020</td>
<td id="S4.T4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.5082</td>
<td id="S4.T4.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.6727</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results on DAQUAR-full dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></figcaption>
</figure>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.1" class="ltx_p">Some of the generated question-guided attention maps and their corresponding images and questions are shown in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5 Conclusion ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
We can observe that the question-guided attention maps successfully capture different questions’ intents with different attention regions.
With these attention maps, ABC-CNN is capable of generating more accurate answers by focusing its attention on important regions and filtering out irrelevant information.
Since the original feature map is also provided when predicting answers, ABC-CNN can answer the question without using the attention map if the object queried is the only object in the image (e.g., the QA pair in row 2, column 2 of Fig. <a href="#S5.F5" title="Figure 5 ‣ 5 Conclusion ‣ ABC-CNN: An Attention Based Convolutional Neural Network for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
In this case, the attention map may not focus on the object queried.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<td id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">Q+I <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">Q+I+C <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">ATT 1000</td>
<td id="S4.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">ATT Full</td>
</tr>
<tr id="S4.T5.1.2.2" class="ltx_tr">
<th id="S4.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><span id="S4.T5.1.2.2.1.1" class="ltx_text ltx_font_bold">ACC.</span></th>
<td id="S4.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.2678</td>
<td id="S4.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.2939</td>
<td id="S4.T5.1.2.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T5.1.2.2.4.1" class="ltx_text ltx_font_bold">0.4838</span></td>
<td id="S4.T5.1.2.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">0.4651</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Results on VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a unified attention based configurable convolutional neural network (ABC-CNN) framework for VQA problem.
Our model unifies the visual feature extraction and semantic question understanding via <em id="S5.p1.1.1" class="ltx_emph ltx_font_italic">question-guided</em> attention map.
The attention map is generated by a configurable convolution network that is adaptively determined by the meaning of questions.
ABC-CNN significantly improves both visual question answering performance and the understanding of the integration of question semantics and image contents.
Our model outperforms state-of-the-art methods on Toronto COCO-QA, DAQUAR and VQA datasets.
The visualization demonstrates that ABC-CNN produces attention maps that are highly related to the semantics of the image-related questions.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1511.05960/assets/x4.png" id="S5.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="538" height="531" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Selected images with image-related questions and question-guided attention maps generated by ABC-CNN in Toronto COCO-QA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. We find the proposed ABC-CNN model is capable of focusing its attention on different regions for different questions. The attention maps help filter out irrelevant information and model the spatial relationship of the objects in images.</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1505.00468</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
J. Ba, V. Mnih, and K. Kavukcuoglu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Multiple object recognition with visual attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
K. Chatfield, K. Simonyan, A. Vedaldi, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Return of the devil in the details: Delving deep into convolutional
nets.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1405.3531</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
L.-C. Chen, G. Papandreou, I. Kokkinos, K. Murphy, and A. L. Yuille.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Semantic image segmentation with deep convolutional nets and fully
connected crfs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.7062</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Pattern Recognition, 2009. CVPR 2009.
IEEE Conference on</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255. IEEE, 2009.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
J. Donahue, L. A. Hendricks, S. Guadarrama, M. Rohrbach, S. Venugopalan,
K. Saenko, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Long-term recurrent convolutional networks for visual recognition and
description.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1411.4389</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
H. Gao, J. Mao, J. Zhou, Z. Huang, L. Wang, and W. Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Are you talking to a machine? dataset and methods for multilingual
image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1505.05612</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
S. Hochreiter and J. Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Long short-term memory.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural computation</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 9(8):1735–1780, 1997.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
J. Jin, K. Fu, R. Cui, F. Sha, and C. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Aligning where to see and what to tell: image caption with
region-based attention and scene factorization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1506.06272</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
A. Karpathy and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Deep visual-semantic alignments for generating image descriptions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.2306</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
B. Klein, L. Wolf, and Y. Afek.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">A dynamic convolutional layer for short range weather prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 4840–4848, 2015.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Y. LeCun, B. Boser, J. S. Denker, D. Henderson, R. E. Howard, W. Hubbard, and
L. D. Jackel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Backpropagation applied to handwritten zip code recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural computation</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 1(4):541–551, 1989.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Y. A. LeCun, L. Bottou, G. B. Orr, and K.-R. Müller.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Efficient backprop.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural networks: Tricks of the trade</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages 9–48. Springer,
2012.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ramanan,
P. Dollár, and C. L. Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision–ECCV 2014</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 740–755. Springer, 2014.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
T.-Y. Lin, A. RoyChowdhury, and S. Maji.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Bilinear cnn models for fine-grained visual recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1504.07889</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
J. Long, E. Shelhamer, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Fully convolutional networks for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1411.4038</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">A multi-world approach to question answering about real-world scenes
based on uncertain input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages
1682–1690, 2014.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski, M. Rohrbach, and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Ask your neurons: A neural-based approach to answering questions
about images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1505.01121</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
J. Mao, W. Xu, Y. Yang, J. Wang, and A. Yuille.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Deep captioning with multimodal recurrent neural networks (m-rnn).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.6632</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
V. Mnih, N. Heess, A. Graves, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Recurrent models of visual attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, pages
2204–2212, 2014.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
M. Ren, R. Kiros, and R. Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Exploring models and data for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1505.02074</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">. 2015.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
P. Sermanet, A. Frome, and E. Real.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Attention for fine-grained categorization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.7054</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
N. Silberman, D. Hoiem, P. Kohli, and R. Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Indoor segmentation and support inference from rgbd images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision–ECCV 2012</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 746–760. Springer, 2012.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
K. Simonyan and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1409.1556</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
I. Sutskever, O. Vinyals, and Q. V. Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Sequence to sequence learning with neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, pages
3104–3112, 2014.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
S. Venugopalan, H. Xu, J. Donahue, M. Rohrbach, R. Mooney, and K. Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Translating videos to natural language using deep recurrent neural
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1412.4729</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Z. Wu and M. Palmer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Verbs semantics and lexical selection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 32nd annual meeting on Association for
Computational Linguistics</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 133–138. Association for Computational
Linguistics, 1994.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
K. Xu, J. Ba, R. Kiros, A. Courville, R. Salakhutdinov, R. Zemel, and
Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning (ICML)</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
M. D. Zeiler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Adadelta: An adaptive learning rate method.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1212.5701</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
C. L. Zitnick, D. Parikh, and L. Vanderwende.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Learning the visual interpretation of sentences.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision (ICCV), 2013 IEEE International Conference
on</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 1681–1688. IEEE, 2013.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1511.05959" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1511.05960" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1511.05960">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1511.05960" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1511.05961" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar 16 01:23:11 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
