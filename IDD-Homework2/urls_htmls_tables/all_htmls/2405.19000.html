<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.19000] FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization</title><meta property="og:description" content="Federated Learning (FL) enables collaborative training of machine learning models on decentralized data while preserving data privacy. However, data across clients often differs significantly due to class imbalance, fe…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.19000">

<!--Generated on Wed Jun  5 13:18:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fan Zhang  Carlos Esteve-Yagüe<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>  Sören Dittmer 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_bold">Carola-Bibiane Schönlieb</span>  <span id="id2.2.id2" class="ltx_text ltx_font_bold">Michael Roberts</span> 
<br class="ltx_break">Department of Applied Mathematics and Theoretical Physics 
<br class="ltx_break">University of Cambridge 
<br class="ltx_break">Cambridge, CB3 0WA 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">{fz285,ce423,sd870,cbs31,mr808}@cam.ac.uk</span> 
<br class="ltx_break">
</span><span class="ltx_author_notes">Equal contribution.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated Learning (FL) enables collaborative training of machine learning models on decentralized data while preserving data privacy. However, data across clients often differs significantly due to class imbalance, feature distribution skew, sample size imbalance, and other phenomena.
Leveraging information from these not identically distributed (non-IID) datasets poses substantial challenges. FL methods based on a single global model cannot effectively capture the variations in client data and underperform in non-IID settings. Consequently, Personalized FL (PFL) approaches that adapt to each client’s data distribution but leverage other clients’ data are essential but currently underexplored. We propose a novel Bayesian PFL framework using bi-level optimization to tackle the data heterogeneity challenges. Our proposed framework utilizes the global model as a prior distribution within a Maximum A Posteriori (MAP) estimation of personalized client models. This approach facilitates PFL by integrating shared knowledge from the prior, thereby enhancing local model performance, generalization ability, and communication efficiency.
We extensively evaluated our bi-level optimization approach on real-world and synthetic datasets, demonstrating significant improvements in model accuracy compared to existing methods while reducing communication overhead. This study contributes to PFL by establishing a solid theoretical foundation for the proposed method and offering a robust, ready-to-use framework that effectively addresses the challenges posed by non-IID data in FL.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Leveraging distributed data resources through collaborative access mechanisms presents a significant opportunity to advance machine learning models and extract valuable insights. However, increasingly strict privacy regulations, security concerns, and high data transfer costs have made traditional centralized approaches infeasible, particularly in sensitive domains such as healthcare<cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">zhang2023recent </a></cite>. FL, a compelling paradigm, facilitates collaborative training across clients, eliminating the need for raw data sharing.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In practice, data across organizations are often non-IID, presenting significant challenges for successful FL adoption. Non-IID data refers to data not identically distributed across clients, leading to challenges such as slower model convergence, lower model accuracy, and increased communication rounds in FL. As Li et al. <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib2" title="" class="ltx_ref">9835537 </a></cite> described, there are three primary categories of non-IID data: label distribution skew, feature distribution skew, and quantity skew. Label distribution skew occurs when the proportion of different data types varies across clients. For instance, this can arise due to variations in disease prevalence across geographic regions or the specialized expertise of healthcare institutions. Feature distribution skew refers to scenarios where the input data distributions differ across clients, caused by factors such as demographic variations, differences in instrumentation calibration, or diverse data collection methods. Quantity skew refers to an imbalance in the number of data samples available from different sources, such as large urban hospitals may have significantly more patient data than rural clinics, leading to a skew in data quantities across locations.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Traditional FL algorithms, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib3" title="" class="ltx_ref">mcmahan2023communicationefficient </a></cite>, assume that local client updates can be aggregated to obtain a single global model that performs well across all clients. This assumption breaks down in the presence of non-IID data, leading to suboptimal model performance and convergence issues <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib4" title="" class="ltx_ref">li2021fedbn </a></cite>. While FedAvg and its variants have made strides in addressing statistical heterogeneity, they often struggle to capture the complexities and nuances of non-IID data. To tackle these challenges, Personalized FL (PFL) has been introduced, aiming to learn personalized models tailored to each client’s unique data distribution while leveraging the collective knowledge across clients <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">9210355 </a></cite>. However, existing PFL approaches encounter numerous issues, including high communication expenses, adversarial attacks during training, and unfair performance across different devices <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib6" title="" class="ltx_ref">lin_han_li_zhang_2022 </a></cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We propose FedMAP, a novel framework for PFL that leverages a global prior distribution derived from maximum a posteriori (MAP) estimation to facilitate knowledge sharing among clients while enabling local model adaptation to client-specific data distributions. Our contributions are as follows: First, we present a mathematical framework for FL, formulating the problem as a bi-level optimization problem. Second, we introduce the FedMAP algorithm and illustrate how MAP is integrated with FL using an adaptive weighting scheme, which ensures robust global model updates and mitigates the impact of outlier clients. Third, we extensively evaluate FedMAP on synthetic and public datasets, incorporating various non-IID data distributions. Our experiments demonstrate that FedMAP consistently outperforms individual client training and state-of-the-art FL algorithms. Fourth, we integrate FedMAP with the open-source Flower FL framework <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib7" title="" class="ltx_ref">beutel2020flower </a></cite>, enabling plug-and-play deployment. FedMAP addresses challenges posed by non-IID data, paving the way for more robust and widely applicable FL solutions. FedMAP is available for community use and further development on GitHub <a target="_blank" href="https://github.com/CambridgeCIA/FedMAP" title="" class="ltx_ref ltx_href">Link to GitHub</a></p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Related literature</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p"><span id="S1.SS1.p1.1.1" class="ltx_text ltx_font_bold">Approaches for addressing non-IID Issues through standard FL</span> One of the key challenges in standard FL is the statistical heterogeneity among clients’ data, which often leads to significant variations in model performance across clients <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib8" title="" class="ltx_ref">10174745 </a></cite>. Several solutions have been proposed to mitigate the impact of statistical heterogeneity. FedProx <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">li2020federated </a></cite> adds a proximal term to the local optimization process, limiting how far local updates can deviate from the global model. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib10" title="" class="ltx_ref">pmlr-v119-karimireddy20a </a></cite> utilises control variates to correct client drift in local updates. Despite these improvements, relying on a single global model schema often fails to effectively generalize across the diverse, non-IID data distributions of different clients, leading to suboptimal performance in many cases <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">9210355 </a></cite>.</p>
</div>
<div id="S1.SS1.p2" class="ltx_para">
<p id="S1.SS1.p2.1" class="ltx_p"><span id="S1.SS1.p2.1.1" class="ltx_text ltx_font_bold">Personalized federated learning</span> Recent research highlights that PFL effectively addresses statistical heterogeneity by customizing the global model to individual clients’ data distributions<cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib5" title="" class="ltx_ref">9210355 </a></cite>. This personalization can be achieved through several methods. <span id="S1.SS1.p2.1.2" class="ltx_text ltx_font_italic">Fine-Tuning</span> <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib11" title="" class="ltx_ref">pmlr-v162-marfoq22a </a>; <a href="#bib.bib12" title="" class="ltx_ref">lee2023fedlp </a></cite> allows clients to adjust a global model locally using their own data. <span id="S1.SS1.p2.1.3" class="ltx_text ltx_font_italic">Layer-wise Personalization</span> involves parameterized layer-wise feature transformations (scaling and shifting) to adapt the model’s features to client-specific data characteristics <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib13" title="" class="ltx_ref">10.1145/3638252 </a></cite>. <span id="S1.SS1.p2.1.4" class="ltx_text ltx_font_italic">Multi-Task Learning</span> treats each client as a unique task, optimizing across related tasks to improve overall model performance <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib14" title="" class="ltx_ref">NIPS2017_6211080f </a></cite>. <span id="S1.SS1.p2.1.5" class="ltx_text ltx_font_italic">Meta-Learning</span> strategies such as Model-Agnostic Meta-Learning (MAML) <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib15" title="" class="ltx_ref">NEURIPS2020_24389bfe </a></cite> construct a model to adapt to new client data with minimal retraining. <span id="S1.SS1.p2.1.6" class="ltx_text ltx_font_italic">Cluster-Based Personalization</span> <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib16" title="" class="ltx_ref">REN2023119499 </a>; <a href="#bib.bib17" title="" class="ltx_ref">10090084 </a></cite> groups clients by data similarity, each cluster developing a shared model that reflects its common characteristics. These strategies collectively aim to balance robust global model learning with effective local adaptation, thus optimizing FL across diverse environments.</p>
</div>
<div id="S1.SS1.p3" class="ltx_para">
<p id="S1.SS1.p3.2" class="ltx_p"><span id="S1.SS1.p3.2.1" class="ltx_text ltx_font_bold">Bayesian approach in FL</span>
Adopting Bayesian methods in FL offers several benefits, particularly in handling non-IID data by quantifying uncertainty, enhancing robustness through evidence-based likelihood estimates, and improving performance on limited data using prior distributions for each model parameter <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib18" title="" class="ltx_ref">10.24963/ijcai.2023/851 </a></cite>. The method pFedBayes <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib19" title="" class="ltx_ref">pmlr-v162-zhang22o </a></cite> introduces weight uncertainty in neural networks by balancing the loss on private data with the KL divergence from a global variational distribution using variational Bayesian inference. <math id="S1.SS1.p3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S1.SS1.p3.1.m1.1a"><mi id="S1.SS1.p3.1.m1.1.1" xref="S1.SS1.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p3.1.m1.1b"><ci id="S1.SS1.p3.1.m1.1.1.cmml" xref="S1.SS1.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p3.1.m1.1c">\beta</annotation></semantics></math>-Predictive Bayes <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib20" title="" class="ltx_ref">Hasan2023CalibratedOR </a></cite> improves calibration and uncertainty estimation by approximating the global predictive posterior through interpolating a mixture and a product of local predictive posteriors using a tunable parameter <math id="S1.SS1.p3.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S1.SS1.p3.2.m2.1a"><mi id="S1.SS1.p3.2.m2.1.1" xref="S1.SS1.p3.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p3.2.m2.1b"><ci id="S1.SS1.p3.2.m2.1.1.cmml" xref="S1.SS1.p3.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p3.2.m2.1c">\beta</annotation></semantics></math>. FedPop <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib21" title="" class="ltx_ref">NEURIPS2022_39540967 </a></cite> conceptualizes FL as population modeling, using Markov Chain Monte Carlo methods for federated stochastic optimization and accounting for data heterogeneity with common population parameters and random effects. Furthermore, the Bayesian nonparametric framework proposed in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib22" title="" class="ltx_ref">pmlr-v97-yurochkin19a </a></cite> models local neural network weights and employs a Beta-Bernoulli process-based inference technique to synthesize a global network from local models without additional data pooling.</p>
</div>
<div id="S1.SS1.p4" class="ltx_para">
<p id="S1.SS1.p4.1" class="ltx_p">Unlike methods that adapt a single global model through fine-tuning or clustering, our approach directly incorporates a global Gaussian prior to the optimization, regularizing local updates for consistency across personalized client models.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>From MLE to MAP estimator</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.4" class="ltx_p">Let <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{X}</annotation></semantics></math> and <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathcal{Y}</annotation></semantics></math> be two measurable spaces. We consider a prediction task in which the input space is <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{X}</annotation></semantics></math> and the output space is <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\mathcal{Y}</annotation></semantics></math>. The goal is to construct (<span id="S2.p1.4.1" class="ltx_text ltx_font_italic">learn</span>) a probabilistic model</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.2" class="ltx_Math" alttext="\phi:\mathcal{X}\longrightarrow\mathcal{P}(\mathcal{Y})," display="block"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.cmml">ϕ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.Ex1.m1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.cmml">:</mo><mrow id="S2.Ex1.m1.2.2.1.1.3" xref="S2.Ex1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.3.1" xref="S2.Ex1.m1.2.2.1.1.3.1.cmml">⟶</mo><mrow id="S2.Ex1.m1.2.2.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.3.3.2" xref="S2.Ex1.m1.2.2.1.1.3.3.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.1.3.3.1" xref="S2.Ex1.m1.2.2.1.1.3.3.1.cmml">​</mo><mrow id="S2.Ex1.m1.2.2.1.1.3.3.3.2" xref="S2.Ex1.m1.2.2.1.1.3.3.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.3.3.3.2.1" xref="S2.Ex1.m1.2.2.1.1.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.3.3.3.2.2" xref="S2.Ex1.m1.2.2.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.2" xref="S2.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.1"><ci id="S2.Ex1.m1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1">:</ci><ci id="S2.Ex1.m1.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2">italic-ϕ</ci><apply id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3"><ci id="S2.Ex1.m1.2.2.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.3.1">⟶</ci><ci id="S2.Ex1.m1.2.2.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.3.2">𝒳</ci><apply id="S2.Ex1.m1.2.2.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3.3"><times id="S2.Ex1.m1.2.2.1.1.3.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.3.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.3.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.3.3.2">𝒫</ci><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\phi:\mathcal{X}\longrightarrow\mathcal{P}(\mathcal{Y}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p1.9" class="ltx_p">which associates, to any element <math id="S2.p1.5.m1.1" class="ltx_Math" alttext="x\in\mathcal{X}" display="inline"><semantics id="S2.p1.5.m1.1a"><mrow id="S2.p1.5.m1.1.1" xref="S2.p1.5.m1.1.1.cmml"><mi id="S2.p1.5.m1.1.1.2" xref="S2.p1.5.m1.1.1.2.cmml">x</mi><mo id="S2.p1.5.m1.1.1.1" xref="S2.p1.5.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m1.1.1.3" xref="S2.p1.5.m1.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m1.1b"><apply id="S2.p1.5.m1.1.1.cmml" xref="S2.p1.5.m1.1.1"><in id="S2.p1.5.m1.1.1.1.cmml" xref="S2.p1.5.m1.1.1.1"></in><ci id="S2.p1.5.m1.1.1.2.cmml" xref="S2.p1.5.m1.1.1.2">𝑥</ci><ci id="S2.p1.5.m1.1.1.3.cmml" xref="S2.p1.5.m1.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m1.1c">x\in\mathcal{X}</annotation></semantics></math>, a probability measure over <math id="S2.p1.6.m2.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S2.p1.6.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.6.m2.1.1" xref="S2.p1.6.m2.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m2.1b"><ci id="S2.p1.6.m2.1.1.cmml" xref="S2.p1.6.m2.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m2.1c">\mathcal{Y}</annotation></semantics></math>.
Throughout the paper, for any measurable space <math id="S2.p1.7.m3.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p1.7.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m3.1.1" xref="S2.p1.7.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m3.1b"><ci id="S2.p1.7.m3.1.1.cmml" xref="S2.p1.7.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m3.1c">\mathcal{X}</annotation></semantics></math>, we denote by <math id="S2.p1.8.m4.1" class="ltx_Math" alttext="\mathcal{P}(\mathcal{X})" display="inline"><semantics id="S2.p1.8.m4.1a"><mrow id="S2.p1.8.m4.1.2" xref="S2.p1.8.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.8.m4.1.2.2" xref="S2.p1.8.m4.1.2.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.p1.8.m4.1.2.1" xref="S2.p1.8.m4.1.2.1.cmml">​</mo><mrow id="S2.p1.8.m4.1.2.3.2" xref="S2.p1.8.m4.1.2.cmml"><mo stretchy="false" id="S2.p1.8.m4.1.2.3.2.1" xref="S2.p1.8.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.8.m4.1.1" xref="S2.p1.8.m4.1.1.cmml">𝒳</mi><mo stretchy="false" id="S2.p1.8.m4.1.2.3.2.2" xref="S2.p1.8.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m4.1b"><apply id="S2.p1.8.m4.1.2.cmml" xref="S2.p1.8.m4.1.2"><times id="S2.p1.8.m4.1.2.1.cmml" xref="S2.p1.8.m4.1.2.1"></times><ci id="S2.p1.8.m4.1.2.2.cmml" xref="S2.p1.8.m4.1.2.2">𝒫</ci><ci id="S2.p1.8.m4.1.1.cmml" xref="S2.p1.8.m4.1.1">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m4.1c">\mathcal{P}(\mathcal{X})</annotation></semantics></math> the space of probability measures over <math id="S2.p1.9.m5.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p1.9.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m5.1.1" xref="S2.p1.9.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m5.1b"><ci id="S2.p1.9.m5.1.1.cmml" xref="S2.p1.9.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m5.1c">\mathcal{X}</annotation></semantics></math>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.2" class="ltx_p">As mentioned in the introduction, in the FL framework, one has available not only one but a collection of datasets</p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.7" class="ltx_Math" alttext="Z_{k}=\{(x^{(i)}_{k},y^{(i)}_{k})\}_{i=1}^{N_{k}}\subset(\mathcal{X}\times\mathcal{Y})^{N_{k}},\qquad\text{for}\quad k=1,\ldots,q," display="block"><semantics id="S2.Ex2.m1.7a"><mrow id="S2.Ex2.m1.7.7.1"><mrow id="S2.Ex2.m1.7.7.1.1.3" xref="S2.Ex2.m1.7.7.1.1.4.cmml"><mrow id="S2.Ex2.m1.7.7.1.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.cmml"><msub id="S2.Ex2.m1.7.7.1.1.1.1.4" xref="S2.Ex2.m1.7.7.1.1.1.1.4.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.4.2" xref="S2.Ex2.m1.7.7.1.1.1.1.4.2.cmml">Z</mi><mi id="S2.Ex2.m1.7.7.1.1.1.1.4.3" xref="S2.Ex2.m1.7.7.1.1.1.1.4.3.cmml">k</mi></msub><mo id="S2.Ex2.m1.7.7.1.1.1.1.5" xref="S2.Ex2.m1.7.7.1.1.1.1.5.cmml">=</mo><msubsup id="S2.Ex2.m1.7.7.1.1.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S2.Ex2.m1.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.1.1.1.3.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S2.Ex2.m1.1.1.1.3.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.4" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi><mrow id="S2.Ex2.m1.2.2.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.2.2.1.3.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S2.Ex2.m1.2.2.1.1" xref="S2.Ex2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S2.Ex2.m1.2.2.1.3.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.5" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.1" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.Ex2.m1.7.7.1.1.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.3.2" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3.2.cmml">N</mi><mi id="S2.Ex2.m1.7.7.1.1.1.1.1.3.3" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3.3.cmml">k</mi></msub></msubsup><mo id="S2.Ex2.m1.7.7.1.1.1.1.6" xref="S2.Ex2.m1.7.7.1.1.1.1.6.cmml">⊂</mo><msup id="S2.Ex2.m1.7.7.1.1.1.1.2" xref="S2.Ex2.m1.7.7.1.1.1.1.2.cmml"><mrow id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.2" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.2" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.1" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.3.cmml">𝒴</mi></mrow><mo stretchy="false" id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.3" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><msub id="S2.Ex2.m1.7.7.1.1.1.1.2.3" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3.cmml"><mi id="S2.Ex2.m1.7.7.1.1.1.1.2.3.2" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3.2.cmml">N</mi><mi id="S2.Ex2.m1.7.7.1.1.1.1.2.3.3" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3.3.cmml">k</mi></msub></msup></mrow><mo rspace="2.167em" id="S2.Ex2.m1.7.7.1.1.3.4" xref="S2.Ex2.m1.7.7.1.1.4a.cmml">,</mo><mrow id="S2.Ex2.m1.7.7.1.1.2.2" xref="S2.Ex2.m1.7.7.1.1.2.2.cmml"><mrow id="S2.Ex2.m1.7.7.1.1.2.2.2.2" xref="S2.Ex2.m1.7.7.1.1.2.2.2.1.cmml"><mtext id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3a.cmml">for</mtext><mspace width="1em" id="S2.Ex2.m1.7.7.1.1.2.2.2.2.1" xref="S2.Ex2.m1.7.7.1.1.2.2.2.1.cmml"></mspace><mi id="S2.Ex2.m1.4.4" xref="S2.Ex2.m1.4.4.cmml">k</mi></mrow><mo id="S2.Ex2.m1.7.7.1.1.2.2.1" xref="S2.Ex2.m1.7.7.1.1.2.2.1.cmml">=</mo><mn id="S2.Ex2.m1.7.7.1.1.2.2.3" xref="S2.Ex2.m1.7.7.1.1.2.2.3.cmml">1</mn></mrow><mo id="S2.Ex2.m1.7.7.1.1.3.5" xref="S2.Ex2.m1.7.7.1.1.4a.cmml">,</mo><mrow id="S2.Ex2.m1.7.7.1.1.3.3.2" xref="S2.Ex2.m1.7.7.1.1.3.3.1.cmml"><mi mathvariant="normal" id="S2.Ex2.m1.5.5" xref="S2.Ex2.m1.5.5.cmml">…</mi><mo id="S2.Ex2.m1.7.7.1.1.3.3.2.1" xref="S2.Ex2.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S2.Ex2.m1.6.6" xref="S2.Ex2.m1.6.6.cmml">q</mi></mrow></mrow><mo id="S2.Ex2.m1.7.7.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.7b"><apply id="S2.Ex2.m1.7.7.1.1.4.cmml" xref="S2.Ex2.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.4a.cmml" xref="S2.Ex2.m1.7.7.1.1.3.4">formulae-sequence</csymbol><apply id="S2.Ex2.m1.7.7.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1"><and id="S2.Ex2.m1.7.7.1.1.1.1a.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1"></and><apply id="S2.Ex2.m1.7.7.1.1.1.1b.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1"><eq id="S2.Ex2.m1.7.7.1.1.1.1.5.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.5"></eq><apply id="S2.Ex2.m1.7.7.1.1.1.1.4.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.4.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex2.m1.7.7.1.1.1.1.4.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.4.2">𝑍</ci><ci id="S2.Ex2.m1.7.7.1.1.1.1.4.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.4.3">𝑘</ci></apply><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1">subscript</csymbol><set id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1"><interval closure="open" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2"><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex2.m1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1">𝑖</ci></apply><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.Ex2.m1.2.2.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1">𝑖</ci></apply><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3"><eq id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.1"></eq><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.Ex2.m1.7.7.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3.2">𝑁</ci><ci id="S2.Ex2.m1.7.7.1.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="S2.Ex2.m1.7.7.1.1.1.1c.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1"><subset id="S2.Ex2.m1.7.7.1.1.1.1.6.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.6"></subset><share href="#S2.Ex2.m1.7.7.1.1.1.1.1.cmml" id="S2.Ex2.m1.7.7.1.1.1.1d.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1"></share><apply id="S2.Ex2.m1.7.7.1.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1"><times id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.1"></times><ci id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.2">𝒳</ci><ci id="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.1.1.1.3">𝒴</ci></apply><apply id="S2.Ex2.m1.7.7.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.1.1.1.1.2.3.1.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3">subscript</csymbol><ci id="S2.Ex2.m1.7.7.1.1.1.1.2.3.2.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3.2">𝑁</ci><ci id="S2.Ex2.m1.7.7.1.1.1.1.2.3.3.cmml" xref="S2.Ex2.m1.7.7.1.1.1.1.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S2.Ex2.m1.7.7.1.1.2.2.cmml" xref="S2.Ex2.m1.7.7.1.1.2.2"><eq id="S2.Ex2.m1.7.7.1.1.2.2.1.cmml" xref="S2.Ex2.m1.7.7.1.1.2.2.1"></eq><list id="S2.Ex2.m1.7.7.1.1.2.2.2.1.cmml" xref="S2.Ex2.m1.7.7.1.1.2.2.2.2"><ci id="S2.Ex2.m1.3.3a.cmml" xref="S2.Ex2.m1.3.3"><mtext id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">for</mtext></ci><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">𝑘</ci></list><cn type="integer" id="S2.Ex2.m1.7.7.1.1.2.2.3.cmml" xref="S2.Ex2.m1.7.7.1.1.2.2.3">1</cn></apply><list id="S2.Ex2.m1.7.7.1.1.3.3.1.cmml" xref="S2.Ex2.m1.7.7.1.1.3.3.2"><ci id="S2.Ex2.m1.5.5.cmml" xref="S2.Ex2.m1.5.5">…</ci><ci id="S2.Ex2.m1.6.6.cmml" xref="S2.Ex2.m1.6.6">𝑞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.7c">Z_{k}=\{(x^{(i)}_{k},y^{(i)}_{k})\}_{i=1}^{N_{k}}\subset(\mathcal{X}\times\mathcal{Y})^{N_{k}},\qquad\text{for}\quad k=1,\ldots,q,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p2.1" class="ltx_p">each of them consisting of an IID sampling from a probability distribution <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{k}\in\mathcal{P}(\mathcal{X}\times\mathcal{Y})" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><msub id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml">k</mi></msub><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">∈</mo><mrow id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.p2.1.m1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.2.cmml">​</mo><mrow id="S2.p2.1.m1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.3.cmml">𝒴</mi></mrow><mo stretchy="false" id="S2.p2.1.m1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><in id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2"></in><apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.p2.1.m1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.3.2">𝒟</ci><ci id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3">𝑘</ci></apply><apply id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"><times id="S2.p2.1.m1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.2"></times><ci id="S2.p2.1.m1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.3">𝒫</ci><apply id="S2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1"><times id="S2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.1"></times><ci id="S2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.2">𝒳</ci><ci id="S2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1.3">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{D}_{k}\in\mathcal{P}(\mathcal{X}\times\mathcal{Y})</annotation></semantics></math>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The learning procedure in the FL framework consists of two stages, which can be repeated iteratively:</p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p"><span id="S2.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">Local training:</span> Each server trains a model based on its local data and the global model (if a global model is available).</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p"><span id="S2.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">Aggregation:</span> The central server constructs (or updates) a global model based on the outcome of the local training at each local server.</p>
</div>
</li>
</ol>
<p id="S2.p3.2" class="ltx_p">Each iteration of this two-stage process is known as a <span id="S2.p3.2.1" class="ltx_text ltx_font_italic">communication round</span>.
Both the local training and the aggregation can be seen as particular examples of learning tasks.
Hence, for both of them, we need to choose the hypothesis set, the loss function and the learning algorithm.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Given that we are looking for a probabilistic model <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="\phi:\mathcal{X}\to\mathcal{P}(\mathcal{Y})" display="inline"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.2" xref="S2.p4.1.m1.1.2.cmml"><mi id="S2.p4.1.m1.1.2.2" xref="S2.p4.1.m1.1.2.2.cmml">ϕ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.p4.1.m1.1.2.1" xref="S2.p4.1.m1.1.2.1.cmml">:</mo><mrow id="S2.p4.1.m1.1.2.3" xref="S2.p4.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.2.3.2" xref="S2.p4.1.m1.1.2.3.2.cmml">𝒳</mi><mo stretchy="false" id="S2.p4.1.m1.1.2.3.1" xref="S2.p4.1.m1.1.2.3.1.cmml">→</mo><mrow id="S2.p4.1.m1.1.2.3.3" xref="S2.p4.1.m1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.2.3.3.2" xref="S2.p4.1.m1.1.2.3.3.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.p4.1.m1.1.2.3.3.1" xref="S2.p4.1.m1.1.2.3.3.1.cmml">​</mo><mrow id="S2.p4.1.m1.1.2.3.3.3.2" xref="S2.p4.1.m1.1.2.3.3.cmml"><mo stretchy="false" id="S2.p4.1.m1.1.2.3.3.3.2.1" xref="S2.p4.1.m1.1.2.3.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">𝒴</mi><mo stretchy="false" id="S2.p4.1.m1.1.2.3.3.3.2.2" xref="S2.p4.1.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.2.cmml" xref="S2.p4.1.m1.1.2"><ci id="S2.p4.1.m1.1.2.1.cmml" xref="S2.p4.1.m1.1.2.1">:</ci><ci id="S2.p4.1.m1.1.2.2.cmml" xref="S2.p4.1.m1.1.2.2">italic-ϕ</ci><apply id="S2.p4.1.m1.1.2.3.cmml" xref="S2.p4.1.m1.1.2.3"><ci id="S2.p4.1.m1.1.2.3.1.cmml" xref="S2.p4.1.m1.1.2.3.1">→</ci><ci id="S2.p4.1.m1.1.2.3.2.cmml" xref="S2.p4.1.m1.1.2.3.2">𝒳</ci><apply id="S2.p4.1.m1.1.2.3.3.cmml" xref="S2.p4.1.m1.1.2.3.3"><times id="S2.p4.1.m1.1.2.3.3.1.cmml" xref="S2.p4.1.m1.1.2.3.3.1"></times><ci id="S2.p4.1.m1.1.2.3.3.2.cmml" xref="S2.p4.1.m1.1.2.3.3.2">𝒫</ci><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\phi:\mathcal{X}\to\mathcal{P}(\mathcal{Y})</annotation></semantics></math>, a typical choice for the loss functional during the local training is the negative log-likelihood, defined as</p>
<table id="S2.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex3.m1.5" class="ltx_Math" alttext="\mathcal{L}(\phi,(x,y)):=-\log\mathbb{P}(y|\phi(x))," display="block"><semantics id="S2.Ex3.m1.5a"><mrow id="S2.Ex3.m1.5.5.1" xref="S2.Ex3.m1.5.5.1.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1" xref="S2.Ex3.m1.5.5.1.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.5.5.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.5.5.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S2.Ex3.m1.3.3" xref="S2.Ex3.m1.3.3.cmml">ϕ</mi><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.1.1.2.cmml">,</mo><mrow id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">x</mi><mo id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml">,</mo><mi id="S2.Ex3.m1.2.2" xref="S2.Ex3.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.278em" stretchy="false" id="S2.Ex3.m1.5.5.1.1.1.1.1.4" xref="S2.Ex3.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.Ex3.m1.5.5.1.1.3" xref="S2.Ex3.m1.5.5.1.1.3.cmml">:=</mo><mrow id="S2.Ex3.m1.5.5.1.1.2" xref="S2.Ex3.m1.5.5.1.1.2.cmml"><mo rspace="0.167em" id="S2.Ex3.m1.5.5.1.1.2a" xref="S2.Ex3.m1.5.5.1.1.2.cmml">−</mo><mrow id="S2.Ex3.m1.5.5.1.1.2.1" xref="S2.Ex3.m1.5.5.1.1.2.1.cmml"><mrow id="S2.Ex3.m1.5.5.1.1.2.1.3" xref="S2.Ex3.m1.5.5.1.1.2.1.3.cmml"><mi id="S2.Ex3.m1.5.5.1.1.2.1.3.1" xref="S2.Ex3.m1.5.5.1.1.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex3.m1.5.5.1.1.2.1.3a" xref="S2.Ex3.m1.5.5.1.1.2.1.3.cmml">⁡</mo><mi id="S2.Ex3.m1.5.5.1.1.2.1.3.2" xref="S2.Ex3.m1.5.5.1.1.2.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.5.5.1.1.2.1.2" xref="S2.Ex3.m1.5.5.1.1.2.1.2.cmml">​</mo><mrow id="S2.Ex3.m1.5.5.1.1.2.1.1.1" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.cmml"><mi id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.2" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.1" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.1.cmml">|</mo><mrow id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.2" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.1" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.3.2" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.3.2.1" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.cmml">(</mo><mi id="S2.Ex3.m1.4.4" xref="S2.Ex3.m1.4.4.cmml">x</mi><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.3.2.2" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.3" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex3.m1.5.5.1.2" xref="S2.Ex3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.5b"><apply id="S2.Ex3.m1.5.5.1.1.cmml" xref="S2.Ex3.m1.5.5.1"><csymbol cd="latexml" id="S2.Ex3.m1.5.5.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.3">assign</csymbol><apply id="S2.Ex3.m1.5.5.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1"><times id="S2.Ex3.m1.5.5.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.2"></times><ci id="S2.Ex3.m1.5.5.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.1.3">ℒ</ci><interval closure="open" id="S2.Ex3.m1.5.5.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1"><ci id="S2.Ex3.m1.3.3.cmml" xref="S2.Ex3.m1.3.3">italic-ϕ</ci><interval closure="open" id="S2.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.1.1.1.1.2"><ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">𝑥</ci><ci id="S2.Ex3.m1.2.2.cmml" xref="S2.Ex3.m1.2.2">𝑦</ci></interval></interval></apply><apply id="S2.Ex3.m1.5.5.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2"><minus id="S2.Ex3.m1.5.5.1.1.2.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2"></minus><apply id="S2.Ex3.m1.5.5.1.1.2.1.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1"><times id="S2.Ex3.m1.5.5.1.1.2.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.2"></times><apply id="S2.Ex3.m1.5.5.1.1.2.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.3"><log id="S2.Ex3.m1.5.5.1.1.2.1.3.1.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.3.1"></log><ci id="S2.Ex3.m1.5.5.1.1.2.1.3.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.3.2">ℙ</ci></apply><apply id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.2">𝑦</ci><apply id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3"><times id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.1"></times><ci id="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.5.5.1.1.2.1.1.1.1.3.2">italic-ϕ</ci><ci id="S2.Ex3.m1.4.4.cmml" xref="S2.Ex3.m1.4.4">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.5c">\mathcal{L}(\phi,(x,y)):=-\log\mathbb{P}(y|\phi(x)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p4.5" class="ltx_p">where <math id="S2.p4.2.m1.2" class="ltx_Math" alttext="\mathbb{P}(y|\phi(x))" display="inline"><semantics id="S2.p4.2.m1.2a"><mrow id="S2.p4.2.m1.2.2" xref="S2.p4.2.m1.2.2.cmml"><mi id="S2.p4.2.m1.2.2.3" xref="S2.p4.2.m1.2.2.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.p4.2.m1.2.2.2" xref="S2.p4.2.m1.2.2.2.cmml">​</mo><mrow id="S2.p4.2.m1.2.2.1.1" xref="S2.p4.2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.p4.2.m1.2.2.1.1.2" xref="S2.p4.2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.p4.2.m1.2.2.1.1.1" xref="S2.p4.2.m1.2.2.1.1.1.cmml"><mi id="S2.p4.2.m1.2.2.1.1.1.2" xref="S2.p4.2.m1.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p4.2.m1.2.2.1.1.1.1" xref="S2.p4.2.m1.2.2.1.1.1.1.cmml">|</mo><mrow id="S2.p4.2.m1.2.2.1.1.1.3" xref="S2.p4.2.m1.2.2.1.1.1.3.cmml"><mi id="S2.p4.2.m1.2.2.1.1.1.3.2" xref="S2.p4.2.m1.2.2.1.1.1.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.p4.2.m1.2.2.1.1.1.3.1" xref="S2.p4.2.m1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S2.p4.2.m1.2.2.1.1.1.3.3.2" xref="S2.p4.2.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S2.p4.2.m1.2.2.1.1.1.3.3.2.1" xref="S2.p4.2.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S2.p4.2.m1.1.1" xref="S2.p4.2.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.p4.2.m1.2.2.1.1.1.3.3.2.2" xref="S2.p4.2.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.p4.2.m1.2.2.1.1.3" xref="S2.p4.2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m1.2b"><apply id="S2.p4.2.m1.2.2.cmml" xref="S2.p4.2.m1.2.2"><times id="S2.p4.2.m1.2.2.2.cmml" xref="S2.p4.2.m1.2.2.2"></times><ci id="S2.p4.2.m1.2.2.3.cmml" xref="S2.p4.2.m1.2.2.3">ℙ</ci><apply id="S2.p4.2.m1.2.2.1.1.1.cmml" xref="S2.p4.2.m1.2.2.1.1"><csymbol cd="latexml" id="S2.p4.2.m1.2.2.1.1.1.1.cmml" xref="S2.p4.2.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S2.p4.2.m1.2.2.1.1.1.2.cmml" xref="S2.p4.2.m1.2.2.1.1.1.2">𝑦</ci><apply id="S2.p4.2.m1.2.2.1.1.1.3.cmml" xref="S2.p4.2.m1.2.2.1.1.1.3"><times id="S2.p4.2.m1.2.2.1.1.1.3.1.cmml" xref="S2.p4.2.m1.2.2.1.1.1.3.1"></times><ci id="S2.p4.2.m1.2.2.1.1.1.3.2.cmml" xref="S2.p4.2.m1.2.2.1.1.1.3.2">italic-ϕ</ci><ci id="S2.p4.2.m1.1.1.cmml" xref="S2.p4.2.m1.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m1.2c">\mathbb{P}(y|\phi(x))</annotation></semantics></math> denotes the likelihood of the random variable <math id="S2.p4.3.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p4.3.m2.1a"><mi id="S2.p4.3.m2.1.1" xref="S2.p4.3.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p4.3.m2.1b"><ci id="S2.p4.3.m2.1.1.cmml" xref="S2.p4.3.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m2.1c">y</annotation></semantics></math> associated to the probability distribution <math id="S2.p4.4.m3.1" class="ltx_Math" alttext="\phi(x)" display="inline"><semantics id="S2.p4.4.m3.1a"><mrow id="S2.p4.4.m3.1.2" xref="S2.p4.4.m3.1.2.cmml"><mi id="S2.p4.4.m3.1.2.2" xref="S2.p4.4.m3.1.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.p4.4.m3.1.2.1" xref="S2.p4.4.m3.1.2.1.cmml">​</mo><mrow id="S2.p4.4.m3.1.2.3.2" xref="S2.p4.4.m3.1.2.cmml"><mo stretchy="false" id="S2.p4.4.m3.1.2.3.2.1" xref="S2.p4.4.m3.1.2.cmml">(</mo><mi id="S2.p4.4.m3.1.1" xref="S2.p4.4.m3.1.1.cmml">x</mi><mo stretchy="false" id="S2.p4.4.m3.1.2.3.2.2" xref="S2.p4.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.4.m3.1b"><apply id="S2.p4.4.m3.1.2.cmml" xref="S2.p4.4.m3.1.2"><times id="S2.p4.4.m3.1.2.1.cmml" xref="S2.p4.4.m3.1.2.1"></times><ci id="S2.p4.4.m3.1.2.2.cmml" xref="S2.p4.4.m3.1.2.2">italic-ϕ</ci><ci id="S2.p4.4.m3.1.1.cmml" xref="S2.p4.4.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m3.1c">\phi(x)</annotation></semantics></math>.
Considering empirical risk minimization as a learning algorithm, each local model <math id="S2.p4.5.m4.1" class="ltx_Math" alttext="\phi_{k}^{\ast}" display="inline"><semantics id="S2.p4.5.m4.1a"><msubsup id="S2.p4.5.m4.1.1" xref="S2.p4.5.m4.1.1.cmml"><mi id="S2.p4.5.m4.1.1.2.2" xref="S2.p4.5.m4.1.1.2.2.cmml">ϕ</mi><mi id="S2.p4.5.m4.1.1.2.3" xref="S2.p4.5.m4.1.1.2.3.cmml">k</mi><mo id="S2.p4.5.m4.1.1.3" xref="S2.p4.5.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.p4.5.m4.1b"><apply id="S2.p4.5.m4.1.1.cmml" xref="S2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S2.p4.5.m4.1.1.1.cmml" xref="S2.p4.5.m4.1.1">superscript</csymbol><apply id="S2.p4.5.m4.1.1.2.cmml" xref="S2.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S2.p4.5.m4.1.1.2.1.cmml" xref="S2.p4.5.m4.1.1">subscript</csymbol><ci id="S2.p4.5.m4.1.1.2.2.cmml" xref="S2.p4.5.m4.1.1.2.2">italic-ϕ</ci><ci id="S2.p4.5.m4.1.1.2.3.cmml" xref="S2.p4.5.m4.1.1.2.3">𝑘</ci></apply><ci id="S2.p4.5.m4.1.1.3.cmml" xref="S2.p4.5.m4.1.1.3">∗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m4.1c">\phi_{k}^{\ast}</annotation></semantics></math> can be written as the solution to the minimization problem</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="\phi_{k}^{\ast}\in\arg\min_{\phi\in\mathcal{H}}\dfrac{1}{N_{k}}\sum_{i=1}^{N_{k}}-\log\left[\mathbb{P}\left(y_{k}^{(i)}|\phi(x_{k}^{(i)})\right)\right]." display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><msubsup id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.3.2.2" xref="S2.E1.m1.4.4.1.1.3.2.2.cmml">ϕ</mi><mi id="S2.E1.m1.4.4.1.1.3.2.3" xref="S2.E1.m1.4.4.1.1.3.2.3.cmml">k</mi><mo id="S2.E1.m1.4.4.1.1.3.3" xref="S2.E1.m1.4.4.1.1.3.3.cmml">∗</mo></msubsup><mo id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml">∈</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.3.2.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2.1" xref="S2.E1.m1.4.4.1.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.4.4.1.1.1.3.2a" xref="S2.E1.m1.4.4.1.1.1.3.2.cmml">⁡</mo><mrow id="S2.E1.m1.4.4.1.1.1.3.2.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.cmml"><munder id="S2.E1.m1.4.4.1.1.1.3.2.2.1" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2.2.1.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.2.cmml">min</mi><mrow id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.2.cmml">ϕ</mi><mo id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.1" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.3" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.3.cmml">ℋ</mi></mrow></munder><mo lspace="0.167em" id="S2.E1.m1.4.4.1.1.1.3.2.2a" xref="S2.E1.m1.4.4.1.1.1.3.2.2.cmml">⁡</mo><mfrac id="S2.E1.m1.4.4.1.1.1.3.2.2.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.cmml"><mn id="S2.E1.m1.4.4.1.1.1.3.2.2.2.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.2.cmml">1</mn><msub id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.2" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.2.cmml">N</mi><mi id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.3" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.3.cmml">k</mi></msub></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.3.1" xref="S2.E1.m1.4.4.1.1.1.3.1.cmml">​</mo><munderover id="S2.E1.m1.4.4.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.4.4.1.1.1.3.3.2.2" xref="S2.E1.m1.4.4.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.4.4.1.1.1.3.3.2.3" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.3.2.3.2" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S2.E1.m1.4.4.1.1.1.3.3.2.3.1" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.4.4.1.1.1.3.3.2.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E1.m1.4.4.1.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.3.3.2" xref="S2.E1.m1.4.4.1.1.1.3.3.3.2.cmml">N</mi><mi id="S2.E1.m1.4.4.1.1.1.3.3.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.3.3.cmml">k</mi></msub></munderover></mrow><mo lspace="0em" id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml"><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">log</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1a" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">[</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo fence="false" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1"><in id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"></in><apply id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.3">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.3.2.1.cmml" xref="S2.E1.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.3.2.2.cmml" xref="S2.E1.m1.4.4.1.1.3.2.2">italic-ϕ</ci><ci id="S2.E1.m1.4.4.1.1.3.2.3.cmml" xref="S2.E1.m1.4.4.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E1.m1.4.4.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.3.3">∗</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><minus id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"></minus><apply id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3"><times id="S2.E1.m1.4.4.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.1"></times><apply id="S2.E1.m1.4.4.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2"><arg id="S2.E1.m1.4.4.1.1.1.3.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.1"></arg><apply id="S2.E1.m1.4.4.1.1.1.3.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2"><apply id="S2.E1.m1.4.4.1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.2.2.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1">subscript</csymbol><min id="S2.E1.m1.4.4.1.1.1.3.2.2.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.2"></min><apply id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3"><in id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.1"></in><ci id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.2">italic-ϕ</ci><ci id="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.1.3.3">ℋ</ci></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2"><divide id="S2.E1.m1.4.4.1.1.1.3.2.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2"></divide><cn type="integer" id="S2.E1.m1.4.4.1.1.1.3.2.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.2">1</cn><apply id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.2">𝑁</ci><ci id="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2.2.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.1.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.3.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3">subscript</csymbol><sum id="S2.E1.m1.4.4.1.1.1.3.3.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2.2"></sum><apply id="S2.E1.m1.4.4.1.1.1.3.3.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3"><eq id="S2.E1.m1.4.4.1.1.1.3.3.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.1"></eq><ci id="S2.E1.m1.4.4.1.1.1.3.3.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.3.3.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.3.2">𝑁</ci><ci id="S2.E1.m1.4.4.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><log id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"></log><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3">ℙ</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\phi_{k}^{\ast}\in\arg\min_{\phi\in\mathcal{H}}\dfrac{1}{N_{k}}\sum_{i=1}^{N_{k}}-\log\left[\mathbb{P}\left(y_{k}^{(i)}|\phi(x_{k}^{(i)})\right)\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p4.7" class="ltx_p">This corresponds to a maximum likelihood estimator MLE within the hypothesis set for the local model, denoted by <math id="S2.p4.6.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p4.6.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p4.6.m1.1.1" xref="S2.p4.6.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p4.6.m1.1b"><ci id="S2.p4.6.m1.1.1.cmml" xref="S2.p4.6.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m1.1c">\mathcal{H}</annotation></semantics></math>.
The problem of (<a href="#S2.E1" title="In 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is that the trained model <math id="S2.p4.7.m2.1" class="ltx_Math" alttext="\phi_{k}^{\ast}" display="inline"><semantics id="S2.p4.7.m2.1a"><msubsup id="S2.p4.7.m2.1.1" xref="S2.p4.7.m2.1.1.cmml"><mi id="S2.p4.7.m2.1.1.2.2" xref="S2.p4.7.m2.1.1.2.2.cmml">ϕ</mi><mi id="S2.p4.7.m2.1.1.2.3" xref="S2.p4.7.m2.1.1.2.3.cmml">k</mi><mo id="S2.p4.7.m2.1.1.3" xref="S2.p4.7.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.p4.7.m2.1b"><apply id="S2.p4.7.m2.1.1.cmml" xref="S2.p4.7.m2.1.1"><csymbol cd="ambiguous" id="S2.p4.7.m2.1.1.1.cmml" xref="S2.p4.7.m2.1.1">superscript</csymbol><apply id="S2.p4.7.m2.1.1.2.cmml" xref="S2.p4.7.m2.1.1"><csymbol cd="ambiguous" id="S2.p4.7.m2.1.1.2.1.cmml" xref="S2.p4.7.m2.1.1">subscript</csymbol><ci id="S2.p4.7.m2.1.1.2.2.cmml" xref="S2.p4.7.m2.1.1.2.2">italic-ϕ</ci><ci id="S2.p4.7.m2.1.1.2.3.cmml" xref="S2.p4.7.m2.1.1.2.3">𝑘</ci></apply><ci id="S2.p4.7.m2.1.1.3.cmml" xref="S2.p4.7.m2.1.1.3">∗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.m2.1c">\phi_{k}^{\ast}</annotation></semantics></math> only depends on the local data, and no knowledge is leveraged across the datasets, which is precisely the goal in FL.
For this reason, in most FL methods, one does not aim at solving (<a href="#S2.E1" title="In 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Instead, one would consider the minimization problem (<a href="#S2.E1" title="In 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), using the global model as initial guess but never letting the algorithm reach the minimum.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.2" class="ltx_p">The issue of forgetting the global model during the local training can be overcome by using the global model, not only as the initialization of the minimization algorithm but also in the loss function <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">\mathcal{L}</annotation></semantics></math> for the local training.
In our FL approach, we formulate the local training problem as a MAP estimation of the local models, in which the global model acts as a prior distribution on the hypothesis set <math id="S2.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><ci id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">\mathcal{H}</annotation></semantics></math>.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">Let us assume that the hypothesis set <math id="S2.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\mathcal{H}</annotation></semantics></math> is a parameterized family of probabilistic models with a finite number of parameters, denoted by</p>
<table id="S2.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex4.m1.4" class="ltx_Math" alttext="\mathcal{H}:=\{\phi(\cdot;\theta):\mathcal{X}\longmapsto\mathcal{P}(\mathcal{Y})\ ;\quad\theta\in\Theta\}," display="block"><semantics id="S2.Ex4.m1.4a"><mrow id="S2.Ex4.m1.4.4.1" xref="S2.Ex4.m1.4.4.1.1.cmml"><mrow id="S2.Ex4.m1.4.4.1.1" xref="S2.Ex4.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex4.m1.4.4.1.1.4" xref="S2.Ex4.m1.4.4.1.1.4.cmml">ℋ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.Ex4.m1.4.4.1.1.3" xref="S2.Ex4.m1.4.4.1.1.3.cmml">:=</mo><mrow id="S2.Ex4.m1.4.4.1.1.2.2" xref="S2.Ex4.m1.4.4.1.1.2.3.cmml"><mo stretchy="false" id="S2.Ex4.m1.4.4.1.1.2.2.3" xref="S2.Ex4.m1.4.4.1.1.2.3.1.cmml">{</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.cmml"><mi id="S2.Ex4.m1.4.4.1.1.1.1.1.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.4.4.1.1.1.1.1.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.Ex4.m1.4.4.1.1.1.1.1.3.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.Ex4.m1.4.4.1.1.1.1.1.3.2.1" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.1.1" xref="S2.Ex4.m1.1.1.cmml">⋅</mo><mo id="S2.Ex4.m1.4.4.1.1.1.1.1.3.2.2" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.Ex4.m1.2.2" xref="S2.Ex4.m1.2.2.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="S2.Ex4.m1.4.4.1.1.1.1.1.3.2.3" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.Ex4.m1.4.4.1.1.2.2.4" xref="S2.Ex4.m1.4.4.1.1.2.3.1.cmml">:</mo><mrow id="S2.Ex4.m1.4.4.1.1.2.2.2.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.3.cmml"><mrow id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.2.cmml">𝒳</mi><mo stretchy="false" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.1" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.1.cmml">⟼</mo><mrow id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.1" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.3.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.3.2.1" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex4.m1.3.3" xref="S2.Ex4.m1.3.3.cmml">𝒴</mi><mo rspace="0.500em" stretchy="false" id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.3.2.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S2.Ex4.m1.4.4.1.1.2.2.2.2.3" xref="S2.Ex4.m1.4.4.1.1.2.2.2.3a.cmml">;</mo><mrow id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.2" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.2.cmml">θ</mi><mo id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.1" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.1.cmml">∈</mo><mi mathvariant="normal" id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.3" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.3.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S2.Ex4.m1.4.4.1.1.2.2.5" xref="S2.Ex4.m1.4.4.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S2.Ex4.m1.4.4.1.2" xref="S2.Ex4.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.4b"><apply id="S2.Ex4.m1.4.4.1.1.cmml" xref="S2.Ex4.m1.4.4.1"><csymbol cd="latexml" id="S2.Ex4.m1.4.4.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.3">assign</csymbol><ci id="S2.Ex4.m1.4.4.1.1.4.cmml" xref="S2.Ex4.m1.4.4.1.1.4">ℋ</ci><apply id="S2.Ex4.m1.4.4.1.1.2.3.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2"><csymbol cd="latexml" id="S2.Ex4.m1.4.4.1.1.2.3.1.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.3">conditional-set</csymbol><apply id="S2.Ex4.m1.4.4.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1"><times id="S2.Ex4.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.1"></times><ci id="S2.Ex4.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.2">italic-ϕ</ci><list id="S2.Ex4.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.Ex4.m1.4.4.1.1.1.1.1.3.2"><ci id="S2.Ex4.m1.1.1.cmml" xref="S2.Ex4.m1.1.1">⋅</ci><ci id="S2.Ex4.m1.2.2.cmml" xref="S2.Ex4.m1.2.2">𝜃</ci></list></apply><apply id="S2.Ex4.m1.4.4.1.1.2.2.2.3.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex4.m1.4.4.1.1.2.2.2.3a.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1"><ci id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.1">⟼</ci><ci id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.2.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.2">𝒳</ci><apply id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3"><times id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.1.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.1"></times><ci id="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.2.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.1.1.3.2">𝒫</ci><ci id="S2.Ex4.m1.3.3.cmml" xref="S2.Ex4.m1.3.3">𝒴</ci></apply></apply><apply id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2"><in id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.1"></in><ci id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.2">𝜃</ci><ci id="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex4.m1.4.4.1.1.2.2.2.2.2.3">Θ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.4c">\mathcal{H}:=\{\phi(\cdot;\theta):\mathcal{X}\longmapsto\mathcal{P}(\mathcal{Y})\ ;\quad\theta\in\Theta\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p6.4" class="ltx_p">where <math id="S2.p6.2.m1.1" class="ltx_Math" alttext="\Theta\subset\mathbb{R}^{d_{l}}" display="inline"><semantics id="S2.p6.2.m1.1a"><mrow id="S2.p6.2.m1.1.1" xref="S2.p6.2.m1.1.1.cmml"><mi mathvariant="normal" id="S2.p6.2.m1.1.1.2" xref="S2.p6.2.m1.1.1.2.cmml">Θ</mi><mo id="S2.p6.2.m1.1.1.1" xref="S2.p6.2.m1.1.1.1.cmml">⊂</mo><msup id="S2.p6.2.m1.1.1.3" xref="S2.p6.2.m1.1.1.3.cmml"><mi id="S2.p6.2.m1.1.1.3.2" xref="S2.p6.2.m1.1.1.3.2.cmml">ℝ</mi><msub id="S2.p6.2.m1.1.1.3.3" xref="S2.p6.2.m1.1.1.3.3.cmml"><mi id="S2.p6.2.m1.1.1.3.3.2" xref="S2.p6.2.m1.1.1.3.3.2.cmml">d</mi><mi id="S2.p6.2.m1.1.1.3.3.3" xref="S2.p6.2.m1.1.1.3.3.3.cmml">l</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.2.m1.1b"><apply id="S2.p6.2.m1.1.1.cmml" xref="S2.p6.2.m1.1.1"><subset id="S2.p6.2.m1.1.1.1.cmml" xref="S2.p6.2.m1.1.1.1"></subset><ci id="S2.p6.2.m1.1.1.2.cmml" xref="S2.p6.2.m1.1.1.2">Θ</ci><apply id="S2.p6.2.m1.1.1.3.cmml" xref="S2.p6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.2.m1.1.1.3.1.cmml" xref="S2.p6.2.m1.1.1.3">superscript</csymbol><ci id="S2.p6.2.m1.1.1.3.2.cmml" xref="S2.p6.2.m1.1.1.3.2">ℝ</ci><apply id="S2.p6.2.m1.1.1.3.3.cmml" xref="S2.p6.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p6.2.m1.1.1.3.3.1.cmml" xref="S2.p6.2.m1.1.1.3.3">subscript</csymbol><ci id="S2.p6.2.m1.1.1.3.3.2.cmml" xref="S2.p6.2.m1.1.1.3.3.2">𝑑</ci><ci id="S2.p6.2.m1.1.1.3.3.3.cmml" xref="S2.p6.2.m1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m1.1c">\Theta\subset\mathbb{R}^{d_{l}}</annotation></semantics></math> is the parameter space.
We define the hypothesis set for the global model, denoted by <math id="S2.p6.3.m2.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S2.p6.3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.3.m2.1.1" xref="S2.p6.3.m2.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.p6.3.m2.1b"><ci id="S2.p6.3.m2.1.1.cmml" xref="S2.p6.3.m2.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m2.1c">\mathcal{G}</annotation></semantics></math>, as a parameterized family of probability measures over <math id="S2.p6.4.m3.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S2.p6.4.m3.1a"><mi mathvariant="normal" id="S2.p6.4.m3.1.1" xref="S2.p6.4.m3.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.4.m3.1b"><ci id="S2.p6.4.m3.1.1.cmml" xref="S2.p6.4.m3.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m3.1c">\Theta</annotation></semantics></math>, denoted by</p>
<table id="S2.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex5.m1.2" class="ltx_Math" alttext="\mathcal{G}:=\{\rho_{\gamma}\in\mathcal{P}(\Theta)\ ;\quad\gamma\in\Gamma\}," display="block"><semantics id="S2.Ex5.m1.2a"><mrow id="S2.Ex5.m1.2.2.1" xref="S2.Ex5.m1.2.2.1.1.cmml"><mrow id="S2.Ex5.m1.2.2.1.1" xref="S2.Ex5.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex5.m1.2.2.1.1.3" xref="S2.Ex5.m1.2.2.1.1.3.cmml">𝒢</mi><mo lspace="0.278em" rspace="0.278em" id="S2.Ex5.m1.2.2.1.1.2" xref="S2.Ex5.m1.2.2.1.1.2.cmml">:=</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex5.m1.2.2.1.1.1.1.2" xref="S2.Ex5.m1.2.2.1.1.1.2.cmml">{</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.3.cmml"><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">ρ</mi><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">γ</mi></msub><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml">∈</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.2.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml">(</mo><mi mathvariant="normal" id="S2.Ex5.m1.1.1" xref="S2.Ex5.m1.1.1.cmml">Θ</mi><mo rspace="0.500em" stretchy="false" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.2.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S2.Ex5.m1.2.2.1.1.1.1.1.2.3" xref="S2.Ex5.m1.2.2.1.1.1.1.1.3a.cmml">;</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.2.cmml">γ</mi><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.1.cmml">∈</mo><mi mathvariant="normal" id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.3" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.3.cmml">Γ</mi></mrow></mrow><mo stretchy="false" id="S2.Ex5.m1.2.2.1.1.1.1.3" xref="S2.Ex5.m1.2.2.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S2.Ex5.m1.2.2.1.2" xref="S2.Ex5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.2b"><apply id="S2.Ex5.m1.2.2.1.1.cmml" xref="S2.Ex5.m1.2.2.1"><csymbol cd="latexml" id="S2.Ex5.m1.2.2.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.2">assign</csymbol><ci id="S2.Ex5.m1.2.2.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.3">𝒢</ci><set id="S2.Ex5.m1.2.2.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1"><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.1.1.3a.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1"><in id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1"></in><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2">𝜌</ci><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3">𝛾</ci></apply><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3"><times id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2">𝒫</ci><ci id="S2.Ex5.m1.1.1.cmml" xref="S2.Ex5.m1.1.1">Θ</ci></apply></apply><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2"><in id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.1"></in><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.2">𝛾</ci><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.2.2.3">Γ</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.2c">\mathcal{G}:=\{\rho_{\gamma}\in\mathcal{P}(\Theta)\ ;\quad\gamma\in\Gamma\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p6.12" class="ltx_p">where <math id="S2.p6.5.m1.1" class="ltx_Math" alttext="\Gamma\subset\mathbb{R}^{d_{g}}" display="inline"><semantics id="S2.p6.5.m1.1a"><mrow id="S2.p6.5.m1.1.1" xref="S2.p6.5.m1.1.1.cmml"><mi mathvariant="normal" id="S2.p6.5.m1.1.1.2" xref="S2.p6.5.m1.1.1.2.cmml">Γ</mi><mo id="S2.p6.5.m1.1.1.1" xref="S2.p6.5.m1.1.1.1.cmml">⊂</mo><msup id="S2.p6.5.m1.1.1.3" xref="S2.p6.5.m1.1.1.3.cmml"><mi id="S2.p6.5.m1.1.1.3.2" xref="S2.p6.5.m1.1.1.3.2.cmml">ℝ</mi><msub id="S2.p6.5.m1.1.1.3.3" xref="S2.p6.5.m1.1.1.3.3.cmml"><mi id="S2.p6.5.m1.1.1.3.3.2" xref="S2.p6.5.m1.1.1.3.3.2.cmml">d</mi><mi id="S2.p6.5.m1.1.1.3.3.3" xref="S2.p6.5.m1.1.1.3.3.3.cmml">g</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.5.m1.1b"><apply id="S2.p6.5.m1.1.1.cmml" xref="S2.p6.5.m1.1.1"><subset id="S2.p6.5.m1.1.1.1.cmml" xref="S2.p6.5.m1.1.1.1"></subset><ci id="S2.p6.5.m1.1.1.2.cmml" xref="S2.p6.5.m1.1.1.2">Γ</ci><apply id="S2.p6.5.m1.1.1.3.cmml" xref="S2.p6.5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.5.m1.1.1.3.1.cmml" xref="S2.p6.5.m1.1.1.3">superscript</csymbol><ci id="S2.p6.5.m1.1.1.3.2.cmml" xref="S2.p6.5.m1.1.1.3.2">ℝ</ci><apply id="S2.p6.5.m1.1.1.3.3.cmml" xref="S2.p6.5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p6.5.m1.1.1.3.3.1.cmml" xref="S2.p6.5.m1.1.1.3.3">subscript</csymbol><ci id="S2.p6.5.m1.1.1.3.3.2.cmml" xref="S2.p6.5.m1.1.1.3.3.2">𝑑</ci><ci id="S2.p6.5.m1.1.1.3.3.3.cmml" xref="S2.p6.5.m1.1.1.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m1.1c">\Gamma\subset\mathbb{R}^{d_{g}}</annotation></semantics></math> is the parameter space for the global model.
Here, <math id="S2.p6.6.m2.1" class="ltx_Math" alttext="d_{l}" display="inline"><semantics id="S2.p6.6.m2.1a"><msub id="S2.p6.6.m2.1.1" xref="S2.p6.6.m2.1.1.cmml"><mi id="S2.p6.6.m2.1.1.2" xref="S2.p6.6.m2.1.1.2.cmml">d</mi><mi id="S2.p6.6.m2.1.1.3" xref="S2.p6.6.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.6.m2.1b"><apply id="S2.p6.6.m2.1.1.cmml" xref="S2.p6.6.m2.1.1"><csymbol cd="ambiguous" id="S2.p6.6.m2.1.1.1.cmml" xref="S2.p6.6.m2.1.1">subscript</csymbol><ci id="S2.p6.6.m2.1.1.2.cmml" xref="S2.p6.6.m2.1.1.2">𝑑</ci><ci id="S2.p6.6.m2.1.1.3.cmml" xref="S2.p6.6.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.6.m2.1c">d_{l}</annotation></semantics></math> and <math id="S2.p6.7.m3.1" class="ltx_Math" alttext="d_{g}" display="inline"><semantics id="S2.p6.7.m3.1a"><msub id="S2.p6.7.m3.1.1" xref="S2.p6.7.m3.1.1.cmml"><mi id="S2.p6.7.m3.1.1.2" xref="S2.p6.7.m3.1.1.2.cmml">d</mi><mi id="S2.p6.7.m3.1.1.3" xref="S2.p6.7.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.7.m3.1b"><apply id="S2.p6.7.m3.1.1.cmml" xref="S2.p6.7.m3.1.1"><csymbol cd="ambiguous" id="S2.p6.7.m3.1.1.1.cmml" xref="S2.p6.7.m3.1.1">subscript</csymbol><ci id="S2.p6.7.m3.1.1.2.cmml" xref="S2.p6.7.m3.1.1.2">𝑑</ci><ci id="S2.p6.7.m3.1.1.3.cmml" xref="S2.p6.7.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.7.m3.1c">d_{g}</annotation></semantics></math> denote the number of parameters for the hypothesis sets <math id="S2.p6.8.m4.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S2.p6.8.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.8.m4.1.1" xref="S2.p6.8.m4.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.8.m4.1b"><ci id="S2.p6.8.m4.1.1.cmml" xref="S2.p6.8.m4.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.8.m4.1c">\mathcal{H}</annotation></semantics></math> and <math id="S2.p6.9.m5.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S2.p6.9.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p6.9.m5.1.1" xref="S2.p6.9.m5.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.p6.9.m5.1b"><ci id="S2.p6.9.m5.1.1.cmml" xref="S2.p6.9.m5.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.9.m5.1c">\mathcal{G}</annotation></semantics></math> respectively.
Since we shall always consider absolutely continuous probability measures <math id="S2.p6.10.m6.1" class="ltx_Math" alttext="\rho_{\gamma}" display="inline"><semantics id="S2.p6.10.m6.1a"><msub id="S2.p6.10.m6.1.1" xref="S2.p6.10.m6.1.1.cmml"><mi id="S2.p6.10.m6.1.1.2" xref="S2.p6.10.m6.1.1.2.cmml">ρ</mi><mi id="S2.p6.10.m6.1.1.3" xref="S2.p6.10.m6.1.1.3.cmml">γ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.10.m6.1b"><apply id="S2.p6.10.m6.1.1.cmml" xref="S2.p6.10.m6.1.1"><csymbol cd="ambiguous" id="S2.p6.10.m6.1.1.1.cmml" xref="S2.p6.10.m6.1.1">subscript</csymbol><ci id="S2.p6.10.m6.1.1.2.cmml" xref="S2.p6.10.m6.1.1.2">𝜌</ci><ci id="S2.p6.10.m6.1.1.3.cmml" xref="S2.p6.10.m6.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.10.m6.1c">\rho_{\gamma}</annotation></semantics></math> over <math id="S2.p6.11.m7.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S2.p6.11.m7.1a"><mi mathvariant="normal" id="S2.p6.11.m7.1.1" xref="S2.p6.11.m7.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.11.m7.1b"><ci id="S2.p6.11.m7.1.1.cmml" xref="S2.p6.11.m7.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.11.m7.1c">\Theta</annotation></semantics></math>, from now on, with a slight abuse of notation, we will use <math id="S2.p6.12.m8.1" class="ltx_Math" alttext="\rho_{\gamma}:\Theta\to\mathbb{R}^{+}" display="inline"><semantics id="S2.p6.12.m8.1a"><mrow id="S2.p6.12.m8.1.1" xref="S2.p6.12.m8.1.1.cmml"><msub id="S2.p6.12.m8.1.1.2" xref="S2.p6.12.m8.1.1.2.cmml"><mi id="S2.p6.12.m8.1.1.2.2" xref="S2.p6.12.m8.1.1.2.2.cmml">ρ</mi><mi id="S2.p6.12.m8.1.1.2.3" xref="S2.p6.12.m8.1.1.2.3.cmml">γ</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S2.p6.12.m8.1.1.1" xref="S2.p6.12.m8.1.1.1.cmml">:</mo><mrow id="S2.p6.12.m8.1.1.3" xref="S2.p6.12.m8.1.1.3.cmml"><mi mathvariant="normal" id="S2.p6.12.m8.1.1.3.2" xref="S2.p6.12.m8.1.1.3.2.cmml">Θ</mi><mo stretchy="false" id="S2.p6.12.m8.1.1.3.1" xref="S2.p6.12.m8.1.1.3.1.cmml">→</mo><msup id="S2.p6.12.m8.1.1.3.3" xref="S2.p6.12.m8.1.1.3.3.cmml"><mi id="S2.p6.12.m8.1.1.3.3.2" xref="S2.p6.12.m8.1.1.3.3.2.cmml">ℝ</mi><mo id="S2.p6.12.m8.1.1.3.3.3" xref="S2.p6.12.m8.1.1.3.3.3.cmml">+</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.12.m8.1b"><apply id="S2.p6.12.m8.1.1.cmml" xref="S2.p6.12.m8.1.1"><ci id="S2.p6.12.m8.1.1.1.cmml" xref="S2.p6.12.m8.1.1.1">:</ci><apply id="S2.p6.12.m8.1.1.2.cmml" xref="S2.p6.12.m8.1.1.2"><csymbol cd="ambiguous" id="S2.p6.12.m8.1.1.2.1.cmml" xref="S2.p6.12.m8.1.1.2">subscript</csymbol><ci id="S2.p6.12.m8.1.1.2.2.cmml" xref="S2.p6.12.m8.1.1.2.2">𝜌</ci><ci id="S2.p6.12.m8.1.1.2.3.cmml" xref="S2.p6.12.m8.1.1.2.3">𝛾</ci></apply><apply id="S2.p6.12.m8.1.1.3.cmml" xref="S2.p6.12.m8.1.1.3"><ci id="S2.p6.12.m8.1.1.3.1.cmml" xref="S2.p6.12.m8.1.1.3.1">→</ci><ci id="S2.p6.12.m8.1.1.3.2.cmml" xref="S2.p6.12.m8.1.1.3.2">Θ</ci><apply id="S2.p6.12.m8.1.1.3.3.cmml" xref="S2.p6.12.m8.1.1.3.3"><csymbol cd="ambiguous" id="S2.p6.12.m8.1.1.3.3.1.cmml" xref="S2.p6.12.m8.1.1.3.3">superscript</csymbol><ci id="S2.p6.12.m8.1.1.3.3.2.cmml" xref="S2.p6.12.m8.1.1.3.3.2">ℝ</ci><plus id="S2.p6.12.m8.1.1.3.3.3.cmml" xref="S2.p6.12.m8.1.1.3.3.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.12.m8.1c">\rho_{\gamma}:\Theta\to\mathbb{R}^{+}</annotation></semantics></math> to denote the associated probability density function.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Local training as MAP estimation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.5" class="ltx_p">Given a global model <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\rho_{\gamma}\in\mathcal{G}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><msub id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2.2" xref="S2.SS1.p1.1.m1.1.1.2.2.cmml">ρ</mi><mi id="S2.SS1.p1.1.m1.1.1.2.3" xref="S2.SS1.p1.1.m1.1.1.2.3.cmml">γ</mi></msub><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><apply id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2.2">𝜌</ci><ci id="S2.SS1.p1.1.m1.1.1.2.3.cmml" xref="S2.SS1.p1.1.m1.1.1.2.3">𝛾</ci></apply><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\rho_{\gamma}\in\mathcal{G}</annotation></semantics></math>, we can compute, for any <math id="S2.SS1.p1.2.m2.2" class="ltx_Math" alttext="(x,y)\in\mathcal{X}\times\mathcal{Y}" display="inline"><semantics id="S2.SS1.p1.2.m2.2a"><mrow id="S2.SS1.p1.2.m2.2.3" xref="S2.SS1.p1.2.m2.2.3.cmml"><mrow id="S2.SS1.p1.2.m2.2.3.2.2" xref="S2.SS1.p1.2.m2.2.3.2.1.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.2.3.2.2.1" xref="S2.SS1.p1.2.m2.2.3.2.1.cmml">(</mo><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">x</mi><mo id="S2.SS1.p1.2.m2.2.3.2.2.2" xref="S2.SS1.p1.2.m2.2.3.2.1.cmml">,</mo><mi id="S2.SS1.p1.2.m2.2.2" xref="S2.SS1.p1.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.2.m2.2.3.2.2.3" xref="S2.SS1.p1.2.m2.2.3.2.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.2.m2.2.3.1" xref="S2.SS1.p1.2.m2.2.3.1.cmml">∈</mo><mrow id="S2.SS1.p1.2.m2.2.3.3" xref="S2.SS1.p1.2.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.2.3.3.2" xref="S2.SS1.p1.2.m2.2.3.3.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p1.2.m2.2.3.3.1" xref="S2.SS1.p1.2.m2.2.3.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.2.3.3.3" xref="S2.SS1.p1.2.m2.2.3.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.3"><in id="S2.SS1.p1.2.m2.2.3.1.cmml" xref="S2.SS1.p1.2.m2.2.3.1"></in><interval closure="open" id="S2.SS1.p1.2.m2.2.3.2.1.cmml" xref="S2.SS1.p1.2.m2.2.3.2.2"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑥</ci><ci id="S2.SS1.p1.2.m2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2">𝑦</ci></interval><apply id="S2.SS1.p1.2.m2.2.3.3.cmml" xref="S2.SS1.p1.2.m2.2.3.3"><times id="S2.SS1.p1.2.m2.2.3.3.1.cmml" xref="S2.SS1.p1.2.m2.2.3.3.1"></times><ci id="S2.SS1.p1.2.m2.2.3.3.2.cmml" xref="S2.SS1.p1.2.m2.2.3.3.2">𝒳</ci><ci id="S2.SS1.p1.2.m2.2.3.3.3.cmml" xref="S2.SS1.p1.2.m2.2.3.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">(x,y)\in\mathcal{X}\times\mathcal{Y}</annotation></semantics></math> and <math id="S2.SS1.p1.3.m3.2" class="ltx_Math" alttext="\phi(\cdot;\theta)\in\mathcal{H}" display="inline"><semantics id="S2.SS1.p1.3.m3.2a"><mrow id="S2.SS1.p1.3.m3.2.3" xref="S2.SS1.p1.3.m3.2.3.cmml"><mrow id="S2.SS1.p1.3.m3.2.3.2" xref="S2.SS1.p1.3.m3.2.3.2.cmml"><mi id="S2.SS1.p1.3.m3.2.3.2.2" xref="S2.SS1.p1.3.m3.2.3.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.2.3.2.1" xref="S2.SS1.p1.3.m3.2.3.2.1.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.2.3.2.3.2" xref="S2.SS1.p1.3.m3.2.3.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.2.3.2.3.2.1" xref="S2.SS1.p1.3.m3.2.3.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">⋅</mo><mo id="S2.SS1.p1.3.m3.2.3.2.3.2.2" xref="S2.SS1.p1.3.m3.2.3.2.3.1.cmml">;</mo><mi id="S2.SS1.p1.3.m3.2.2" xref="S2.SS1.p1.3.m3.2.2.cmml">θ</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.2.3.2.3.2.3" xref="S2.SS1.p1.3.m3.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.3.m3.2.3.1" xref="S2.SS1.p1.3.m3.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.2.3.3" xref="S2.SS1.p1.3.m3.2.3.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.2b"><apply id="S2.SS1.p1.3.m3.2.3.cmml" xref="S2.SS1.p1.3.m3.2.3"><in id="S2.SS1.p1.3.m3.2.3.1.cmml" xref="S2.SS1.p1.3.m3.2.3.1"></in><apply id="S2.SS1.p1.3.m3.2.3.2.cmml" xref="S2.SS1.p1.3.m3.2.3.2"><times id="S2.SS1.p1.3.m3.2.3.2.1.cmml" xref="S2.SS1.p1.3.m3.2.3.2.1"></times><ci id="S2.SS1.p1.3.m3.2.3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.3.2.2">italic-ϕ</ci><list id="S2.SS1.p1.3.m3.2.3.2.3.1.cmml" xref="S2.SS1.p1.3.m3.2.3.2.3.2"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">⋅</ci><ci id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2">𝜃</ci></list></apply><ci id="S2.SS1.p1.3.m3.2.3.3.cmml" xref="S2.SS1.p1.3.m3.2.3.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.2c">\phi(\cdot;\theta)\in\mathcal{H}</annotation></semantics></math>, the likelihood of the posterior probability distribution with respect to the prior <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\rho_{\gamma}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">ρ</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">γ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝜌</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\rho_{\gamma}</annotation></semantics></math>. Up to a multiplicative constant, which is independent of <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\theta</annotation></semantics></math>, we can use Bayes Theorem to write the posterior as</p>
<table id="S2.Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex6.m1.9" class="ltx_Math" alttext="\mathbb{P}(\theta|(x,y))\propto\mathbb{P}((x,y)|\theta)\rho_{\gamma}(\theta)=\mathbb{P}(y|\phi(x;\theta))\rho_{\gamma}(\theta)." display="block"><semantics id="S2.Ex6.m1.9a"><mrow id="S2.Ex6.m1.9.9.1" xref="S2.Ex6.m1.9.9.1.1.cmml"><mrow id="S2.Ex6.m1.9.9.1.1" xref="S2.Ex6.m1.9.9.1.1.cmml"><mrow id="S2.Ex6.m1.9.9.1.1.1" xref="S2.Ex6.m1.9.9.1.1.1.cmml"><mi id="S2.Ex6.m1.9.9.1.1.1.3" xref="S2.Ex6.m1.9.9.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.1.2" xref="S2.Ex6.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.1.1.1" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.1.1.1.2" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.9.9.1.1.1.1.1.1" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S2.Ex6.m1.9.9.1.1.1.1.1.1.2" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.2.cmml">θ</mi><mo fence="false" id="S2.Ex6.m1.9.9.1.1.1.1.1.1.1" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.2" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.2.1" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.Ex6.m1.1.1" xref="S2.Ex6.m1.1.1.cmml">x</mi><mo id="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.2.2" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.Ex6.m1.2.2" xref="S2.Ex6.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.2.3" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.1.1.1.3" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.9.9.1.1.5" xref="S2.Ex6.m1.9.9.1.1.5.cmml">∝</mo><mrow id="S2.Ex6.m1.9.9.1.1.2" xref="S2.Ex6.m1.9.9.1.1.2.cmml"><mi id="S2.Ex6.m1.9.9.1.1.2.3" xref="S2.Ex6.m1.9.9.1.1.2.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.2.2" xref="S2.Ex6.m1.9.9.1.1.2.2.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.2.1.1" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.1.1.2" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.9.9.1.1.2.1.1.1" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.cmml"><mrow id="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.2" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.2.1" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.1.cmml">(</mo><mi id="S2.Ex6.m1.3.3" xref="S2.Ex6.m1.3.3.cmml">x</mi><mo id="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.2.2" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.1.cmml">,</mo><mi id="S2.Ex6.m1.4.4" xref="S2.Ex6.m1.4.4.cmml">y</mi><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.2.3" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.1.cmml">)</mo></mrow><mo fence="false" id="S2.Ex6.m1.9.9.1.1.2.1.1.1.1" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.1.cmml">|</mo><mi id="S2.Ex6.m1.9.9.1.1.2.1.1.1.3" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.3.cmml">θ</mi></mrow><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.1.1.3" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.2.2a" xref="S2.Ex6.m1.9.9.1.1.2.2.cmml">​</mo><msub id="S2.Ex6.m1.9.9.1.1.2.4" xref="S2.Ex6.m1.9.9.1.1.2.4.cmml"><mi id="S2.Ex6.m1.9.9.1.1.2.4.2" xref="S2.Ex6.m1.9.9.1.1.2.4.2.cmml">ρ</mi><mi id="S2.Ex6.m1.9.9.1.1.2.4.3" xref="S2.Ex6.m1.9.9.1.1.2.4.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.2.2b" xref="S2.Ex6.m1.9.9.1.1.2.2.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.2.5.2" xref="S2.Ex6.m1.9.9.1.1.2.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.5.2.1" xref="S2.Ex6.m1.9.9.1.1.2.cmml">(</mo><mi id="S2.Ex6.m1.5.5" xref="S2.Ex6.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.2.5.2.2" xref="S2.Ex6.m1.9.9.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex6.m1.9.9.1.1.6" xref="S2.Ex6.m1.9.9.1.1.6.cmml">=</mo><mrow id="S2.Ex6.m1.9.9.1.1.3" xref="S2.Ex6.m1.9.9.1.1.3.cmml"><mi id="S2.Ex6.m1.9.9.1.1.3.3" xref="S2.Ex6.m1.9.9.1.1.3.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.3.2" xref="S2.Ex6.m1.9.9.1.1.3.2.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.3.1.1" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.1.1.2" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.cmml">(</mo><mrow id="S2.Ex6.m1.9.9.1.1.3.1.1.1" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.cmml"><mi id="S2.Ex6.m1.9.9.1.1.3.1.1.1.2" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.Ex6.m1.9.9.1.1.3.1.1.1.1" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.1.cmml">|</mo><mrow id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.cmml"><mi id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.2" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.1" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.2" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.2.1" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex6.m1.6.6" xref="S2.Ex6.m1.6.6.cmml">x</mi><mo id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.2.2" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.1.cmml">;</mo><mi id="S2.Ex6.m1.7.7" xref="S2.Ex6.m1.7.7.cmml">θ</mi><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.2.3" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.1.1.3" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.3.2a" xref="S2.Ex6.m1.9.9.1.1.3.2.cmml">​</mo><msub id="S2.Ex6.m1.9.9.1.1.3.4" xref="S2.Ex6.m1.9.9.1.1.3.4.cmml"><mi id="S2.Ex6.m1.9.9.1.1.3.4.2" xref="S2.Ex6.m1.9.9.1.1.3.4.2.cmml">ρ</mi><mi id="S2.Ex6.m1.9.9.1.1.3.4.3" xref="S2.Ex6.m1.9.9.1.1.3.4.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex6.m1.9.9.1.1.3.2b" xref="S2.Ex6.m1.9.9.1.1.3.2.cmml">​</mo><mrow id="S2.Ex6.m1.9.9.1.1.3.5.2" xref="S2.Ex6.m1.9.9.1.1.3.cmml"><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.5.2.1" xref="S2.Ex6.m1.9.9.1.1.3.cmml">(</mo><mi id="S2.Ex6.m1.8.8" xref="S2.Ex6.m1.8.8.cmml">θ</mi><mo stretchy="false" id="S2.Ex6.m1.9.9.1.1.3.5.2.2" xref="S2.Ex6.m1.9.9.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex6.m1.9.9.1.2" xref="S2.Ex6.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6.m1.9b"><apply id="S2.Ex6.m1.9.9.1.1.cmml" xref="S2.Ex6.m1.9.9.1"><and id="S2.Ex6.m1.9.9.1.1a.cmml" xref="S2.Ex6.m1.9.9.1"></and><apply id="S2.Ex6.m1.9.9.1.1b.cmml" xref="S2.Ex6.m1.9.9.1"><csymbol cd="latexml" id="S2.Ex6.m1.9.9.1.1.5.cmml" xref="S2.Ex6.m1.9.9.1.1.5">proportional-to</csymbol><apply id="S2.Ex6.m1.9.9.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.1"><times id="S2.Ex6.m1.9.9.1.1.1.2.cmml" xref="S2.Ex6.m1.9.9.1.1.1.2"></times><ci id="S2.Ex6.m1.9.9.1.1.1.3.cmml" xref="S2.Ex6.m1.9.9.1.1.1.3">ℙ</ci><apply id="S2.Ex6.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex6.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.2">𝜃</ci><interval closure="open" id="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex6.m1.9.9.1.1.1.1.1.1.3.2"><ci id="S2.Ex6.m1.1.1.cmml" xref="S2.Ex6.m1.1.1">𝑥</ci><ci id="S2.Ex6.m1.2.2.cmml" xref="S2.Ex6.m1.2.2">𝑦</ci></interval></apply></apply><apply id="S2.Ex6.m1.9.9.1.1.2.cmml" xref="S2.Ex6.m1.9.9.1.1.2"><times id="S2.Ex6.m1.9.9.1.1.2.2.cmml" xref="S2.Ex6.m1.9.9.1.1.2.2"></times><ci id="S2.Ex6.m1.9.9.1.1.2.3.cmml" xref="S2.Ex6.m1.9.9.1.1.2.3">ℙ</ci><apply id="S2.Ex6.m1.9.9.1.1.2.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.2.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.9.9.1.1.2.1.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.1">conditional</csymbol><interval closure="open" id="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.1.cmml" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.2.2"><ci id="S2.Ex6.m1.3.3.cmml" xref="S2.Ex6.m1.3.3">𝑥</ci><ci id="S2.Ex6.m1.4.4.cmml" xref="S2.Ex6.m1.4.4">𝑦</ci></interval><ci id="S2.Ex6.m1.9.9.1.1.2.1.1.1.3.cmml" xref="S2.Ex6.m1.9.9.1.1.2.1.1.1.3">𝜃</ci></apply><apply id="S2.Ex6.m1.9.9.1.1.2.4.cmml" xref="S2.Ex6.m1.9.9.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex6.m1.9.9.1.1.2.4.1.cmml" xref="S2.Ex6.m1.9.9.1.1.2.4">subscript</csymbol><ci id="S2.Ex6.m1.9.9.1.1.2.4.2.cmml" xref="S2.Ex6.m1.9.9.1.1.2.4.2">𝜌</ci><ci id="S2.Ex6.m1.9.9.1.1.2.4.3.cmml" xref="S2.Ex6.m1.9.9.1.1.2.4.3">𝛾</ci></apply><ci id="S2.Ex6.m1.5.5.cmml" xref="S2.Ex6.m1.5.5">𝜃</ci></apply></apply><apply id="S2.Ex6.m1.9.9.1.1c.cmml" xref="S2.Ex6.m1.9.9.1"><eq id="S2.Ex6.m1.9.9.1.1.6.cmml" xref="S2.Ex6.m1.9.9.1.1.6"></eq><share href="#S2.Ex6.m1.9.9.1.1.2.cmml" id="S2.Ex6.m1.9.9.1.1d.cmml" xref="S2.Ex6.m1.9.9.1"></share><apply id="S2.Ex6.m1.9.9.1.1.3.cmml" xref="S2.Ex6.m1.9.9.1.1.3"><times id="S2.Ex6.m1.9.9.1.1.3.2.cmml" xref="S2.Ex6.m1.9.9.1.1.3.2"></times><ci id="S2.Ex6.m1.9.9.1.1.3.3.cmml" xref="S2.Ex6.m1.9.9.1.1.3.3">ℙ</ci><apply id="S2.Ex6.m1.9.9.1.1.3.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1"><csymbol cd="latexml" id="S2.Ex6.m1.9.9.1.1.3.1.1.1.1.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.1">conditional</csymbol><ci id="S2.Ex6.m1.9.9.1.1.3.1.1.1.2.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.2">𝑦</ci><apply id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3"><times id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.1.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.1"></times><ci id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.2.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.2">italic-ϕ</ci><list id="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.1.cmml" xref="S2.Ex6.m1.9.9.1.1.3.1.1.1.3.3.2"><ci id="S2.Ex6.m1.6.6.cmml" xref="S2.Ex6.m1.6.6">𝑥</ci><ci id="S2.Ex6.m1.7.7.cmml" xref="S2.Ex6.m1.7.7">𝜃</ci></list></apply></apply><apply id="S2.Ex6.m1.9.9.1.1.3.4.cmml" xref="S2.Ex6.m1.9.9.1.1.3.4"><csymbol cd="ambiguous" id="S2.Ex6.m1.9.9.1.1.3.4.1.cmml" xref="S2.Ex6.m1.9.9.1.1.3.4">subscript</csymbol><ci id="S2.Ex6.m1.9.9.1.1.3.4.2.cmml" xref="S2.Ex6.m1.9.9.1.1.3.4.2">𝜌</ci><ci id="S2.Ex6.m1.9.9.1.1.3.4.3.cmml" xref="S2.Ex6.m1.9.9.1.1.3.4.3">𝛾</ci></apply><ci id="S2.Ex6.m1.8.8.cmml" xref="S2.Ex6.m1.8.8">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m1.9c">\mathbb{P}(\theta|(x,y))\propto\mathbb{P}((x,y)|\theta)\rho_{\gamma}(\theta)=\mathbb{P}(y|\phi(x;\theta))\rho_{\gamma}(\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.9" class="ltx_p">Then, if we consider the problem of minimizing the negative log-likelihood of the posterior probability distribution, we can take the following loss function:</p>
<table id="S2.Ex7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex7.m1.8" class="ltx_Math" alttext="\mathcal{L}(\theta,(x,y),\rho_{\gamma}):=-\log\left[\mathbb{P}(y|\phi(x;\theta))\right]-\log\rho_{\gamma}(\theta)." display="block"><semantics id="S2.Ex7.m1.8a"><mrow id="S2.Ex7.m1.8.8.1" xref="S2.Ex7.m1.8.8.1.1.cmml"><mrow id="S2.Ex7.m1.8.8.1.1" xref="S2.Ex7.m1.8.8.1.1.cmml"><mrow id="S2.Ex7.m1.8.8.1.1.2" xref="S2.Ex7.m1.8.8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex7.m1.8.8.1.1.2.4" xref="S2.Ex7.m1.8.8.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.Ex7.m1.8.8.1.1.2.3" xref="S2.Ex7.m1.8.8.1.1.2.3.cmml">​</mo><mrow id="S2.Ex7.m1.8.8.1.1.2.2.2" xref="S2.Ex7.m1.8.8.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.2.2.2.3" xref="S2.Ex7.m1.8.8.1.1.2.2.3.cmml">(</mo><mi id="S2.Ex7.m1.3.3" xref="S2.Ex7.m1.3.3.cmml">θ</mi><mo id="S2.Ex7.m1.8.8.1.1.2.2.2.4" xref="S2.Ex7.m1.8.8.1.1.2.2.3.cmml">,</mo><mrow id="S2.Ex7.m1.8.8.1.1.1.1.1.1.2" xref="S2.Ex7.m1.8.8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.1.1.1.1.2.1" xref="S2.Ex7.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex7.m1.1.1" xref="S2.Ex7.m1.1.1.cmml">x</mi><mo id="S2.Ex7.m1.8.8.1.1.1.1.1.1.2.2" xref="S2.Ex7.m1.8.8.1.1.1.1.1.1.1.cmml">,</mo><mi id="S2.Ex7.m1.2.2" xref="S2.Ex7.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.1.1.1.1.2.3" xref="S2.Ex7.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex7.m1.8.8.1.1.2.2.2.5" xref="S2.Ex7.m1.8.8.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex7.m1.8.8.1.1.2.2.2.2" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2.cmml"><mi id="S2.Ex7.m1.8.8.1.1.2.2.2.2.2" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2.2.cmml">ρ</mi><mi id="S2.Ex7.m1.8.8.1.1.2.2.2.2.3" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2.3.cmml">γ</mi></msub><mo rspace="0.278em" stretchy="false" id="S2.Ex7.m1.8.8.1.1.2.2.2.6" xref="S2.Ex7.m1.8.8.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.Ex7.m1.8.8.1.1.4" xref="S2.Ex7.m1.8.8.1.1.4.cmml">:=</mo><mrow id="S2.Ex7.m1.8.8.1.1.3" xref="S2.Ex7.m1.8.8.1.1.3.cmml"><mrow id="S2.Ex7.m1.8.8.1.1.3.1" xref="S2.Ex7.m1.8.8.1.1.3.1.cmml"><mo rspace="0.167em" id="S2.Ex7.m1.8.8.1.1.3.1a" xref="S2.Ex7.m1.8.8.1.1.3.1.cmml">−</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml"><mi id="S2.Ex7.m1.6.6" xref="S2.Ex7.m1.6.6.cmml">log</mi><mo id="S2.Ex7.m1.8.8.1.1.3.1.1.1a" xref="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml">⁡</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml"><mo id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml">[</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.cmml"><mi id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.3" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.2.1" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex7.m1.4.4" xref="S2.Ex7.m1.4.4.cmml">x</mi><mo id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml">;</mo><mi id="S2.Ex7.m1.5.5" xref="S2.Ex7.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.3" xref="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="S2.Ex7.m1.8.8.1.1.3.2" xref="S2.Ex7.m1.8.8.1.1.3.2.cmml">−</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.3" xref="S2.Ex7.m1.8.8.1.1.3.3.cmml"><mrow id="S2.Ex7.m1.8.8.1.1.3.3.2" xref="S2.Ex7.m1.8.8.1.1.3.3.2.cmml"><mi id="S2.Ex7.m1.8.8.1.1.3.3.2.1" xref="S2.Ex7.m1.8.8.1.1.3.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex7.m1.8.8.1.1.3.3.2a" xref="S2.Ex7.m1.8.8.1.1.3.3.2.cmml">⁡</mo><msub id="S2.Ex7.m1.8.8.1.1.3.3.2.2" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2.cmml"><mi id="S2.Ex7.m1.8.8.1.1.3.3.2.2.2" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2.2.cmml">ρ</mi><mi id="S2.Ex7.m1.8.8.1.1.3.3.2.2.3" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2.3.cmml">γ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.Ex7.m1.8.8.1.1.3.3.1" xref="S2.Ex7.m1.8.8.1.1.3.3.1.cmml">​</mo><mrow id="S2.Ex7.m1.8.8.1.1.3.3.3.2" xref="S2.Ex7.m1.8.8.1.1.3.3.cmml"><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.3.3.2.1" xref="S2.Ex7.m1.8.8.1.1.3.3.cmml">(</mo><mi id="S2.Ex7.m1.7.7" xref="S2.Ex7.m1.7.7.cmml">θ</mi><mo stretchy="false" id="S2.Ex7.m1.8.8.1.1.3.3.3.2.2" xref="S2.Ex7.m1.8.8.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex7.m1.8.8.1.2" xref="S2.Ex7.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7.m1.8b"><apply id="S2.Ex7.m1.8.8.1.1.cmml" xref="S2.Ex7.m1.8.8.1"><csymbol cd="latexml" id="S2.Ex7.m1.8.8.1.1.4.cmml" xref="S2.Ex7.m1.8.8.1.1.4">assign</csymbol><apply id="S2.Ex7.m1.8.8.1.1.2.cmml" xref="S2.Ex7.m1.8.8.1.1.2"><times id="S2.Ex7.m1.8.8.1.1.2.3.cmml" xref="S2.Ex7.m1.8.8.1.1.2.3"></times><ci id="S2.Ex7.m1.8.8.1.1.2.4.cmml" xref="S2.Ex7.m1.8.8.1.1.2.4">ℒ</ci><vector id="S2.Ex7.m1.8.8.1.1.2.2.3.cmml" xref="S2.Ex7.m1.8.8.1.1.2.2.2"><ci id="S2.Ex7.m1.3.3.cmml" xref="S2.Ex7.m1.3.3">𝜃</ci><interval closure="open" id="S2.Ex7.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.8.8.1.1.1.1.1.1.2"><ci id="S2.Ex7.m1.1.1.cmml" xref="S2.Ex7.m1.1.1">𝑥</ci><ci id="S2.Ex7.m1.2.2.cmml" xref="S2.Ex7.m1.2.2">𝑦</ci></interval><apply id="S2.Ex7.m1.8.8.1.1.2.2.2.2.cmml" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex7.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2.2">𝜌</ci><ci id="S2.Ex7.m1.8.8.1.1.2.2.2.2.3.cmml" xref="S2.Ex7.m1.8.8.1.1.2.2.2.2.3">𝛾</ci></apply></vector></apply><apply id="S2.Ex7.m1.8.8.1.1.3.cmml" xref="S2.Ex7.m1.8.8.1.1.3"><minus id="S2.Ex7.m1.8.8.1.1.3.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.2"></minus><apply id="S2.Ex7.m1.8.8.1.1.3.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1"><minus id="S2.Ex7.m1.8.8.1.1.3.1.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1"></minus><apply id="S2.Ex7.m1.8.8.1.1.3.1.1.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1"><log id="S2.Ex7.m1.6.6.cmml" xref="S2.Ex7.m1.6.6"></log><apply id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1"><times id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.2"></times><ci id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.3.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.3">ℙ</ci><apply id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3"><times id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><list id="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.3.3.2"><ci id="S2.Ex7.m1.4.4.cmml" xref="S2.Ex7.m1.4.4">𝑥</ci><ci id="S2.Ex7.m1.5.5.cmml" xref="S2.Ex7.m1.5.5">𝜃</ci></list></apply></apply></apply></apply></apply><apply id="S2.Ex7.m1.8.8.1.1.3.3.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3"><times id="S2.Ex7.m1.8.8.1.1.3.3.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.1"></times><apply id="S2.Ex7.m1.8.8.1.1.3.3.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2"><log id="S2.Ex7.m1.8.8.1.1.3.3.2.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2.1"></log><apply id="S2.Ex7.m1.8.8.1.1.3.3.2.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.Ex7.m1.8.8.1.1.3.3.2.2.1.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2">subscript</csymbol><ci id="S2.Ex7.m1.8.8.1.1.3.3.2.2.2.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2.2">𝜌</ci><ci id="S2.Ex7.m1.8.8.1.1.3.3.2.2.3.cmml" xref="S2.Ex7.m1.8.8.1.1.3.3.2.2.3">𝛾</ci></apply></apply><ci id="S2.Ex7.m1.7.7.cmml" xref="S2.Ex7.m1.7.7">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7.m1.8c">\mathcal{L}(\theta,(x,y),\rho_{\gamma}):=-\log\left[\mathbb{P}(y|\phi(x;\theta))\right]-\log\rho_{\gamma}(\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.6" class="ltx_p">Finally, if we consider empirical risk minimization as a training algorithm for the local training, we end up with the following minimization problem for the <math id="S2.SS1.p1.6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.6.m1.1a"><mi id="S2.SS1.p1.6.m1.1.1" xref="S2.SS1.p1.6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m1.1b"><ci id="S2.SS1.p1.6.m1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m1.1c">k</annotation></semantics></math>-local model</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.6" class="ltx_Math" alttext="\theta_{k}^{\ast}\in\arg\min_{\theta\in\Theta}\dfrac{1}{N_{k}}\sum_{i=1}^{N_{k}}-\log\left[\mathbb{P}(y_{k}^{(i)}|\phi(x_{k}^{(i)};\theta))\right]-\log\rho_{\gamma}(\theta)," display="block"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1" xref="S2.E2.m1.6.6.1.1.cmml"><msubsup id="S2.E2.m1.6.6.1.1.3" xref="S2.E2.m1.6.6.1.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.3.2.2" xref="S2.E2.m1.6.6.1.1.3.2.2.cmml">θ</mi><mi id="S2.E2.m1.6.6.1.1.3.2.3" xref="S2.E2.m1.6.6.1.1.3.2.3.cmml">k</mi><mo id="S2.E2.m1.6.6.1.1.3.3" xref="S2.E2.m1.6.6.1.1.3.3.cmml">∗</mo></msubsup><mo id="S2.E2.m1.6.6.1.1.2" xref="S2.E2.m1.6.6.1.1.2.cmml">∈</mo><mrow id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.3.cmml"><mrow id="S2.E2.m1.6.6.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.3.2.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.2.1" xref="S2.E2.m1.6.6.1.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E2.m1.6.6.1.1.1.3.2a" xref="S2.E2.m1.6.6.1.1.1.3.2.cmml">⁡</mo><mrow id="S2.E2.m1.6.6.1.1.1.3.2.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.cmml"><munder id="S2.E2.m1.6.6.1.1.1.3.2.2.1" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.2.2.1.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.2.cmml">min</mi><mrow id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.2.cmml">θ</mi><mo id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.1" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.3" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.3.cmml">Θ</mi></mrow></munder><mo lspace="0.167em" id="S2.E2.m1.6.6.1.1.1.3.2.2a" xref="S2.E2.m1.6.6.1.1.1.3.2.2.cmml">⁡</mo><mfrac id="S2.E2.m1.6.6.1.1.1.3.2.2.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.cmml"><mn id="S2.E2.m1.6.6.1.1.1.3.2.2.2.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.2.cmml">1</mn><msub id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.2" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.2.cmml">N</mi><mi id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.3" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.3.cmml">k</mi></msub></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.1.1.1.3.1" xref="S2.E2.m1.6.6.1.1.1.3.1.cmml">​</mo><munderover id="S2.E2.m1.6.6.1.1.1.3.3" xref="S2.E2.m1.6.6.1.1.1.3.3.cmml"><mo movablelimits="false" rspace="0em" id="S2.E2.m1.6.6.1.1.1.3.3.2.2" xref="S2.E2.m1.6.6.1.1.1.3.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.6.6.1.1.1.3.3.2.3" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.3.2.3.2" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S2.E2.m1.6.6.1.1.1.3.3.2.3.1" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.6.6.1.1.1.3.3.2.3.3" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.6.6.1.1.1.3.3.3" xref="S2.E2.m1.6.6.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.3.3.3.2" xref="S2.E2.m1.6.6.1.1.1.3.3.3.2.cmml">N</mi><mi id="S2.E2.m1.6.6.1.1.1.3.3.3.3" xref="S2.E2.m1.6.6.1.1.1.3.3.3.3.cmml">k</mi></msub></munderover></mrow><mo lspace="0em" id="S2.E2.m1.6.6.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.2.cmml">−</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml"><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">log</mi><mo id="S2.E2.m1.6.6.1.1.1.1.1a" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">[</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.3.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo fence="false" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.3.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S2.E2.m1.2.2.1.3.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.1.2a" xref="S2.E2.m1.6.6.1.1.1.2.cmml">−</mo><mrow id="S2.E2.m1.6.6.1.1.1.4" xref="S2.E2.m1.6.6.1.1.1.4.cmml"><mrow id="S2.E2.m1.6.6.1.1.1.4.2" xref="S2.E2.m1.6.6.1.1.1.4.2.cmml"><mi id="S2.E2.m1.6.6.1.1.1.4.2.1" xref="S2.E2.m1.6.6.1.1.1.4.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.6.6.1.1.1.4.2a" xref="S2.E2.m1.6.6.1.1.1.4.2.cmml">⁡</mo><msub id="S2.E2.m1.6.6.1.1.1.4.2.2" xref="S2.E2.m1.6.6.1.1.1.4.2.2.cmml"><mi id="S2.E2.m1.6.6.1.1.1.4.2.2.2" xref="S2.E2.m1.6.6.1.1.1.4.2.2.2.cmml">ρ</mi><mi id="S2.E2.m1.6.6.1.1.1.4.2.2.3" xref="S2.E2.m1.6.6.1.1.1.4.2.2.3.cmml">γ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.1.1.1.4.1" xref="S2.E2.m1.6.6.1.1.1.4.1.cmml">​</mo><mrow id="S2.E2.m1.6.6.1.1.1.4.3.2" xref="S2.E2.m1.6.6.1.1.1.4.cmml"><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.4.3.2.1" xref="S2.E2.m1.6.6.1.1.1.4.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S2.E2.m1.6.6.1.1.1.4.3.2.2" xref="S2.E2.m1.6.6.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.6.6.1.2" xref="S2.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><apply id="S2.E2.m1.6.6.1.1.cmml" xref="S2.E2.m1.6.6.1"><in id="S2.E2.m1.6.6.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2"></in><apply id="S2.E2.m1.6.6.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.3">superscript</csymbol><apply id="S2.E2.m1.6.6.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.3.2.1.cmml" xref="S2.E2.m1.6.6.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.3.2.2.cmml" xref="S2.E2.m1.6.6.1.1.3.2.2">𝜃</ci><ci id="S2.E2.m1.6.6.1.1.3.2.3.cmml" xref="S2.E2.m1.6.6.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E2.m1.6.6.1.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.3.3">∗</ci></apply><apply id="S2.E2.m1.6.6.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1"><minus id="S2.E2.m1.6.6.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.2"></minus><apply id="S2.E2.m1.6.6.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3"><times id="S2.E2.m1.6.6.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.1"></times><apply id="S2.E2.m1.6.6.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2"><arg id="S2.E2.m1.6.6.1.1.1.3.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.1"></arg><apply id="S2.E2.m1.6.6.1.1.1.3.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2"><apply id="S2.E2.m1.6.6.1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.2.2.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1">subscript</csymbol><min id="S2.E2.m1.6.6.1.1.1.3.2.2.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.2"></min><apply id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3"><in id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.1"></in><ci id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.2">𝜃</ci><ci id="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.1.3.3">Θ</ci></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2"><divide id="S2.E2.m1.6.6.1.1.1.3.2.2.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2"></divide><cn type="integer" id="S2.E2.m1.6.6.1.1.1.3.2.2.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.2">1</cn><apply id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.2">𝑁</ci><ci id="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2.2.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3">superscript</csymbol><apply id="S2.E2.m1.6.6.1.1.1.3.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3">subscript</csymbol><sum id="S2.E2.m1.6.6.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.2.2"></sum><apply id="S2.E2.m1.6.6.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3"><eq id="S2.E2.m1.6.6.1.1.1.3.3.2.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.1"></eq><ci id="S2.E2.m1.6.6.1.1.1.3.3.2.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.6.6.1.1.1.3.3.2.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.3.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.3.2">𝑁</ci><ci id="S2.E2.m1.6.6.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1"><log id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"></log><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.3">ℙ</ci><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><list id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1">𝑖</ci></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝜃</ci></list></apply></apply></apply></apply><apply id="S2.E2.m1.6.6.1.1.1.4.cmml" xref="S2.E2.m1.6.6.1.1.1.4"><times id="S2.E2.m1.6.6.1.1.1.4.1.cmml" xref="S2.E2.m1.6.6.1.1.1.4.1"></times><apply id="S2.E2.m1.6.6.1.1.1.4.2.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2"><log id="S2.E2.m1.6.6.1.1.1.4.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2.1"></log><apply id="S2.E2.m1.6.6.1.1.1.4.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.4.2.2.1.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2.2">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.4.2.2.2.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2.2.2">𝜌</ci><ci id="S2.E2.m1.6.6.1.1.1.4.2.2.3.cmml" xref="S2.E2.m1.6.6.1.1.1.4.2.2.3">𝛾</ci></apply></apply><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">\theta_{k}^{\ast}\in\arg\min_{\theta\in\Theta}\dfrac{1}{N_{k}}\sum_{i=1}^{N_{k}}-\log\left[\mathbb{P}(y_{k}^{(i)}|\phi(x_{k}^{(i)};\theta))\right]-\log\rho_{\gamma}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.8" class="ltx_p">where we recall that <math id="S2.SS1.p1.7.m1.4" class="ltx_Math" alttext="Z_{k}=\{(x_{k}^{(i)},y_{k}^{(i)})\}_{i=1}^{N_{k}}\in(\mathcal{X}\times Y)^{N_{k}}" display="inline"><semantics id="S2.SS1.p1.7.m1.4a"><mrow id="S2.SS1.p1.7.m1.4.4" xref="S2.SS1.p1.7.m1.4.4.cmml"><msub id="S2.SS1.p1.7.m1.4.4.4" xref="S2.SS1.p1.7.m1.4.4.4.cmml"><mi id="S2.SS1.p1.7.m1.4.4.4.2" xref="S2.SS1.p1.7.m1.4.4.4.2.cmml">Z</mi><mi id="S2.SS1.p1.7.m1.4.4.4.3" xref="S2.SS1.p1.7.m1.4.4.4.3.cmml">k</mi></msub><mo id="S2.SS1.p1.7.m1.4.4.5" xref="S2.SS1.p1.7.m1.4.4.5.cmml">=</mo><msubsup id="S2.SS1.p1.7.m1.3.3.1" xref="S2.SS1.p1.7.m1.3.3.1.cmml"><mrow id="S2.SS1.p1.7.m1.3.3.1.1.1.1" xref="S2.SS1.p1.7.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.3.cmml">(</mo><msubsup id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S2.SS1.p1.7.m1.1.1.1.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m1.1.1.1.3.1" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.7.m1.1.1.1.1" xref="S2.SS1.p1.7.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S2.SS1.p1.7.m1.1.1.1.3.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.4" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">k</mi><mrow id="S2.SS1.p1.7.m1.2.2.1.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m1.2.2.1.3.1" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.cmml">(</mo><mi id="S2.SS1.p1.7.m1.2.2.1.1" xref="S2.SS1.p1.7.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S2.SS1.p1.7.m1.2.2.1.3.2" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.5" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.3" xref="S2.SS1.p1.7.m1.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.7.m1.3.3.1.1.3" xref="S2.SS1.p1.7.m1.3.3.1.1.3.cmml"><mi id="S2.SS1.p1.7.m1.3.3.1.1.3.2" xref="S2.SS1.p1.7.m1.3.3.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.7.m1.3.3.1.1.3.1" xref="S2.SS1.p1.7.m1.3.3.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.7.m1.3.3.1.1.3.3" xref="S2.SS1.p1.7.m1.3.3.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.7.m1.3.3.1.3" xref="S2.SS1.p1.7.m1.3.3.1.3.cmml"><mi id="S2.SS1.p1.7.m1.3.3.1.3.2" xref="S2.SS1.p1.7.m1.3.3.1.3.2.cmml">N</mi><mi id="S2.SS1.p1.7.m1.3.3.1.3.3" xref="S2.SS1.p1.7.m1.3.3.1.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.7.m1.4.4.6" xref="S2.SS1.p1.7.m1.4.4.6.cmml">∈</mo><msup id="S2.SS1.p1.7.m1.4.4.2" xref="S2.SS1.p1.7.m1.4.4.2.cmml"><mrow id="S2.SS1.p1.7.m1.4.4.2.1.1" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m1.4.4.2.1.1.2" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.7.m1.4.4.2.1.1.1" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m1.4.4.2.1.1.1.2" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p1.7.m1.4.4.2.1.1.1.1" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.1.cmml">×</mo><mi id="S2.SS1.p1.7.m1.4.4.2.1.1.1.3" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.3.cmml">Y</mi></mrow><mo stretchy="false" id="S2.SS1.p1.7.m1.4.4.2.1.1.3" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.cmml">)</mo></mrow><msub id="S2.SS1.p1.7.m1.4.4.2.3" xref="S2.SS1.p1.7.m1.4.4.2.3.cmml"><mi id="S2.SS1.p1.7.m1.4.4.2.3.2" xref="S2.SS1.p1.7.m1.4.4.2.3.2.cmml">N</mi><mi id="S2.SS1.p1.7.m1.4.4.2.3.3" xref="S2.SS1.p1.7.m1.4.4.2.3.3.cmml">k</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m1.4b"><apply id="S2.SS1.p1.7.m1.4.4.cmml" xref="S2.SS1.p1.7.m1.4.4"><and id="S2.SS1.p1.7.m1.4.4a.cmml" xref="S2.SS1.p1.7.m1.4.4"></and><apply id="S2.SS1.p1.7.m1.4.4b.cmml" xref="S2.SS1.p1.7.m1.4.4"><eq id="S2.SS1.p1.7.m1.4.4.5.cmml" xref="S2.SS1.p1.7.m1.4.4.5"></eq><apply id="S2.SS1.p1.7.m1.4.4.4.cmml" xref="S2.SS1.p1.7.m1.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.4.4.4.1.cmml" xref="S2.SS1.p1.7.m1.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.7.m1.4.4.4.2.cmml" xref="S2.SS1.p1.7.m1.4.4.4.2">𝑍</ci><ci id="S2.SS1.p1.7.m1.4.4.4.3.cmml" xref="S2.SS1.p1.7.m1.4.4.4.3">𝑘</ci></apply><apply id="S2.SS1.p1.7.m1.3.3.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1">superscript</csymbol><apply id="S2.SS1.p1.7.m1.3.3.1.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.1.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1">subscript</csymbol><set id="S2.SS1.p1.7.m1.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1"><interval closure="open" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2"><apply id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.7.m1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.7.m1.2.2.1.1.cmml" xref="S2.SS1.p1.7.m1.2.2.1.1">𝑖</ci></apply></interval></set><apply id="S2.SS1.p1.7.m1.3.3.1.1.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.3"><eq id="S2.SS1.p1.7.m1.3.3.1.1.3.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.3.1"></eq><ci id="S2.SS1.p1.7.m1.3.3.1.1.3.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.7.m1.3.3.1.1.3.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.7.m1.3.3.1.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.3.3.1.3.1.cmml" xref="S2.SS1.p1.7.m1.3.3.1.3">subscript</csymbol><ci id="S2.SS1.p1.7.m1.3.3.1.3.2.cmml" xref="S2.SS1.p1.7.m1.3.3.1.3.2">𝑁</ci><ci id="S2.SS1.p1.7.m1.3.3.1.3.3.cmml" xref="S2.SS1.p1.7.m1.3.3.1.3.3">𝑘</ci></apply></apply></apply><apply id="S2.SS1.p1.7.m1.4.4c.cmml" xref="S2.SS1.p1.7.m1.4.4"><in id="S2.SS1.p1.7.m1.4.4.6.cmml" xref="S2.SS1.p1.7.m1.4.4.6"></in><share href="#S2.SS1.p1.7.m1.3.3.1.cmml" id="S2.SS1.p1.7.m1.4.4d.cmml" xref="S2.SS1.p1.7.m1.4.4"></share><apply id="S2.SS1.p1.7.m1.4.4.2.cmml" xref="S2.SS1.p1.7.m1.4.4.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.4.4.2.2.cmml" xref="S2.SS1.p1.7.m1.4.4.2">superscript</csymbol><apply id="S2.SS1.p1.7.m1.4.4.2.1.1.1.cmml" xref="S2.SS1.p1.7.m1.4.4.2.1.1"><times id="S2.SS1.p1.7.m1.4.4.2.1.1.1.1.cmml" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.1"></times><ci id="S2.SS1.p1.7.m1.4.4.2.1.1.1.2.cmml" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.2">𝒳</ci><ci id="S2.SS1.p1.7.m1.4.4.2.1.1.1.3.cmml" xref="S2.SS1.p1.7.m1.4.4.2.1.1.1.3">𝑌</ci></apply><apply id="S2.SS1.p1.7.m1.4.4.2.3.cmml" xref="S2.SS1.p1.7.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m1.4.4.2.3.1.cmml" xref="S2.SS1.p1.7.m1.4.4.2.3">subscript</csymbol><ci id="S2.SS1.p1.7.m1.4.4.2.3.2.cmml" xref="S2.SS1.p1.7.m1.4.4.2.3.2">𝑁</ci><ci id="S2.SS1.p1.7.m1.4.4.2.3.3.cmml" xref="S2.SS1.p1.7.m1.4.4.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m1.4c">Z_{k}=\{(x_{k}^{(i)},y_{k}^{(i)})\}_{i=1}^{N_{k}}\in(\mathcal{X}\times Y)^{N_{k}}</annotation></semantics></math> is the dataset of the <math id="S2.SS1.p1.8.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.8.m2.1a"><mi id="S2.SS1.p1.8.m2.1.1" xref="S2.SS1.p1.8.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m2.1b"><ci id="S2.SS1.p1.8.m2.1.1.cmml" xref="S2.SS1.p1.8.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m2.1c">k</annotation></semantics></math>-th server.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Estimating the prior during aggregation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.9" class="ltx_p">Next, we describe our approach to constructing the global model from the <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">q</annotation></semantics></math> local models.
Recall that we consider the global model a prior distribution on the parameter space <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi mathvariant="normal" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\Theta</annotation></semantics></math>, denoted by <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="\rho_{\gamma}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">ρ</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">γ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝜌</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\rho_{\gamma}</annotation></semantics></math>, where <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="\gamma\in\Gamma" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">γ</mi><mo id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml">∈</mo><mi mathvariant="normal" id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">Γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><in id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"></in><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝛾</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">Γ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">\gamma\in\Gamma</annotation></semantics></math> is the parameter to be estimated.
As a loss function for the <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">k</annotation></semantics></math>-th node, we consider the negative log-likelihood of the parameter <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\theta</annotation></semantics></math>, denoted by <math id="S2.SS2.p1.7.m7.3" class="ltx_Math" alttext="\log(\rho_{\gamma}(\theta))" display="inline"><semantics id="S2.SS2.p1.7.m7.3a"><mrow id="S2.SS2.p1.7.m7.3.3.1" xref="S2.SS2.p1.7.m7.3.3.2.cmml"><mi id="S2.SS2.p1.7.m7.2.2" xref="S2.SS2.p1.7.m7.2.2.cmml">log</mi><mo id="S2.SS2.p1.7.m7.3.3.1a" xref="S2.SS2.p1.7.m7.3.3.2.cmml">⁡</mo><mrow id="S2.SS2.p1.7.m7.3.3.1.1" xref="S2.SS2.p1.7.m7.3.3.2.cmml"><mo stretchy="false" id="S2.SS2.p1.7.m7.3.3.1.1.2" xref="S2.SS2.p1.7.m7.3.3.2.cmml">(</mo><mrow id="S2.SS2.p1.7.m7.3.3.1.1.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.cmml"><msub id="S2.SS2.p1.7.m7.3.3.1.1.1.2" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2.cmml"><mi id="S2.SS2.p1.7.m7.3.3.1.1.1.2.2" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2.2.cmml">ρ</mi><mi id="S2.SS2.p1.7.m7.3.3.1.1.1.2.3" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.7.m7.3.3.1.1.1.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml">​</mo><mrow id="S2.SS2.p1.7.m7.3.3.1.1.1.3.2" xref="S2.SS2.p1.7.m7.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.7.m7.3.3.1.1.1.3.2.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.cmml">(</mo><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p1.7.m7.3.3.1.1.1.3.2.2" xref="S2.SS2.p1.7.m7.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.7.m7.3.3.1.1.3" xref="S2.SS2.p1.7.m7.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.3b"><apply id="S2.SS2.p1.7.m7.3.3.2.cmml" xref="S2.SS2.p1.7.m7.3.3.1"><log id="S2.SS2.p1.7.m7.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2"></log><apply id="S2.SS2.p1.7.m7.3.3.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1"><times id="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1"></times><apply id="S2.SS2.p1.7.m7.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.3.3.1.1.1.2.1.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.7.m7.3.3.1.1.1.2.2.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2.2">𝜌</ci><ci id="S2.SS2.p1.7.m7.3.3.1.1.1.2.3.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.2.3">𝛾</ci></apply><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.3c">\log(\rho_{\gamma}(\theta))</annotation></semantics></math>, weighted with the likelihood of the <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">k</annotation></semantics></math>-dataset given the model <math id="S2.SS2.p1.9.m9.2" class="ltx_Math" alttext="\phi(\cdot;\theta)" display="inline"><semantics id="S2.SS2.p1.9.m9.2a"><mrow id="S2.SS2.p1.9.m9.2.3" xref="S2.SS2.p1.9.m9.2.3.cmml"><mi id="S2.SS2.p1.9.m9.2.3.2" xref="S2.SS2.p1.9.m9.2.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.m9.2.3.1" xref="S2.SS2.p1.9.m9.2.3.1.cmml">​</mo><mrow id="S2.SS2.p1.9.m9.2.3.3.2" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p1.9.m9.2.3.3.2.1" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.9.m9.2.3.3.2.2" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml">;</mo><mi id="S2.SS2.p1.9.m9.2.2" xref="S2.SS2.p1.9.m9.2.2.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p1.9.m9.2.3.3.2.3" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.2b"><apply id="S2.SS2.p1.9.m9.2.3.cmml" xref="S2.SS2.p1.9.m9.2.3"><times id="S2.SS2.p1.9.m9.2.3.1.cmml" xref="S2.SS2.p1.9.m9.2.3.1"></times><ci id="S2.SS2.p1.9.m9.2.3.2.cmml" xref="S2.SS2.p1.9.m9.2.3.2">italic-ϕ</ci><list id="S2.SS2.p1.9.m9.2.3.3.1.cmml" xref="S2.SS2.p1.9.m9.2.3.3.2"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">⋅</ci><ci id="S2.SS2.p1.9.m9.2.2.cmml" xref="S2.SS2.p1.9.m9.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.2c">\phi(\cdot;\theta)</annotation></semantics></math>. It can be written as</p>
<table id="S2.Ex8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex8.m1.8" class="ltx_Math" alttext="\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta)):=-\mathbb{P}(Z_{k}|\phi(\cdot;\theta))\log(\rho_{\gamma}(\theta))." display="block"><semantics id="S2.Ex8.m1.8a"><mrow id="S2.Ex8.m1.8.8.1" xref="S2.Ex8.m1.8.8.1.1.cmml"><mrow id="S2.Ex8.m1.8.8.1.1" xref="S2.Ex8.m1.8.8.1.1.cmml"><mrow id="S2.Ex8.m1.8.8.1.1.2" xref="S2.Ex8.m1.8.8.1.1.2.cmml"><msubsup id="S2.Ex8.m1.8.8.1.1.2.4" xref="S2.Ex8.m1.8.8.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex8.m1.8.8.1.1.2.4.2.2" xref="S2.Ex8.m1.8.8.1.1.2.4.2.2.cmml">ℒ</mi><mi id="S2.Ex8.m1.8.8.1.1.2.4.2.3" xref="S2.Ex8.m1.8.8.1.1.2.4.2.3.cmml">g</mi><mrow id="S2.Ex8.m1.1.1.1.3" xref="S2.Ex8.m1.8.8.1.1.2.4.cmml"><mo stretchy="false" id="S2.Ex8.m1.1.1.1.3.1" xref="S2.Ex8.m1.8.8.1.1.2.4.cmml">(</mo><mi id="S2.Ex8.m1.1.1.1.1" xref="S2.Ex8.m1.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S2.Ex8.m1.1.1.1.3.2" xref="S2.Ex8.m1.8.8.1.1.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.2.3" xref="S2.Ex8.m1.8.8.1.1.2.3.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.2.2.2" xref="S2.Ex8.m1.8.8.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.2.2.2.3" xref="S2.Ex8.m1.8.8.1.1.2.2.3.cmml">(</mo><msub id="S2.Ex8.m1.8.8.1.1.1.1.1.1" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S2.Ex8.m1.8.8.1.1.1.1.1.1.2" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1.2.cmml">ρ</mi><mi id="S2.Ex8.m1.8.8.1.1.1.1.1.1.3" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml">γ</mi></msub><mo id="S2.Ex8.m1.8.8.1.1.2.2.2.4" xref="S2.Ex8.m1.8.8.1.1.2.2.3.cmml">,</mo><mrow id="S2.Ex8.m1.8.8.1.1.2.2.2.2" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.cmml"><mi id="S2.Ex8.m1.8.8.1.1.2.2.2.2.2" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.2.2.2.2.1" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.1.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.2" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.2.1" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.2.2" xref="S2.Ex8.m1.2.2.cmml">⋅</mo><mo id="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.2.2" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.1.cmml">;</mo><mi id="S2.Ex8.m1.3.3" xref="S2.Ex8.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.2.3" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" stretchy="false" id="S2.Ex8.m1.8.8.1.1.2.2.2.5" xref="S2.Ex8.m1.8.8.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.Ex8.m1.8.8.1.1.5" xref="S2.Ex8.m1.8.8.1.1.5.cmml">:=</mo><mrow id="S2.Ex8.m1.8.8.1.1.4" xref="S2.Ex8.m1.8.8.1.1.4.cmml"><mo id="S2.Ex8.m1.8.8.1.1.4a" xref="S2.Ex8.m1.8.8.1.1.4.cmml">−</mo><mrow id="S2.Ex8.m1.8.8.1.1.4.2" xref="S2.Ex8.m1.8.8.1.1.4.2.cmml"><mi id="S2.Ex8.m1.8.8.1.1.4.2.4" xref="S2.Ex8.m1.8.8.1.1.4.2.4.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.4.2.3" xref="S2.Ex8.m1.8.8.1.1.4.2.3.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.3.1.1.1" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.cmml"><msub id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.cmml"><mi id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.2.cmml">Z</mi><mi id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.3" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.3.cmml">k</mi></msub><mo fence="false" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.1" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.1.cmml">|</mo><mrow id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.cmml"><mi id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.1" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.2.1" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.4.4" xref="S2.Ex8.m1.4.4.cmml">⋅</mo><mo id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.2.2" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.1.cmml">;</mo><mi id="S2.Ex8.m1.5.5" xref="S2.Ex8.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.2.3" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.3" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.4.2.3a" xref="S2.Ex8.m1.8.8.1.1.4.2.3.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.4.2.2.1" xref="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml"><mi id="S2.Ex8.m1.7.7" xref="S2.Ex8.m1.7.7.cmml">log</mi><mo id="S2.Ex8.m1.8.8.1.1.4.2.2.1a" xref="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml">⁡</mo><mrow id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1" xref="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.2" xref="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml">(</mo><mrow id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.cmml"><msub id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.cmml"><mi id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.2" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.2.cmml">ρ</mi><mi id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.3" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.1" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.1.cmml">​</mo><mrow id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.3.2" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.3.2.1" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.cmml">(</mo><mi id="S2.Ex8.m1.6.6" xref="S2.Ex8.m1.6.6.cmml">θ</mi><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.3.2.2" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.3" xref="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex8.m1.8.8.1.2" xref="S2.Ex8.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex8.m1.8b"><apply id="S2.Ex8.m1.8.8.1.1.cmml" xref="S2.Ex8.m1.8.8.1"><csymbol cd="latexml" id="S2.Ex8.m1.8.8.1.1.5.cmml" xref="S2.Ex8.m1.8.8.1.1.5">assign</csymbol><apply id="S2.Ex8.m1.8.8.1.1.2.cmml" xref="S2.Ex8.m1.8.8.1.1.2"><times id="S2.Ex8.m1.8.8.1.1.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.2.3"></times><apply id="S2.Ex8.m1.8.8.1.1.2.4.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex8.m1.8.8.1.1.2.4.1.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4">superscript</csymbol><apply id="S2.Ex8.m1.8.8.1.1.2.4.2.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex8.m1.8.8.1.1.2.4.2.1.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4">subscript</csymbol><ci id="S2.Ex8.m1.8.8.1.1.2.4.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4.2.2">ℒ</ci><ci id="S2.Ex8.m1.8.8.1.1.2.4.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.2.4.2.3">𝑔</ci></apply><ci id="S2.Ex8.m1.1.1.1.1.cmml" xref="S2.Ex8.m1.1.1.1.1">𝑘</ci></apply><interval closure="open" id="S2.Ex8.m1.8.8.1.1.2.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.2.2.2"><apply id="S2.Ex8.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex8.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex8.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1.2">𝜌</ci><ci id="S2.Ex8.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S2.Ex8.m1.8.8.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S2.Ex8.m1.8.8.1.1.2.2.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2"><times id="S2.Ex8.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.1"></times><ci id="S2.Ex8.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.2">italic-ϕ</ci><list id="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex8.m1.8.8.1.1.2.2.2.2.3.2"><ci id="S2.Ex8.m1.2.2.cmml" xref="S2.Ex8.m1.2.2">⋅</ci><ci id="S2.Ex8.m1.3.3.cmml" xref="S2.Ex8.m1.3.3">𝜃</ci></list></apply></interval></apply><apply id="S2.Ex8.m1.8.8.1.1.4.cmml" xref="S2.Ex8.m1.8.8.1.1.4"><minus id="S2.Ex8.m1.8.8.1.1.4.3.cmml" xref="S2.Ex8.m1.8.8.1.1.4"></minus><apply id="S2.Ex8.m1.8.8.1.1.4.2.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2"><times id="S2.Ex8.m1.8.8.1.1.4.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.3"></times><ci id="S2.Ex8.m1.8.8.1.1.4.2.4.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.4">ℙ</ci><apply id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1"><csymbol cd="latexml" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.1">conditional</csymbol><apply id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.1.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.2">𝑍</ci><ci id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.2.3">𝑘</ci></apply><apply id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3"><times id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.1.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.1"></times><ci id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.2.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.2">italic-ϕ</ci><list id="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.1.cmml" xref="S2.Ex8.m1.8.8.1.1.3.1.1.1.1.3.3.2"><ci id="S2.Ex8.m1.4.4.cmml" xref="S2.Ex8.m1.4.4">⋅</ci><ci id="S2.Ex8.m1.5.5.cmml" xref="S2.Ex8.m1.5.5">𝜃</ci></list></apply></apply><apply id="S2.Ex8.m1.8.8.1.1.4.2.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1"><log id="S2.Ex8.m1.7.7.cmml" xref="S2.Ex8.m1.7.7"></log><apply id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1"><times id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.1.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.1"></times><apply id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.1.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2">subscript</csymbol><ci id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.2.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.2">𝜌</ci><ci id="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.3.cmml" xref="S2.Ex8.m1.8.8.1.1.4.2.2.1.1.1.2.3">𝛾</ci></apply><ci id="S2.Ex8.m1.6.6.cmml" xref="S2.Ex8.m1.6.6">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex8.m1.8c">\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta)):=-\mathbb{P}(Z_{k}|\phi(\cdot;\theta))\log(\rho_{\gamma}(\theta)).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.11" class="ltx_p">Given the local models <math id="S2.SS2.p1.10.m1.6" class="ltx_Math" alttext="\left(\phi(\cdot;\theta_{1}),\ldots,\phi(\cdot;\theta_{q})\right)\in(\mathcal{H})^{q}" display="inline"><semantics id="S2.SS2.p1.10.m1.6a"><mrow id="S2.SS2.p1.10.m1.6.6" xref="S2.SS2.p1.10.m1.6.6.cmml"><mrow id="S2.SS2.p1.10.m1.6.6.2.2" xref="S2.SS2.p1.10.m1.6.6.2.3.cmml"><mo id="S2.SS2.p1.10.m1.6.6.2.2.3" xref="S2.SS2.p1.10.m1.6.6.2.3.cmml">(</mo><mrow id="S2.SS2.p1.10.m1.5.5.1.1.1" xref="S2.SS2.p1.10.m1.5.5.1.1.1.cmml"><mi id="S2.SS2.p1.10.m1.5.5.1.1.1.3" xref="S2.SS2.p1.10.m1.5.5.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.10.m1.5.5.1.1.1.2" xref="S2.SS2.p1.10.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.2" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.10.m1.1.1" xref="S2.SS2.p1.10.m1.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.3" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.2.cmml">;</mo><msub id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.2" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.2.cmml">θ</mi><mn id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.3" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.4" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.10.m1.6.6.2.2.4" xref="S2.SS2.p1.10.m1.6.6.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.10.m1.3.3" xref="S2.SS2.p1.10.m1.3.3.cmml">…</mi><mo id="S2.SS2.p1.10.m1.6.6.2.2.5" xref="S2.SS2.p1.10.m1.6.6.2.3.cmml">,</mo><mrow id="S2.SS2.p1.10.m1.6.6.2.2.2" xref="S2.SS2.p1.10.m1.6.6.2.2.2.cmml"><mi id="S2.SS2.p1.10.m1.6.6.2.2.2.3" xref="S2.SS2.p1.10.m1.6.6.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.10.m1.6.6.2.2.2.2" xref="S2.SS2.p1.10.m1.6.6.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.2" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.10.m1.2.2" xref="S2.SS2.p1.10.m1.2.2.cmml">⋅</mo><mo id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.3" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.2.cmml">;</mo><msub id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.2" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.3" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.4" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.10.m1.6.6.2.2.6" xref="S2.SS2.p1.10.m1.6.6.2.3.cmml">)</mo></mrow><mo id="S2.SS2.p1.10.m1.6.6.3" xref="S2.SS2.p1.10.m1.6.6.3.cmml">∈</mo><msup id="S2.SS2.p1.10.m1.6.6.4" xref="S2.SS2.p1.10.m1.6.6.4.cmml"><mrow id="S2.SS2.p1.10.m1.6.6.4.2.2" xref="S2.SS2.p1.10.m1.6.6.4.cmml"><mo stretchy="false" id="S2.SS2.p1.10.m1.6.6.4.2.2.1" xref="S2.SS2.p1.10.m1.6.6.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m1.4.4" xref="S2.SS2.p1.10.m1.4.4.cmml">ℋ</mi><mo stretchy="false" id="S2.SS2.p1.10.m1.6.6.4.2.2.2" xref="S2.SS2.p1.10.m1.6.6.4.cmml">)</mo></mrow><mi id="S2.SS2.p1.10.m1.6.6.4.3" xref="S2.SS2.p1.10.m1.6.6.4.3.cmml">q</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m1.6b"><apply id="S2.SS2.p1.10.m1.6.6.cmml" xref="S2.SS2.p1.10.m1.6.6"><in id="S2.SS2.p1.10.m1.6.6.3.cmml" xref="S2.SS2.p1.10.m1.6.6.3"></in><vector id="S2.SS2.p1.10.m1.6.6.2.3.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2"><apply id="S2.SS2.p1.10.m1.5.5.1.1.1.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1"><times id="S2.SS2.p1.10.m1.5.5.1.1.1.2.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.2"></times><ci id="S2.SS2.p1.10.m1.5.5.1.1.1.3.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.3">italic-ϕ</ci><list id="S2.SS2.p1.10.m1.5.5.1.1.1.1.2.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1"><ci id="S2.SS2.p1.10.m1.1.1.cmml" xref="S2.SS2.p1.10.m1.1.1">⋅</ci><apply id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.2">𝜃</ci><cn type="integer" id="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.10.m1.5.5.1.1.1.1.1.1.3">1</cn></apply></list></apply><ci id="S2.SS2.p1.10.m1.3.3.cmml" xref="S2.SS2.p1.10.m1.3.3">…</ci><apply id="S2.SS2.p1.10.m1.6.6.2.2.2.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2"><times id="S2.SS2.p1.10.m1.6.6.2.2.2.2.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.2"></times><ci id="S2.SS2.p1.10.m1.6.6.2.2.2.3.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.3">italic-ϕ</ci><list id="S2.SS2.p1.10.m1.6.6.2.2.2.1.2.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1"><ci id="S2.SS2.p1.10.m1.2.2.cmml" xref="S2.SS2.p1.10.m1.2.2">⋅</ci><apply id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.2">𝜃</ci><ci id="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.10.m1.6.6.2.2.2.1.1.1.3">𝑞</ci></apply></list></apply></vector><apply id="S2.SS2.p1.10.m1.6.6.4.cmml" xref="S2.SS2.p1.10.m1.6.6.4"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m1.6.6.4.1.cmml" xref="S2.SS2.p1.10.m1.6.6.4">superscript</csymbol><ci id="S2.SS2.p1.10.m1.4.4.cmml" xref="S2.SS2.p1.10.m1.4.4">ℋ</ci><ci id="S2.SS2.p1.10.m1.6.6.4.3.cmml" xref="S2.SS2.p1.10.m1.6.6.4.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m1.6c">\left(\phi(\cdot;\theta_{1}),\ldots,\phi(\cdot;\theta_{q})\right)\in(\mathcal{H})^{q}</annotation></semantics></math>, the parameter <math id="S2.SS2.p1.11.m2.1" class="ltx_Math" alttext="\gamma^{\ast}\in\Gamma" display="inline"><semantics id="S2.SS2.p1.11.m2.1a"><mrow id="S2.SS2.p1.11.m2.1.1" xref="S2.SS2.p1.11.m2.1.1.cmml"><msup id="S2.SS2.p1.11.m2.1.1.2" xref="S2.SS2.p1.11.m2.1.1.2.cmml"><mi id="S2.SS2.p1.11.m2.1.1.2.2" xref="S2.SS2.p1.11.m2.1.1.2.2.cmml">γ</mi><mo id="S2.SS2.p1.11.m2.1.1.2.3" xref="S2.SS2.p1.11.m2.1.1.2.3.cmml">∗</mo></msup><mo id="S2.SS2.p1.11.m2.1.1.1" xref="S2.SS2.p1.11.m2.1.1.1.cmml">∈</mo><mi mathvariant="normal" id="S2.SS2.p1.11.m2.1.1.3" xref="S2.SS2.p1.11.m2.1.1.3.cmml">Γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m2.1b"><apply id="S2.SS2.p1.11.m2.1.1.cmml" xref="S2.SS2.p1.11.m2.1.1"><in id="S2.SS2.p1.11.m2.1.1.1.cmml" xref="S2.SS2.p1.11.m2.1.1.1"></in><apply id="S2.SS2.p1.11.m2.1.1.2.cmml" xref="S2.SS2.p1.11.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m2.1.1.2.1.cmml" xref="S2.SS2.p1.11.m2.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.11.m2.1.1.2.2.cmml" xref="S2.SS2.p1.11.m2.1.1.2.2">𝛾</ci><ci id="S2.SS2.p1.11.m2.1.1.2.3.cmml" xref="S2.SS2.p1.11.m2.1.1.2.3">∗</ci></apply><ci id="S2.SS2.p1.11.m2.1.1.3.cmml" xref="S2.SS2.p1.11.m2.1.1.3">Γ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m2.1c">\gamma^{\ast}\in\Gamma</annotation></semantics></math> for the global model can be estimated through empirical risk minimization as</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.5" class="ltx_Math" alttext="\gamma^{\ast}\in\arg\min_{\gamma\in\Gamma}\dfrac{1}{q}\sum_{k=1}^{q}\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta_{k}))=-\dfrac{1}{q}\sum_{k=1}^{q}\mathbb{P}(Z_{k}|\phi(\cdot;\theta_{k}))\log(\rho_{\gamma}(\theta_{k}))." display="block"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml"><msup id="S2.E3.m1.5.5.1.1.6" xref="S2.E3.m1.5.5.1.1.6.cmml"><mi id="S2.E3.m1.5.5.1.1.6.2" xref="S2.E3.m1.5.5.1.1.6.2.cmml">γ</mi><mo id="S2.E3.m1.5.5.1.1.6.3" xref="S2.E3.m1.5.5.1.1.6.3.cmml">∗</mo></msup><mo id="S2.E3.m1.5.5.1.1.7" xref="S2.E3.m1.5.5.1.1.7.cmml">∈</mo><mrow id="S2.E3.m1.5.5.1.1.2" xref="S2.E3.m1.5.5.1.1.2.cmml"><mrow id="S2.E3.m1.5.5.1.1.2.4" xref="S2.E3.m1.5.5.1.1.2.4.cmml"><mi id="S2.E3.m1.5.5.1.1.2.4.1" xref="S2.E3.m1.5.5.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E3.m1.5.5.1.1.2.4a" xref="S2.E3.m1.5.5.1.1.2.4.cmml">⁡</mo><mrow id="S2.E3.m1.5.5.1.1.2.4.2" xref="S2.E3.m1.5.5.1.1.2.4.2.cmml"><munder id="S2.E3.m1.5.5.1.1.2.4.2.1" xref="S2.E3.m1.5.5.1.1.2.4.2.1.cmml"><mi id="S2.E3.m1.5.5.1.1.2.4.2.1.2" xref="S2.E3.m1.5.5.1.1.2.4.2.1.2.cmml">min</mi><mrow id="S2.E3.m1.5.5.1.1.2.4.2.1.3" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.cmml"><mi id="S2.E3.m1.5.5.1.1.2.4.2.1.3.2" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.2.cmml">γ</mi><mo id="S2.E3.m1.5.5.1.1.2.4.2.1.3.1" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E3.m1.5.5.1.1.2.4.2.1.3.3" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.3.cmml">Γ</mi></mrow></munder><mo lspace="0.167em" id="S2.E3.m1.5.5.1.1.2.4.2a" xref="S2.E3.m1.5.5.1.1.2.4.2.cmml">⁡</mo><mfrac id="S2.E3.m1.5.5.1.1.2.4.2.2" xref="S2.E3.m1.5.5.1.1.2.4.2.2.cmml"><mn id="S2.E3.m1.5.5.1.1.2.4.2.2.2" xref="S2.E3.m1.5.5.1.1.2.4.2.2.2.cmml">1</mn><mi id="S2.E3.m1.5.5.1.1.2.4.2.2.3" xref="S2.E3.m1.5.5.1.1.2.4.2.2.3.cmml">q</mi></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.3" xref="S2.E3.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.cmml"><munderover id="S2.E3.m1.5.5.1.1.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.3.cmml"><mo movablelimits="false" id="S2.E3.m1.5.5.1.1.2.2.3.2.2" xref="S2.E3.m1.5.5.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.3.2.3" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2.3.2.3.2" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.2.cmml">k</mi><mo id="S2.E3.m1.5.5.1.1.2.2.3.2.3.1" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E3.m1.5.5.1.1.2.2.3.2.3.3" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.5.5.1.1.2.2.3.3" xref="S2.E3.m1.5.5.1.1.2.2.3.3.cmml">q</mi></munderover><mrow id="S2.E3.m1.5.5.1.1.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.cmml"><msubsup id="S2.E3.m1.5.5.1.1.2.2.2.4" xref="S2.E3.m1.5.5.1.1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.1.1.2.2.2.4.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.4.2.2.cmml">ℒ</mi><mi id="S2.E3.m1.5.5.1.1.2.2.2.4.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.4.2.3.cmml">g</mi><mrow id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.2.4.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.3.1" xref="S2.E3.m1.5.5.1.1.2.2.2.4.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.2.2.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.3.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml">(</mo><msub id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">ρ</mi><mi id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">γ</mi></msub><mo id="S2.E3.m1.5.5.1.1.2.2.2.2.2.4" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">⋅</mo><mo id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.2.cmml">;</mo><msub id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.2.cmml">θ</mi><mi id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.4" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.5" xref="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.8" xref="S2.E3.m1.5.5.1.1.8.cmml">=</mo><mrow id="S2.E3.m1.5.5.1.1.4" xref="S2.E3.m1.5.5.1.1.4.cmml"><mo id="S2.E3.m1.5.5.1.1.4a" xref="S2.E3.m1.5.5.1.1.4.cmml">−</mo><mrow id="S2.E3.m1.5.5.1.1.4.2" xref="S2.E3.m1.5.5.1.1.4.2.cmml"><mfrac id="S2.E3.m1.5.5.1.1.4.2.4" xref="S2.E3.m1.5.5.1.1.4.2.4.cmml"><mn id="S2.E3.m1.5.5.1.1.4.2.4.2" xref="S2.E3.m1.5.5.1.1.4.2.4.2.cmml">1</mn><mi id="S2.E3.m1.5.5.1.1.4.2.4.3" xref="S2.E3.m1.5.5.1.1.4.2.4.3.cmml">q</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.4.2.3" xref="S2.E3.m1.5.5.1.1.4.2.3.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2" xref="S2.E3.m1.5.5.1.1.4.2.2.cmml"><munderover id="S2.E3.m1.5.5.1.1.4.2.2.3" xref="S2.E3.m1.5.5.1.1.4.2.2.3.cmml"><mo movablelimits="false" id="S2.E3.m1.5.5.1.1.4.2.2.3.2.2" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.2" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.2.cmml">k</mi><mo id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.1" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.3" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.5.5.1.1.4.2.2.3.3" xref="S2.E3.m1.5.5.1.1.4.2.2.3.3.cmml">q</mi></munderover><mrow id="S2.E3.m1.5.5.1.1.4.2.2.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.2.2.4" xref="S2.E3.m1.5.5.1.1.4.2.2.2.4.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.4.2.2.2.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.3.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.2.cmml">Z</mi><mi id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo fence="false" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">⋅</mo><mo id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.5.5.1.1.4.2.2.2.3a" xref="S2.E3.m1.5.5.1.1.4.2.2.2.3.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml"><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">log</mi><mo id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1a" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml">(</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.2.cmml">ρ</mi><mi id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.3" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E3.m1.5.5.1.2" xref="S2.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1"><and id="S2.E3.m1.5.5.1.1a.cmml" xref="S2.E3.m1.5.5.1"></and><apply id="S2.E3.m1.5.5.1.1b.cmml" xref="S2.E3.m1.5.5.1"><in id="S2.E3.m1.5.5.1.1.7.cmml" xref="S2.E3.m1.5.5.1.1.7"></in><apply id="S2.E3.m1.5.5.1.1.6.cmml" xref="S2.E3.m1.5.5.1.1.6"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.6.1.cmml" xref="S2.E3.m1.5.5.1.1.6">superscript</csymbol><ci id="S2.E3.m1.5.5.1.1.6.2.cmml" xref="S2.E3.m1.5.5.1.1.6.2">𝛾</ci><ci id="S2.E3.m1.5.5.1.1.6.3.cmml" xref="S2.E3.m1.5.5.1.1.6.3">∗</ci></apply><apply id="S2.E3.m1.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2"><times id="S2.E3.m1.5.5.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.3"></times><apply id="S2.E3.m1.5.5.1.1.2.4.cmml" xref="S2.E3.m1.5.5.1.1.2.4"><arg id="S2.E3.m1.5.5.1.1.2.4.1.cmml" xref="S2.E3.m1.5.5.1.1.2.4.1"></arg><apply id="S2.E3.m1.5.5.1.1.2.4.2.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2"><apply id="S2.E3.m1.5.5.1.1.2.4.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.4.2.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1">subscript</csymbol><min id="S2.E3.m1.5.5.1.1.2.4.2.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1.2"></min><apply id="S2.E3.m1.5.5.1.1.2.4.2.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3"><in id="S2.E3.m1.5.5.1.1.2.4.2.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.1"></in><ci id="S2.E3.m1.5.5.1.1.2.4.2.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.2">𝛾</ci><ci id="S2.E3.m1.5.5.1.1.2.4.2.1.3.3.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.1.3.3">Γ</ci></apply></apply><apply id="S2.E3.m1.5.5.1.1.2.4.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.2"><divide id="S2.E3.m1.5.5.1.1.2.4.2.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.2"></divide><cn type="integer" id="S2.E3.m1.5.5.1.1.2.4.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.2.2">1</cn><ci id="S2.E3.m1.5.5.1.1.2.4.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.4.2.2.3">𝑞</ci></apply></apply></apply><apply id="S2.E3.m1.5.5.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2"><apply id="S2.E3.m1.5.5.1.1.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3">subscript</csymbol><sum id="S2.E3.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.2.2"></sum><apply id="S2.E3.m1.5.5.1.1.2.2.3.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3"><eq id="S2.E3.m1.5.5.1.1.2.2.3.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.1"></eq><ci id="S2.E3.m1.5.5.1.1.2.2.3.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E3.m1.5.5.1.1.2.2.3.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.5.5.1.1.2.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3.3">𝑞</ci></apply><apply id="S2.E3.m1.5.5.1.1.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2"><times id="S2.E3.m1.5.5.1.1.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.3"></times><apply id="S2.E3.m1.5.5.1.1.2.2.2.4.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.2.4.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.2.4.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.2.4.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.2.2.2.4.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4.2.2">ℒ</ci><ci id="S2.E3.m1.5.5.1.1.2.2.2.4.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.4.2.3">𝑔</ci></apply><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑘</ci></apply><interval closure="open" id="S2.E3.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2"><apply id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.2">𝜌</ci><ci id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2"><times id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.2"></times><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.3">italic-ϕ</ci><list id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1"><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">⋅</ci><apply id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.2">𝜃</ci><ci id="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2.2.2.2.1.1.1.3">𝑘</ci></apply></list></apply></interval></apply></apply></apply></apply><apply id="S2.E3.m1.5.5.1.1c.cmml" xref="S2.E3.m1.5.5.1"><eq id="S2.E3.m1.5.5.1.1.8.cmml" xref="S2.E3.m1.5.5.1.1.8"></eq><share href="#S2.E3.m1.5.5.1.1.2.cmml" id="S2.E3.m1.5.5.1.1d.cmml" xref="S2.E3.m1.5.5.1"></share><apply id="S2.E3.m1.5.5.1.1.4.cmml" xref="S2.E3.m1.5.5.1.1.4"><minus id="S2.E3.m1.5.5.1.1.4.3.cmml" xref="S2.E3.m1.5.5.1.1.4"></minus><apply id="S2.E3.m1.5.5.1.1.4.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2"><times id="S2.E3.m1.5.5.1.1.4.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.3"></times><apply id="S2.E3.m1.5.5.1.1.4.2.4.cmml" xref="S2.E3.m1.5.5.1.1.4.2.4"><divide id="S2.E3.m1.5.5.1.1.4.2.4.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.4"></divide><cn type="integer" id="S2.E3.m1.5.5.1.1.4.2.4.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.4.2">1</cn><ci id="S2.E3.m1.5.5.1.1.4.2.4.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.4.3">𝑞</ci></apply><apply id="S2.E3.m1.5.5.1.1.4.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2"><apply id="S2.E3.m1.5.5.1.1.4.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.2.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.4.2.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.2.2.3.2.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3">subscript</csymbol><sum id="S2.E3.m1.5.5.1.1.4.2.2.3.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.2"></sum><apply id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3"><eq id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.1"></eq><ci id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.5.5.1.1.4.2.2.3.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.3.3">𝑞</ci></apply><apply id="S2.E3.m1.5.5.1.1.4.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2"><times id="S2.E3.m1.5.5.1.1.4.2.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.3"></times><ci id="S2.E3.m1.5.5.1.1.4.2.2.2.4.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.4">ℙ</ci><apply id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.2">𝑍</ci><ci id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1"><times id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.3">italic-ϕ</ci><list id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1"><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">⋅</ci><apply id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply><apply id="S2.E3.m1.5.5.1.1.4.2.2.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1"><log id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"></log><apply id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1"><times id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.2"></times><apply id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.2">𝜌</ci><ci id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.3.3">𝛾</ci></apply><apply id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.4.2.2.2.2.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">\gamma^{\ast}\in\arg\min_{\gamma\in\Gamma}\dfrac{1}{q}\sum_{k=1}^{q}\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta_{k}))=-\dfrac{1}{q}\sum_{k=1}^{q}\mathbb{P}(Z_{k}|\phi(\cdot;\theta_{k}))\log(\rho_{\gamma}(\theta_{k})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.12" class="ltx_p">The quantities <math id="S2.SS2.p1.12.m1.2" class="ltx_Math" alttext="\mathbb{P}(Z_{k}|\phi(\cdot;\theta_{k}))" display="inline"><semantics id="S2.SS2.p1.12.m1.2a"><mrow id="S2.SS2.p1.12.m1.2.2" xref="S2.SS2.p1.12.m1.2.2.cmml"><mi id="S2.SS2.p1.12.m1.2.2.3" xref="S2.SS2.p1.12.m1.2.2.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.12.m1.2.2.2" xref="S2.SS2.p1.12.m1.2.2.2.cmml">​</mo><mrow id="S2.SS2.p1.12.m1.2.2.1.1" xref="S2.SS2.p1.12.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.12.m1.2.2.1.1.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.12.m1.2.2.1.1.1" xref="S2.SS2.p1.12.m1.2.2.1.1.1.cmml"><msub id="S2.SS2.p1.12.m1.2.2.1.1.1.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3.cmml"><mi id="S2.SS2.p1.12.m1.2.2.1.1.1.3.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3.2.cmml">Z</mi><mi id="S2.SS2.p1.12.m1.2.2.1.1.1.3.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3.3.cmml">k</mi></msub><mo fence="false" id="S2.SS2.p1.12.m1.2.2.1.1.1.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.SS2.p1.12.m1.2.2.1.1.1.1" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p1.12.m1.2.2.1.1.1.1.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.12.m1.2.2.1.1.1.1.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.12.m1.1.1" xref="S2.SS2.p1.12.m1.1.1.cmml">⋅</mo><mo id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.2.cmml">;</mo><msub id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.4" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.12.m1.2.2.1.1.3" xref="S2.SS2.p1.12.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m1.2b"><apply id="S2.SS2.p1.12.m1.2.2.cmml" xref="S2.SS2.p1.12.m1.2.2"><times id="S2.SS2.p1.12.m1.2.2.2.cmml" xref="S2.SS2.p1.12.m1.2.2.2"></times><ci id="S2.SS2.p1.12.m1.2.2.3.cmml" xref="S2.SS2.p1.12.m1.2.2.3">ℙ</ci><apply id="S2.SS2.p1.12.m1.2.2.1.1.1.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p1.12.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.2">conditional</csymbol><apply id="S2.SS2.p1.12.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m1.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.12.m1.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3.2">𝑍</ci><ci id="S2.SS2.p1.12.m1.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.3.3">𝑘</ci></apply><apply id="S2.SS2.p1.12.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1"><times id="S2.SS2.p1.12.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.2"></times><ci id="S2.SS2.p1.12.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.3">italic-ϕ</ci><list id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1"><ci id="S2.SS2.p1.12.m1.1.1.cmml" xref="S2.SS2.p1.12.m1.1.1">⋅</ci><apply id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.12.m1.2.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m1.2c">\mathbb{P}(Z_{k}|\phi(\cdot;\theta_{k}))</annotation></semantics></math> have to be computed at the local servers and then transmitted to the central server for aggregation since they depend on the local datasets.
These quantities can be seen as weighting factors for the aggregation of the models, similar to the sample size in FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib3" title="" class="ltx_ref">mcmahan2023communicationefficient </a></cite>, representing the confidence of each local model on its own data.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>FL as bi-level optimization</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">FL is a two-stage procedure, with the final goal of constructing local models trained on local data and a global model that leverages the information from the trained local models.
This two-stage procedure can be seen as an alternating strategy to approximate the solution to the following bi-level optimization problem:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.5" class="ltx_Math" alttext="\gamma^{\ast}\in\arg\min_{\gamma\in\Gamma}\dfrac{1}{q}\sum_{k=1}^{q}\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta_{k}^{\ast})),\quad\text{s.t. $\theta_{k}^{\ast}$ satisfies \eqref{MAP estimation} for all $k\in\{1,\ldots,q\}.$}" display="block"><semantics id="S2.E4.m1.5a"><mrow id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml"><msup id="S2.E4.m1.5.5.3" xref="S2.E4.m1.5.5.3.cmml"><mi id="S2.E4.m1.5.5.3.2" xref="S2.E4.m1.5.5.3.2.cmml">γ</mi><mo id="S2.E4.m1.5.5.3.3" xref="S2.E4.m1.5.5.3.3.cmml">∗</mo></msup><mo id="S2.E4.m1.5.5.2" xref="S2.E4.m1.5.5.2.cmml">∈</mo><mrow id="S2.E4.m1.5.5.1.1" xref="S2.E4.m1.5.5.1.2.cmml"><mrow id="S2.E4.m1.5.5.1.1.1" xref="S2.E4.m1.5.5.1.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1.1.4" xref="S2.E4.m1.5.5.1.1.1.4.cmml"><mi id="S2.E4.m1.5.5.1.1.1.4.1" xref="S2.E4.m1.5.5.1.1.1.4.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E4.m1.5.5.1.1.1.4a" xref="S2.E4.m1.5.5.1.1.1.4.cmml">⁡</mo><mrow id="S2.E4.m1.5.5.1.1.1.4.2" xref="S2.E4.m1.5.5.1.1.1.4.2.cmml"><munder id="S2.E4.m1.5.5.1.1.1.4.2.1" xref="S2.E4.m1.5.5.1.1.1.4.2.1.cmml"><mi id="S2.E4.m1.5.5.1.1.1.4.2.1.2" xref="S2.E4.m1.5.5.1.1.1.4.2.1.2.cmml">min</mi><mrow id="S2.E4.m1.5.5.1.1.1.4.2.1.3" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.cmml"><mi id="S2.E4.m1.5.5.1.1.1.4.2.1.3.2" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.2.cmml">γ</mi><mo id="S2.E4.m1.5.5.1.1.1.4.2.1.3.1" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E4.m1.5.5.1.1.1.4.2.1.3.3" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.3.cmml">Γ</mi></mrow></munder><mo lspace="0.167em" id="S2.E4.m1.5.5.1.1.1.4.2a" xref="S2.E4.m1.5.5.1.1.1.4.2.cmml">⁡</mo><mfrac id="S2.E4.m1.5.5.1.1.1.4.2.2" xref="S2.E4.m1.5.5.1.1.1.4.2.2.cmml"><mn id="S2.E4.m1.5.5.1.1.1.4.2.2.2" xref="S2.E4.m1.5.5.1.1.1.4.2.2.2.cmml">1</mn><mi id="S2.E4.m1.5.5.1.1.1.4.2.2.3" xref="S2.E4.m1.5.5.1.1.1.4.2.2.3.cmml">q</mi></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.5.5.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.3.cmml">​</mo><mrow id="S2.E4.m1.5.5.1.1.1.2" xref="S2.E4.m1.5.5.1.1.1.2.cmml"><munderover id="S2.E4.m1.5.5.1.1.1.2.3" xref="S2.E4.m1.5.5.1.1.1.2.3.cmml"><mo movablelimits="false" id="S2.E4.m1.5.5.1.1.1.2.3.2.2" xref="S2.E4.m1.5.5.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.E4.m1.5.5.1.1.1.2.3.2.3" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.cmml"><mi id="S2.E4.m1.5.5.1.1.1.2.3.2.3.2" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.2.cmml">k</mi><mo id="S2.E4.m1.5.5.1.1.1.2.3.2.3.1" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S2.E4.m1.5.5.1.1.1.2.3.2.3.3" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.5.5.1.1.1.2.3.3" xref="S2.E4.m1.5.5.1.1.1.2.3.3.cmml">q</mi></munderover><mrow id="S2.E4.m1.5.5.1.1.1.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.cmml"><msubsup id="S2.E4.m1.5.5.1.1.1.2.2.4" xref="S2.E4.m1.5.5.1.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.5.5.1.1.1.2.2.4.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.4.2.2.cmml">ℒ</mi><mi id="S2.E4.m1.5.5.1.1.1.2.2.4.2.3" xref="S2.E4.m1.5.5.1.1.1.2.2.4.2.3.cmml">g</mi><mrow id="S2.E4.m1.3.3.1.3" xref="S2.E4.m1.5.5.1.1.1.2.2.4.cmml"><mo stretchy="false" id="S2.E4.m1.3.3.1.3.1" xref="S2.E4.m1.5.5.1.1.1.2.2.4.cmml">(</mo><mi id="S2.E4.m1.3.3.1.1" xref="S2.E4.m1.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S2.E4.m1.3.3.1.3.2" xref="S2.E4.m1.5.5.1.1.1.2.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E4.m1.5.5.1.1.1.2.2.3" xref="S2.E4.m1.5.5.1.1.1.2.2.3.cmml">​</mo><mrow id="S2.E4.m1.5.5.1.1.1.2.2.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.3" xref="S2.E4.m1.5.5.1.1.1.2.2.2.3.cmml">(</mo><msub id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">ρ</mi><mi id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">γ</mi></msub><mo id="S2.E4.m1.5.5.1.1.1.2.2.2.2.4" xref="S2.E4.m1.5.5.1.1.1.2.2.2.3.cmml">,</mo><mrow id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.cmml"><mi id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.3" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.2" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">⋅</mo><mo id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.3" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.2.cmml">;</mo><msubsup id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.2" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.2.cmml">θ</mi><mi id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.3" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.3.cmml">k</mi><mo id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.4" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.5" xref="S2.E4.m1.5.5.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo rspace="1.167em" id="S2.E4.m1.5.5.1.1.2" xref="S2.E4.m1.5.5.1.2.cmml">,</mo><mrow id="S2.E4.m1.2.2.2" xref="S2.E4.m1.2.2.2g.cmml"><mtext id="S2.E4.m1.2.2.2a" xref="S2.E4.m1.2.2.2g.cmml">s.t. </mtext><msubsup id="S2.E4.m1.1.1.1.m1.1.1" xref="S2.E4.m1.1.1.1.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.m1.1.1.2.2" xref="S2.E4.m1.1.1.1.m1.1.1.2.2.cmml">θ</mi><mi id="S2.E4.m1.1.1.1.m1.1.1.2.3" xref="S2.E4.m1.1.1.1.m1.1.1.2.3.cmml">k</mi><mo id="S2.E4.m1.1.1.1.m1.1.1.3" xref="S2.E4.m1.1.1.1.m1.1.1.3.cmml">∗</mo></msubsup><mtext id="S2.E4.m1.2.2.2b" xref="S2.E4.m1.2.2.2g.cmml"> satisfies (</mtext><mtext id="S2.E4.m1.2.2.2c" xref="S2.E4.m1.2.2.2g.cmml"><a href="#S2.E2" title="In 2.1 Local training as MAP estimation ‣ 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></mtext><mtext id="S2.E4.m1.2.2.2f" xref="S2.E4.m1.2.2.2g.cmml">) for all </mtext><mrow id="S2.E4.m1.2.2.2.m2.4.4.1" xref="S2.E4.m1.2.2.2.m2.4.4.1.cmml"><mrow id="S2.E4.m1.2.2.2.m2.4.4.1.1" xref="S2.E4.m1.2.2.2.m2.4.4.1.cmml"><mi id="S2.E4.m1.2.2.2.m2.4.4.1.1.2" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.2.cmml">k</mi><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.1" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.1.cmml">∈</mo><mrow id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.1" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml">{</mo><mn id="S2.E4.m1.2.2.2.m2.1.1" xref="S2.E4.m1.2.2.2.m2.1.1.cmml">1</mn><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.2" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml">,</mo><mi mathvariant="normal" id="S2.E4.m1.2.2.2.m2.2.2" xref="S2.E4.m1.2.2.2.m2.2.2.cmml">…</mi><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.3" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml">,</mo><mi id="S2.E4.m1.2.2.2.m2.3.3" xref="S2.E4.m1.2.2.2.m2.3.3.cmml">q</mi><mo stretchy="false" id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.4" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S2.E4.m1.2.2.2.m2.4.4.1.2" xref="S2.E4.m1.2.2.2.m2.4.4.1.cmml">.</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.5b"><apply id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5"><in id="S2.E4.m1.5.5.2.cmml" xref="S2.E4.m1.5.5.2"></in><apply id="S2.E4.m1.5.5.3.cmml" xref="S2.E4.m1.5.5.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.3.1.cmml" xref="S2.E4.m1.5.5.3">superscript</csymbol><ci id="S2.E4.m1.5.5.3.2.cmml" xref="S2.E4.m1.5.5.3.2">𝛾</ci><ci id="S2.E4.m1.5.5.3.3.cmml" xref="S2.E4.m1.5.5.3.3">∗</ci></apply><list id="S2.E4.m1.5.5.1.2.cmml" xref="S2.E4.m1.5.5.1.1"><apply id="S2.E4.m1.5.5.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1"><times id="S2.E4.m1.5.5.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.3"></times><apply id="S2.E4.m1.5.5.1.1.1.4.cmml" xref="S2.E4.m1.5.5.1.1.1.4"><arg id="S2.E4.m1.5.5.1.1.1.4.1.cmml" xref="S2.E4.m1.5.5.1.1.1.4.1"></arg><apply id="S2.E4.m1.5.5.1.1.1.4.2.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2"><apply id="S2.E4.m1.5.5.1.1.1.4.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.4.2.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1">subscript</csymbol><min id="S2.E4.m1.5.5.1.1.1.4.2.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1.2"></min><apply id="S2.E4.m1.5.5.1.1.1.4.2.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3"><in id="S2.E4.m1.5.5.1.1.1.4.2.1.3.1.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.1"></in><ci id="S2.E4.m1.5.5.1.1.1.4.2.1.3.2.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.2">𝛾</ci><ci id="S2.E4.m1.5.5.1.1.1.4.2.1.3.3.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.1.3.3">Γ</ci></apply></apply><apply id="S2.E4.m1.5.5.1.1.1.4.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.2"><divide id="S2.E4.m1.5.5.1.1.1.4.2.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.2"></divide><cn type="integer" id="S2.E4.m1.5.5.1.1.1.4.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.2.2">1</cn><ci id="S2.E4.m1.5.5.1.1.1.4.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.4.2.2.3">𝑞</ci></apply></apply></apply><apply id="S2.E4.m1.5.5.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2"><apply id="S2.E4.m1.5.5.1.1.1.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.3.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3">superscript</csymbol><apply id="S2.E4.m1.5.5.1.1.1.2.3.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.3.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3">subscript</csymbol><sum id="S2.E4.m1.5.5.1.1.1.2.3.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.2.2"></sum><apply id="S2.E4.m1.5.5.1.1.1.2.3.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3"><eq id="S2.E4.m1.5.5.1.1.1.2.3.2.3.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.1"></eq><ci id="S2.E4.m1.5.5.1.1.1.2.3.2.3.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E4.m1.5.5.1.1.1.2.3.2.3.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.5.5.1.1.1.2.3.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.3.3">𝑞</ci></apply><apply id="S2.E4.m1.5.5.1.1.1.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2"><times id="S2.E4.m1.5.5.1.1.1.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.3"></times><apply id="S2.E4.m1.5.5.1.1.1.2.2.4.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.2.4.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4">superscript</csymbol><apply id="S2.E4.m1.5.5.1.1.1.2.2.4.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.2.4.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.2.2.4.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4.2.2">ℒ</ci><ci id="S2.E4.m1.5.5.1.1.1.2.2.4.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.4.2.3">𝑔</ci></apply><ci id="S2.E4.m1.3.3.1.1.cmml" xref="S2.E4.m1.3.3.1.1">𝑘</ci></apply><interval closure="open" id="S2.E4.m1.5.5.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2"><apply id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2">𝜌</ci><ci id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2"><times id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.2"></times><ci id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.3">italic-ϕ</ci><list id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1"><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">⋅</ci><apply id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.2">𝜃</ci><ci id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.2.2.2.2.2.1.1.1.3">∗</ci></apply></list></apply></interval></apply></apply></apply><ci id="S2.E4.m1.2.2.2g.cmml" xref="S2.E4.m1.2.2.2"><mrow id="S2.E4.m1.2.2.2.cmml" xref="S2.E4.m1.2.2.2"><mtext id="S2.E4.m1.2.2.2a.cmml" xref="S2.E4.m1.2.2.2">s.t. </mtext><msubsup id="S2.E4.m1.1.1.1.m1.1.1.cmml" xref="S2.E4.m1.1.1.1.m1.1.1"><mi id="S2.E4.m1.1.1.1.m1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.m1.1.1.2.2">θ</mi><mi id="S2.E4.m1.1.1.1.m1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.m1.1.1.2.3">k</mi><mo id="S2.E4.m1.1.1.1.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.m1.1.1.3">∗</mo></msubsup><mtext id="S2.E4.m1.2.2.2b.cmml" xref="S2.E4.m1.2.2.2"> satisfies (</mtext><mtext id="S2.E4.m1.2.2.2c.cmml" xref="S2.E4.m1.2.2.2"><a href="#S2.E2" title="In 2.1 Local training as MAP estimation ‣ 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></mtext><mtext id="S2.E4.m1.2.2.2f.cmml" xref="S2.E4.m1.2.2.2">) for all </mtext><mrow id="S2.E4.m1.2.2.2.m2.4.4.1.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1"><mrow id="S2.E4.m1.2.2.2.m2.4.4.1.1.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1"><mi id="S2.E4.m1.2.2.2.m2.4.4.1.1.2.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.2">k</mi><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.1.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.1">∈</mo><mrow id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2"><mo stretchy="false" id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.1.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2">{</mo><mn id="S2.E4.m1.2.2.2.m2.1.1.cmml" xref="S2.E4.m1.2.2.2.m2.1.1">1</mn><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.2.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2">,</mo><mi mathvariant="normal" id="S2.E4.m1.2.2.2.m2.2.2.cmml" xref="S2.E4.m1.2.2.2.m2.2.2">…</mi><mo id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.3.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2">,</mo><mi id="S2.E4.m1.2.2.2.m2.3.3.cmml" xref="S2.E4.m1.2.2.2.m2.3.3">q</mi><mo stretchy="false" id="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2.4.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1.1.3.2">}</mo></mrow></mrow><mo id="S2.E4.m1.2.2.2.m2.4.4.1.2.cmml" xref="S2.E4.m1.2.2.2.m2.4.4.1">.</mo></mrow></mrow></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.5c">\gamma^{\ast}\in\arg\min_{\gamma\in\Gamma}\dfrac{1}{q}\sum_{k=1}^{q}\mathcal{L}_{g}^{(k)}(\rho_{\gamma},\phi(\cdot;\theta_{k}^{\ast})),\quad\text{s.t. $\theta_{k}^{\ast}$ satisfies \eqref{MAP estimation} for all $k\in\{1,\ldots,q\}.$}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Local training would address the lower-level problems, whereas the aggregation step addresses the upper-level problem.
Incorporating the global model in the loss function for the local training couples the upper- and lower-level optimization problems. This coupling leverages the knowledge of the local models across the clients.
For a theoretical analysis of alternate-gradient methods for bi-level optimisation problems we refer to <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib23" title="" class="ltx_ref">Ji2020BilevelOC </a>; <a href="#bib.bib24" title="" class="ltx_ref">NEURIPS2021_d4dd111a </a></cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed <span id="S3.1.1" class="ltx_text ltx_font_italic">FedMAP</span> algorithm</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.9" class="ltx_p">We propose FedMAP (Federated Maximum A Posteriori), a novel FL algorithm incorporating a global prior distribution over the local model parameters, enabling personalized FL.
In the sequel, we will consider, as a hypothesis set for the local models, a family of NNs denoted by</p>
<table id="S3.Ex9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex9.m1.3" class="ltx_Math" alttext="\phi(\cdot\,;\theta):\mathcal{X}\to\mathcal{Y},\qquad\theta\in\Theta:=\mathbb{R}^{d}." display="block"><semantics id="S3.Ex9.m1.3a"><mrow id="S3.Ex9.m1.3.3.1" xref="S3.Ex9.m1.3.3.1.1.cmml"><mrow id="S3.Ex9.m1.3.3.1.1" xref="S3.Ex9.m1.3.3.1.1.cmml"><mrow id="S3.Ex9.m1.3.3.1.1.4" xref="S3.Ex9.m1.3.3.1.1.4.cmml"><mi id="S3.Ex9.m1.3.3.1.1.4.2" xref="S3.Ex9.m1.3.3.1.1.4.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.Ex9.m1.3.3.1.1.4.1" xref="S3.Ex9.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.Ex9.m1.3.3.1.1.4.3.2" xref="S3.Ex9.m1.3.3.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.Ex9.m1.3.3.1.1.4.3.2.1" xref="S3.Ex9.m1.3.3.1.1.4.3.1.cmml">(</mo><mo lspace="0em" id="S3.Ex9.m1.1.1" xref="S3.Ex9.m1.1.1.cmml">⋅</mo><mo id="S3.Ex9.m1.3.3.1.1.4.3.2.2" xref="S3.Ex9.m1.3.3.1.1.4.3.1.cmml">;</mo><mi id="S3.Ex9.m1.2.2" xref="S3.Ex9.m1.2.2.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="S3.Ex9.m1.3.3.1.1.4.3.2.3" xref="S3.Ex9.m1.3.3.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.Ex9.m1.3.3.1.1.3" xref="S3.Ex9.m1.3.3.1.1.3.cmml">:</mo><mrow id="S3.Ex9.m1.3.3.1.1.2.2" xref="S3.Ex9.m1.3.3.1.1.2.3.cmml"><mrow id="S3.Ex9.m1.3.3.1.1.1.1.1" xref="S3.Ex9.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m1.3.3.1.1.1.1.1.2" xref="S3.Ex9.m1.3.3.1.1.1.1.1.2.cmml">𝒳</mi><mo stretchy="false" id="S3.Ex9.m1.3.3.1.1.1.1.1.1" xref="S3.Ex9.m1.3.3.1.1.1.1.1.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex9.m1.3.3.1.1.1.1.1.3" xref="S3.Ex9.m1.3.3.1.1.1.1.1.3.cmml">𝒴</mi></mrow><mo rspace="2.167em" id="S3.Ex9.m1.3.3.1.1.2.2.3" xref="S3.Ex9.m1.3.3.1.1.2.3a.cmml">,</mo><mrow id="S3.Ex9.m1.3.3.1.1.2.2.2" xref="S3.Ex9.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.Ex9.m1.3.3.1.1.2.2.2.2" xref="S3.Ex9.m1.3.3.1.1.2.2.2.2.cmml">θ</mi><mo id="S3.Ex9.m1.3.3.1.1.2.2.2.3" xref="S3.Ex9.m1.3.3.1.1.2.2.2.3.cmml">∈</mo><mi mathvariant="normal" id="S3.Ex9.m1.3.3.1.1.2.2.2.4" xref="S3.Ex9.m1.3.3.1.1.2.2.2.4.cmml">Θ</mi><mo lspace="0.278em" rspace="0.278em" id="S3.Ex9.m1.3.3.1.1.2.2.2.5" xref="S3.Ex9.m1.3.3.1.1.2.2.2.5.cmml">:=</mo><msup id="S3.Ex9.m1.3.3.1.1.2.2.2.6" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6.cmml"><mi id="S3.Ex9.m1.3.3.1.1.2.2.2.6.2" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6.2.cmml">ℝ</mi><mi id="S3.Ex9.m1.3.3.1.1.2.2.2.6.3" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6.3.cmml">d</mi></msup></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex9.m1.3.3.1.2" xref="S3.Ex9.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.3b"><apply id="S3.Ex9.m1.3.3.1.1.cmml" xref="S3.Ex9.m1.3.3.1"><ci id="S3.Ex9.m1.3.3.1.1.3.cmml" xref="S3.Ex9.m1.3.3.1.1.3">:</ci><apply id="S3.Ex9.m1.3.3.1.1.4.cmml" xref="S3.Ex9.m1.3.3.1.1.4"><times id="S3.Ex9.m1.3.3.1.1.4.1.cmml" xref="S3.Ex9.m1.3.3.1.1.4.1"></times><ci id="S3.Ex9.m1.3.3.1.1.4.2.cmml" xref="S3.Ex9.m1.3.3.1.1.4.2">italic-ϕ</ci><list id="S3.Ex9.m1.3.3.1.1.4.3.1.cmml" xref="S3.Ex9.m1.3.3.1.1.4.3.2"><ci id="S3.Ex9.m1.1.1.cmml" xref="S3.Ex9.m1.1.1">⋅</ci><ci id="S3.Ex9.m1.2.2.cmml" xref="S3.Ex9.m1.2.2">𝜃</ci></list></apply><apply id="S3.Ex9.m1.3.3.1.1.2.3.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.3.3.1.1.2.3a.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex9.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex9.m1.3.3.1.1.1.1.1"><ci id="S3.Ex9.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.3.3.1.1.1.1.1.1">→</ci><ci id="S3.Ex9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.3.3.1.1.1.1.1.2">𝒳</ci><ci id="S3.Ex9.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.3.3.1.1.1.1.1.3">𝒴</ci></apply><apply id="S3.Ex9.m1.3.3.1.1.2.2.2.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2"><and id="S3.Ex9.m1.3.3.1.1.2.2.2a.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2"></and><apply id="S3.Ex9.m1.3.3.1.1.2.2.2b.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2"><in id="S3.Ex9.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.3"></in><ci id="S3.Ex9.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.2">𝜃</ci><ci id="S3.Ex9.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.4">Θ</ci></apply><apply id="S3.Ex9.m1.3.3.1.1.2.2.2c.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2"><csymbol cd="latexml" id="S3.Ex9.m1.3.3.1.1.2.2.2.5.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.5">assign</csymbol><share href="#S3.Ex9.m1.3.3.1.1.2.2.2.4.cmml" id="S3.Ex9.m1.3.3.1.1.2.2.2d.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2"></share><apply id="S3.Ex9.m1.3.3.1.1.2.2.2.6.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6"><csymbol cd="ambiguous" id="S3.Ex9.m1.3.3.1.1.2.2.2.6.1.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6">superscript</csymbol><ci id="S3.Ex9.m1.3.3.1.1.2.2.2.6.2.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6.2">ℝ</ci><ci id="S3.Ex9.m1.3.3.1.1.2.2.2.6.3.cmml" xref="S3.Ex9.m1.3.3.1.1.2.2.2.6.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.3c">\phi(\cdot\,;\theta):\mathcal{X}\to\mathcal{Y},\qquad\theta\in\Theta:=\mathbb{R}^{d}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p1.2" class="ltx_p">As hypothesis set for the global model,
we will consider a Gaussian prior on the parameter space, where the parameter <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\gamma</annotation></semantics></math> represents the mean of the distribution.
For a fixed parameter <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\sigma^{2}&gt;0" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><msup id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml"><mi id="S3.p1.2.m2.1.1.2.2" xref="S3.p1.2.m2.1.1.2.2.cmml">σ</mi><mn id="S3.p1.2.m2.1.1.2.3" xref="S3.p1.2.m2.1.1.2.3.cmml">2</mn></msup><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><gt id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></gt><apply id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.2.1.cmml" xref="S3.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.p1.2.m2.1.1.2.2.cmml" xref="S3.p1.2.m2.1.1.2.2">𝜎</ci><cn type="integer" id="S3.p1.2.m2.1.1.2.3.cmml" xref="S3.p1.2.m2.1.1.2.3">2</cn></apply><cn type="integer" id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\sigma^{2}&gt;0</annotation></semantics></math>, we consider the parameterized family of probability distributions with density function</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\theta\in\Theta\longmapsto\rho_{\gamma}(\theta)=\dfrac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\frac{\|\theta-\gamma\|^{2}}{2\sigma^{2}}},\qquad\text{for}\ \gamma\in\Gamma=\Theta." display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1"><mrow id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.3.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml">θ</mi><mo id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml">∈</mo><mi mathvariant="normal" id="S3.E5.m1.3.3.1.1.1.1.4" xref="S3.E5.m1.3.3.1.1.1.1.4.cmml">Θ</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.5" xref="S3.E5.m1.3.3.1.1.1.1.5.cmml">⟼</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.6" xref="S3.E5.m1.3.3.1.1.1.1.6.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1.6.2" xref="S3.E5.m1.3.3.1.1.1.1.6.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.6.2.2" xref="S3.E5.m1.3.3.1.1.1.1.6.2.2.cmml">ρ</mi><mi id="S3.E5.m1.3.3.1.1.1.1.6.2.3" xref="S3.E5.m1.3.3.1.1.1.1.6.2.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.6.1" xref="S3.E5.m1.3.3.1.1.1.1.6.1.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.6.3.2" xref="S3.E5.m1.3.3.1.1.1.1.6.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.6.3.2.1" xref="S3.E5.m1.3.3.1.1.1.1.6.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.6.3.2.2" xref="S3.E5.m1.3.3.1.1.1.1.6.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.7" xref="S3.E5.m1.3.3.1.1.1.1.7.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.8" xref="S3.E5.m1.3.3.1.1.1.1.8.cmml"><mfrac id="S3.E5.m1.3.3.1.1.1.1.8.2" xref="S3.E5.m1.3.3.1.1.1.1.8.2.cmml"><mn id="S3.E5.m1.3.3.1.1.1.1.8.2.2" xref="S3.E5.m1.3.3.1.1.1.1.8.2.2.cmml">1</mn><msqrt id="S3.E5.m1.3.3.1.1.1.1.8.2.3" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.cmml"><mrow id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.cmml"><mn id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.2" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1.cmml">​</mo><mi id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.3" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1a" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1.cmml">​</mo><msup id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.2" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.2.cmml">σ</mi><mn id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.3" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.3.cmml">2</mn></msup></mrow></msqrt></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.8.1" xref="S3.E5.m1.3.3.1.1.1.1.8.1.cmml">​</mo><msup id="S3.E5.m1.3.3.1.1.1.1.8.3" xref="S3.E5.m1.3.3.1.1.1.1.8.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.8.3.2" xref="S3.E5.m1.3.3.1.1.1.1.8.3.2.cmml">e</mi><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1a" xref="S3.E5.m1.1.1.1.cmml">−</mo><mfrac id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msup id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">2</mn></msup><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mn id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">​</mo><msup id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">σ</mi><mn id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mfrac></mrow></msup></mrow></mrow><mo rspace="2.167em" id="S3.E5.m1.3.3.1.1.2.3" xref="S3.E5.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E5.m1.3.3.1.1.2.2" xref="S3.E5.m1.3.3.1.1.2.2.cmml"><mrow id="S3.E5.m1.3.3.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml"><mtext id="S3.E5.m1.3.3.1.1.2.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.2a.cmml">for</mtext><mo lspace="0.500em" rspace="0em" id="S3.E5.m1.3.3.1.1.2.2.2.1" xref="S3.E5.m1.3.3.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.3.3.1.1.2.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.2.3.cmml">γ</mi></mrow><mo id="S3.E5.m1.3.3.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.3.cmml">∈</mo><mi mathvariant="normal" id="S3.E5.m1.3.3.1.1.2.2.4" xref="S3.E5.m1.3.3.1.1.2.2.4.cmml">Γ</mi><mo id="S3.E5.m1.3.3.1.1.2.2.5" xref="S3.E5.m1.3.3.1.1.2.2.5.cmml">=</mo><mi mathvariant="normal" id="S3.E5.m1.3.3.1.1.2.2.6" xref="S3.E5.m1.3.3.1.1.2.2.6.cmml">Θ</mi></mrow></mrow><mo lspace="0em" id="S3.E5.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><and id="S3.E5.m1.3.3.1.1.1.1a.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></and><apply id="S3.E5.m1.3.3.1.1.1.1b.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><in id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3"></in><ci id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2">𝜃</ci><ci id="S3.E5.m1.3.3.1.1.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.4">Θ</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1c.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><ci id="S3.E5.m1.3.3.1.1.1.1.5.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5">⟼</ci><share href="#S3.E5.m1.3.3.1.1.1.1.4.cmml" id="S3.E5.m1.3.3.1.1.1.1d.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></share><apply id="S3.E5.m1.3.3.1.1.1.1.6.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6"><times id="S3.E5.m1.3.3.1.1.1.1.6.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6.1"></times><apply id="S3.E5.m1.3.3.1.1.1.1.6.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.6.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.6.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6.2.2">𝜌</ci><ci id="S3.E5.m1.3.3.1.1.1.1.6.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6.2.3">𝛾</ci></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝜃</ci></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.1e.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><eq id="S3.E5.m1.3.3.1.1.1.1.7.cmml" xref="S3.E5.m1.3.3.1.1.1.1.7"></eq><share href="#S3.E5.m1.3.3.1.1.1.1.6.cmml" id="S3.E5.m1.3.3.1.1.1.1f.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></share><apply id="S3.E5.m1.3.3.1.1.1.1.8.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8"><times id="S3.E5.m1.3.3.1.1.1.1.8.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.1"></times><apply id="S3.E5.m1.3.3.1.1.1.1.8.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2"><divide id="S3.E5.m1.3.3.1.1.1.1.8.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2"></divide><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.8.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.2">1</cn><apply id="S3.E5.m1.3.3.1.1.1.1.8.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3"><root id="S3.E5.m1.3.3.1.1.1.1.8.2.3a.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3"></root><apply id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2"><times id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.1"></times><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.2">2</cn><ci id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.3">𝜋</ci><apply id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.2">𝜎</ci><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.2.3.2.4.3">2</cn></apply></apply></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.1.8.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.8.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.3">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.8.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.8.3.2">𝑒</ci><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><minus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1"></minus><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><divide id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1"></divide><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><minus id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝛾</ci></apply></apply><cn type="integer" id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><times id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></times><cn type="integer" id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2">2</cn><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">𝜎</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2"><and id="S3.E5.m1.3.3.1.1.2.2a.cmml" xref="S3.E5.m1.3.3.1.1.2.2"></and><apply id="S3.E5.m1.3.3.1.1.2.2b.cmml" xref="S3.E5.m1.3.3.1.1.2.2"><in id="S3.E5.m1.3.3.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3"></in><apply id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2"><times id="S3.E5.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2.1"></times><ci id="S3.E5.m1.3.3.1.1.2.2.2.2a.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2.2"><mtext id="S3.E5.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2.2">for</mtext></ci><ci id="S3.E5.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2.3">𝛾</ci></apply><ci id="S3.E5.m1.3.3.1.1.2.2.4.cmml" xref="S3.E5.m1.3.3.1.1.2.2.4">Γ</ci></apply><apply id="S3.E5.m1.3.3.1.1.2.2c.cmml" xref="S3.E5.m1.3.3.1.1.2.2"><eq id="S3.E5.m1.3.3.1.1.2.2.5.cmml" xref="S3.E5.m1.3.3.1.1.2.2.5"></eq><share href="#S3.E5.m1.3.3.1.1.2.2.4.cmml" id="S3.E5.m1.3.3.1.1.2.2d.cmml" xref="S3.E5.m1.3.3.1.1.2.2"></share><ci id="S3.E5.m1.3.3.1.1.2.2.6.cmml" xref="S3.E5.m1.3.3.1.1.2.2.6">Θ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\theta\in\Theta\longmapsto\rho_{\gamma}(\theta)=\dfrac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\frac{\|\theta-\gamma\|^{2}}{2\sigma^{2}}},\qquad\text{for}\ \gamma\in\Gamma=\Theta.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.8" class="ltx_p">Let <math id="S3.p1.3.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t)}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.p1.3.m1.1a"><mrow id="S3.p1.3.m1.1.2" xref="S3.p1.3.m1.1.2.cmml"><msubsup id="S3.p1.3.m1.1.2.2" xref="S3.p1.3.m1.1.2.2.cmml"><mi id="S3.p1.3.m1.1.2.2.2.2" xref="S3.p1.3.m1.1.2.2.2.2.cmml">θ</mi><mi id="S3.p1.3.m1.1.2.2.2.3" xref="S3.p1.3.m1.1.2.2.2.3.cmml">k</mi><mrow id="S3.p1.3.m1.1.1.1.3" xref="S3.p1.3.m1.1.2.2.cmml"><mo stretchy="false" id="S3.p1.3.m1.1.1.1.3.1" xref="S3.p1.3.m1.1.2.2.cmml">(</mo><mi id="S3.p1.3.m1.1.1.1.1" xref="S3.p1.3.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.p1.3.m1.1.1.1.3.2" xref="S3.p1.3.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.3.m1.1.2.1" xref="S3.p1.3.m1.1.2.1.cmml">∈</mo><msup id="S3.p1.3.m1.1.2.3" xref="S3.p1.3.m1.1.2.3.cmml"><mi id="S3.p1.3.m1.1.2.3.2" xref="S3.p1.3.m1.1.2.3.2.cmml">ℝ</mi><mi id="S3.p1.3.m1.1.2.3.3" xref="S3.p1.3.m1.1.2.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m1.1b"><apply id="S3.p1.3.m1.1.2.cmml" xref="S3.p1.3.m1.1.2"><in id="S3.p1.3.m1.1.2.1.cmml" xref="S3.p1.3.m1.1.2.1"></in><apply id="S3.p1.3.m1.1.2.2.cmml" xref="S3.p1.3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.2.2.1.cmml" xref="S3.p1.3.m1.1.2.2">superscript</csymbol><apply id="S3.p1.3.m1.1.2.2.2.cmml" xref="S3.p1.3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.2.2.2.1.cmml" xref="S3.p1.3.m1.1.2.2">subscript</csymbol><ci id="S3.p1.3.m1.1.2.2.2.2.cmml" xref="S3.p1.3.m1.1.2.2.2.2">𝜃</ci><ci id="S3.p1.3.m1.1.2.2.2.3.cmml" xref="S3.p1.3.m1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.p1.3.m1.1.1.1.1.cmml" xref="S3.p1.3.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.p1.3.m1.1.2.3.cmml" xref="S3.p1.3.m1.1.2.3"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.2.3.1.cmml" xref="S3.p1.3.m1.1.2.3">superscript</csymbol><ci id="S3.p1.3.m1.1.2.3.2.cmml" xref="S3.p1.3.m1.1.2.3.2">ℝ</ci><ci id="S3.p1.3.m1.1.2.3.3.cmml" xref="S3.p1.3.m1.1.2.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m1.1c">\theta_{k}^{(t)}\in\mathbb{R}^{d}</annotation></semantics></math> denote the model parameters for client <math id="S3.p1.4.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.4.m2.1a"><mi id="S3.p1.4.m2.1.1" xref="S3.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m2.1b"><ci id="S3.p1.4.m2.1.1.cmml" xref="S3.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m2.1c">k</annotation></semantics></math> at communication round <math id="S3.p1.5.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.5.m3.1a"><mi id="S3.p1.5.m3.1.1" xref="S3.p1.5.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m3.1b"><ci id="S3.p1.5.m3.1.1.cmml" xref="S3.p1.5.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m3.1c">t</annotation></semantics></math>, and let <math id="S3.p1.6.m4.1" class="ltx_Math" alttext="\gamma^{(t)}" display="inline"><semantics id="S3.p1.6.m4.1a"><msup id="S3.p1.6.m4.1.2" xref="S3.p1.6.m4.1.2.cmml"><mi id="S3.p1.6.m4.1.2.2" xref="S3.p1.6.m4.1.2.2.cmml">γ</mi><mrow id="S3.p1.6.m4.1.1.1.3" xref="S3.p1.6.m4.1.2.cmml"><mo stretchy="false" id="S3.p1.6.m4.1.1.1.3.1" xref="S3.p1.6.m4.1.2.cmml">(</mo><mi id="S3.p1.6.m4.1.1.1.1" xref="S3.p1.6.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.p1.6.m4.1.1.1.3.2" xref="S3.p1.6.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.6.m4.1b"><apply id="S3.p1.6.m4.1.2.cmml" xref="S3.p1.6.m4.1.2"><csymbol cd="ambiguous" id="S3.p1.6.m4.1.2.1.cmml" xref="S3.p1.6.m4.1.2">superscript</csymbol><ci id="S3.p1.6.m4.1.2.2.cmml" xref="S3.p1.6.m4.1.2.2">𝛾</ci><ci id="S3.p1.6.m4.1.1.1.1.cmml" xref="S3.p1.6.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m4.1c">\gamma^{(t)}</annotation></semantics></math> denote the parameters of the prior. At every round, FedMAP aims to estimate <math id="S3.p1.7.m5.1" class="ltx_Math" alttext="\theta_{k}^{(t)}" display="inline"><semantics id="S3.p1.7.m5.1a"><msubsup id="S3.p1.7.m5.1.2" xref="S3.p1.7.m5.1.2.cmml"><mi id="S3.p1.7.m5.1.2.2.2" xref="S3.p1.7.m5.1.2.2.2.cmml">θ</mi><mi id="S3.p1.7.m5.1.2.2.3" xref="S3.p1.7.m5.1.2.2.3.cmml">k</mi><mrow id="S3.p1.7.m5.1.1.1.3" xref="S3.p1.7.m5.1.2.cmml"><mo stretchy="false" id="S3.p1.7.m5.1.1.1.3.1" xref="S3.p1.7.m5.1.2.cmml">(</mo><mi id="S3.p1.7.m5.1.1.1.1" xref="S3.p1.7.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.p1.7.m5.1.1.1.3.2" xref="S3.p1.7.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m5.1b"><apply id="S3.p1.7.m5.1.2.cmml" xref="S3.p1.7.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m5.1.2.1.cmml" xref="S3.p1.7.m5.1.2">superscript</csymbol><apply id="S3.p1.7.m5.1.2.2.cmml" xref="S3.p1.7.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m5.1.2.2.1.cmml" xref="S3.p1.7.m5.1.2">subscript</csymbol><ci id="S3.p1.7.m5.1.2.2.2.cmml" xref="S3.p1.7.m5.1.2.2.2">𝜃</ci><ci id="S3.p1.7.m5.1.2.2.3.cmml" xref="S3.p1.7.m5.1.2.2.3">𝑘</ci></apply><ci id="S3.p1.7.m5.1.1.1.1.cmml" xref="S3.p1.7.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m5.1c">\theta_{k}^{(t)}</annotation></semantics></math> while leveraging the shared knowledge across clients through the global model, which is the prior distribution <math id="S3.p1.8.m6.1" class="ltx_Math" alttext="\rho_{\gamma^{(t)}}" display="inline"><semantics id="S3.p1.8.m6.1a"><msub id="S3.p1.8.m6.1.2" xref="S3.p1.8.m6.1.2.cmml"><mi id="S3.p1.8.m6.1.2.2" xref="S3.p1.8.m6.1.2.2.cmml">ρ</mi><msup id="S3.p1.8.m6.1.1.1" xref="S3.p1.8.m6.1.1.1.cmml"><mi id="S3.p1.8.m6.1.1.1.3" xref="S3.p1.8.m6.1.1.1.3.cmml">γ</mi><mrow id="S3.p1.8.m6.1.1.1.1.1.3" xref="S3.p1.8.m6.1.1.1.cmml"><mo stretchy="false" id="S3.p1.8.m6.1.1.1.1.1.3.1" xref="S3.p1.8.m6.1.1.1.cmml">(</mo><mi id="S3.p1.8.m6.1.1.1.1.1.1" xref="S3.p1.8.m6.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.p1.8.m6.1.1.1.1.1.3.2" xref="S3.p1.8.m6.1.1.1.cmml">)</mo></mrow></msup></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m6.1b"><apply id="S3.p1.8.m6.1.2.cmml" xref="S3.p1.8.m6.1.2"><csymbol cd="ambiguous" id="S3.p1.8.m6.1.2.1.cmml" xref="S3.p1.8.m6.1.2">subscript</csymbol><ci id="S3.p1.8.m6.1.2.2.cmml" xref="S3.p1.8.m6.1.2.2">𝜌</ci><apply id="S3.p1.8.m6.1.1.1.cmml" xref="S3.p1.8.m6.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m6.1.1.1.2.cmml" xref="S3.p1.8.m6.1.1.1">superscript</csymbol><ci id="S3.p1.8.m6.1.1.1.3.cmml" xref="S3.p1.8.m6.1.1.1.3">𝛾</ci><ci id="S3.p1.8.m6.1.1.1.1.1.1.cmml" xref="S3.p1.8.m6.1.1.1.1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m6.1c">\rho_{\gamma^{(t)}}</annotation></semantics></math>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">The FedMAP algorithm consists of three main steps: Initialization, Local Optimization, and Global Aggregation, as outlined in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Initialization ‣ 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Initialization</h4>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.3" class="ltx_p">A client <math id="S3.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">j</annotation></semantics></math> is randomly selected, and its model parameters are used to initialize the global model <math id="S3.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\gamma^{(0)}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><msup id="S3.SS0.SSS0.Px1.p1.2.m2.1.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.2.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.2.cmml">γ</mi><mrow id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.cmml">(</mo><mn id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px1.p1.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.2.2">𝛾</ci><cn type="integer" id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">\gamma^{(0)}</annotation></semantics></math> and the local model parameters <math id="S3.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\theta_{j}^{(0)}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><msubsup id="S3.SS0.SSS0.Px1.p1.3.m3.1.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.3.cmml">j</mi><mrow id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.cmml">(</mo><mn id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.2.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">\theta_{j}^{(0)}</annotation></semantics></math>. These initial parameters are then broadcasted to all clients, ensuring that every client starts from a common initial point.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedMAP (Federated Maximum A Posteriori)</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">q</annotation></semantics></math> (Total number of clients)

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold">Initialization:</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Randomly select client <math id="alg1.l3.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">j</annotation></semantics></math> from <math id="alg1.l3.m2.3" class="ltx_Math" alttext="\{1,\ldots,q\}" display="inline"><semantics id="alg1.l3.m2.3a"><mrow id="alg1.l3.m2.3.4.2" xref="alg1.l3.m2.3.4.1.cmml"><mo stretchy="false" id="alg1.l3.m2.3.4.2.1" xref="alg1.l3.m2.3.4.1.cmml">{</mo><mn id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">1</mn><mo id="alg1.l3.m2.3.4.2.2" xref="alg1.l3.m2.3.4.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m2.2.2" xref="alg1.l3.m2.2.2.cmml">…</mi><mo id="alg1.l3.m2.3.4.2.3" xref="alg1.l3.m2.3.4.1.cmml">,</mo><mi id="alg1.l3.m2.3.3" xref="alg1.l3.m2.3.3.cmml">q</mi><mo stretchy="false" id="alg1.l3.m2.3.4.2.4" xref="alg1.l3.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.3b"><set id="alg1.l3.m2.3.4.1.cmml" xref="alg1.l3.m2.3.4.2"><cn type="integer" id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">1</cn><ci id="alg1.l3.m2.2.2.cmml" xref="alg1.l3.m2.2.2">…</ci><ci id="alg1.l3.m2.3.3.cmml" xref="alg1.l3.m2.3.3">𝑞</ci></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.3c">\{1,\ldots,q\}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Initialize <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\theta^{(0)}" display="inline"><semantics id="alg1.l4.m1.1a"><msup id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><mi id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml">θ</mi><mrow id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.1" xref="alg1.l4.m1.1.2.cmml">(</mo><mn id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.2" xref="alg1.l4.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2">superscript</csymbol><ci id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2">𝜃</ci><cn type="integer" id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\theta^{(0)}</annotation></semantics></math> and <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\gamma^{(0)}" display="inline"><semantics id="alg1.l4.m2.1a"><msup id="alg1.l4.m2.1.2" xref="alg1.l4.m2.1.2.cmml"><mi id="alg1.l4.m2.1.2.2" xref="alg1.l4.m2.1.2.2.cmml">γ</mi><mrow id="alg1.l4.m2.1.1.1.3" xref="alg1.l4.m2.1.2.cmml"><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.1" xref="alg1.l4.m2.1.2.cmml">(</mo><mn id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.2" xref="alg1.l4.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.1.cmml" xref="alg1.l4.m2.1.2">superscript</csymbol><ci id="alg1.l4.m2.1.2.2.cmml" xref="alg1.l4.m2.1.2.2">𝛾</ci><cn type="integer" id="alg1.l4.m2.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\gamma^{(0)}</annotation></semantics></math> based on client <math id="alg1.l4.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l4.m3.1a"><mi id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><ci id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">j</annotation></semantics></math>’s model

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Broadcast <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\gamma^{(0)}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">γ</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.1" xref="alg1.l5.m1.1.2.cmml">(</mo><mn id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2">superscript</csymbol><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝛾</ci><cn type="integer" id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\gamma^{(0)}</annotation></semantics></math> and <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\theta^{(0)}" display="inline"><semantics id="alg1.l5.m2.1a"><msup id="alg1.l5.m2.1.2" xref="alg1.l5.m2.1.2.cmml"><mi id="alg1.l5.m2.1.2.2" xref="alg1.l5.m2.1.2.2.cmml">θ</mi><mrow id="alg1.l5.m2.1.1.1.3" xref="alg1.l5.m2.1.2.cmml"><mo stretchy="false" id="alg1.l5.m2.1.1.1.3.1" xref="alg1.l5.m2.1.2.cmml">(</mo><mn id="alg1.l5.m2.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l5.m2.1.1.1.3.2" xref="alg1.l5.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.2.cmml" xref="alg1.l5.m2.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.2.1.cmml" xref="alg1.l5.m2.1.2">superscript</csymbol><ci id="alg1.l5.m2.1.2.2.cmml" xref="alg1.l5.m2.1.2.2">𝜃</ci><cn type="integer" id="alg1.l5.m2.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\theta^{(0)}</annotation></semantics></math> to all clients

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> each communication round <math id="alg1.l6.m1.4" class="ltx_Math" alttext="t=0,1,2,\ldots" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.5" xref="alg1.l6.m1.4.5.cmml"><mi id="alg1.l6.m1.4.5.2" xref="alg1.l6.m1.4.5.2.cmml">t</mi><mo id="alg1.l6.m1.4.5.1" xref="alg1.l6.m1.4.5.1.cmml">=</mo><mrow id="alg1.l6.m1.4.5.3.2" xref="alg1.l6.m1.4.5.3.1.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">0</mn><mo id="alg1.l6.m1.4.5.3.2.1" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">1</mn><mo id="alg1.l6.m1.4.5.3.2.2" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">2</mn><mo id="alg1.l6.m1.4.5.3.2.3" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.5.cmml" xref="alg1.l6.m1.4.5"><eq id="alg1.l6.m1.4.5.1.cmml" xref="alg1.l6.m1.4.5.1"></eq><ci id="alg1.l6.m1.4.5.2.cmml" xref="alg1.l6.m1.4.5.2">𝑡</ci><list id="alg1.l6.m1.4.5.3.1.cmml" xref="alg1.l6.m1.4.5.3.2"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">0</cn><cn type="integer" id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">1</cn><cn type="integer" id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">2</cn><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">t=0,1,2,\ldots</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">k</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">=</mo><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></eq><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">k=1</annotation></semantics></math> to <math id="alg1.l7.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">q</annotation></semantics></math> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l7.4" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <span id="alg1.l8.3" class="ltx_text ltx_font_smallcaps">LocalOptimization</span>(<math id="alg1.l8.m1.1" class="ltx_Math" alttext="\gamma^{(t)}" display="inline"><semantics id="alg1.l8.m1.1a"><msup id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><mi id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml">γ</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.1.2.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2">superscript</csymbol><ci id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2">𝛾</ci><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\gamma^{(t)}</annotation></semantics></math>) <span id="alg1.l8.1" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> Algorithm <a href="#alg2" title="Algorithm 2 ‣ Local Optimization ‣ 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.2.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg1.l10.3" class="ltx_text ltx_font_smallcaps">GlobalAggregation</span>(<math id="alg1.l10.m1.1" class="ltx_math_unparsed" alttext="\{\theta_{k}^{(t+1)}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1b"><mo stretchy="false" id="alg1.l10.m1.1.2">{</mo><msubsup id="alg1.l10.m1.1.3"><mi id="alg1.l10.m1.1.3.2.2">θ</mi><mi id="alg1.l10.m1.1.3.2.3">k</mi><mrow id="alg1.l10.m1.1.1.1.1"><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.2">(</mo><mrow id="alg1.l10.m1.1.1.1.1.1"><mi id="alg1.l10.m1.1.1.1.1.1.2">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.1">+</mo><mn id="alg1.l10.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.3">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\{\theta_{k}^{(t+1)}</annotation></semantics></math>, <math id="alg1.l10.m2.1" class="ltx_math_unparsed" alttext="\omega_{k}^{(t)}\}_{k=1}^{q}" display="inline"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1b"><msubsup id="alg1.l10.m2.1.2"><mi id="alg1.l10.m2.1.2.2.2">ω</mi><mi id="alg1.l10.m2.1.2.2.3">k</mi><mrow id="alg1.l10.m2.1.1.1.3"><mo stretchy="false" id="alg1.l10.m2.1.1.1.3.1">(</mo><mi id="alg1.l10.m2.1.1.1.1">t</mi><mo stretchy="false" id="alg1.l10.m2.1.1.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l10.m2.1.3">}</mo><msub id="alg1.l10.m2.1.4"><mi id="alg1.l10.m2.1.4a"></mi><mrow id="alg1.l10.m2.1.4.1"><mi id="alg1.l10.m2.1.4.1.2">k</mi><mo id="alg1.l10.m2.1.4.1.1">=</mo><mn id="alg1.l10.m2.1.4.1.3">1</mn></mrow></msub><msup id="alg1.l10.m2.1.5"><mi id="alg1.l10.m2.1.5a"></mi><mi id="alg1.l10.m2.1.5.1">q</mi></msup></mrow><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\omega_{k}^{(t)}\}_{k=1}^{q}</annotation></semantics></math>) <span id="alg1.l10.1" class="ltx_text" style="float:right;"><math id="alg1.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation></semantics></math> Algorithm <a href="#alg3" title="Algorithm 3 ‣ Global Aggregation ‣ 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span><span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Local Optimization</h4>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.2" class="ltx_p">Each client <math id="S3.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">k</annotation></semantics></math> optimizes their model parameters <math id="S3.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><msubsup id="S3.SS0.SSS0.Px2.p1.2.m2.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.2.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1"><plus id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">\theta_{k}^{(t+1)}</annotation></semantics></math> by minimizing the negative log-likelihood of the posterior distribution, according to the following update rule:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.4" class="ltx_Math" alttext="\theta_{k}^{(t+1)}=\arg\min_{\theta}-\log\mathbb{P}(Z_{k}|\theta)-\log\rho_{\gamma^{(t)}}(\theta)." display="block"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4.4.1" xref="S3.E6.m1.4.4.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml"><msubsup id="S3.E6.m1.4.4.1.1.3" xref="S3.E6.m1.4.4.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.3.2.2" xref="S3.E6.m1.4.4.1.1.3.2.2.cmml">θ</mi><mi id="S3.E6.m1.4.4.1.1.3.2.3" xref="S3.E6.m1.4.4.1.1.3.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.4.4.1.1.2" xref="S3.E6.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.3.1" xref="S3.E6.m1.4.4.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E6.m1.4.4.1.1.1.3a" xref="S3.E6.m1.4.4.1.1.1.3.cmml">⁡</mo><munder id="S3.E6.m1.4.4.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.3.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.3.2.2" xref="S3.E6.m1.4.4.1.1.1.3.2.2.cmml">min</mi><mi id="S3.E6.m1.4.4.1.1.1.3.2.3" xref="S3.E6.m1.4.4.1.1.1.3.2.3.cmml">θ</mi></munder></mrow><mo lspace="0em" id="S3.E6.m1.4.4.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.4.4.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.3.1" xref="S3.E6.m1.4.4.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.4.4.1.1.1.1.3a" xref="S3.E6.m1.4.4.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E6.m1.4.4.1.1.1.1.3.2" xref="S3.E6.m1.4.4.1.1.1.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.4.4.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">Z</mi><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo fence="false" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml">θ</mi></mrow><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.4.1.1.1.2a" xref="S3.E6.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.4.4.1.1.1.4" xref="S3.E6.m1.4.4.1.1.1.4.cmml"><mrow id="S3.E6.m1.4.4.1.1.1.4.2" xref="S3.E6.m1.4.4.1.1.1.4.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.4.2.1" xref="S3.E6.m1.4.4.1.1.1.4.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.4.4.1.1.1.4.2a" xref="S3.E6.m1.4.4.1.1.1.4.2.cmml">⁡</mo><msub id="S3.E6.m1.4.4.1.1.1.4.2.2" xref="S3.E6.m1.4.4.1.1.1.4.2.2.cmml"><mi id="S3.E6.m1.4.4.1.1.1.4.2.2.2" xref="S3.E6.m1.4.4.1.1.1.4.2.2.2.cmml">ρ</mi><msup id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.cmml"><mi id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.2.2.1.3.cmml">γ</mi><mrow id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.3.1" xref="S3.E6.m1.2.2.1.cmml">(</mo><mi id="S3.E6.m1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.1.1.1.4.1" xref="S3.E6.m1.4.4.1.1.1.4.1.cmml">​</mo><mrow id="S3.E6.m1.4.4.1.1.1.4.3.2" xref="S3.E6.m1.4.4.1.1.1.4.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.4.3.2.1" xref="S3.E6.m1.4.4.1.1.1.4.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.4.4.1.1.1.4.3.2.2" xref="S3.E6.m1.4.4.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.4.4.1.2" xref="S3.E6.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.4b"><apply id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1"><eq id="S3.E6.m1.4.4.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.2"></eq><apply id="S3.E6.m1.4.4.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.3">superscript</csymbol><apply id="S3.E6.m1.4.4.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.3.2.1.cmml" xref="S3.E6.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.3.2.2.cmml" xref="S3.E6.m1.4.4.1.1.3.2.2">𝜃</ci><ci id="S3.E6.m1.4.4.1.1.3.2.3.cmml" xref="S3.E6.m1.4.4.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"></plus><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E6.m1.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"><minus id="S3.E6.m1.4.4.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2"></minus><apply id="S3.E6.m1.4.4.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.3"><arg id="S3.E6.m1.4.4.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.3.1"></arg><apply id="S3.E6.m1.4.4.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.3.2">subscript</csymbol><min id="S3.E6.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.3.2.2"></min><ci id="S3.E6.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.E6.m1.4.4.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E6.m1.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1"><times id="S3.E6.m1.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.2"></times><apply id="S3.E6.m1.4.4.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3"><log id="S3.E6.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3.1"></log><ci id="S3.E6.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.3.2">ℙ</ci></apply><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.2">𝑍</ci><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.1.1.1.1.1.1.1.3">𝜃</ci></apply></apply><apply id="S3.E6.m1.4.4.1.1.1.4.cmml" xref="S3.E6.m1.4.4.1.1.1.4"><times id="S3.E6.m1.4.4.1.1.1.4.1.cmml" xref="S3.E6.m1.4.4.1.1.1.4.1"></times><apply id="S3.E6.m1.4.4.1.1.1.4.2.cmml" xref="S3.E6.m1.4.4.1.1.1.4.2"><log id="S3.E6.m1.4.4.1.1.1.4.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.4.2.1"></log><apply id="S3.E6.m1.4.4.1.1.1.4.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.4.2.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1.4.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.4.2.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.4.2.2.2">𝜌</ci><apply id="S3.E6.m1.2.2.1.cmml" xref="S3.E6.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.2.cmml" xref="S3.E6.m1.2.2.1">superscript</csymbol><ci id="S3.E6.m1.2.2.1.3.cmml" xref="S3.E6.m1.2.2.1.3">𝛾</ci><ci id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\theta_{k}^{(t+1)}=\arg\min_{\theta}-\log\mathbb{P}(Z_{k}|\theta)-\log\rho_{\gamma^{(t)}}(\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px2.p1.9" class="ltx_p">Using the explicit form of the prior in (<a href="#S3.E5" title="In 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), we can write the minimization problem as</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.7" class="ltx_Math" alttext="\theta_{k}^{(t+1)}=\arg\min_{\theta}\frac{1}{N_{k}}\sum_{i=1}^{N_{k}}\mathcal{L}\left(y_{k}^{(i)},\phi(x_{k}^{(i)};\theta)\right)+\underbrace{\frac{1}{2\sigma^{2}}\|\theta-\gamma^{(t)}\|^{2}}_{\text{Prior term}}," display="block"><semantics id="S3.E7.m1.7a"><mrow id="S3.E7.m1.7.7.1" xref="S3.E7.m1.7.7.1.1.cmml"><mrow id="S3.E7.m1.7.7.1.1" xref="S3.E7.m1.7.7.1.1.cmml"><msubsup id="S3.E7.m1.7.7.1.1.4" xref="S3.E7.m1.7.7.1.1.4.cmml"><mi id="S3.E7.m1.7.7.1.1.4.2.2" xref="S3.E7.m1.7.7.1.1.4.2.2.cmml">θ</mi><mi id="S3.E7.m1.7.7.1.1.4.2.3" xref="S3.E7.m1.7.7.1.1.4.2.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.7.7.1.1.3" xref="S3.E7.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.7.7.1.1.2" xref="S3.E7.m1.7.7.1.1.2.cmml"><mrow id="S3.E7.m1.7.7.1.1.2.2" xref="S3.E7.m1.7.7.1.1.2.2.cmml"><mrow id="S3.E7.m1.7.7.1.1.2.2.4" xref="S3.E7.m1.7.7.1.1.2.2.4.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.4.1" xref="S3.E7.m1.7.7.1.1.2.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E7.m1.7.7.1.1.2.2.4a" xref="S3.E7.m1.7.7.1.1.2.2.4.cmml">⁡</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.4.2" xref="S3.E7.m1.7.7.1.1.2.2.4.2.cmml"><munder id="S3.E7.m1.7.7.1.1.2.2.4.2.1" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.4.2.1.2" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1.2.cmml">min</mi><mi id="S3.E7.m1.7.7.1.1.2.2.4.2.1.3" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E7.m1.7.7.1.1.2.2.4.2a" xref="S3.E7.m1.7.7.1.1.2.2.4.2.cmml">⁡</mo><mfrac id="S3.E7.m1.7.7.1.1.2.2.4.2.2" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.cmml"><mn id="S3.E7.m1.7.7.1.1.2.2.4.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.2.cmml">1</mn><msub id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.2" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.2.cmml">N</mi><mi id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.3" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.3.cmml">k</mi></msub></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.cmml"><munderover id="S3.E7.m1.7.7.1.1.2.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E7.m1.7.7.1.1.2.2.2.3.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.2" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.1" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.3" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E7.m1.7.7.1.1.2.2.2.3.3" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.2.3.3.2" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3.2.cmml">N</mi><mi id="S3.E7.m1.7.7.1.1.2.2.2.3.3.3" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3.3.cmml">k</mi></msub></munderover><mrow id="S3.E7.m1.7.7.1.1.2.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.7.7.1.1.2.2.2.2.4" xref="S3.E7.m1.7.7.1.1.2.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.2.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.3.cmml"><mo id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.3.1" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.4" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.3.cmml">,</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.2.cmml">(</mo><msubsup id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.2.cmml">x</mi><mi id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.3.cmml">k</mi><mrow id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.3.1" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.3.2" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.3" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.2.cmml">;</mo><mi id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml">θ</mi><mo stretchy="false" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.4" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.5" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.7.7.1.1.2.3" xref="S3.E7.m1.7.7.1.1.2.3.cmml">+</mo><munder id="S3.E7.m1.7.7.1.1.2.4" xref="S3.E7.m1.7.7.1.1.2.4.cmml"><munder accentunder="true" id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml"><mrow id="S3.E7.m1.5.5.2" xref="S3.E7.m1.5.5.2.cmml"><mfrac id="S3.E7.m1.5.5.2.4" xref="S3.E7.m1.5.5.2.4.cmml"><mn id="S3.E7.m1.5.5.2.4.2" xref="S3.E7.m1.5.5.2.4.2.cmml">1</mn><mrow id="S3.E7.m1.5.5.2.4.3" xref="S3.E7.m1.5.5.2.4.3.cmml"><mn id="S3.E7.m1.5.5.2.4.3.2" xref="S3.E7.m1.5.5.2.4.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.2.4.3.1" xref="S3.E7.m1.5.5.2.4.3.1.cmml">​</mo><msup id="S3.E7.m1.5.5.2.4.3.3" xref="S3.E7.m1.5.5.2.4.3.3.cmml"><mi id="S3.E7.m1.5.5.2.4.3.3.2" xref="S3.E7.m1.5.5.2.4.3.3.2.cmml">σ</mi><mn id="S3.E7.m1.5.5.2.4.3.3.3" xref="S3.E7.m1.5.5.2.4.3.3.3.cmml">2</mn></msup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.2.3" xref="S3.E7.m1.5.5.2.3.cmml">​</mo><msup id="S3.E7.m1.5.5.2.2" xref="S3.E7.m1.5.5.2.2.cmml"><mrow id="S3.E7.m1.5.5.2.2.1.1" xref="S3.E7.m1.5.5.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.2.2.1.1.2" xref="S3.E7.m1.5.5.2.2.1.2.1.cmml">‖</mo><mrow id="S3.E7.m1.5.5.2.2.1.1.1" xref="S3.E7.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E7.m1.5.5.2.2.1.1.1.2" xref="S3.E7.m1.5.5.2.2.1.1.1.2.cmml">θ</mi><mo id="S3.E7.m1.5.5.2.2.1.1.1.1" xref="S3.E7.m1.5.5.2.2.1.1.1.1.cmml">−</mo><msup id="S3.E7.m1.5.5.2.2.1.1.1.3" xref="S3.E7.m1.5.5.2.2.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.2.2.1.1.1.3.2" xref="S3.E7.m1.5.5.2.2.1.1.1.3.2.cmml">γ</mi><mrow id="S3.E7.m1.4.4.1.1.1.3" xref="S3.E7.m1.5.5.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.1.1.1.3.1" xref="S3.E7.m1.5.5.2.2.1.1.1.3.cmml">(</mo><mi id="S3.E7.m1.4.4.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E7.m1.4.4.1.1.1.3.2" xref="S3.E7.m1.5.5.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S3.E7.m1.5.5.2.2.1.1.3" xref="S3.E7.m1.5.5.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S3.E7.m1.5.5.2.2.3" xref="S3.E7.m1.5.5.2.2.3.cmml">2</mn></msup></mrow><mo id="S3.E7.m1.5.5.3" xref="S3.E7.m1.5.5.3.cmml">⏟</mo></munder><mtext id="S3.E7.m1.7.7.1.1.2.4.2" xref="S3.E7.m1.7.7.1.1.2.4.2a.cmml">Prior term</mtext></munder></mrow></mrow><mo id="S3.E7.m1.7.7.1.2" xref="S3.E7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.7b"><apply id="S3.E7.m1.7.7.1.1.cmml" xref="S3.E7.m1.7.7.1"><eq id="S3.E7.m1.7.7.1.1.3.cmml" xref="S3.E7.m1.7.7.1.1.3"></eq><apply id="S3.E7.m1.7.7.1.1.4.cmml" xref="S3.E7.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.4.1.cmml" xref="S3.E7.m1.7.7.1.1.4">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.4.2.cmml" xref="S3.E7.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.4.2.1.cmml" xref="S3.E7.m1.7.7.1.1.4">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.4.2.2.cmml" xref="S3.E7.m1.7.7.1.1.4.2.2">𝜃</ci><ci id="S3.E7.m1.7.7.1.1.4.2.3.cmml" xref="S3.E7.m1.7.7.1.1.4.2.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"></plus><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E7.m1.7.7.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.2"><plus id="S3.E7.m1.7.7.1.1.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.3"></plus><apply id="S3.E7.m1.7.7.1.1.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2"><times id="S3.E7.m1.7.7.1.1.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.3"></times><apply id="S3.E7.m1.7.7.1.1.2.2.4.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4"><arg id="S3.E7.m1.7.7.1.1.2.2.4.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.1"></arg><apply id="S3.E7.m1.7.7.1.1.2.2.4.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2"><apply id="S3.E7.m1.7.7.1.1.2.2.4.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.4.2.1.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1">subscript</csymbol><min id="S3.E7.m1.7.7.1.1.2.2.4.2.1.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1.2"></min><ci id="S3.E7.m1.7.7.1.1.2.2.4.2.1.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.1.3">𝜃</ci></apply><apply id="S3.E7.m1.7.7.1.1.2.2.4.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2"><divide id="S3.E7.m1.7.7.1.1.2.2.4.2.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2"></divide><cn type="integer" id="S3.E7.m1.7.7.1.1.2.2.4.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.2">1</cn><apply id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.2">𝑁</ci><ci id="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.4.2.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E7.m1.7.7.1.1.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2"><apply id="S3.E7.m1.7.7.1.1.2.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.2.2.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.2.3.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3">subscript</csymbol><sum id="S3.E7.m1.7.7.1.1.2.2.2.3.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.2"></sum><apply id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3"><eq id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.1"></eq><ci id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.7.7.1.1.2.2.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.2.3.3.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.2.2.2.3.3.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3.2">𝑁</ci><ci id="S3.E7.m1.7.7.1.1.2.2.2.3.3.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2"><times id="S3.E7.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.3"></times><ci id="S3.E7.m1.7.7.1.1.2.2.2.2.4.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.4">ℒ</ci><interval closure="open" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2"><apply id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2"><times id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.2"></times><ci id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.3">italic-ϕ</ci><list id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1"><apply id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.2">𝑥</ci><ci id="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2.2.2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝑖</ci></apply><ci id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6">𝜃</ci></list></apply></interval></apply></apply></apply><apply id="S3.E7.m1.7.7.1.1.2.4.cmml" xref="S3.E7.m1.7.7.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.4.1.cmml" xref="S3.E7.m1.7.7.1.1.2.4">subscript</csymbol><apply id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5"><ci id="S3.E7.m1.5.5.3.cmml" xref="S3.E7.m1.5.5.3">⏟</ci><apply id="S3.E7.m1.5.5.2.cmml" xref="S3.E7.m1.5.5.2"><times id="S3.E7.m1.5.5.2.3.cmml" xref="S3.E7.m1.5.5.2.3"></times><apply id="S3.E7.m1.5.5.2.4.cmml" xref="S3.E7.m1.5.5.2.4"><divide id="S3.E7.m1.5.5.2.4.1.cmml" xref="S3.E7.m1.5.5.2.4"></divide><cn type="integer" id="S3.E7.m1.5.5.2.4.2.cmml" xref="S3.E7.m1.5.5.2.4.2">1</cn><apply id="S3.E7.m1.5.5.2.4.3.cmml" xref="S3.E7.m1.5.5.2.4.3"><times id="S3.E7.m1.5.5.2.4.3.1.cmml" xref="S3.E7.m1.5.5.2.4.3.1"></times><cn type="integer" id="S3.E7.m1.5.5.2.4.3.2.cmml" xref="S3.E7.m1.5.5.2.4.3.2">2</cn><apply id="S3.E7.m1.5.5.2.4.3.3.cmml" xref="S3.E7.m1.5.5.2.4.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.2.4.3.3.1.cmml" xref="S3.E7.m1.5.5.2.4.3.3">superscript</csymbol><ci id="S3.E7.m1.5.5.2.4.3.3.2.cmml" xref="S3.E7.m1.5.5.2.4.3.3.2">𝜎</ci><cn type="integer" id="S3.E7.m1.5.5.2.4.3.3.3.cmml" xref="S3.E7.m1.5.5.2.4.3.3.3">2</cn></apply></apply></apply><apply id="S3.E7.m1.5.5.2.2.cmml" xref="S3.E7.m1.5.5.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.2.2.2.cmml" xref="S3.E7.m1.5.5.2.2">superscript</csymbol><apply id="S3.E7.m1.5.5.2.2.1.2.cmml" xref="S3.E7.m1.5.5.2.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.5.5.2.2.1.2.1.cmml" xref="S3.E7.m1.5.5.2.2.1.1.2">norm</csymbol><apply id="S3.E7.m1.5.5.2.2.1.1.1.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1"><minus id="S3.E7.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1.1"></minus><ci id="S3.E7.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1.2">𝜃</ci><apply id="S3.E7.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E7.m1.5.5.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.2.2.1.1.1.3.2">𝛾</ci><ci id="S3.E7.m1.4.4.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1">𝑡</ci></apply></apply></apply><cn type="integer" id="S3.E7.m1.5.5.2.2.3.cmml" xref="S3.E7.m1.5.5.2.2.3">2</cn></apply></apply></apply><ci id="S3.E7.m1.7.7.1.1.2.4.2a.cmml" xref="S3.E7.m1.7.7.1.1.2.4.2"><mtext mathsize="70%" id="S3.E7.m1.7.7.1.1.2.4.2.cmml" xref="S3.E7.m1.7.7.1.1.2.4.2">Prior term</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.7c">\theta_{k}^{(t+1)}=\arg\min_{\theta}\frac{1}{N_{k}}\sum_{i=1}^{N_{k}}\mathcal{L}\left(y_{k}^{(i)},\phi(x_{k}^{(i)};\theta)\right)+\underbrace{\frac{1}{2\sigma^{2}}\|\theta-\gamma^{(t)}\|^{2}}_{\text{Prior term}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px2.p1.8" class="ltx_p">where <math id="S3.SS0.SSS0.Px2.p1.3.m1.8" class="ltx_Math" alttext="\mathcal{L}\left(y_{i},\phi(x_{k}^{(i)};\theta)\right):=-\log\mathbb{P}\left(y_{k}^{(i)}|\phi(x_{k}^{(i)},\theta)\right)" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.3.m1.8a"><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.3.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.3.cmml">,</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.2.cmml">(</mo><msubsup id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.2.cmml">;</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.4.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.5" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.4.cmml">:=</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.cmml"><mo rspace="0.167em" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3a" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.cmml">−</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3a" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.cmml">⁡</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.cmml"><mo id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.cmml"><msubsup id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo fence="false" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.2.cmml">|</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m1.5.5" xref="S3.SS0.SSS0.Px2.p1.3.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.4" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m1.8b"><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.4.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.4">assign</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2"><times id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.3"></times><ci id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.4.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.4">ℒ</ci><interval closure="open" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2"><apply id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.6.6.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2"><times id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.2"></times><ci id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.3">italic-ϕ</ci><list id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1"><apply id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.7.7.2.2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m1.4.4.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.4.4">𝜃</ci></list></apply></interval></apply><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3"><minus id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3"></minus><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1"><times id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.2"></times><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3"><log id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.1"></log><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.3.2">ℙ</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.2">conditional</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1"><times id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.2"></times><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.3">italic-ϕ</ci><interval closure="open" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1"><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.8.8.3.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.3.3.1.1">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.3.m1.5.5.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m1.5.5">𝜃</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m1.8c">\mathcal{L}\left(y_{i},\phi(x_{k}^{(i)};\theta)\right):=-\log\mathbb{P}\left(y_{k}^{(i)}|\phi(x_{k}^{(i)},\theta)\right)</annotation></semantics></math> denotes the loss function, and <math id="S3.SS0.SSS0.Px2.p1.4.m2.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.4.m2.1a"><msub id="S3.SS0.SSS0.Px2.p1.4.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1.2.cmml">N</mi><mi id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m2.1b"><apply id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1.2">𝑁</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m2.1c">N_{k}</annotation></semantics></math> represents the count of data points in <math id="S3.SS0.SSS0.Px2.p1.5.m3.1" class="ltx_Math" alttext="Z_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.5.m3.1a"><msub id="S3.SS0.SSS0.Px2.p1.5.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1.2.cmml">Z</mi><mi id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.5.m3.1b"><apply id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1.2">𝑍</ci><ci id="S3.SS0.SSS0.Px2.p1.5.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.5.m3.1c">Z_{k}</annotation></semantics></math>. The prior term penalizes deviations from the global model parameters <math id="S3.SS0.SSS0.Px2.p1.6.m4.1" class="ltx_Math" alttext="\gamma^{(t)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.6.m4.1a"><msup id="S3.SS0.SSS0.Px2.p1.6.m4.1.2" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.6.m4.1.2.2" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.2.cmml">γ</mi><mrow id="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.6.m4.1b"><apply id="S3.SS0.SSS0.Px2.p1.6.m4.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.6.m4.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.6.m4.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.2.2">𝛾</ci><ci id="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.6.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.6.m4.1c">\gamma^{(t)}</annotation></semantics></math>. Each client iteratively updates <math id="S3.SS0.SSS0.Px2.p1.7.m5.1" class="ltx_Math" alttext="\theta_{k}^{(t)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.7.m5.1a"><msubsup id="S3.SS0.SSS0.Px2.p1.7.m5.1.2" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.2" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.3" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.7.m5.1b"><apply id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.7.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.7.m5.1c">\theta_{k}^{(t)}</annotation></semantics></math> for a fixed number of local epochs <math id="S3.SS0.SSS0.Px2.p1.8.m6.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.8.m6.1a"><mi id="S3.SS0.SSS0.Px2.p1.8.m6.1.1" xref="S3.SS0.SSS0.Px2.p1.8.m6.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.8.m6.1b"><ci id="S3.SS0.SSS0.Px2.p1.8.m6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.8.m6.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.8.m6.1c">e</annotation></semantics></math>, as detailed in Algorithm <a href="#alg2" title="Algorithm 2 ‣ Local Optimization ‣ 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p2.1" class="ltx_p">After optimizing the local model, each client computes a weighting factor <math id="S3.SS0.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="\omega_{k}^{(t)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px2.p2.1.m1.1.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.2.cmml">ω</mi><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.2">𝜔</ci><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.1.m1.1c">\omega_{k}^{(t)}</annotation></semantics></math>, representing the importance of the client’s local model in the subsequent Global Aggregation step:</p>
</div>
<div id="S3.SS0.SSS0.Px2.p3" class="ltx_para">
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\omega_{k}^{(t)}=\mathbb{P}(Z_{k}|\theta_{k}^{(t+1)})\times\rho_{\gamma^{(t)}}(\theta_{k}^{(t+1)})" display="block"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml"><msubsup id="S3.E8.m1.6.6.4" xref="S3.E8.m1.6.6.4.cmml"><mi id="S3.E8.m1.6.6.4.2.2" xref="S3.E8.m1.6.6.4.2.2.cmml">ω</mi><mi id="S3.E8.m1.6.6.4.2.3" xref="S3.E8.m1.6.6.4.2.3.cmml">k</mi><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.6.6.4.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.3.1" xref="S3.E8.m1.6.6.4.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.6.6.4.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m1.6.6.3" xref="S3.E8.m1.6.6.3.cmml">=</mo><mrow id="S3.E8.m1.6.6.2" xref="S3.E8.m1.6.6.2.cmml"><mrow id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1" xref="S3.E8.m1.5.5.1.1.1.cmml"><mi id="S3.E8.m1.5.5.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.2.cmml">Z</mi><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo fence="false" id="S3.E8.m1.5.5.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="S3.E8.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">t</mi><mo id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml">+</mo><mn id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E8.m1.5.5.1.1.2" xref="S3.E8.m1.5.5.1.1.2.cmml">×</mo><msub id="S3.E8.m1.5.5.1.1.3" xref="S3.E8.m1.5.5.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.3.2" xref="S3.E8.m1.5.5.1.1.3.2.cmml">ρ</mi><msup id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.cmml"><mi id="S3.E8.m1.3.3.1.3" xref="S3.E8.m1.3.3.1.3.cmml">γ</mi><mrow id="S3.E8.m1.3.3.1.1.1.3" xref="S3.E8.m1.3.3.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.1.1.1.3.1" xref="S3.E8.m1.3.3.1.cmml">(</mo><mi id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E8.m1.3.3.1.1.1.3.2" xref="S3.E8.m1.3.3.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.2.3" xref="S3.E8.m1.6.6.2.3.cmml">​</mo><mrow id="S3.E8.m1.6.6.2.2.1" xref="S3.E8.m1.6.6.2.2.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.2.2.1.2" xref="S3.E8.m1.6.6.2.2.1.1.cmml">(</mo><msubsup id="S3.E8.m1.6.6.2.2.1.1" xref="S3.E8.m1.6.6.2.2.1.1.cmml"><mi id="S3.E8.m1.6.6.2.2.1.1.2.2" xref="S3.E8.m1.6.6.2.2.1.1.2.2.cmml">θ</mi><mi id="S3.E8.m1.6.6.2.2.1.1.2.3" xref="S3.E8.m1.6.6.2.2.1.1.2.3.cmml">k</mi><mrow id="S3.E8.m1.4.4.1.1" xref="S3.E8.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.4.4.1.1.2" xref="S3.E8.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.1.1.1" xref="S3.E8.m1.4.4.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.2.cmml">t</mi><mo id="S3.E8.m1.4.4.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.cmml">+</mo><mn id="S3.E8.m1.4.4.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m1.4.4.1.1.3" xref="S3.E8.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E8.m1.6.6.2.2.1.3" xref="S3.E8.m1.6.6.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6"><eq id="S3.E8.m1.6.6.3.cmml" xref="S3.E8.m1.6.6.3"></eq><apply id="S3.E8.m1.6.6.4.cmml" xref="S3.E8.m1.6.6.4"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.4.1.cmml" xref="S3.E8.m1.6.6.4">superscript</csymbol><apply id="S3.E8.m1.6.6.4.2.cmml" xref="S3.E8.m1.6.6.4"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.4.2.1.cmml" xref="S3.E8.m1.6.6.4">subscript</csymbol><ci id="S3.E8.m1.6.6.4.2.2.cmml" xref="S3.E8.m1.6.6.4.2.2">𝜔</ci><ci id="S3.E8.m1.6.6.4.2.3.cmml" xref="S3.E8.m1.6.6.4.2.3">𝑘</ci></apply><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E8.m1.6.6.2.cmml" xref="S3.E8.m1.6.6.2"><times id="S3.E8.m1.6.6.2.3.cmml" xref="S3.E8.m1.6.6.2.3"></times><apply id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1.1"><times id="S3.E8.m1.5.5.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1"><times id="S3.E8.m1.5.5.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.2"></times><ci id="S3.E8.m1.5.5.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.3">ℙ</ci><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.2">𝑍</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1"><plus id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"></plus><ci id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">1</cn></apply></apply></apply></apply><apply id="S3.E8.m1.5.5.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.3.2">𝜌</ci><apply id="S3.E8.m1.3.3.1.cmml" xref="S3.E8.m1.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.2.cmml" xref="S3.E8.m1.3.3.1">superscript</csymbol><ci id="S3.E8.m1.3.3.1.3.cmml" xref="S3.E8.m1.3.3.1.3">𝛾</ci><ci id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="S3.E8.m1.6.6.2.2.1.1.cmml" xref="S3.E8.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.2.2.1.1.1.cmml" xref="S3.E8.m1.6.6.2.2.1">superscript</csymbol><apply id="S3.E8.m1.6.6.2.2.1.1.2.cmml" xref="S3.E8.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.2.2.1.1.2.1.cmml" xref="S3.E8.m1.6.6.2.2.1">subscript</csymbol><ci id="S3.E8.m1.6.6.2.2.1.1.2.2.cmml" xref="S3.E8.m1.6.6.2.2.1.1.2.2">𝜃</ci><ci id="S3.E8.m1.6.6.2.2.1.1.2.3.cmml" xref="S3.E8.m1.6.6.2.2.1.1.2.3">𝑘</ci></apply><apply id="S3.E8.m1.4.4.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1"><plus id="S3.E8.m1.4.4.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1"></plus><ci id="S3.E8.m1.4.4.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E8.m1.4.4.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\omega_{k}^{(t)}=\mathbb{P}(Z_{k}|\theta_{k}^{(t+1)})\times\rho_{\gamma^{(t)}}(\theta_{k}^{(t+1)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS0.SSS0.Px2.p4" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p4.2" class="ltx_p">The locally optimized parameters <math id="S3.SS0.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px2.p4.1.m1.1.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1"><plus id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.1.m1.1c">\theta_{k}^{(t+1)}</annotation></semantics></math> and their corresponding weighting factor <math id="S3.SS0.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="\omega_{k}^{(t)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.2.m2.1a"><msubsup id="S3.SS0.SSS0.Px2.p4.2.m2.1.2" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.2" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.2.cmml">ω</mi><mi id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.3" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.2">𝜔</ci><ci id="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.2.m2.1c">\omega_{k}^{(t)}</annotation></semantics></math> are then sent to the server for global aggregation.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Local Optimization</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text ltx_font_bold">Input:</span>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><math id="alg2.l2.m1.1" class="ltx_Math" alttext="\theta^{(0)}" display="inline"><semantics id="alg2.l2.m1.1a"><msup id="alg2.l2.m1.1.2" xref="alg2.l2.m1.1.2.cmml"><mi id="alg2.l2.m1.1.2.2" xref="alg2.l2.m1.1.2.2.cmml">θ</mi><mrow id="alg2.l2.m1.1.1.1.3" xref="alg2.l2.m1.1.2.cmml"><mo stretchy="false" id="alg2.l2.m1.1.1.1.3.1" xref="alg2.l2.m1.1.2.cmml">(</mo><mn id="alg2.l2.m1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg2.l2.m1.1.1.1.3.2" xref="alg2.l2.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.2.cmml" xref="alg2.l2.m1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.2.1.cmml" xref="alg2.l2.m1.1.2">superscript</csymbol><ci id="alg2.l2.m1.1.2.2.cmml" xref="alg2.l2.m1.1.2.2">𝜃</ci><cn type="integer" id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\theta^{(0)}</annotation></semantics></math> The initial model parameter

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg2.l3.m1.1" class="ltx_Math" alttext="Z_{k}" display="inline"><semantics id="alg2.l3.m1.1a"><msub id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">Z</mi><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑍</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">Z_{k}</annotation></semantics></math><span id="alg2.l3.2" class="ltx_text ltx_font_bold">:</span> The local dataset for client <math id="alg2.l3.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.l3.m2.1a"><mi id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">k</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><math id="alg2.l4.m1.1" class="ltx_Math" alttext="\gamma^{(t)}" display="inline"><semantics id="alg2.l4.m1.1a"><msup id="alg2.l4.m1.1.2" xref="alg2.l4.m1.1.2.cmml"><mi id="alg2.l4.m1.1.2.2" xref="alg2.l4.m1.1.2.2.cmml">γ</mi><mrow id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.1.1.1.3.1" xref="alg2.l4.m1.1.2.cmml">(</mo><mi id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.2.cmml" xref="alg2.l4.m1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.2.1.cmml" xref="alg2.l4.m1.1.2">superscript</csymbol><ci id="alg2.l4.m1.1.2.2.cmml" xref="alg2.l4.m1.1.2.2">𝛾</ci><ci id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\gamma^{(t)}</annotation></semantics></math><span id="alg2.l4.2" class="ltx_text ltx_font_bold">: </span>Current global model parameter

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><math id="alg2.l5.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t)}" display="inline"><semantics id="alg2.l5.m1.1a"><msubsup id="alg2.l5.m1.1.2" xref="alg2.l5.m1.1.2.cmml"><mi id="alg2.l5.m1.1.2.2.2" xref="alg2.l5.m1.1.2.2.2.cmml">θ</mi><mi id="alg2.l5.m1.1.2.2.3" xref="alg2.l5.m1.1.2.2.3.cmml">k</mi><mrow id="alg2.l5.m1.1.1.1.3" xref="alg2.l5.m1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.3.1" xref="alg2.l5.m1.1.2.cmml">(</mo><mi id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l5.m1.1.1.1.3.2" xref="alg2.l5.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.2.cmml" xref="alg2.l5.m1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.2.1.cmml" xref="alg2.l5.m1.1.2">superscript</csymbol><apply id="alg2.l5.m1.1.2.2.cmml" xref="alg2.l5.m1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.2.2.1.cmml" xref="alg2.l5.m1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.2.2.2.cmml" xref="alg2.l5.m1.1.2.2.2">𝜃</ci><ci id="alg2.l5.m1.1.2.2.3.cmml" xref="alg2.l5.m1.1.2.2.3">𝑘</ci></apply><ci id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\theta_{k}^{(t)}</annotation></semantics></math><span id="alg2.l5.2" class="ltx_text ltx_font_bold">: </span>Current model parameters for client <math id="alg2.l5.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">i</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><math id="alg2.l6.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">e</annotation></semantics></math><span id="alg2.l6.2" class="ltx_text ltx_font_bold">: </span>Number of epochs per local optimization

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg2.l7.2" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l7.m1.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">t</mi><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">=</mo><mn id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><eq id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></eq><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">t=0</annotation></semantics></math> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <math id="alg2.l8.m1.2" class="ltx_Math" alttext="\theta_{i}^{(t)}\leftarrow\theta^{(0)}" display="inline"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.3" xref="alg2.l8.m1.2.3.cmml"><msubsup id="alg2.l8.m1.2.3.2" xref="alg2.l8.m1.2.3.2.cmml"><mi id="alg2.l8.m1.2.3.2.2.2" xref="alg2.l8.m1.2.3.2.2.2.cmml">θ</mi><mi id="alg2.l8.m1.2.3.2.2.3" xref="alg2.l8.m1.2.3.2.2.3.cmml">i</mi><mrow id="alg2.l8.m1.1.1.1.3" xref="alg2.l8.m1.2.3.2.cmml"><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.1" xref="alg2.l8.m1.2.3.2.cmml">(</mo><mi id="alg2.l8.m1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.2" xref="alg2.l8.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l8.m1.2.3.1" xref="alg2.l8.m1.2.3.1.cmml">←</mo><msup id="alg2.l8.m1.2.3.3" xref="alg2.l8.m1.2.3.3.cmml"><mi id="alg2.l8.m1.2.3.3.2" xref="alg2.l8.m1.2.3.3.2.cmml">θ</mi><mrow id="alg2.l8.m1.2.2.1.3" xref="alg2.l8.m1.2.3.3.cmml"><mo stretchy="false" id="alg2.l8.m1.2.2.1.3.1" xref="alg2.l8.m1.2.3.3.cmml">(</mo><mn id="alg2.l8.m1.2.2.1.1" xref="alg2.l8.m1.2.2.1.1.cmml">0</mn><mo stretchy="false" id="alg2.l8.m1.2.2.1.3.2" xref="alg2.l8.m1.2.3.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><apply id="alg2.l8.m1.2.3.cmml" xref="alg2.l8.m1.2.3"><ci id="alg2.l8.m1.2.3.1.cmml" xref="alg2.l8.m1.2.3.1">←</ci><apply id="alg2.l8.m1.2.3.2.cmml" xref="alg2.l8.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.2.1.cmml" xref="alg2.l8.m1.2.3.2">superscript</csymbol><apply id="alg2.l8.m1.2.3.2.2.cmml" xref="alg2.l8.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.2.2.1.cmml" xref="alg2.l8.m1.2.3.2">subscript</csymbol><ci id="alg2.l8.m1.2.3.2.2.2.cmml" xref="alg2.l8.m1.2.3.2.2.2">𝜃</ci><ci id="alg2.l8.m1.2.3.2.2.3.cmml" xref="alg2.l8.m1.2.3.2.2.3">𝑖</ci></apply><ci id="alg2.l8.m1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1">𝑡</ci></apply><apply id="alg2.l8.m1.2.3.3.cmml" xref="alg2.l8.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.1.cmml" xref="alg2.l8.m1.2.3.3">superscript</csymbol><ci id="alg2.l8.m1.2.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.2">𝜃</ci><cn type="integer" id="alg2.l8.m1.2.2.1.1.cmml" xref="alg2.l8.m1.2.2.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">\theta_{i}^{(t)}\leftarrow\theta^{(0)}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg2.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l9.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg2.l10.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l10.m1.1" class="ltx_Math" alttext="epoch=1" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mrow id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mi id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.3" xref="alg2.l10.m1.1.1.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1a" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.4" xref="alg2.l10.m1.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1b" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.5" xref="alg2.l10.m1.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.2.1c" xref="alg2.l10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.2.6" xref="alg2.l10.m1.1.1.2.6.cmml">h</mi></mrow><mo id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">=</mo><mn id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><eq id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"></eq><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><times id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2.1"></times><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">𝑒</ci><ci id="alg2.l10.m1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.2.3">𝑝</ci><ci id="alg2.l10.m1.1.1.2.4.cmml" xref="alg2.l10.m1.1.1.2.4">𝑜</ci><ci id="alg2.l10.m1.1.1.2.5.cmml" xref="alg2.l10.m1.1.1.2.5">𝑐</ci><ci id="alg2.l10.m1.1.1.2.6.cmml" xref="alg2.l10.m1.1.1.2.6">ℎ</ci></apply><cn type="integer" id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">epoch=1</annotation></semantics></math> to <math id="alg2.l10.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l10.m2.1a"><mi id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><ci id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">e</annotation></semantics></math> <span id="alg2.l10.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <math id="alg2.l11.m1.4" class="ltx_Math" alttext="\theta_{k}^{(t+1)}\leftarrow\arg\displaystyle\min_{\theta}-\log\mathbb{P}(Z_{k}|\theta)-\log\rho_{\gamma^{(t)}}(\theta)" display="inline"><semantics id="alg2.l11.m1.4a"><mrow id="alg2.l11.m1.4.4" xref="alg2.l11.m1.4.4.cmml"><msubsup id="alg2.l11.m1.4.4.3" xref="alg2.l11.m1.4.4.3.cmml"><mi id="alg2.l11.m1.4.4.3.2.2" xref="alg2.l11.m1.4.4.3.2.2.cmml">θ</mi><mi id="alg2.l11.m1.4.4.3.2.3" xref="alg2.l11.m1.4.4.3.2.3.cmml">k</mi><mrow id="alg2.l11.m1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l11.m1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l11.m1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.cmml"><mi id="alg2.l11.m1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg2.l11.m1.1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l11.m1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg2.l11.m1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l11.m1.4.4.2" xref="alg2.l11.m1.4.4.2.cmml">←</mo><mrow id="alg2.l11.m1.4.4.1" xref="alg2.l11.m1.4.4.1.cmml"><mrow id="alg2.l11.m1.4.4.1.3" xref="alg2.l11.m1.4.4.1.3.cmml"><mi id="alg2.l11.m1.4.4.1.3.1" xref="alg2.l11.m1.4.4.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="alg2.l11.m1.4.4.1.3a" xref="alg2.l11.m1.4.4.1.3.cmml">⁡</mo><munder id="alg2.l11.m1.4.4.1.3.2" xref="alg2.l11.m1.4.4.1.3.2.cmml"><mi id="alg2.l11.m1.4.4.1.3.2.2" xref="alg2.l11.m1.4.4.1.3.2.2.cmml">min</mi><mi id="alg2.l11.m1.4.4.1.3.2.3" xref="alg2.l11.m1.4.4.1.3.2.3.cmml">θ</mi></munder></mrow><mo lspace="0em" id="alg2.l11.m1.4.4.1.2" xref="alg2.l11.m1.4.4.1.2.cmml">−</mo><mrow id="alg2.l11.m1.4.4.1.1" xref="alg2.l11.m1.4.4.1.1.cmml"><mrow id="alg2.l11.m1.4.4.1.1.3" xref="alg2.l11.m1.4.4.1.1.3.cmml"><mi id="alg2.l11.m1.4.4.1.1.3.1" xref="alg2.l11.m1.4.4.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="alg2.l11.m1.4.4.1.1.3a" xref="alg2.l11.m1.4.4.1.1.3.cmml">⁡</mo><mi id="alg2.l11.m1.4.4.1.1.3.2" xref="alg2.l11.m1.4.4.1.1.3.2.cmml">ℙ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l11.m1.4.4.1.1.2" xref="alg2.l11.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg2.l11.m1.4.4.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l11.m1.4.4.1.1.1.1.2" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l11.m1.4.4.1.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml"><msub id="alg2.l11.m1.4.4.1.1.1.1.1.2" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.cmml"><mi id="alg2.l11.m1.4.4.1.1.1.1.1.2.2" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.2.cmml">Z</mi><mi id="alg2.l11.m1.4.4.1.1.1.1.1.2.3" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.3.cmml">k</mi></msub><mo fence="false" id="alg2.l11.m1.4.4.1.1.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.l11.m1.4.4.1.1.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.1.1.1.3.cmml">θ</mi></mrow><mo stretchy="false" id="alg2.l11.m1.4.4.1.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l11.m1.4.4.1.2a" xref="alg2.l11.m1.4.4.1.2.cmml">−</mo><mrow id="alg2.l11.m1.4.4.1.4" xref="alg2.l11.m1.4.4.1.4.cmml"><mrow id="alg2.l11.m1.4.4.1.4.2" xref="alg2.l11.m1.4.4.1.4.2.cmml"><mi id="alg2.l11.m1.4.4.1.4.2.1" xref="alg2.l11.m1.4.4.1.4.2.1.cmml">log</mi><mo lspace="0.167em" id="alg2.l11.m1.4.4.1.4.2a" xref="alg2.l11.m1.4.4.1.4.2.cmml">⁡</mo><msub id="alg2.l11.m1.4.4.1.4.2.2" xref="alg2.l11.m1.4.4.1.4.2.2.cmml"><mi id="alg2.l11.m1.4.4.1.4.2.2.2" xref="alg2.l11.m1.4.4.1.4.2.2.2.cmml">ρ</mi><msup id="alg2.l11.m1.2.2.1" xref="alg2.l11.m1.2.2.1.cmml"><mi id="alg2.l11.m1.2.2.1.3" xref="alg2.l11.m1.2.2.1.3.cmml">γ</mi><mrow id="alg2.l11.m1.2.2.1.1.1.3" xref="alg2.l11.m1.2.2.1.cmml"><mo stretchy="false" id="alg2.l11.m1.2.2.1.1.1.3.1" xref="alg2.l11.m1.2.2.1.cmml">(</mo><mi id="alg2.l11.m1.2.2.1.1.1.1" xref="alg2.l11.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l11.m1.2.2.1.1.1.3.2" xref="alg2.l11.m1.2.2.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l11.m1.4.4.1.4.1" xref="alg2.l11.m1.4.4.1.4.1.cmml">​</mo><mrow id="alg2.l11.m1.4.4.1.4.3.2" xref="alg2.l11.m1.4.4.1.4.cmml"><mo stretchy="false" id="alg2.l11.m1.4.4.1.4.3.2.1" xref="alg2.l11.m1.4.4.1.4.cmml">(</mo><mi id="alg2.l11.m1.3.3" xref="alg2.l11.m1.3.3.cmml">θ</mi><mo stretchy="false" id="alg2.l11.m1.4.4.1.4.3.2.2" xref="alg2.l11.m1.4.4.1.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.4b"><apply id="alg2.l11.m1.4.4.cmml" xref="alg2.l11.m1.4.4"><ci id="alg2.l11.m1.4.4.2.cmml" xref="alg2.l11.m1.4.4.2">←</ci><apply id="alg2.l11.m1.4.4.3.cmml" xref="alg2.l11.m1.4.4.3"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.3.1.cmml" xref="alg2.l11.m1.4.4.3">superscript</csymbol><apply id="alg2.l11.m1.4.4.3.2.cmml" xref="alg2.l11.m1.4.4.3"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.3.2.1.cmml" xref="alg2.l11.m1.4.4.3">subscript</csymbol><ci id="alg2.l11.m1.4.4.3.2.2.cmml" xref="alg2.l11.m1.4.4.3.2.2">𝜃</ci><ci id="alg2.l11.m1.4.4.3.2.3.cmml" xref="alg2.l11.m1.4.4.3.2.3">𝑘</ci></apply><apply id="alg2.l11.m1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1"><plus id="alg2.l11.m1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.1"></plus><ci id="alg2.l11.m1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l11.m1.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg2.l11.m1.4.4.1.cmml" xref="alg2.l11.m1.4.4.1"><minus id="alg2.l11.m1.4.4.1.2.cmml" xref="alg2.l11.m1.4.4.1.2"></minus><apply id="alg2.l11.m1.4.4.1.3.cmml" xref="alg2.l11.m1.4.4.1.3"><arg id="alg2.l11.m1.4.4.1.3.1.cmml" xref="alg2.l11.m1.4.4.1.3.1"></arg><apply id="alg2.l11.m1.4.4.1.3.2.cmml" xref="alg2.l11.m1.4.4.1.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.3.2.1.cmml" xref="alg2.l11.m1.4.4.1.3.2">subscript</csymbol><min id="alg2.l11.m1.4.4.1.3.2.2.cmml" xref="alg2.l11.m1.4.4.1.3.2.2"></min><ci id="alg2.l11.m1.4.4.1.3.2.3.cmml" xref="alg2.l11.m1.4.4.1.3.2.3">𝜃</ci></apply></apply><apply id="alg2.l11.m1.4.4.1.1.cmml" xref="alg2.l11.m1.4.4.1.1"><times id="alg2.l11.m1.4.4.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.2"></times><apply id="alg2.l11.m1.4.4.1.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.3"><log id="alg2.l11.m1.4.4.1.1.3.1.cmml" xref="alg2.l11.m1.4.4.1.1.3.1"></log><ci id="alg2.l11.m1.4.4.1.1.3.2.cmml" xref="alg2.l11.m1.4.4.1.1.3.2">ℙ</ci></apply><apply id="alg2.l11.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="alg2.l11.m1.4.4.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.1">conditional</csymbol><apply id="alg2.l11.m1.4.4.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.1.1.1.1.2.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l11.m1.4.4.1.1.1.1.1.2.2.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.2">𝑍</ci><ci id="alg2.l11.m1.4.4.1.1.1.1.1.2.3.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l11.m1.4.4.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.3">𝜃</ci></apply></apply><apply id="alg2.l11.m1.4.4.1.4.cmml" xref="alg2.l11.m1.4.4.1.4"><times id="alg2.l11.m1.4.4.1.4.1.cmml" xref="alg2.l11.m1.4.4.1.4.1"></times><apply id="alg2.l11.m1.4.4.1.4.2.cmml" xref="alg2.l11.m1.4.4.1.4.2"><log id="alg2.l11.m1.4.4.1.4.2.1.cmml" xref="alg2.l11.m1.4.4.1.4.2.1"></log><apply id="alg2.l11.m1.4.4.1.4.2.2.cmml" xref="alg2.l11.m1.4.4.1.4.2.2"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.4.2.2.1.cmml" xref="alg2.l11.m1.4.4.1.4.2.2">subscript</csymbol><ci id="alg2.l11.m1.4.4.1.4.2.2.2.cmml" xref="alg2.l11.m1.4.4.1.4.2.2.2">𝜌</ci><apply id="alg2.l11.m1.2.2.1.cmml" xref="alg2.l11.m1.2.2.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.1.2.cmml" xref="alg2.l11.m1.2.2.1">superscript</csymbol><ci id="alg2.l11.m1.2.2.1.3.cmml" xref="alg2.l11.m1.2.2.1.3">𝛾</ci><ci id="alg2.l11.m1.2.2.1.1.1.1.cmml" xref="alg2.l11.m1.2.2.1.1.1.1">𝑡</ci></apply></apply></apply><ci id="alg2.l11.m1.3.3.cmml" xref="alg2.l11.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.4c">\theta_{k}^{(t+1)}\leftarrow\arg\displaystyle\min_{\theta}-\log\mathbb{P}(Z_{k}|\theta)-\log\rho_{\gamma^{(t)}}(\theta)</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg2.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><math id="alg2.l13.m1.6" class="ltx_Math" alttext="\omega_{k}^{(t)}\leftarrow\mathbb{P}(Z_{k}|\theta_{k}^{(t+1)})\times\rho_{\gamma^{(t)}}(\theta_{k}^{(t+1)})" display="inline"><semantics id="alg2.l13.m1.6a"><mrow id="alg2.l13.m1.6.6" xref="alg2.l13.m1.6.6.cmml"><msubsup id="alg2.l13.m1.6.6.4" xref="alg2.l13.m1.6.6.4.cmml"><mi id="alg2.l13.m1.6.6.4.2.2" xref="alg2.l13.m1.6.6.4.2.2.cmml">ω</mi><mi id="alg2.l13.m1.6.6.4.2.3" xref="alg2.l13.m1.6.6.4.2.3.cmml">k</mi><mrow id="alg2.l13.m1.1.1.1.3" xref="alg2.l13.m1.6.6.4.cmml"><mo stretchy="false" id="alg2.l13.m1.1.1.1.3.1" xref="alg2.l13.m1.6.6.4.cmml">(</mo><mi id="alg2.l13.m1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l13.m1.1.1.1.3.2" xref="alg2.l13.m1.6.6.4.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l13.m1.6.6.3" xref="alg2.l13.m1.6.6.3.cmml">←</mo><mrow id="alg2.l13.m1.6.6.2" xref="alg2.l13.m1.6.6.2.cmml"><mrow id="alg2.l13.m1.5.5.1.1" xref="alg2.l13.m1.5.5.1.1.cmml"><mrow id="alg2.l13.m1.5.5.1.1.1" xref="alg2.l13.m1.5.5.1.1.1.cmml"><mi id="alg2.l13.m1.5.5.1.1.1.3" xref="alg2.l13.m1.5.5.1.1.1.3.cmml">ℙ</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.5.5.1.1.1.2" xref="alg2.l13.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="alg2.l13.m1.5.5.1.1.1.1.1" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l13.m1.5.5.1.1.1.1.1.2" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.5.5.1.1.1.1.1.1" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.cmml"><msub id="alg2.l13.m1.5.5.1.1.1.1.1.1.2" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.2" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2.2.cmml">Z</mi><mi id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.3" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo fence="false" id="alg2.l13.m1.5.5.1.1.1.1.1.1.1" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="alg2.l13.m1.5.5.1.1.1.1.1.1.3" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.2" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.3" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">k</mi><mrow id="alg2.l13.m1.2.2.1.1" xref="alg2.l13.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg2.l13.m1.2.2.1.1.2" xref="alg2.l13.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.2.2.1.1.1" xref="alg2.l13.m1.2.2.1.1.1.cmml"><mi id="alg2.l13.m1.2.2.1.1.1.2" xref="alg2.l13.m1.2.2.1.1.1.2.cmml">t</mi><mo id="alg2.l13.m1.2.2.1.1.1.1" xref="alg2.l13.m1.2.2.1.1.1.1.cmml">+</mo><mn id="alg2.l13.m1.2.2.1.1.1.3" xref="alg2.l13.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg2.l13.m1.2.2.1.1.3" xref="alg2.l13.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="alg2.l13.m1.5.5.1.1.1.1.1.3" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="alg2.l13.m1.5.5.1.1.2" xref="alg2.l13.m1.5.5.1.1.2.cmml">×</mo><msub id="alg2.l13.m1.5.5.1.1.3" xref="alg2.l13.m1.5.5.1.1.3.cmml"><mi id="alg2.l13.m1.5.5.1.1.3.2" xref="alg2.l13.m1.5.5.1.1.3.2.cmml">ρ</mi><msup id="alg2.l13.m1.3.3.1" xref="alg2.l13.m1.3.3.1.cmml"><mi id="alg2.l13.m1.3.3.1.3" xref="alg2.l13.m1.3.3.1.3.cmml">γ</mi><mrow id="alg2.l13.m1.3.3.1.1.1.3" xref="alg2.l13.m1.3.3.1.cmml"><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.3.1" xref="alg2.l13.m1.3.3.1.cmml">(</mo><mi id="alg2.l13.m1.3.3.1.1.1.1" xref="alg2.l13.m1.3.3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l13.m1.3.3.1.1.1.3.2" xref="alg2.l13.m1.3.3.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l13.m1.6.6.2.3" xref="alg2.l13.m1.6.6.2.3.cmml">​</mo><mrow id="alg2.l13.m1.6.6.2.2.1" xref="alg2.l13.m1.6.6.2.2.1.1.cmml"><mo stretchy="false" id="alg2.l13.m1.6.6.2.2.1.2" xref="alg2.l13.m1.6.6.2.2.1.1.cmml">(</mo><msubsup id="alg2.l13.m1.6.6.2.2.1.1" xref="alg2.l13.m1.6.6.2.2.1.1.cmml"><mi id="alg2.l13.m1.6.6.2.2.1.1.2.2" xref="alg2.l13.m1.6.6.2.2.1.1.2.2.cmml">θ</mi><mi id="alg2.l13.m1.6.6.2.2.1.1.2.3" xref="alg2.l13.m1.6.6.2.2.1.1.2.3.cmml">k</mi><mrow id="alg2.l13.m1.4.4.1.1" xref="alg2.l13.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="alg2.l13.m1.4.4.1.1.2" xref="alg2.l13.m1.4.4.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.4.4.1.1.1" xref="alg2.l13.m1.4.4.1.1.1.cmml"><mi id="alg2.l13.m1.4.4.1.1.1.2" xref="alg2.l13.m1.4.4.1.1.1.2.cmml">t</mi><mo id="alg2.l13.m1.4.4.1.1.1.1" xref="alg2.l13.m1.4.4.1.1.1.1.cmml">+</mo><mn id="alg2.l13.m1.4.4.1.1.1.3" xref="alg2.l13.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg2.l13.m1.4.4.1.1.3" xref="alg2.l13.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg2.l13.m1.6.6.2.2.1.3" xref="alg2.l13.m1.6.6.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.6b"><apply id="alg2.l13.m1.6.6.cmml" xref="alg2.l13.m1.6.6"><ci id="alg2.l13.m1.6.6.3.cmml" xref="alg2.l13.m1.6.6.3">←</ci><apply id="alg2.l13.m1.6.6.4.cmml" xref="alg2.l13.m1.6.6.4"><csymbol cd="ambiguous" id="alg2.l13.m1.6.6.4.1.cmml" xref="alg2.l13.m1.6.6.4">superscript</csymbol><apply id="alg2.l13.m1.6.6.4.2.cmml" xref="alg2.l13.m1.6.6.4"><csymbol cd="ambiguous" id="alg2.l13.m1.6.6.4.2.1.cmml" xref="alg2.l13.m1.6.6.4">subscript</csymbol><ci id="alg2.l13.m1.6.6.4.2.2.cmml" xref="alg2.l13.m1.6.6.4.2.2">𝜔</ci><ci id="alg2.l13.m1.6.6.4.2.3.cmml" xref="alg2.l13.m1.6.6.4.2.3">𝑘</ci></apply><ci id="alg2.l13.m1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1">𝑡</ci></apply><apply id="alg2.l13.m1.6.6.2.cmml" xref="alg2.l13.m1.6.6.2"><times id="alg2.l13.m1.6.6.2.3.cmml" xref="alg2.l13.m1.6.6.2.3"></times><apply id="alg2.l13.m1.5.5.1.1.cmml" xref="alg2.l13.m1.5.5.1.1"><times id="alg2.l13.m1.5.5.1.1.2.cmml" xref="alg2.l13.m1.5.5.1.1.2"></times><apply id="alg2.l13.m1.5.5.1.1.1.cmml" xref="alg2.l13.m1.5.5.1.1.1"><times id="alg2.l13.m1.5.5.1.1.1.2.cmml" xref="alg2.l13.m1.5.5.1.1.1.2"></times><ci id="alg2.l13.m1.5.5.1.1.1.3.cmml" xref="alg2.l13.m1.5.5.1.1.1.3">ℙ</ci><apply id="alg2.l13.m1.5.5.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l13.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2.2">𝑍</ci><ci id="alg2.l13.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l13.m1.5.5.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="alg2.l13.m1.2.2.1.1.1.cmml" xref="alg2.l13.m1.2.2.1.1"><plus id="alg2.l13.m1.2.2.1.1.1.1.cmml" xref="alg2.l13.m1.2.2.1.1.1.1"></plus><ci id="alg2.l13.m1.2.2.1.1.1.2.cmml" xref="alg2.l13.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l13.m1.2.2.1.1.1.3.cmml" xref="alg2.l13.m1.2.2.1.1.1.3">1</cn></apply></apply></apply></apply><apply id="alg2.l13.m1.5.5.1.1.3.cmml" xref="alg2.l13.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.5.5.1.1.3.1.cmml" xref="alg2.l13.m1.5.5.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.5.5.1.1.3.2.cmml" xref="alg2.l13.m1.5.5.1.1.3.2">𝜌</ci><apply id="alg2.l13.m1.3.3.1.cmml" xref="alg2.l13.m1.3.3.1"><csymbol cd="ambiguous" id="alg2.l13.m1.3.3.1.2.cmml" xref="alg2.l13.m1.3.3.1">superscript</csymbol><ci id="alg2.l13.m1.3.3.1.3.cmml" xref="alg2.l13.m1.3.3.1.3">𝛾</ci><ci id="alg2.l13.m1.3.3.1.1.1.1.cmml" xref="alg2.l13.m1.3.3.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="alg2.l13.m1.6.6.2.2.1.1.cmml" xref="alg2.l13.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="alg2.l13.m1.6.6.2.2.1.1.1.cmml" xref="alg2.l13.m1.6.6.2.2.1">superscript</csymbol><apply id="alg2.l13.m1.6.6.2.2.1.1.2.cmml" xref="alg2.l13.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="alg2.l13.m1.6.6.2.2.1.1.2.1.cmml" xref="alg2.l13.m1.6.6.2.2.1">subscript</csymbol><ci id="alg2.l13.m1.6.6.2.2.1.1.2.2.cmml" xref="alg2.l13.m1.6.6.2.2.1.1.2.2">𝜃</ci><ci id="alg2.l13.m1.6.6.2.2.1.1.2.3.cmml" xref="alg2.l13.m1.6.6.2.2.1.1.2.3">𝑘</ci></apply><apply id="alg2.l13.m1.4.4.1.1.1.cmml" xref="alg2.l13.m1.4.4.1.1"><plus id="alg2.l13.m1.4.4.1.1.1.1.cmml" xref="alg2.l13.m1.4.4.1.1.1.1"></plus><ci id="alg2.l13.m1.4.4.1.1.1.2.cmml" xref="alg2.l13.m1.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l13.m1.4.4.1.1.1.3.cmml" xref="alg2.l13.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.6c">\omega_{k}^{(t)}\leftarrow\mathbb{P}(Z_{k}|\theta_{k}^{(t+1)})\times\rho_{\gamma^{(t)}}(\theta_{k}^{(t+1)})</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>Send <math id="alg2.l14.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="alg2.l14.m1.1a"><msubsup id="alg2.l14.m1.1.2" xref="alg2.l14.m1.1.2.cmml"><mi id="alg2.l14.m1.1.2.2.2" xref="alg2.l14.m1.1.2.2.2.cmml">θ</mi><mi id="alg2.l14.m1.1.2.2.3" xref="alg2.l14.m1.1.2.2.3.cmml">k</mi><mrow id="alg2.l14.m1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l14.m1.1.1.1.1.2" xref="alg2.l14.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l14.m1.1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.cmml"><mi id="alg2.l14.m1.1.1.1.1.1.2" xref="alg2.l14.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg2.l14.m1.1.1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l14.m1.1.1.1.1.1.3" xref="alg2.l14.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg2.l14.m1.1.1.1.1.3" xref="alg2.l14.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.2.cmml" xref="alg2.l14.m1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.2.1.cmml" xref="alg2.l14.m1.1.2">superscript</csymbol><apply id="alg2.l14.m1.1.2.2.cmml" xref="alg2.l14.m1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.2.2.1.cmml" xref="alg2.l14.m1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.2.2.2.cmml" xref="alg2.l14.m1.1.2.2.2">𝜃</ci><ci id="alg2.l14.m1.1.2.2.3.cmml" xref="alg2.l14.m1.1.2.2.3">𝑘</ci></apply><apply id="alg2.l14.m1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1"><plus id="alg2.l14.m1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1.1.1"></plus><ci id="alg2.l14.m1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l14.m1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">\theta_{k}^{(t+1)}</annotation></semantics></math> and <math id="alg2.l14.m2.1" class="ltx_Math" alttext="\omega_{k}^{(t)}" display="inline"><semantics id="alg2.l14.m2.1a"><msubsup id="alg2.l14.m2.1.2" xref="alg2.l14.m2.1.2.cmml"><mi id="alg2.l14.m2.1.2.2.2" xref="alg2.l14.m2.1.2.2.2.cmml">ω</mi><mi id="alg2.l14.m2.1.2.2.3" xref="alg2.l14.m2.1.2.2.3.cmml">k</mi><mrow id="alg2.l14.m2.1.1.1.3" xref="alg2.l14.m2.1.2.cmml"><mo stretchy="false" id="alg2.l14.m2.1.1.1.3.1" xref="alg2.l14.m2.1.2.cmml">(</mo><mi id="alg2.l14.m2.1.1.1.1" xref="alg2.l14.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg2.l14.m2.1.1.1.3.2" xref="alg2.l14.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><apply id="alg2.l14.m2.1.2.cmml" xref="alg2.l14.m2.1.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.2.1.cmml" xref="alg2.l14.m2.1.2">superscript</csymbol><apply id="alg2.l14.m2.1.2.2.cmml" xref="alg2.l14.m2.1.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.2.2.1.cmml" xref="alg2.l14.m2.1.2">subscript</csymbol><ci id="alg2.l14.m2.1.2.2.2.cmml" xref="alg2.l14.m2.1.2.2.2">𝜔</ci><ci id="alg2.l14.m2.1.2.2.3.cmml" xref="alg2.l14.m2.1.2.2.3">𝑘</ci></apply><ci id="alg2.l14.m2.1.1.1.1.cmml" xref="alg2.l14.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\omega_{k}^{(t)}</annotation></semantics></math> to the server

</div>
</div>
</figure>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Global Aggregation</h4>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p1.4" class="ltx_p">The server aggregates the optimized local model parameters <math id="S3.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.1.m1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1"><plus id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.1.m1.1c">\theta_{k}^{(t+1)}</annotation></semantics></math> from all clients to obtain the updated global model parameters <math id="S3.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\gamma^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.2.m2.1a"><msup id="S3.SS0.SSS0.Px3.p1.2.m2.1.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.2.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.2.2.cmml">γ</mi><mrow id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px3.p1.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.2.2">𝛾</ci><apply id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1"><plus id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.2.m2.1c">\gamma^{(t+1)}</annotation></semantics></math>, as shown in Algorithm <a href="#alg3" title="Algorithm 3 ‣ Global Aggregation ‣ 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In view of (<a href="#S2.E3" title="In 2.2 Estimating the prior during aggregation ‣ 2 From MLE to MAP estimator ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and the specific form of <math id="S3.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\rho_{\gamma}(\theta)" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px3.p1.3.m3.1.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.cmml"><msub id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.2.cmml">ρ</mi><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.3" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.3.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.3.2.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.3.2.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2"><times id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.1"></times><apply id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.2">𝜌</ci><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.2.2.3">𝛾</ci></apply><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.3.m3.1c">\rho_{\gamma}(\theta)</annotation></semantics></math> in (<a href="#S3.E5" title="In 3 Proposed FedMAP algorithm ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), the aggregation is performed as a weighted average of the local model parameters, where the weights are the weighting factors <math id="S3.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="\omega_{k}^{(t)}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.4.m4.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.4.m4.1.2" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.2" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.2.cmml">ω</mi><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.3" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.3.1" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.1" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.3.2" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.2">𝜔</ci><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.4.m4.1c">\omega_{k}^{(t)}</annotation></semantics></math> computed in the Local Optimization step:</p>
</div>
<div id="S3.SS0.SSS0.Px3.p2" class="ltx_para">
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.4" class="ltx_Math" alttext="\gamma^{(t+1)}=\frac{1}{\sum_{j=1}^{q}\omega_{j}^{(t)}}\sum_{k=1}^{q}\omega_{k}^{(t)}\theta_{k}^{(t+1)}" display="block"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.5" xref="S3.E9.m1.4.5.cmml"><msup id="S3.E9.m1.4.5.2" xref="S3.E9.m1.4.5.2.cmml"><mi id="S3.E9.m1.4.5.2.2" xref="S3.E9.m1.4.5.2.2.cmml">γ</mi><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E9.m1.4.5.1" xref="S3.E9.m1.4.5.1.cmml">=</mo><mrow id="S3.E9.m1.4.5.3" xref="S3.E9.m1.4.5.3.cmml"><mfrac id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mn id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml">1</mn><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.cmml"><msubsup id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.2.cmml"><mo id="S3.E9.m1.2.2.1.2.2.2" xref="S3.E9.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.2.2.1.2.2.3" xref="S3.E9.m1.2.2.1.2.2.3.cmml"><mi id="S3.E9.m1.2.2.1.2.2.3.2" xref="S3.E9.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="S3.E9.m1.2.2.1.2.2.3.1" xref="S3.E9.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.2.2.1.2.2.3.3" xref="S3.E9.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.2.2.1.2.3" xref="S3.E9.m1.2.2.1.2.3.cmml">q</mi></msubsup><msubsup id="S3.E9.m1.2.2.1.3" xref="S3.E9.m1.2.2.1.3.cmml"><mi id="S3.E9.m1.2.2.1.3.2.2" xref="S3.E9.m1.2.2.1.3.2.2.cmml">ω</mi><mi id="S3.E9.m1.2.2.1.3.2.3" xref="S3.E9.m1.2.2.1.3.2.3.cmml">j</mi><mrow id="S3.E9.m1.2.2.1.1.1.3" xref="S3.E9.m1.2.2.1.3.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.3.1" xref="S3.E9.m1.2.2.1.3.cmml">(</mo><mi id="S3.E9.m1.2.2.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.1.1.3.2" xref="S3.E9.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.3.1" xref="S3.E9.m1.4.5.3.1.cmml">​</mo><mrow id="S3.E9.m1.4.5.3.2" xref="S3.E9.m1.4.5.3.2.cmml"><munderover id="S3.E9.m1.4.5.3.2.1" xref="S3.E9.m1.4.5.3.2.1.cmml"><mo movablelimits="false" id="S3.E9.m1.4.5.3.2.1.2.2" xref="S3.E9.m1.4.5.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E9.m1.4.5.3.2.1.2.3" xref="S3.E9.m1.4.5.3.2.1.2.3.cmml"><mi id="S3.E9.m1.4.5.3.2.1.2.3.2" xref="S3.E9.m1.4.5.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E9.m1.4.5.3.2.1.2.3.1" xref="S3.E9.m1.4.5.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E9.m1.4.5.3.2.1.2.3.3" xref="S3.E9.m1.4.5.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.4.5.3.2.1.3" xref="S3.E9.m1.4.5.3.2.1.3.cmml">q</mi></munderover><mrow id="S3.E9.m1.4.5.3.2.2" xref="S3.E9.m1.4.5.3.2.2.cmml"><msubsup id="S3.E9.m1.4.5.3.2.2.2" xref="S3.E9.m1.4.5.3.2.2.2.cmml"><mi id="S3.E9.m1.4.5.3.2.2.2.2.2" xref="S3.E9.m1.4.5.3.2.2.2.2.2.cmml">ω</mi><mi id="S3.E9.m1.4.5.3.2.2.2.2.3" xref="S3.E9.m1.4.5.3.2.2.2.2.3.cmml">k</mi><mrow id="S3.E9.m1.3.3.1.3" xref="S3.E9.m1.4.5.3.2.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.3.1" xref="S3.E9.m1.4.5.3.2.2.2.cmml">(</mo><mi id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S3.E9.m1.3.3.1.3.2" xref="S3.E9.m1.4.5.3.2.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.5.3.2.2.1" xref="S3.E9.m1.4.5.3.2.2.1.cmml">​</mo><msubsup id="S3.E9.m1.4.5.3.2.2.3" xref="S3.E9.m1.4.5.3.2.2.3.cmml"><mi id="S3.E9.m1.4.5.3.2.2.3.2.2" xref="S3.E9.m1.4.5.3.2.2.3.2.2.cmml">θ</mi><mi id="S3.E9.m1.4.5.3.2.2.3.2.3" xref="S3.E9.m1.4.5.3.2.2.3.2.3.cmml">k</mi><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.1.1.2" xref="S3.E9.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.2.cmml">t</mi><mo id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml">+</mo><mn id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9.m1.4.4.1.1.3" xref="S3.E9.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.5.cmml" xref="S3.E9.m1.4.5"><eq id="S3.E9.m1.4.5.1.cmml" xref="S3.E9.m1.4.5.1"></eq><apply id="S3.E9.m1.4.5.2.cmml" xref="S3.E9.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.2.1.cmml" xref="S3.E9.m1.4.5.2">superscript</csymbol><ci id="S3.E9.m1.4.5.2.2.cmml" xref="S3.E9.m1.4.5.2.2">𝛾</ci><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"></plus><ci id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E9.m1.4.5.3.cmml" xref="S3.E9.m1.4.5.3"><times id="S3.E9.m1.4.5.3.1.cmml" xref="S3.E9.m1.4.5.3.1"></times><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><divide id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2"></divide><cn type="integer" id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3">1</cn><apply id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.2.2.1"><apply id="S3.E9.m1.2.2.1.2.cmml" xref="S3.E9.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.2.1.cmml" xref="S3.E9.m1.2.2.1.2">superscript</csymbol><apply id="S3.E9.m1.2.2.1.2.2.cmml" xref="S3.E9.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.2.2.1.cmml" xref="S3.E9.m1.2.2.1.2">subscript</csymbol><sum id="S3.E9.m1.2.2.1.2.2.2.cmml" xref="S3.E9.m1.2.2.1.2.2.2"></sum><apply id="S3.E9.m1.2.2.1.2.2.3.cmml" xref="S3.E9.m1.2.2.1.2.2.3"><eq id="S3.E9.m1.2.2.1.2.2.3.1.cmml" xref="S3.E9.m1.2.2.1.2.2.3.1"></eq><ci id="S3.E9.m1.2.2.1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E9.m1.2.2.1.2.2.3.3.cmml" xref="S3.E9.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.2.2.1.2.3.cmml" xref="S3.E9.m1.2.2.1.2.3">𝑞</ci></apply><apply id="S3.E9.m1.2.2.1.3.cmml" xref="S3.E9.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.3.1.cmml" xref="S3.E9.m1.2.2.1.3">superscript</csymbol><apply id="S3.E9.m1.2.2.1.3.2.cmml" xref="S3.E9.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.3.2.1.cmml" xref="S3.E9.m1.2.2.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.1.3.2.2.cmml" xref="S3.E9.m1.2.2.1.3.2.2">𝜔</ci><ci id="S3.E9.m1.2.2.1.3.2.3.cmml" xref="S3.E9.m1.2.2.1.3.2.3">𝑗</ci></apply><ci id="S3.E9.m1.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="S3.E9.m1.4.5.3.2.cmml" xref="S3.E9.m1.4.5.3.2"><apply id="S3.E9.m1.4.5.3.2.1.cmml" xref="S3.E9.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.1.1.cmml" xref="S3.E9.m1.4.5.3.2.1">superscript</csymbol><apply id="S3.E9.m1.4.5.3.2.1.2.cmml" xref="S3.E9.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.1.2.1.cmml" xref="S3.E9.m1.4.5.3.2.1">subscript</csymbol><sum id="S3.E9.m1.4.5.3.2.1.2.2.cmml" xref="S3.E9.m1.4.5.3.2.1.2.2"></sum><apply id="S3.E9.m1.4.5.3.2.1.2.3.cmml" xref="S3.E9.m1.4.5.3.2.1.2.3"><eq id="S3.E9.m1.4.5.3.2.1.2.3.1.cmml" xref="S3.E9.m1.4.5.3.2.1.2.3.1"></eq><ci id="S3.E9.m1.4.5.3.2.1.2.3.2.cmml" xref="S3.E9.m1.4.5.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E9.m1.4.5.3.2.1.2.3.3.cmml" xref="S3.E9.m1.4.5.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.4.5.3.2.1.3.cmml" xref="S3.E9.m1.4.5.3.2.1.3">𝑞</ci></apply><apply id="S3.E9.m1.4.5.3.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2"><times id="S3.E9.m1.4.5.3.2.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2.1"></times><apply id="S3.E9.m1.4.5.3.2.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2.2">superscript</csymbol><apply id="S3.E9.m1.4.5.3.2.2.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.2.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2.2">subscript</csymbol><ci id="S3.E9.m1.4.5.3.2.2.2.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2.2.2.2">𝜔</ci><ci id="S3.E9.m1.4.5.3.2.2.2.2.3.cmml" xref="S3.E9.m1.4.5.3.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">𝑡</ci></apply><apply id="S3.E9.m1.4.5.3.2.2.3.cmml" xref="S3.E9.m1.4.5.3.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.3.1.cmml" xref="S3.E9.m1.4.5.3.2.2.3">superscript</csymbol><apply id="S3.E9.m1.4.5.3.2.2.3.2.cmml" xref="S3.E9.m1.4.5.3.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.5.3.2.2.3.2.1.cmml" xref="S3.E9.m1.4.5.3.2.2.3">subscript</csymbol><ci id="S3.E9.m1.4.5.3.2.2.3.2.2.cmml" xref="S3.E9.m1.4.5.3.2.2.3.2.2">𝜃</ci><ci id="S3.E9.m1.4.5.3.2.2.3.2.3.cmml" xref="S3.E9.m1.4.5.3.2.2.3.2.3">𝑘</ci></apply><apply id="S3.E9.m1.4.4.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1"><plus id="S3.E9.m1.4.4.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1"></plus><ci id="S3.E9.m1.4.4.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E9.m1.4.4.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\gamma^{(t+1)}=\frac{1}{\sum_{j=1}^{q}\omega_{j}^{(t)}}\sum_{k=1}^{q}\omega_{k}^{(t)}\theta_{k}^{(t+1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS0.SSS0.Px3.p3" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p3.1" class="ltx_p">The updated global model <math id="S3.SS0.SSS0.Px3.p3.1.m1.1" class="ltx_Math" alttext="\gamma^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.1.m1.1a"><msup id="S3.SS0.SSS0.Px3.p3.1.m1.1.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.1.m1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.2.2.cmml">γ</mi><mrow id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p3.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.1.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.1.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.2.2">𝛾</ci><apply id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1"><plus id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.1.m1.1c">\gamma^{(t+1)}</annotation></semantics></math> is then broadcast to all clients for the next round of Local Optimization.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p4" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p4.2" class="ltx_p">Local Optimization and Global Aggregation steps are repeated iteratively until a predefined number of communication rounds is reached. After the iterative process is complete, the final personalized model for each client <math id="S3.SS0.SSS0.Px3.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.1.m1.1a"><mi id="S3.SS0.SSS0.Px3.p4.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.1.m1.1b"><ci id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.1.m1.1c">k</annotation></semantics></math> is given by the optimized local model parameters <math id="S3.SS0.SSS0.Px3.p4.2.m2.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.2.m2.1a"><msubsup id="S3.SS0.SSS0.Px3.p4.2.m2.1.2" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.2" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.3" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.2.m2.1b"><apply id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.2">𝜃</ci><ci id="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.2.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1"><plus id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.2.m2.1c">\theta_{k}^{(t+1)}</annotation></semantics></math>. These personalized models capture the unique characteristics of each client’s data while benefiting from the collective knowledge of all clients through the regularization effect of the global model.</p>
</div>
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Global Aggregation</figcaption>
<div id="alg3.3" class="ltx_listing ltx_listing">
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg3.l1.2" class="ltx_text ltx_font_bold">Input:</span>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><math id="alg3.l2.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg3.l2.m1.1a"><mi id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><ci id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">q</annotation></semantics></math><span id="alg3.l2.2" class="ltx_text ltx_font_bold">: </span>Total number of clients

</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg3.l3.m1.1" class="ltx_Math" alttext="\theta_{k}^{(t+1)}" display="inline"><semantics id="alg3.l3.m1.1a"><msubsup id="alg3.l3.m1.1.2" xref="alg3.l3.m1.1.2.cmml"><mi id="alg3.l3.m1.1.2.2.2" xref="alg3.l3.m1.1.2.2.2.cmml">θ</mi><mi id="alg3.l3.m1.1.2.2.3" xref="alg3.l3.m1.1.2.2.3.cmml">k</mi><mrow id="alg3.l3.m1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l3.m1.1.1.1.1.2" xref="alg3.l3.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l3.m1.1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.cmml"><mi id="alg3.l3.m1.1.1.1.1.1.2" xref="alg3.l3.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg3.l3.m1.1.1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg3.l3.m1.1.1.1.1.1.3" xref="alg3.l3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg3.l3.m1.1.1.1.1.3" xref="alg3.l3.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><apply id="alg3.l3.m1.1.2.cmml" xref="alg3.l3.m1.1.2"><csymbol cd="ambiguous" id="alg3.l3.m1.1.2.1.cmml" xref="alg3.l3.m1.1.2">superscript</csymbol><apply id="alg3.l3.m1.1.2.2.cmml" xref="alg3.l3.m1.1.2"><csymbol cd="ambiguous" id="alg3.l3.m1.1.2.2.1.cmml" xref="alg3.l3.m1.1.2">subscript</csymbol><ci id="alg3.l3.m1.1.2.2.2.cmml" xref="alg3.l3.m1.1.2.2.2">𝜃</ci><ci id="alg3.l3.m1.1.2.2.3.cmml" xref="alg3.l3.m1.1.2.2.3">𝑘</ci></apply><apply id="alg3.l3.m1.1.1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1.1"><plus id="alg3.l3.m1.1.1.1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1.1.1.1"></plus><ci id="alg3.l3.m1.1.1.1.1.1.2.cmml" xref="alg3.l3.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg3.l3.m1.1.1.1.1.1.3.cmml" xref="alg3.l3.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">\theta_{k}^{(t+1)}</annotation></semantics></math><span id="alg3.l3.2" class="ltx_text ltx_font_bold">: </span>Optimized model parameters from each client

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><math id="alg3.l4.m1.1" class="ltx_Math" alttext="\omega_{k}^{(t)}" display="inline"><semantics id="alg3.l4.m1.1a"><msubsup id="alg3.l4.m1.1.2" xref="alg3.l4.m1.1.2.cmml"><mi id="alg3.l4.m1.1.2.2.2" xref="alg3.l4.m1.1.2.2.2.cmml">ω</mi><mi id="alg3.l4.m1.1.2.2.3" xref="alg3.l4.m1.1.2.2.3.cmml">k</mi><mrow id="alg3.l4.m1.1.1.1.3" xref="alg3.l4.m1.1.2.cmml"><mo stretchy="false" id="alg3.l4.m1.1.1.1.3.1" xref="alg3.l4.m1.1.2.cmml">(</mo><mi id="alg3.l4.m1.1.1.1.1" xref="alg3.l4.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg3.l4.m1.1.1.1.3.2" xref="alg3.l4.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.2.cmml" xref="alg3.l4.m1.1.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.2.1.cmml" xref="alg3.l4.m1.1.2">superscript</csymbol><apply id="alg3.l4.m1.1.2.2.cmml" xref="alg3.l4.m1.1.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.2.2.1.cmml" xref="alg3.l4.m1.1.2">subscript</csymbol><ci id="alg3.l4.m1.1.2.2.2.cmml" xref="alg3.l4.m1.1.2.2.2">𝜔</ci><ci id="alg3.l4.m1.1.2.2.3.cmml" xref="alg3.l4.m1.1.2.2.3">𝑘</ci></apply><ci id="alg3.l4.m1.1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\omega_{k}^{(t)}</annotation></semantics></math><span id="alg3.l4.2" class="ltx_text ltx_font_bold">: </span>Weighting factors from each client

</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><math id="alg3.l5.m1.4" class="ltx_Math" alttext="\gamma^{(t+1)}\leftarrow\dfrac{1}{\sum_{j=1}^{N}\omega_{j}^{(t)}}\displaystyle\sum_{k=1}^{q}\omega_{k}^{(t)}\theta_{k}^{(t+1)}" display="inline"><semantics id="alg3.l5.m1.4a"><mrow id="alg3.l5.m1.4.5" xref="alg3.l5.m1.4.5.cmml"><msup id="alg3.l5.m1.4.5.2" xref="alg3.l5.m1.4.5.2.cmml"><mi id="alg3.l5.m1.4.5.2.2" xref="alg3.l5.m1.4.5.2.2.cmml">γ</mi><mrow id="alg3.l5.m1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l5.m1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l5.m1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg3.l5.m1.1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg3.l5.m1.1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg3.l5.m1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg3.l5.m1.4.5.1" xref="alg3.l5.m1.4.5.1.cmml">←</mo><mrow id="alg3.l5.m1.4.5.3" xref="alg3.l5.m1.4.5.3.cmml"><mstyle displaystyle="true" id="alg3.l5.m1.2.2" xref="alg3.l5.m1.2.2.cmml"><mfrac id="alg3.l5.m1.2.2a" xref="alg3.l5.m1.2.2.cmml"><mn id="alg3.l5.m1.2.2.3" xref="alg3.l5.m1.2.2.3.cmml">1</mn><mrow id="alg3.l5.m1.2.2.1" xref="alg3.l5.m1.2.2.1.cmml"><msubsup id="alg3.l5.m1.2.2.1.2" xref="alg3.l5.m1.2.2.1.2.cmml"><mo id="alg3.l5.m1.2.2.1.2.2.2" xref="alg3.l5.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="alg3.l5.m1.2.2.1.2.2.3" xref="alg3.l5.m1.2.2.1.2.2.3.cmml"><mi id="alg3.l5.m1.2.2.1.2.2.3.2" xref="alg3.l5.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="alg3.l5.m1.2.2.1.2.2.3.1" xref="alg3.l5.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="alg3.l5.m1.2.2.1.2.2.3.3" xref="alg3.l5.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg3.l5.m1.2.2.1.2.3" xref="alg3.l5.m1.2.2.1.2.3.cmml">N</mi></msubsup><msubsup id="alg3.l5.m1.2.2.1.3" xref="alg3.l5.m1.2.2.1.3.cmml"><mi id="alg3.l5.m1.2.2.1.3.2.2" xref="alg3.l5.m1.2.2.1.3.2.2.cmml">ω</mi><mi id="alg3.l5.m1.2.2.1.3.2.3" xref="alg3.l5.m1.2.2.1.3.2.3.cmml">j</mi><mrow id="alg3.l5.m1.2.2.1.1.1.3" xref="alg3.l5.m1.2.2.1.3.cmml"><mo stretchy="false" id="alg3.l5.m1.2.2.1.1.1.3.1" xref="alg3.l5.m1.2.2.1.3.cmml">(</mo><mi id="alg3.l5.m1.2.2.1.1.1.1" xref="alg3.l5.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg3.l5.m1.2.2.1.1.1.3.2" xref="alg3.l5.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="alg3.l5.m1.4.5.3.1" xref="alg3.l5.m1.4.5.3.1.cmml">​</mo><mrow id="alg3.l5.m1.4.5.3.2" xref="alg3.l5.m1.4.5.3.2.cmml"><mstyle displaystyle="true" id="alg3.l5.m1.4.5.3.2.1" xref="alg3.l5.m1.4.5.3.2.1.cmml"><munderover id="alg3.l5.m1.4.5.3.2.1a" xref="alg3.l5.m1.4.5.3.2.1.cmml"><mo movablelimits="false" id="alg3.l5.m1.4.5.3.2.1.2.2" xref="alg3.l5.m1.4.5.3.2.1.2.2.cmml">∑</mo><mrow id="alg3.l5.m1.4.5.3.2.1.2.3" xref="alg3.l5.m1.4.5.3.2.1.2.3.cmml"><mi id="alg3.l5.m1.4.5.3.2.1.2.3.2" xref="alg3.l5.m1.4.5.3.2.1.2.3.2.cmml">k</mi><mo id="alg3.l5.m1.4.5.3.2.1.2.3.1" xref="alg3.l5.m1.4.5.3.2.1.2.3.1.cmml">=</mo><mn id="alg3.l5.m1.4.5.3.2.1.2.3.3" xref="alg3.l5.m1.4.5.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg3.l5.m1.4.5.3.2.1.3" xref="alg3.l5.m1.4.5.3.2.1.3.cmml">q</mi></munderover></mstyle><mrow id="alg3.l5.m1.4.5.3.2.2" xref="alg3.l5.m1.4.5.3.2.2.cmml"><msubsup id="alg3.l5.m1.4.5.3.2.2.2" xref="alg3.l5.m1.4.5.3.2.2.2.cmml"><mi id="alg3.l5.m1.4.5.3.2.2.2.2.2" xref="alg3.l5.m1.4.5.3.2.2.2.2.2.cmml">ω</mi><mi id="alg3.l5.m1.4.5.3.2.2.2.2.3" xref="alg3.l5.m1.4.5.3.2.2.2.2.3.cmml">k</mi><mrow id="alg3.l5.m1.3.3.1.3" xref="alg3.l5.m1.4.5.3.2.2.2.cmml"><mo stretchy="false" id="alg3.l5.m1.3.3.1.3.1" xref="alg3.l5.m1.4.5.3.2.2.2.cmml">(</mo><mi id="alg3.l5.m1.3.3.1.1" xref="alg3.l5.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="alg3.l5.m1.3.3.1.3.2" xref="alg3.l5.m1.4.5.3.2.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg3.l5.m1.4.5.3.2.2.1" xref="alg3.l5.m1.4.5.3.2.2.1.cmml">​</mo><msubsup id="alg3.l5.m1.4.5.3.2.2.3" xref="alg3.l5.m1.4.5.3.2.2.3.cmml"><mi id="alg3.l5.m1.4.5.3.2.2.3.2.2" xref="alg3.l5.m1.4.5.3.2.2.3.2.2.cmml">θ</mi><mi id="alg3.l5.m1.4.5.3.2.2.3.2.3" xref="alg3.l5.m1.4.5.3.2.2.3.2.3.cmml">k</mi><mrow id="alg3.l5.m1.4.4.1.1" xref="alg3.l5.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="alg3.l5.m1.4.4.1.1.2" xref="alg3.l5.m1.4.4.1.1.1.cmml">(</mo><mrow id="alg3.l5.m1.4.4.1.1.1" xref="alg3.l5.m1.4.4.1.1.1.cmml"><mi id="alg3.l5.m1.4.4.1.1.1.2" xref="alg3.l5.m1.4.4.1.1.1.2.cmml">t</mi><mo id="alg3.l5.m1.4.4.1.1.1.1" xref="alg3.l5.m1.4.4.1.1.1.1.cmml">+</mo><mn id="alg3.l5.m1.4.4.1.1.1.3" xref="alg3.l5.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg3.l5.m1.4.4.1.1.3" xref="alg3.l5.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.4b"><apply id="alg3.l5.m1.4.5.cmml" xref="alg3.l5.m1.4.5"><ci id="alg3.l5.m1.4.5.1.cmml" xref="alg3.l5.m1.4.5.1">←</ci><apply id="alg3.l5.m1.4.5.2.cmml" xref="alg3.l5.m1.4.5.2"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.2.1.cmml" xref="alg3.l5.m1.4.5.2">superscript</csymbol><ci id="alg3.l5.m1.4.5.2.2.cmml" xref="alg3.l5.m1.4.5.2.2">𝛾</ci><apply id="alg3.l5.m1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1"><plus id="alg3.l5.m1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1"></plus><ci id="alg3.l5.m1.1.1.1.1.1.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg3.l5.m1.1.1.1.1.1.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg3.l5.m1.4.5.3.cmml" xref="alg3.l5.m1.4.5.3"><times id="alg3.l5.m1.4.5.3.1.cmml" xref="alg3.l5.m1.4.5.3.1"></times><apply id="alg3.l5.m1.2.2.cmml" xref="alg3.l5.m1.2.2"><divide id="alg3.l5.m1.2.2.2.cmml" xref="alg3.l5.m1.2.2"></divide><cn type="integer" id="alg3.l5.m1.2.2.3.cmml" xref="alg3.l5.m1.2.2.3">1</cn><apply id="alg3.l5.m1.2.2.1.cmml" xref="alg3.l5.m1.2.2.1"><apply id="alg3.l5.m1.2.2.1.2.cmml" xref="alg3.l5.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.2.1.cmml" xref="alg3.l5.m1.2.2.1.2">superscript</csymbol><apply id="alg3.l5.m1.2.2.1.2.2.cmml" xref="alg3.l5.m1.2.2.1.2"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.2.2.1.cmml" xref="alg3.l5.m1.2.2.1.2">subscript</csymbol><sum id="alg3.l5.m1.2.2.1.2.2.2.cmml" xref="alg3.l5.m1.2.2.1.2.2.2"></sum><apply id="alg3.l5.m1.2.2.1.2.2.3.cmml" xref="alg3.l5.m1.2.2.1.2.2.3"><eq id="alg3.l5.m1.2.2.1.2.2.3.1.cmml" xref="alg3.l5.m1.2.2.1.2.2.3.1"></eq><ci id="alg3.l5.m1.2.2.1.2.2.3.2.cmml" xref="alg3.l5.m1.2.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="alg3.l5.m1.2.2.1.2.2.3.3.cmml" xref="alg3.l5.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="alg3.l5.m1.2.2.1.2.3.cmml" xref="alg3.l5.m1.2.2.1.2.3">𝑁</ci></apply><apply id="alg3.l5.m1.2.2.1.3.cmml" xref="alg3.l5.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.3.1.cmml" xref="alg3.l5.m1.2.2.1.3">superscript</csymbol><apply id="alg3.l5.m1.2.2.1.3.2.cmml" xref="alg3.l5.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg3.l5.m1.2.2.1.3.2.1.cmml" xref="alg3.l5.m1.2.2.1.3">subscript</csymbol><ci id="alg3.l5.m1.2.2.1.3.2.2.cmml" xref="alg3.l5.m1.2.2.1.3.2.2">𝜔</ci><ci id="alg3.l5.m1.2.2.1.3.2.3.cmml" xref="alg3.l5.m1.2.2.1.3.2.3">𝑗</ci></apply><ci id="alg3.l5.m1.2.2.1.1.1.1.cmml" xref="alg3.l5.m1.2.2.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="alg3.l5.m1.4.5.3.2.cmml" xref="alg3.l5.m1.4.5.3.2"><apply id="alg3.l5.m1.4.5.3.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.1.1.cmml" xref="alg3.l5.m1.4.5.3.2.1">superscript</csymbol><apply id="alg3.l5.m1.4.5.3.2.1.2.cmml" xref="alg3.l5.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.1.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.1">subscript</csymbol><sum id="alg3.l5.m1.4.5.3.2.1.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.1.2.2"></sum><apply id="alg3.l5.m1.4.5.3.2.1.2.3.cmml" xref="alg3.l5.m1.4.5.3.2.1.2.3"><eq id="alg3.l5.m1.4.5.3.2.1.2.3.1.cmml" xref="alg3.l5.m1.4.5.3.2.1.2.3.1"></eq><ci id="alg3.l5.m1.4.5.3.2.1.2.3.2.cmml" xref="alg3.l5.m1.4.5.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="alg3.l5.m1.4.5.3.2.1.2.3.3.cmml" xref="alg3.l5.m1.4.5.3.2.1.2.3.3">1</cn></apply></apply><ci id="alg3.l5.m1.4.5.3.2.1.3.cmml" xref="alg3.l5.m1.4.5.3.2.1.3">𝑞</ci></apply><apply id="alg3.l5.m1.4.5.3.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.2"><times id="alg3.l5.m1.4.5.3.2.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.2.1"></times><apply id="alg3.l5.m1.4.5.3.2.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.2.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.2.2">superscript</csymbol><apply id="alg3.l5.m1.4.5.3.2.2.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.2.2.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.2.2">subscript</csymbol><ci id="alg3.l5.m1.4.5.3.2.2.2.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.2.2.2.2">𝜔</ci><ci id="alg3.l5.m1.4.5.3.2.2.2.2.3.cmml" xref="alg3.l5.m1.4.5.3.2.2.2.2.3">𝑘</ci></apply><ci id="alg3.l5.m1.3.3.1.1.cmml" xref="alg3.l5.m1.3.3.1.1">𝑡</ci></apply><apply id="alg3.l5.m1.4.5.3.2.2.3.cmml" xref="alg3.l5.m1.4.5.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.2.3.1.cmml" xref="alg3.l5.m1.4.5.3.2.2.3">superscript</csymbol><apply id="alg3.l5.m1.4.5.3.2.2.3.2.cmml" xref="alg3.l5.m1.4.5.3.2.2.3"><csymbol cd="ambiguous" id="alg3.l5.m1.4.5.3.2.2.3.2.1.cmml" xref="alg3.l5.m1.4.5.3.2.2.3">subscript</csymbol><ci id="alg3.l5.m1.4.5.3.2.2.3.2.2.cmml" xref="alg3.l5.m1.4.5.3.2.2.3.2.2">𝜃</ci><ci id="alg3.l5.m1.4.5.3.2.2.3.2.3.cmml" xref="alg3.l5.m1.4.5.3.2.2.3.2.3">𝑘</ci></apply><apply id="alg3.l5.m1.4.4.1.1.1.cmml" xref="alg3.l5.m1.4.4.1.1"><plus id="alg3.l5.m1.4.4.1.1.1.1.cmml" xref="alg3.l5.m1.4.4.1.1.1.1"></plus><ci id="alg3.l5.m1.4.4.1.1.1.2.cmml" xref="alg3.l5.m1.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="alg3.l5.m1.4.4.1.1.1.3.cmml" xref="alg3.l5.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.4c">\gamma^{(t+1)}\leftarrow\dfrac{1}{\sum_{j=1}^{N}\omega_{j}^{(t)}}\displaystyle\sum_{k=1}^{q}\omega_{k}^{(t)}\theta_{k}^{(t+1)}</annotation></semantics></math>

</div>
<div id="alg3.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg3.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Broadcast <math id="alg3.l6.m1.1" class="ltx_Math" alttext="\gamma^{(t+1)}" display="inline"><semantics id="alg3.l6.m1.1a"><msup id="alg3.l6.m1.1.2" xref="alg3.l6.m1.1.2.cmml"><mi id="alg3.l6.m1.1.2.2" xref="alg3.l6.m1.1.2.2.cmml">γ</mi><mrow id="alg3.l6.m1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l6.m1.1.1.1.1.2" xref="alg3.l6.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l6.m1.1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.cmml"><mi id="alg3.l6.m1.1.1.1.1.1.2" xref="alg3.l6.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg3.l6.m1.1.1.1.1.1.1" xref="alg3.l6.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg3.l6.m1.1.1.1.1.1.3" xref="alg3.l6.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg3.l6.m1.1.1.1.1.3" xref="alg3.l6.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.2.cmml" xref="alg3.l6.m1.1.2"><csymbol cd="ambiguous" id="alg3.l6.m1.1.2.1.cmml" xref="alg3.l6.m1.1.2">superscript</csymbol><ci id="alg3.l6.m1.1.2.2.cmml" xref="alg3.l6.m1.1.2.2">𝛾</ci><apply id="alg3.l6.m1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1"><plus id="alg3.l6.m1.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1.1.1.1"></plus><ci id="alg3.l6.m1.1.1.1.1.1.2.cmml" xref="alg3.l6.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg3.l6.m1.1.1.1.1.1.3.cmml" xref="alg3.l6.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">\gamma^{(t+1)}</annotation></semantics></math> to the all clients

</div>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To evaluate the performance of FedMAP under non-IID data distributions, we utilized both synthetic and public datasets.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Synthetic Dataset: A synthetic dataset was created to isolate and analyze the effects of distinct non-IID issues, enabling targeted evaluations of FedMAP’s performance under each condition. This dataset includes diverse non-IID data distributions across clients: 1) Feature Distribution Skew through client-specific affine transformations applied to the local data, 2) Quantity Skew with varying splitting ratios for imbalanced data assignments, 3) Label Distribution Skew by different class proportions across the clients. A detailed explanation of the generation of the synthetic data is included in the appendix. This synthetic dataset closely simulates challenges encountered in practical settings. We use the synthetic dataset to isolate and analyze the effects of distinct non-IID issues, enabling targeted evaluations of FedMAP’s performance under each condition.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">Office-31 Dataset: To complement the experiments on synthetic datasets and to assess FedMAP’s effectiveness in realistic scenarios, we employed the Office-31 dataset <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib25" title="" class="ltx_ref">10.1007/978-3-642-15561-1_16 </a></cite>. This dataset consists of 4110 images across 31 object categories, collected from three distinct domains: Amazon (images from Amazon.com), Webcam (low-resolution images captured by a webcam), and DSLR (high-resolution images captured by a digital SLR camera). The diversity in image domains, resolution, and acquisition conditions in the Office-31 dataset naturally introduces non-IID data distributions, making it an ideal real-world benchmark for evaluating FL algorithms.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Setup</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Using the synthetic dataset for a binary classification task, we evaluated FedMAP across three distinct non-IID scenarios involving 10 clients for FL training and validation. The first scenario featured skewed feature distributions, with each client holding 2000 samples. The second scenario combined feature distribution skew with quantity skew, where five clients held 2000 samples each, and the other five held only 500 samples each. The third scenario combined feature distribution skew with label distribution skew, where all clients had 2000 samples, but five clients had 85% of their samples belonging to class 0, while the class proportions were balanced for the remaining clients. Each client employed a 70:30 train-validation split. The model architecture employed was a multi-layer perceptron (MLP) with two hidden layers. Models were optimized using the Adam optimizer.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">To simulate non-IID data distributions in the Office-31 dataset, we partitioned the data across three clients, each representing a distinct domain: Amazon, Webcam, and DSLR. We utilized the Convolutional Neural Network(CNN) model architecture from the FedBN <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib4" title="" class="ltx_ref">li2021fedbn </a></cite> experiments, which consists of five convolutional layers, each with batch normalization and ReLU activation, ending with an output layer for classification. Models were optimized using the SGD optimizer, and each client also used a 70:30 train-validation split.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">FedMAP was evaluated against three established FL baselines and individual client training. FedAvg <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib3" title="" class="ltx_ref">mcmahan2023communicationefficient </a></cite> serves as the benchmark of FL. FedProx <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib9" title="" class="ltx_ref">li2020federated </a></cite> was selected due to its similarity to FedMAP in addressing non-IID by using a regularizing term that keeps local updates close to the global model. FedBN <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib4" title="" class="ltx_ref">li2021fedbn </a></cite> was selected as it is a PFL method that targets the feature distribution skew scenarios we are investigating. Individual client training, where models are trained and validated exclusively on each client’s local data to assess base performance. All experiments were conducted on an AMD 5965WX 24-core CPU with two NVIDIA RTX A5500 GPUs. To facilitate reproducibility and practical adoption, we integrated FedMAP into one of the popular open-source frameworks, Flower <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib7" title="" class="ltx_ref">beutel2020flower </a></cite>, enabling simulations of real distributed deployments.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results and discussion</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">This section presents the validation accuracy of FedMAP compared to individual client training and other FL approaches under various non-IID data scenarios. FedMAP shows prominent performance across non-IID scenarios, especially for clients with limited or imbalanced data.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the performance of FedMAP in the label distribution skew scenario, where clients 1-5 have balanced class distributions, whereas clients 6-10, marked in red, have significantly imbalanced class distributions. FedMAP is highly effective in this scenario, especially for clients 6-10 with severely imbalanced class distributions. Clients 8, 9, and 10 achieve accuracy improvements of over 13% compared to their individual training models, which face difficulties with underrepresented classes. Notably, FedMAP also enhances the performance of the clients with balanced class distributions, demonstrating its ability to leverage diverse data to refine the global prior and benefit all clients.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.3.2" class="ltx_text" style="font-size:90%;">Accuracy comparison of FedMAP, FedBN, FedProx, FedAvg, and individual client training on the synthetic dataset with label distribution skew. Clients 1-5 have balanced label distributions, while 6-10 (red) have severely skewed label distributions.</span></figcaption>
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.4.1.1" class="ltx_tr">
<th id="S4.T1.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T1.4.1.1.1.1" class="ltx_text ltx_font_bold">Client</span></th>
<th id="S4.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.4.1.1.2.1" class="ltx_text ltx_font_bold">Individual</span></th>
<th id="S4.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.4.1.1.3.1" class="ltx_text ltx_font_bold">FedMAP</span></th>
<th id="S4.T1.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.4.1.1.4.1" class="ltx_text ltx_font_bold">FedBN</span></th>
<th id="S4.T1.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.4.1.1.5.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="S4.T1.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.4.1.1.6.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.4.2.1" class="ltx_tr">
<th id="S4.T1.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S4.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">84.51%</td>
<td id="S4.T1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">86.91% <span id="S4.T1.4.2.1.3.1" class="ltx_text" style="color:#00E000;">(↑ 2.40%)</span>
</td>
<td id="S4.T1.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">67.49%</td>
<td id="S4.T1.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t">53.16%</td>
<td id="S4.T1.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t">52.19%</td>
</tr>
<tr id="S4.T1.4.3.2" class="ltx_tr">
<th id="S4.T1.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">2</th>
<td id="S4.T1.4.3.2.2" class="ltx_td ltx_align_center">86.44%</td>
<td id="S4.T1.4.3.2.3" class="ltx_td ltx_align_center">87.15% <span id="S4.T1.4.3.2.3.1" class="ltx_text" style="color:#00E000;">(↑ 0.71%)</span>
</td>
<td id="S4.T1.4.3.2.4" class="ltx_td ltx_align_center">67.43%</td>
<td id="S4.T1.4.3.2.5" class="ltx_td ltx_align_center">56.70%</td>
<td id="S4.T1.4.3.2.6" class="ltx_td ltx_align_center">55.61%</td>
</tr>
<tr id="S4.T1.4.4.3" class="ltx_tr">
<th id="S4.T1.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">3</th>
<td id="S4.T1.4.4.3.2" class="ltx_td ltx_align_center">86.95%</td>
<td id="S4.T1.4.4.3.3" class="ltx_td ltx_align_center">87.01% <span id="S4.T1.4.4.3.3.1" class="ltx_text" style="color:#00E000;">(↑ 0.06%)</span>
</td>
<td id="S4.T1.4.4.3.4" class="ltx_td ltx_align_center">69.18%</td>
<td id="S4.T1.4.4.3.5" class="ltx_td ltx_align_center">55.37%</td>
<td id="S4.T1.4.4.3.6" class="ltx_td ltx_align_center">54.79%</td>
</tr>
<tr id="S4.T1.4.5.4" class="ltx_tr">
<th id="S4.T1.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">4</th>
<td id="S4.T1.4.5.4.2" class="ltx_td ltx_align_center">87.84%</td>
<td id="S4.T1.4.5.4.3" class="ltx_td ltx_align_center">89.94% <span id="S4.T1.4.5.4.3.1" class="ltx_text" style="color:#00E000;">(↑ 2.10%)</span>
</td>
<td id="S4.T1.4.5.4.4" class="ltx_td ltx_align_center">72.88%</td>
<td id="S4.T1.4.5.4.5" class="ltx_td ltx_align_center">57.09%</td>
<td id="S4.T1.4.5.4.6" class="ltx_td ltx_align_center">56.17%</td>
</tr>
<tr id="S4.T1.4.6.5" class="ltx_tr">
<th id="S4.T1.4.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">5</th>
<td id="S4.T1.4.6.5.2" class="ltx_td ltx_align_center">88.08%</td>
<td id="S4.T1.4.6.5.3" class="ltx_td ltx_align_center">89.08% <span id="S4.T1.4.6.5.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.00%)</span>
</td>
<td id="S4.T1.4.6.5.4" class="ltx_td ltx_align_center">71.53%</td>
<td id="S4.T1.4.6.5.5" class="ltx_td ltx_align_center">55.42%</td>
<td id="S4.T1.4.6.5.6" class="ltx_td ltx_align_center">53.92%</td>
</tr>
<tr id="S4.T1.4.7.6" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="S4.T1.4.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.4.7.6.1.1" class="ltx_text" style="background-color:#FFCCCC;">6</span></th>
<td id="S4.T1.4.7.6.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.7.6.2.1" class="ltx_text" style="background-color:#FFCCCC;">59.37%</span></td>
<td id="S4.T1.4.7.6.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.7.6.3.1" class="ltx_text" style="background-color:#FFCCCC;">66.80% <span id="S4.T1.4.7.6.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 7.43%)</span></span></td>
<td id="S4.T1.4.7.6.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.7.6.4.1" class="ltx_text" style="background-color:#FFCCCC;">55.60%</span></td>
<td id="S4.T1.4.7.6.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.7.6.5.1" class="ltx_text" style="background-color:#FFCCCC;">52.00%</span></td>
<td id="S4.T1.4.7.6.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.7.6.6.1" class="ltx_text" style="background-color:#FFCCCC;">51.34%</span></td>
</tr>
<tr id="S4.T1.4.8.7" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="S4.T1.4.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.4.8.7.1.1" class="ltx_text" style="background-color:#FFCCCC;">7</span></th>
<td id="S4.T1.4.8.7.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.7.2.1" class="ltx_text" style="background-color:#FFCCCC;">65.17%</span></td>
<td id="S4.T1.4.8.7.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.7.3.1" class="ltx_text" style="background-color:#FFCCCC;">73.02% <span id="S4.T1.4.8.7.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 7.85%)</span></span></td>
<td id="S4.T1.4.8.7.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.7.4.1" class="ltx_text" style="background-color:#FFCCCC;">57.68%</span></td>
<td id="S4.T1.4.8.7.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.7.5.1" class="ltx_text" style="background-color:#FFCCCC;">52.57%</span></td>
<td id="S4.T1.4.8.7.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.8.7.6.1" class="ltx_text" style="background-color:#FFCCCC;">51.65%</span></td>
</tr>
<tr id="S4.T1.4.9.8" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="S4.T1.4.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.4.9.8.1.1" class="ltx_text" style="background-color:#FFCCCC;">8</span></th>
<td id="S4.T1.4.9.8.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.8.2.1" class="ltx_text" style="background-color:#FFCCCC;">60.73%</span></td>
<td id="S4.T1.4.9.8.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.8.3.1" class="ltx_text" style="background-color:#FFCCCC;">76.08% <span id="S4.T1.4.9.8.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 15.35%)</span></span></td>
<td id="S4.T1.4.9.8.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.8.4.1" class="ltx_text" style="background-color:#FFCCCC;">56.73%</span></td>
<td id="S4.T1.4.9.8.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.8.5.1" class="ltx_text" style="background-color:#FFCCCC;">51.81%</span></td>
<td id="S4.T1.4.9.8.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.9.8.6.1" class="ltx_text" style="background-color:#FFCCCC;">50.98%</span></td>
</tr>
<tr id="S4.T1.4.10.9" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="S4.T1.4.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.4.10.9.1.1" class="ltx_text" style="background-color:#FFCCCC;">9</span></th>
<td id="S4.T1.4.10.9.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.10.9.2.1" class="ltx_text" style="background-color:#FFCCCC;">57.68%</span></td>
<td id="S4.T1.4.10.9.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.10.9.3.1" class="ltx_text" style="background-color:#FFCCCC;">71.66% <span id="S4.T1.4.10.9.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 13.98%)</span></span></td>
<td id="S4.T1.4.10.9.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.10.9.4.1" class="ltx_text" style="background-color:#FFCCCC;">54.76%</span></td>
<td id="S4.T1.4.10.9.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.10.9.5.1" class="ltx_text" style="background-color:#FFCCCC;">51.56%</span></td>
<td id="S4.T1.4.10.9.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.10.9.6.1" class="ltx_text" style="background-color:#FFCCCC;">51.36%</span></td>
</tr>
<tr id="S4.T1.4.11.10" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="S4.T1.4.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.4.11.10.1.1" class="ltx_text" style="background-color:#FFCCCC;">10</span></th>
<td id="S4.T1.4.11.10.2" class="ltx_td ltx_align_center"><span id="S4.T1.4.11.10.2.1" class="ltx_text" style="background-color:#FFCCCC;">62.12%</span></td>
<td id="S4.T1.4.11.10.3" class="ltx_td ltx_align_center"><span id="S4.T1.4.11.10.3.1" class="ltx_text" style="background-color:#FFCCCC;">76.32% <span id="S4.T1.4.11.10.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 14.20%)</span></span></td>
<td id="S4.T1.4.11.10.4" class="ltx_td ltx_align_center"><span id="S4.T1.4.11.10.4.1" class="ltx_text" style="background-color:#FFCCCC;">57.31%</span></td>
<td id="S4.T1.4.11.10.5" class="ltx_td ltx_align_center"><span id="S4.T1.4.11.10.5.1" class="ltx_text" style="background-color:#FFCCCC;">51.50%</span></td>
<td id="S4.T1.4.11.10.6" class="ltx_td ltx_align_center"><span id="S4.T1.4.11.10.6.1" class="ltx_text" style="background-color:#FFCCCC;">51.22%</span></td>
</tr>
<tr id="S4.T1.4.12.11" class="ltx_tr">
<th id="S4.T1.4.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T1.4.12.11.1.1" class="ltx_text ltx_font_bold">Average</span></th>
<td id="S4.T1.4.12.11.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">75.20%</td>
<td id="S4.T1.4.12.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">80.39%</td>
<td id="S4.T1.4.12.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">63.05%</td>
<td id="S4.T1.4.12.11.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">53.71%</td>
<td id="S4.T1.4.12.11.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">52.92%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">In contrast, existing FL methods FedAvg, FedProx, and FedBN underperform compared to individual client training across all clients with skewed label distributions. They show particularly large gaps in performance on the clients (6-10) with the most skewed data, highlighting their limitations in handling non-IID data distributions. For a comprehensive overview of FedMAP’s performance in other non-IID scenarios, such as feature distribution and quantity skew, please refer to Tables <a href="#A2.T3" title="Table 3 ‣ B.2 Results in different non-IID scenarios ‣ Appendix B Supplementary material for the experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#A2.T4" title="Table 4 ‣ B.2 Results in different non-IID scenarios ‣ Appendix B Supplementary material for the experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> in the Appendix.</p>
</div>
<figure id="S4.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.19000/assets/x1.png" id="S4.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="336" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F1.sf1.3.2" class="ltx_text" style="font-size:90%;">Feature Distribution Skew: All clients have the same number of samples (2000 each).</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.19000/assets/x2.png" id="S4.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="336" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F1.sf2.3.2" class="ltx_text" style="font-size:90%;">Quantity Skew: Clients 1-5 have 2000 samples each, while clients 6-10 have only 500 each.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.19000/assets/x3.png" id="S4.F1.sf3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="336" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F1.sf3.3.2" class="ltx_text" style="font-size:90%;">Label Distribution Skew: Clients 1-5 are balanced, while clients 6-10 have 85% of samples in one class.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.3.2" class="ltx_text" style="font-size:90%;">Comparison of FedMAP’s validation accuracy curves under three non-IID scenarios, illustrating the impact of feature, quantity, and label distribution skews on model performance.</span></figcaption>
</figure>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">As shown in Figure <a href="#S4.F1" title="Figure 1 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the validation accuracy curves of clients using FedMAP vary significantly across different types of data skew. Under feature distribution skew (Figure <a href="#S4.F1.sf1" title="In Figure 1 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>), all clients consistently achieve high validation accuracy and demonstrate stable learning trajectories, indicating FedMAP’s effectiveness in mitigating feature distribution disparities. In contrast, clients under quantity and label distribution skews exhibit more variability and slower convergence.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">In scenarios with quantity skew (Figure <a href="#S4.F1.sf2" title="In Figure 1 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>), clients 6-10 initially show much lower accuracy than clients 1-5 due to their limited sample sizes. However, as communication rounds progress, these clients gradually improve, though slower.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.1" class="ltx_p">For label distribution skew (Figure <a href="#S4.F1.sf3" title="In Figure 1 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>), clients 6-10 experience an extended initial phase with an accuracy of approximately 0.5, indicating a strong bias towards the majority class. This phase persists for about 20 communication rounds, reflecting the inherent difficulty in learning the underrepresented minority class from severely imbalanced data distributions. Eventually, clients 6-10 converge, with their accuracy gradually improving, though still lagging behind clients 1-5. This transition suggests that the global prior distribution, shaped by the aggregation of local models, gradually adapts to the skewed label distributions, enabling clients 6-10 to learn the minority class better. Despite these challenges, FedMAP enhances overall validation accuracy, demonstrating robustness in heterogeneous data environments.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Comparison of accuracies of all clients for each approach under Office-31 dataset</span></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<th id="S4.T2.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T2.4.1.1.1.1" class="ltx_text ltx_font_bold">Domain</span></th>
<th id="S4.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.1.1.2.1" class="ltx_text ltx_font_bold">Individual</span></th>
<th id="S4.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.1.1.3.1" class="ltx_text ltx_font_bold">FedMAP</span></th>
<th id="S4.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.1.1.4.1" class="ltx_text ltx_font_bold">FedBN</span></th>
<th id="S4.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.1.1.5.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="S4.T2.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.1.1.6.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.2.1" class="ltx_tr">
<th id="S4.T2.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Amazon</th>
<td id="S4.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">65.80%</td>
<td id="S4.T2.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">70.34% <span id="S4.T2.4.2.1.3.1" class="ltx_text" style="color:#00E000;">(↑ 4.54%)</span>
</td>
<td id="S4.T2.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">70.29%</td>
<td id="S4.T2.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t">64.37%</td>
<td id="S4.T2.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t">64.86%</td>
</tr>
<tr id="S4.T2.4.3.2" class="ltx_tr">
<th id="S4.T2.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Webcam</th>
<td id="S4.T2.4.3.2.2" class="ltx_td ltx_align_center">68.98%</td>
<td id="S4.T2.4.3.2.3" class="ltx_td ltx_align_center">86.04% <span id="S4.T2.4.3.2.3.1" class="ltx_text" style="color:#00E000;">(↑ 17.06%)</span>
</td>
<td id="S4.T2.4.3.2.4" class="ltx_td ltx_align_center">83.98%</td>
<td id="S4.T2.4.3.2.5" class="ltx_td ltx_align_center">40.22%</td>
<td id="S4.T2.4.3.2.6" class="ltx_td ltx_align_center">42.22%</td>
</tr>
<tr id="S4.T2.4.4.3" class="ltx_tr">
<th id="S4.T2.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DSLR</th>
<td id="S4.T2.4.4.3.2" class="ltx_td ltx_align_center">85.57%</td>
<td id="S4.T2.4.4.3.3" class="ltx_td ltx_align_center">95.54% <span id="S4.T2.4.4.3.3.1" class="ltx_text" style="color:#00E000;">(↑ 9.97%)</span>
</td>
<td id="S4.T2.4.4.3.4" class="ltx_td ltx_align_center">82.52%</td>
<td id="S4.T2.4.4.3.5" class="ltx_td ltx_align_center">75.52%</td>
<td id="S4.T2.4.4.3.6" class="ltx_td ltx_align_center">77.49%</td>
</tr>
<tr id="S4.T2.4.5.4" class="ltx_tr">
<th id="S4.T2.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.4.5.4.1.1" class="ltx_text ltx_font_bold">Average</span></th>
<td id="S4.T2.4.5.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">73.45%</td>
<td id="S4.T2.4.5.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">83.97%</td>
<td id="S4.T2.4.5.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">78.93%</td>
<td id="S4.T2.4.5.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">60.04%</td>
<td id="S4.T2.4.5.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">61.52%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p7" class="ltx_para">
<p id="S4.SS3.p7.1" class="ltx_p">The results from the Office-31 dataset experiment further confirm FedMAP’s effectiveness in handling non-IID data distributions encountered in real-world FL scenarios. As depicted in Table <a href="#S4.T2" title="Table 2 ‣ 4.3 Results and discussion ‣ 4 Experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, FedMAP demonstrates performance gains over individual client training models across all three clients in the Office-31 dataset. Moreover, the varying degrees of improvement observed across clients can be attributed to the inherent diversity in data distributions present in the dataset. The Webcam domain shows the most significant accuracy gain, 17.06% with FedMAP. This can be explained by the low-resolution and unique characteristics of the Webcam images, which deviate substantially from the other domains. By leveraging the global prior, FedMAP effectively transfers relevant knowledge from the higher-resolution DSLR dataset, enabling the Webcam domain to overcome the limitations of its low-resolution data.
Overall, the experiment results highlight FedMAP’s ability to effectively address the challenges posed by non-IID data distributions.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we presented FedMAP, a novel FL framework incorporating a global prior distribution over local model parameters, enabling personalized FL. We formulated a mathematical framework for the problem within a bi-level optimization structure, capturing the heterogeneity of data distributions across clients. Extensive evaluations across scenarios with skewed feature, label and quantity distributions demonstrated FedMAP’s performance gains over baselines like FedAvg, FedProx, and FedBN. FedMAP significantly improved performance for clients facing severe label imbalances or limited data. Additionally, we integrated FedMAP with the open-source Flower framework to facilitate reproducibility and practical deployment using Docker containers. This integration streamlines the deployment process and allows researchers and practitioners to easily incorporate FedMAP into their FL pipelines.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Regarding the practical use case, FedMAP can particularly benefit healthcare, enabling multiple hospitals to train ML models collaboratively despite their siloed data. Hospitals often face non-IID data due to varying disease prevalence, demographic differences, and disparate dataset sizes <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib1" title="" class="ltx_ref">zhang2023recent </a></cite>. FedMAP enables the training of robust and personalized diagnostic models tailored to each healthcare provider’s unique data landscape, unlocking the power of collaborative learning while preserving data privacy and integrity.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Despite the promising results, there are opportunities for further enhancement. One limitation of our approach is the assumption of an isotropic Gaussian distribution for the global prior, in which the unique parameter is the mean. Future work will include investigating the possibility of tuning the co-variance matrix, as well as exploring alternative prior distributions beyond the Gaussian, conducting extensive real-world deployments to validate FedMAP’s performance and scalability and investigating the theoretical properties and convergence behavior of the method. In conclusion, FedMAP represents significant advancements over existing FL methods, paving the way for broader adoption of FL.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Fan Zhang, Daniel Kreuter, Yichen Chen, Sören Dittmer, Samuel Tull, Tolou Shadbahr, BloodCounts! Collaboration, Jacobus Preller, James H. F. Rudd, John A. D. Aston, Carola-Bibiane Schönlieb, Nicholas Gleadall, and Michael Roberts.

</span>
<span class="ltx_bibblock">Recent methodological advances in federated learning for healthcare, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An experimental study.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">2022 IEEE 38th International Conference on Data Engineering (ICDE)</span>, pages 965–978, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou.

</span>
<span class="ltx_bibblock">Fedbn: Federated learning on non-iid features via local batch normalization, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Viraj Kulkarni, Milind Kulkarni, and Aniruddha Pant.

</span>
<span class="ltx_bibblock">Survey of personalization techniques for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">2020 Fourth World Conference on Smart Trends in Systems, Security and Sustainability (WorldS4)</span>, pages 794–797, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Shiyun Lin, Yuze Han, Xiang Li, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">Personalized federated learning towards communication efficiency, robustness and fairness.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 35:30471–30485, Dec 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Daniel J Beutel, Taner Topal, Akhil Mathur, Xinchi Qiu, Javier Fernandez-Marques, Yan Gao, Lorenzo Sani, Hei Li Kwing, Titouan Parcollet, Pedro PB de Gusmão, and Nicholas D Lane.

</span>
<span class="ltx_bibblock">Flower: A friendly federated learning research framework.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.14390</span>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Saeed Vahidian, Mahdi Morafah, Chen Chen, Mubarak Shah, and Bill Lin.

</span>
<span class="ltx_bibblock">Rethinking data heterogeneity in federated learning: Introducing a new notion and standard benchmarks.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Artificial Intelligence</span>, 5(3):1386–1397, 2024.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In Hal Daumé III and Aarti Singh, editors, <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the 37th International Conference on Machine Learning</span>, volume 119 of <span id="bib.bib10.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 5132–5143. PMLR, 13–18 Jul 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Othmane Marfoq, Giovanni Neglia, Richard Vidal, and Laetitia Kameni.

</span>
<span class="ltx_bibblock">Personalized federated learning through local memorization.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari, Gang Niu, and Sivan Sabato, editors, <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning</span>, volume 162 of <span id="bib.bib11.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 15070–15092. PMLR, 17–23 Jul 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Royson Lee, Minyoung Kim, Da Li, Xinchi Qiu, Timothy Hospedales, Ferenc Huszár, and Nicholas Donald Lane.

</span>
<span class="ltx_bibblock">Fedl2p: Federated learning to personalize.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Thirty-seventh Conference on Neural Information Processing Systems</span>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Jingke Tu, Jiaming Huang, Lei Yang, and Wanyu Lin.

</span>
<span class="ltx_bibblock">Personalized federated learning with layer-wise feature transformation via meta-learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">ACM Trans. Knowl. Discov. Data</span>, 18(4), feb 2024.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock">In I. Guyon, U. Von Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, editors, <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, volume 30. Curran Associates, Inc., 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin, editors, <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, volume 33, pages 3557–3568. Curran Associates, Inc., 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Maoye Ren, Zhe Wang, and Xinhai Yu.

</span>
<span class="ltx_bibblock">Personalized federated learning: A clustered distributed co-meta-learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Information Sciences</span>, 647:119499, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Simone Porcu, Alessandro Floris, and Luigi Atzori.

</span>
<span class="ltx_bibblock">Cb-fl: Cluster-based federated learning applied to quality of experience modelling.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">2022 16th International Conference on Signal-Image Technology &amp; Internet-Based Systems (SITIS)</span>, pages 585–591, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Longbing Cao, Hui Chen, Xuhui Fan, Joao Gama, Yew-Soon Ong, and Vipin Kumar.

</span>
<span class="ltx_bibblock">Bayesian federated learning: a survey.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proceedings of the Thirty-Second International Joint Conference on Artificial Intelligence</span>, IJCAI ’23, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Xu Zhang, Yinchuan Li, Wenpeng Li, Kaiyang Guo, and Yunfeng Shao.

</span>
<span class="ltx_bibblock">Personalized federated learning via variational Bayesian inference.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari, Gang Niu, and Sivan Sabato, editors, <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning</span>, volume 162 of <span id="bib.bib19.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 26293–26310. PMLR, 17–23 Jul 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Mohsin Hasan, Guojun Zhang, Kaiyang Guo, Xi Chen, and Pascal Poupart.

</span>
<span class="ltx_bibblock">Calibrated one round federated learning with bayesian inference in the predictive space.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">AAAI Conference on Artificial Intelligence</span>, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Nikita Kotelevskii, Maxime Vono, Alain Durmus, and Eric Moulines.

</span>
<span class="ltx_bibblock">Fedpop: A bayesian approach for personalised federated learning.

</span>
<span class="ltx_bibblock">In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, volume 35, pages 8687–8701. Curran Associates, Inc., 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, Nghia Hoang, and Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri and Ruslan Salakhutdinov, editors, <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th International Conference on Machine Learning</span>, volume 97 of <span id="bib.bib22.2.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning Research</span>, pages 7252–7261. PMLR, 09–15 Jun 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Kaiyi Ji, Junjie Yang, and Yingbin Liang.

</span>
<span class="ltx_bibblock">Bilevel optimization: Convergence analysis and enhanced design.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Tianyi Chen, Yuejiao Sun, and Wotao Yin.

</span>
<span class="ltx_bibblock">Closing the gap: Tighter analysis of alternating stochastic gradient methods for bilevel problems.

</span>
<span class="ltx_bibblock">In M. Ranzato, A. Beygelzimer, Y. Dauphin, P.S. Liang, and J. Wortman Vaughan, editors, <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, volume 34, pages 25294–25307. Curran Associates, Inc., 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Kate Saenko, Brian Kulis, Mario Fritz, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Adapting visual category models to new domains.

</span>
<span class="ltx_bibblock">In Kostas Daniilidis, Petros Maragos, and Nikos Paragios, editors, <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Computer Vision – ECCV 2010</span>, pages 213–226, Berlin, Heidelberg, 2010. Springer Berlin Heidelberg.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Supporting material for the experiments</h2>

</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Supplementary material for the experiments</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Description of the synthetic data</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.13" class="ltx_p">We designed a data synthesis method that generates synthetic data for a binary classification problem in <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><msup id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mi id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">ℝ</mi><mi id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.1.2">ℝ</ci><ci id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">\mathbb{R}^{n}</annotation></semantics></math>, where <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="n=30" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">n</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><eq id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></eq><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝑛</ci><cn type="integer" id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">n=30</annotation></semantics></math> is the number of features.
We assume that the intrinsic dimension of the data is <math id="A2.SS1.p1.3.m3.1" class="ltx_Math" alttext="d=4" display="inline"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">d</mi><mo id="A2.SS1.p1.3.m3.1.1.1" xref="A2.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><eq id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1"></eq><ci id="A2.SS1.p1.3.m3.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.2">𝑑</ci><cn type="integer" id="A2.SS1.p1.3.m3.1.1.3.cmml" xref="A2.SS1.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">d=4</annotation></semantics></math>, so we start by randomly selecting a <math id="A2.SS1.p1.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">d</annotation></semantics></math>-dimensional linear subspace of <math id="A2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p1.5.m5.1a"><msup id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml"><mi id="A2.SS1.p1.5.m5.1.1.2" xref="A2.SS1.p1.5.m5.1.1.2.cmml">ℝ</mi><mi id="A2.SS1.p1.5.m5.1.1.3" xref="A2.SS1.p1.5.m5.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><apply id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.5.m5.1.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="A2.SS1.p1.5.m5.1.1.2.cmml" xref="A2.SS1.p1.5.m5.1.1.2">ℝ</ci><ci id="A2.SS1.p1.5.m5.1.1.3.cmml" xref="A2.SS1.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">\mathbb{R}^{n}</annotation></semantics></math>.
This is done by randomly generating <math id="A2.SS1.p1.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.SS1.p1.6.m6.1a"><mi id="A2.SS1.p1.6.m6.1.1" xref="A2.SS1.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.6.m6.1b"><ci id="A2.SS1.p1.6.m6.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.6.m6.1c">d</annotation></semantics></math> orthonormal vectors of <math id="A2.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p1.7.m7.1a"><msup id="A2.SS1.p1.7.m7.1.1" xref="A2.SS1.p1.7.m7.1.1.cmml"><mi id="A2.SS1.p1.7.m7.1.1.2" xref="A2.SS1.p1.7.m7.1.1.2.cmml">ℝ</mi><mi id="A2.SS1.p1.7.m7.1.1.3" xref="A2.SS1.p1.7.m7.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.7.m7.1b"><apply id="A2.SS1.p1.7.m7.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.7.m7.1.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="A2.SS1.p1.7.m7.1.1.2.cmml" xref="A2.SS1.p1.7.m7.1.1.2">ℝ</ci><ci id="A2.SS1.p1.7.m7.1.1.3.cmml" xref="A2.SS1.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.7.m7.1c">\mathbb{R}^{n}</annotation></semantics></math>, that we stack as a matrix <math id="A2.SS1.p1.8.m8.3" class="ltx_Math" alttext="B=(b_{1},\ldots,b_{d})\in\mathbb{R}^{n\times d}" display="inline"><semantics id="A2.SS1.p1.8.m8.3a"><mrow id="A2.SS1.p1.8.m8.3.3" xref="A2.SS1.p1.8.m8.3.3.cmml"><mi id="A2.SS1.p1.8.m8.3.3.4" xref="A2.SS1.p1.8.m8.3.3.4.cmml">B</mi><mo id="A2.SS1.p1.8.m8.3.3.5" xref="A2.SS1.p1.8.m8.3.3.5.cmml">=</mo><mrow id="A2.SS1.p1.8.m8.3.3.2.2" xref="A2.SS1.p1.8.m8.3.3.2.3.cmml"><mo stretchy="false" id="A2.SS1.p1.8.m8.3.3.2.2.3" xref="A2.SS1.p1.8.m8.3.3.2.3.cmml">(</mo><msub id="A2.SS1.p1.8.m8.2.2.1.1.1" xref="A2.SS1.p1.8.m8.2.2.1.1.1.cmml"><mi id="A2.SS1.p1.8.m8.2.2.1.1.1.2" xref="A2.SS1.p1.8.m8.2.2.1.1.1.2.cmml">b</mi><mn id="A2.SS1.p1.8.m8.2.2.1.1.1.3" xref="A2.SS1.p1.8.m8.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A2.SS1.p1.8.m8.3.3.2.2.4" xref="A2.SS1.p1.8.m8.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS1.p1.8.m8.1.1" xref="A2.SS1.p1.8.m8.1.1.cmml">…</mi><mo id="A2.SS1.p1.8.m8.3.3.2.2.5" xref="A2.SS1.p1.8.m8.3.3.2.3.cmml">,</mo><msub id="A2.SS1.p1.8.m8.3.3.2.2.2" xref="A2.SS1.p1.8.m8.3.3.2.2.2.cmml"><mi id="A2.SS1.p1.8.m8.3.3.2.2.2.2" xref="A2.SS1.p1.8.m8.3.3.2.2.2.2.cmml">b</mi><mi id="A2.SS1.p1.8.m8.3.3.2.2.2.3" xref="A2.SS1.p1.8.m8.3.3.2.2.2.3.cmml">d</mi></msub><mo stretchy="false" id="A2.SS1.p1.8.m8.3.3.2.2.6" xref="A2.SS1.p1.8.m8.3.3.2.3.cmml">)</mo></mrow><mo id="A2.SS1.p1.8.m8.3.3.6" xref="A2.SS1.p1.8.m8.3.3.6.cmml">∈</mo><msup id="A2.SS1.p1.8.m8.3.3.7" xref="A2.SS1.p1.8.m8.3.3.7.cmml"><mi id="A2.SS1.p1.8.m8.3.3.7.2" xref="A2.SS1.p1.8.m8.3.3.7.2.cmml">ℝ</mi><mrow id="A2.SS1.p1.8.m8.3.3.7.3" xref="A2.SS1.p1.8.m8.3.3.7.3.cmml"><mi id="A2.SS1.p1.8.m8.3.3.7.3.2" xref="A2.SS1.p1.8.m8.3.3.7.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p1.8.m8.3.3.7.3.1" xref="A2.SS1.p1.8.m8.3.3.7.3.1.cmml">×</mo><mi id="A2.SS1.p1.8.m8.3.3.7.3.3" xref="A2.SS1.p1.8.m8.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.8.m8.3b"><apply id="A2.SS1.p1.8.m8.3.3.cmml" xref="A2.SS1.p1.8.m8.3.3"><and id="A2.SS1.p1.8.m8.3.3a.cmml" xref="A2.SS1.p1.8.m8.3.3"></and><apply id="A2.SS1.p1.8.m8.3.3b.cmml" xref="A2.SS1.p1.8.m8.3.3"><eq id="A2.SS1.p1.8.m8.3.3.5.cmml" xref="A2.SS1.p1.8.m8.3.3.5"></eq><ci id="A2.SS1.p1.8.m8.3.3.4.cmml" xref="A2.SS1.p1.8.m8.3.3.4">𝐵</ci><vector id="A2.SS1.p1.8.m8.3.3.2.3.cmml" xref="A2.SS1.p1.8.m8.3.3.2.2"><apply id="A2.SS1.p1.8.m8.2.2.1.1.1.cmml" xref="A2.SS1.p1.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.2.2.1.1.1.1.cmml" xref="A2.SS1.p1.8.m8.2.2.1.1.1">subscript</csymbol><ci id="A2.SS1.p1.8.m8.2.2.1.1.1.2.cmml" xref="A2.SS1.p1.8.m8.2.2.1.1.1.2">𝑏</ci><cn type="integer" id="A2.SS1.p1.8.m8.2.2.1.1.1.3.cmml" xref="A2.SS1.p1.8.m8.2.2.1.1.1.3">1</cn></apply><ci id="A2.SS1.p1.8.m8.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1">…</ci><apply id="A2.SS1.p1.8.m8.3.3.2.2.2.cmml" xref="A2.SS1.p1.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.3.3.2.2.2.1.cmml" xref="A2.SS1.p1.8.m8.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p1.8.m8.3.3.2.2.2.2.cmml" xref="A2.SS1.p1.8.m8.3.3.2.2.2.2">𝑏</ci><ci id="A2.SS1.p1.8.m8.3.3.2.2.2.3.cmml" xref="A2.SS1.p1.8.m8.3.3.2.2.2.3">𝑑</ci></apply></vector></apply><apply id="A2.SS1.p1.8.m8.3.3c.cmml" xref="A2.SS1.p1.8.m8.3.3"><in id="A2.SS1.p1.8.m8.3.3.6.cmml" xref="A2.SS1.p1.8.m8.3.3.6"></in><share href="#A2.SS1.p1.8.m8.3.3.2.cmml" id="A2.SS1.p1.8.m8.3.3d.cmml" xref="A2.SS1.p1.8.m8.3.3"></share><apply id="A2.SS1.p1.8.m8.3.3.7.cmml" xref="A2.SS1.p1.8.m8.3.3.7"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.3.3.7.1.cmml" xref="A2.SS1.p1.8.m8.3.3.7">superscript</csymbol><ci id="A2.SS1.p1.8.m8.3.3.7.2.cmml" xref="A2.SS1.p1.8.m8.3.3.7.2">ℝ</ci><apply id="A2.SS1.p1.8.m8.3.3.7.3.cmml" xref="A2.SS1.p1.8.m8.3.3.7.3"><times id="A2.SS1.p1.8.m8.3.3.7.3.1.cmml" xref="A2.SS1.p1.8.m8.3.3.7.3.1"></times><ci id="A2.SS1.p1.8.m8.3.3.7.3.2.cmml" xref="A2.SS1.p1.8.m8.3.3.7.3.2">𝑛</ci><ci id="A2.SS1.p1.8.m8.3.3.7.3.3.cmml" xref="A2.SS1.p1.8.m8.3.3.7.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.8.m8.3c">B=(b_{1},\ldots,b_{d})\in\mathbb{R}^{n\times d}</annotation></semantics></math>.
For every data point <math id="A2.SS1.p1.9.m9.4" class="ltx_Math" alttext="(x,y)\in\mathbb{R}^{n}\times\{0,1\}" display="inline"><semantics id="A2.SS1.p1.9.m9.4a"><mrow id="A2.SS1.p1.9.m9.4.5" xref="A2.SS1.p1.9.m9.4.5.cmml"><mrow id="A2.SS1.p1.9.m9.4.5.2.2" xref="A2.SS1.p1.9.m9.4.5.2.1.cmml"><mo stretchy="false" id="A2.SS1.p1.9.m9.4.5.2.2.1" xref="A2.SS1.p1.9.m9.4.5.2.1.cmml">(</mo><mi id="A2.SS1.p1.9.m9.1.1" xref="A2.SS1.p1.9.m9.1.1.cmml">x</mi><mo id="A2.SS1.p1.9.m9.4.5.2.2.2" xref="A2.SS1.p1.9.m9.4.5.2.1.cmml">,</mo><mi id="A2.SS1.p1.9.m9.2.2" xref="A2.SS1.p1.9.m9.2.2.cmml">y</mi><mo stretchy="false" id="A2.SS1.p1.9.m9.4.5.2.2.3" xref="A2.SS1.p1.9.m9.4.5.2.1.cmml">)</mo></mrow><mo id="A2.SS1.p1.9.m9.4.5.1" xref="A2.SS1.p1.9.m9.4.5.1.cmml">∈</mo><mrow id="A2.SS1.p1.9.m9.4.5.3" xref="A2.SS1.p1.9.m9.4.5.3.cmml"><msup id="A2.SS1.p1.9.m9.4.5.3.2" xref="A2.SS1.p1.9.m9.4.5.3.2.cmml"><mi id="A2.SS1.p1.9.m9.4.5.3.2.2" xref="A2.SS1.p1.9.m9.4.5.3.2.2.cmml">ℝ</mi><mi id="A2.SS1.p1.9.m9.4.5.3.2.3" xref="A2.SS1.p1.9.m9.4.5.3.2.3.cmml">n</mi></msup><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p1.9.m9.4.5.3.1" xref="A2.SS1.p1.9.m9.4.5.3.1.cmml">×</mo><mrow id="A2.SS1.p1.9.m9.4.5.3.3.2" xref="A2.SS1.p1.9.m9.4.5.3.3.1.cmml"><mo stretchy="false" id="A2.SS1.p1.9.m9.4.5.3.3.2.1" xref="A2.SS1.p1.9.m9.4.5.3.3.1.cmml">{</mo><mn id="A2.SS1.p1.9.m9.3.3" xref="A2.SS1.p1.9.m9.3.3.cmml">0</mn><mo id="A2.SS1.p1.9.m9.4.5.3.3.2.2" xref="A2.SS1.p1.9.m9.4.5.3.3.1.cmml">,</mo><mn id="A2.SS1.p1.9.m9.4.4" xref="A2.SS1.p1.9.m9.4.4.cmml">1</mn><mo stretchy="false" id="A2.SS1.p1.9.m9.4.5.3.3.2.3" xref="A2.SS1.p1.9.m9.4.5.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.9.m9.4b"><apply id="A2.SS1.p1.9.m9.4.5.cmml" xref="A2.SS1.p1.9.m9.4.5"><in id="A2.SS1.p1.9.m9.4.5.1.cmml" xref="A2.SS1.p1.9.m9.4.5.1"></in><interval closure="open" id="A2.SS1.p1.9.m9.4.5.2.1.cmml" xref="A2.SS1.p1.9.m9.4.5.2.2"><ci id="A2.SS1.p1.9.m9.1.1.cmml" xref="A2.SS1.p1.9.m9.1.1">𝑥</ci><ci id="A2.SS1.p1.9.m9.2.2.cmml" xref="A2.SS1.p1.9.m9.2.2">𝑦</ci></interval><apply id="A2.SS1.p1.9.m9.4.5.3.cmml" xref="A2.SS1.p1.9.m9.4.5.3"><times id="A2.SS1.p1.9.m9.4.5.3.1.cmml" xref="A2.SS1.p1.9.m9.4.5.3.1"></times><apply id="A2.SS1.p1.9.m9.4.5.3.2.cmml" xref="A2.SS1.p1.9.m9.4.5.3.2"><csymbol cd="ambiguous" id="A2.SS1.p1.9.m9.4.5.3.2.1.cmml" xref="A2.SS1.p1.9.m9.4.5.3.2">superscript</csymbol><ci id="A2.SS1.p1.9.m9.4.5.3.2.2.cmml" xref="A2.SS1.p1.9.m9.4.5.3.2.2">ℝ</ci><ci id="A2.SS1.p1.9.m9.4.5.3.2.3.cmml" xref="A2.SS1.p1.9.m9.4.5.3.2.3">𝑛</ci></apply><set id="A2.SS1.p1.9.m9.4.5.3.3.1.cmml" xref="A2.SS1.p1.9.m9.4.5.3.3.2"><cn type="integer" id="A2.SS1.p1.9.m9.3.3.cmml" xref="A2.SS1.p1.9.m9.3.3">0</cn><cn type="integer" id="A2.SS1.p1.9.m9.4.4.cmml" xref="A2.SS1.p1.9.m9.4.4">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.9.m9.4c">(x,y)\in\mathbb{R}^{n}\times\{0,1\}</annotation></semantics></math>, the label <math id="A2.SS1.p1.10.m10.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A2.SS1.p1.10.m10.1a"><mi id="A2.SS1.p1.10.m10.1.1" xref="A2.SS1.p1.10.m10.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.10.m10.1b"><ci id="A2.SS1.p1.10.m10.1.1.cmml" xref="A2.SS1.p1.10.m10.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.10.m10.1c">y</annotation></semantics></math> is correlated only with the projection of <math id="A2.SS1.p1.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.SS1.p1.11.m11.1a"><mi id="A2.SS1.p1.11.m11.1.1" xref="A2.SS1.p1.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.11.m11.1b"><ci id="A2.SS1.p1.11.m11.1.1.cmml" xref="A2.SS1.p1.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.11.m11.1c">x</annotation></semantics></math> onto the space spanned by <math id="A2.SS1.p1.12.m12.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A2.SS1.p1.12.m12.1a"><mi id="A2.SS1.p1.12.m12.1.1" xref="A2.SS1.p1.12.m12.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.12.m12.1b"><ci id="A2.SS1.p1.12.m12.1.1.cmml" xref="A2.SS1.p1.12.m12.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.12.m12.1c">B</annotation></semantics></math>, and the orthogonal component to <math id="A2.SS1.p1.13.m13.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A2.SS1.p1.13.m13.1a"><mi id="A2.SS1.p1.13.m13.1.1" xref="A2.SS1.p1.13.m13.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.13.m13.1b"><ci id="A2.SS1.p1.13.m13.1.1.cmml" xref="A2.SS1.p1.13.m13.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.13.m13.1c">B</annotation></semantics></math> is assumed to be a nuisance variable.</p>
</div>
<div id="A2.SS1.p2" class="ltx_para">
<p id="A2.SS1.p2.3" class="ltx_p">The data generation for the two classes is as follows:</p>
<ol id="A2.I1" class="ltx_enumerate">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.6" class="ltx_p">For the label <math id="A2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="y=0" display="inline"><semantics id="A2.I1.i1.p1.1.m1.1a"><mrow id="A2.I1.i1.p1.1.m1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.cmml"><mi id="A2.I1.i1.p1.1.m1.1.1.2" xref="A2.I1.i1.p1.1.m1.1.1.2.cmml">y</mi><mo id="A2.I1.i1.p1.1.m1.1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.I1.i1.p1.1.m1.1.1.3" xref="A2.I1.i1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.1b"><apply id="A2.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1"><eq id="A2.I1.i1.p1.1.m1.1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1"></eq><ci id="A2.I1.i1.p1.1.m1.1.1.2.cmml" xref="A2.I1.i1.p1.1.m1.1.1.2">𝑦</ci><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.3.cmml" xref="A2.I1.i1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.1c">y=0</annotation></semantics></math>, the projection of <math id="A2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.I1.i1.p1.2.m2.1a"><mi id="A2.I1.i1.p1.2.m2.1.1" xref="A2.I1.i1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.2.m2.1b"><ci id="A2.I1.i1.p1.2.m2.1.1.cmml" xref="A2.I1.i1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.2.m2.1c">x</annotation></semantics></math> onto the <math id="A2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.I1.i1.p1.3.m3.1a"><mi id="A2.I1.i1.p1.3.m3.1.1" xref="A2.I1.i1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.3.m3.1b"><ci id="A2.I1.i1.p1.3.m3.1.1.cmml" xref="A2.I1.i1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.3.m3.1c">d</annotation></semantics></math>-dimensional subspace <math id="A2.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A2.I1.i1.p1.4.m4.1a"><mi id="A2.I1.i1.p1.4.m4.1.1" xref="A2.I1.i1.p1.4.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.4.m4.1b"><ci id="A2.I1.i1.p1.4.m4.1.1.cmml" xref="A2.I1.i1.p1.4.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.4.m4.1c">B</annotation></semantics></math> follows an isotropic Normal distribution centered at the origin, i.e. <math id="A2.I1.i1.p1.5.m5.2" class="ltx_Math" alttext="Bx\sim\mathcal{N}(\mathbf{0},\sigma_{0}^{2}\mathbf{I}_{d})" display="inline"><semantics id="A2.I1.i1.p1.5.m5.2a"><mrow id="A2.I1.i1.p1.5.m5.2.2" xref="A2.I1.i1.p1.5.m5.2.2.cmml"><mrow id="A2.I1.i1.p1.5.m5.2.2.3" xref="A2.I1.i1.p1.5.m5.2.2.3.cmml"><mi id="A2.I1.i1.p1.5.m5.2.2.3.2" xref="A2.I1.i1.p1.5.m5.2.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.I1.i1.p1.5.m5.2.2.3.1" xref="A2.I1.i1.p1.5.m5.2.2.3.1.cmml">​</mo><mi id="A2.I1.i1.p1.5.m5.2.2.3.3" xref="A2.I1.i1.p1.5.m5.2.2.3.3.cmml">x</mi></mrow><mo id="A2.I1.i1.p1.5.m5.2.2.2" xref="A2.I1.i1.p1.5.m5.2.2.2.cmml">∼</mo><mrow id="A2.I1.i1.p1.5.m5.2.2.1" xref="A2.I1.i1.p1.5.m5.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i1.p1.5.m5.2.2.1.3" xref="A2.I1.i1.p1.5.m5.2.2.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.I1.i1.p1.5.m5.2.2.1.2" xref="A2.I1.i1.p1.5.m5.2.2.1.2.cmml">​</mo><mrow id="A2.I1.i1.p1.5.m5.2.2.1.1.1" xref="A2.I1.i1.p1.5.m5.2.2.1.1.2.cmml"><mo stretchy="false" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.2" xref="A2.I1.i1.p1.5.m5.2.2.1.1.2.cmml">(</mo><mn id="A2.I1.i1.p1.5.m5.1.1" xref="A2.I1.i1.p1.5.m5.1.1.cmml">𝟎</mn><mo id="A2.I1.i1.p1.5.m5.2.2.1.1.1.3" xref="A2.I1.i1.p1.5.m5.2.2.1.1.2.cmml">,</mo><mrow id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.cmml"><msubsup id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.cmml"><mi id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.2" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.2.cmml">σ</mi><mn id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.3" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.3.cmml">0</mn><mn id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.3" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.1" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.1.cmml">​</mo><msub id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.cmml"><mi id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.2" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.2.cmml">𝐈</mi><mi id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.3" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.3.cmml">d</mi></msub></mrow><mo stretchy="false" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.4" xref="A2.I1.i1.p1.5.m5.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.5.m5.2b"><apply id="A2.I1.i1.p1.5.m5.2.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2"><csymbol cd="latexml" id="A2.I1.i1.p1.5.m5.2.2.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.2">similar-to</csymbol><apply id="A2.I1.i1.p1.5.m5.2.2.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.3"><times id="A2.I1.i1.p1.5.m5.2.2.3.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.3.1"></times><ci id="A2.I1.i1.p1.5.m5.2.2.3.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.3.2">𝐵</ci><ci id="A2.I1.i1.p1.5.m5.2.2.3.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.3.3">𝑥</ci></apply><apply id="A2.I1.i1.p1.5.m5.2.2.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1"><times id="A2.I1.i1.p1.5.m5.2.2.1.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.2"></times><ci id="A2.I1.i1.p1.5.m5.2.2.1.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.3">𝒩</ci><interval closure="open" id="A2.I1.i1.p1.5.m5.2.2.1.1.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1"><cn type="integer" id="A2.I1.i1.p1.5.m5.1.1.cmml" xref="A2.I1.i1.p1.5.m5.1.1">0</cn><apply id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1"><times id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.1"></times><apply id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2">superscript</csymbol><apply id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2">subscript</csymbol><ci id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.2">𝜎</ci><cn type="integer" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.2.3">0</cn></apply><cn type="integer" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.2.3">2</cn></apply><apply id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.1.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3">subscript</csymbol><ci id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.2.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.2">𝐈</ci><ci id="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.3.cmml" xref="A2.I1.i1.p1.5.m5.2.2.1.1.1.1.3.3">𝑑</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.5.m5.2c">Bx\sim\mathcal{N}(\mathbf{0},\sigma_{0}^{2}\mathbf{I}_{d})</annotation></semantics></math>, with <math id="A2.I1.i1.p1.6.m6.1" class="ltx_Math" alttext="\sigma_{0}^{2}=2" display="inline"><semantics id="A2.I1.i1.p1.6.m6.1a"><mrow id="A2.I1.i1.p1.6.m6.1.1" xref="A2.I1.i1.p1.6.m6.1.1.cmml"><msubsup id="A2.I1.i1.p1.6.m6.1.1.2" xref="A2.I1.i1.p1.6.m6.1.1.2.cmml"><mi id="A2.I1.i1.p1.6.m6.1.1.2.2.2" xref="A2.I1.i1.p1.6.m6.1.1.2.2.2.cmml">σ</mi><mn id="A2.I1.i1.p1.6.m6.1.1.2.2.3" xref="A2.I1.i1.p1.6.m6.1.1.2.2.3.cmml">0</mn><mn id="A2.I1.i1.p1.6.m6.1.1.2.3" xref="A2.I1.i1.p1.6.m6.1.1.2.3.cmml">2</mn></msubsup><mo id="A2.I1.i1.p1.6.m6.1.1.1" xref="A2.I1.i1.p1.6.m6.1.1.1.cmml">=</mo><mn id="A2.I1.i1.p1.6.m6.1.1.3" xref="A2.I1.i1.p1.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.6.m6.1b"><apply id="A2.I1.i1.p1.6.m6.1.1.cmml" xref="A2.I1.i1.p1.6.m6.1.1"><eq id="A2.I1.i1.p1.6.m6.1.1.1.cmml" xref="A2.I1.i1.p1.6.m6.1.1.1"></eq><apply id="A2.I1.i1.p1.6.m6.1.1.2.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i1.p1.6.m6.1.1.2.1.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2">superscript</csymbol><apply id="A2.I1.i1.p1.6.m6.1.1.2.2.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i1.p1.6.m6.1.1.2.2.1.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2">subscript</csymbol><ci id="A2.I1.i1.p1.6.m6.1.1.2.2.2.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2.2.2">𝜎</ci><cn type="integer" id="A2.I1.i1.p1.6.m6.1.1.2.2.3.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2.2.3">0</cn></apply><cn type="integer" id="A2.I1.i1.p1.6.m6.1.1.2.3.cmml" xref="A2.I1.i1.p1.6.m6.1.1.2.3">2</cn></apply><cn type="integer" id="A2.I1.i1.p1.6.m6.1.1.3.cmml" xref="A2.I1.i1.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.6.m6.1c">\sigma_{0}^{2}=2</annotation></semantics></math>.</p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.13" class="ltx_p">For the label <math id="A2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="y=1" display="inline"><semantics id="A2.I1.i2.p1.1.m1.1a"><mrow id="A2.I1.i2.p1.1.m1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.cmml"><mi id="A2.I1.i2.p1.1.m1.1.1.2" xref="A2.I1.i2.p1.1.m1.1.1.2.cmml">y</mi><mo id="A2.I1.i2.p1.1.m1.1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.I1.i2.p1.1.m1.1.1.3" xref="A2.I1.i2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.1b"><apply id="A2.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1"><eq id="A2.I1.i2.p1.1.m1.1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1.1"></eq><ci id="A2.I1.i2.p1.1.m1.1.1.2.cmml" xref="A2.I1.i2.p1.1.m1.1.1.2">𝑦</ci><cn type="integer" id="A2.I1.i2.p1.1.m1.1.1.3.cmml" xref="A2.I1.i2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.1c">y=1</annotation></semantics></math>, the projection of <math id="A2.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.I1.i2.p1.2.m2.1a"><mi id="A2.I1.i2.p1.2.m2.1.1" xref="A2.I1.i2.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.2.m2.1b"><ci id="A2.I1.i2.p1.2.m2.1.1.cmml" xref="A2.I1.i2.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.2.m2.1c">x</annotation></semantics></math> onto the <math id="A2.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.I1.i2.p1.3.m3.1a"><mi id="A2.I1.i2.p1.3.m3.1.1" xref="A2.I1.i2.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.3.m3.1b"><ci id="A2.I1.i2.p1.3.m3.1.1.cmml" xref="A2.I1.i2.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.3.m3.1c">d</annotation></semantics></math>-dimensional subspace <math id="A2.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A2.I1.i2.p1.4.m4.1a"><mi id="A2.I1.i2.p1.4.m4.1.1" xref="A2.I1.i2.p1.4.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.4.m4.1b"><ci id="A2.I1.i2.p1.4.m4.1.1.cmml" xref="A2.I1.i2.p1.4.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.4.m4.1c">B</annotation></semantics></math> is distributed around the <math id="A2.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="(d-1)" display="inline"><semantics id="A2.I1.i2.p1.5.m5.1a"><mrow id="A2.I1.i2.p1.5.m5.1.1.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="A2.I1.i2.p1.5.m5.1.1.1.2" xref="A2.I1.i2.p1.5.m5.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i2.p1.5.m5.1.1.1.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.5.m5.1.1.1.1.2" xref="A2.I1.i2.p1.5.m5.1.1.1.1.2.cmml">d</mi><mo id="A2.I1.i2.p1.5.m5.1.1.1.1.1" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml">−</mo><mn id="A2.I1.i2.p1.5.m5.1.1.1.1.3" xref="A2.I1.i2.p1.5.m5.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.I1.i2.p1.5.m5.1.1.1.3" xref="A2.I1.i2.p1.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.5.m5.1b"><apply id="A2.I1.i2.p1.5.m5.1.1.1.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1"><minus id="A2.I1.i2.p1.5.m5.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.1"></minus><ci id="A2.I1.i2.p1.5.m5.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.2">𝑑</ci><cn type="integer" id="A2.I1.i2.p1.5.m5.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.5.m5.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.5.m5.1c">(d-1)</annotation></semantics></math>-dimensional sphere of radius <math id="A2.I1.i2.p1.6.m6.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A2.I1.i2.p1.6.m6.1a"><mn id="A2.I1.i2.p1.6.m6.1.1" xref="A2.I1.i2.p1.6.m6.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.6.m6.1b"><cn type="integer" id="A2.I1.i2.p1.6.m6.1.1.cmml" xref="A2.I1.i2.p1.6.m6.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.6.m6.1c">8</annotation></semantics></math> as follows: <math id="A2.I1.i2.p1.7.m7.2" class="ltx_Math" alttext="\frac{Bx}{\|Bx\|}\sim\mathcal{U}(\mathbb{S}^{d-1})" display="inline"><semantics id="A2.I1.i2.p1.7.m7.2a"><mrow id="A2.I1.i2.p1.7.m7.2.2" xref="A2.I1.i2.p1.7.m7.2.2.cmml"><mfrac id="A2.I1.i2.p1.7.m7.1.1" xref="A2.I1.i2.p1.7.m7.1.1.cmml"><mrow id="A2.I1.i2.p1.7.m7.1.1.3" xref="A2.I1.i2.p1.7.m7.1.1.3.cmml"><mi id="A2.I1.i2.p1.7.m7.1.1.3.2" xref="A2.I1.i2.p1.7.m7.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.7.m7.1.1.3.1" xref="A2.I1.i2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="A2.I1.i2.p1.7.m7.1.1.3.3" xref="A2.I1.i2.p1.7.m7.1.1.3.3.cmml">x</mi></mrow><mrow id="A2.I1.i2.p1.7.m7.1.1.1.1" xref="A2.I1.i2.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="A2.I1.i2.p1.7.m7.1.1.1.1.2" xref="A2.I1.i2.p1.7.m7.1.1.1.2.1.cmml">‖</mo><mrow id="A2.I1.i2.p1.7.m7.1.1.1.1.1" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.7.m7.1.1.1.1.1.2" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.7.m7.1.1.1.1.1.1" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.1.cmml">​</mo><mi id="A2.I1.i2.p1.7.m7.1.1.1.1.1.3" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="A2.I1.i2.p1.7.m7.1.1.1.1.3" xref="A2.I1.i2.p1.7.m7.1.1.1.2.1.cmml">‖</mo></mrow></mfrac><mo id="A2.I1.i2.p1.7.m7.2.2.2" xref="A2.I1.i2.p1.7.m7.2.2.2.cmml">∼</mo><mrow id="A2.I1.i2.p1.7.m7.2.2.1" xref="A2.I1.i2.p1.7.m7.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.7.m7.2.2.1.3" xref="A2.I1.i2.p1.7.m7.2.2.1.3.cmml">𝒰</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.7.m7.2.2.1.2" xref="A2.I1.i2.p1.7.m7.2.2.1.2.cmml">​</mo><mrow id="A2.I1.i2.p1.7.m7.2.2.1.1.1" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A2.I1.i2.p1.7.m7.2.2.1.1.1.2" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.cmml">(</mo><msup id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.2" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.2.cmml">𝕊</mi><mrow id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.cmml"><mi id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.2" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.2.cmml">d</mi><mo id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.1" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.3" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="A2.I1.i2.p1.7.m7.2.2.1.1.1.3" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.7.m7.2b"><apply id="A2.I1.i2.p1.7.m7.2.2.cmml" xref="A2.I1.i2.p1.7.m7.2.2"><csymbol cd="latexml" id="A2.I1.i2.p1.7.m7.2.2.2.cmml" xref="A2.I1.i2.p1.7.m7.2.2.2">similar-to</csymbol><apply id="A2.I1.i2.p1.7.m7.1.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1"><divide id="A2.I1.i2.p1.7.m7.1.1.2.cmml" xref="A2.I1.i2.p1.7.m7.1.1"></divide><apply id="A2.I1.i2.p1.7.m7.1.1.3.cmml" xref="A2.I1.i2.p1.7.m7.1.1.3"><times id="A2.I1.i2.p1.7.m7.1.1.3.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1.3.1"></times><ci id="A2.I1.i2.p1.7.m7.1.1.3.2.cmml" xref="A2.I1.i2.p1.7.m7.1.1.3.2">𝐵</ci><ci id="A2.I1.i2.p1.7.m7.1.1.3.3.cmml" xref="A2.I1.i2.p1.7.m7.1.1.3.3">𝑥</ci></apply><apply id="A2.I1.i2.p1.7.m7.1.1.1.2.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="A2.I1.i2.p1.7.m7.1.1.1.2.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1.2">norm</csymbol><apply id="A2.I1.i2.p1.7.m7.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1"><times id="A2.I1.i2.p1.7.m7.1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.1"></times><ci id="A2.I1.i2.p1.7.m7.1.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.2">𝐵</ci><ci id="A2.I1.i2.p1.7.m7.1.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="A2.I1.i2.p1.7.m7.2.2.1.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1"><times id="A2.I1.i2.p1.7.m7.2.2.1.2.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.2"></times><ci id="A2.I1.i2.p1.7.m7.2.2.1.3.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.3">𝒰</ci><apply id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1">superscript</csymbol><ci id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.2">𝕊</ci><apply id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3"><minus id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.1.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.1"></minus><ci id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.2.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.2">𝑑</ci><cn type="integer" id="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.3.cmml" xref="A2.I1.i2.p1.7.m7.2.2.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.7.m7.2c">\frac{Bx}{\|Bx\|}\sim\mathcal{U}(\mathbb{S}^{d-1})</annotation></semantics></math>, where <math id="A2.I1.i2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{U}(\mathbb{S}^{d-1})" display="inline"><semantics id="A2.I1.i2.p1.8.m8.1a"><mrow id="A2.I1.i2.p1.8.m8.1.1" xref="A2.I1.i2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.8.m8.1.1.3" xref="A2.I1.i2.p1.8.m8.1.1.3.cmml">𝒰</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.8.m8.1.1.2" xref="A2.I1.i2.p1.8.m8.1.1.2.cmml">​</mo><mrow id="A2.I1.i2.p1.8.m8.1.1.1.1" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.I1.i2.p1.8.m8.1.1.1.1.2" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.cmml">(</mo><msup id="A2.I1.i2.p1.8.m8.1.1.1.1.1" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.8.m8.1.1.1.1.1.2" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.2.cmml">𝕊</mi><mrow id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.2" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.2.cmml">d</mi><mo id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.1" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.1.cmml">−</mo><mn id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.3" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="A2.I1.i2.p1.8.m8.1.1.1.1.3" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.8.m8.1b"><apply id="A2.I1.i2.p1.8.m8.1.1.cmml" xref="A2.I1.i2.p1.8.m8.1.1"><times id="A2.I1.i2.p1.8.m8.1.1.2.cmml" xref="A2.I1.i2.p1.8.m8.1.1.2"></times><ci id="A2.I1.i2.p1.8.m8.1.1.3.cmml" xref="A2.I1.i2.p1.8.m8.1.1.3">𝒰</ci><apply id="A2.I1.i2.p1.8.m8.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="A2.I1.i2.p1.8.m8.1.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1">superscript</csymbol><ci id="A2.I1.i2.p1.8.m8.1.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.2">𝕊</ci><apply id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3"><minus id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.1"></minus><ci id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.2">𝑑</ci><cn type="integer" id="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="A2.I1.i2.p1.8.m8.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.8.m8.1c">\mathcal{U}(\mathbb{S}^{d-1})</annotation></semantics></math> denotes the uniform distribution on the unit <math id="A2.I1.i2.p1.9.m9.1" class="ltx_Math" alttext="(d-1)" display="inline"><semantics id="A2.I1.i2.p1.9.m9.1a"><mrow id="A2.I1.i2.p1.9.m9.1.1.1" xref="A2.I1.i2.p1.9.m9.1.1.1.1.cmml"><mo stretchy="false" id="A2.I1.i2.p1.9.m9.1.1.1.2" xref="A2.I1.i2.p1.9.m9.1.1.1.1.cmml">(</mo><mrow id="A2.I1.i2.p1.9.m9.1.1.1.1" xref="A2.I1.i2.p1.9.m9.1.1.1.1.cmml"><mi id="A2.I1.i2.p1.9.m9.1.1.1.1.2" xref="A2.I1.i2.p1.9.m9.1.1.1.1.2.cmml">d</mi><mo id="A2.I1.i2.p1.9.m9.1.1.1.1.1" xref="A2.I1.i2.p1.9.m9.1.1.1.1.1.cmml">−</mo><mn id="A2.I1.i2.p1.9.m9.1.1.1.1.3" xref="A2.I1.i2.p1.9.m9.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.I1.i2.p1.9.m9.1.1.1.3" xref="A2.I1.i2.p1.9.m9.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.9.m9.1b"><apply id="A2.I1.i2.p1.9.m9.1.1.1.1.cmml" xref="A2.I1.i2.p1.9.m9.1.1.1"><minus id="A2.I1.i2.p1.9.m9.1.1.1.1.1.cmml" xref="A2.I1.i2.p1.9.m9.1.1.1.1.1"></minus><ci id="A2.I1.i2.p1.9.m9.1.1.1.1.2.cmml" xref="A2.I1.i2.p1.9.m9.1.1.1.1.2">𝑑</ci><cn type="integer" id="A2.I1.i2.p1.9.m9.1.1.1.1.3.cmml" xref="A2.I1.i2.p1.9.m9.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.9.m9.1c">(d-1)</annotation></semantics></math>-dimensional sphere, and the norm of <math id="A2.I1.i2.p1.10.m10.1" class="ltx_Math" alttext="Bx" display="inline"><semantics id="A2.I1.i2.p1.10.m10.1a"><mrow id="A2.I1.i2.p1.10.m10.1.1" xref="A2.I1.i2.p1.10.m10.1.1.cmml"><mi id="A2.I1.i2.p1.10.m10.1.1.2" xref="A2.I1.i2.p1.10.m10.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.10.m10.1.1.1" xref="A2.I1.i2.p1.10.m10.1.1.1.cmml">​</mo><mi id="A2.I1.i2.p1.10.m10.1.1.3" xref="A2.I1.i2.p1.10.m10.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.10.m10.1b"><apply id="A2.I1.i2.p1.10.m10.1.1.cmml" xref="A2.I1.i2.p1.10.m10.1.1"><times id="A2.I1.i2.p1.10.m10.1.1.1.cmml" xref="A2.I1.i2.p1.10.m10.1.1.1"></times><ci id="A2.I1.i2.p1.10.m10.1.1.2.cmml" xref="A2.I1.i2.p1.10.m10.1.1.2">𝐵</ci><ci id="A2.I1.i2.p1.10.m10.1.1.3.cmml" xref="A2.I1.i2.p1.10.m10.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.10.m10.1c">Bx</annotation></semantics></math> is normally distributed around <math id="A2.I1.i2.p1.11.m11.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A2.I1.i2.p1.11.m11.1a"><mn id="A2.I1.i2.p1.11.m11.1.1" xref="A2.I1.i2.p1.11.m11.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.11.m11.1b"><cn type="integer" id="A2.I1.i2.p1.11.m11.1.1.cmml" xref="A2.I1.i2.p1.11.m11.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.11.m11.1c">8</annotation></semantics></math>, i.e. <math id="A2.I1.i2.p1.12.m12.3" class="ltx_Math" alttext="\|Bx\|\sim\mathcal{N}(8,\sigma_{1}^{2}\mathbf{I}_{d})" display="inline"><semantics id="A2.I1.i2.p1.12.m12.3a"><mrow id="A2.I1.i2.p1.12.m12.3.3" xref="A2.I1.i2.p1.12.m12.3.3.cmml"><mrow id="A2.I1.i2.p1.12.m12.2.2.1.1" xref="A2.I1.i2.p1.12.m12.2.2.1.2.cmml"><mo stretchy="false" id="A2.I1.i2.p1.12.m12.2.2.1.1.2" xref="A2.I1.i2.p1.12.m12.2.2.1.2.1.cmml">‖</mo><mrow id="A2.I1.i2.p1.12.m12.2.2.1.1.1" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.cmml"><mi id="A2.I1.i2.p1.12.m12.2.2.1.1.1.2" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.12.m12.2.2.1.1.1.1" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.1.cmml">​</mo><mi id="A2.I1.i2.p1.12.m12.2.2.1.1.1.3" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="A2.I1.i2.p1.12.m12.2.2.1.1.3" xref="A2.I1.i2.p1.12.m12.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A2.I1.i2.p1.12.m12.3.3.3" xref="A2.I1.i2.p1.12.m12.3.3.3.cmml">∼</mo><mrow id="A2.I1.i2.p1.12.m12.3.3.2" xref="A2.I1.i2.p1.12.m12.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.I1.i2.p1.12.m12.3.3.2.3" xref="A2.I1.i2.p1.12.m12.3.3.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.12.m12.3.3.2.2" xref="A2.I1.i2.p1.12.m12.3.3.2.2.cmml">​</mo><mrow id="A2.I1.i2.p1.12.m12.3.3.2.1.1" xref="A2.I1.i2.p1.12.m12.3.3.2.1.2.cmml"><mo stretchy="false" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.2" xref="A2.I1.i2.p1.12.m12.3.3.2.1.2.cmml">(</mo><mn id="A2.I1.i2.p1.12.m12.1.1" xref="A2.I1.i2.p1.12.m12.1.1.cmml">8</mn><mo id="A2.I1.i2.p1.12.m12.3.3.2.1.1.3" xref="A2.I1.i2.p1.12.m12.3.3.2.1.2.cmml">,</mo><mrow id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.cmml"><msubsup id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.cmml"><mi id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.2" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.2.cmml">σ</mi><mn id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.3" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.3.cmml">1</mn><mn id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.3" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.1" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.1.cmml">​</mo><msub id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.cmml"><mi id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.2" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.2.cmml">𝐈</mi><mi id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.3" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.3.cmml">d</mi></msub></mrow><mo stretchy="false" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.4" xref="A2.I1.i2.p1.12.m12.3.3.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.12.m12.3b"><apply id="A2.I1.i2.p1.12.m12.3.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3"><csymbol cd="latexml" id="A2.I1.i2.p1.12.m12.3.3.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.3">similar-to</csymbol><apply id="A2.I1.i2.p1.12.m12.2.2.1.2.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1"><csymbol cd="latexml" id="A2.I1.i2.p1.12.m12.2.2.1.2.1.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1.2">norm</csymbol><apply id="A2.I1.i2.p1.12.m12.2.2.1.1.1.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1"><times id="A2.I1.i2.p1.12.m12.2.2.1.1.1.1.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.1"></times><ci id="A2.I1.i2.p1.12.m12.2.2.1.1.1.2.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.2">𝐵</ci><ci id="A2.I1.i2.p1.12.m12.2.2.1.1.1.3.cmml" xref="A2.I1.i2.p1.12.m12.2.2.1.1.1.3">𝑥</ci></apply></apply><apply id="A2.I1.i2.p1.12.m12.3.3.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2"><times id="A2.I1.i2.p1.12.m12.3.3.2.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.2"></times><ci id="A2.I1.i2.p1.12.m12.3.3.2.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.3">𝒩</ci><interval closure="open" id="A2.I1.i2.p1.12.m12.3.3.2.1.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1"><cn type="integer" id="A2.I1.i2.p1.12.m12.1.1.cmml" xref="A2.I1.i2.p1.12.m12.1.1">8</cn><apply id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1"><times id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.1.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.1"></times><apply id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.1.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2">superscript</csymbol><apply id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.1.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2">subscript</csymbol><ci id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.2">𝜎</ci><cn type="integer" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.2.3">1</cn></apply><cn type="integer" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.2.3">2</cn></apply><apply id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.1.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3">subscript</csymbol><ci id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.2.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.2">𝐈</ci><ci id="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.3.cmml" xref="A2.I1.i2.p1.12.m12.3.3.2.1.1.1.3.3">𝑑</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.12.m12.3c">\|Bx\|\sim\mathcal{N}(8,\sigma_{1}^{2}\mathbf{I}_{d})</annotation></semantics></math>, with <math id="A2.I1.i2.p1.13.m13.1" class="ltx_Math" alttext="\sigma_{1}^{2}=2" display="inline"><semantics id="A2.I1.i2.p1.13.m13.1a"><mrow id="A2.I1.i2.p1.13.m13.1.1" xref="A2.I1.i2.p1.13.m13.1.1.cmml"><msubsup id="A2.I1.i2.p1.13.m13.1.1.2" xref="A2.I1.i2.p1.13.m13.1.1.2.cmml"><mi id="A2.I1.i2.p1.13.m13.1.1.2.2.2" xref="A2.I1.i2.p1.13.m13.1.1.2.2.2.cmml">σ</mi><mn id="A2.I1.i2.p1.13.m13.1.1.2.2.3" xref="A2.I1.i2.p1.13.m13.1.1.2.2.3.cmml">1</mn><mn id="A2.I1.i2.p1.13.m13.1.1.2.3" xref="A2.I1.i2.p1.13.m13.1.1.2.3.cmml">2</mn></msubsup><mo id="A2.I1.i2.p1.13.m13.1.1.1" xref="A2.I1.i2.p1.13.m13.1.1.1.cmml">=</mo><mn id="A2.I1.i2.p1.13.m13.1.1.3" xref="A2.I1.i2.p1.13.m13.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.13.m13.1b"><apply id="A2.I1.i2.p1.13.m13.1.1.cmml" xref="A2.I1.i2.p1.13.m13.1.1"><eq id="A2.I1.i2.p1.13.m13.1.1.1.cmml" xref="A2.I1.i2.p1.13.m13.1.1.1"></eq><apply id="A2.I1.i2.p1.13.m13.1.1.2.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.13.m13.1.1.2.1.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2">superscript</csymbol><apply id="A2.I1.i2.p1.13.m13.1.1.2.2.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="A2.I1.i2.p1.13.m13.1.1.2.2.1.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2">subscript</csymbol><ci id="A2.I1.i2.p1.13.m13.1.1.2.2.2.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2.2.2">𝜎</ci><cn type="integer" id="A2.I1.i2.p1.13.m13.1.1.2.2.3.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2.2.3">1</cn></apply><cn type="integer" id="A2.I1.i2.p1.13.m13.1.1.2.3.cmml" xref="A2.I1.i2.p1.13.m13.1.1.2.3">2</cn></apply><cn type="integer" id="A2.I1.i2.p1.13.m13.1.1.3.cmml" xref="A2.I1.i2.p1.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.13.m13.1c">\sigma_{1}^{2}=2</annotation></semantics></math>.</p>
</div>
</li>
</ol>
<p id="A2.SS1.p2.2" class="ltx_p">In both cases, the projection of the vector of features onto the orthogonal space to <math id="A2.SS1.p2.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A2.SS1.p2.1.m1.1a"><mi id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><ci id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">B</annotation></semantics></math> follows a Normal distribution <math id="A2.SS1.p2.2.m2.2" class="ltx_Math" alttext="\mathcal{N}(\mathbf{0},\sigma_{0}^{2}\mathbf{I}_{n-d})" display="inline"><semantics id="A2.SS1.p2.2.m2.2a"><mrow id="A2.SS1.p2.2.m2.2.2" xref="A2.SS1.p2.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.2.m2.2.2.3" xref="A2.SS1.p2.2.m2.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p2.2.m2.2.2.2" xref="A2.SS1.p2.2.m2.2.2.2.cmml">​</mo><mrow id="A2.SS1.p2.2.m2.2.2.1.1" xref="A2.SS1.p2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="A2.SS1.p2.2.m2.2.2.1.1.2" xref="A2.SS1.p2.2.m2.2.2.1.2.cmml">(</mo><mn id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml">𝟎</mn><mo id="A2.SS1.p2.2.m2.2.2.1.1.3" xref="A2.SS1.p2.2.m2.2.2.1.2.cmml">,</mo><mrow id="A2.SS1.p2.2.m2.2.2.1.1.1" xref="A2.SS1.p2.2.m2.2.2.1.1.1.cmml"><msubsup id="A2.SS1.p2.2.m2.2.2.1.1.1.2" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.cmml"><mi id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.2" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.2.cmml">σ</mi><mn id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.3" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.3.cmml">0</mn><mn id="A2.SS1.p2.2.m2.2.2.1.1.1.2.3" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="A2.SS1.p2.2.m2.2.2.1.1.1.1" xref="A2.SS1.p2.2.m2.2.2.1.1.1.1.cmml">​</mo><msub id="A2.SS1.p2.2.m2.2.2.1.1.1.3" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.cmml"><mi id="A2.SS1.p2.2.m2.2.2.1.1.1.3.2" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.2.cmml">𝐈</mi><mrow id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.cmml"><mi id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.2" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.2.cmml">n</mi><mo id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.1" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.1.cmml">−</mo><mi id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.3" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.3.cmml">d</mi></mrow></msub></mrow><mo stretchy="false" id="A2.SS1.p2.2.m2.2.2.1.1.4" xref="A2.SS1.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.2b"><apply id="A2.SS1.p2.2.m2.2.2.cmml" xref="A2.SS1.p2.2.m2.2.2"><times id="A2.SS1.p2.2.m2.2.2.2.cmml" xref="A2.SS1.p2.2.m2.2.2.2"></times><ci id="A2.SS1.p2.2.m2.2.2.3.cmml" xref="A2.SS1.p2.2.m2.2.2.3">𝒩</ci><interval closure="open" id="A2.SS1.p2.2.m2.2.2.1.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1"><cn type="integer" id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1">0</cn><apply id="A2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1"><times id="A2.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.1"></times><apply id="A2.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2">superscript</csymbol><apply id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.2">𝜎</ci><cn type="integer" id="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.3.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.2.3">0</cn></apply><cn type="integer" id="A2.SS1.p2.2.m2.2.2.1.1.1.2.3.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.2.3">2</cn></apply><apply id="A2.SS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.2.2.1.1.1.3.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="A2.SS1.p2.2.m2.2.2.1.1.1.3.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.2">𝐈</ci><apply id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3"><minus id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.1.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.1"></minus><ci id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.2.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.2">𝑛</ci><ci id="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.3.cmml" xref="A2.SS1.p2.2.m2.2.2.1.1.1.3.3.3">𝑑</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.2c">\mathcal{N}(\mathbf{0},\sigma_{0}^{2}\mathbf{I}_{n-d})</annotation></semantics></math>.</p>
</div>
<div id="A2.SS1.p3" class="ltx_para">
<p id="A2.SS1.p3.7" class="ltx_p">In this way, the binary classification task consists of separating the feature vectors <math id="A2.SS1.p3.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.SS1.p3.1.m1.1a"><mi id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><ci id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">x</annotation></semantics></math> such that <math id="A2.SS1.p3.2.m2.1" class="ltx_Math" alttext="Bx" display="inline"><semantics id="A2.SS1.p3.2.m2.1a"><mrow id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml"><mi id="A2.SS1.p3.2.m2.1.1.2" xref="A2.SS1.p3.2.m2.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.2.m2.1.1.1" xref="A2.SS1.p3.2.m2.1.1.1.cmml">​</mo><mi id="A2.SS1.p3.2.m2.1.1.3" xref="A2.SS1.p3.2.m2.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><apply id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1"><times id="A2.SS1.p3.2.m2.1.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1.1"></times><ci id="A2.SS1.p3.2.m2.1.1.2.cmml" xref="A2.SS1.p3.2.m2.1.1.2">𝐵</ci><ci id="A2.SS1.p3.2.m2.1.1.3.cmml" xref="A2.SS1.p3.2.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">Bx</annotation></semantics></math> is close to <math id="A2.SS1.p3.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A2.SS1.p3.3.m3.1a"><mn id="A2.SS1.p3.3.m3.1.1" xref="A2.SS1.p3.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.3.m3.1b"><cn type="integer" id="A2.SS1.p3.3.m3.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1">0</cn></annotation-xml></semantics></math> from those such that <math id="A2.SS1.p3.4.m4.1" class="ltx_Math" alttext="Bx" display="inline"><semantics id="A2.SS1.p3.4.m4.1a"><mrow id="A2.SS1.p3.4.m4.1.1" xref="A2.SS1.p3.4.m4.1.1.cmml"><mi id="A2.SS1.p3.4.m4.1.1.2" xref="A2.SS1.p3.4.m4.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p3.4.m4.1.1.1" xref="A2.SS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="A2.SS1.p3.4.m4.1.1.3" xref="A2.SS1.p3.4.m4.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.4.m4.1b"><apply id="A2.SS1.p3.4.m4.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1"><times id="A2.SS1.p3.4.m4.1.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1.1"></times><ci id="A2.SS1.p3.4.m4.1.1.2.cmml" xref="A2.SS1.p3.4.m4.1.1.2">𝐵</ci><ci id="A2.SS1.p3.4.m4.1.1.3.cmml" xref="A2.SS1.p3.4.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.4.m4.1c">Bx</annotation></semantics></math> is close to the <math id="A2.SS1.p3.5.m5.1" class="ltx_Math" alttext="(d-1)" display="inline"><semantics id="A2.SS1.p3.5.m5.1a"><mrow id="A2.SS1.p3.5.m5.1.1.1" xref="A2.SS1.p3.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="A2.SS1.p3.5.m5.1.1.1.2" xref="A2.SS1.p3.5.m5.1.1.1.1.cmml">(</mo><mrow id="A2.SS1.p3.5.m5.1.1.1.1" xref="A2.SS1.p3.5.m5.1.1.1.1.cmml"><mi id="A2.SS1.p3.5.m5.1.1.1.1.2" xref="A2.SS1.p3.5.m5.1.1.1.1.2.cmml">d</mi><mo id="A2.SS1.p3.5.m5.1.1.1.1.1" xref="A2.SS1.p3.5.m5.1.1.1.1.1.cmml">−</mo><mn id="A2.SS1.p3.5.m5.1.1.1.1.3" xref="A2.SS1.p3.5.m5.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A2.SS1.p3.5.m5.1.1.1.3" xref="A2.SS1.p3.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.5.m5.1b"><apply id="A2.SS1.p3.5.m5.1.1.1.1.cmml" xref="A2.SS1.p3.5.m5.1.1.1"><minus id="A2.SS1.p3.5.m5.1.1.1.1.1.cmml" xref="A2.SS1.p3.5.m5.1.1.1.1.1"></minus><ci id="A2.SS1.p3.5.m5.1.1.1.1.2.cmml" xref="A2.SS1.p3.5.m5.1.1.1.1.2">𝑑</ci><cn type="integer" id="A2.SS1.p3.5.m5.1.1.1.1.3.cmml" xref="A2.SS1.p3.5.m5.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.5.m5.1c">(d-1)</annotation></semantics></math>- dimensional sphere of radius 8, where <math id="A2.SS1.p3.6.m6.3" class="ltx_Math" alttext="B=(b_{1},\ldots,b_{d})" display="inline"><semantics id="A2.SS1.p3.6.m6.3a"><mrow id="A2.SS1.p3.6.m6.3.3" xref="A2.SS1.p3.6.m6.3.3.cmml"><mi id="A2.SS1.p3.6.m6.3.3.4" xref="A2.SS1.p3.6.m6.3.3.4.cmml">B</mi><mo id="A2.SS1.p3.6.m6.3.3.3" xref="A2.SS1.p3.6.m6.3.3.3.cmml">=</mo><mrow id="A2.SS1.p3.6.m6.3.3.2.2" xref="A2.SS1.p3.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="A2.SS1.p3.6.m6.3.3.2.2.3" xref="A2.SS1.p3.6.m6.3.3.2.3.cmml">(</mo><msub id="A2.SS1.p3.6.m6.2.2.1.1.1" xref="A2.SS1.p3.6.m6.2.2.1.1.1.cmml"><mi id="A2.SS1.p3.6.m6.2.2.1.1.1.2" xref="A2.SS1.p3.6.m6.2.2.1.1.1.2.cmml">b</mi><mn id="A2.SS1.p3.6.m6.2.2.1.1.1.3" xref="A2.SS1.p3.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A2.SS1.p3.6.m6.3.3.2.2.4" xref="A2.SS1.p3.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS1.p3.6.m6.1.1" xref="A2.SS1.p3.6.m6.1.1.cmml">…</mi><mo id="A2.SS1.p3.6.m6.3.3.2.2.5" xref="A2.SS1.p3.6.m6.3.3.2.3.cmml">,</mo><msub id="A2.SS1.p3.6.m6.3.3.2.2.2" xref="A2.SS1.p3.6.m6.3.3.2.2.2.cmml"><mi id="A2.SS1.p3.6.m6.3.3.2.2.2.2" xref="A2.SS1.p3.6.m6.3.3.2.2.2.2.cmml">b</mi><mi id="A2.SS1.p3.6.m6.3.3.2.2.2.3" xref="A2.SS1.p3.6.m6.3.3.2.2.2.3.cmml">d</mi></msub><mo stretchy="false" id="A2.SS1.p3.6.m6.3.3.2.2.6" xref="A2.SS1.p3.6.m6.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.6.m6.3b"><apply id="A2.SS1.p3.6.m6.3.3.cmml" xref="A2.SS1.p3.6.m6.3.3"><eq id="A2.SS1.p3.6.m6.3.3.3.cmml" xref="A2.SS1.p3.6.m6.3.3.3"></eq><ci id="A2.SS1.p3.6.m6.3.3.4.cmml" xref="A2.SS1.p3.6.m6.3.3.4">𝐵</ci><vector id="A2.SS1.p3.6.m6.3.3.2.3.cmml" xref="A2.SS1.p3.6.m6.3.3.2.2"><apply id="A2.SS1.p3.6.m6.2.2.1.1.1.cmml" xref="A2.SS1.p3.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p3.6.m6.2.2.1.1.1.1.cmml" xref="A2.SS1.p3.6.m6.2.2.1.1.1">subscript</csymbol><ci id="A2.SS1.p3.6.m6.2.2.1.1.1.2.cmml" xref="A2.SS1.p3.6.m6.2.2.1.1.1.2">𝑏</ci><cn type="integer" id="A2.SS1.p3.6.m6.2.2.1.1.1.3.cmml" xref="A2.SS1.p3.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="A2.SS1.p3.6.m6.1.1.cmml" xref="A2.SS1.p3.6.m6.1.1">…</ci><apply id="A2.SS1.p3.6.m6.3.3.2.2.2.cmml" xref="A2.SS1.p3.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p3.6.m6.3.3.2.2.2.1.cmml" xref="A2.SS1.p3.6.m6.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p3.6.m6.3.3.2.2.2.2.cmml" xref="A2.SS1.p3.6.m6.3.3.2.2.2.2">𝑏</ci><ci id="A2.SS1.p3.6.m6.3.3.2.2.2.3.cmml" xref="A2.SS1.p3.6.m6.3.3.2.2.2.3">𝑑</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.6.m6.3c">B=(b_{1},\ldots,b_{d})</annotation></semantics></math> is an unknown <math id="A2.SS1.p3.7.m7.1" class="ltx_Math" alttext="n\times d" display="inline"><semantics id="A2.SS1.p3.7.m7.1a"><mrow id="A2.SS1.p3.7.m7.1.1" xref="A2.SS1.p3.7.m7.1.1.cmml"><mi id="A2.SS1.p3.7.m7.1.1.2" xref="A2.SS1.p3.7.m7.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p3.7.m7.1.1.1" xref="A2.SS1.p3.7.m7.1.1.1.cmml">×</mo><mi id="A2.SS1.p3.7.m7.1.1.3" xref="A2.SS1.p3.7.m7.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.7.m7.1b"><apply id="A2.SS1.p3.7.m7.1.1.cmml" xref="A2.SS1.p3.7.m7.1.1"><times id="A2.SS1.p3.7.m7.1.1.1.cmml" xref="A2.SS1.p3.7.m7.1.1.1"></times><ci id="A2.SS1.p3.7.m7.1.1.2.cmml" xref="A2.SS1.p3.7.m7.1.1.2">𝑛</ci><ci id="A2.SS1.p3.7.m7.1.1.3.cmml" xref="A2.SS1.p3.7.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.7.m7.1c">n\times d</annotation></semantics></math> matrix with orthonormal columns.</p>
</div>
<div id="A2.SS1.p4" class="ltx_para">
<p id="A2.SS1.p4.7" class="ltx_p">This data generation process is repeated independently for each of the <math id="A2.SS1.p4.1.m1.1" class="ltx_Math" alttext="q=10" display="inline"><semantics id="A2.SS1.p4.1.m1.1a"><mrow id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mi id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml">q</mi><mo id="A2.SS1.p4.1.m1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><eq id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1"></eq><ci id="A2.SS1.p4.1.m1.1.1.2.cmml" xref="A2.SS1.p4.1.m1.1.1.2">𝑞</ci><cn type="integer" id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">q=10</annotation></semantics></math> clients, with the number of samples per machine determined by a split ratio. Finally, in order to simulate Feature Distribution Skew across the clients, for each client, the vector of features <math id="A2.SS1.p4.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.SS1.p4.2.m2.1a"><mi id="A2.SS1.p4.2.m2.1.1" xref="A2.SS1.p4.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.1b"><ci id="A2.SS1.p4.2.m2.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.1c">x</annotation></semantics></math> is further transformed by an affine transformation <math id="A2.SS1.p4.3.m3.1" class="ltx_Math" alttext="Ax+b" display="inline"><semantics id="A2.SS1.p4.3.m3.1a"><mrow id="A2.SS1.p4.3.m3.1.1" xref="A2.SS1.p4.3.m3.1.1.cmml"><mrow id="A2.SS1.p4.3.m3.1.1.2" xref="A2.SS1.p4.3.m3.1.1.2.cmml"><mi id="A2.SS1.p4.3.m3.1.1.2.2" xref="A2.SS1.p4.3.m3.1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p4.3.m3.1.1.2.1" xref="A2.SS1.p4.3.m3.1.1.2.1.cmml">​</mo><mi id="A2.SS1.p4.3.m3.1.1.2.3" xref="A2.SS1.p4.3.m3.1.1.2.3.cmml">x</mi></mrow><mo id="A2.SS1.p4.3.m3.1.1.1" xref="A2.SS1.p4.3.m3.1.1.1.cmml">+</mo><mi id="A2.SS1.p4.3.m3.1.1.3" xref="A2.SS1.p4.3.m3.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.3.m3.1b"><apply id="A2.SS1.p4.3.m3.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1"><plus id="A2.SS1.p4.3.m3.1.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1.1"></plus><apply id="A2.SS1.p4.3.m3.1.1.2.cmml" xref="A2.SS1.p4.3.m3.1.1.2"><times id="A2.SS1.p4.3.m3.1.1.2.1.cmml" xref="A2.SS1.p4.3.m3.1.1.2.1"></times><ci id="A2.SS1.p4.3.m3.1.1.2.2.cmml" xref="A2.SS1.p4.3.m3.1.1.2.2">𝐴</ci><ci id="A2.SS1.p4.3.m3.1.1.2.3.cmml" xref="A2.SS1.p4.3.m3.1.1.2.3">𝑥</ci></apply><ci id="A2.SS1.p4.3.m3.1.1.3.cmml" xref="A2.SS1.p4.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.3.m3.1c">Ax+b</annotation></semantics></math>, where <math id="A2.SS1.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{A}\in\mathbb{R}^{n\times n}" display="inline"><semantics id="A2.SS1.p4.4.m4.1a"><mrow id="A2.SS1.p4.4.m4.1.1" xref="A2.SS1.p4.4.m4.1.1.cmml"><mi id="A2.SS1.p4.4.m4.1.1.2" xref="A2.SS1.p4.4.m4.1.1.2.cmml">𝐀</mi><mo id="A2.SS1.p4.4.m4.1.1.1" xref="A2.SS1.p4.4.m4.1.1.1.cmml">∈</mo><msup id="A2.SS1.p4.4.m4.1.1.3" xref="A2.SS1.p4.4.m4.1.1.3.cmml"><mi id="A2.SS1.p4.4.m4.1.1.3.2" xref="A2.SS1.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="A2.SS1.p4.4.m4.1.1.3.3" xref="A2.SS1.p4.4.m4.1.1.3.3.cmml"><mi id="A2.SS1.p4.4.m4.1.1.3.3.2" xref="A2.SS1.p4.4.m4.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p4.4.m4.1.1.3.3.1" xref="A2.SS1.p4.4.m4.1.1.3.3.1.cmml">×</mo><mi id="A2.SS1.p4.4.m4.1.1.3.3.3" xref="A2.SS1.p4.4.m4.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.4.m4.1b"><apply id="A2.SS1.p4.4.m4.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1"><in id="A2.SS1.p4.4.m4.1.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1.1"></in><ci id="A2.SS1.p4.4.m4.1.1.2.cmml" xref="A2.SS1.p4.4.m4.1.1.2">𝐀</ci><apply id="A2.SS1.p4.4.m4.1.1.3.cmml" xref="A2.SS1.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p4.4.m4.1.1.3.1.cmml" xref="A2.SS1.p4.4.m4.1.1.3">superscript</csymbol><ci id="A2.SS1.p4.4.m4.1.1.3.2.cmml" xref="A2.SS1.p4.4.m4.1.1.3.2">ℝ</ci><apply id="A2.SS1.p4.4.m4.1.1.3.3.cmml" xref="A2.SS1.p4.4.m4.1.1.3.3"><times id="A2.SS1.p4.4.m4.1.1.3.3.1.cmml" xref="A2.SS1.p4.4.m4.1.1.3.3.1"></times><ci id="A2.SS1.p4.4.m4.1.1.3.3.2.cmml" xref="A2.SS1.p4.4.m4.1.1.3.3.2">𝑛</ci><ci id="A2.SS1.p4.4.m4.1.1.3.3.3.cmml" xref="A2.SS1.p4.4.m4.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.4.m4.1c">\mathbf{A}\in\mathbb{R}^{n\times n}</annotation></semantics></math> is a random matrix and <math id="A2.SS1.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{b}\in\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p4.5.m5.1a"><mrow id="A2.SS1.p4.5.m5.1.1" xref="A2.SS1.p4.5.m5.1.1.cmml"><mi id="A2.SS1.p4.5.m5.1.1.2" xref="A2.SS1.p4.5.m5.1.1.2.cmml">𝐛</mi><mo id="A2.SS1.p4.5.m5.1.1.1" xref="A2.SS1.p4.5.m5.1.1.1.cmml">∈</mo><msup id="A2.SS1.p4.5.m5.1.1.3" xref="A2.SS1.p4.5.m5.1.1.3.cmml"><mi id="A2.SS1.p4.5.m5.1.1.3.2" xref="A2.SS1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="A2.SS1.p4.5.m5.1.1.3.3" xref="A2.SS1.p4.5.m5.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.5.m5.1b"><apply id="A2.SS1.p4.5.m5.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1"><in id="A2.SS1.p4.5.m5.1.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1.1"></in><ci id="A2.SS1.p4.5.m5.1.1.2.cmml" xref="A2.SS1.p4.5.m5.1.1.2">𝐛</ci><apply id="A2.SS1.p4.5.m5.1.1.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p4.5.m5.1.1.3.1.cmml" xref="A2.SS1.p4.5.m5.1.1.3">superscript</csymbol><ci id="A2.SS1.p4.5.m5.1.1.3.2.cmml" xref="A2.SS1.p4.5.m5.1.1.3.2">ℝ</ci><ci id="A2.SS1.p4.5.m5.1.1.3.3.cmml" xref="A2.SS1.p4.5.m5.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.5.m5.1c">\mathbf{b}\in\mathbb{R}^{n}</annotation></semantics></math> is a random vector that scales with the client index. The matrix <math id="A2.SS1.p4.6.m6.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A2.SS1.p4.6.m6.1a"><mi id="A2.SS1.p4.6.m6.1.1" xref="A2.SS1.p4.6.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.6.m6.1b"><ci id="A2.SS1.p4.6.m6.1.1.cmml" xref="A2.SS1.p4.6.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.6.m6.1c">A</annotation></semantics></math> and the vector <math id="A2.SS1.p4.7.m7.1" class="ltx_Math" alttext="b" display="inline"><semantics id="A2.SS1.p4.7.m7.1a"><mi id="A2.SS1.p4.7.m7.1.1" xref="A2.SS1.p4.7.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.7.m7.1b"><ci id="A2.SS1.p4.7.m7.1.1.cmml" xref="A2.SS1.p4.7.m7.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.7.m7.1c">b</annotation></semantics></math> are different for each client.</p>
</div>
<div id="A2.SS1.p5" class="ltx_para">
<p id="A2.SS1.p5.3" class="ltx_p">The method introduces several types of data skew to simulate realistic FL non-IID scenarios. <span id="A2.SS1.p5.3.1" class="ltx_text ltx_font_bold">Feature Distribution Skew</span> is achieved by applying client-specific random affine transformations <math id="A2.SS1.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{x}\mapsto A\mathbf{x}+\mathbf{b}" display="inline"><semantics id="A2.SS1.p5.1.m1.1a"><mrow id="A2.SS1.p5.1.m1.1.1" xref="A2.SS1.p5.1.m1.1.1.cmml"><mi id="A2.SS1.p5.1.m1.1.1.2" xref="A2.SS1.p5.1.m1.1.1.2.cmml">𝐱</mi><mo stretchy="false" id="A2.SS1.p5.1.m1.1.1.1" xref="A2.SS1.p5.1.m1.1.1.1.cmml">↦</mo><mrow id="A2.SS1.p5.1.m1.1.1.3" xref="A2.SS1.p5.1.m1.1.1.3.cmml"><mrow id="A2.SS1.p5.1.m1.1.1.3.2" xref="A2.SS1.p5.1.m1.1.1.3.2.cmml"><mi id="A2.SS1.p5.1.m1.1.1.3.2.2" xref="A2.SS1.p5.1.m1.1.1.3.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p5.1.m1.1.1.3.2.1" xref="A2.SS1.p5.1.m1.1.1.3.2.1.cmml">​</mo><mi id="A2.SS1.p5.1.m1.1.1.3.2.3" xref="A2.SS1.p5.1.m1.1.1.3.2.3.cmml">𝐱</mi></mrow><mo id="A2.SS1.p5.1.m1.1.1.3.1" xref="A2.SS1.p5.1.m1.1.1.3.1.cmml">+</mo><mi id="A2.SS1.p5.1.m1.1.1.3.3" xref="A2.SS1.p5.1.m1.1.1.3.3.cmml">𝐛</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.1.m1.1b"><apply id="A2.SS1.p5.1.m1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1"><csymbol cd="latexml" id="A2.SS1.p5.1.m1.1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1.1">maps-to</csymbol><ci id="A2.SS1.p5.1.m1.1.1.2.cmml" xref="A2.SS1.p5.1.m1.1.1.2">𝐱</ci><apply id="A2.SS1.p5.1.m1.1.1.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3"><plus id="A2.SS1.p5.1.m1.1.1.3.1.cmml" xref="A2.SS1.p5.1.m1.1.1.3.1"></plus><apply id="A2.SS1.p5.1.m1.1.1.3.2.cmml" xref="A2.SS1.p5.1.m1.1.1.3.2"><times id="A2.SS1.p5.1.m1.1.1.3.2.1.cmml" xref="A2.SS1.p5.1.m1.1.1.3.2.1"></times><ci id="A2.SS1.p5.1.m1.1.1.3.2.2.cmml" xref="A2.SS1.p5.1.m1.1.1.3.2.2">𝐴</ci><ci id="A2.SS1.p5.1.m1.1.1.3.2.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3.2.3">𝐱</ci></apply><ci id="A2.SS1.p5.1.m1.1.1.3.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3.3">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.1.m1.1c">\mathbf{x}\mapsto A\mathbf{x}+\mathbf{b}</annotation></semantics></math> to the local data points, with <math id="A2.SS1.p5.2.m2.1" class="ltx_Math" alttext="A\in\mathbb{R}^{n\times n}" display="inline"><semantics id="A2.SS1.p5.2.m2.1a"><mrow id="A2.SS1.p5.2.m2.1.1" xref="A2.SS1.p5.2.m2.1.1.cmml"><mi id="A2.SS1.p5.2.m2.1.1.2" xref="A2.SS1.p5.2.m2.1.1.2.cmml">A</mi><mo id="A2.SS1.p5.2.m2.1.1.1" xref="A2.SS1.p5.2.m2.1.1.1.cmml">∈</mo><msup id="A2.SS1.p5.2.m2.1.1.3" xref="A2.SS1.p5.2.m2.1.1.3.cmml"><mi id="A2.SS1.p5.2.m2.1.1.3.2" xref="A2.SS1.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A2.SS1.p5.2.m2.1.1.3.3" xref="A2.SS1.p5.2.m2.1.1.3.3.cmml"><mi id="A2.SS1.p5.2.m2.1.1.3.3.2" xref="A2.SS1.p5.2.m2.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A2.SS1.p5.2.m2.1.1.3.3.1" xref="A2.SS1.p5.2.m2.1.1.3.3.1.cmml">×</mo><mi id="A2.SS1.p5.2.m2.1.1.3.3.3" xref="A2.SS1.p5.2.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.2.m2.1b"><apply id="A2.SS1.p5.2.m2.1.1.cmml" xref="A2.SS1.p5.2.m2.1.1"><in id="A2.SS1.p5.2.m2.1.1.1.cmml" xref="A2.SS1.p5.2.m2.1.1.1"></in><ci id="A2.SS1.p5.2.m2.1.1.2.cmml" xref="A2.SS1.p5.2.m2.1.1.2">𝐴</ci><apply id="A2.SS1.p5.2.m2.1.1.3.cmml" xref="A2.SS1.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p5.2.m2.1.1.3.1.cmml" xref="A2.SS1.p5.2.m2.1.1.3">superscript</csymbol><ci id="A2.SS1.p5.2.m2.1.1.3.2.cmml" xref="A2.SS1.p5.2.m2.1.1.3.2">ℝ</ci><apply id="A2.SS1.p5.2.m2.1.1.3.3.cmml" xref="A2.SS1.p5.2.m2.1.1.3.3"><times id="A2.SS1.p5.2.m2.1.1.3.3.1.cmml" xref="A2.SS1.p5.2.m2.1.1.3.3.1"></times><ci id="A2.SS1.p5.2.m2.1.1.3.3.2.cmml" xref="A2.SS1.p5.2.m2.1.1.3.3.2">𝑛</ci><ci id="A2.SS1.p5.2.m2.1.1.3.3.3.cmml" xref="A2.SS1.p5.2.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.2.m2.1c">A\in\mathbb{R}^{n\times n}</annotation></semantics></math> and <math id="A2.SS1.p5.3.m3.1" class="ltx_Math" alttext="\mathbf{b}\in\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p5.3.m3.1a"><mrow id="A2.SS1.p5.3.m3.1.1" xref="A2.SS1.p5.3.m3.1.1.cmml"><mi id="A2.SS1.p5.3.m3.1.1.2" xref="A2.SS1.p5.3.m3.1.1.2.cmml">𝐛</mi><mo id="A2.SS1.p5.3.m3.1.1.1" xref="A2.SS1.p5.3.m3.1.1.1.cmml">∈</mo><msup id="A2.SS1.p5.3.m3.1.1.3" xref="A2.SS1.p5.3.m3.1.1.3.cmml"><mi id="A2.SS1.p5.3.m3.1.1.3.2" xref="A2.SS1.p5.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="A2.SS1.p5.3.m3.1.1.3.3" xref="A2.SS1.p5.3.m3.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.3.m3.1b"><apply id="A2.SS1.p5.3.m3.1.1.cmml" xref="A2.SS1.p5.3.m3.1.1"><in id="A2.SS1.p5.3.m3.1.1.1.cmml" xref="A2.SS1.p5.3.m3.1.1.1"></in><ci id="A2.SS1.p5.3.m3.1.1.2.cmml" xref="A2.SS1.p5.3.m3.1.1.2">𝐛</ci><apply id="A2.SS1.p5.3.m3.1.1.3.cmml" xref="A2.SS1.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p5.3.m3.1.1.3.1.cmml" xref="A2.SS1.p5.3.m3.1.1.3">superscript</csymbol><ci id="A2.SS1.p5.3.m3.1.1.3.2.cmml" xref="A2.SS1.p5.3.m3.1.1.3.2">ℝ</ci><ci id="A2.SS1.p5.3.m3.1.1.3.3.cmml" xref="A2.SS1.p5.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.3.m3.1c">\mathbf{b}\in\mathbb{R}^{n}</annotation></semantics></math> varying between clients. This results in the data distribution shifts across clients.
<span id="A2.SS1.p5.3.2" class="ltx_text ltx_font_bold">Label Distribution Skew</span> and <span id="A2.SS1.p5.3.3" class="ltx_text ltx_font_bold">Quantity Skew</span> are simulated by varying the proportion of class 0 samples and the number of samples assigned to each client, respectively, on top of Feature Distribution Skew. This results in clients having different class proportions, feature distributions, and numbers of samples.</p>
</div>
<div id="A2.SS1.p6" class="ltx_para">
<p id="A2.SS1.p6.1" class="ltx_p">The method allows fine-grained control over the degree and nature of the induced data skew, enabling the generation of realistic synthetic federated datasets to study the impact of different non-IID data scenarios on the performance of FL algorithms.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Results in different non-IID scenarios</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Table <a href="#A2.T3" title="Table 3 ‣ B.2 Results in different non-IID scenarios ‣ Appendix B Supplementary material for the experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents the results for the feature distribution skew scenario, where clients have heterogeneous feature distributions. FedMAP consistently improves upon individual client training for all clients, validating its effectiveness in handling diverse feature distributions through personalized client models while leveraging the guidance of the global prior.</p>
</div>
<figure id="A2.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A2.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="A2.T3.3.2" class="ltx_text" style="font-size:90%;">Validation accuracies of FedMAP, FedBN, FedProx, FedAvg, and individual training on the synthetic dataset with feature distribution skew. Each client has a unique transformation applied to its local data, introducing heterogeneity in the feature space.</span></figcaption>
<table id="A2.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T3.4.1.1" class="ltx_tr">
<th id="A2.T3.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A2.T3.4.1.1.1.1" class="ltx_text ltx_font_bold">Client</span></th>
<th id="A2.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T3.4.1.1.2.1" class="ltx_text ltx_font_bold">Individual</span></th>
<th id="A2.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T3.4.1.1.3.1" class="ltx_text ltx_font_bold">FedMAP</span></th>
<th id="A2.T3.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T3.4.1.1.4.1" class="ltx_text ltx_font_bold">FedBN</span></th>
<th id="A2.T3.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T3.4.1.1.5.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="A2.T3.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T3.4.1.1.6.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T3.4.2.1" class="ltx_tr">
<th id="A2.T3.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1</th>
<td id="A2.T3.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">82.25%</td>
<td id="A2.T3.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">85.26% <span id="A2.T3.4.2.1.3.1" class="ltx_text" style="color:#00E000;">(↑ 3.01%)</span>
</td>
<td id="A2.T3.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">62.77%</td>
<td id="A2.T3.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t">58.44%</td>
<td id="A2.T3.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t">57.85%</td>
</tr>
<tr id="A2.T3.4.3.2" class="ltx_tr">
<th id="A2.T3.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">2</th>
<td id="A2.T3.4.3.2.2" class="ltx_td ltx_align_center">86.24%</td>
<td id="A2.T3.4.3.2.3" class="ltx_td ltx_align_center">88.94% <span id="A2.T3.4.3.2.3.1" class="ltx_text" style="color:#00E000;">(↑ 2.70%)</span>
</td>
<td id="A2.T3.4.3.2.4" class="ltx_td ltx_align_center">65.86%</td>
<td id="A2.T3.4.3.2.5" class="ltx_td ltx_align_center">64.28%</td>
<td id="A2.T3.4.3.2.6" class="ltx_td ltx_align_center">65.35%</td>
</tr>
<tr id="A2.T3.4.4.3" class="ltx_tr">
<th id="A2.T3.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">3</th>
<td id="A2.T3.4.4.3.2" class="ltx_td ltx_align_center">80.76%</td>
<td id="A2.T3.4.4.3.3" class="ltx_td ltx_align_center">83.70% <span id="A2.T3.4.4.3.3.1" class="ltx_text" style="color:#00E000;">(↑ 2.94%)</span>
</td>
<td id="A2.T3.4.4.3.4" class="ltx_td ltx_align_center">66.99%</td>
<td id="A2.T3.4.4.3.5" class="ltx_td ltx_align_center">65.99%</td>
<td id="A2.T3.4.4.3.6" class="ltx_td ltx_align_center">66.06%</td>
</tr>
<tr id="A2.T3.4.5.4" class="ltx_tr">
<th id="A2.T3.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">4</th>
<td id="A2.T3.4.5.4.2" class="ltx_td ltx_align_center">88.07%</td>
<td id="A2.T3.4.5.4.3" class="ltx_td ltx_align_center">89.70% <span id="A2.T3.4.5.4.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.63%)</span>
</td>
<td id="A2.T3.4.5.4.4" class="ltx_td ltx_align_center">65.32%</td>
<td id="A2.T3.4.5.4.5" class="ltx_td ltx_align_center">62.09%</td>
<td id="A2.T3.4.5.4.6" class="ltx_td ltx_align_center">63.46%</td>
</tr>
<tr id="A2.T3.4.6.5" class="ltx_tr">
<th id="A2.T3.4.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">5</th>
<td id="A2.T3.4.6.5.2" class="ltx_td ltx_align_center">83.03%</td>
<td id="A2.T3.4.6.5.3" class="ltx_td ltx_align_center">84.97% <span id="A2.T3.4.6.5.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.94%)</span>
</td>
<td id="A2.T3.4.6.5.4" class="ltx_td ltx_align_center">66.46%</td>
<td id="A2.T3.4.6.5.5" class="ltx_td ltx_align_center">64.78%</td>
<td id="A2.T3.4.6.5.6" class="ltx_td ltx_align_center">64.74%</td>
</tr>
<tr id="A2.T3.4.7.6" class="ltx_tr">
<th id="A2.T3.4.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">6</th>
<td id="A2.T3.4.7.6.2" class="ltx_td ltx_align_center">80.27%</td>
<td id="A2.T3.4.7.6.3" class="ltx_td ltx_align_center">83.39% <span id="A2.T3.4.7.6.3.1" class="ltx_text" style="color:#00E000;">(↑ 3.12%)</span>
</td>
<td id="A2.T3.4.7.6.4" class="ltx_td ltx_align_center">61.08%</td>
<td id="A2.T3.4.7.6.5" class="ltx_td ltx_align_center">58.92%</td>
<td id="A2.T3.4.7.6.6" class="ltx_td ltx_align_center">60.03%</td>
</tr>
<tr id="A2.T3.4.8.7" class="ltx_tr">
<th id="A2.T3.4.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">7</th>
<td id="A2.T3.4.8.7.2" class="ltx_td ltx_align_center">83.48%</td>
<td id="A2.T3.4.8.7.3" class="ltx_td ltx_align_center">86.55% <span id="A2.T3.4.8.7.3.1" class="ltx_text" style="color:#00E000;">(↑ 3.07%)</span>
</td>
<td id="A2.T3.4.8.7.4" class="ltx_td ltx_align_center">68.39%</td>
<td id="A2.T3.4.8.7.5" class="ltx_td ltx_align_center">67.34%</td>
<td id="A2.T3.4.8.7.6" class="ltx_td ltx_align_center">66.65%</td>
</tr>
<tr id="A2.T3.4.9.8" class="ltx_tr">
<th id="A2.T3.4.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">8</th>
<td id="A2.T3.4.9.8.2" class="ltx_td ltx_align_center">82.21%</td>
<td id="A2.T3.4.9.8.3" class="ltx_td ltx_align_center">85.38% <span id="A2.T3.4.9.8.3.1" class="ltx_text" style="color:#00E000;">(↑ 3.17%)</span>
</td>
<td id="A2.T3.4.9.8.4" class="ltx_td ltx_align_center">64.47%</td>
<td id="A2.T3.4.9.8.5" class="ltx_td ltx_align_center">61.25%</td>
<td id="A2.T3.4.9.8.6" class="ltx_td ltx_align_center">61.54%</td>
</tr>
<tr id="A2.T3.4.10.9" class="ltx_tr">
<th id="A2.T3.4.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">9</th>
<td id="A2.T3.4.10.9.2" class="ltx_td ltx_align_center">85.92%</td>
<td id="A2.T3.4.10.9.3" class="ltx_td ltx_align_center">87.45% <span id="A2.T3.4.10.9.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.53%)</span>
</td>
<td id="A2.T3.4.10.9.4" class="ltx_td ltx_align_center">66.16%</td>
<td id="A2.T3.4.10.9.5" class="ltx_td ltx_align_center">63.14%</td>
<td id="A2.T3.4.10.9.6" class="ltx_td ltx_align_center">63.55%</td>
</tr>
<tr id="A2.T3.4.11.10" class="ltx_tr">
<th id="A2.T3.4.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">10</th>
<td id="A2.T3.4.11.10.2" class="ltx_td ltx_align_center">85.78%</td>
<td id="A2.T3.4.11.10.3" class="ltx_td ltx_align_center">87.38% <span id="A2.T3.4.11.10.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.60%)</span>
</td>
<td id="A2.T3.4.11.10.4" class="ltx_td ltx_align_center">66.33%</td>
<td id="A2.T3.4.11.10.5" class="ltx_td ltx_align_center">63.77%</td>
<td id="A2.T3.4.11.10.6" class="ltx_td ltx_align_center">62.53%</td>
</tr>
<tr id="A2.T3.4.12.11" class="ltx_tr">
<th id="A2.T3.4.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="A2.T3.4.12.11.1.1" class="ltx_text ltx_font_bold">Average</span></th>
<td id="A2.T3.4.12.11.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">83.38%</td>
<td id="A2.T3.4.12.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">86.27%</td>
<td id="A2.T3.4.12.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">65.38%</td>
<td id="A2.T3.4.12.11.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">63.00%</td>
<td id="A2.T3.4.12.11.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">63.10%</td>
</tr>
</tbody>
</table>
</figure>
<div id="A2.SS2.p2" class="ltx_para">
<p id="A2.SS2.p2.1" class="ltx_p">Table <a href="#A2.T4" title="Table 4 ‣ B.2 Results in different non-IID scenarios ‣ Appendix B Supplementary material for the experiments ‣ FedMAP: Unlocking Potential in Personalized Federated Learning through Bi-Level MAP Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results for the quantity skew scenario, where some clients (6-10) have limited sample sizes (highlighted in red). FedMAP provides significant gains of up to 8.90% over individual training for clients 6-10, demonstrating its ability to effectively leverage information from clients with larger sample sizes.</p>
</div>
<figure id="A2.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A2.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="A2.T4.3.2" class="ltx_text" style="font-size:90%;">Validation accuracies of FedMAP, FedBN, FedProx, FedAvg, and individual training on the synthetic dataset with quantity skew. Clients 1-5 have 2000 samples each, while clients 6-10 (red) have only 500 samples each.</span></figcaption>
<table id="A2.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T4.4.1.1" class="ltx_tr">
<th id="A2.T4.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A2.T4.4.1.1.1.1" class="ltx_text ltx_font_bold">Client</span></th>
<th id="A2.T4.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T4.4.1.1.2.1" class="ltx_text ltx_font_bold">Individual</span></th>
<th id="A2.T4.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T4.4.1.1.3.1" class="ltx_text ltx_font_bold">FedMAP</span></th>
<th id="A2.T4.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T4.4.1.1.4.1" class="ltx_text ltx_font_bold">FedBN</span></th>
<th id="A2.T4.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T4.4.1.1.5.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="A2.T4.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T4.4.1.1.6.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T4.4.2.1" class="ltx_tr">
<th id="A2.T4.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1</th>
<td id="A2.T4.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">83.37%</td>
<td id="A2.T4.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">84.47% <span id="A2.T4.4.2.1.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.10%)</span>
</td>
<td id="A2.T4.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">67.69%</td>
<td id="A2.T4.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t">64.33%</td>
<td id="A2.T4.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t">66.45%</td>
</tr>
<tr id="A2.T4.4.3.2" class="ltx_tr">
<th id="A2.T4.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">2</th>
<td id="A2.T4.4.3.2.2" class="ltx_td ltx_align_center">88.10%</td>
<td id="A2.T4.4.3.2.3" class="ltx_td ltx_align_center">89.64% <span id="A2.T4.4.3.2.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.54%)</span>
</td>
<td id="A2.T4.4.3.2.4" class="ltx_td ltx_align_center">72.41%</td>
<td id="A2.T4.4.3.2.5" class="ltx_td ltx_align_center">70.10%</td>
<td id="A2.T4.4.3.2.6" class="ltx_td ltx_align_center">70.22%</td>
</tr>
<tr id="A2.T4.4.4.3" class="ltx_tr">
<th id="A2.T4.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">3</th>
<td id="A2.T4.4.4.3.2" class="ltx_td ltx_align_center">87.48%</td>
<td id="A2.T4.4.4.3.3" class="ltx_td ltx_align_center">88.88% <span id="A2.T4.4.4.3.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.40%)</span>
</td>
<td id="A2.T4.4.4.3.4" class="ltx_td ltx_align_center">73.74%</td>
<td id="A2.T4.4.4.3.5" class="ltx_td ltx_align_center">72.56%</td>
<td id="A2.T4.4.4.3.6" class="ltx_td ltx_align_center">71.08%</td>
</tr>
<tr id="A2.T4.4.5.4" class="ltx_tr">
<th id="A2.T4.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">4</th>
<td id="A2.T4.4.5.4.2" class="ltx_td ltx_align_center">84.40%</td>
<td id="A2.T4.4.5.4.3" class="ltx_td ltx_align_center">86.95% <span id="A2.T4.4.5.4.3.1" class="ltx_text" style="color:#00E000;">(↑ 2.55%)</span>
</td>
<td id="A2.T4.4.5.4.4" class="ltx_td ltx_align_center">71.38%</td>
<td id="A2.T4.4.5.4.5" class="ltx_td ltx_align_center">69.19%</td>
<td id="A2.T4.4.5.4.6" class="ltx_td ltx_align_center">68.82%</td>
</tr>
<tr id="A2.T4.4.6.5" class="ltx_tr">
<th id="A2.T4.4.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">5</th>
<td id="A2.T4.4.6.5.2" class="ltx_td ltx_align_center">78.47%</td>
<td id="A2.T4.4.6.5.3" class="ltx_td ltx_align_center">80.23% <span id="A2.T4.4.6.5.3.1" class="ltx_text" style="color:#00E000;">(↑ 1.76%)</span>
</td>
<td id="A2.T4.4.6.5.4" class="ltx_td ltx_align_center">66.96%</td>
<td id="A2.T4.4.6.5.5" class="ltx_td ltx_align_center">63.93%</td>
<td id="A2.T4.4.6.5.6" class="ltx_td ltx_align_center">62.76%</td>
</tr>
<tr id="A2.T4.4.7.6" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="A2.T4.4.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A2.T4.4.7.6.1.1" class="ltx_text" style="background-color:#FFCCCC;">6</span></th>
<td id="A2.T4.4.7.6.2" class="ltx_td ltx_align_center"><span id="A2.T4.4.7.6.2.1" class="ltx_text" style="background-color:#FFCCCC;">61.62%</span></td>
<td id="A2.T4.4.7.6.3" class="ltx_td ltx_align_center"><span id="A2.T4.4.7.6.3.1" class="ltx_text" style="background-color:#FFCCCC;">65.48% <span id="A2.T4.4.7.6.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 3.86%)</span></span></td>
<td id="A2.T4.4.7.6.4" class="ltx_td ltx_align_center"><span id="A2.T4.4.7.6.4.1" class="ltx_text" style="background-color:#FFCCCC;">56.28%</span></td>
<td id="A2.T4.4.7.6.5" class="ltx_td ltx_align_center"><span id="A2.T4.4.7.6.5.1" class="ltx_text" style="background-color:#FFCCCC;">54.49%</span></td>
<td id="A2.T4.4.7.6.6" class="ltx_td ltx_align_center"><span id="A2.T4.4.7.6.6.1" class="ltx_text" style="background-color:#FFCCCC;">53.96%</span></td>
</tr>
<tr id="A2.T4.4.8.7" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="A2.T4.4.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A2.T4.4.8.7.1.1" class="ltx_text" style="background-color:#FFCCCC;">7</span></th>
<td id="A2.T4.4.8.7.2" class="ltx_td ltx_align_center"><span id="A2.T4.4.8.7.2.1" class="ltx_text" style="background-color:#FFCCCC;">64.07%</span></td>
<td id="A2.T4.4.8.7.3" class="ltx_td ltx_align_center"><span id="A2.T4.4.8.7.3.1" class="ltx_text" style="background-color:#FFCCCC;">72.97% <span id="A2.T4.4.8.7.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 8.90%)</span></span></td>
<td id="A2.T4.4.8.7.4" class="ltx_td ltx_align_center"><span id="A2.T4.4.8.7.4.1" class="ltx_text" style="background-color:#FFCCCC;">54.96%</span></td>
<td id="A2.T4.4.8.7.5" class="ltx_td ltx_align_center"><span id="A2.T4.4.8.7.5.1" class="ltx_text" style="background-color:#FFCCCC;">56.05%</span></td>
<td id="A2.T4.4.8.7.6" class="ltx_td ltx_align_center"><span id="A2.T4.4.8.7.6.1" class="ltx_text" style="background-color:#FFCCCC;">55.02%</span></td>
</tr>
<tr id="A2.T4.4.9.8" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="A2.T4.4.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A2.T4.4.9.8.1.1" class="ltx_text" style="background-color:#FFCCCC;">8</span></th>
<td id="A2.T4.4.9.8.2" class="ltx_td ltx_align_center"><span id="A2.T4.4.9.8.2.1" class="ltx_text" style="background-color:#FFCCCC;">63.83%</span></td>
<td id="A2.T4.4.9.8.3" class="ltx_td ltx_align_center"><span id="A2.T4.4.9.8.3.1" class="ltx_text" style="background-color:#FFCCCC;">67.10% <span id="A2.T4.4.9.8.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 3.27%)</span></span></td>
<td id="A2.T4.4.9.8.4" class="ltx_td ltx_align_center"><span id="A2.T4.4.9.8.4.1" class="ltx_text" style="background-color:#FFCCCC;">48.58%</span></td>
<td id="A2.T4.4.9.8.5" class="ltx_td ltx_align_center"><span id="A2.T4.4.9.8.5.1" class="ltx_text" style="background-color:#FFCCCC;">45.45%</span></td>
<td id="A2.T4.4.9.8.6" class="ltx_td ltx_align_center"><span id="A2.T4.4.9.8.6.1" class="ltx_text" style="background-color:#FFCCCC;">46.33%</span></td>
</tr>
<tr id="A2.T4.4.10.9" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="A2.T4.4.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A2.T4.4.10.9.1.1" class="ltx_text" style="background-color:#FFCCCC;">9</span></th>
<td id="A2.T4.4.10.9.2" class="ltx_td ltx_align_center"><span id="A2.T4.4.10.9.2.1" class="ltx_text" style="background-color:#FFCCCC;">67.32%</span></td>
<td id="A2.T4.4.10.9.3" class="ltx_td ltx_align_center"><span id="A2.T4.4.10.9.3.1" class="ltx_text" style="background-color:#FFCCCC;">74.92% <span id="A2.T4.4.10.9.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 7.60%)</span></span></td>
<td id="A2.T4.4.10.9.4" class="ltx_td ltx_align_center"><span id="A2.T4.4.10.9.4.1" class="ltx_text" style="background-color:#FFCCCC;">62.26%</span></td>
<td id="A2.T4.4.10.9.5" class="ltx_td ltx_align_center"><span id="A2.T4.4.10.9.5.1" class="ltx_text" style="background-color:#FFCCCC;">60.37%</span></td>
<td id="A2.T4.4.10.9.6" class="ltx_td ltx_align_center"><span id="A2.T4.4.10.9.6.1" class="ltx_text" style="background-color:#FFCCCC;">61.03%</span></td>
</tr>
<tr id="A2.T4.4.11.10" class="ltx_tr" style="background-color:#FFCCCC;">
<th id="A2.T4.4.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A2.T4.4.11.10.1.1" class="ltx_text" style="background-color:#FFCCCC;">10</span></th>
<td id="A2.T4.4.11.10.2" class="ltx_td ltx_align_center"><span id="A2.T4.4.11.10.2.1" class="ltx_text" style="background-color:#FFCCCC;">64.04%</span></td>
<td id="A2.T4.4.11.10.3" class="ltx_td ltx_align_center"><span id="A2.T4.4.11.10.3.1" class="ltx_text" style="background-color:#FFCCCC;">71.74% <span id="A2.T4.4.11.10.3.1.1" class="ltx_text" style="color:#00E000;">(↑ 7.70%)</span></span></td>
<td id="A2.T4.4.11.10.4" class="ltx_td ltx_align_center"><span id="A2.T4.4.11.10.4.1" class="ltx_text" style="background-color:#FFCCCC;">61.99%</span></td>
<td id="A2.T4.4.11.10.5" class="ltx_td ltx_align_center"><span id="A2.T4.4.11.10.5.1" class="ltx_text" style="background-color:#FFCCCC;">57.03%</span></td>
<td id="A2.T4.4.11.10.6" class="ltx_td ltx_align_center"><span id="A2.T4.4.11.10.6.1" class="ltx_text" style="background-color:#FFCCCC;">59.73%</span></td>
</tr>
<tr id="A2.T4.4.12.11" class="ltx_tr">
<th id="A2.T4.4.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="A2.T4.4.12.11.1.1" class="ltx_text ltx_font_bold">Average</span></th>
<td id="A2.T4.4.12.11.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">75.37%</td>
<td id="A2.T4.4.12.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">79.06%</td>
<td id="A2.T4.4.12.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">63.80%</td>
<td id="A2.T4.4.12.11.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">61.54%</td>
<td id="A2.T4.4.12.11.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">61.88%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.18999" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.19000" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.19000">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.19000" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.19001" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 13:18:55 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
