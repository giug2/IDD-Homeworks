<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement</title>
<!--Generated on Tue May 14 18:20:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2404.18214v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S1" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S2" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S2.SS1" title="In 2 Related work ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S2.SS2" title="In 2 Related work ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Disentangled Representation Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S2.SS3" title="In 2 Related work ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Contrastive Self-Supervised Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S3" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S3.SS1" title="In 3 Preliminaries ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S3.SS2" title="In 3 Preliminaries ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Intention Disentanglement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S3.SS3" title="In 3 Preliminaries ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Contrastive Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS1" title="In 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Model Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS2" title="In 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Embedded Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS3" title="In 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Intention Disentanglement Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS4" title="In 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Contrastive Learning Layer</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS4.SSS1" title="In 4.4 Contrastive Learning Layer ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span><span class="ltx_text ltx_font_bold">Intention-based Contrastive Learning</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS4.SSS2" title="In 4.4 Contrastive Learning Layer ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span><span class="ltx_text ltx_font_bold">Sequence-based Contrastive Learning</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS5" title="In 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Multi-Task Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS1" title="In 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setting</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS1.SSS1" title="In 5.1 Experimental Setting ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span><span class="ltx_text ltx_font_bold">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS1.SSS2" title="In 5.1 Experimental Setting ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span><span class="ltx_text ltx_font_bold">Evaluation Metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS1.SSS3" title="In 5.1 Experimental Setting ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span><span class="ltx_text ltx_font_bold">Baseline Methods</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS1.SSS4" title="In 5.1 Experimental Setting ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span><span class="ltx_text ltx_font_bold">Implementation Details</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS2" title="In 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS3" title="In 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Hyper-parameter Sensitivity Analysis (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS4" title="In 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Study (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.SS5" title="In 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Intention Visualization (RQ4)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S6" title="In Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">[1,2,3,4]<span class="ltx_ERROR undefined" id="p1.1.1">\fnm</span>Zeyu <span class="ltx_ERROR undefined" id="p1.1.2">\sur</span>Hu</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\equalcont</span>
<p class="ltx_p" id="p2.2">Corresponding author. E-mail: <span class="ltx_text" id="p2.2.1" style="color:#0000FF;">qh_xiaoyuzhi@139.com</span>;</p>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">1]<span class="ltx_ERROR undefined" id="p3.1.1">\orgaddress</span>College of Computer, Qinghai Normal University, Xining, 810008, China</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p" id="p4.1">2]<span class="ltx_ERROR undefined" id="p4.1.1">\orgaddress</span>The State Key Laboratory of Tibetan Intelligent Information Processing and Application, Xining, 810008, China</p>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">3]<span class="ltx_ERROR undefined" id="p5.1.1">\orgaddress</span>Tibetan Information Processing and Machine Translation Key Laboratory of Qinghai Province, Xining, 810008, China</p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p" id="p6.1">4]<span class="ltx_ERROR undefined" id="p6.1.1">\orgaddress</span>Key Laboratory of Tibetan Information Processing, Ministry of Education, Xining, 810008, China</p>
</div>
<h1 class="ltx_title ltx_title_document">Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:81234hzy@gmail.com">81234hzy@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\fnm</span>Yuzhi <span class="ltx_ERROR undefined" id="id2.2.id2">\sur</span>Xiao
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id3.1.id1">\fnm</span>Tao <span class="ltx_ERROR undefined" id="id4.2.id2">\sur</span>Huang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:762711327@qq.com">762711327@qq.com</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id5.1.id1">\fnm</span>Xuanrong <span class="ltx_ERROR undefined" id="id6.2.id2">\sur</span>Huo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:2045519433@qq.com">2045519433@qq.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">Sequential recommendation is one of the important branches of recommender system, aiming to achieve personalized recommended items for the future through the analysis and prediction of users’ ordered historical interactive behaviors. However, along with the growth of the user volume and the increasingly rich behavioral information, how to understand and disentangle the user’s interactive multi-intention effectively also poses challenges to behavior prediction and sequential recommendation.
In light of these challenges, we propose a <span class="ltx_text ltx_font_bold" id="id7.id1.1">C</span>ontrastive <span class="ltx_text ltx_font_bold" id="id7.id1.2">L</span>earning sequential recommendation method based on <span class="ltx_text ltx_font_bold" id="id7.id1.3">M</span>ulti-<span class="ltx_text ltx_font_bold" id="id7.id1.4">I</span>ntention <span class="ltx_text ltx_font_bold" id="id7.id1.5">D</span>isentanglement (MIDCL).
In our work, intentions are recognized as dynamic and diverse, and user behaviors are often driven by current multi-intentions, which means that the model needs to not only mine the most relevant implicit intention for each user, but also impair the influence from irrelevant intentions.
Therefore, we choose Variational Auto-Encoder (VAE) to realize the disentanglement of users’ multi-intentions. We propose two types of contrastive learning paradigms for finding the most relevant user’s interactive intention, and maximizing the mutual information of positive sample pairs, respectively. Experimental results show that MIDCL not only has significant superiority over most existing baseline methods, but also brings a more interpretable case to the research about intention-based prediction and recommendation.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Sequential Recommendation, Interactive Behavior Prediction, Variational Auto-Encoder, Multi-intention Disentanglement, Contrastive Learning
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Nowadays, recommender system has gradually become an indispensable part of people’s lives, meanwhile, the more realistic and logical sequential recommendation are becoming the key to provide personalized needs. As a popular research direction, sequential recommendation is not only for product recommendation, but also can be extended to other fields, such as intention understanding and prediction. The main reason is that the definition of sequential recommendation is not absolute, such as the task of recommending the next product to the user based on the browsing and purchasing records. But we can also consider it as a prediction task based on a series of consecutive historical interactive sequences of the user, and analyze the potential intention of users to generate the most probable interactions that will occur at the next moment, so that the method can be applied to real-world datasets in different scenarios.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The difference between prediction and recommendation is that recommendation usually does not recommend the interacted items to the user again, but the behavior sequence may contain a large number of repeated interactions, which leads to a wider scope of prediction than recommendation. Due to the real-time progression of interactive intention, we believe that the closer the interactive behavior is to the current moment, the more it can influence the prediction of the next moment. Fig.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the sequence of four users’ interactive behaviors, and it can be seen that there are a variety of coherent behaviors that contain certain fixed-pairing items. In particular, the most recent interacted item has the highest weight in the prediction task, but this is not absolute. As shown in this figure, it can be found that the first and last users have different interacted tail items, but the items to be predicted are the same. Therefore, it is reasonable to assume that although the two users have different behaviors at this point in time, their intentions are indeed close to each other, which reflects the importance of intention understanding and disentanglement.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S1.F1.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">An example about historical behavioral sequences of different users, each item represents a kind of interactive behavior.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The core task of sequential recommendation is to predict whether the user will interact with the candidate item at the next moment, and different scenarios will be handled in different ways. For example, in the graph-based recommendation scenario, we can regard it as a link prediction problem. Through the current research on sequential recommendation, it can be seen that most of the work focuses on the feature construction of the user and the item, but instead does not consider the historical behavior that contains rich potential information, and ignores the full mining of the user’s interactive intention. Meanwhile, the input features of most models in Computer Vision (CV) and Natural Language Processing (NLP) are dense features, while the inputs of recommendation models are mostly sparse features such as id information, so how to design data enhancement methods for sparse features is the key to optimize the sequential recommendation task.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Most of the current researches have achieved surprising results in the prediction process as well as the recommendation accuracy, but we also want to build on these researches to further discover the user’s interactive intention from the user’s sequence, and endow the final recommendation results with a certain degree of interpretability as well as the generalization capability to face different dataset scenarios. Based on this, we propose a contrastive learning recommendation method based on the disentanglement of multi-intentions. First, the multiple entangled intentions of the user’s current interactive behavior are disentangled and mapped to potential spaces through VAE, and the user’s feature optimization is realized from the encoder to the decoder. Then, the two kinds of loss function is constructed based on the contrastive learning, and optimize feature representation according to Mutual Information Maximization (MIM) principles. Finally, use the learned user embedding and item embedding to compute dot product results to predict the probability of a user interacting with the item, thus enabling personalized recommendation.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The main contributions of this paper are as follows:</p>
</div>
<div class="ltx_para" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">VAE-based disentanglement can discover and learn the latent intention of user’s interactive behavior.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Two contrastive learning paradigms are proposed that not only enhance the user’s feature representation, but also weaken the negative impact of irrelevant intentions.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">MIDCL demonstrates good performance and generalization ability in experiments with four real scenario datasets, and also proves that intention disentanglement can compensate a certain degree of interpretability for the final recommendation results.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The work in this paper is structured as follows. In Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S2" title="2 Related work ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">2</span></a>, we present relevant recent years studies. Subsequently, Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S3" title="3 Preliminaries ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">3</span></a> details the preliminaries about VAE and contrastive learning. In Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4" title="4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">4</span></a>, we describe the proposed methodology in detail. Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5" title="5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">5</span></a> verifies the validity of the proposed method through experiments and analysis. Finally, we discuss future work and provide conclusion for the paper in Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S6" title="6 Conclusion ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Unlike traditional recommendation based on collaborative filtering of users or items, sequential recommendation pays more attention to the interaction sequence of users’ behavior history, focusing on mining users’ real-time interests and interactive intentions. The earliest sequential recommendation started with statistical machine learning methods, based on Markov chain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib1" title="">1</a>]</cite> to predict the next clicked item through the user’s historical sequence; combining the first-order Markov chain and matrix factorization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib2" title="">2</a>]</cite> not only focuses on the user’s history, but also simulates the user’s potential preferences; combining similarity computation in the Markov chain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib3" title="">3</a>]</cite> to a certain extent compensates for the shortcomings of the first two models.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">With the rise of deep learning, researchers began to apply it to sequential recommendation because of its powerful ability to handle massive data and complex problems. For example, GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib4" title="">4</a>]</cite>, which improves Recurrent Neural Network (RNN), alleviates the former problem of gradient vanishing or gradient explosion; Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib5" title="">5</a>]</cite>, based on Convolution Neural Network (CNN), enhances feature associations between items by splicing the convolutional results in different directions; SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib6" title="">6</a>]</cite> based on the self-attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib7" title="">7</a>]</cite>, fully exploits the user’s interest weight in the current interaction, and TiSASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib8" title="">8</a>]</cite> incorporates consideration of the time intervals between interactions based on  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib6" title="">6</a>]</cite>. BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib9" title="">9</a>]</cite> consists of the bidirectional Transformer-based structure, which demonstrates its powerful processing and computing capabilities in the face of large-scale data.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Nevertheless, most of the existing algorithms for sequential recommendation lack the analysis of the user’s dynamic interests and the interpretation of interaction intentions.
In some studies, Graph Neural Network (GNN) has been employed to deal with heterogeneous networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib14" title="">14</a>]</cite>, and some others try to discover latent user interests through contextual information  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib17" title="">17</a>]</cite> or interaction time-aware analysis  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib20" title="">20</a>]</cite>,
but we hope to mine the potential multiple intentions of users from the interaction sequences themselves.
As a result, we build on the above and conduct a series of work that incorporates the intention during interaction behavior.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Disentangled Representation Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In a sequential recommendation task, the user’s choice will be influenced by contextual information, but also related to one’s own interactive intention. Therefore, how to mine the potential intention is a current issue of great interest. Researchers believe that the user’s interactive intentions are dynamic and entangled, so most of the research is devoted to decompose the diverse real-time interactive intentions through disentangled representation learning and flexibly apply them in prediction and recommendation.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">VAE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib21" title="">21</a>]</cite>, first proposed in 2013, is a generative network architecture based on Variational Bayes inference, designed for effective inference and learning in directed probabilistic models in the face of continuous latent variables with intractable posterior distributions and large datasets. VAE differ from Auto-Encoder in that the former introduce latent variables that are assumed to obey a prior distribution.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">MacridVAE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib22" title="">22</a>]</cite> faces a shopping scenario with highly entangled user intentions and captures different dimensions of user preferences from macro and micro perspectives, respectively, with the help of VAE; MGNM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib23" title="">23</a>]</cite> simulates a recommendation scenario of a short-video and an e-commerce platform, where a loose sequence of items is combined into a single item by means of user perception to reconstruct loose item sequences into tight item-item interest graphs, and the introduction of sequence capsule networks in the iterative graph convolution inference process enhances the multi-interest extraction of users.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">However, the results of directly applying most of the disentangled intentions in recommendation scenarios are often unsatisfactory due to the fact that the results not only rely on the prior distribution, but also suffer from the posterior collapse problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib24" title="">24</a>]</cite>. Therefore, after the disentanglement of user’s intention, how to utilize these disentangled intentions is the core goal of our research, and mitigating the problem of representation degradation through contrastive learning is a widely recognized approach.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Contrastive Self-Supervised Learning</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Contrastive Learning, also known as Self-Supervised Learning or Unsupervised Learning, aiming to learn a representation or feature of the data by comparing the similarities and differences between different samples to learn the representation or features of the data. The key of contrastive learning in sequential recommendation-oriented tasks is how to construct suitable pairs of positive and negative samples.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">CGCL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib25" title="">25</a>]</cite> provides high-quality embedding based on graph contrastive learning by constructing a structural neighborhood contrastive learning object, a candidate contrastive learning object and candidate structural neighborhood contrastive learning object nodes. In addition, contrast learning is usually combined with intention disentanglement. Paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib26" title="">26</a>]</cite> proposes a novel seq2seq training strategy to disentangle multiple user’s intentions and cluster the intentions based on prototype distances to enable prediction of future intentions; IOCRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib27" title="">27</a>]</cite> fuses local and global intentions to unify sequential patterns and intention-level self-supervised signals, and demonstrates a good denoising performance that alleviate the impact of different user’s intentoins on the prediction results; ICLRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib28" title="">28</a>]</cite> uses K-means clustering to represent the distribution of users’ potential intentions and maximizes the consistency between sequential views and their corresponding intentions based on the idea of expectation-maximization, from which the loss function is constructed and trained alternatively; ICSRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib29" title="">29</a>]</cite> uses cross-sequence contrastive learning to model potential user purchase intention by splitting the user interaction sequence into multiple subsequences and encoding them, assumes that subsequences with the same target item have the same user intent, and uses intention-based contrastive learning to pull together subsequences with the same target item; DCCF <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib30" title="">30</a>]</cite> proposes a framework about disentangled contrastive with collaborative filtering, in order to enable intention disentanglement with self-supervised augmentation in adaptive way.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">S<sup class="ltx_sup" id="S2.SS3.p3.1.1">3</sup>-Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib31" title="">31</a>]</cite>, as a sequential recommendation model based on a self-attentive neural architecture, proposes four classes to learn the correlation between attributes, items, subsequences and sequences respectively by using the MIM principle; CL4SRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib32" title="">32</a>]</cite> optimizes the user feature representation based on maximizing the consistency between different augmented views of the same user interaction sequence in the latent space, and similarly proposes three training methods based on contrastive learning by augmenting the data i.e. cropping, masking, and reordering, respectively. Both of the above models provide valuable reference solutions for data optimization for future contrast learning tasks, and CoSeRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib33" title="">33</a>]</cite> proposes two additional informative enhancement operators on top of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib32" title="">32</a>]</cite>, which are substituting and inserting.</p>
</div>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.1">Unlike above methods, in our work, in addition to contrastive learning of sequences, we propose a new paradigm for contrastive learning of intentions, which is dedicated to weakening the influence of irrelevant intentions on user’s behavior reasoning.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Definition</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.10">Let <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_U</annotation></semantics></math> denote the set of users <math alttext="\{u_{1},u_{2},\dots,u_{|\mathcal{U}|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5.3" xref="S3.SS1.p1.2.m2.5.5.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.3.3.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.2.cmml">u</mi><mn id="S3.SS1.p1.2.m2.3.3.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.5" xref="S3.SS1.p1.2.m2.5.5.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml">u</mi><mn id="S3.SS1.p1.2.m2.4.4.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.6" xref="S3.SS1.p1.2.m2.5.5.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.7" xref="S3.SS1.p1.2.m2.5.5.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.2.cmml">u</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">𝒰</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><set id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.2">𝑢</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2">𝑢</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.2">𝑢</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝒰</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">\{u_{1},u_{2},\dots,u_{|\mathcal{U}|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">{ italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT | caligraphic_U | end_POSTSUBSCRIPT }</annotation></semantics></math>,
<math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_I</annotation></semantics></math> denote the set of items <math alttext="\{i_{1},i_{2},\dots,i_{|\mathcal{I}|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.5"><semantics id="S3.SS1.p1.4.m4.5a"><mrow id="S3.SS1.p1.4.m4.5.5.3" xref="S3.SS1.p1.4.m4.5.5.4.cmml"><mo id="S3.SS1.p1.4.m4.5.5.3.4" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.4.cmml">{</mo><msub id="S3.SS1.p1.4.m4.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.4.m4.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.5.5.3.5" xref="S3.SS1.p1.4.m4.5.5.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.4.4.2.2" xref="S3.SS1.p1.4.m4.4.4.2.2.cmml"><mi id="S3.SS1.p1.4.m4.4.4.2.2.2" xref="S3.SS1.p1.4.m4.4.4.2.2.2.cmml">i</mi><mn id="S3.SS1.p1.4.m4.4.4.2.2.3" xref="S3.SS1.p1.4.m4.4.4.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.4.m4.5.5.3.6" xref="S3.SS1.p1.4.m4.5.5.4.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2" mathvariant="normal" xref="S3.SS1.p1.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p1.4.m4.5.5.3.7" xref="S3.SS1.p1.4.m4.5.5.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.5.5.3.3" xref="S3.SS1.p1.4.m4.5.5.3.3.cmml"><mi id="S3.SS1.p1.4.m4.5.5.3.3.2" xref="S3.SS1.p1.4.m4.5.5.3.3.2.cmml">i</mi><mrow id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">ℐ</mi><mo id="S3.SS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.4.m4.5.5.3.8" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.5b"><set id="S3.SS1.p1.4.m4.5.5.4.cmml" xref="S3.SS1.p1.4.m4.5.5.3"><apply id="S3.SS1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.3.3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.3.3.1.1.3">1</cn></apply><apply id="S3.SS1.p1.4.m4.4.4.2.2.cmml" xref="S3.SS1.p1.4.m4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.2.2.1.cmml" xref="S3.SS1.p1.4.m4.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.2.2.2.cmml" xref="S3.SS1.p1.4.m4.4.4.2.2.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.4.4.2.2.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.4.4.2.2.3">2</cn></apply><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">…</ci><apply id="S3.SS1.p1.4.m4.5.5.3.3.cmml" xref="S3.SS1.p1.4.m4.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.5.5.3.3.1.cmml" xref="S3.SS1.p1.4.m4.5.5.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.5.5.3.3.2.cmml" xref="S3.SS1.p1.4.m4.5.5.3.3.2">𝑖</ci><apply id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3"><abs id="S3.SS1.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.1"></abs><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">ℐ</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.5c">\{i_{1},i_{2},\dots,i_{|\mathcal{I}|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.5d">{ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT | caligraphic_I | end_POSTSUBSCRIPT }</annotation></semantics></math>.
Define <math alttext="H^{u}=[H^{u}_{1},H^{u}_{2},\dots,H^{u}_{|H^{u}|}]" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.5"><semantics id="S3.SS1.p1.5.m5.5a"><mrow id="S3.SS1.p1.5.m5.5.5" xref="S3.SS1.p1.5.m5.5.5.cmml"><msup id="S3.SS1.p1.5.m5.5.5.5" xref="S3.SS1.p1.5.m5.5.5.5.cmml"><mi id="S3.SS1.p1.5.m5.5.5.5.2" xref="S3.SS1.p1.5.m5.5.5.5.2.cmml">H</mi><mi id="S3.SS1.p1.5.m5.5.5.5.3" xref="S3.SS1.p1.5.m5.5.5.5.3.cmml">u</mi></msup><mo id="S3.SS1.p1.5.m5.5.5.4" xref="S3.SS1.p1.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.5.5.3.3" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml"><mo id="S3.SS1.p1.5.m5.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">[</mo><msubsup id="S3.SS1.p1.5.m5.3.3.1.1.1" xref="S3.SS1.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.3.3.1.1.1.2.2" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.2.cmml">H</mi><mn id="S3.SS1.p1.5.m5.3.3.1.1.1.3" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml">1</mn><mi id="S3.SS1.p1.5.m5.3.3.1.1.1.2.3" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.5" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.4.4.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.4.4.2.2.2.2.2" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.2.cmml">H</mi><mn id="S3.SS1.p1.5.m5.4.4.2.2.2.3" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml">2</mn><mi id="S3.SS1.p1.5.m5.4.4.2.2.2.2.3" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.6" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2" mathvariant="normal" xref="S3.SS1.p1.5.m5.2.2.cmml">…</mi><mo id="S3.SS1.p1.5.m5.5.5.3.3.7" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.5.5.3.3.3" xref="S3.SS1.p1.5.m5.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.5.m5.5.5.3.3.3.2.2" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.2.cmml">H</mi><mrow id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.2.cmml"><mo id="S3.SS1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p1.5.m5.1.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.2" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml">H</mi><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.SS1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.SS1.p1.5.m5.5.5.3.3.3.2.3" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.3.cmml">u</mi></msubsup><mo id="S3.SS1.p1.5.m5.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.5.m5.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.5b"><apply id="S3.SS1.p1.5.m5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5"><eq id="S3.SS1.p1.5.m5.5.5.4.cmml" xref="S3.SS1.p1.5.m5.5.5.4"></eq><apply id="S3.SS1.p1.5.m5.5.5.5.cmml" xref="S3.SS1.p1.5.m5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.5.1.cmml" xref="S3.SS1.p1.5.m5.5.5.5">superscript</csymbol><ci id="S3.SS1.p1.5.m5.5.5.5.2.cmml" xref="S3.SS1.p1.5.m5.5.5.5.2">𝐻</ci><ci id="S3.SS1.p1.5.m5.5.5.5.3.cmml" xref="S3.SS1.p1.5.m5.5.5.5.3">𝑢</ci></apply><list id="S3.SS1.p1.5.m5.5.5.3.4.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3"><apply id="S3.SS1.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.2">𝐻</ci><ci id="S3.SS1.p1.5.m5.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.1.1.1.2.3">𝑢</ci></apply><cn id="S3.SS1.p1.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.5.m5.4.4.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.2">𝐻</ci><ci id="S3.SS1.p1.5.m5.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.4.4.2.2.2.2.3">𝑢</ci></apply><cn id="S3.SS1.p1.5.m5.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">…</ci><apply id="S3.SS1.p1.5.m5.5.5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3">subscript</csymbol><apply id="S3.SS1.p1.5.m5.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.5.5.3.3.3.2.1.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3">superscript</csymbol><ci id="S3.SS1.p1.5.m5.5.5.3.3.3.2.2.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.2">𝐻</ci><ci id="S3.SS1.p1.5.m5.5.5.3.3.3.2.3.cmml" xref="S3.SS1.p1.5.m5.5.5.3.3.3.2.3">𝑢</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"><abs id="S3.SS1.p1.5.m5.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.2"></abs><apply id="S3.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.2">𝐻</ci><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.5c">H^{u}=[H^{u}_{1},H^{u}_{2},\dots,H^{u}_{|H^{u}|}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.5d">italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT ]</annotation></semantics></math> as the sequences of interaction items of user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_u</annotation></semantics></math> sorted by timestamp to moment <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_T</annotation></semantics></math>, where <math alttext="H^{u}_{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msubsup id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.2.2.cmml">H</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">T</mi><mi id="S3.SS1.p1.8.m8.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2.2">𝐻</ci><ci id="S3.SS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.2.3">𝑢</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">H^{u}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> donates the item that <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_u</annotation></semantics></math> has interacted with most recently.
For each user, <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_k</annotation></semantics></math> is the number of disentangled intentions.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">The goal of our work can be formulated as predicting the item <math alttext="i_{u}^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msubsup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.2.2.cmml">i</mi><mi id="S3.SS1.p2.1.m1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.2.3.cmml">u</mi><mo id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2.2">𝑖</ci><ci id="S3.SS1.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.2.3">𝑢</ci></apply><times id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">i_{u}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> that the current user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_u</annotation></semantics></math> is most likely to interact with at the next moment, after the disentanglement of <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_u</annotation></semantics></math>’s most relevant intention <math alttext="e^{msi}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msubsup id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2.cmml">e</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">i</mi><mrow id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2.3.2" xref="S3.SS1.p2.4.m4.1.1.2.3.2.cmml">m</mi><mo id="S3.SS1.p2.4.m4.1.1.2.3.1" xref="S3.SS1.p2.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.2.3.3" xref="S3.SS1.p2.4.m4.1.1.2.3.3.cmml">s</mi><mo id="S3.SS1.p2.4.m4.1.1.2.3.1a" xref="S3.SS1.p2.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.2.3.4" xref="S3.SS1.p2.4.m4.1.1.2.3.4.cmml">i</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">𝑒</ci><apply id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3"><times id="S3.SS1.p2.4.m4.1.1.2.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.2.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3.2">𝑚</ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3.3">𝑠</ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3.4">𝑖</ci></apply></apply><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">e^{msi}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_e start_POSTSUPERSCRIPT italic_m italic_s italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="i^{*}_{u}=\underset{e^{i},i\in\mathcal{I}}{\mathrm{arg\,max}}~{}P(H^{u}_{T+1}=%
e^{i}|e^{msi}_{i},H^{u}_{T})." class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msubsup id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.cmml">i</mi><mi id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml">u</mi><mo id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">∗</mo></msubsup><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><munder accentunder="true" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.3.2" xref="S3.E1.m1.2.2.3.2.cmml">arg</mi><mo id="S3.E1.m1.2.2.3.1" lspace="0.170em" xref="S3.E1.m1.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.3.3" xref="S3.E1.m1.2.2.3.3.cmml">max</mi></mrow><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.cmml"><msup id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml">e</mi><mi id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml">i</mi></msup><mo id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.2.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">i</mi></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">ℐ</mi></mrow></munder><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">P</mi><mo id="S3.E1.m1.3.3.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.2.cmml">H</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2.cmml">T</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.3.cmml">u</mi></msubsup><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><msup id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.2.cmml">e</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.3.cmml">i</mi></msup><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.3.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">s</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">i</mi></mrow></msubsup><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.2.cmml">H</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml">T</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.3.cmml">u</mi></msubsup></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2">𝑖</ci><times id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3"></times></apply><ci id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3">𝑢</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><in id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></in><list id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1"><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">𝑒</ci><ci id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑖</ci></list><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">ℐ</ci></apply><apply id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3"><times id="S3.E1.m1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.3.1"></times><ci id="S3.E1.m1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.3.2">arg</ci><ci id="S3.E1.m1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.3.3">max</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝑃</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.2">𝐻</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.3">𝑢</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3"><plus id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.1"></plus><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2">𝑇</ci><cn id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.2">𝑒</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.4.3">𝑖</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑠</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.4">𝑖</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.2">𝐻</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.3">𝑢</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.3">𝑇</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">i^{*}_{u}=\underset{e^{i},i\in\mathcal{I}}{\mathrm{arg\,max}}~{}P(H^{u}_{T+1}=%
e^{i}|e^{msi}_{i},H^{u}_{T}).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = start_UNDERACCENT italic_e start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_i ∈ caligraphic_I end_UNDERACCENT start_ARG roman_arg roman_max end_ARG italic_P ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T + 1 end_POSTSUBSCRIPT = italic_e start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT | italic_e start_POSTSUPERSCRIPT italic_m italic_s italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Intention Disentanglement</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The essence of VAE is a generative model, whose structure consists of an encoder and a decoder. VAE is an extension from the self-encoder, which works on the idea of obtaining an ideal distribution of the sample data through the encoder based on a portion of the real samples, then reconstructing new samples in accordance with this distribution through the decoder, and the more ideal the distribution, the closer the new samples can make these new samples to the original real samples. VAE, on the other hand, makes further variance processing on the basis of the self-encoder, it allows the model to learn the potential distribution of the sample data and at the same time also learns the mean and variance of the sample distribution.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">Assume a batch of data samples <math alttext="X=\{x_{1},\dots x_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.2"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.4" xref="S3.SS2.p2.1.m1.2.2.4.cmml">X</mi><mo id="S3.SS2.p2.1.m1.2.2.3" xref="S3.SS2.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml"><mo id="S3.SS2.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml">x</mi><mn id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.1.m1.2.2.2.2.4" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.p2.1.m1.2.2.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2.cmml">…</mi><mo id="S3.SS2.p2.1.m1.2.2.2.2.2.1" xref="S3.SS2.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.3.2" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml">x</mi><mi id="S3.SS2.p2.1.m1.2.2.2.2.2.3.3" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS2.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS2.p2.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><eq id="S3.SS2.p2.1.m1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.3"></eq><ci id="S3.SS2.p2.1.m1.2.2.4.cmml" xref="S3.SS2.p2.1.m1.2.2.4">𝑋</ci><set id="S3.SS2.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2"><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2">𝑥</ci><cn id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2"><times id="S3.SS2.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.1"></times><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.2">…</ci><apply id="S3.SS2.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.2">𝑥</ci><ci id="S3.SS2.p2.1.m1.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.1.m1.2.2.2.2.2.3.3">𝑛</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">X=\{x_{1},\dots x_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.2d">italic_X = { italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, by obtaining the distribution <math alttext="p(X)" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.2.2" xref="S3.SS2.p2.2.m2.1.2.2.cmml">p</mi><mo id="S3.SS2.p2.2.m2.1.2.1" xref="S3.SS2.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.1.2.3.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mo id="S3.SS2.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">X</mi><mo id="S3.SS2.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.2.cmml" xref="S3.SS2.p2.2.m2.1.2"><times id="S3.SS2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.2.1"></times><ci id="S3.SS2.p2.2.m2.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.2.2">𝑝</ci><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">p(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_p ( italic_X )</annotation></semantics></math> of <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_X</annotation></semantics></math>, and then sampling according to <math alttext="p(X)" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.2" xref="S3.SS2.p2.4.m4.1.2.cmml"><mi id="S3.SS2.p2.4.m4.1.2.2" xref="S3.SS2.p2.4.m4.1.2.2.cmml">p</mi><mo id="S3.SS2.p2.4.m4.1.2.1" xref="S3.SS2.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.4.m4.1.2.3.2" xref="S3.SS2.p2.4.m4.1.2.cmml"><mo id="S3.SS2.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">X</mi><mo id="S3.SS2.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.2.cmml" xref="S3.SS2.p2.4.m4.1.2"><times id="S3.SS2.p2.4.m4.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.2.1"></times><ci id="S3.SS2.p2.4.m4.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.2.2">𝑝</ci><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">p(X)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_p ( italic_X )</annotation></semantics></math>, a new sample <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_Z</annotation></semantics></math> can be obtained based on the <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_X</annotation></semantics></math> distribution. Derive this distribution as the posterior distribution of the hidden variables:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="p(X)=\sum_{Z}p(X|Z)p(Z)." class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">p</mi><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.cmml"><mo id="S3.E2.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">X</mi><mo id="S3.E2.m1.3.3.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.2" rspace="0.111em" xref="S3.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><munder id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.1.2.2" movablelimits="false" xref="S3.E2.m1.3.3.1.1.1.2.2.cmml">∑</mo><mi id="S3.E2.m1.3.3.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.2.3.cmml">Z</mi></munder><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.3.cmml">p</mi><mo id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">X</mi><mo fence="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml">Z</mi></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.2a" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.1.1.4" xref="S3.E2.m1.3.3.1.1.1.1.4.cmml">p</mi><mo id="S3.E2.m1.3.3.1.1.1.1.2b" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.5.2" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.5.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">Z</mi><mo id="S3.E2.m1.3.3.1.1.1.1.5.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" lspace="0em" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"></eq><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">𝑝</ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑋</ci></apply><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><apply id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2.2"></sum><ci id="S3.E2.m1.3.3.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.2.3">𝑍</ci></apply><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"></times><ci id="S3.E2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.3">𝑝</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3">𝑍</ci></apply><ci id="S3.E2.m1.3.3.1.1.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.1.1.4">𝑝</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">p(X)=\sum_{Z}p(X|Z)p(Z).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">italic_p ( italic_X ) = ∑ start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT italic_p ( italic_X | italic_Z ) italic_p ( italic_Z ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.26">The <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_Z</annotation></semantics></math> in Eq.(2) is expected to satisfy the standard normal distribution, which means <math alttext="p(Z)=\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.3"><semantics id="S3.SS2.p3.2.m2.3a"><mrow id="S3.SS2.p3.2.m2.3.4" xref="S3.SS2.p3.2.m2.3.4.cmml"><mrow id="S3.SS2.p3.2.m2.3.4.2" xref="S3.SS2.p3.2.m2.3.4.2.cmml"><mi id="S3.SS2.p3.2.m2.3.4.2.2" xref="S3.SS2.p3.2.m2.3.4.2.2.cmml">p</mi><mo id="S3.SS2.p3.2.m2.3.4.2.1" xref="S3.SS2.p3.2.m2.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.2.m2.3.4.2.3.2" xref="S3.SS2.p3.2.m2.3.4.2.cmml"><mo id="S3.SS2.p3.2.m2.3.4.2.3.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.3.4.2.cmml">(</mo><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">Z</mi><mo id="S3.SS2.p3.2.m2.3.4.2.3.2.2" stretchy="false" xref="S3.SS2.p3.2.m2.3.4.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.2.m2.3.4.1" xref="S3.SS2.p3.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS2.p3.2.m2.3.4.3" xref="S3.SS2.p3.2.m2.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.3.4.3.2" xref="S3.SS2.p3.2.m2.3.4.3.2.cmml">𝒩</mi><mo id="S3.SS2.p3.2.m2.3.4.3.1" xref="S3.SS2.p3.2.m2.3.4.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.2.m2.3.4.3.3.2" xref="S3.SS2.p3.2.m2.3.4.3.3.1.cmml"><mo id="S3.SS2.p3.2.m2.3.4.3.3.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.3.4.3.3.1.cmml">(</mo><mn id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml">0</mn><mo id="S3.SS2.p3.2.m2.3.4.3.3.2.2" xref="S3.SS2.p3.2.m2.3.4.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.2.m2.3.3" xref="S3.SS2.p3.2.m2.3.3.cmml">1</mn><mo id="S3.SS2.p3.2.m2.3.4.3.3.2.3" stretchy="false" xref="S3.SS2.p3.2.m2.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.3b"><apply id="S3.SS2.p3.2.m2.3.4.cmml" xref="S3.SS2.p3.2.m2.3.4"><eq id="S3.SS2.p3.2.m2.3.4.1.cmml" xref="S3.SS2.p3.2.m2.3.4.1"></eq><apply id="S3.SS2.p3.2.m2.3.4.2.cmml" xref="S3.SS2.p3.2.m2.3.4.2"><times id="S3.SS2.p3.2.m2.3.4.2.1.cmml" xref="S3.SS2.p3.2.m2.3.4.2.1"></times><ci id="S3.SS2.p3.2.m2.3.4.2.2.cmml" xref="S3.SS2.p3.2.m2.3.4.2.2">𝑝</ci><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑍</ci></apply><apply id="S3.SS2.p3.2.m2.3.4.3.cmml" xref="S3.SS2.p3.2.m2.3.4.3"><times id="S3.SS2.p3.2.m2.3.4.3.1.cmml" xref="S3.SS2.p3.2.m2.3.4.3.1"></times><ci id="S3.SS2.p3.2.m2.3.4.3.2.cmml" xref="S3.SS2.p3.2.m2.3.4.3.2">𝒩</ci><interval closure="open" id="S3.SS2.p3.2.m2.3.4.3.3.1.cmml" xref="S3.SS2.p3.2.m2.3.4.3.3.2"><cn id="S3.SS2.p3.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p3.2.m2.2.2">0</cn><cn id="S3.SS2.p3.2.m2.3.3.cmml" type="integer" xref="S3.SS2.p3.2.m2.3.3">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.3c">p(Z)=\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.3d">italic_p ( italic_Z ) = caligraphic_N ( 0 , 1 )</annotation></semantics></math>, and such a distribution can help the decoder generate more similar samples. The normal distribution is affected by the mean <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_μ</annotation></semantics></math> and variance <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝜎</ci><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, and VAE can also use a neural network to help it fit the vector representation of <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_μ</annotation></semantics></math> and <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msup id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝜎</ci><cn id="S3.SS2.p3.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.p3.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. For a real sample <math alttext="X_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">X</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑋</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, set up a distribution <math alttext="p(Z|X_{k})" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mrow id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">p</mi><mo id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.8.m8.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.8.m8.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.1.1.1.2.cmml">Z</mi><mo fence="false" id="S3.SS2.p3.8.m8.1.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p3.8.m8.1.1.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.8.m8.1.1.1.1.1.3.2" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.2.cmml">X</mi><mi id="S3.SS2.p3.8.m8.1.1.1.1.1.3.3" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p3.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><times id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2"></times><ci id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">𝑝</ci><apply id="S3.SS2.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.2">𝑍</ci><apply id="S3.SS2.p3.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.2">𝑋</ci><ci id="S3.SS2.p3.8.m8.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">p(Z|X_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_p ( italic_Z | italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> exclusively belonging to <math alttext="X_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><msub id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">X</mi><mi id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2">𝑋</ci><ci id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, train the <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><mi id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><ci id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">italic_μ</annotation></semantics></math> and <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m11.1"><semantics id="S3.SS2.p3.11.m11.1a"><msup id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml"><mi id="S3.SS2.p3.11.m11.1.1.2" xref="S3.SS2.p3.11.m11.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.11.m11.1.1.3" xref="S3.SS2.p3.11.m11.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.1b"><apply id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m11.1.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.p3.11.m11.1.1.2.cmml" xref="S3.SS2.p3.11.m11.1.1.2">𝜎</ci><cn id="S3.SS2.p3.11.m11.1.1.3.cmml" type="integer" xref="S3.SS2.p3.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m11.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> of this distribution with encoder by approaching to the normal distribution through a neural network <math alttext="X=g(Z)" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m12.1"><semantics id="S3.SS2.p3.12.m12.1a"><mrow id="S3.SS2.p3.12.m12.1.2" xref="S3.SS2.p3.12.m12.1.2.cmml"><mi id="S3.SS2.p3.12.m12.1.2.2" xref="S3.SS2.p3.12.m12.1.2.2.cmml">X</mi><mo id="S3.SS2.p3.12.m12.1.2.1" xref="S3.SS2.p3.12.m12.1.2.1.cmml">=</mo><mrow id="S3.SS2.p3.12.m12.1.2.3" xref="S3.SS2.p3.12.m12.1.2.3.cmml"><mi id="S3.SS2.p3.12.m12.1.2.3.2" xref="S3.SS2.p3.12.m12.1.2.3.2.cmml">g</mi><mo id="S3.SS2.p3.12.m12.1.2.3.1" xref="S3.SS2.p3.12.m12.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.12.m12.1.2.3.3.2" xref="S3.SS2.p3.12.m12.1.2.3.cmml"><mo id="S3.SS2.p3.12.m12.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.12.m12.1.2.3.cmml">(</mo><mi id="S3.SS2.p3.12.m12.1.1" xref="S3.SS2.p3.12.m12.1.1.cmml">Z</mi><mo id="S3.SS2.p3.12.m12.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p3.12.m12.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m12.1b"><apply id="S3.SS2.p3.12.m12.1.2.cmml" xref="S3.SS2.p3.12.m12.1.2"><eq id="S3.SS2.p3.12.m12.1.2.1.cmml" xref="S3.SS2.p3.12.m12.1.2.1"></eq><ci id="S3.SS2.p3.12.m12.1.2.2.cmml" xref="S3.SS2.p3.12.m12.1.2.2">𝑋</ci><apply id="S3.SS2.p3.12.m12.1.2.3.cmml" xref="S3.SS2.p3.12.m12.1.2.3"><times id="S3.SS2.p3.12.m12.1.2.3.1.cmml" xref="S3.SS2.p3.12.m12.1.2.3.1"></times><ci id="S3.SS2.p3.12.m12.1.2.3.2.cmml" xref="S3.SS2.p3.12.m12.1.2.3.2">𝑔</ci><ci id="S3.SS2.p3.12.m12.1.1.cmml" xref="S3.SS2.p3.12.m12.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m12.1c">X=g(Z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m12.1d">italic_X = italic_g ( italic_Z )</annotation></semantics></math>, and then use decoder to reconstruct <math alttext="Z_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m13.1"><semantics id="S3.SS2.p3.13.m13.1a"><msub id="S3.SS2.p3.13.m13.1.1" xref="S3.SS2.p3.13.m13.1.1.cmml"><mi id="S3.SS2.p3.13.m13.1.1.2" xref="S3.SS2.p3.13.m13.1.1.2.cmml">Z</mi><mi id="S3.SS2.p3.13.m13.1.1.3" xref="S3.SS2.p3.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m13.1b"><apply id="S3.SS2.p3.13.m13.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m13.1.1.1.cmml" xref="S3.SS2.p3.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m13.1.1.2.cmml" xref="S3.SS2.p3.13.m13.1.1.2">𝑍</ci><ci id="S3.SS2.p3.13.m13.1.1.3.cmml" xref="S3.SS2.p3.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m13.1c">Z_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m13.1d">italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> sampled from the distribution <math alttext="p(Z|X_{k})" class="ltx_Math" display="inline" id="S3.SS2.p3.14.m14.1"><semantics id="S3.SS2.p3.14.m14.1a"><mrow id="S3.SS2.p3.14.m14.1.1" xref="S3.SS2.p3.14.m14.1.1.cmml"><mi id="S3.SS2.p3.14.m14.1.1.3" xref="S3.SS2.p3.14.m14.1.1.3.cmml">p</mi><mo id="S3.SS2.p3.14.m14.1.1.2" xref="S3.SS2.p3.14.m14.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.14.m14.1.1.1.1" xref="S3.SS2.p3.14.m14.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.14.m14.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.14.m14.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.14.m14.1.1.1.1.1" xref="S3.SS2.p3.14.m14.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.14.m14.1.1.1.1.1.2" xref="S3.SS2.p3.14.m14.1.1.1.1.1.2.cmml">Z</mi><mo fence="false" id="S3.SS2.p3.14.m14.1.1.1.1.1.1" xref="S3.SS2.p3.14.m14.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p3.14.m14.1.1.1.1.1.3" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.14.m14.1.1.1.1.1.3.2" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3.2.cmml">X</mi><mi id="S3.SS2.p3.14.m14.1.1.1.1.1.3.3" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p3.14.m14.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.14.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m14.1b"><apply id="S3.SS2.p3.14.m14.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1"><times id="S3.SS2.p3.14.m14.1.1.2.cmml" xref="S3.SS2.p3.14.m14.1.1.2"></times><ci id="S3.SS2.p3.14.m14.1.1.3.cmml" xref="S3.SS2.p3.14.m14.1.1.3">𝑝</ci><apply id="S3.SS2.p3.14.m14.1.1.1.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.14.m14.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.2">𝑍</ci><apply id="S3.SS2.p3.14.m14.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m14.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.14.m14.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3.2">𝑋</ci><ci id="S3.SS2.p3.14.m14.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.14.m14.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m14.1c">p(Z|X_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.14.m14.1d">italic_p ( italic_Z | italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> to <math alttext="X_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.15.m15.1"><semantics id="S3.SS2.p3.15.m15.1a"><msub id="S3.SS2.p3.15.m15.1.1" xref="S3.SS2.p3.15.m15.1.1.cmml"><mi id="S3.SS2.p3.15.m15.1.1.2" xref="S3.SS2.p3.15.m15.1.1.2.cmml">X</mi><mi id="S3.SS2.p3.15.m15.1.1.3" xref="S3.SS2.p3.15.m15.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m15.1b"><apply id="S3.SS2.p3.15.m15.1.1.cmml" xref="S3.SS2.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.15.m15.1.1.1.cmml" xref="S3.SS2.p3.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.p3.15.m15.1.1.2.cmml" xref="S3.SS2.p3.15.m15.1.1.2">𝑋</ci><ci id="S3.SS2.p3.15.m15.1.1.3.cmml" xref="S3.SS2.p3.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m15.1c">X_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.15.m15.1d">italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, the neural network <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p3.16.m16.1"><semantics id="S3.SS2.p3.16.m16.1a"><mi id="S3.SS2.p3.16.m16.1.1" xref="S3.SS2.p3.16.m16.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.16.m16.1b"><ci id="S3.SS2.p3.16.m16.1.1.cmml" xref="S3.SS2.p3.16.m16.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.16.m16.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.16.m16.1d">italic_X</annotation></semantics></math> contains two encoders <math alttext="f_{1}(X_{k})" class="ltx_Math" display="inline" id="S3.SS2.p3.17.m17.1"><semantics id="S3.SS2.p3.17.m17.1a"><mrow id="S3.SS2.p3.17.m17.1.1" xref="S3.SS2.p3.17.m17.1.1.cmml"><msub id="S3.SS2.p3.17.m17.1.1.3" xref="S3.SS2.p3.17.m17.1.1.3.cmml"><mi id="S3.SS2.p3.17.m17.1.1.3.2" xref="S3.SS2.p3.17.m17.1.1.3.2.cmml">f</mi><mn id="S3.SS2.p3.17.m17.1.1.3.3" xref="S3.SS2.p3.17.m17.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS2.p3.17.m17.1.1.2" xref="S3.SS2.p3.17.m17.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.17.m17.1.1.1.1" xref="S3.SS2.p3.17.m17.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.17.m17.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.17.m17.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.17.m17.1.1.1.1.1" xref="S3.SS2.p3.17.m17.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.17.m17.1.1.1.1.1.2" xref="S3.SS2.p3.17.m17.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS2.p3.17.m17.1.1.1.1.1.3" xref="S3.SS2.p3.17.m17.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p3.17.m17.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.17.m17.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.17.m17.1b"><apply id="S3.SS2.p3.17.m17.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1"><times id="S3.SS2.p3.17.m17.1.1.2.cmml" xref="S3.SS2.p3.17.m17.1.1.2"></times><apply id="S3.SS2.p3.17.m17.1.1.3.cmml" xref="S3.SS2.p3.17.m17.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m17.1.1.3.1.cmml" xref="S3.SS2.p3.17.m17.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.17.m17.1.1.3.2.cmml" xref="S3.SS2.p3.17.m17.1.1.3.2">𝑓</ci><cn id="S3.SS2.p3.17.m17.1.1.3.3.cmml" type="integer" xref="S3.SS2.p3.17.m17.1.1.3.3">1</cn></apply><apply id="S3.SS2.p3.17.m17.1.1.1.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m17.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.17.m17.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.17.m17.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.17.m17.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS2.p3.17.m17.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.17.m17.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.17.m17.1c">f_{1}(X_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.17.m17.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="f_{2}(X_{k})" class="ltx_Math" display="inline" id="S3.SS2.p3.18.m18.1"><semantics id="S3.SS2.p3.18.m18.1a"><mrow id="S3.SS2.p3.18.m18.1.1" xref="S3.SS2.p3.18.m18.1.1.cmml"><msub id="S3.SS2.p3.18.m18.1.1.3" xref="S3.SS2.p3.18.m18.1.1.3.cmml"><mi id="S3.SS2.p3.18.m18.1.1.3.2" xref="S3.SS2.p3.18.m18.1.1.3.2.cmml">f</mi><mn id="S3.SS2.p3.18.m18.1.1.3.3" xref="S3.SS2.p3.18.m18.1.1.3.3.cmml">2</mn></msub><mo id="S3.SS2.p3.18.m18.1.1.2" xref="S3.SS2.p3.18.m18.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.18.m18.1.1.1.1" xref="S3.SS2.p3.18.m18.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.18.m18.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.18.m18.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.18.m18.1.1.1.1.1" xref="S3.SS2.p3.18.m18.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.18.m18.1.1.1.1.1.2" xref="S3.SS2.p3.18.m18.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS2.p3.18.m18.1.1.1.1.1.3" xref="S3.SS2.p3.18.m18.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p3.18.m18.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.18.m18.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.18.m18.1b"><apply id="S3.SS2.p3.18.m18.1.1.cmml" xref="S3.SS2.p3.18.m18.1.1"><times id="S3.SS2.p3.18.m18.1.1.2.cmml" xref="S3.SS2.p3.18.m18.1.1.2"></times><apply id="S3.SS2.p3.18.m18.1.1.3.cmml" xref="S3.SS2.p3.18.m18.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m18.1.1.3.1.cmml" xref="S3.SS2.p3.18.m18.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.18.m18.1.1.3.2.cmml" xref="S3.SS2.p3.18.m18.1.1.3.2">𝑓</ci><cn id="S3.SS2.p3.18.m18.1.1.3.3.cmml" type="integer" xref="S3.SS2.p3.18.m18.1.1.3.3">2</cn></apply><apply id="S3.SS2.p3.18.m18.1.1.1.1.1.cmml" xref="S3.SS2.p3.18.m18.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m18.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.18.m18.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.18.m18.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.18.m18.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS2.p3.18.m18.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.18.m18.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.18.m18.1c">f_{2}(X_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.18.m18.1d">italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, which are used to train <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.19.m19.1"><semantics id="S3.SS2.p3.19.m19.1a"><msub id="S3.SS2.p3.19.m19.1.1" xref="S3.SS2.p3.19.m19.1.1.cmml"><mi id="S3.SS2.p3.19.m19.1.1.2" xref="S3.SS2.p3.19.m19.1.1.2.cmml">μ</mi><mi id="S3.SS2.p3.19.m19.1.1.3" xref="S3.SS2.p3.19.m19.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.19.m19.1b"><apply id="S3.SS2.p3.19.m19.1.1.cmml" xref="S3.SS2.p3.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.19.m19.1.1.1.cmml" xref="S3.SS2.p3.19.m19.1.1">subscript</csymbol><ci id="S3.SS2.p3.19.m19.1.1.2.cmml" xref="S3.SS2.p3.19.m19.1.1.2">𝜇</ci><ci id="S3.SS2.p3.19.m19.1.1.3.cmml" xref="S3.SS2.p3.19.m19.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.19.m19.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.19.m19.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\log{\sigma^{2}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.20.m20.1"><semantics id="S3.SS2.p3.20.m20.1a"><mrow id="S3.SS2.p3.20.m20.1.1" xref="S3.SS2.p3.20.m20.1.1.cmml"><mi id="S3.SS2.p3.20.m20.1.1.1" xref="S3.SS2.p3.20.m20.1.1.1.cmml">log</mi><mo id="S3.SS2.p3.20.m20.1.1a" lspace="0.167em" xref="S3.SS2.p3.20.m20.1.1.cmml">⁡</mo><msubsup id="S3.SS2.p3.20.m20.1.1.2" xref="S3.SS2.p3.20.m20.1.1.2.cmml"><mi id="S3.SS2.p3.20.m20.1.1.2.2.2" xref="S3.SS2.p3.20.m20.1.1.2.2.2.cmml">σ</mi><mi id="S3.SS2.p3.20.m20.1.1.2.3" xref="S3.SS2.p3.20.m20.1.1.2.3.cmml">k</mi><mn id="S3.SS2.p3.20.m20.1.1.2.2.3" xref="S3.SS2.p3.20.m20.1.1.2.2.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.20.m20.1b"><apply id="S3.SS2.p3.20.m20.1.1.cmml" xref="S3.SS2.p3.20.m20.1.1"><log id="S3.SS2.p3.20.m20.1.1.1.cmml" xref="S3.SS2.p3.20.m20.1.1.1"></log><apply id="S3.SS2.p3.20.m20.1.1.2.cmml" xref="S3.SS2.p3.20.m20.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m20.1.1.2.1.cmml" xref="S3.SS2.p3.20.m20.1.1.2">subscript</csymbol><apply id="S3.SS2.p3.20.m20.1.1.2.2.cmml" xref="S3.SS2.p3.20.m20.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m20.1.1.2.2.1.cmml" xref="S3.SS2.p3.20.m20.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.20.m20.1.1.2.2.2.cmml" xref="S3.SS2.p3.20.m20.1.1.2.2.2">𝜎</ci><cn id="S3.SS2.p3.20.m20.1.1.2.2.3.cmml" type="integer" xref="S3.SS2.p3.20.m20.1.1.2.2.3">2</cn></apply><ci id="S3.SS2.p3.20.m20.1.1.2.3.cmml" xref="S3.SS2.p3.20.m20.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.20.m20.1c">\log{\sigma^{2}_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.20.m20.1d">roman_log italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>,
respectively, and reconstructs the samples by a generator
<math alttext="\hat{X}_{k}=g(Z_{k})" class="ltx_Math" display="inline" id="S3.SS2.p3.21.m21.1"><semantics id="S3.SS2.p3.21.m21.1a"><mrow id="S3.SS2.p3.21.m21.1.1" xref="S3.SS2.p3.21.m21.1.1.cmml"><msub id="S3.SS2.p3.21.m21.1.1.3" xref="S3.SS2.p3.21.m21.1.1.3.cmml"><mover accent="true" id="S3.SS2.p3.21.m21.1.1.3.2" xref="S3.SS2.p3.21.m21.1.1.3.2.cmml"><mi id="S3.SS2.p3.21.m21.1.1.3.2.2" xref="S3.SS2.p3.21.m21.1.1.3.2.2.cmml">X</mi><mo id="S3.SS2.p3.21.m21.1.1.3.2.1" xref="S3.SS2.p3.21.m21.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.21.m21.1.1.3.3" xref="S3.SS2.p3.21.m21.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS2.p3.21.m21.1.1.2" xref="S3.SS2.p3.21.m21.1.1.2.cmml">=</mo><mrow id="S3.SS2.p3.21.m21.1.1.1" xref="S3.SS2.p3.21.m21.1.1.1.cmml"><mi id="S3.SS2.p3.21.m21.1.1.1.3" xref="S3.SS2.p3.21.m21.1.1.1.3.cmml">g</mi><mo id="S3.SS2.p3.21.m21.1.1.1.2" xref="S3.SS2.p3.21.m21.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.21.m21.1.1.1.1.1" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p3.21.m21.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p3.21.m21.1.1.1.1.1.1" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.21.m21.1.1.1.1.1.1.2" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S3.SS2.p3.21.m21.1.1.1.1.1.1.3" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p3.21.m21.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.21.m21.1b"><apply id="S3.SS2.p3.21.m21.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1"><eq id="S3.SS2.p3.21.m21.1.1.2.cmml" xref="S3.SS2.p3.21.m21.1.1.2"></eq><apply id="S3.SS2.p3.21.m21.1.1.3.cmml" xref="S3.SS2.p3.21.m21.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.21.m21.1.1.3.1.cmml" xref="S3.SS2.p3.21.m21.1.1.3">subscript</csymbol><apply id="S3.SS2.p3.21.m21.1.1.3.2.cmml" xref="S3.SS2.p3.21.m21.1.1.3.2"><ci id="S3.SS2.p3.21.m21.1.1.3.2.1.cmml" xref="S3.SS2.p3.21.m21.1.1.3.2.1">^</ci><ci id="S3.SS2.p3.21.m21.1.1.3.2.2.cmml" xref="S3.SS2.p3.21.m21.1.1.3.2.2">𝑋</ci></apply><ci id="S3.SS2.p3.21.m21.1.1.3.3.cmml" xref="S3.SS2.p3.21.m21.1.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p3.21.m21.1.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1.1"><times id="S3.SS2.p3.21.m21.1.1.1.2.cmml" xref="S3.SS2.p3.21.m21.1.1.1.2"></times><ci id="S3.SS2.p3.21.m21.1.1.1.3.cmml" xref="S3.SS2.p3.21.m21.1.1.1.3">𝑔</ci><apply id="S3.SS2.p3.21.m21.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.21.m21.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.21.m21.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.21.m21.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.2">𝑍</ci><ci id="S3.SS2.p3.21.m21.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.21.m21.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.21.m21.1c">\hat{X}_{k}=g(Z_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.21.m21.1d">over^ start_ARG italic_X end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_g ( italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>,
constructing a loss function with a mean-square error as
<math alttext="\mathcal{D}(\hat{X}_{k},X_{k})^{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.22.m22.2"><semantics id="S3.SS2.p3.22.m22.2a"><mrow id="S3.SS2.p3.22.m22.2.2" xref="S3.SS2.p3.22.m22.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.22.m22.2.2.4" xref="S3.SS2.p3.22.m22.2.2.4.cmml">𝒟</mi><mo id="S3.SS2.p3.22.m22.2.2.3" xref="S3.SS2.p3.22.m22.2.2.3.cmml">⁢</mo><msup id="S3.SS2.p3.22.m22.2.2.2" xref="S3.SS2.p3.22.m22.2.2.2.cmml"><mrow id="S3.SS2.p3.22.m22.2.2.2.2.2" xref="S3.SS2.p3.22.m22.2.2.2.2.3.cmml"><mo id="S3.SS2.p3.22.m22.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.p3.22.m22.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p3.22.m22.1.1.1.1.1.1" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.2" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.2.cmml">X</mi><mo id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.1" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.22.m22.1.1.1.1.1.1.3" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p3.22.m22.2.2.2.2.2.4" xref="S3.SS2.p3.22.m22.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.22.m22.2.2.2.2.2.2" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.22.m22.2.2.2.2.2.2.2" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2.2.cmml">X</mi><mi id="S3.SS2.p3.22.m22.2.2.2.2.2.2.3" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS2.p3.22.m22.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.p3.22.m22.2.2.2.2.3.cmml">)</mo></mrow><mn id="S3.SS2.p3.22.m22.2.2.2.4" xref="S3.SS2.p3.22.m22.2.2.2.4.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.22.m22.2b"><apply id="S3.SS2.p3.22.m22.2.2.cmml" xref="S3.SS2.p3.22.m22.2.2"><times id="S3.SS2.p3.22.m22.2.2.3.cmml" xref="S3.SS2.p3.22.m22.2.2.3"></times><ci id="S3.SS2.p3.22.m22.2.2.4.cmml" xref="S3.SS2.p3.22.m22.2.2.4">𝒟</ci><apply id="S3.SS2.p3.22.m22.2.2.2.cmml" xref="S3.SS2.p3.22.m22.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m22.2.2.2.3.cmml" xref="S3.SS2.p3.22.m22.2.2.2">superscript</csymbol><interval closure="open" id="S3.SS2.p3.22.m22.2.2.2.2.3.cmml" xref="S3.SS2.p3.22.m22.2.2.2.2.2"><apply id="S3.SS2.p3.22.m22.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m22.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2"><ci id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.2.2">𝑋</ci></apply><ci id="S3.SS2.p3.22.m22.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.22.m22.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.p3.22.m22.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m22.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.22.m22.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2.2">𝑋</ci><ci id="S3.SS2.p3.22.m22.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.22.m22.2.2.2.2.2.2.3">𝑘</ci></apply></interval><cn id="S3.SS2.p3.22.m22.2.2.2.4.cmml" type="integer" xref="S3.SS2.p3.22.m22.2.2.2.4">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.22.m22.2c">\mathcal{D}(\hat{X}_{k},X_{k})^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.22.m22.2d">caligraphic_D ( over^ start_ARG italic_X end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
and the sum of Kullback-Leibler Divergence (KLD) as
<math alttext="KL\bigl{(}\mathcal{N}(\mu,\sigma^{2})\|\mathcal{N}(0,1)\bigr{)}" class="ltx_Math" display="inline" id="S3.SS2.p3.23.m23.4"><semantics id="S3.SS2.p3.23.m23.4a"><mrow id="S3.SS2.p3.23.m23.4.4" xref="S3.SS2.p3.23.m23.4.4.cmml"><mi id="S3.SS2.p3.23.m23.4.4.3" xref="S3.SS2.p3.23.m23.4.4.3.cmml">K</mi><mo id="S3.SS2.p3.23.m23.4.4.2" xref="S3.SS2.p3.23.m23.4.4.2.cmml">⁢</mo><mi id="S3.SS2.p3.23.m23.4.4.4" xref="S3.SS2.p3.23.m23.4.4.4.cmml">L</mi><mo id="S3.SS2.p3.23.m23.4.4.2a" xref="S3.SS2.p3.23.m23.4.4.2.cmml">⁢</mo><mrow id="S3.SS2.p3.23.m23.4.4.1.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.cmml"><mo id="S3.SS2.p3.23.m23.4.4.1.1.2" maxsize="120%" minsize="120%" xref="S3.SS2.p3.23.m23.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.23.m23.4.4.1.1.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.cmml"><mrow id="S3.SS2.p3.23.m23.4.4.1.1.1.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.23.m23.4.4.1.1.1.1.3" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.3.cmml">𝒩</mi><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.1.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.p3.23.m23.1.1" xref="S3.SS2.p3.23.m23.1.1.cmml">μ</mi><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.3" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.2.cmml">,</mo><msup id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.4" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.2.cmml">∥</mo><mrow id="S3.SS2.p3.23.m23.4.4.1.1.1.3" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.23.m23.4.4.1.1.1.3.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.2.cmml">𝒩</mi><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.3.1" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.1.cmml"><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.1.cmml">(</mo><mn id="S3.SS2.p3.23.m23.2.2" xref="S3.SS2.p3.23.m23.2.2.cmml">0</mn><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.2.2" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.23.m23.3.3" xref="S3.SS2.p3.23.m23.3.3.cmml">1</mn><mo id="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.2.3" stretchy="false" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.p3.23.m23.4.4.1.1.3" maxsize="120%" minsize="120%" xref="S3.SS2.p3.23.m23.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.23.m23.4b"><apply id="S3.SS2.p3.23.m23.4.4.cmml" xref="S3.SS2.p3.23.m23.4.4"><times id="S3.SS2.p3.23.m23.4.4.2.cmml" xref="S3.SS2.p3.23.m23.4.4.2"></times><ci id="S3.SS2.p3.23.m23.4.4.3.cmml" xref="S3.SS2.p3.23.m23.4.4.3">𝐾</ci><ci id="S3.SS2.p3.23.m23.4.4.4.cmml" xref="S3.SS2.p3.23.m23.4.4.4">𝐿</ci><apply id="S3.SS2.p3.23.m23.4.4.1.1.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1"><csymbol cd="latexml" id="S3.SS2.p3.23.m23.4.4.1.1.1.2.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.2">conditional</csymbol><apply id="S3.SS2.p3.23.m23.4.4.1.1.1.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1"><times id="S3.SS2.p3.23.m23.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.2"></times><ci id="S3.SS2.p3.23.m23.4.4.1.1.1.1.3.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.3">𝒩</ci><interval closure="open" id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1"><ci id="S3.SS2.p3.23.m23.1.1.cmml" xref="S3.SS2.p3.23.m23.1.1">𝜇</ci><apply id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.2">𝜎</ci><cn id="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.23.m23.4.4.1.1.1.1.1.1.1.3">2</cn></apply></interval></apply><apply id="S3.SS2.p3.23.m23.4.4.1.1.1.3.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3"><times id="S3.SS2.p3.23.m23.4.4.1.1.1.3.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.1"></times><ci id="S3.SS2.p3.23.m23.4.4.1.1.1.3.2.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.2">𝒩</ci><interval closure="open" id="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.1.cmml" xref="S3.SS2.p3.23.m23.4.4.1.1.1.3.3.2"><cn id="S3.SS2.p3.23.m23.2.2.cmml" type="integer" xref="S3.SS2.p3.23.m23.2.2">0</cn><cn id="S3.SS2.p3.23.m23.3.3.cmml" type="integer" xref="S3.SS2.p3.23.m23.3.3">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.23.m23.4c">KL\bigl{(}\mathcal{N}(\mu,\sigma^{2})\|\mathcal{N}(0,1)\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.23.m23.4d">italic_K italic_L ( caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ∥ caligraphic_N ( 0 , 1 ) )</annotation></semantics></math>,
the VAE turns the sampling from <math alttext="\mathcal{N}(\mu,\sigma^{2})" class="ltx_Math" display="inline" id="S3.SS2.p3.24.m24.2"><semantics id="S3.SS2.p3.24.m24.2a"><mrow id="S3.SS2.p3.24.m24.2.2" xref="S3.SS2.p3.24.m24.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.24.m24.2.2.3" xref="S3.SS2.p3.24.m24.2.2.3.cmml">𝒩</mi><mo id="S3.SS2.p3.24.m24.2.2.2" xref="S3.SS2.p3.24.m24.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p3.24.m24.2.2.1.1" xref="S3.SS2.p3.24.m24.2.2.1.2.cmml"><mo id="S3.SS2.p3.24.m24.2.2.1.1.2" stretchy="false" xref="S3.SS2.p3.24.m24.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p3.24.m24.1.1" xref="S3.SS2.p3.24.m24.1.1.cmml">μ</mi><mo id="S3.SS2.p3.24.m24.2.2.1.1.3" xref="S3.SS2.p3.24.m24.2.2.1.2.cmml">,</mo><msup id="S3.SS2.p3.24.m24.2.2.1.1.1" xref="S3.SS2.p3.24.m24.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.24.m24.2.2.1.1.1.2" xref="S3.SS2.p3.24.m24.2.2.1.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.24.m24.2.2.1.1.1.3" xref="S3.SS2.p3.24.m24.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS2.p3.24.m24.2.2.1.1.4" stretchy="false" xref="S3.SS2.p3.24.m24.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.24.m24.2b"><apply id="S3.SS2.p3.24.m24.2.2.cmml" xref="S3.SS2.p3.24.m24.2.2"><times id="S3.SS2.p3.24.m24.2.2.2.cmml" xref="S3.SS2.p3.24.m24.2.2.2"></times><ci id="S3.SS2.p3.24.m24.2.2.3.cmml" xref="S3.SS2.p3.24.m24.2.2.3">𝒩</ci><interval closure="open" id="S3.SS2.p3.24.m24.2.2.1.2.cmml" xref="S3.SS2.p3.24.m24.2.2.1.1"><ci id="S3.SS2.p3.24.m24.1.1.cmml" xref="S3.SS2.p3.24.m24.1.1">𝜇</ci><apply id="S3.SS2.p3.24.m24.2.2.1.1.1.cmml" xref="S3.SS2.p3.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m24.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.24.m24.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.24.m24.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.24.m24.2.2.1.1.1.2">𝜎</ci><cn id="S3.SS2.p3.24.m24.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.24.m24.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.24.m24.2c">\mathcal{N}(\mu,\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.24.m24.2d">caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> into sampling from
<math alttext="\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S3.SS2.p3.25.m25.2"><semantics id="S3.SS2.p3.25.m25.2a"><mrow id="S3.SS2.p3.25.m25.2.3" xref="S3.SS2.p3.25.m25.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.25.m25.2.3.2" xref="S3.SS2.p3.25.m25.2.3.2.cmml">𝒩</mi><mo id="S3.SS2.p3.25.m25.2.3.1" xref="S3.SS2.p3.25.m25.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.25.m25.2.3.3.2" xref="S3.SS2.p3.25.m25.2.3.3.1.cmml"><mo id="S3.SS2.p3.25.m25.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.25.m25.2.3.3.1.cmml">(</mo><mn id="S3.SS2.p3.25.m25.1.1" xref="S3.SS2.p3.25.m25.1.1.cmml">0</mn><mo id="S3.SS2.p3.25.m25.2.3.3.2.2" xref="S3.SS2.p3.25.m25.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p3.25.m25.2.2" xref="S3.SS2.p3.25.m25.2.2.cmml">1</mn><mo id="S3.SS2.p3.25.m25.2.3.3.2.3" stretchy="false" xref="S3.SS2.p3.25.m25.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.25.m25.2b"><apply id="S3.SS2.p3.25.m25.2.3.cmml" xref="S3.SS2.p3.25.m25.2.3"><times id="S3.SS2.p3.25.m25.2.3.1.cmml" xref="S3.SS2.p3.25.m25.2.3.1"></times><ci id="S3.SS2.p3.25.m25.2.3.2.cmml" xref="S3.SS2.p3.25.m25.2.3.2">𝒩</ci><interval closure="open" id="S3.SS2.p3.25.m25.2.3.3.1.cmml" xref="S3.SS2.p3.25.m25.2.3.3.2"><cn id="S3.SS2.p3.25.m25.1.1.cmml" type="integer" xref="S3.SS2.p3.25.m25.1.1">0</cn><cn id="S3.SS2.p3.25.m25.2.2.cmml" type="integer" xref="S3.SS2.p3.25.m25.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.25.m25.2c">\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.25.m25.2d">caligraphic_N ( 0 , 1 )</annotation></semantics></math>,
and then obtains the sampling from <math alttext="\mathcal{N}(\mu,\sigma^{2})" class="ltx_Math" display="inline" id="S3.SS2.p3.26.m26.2"><semantics id="S3.SS2.p3.26.m26.2a"><mrow id="S3.SS2.p3.26.m26.2.2" xref="S3.SS2.p3.26.m26.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.26.m26.2.2.3" xref="S3.SS2.p3.26.m26.2.2.3.cmml">𝒩</mi><mo id="S3.SS2.p3.26.m26.2.2.2" xref="S3.SS2.p3.26.m26.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p3.26.m26.2.2.1.1" xref="S3.SS2.p3.26.m26.2.2.1.2.cmml"><mo id="S3.SS2.p3.26.m26.2.2.1.1.2" stretchy="false" xref="S3.SS2.p3.26.m26.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p3.26.m26.1.1" xref="S3.SS2.p3.26.m26.1.1.cmml">μ</mi><mo id="S3.SS2.p3.26.m26.2.2.1.1.3" xref="S3.SS2.p3.26.m26.2.2.1.2.cmml">,</mo><msup id="S3.SS2.p3.26.m26.2.2.1.1.1" xref="S3.SS2.p3.26.m26.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.26.m26.2.2.1.1.1.2" xref="S3.SS2.p3.26.m26.2.2.1.1.1.2.cmml">σ</mi><mn id="S3.SS2.p3.26.m26.2.2.1.1.1.3" xref="S3.SS2.p3.26.m26.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS2.p3.26.m26.2.2.1.1.4" stretchy="false" xref="S3.SS2.p3.26.m26.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.26.m26.2b"><apply id="S3.SS2.p3.26.m26.2.2.cmml" xref="S3.SS2.p3.26.m26.2.2"><times id="S3.SS2.p3.26.m26.2.2.2.cmml" xref="S3.SS2.p3.26.m26.2.2.2"></times><ci id="S3.SS2.p3.26.m26.2.2.3.cmml" xref="S3.SS2.p3.26.m26.2.2.3">𝒩</ci><interval closure="open" id="S3.SS2.p3.26.m26.2.2.1.2.cmml" xref="S3.SS2.p3.26.m26.2.2.1.1"><ci id="S3.SS2.p3.26.m26.1.1.cmml" xref="S3.SS2.p3.26.m26.1.1">𝜇</ci><apply id="S3.SS2.p3.26.m26.2.2.1.1.1.cmml" xref="S3.SS2.p3.26.m26.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m26.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.26.m26.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.26.m26.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.26.m26.2.2.1.1.1.2">𝜎</ci><cn id="S3.SS2.p3.26.m26.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.26.m26.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.26.m26.2c">\mathcal{N}(\mu,\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.26.m26.2d">caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> by a parameter transformation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="VAE_{Loss}=\mathcal{D}(\hat{X}_{k},X_{k})^{2}+KL\bigl{(}\mathcal{N}(\mu,\sigma%
^{2})\|\mathcal{N}(0,1)\bigr{)}." class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.5" xref="S3.E3.m1.4.4.1.1.5.cmml"><mi id="S3.E3.m1.4.4.1.1.5.2" xref="S3.E3.m1.4.4.1.1.5.2.cmml">V</mi><mo id="S3.E3.m1.4.4.1.1.5.1" xref="S3.E3.m1.4.4.1.1.5.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.5.3" xref="S3.E3.m1.4.4.1.1.5.3.cmml">A</mi><mo id="S3.E3.m1.4.4.1.1.5.1a" xref="S3.E3.m1.4.4.1.1.5.1.cmml">⁢</mo><msub id="S3.E3.m1.4.4.1.1.5.4" xref="S3.E3.m1.4.4.1.1.5.4.cmml"><mi id="S3.E3.m1.4.4.1.1.5.4.2" xref="S3.E3.m1.4.4.1.1.5.4.2.cmml">E</mi><mrow id="S3.E3.m1.4.4.1.1.5.4.3" xref="S3.E3.m1.4.4.1.1.5.4.3.cmml"><mi id="S3.E3.m1.4.4.1.1.5.4.3.2" xref="S3.E3.m1.4.4.1.1.5.4.3.2.cmml">L</mi><mo id="S3.E3.m1.4.4.1.1.5.4.3.1" xref="S3.E3.m1.4.4.1.1.5.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.5.4.3.3" xref="S3.E3.m1.4.4.1.1.5.4.3.3.cmml">o</mi><mo id="S3.E3.m1.4.4.1.1.5.4.3.1a" xref="S3.E3.m1.4.4.1.1.5.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.5.4.3.4" xref="S3.E3.m1.4.4.1.1.5.4.3.4.cmml">s</mi><mo id="S3.E3.m1.4.4.1.1.5.4.3.1b" xref="S3.E3.m1.4.4.1.1.5.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.5.4.3.5" xref="S3.E3.m1.4.4.1.1.5.4.3.5.cmml">s</mi></mrow></msub></mrow><mo id="S3.E3.m1.4.4.1.1.4" xref="S3.E3.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mrow id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.2.2.4" xref="S3.E3.m1.4.4.1.1.2.2.4.cmml">𝒟</mi><mo id="S3.E3.m1.4.4.1.1.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.3.cmml">⁢</mo><msup id="S3.E3.m1.4.4.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.cmml"><mrow id="S3.E3.m1.4.4.1.1.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml"><mo id="S3.E3.m1.4.4.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">X</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E3.m1.4.4.1.1.2.2.2.2.2.4" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">X</mi><mi id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.E3.m1.4.4.1.1.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml">)</mo></mrow><mn id="S3.E3.m1.4.4.1.1.2.2.2.4" xref="S3.E3.m1.4.4.1.1.2.2.2.4.cmml">2</mn></msup></mrow><mo id="S3.E3.m1.4.4.1.1.3.4" xref="S3.E3.m1.4.4.1.1.3.4.cmml">+</mo><mrow id="S3.E3.m1.4.4.1.1.3.3" xref="S3.E3.m1.4.4.1.1.3.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.3" xref="S3.E3.m1.4.4.1.1.3.3.3.cmml">K</mi><mo id="S3.E3.m1.4.4.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.2.cmml">⁢</mo><mi id="S3.E3.m1.4.4.1.1.3.3.4" xref="S3.E3.m1.4.4.1.1.3.3.4.cmml">L</mi><mo id="S3.E3.m1.4.4.1.1.3.3.2a" xref="S3.E3.m1.4.4.1.1.3.3.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.cmml"><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.2" maxsize="120%" minsize="120%" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.3.cmml">𝒩</mi><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">μ</mi><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.2.cmml">σ</mi><mn id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.2.cmml">∥</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.2.cmml">𝒩</mi><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.1" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.1.cmml"><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.1.cmml">(</mo><mn id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">0</mn><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.2.2" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.1.cmml">,</mo><mn id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">1</mn><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.2.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.3.3.1.1.3" maxsize="120%" minsize="120%" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" lspace="0em" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.4.cmml" xref="S3.E3.m1.4.4.1.1.4"></eq><apply id="S3.E3.m1.4.4.1.1.5.cmml" xref="S3.E3.m1.4.4.1.1.5"><times id="S3.E3.m1.4.4.1.1.5.1.cmml" xref="S3.E3.m1.4.4.1.1.5.1"></times><ci id="S3.E3.m1.4.4.1.1.5.2.cmml" xref="S3.E3.m1.4.4.1.1.5.2">𝑉</ci><ci id="S3.E3.m1.4.4.1.1.5.3.cmml" xref="S3.E3.m1.4.4.1.1.5.3">𝐴</ci><apply id="S3.E3.m1.4.4.1.1.5.4.cmml" xref="S3.E3.m1.4.4.1.1.5.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.5.4.1.cmml" xref="S3.E3.m1.4.4.1.1.5.4">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.5.4.2.cmml" xref="S3.E3.m1.4.4.1.1.5.4.2">𝐸</ci><apply id="S3.E3.m1.4.4.1.1.5.4.3.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3"><times id="S3.E3.m1.4.4.1.1.5.4.3.1.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3.1"></times><ci id="S3.E3.m1.4.4.1.1.5.4.3.2.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3.2">𝐿</ci><ci id="S3.E3.m1.4.4.1.1.5.4.3.3.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3.3">𝑜</ci><ci id="S3.E3.m1.4.4.1.1.5.4.3.4.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3.4">𝑠</ci><ci id="S3.E3.m1.4.4.1.1.5.4.3.5.cmml" xref="S3.E3.m1.4.4.1.1.5.4.3.5">𝑠</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><plus id="S3.E3.m1.4.4.1.1.3.4.cmml" xref="S3.E3.m1.4.4.1.1.3.4"></plus><apply id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2"><times id="S3.E3.m1.4.4.1.1.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.3"></times><ci id="S3.E3.m1.4.4.1.1.2.2.4.cmml" xref="S3.E3.m1.4.4.1.1.2.2.4">𝒟</ci><apply id="S3.E3.m1.4.4.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2">superscript</csymbol><interval closure="open" id="S3.E3.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2"><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2"><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝑋</ci></apply><ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.2">𝑋</ci><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2.2.2.3">𝑘</ci></apply></interval><cn id="S3.E3.m1.4.4.1.1.2.2.2.4.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.2.2.2.4">2</cn></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3"><times id="S3.E3.m1.4.4.1.1.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2"></times><ci id="S3.E3.m1.4.4.1.1.3.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3">𝐾</ci><ci id="S3.E3.m1.4.4.1.1.3.3.4.cmml" xref="S3.E3.m1.4.4.1.1.3.3.4">𝐿</ci><apply id="S3.E3.m1.4.4.1.1.3.3.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.2">conditional</csymbol><apply id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1"><times id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.2"></times><ci id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.3">𝒩</ci><interval closure="open" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝜇</ci><apply id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.2">𝜎</ci><cn id="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.1.1.1.1.3">2</cn></apply></interval></apply><apply id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3"><times id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.1"></times><ci id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.2">𝒩</ci><interval closure="open" id="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1.1.1.3.3.2"><cn id="S3.E3.m1.2.2.cmml" type="integer" xref="S3.E3.m1.2.2">0</cn><cn id="S3.E3.m1.3.3.cmml" type="integer" xref="S3.E3.m1.3.3">1</cn></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">VAE_{Loss}=\mathcal{D}(\hat{X}_{k},X_{k})^{2}+KL\bigl{(}\mathcal{N}(\mu,\sigma%
^{2})\|\mathcal{N}(0,1)\bigr{)}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">italic_V italic_A italic_E start_POSTSUBSCRIPT italic_L italic_o italic_s italic_s end_POSTSUBSCRIPT = caligraphic_D ( over^ start_ARG italic_X end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_K italic_L ( caligraphic_N ( italic_μ , italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ∥ caligraphic_N ( 0 , 1 ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">The ‘Variational’ in VAE means that the derivation process uses the variational method to find the variational lower bound of the KLD generalized extremum, which is essentially the introduction of Gaussian noise into the encoder on the basis of the self-encoder, so that the decoder can be robust to the noise to improve the generalization ability. The KLD is equivalent to a regular term of the encoder, which aims to keep <math alttext="p(Z)" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.2" xref="S3.SS2.p4.1.m1.1.2.cmml"><mi id="S3.SS2.p4.1.m1.1.2.2" xref="S3.SS2.p4.1.m1.1.2.2.cmml">p</mi><mo id="S3.SS2.p4.1.m1.1.2.1" xref="S3.SS2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.1.2.3.2" xref="S3.SS2.p4.1.m1.1.2.cmml"><mo id="S3.SS2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">Z</mi><mo id="S3.SS2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.2"><times id="S3.SS2.p4.1.m1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.2.1"></times><ci id="S3.SS2.p4.1.m1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.2.2">𝑝</ci><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">p(Z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_p ( italic_Z )</annotation></semantics></math> as close as possible to the standard normal distribution. Conversely, the encoder is also capable of dynamically adjusting the intensity of the noise, thus achieving a GAN-like adversarial training process. In order to satisfy the individual needs of users, in our work, the VAE is allowed to learn the mean and log-variance independently for each user in each batch, and to make the distribution of each pair of mean and log-variance converge to the normal distribution during the training process.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Contrastive Learning</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Contrastive learning originated in 2014 when Kateria Fragkiadaki et al. questioned in the face of supervised pre-training of ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib34" title="">34</a>]</cite>, whether semantic supervision was really needed to learn good information representations. Five years later, the MoCo model based on the contrast learning paradigm proposed by He et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib35" title="">35</a>]</cite> outperformed the mainstream supervised learning methods on the task of Pascal VOC target detection of the time. Contrastive learning is centered on gradually narrowing the spacing of similar samples and expanding the distance of dissimilar samples by comparing the differences between two or more samples, and has been widely used because it does not require artificial labels. Let a data sample <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_x</annotation></semantics></math>, contrastive learning aims to learn an encoder <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.2.2" xref="S3.SS3.p1.2.m2.1.2.2.cmml">f</mi><mo id="S3.SS3.p1.2.m2.1.2.1" xref="S3.SS3.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.2.m2.1.2.3.2" xref="S3.SS3.p1.2.m2.1.2.cmml"><mo id="S3.SS3.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">x</mi><mo id="S3.SS3.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.2.cmml" xref="S3.SS3.p1.2.m2.1.2"><times id="S3.SS3.p1.2.m2.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.2.1"></times><ci id="S3.SS3.p1.2.m2.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.2.2">𝑓</ci><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_f ( italic_x )</annotation></semantics></math> such that:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="Score\bigl{(}f(x),f(x^{+})\bigr{)}\gg Score\bigl{(}f(x),f(x^{-})\bigr{)}," class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.4" xref="S3.E4.m1.3.3.1.1.2.4.cmml">S</mi><mo id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.5" xref="S3.E4.m1.3.3.1.1.2.5.cmml">c</mi><mo id="S3.E4.m1.3.3.1.1.2.3a" xref="S3.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.6" xref="S3.E4.m1.3.3.1.1.2.6.cmml">o</mi><mo id="S3.E4.m1.3.3.1.1.2.3b" xref="S3.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.7" xref="S3.E4.m1.3.3.1.1.2.7.cmml">r</mi><mo id="S3.E4.m1.3.3.1.1.2.3c" xref="S3.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.2.8" xref="S3.E4.m1.3.3.1.1.2.8.cmml">e</mi><mo id="S3.E4.m1.3.3.1.1.2.3d" xref="S3.E4.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml"><mo id="S3.E4.m1.3.3.1.1.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">x</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.2.2.2.4" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3.cmml">f</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.2" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml">x</mi><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml">+</mo></msup><mo id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.2.2.2.5" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.5" xref="S3.E4.m1.3.3.1.1.5.cmml">≫</mo><mrow id="S3.E4.m1.3.3.1.1.4" xref="S3.E4.m1.3.3.1.1.4.cmml"><mi id="S3.E4.m1.3.3.1.1.4.4" xref="S3.E4.m1.3.3.1.1.4.4.cmml">S</mi><mo id="S3.E4.m1.3.3.1.1.4.3" xref="S3.E4.m1.3.3.1.1.4.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.5" xref="S3.E4.m1.3.3.1.1.4.5.cmml">c</mi><mo id="S3.E4.m1.3.3.1.1.4.3a" xref="S3.E4.m1.3.3.1.1.4.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.6" xref="S3.E4.m1.3.3.1.1.4.6.cmml">o</mi><mo id="S3.E4.m1.3.3.1.1.4.3b" xref="S3.E4.m1.3.3.1.1.4.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.7" xref="S3.E4.m1.3.3.1.1.4.7.cmml">r</mi><mo id="S3.E4.m1.3.3.1.1.4.3c" xref="S3.E4.m1.3.3.1.1.4.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.8" xref="S3.E4.m1.3.3.1.1.4.8.cmml">e</mi><mo id="S3.E4.m1.3.3.1.1.4.3d" xref="S3.E4.m1.3.3.1.1.4.3.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.4.2.2" xref="S3.E4.m1.3.3.1.1.4.2.3.cmml"><mo id="S3.E4.m1.3.3.1.1.4.2.2.3" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.1.1.4.2.3.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.3.1.1.1" xref="S3.E4.m1.3.3.1.1.3.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.3.1.1.1.2.cmml">f</mi><mo id="S3.E4.m1.3.3.1.1.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.3.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.3.1.1.1.3.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.3.1.1.1.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">x</mi><mo id="S3.E4.m1.3.3.1.1.3.1.1.1.3.2.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.4.2.2.4" xref="S3.E4.m1.3.3.1.1.4.2.3.cmml">,</mo><mrow id="S3.E4.m1.3.3.1.1.4.2.2.2" xref="S3.E4.m1.3.3.1.1.4.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.4.2.2.2.3" xref="S3.E4.m1.3.3.1.1.4.2.2.2.3.cmml">f</mi><mo id="S3.E4.m1.3.3.1.1.4.2.2.2.2" xref="S3.E4.m1.3.3.1.1.4.2.2.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.2" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.2.cmml">x</mi><mo id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.3" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.3.cmml">−</mo></msup><mo id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.4.2.2.5" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.5.cmml" xref="S3.E4.m1.3.3.1.1.5">much-greater-than</csymbol><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><times id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3"></times><ci id="S3.E4.m1.3.3.1.1.2.4.cmml" xref="S3.E4.m1.3.3.1.1.2.4">𝑆</ci><ci id="S3.E4.m1.3.3.1.1.2.5.cmml" xref="S3.E4.m1.3.3.1.1.2.5">𝑐</ci><ci id="S3.E4.m1.3.3.1.1.2.6.cmml" xref="S3.E4.m1.3.3.1.1.2.6">𝑜</ci><ci id="S3.E4.m1.3.3.1.1.2.7.cmml" xref="S3.E4.m1.3.3.1.1.2.7">𝑟</ci><ci id="S3.E4.m1.3.3.1.1.2.8.cmml" xref="S3.E4.m1.3.3.1.1.2.8">𝑒</ci><interval closure="open" id="S3.E4.m1.3.3.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2"><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑥</ci></apply><apply id="S3.E4.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2"><times id="S3.E4.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.2"></times><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.3">𝑓</ci><apply id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.2">𝑥</ci><plus id="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2.2.1.1.1.3"></plus></apply></apply></interval></apply><apply id="S3.E4.m1.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.4"><times id="S3.E4.m1.3.3.1.1.4.3.cmml" xref="S3.E4.m1.3.3.1.1.4.3"></times><ci id="S3.E4.m1.3.3.1.1.4.4.cmml" xref="S3.E4.m1.3.3.1.1.4.4">𝑆</ci><ci id="S3.E4.m1.3.3.1.1.4.5.cmml" xref="S3.E4.m1.3.3.1.1.4.5">𝑐</ci><ci id="S3.E4.m1.3.3.1.1.4.6.cmml" xref="S3.E4.m1.3.3.1.1.4.6">𝑜</ci><ci id="S3.E4.m1.3.3.1.1.4.7.cmml" xref="S3.E4.m1.3.3.1.1.4.7">𝑟</ci><ci id="S3.E4.m1.3.3.1.1.4.8.cmml" xref="S3.E4.m1.3.3.1.1.4.8">𝑒</ci><interval closure="open" id="S3.E4.m1.3.3.1.1.4.2.3.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2"><apply id="S3.E4.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1.1.1.1"></times><ci id="S3.E4.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.3.1.1.1.2">𝑓</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑥</ci></apply><apply id="S3.E4.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2"><times id="S3.E4.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.2"></times><ci id="S3.E4.m1.3.3.1.1.4.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.3">𝑓</ci><apply id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.2">𝑥</ci><minus id="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.4.2.2.2.1.1.1.3"></minus></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">Score\bigl{(}f(x),f(x^{+})\bigr{)}\gg Score\bigl{(}f(x),f(x^{-})\bigr{)},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_S italic_c italic_o italic_r italic_e ( italic_f ( italic_x ) , italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) ≫ italic_S italic_c italic_o italic_r italic_e ( italic_f ( italic_x ) , italic_f ( italic_x start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.7">where <math alttext="x^{+}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑥</ci><plus id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">x^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> denotes a positive sample that is similar to <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_x</annotation></semantics></math>, and <math alttext="x^{-}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">x</mi><mo id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑥</ci><minus id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">x^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_x start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> denotes a negative sample that is not similar to <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_x</annotation></semantics></math>. <math alttext="Score(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.2"><semantics id="S3.SS3.p2.5.m5.2a"><mrow id="S3.SS3.p2.5.m5.2.3" xref="S3.SS3.p2.5.m5.2.3.cmml"><mi id="S3.SS3.p2.5.m5.2.3.2" xref="S3.SS3.p2.5.m5.2.3.2.cmml">S</mi><mo id="S3.SS3.p2.5.m5.2.3.1" xref="S3.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.2.3.3" xref="S3.SS3.p2.5.m5.2.3.3.cmml">c</mi><mo id="S3.SS3.p2.5.m5.2.3.1a" xref="S3.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.2.3.4" xref="S3.SS3.p2.5.m5.2.3.4.cmml">o</mi><mo id="S3.SS3.p2.5.m5.2.3.1b" xref="S3.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.2.3.5" xref="S3.SS3.p2.5.m5.2.3.5.cmml">r</mi><mo id="S3.SS3.p2.5.m5.2.3.1c" xref="S3.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.2.3.6" xref="S3.SS3.p2.5.m5.2.3.6.cmml">e</mi><mo id="S3.SS3.p2.5.m5.2.3.1d" xref="S3.SS3.p2.5.m5.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.2.3.7.2" xref="S3.SS3.p2.5.m5.2.3.7.1.cmml"><mo id="S3.SS3.p2.5.m5.2.3.7.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.7.1.cmml">(</mo><mo id="S3.SS3.p2.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.5.m5.1.1.cmml">⋅</mo><mo id="S3.SS3.p2.5.m5.2.3.7.2.2" rspace="0em" xref="S3.SS3.p2.5.m5.2.3.7.1.cmml">,</mo><mo id="S3.SS3.p2.5.m5.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p2.5.m5.2.2.cmml">⋅</mo><mo id="S3.SS3.p2.5.m5.2.3.7.2.3" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.7.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.2b"><apply id="S3.SS3.p2.5.m5.2.3.cmml" xref="S3.SS3.p2.5.m5.2.3"><times id="S3.SS3.p2.5.m5.2.3.1.cmml" xref="S3.SS3.p2.5.m5.2.3.1"></times><ci id="S3.SS3.p2.5.m5.2.3.2.cmml" xref="S3.SS3.p2.5.m5.2.3.2">𝑆</ci><ci id="S3.SS3.p2.5.m5.2.3.3.cmml" xref="S3.SS3.p2.5.m5.2.3.3">𝑐</ci><ci id="S3.SS3.p2.5.m5.2.3.4.cmml" xref="S3.SS3.p2.5.m5.2.3.4">𝑜</ci><ci id="S3.SS3.p2.5.m5.2.3.5.cmml" xref="S3.SS3.p2.5.m5.2.3.5">𝑟</ci><ci id="S3.SS3.p2.5.m5.2.3.6.cmml" xref="S3.SS3.p2.5.m5.2.3.6">𝑒</ci><interval closure="open" id="S3.SS3.p2.5.m5.2.3.7.1.cmml" xref="S3.SS3.p2.5.m5.2.3.7.2"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">⋅</ci><ci id="S3.SS3.p2.5.m5.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.2c">Score(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.2d">italic_S italic_c italic_o italic_r italic_e ( ⋅ , ⋅ )</annotation></semantics></math> is a measure of the similarity between two features, typically a function of Euclidean distance, cosine similarity, etc. Here <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_x</annotation></semantics></math> is commonly referred to as the anchor point, and aiming to optimize <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_x</annotation></semantics></math>, a classifier is typically constructed to assign high scores to positive samples and low scores to negative samples:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;\mathcal{L}_{N}=-\mathbb{E}_{X}\\
&amp;[\log\frac{\exp\bigl{(}f(x)^{\top}f(x^{+})\bigr{)}}{\exp\bigl{(}f(x)^{\top}f(%
x^{+})\bigr{)}+\sum_{j=1}^{N-1}\exp\bigl{(}f(x)^{\top}f(x_{j})\bigr{)}}],\end{split}" class="ltx_Math" display="block" id="S3.E5.m1.13"><semantics id="S3.E5.m1.13a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.13.13.2" rowspacing="0pt"><mtr id="S3.E5.m1.13.13.2a"><mtd id="S3.E5.m1.13.13.2b" xref="S3.E5.m1.12.12.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.13.13.2c"><mrow id="S3.E5.m1.6.6.6.6.6"><msub id="S3.E5.m1.6.6.6.6.6.7"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">ℒ</mi><mi id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">N</mi></msub><mo id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E5.m1.6.6.6.6.6.8"><mo id="S3.E5.m1.6.6.6.6.6.8a" xref="S3.E5.m1.12.12.1.1.1.cmml">−</mo><msub id="S3.E5.m1.6.6.6.6.6.8.1"><mi id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">𝔼</mi><mi id="S3.E5.m1.6.6.6.6.6.6.1" xref="S3.E5.m1.6.6.6.6.6.6.1.cmml">X</mi></msub></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.13.13.2d"><mtd id="S3.E5.m1.13.13.2e" xref="S3.E5.m1.12.12.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.13.13.2f"><mrow id="S3.E5.m1.13.13.2.12.6.6.6"><mrow id="S3.E5.m1.13.13.2.12.6.6.6.1"><mo id="S3.E5.m1.7.7.7.1.1.1" stretchy="false" xref="S3.E5.m1.12.12.1.1.1.cmml">[</mo><mrow id="S3.E5.m1.13.13.2.12.6.6.6.1.1.1"><mi id="S3.E5.m1.8.8.8.2.2.2" xref="S3.E5.m1.8.8.8.2.2.2.cmml">log</mi><mo id="S3.E5.m1.13.13.2.12.6.6.6.1.1.1a" lspace="0.167em" xref="S3.E5.m1.12.12.1.1.1.cmml">⁡</mo><mfrac id="S3.E5.m1.9.9.9.3.3.3" xref="S3.E5.m1.9.9.9.3.3.3.cmml"><mrow id="S3.E5.m1.9.9.9.3.3.3.3.3" xref="S3.E5.m1.9.9.9.3.3.3.3.4.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.2.2" xref="S3.E5.m1.9.9.9.3.3.3.2.2.cmml">exp</mi><mo id="S3.E5.m1.9.9.9.3.3.3.3.3a" xref="S3.E5.m1.9.9.9.3.3.3.3.4.cmml">⁡</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.3.3.1" xref="S3.E5.m1.9.9.9.3.3.3.3.4.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.2" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.3.4.cmml">(</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.3.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2.cmml">⁢</mo><msup id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.cmml"><mrow id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.2.2" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.2.2.1" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.cmml">(</mo><mi id="S3.E5.m1.9.9.9.3.3.3.1.1" xref="S3.E5.m1.9.9.9.3.3.3.1.1.cmml">x</mi><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.2.2.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.cmml">)</mo></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.3" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.3.cmml">⊤</mo></msup><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2a" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.5" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.5.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2b" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.cmml">(</mo><msup id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.3.3.1.3" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.9.9.9.3.3.3.9" xref="S3.E5.m1.9.9.9.3.3.3.9.cmml"><mrow id="S3.E5.m1.9.9.9.3.3.3.8.5.1" xref="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.5.2" xref="S3.E5.m1.9.9.9.3.3.3.5.2.cmml">exp</mi><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1a" xref="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml">⁡</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1" xref="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.2" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml">(</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.3.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2.cmml">⁢</mo><msup id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.cmml"><mrow id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.2.2" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.2.2.1" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.cmml">(</mo><mi id="S3.E5.m1.9.9.9.3.3.3.4.1" xref="S3.E5.m1.9.9.9.3.3.3.4.1.cmml">x</mi><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.2.2.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.cmml">)</mo></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.3" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.3.cmml">⊤</mo></msup><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2a" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.5" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.5.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2b" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.3" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.9.7" rspace="0.055em" xref="S3.E5.m1.9.9.9.3.3.3.9.7.cmml">+</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6" xref="S3.E5.m1.9.9.9.3.3.3.9.6.cmml"><msubsup id="S3.E5.m1.9.9.9.3.3.3.9.6.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.2.cmml">j</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.2.cmml">N</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.1.cmml">−</mo><mn id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.7.4" xref="S3.E5.m1.9.9.9.3.3.3.7.4.cmml">exp</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1a" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml">⁡</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml">(</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.3.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.cmml"><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.2.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.2.2.1" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.cmml">(</mo><mi id="S3.E5.m1.9.9.9.3.3.3.6.3" xref="S3.E5.m1.9.9.9.3.3.3.6.3.cmml">x</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.2.2.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.3.cmml">⊤</mo></msup><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2a" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.5" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.5.cmml">f</mi><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2b" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.2" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.3" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E5.m1.10.10.10.4.4.4" stretchy="false" xref="S3.E5.m1.12.12.1.1.1.cmml">]</mo></mrow><mo id="S3.E5.m1.11.11.11.5.5.5" xref="S3.E5.m1.12.12.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.13b"><apply id="S3.E5.m1.12.12.1.1.1.cmml" xref="S3.E5.m1.13.13.2b"><eq id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3"></eq><apply id="S3.E5.m1.12.12.1.1.1.3.cmml" xref="S3.E5.m1.13.13.2b"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.1.1.1.3.1.cmml" xref="S3.E5.m1.13.13.2b">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1">𝑁</ci></apply><apply id="S3.E5.m1.12.12.1.1.1.1.cmml" xref="S3.E5.m1.13.13.2b"><minus id="S3.E5.m1.4.4.4.4.4.4.cmml" xref="S3.E5.m1.13.13.2b"></minus><apply id="S3.E5.m1.12.12.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.2b"><times id="S3.E5.m1.12.12.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.2b"></times><apply id="S3.E5.m1.12.12.1.1.1.1.1.3.cmml" xref="S3.E5.m1.13.13.2b"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.13.13.2b">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">𝔼</ci><ci id="S3.E5.m1.6.6.6.6.6.6.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1">𝑋</ci></apply><apply id="S3.E5.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.2b"><csymbol cd="latexml" id="S3.E5.m1.12.12.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.13.13.2b">delimited-[]</csymbol><apply id="S3.E5.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.2b"><log id="S3.E5.m1.8.8.8.2.2.2.cmml" xref="S3.E5.m1.8.8.8.2.2.2"></log><apply id="S3.E5.m1.9.9.9.3.3.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3"><divide id="S3.E5.m1.9.9.9.3.3.3.10.cmml" xref="S3.E5.m1.9.9.9.3.3.3"></divide><apply id="S3.E5.m1.9.9.9.3.3.3.3.4.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3"><exp id="S3.E5.m1.9.9.9.3.3.3.2.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.2.2"></exp><apply id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1"><times id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.2"></times><ci id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.3">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4">superscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.1.1">𝑥</ci><csymbol cd="latexml" id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.4.3">top</csymbol></apply><ci id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.5.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.5">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.2">𝑥</ci><plus id="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.3.3.1.1.1.1.1.3"></plus></apply></apply></apply><apply id="S3.E5.m1.9.9.9.3.3.3.9.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9"><plus id="S3.E5.m1.9.9.9.3.3.3.9.7.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.7"></plus><apply id="S3.E5.m1.9.9.9.3.3.3.8.5.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1"><exp id="S3.E5.m1.9.9.9.3.3.3.5.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.5.2"></exp><apply id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1"><times id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.2"></times><ci id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.3">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4">superscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.4.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.4.1">𝑥</ci><csymbol cd="latexml" id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.4.3">top</csymbol></apply><ci id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.5.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.5">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.2">𝑥</ci><plus id="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.8.5.1.1.1.1.1.1.3"></plus></apply></apply></apply><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6"><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.9.6.2.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2">superscript</csymbol><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2">subscript</csymbol><sum id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.2"></sum><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3"><eq id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.1"></eq><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.2">𝑗</ci><cn id="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3"><minus id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.1"></minus><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.2">𝑁</ci><cn id="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.3.cmml" type="integer" xref="S3.E5.m1.9.9.9.3.3.3.9.6.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1"><exp id="S3.E5.m1.9.9.9.3.3.3.7.4.cmml" xref="S3.E5.m1.9.9.9.3.3.3.7.4"></exp><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1"><times id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.2"></times><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.3">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4">superscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.6.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.6.3">𝑥</ci><csymbol cd="latexml" id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.4.3">top</csymbol></apply><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.5.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.5">𝑓</ci><apply id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.9.9.9.3.3.3.9.6.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.13c">\begin{split}&amp;\mathcal{L}_{N}=-\mathbb{E}_{X}\\
&amp;[\log\frac{\exp\bigl{(}f(x)^{\top}f(x^{+})\bigr{)}}{\exp\bigl{(}f(x)^{\top}f(%
x^{+})\bigr{)}+\sum_{j=1}^{N-1}\exp\bigl{(}f(x)^{\top}f(x_{j})\bigr{)}}],\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.13d">start_ROW start_CELL end_CELL start_CELL caligraphic_L start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL [ roman_log divide start_ARG roman_exp ( italic_f ( italic_x ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_f ( italic_x ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT roman_exp ( italic_f ( italic_x ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_f ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">and</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="Score\bigl{(}f(x),f(x^{+})\bigr{)}=f(x)^{\top}f(x^{+})," class="ltx_Math" display="block" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.4" xref="S3.E6.m1.3.3.1.1.2.4.cmml">S</mi><mo id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.5" xref="S3.E6.m1.3.3.1.1.2.5.cmml">c</mi><mo id="S3.E6.m1.3.3.1.1.2.3a" xref="S3.E6.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.6" xref="S3.E6.m1.3.3.1.1.2.6.cmml">o</mi><mo id="S3.E6.m1.3.3.1.1.2.3b" xref="S3.E6.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.7" xref="S3.E6.m1.3.3.1.1.2.7.cmml">r</mi><mo id="S3.E6.m1.3.3.1.1.2.3c" xref="S3.E6.m1.3.3.1.1.2.3.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.8" xref="S3.E6.m1.3.3.1.1.2.8.cmml">e</mi><mo id="S3.E6.m1.3.3.1.1.2.3d" xref="S3.E6.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.2.4" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml">+</mo></msup><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.2.5" maxsize="120%" minsize="120%" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.4" xref="S3.E6.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.3.3" xref="S3.E6.m1.3.3.1.1.3.3.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.3.2" xref="S3.E6.m1.3.3.1.1.3.2.cmml">⁢</mo><msup id="S3.E6.m1.3.3.1.1.3.4" xref="S3.E6.m1.3.3.1.1.3.4.cmml"><mrow id="S3.E6.m1.3.3.1.1.3.4.2.2" xref="S3.E6.m1.3.3.1.1.3.4.cmml"><mo id="S3.E6.m1.3.3.1.1.3.4.2.2.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.4.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.3.4.2.2.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.4.cmml">)</mo></mrow><mo id="S3.E6.m1.3.3.1.1.3.4.3" xref="S3.E6.m1.3.3.1.1.3.4.3.cmml">⊤</mo></msup><mo id="S3.E6.m1.3.3.1.1.3.2a" xref="S3.E6.m1.3.3.1.1.3.2.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.3.5" xref="S3.E6.m1.3.3.1.1.3.5.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.3.2b" xref="S3.E6.m1.3.3.1.1.3.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.3.1.1" xref="S3.E6.m1.3.3.1.1.3.1.1.1.cmml"><mo id="S3.E6.m1.3.3.1.1.3.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.1.1.1.cmml">(</mo><msup id="S3.E6.m1.3.3.1.1.3.1.1.1" xref="S3.E6.m1.3.3.1.1.3.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.3.1.1.1.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.cmml">+</mo></msup><mo id="S3.E6.m1.3.3.1.1.3.1.1.3" stretchy="false" xref="S3.E6.m1.3.3.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.4"></eq><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><times id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3"></times><ci id="S3.E6.m1.3.3.1.1.2.4.cmml" xref="S3.E6.m1.3.3.1.1.2.4">𝑆</ci><ci id="S3.E6.m1.3.3.1.1.2.5.cmml" xref="S3.E6.m1.3.3.1.1.2.5">𝑐</ci><ci id="S3.E6.m1.3.3.1.1.2.6.cmml" xref="S3.E6.m1.3.3.1.1.2.6">𝑜</ci><ci id="S3.E6.m1.3.3.1.1.2.7.cmml" xref="S3.E6.m1.3.3.1.1.2.7">𝑟</ci><ci id="S3.E6.m1.3.3.1.1.2.8.cmml" xref="S3.E6.m1.3.3.1.1.2.8">𝑒</ci><interval closure="open" id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑥</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2"><times id="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2"></times><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3">𝑓</ci><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.2">𝑥</ci><plus id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.3"></plus></apply></apply></interval></apply><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"><times id="S3.E6.m1.3.3.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.2"></times><ci id="S3.E6.m1.3.3.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3">𝑓</ci><apply id="S3.E6.m1.3.3.1.1.3.4.cmml" xref="S3.E6.m1.3.3.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.4.1.cmml" xref="S3.E6.m1.3.3.1.1.3.4">superscript</csymbol><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑥</ci><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.3.4.3.cmml" xref="S3.E6.m1.3.3.1.1.3.4.3">top</csymbol></apply><ci id="S3.E6.m1.3.3.1.1.3.5.cmml" xref="S3.E6.m1.3.3.1.1.3.5">𝑓</ci><apply id="S3.E6.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.2">𝑥</ci><plus id="S3.E6.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">Score\bigl{(}f(x),f(x^{+})\bigr{)}=f(x)^{\top}f(x^{+}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_S italic_c italic_o italic_r italic_e ( italic_f ( italic_x ) , italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) = italic_f ( italic_x ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">where the numerator is a positive sample, the denominator includes one positive sample and N-1 negative samples, the similarity metric is the dot product. In contrastive learning, this loss function for evaluating positive and negative samples with anchors is called InfoNCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib36" title="">36</a>]</cite> (Information Noise-Contrastive Estimation).</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.4">In contrastive learning, mutual information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib37" title="">37</a>]</cite> is used to indicate the degree of association of an anchor point with a positive sample, so the process of minimizing the InfoNCE loss is also seen as maximizing the mutual information lower bound of <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mi id="S3.SS3.p5.1.m1.1.2.2" xref="S3.SS3.p5.1.m1.1.2.2.cmml">f</mi><mo id="S3.SS3.p5.1.m1.1.2.1" xref="S3.SS3.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p5.1.m1.1.2.3.2" xref="S3.SS3.p5.1.m1.1.2.cmml"><mo id="S3.SS3.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">x</mi><mo id="S3.SS3.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.2"><times id="S3.SS3.p5.1.m1.1.2.1.cmml" xref="S3.SS3.p5.1.m1.1.2.1"></times><ci id="S3.SS3.p5.1.m1.1.2.2.cmml" xref="S3.SS3.p5.1.m1.1.2.2">𝑓</ci><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_f ( italic_x )</annotation></semantics></math> and <math alttext="f(x^{+})" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml">f</mi><mo id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p5.2.m2.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p5.2.m2.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml">x</mi><mo id="S3.SS3.p5.2.m2.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S3.SS3.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><times id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2"></times><ci id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3">𝑓</ci><apply id="S3.SS3.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2">𝑥</ci><plus id="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">f(x^{+})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_f ( italic_x start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT )</annotation></semantics></math>, and VAE also serves the same purpose of constraining the Evidence Lower Bound while minimizing the prior distribution role. Specifically, the correlation between samples <math alttext="X" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_X</annotation></semantics></math> and <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.1"><semantics id="S3.SS3.p5.4.m4.1a"><mi id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><ci id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.4.m4.1d">italic_Z</annotation></semantics></math> is expressed in terms of mutual information:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}I(X,Z)&amp;=\iint{p(z|x)\tilde{p}(x)\log\frac{p(z|x)\tilde{p}(x)}{p(z%
)\tilde{p}(x)}}dxdz\\
&amp;=KL(p(z|x)\tilde{p}(x)\|p(z)\tilde{p}(x)),\end{split}" class="ltx_Math" display="block" id="S3.E7.m1.52"><semantics id="S3.E7.m1.52a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E7.m1.52.52.3" rowspacing="0pt"><mtr id="S3.E7.m1.52.52.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.52.52.3b"><mrow id="S3.E7.m1.6.6.6.6.6"><mi id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">I</mi><mo id="S3.E7.m1.6.6.6.6.6.7" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.6.6.6.6.6.8"><mo id="S3.E7.m1.2.2.2.2.2.2" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mi id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">X</mi><mo id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.50.50.1.1.1.cmml">,</mo><mi id="S3.E7.m1.5.5.5.5.5.5" xref="S3.E7.m1.5.5.5.5.5.5.cmml">Z</mi><mo id="S3.E7.m1.6.6.6.6.6.6" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.52.52.3c"><mrow id="S3.E7.m1.51.51.2.50.25.19"><mi id="S3.E7.m1.51.51.2.50.25.19.20" xref="S3.E7.m1.50.50.1.1.1.cmml"></mi><mo id="S3.E7.m1.7.7.7.7.1.1" rspace="0.111em" xref="S3.E7.m1.7.7.7.7.1.1.cmml">=</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19"><mo id="S3.E7.m1.8.8.8.8.2.2" xref="S3.E7.m1.8.8.8.8.2.2.cmml">∬</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1"><mi id="S3.E7.m1.9.9.9.9.3.3" xref="S3.E7.m1.9.9.9.9.3.3.cmml">p</mi><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.2" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1.1.1"><mo id="S3.E7.m1.10.10.10.10.4.4" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1.1.1.1"><mi id="S3.E7.m1.11.11.11.11.5.5" xref="S3.E7.m1.11.11.11.11.5.5.cmml">z</mi><mo fence="false" id="S3.E7.m1.12.12.12.12.6.6" xref="S3.E7.m1.12.12.12.12.6.6.cmml">|</mo><mi id="S3.E7.m1.13.13.13.13.7.7" xref="S3.E7.m1.13.13.13.13.7.7.cmml">x</mi></mrow><mo id="S3.E7.m1.14.14.14.14.8.8" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.2a" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mover accent="true" id="S3.E7.m1.15.15.15.15.9.9" xref="S3.E7.m1.15.15.15.15.9.9.cmml"><mi id="S3.E7.m1.15.15.15.15.9.9.2" xref="S3.E7.m1.15.15.15.15.9.9.2.cmml">p</mi><mo id="S3.E7.m1.15.15.15.15.9.9.1" xref="S3.E7.m1.15.15.15.15.9.9.1.cmml">~</mo></mover><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.2b" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1.3"><mo id="S3.E7.m1.16.16.16.16.10.10" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mi id="S3.E7.m1.17.17.17.17.11.11" xref="S3.E7.m1.17.17.17.17.11.11.cmml">x</mi><mo id="S3.E7.m1.18.18.18.18.12.12" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.2c" lspace="0.167em" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1.4"><mi id="S3.E7.m1.19.19.19.19.13.13" xref="S3.E7.m1.19.19.19.19.13.13.cmml">log</mi><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.4a" lspace="0.167em" xref="S3.E7.m1.50.50.1.1.1.cmml">⁡</mo><mrow id="S3.E7.m1.51.51.2.50.25.19.19.1.4.1"><mfrac id="S3.E7.m1.20.20.20.20.14.14" xref="S3.E7.m1.20.20.20.20.14.14.cmml"><mrow id="S3.E7.m1.20.20.20.20.14.14.2" xref="S3.E7.m1.20.20.20.20.14.14.2.cmml"><mi id="S3.E7.m1.20.20.20.20.14.14.2.4" xref="S3.E7.m1.20.20.20.20.14.14.2.4.cmml">p</mi><mo id="S3.E7.m1.20.20.20.20.14.14.2.3" xref="S3.E7.m1.20.20.20.20.14.14.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.20.20.20.20.14.14.2.2.1" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.cmml"><mo id="S3.E7.m1.20.20.20.20.14.14.2.2.1.2" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.cmml"><mi id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.2" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.2.cmml">z</mi><mo fence="false" id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.1" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.1.cmml">|</mo><mi id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.3" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.3.cmml">x</mi></mrow><mo id="S3.E7.m1.20.20.20.20.14.14.2.2.1.3" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.20.20.20.20.14.14.2.3a" xref="S3.E7.m1.20.20.20.20.14.14.2.3.cmml">⁢</mo><mover accent="true" id="S3.E7.m1.20.20.20.20.14.14.2.5" xref="S3.E7.m1.20.20.20.20.14.14.2.5.cmml"><mi id="S3.E7.m1.20.20.20.20.14.14.2.5.2" xref="S3.E7.m1.20.20.20.20.14.14.2.5.2.cmml">p</mi><mo id="S3.E7.m1.20.20.20.20.14.14.2.5.1" xref="S3.E7.m1.20.20.20.20.14.14.2.5.1.cmml">~</mo></mover><mo id="S3.E7.m1.20.20.20.20.14.14.2.3b" xref="S3.E7.m1.20.20.20.20.14.14.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.20.20.20.20.14.14.2.6.2" xref="S3.E7.m1.20.20.20.20.14.14.2.cmml"><mo id="S3.E7.m1.20.20.20.20.14.14.2.6.2.1" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.2.cmml">(</mo><mi id="S3.E7.m1.20.20.20.20.14.14.1.1" xref="S3.E7.m1.20.20.20.20.14.14.1.1.cmml">x</mi><mo id="S3.E7.m1.20.20.20.20.14.14.2.6.2.2" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.2.cmml">)</mo></mrow></mrow><mrow id="S3.E7.m1.20.20.20.20.14.14.4" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml"><mi id="S3.E7.m1.20.20.20.20.14.14.4.4" xref="S3.E7.m1.20.20.20.20.14.14.4.4.cmml">p</mi><mo id="S3.E7.m1.20.20.20.20.14.14.4.3" xref="S3.E7.m1.20.20.20.20.14.14.4.3.cmml">⁢</mo><mrow id="S3.E7.m1.20.20.20.20.14.14.4.5.2" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml"><mo id="S3.E7.m1.20.20.20.20.14.14.4.5.2.1" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml">(</mo><mi id="S3.E7.m1.20.20.20.20.14.14.3.1" xref="S3.E7.m1.20.20.20.20.14.14.3.1.cmml">z</mi><mo id="S3.E7.m1.20.20.20.20.14.14.4.5.2.2" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml">)</mo></mrow><mo id="S3.E7.m1.20.20.20.20.14.14.4.3a" xref="S3.E7.m1.20.20.20.20.14.14.4.3.cmml">⁢</mo><mover accent="true" id="S3.E7.m1.20.20.20.20.14.14.4.6" xref="S3.E7.m1.20.20.20.20.14.14.4.6.cmml"><mi id="S3.E7.m1.20.20.20.20.14.14.4.6.2" xref="S3.E7.m1.20.20.20.20.14.14.4.6.2.cmml">p</mi><mo id="S3.E7.m1.20.20.20.20.14.14.4.6.1" xref="S3.E7.m1.20.20.20.20.14.14.4.6.1.cmml">~</mo></mover><mo id="S3.E7.m1.20.20.20.20.14.14.4.3b" xref="S3.E7.m1.20.20.20.20.14.14.4.3.cmml">⁢</mo><mrow id="S3.E7.m1.20.20.20.20.14.14.4.7.2" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml"><mo id="S3.E7.m1.20.20.20.20.14.14.4.7.2.1" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml">(</mo><mi id="S3.E7.m1.20.20.20.20.14.14.4.2" xref="S3.E7.m1.20.20.20.20.14.14.4.2.cmml">x</mi><mo id="S3.E7.m1.20.20.20.20.14.14.4.7.2.2" stretchy="false" xref="S3.E7.m1.20.20.20.20.14.14.4.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.4.1.1" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.21.21.21.21.15.15" xref="S3.E7.m1.21.21.21.21.15.15.cmml">d</mi><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.4.1.1a" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.22.22.22.22.16.16" xref="S3.E7.m1.22.22.22.22.16.16.cmml">x</mi><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.4.1.1b" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.23.23.23.23.17.17" xref="S3.E7.m1.23.23.23.23.17.17.cmml">d</mi><mo id="S3.E7.m1.51.51.2.50.25.19.19.1.4.1.1c" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.24.24.24.24.18.18" xref="S3.E7.m1.24.24.24.24.18.18.cmml">z</mi></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.52.52.3d"><mtd id="S3.E7.m1.52.52.3e" xref="S3.E7.m1.50.50.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.52.52.3f"><mrow id="S3.E7.m1.52.52.3.51.26.26.26"><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1"><mi id="S3.E7.m1.52.52.3.51.26.26.26.1.2" xref="S3.E7.m1.50.50.1.1.1.cmml"></mi><mo id="S3.E7.m1.25.25.25.1.1.1" xref="S3.E7.m1.25.25.25.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1"><mi id="S3.E7.m1.26.26.26.2.2.2" xref="S3.E7.m1.26.26.26.2.2.2.cmml">K</mi><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.2" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mi id="S3.E7.m1.27.27.27.3.3.3" xref="S3.E7.m1.27.27.27.3.3.3.cmml">L</mi><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.2a" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1"><mo id="S3.E7.m1.28.28.28.4.4.4" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1"><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1"><mi id="S3.E7.m1.29.29.29.5.5.5" xref="S3.E7.m1.29.29.29.5.5.5.cmml">p</mi><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.2" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.1.1"><mo id="S3.E7.m1.30.30.30.6.6.6" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.1.1.1"><mi id="S3.E7.m1.31.31.31.7.7.7" xref="S3.E7.m1.31.31.31.7.7.7.cmml">z</mi><mo fence="false" id="S3.E7.m1.32.32.32.8.8.8" xref="S3.E7.m1.32.32.32.8.8.8.cmml">|</mo><mi id="S3.E7.m1.33.33.33.9.9.9" xref="S3.E7.m1.33.33.33.9.9.9.cmml">x</mi></mrow><mo id="S3.E7.m1.34.34.34.10.10.10" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.2a" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mover accent="true" id="S3.E7.m1.35.35.35.11.11.11" xref="S3.E7.m1.35.35.35.11.11.11.cmml"><mi id="S3.E7.m1.35.35.35.11.11.11.2" xref="S3.E7.m1.35.35.35.11.11.11.2.cmml">p</mi><mo id="S3.E7.m1.35.35.35.11.11.11.1" xref="S3.E7.m1.35.35.35.11.11.11.1.cmml">~</mo></mover><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.2b" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.1.3"><mo id="S3.E7.m1.36.36.36.12.12.12" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mi id="S3.E7.m1.37.37.37.13.13.13" xref="S3.E7.m1.37.37.37.13.13.13.cmml">x</mi><mo id="S3.E7.m1.38.38.38.14.14.14" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.39.39.39.15.15.15" xref="S3.E7.m1.39.39.39.15.15.15.cmml">∥</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2"><mi id="S3.E7.m1.40.40.40.16.16.16" xref="S3.E7.m1.40.40.40.16.16.16.cmml">p</mi><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2.1" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2.2"><mo id="S3.E7.m1.41.41.41.17.17.17" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mi id="S3.E7.m1.42.42.42.18.18.18" xref="S3.E7.m1.42.42.42.18.18.18.cmml">z</mi><mo id="S3.E7.m1.43.43.43.19.19.19" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2.1a" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mover accent="true" id="S3.E7.m1.44.44.44.20.20.20" xref="S3.E7.m1.44.44.44.20.20.20.cmml"><mi id="S3.E7.m1.44.44.44.20.20.20.2" xref="S3.E7.m1.44.44.44.20.20.20.2.cmml">p</mi><mo id="S3.E7.m1.44.44.44.20.20.20.1" xref="S3.E7.m1.44.44.44.20.20.20.1.cmml">~</mo></mover><mo id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2.1b" xref="S3.E7.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="S3.E7.m1.52.52.3.51.26.26.26.1.1.1.1.1.2.3"><mo id="S3.E7.m1.45.45.45.21.21.21" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">(</mo><mi id="S3.E7.m1.46.46.46.22.22.22" xref="S3.E7.m1.46.46.46.22.22.22.cmml">x</mi><mo id="S3.E7.m1.47.47.47.23.23.23" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.48.48.48.24.24.24" stretchy="false" xref="S3.E7.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.49.49.49.25.25.25" xref="S3.E7.m1.50.50.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.52b"><apply id="S3.E7.m1.50.50.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><and id="S3.E7.m1.50.50.1.1.1a.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></and><apply id="S3.E7.m1.50.50.1.1.1b.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><eq id="S3.E7.m1.7.7.7.7.1.1.cmml" xref="S3.E7.m1.7.7.7.7.1.1"></eq><apply id="S3.E7.m1.50.50.1.1.1.4.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.4.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">𝐼</ci><interval closure="open" id="S3.E7.m1.50.50.1.1.1.4.3.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><ci id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3">𝑋</ci><ci id="S3.E7.m1.5.5.5.5.5.5.cmml" xref="S3.E7.m1.5.5.5.5.5.5">𝑍</ci></interval></apply><apply id="S3.E7.m1.50.50.1.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><csymbol cd="latexml" id="S3.E7.m1.8.8.8.8.2.2.cmml" xref="S3.E7.m1.8.8.8.8.2.2">double-integral</csymbol><apply id="S3.E7.m1.50.50.1.1.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.1.1.2.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><ci id="S3.E7.m1.9.9.9.9.3.3.cmml" xref="S3.E7.m1.9.9.9.9.3.3">𝑝</ci><apply id="S3.E7.m1.50.50.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><csymbol cd="latexml" id="S3.E7.m1.12.12.12.12.6.6.cmml" xref="S3.E7.m1.12.12.12.12.6.6">conditional</csymbol><ci id="S3.E7.m1.11.11.11.11.5.5.cmml" xref="S3.E7.m1.11.11.11.11.5.5">𝑧</ci><ci id="S3.E7.m1.13.13.13.13.7.7.cmml" xref="S3.E7.m1.13.13.13.13.7.7">𝑥</ci></apply><apply id="S3.E7.m1.15.15.15.15.9.9.cmml" xref="S3.E7.m1.15.15.15.15.9.9"><ci id="S3.E7.m1.15.15.15.15.9.9.1.cmml" xref="S3.E7.m1.15.15.15.15.9.9.1">~</ci><ci id="S3.E7.m1.15.15.15.15.9.9.2.cmml" xref="S3.E7.m1.15.15.15.15.9.9.2">𝑝</ci></apply><ci id="S3.E7.m1.17.17.17.17.11.11.cmml" xref="S3.E7.m1.17.17.17.17.11.11">𝑥</ci><apply id="S3.E7.m1.50.50.1.1.1.1.1.6.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><log id="S3.E7.m1.19.19.19.19.13.13.cmml" xref="S3.E7.m1.19.19.19.19.13.13"></log><apply id="S3.E7.m1.50.50.1.1.1.1.1.6.2.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.1.1.6.2.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><apply id="S3.E7.m1.20.20.20.20.14.14.cmml" xref="S3.E7.m1.20.20.20.20.14.14"><divide id="S3.E7.m1.20.20.20.20.14.14.5.cmml" xref="S3.E7.m1.20.20.20.20.14.14"></divide><apply id="S3.E7.m1.20.20.20.20.14.14.2.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2"><times id="S3.E7.m1.20.20.20.20.14.14.2.3.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.3"></times><ci id="S3.E7.m1.20.20.20.20.14.14.2.4.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.4">𝑝</ci><apply id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1"><csymbol cd="latexml" id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.1">conditional</csymbol><ci id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.2.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.2">𝑧</ci><ci id="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.3.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.2.1.1.3">𝑥</ci></apply><apply id="S3.E7.m1.20.20.20.20.14.14.2.5.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.5"><ci id="S3.E7.m1.20.20.20.20.14.14.2.5.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.5.1">~</ci><ci id="S3.E7.m1.20.20.20.20.14.14.2.5.2.cmml" xref="S3.E7.m1.20.20.20.20.14.14.2.5.2">𝑝</ci></apply><ci id="S3.E7.m1.20.20.20.20.14.14.1.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.1.1">𝑥</ci></apply><apply id="S3.E7.m1.20.20.20.20.14.14.4.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4"><times id="S3.E7.m1.20.20.20.20.14.14.4.3.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.3"></times><ci id="S3.E7.m1.20.20.20.20.14.14.4.4.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.4">𝑝</ci><ci id="S3.E7.m1.20.20.20.20.14.14.3.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.3.1">𝑧</ci><apply id="S3.E7.m1.20.20.20.20.14.14.4.6.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.6"><ci id="S3.E7.m1.20.20.20.20.14.14.4.6.1.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.6.1">~</ci><ci id="S3.E7.m1.20.20.20.20.14.14.4.6.2.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.6.2">𝑝</ci></apply><ci id="S3.E7.m1.20.20.20.20.14.14.4.2.cmml" xref="S3.E7.m1.20.20.20.20.14.14.4.2">𝑥</ci></apply></apply><ci id="S3.E7.m1.21.21.21.21.15.15.cmml" xref="S3.E7.m1.21.21.21.21.15.15">𝑑</ci><ci id="S3.E7.m1.22.22.22.22.16.16.cmml" xref="S3.E7.m1.22.22.22.22.16.16">𝑥</ci><ci id="S3.E7.m1.23.23.23.23.17.17.cmml" xref="S3.E7.m1.23.23.23.23.17.17">𝑑</ci><ci id="S3.E7.m1.24.24.24.24.18.18.cmml" xref="S3.E7.m1.24.24.24.24.18.18">𝑧</ci></apply></apply></apply></apply></apply><apply id="S3.E7.m1.50.50.1.1.1c.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><eq id="S3.E7.m1.25.25.25.1.1.1.cmml" xref="S3.E7.m1.25.25.25.1.1.1"></eq><share href="https://arxiv.org/html/2404.18214v2#S3.E7.m1.50.50.1.1.1.1.cmml" id="S3.E7.m1.50.50.1.1.1d.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></share><apply id="S3.E7.m1.50.50.1.1.1.2.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.2.2.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><ci id="S3.E7.m1.26.26.26.2.2.2.cmml" xref="S3.E7.m1.26.26.26.2.2.2">𝐾</ci><ci id="S3.E7.m1.27.27.27.3.3.3.cmml" xref="S3.E7.m1.27.27.27.3.3.3">𝐿</ci><apply id="S3.E7.m1.50.50.1.1.1.2.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><csymbol cd="latexml" id="S3.E7.m1.39.39.39.15.15.15.cmml" xref="S3.E7.m1.39.39.39.15.15.15">conditional</csymbol><apply id="S3.E7.m1.50.50.1.1.1.2.1.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><ci id="S3.E7.m1.29.29.29.5.5.5.cmml" xref="S3.E7.m1.29.29.29.5.5.5">𝑝</ci><apply id="S3.E7.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><csymbol cd="latexml" id="S3.E7.m1.32.32.32.8.8.8.cmml" xref="S3.E7.m1.32.32.32.8.8.8">conditional</csymbol><ci id="S3.E7.m1.31.31.31.7.7.7.cmml" xref="S3.E7.m1.31.31.31.7.7.7">𝑧</ci><ci id="S3.E7.m1.33.33.33.9.9.9.cmml" xref="S3.E7.m1.33.33.33.9.9.9">𝑥</ci></apply><apply id="S3.E7.m1.35.35.35.11.11.11.cmml" xref="S3.E7.m1.35.35.35.11.11.11"><ci id="S3.E7.m1.35.35.35.11.11.11.1.cmml" xref="S3.E7.m1.35.35.35.11.11.11.1">~</ci><ci id="S3.E7.m1.35.35.35.11.11.11.2.cmml" xref="S3.E7.m1.35.35.35.11.11.11.2">𝑝</ci></apply><ci id="S3.E7.m1.37.37.37.13.13.13.cmml" xref="S3.E7.m1.37.37.37.13.13.13">𝑥</ci></apply><apply id="S3.E7.m1.50.50.1.1.1.2.1.1.1.3.cmml" xref="S3.E7.m1.6.6.6.6.6.7"><times id="S3.E7.m1.50.50.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E7.m1.6.6.6.6.6.7"></times><ci id="S3.E7.m1.40.40.40.16.16.16.cmml" xref="S3.E7.m1.40.40.40.16.16.16">𝑝</ci><ci id="S3.E7.m1.42.42.42.18.18.18.cmml" xref="S3.E7.m1.42.42.42.18.18.18">𝑧</ci><apply id="S3.E7.m1.44.44.44.20.20.20.cmml" xref="S3.E7.m1.44.44.44.20.20.20"><ci id="S3.E7.m1.44.44.44.20.20.20.1.cmml" xref="S3.E7.m1.44.44.44.20.20.20.1">~</ci><ci id="S3.E7.m1.44.44.44.20.20.20.2.cmml" xref="S3.E7.m1.44.44.44.20.20.20.2">𝑝</ci></apply><ci id="S3.E7.m1.46.46.46.22.22.22.cmml" xref="S3.E7.m1.46.46.46.22.22.22">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.52c">\begin{split}I(X,Z)&amp;=\iint{p(z|x)\tilde{p}(x)\log\frac{p(z|x)\tilde{p}(x)}{p(z%
)\tilde{p}(x)}}dxdz\\
&amp;=KL(p(z|x)\tilde{p}(x)\|p(z)\tilde{p}(x)),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.52d">start_ROW start_CELL italic_I ( italic_X , italic_Z ) end_CELL start_CELL = ∬ italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x ) roman_log divide start_ARG italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x ) end_ARG start_ARG italic_p ( italic_z ) over~ start_ARG italic_p end_ARG ( italic_x ) end_ARG italic_d italic_x italic_d italic_z end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = italic_K italic_L ( italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x ) ∥ italic_p ( italic_z ) over~ start_ARG italic_p end_ARG ( italic_x ) ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.7">where <math alttext="\tilde{p}(x)" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><mrow id="S3.SS3.p6.1.m1.1.2" xref="S3.SS3.p6.1.m1.1.2.cmml"><mover accent="true" id="S3.SS3.p6.1.m1.1.2.2" xref="S3.SS3.p6.1.m1.1.2.2.cmml"><mi id="S3.SS3.p6.1.m1.1.2.2.2" xref="S3.SS3.p6.1.m1.1.2.2.2.cmml">p</mi><mo id="S3.SS3.p6.1.m1.1.2.2.1" xref="S3.SS3.p6.1.m1.1.2.2.1.cmml">~</mo></mover><mo id="S3.SS3.p6.1.m1.1.2.1" xref="S3.SS3.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p6.1.m1.1.2.3.2" xref="S3.SS3.p6.1.m1.1.2.cmml"><mo id="S3.SS3.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p6.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">x</mi><mo id="S3.SS3.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.2"><times id="S3.SS3.p6.1.m1.1.2.1.cmml" xref="S3.SS3.p6.1.m1.1.2.1"></times><apply id="S3.SS3.p6.1.m1.1.2.2.cmml" xref="S3.SS3.p6.1.m1.1.2.2"><ci id="S3.SS3.p6.1.m1.1.2.2.1.cmml" xref="S3.SS3.p6.1.m1.1.2.2.1">~</ci><ci id="S3.SS3.p6.1.m1.1.2.2.2.cmml" xref="S3.SS3.p6.1.m1.1.2.2.2">𝑝</ci></apply><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\tilde{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">over~ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math> represents the distribution of the original data, <math alttext="p(z|x)\tilde{p}(x)" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m2.2"><semantics id="S3.SS3.p6.2.m2.2a"><mrow id="S3.SS3.p6.2.m2.2.2" xref="S3.SS3.p6.2.m2.2.2.cmml"><mi id="S3.SS3.p6.2.m2.2.2.3" xref="S3.SS3.p6.2.m2.2.2.3.cmml">p</mi><mo id="S3.SS3.p6.2.m2.2.2.2" xref="S3.SS3.p6.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p6.2.m2.2.2.1.1" xref="S3.SS3.p6.2.m2.2.2.1.1.1.cmml"><mo id="S3.SS3.p6.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p6.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p6.2.m2.2.2.1.1.1" xref="S3.SS3.p6.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p6.2.m2.2.2.1.1.1.2" xref="S3.SS3.p6.2.m2.2.2.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.SS3.p6.2.m2.2.2.1.1.1.1" xref="S3.SS3.p6.2.m2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p6.2.m2.2.2.1.1.1.3" xref="S3.SS3.p6.2.m2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS3.p6.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p6.2.m2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p6.2.m2.2.2.2a" xref="S3.SS3.p6.2.m2.2.2.2.cmml">⁢</mo><mover accent="true" id="S3.SS3.p6.2.m2.2.2.4" xref="S3.SS3.p6.2.m2.2.2.4.cmml"><mi id="S3.SS3.p6.2.m2.2.2.4.2" xref="S3.SS3.p6.2.m2.2.2.4.2.cmml">p</mi><mo id="S3.SS3.p6.2.m2.2.2.4.1" xref="S3.SS3.p6.2.m2.2.2.4.1.cmml">~</mo></mover><mo id="S3.SS3.p6.2.m2.2.2.2b" xref="S3.SS3.p6.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p6.2.m2.2.2.5.2" xref="S3.SS3.p6.2.m2.2.2.cmml"><mo id="S3.SS3.p6.2.m2.2.2.5.2.1" stretchy="false" xref="S3.SS3.p6.2.m2.2.2.cmml">(</mo><mi id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml">x</mi><mo id="S3.SS3.p6.2.m2.2.2.5.2.2" stretchy="false" xref="S3.SS3.p6.2.m2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.2b"><apply id="S3.SS3.p6.2.m2.2.2.cmml" xref="S3.SS3.p6.2.m2.2.2"><times id="S3.SS3.p6.2.m2.2.2.2.cmml" xref="S3.SS3.p6.2.m2.2.2.2"></times><ci id="S3.SS3.p6.2.m2.2.2.3.cmml" xref="S3.SS3.p6.2.m2.2.2.3">𝑝</ci><apply id="S3.SS3.p6.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p6.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p6.2.m2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p6.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p6.2.m2.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.p6.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p6.2.m2.2.2.1.1.1.3">𝑥</ci></apply><apply id="S3.SS3.p6.2.m2.2.2.4.cmml" xref="S3.SS3.p6.2.m2.2.2.4"><ci id="S3.SS3.p6.2.m2.2.2.4.1.cmml" xref="S3.SS3.p6.2.m2.2.2.4.1">~</ci><ci id="S3.SS3.p6.2.m2.2.2.4.2.cmml" xref="S3.SS3.p6.2.m2.2.2.4.2">𝑝</ci></apply><ci id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.2c">p(z|x)\tilde{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m2.2d">italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math> describes the joint distribution of <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p6.3.m3.1"><semantics id="S3.SS3.p6.3.m3.1a"><mi id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><ci id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.3.m3.1d">italic_x</annotation></semantics></math> and <math alttext="z" class="ltx_Math" display="inline" id="S3.SS3.p6.4.m4.1"><semantics id="S3.SS3.p6.4.m4.1a"><mi id="S3.SS3.p6.4.m4.1.1" xref="S3.SS3.p6.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m4.1b"><ci id="S3.SS3.p6.4.m4.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.4.m4.1d">italic_z</annotation></semantics></math>, and <math alttext="p(z)" class="ltx_Math" display="inline" id="S3.SS3.p6.5.m5.1"><semantics id="S3.SS3.p6.5.m5.1a"><mrow id="S3.SS3.p6.5.m5.1.2" xref="S3.SS3.p6.5.m5.1.2.cmml"><mi id="S3.SS3.p6.5.m5.1.2.2" xref="S3.SS3.p6.5.m5.1.2.2.cmml">p</mi><mo id="S3.SS3.p6.5.m5.1.2.1" xref="S3.SS3.p6.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p6.5.m5.1.2.3.2" xref="S3.SS3.p6.5.m5.1.2.cmml"><mo id="S3.SS3.p6.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS3.p6.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.p6.5.m5.1.1" xref="S3.SS3.p6.5.m5.1.1.cmml">z</mi><mo id="S3.SS3.p6.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS3.p6.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m5.1b"><apply id="S3.SS3.p6.5.m5.1.2.cmml" xref="S3.SS3.p6.5.m5.1.2"><times id="S3.SS3.p6.5.m5.1.2.1.cmml" xref="S3.SS3.p6.5.m5.1.2.1"></times><ci id="S3.SS3.p6.5.m5.1.2.2.cmml" xref="S3.SS3.p6.5.m5.1.2.2">𝑝</ci><ci id="S3.SS3.p6.5.m5.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m5.1c">p(z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.5.m5.1d">italic_p ( italic_z )</annotation></semantics></math> denotes the distribution of the entire <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS3.p6.6.m6.1"><semantics id="S3.SS3.p6.6.m6.1a"><mi id="S3.SS3.p6.6.m6.1.1" xref="S3.SS3.p6.6.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.6.m6.1b"><ci id="S3.SS3.p6.6.m6.1.1.cmml" xref="S3.SS3.p6.6.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.6.m6.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.6.m6.1d">italic_Z</annotation></semantics></math> after given <math alttext="p(z|x)" class="ltx_Math" display="inline" id="S3.SS3.p6.7.m7.1"><semantics id="S3.SS3.p6.7.m7.1a"><mrow id="S3.SS3.p6.7.m7.1.1" xref="S3.SS3.p6.7.m7.1.1.cmml"><mi id="S3.SS3.p6.7.m7.1.1.3" xref="S3.SS3.p6.7.m7.1.1.3.cmml">p</mi><mo id="S3.SS3.p6.7.m7.1.1.2" xref="S3.SS3.p6.7.m7.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p6.7.m7.1.1.1.1" xref="S3.SS3.p6.7.m7.1.1.1.1.1.cmml"><mo id="S3.SS3.p6.7.m7.1.1.1.1.2" stretchy="false" xref="S3.SS3.p6.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p6.7.m7.1.1.1.1.1" xref="S3.SS3.p6.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS3.p6.7.m7.1.1.1.1.1.2" xref="S3.SS3.p6.7.m7.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.SS3.p6.7.m7.1.1.1.1.1.1" xref="S3.SS3.p6.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p6.7.m7.1.1.1.1.1.3" xref="S3.SS3.p6.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS3.p6.7.m7.1.1.1.1.3" stretchy="false" xref="S3.SS3.p6.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.7.m7.1b"><apply id="S3.SS3.p6.7.m7.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1"><times id="S3.SS3.p6.7.m7.1.1.2.cmml" xref="S3.SS3.p6.7.m7.1.1.2"></times><ci id="S3.SS3.p6.7.m7.1.1.3.cmml" xref="S3.SS3.p6.7.m7.1.1.3">𝑝</ci><apply id="S3.SS3.p6.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p6.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p6.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS3.p6.7.m7.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p6.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS3.p6.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.7.m7.1c">p(z|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.7.m7.1d">italic_p ( italic_z | italic_x )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="p(z)=\int p(z|x)\tilde{p}(x)dx." class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.2" xref="S3.E8.m1.3.3.1.1.3.2.cmml">p</mi><mo id="S3.E8.m1.3.3.1.1.3.1" xref="S3.E8.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.3.3.2" xref="S3.E8.m1.3.3.1.1.3.cmml"><mo id="S3.E8.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E8.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">z</mi><mo id="S3.E8.m1.3.3.1.1.3.3.2.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.2" rspace="0.111em" xref="S3.E8.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.2.cmml">∫</mo><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.cmml">p</mi><mo id="S3.E8.m1.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.2a" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mover accent="true" id="S3.E8.m1.3.3.1.1.1.1.4" xref="S3.E8.m1.3.3.1.1.1.1.4.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.4.2" xref="S3.E8.m1.3.3.1.1.1.1.4.2.cmml">p</mi><mo id="S3.E8.m1.3.3.1.1.1.1.4.1" xref="S3.E8.m1.3.3.1.1.1.1.4.1.cmml">~</mo></mover><mo id="S3.E8.m1.3.3.1.1.1.1.2b" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.5.2" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.5.2.1" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">x</mi><mo id="S3.E8.m1.3.3.1.1.1.1.5.2.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.2c" lspace="0em" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.6" xref="S3.E8.m1.3.3.1.1.1.1.6.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.6.1" rspace="0em" xref="S3.E8.m1.3.3.1.1.1.1.6.1.cmml">𝑑</mo><mi id="S3.E8.m1.3.3.1.1.1.1.6.2" xref="S3.E8.m1.3.3.1.1.1.1.6.2.cmml">x</mi></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" lspace="0em" xref="S3.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><eq id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></eq><apply id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3"><times id="S3.E8.m1.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.1"></times><ci id="S3.E8.m1.3.3.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2">𝑝</ci><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑧</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><int id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"></int><apply id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2"></times><ci id="S3.E8.m1.3.3.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3">𝑝</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.4.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4"><ci id="S3.E8.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.1">~</ci><ci id="S3.E8.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2">𝑝</ci></apply><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝑥</ci><apply id="S3.E8.m1.3.3.1.1.1.1.6.cmml" xref="S3.E8.m1.3.3.1.1.1.1.6"><csymbol cd="latexml" id="S3.E8.m1.3.3.1.1.1.1.6.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.6.1">differential-d</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.6.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.6.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">p(z)=\int p(z|x)\tilde{p}(x)dx.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">italic_p ( italic_z ) = ∫ italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x ) italic_d italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.3">VAE wants to maximize the mutual information <math alttext="I(X,Z)" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.2"><semantics id="S3.SS3.p7.1.m1.2a"><mrow id="S3.SS3.p7.1.m1.2.3" xref="S3.SS3.p7.1.m1.2.3.cmml"><mi id="S3.SS3.p7.1.m1.2.3.2" xref="S3.SS3.p7.1.m1.2.3.2.cmml">I</mi><mo id="S3.SS3.p7.1.m1.2.3.1" xref="S3.SS3.p7.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.1.m1.2.3.3.2" xref="S3.SS3.p7.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.p7.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p7.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml">X</mi><mo id="S3.SS3.p7.1.m1.2.3.3.2.2" xref="S3.SS3.p7.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p7.1.m1.2.2" xref="S3.SS3.p7.1.m1.2.2.cmml">Z</mi><mo id="S3.SS3.p7.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p7.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.2b"><apply id="S3.SS3.p7.1.m1.2.3.cmml" xref="S3.SS3.p7.1.m1.2.3"><times id="S3.SS3.p7.1.m1.2.3.1.cmml" xref="S3.SS3.p7.1.m1.2.3.1"></times><ci id="S3.SS3.p7.1.m1.2.3.2.cmml" xref="S3.SS3.p7.1.m1.2.3.2">𝐼</ci><interval closure="open" id="S3.SS3.p7.1.m1.2.3.3.1.cmml" xref="S3.SS3.p7.1.m1.2.3.3.2"><ci id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">𝑋</ci><ci id="S3.SS3.p7.1.m1.2.2.cmml" xref="S3.SS3.p7.1.m1.2.2">𝑍</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.2c">I(X,Z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.2d">italic_I ( italic_X , italic_Z )</annotation></semantics></math>, i.e., to widen the distance between <math alttext="p(z|x)\tilde{p}(x)" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.2"><semantics id="S3.SS3.p7.2.m2.2a"><mrow id="S3.SS3.p7.2.m2.2.2" xref="S3.SS3.p7.2.m2.2.2.cmml"><mi id="S3.SS3.p7.2.m2.2.2.3" xref="S3.SS3.p7.2.m2.2.2.3.cmml">p</mi><mo id="S3.SS3.p7.2.m2.2.2.2" xref="S3.SS3.p7.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p7.2.m2.2.2.1.1" xref="S3.SS3.p7.2.m2.2.2.1.1.1.cmml"><mo id="S3.SS3.p7.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p7.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p7.2.m2.2.2.1.1.1" xref="S3.SS3.p7.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p7.2.m2.2.2.1.1.1.2" xref="S3.SS3.p7.2.m2.2.2.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.SS3.p7.2.m2.2.2.1.1.1.1" xref="S3.SS3.p7.2.m2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p7.2.m2.2.2.1.1.1.3" xref="S3.SS3.p7.2.m2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS3.p7.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p7.2.m2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p7.2.m2.2.2.2a" xref="S3.SS3.p7.2.m2.2.2.2.cmml">⁢</mo><mover accent="true" id="S3.SS3.p7.2.m2.2.2.4" xref="S3.SS3.p7.2.m2.2.2.4.cmml"><mi id="S3.SS3.p7.2.m2.2.2.4.2" xref="S3.SS3.p7.2.m2.2.2.4.2.cmml">p</mi><mo id="S3.SS3.p7.2.m2.2.2.4.1" xref="S3.SS3.p7.2.m2.2.2.4.1.cmml">~</mo></mover><mo id="S3.SS3.p7.2.m2.2.2.2b" xref="S3.SS3.p7.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p7.2.m2.2.2.5.2" xref="S3.SS3.p7.2.m2.2.2.cmml"><mo id="S3.SS3.p7.2.m2.2.2.5.2.1" stretchy="false" xref="S3.SS3.p7.2.m2.2.2.cmml">(</mo><mi id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml">x</mi><mo id="S3.SS3.p7.2.m2.2.2.5.2.2" stretchy="false" xref="S3.SS3.p7.2.m2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.2b"><apply id="S3.SS3.p7.2.m2.2.2.cmml" xref="S3.SS3.p7.2.m2.2.2"><times id="S3.SS3.p7.2.m2.2.2.2.cmml" xref="S3.SS3.p7.2.m2.2.2.2"></times><ci id="S3.SS3.p7.2.m2.2.2.3.cmml" xref="S3.SS3.p7.2.m2.2.2.3">𝑝</ci><apply id="S3.SS3.p7.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p7.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p7.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p7.2.m2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p7.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p7.2.m2.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.p7.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p7.2.m2.2.2.1.1.1.3">𝑥</ci></apply><apply id="S3.SS3.p7.2.m2.2.2.4.cmml" xref="S3.SS3.p7.2.m2.2.2.4"><ci id="S3.SS3.p7.2.m2.2.2.4.1.cmml" xref="S3.SS3.p7.2.m2.2.2.4.1">~</ci><ci id="S3.SS3.p7.2.m2.2.2.4.2.cmml" xref="S3.SS3.p7.2.m2.2.2.4.2">𝑝</ci></apply><ci id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.2c">p(z|x)\tilde{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.2d">italic_p ( italic_z | italic_x ) over~ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math> and <math alttext="p(z)\tilde{p}(x)" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.2"><semantics id="S3.SS3.p7.3.m3.2a"><mrow id="S3.SS3.p7.3.m3.2.3" xref="S3.SS3.p7.3.m3.2.3.cmml"><mi id="S3.SS3.p7.3.m3.2.3.2" xref="S3.SS3.p7.3.m3.2.3.2.cmml">p</mi><mo id="S3.SS3.p7.3.m3.2.3.1" xref="S3.SS3.p7.3.m3.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.3.m3.2.3.3.2" xref="S3.SS3.p7.3.m3.2.3.cmml"><mo id="S3.SS3.p7.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS3.p7.3.m3.2.3.cmml">(</mo><mi id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml">z</mi><mo id="S3.SS3.p7.3.m3.2.3.3.2.2" stretchy="false" xref="S3.SS3.p7.3.m3.2.3.cmml">)</mo></mrow><mo id="S3.SS3.p7.3.m3.2.3.1a" xref="S3.SS3.p7.3.m3.2.3.1.cmml">⁢</mo><mover accent="true" id="S3.SS3.p7.3.m3.2.3.4" xref="S3.SS3.p7.3.m3.2.3.4.cmml"><mi id="S3.SS3.p7.3.m3.2.3.4.2" xref="S3.SS3.p7.3.m3.2.3.4.2.cmml">p</mi><mo id="S3.SS3.p7.3.m3.2.3.4.1" xref="S3.SS3.p7.3.m3.2.3.4.1.cmml">~</mo></mover><mo id="S3.SS3.p7.3.m3.2.3.1b" xref="S3.SS3.p7.3.m3.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p7.3.m3.2.3.5.2" xref="S3.SS3.p7.3.m3.2.3.cmml"><mo id="S3.SS3.p7.3.m3.2.3.5.2.1" stretchy="false" xref="S3.SS3.p7.3.m3.2.3.cmml">(</mo><mi id="S3.SS3.p7.3.m3.2.2" xref="S3.SS3.p7.3.m3.2.2.cmml">x</mi><mo id="S3.SS3.p7.3.m3.2.3.5.2.2" stretchy="false" xref="S3.SS3.p7.3.m3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.2b"><apply id="S3.SS3.p7.3.m3.2.3.cmml" xref="S3.SS3.p7.3.m3.2.3"><times id="S3.SS3.p7.3.m3.2.3.1.cmml" xref="S3.SS3.p7.3.m3.2.3.1"></times><ci id="S3.SS3.p7.3.m3.2.3.2.cmml" xref="S3.SS3.p7.3.m3.2.3.2">𝑝</ci><ci id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">𝑧</ci><apply id="S3.SS3.p7.3.m3.2.3.4.cmml" xref="S3.SS3.p7.3.m3.2.3.4"><ci id="S3.SS3.p7.3.m3.2.3.4.1.cmml" xref="S3.SS3.p7.3.m3.2.3.4.1">~</ci><ci id="S3.SS3.p7.3.m3.2.3.4.2.cmml" xref="S3.SS3.p7.3.m3.2.3.4.2">𝑝</ci></apply><ci id="S3.SS3.p7.3.m3.2.2.cmml" xref="S3.SS3.p7.3.m3.2.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.2c">p(z)\tilde{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.2d">italic_p ( italic_z ) over~ start_ARG italic_p end_ARG ( italic_x )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="p(z|x)=\underset{p(z|x)}{\mathrm{arg\,max}}I(X,Z)." class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.3.cmml">p</mi><mo id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E9.m1.4.4.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E9.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2" xref="S3.E9.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.4.4.1.1.3" xref="S3.E9.m1.4.4.1.1.3.cmml"><munder accentunder="true" id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mrow id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">arg</mi><mo id="S3.E9.m1.1.1.2.1" lspace="0.170em" xref="S3.E9.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml">p</mi><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E9.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></munder><mo id="S3.E9.m1.4.4.1.1.3.1" xref="S3.E9.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="S3.E9.m1.4.4.1.1.3.2" xref="S3.E9.m1.4.4.1.1.3.2.cmml">I</mi><mo id="S3.E9.m1.4.4.1.1.3.1a" xref="S3.E9.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.3.3.2" xref="S3.E9.m1.4.4.1.1.3.3.1.cmml"><mo id="S3.E9.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S3.E9.m1.4.4.1.1.3.3.1.cmml">(</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">X</mi><mo id="S3.E9.m1.4.4.1.1.3.3.2.2" xref="S3.E9.m1.4.4.1.1.3.3.1.cmml">,</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">Z</mi><mo id="S3.E9.m1.4.4.1.1.3.3.2.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.2" lspace="0em" xref="S3.E9.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.1.1.cmml" xref="S3.E9.m1.4.4.1"><eq id="S3.E9.m1.4.4.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2"></eq><apply id="S3.E9.m1.4.4.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1"><times id="S3.E9.m1.4.4.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.2"></times><ci id="S3.E9.m1.4.4.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.3">𝑝</ci><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E9.m1.4.4.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.3"><times id="S3.E9.m1.4.4.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.3.1"></times><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><times id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3">𝑝</ci><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"><times id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.2.1"></times><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">arg</ci><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">max</ci></apply></apply><ci id="S3.E9.m1.4.4.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.3.2">𝐼</ci><interval closure="open" id="S3.E9.m1.4.4.1.1.3.3.1.cmml" xref="S3.E9.m1.4.4.1.1.3.3.2"><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑋</ci><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">𝑍</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">p(z|x)=\underset{p(z|x)}{\mathrm{arg\,max}}I(X,Z).</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">italic_p ( italic_z | italic_x ) = start_UNDERACCENT italic_p ( italic_z | italic_x ) end_UNDERACCENT start_ARG roman_arg roman_max end_ARG italic_I ( italic_X , italic_Z ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">Let <math alttext="q(z)" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><mrow id="S3.SS3.p8.1.m1.1.2" xref="S3.SS3.p8.1.m1.1.2.cmml"><mi id="S3.SS3.p8.1.m1.1.2.2" xref="S3.SS3.p8.1.m1.1.2.2.cmml">q</mi><mo id="S3.SS3.p8.1.m1.1.2.1" xref="S3.SS3.p8.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p8.1.m1.1.2.3.2" xref="S3.SS3.p8.1.m1.1.2.cmml"><mo id="S3.SS3.p8.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p8.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml">z</mi><mo id="S3.SS3.p8.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p8.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.2"><times id="S3.SS3.p8.1.m1.1.2.1.cmml" xref="S3.SS3.p8.1.m1.1.2.1"></times><ci id="S3.SS3.p8.1.m1.1.2.2.cmml" xref="S3.SS3.p8.1.m1.1.2.2">𝑞</ci><ci id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">q(z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_q ( italic_z )</annotation></semantics></math> be the prior distribution of the standard normal distribution, and write the loss of KLD in Eq.(3) as the sum of two components:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;KL\bigl{(}{p(z)\|q(z)}\bigr{)}=KL\bigl{(}{\tilde{p}(x)p(z|x)\|q(%
z)q(x|z)}\bigr{)}\\
&amp;=\iint{\tilde{p}(x)p(z|x)\log{\frac{\tilde{p}(x)p(z|x)}{q(x|z)q(z)}}}dzdx\\
&amp;=\iint{\tilde{p}(x)p(z|x)\log{\frac{p(z|x)}{q(z)}}}dzdx\\
&amp;-\iint{\tilde{p}(x)p(z|x)\log{\frac{q(x|z)}{\tilde{p}(x)}}}dzdx,\end{split}" class="ltx_math_unparsed" display="block" id="S3.E10.m1.97"><semantics id="S3.E10.m1.97a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E10.m1.97.97.3" rowspacing="0pt"><mtr id="S3.E10.m1.97.97.3a"><mtd id="S3.E10.m1.97.97.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.97.97.3c"><mrow id="S3.E10.m1.39.39.39.39.39"><mi id="S3.E10.m1.1.1.1.1.1.1">K</mi><mi id="S3.E10.m1.2.2.2.2.2.2">L</mi><mrow id="S3.E10.m1.39.39.39.39.39.40"><mo id="S3.E10.m1.3.3.3.3.3.3" maxsize="120%" minsize="120%">(</mo><mi id="S3.E10.m1.4.4.4.4.4.4">p</mi><mrow id="S3.E10.m1.39.39.39.39.39.40.1"><mo id="S3.E10.m1.5.5.5.5.5.5" stretchy="false">(</mo><mi id="S3.E10.m1.6.6.6.6.6.6">z</mi><mo id="S3.E10.m1.7.7.7.7.7.7" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.8.8.8.8.8.8" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E10.m1.9.9.9.9.9.9">q</mi><mrow id="S3.E10.m1.39.39.39.39.39.40.2"><mo id="S3.E10.m1.10.10.10.10.10.10" stretchy="false">(</mo><mi id="S3.E10.m1.11.11.11.11.11.11">z</mi><mo id="S3.E10.m1.12.12.12.12.12.12" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.13.13.13.13.13.13" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S3.E10.m1.14.14.14.14.14.14">=</mo><mi id="S3.E10.m1.15.15.15.15.15.15">K</mi><mi id="S3.E10.m1.16.16.16.16.16.16">L</mi><mrow id="S3.E10.m1.39.39.39.39.39.41"><mo id="S3.E10.m1.17.17.17.17.17.17" maxsize="120%" minsize="120%">(</mo><mover accent="true" id="S3.E10.m1.18.18.18.18.18.18"><mi id="S3.E10.m1.18.18.18.18.18.18.2">p</mi><mo id="S3.E10.m1.18.18.18.18.18.18.1">~</mo></mover><mrow id="S3.E10.m1.39.39.39.39.39.41.1"><mo id="S3.E10.m1.19.19.19.19.19.19" stretchy="false">(</mo><mi id="S3.E10.m1.20.20.20.20.20.20">x</mi><mo id="S3.E10.m1.21.21.21.21.21.21" stretchy="false">)</mo></mrow><mi id="S3.E10.m1.22.22.22.22.22.22">p</mi><mrow id="S3.E10.m1.39.39.39.39.39.41.2"><mo id="S3.E10.m1.23.23.23.23.23.23" stretchy="false">(</mo><mi id="S3.E10.m1.24.24.24.24.24.24">z</mi><mo fence="false" id="S3.E10.m1.25.25.25.25.25.25" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E10.m1.26.26.26.26.26.26">x</mi><mo id="S3.E10.m1.27.27.27.27.27.27" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.28.28.28.28.28.28" lspace="0em" rspace="0.167em">∥</mo><mi id="S3.E10.m1.29.29.29.29.29.29">q</mi><mrow id="S3.E10.m1.39.39.39.39.39.41.3"><mo id="S3.E10.m1.30.30.30.30.30.30" stretchy="false">(</mo><mi id="S3.E10.m1.31.31.31.31.31.31">z</mi><mo id="S3.E10.m1.32.32.32.32.32.32" stretchy="false">)</mo></mrow><mi id="S3.E10.m1.33.33.33.33.33.33">q</mi><mrow id="S3.E10.m1.39.39.39.39.39.41.4"><mo id="S3.E10.m1.34.34.34.34.34.34" stretchy="false">(</mo><mi id="S3.E10.m1.35.35.35.35.35.35">x</mi><mo fence="false" id="S3.E10.m1.36.36.36.36.36.36" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E10.m1.37.37.37.37.37.37">z</mi><mo id="S3.E10.m1.38.38.38.38.38.38" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.39.39.39.39.39.39" maxsize="120%" minsize="120%">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.97.97.3d"><mtd id="S3.E10.m1.97.97.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.97.97.3f"><mrow id="S3.E10.m1.95.95.1.95.19.19"><mi id="S3.E10.m1.95.95.1.95.19.19.20"></mi><mo id="S3.E10.m1.40.40.40.1.1.1" rspace="0.111em">=</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19"><mo id="S3.E10.m1.41.41.41.2.2.2">∬</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1"><mover accent="true" id="S3.E10.m1.42.42.42.3.3.3"><mi id="S3.E10.m1.42.42.42.3.3.3.2">p</mi><mo id="S3.E10.m1.42.42.42.3.3.3.1">~</mo></mover><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.2">⁢</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1.3"><mo id="S3.E10.m1.43.43.43.4.4.4" stretchy="false">(</mo><mi id="S3.E10.m1.44.44.44.5.5.5">x</mi><mo id="S3.E10.m1.45.45.45.6.6.6" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.2a">⁢</mo><mi id="S3.E10.m1.46.46.46.7.7.7">p</mi><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.2b">⁢</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1.1.1"><mo id="S3.E10.m1.47.47.47.8.8.8" stretchy="false">(</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1.1.1.1"><mi id="S3.E10.m1.48.48.48.9.9.9">z</mi><mo fence="false" id="S3.E10.m1.49.49.49.10.10.10">|</mo><mi id="S3.E10.m1.50.50.50.11.11.11">x</mi></mrow><mo id="S3.E10.m1.51.51.51.12.12.12" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.2c" lspace="0.167em">⁢</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1.4"><mi id="S3.E10.m1.52.52.52.13.13.13">log</mi><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.4a" lspace="0.167em">⁡</mo><mrow id="S3.E10.m1.95.95.1.95.19.19.19.1.4.1"><mfrac id="S3.E10.m1.53.53.53.14.14.14"><mrow id="S3.E10.m1.53.53.53.14.14.14.2"><mover accent="true" id="S3.E10.m1.53.53.53.14.14.14.2.4"><mi id="S3.E10.m1.53.53.53.14.14.14.2.4.2">p</mi><mo id="S3.E10.m1.53.53.53.14.14.14.2.4.1">~</mo></mover><mo id="S3.E10.m1.53.53.53.14.14.14.2.3">⁢</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.2.5.2"><mo id="S3.E10.m1.53.53.53.14.14.14.2.5.2.1" stretchy="false">(</mo><mi id="S3.E10.m1.53.53.53.14.14.14.1.1">x</mi><mo id="S3.E10.m1.53.53.53.14.14.14.2.5.2.2" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.53.53.53.14.14.14.2.3a">⁢</mo><mi id="S3.E10.m1.53.53.53.14.14.14.2.6">p</mi><mo id="S3.E10.m1.53.53.53.14.14.14.2.3b">⁢</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.2.2.1"><mo id="S3.E10.m1.53.53.53.14.14.14.2.2.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.2.2.1.1"><mi id="S3.E10.m1.53.53.53.14.14.14.2.2.1.1.2">z</mi><mo fence="false" id="S3.E10.m1.53.53.53.14.14.14.2.2.1.1.1">|</mo><mi id="S3.E10.m1.53.53.53.14.14.14.2.2.1.1.3">x</mi></mrow><mo id="S3.E10.m1.53.53.53.14.14.14.2.2.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E10.m1.53.53.53.14.14.14.4"><mi id="S3.E10.m1.53.53.53.14.14.14.4.4">q</mi><mo id="S3.E10.m1.53.53.53.14.14.14.4.3">⁢</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.4.2.1"><mo id="S3.E10.m1.53.53.53.14.14.14.4.2.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.4.2.1.1"><mi id="S3.E10.m1.53.53.53.14.14.14.4.2.1.1.2">x</mi><mo fence="false" id="S3.E10.m1.53.53.53.14.14.14.4.2.1.1.1">|</mo><mi id="S3.E10.m1.53.53.53.14.14.14.4.2.1.1.3">z</mi></mrow><mo id="S3.E10.m1.53.53.53.14.14.14.4.2.1.3" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.53.53.53.14.14.14.4.3a">⁢</mo><mi id="S3.E10.m1.53.53.53.14.14.14.4.5">q</mi><mo id="S3.E10.m1.53.53.53.14.14.14.4.3b">⁢</mo><mrow id="S3.E10.m1.53.53.53.14.14.14.4.6.2"><mo id="S3.E10.m1.53.53.53.14.14.14.4.6.2.1" stretchy="false">(</mo><mi id="S3.E10.m1.53.53.53.14.14.14.3.1">z</mi><mo id="S3.E10.m1.53.53.53.14.14.14.4.6.2.2" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.4.1.1">⁢</mo><mi id="S3.E10.m1.54.54.54.15.15.15">d</mi><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.4.1.1a">⁢</mo><mi id="S3.E10.m1.55.55.55.16.16.16">z</mi><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.4.1.1b">⁢</mo><mi id="S3.E10.m1.56.56.56.17.17.17">d</mi><mo id="S3.E10.m1.95.95.1.95.19.19.19.1.4.1.1c">⁢</mo><mi id="S3.E10.m1.57.57.57.18.18.18">x</mi></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.97.97.3g"><mtd id="S3.E10.m1.97.97.3h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.97.97.3i"><mrow id="S3.E10.m1.96.96.2.96.19.19"><mi id="S3.E10.m1.96.96.2.96.19.19.20"></mi><mo id="S3.E10.m1.58.58.58.1.1.1" rspace="0.111em">=</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19"><mo id="S3.E10.m1.59.59.59.2.2.2">∬</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1"><mover accent="true" id="S3.E10.m1.60.60.60.3.3.3"><mi id="S3.E10.m1.60.60.60.3.3.3.2">p</mi><mo id="S3.E10.m1.60.60.60.3.3.3.1">~</mo></mover><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.2">⁢</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1.3"><mo id="S3.E10.m1.61.61.61.4.4.4" stretchy="false">(</mo><mi id="S3.E10.m1.62.62.62.5.5.5">x</mi><mo id="S3.E10.m1.63.63.63.6.6.6" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.2a">⁢</mo><mi id="S3.E10.m1.64.64.64.7.7.7">p</mi><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.2b">⁢</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1.1.1"><mo id="S3.E10.m1.65.65.65.8.8.8" stretchy="false">(</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1.1.1.1"><mi id="S3.E10.m1.66.66.66.9.9.9">z</mi><mo fence="false" id="S3.E10.m1.67.67.67.10.10.10">|</mo><mi id="S3.E10.m1.68.68.68.11.11.11">x</mi></mrow><mo id="S3.E10.m1.69.69.69.12.12.12" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.2c" lspace="0.167em">⁢</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1.4"><mi id="S3.E10.m1.70.70.70.13.13.13">log</mi><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.4a" lspace="0.167em">⁡</mo><mrow id="S3.E10.m1.96.96.2.96.19.19.19.1.4.1"><mfrac id="S3.E10.m1.71.71.71.14.14.14"><mrow id="S3.E10.m1.71.71.71.14.14.14.1"><mi id="S3.E10.m1.71.71.71.14.14.14.1.3">p</mi><mo id="S3.E10.m1.71.71.71.14.14.14.1.2">⁢</mo><mrow id="S3.E10.m1.71.71.71.14.14.14.1.1.1"><mo id="S3.E10.m1.71.71.71.14.14.14.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.71.71.71.14.14.14.1.1.1.1"><mi id="S3.E10.m1.71.71.71.14.14.14.1.1.1.1.2">z</mi><mo fence="false" id="S3.E10.m1.71.71.71.14.14.14.1.1.1.1.1">|</mo><mi id="S3.E10.m1.71.71.71.14.14.14.1.1.1.1.3">x</mi></mrow><mo id="S3.E10.m1.71.71.71.14.14.14.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E10.m1.71.71.71.14.14.14.2"><mi id="S3.E10.m1.71.71.71.14.14.14.2.3">q</mi><mo id="S3.E10.m1.71.71.71.14.14.14.2.2">⁢</mo><mrow id="S3.E10.m1.71.71.71.14.14.14.2.4.2"><mo id="S3.E10.m1.71.71.71.14.14.14.2.4.2.1" stretchy="false">(</mo><mi id="S3.E10.m1.71.71.71.14.14.14.2.1">z</mi><mo id="S3.E10.m1.71.71.71.14.14.14.2.4.2.2" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.4.1.1">⁢</mo><mi id="S3.E10.m1.72.72.72.15.15.15">d</mi><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.4.1.1a">⁢</mo><mi id="S3.E10.m1.73.73.73.16.16.16">z</mi><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.4.1.1b">⁢</mo><mi id="S3.E10.m1.74.74.74.17.17.17">d</mi><mo id="S3.E10.m1.96.96.2.96.19.19.19.1.4.1.1c">⁢</mo><mi id="S3.E10.m1.75.75.75.18.18.18">x</mi></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.97.97.3j"><mtd id="S3.E10.m1.97.97.3k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.97.97.3l"><mrow id="S3.E10.m1.97.97.3.97.20.20.20"><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1"><mo id="S3.E10.m1.97.97.3.97.20.20.20.1a">−</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1"><mo id="S3.E10.m1.77.77.77.2.2.2">∬</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1"><mover accent="true" id="S3.E10.m1.78.78.78.3.3.3"><mi id="S3.E10.m1.78.78.78.3.3.3.2">p</mi><mo id="S3.E10.m1.78.78.78.3.3.3.1">~</mo></mover><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.2">⁢</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.3"><mo id="S3.E10.m1.79.79.79.4.4.4" stretchy="false">(</mo><mi id="S3.E10.m1.80.80.80.5.5.5">x</mi><mo id="S3.E10.m1.81.81.81.6.6.6" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.2a">⁢</mo><mi id="S3.E10.m1.82.82.82.7.7.7">p</mi><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.2b">⁢</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.1.1"><mo id="S3.E10.m1.83.83.83.8.8.8" stretchy="false">(</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.1.1.1"><mi id="S3.E10.m1.84.84.84.9.9.9">z</mi><mo fence="false" id="S3.E10.m1.85.85.85.10.10.10">|</mo><mi id="S3.E10.m1.86.86.86.11.11.11">x</mi></mrow><mo id="S3.E10.m1.87.87.87.12.12.12" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.2c" lspace="0.167em">⁢</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4"><mi id="S3.E10.m1.88.88.88.13.13.13">log</mi><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4a" lspace="0.167em">⁡</mo><mrow id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4.1"><mfrac id="S3.E10.m1.89.89.89.14.14.14"><mrow id="S3.E10.m1.89.89.89.14.14.14.1"><mi id="S3.E10.m1.89.89.89.14.14.14.1.3">q</mi><mo id="S3.E10.m1.89.89.89.14.14.14.1.2">⁢</mo><mrow id="S3.E10.m1.89.89.89.14.14.14.1.1.1"><mo id="S3.E10.m1.89.89.89.14.14.14.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.89.89.89.14.14.14.1.1.1.1"><mi id="S3.E10.m1.89.89.89.14.14.14.1.1.1.1.2">x</mi><mo fence="false" id="S3.E10.m1.89.89.89.14.14.14.1.1.1.1.1">|</mo><mi id="S3.E10.m1.89.89.89.14.14.14.1.1.1.1.3">z</mi></mrow><mo id="S3.E10.m1.89.89.89.14.14.14.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E10.m1.89.89.89.14.14.14.2"><mover accent="true" id="S3.E10.m1.89.89.89.14.14.14.2.3"><mi id="S3.E10.m1.89.89.89.14.14.14.2.3.2">p</mi><mo id="S3.E10.m1.89.89.89.14.14.14.2.3.1">~</mo></mover><mo id="S3.E10.m1.89.89.89.14.14.14.2.2">⁢</mo><mrow id="S3.E10.m1.89.89.89.14.14.14.2.4.2"><mo id="S3.E10.m1.89.89.89.14.14.14.2.4.2.1" stretchy="false">(</mo><mi id="S3.E10.m1.89.89.89.14.14.14.2.1">x</mi><mo id="S3.E10.m1.89.89.89.14.14.14.2.4.2.2" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4.1.1">⁢</mo><mi id="S3.E10.m1.90.90.90.15.15.15">d</mi><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4.1.1a">⁢</mo><mi id="S3.E10.m1.91.91.91.16.16.16">z</mi><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4.1.1b">⁢</mo><mi id="S3.E10.m1.92.92.92.17.17.17">d</mi><mo id="S3.E10.m1.97.97.3.97.20.20.20.1.1.1.4.1.1c">⁢</mo><mi id="S3.E10.m1.93.93.93.18.18.18">x</mi></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.94.94.94.19.19.19">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E10.m1.97b">\begin{split}&amp;KL\bigl{(}{p(z)\|q(z)}\bigr{)}=KL\bigl{(}{\tilde{p}(x)p(z|x)\|q(%
z)q(x|z)}\bigr{)}\\
&amp;=\iint{\tilde{p}(x)p(z|x)\log{\frac{\tilde{p}(x)p(z|x)}{q(x|z)q(z)}}}dzdx\\
&amp;=\iint{\tilde{p}(x)p(z|x)\log{\frac{p(z|x)}{q(z)}}}dzdx\\
&amp;-\iint{\tilde{p}(x)p(z|x)\log{\frac{q(x|z)}{\tilde{p}(x)}}}dzdx,\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.97c">start_ROW start_CELL end_CELL start_CELL italic_K italic_L ( italic_p ( italic_z ) ∥ italic_q ( italic_z ) ) = italic_K italic_L ( over~ start_ARG italic_p end_ARG ( italic_x ) italic_p ( italic_z | italic_x ) ∥ italic_q ( italic_z ) italic_q ( italic_x | italic_z ) ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = ∬ over~ start_ARG italic_p end_ARG ( italic_x ) italic_p ( italic_z | italic_x ) roman_log divide start_ARG over~ start_ARG italic_p end_ARG ( italic_x ) italic_p ( italic_z | italic_x ) end_ARG start_ARG italic_q ( italic_x | italic_z ) italic_q ( italic_z ) end_ARG italic_d italic_z italic_d italic_x end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = ∬ over~ start_ARG italic_p end_ARG ( italic_x ) italic_p ( italic_z | italic_x ) roman_log divide start_ARG italic_p ( italic_z | italic_x ) end_ARG start_ARG italic_q ( italic_z ) end_ARG italic_d italic_z italic_d italic_x end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL - ∬ over~ start_ARG italic_p end_ARG ( italic_x ) italic_p ( italic_z | italic_x ) roman_log divide start_ARG italic_q ( italic_x | italic_z ) end_ARG start_ARG over~ start_ARG italic_p end_ARG ( italic_x ) end_ARG italic_d italic_z italic_d italic_x , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p9">
<p class="ltx_p" id="S3.SS3.p9.2">where the first term is the KLD of the prior distribution and the second term is the mutual information of <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p9.1.m1.1"><semantics id="S3.SS3.p9.1.m1.1a"><mi id="S3.SS3.p9.1.m1.1.1" xref="S3.SS3.p9.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p9.1.m1.1b"><ci id="S3.SS3.p9.1.m1.1.1.cmml" xref="S3.SS3.p9.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p9.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p9.1.m1.1d">italic_x</annotation></semantics></math> and <math alttext="z" class="ltx_Math" display="inline" id="S3.SS3.p9.2.m2.1"><semantics id="S3.SS3.p9.2.m2.1a"><mi id="S3.SS3.p9.2.m2.1.1" xref="S3.SS3.p9.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p9.2.m2.1b"><ci id="S3.SS3.p9.2.m2.1.1.cmml" xref="S3.SS3.p9.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p9.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p9.2.m2.1d">italic_z</annotation></semantics></math>. The purpose of VAE is to maximize the mutual information while minimizing the prior distribution.</p>
</div>
<div class="ltx_para" id="S3.SS3.p10">
<p class="ltx_p" id="S3.SS3.p10.1">The idea of contrastive learning was first applied in the field of CV <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib39" title="">39</a>]</cite>. Let the global features of an image be the anchor point, positive samples are local features from the same image, and negative samples are local features from different images. With the research in recent years, contrastive learning and VAE have also been introduced into the domain of sequential recommendation. In our work, the method will be proposed to disentangle the potential user’s intention distribution based on VAE, and we also propose two new paradigms combined with contrastive learning, aiming to help the model to get a more accurate user sequence and intention representation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Model Architecture</h3>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F2.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Overview of MDICL. (a) shows the basic structure of Transformer encoder. (b) describes the framework and process of MIDCL, which includes the intention disentanglement by VAE and contrastive learning. The detailed illustration of VAE is in Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS3" title="4.3 Intention Disentanglement Layer ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">4.3</span></a>, and five kinds of augmentation operators is recorded in Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS4" title="4.4 Contrastive Learning Layer ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">4.4</span></a>. Multi-task training integrates adaptive results from three types of loss functions for the final prediction.</span></figcaption>
</figure>
<div class="ltx_para ltx_indent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The model architecture of MIDCL is shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.F2" title="Figure 2 ‣ 4.1 Model Architecture ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">2</span></a>. Where (a) is the encoder part of the Transformer, the position encoding is changed from the original sine-cosine encoding to the learnable position encoding.
(b) is the structure of intention disentanglement and the construction process of the loss function, the input is the user’s historical interaction sequence, and then two Transformers with shared parameters encode the user’s intention vectors and sequence vectors, respectively. The distribution of the intention is learnt by the VAE, and the user’s sequence encoding is is optimized using the attention mechanism.
In the part of contrastive learning, we propose two kinds of paradigms, one of them is intention contrastive learning, the anchor point is the user’s optimized sequence encoding, the positive samples are the most similar intentions, the negative samples are the least similar intentions, and the loss function is the Triplet loss, which brings the most similar intentions closer to the most similar intentions and as far as possible away from the least similar intentions by minimizing the loss of the triplet.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">The second one is sequence contrastive learning, the anchor point is the interaction sequence of one of the <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_N</annotation></semantics></math> users, after the random operator augmentation, the positive samples are the 2 augmented sequences of the current user, and the negative samples are the <math alttext="2(N-1)" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">2</mn><mo id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p2.2.m2.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.2.m2.1.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.1.1.1.2" xref="S4.SS1.p2.2.m2.1.1.1.1.1.2.cmml">N</mi><mo id="S4.SS1.p2.2.m2.1.1.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p2.2.m2.1.1.1.1.1.3" xref="S4.SS1.p2.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><times id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2"></times><cn id="S4.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3">2</cn><apply id="S4.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1"><minus id="S4.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.1.1"></minus><ci id="S4.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.1.2">𝑁</ci><cn id="S4.SS1.p2.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">2(N-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">2 ( italic_N - 1 )</annotation></semantics></math> augmented sequences of the rest of users, the positive and negative samples go through the same encoder to generate vectors, and then optimize the features according to the InfoNCE loss function, which is designed to maximize the mutual information of the positive samples from the same sequence, and minimize the mutual information of the negative samples from different sequences.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Embedded Layer</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">In our work, we uniformly use Transformer as encoder, compared to CNN, Transformer’s sensory field is more suitable for sequence data, and compared to RNN, Transformer is more adept at learning the item impact of each item in the sequence, and does not suffer from the problem of disappearing or exploding gradient in the training process. For the interaction sequence <math alttext="[H_{1}^{u},H_{2}^{u},\dots,H_{T}^{u}]" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.4"><semantics id="S4.SS2.p1.1.m1.4a"><mrow id="S4.SS2.p1.1.m1.4.4.3" xref="S4.SS2.p1.1.m1.4.4.4.cmml"><mo id="S4.SS2.p1.1.m1.4.4.3.4" stretchy="false" xref="S4.SS2.p1.1.m1.4.4.4.cmml">[</mo><msubsup id="S4.SS2.p1.1.m1.2.2.1.1" xref="S4.SS2.p1.1.m1.2.2.1.1.cmml"><mi id="S4.SS2.p1.1.m1.2.2.1.1.2.2" xref="S4.SS2.p1.1.m1.2.2.1.1.2.2.cmml">H</mi><mn id="S4.SS2.p1.1.m1.2.2.1.1.2.3" xref="S4.SS2.p1.1.m1.2.2.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p1.1.m1.2.2.1.1.3" xref="S4.SS2.p1.1.m1.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS2.p1.1.m1.4.4.3.5" xref="S4.SS2.p1.1.m1.4.4.4.cmml">,</mo><msubsup id="S4.SS2.p1.1.m1.3.3.2.2" xref="S4.SS2.p1.1.m1.3.3.2.2.cmml"><mi id="S4.SS2.p1.1.m1.3.3.2.2.2.2" xref="S4.SS2.p1.1.m1.3.3.2.2.2.2.cmml">H</mi><mn id="S4.SS2.p1.1.m1.3.3.2.2.2.3" xref="S4.SS2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S4.SS2.p1.1.m1.3.3.2.2.3" xref="S4.SS2.p1.1.m1.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS2.p1.1.m1.4.4.3.6" xref="S4.SS2.p1.1.m1.4.4.4.cmml">,</mo><mi id="S4.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S4.SS2.p1.1.m1.4.4.3.7" xref="S4.SS2.p1.1.m1.4.4.4.cmml">,</mo><msubsup id="S4.SS2.p1.1.m1.4.4.3.3" xref="S4.SS2.p1.1.m1.4.4.3.3.cmml"><mi id="S4.SS2.p1.1.m1.4.4.3.3.2.2" xref="S4.SS2.p1.1.m1.4.4.3.3.2.2.cmml">H</mi><mi id="S4.SS2.p1.1.m1.4.4.3.3.2.3" xref="S4.SS2.p1.1.m1.4.4.3.3.2.3.cmml">T</mi><mi id="S4.SS2.p1.1.m1.4.4.3.3.3" xref="S4.SS2.p1.1.m1.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S4.SS2.p1.1.m1.4.4.3.8" stretchy="false" xref="S4.SS2.p1.1.m1.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.4b"><list id="S4.SS2.p1.1.m1.4.4.4.cmml" xref="S4.SS2.p1.1.m1.4.4.3"><apply id="S4.SS2.p1.1.m1.2.2.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.2.2.1.1.2.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.2.2">𝐻</ci><cn id="S4.SS2.p1.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.2.2.1.1.2.3">1</cn></apply><ci id="S4.SS2.p1.1.m1.2.2.1.1.3.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.3">𝑢</ci></apply><apply id="S4.SS2.p1.1.m1.3.3.2.2.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.3.3.2.2.1.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2">superscript</csymbol><apply id="S4.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2.2.2">𝐻</ci><cn id="S4.SS2.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS2.p1.1.m1.3.3.2.2.3.cmml" xref="S4.SS2.p1.1.m1.3.3.2.2.3">𝑢</ci></apply><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">…</ci><apply id="S4.SS2.p1.1.m1.4.4.3.3.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.4.4.3.3.1.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3">superscript</csymbol><apply id="S4.SS2.p1.1.m1.4.4.3.3.2.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.4.4.3.3.2.1.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.4.4.3.3.2.2.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3.2.2">𝐻</ci><ci id="S4.SS2.p1.1.m1.4.4.3.3.2.3.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3.2.3">𝑇</ci></apply><ci id="S4.SS2.p1.1.m1.4.4.3.3.3.cmml" xref="S4.SS2.p1.1.m1.4.4.3.3.3">𝑢</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.4c">[H_{1}^{u},H_{2}^{u},\dots,H_{T}^{u}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.4d">[ italic_H start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_H start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ]</annotation></semantics></math> of user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_u</annotation></semantics></math>, generate an embedding representation for the items at each position:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="e_{i}^{u}=\mathrm{Trm}(H_{T}^{u}+p_{T})," class="ltx_Math" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><msubsup id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.3.2.2" xref="S4.E11.m1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S4.E11.m1.1.1.1.1.3.2.3" xref="S4.E11.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E11.m1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.3.3.cmml">u</mi></msubsup><mo id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml">Trm</mi><mo id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E11.m1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">H</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E11.m1.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.E11.m1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></msub></mrow><mo id="S4.E11.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><eq id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2"></eq><apply id="S4.E11.m1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.3.2.1.cmml" xref="S4.E11.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.3.2.2.cmml" xref="S4.E11.m1.1.1.1.1.3.2.2">𝑒</ci><ci id="S4.E11.m1.1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E11.m1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2"></times><ci id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3">Trm</ci><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"><plus id="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.2">𝐻</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">e_{i}^{u}=\mathrm{Trm}(H_{T}^{u}+p_{T}),</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Trm ( italic_H start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + italic_p start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4">where <math alttext="\mathrm{Trm}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mi id="S4.SS2.p2.1.m1.1.2.2" xref="S4.SS2.p2.1.m1.1.2.2.cmml">Trm</mi><mo id="S4.SS2.p2.1.m1.1.2.1" xref="S4.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.1.2.3.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mo id="S4.SS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p2.1.m1.1.2.cmml">(</mo><mo id="S4.SS2.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.2"><times id="S4.SS2.p2.1.m1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.2.1"></times><ci id="S4.SS2.p2.1.m1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.2.2">Trm</ci><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathrm{Trm}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">roman_Trm ( ⋅ )</annotation></semantics></math> is the Transformer encoder and <math alttext="p_{T}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">p</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑝</ci><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">p_{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> is the learnable positional encoding of <math alttext="H_{T}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msubsup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">H</mi><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">T</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝐻</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑇</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">H_{T}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_H start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> at moment <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_T</annotation></semantics></math>. Transformer’s parallel computation of each item in the sequence leaves it with no way to obtain the absolute position of the item in the sequence, which is a fatal problem in the field of NLP because the position of a single word may change the meaning of the whole sentence, so the introduction of positional encoding with sine-cosine computation enables the position of each word or item in the sequence, that is, the effect on the whole sequence, to be represented.
Compared to the sine-cosine function coding in paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib7" title="">7</a>]</cite>, many studies have suggested that learnable absolute positional coding can bring better performance, and that positional coding learned through neural networks has stronger expressive power, which can be more adaptive to varying sequence lengths, possesses higher scalability, and is better suited for end-to-end training tasks because learnable positional coding is learned together as an overall parameter of the model, rather than as a stand-alone process.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Doing so, however, ignores the relative position of each item in the sequence. Since for the task of sequential recommendation, the user’s interactive intention changes over time, and the last item in the sequence, i.e., the intention of the last interaction behavior, has the greatest impact on predicting the interaction behavior at the next moment, the model needs to take into account the weighting factor of each item for the last interaction. Although the models in paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib42" title="">42</a>]</cite> take the relative position or rotational position coding of each item (relative position coding implemented by the absolute position coding approach), it is also necessary to consider the effect of the item itself on the overall sequence with the final intention. Therefore, in the study in this paper, the user’s sequence characteristics are optimized by adopting an attention mechanism for the first <math alttext="T-1" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">T</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">−</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><minus id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></minus><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑇</ci><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">T-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_T - 1</annotation></semantics></math> items versus the last interacted item.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3">The user’s historical sequence <math alttext="H^{u}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msup id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">H</mi><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝐻</ci><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">H^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, sorted by interaction timestamp, is used as input to the Transformer encoder, which encodes an embedded representation <math alttext="[e_{1}^{u},\dots,e_{T-1}^{u},e_{T}^{u}]" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.4"><semantics id="S4.SS2.p4.2.m2.4a"><mrow id="S4.SS2.p4.2.m2.4.4.3" xref="S4.SS2.p4.2.m2.4.4.4.cmml"><mo id="S4.SS2.p4.2.m2.4.4.3.4" stretchy="false" xref="S4.SS2.p4.2.m2.4.4.4.cmml">[</mo><msubsup id="S4.SS2.p4.2.m2.2.2.1.1" xref="S4.SS2.p4.2.m2.2.2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.2.2.1.1.2.2" xref="S4.SS2.p4.2.m2.2.2.1.1.2.2.cmml">e</mi><mn id="S4.SS2.p4.2.m2.2.2.1.1.2.3" xref="S4.SS2.p4.2.m2.2.2.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p4.2.m2.2.2.1.1.3" xref="S4.SS2.p4.2.m2.2.2.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS2.p4.2.m2.4.4.3.5" xref="S4.SS2.p4.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS2.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS2.p4.2.m2.1.1.cmml">…</mi><mo id="S4.SS2.p4.2.m2.4.4.3.6" xref="S4.SS2.p4.2.m2.4.4.4.cmml">,</mo><msubsup id="S4.SS2.p4.2.m2.3.3.2.2" xref="S4.SS2.p4.2.m2.3.3.2.2.cmml"><mi id="S4.SS2.p4.2.m2.3.3.2.2.2.2" xref="S4.SS2.p4.2.m2.3.3.2.2.2.2.cmml">e</mi><mrow id="S4.SS2.p4.2.m2.3.3.2.2.2.3" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.cmml"><mi id="S4.SS2.p4.2.m2.3.3.2.2.2.3.2" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.2.cmml">T</mi><mo id="S4.SS2.p4.2.m2.3.3.2.2.2.3.1" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p4.2.m2.3.3.2.2.2.3.3" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p4.2.m2.3.3.2.2.3" xref="S4.SS2.p4.2.m2.3.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS2.p4.2.m2.4.4.3.7" xref="S4.SS2.p4.2.m2.4.4.4.cmml">,</mo><msubsup id="S4.SS2.p4.2.m2.4.4.3.3" xref="S4.SS2.p4.2.m2.4.4.3.3.cmml"><mi id="S4.SS2.p4.2.m2.4.4.3.3.2.2" xref="S4.SS2.p4.2.m2.4.4.3.3.2.2.cmml">e</mi><mi id="S4.SS2.p4.2.m2.4.4.3.3.2.3" xref="S4.SS2.p4.2.m2.4.4.3.3.2.3.cmml">T</mi><mi id="S4.SS2.p4.2.m2.4.4.3.3.3" xref="S4.SS2.p4.2.m2.4.4.3.3.3.cmml">u</mi></msubsup><mo id="S4.SS2.p4.2.m2.4.4.3.8" stretchy="false" xref="S4.SS2.p4.2.m2.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.4b"><list id="S4.SS2.p4.2.m2.4.4.4.cmml" xref="S4.SS2.p4.2.m2.4.4.3"><apply id="S4.SS2.p4.2.m2.2.2.1.1.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1">superscript</csymbol><apply id="S4.SS2.p4.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.2.2.1.1.2.1.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.2.2.1.1.2.2.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1.2.2">𝑒</ci><cn id="S4.SS2.p4.2.m2.2.2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p4.2.m2.2.2.1.1.2.3">1</cn></apply><ci id="S4.SS2.p4.2.m2.2.2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.2.2.1.1.3">𝑢</ci></apply><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">…</ci><apply id="S4.SS2.p4.2.m2.3.3.2.2.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.3.3.2.2.1.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2">superscript</csymbol><apply id="S4.SS2.p4.2.m2.3.3.2.2.2.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS2.p4.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2.2.2">𝑒</ci><apply id="S4.SS2.p4.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3"><minus id="S4.SS2.p4.2.m2.3.3.2.2.2.3.1.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.1"></minus><ci id="S4.SS2.p4.2.m2.3.3.2.2.2.3.2.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.2">𝑇</ci><cn id="S4.SS2.p4.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.p4.2.m2.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p4.2.m2.3.3.2.2.3.cmml" xref="S4.SS2.p4.2.m2.3.3.2.2.3">𝑢</ci></apply><apply id="S4.SS2.p4.2.m2.4.4.3.3.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.4.4.3.3.1.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3">superscript</csymbol><apply id="S4.SS2.p4.2.m2.4.4.3.3.2.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.4.4.3.3.2.1.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS2.p4.2.m2.4.4.3.3.2.2.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3.2.2">𝑒</ci><ci id="S4.SS2.p4.2.m2.4.4.3.3.2.3.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3.2.3">𝑇</ci></apply><ci id="S4.SS2.p4.2.m2.4.4.3.3.3.cmml" xref="S4.SS2.p4.2.m2.4.4.3.3.3">𝑢</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.4c">[e_{1}^{u},\dots,e_{T-1}^{u},e_{T}^{u}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.4d">[ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_T - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ]</annotation></semantics></math> for each position. This result incorporates the multi-head self-attention mechanism of the <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_h</annotation></semantics></math>-heads, set to be encoded by each head:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="Head_{i\in h}=\mathrm{SelfAtt}(Q_{H^{u}},K_{H^{u}},V_{H^{u}})," class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.5" xref="S4.E12.m1.1.1.1.1.5.cmml"><mi id="S4.E12.m1.1.1.1.1.5.2" xref="S4.E12.m1.1.1.1.1.5.2.cmml">H</mi><mo id="S4.E12.m1.1.1.1.1.5.1" xref="S4.E12.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.5.3" xref="S4.E12.m1.1.1.1.1.5.3.cmml">e</mi><mo id="S4.E12.m1.1.1.1.1.5.1a" xref="S4.E12.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.5.4" xref="S4.E12.m1.1.1.1.1.5.4.cmml">a</mi><mo id="S4.E12.m1.1.1.1.1.5.1b" xref="S4.E12.m1.1.1.1.1.5.1.cmml">⁢</mo><msub id="S4.E12.m1.1.1.1.1.5.5" xref="S4.E12.m1.1.1.1.1.5.5.cmml"><mi id="S4.E12.m1.1.1.1.1.5.5.2" xref="S4.E12.m1.1.1.1.1.5.5.2.cmml">d</mi><mrow id="S4.E12.m1.1.1.1.1.5.5.3" xref="S4.E12.m1.1.1.1.1.5.5.3.cmml"><mi id="S4.E12.m1.1.1.1.1.5.5.3.2" xref="S4.E12.m1.1.1.1.1.5.5.3.2.cmml">i</mi><mo id="S4.E12.m1.1.1.1.1.5.5.3.1" xref="S4.E12.m1.1.1.1.1.5.5.3.1.cmml">∈</mo><mi id="S4.E12.m1.1.1.1.1.5.5.3.3" xref="S4.E12.m1.1.1.1.1.5.5.3.3.cmml">h</mi></mrow></msub></mrow><mo id="S4.E12.m1.1.1.1.1.4" xref="S4.E12.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.5" xref="S4.E12.m1.1.1.1.1.3.5.cmml">SelfAtt</mi><mo id="S4.E12.m1.1.1.1.1.3.4" xref="S4.E12.m1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml"><mo id="S4.E12.m1.1.1.1.1.3.3.3.4" stretchy="false" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><msup id="S4.E12.m1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.2.cmml">H</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msup></msub><mo id="S4.E12.m1.1.1.1.1.3.3.3.5" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E12.m1.1.1.1.1.2.2.2.2" xref="S4.E12.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E12.m1.1.1.1.1.2.2.2.2.2" xref="S4.E12.m1.1.1.1.1.2.2.2.2.2.cmml">K</mi><msup id="S4.E12.m1.1.1.1.1.2.2.2.2.3" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E12.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3.2.cmml">H</mi><mi id="S4.E12.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3.3.cmml">u</mi></msup></msub><mo id="S4.E12.m1.1.1.1.1.3.3.3.6" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E12.m1.1.1.1.1.3.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.3.3.2" xref="S4.E12.m1.1.1.1.1.3.3.3.3.2.cmml">V</mi><msup id="S4.E12.m1.1.1.1.1.3.3.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.3.3.3.2" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3.2.cmml">H</mi><mi id="S4.E12.m1.1.1.1.1.3.3.3.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3.3.cmml">u</mi></msup></msub><mo id="S4.E12.m1.1.1.1.1.3.3.3.7" stretchy="false" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.4.cmml" xref="S4.E12.m1.1.1.1.1.4"></eq><apply id="S4.E12.m1.1.1.1.1.5.cmml" xref="S4.E12.m1.1.1.1.1.5"><times id="S4.E12.m1.1.1.1.1.5.1.cmml" xref="S4.E12.m1.1.1.1.1.5.1"></times><ci id="S4.E12.m1.1.1.1.1.5.2.cmml" xref="S4.E12.m1.1.1.1.1.5.2">𝐻</ci><ci id="S4.E12.m1.1.1.1.1.5.3.cmml" xref="S4.E12.m1.1.1.1.1.5.3">𝑒</ci><ci id="S4.E12.m1.1.1.1.1.5.4.cmml" xref="S4.E12.m1.1.1.1.1.5.4">𝑎</ci><apply id="S4.E12.m1.1.1.1.1.5.5.cmml" xref="S4.E12.m1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.5.5.1.cmml" xref="S4.E12.m1.1.1.1.1.5.5">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.5.5.2.cmml" xref="S4.E12.m1.1.1.1.1.5.5.2">𝑑</ci><apply id="S4.E12.m1.1.1.1.1.5.5.3.cmml" xref="S4.E12.m1.1.1.1.1.5.5.3"><in id="S4.E12.m1.1.1.1.1.5.5.3.1.cmml" xref="S4.E12.m1.1.1.1.1.5.5.3.1"></in><ci id="S4.E12.m1.1.1.1.1.5.5.3.2.cmml" xref="S4.E12.m1.1.1.1.1.5.5.3.2">𝑖</ci><ci id="S4.E12.m1.1.1.1.1.5.5.3.3.cmml" xref="S4.E12.m1.1.1.1.1.5.5.3.3">ℎ</ci></apply></apply></apply><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><times id="S4.E12.m1.1.1.1.1.3.4.cmml" xref="S4.E12.m1.1.1.1.1.3.4"></times><ci id="S4.E12.m1.1.1.1.1.3.5.cmml" xref="S4.E12.m1.1.1.1.1.3.5">SelfAtt</ci><vector id="S4.E12.m1.1.1.1.1.3.3.4.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3"><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2">𝑄</ci><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.2">𝐻</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2.2">𝐾</ci><apply id="S4.E12.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3.2">𝐻</ci><ci id="S4.E12.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E12.m1.1.1.1.1.2.2.2.2.3.3">𝑢</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3.2">𝑉</ci><apply id="S4.E12.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3.2">𝐻</ci><ci id="S4.E12.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3.3.3.3">𝑢</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">Head_{i\in h}=\mathrm{SelfAtt}(Q_{H^{u}},K_{H^{u}},V_{H^{u}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">italic_H italic_e italic_a italic_d start_POSTSUBSCRIPT italic_i ∈ italic_h end_POSTSUBSCRIPT = roman_SelfAtt ( italic_Q start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.10">where <math alttext="\mathrm{SelfAtt}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mrow id="S4.SS2.p5.1.m1.1.2" xref="S4.SS2.p5.1.m1.1.2.cmml"><mi id="S4.SS2.p5.1.m1.1.2.2" xref="S4.SS2.p5.1.m1.1.2.2.cmml">SelfAtt</mi><mo id="S4.SS2.p5.1.m1.1.2.1" xref="S4.SS2.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p5.1.m1.1.2.3.2" xref="S4.SS2.p5.1.m1.1.2.cmml"><mo id="S4.SS2.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p5.1.m1.1.2.cmml">(</mo><mo id="S4.SS2.p5.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p5.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS2.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.2"><times id="S4.SS2.p5.1.m1.1.2.1.cmml" xref="S4.SS2.p5.1.m1.1.2.1"></times><ci id="S4.SS2.p5.1.m1.1.2.2.cmml" xref="S4.SS2.p5.1.m1.1.2.2">SelfAtt</ci><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">\mathrm{SelfAtt}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">roman_SelfAtt ( ⋅ )</annotation></semantics></math> is the self-attention mechanism, and <math alttext="Q_{H^{u}}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">Q</mi><msup id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml"><mi id="S4.SS2.p5.2.m2.1.1.3.2" xref="S4.SS2.p5.2.m2.1.1.3.2.cmml">H</mi><mi id="S4.SS2.p5.2.m2.1.1.3.3" xref="S4.SS2.p5.2.m2.1.1.3.3.cmml">u</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝑄</ci><apply id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.3.1.cmml" xref="S4.SS2.p5.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.3.2.cmml" xref="S4.SS2.p5.2.m2.1.1.3.2">𝐻</ci><ci id="S4.SS2.p5.2.m2.1.1.3.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">Q_{H^{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="K_{H^{u}}" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><msub id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">K</mi><msup id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml"><mi id="S4.SS2.p5.3.m3.1.1.3.2" xref="S4.SS2.p5.3.m3.1.1.3.2.cmml">H</mi><mi id="S4.SS2.p5.3.m3.1.1.3.3" xref="S4.SS2.p5.3.m3.1.1.3.3.cmml">u</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2">𝐾</ci><apply id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.3.1.cmml" xref="S4.SS2.p5.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.3.2.cmml" xref="S4.SS2.p5.3.m3.1.1.3.2">𝐻</ci><ci id="S4.SS2.p5.3.m3.1.1.3.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">K_{H^{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_K start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="V_{H^{u}}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><msub id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">V</mi><msup id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml"><mi id="S4.SS2.p5.4.m4.1.1.3.2" xref="S4.SS2.p5.4.m4.1.1.3.2.cmml">H</mi><mi id="S4.SS2.p5.4.m4.1.1.3.3" xref="S4.SS2.p5.4.m4.1.1.3.3.cmml">u</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">𝑉</ci><apply id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.3.1.cmml" xref="S4.SS2.p5.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.3.2.cmml" xref="S4.SS2.p5.4.m4.1.1.3.2">𝐻</ci><ci id="S4.SS2.p5.4.m4.1.1.3.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">V_{H^{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">italic_V start_POSTSUBSCRIPT italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are the query, key, and value derived from <math alttext="H^{u}" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m5.1"><semantics id="S4.SS2.p5.5.m5.1a"><msup id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml"><mi id="S4.SS2.p5.5.m5.1.1.2" xref="S4.SS2.p5.5.m5.1.1.2.cmml">H</mi><mi id="S4.SS2.p5.5.m5.1.1.3" xref="S4.SS2.p5.5.m5.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><apply id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.5.m5.1.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">superscript</csymbol><ci id="S4.SS2.p5.5.m5.1.1.2.cmml" xref="S4.SS2.p5.5.m5.1.1.2">𝐻</ci><ci id="S4.SS2.p5.5.m5.1.1.3.cmml" xref="S4.SS2.p5.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">H^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m5.1d">italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> through the three parameter matrices <math alttext="W_{i}^{q}" class="ltx_Math" display="inline" id="S4.SS2.p5.6.m6.1"><semantics id="S4.SS2.p5.6.m6.1a"><msubsup id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml"><mi id="S4.SS2.p5.6.m6.1.1.2.2" xref="S4.SS2.p5.6.m6.1.1.2.2.cmml">W</mi><mi id="S4.SS2.p5.6.m6.1.1.2.3" xref="S4.SS2.p5.6.m6.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p5.6.m6.1.1.3" xref="S4.SS2.p5.6.m6.1.1.3.cmml">q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.p5.6.m6.1.1.2.cmml" xref="S4.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.6.m6.1.1.2.1.cmml" xref="S4.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p5.6.m6.1.1.2.2.cmml" xref="S4.SS2.p5.6.m6.1.1.2.2">𝑊</ci><ci id="S4.SS2.p5.6.m6.1.1.2.3.cmml" xref="S4.SS2.p5.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p5.6.m6.1.1.3.cmml" xref="S4.SS2.p5.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">W_{i}^{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{i}^{k}" class="ltx_Math" display="inline" id="S4.SS2.p5.7.m7.1"><semantics id="S4.SS2.p5.7.m7.1a"><msubsup id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml"><mi id="S4.SS2.p5.7.m7.1.1.2.2" xref="S4.SS2.p5.7.m7.1.1.2.2.cmml">W</mi><mi id="S4.SS2.p5.7.m7.1.1.2.3" xref="S4.SS2.p5.7.m7.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p5.7.m7.1.1.3" xref="S4.SS2.p5.7.m7.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><apply id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m7.1.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">superscript</csymbol><apply id="S4.SS2.p5.7.m7.1.1.2.cmml" xref="S4.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m7.1.1.2.1.cmml" xref="S4.SS2.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p5.7.m7.1.1.2.2.cmml" xref="S4.SS2.p5.7.m7.1.1.2.2">𝑊</ci><ci id="S4.SS2.p5.7.m7.1.1.2.3.cmml" xref="S4.SS2.p5.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p5.7.m7.1.1.3.cmml" xref="S4.SS2.p5.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">W_{i}^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.7.m7.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="W_{i}^{v}" class="ltx_Math" display="inline" id="S4.SS2.p5.8.m8.1"><semantics id="S4.SS2.p5.8.m8.1a"><msubsup id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml"><mi id="S4.SS2.p5.8.m8.1.1.2.2" xref="S4.SS2.p5.8.m8.1.1.2.2.cmml">W</mi><mi id="S4.SS2.p5.8.m8.1.1.2.3" xref="S4.SS2.p5.8.m8.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p5.8.m8.1.1.3" xref="S4.SS2.p5.8.m8.1.1.3.cmml">v</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><apply id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1">superscript</csymbol><apply id="S4.SS2.p5.8.m8.1.1.2.cmml" xref="S4.SS2.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.8.m8.1.1.2.1.cmml" xref="S4.SS2.p5.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p5.8.m8.1.1.2.2.cmml" xref="S4.SS2.p5.8.m8.1.1.2.2">𝑊</ci><ci id="S4.SS2.p5.8.m8.1.1.2.3.cmml" xref="S4.SS2.p5.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p5.8.m8.1.1.3.cmml" xref="S4.SS2.p5.8.m8.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">W_{i}^{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.8.m8.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively. Each head focuses on a different level of behavioral information, and concatenates the results of <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p5.9.m9.1"><semantics id="S4.SS2.p5.9.m9.1a"><mi id="S4.SS2.p5.9.m9.1.1" xref="S4.SS2.p5.9.m9.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><ci id="S4.SS2.p5.9.m9.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.9.m9.1d">italic_h</annotation></semantics></math> heads to get the multi-head representation
<math alttext="[e_{mh_{1}}^{u},\dots,e_{mh_{(T-1})}^{u},e_{mh_{T}}^{u}]" class="ltx_math_unparsed" display="inline" id="S4.SS2.p5.10.m10.4"><semantics id="S4.SS2.p5.10.m10.4a"><mrow id="S4.SS2.p5.10.m10.4.4.3"><mo id="S4.SS2.p5.10.m10.4.4.3.4" stretchy="false">[</mo><msubsup id="S4.SS2.p5.10.m10.2.2.1.1"><mi id="S4.SS2.p5.10.m10.2.2.1.1.2.2">e</mi><mrow id="S4.SS2.p5.10.m10.2.2.1.1.2.3"><mi id="S4.SS2.p5.10.m10.2.2.1.1.2.3.2">m</mi><mo id="S4.SS2.p5.10.m10.2.2.1.1.2.3.1">⁢</mo><msub id="S4.SS2.p5.10.m10.2.2.1.1.2.3.3"><mi id="S4.SS2.p5.10.m10.2.2.1.1.2.3.3.2">h</mi><mn id="S4.SS2.p5.10.m10.2.2.1.1.2.3.3.3">1</mn></msub></mrow><mi id="S4.SS2.p5.10.m10.2.2.1.1.3">u</mi></msubsup><mo id="S4.SS2.p5.10.m10.4.4.3.5">,</mo><mi id="S4.SS2.p5.10.m10.1.1" mathvariant="normal">…</mi><mo id="S4.SS2.p5.10.m10.4.4.3.6">,</mo><msubsup id="S4.SS2.p5.10.m10.3.3.2.2"><mi id="S4.SS2.p5.10.m10.3.3.2.2.2.2">e</mi><mrow id="S4.SS2.p5.10.m10.3.3.2.2.2.3"><mi id="S4.SS2.p5.10.m10.3.3.2.2.2.3.1">m</mi><msub id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2"><mi id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.2">h</mi><mrow id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.3"><mo id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.3.1" stretchy="false">(</mo><mi id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.3.2">T</mi><mo id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.3.3">−</mo><mn id="S4.SS2.p5.10.m10.3.3.2.2.2.3.2.3.4">1</mn></mrow></msub><mo id="S4.SS2.p5.10.m10.3.3.2.2.2.3.3" stretchy="false">)</mo></mrow><mi id="S4.SS2.p5.10.m10.3.3.2.2.3">u</mi></msubsup><mo id="S4.SS2.p5.10.m10.4.4.3.7">,</mo><msubsup id="S4.SS2.p5.10.m10.4.4.3.3"><mi id="S4.SS2.p5.10.m10.4.4.3.3.2.2">e</mi><mrow id="S4.SS2.p5.10.m10.4.4.3.3.2.3"><mi id="S4.SS2.p5.10.m10.4.4.3.3.2.3.2">m</mi><mo id="S4.SS2.p5.10.m10.4.4.3.3.2.3.1">⁢</mo><msub id="S4.SS2.p5.10.m10.4.4.3.3.2.3.3"><mi id="S4.SS2.p5.10.m10.4.4.3.3.2.3.3.2">h</mi><mi id="S4.SS2.p5.10.m10.4.4.3.3.2.3.3.3">T</mi></msub></mrow><mi id="S4.SS2.p5.10.m10.4.4.3.3.3">u</mi></msubsup><mo id="S4.SS2.p5.10.m10.4.4.3.8" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p5.10.m10.4b">[e_{mh_{1}}^{u},\dots,e_{mh_{(T-1})}^{u},e_{mh_{T}}^{u}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.10.m10.4c">[ italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT ( italic_T - 1 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ]</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="e_{mh}^{u}=\mathrm{Dropout}(Head_{1}\|Head_{2}\|\dots\|Head_{h})." class="ltx_Math" display="block" id="S4.E13.m1.1"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><msubsup id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.1.3.2.2" xref="S4.E13.m1.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S4.E13.m1.1.1.1.1.3.2.3" xref="S4.E13.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.3.2.3.2" xref="S4.E13.m1.1.1.1.1.3.2.3.2.cmml">m</mi><mo id="S4.E13.m1.1.1.1.1.3.2.3.1" xref="S4.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.2.3.3" xref="S4.E13.m1.1.1.1.1.3.2.3.3.cmml">h</mi></mrow><mi id="S4.E13.m1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.3.3.cmml">u</mi></msubsup><mo id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.3.cmml">Dropout</mi><mo id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.3.cmml">H</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.4" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.4.cmml">e</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2a" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.5" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.5.cmml">a</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2b" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.2.cmml">d</mi><mn id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.3.cmml">1</mn></msub><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2c" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">H</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">a</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1b" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">d</mi><mn id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">2</mn></msub></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2d" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.1.7" mathvariant="normal" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.7.cmml">…</mi></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml">∥</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml">H</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.4" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.4.cmml">a</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1.3.1b" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.2.cmml">d</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.3.cmml">h</mi></msub></mrow></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" lspace="0em" xref="S4.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"></eq><apply id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2">𝑒</ci><apply id="S4.E13.m1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3"><times id="S4.E13.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E13.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.2">𝑚</ci><ci id="S4.E13.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.3">ℎ</ci></apply></apply><ci id="S4.E13.m1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.2"></times><ci id="S4.E13.m1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3">Dropout</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.3">𝐻</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.4">𝑒</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.5">𝑎</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.2">𝑑</ci><cn id="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.6.3">1</cn></apply><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐻</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝑎</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.2">𝑑</ci><cn id="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.5.3">2</cn></apply></apply></apply><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.1.7.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.7">…</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E13.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.2">𝐻</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.4">𝑎</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.2">𝑑</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.5.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">e_{mh}^{u}=\mathrm{Dropout}(Head_{1}\|Head_{2}\|\dots\|Head_{h}).</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">italic_e start_POSTSUBSCRIPT italic_m italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Dropout ( italic_H italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ italic_H italic_e italic_a italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ … ∥ italic_H italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.1">Based on residual networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib43" title="">43</a>]</cite>, combine the Add&amp;Norm and Feed Forward modules in Transformer encoder to get the encoding for each position:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathrm{AN}(e_{i}^{u})=\mathrm{LayerNorm}(e_{mh}^{u}+e_{i}^{u})," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.3.cmml">AN</mi><mo id="S4.E14.m1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E14.m1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.3.cmml">LayerNorm</mi><mo id="S4.E14.m1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.2.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.2.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.cmml"><msubsup id="S4.E14.m1.1.1.1.1.2.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.2.cmml">e</mi><mrow id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.2.cmml">m</mi><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.3.cmml">h</mi></mrow><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E14.m1.1.1.1.1.2.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1.cmml">+</mo><msubsup id="S4.E14.m1.1.1.1.1.2.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.2" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.2.cmml">e</mi><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E14.m1.1.1.1.1.2.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E14.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3"></eq><apply id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><times id="S4.E14.m1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2"></times><ci id="S4.E14.m1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3">AN</ci><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2"><times id="S4.E14.m1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2"></times><ci id="S4.E14.m1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.3">LayerNorm</ci><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1"><plus id="S4.E14.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.1"></plus><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.2">𝑒</ci><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3"><times id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.1"></times><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.2">𝑚</ci><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.2.3.3">ℎ</ci></apply></apply><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.2.3">𝑢</ci></apply><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.2">𝑒</ci><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E14.m1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.2.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\mathrm{AN}(e_{i}^{u})=\mathrm{LayerNorm}(e_{mh}^{u}+e_{i}^{u}),</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">roman_AN ( italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = roman_LayerNorm ( italic_e start_POSTSUBSCRIPT italic_m italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathrm{FFN}(e_{i}^{u})=\mathrm{ReLU}\bigl{(}{\mathrm{AN}(e_{i}^{u})W_{1}+b_{1%
}}\bigr{)}W_{2}+b_{2}." class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.3.cmml">FFN</mi><mo id="S4.E15.m1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E15.m1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E15.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E15.m1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.cmml"><mrow id="S4.E15.m1.1.1.1.1.2.1" xref="S4.E15.m1.1.1.1.1.2.1.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.3" xref="S4.E15.m1.1.1.1.1.2.1.3.cmml">ReLU</mi><mo id="S4.E15.m1.1.1.1.1.2.1.2" xref="S4.E15.m1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1.2.1.1.1" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.2.1.1.1.1" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.3.cmml">AN</mi><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2a" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.2" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.2.cmml">W</mi><mn id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.2.cmml">+</mo><msub id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">b</mi><mn id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S4.E15.m1.1.1.1.1.2.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E15.m1.1.1.1.1.2.1.2a" xref="S4.E15.m1.1.1.1.1.2.1.2.cmml">⁢</mo><msub id="S4.E15.m1.1.1.1.1.2.1.4" xref="S4.E15.m1.1.1.1.1.2.1.4.cmml"><mi id="S4.E15.m1.1.1.1.1.2.1.4.2" xref="S4.E15.m1.1.1.1.1.2.1.4.2.cmml">W</mi><mn id="S4.E15.m1.1.1.1.1.2.1.4.3" xref="S4.E15.m1.1.1.1.1.2.1.4.3.cmml">2</mn></msub></mrow><mo id="S4.E15.m1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.2.2.cmml">+</mo><msub id="S4.E15.m1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1.2.3.2" xref="S4.E15.m1.1.1.1.1.2.3.2.cmml">b</mi><mn id="S4.E15.m1.1.1.1.1.2.3.3" xref="S4.E15.m1.1.1.1.1.2.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E15.m1.1.1.1.2" lspace="0em" xref="S4.E15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><eq id="S4.E15.m1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.3"></eq><apply id="S4.E15.m1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><times id="S4.E15.m1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.2"></times><ci id="S4.E15.m1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.3">FFN</ci><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><apply id="S4.E15.m1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><plus id="S4.E15.m1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2.2"></plus><apply id="S4.E15.m1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1"><times id="S4.E15.m1.1.1.1.1.2.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.2"></times><ci id="S4.E15.m1.1.1.1.1.2.1.3.cmml" xref="S4.E15.m1.1.1.1.1.2.1.3">ReLU</ci><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1"><plus id="S4.E15.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.2"></plus><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1"><times id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.2"></times><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.3">AN</ci><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.2">𝑊</ci><cn id="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.1.4.3">1</cn></apply></apply><apply id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.2">𝑏</ci><cn id="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E15.m1.1.1.1.1.2.1.4.cmml" xref="S4.E15.m1.1.1.1.1.2.1.4"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.4.1.cmml" xref="S4.E15.m1.1.1.1.1.2.1.4">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.1.4.2.cmml" xref="S4.E15.m1.1.1.1.1.2.1.4.2">𝑊</ci><cn id="S4.E15.m1.1.1.1.1.2.1.4.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.2.1.4.3">2</cn></apply></apply><apply id="S4.E15.m1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.3.1.cmml" xref="S4.E15.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.3.2.cmml" xref="S4.E15.m1.1.1.1.1.2.3.2">𝑏</ci><cn id="S4.E15.m1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.2.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\mathrm{FFN}(e_{i}^{u})=\mathrm{ReLU}\bigl{(}{\mathrm{AN}(e_{i}^{u})W_{1}+b_{1%
}}\bigr{)}W_{2}+b_{2}.</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">roman_FFN ( italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = roman_ReLU ( roman_AN ( italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.4">Since the goal of the model is to predict the most likely interaction item at the moment <math alttext="T+1" class="ltx_Math" display="inline" id="S4.SS2.p7.1.m1.1"><semantics id="S4.SS2.p7.1.m1.1a"><mrow id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml"><mi id="S4.SS2.p7.1.m1.1.1.2" xref="S4.SS2.p7.1.m1.1.1.2.cmml">T</mi><mo id="S4.SS2.p7.1.m1.1.1.1" xref="S4.SS2.p7.1.m1.1.1.1.cmml">+</mo><mn id="S4.SS2.p7.1.m1.1.1.3" xref="S4.SS2.p7.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><apply id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1"><plus id="S4.SS2.p7.1.m1.1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1.1"></plus><ci id="S4.SS2.p7.1.m1.1.1.2.cmml" xref="S4.SS2.p7.1.m1.1.1.2">𝑇</ci><cn id="S4.SS2.p7.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">T+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.1.m1.1d">italic_T + 1</annotation></semantics></math>, and the user’s interactive intention is changing in any order, <math alttext="e_{mh_{T}}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p7.2.m2.1"><semantics id="S4.SS2.p7.2.m2.1a"><msubsup id="S4.SS2.p7.2.m2.1.1" xref="S4.SS2.p7.2.m2.1.1.cmml"><mi id="S4.SS2.p7.2.m2.1.1.2.2" xref="S4.SS2.p7.2.m2.1.1.2.2.cmml">e</mi><mrow id="S4.SS2.p7.2.m2.1.1.2.3" xref="S4.SS2.p7.2.m2.1.1.2.3.cmml"><mi id="S4.SS2.p7.2.m2.1.1.2.3.2" xref="S4.SS2.p7.2.m2.1.1.2.3.2.cmml">m</mi><mo id="S4.SS2.p7.2.m2.1.1.2.3.1" xref="S4.SS2.p7.2.m2.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p7.2.m2.1.1.2.3.3" xref="S4.SS2.p7.2.m2.1.1.2.3.3.cmml"><mi id="S4.SS2.p7.2.m2.1.1.2.3.3.2" xref="S4.SS2.p7.2.m2.1.1.2.3.3.2.cmml">h</mi><mi id="S4.SS2.p7.2.m2.1.1.2.3.3.3" xref="S4.SS2.p7.2.m2.1.1.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.SS2.p7.2.m2.1.1.3" xref="S4.SS2.p7.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m2.1b"><apply id="S4.SS2.p7.2.m2.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.2.m2.1.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p7.2.m2.1.1.2.cmml" xref="S4.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.2.m2.1.1.2.1.cmml" xref="S4.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p7.2.m2.1.1.2.2.cmml" xref="S4.SS2.p7.2.m2.1.1.2.2">𝑒</ci><apply id="S4.SS2.p7.2.m2.1.1.2.3.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3"><times id="S4.SS2.p7.2.m2.1.1.2.3.1.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.1"></times><ci id="S4.SS2.p7.2.m2.1.1.2.3.2.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.2">𝑚</ci><apply id="S4.SS2.p7.2.m2.1.1.2.3.3.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p7.2.m2.1.1.2.3.3.1.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.3">subscript</csymbol><ci id="S4.SS2.p7.2.m2.1.1.2.3.3.2.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.3.2">ℎ</ci><ci id="S4.SS2.p7.2.m2.1.1.2.3.3.3.cmml" xref="S4.SS2.p7.2.m2.1.1.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.SS2.p7.2.m2.1.1.3.cmml" xref="S4.SS2.p7.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m2.1c">e_{mh_{T}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.2.m2.1d">italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> has a greater impact on the final prediction result compared to the first <math alttext="T-1" class="ltx_Math" display="inline" id="S4.SS2.p7.3.m3.1"><semantics id="S4.SS2.p7.3.m3.1a"><mrow id="S4.SS2.p7.3.m3.1.1" xref="S4.SS2.p7.3.m3.1.1.cmml"><mi id="S4.SS2.p7.3.m3.1.1.2" xref="S4.SS2.p7.3.m3.1.1.2.cmml">T</mi><mo id="S4.SS2.p7.3.m3.1.1.1" xref="S4.SS2.p7.3.m3.1.1.1.cmml">−</mo><mn id="S4.SS2.p7.3.m3.1.1.3" xref="S4.SS2.p7.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m3.1b"><apply id="S4.SS2.p7.3.m3.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1"><minus id="S4.SS2.p7.3.m3.1.1.1.cmml" xref="S4.SS2.p7.3.m3.1.1.1"></minus><ci id="S4.SS2.p7.3.m3.1.1.2.cmml" xref="S4.SS2.p7.3.m3.1.1.2">𝑇</ci><cn id="S4.SS2.p7.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p7.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.3.m3.1c">T-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.3.m3.1d">italic_T - 1</annotation></semantics></math> items. Therefore, based on the attention mechanism, the attention score of each item with <math alttext="e_{mh_{T}}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p7.4.m4.1"><semantics id="S4.SS2.p7.4.m4.1a"><msubsup id="S4.SS2.p7.4.m4.1.1" xref="S4.SS2.p7.4.m4.1.1.cmml"><mi id="S4.SS2.p7.4.m4.1.1.2.2" xref="S4.SS2.p7.4.m4.1.1.2.2.cmml">e</mi><mrow id="S4.SS2.p7.4.m4.1.1.2.3" xref="S4.SS2.p7.4.m4.1.1.2.3.cmml"><mi id="S4.SS2.p7.4.m4.1.1.2.3.2" xref="S4.SS2.p7.4.m4.1.1.2.3.2.cmml">m</mi><mo id="S4.SS2.p7.4.m4.1.1.2.3.1" xref="S4.SS2.p7.4.m4.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p7.4.m4.1.1.2.3.3" xref="S4.SS2.p7.4.m4.1.1.2.3.3.cmml"><mi id="S4.SS2.p7.4.m4.1.1.2.3.3.2" xref="S4.SS2.p7.4.m4.1.1.2.3.3.2.cmml">h</mi><mi id="S4.SS2.p7.4.m4.1.1.2.3.3.3" xref="S4.SS2.p7.4.m4.1.1.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.SS2.p7.4.m4.1.1.3" xref="S4.SS2.p7.4.m4.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.4.m4.1b"><apply id="S4.SS2.p7.4.m4.1.1.cmml" xref="S4.SS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.4.m4.1.1.1.cmml" xref="S4.SS2.p7.4.m4.1.1">superscript</csymbol><apply id="S4.SS2.p7.4.m4.1.1.2.cmml" xref="S4.SS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.4.m4.1.1.2.1.cmml" xref="S4.SS2.p7.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p7.4.m4.1.1.2.2.cmml" xref="S4.SS2.p7.4.m4.1.1.2.2">𝑒</ci><apply id="S4.SS2.p7.4.m4.1.1.2.3.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3"><times id="S4.SS2.p7.4.m4.1.1.2.3.1.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.1"></times><ci id="S4.SS2.p7.4.m4.1.1.2.3.2.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.2">𝑚</ci><apply id="S4.SS2.p7.4.m4.1.1.2.3.3.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p7.4.m4.1.1.2.3.3.1.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.3">subscript</csymbol><ci id="S4.SS2.p7.4.m4.1.1.2.3.3.2.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.3.2">ℎ</ci><ci id="S4.SS2.p7.4.m4.1.1.2.3.3.3.cmml" xref="S4.SS2.p7.4.m4.1.1.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.SS2.p7.4.m4.1.1.3.cmml" xref="S4.SS2.p7.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.4.m4.1c">e_{mh_{T}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is calculated and normalized:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathrm{AttScore}_{i,T}=\mathrm{Softmax}\bigl{(}{\mathrm{Dot}(e_{mh_{i}}^{u},e%
_{mh_{T}}^{u})}\bigr{)}," class="ltx_Math" display="block" id="S4.E16.m1.3"><semantics id="S4.E16.m1.3a"><mrow id="S4.E16.m1.3.3.1" xref="S4.E16.m1.3.3.1.1.cmml"><mrow id="S4.E16.m1.3.3.1.1" xref="S4.E16.m1.3.3.1.1.cmml"><msub id="S4.E16.m1.3.3.1.1.3" xref="S4.E16.m1.3.3.1.1.3.cmml"><mi id="S4.E16.m1.3.3.1.1.3.2" xref="S4.E16.m1.3.3.1.1.3.2.cmml">AttScore</mi><mrow id="S4.E16.m1.2.2.2.4" xref="S4.E16.m1.2.2.2.3.cmml"><mi id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml">i</mi><mo id="S4.E16.m1.2.2.2.4.1" xref="S4.E16.m1.2.2.2.3.cmml">,</mo><mi id="S4.E16.m1.2.2.2.2" xref="S4.E16.m1.2.2.2.2.cmml">T</mi></mrow></msub><mo id="S4.E16.m1.3.3.1.1.2" xref="S4.E16.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E16.m1.3.3.1.1.1" xref="S4.E16.m1.3.3.1.1.1.cmml"><mi id="S4.E16.m1.3.3.1.1.1.3" xref="S4.E16.m1.3.3.1.1.1.3.cmml">Softmax</mi><mo id="S4.E16.m1.3.3.1.1.1.2" xref="S4.E16.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E16.m1.3.3.1.1.1.1.1" xref="S4.E16.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E16.m1.3.3.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E16.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.3.3.1.1.1.1.1.1" xref="S4.E16.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.4" xref="S4.E16.m1.3.3.1.1.1.1.1.1.4.cmml">Dot</mi><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">h</mi><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.4" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml">e</mi><mrow id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.2.cmml">m</mi><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.1" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.2" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml">h</mi><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.3.3.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E16.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E16.m1.3.3.1.2" xref="S4.E16.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.3b"><apply id="S4.E16.m1.3.3.1.1.cmml" xref="S4.E16.m1.3.3.1"><eq id="S4.E16.m1.3.3.1.1.2.cmml" xref="S4.E16.m1.3.3.1.1.2"></eq><apply id="S4.E16.m1.3.3.1.1.3.cmml" xref="S4.E16.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.3.1.cmml" xref="S4.E16.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E16.m1.3.3.1.1.3.2.cmml" xref="S4.E16.m1.3.3.1.1.3.2">AttScore</ci><list id="S4.E16.m1.2.2.2.3.cmml" xref="S4.E16.m1.2.2.2.4"><ci id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1">𝑖</ci><ci id="S4.E16.m1.2.2.2.2.cmml" xref="S4.E16.m1.2.2.2.2">𝑇</ci></list></apply><apply id="S4.E16.m1.3.3.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1.1"><times id="S4.E16.m1.3.3.1.1.1.2.cmml" xref="S4.E16.m1.3.3.1.1.1.2"></times><ci id="S4.E16.m1.3.3.1.1.1.3.cmml" xref="S4.E16.m1.3.3.1.1.1.3">Softmax</ci><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1"><times id="S4.E16.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.3"></times><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.4">Dot</ci><interval closure="open" id="S4.E16.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.2">ℎ</ci><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.2">𝑒</ci><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3"><times id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.2">𝑚</ci><apply id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.2">ℎ</ci><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E16.m1.3.3.1.1.1.1.1.1.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.3c">\mathrm{AttScore}_{i,T}=\mathrm{Softmax}\bigl{(}{\mathrm{Dot}(e_{mh_{i}}^{u},e%
_{mh_{T}}^{u})}\bigr{)},</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.3d">roman_AttScore start_POSTSUBSCRIPT italic_i , italic_T end_POSTSUBSCRIPT = roman_Softmax ( roman_Dot ( italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathrm{Att}(e_{mh_{T}}^{u})=\sum_{i=1}^{T-1}\mathrm{AttScore}_{i,T}\cdot e_{%
mh_{i}}^{u}," class="ltx_Math" display="block" id="S4.E17.m1.3"><semantics id="S4.E17.m1.3a"><mrow id="S4.E17.m1.3.3.1" xref="S4.E17.m1.3.3.1.1.cmml"><mrow id="S4.E17.m1.3.3.1.1" xref="S4.E17.m1.3.3.1.1.cmml"><mrow id="S4.E17.m1.3.3.1.1.1" xref="S4.E17.m1.3.3.1.1.1.cmml"><mi id="S4.E17.m1.3.3.1.1.1.3" xref="S4.E17.m1.3.3.1.1.1.3.cmml">Att</mi><mo id="S4.E17.m1.3.3.1.1.1.2" xref="S4.E17.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E17.m1.3.3.1.1.1.1.1" xref="S4.E17.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E17.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E17.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E17.m1.3.3.1.1.1.1.1.1" xref="S4.E17.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E17.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.2" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.2.cmml">h</mi><mi id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.3" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.E17.m1.3.3.1.1.1.1.1.1.3" xref="S4.E17.m1.3.3.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E17.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E17.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E17.m1.3.3.1.1.2" rspace="0.111em" xref="S4.E17.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E17.m1.3.3.1.1.3" xref="S4.E17.m1.3.3.1.1.3.cmml"><munderover id="S4.E17.m1.3.3.1.1.3.1" xref="S4.E17.m1.3.3.1.1.3.1.cmml"><mo id="S4.E17.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="S4.E17.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E17.m1.3.3.1.1.3.1.2.3" xref="S4.E17.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.1.2.3.2" xref="S4.E17.m1.3.3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E17.m1.3.3.1.1.3.1.2.3.1" xref="S4.E17.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E17.m1.3.3.1.1.3.1.2.3.3" xref="S4.E17.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E17.m1.3.3.1.1.3.1.3" xref="S4.E17.m1.3.3.1.1.3.1.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.1.3.2" xref="S4.E17.m1.3.3.1.1.3.1.3.2.cmml">T</mi><mo id="S4.E17.m1.3.3.1.1.3.1.3.1" xref="S4.E17.m1.3.3.1.1.3.1.3.1.cmml">−</mo><mn id="S4.E17.m1.3.3.1.1.3.1.3.3" xref="S4.E17.m1.3.3.1.1.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S4.E17.m1.3.3.1.1.3.2" xref="S4.E17.m1.3.3.1.1.3.2.cmml"><msub id="S4.E17.m1.3.3.1.1.3.2.2" xref="S4.E17.m1.3.3.1.1.3.2.2.cmml"><mi id="S4.E17.m1.3.3.1.1.3.2.2.2" xref="S4.E17.m1.3.3.1.1.3.2.2.2.cmml">AttScore</mi><mrow id="S4.E17.m1.2.2.2.4" xref="S4.E17.m1.2.2.2.3.cmml"><mi id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml">i</mi><mo id="S4.E17.m1.2.2.2.4.1" xref="S4.E17.m1.2.2.2.3.cmml">,</mo><mi id="S4.E17.m1.2.2.2.2" xref="S4.E17.m1.2.2.2.2.cmml">T</mi></mrow></msub><mo id="S4.E17.m1.3.3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S4.E17.m1.3.3.1.1.3.2.3" xref="S4.E17.m1.3.3.1.1.3.2.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.2.3.2.2" xref="S4.E17.m1.3.3.1.1.3.2.3.2.2.cmml">e</mi><mrow id="S4.E17.m1.3.3.1.1.3.2.3.2.3" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.2.3.2.3.2" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.2.cmml">m</mi><mo id="S4.E17.m1.3.3.1.1.3.2.3.2.3.1" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.1.cmml">⁢</mo><msub id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.2" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.2.cmml">h</mi><mi id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.3" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.3.cmml">i</mi></msub></mrow><mi id="S4.E17.m1.3.3.1.1.3.2.3.3" xref="S4.E17.m1.3.3.1.1.3.2.3.3.cmml">u</mi></msubsup></mrow></mrow></mrow><mo id="S4.E17.m1.3.3.1.2" xref="S4.E17.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.3b"><apply id="S4.E17.m1.3.3.1.1.cmml" xref="S4.E17.m1.3.3.1"><eq id="S4.E17.m1.3.3.1.1.2.cmml" xref="S4.E17.m1.3.3.1.1.2"></eq><apply id="S4.E17.m1.3.3.1.1.1.cmml" xref="S4.E17.m1.3.3.1.1.1"><times id="S4.E17.m1.3.3.1.1.1.2.cmml" xref="S4.E17.m1.3.3.1.1.1.2"></times><ci id="S4.E17.m1.3.3.1.1.1.3.cmml" xref="S4.E17.m1.3.3.1.1.1.3">Att</ci><apply id="S4.E17.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S4.E17.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3"><times id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.2">𝑚</ci><apply id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.2">ℎ</ci><ci id="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.E17.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E17.m1.3.3.1.1.1.1.1.1.3">𝑢</ci></apply></apply><apply id="S4.E17.m1.3.3.1.1.3.cmml" xref="S4.E17.m1.3.3.1.1.3"><apply id="S4.E17.m1.3.3.1.1.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.1.1.cmml" xref="S4.E17.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S4.E17.m1.3.3.1.1.3.1.2.cmml" xref="S4.E17.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.1.2.1.cmml" xref="S4.E17.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S4.E17.m1.3.3.1.1.3.1.2.2.cmml" xref="S4.E17.m1.3.3.1.1.3.1.2.2"></sum><apply id="S4.E17.m1.3.3.1.1.3.1.2.3.cmml" xref="S4.E17.m1.3.3.1.1.3.1.2.3"><eq id="S4.E17.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S4.E17.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E17.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E17.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.E17.m1.3.3.1.1.3.1.3.cmml" xref="S4.E17.m1.3.3.1.1.3.1.3"><minus id="S4.E17.m1.3.3.1.1.3.1.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.1.3.1"></minus><ci id="S4.E17.m1.3.3.1.1.3.1.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.1.3.2">𝑇</ci><cn id="S4.E17.m1.3.3.1.1.3.1.3.3.cmml" type="integer" xref="S4.E17.m1.3.3.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.E17.m1.3.3.1.1.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2"><ci id="S4.E17.m1.3.3.1.1.3.2.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.1">⋅</ci><apply id="S4.E17.m1.3.3.1.1.3.2.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.2.2">AttScore</ci><list id="S4.E17.m1.2.2.2.3.cmml" xref="S4.E17.m1.2.2.2.4"><ci id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1">𝑖</ci><ci id="S4.E17.m1.2.2.2.2.cmml" xref="S4.E17.m1.2.2.2.2">𝑇</ci></list></apply><apply id="S4.E17.m1.3.3.1.1.3.2.3.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S4.E17.m1.3.3.1.1.3.2.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.2">𝑒</ci><apply id="S4.E17.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3"><times id="S4.E17.m1.3.3.1.1.3.2.3.2.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.1"></times><ci id="S4.E17.m1.3.3.1.1.3.2.3.2.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.2">𝑚</ci><apply id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.2">ℎ</ci><ci id="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.3.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="S4.E17.m1.3.3.1.1.3.2.3.3.cmml" xref="S4.E17.m1.3.3.1.1.3.2.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.3c">\mathrm{Att}(e_{mh_{T}}^{u})=\sum_{i=1}^{T-1}\mathrm{AttScore}_{i,T}\cdot e_{%
mh_{i}}^{u},</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.3d">roman_Att ( italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T - 1 end_POSTSUPERSCRIPT roman_AttScore start_POSTSUBSCRIPT italic_i , italic_T end_POSTSUBSCRIPT ⋅ italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p8">
<p class="ltx_p" id="S4.SS2.p8.3">where <math alttext="\mathrm{Dot}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p8.1.m1.2"><semantics id="S4.SS2.p8.1.m1.2a"><mrow id="S4.SS2.p8.1.m1.2.3" xref="S4.SS2.p8.1.m1.2.3.cmml"><mi id="S4.SS2.p8.1.m1.2.3.2" xref="S4.SS2.p8.1.m1.2.3.2.cmml">Dot</mi><mo id="S4.SS2.p8.1.m1.2.3.1" xref="S4.SS2.p8.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p8.1.m1.2.3.3.2" xref="S4.SS2.p8.1.m1.2.3.3.1.cmml"><mo id="S4.SS2.p8.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS2.p8.1.m1.2.3.3.1.cmml">(</mo><mo id="S4.SS2.p8.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p8.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS2.p8.1.m1.2.3.3.2.2" rspace="0em" xref="S4.SS2.p8.1.m1.2.3.3.1.cmml">,</mo><mo id="S4.SS2.p8.1.m1.2.2" lspace="0em" rspace="0em" xref="S4.SS2.p8.1.m1.2.2.cmml">⋅</mo><mo id="S4.SS2.p8.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS2.p8.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.2b"><apply id="S4.SS2.p8.1.m1.2.3.cmml" xref="S4.SS2.p8.1.m1.2.3"><times id="S4.SS2.p8.1.m1.2.3.1.cmml" xref="S4.SS2.p8.1.m1.2.3.1"></times><ci id="S4.SS2.p8.1.m1.2.3.2.cmml" xref="S4.SS2.p8.1.m1.2.3.2">Dot</ci><interval closure="open" id="S4.SS2.p8.1.m1.2.3.3.1.cmml" xref="S4.SS2.p8.1.m1.2.3.3.2"><ci id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">⋅</ci><ci id="S4.SS2.p8.1.m1.2.2.cmml" xref="S4.SS2.p8.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.2c">\mathrm{Dot}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.1.m1.2d">roman_Dot ( ⋅ , ⋅ )</annotation></semantics></math> is generally the dot product or scaled dot product, because the <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p8.2.m2.1"><semantics id="S4.SS2.p8.2.m2.1a"><mi id="S4.SS2.p8.2.m2.1.1" xref="S4.SS2.p8.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m2.1b"><ci id="S4.SS2.p8.2.m2.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.2.m2.1d">italic_T</annotation></semantics></math>-th term has the highest attention weight with itself, and in order to avoid the influence of itself on the other items, <math alttext="e_{mh_{T}}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p8.3.m3.1"><semantics id="S4.SS2.p8.3.m3.1a"><msubsup id="S4.SS2.p8.3.m3.1.1" xref="S4.SS2.p8.3.m3.1.1.cmml"><mi id="S4.SS2.p8.3.m3.1.1.2.2" xref="S4.SS2.p8.3.m3.1.1.2.2.cmml">e</mi><mrow id="S4.SS2.p8.3.m3.1.1.2.3" xref="S4.SS2.p8.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p8.3.m3.1.1.2.3.2" xref="S4.SS2.p8.3.m3.1.1.2.3.2.cmml">m</mi><mo id="S4.SS2.p8.3.m3.1.1.2.3.1" xref="S4.SS2.p8.3.m3.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p8.3.m3.1.1.2.3.3" xref="S4.SS2.p8.3.m3.1.1.2.3.3.cmml"><mi id="S4.SS2.p8.3.m3.1.1.2.3.3.2" xref="S4.SS2.p8.3.m3.1.1.2.3.3.2.cmml">h</mi><mi id="S4.SS2.p8.3.m3.1.1.2.3.3.3" xref="S4.SS2.p8.3.m3.1.1.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.SS2.p8.3.m3.1.1.3" xref="S4.SS2.p8.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m3.1b"><apply id="S4.SS2.p8.3.m3.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p8.3.m3.1.1.2.cmml" xref="S4.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.2.1.cmml" xref="S4.SS2.p8.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p8.3.m3.1.1.2.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2.2">𝑒</ci><apply id="S4.SS2.p8.3.m3.1.1.2.3.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3"><times id="S4.SS2.p8.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.1"></times><ci id="S4.SS2.p8.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.2">𝑚</ci><apply id="S4.SS2.p8.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.2.3.3.1.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.3">subscript</csymbol><ci id="S4.SS2.p8.3.m3.1.1.2.3.3.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.3.2">ℎ</ci><ci id="S4.SS2.p8.3.m3.1.1.2.3.3.3.cmml" xref="S4.SS2.p8.3.m3.1.1.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.SS2.p8.3.m3.1.1.3.cmml" xref="S4.SS2.p8.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.3.m3.1c">e_{mh_{T}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.3.m3.1d">italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is added after the weighted summation:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="e^{trm}=e_{mh_{T}}^{u}+\mathrm{Att}(e_{mh_{T}}^{u})." class="ltx_Math" display="block" id="S4.E18.m1.1"><semantics id="S4.E18.m1.1a"><mrow id="S4.E18.m1.1.1.1" xref="S4.E18.m1.1.1.1.1.cmml"><mrow id="S4.E18.m1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.cmml"><msup id="S4.E18.m1.1.1.1.1.3" xref="S4.E18.m1.1.1.1.1.3.cmml"><mi id="S4.E18.m1.1.1.1.1.3.2" xref="S4.E18.m1.1.1.1.1.3.2.cmml">e</mi><mrow id="S4.E18.m1.1.1.1.1.3.3" xref="S4.E18.m1.1.1.1.1.3.3.cmml"><mi id="S4.E18.m1.1.1.1.1.3.3.2" xref="S4.E18.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E18.m1.1.1.1.1.3.3.1" xref="S4.E18.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.1.1.3.3.3" xref="S4.E18.m1.1.1.1.1.3.3.3.cmml">r</mi><mo id="S4.E18.m1.1.1.1.1.3.3.1a" xref="S4.E18.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.1.1.3.3.4" xref="S4.E18.m1.1.1.1.1.3.3.4.cmml">m</mi></mrow></msup><mo id="S4.E18.m1.1.1.1.1.2" xref="S4.E18.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E18.m1.1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.1.cmml"><msubsup id="S4.E18.m1.1.1.1.1.1.3" xref="S4.E18.m1.1.1.1.1.1.3.cmml"><mi id="S4.E18.m1.1.1.1.1.1.3.2.2" xref="S4.E18.m1.1.1.1.1.1.3.2.2.cmml">e</mi><mrow id="S4.E18.m1.1.1.1.1.1.3.2.3" xref="S4.E18.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E18.m1.1.1.1.1.1.3.2.3.2" xref="S4.E18.m1.1.1.1.1.1.3.2.3.2.cmml">m</mi><mo id="S4.E18.m1.1.1.1.1.1.3.2.3.1" xref="S4.E18.m1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msub id="S4.E18.m1.1.1.1.1.1.3.2.3.3" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3.cmml"><mi id="S4.E18.m1.1.1.1.1.1.3.2.3.3.2" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3.2.cmml">h</mi><mi id="S4.E18.m1.1.1.1.1.1.3.2.3.3.3" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.E18.m1.1.1.1.1.1.3.3" xref="S4.E18.m1.1.1.1.1.1.3.3.cmml">u</mi></msubsup><mo id="S4.E18.m1.1.1.1.1.1.2" xref="S4.E18.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E18.m1.1.1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.1.1.cmml"><mi id="S4.E18.m1.1.1.1.1.1.1.3" xref="S4.E18.m1.1.1.1.1.1.1.3.cmml">Att</mi><mo id="S4.E18.m1.1.1.1.1.1.1.2" xref="S4.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E18.m1.1.1.1.1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E18.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E18.m1.1.1.1.1.1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">h</mi><mi id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">T</mi></msub></mrow><mi id="S4.E18.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E18.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E18.m1.1.1.1.2" lspace="0em" xref="S4.E18.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.1b"><apply id="S4.E18.m1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1"><eq id="S4.E18.m1.1.1.1.1.2.cmml" xref="S4.E18.m1.1.1.1.1.2"></eq><apply id="S4.E18.m1.1.1.1.1.3.cmml" xref="S4.E18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.3.1.cmml" xref="S4.E18.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E18.m1.1.1.1.1.3.2.cmml" xref="S4.E18.m1.1.1.1.1.3.2">𝑒</ci><apply id="S4.E18.m1.1.1.1.1.3.3.cmml" xref="S4.E18.m1.1.1.1.1.3.3"><times id="S4.E18.m1.1.1.1.1.3.3.1.cmml" xref="S4.E18.m1.1.1.1.1.3.3.1"></times><ci id="S4.E18.m1.1.1.1.1.3.3.2.cmml" xref="S4.E18.m1.1.1.1.1.3.3.2">𝑡</ci><ci id="S4.E18.m1.1.1.1.1.3.3.3.cmml" xref="S4.E18.m1.1.1.1.1.3.3.3">𝑟</ci><ci id="S4.E18.m1.1.1.1.1.3.3.4.cmml" xref="S4.E18.m1.1.1.1.1.3.3.4">𝑚</ci></apply></apply><apply id="S4.E18.m1.1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1.1"><plus id="S4.E18.m1.1.1.1.1.1.2.cmml" xref="S4.E18.m1.1.1.1.1.1.2"></plus><apply id="S4.E18.m1.1.1.1.1.1.3.cmml" xref="S4.E18.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.3.1.cmml" xref="S4.E18.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E18.m1.1.1.1.1.1.3.2.cmml" xref="S4.E18.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E18.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E18.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.2">𝑒</ci><apply id="S4.E18.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3"><times id="S4.E18.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E18.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.2">𝑚</ci><apply id="S4.E18.m1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3">subscript</csymbol><ci id="S4.E18.m1.1.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3.2">ℎ</ci><ci id="S4.E18.m1.1.1.1.1.1.3.2.3.3.3.cmml" xref="S4.E18.m1.1.1.1.1.1.3.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.E18.m1.1.1.1.1.1.3.3.cmml" xref="S4.E18.m1.1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E18.m1.1.1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1"><times id="S4.E18.m1.1.1.1.1.1.1.2.cmml" xref="S4.E18.m1.1.1.1.1.1.1.2"></times><ci id="S4.E18.m1.1.1.1.1.1.1.3.cmml" xref="S4.E18.m1.1.1.1.1.1.1.3">Att</ci><apply id="S4.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><apply id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.2">ℎ</ci><ci id="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.2.3.3.3">𝑇</ci></apply></apply></apply><ci id="S4.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E18.m1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.1c">e^{trm}=e_{mh_{T}}^{u}+\mathrm{Att}(e_{mh_{T}}^{u}).</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.1d">italic_e start_POSTSUPERSCRIPT italic_t italic_r italic_m end_POSTSUPERSCRIPT = italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + roman_Att ( italic_e start_POSTSUBSCRIPT italic_m italic_h start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p9">
<p class="ltx_p" id="S4.SS2.p9.5">This yields the final sequence representation <math alttext="e^{trm}" class="ltx_Math" display="inline" id="S4.SS2.p9.1.m1.1"><semantics id="S4.SS2.p9.1.m1.1a"><msup id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml"><mi id="S4.SS2.p9.1.m1.1.1.2" xref="S4.SS2.p9.1.m1.1.1.2.cmml">e</mi><mrow id="S4.SS2.p9.1.m1.1.1.3" xref="S4.SS2.p9.1.m1.1.1.3.cmml"><mi id="S4.SS2.p9.1.m1.1.1.3.2" xref="S4.SS2.p9.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p9.1.m1.1.1.3.1" xref="S4.SS2.p9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p9.1.m1.1.1.3.3" xref="S4.SS2.p9.1.m1.1.1.3.3.cmml">r</mi><mo id="S4.SS2.p9.1.m1.1.1.3.1a" xref="S4.SS2.p9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p9.1.m1.1.1.3.4" xref="S4.SS2.p9.1.m1.1.1.3.4.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p9.1.m1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1.2">𝑒</ci><apply id="S4.SS2.p9.1.m1.1.1.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3"><times id="S4.SS2.p9.1.m1.1.1.3.1.cmml" xref="S4.SS2.p9.1.m1.1.1.3.1"></times><ci id="S4.SS2.p9.1.m1.1.1.3.2.cmml" xref="S4.SS2.p9.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS2.p9.1.m1.1.1.3.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3">𝑟</ci><ci id="S4.SS2.p9.1.m1.1.1.3.4.cmml" xref="S4.SS2.p9.1.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">e^{trm}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.1.m1.1d">italic_e start_POSTSUPERSCRIPT italic_t italic_r italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p9.2.m2.1"><semantics id="S4.SS2.p9.2.m2.1a"><mi id="S4.SS2.p9.2.m2.1.1" xref="S4.SS2.p9.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><ci id="S4.SS2.p9.2.m2.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.2.m2.1d">italic_u</annotation></semantics></math>. Compares to the traditional direct splicing, this feature both includes the <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p9.3.m3.1"><semantics id="S4.SS2.p9.3.m3.1a"><mi id="S4.SS2.p9.3.m3.1.1" xref="S4.SS2.p9.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m3.1b"><ci id="S4.SS2.p9.3.m3.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.3.m3.1d">italic_T</annotation></semantics></math>-moment items and absorbs the effect of the weights of the rest of the <math alttext="T-1" class="ltx_Math" display="inline" id="S4.SS2.p9.4.m4.1"><semantics id="S4.SS2.p9.4.m4.1a"><mrow id="S4.SS2.p9.4.m4.1.1" xref="S4.SS2.p9.4.m4.1.1.cmml"><mi id="S4.SS2.p9.4.m4.1.1.2" xref="S4.SS2.p9.4.m4.1.1.2.cmml">T</mi><mo id="S4.SS2.p9.4.m4.1.1.1" xref="S4.SS2.p9.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS2.p9.4.m4.1.1.3" xref="S4.SS2.p9.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m4.1b"><apply id="S4.SS2.p9.4.m4.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1"><minus id="S4.SS2.p9.4.m4.1.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1.1"></minus><ci id="S4.SS2.p9.4.m4.1.1.2.cmml" xref="S4.SS2.p9.4.m4.1.1.2">𝑇</ci><cn id="S4.SS2.p9.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p9.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m4.1c">T-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.4.m4.1d">italic_T - 1</annotation></semantics></math> items on the last item, with higher weights representing the greater importance of the interaction item at that moment for predicting the <math alttext="T+1" class="ltx_Math" display="inline" id="S4.SS2.p9.5.m5.1"><semantics id="S4.SS2.p9.5.m5.1a"><mrow id="S4.SS2.p9.5.m5.1.1" xref="S4.SS2.p9.5.m5.1.1.cmml"><mi id="S4.SS2.p9.5.m5.1.1.2" xref="S4.SS2.p9.5.m5.1.1.2.cmml">T</mi><mo id="S4.SS2.p9.5.m5.1.1.1" xref="S4.SS2.p9.5.m5.1.1.1.cmml">+</mo><mn id="S4.SS2.p9.5.m5.1.1.3" xref="S4.SS2.p9.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.5.m5.1b"><apply id="S4.SS2.p9.5.m5.1.1.cmml" xref="S4.SS2.p9.5.m5.1.1"><plus id="S4.SS2.p9.5.m5.1.1.1.cmml" xref="S4.SS2.p9.5.m5.1.1.1"></plus><ci id="S4.SS2.p9.5.m5.1.1.2.cmml" xref="S4.SS2.p9.5.m5.1.1.2">𝑇</ci><cn id="S4.SS2.p9.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p9.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.5.m5.1c">T+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.5.m5.1d">italic_T + 1</annotation></semantics></math> moment.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Intention Disentanglement Layer</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3">Our work argues that the interactive intentions in user behavior are complex, varied and highly disentangled, but most current research has neglected the effective parsing of user intentions. After obtaining the user’s sequence representation, MIDCL learns the user’s latent distribution representation based on VAE and generates a <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_k</annotation></semantics></math>-dimensional latent vector
<math alttext="e^{int}\in\mathbb{R}^{k\times d}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><msup id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">e</mi><mrow id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.3.2" xref="S4.SS3.p1.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.2.m2.1.1.2.3.1" xref="S4.SS3.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.3.3" xref="S4.SS3.p1.2.m2.1.1.2.3.3.cmml">n</mi><mo id="S4.SS3.p1.2.m2.1.1.2.3.1a" xref="S4.SS3.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.3.4" xref="S4.SS3.p1.2.m2.1.1.2.3.4.cmml">t</mi></mrow></msup><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.3.2" xref="S4.SS3.p1.2.m2.1.1.3.3.2.cmml">k</mi><mo id="S4.SS3.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">𝑒</ci><apply id="S4.SS3.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3"><times id="S4.SS3.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.3">𝑛</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.4.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3"><times id="S4.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.2">𝑘</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">e^{int}\in\mathbb{R}^{k\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_e start_POSTSUPERSCRIPT italic_i italic_n italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_k × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>
via an encoder, with <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_k</annotation></semantics></math> denoting the number of disentangled intentions. VAE is divided into two encoders and a decoder, the encoders map the samples into the latent space, learning the mean and logarithmic variance of the sample distributions, respectively, and this latent space is usually constrained to be close to the standard normal distribution by the KLD and other loss functions. The decoder samples from the latent space and maps back into the data space based on the learned parameters, reconstructing new samples with similar distributions to the original samples. MIDCL discards the decoder portion of the VAE and samples the latent intention distributions of the user sequences using the encoder only, and the learning process relies on the reparameterization technique.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.2">Most VAE encoders and decoders are linear layers, in order to enable them to learn deeper sample distributions, MIDCL adopts Transformer as the feature representation of encoder-generated user-sequence samples, and uses two linear layers to learn the representations of the sample distributions with the mean <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_μ</annotation></semantics></math> and the logarithmic variance <math alttext="\log(\sigma^{2})" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.2"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.2.1" xref="S4.SS3.p2.2.m2.2.2.2.cmml"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">log</mi><mo id="S4.SS3.p2.2.m2.2.2.1a" xref="S4.SS3.p2.2.m2.2.2.2.cmml">⁡</mo><mrow id="S4.SS3.p2.2.m2.2.2.1.1" xref="S4.SS3.p2.2.m2.2.2.2.cmml"><mo id="S4.SS3.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S4.SS3.p2.2.m2.2.2.2.cmml">(</mo><msup id="S4.SS3.p2.2.m2.2.2.1.1.1" xref="S4.SS3.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS3.p2.2.m2.2.2.1.1.1.2" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.cmml">σ</mi><mn id="S4.SS3.p2.2.m2.2.2.1.1.1.3" xref="S4.SS3.p2.2.m2.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS3.p2.2.m2.2.2.1.1.3" stretchy="false" xref="S4.SS3.p2.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><apply id="S4.SS3.p2.2.m2.2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2.1"><log id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"></log><apply id="S4.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2">𝜎</ci><cn id="S4.SS3.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p2.2.m2.2.2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">\log(\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.2d">roman_log ( italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> respectively:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="e^{mu}=\mathrm{Linear}_{1}(e^{trm}),e^{lv}=\mathrm{Linear}_{2}(e^{trm})." class="ltx_Math" display="block" id="S4.E19.m1.1"><semantics id="S4.E19.m1.1a"><mrow id="S4.E19.m1.1.1.1"><mrow id="S4.E19.m1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.3.cmml"><mrow id="S4.E19.m1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.cmml"><msup id="S4.E19.m1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.1.1.3.2.cmml">e</mi><mrow id="S4.E19.m1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.3.3.2" xref="S4.E19.m1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo id="S4.E19.m1.1.1.1.1.1.1.3.3.1" xref="S4.E19.m1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.3.3.3" xref="S4.E19.m1.1.1.1.1.1.1.3.3.3.cmml">u</mi></mrow></msup><mo id="S4.E19.m1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E19.m1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.3.2.cmml">Linear</mi><mn id="S4.E19.m1.1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S4.E19.m1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">r</mi><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">m</mi></mrow></msup><mo id="S4.E19.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E19.m1.1.1.1.1.2.3" xref="S4.E19.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E19.m1.1.1.1.1.2.2" xref="S4.E19.m1.1.1.1.1.2.2.cmml"><msup id="S4.E19.m1.1.1.1.1.2.2.3" xref="S4.E19.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.3.2" xref="S4.E19.m1.1.1.1.1.2.2.3.2.cmml">e</mi><mrow id="S4.E19.m1.1.1.1.1.2.2.3.3" xref="S4.E19.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.3.3.2" xref="S4.E19.m1.1.1.1.1.2.2.3.3.2.cmml">l</mi><mo id="S4.E19.m1.1.1.1.1.2.2.3.3.1" xref="S4.E19.m1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.2.2.3.3.3" xref="S4.E19.m1.1.1.1.1.2.2.3.3.3.cmml">v</mi></mrow></msup><mo id="S4.E19.m1.1.1.1.1.2.2.2" xref="S4.E19.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S4.E19.m1.1.1.1.1.2.2.1" xref="S4.E19.m1.1.1.1.1.2.2.1.cmml"><msub id="S4.E19.m1.1.1.1.1.2.2.1.3" xref="S4.E19.m1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.1.3.2" xref="S4.E19.m1.1.1.1.1.2.2.1.3.2.cmml">Linear</mi><mn id="S4.E19.m1.1.1.1.1.2.2.1.3.3" xref="S4.E19.m1.1.1.1.1.2.2.1.3.3.cmml">2</mn></msub><mo id="S4.E19.m1.1.1.1.1.2.2.1.2" xref="S4.E19.m1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.1.1.1.1.2.2.1.1.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.1.2" stretchy="false" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><msup id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.2.cmml">e</mi><mrow id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">t</mi><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">r</mi><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1a" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.4" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.4.cmml">m</mi></mrow></msup><mo id="S4.E19.m1.1.1.1.1.2.2.1.1.1.3" stretchy="false" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E19.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.1b"><apply id="S4.E19.m1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.3a.cmml" xref="S4.E19.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E19.m1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1"><eq id="S4.E19.m1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E19.m1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E19.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3.2">𝑒</ci><apply id="S4.E19.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3.3"><times id="S4.E19.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E19.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S4.E19.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.3.3.3">𝑢</ci></apply></apply><apply id="S4.E19.m1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1"><times id="S4.E19.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E19.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E19.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.3.2">Linear</ci><cn id="S4.E19.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E19.m1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.2">𝑒</ci><apply id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E19.m1.1.1.1.1.1.1.1.1.1.1.3.4">𝑚</ci></apply></apply></apply></apply><apply id="S4.E19.m1.1.1.1.1.2.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2"><eq id="S4.E19.m1.1.1.1.1.2.2.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.2"></eq><apply id="S4.E19.m1.1.1.1.1.2.2.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S4.E19.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.2">𝑒</ci><apply id="S4.E19.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3"><times id="S4.E19.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.1"></times><ci id="S4.E19.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.2">𝑙</ci><ci id="S4.E19.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.3.3.3">𝑣</ci></apply></apply><apply id="S4.E19.m1.1.1.1.1.2.2.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1"><times id="S4.E19.m1.1.1.1.1.2.2.1.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.2"></times><apply id="S4.E19.m1.1.1.1.1.2.2.1.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S4.E19.m1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.3.2">Linear</ci><cn id="S4.E19.m1.1.1.1.1.2.2.1.3.3.cmml" type="integer" xref="S4.E19.m1.1.1.1.1.2.2.1.3.3">2</cn></apply><apply id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1">superscript</csymbol><ci id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.2">𝑒</ci><apply id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3"><times id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1"></times><ci id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2">𝑡</ci><ci id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3">𝑟</ci><ci id="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.4.cmml" xref="S4.E19.m1.1.1.1.1.2.2.1.1.1.1.3.4">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.1c">e^{mu}=\mathrm{Linear}_{1}(e^{trm}),e^{lv}=\mathrm{Linear}_{2}(e^{trm}).</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.1d">italic_e start_POSTSUPERSCRIPT italic_m italic_u end_POSTSUPERSCRIPT = roman_Linear start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_e start_POSTSUPERSCRIPT italic_t italic_r italic_m end_POSTSUPERSCRIPT ) , italic_e start_POSTSUPERSCRIPT italic_l italic_v end_POSTSUPERSCRIPT = roman_Linear start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_e start_POSTSUPERSCRIPT italic_t italic_r italic_m end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.2">In order to make the encoder output intention representation can be in the same feature space with the sequence representation so as to achieve contrastive learning, compared with the direct learning of the variance, the logarithmic variance avoids the extreme value problem that will occur in the variance, which has better stability, and also makes the optimization process of the model smoother due to the logarithmic transformation to reduce the sharp curvature of the parameter space. Where <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_μ</annotation></semantics></math> controls the center of the data distribution and <math alttext="\log(\sigma^{2})" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.2"><semantics id="S4.SS3.p3.2.m2.2a"><mrow id="S4.SS3.p3.2.m2.2.2.1" xref="S4.SS3.p3.2.m2.2.2.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">log</mi><mo id="S4.SS3.p3.2.m2.2.2.1a" xref="S4.SS3.p3.2.m2.2.2.2.cmml">⁡</mo><mrow id="S4.SS3.p3.2.m2.2.2.1.1" xref="S4.SS3.p3.2.m2.2.2.2.cmml"><mo id="S4.SS3.p3.2.m2.2.2.1.1.2" stretchy="false" xref="S4.SS3.p3.2.m2.2.2.2.cmml">(</mo><msup id="S4.SS3.p3.2.m2.2.2.1.1.1" xref="S4.SS3.p3.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS3.p3.2.m2.2.2.1.1.1.2" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2.cmml">σ</mi><mn id="S4.SS3.p3.2.m2.2.2.1.1.1.3" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS3.p3.2.m2.2.2.1.1.3" stretchy="false" xref="S4.SS3.p3.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.2b"><apply id="S4.SS3.p3.2.m2.2.2.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1"><log id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"></log><apply id="S4.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.1.2">𝜎</ci><cn id="S4.SS3.p3.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.2.2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.2c">\log(\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.2d">roman_log ( italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> constrains the dispersion of the data points, both of which together determine the latent intention in the space. The reparameterization trick is reflected in the sampling process:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\sigma=\sqrt{\exp\bigl{(}{\log(\sigma^{2})}\bigr{)}}," class="ltx_Math" display="block" id="S4.E20.m1.4"><semantics id="S4.E20.m1.4a"><mrow id="S4.E20.m1.4.4.1" xref="S4.E20.m1.4.4.1.1.cmml"><mrow id="S4.E20.m1.4.4.1.1" xref="S4.E20.m1.4.4.1.1.cmml"><mi id="S4.E20.m1.4.4.1.1.2" xref="S4.E20.m1.4.4.1.1.2.cmml">σ</mi><mo id="S4.E20.m1.4.4.1.1.1" xref="S4.E20.m1.4.4.1.1.1.cmml">=</mo><msqrt id="S4.E20.m1.3.3" xref="S4.E20.m1.3.3.cmml"><mrow id="S4.E20.m1.3.3.3.3" xref="S4.E20.m1.3.3.3.4.cmml"><mi id="S4.E20.m1.2.2.2.2" xref="S4.E20.m1.2.2.2.2.cmml">exp</mi><mo id="S4.E20.m1.3.3.3.3a" xref="S4.E20.m1.3.3.3.4.cmml">⁡</mo><mrow id="S4.E20.m1.3.3.3.3.1" xref="S4.E20.m1.3.3.3.4.cmml"><mo id="S4.E20.m1.3.3.3.3.1.2" maxsize="120%" minsize="120%" xref="S4.E20.m1.3.3.3.4.cmml">(</mo><mrow id="S4.E20.m1.3.3.3.3.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml"><mi id="S4.E20.m1.1.1.1.1" xref="S4.E20.m1.1.1.1.1.cmml">log</mi><mo id="S4.E20.m1.3.3.3.3.1.1.1a" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml">⁡</mo><mrow id="S4.E20.m1.3.3.3.3.1.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml"><mo id="S4.E20.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml">(</mo><msup id="S4.E20.m1.3.3.3.3.1.1.1.1.1" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E20.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1.2.cmml">σ</mi><mn id="S4.E20.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E20.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S4.E20.m1.3.3.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E20.m1.3.3.3.3.1.3" maxsize="120%" minsize="120%" xref="S4.E20.m1.3.3.3.4.cmml">)</mo></mrow></mrow></msqrt></mrow><mo id="S4.E20.m1.4.4.1.2" xref="S4.E20.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m1.4b"><apply id="S4.E20.m1.4.4.1.1.cmml" xref="S4.E20.m1.4.4.1"><eq id="S4.E20.m1.4.4.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1"></eq><ci id="S4.E20.m1.4.4.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.2">𝜎</ci><apply id="S4.E20.m1.3.3.cmml" xref="S4.E20.m1.3.3"><root id="S4.E20.m1.3.3a.cmml" xref="S4.E20.m1.3.3"></root><apply id="S4.E20.m1.3.3.3.4.cmml" xref="S4.E20.m1.3.3.3.3"><exp id="S4.E20.m1.2.2.2.2.cmml" xref="S4.E20.m1.2.2.2.2"></exp><apply id="S4.E20.m1.3.3.3.3.1.1.2.cmml" xref="S4.E20.m1.3.3.3.3.1.1.1"><log id="S4.E20.m1.1.1.1.1.cmml" xref="S4.E20.m1.1.1.1.1"></log><apply id="S4.E20.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E20.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1.2">𝜎</ci><cn id="S4.E20.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S4.E20.m1.3.3.3.3.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.4c">\sigma=\sqrt{\exp\bigl{(}{\log(\sigma^{2})}\bigr{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E20.m1.4d">italic_σ = square-root start_ARG roman_exp ( roman_log ( italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="z=\mu+\epsilon\cdot\sigma=\mu+\epsilon\cdot{\sqrt{\exp\bigl{(}{\log(\sigma^{2}%
)}\bigr{)}}}," class="ltx_Math" display="block" id="S4.E21.m1.4"><semantics id="S4.E21.m1.4a"><mrow id="S4.E21.m1.4.4.1" xref="S4.E21.m1.4.4.1.1.cmml"><mrow id="S4.E21.m1.4.4.1.1" xref="S4.E21.m1.4.4.1.1.cmml"><mi id="S4.E21.m1.4.4.1.1.2" xref="S4.E21.m1.4.4.1.1.2.cmml">z</mi><mo id="S4.E21.m1.4.4.1.1.3" xref="S4.E21.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E21.m1.4.4.1.1.4" xref="S4.E21.m1.4.4.1.1.4.cmml"><mi id="S4.E21.m1.4.4.1.1.4.2" xref="S4.E21.m1.4.4.1.1.4.2.cmml">μ</mi><mo id="S4.E21.m1.4.4.1.1.4.1" xref="S4.E21.m1.4.4.1.1.4.1.cmml">+</mo><mrow id="S4.E21.m1.4.4.1.1.4.3" xref="S4.E21.m1.4.4.1.1.4.3.cmml"><mi id="S4.E21.m1.4.4.1.1.4.3.2" xref="S4.E21.m1.4.4.1.1.4.3.2.cmml">ϵ</mi><mo id="S4.E21.m1.4.4.1.1.4.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E21.m1.4.4.1.1.4.3.1.cmml">⋅</mo><mi id="S4.E21.m1.4.4.1.1.4.3.3" xref="S4.E21.m1.4.4.1.1.4.3.3.cmml">σ</mi></mrow></mrow><mo id="S4.E21.m1.4.4.1.1.5" xref="S4.E21.m1.4.4.1.1.5.cmml">=</mo><mrow id="S4.E21.m1.4.4.1.1.6" xref="S4.E21.m1.4.4.1.1.6.cmml"><mi id="S4.E21.m1.4.4.1.1.6.2" xref="S4.E21.m1.4.4.1.1.6.2.cmml">μ</mi><mo id="S4.E21.m1.4.4.1.1.6.1" xref="S4.E21.m1.4.4.1.1.6.1.cmml">+</mo><mrow id="S4.E21.m1.4.4.1.1.6.3" xref="S4.E21.m1.4.4.1.1.6.3.cmml"><mi id="S4.E21.m1.4.4.1.1.6.3.2" xref="S4.E21.m1.4.4.1.1.6.3.2.cmml">ϵ</mi><mo id="S4.E21.m1.4.4.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E21.m1.4.4.1.1.6.3.1.cmml">⋅</mo><msqrt id="S4.E21.m1.3.3" xref="S4.E21.m1.3.3.cmml"><mrow id="S4.E21.m1.3.3.3.3" xref="S4.E21.m1.3.3.3.4.cmml"><mi id="S4.E21.m1.2.2.2.2" xref="S4.E21.m1.2.2.2.2.cmml">exp</mi><mo id="S4.E21.m1.3.3.3.3a" xref="S4.E21.m1.3.3.3.4.cmml">⁡</mo><mrow id="S4.E21.m1.3.3.3.3.1" xref="S4.E21.m1.3.3.3.4.cmml"><mo id="S4.E21.m1.3.3.3.3.1.2" maxsize="120%" minsize="120%" xref="S4.E21.m1.3.3.3.4.cmml">(</mo><mrow id="S4.E21.m1.3.3.3.3.1.1.1" xref="S4.E21.m1.3.3.3.3.1.1.2.cmml"><mi id="S4.E21.m1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.cmml">log</mi><mo id="S4.E21.m1.3.3.3.3.1.1.1a" xref="S4.E21.m1.3.3.3.3.1.1.2.cmml">⁡</mo><mrow id="S4.E21.m1.3.3.3.3.1.1.1.1" xref="S4.E21.m1.3.3.3.3.1.1.2.cmml"><mo id="S4.E21.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S4.E21.m1.3.3.3.3.1.1.2.cmml">(</mo><msup id="S4.E21.m1.3.3.3.3.1.1.1.1.1" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E21.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1.2.cmml">σ</mi><mn id="S4.E21.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E21.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S4.E21.m1.3.3.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.3.3.3.3.1.3" maxsize="120%" minsize="120%" xref="S4.E21.m1.3.3.3.4.cmml">)</mo></mrow></mrow></msqrt></mrow></mrow></mrow><mo id="S4.E21.m1.4.4.1.2" xref="S4.E21.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E21.m1.4b"><apply id="S4.E21.m1.4.4.1.1.cmml" xref="S4.E21.m1.4.4.1"><and id="S4.E21.m1.4.4.1.1a.cmml" xref="S4.E21.m1.4.4.1"></and><apply id="S4.E21.m1.4.4.1.1b.cmml" xref="S4.E21.m1.4.4.1"><eq id="S4.E21.m1.4.4.1.1.3.cmml" xref="S4.E21.m1.4.4.1.1.3"></eq><ci id="S4.E21.m1.4.4.1.1.2.cmml" xref="S4.E21.m1.4.4.1.1.2">𝑧</ci><apply id="S4.E21.m1.4.4.1.1.4.cmml" xref="S4.E21.m1.4.4.1.1.4"><plus id="S4.E21.m1.4.4.1.1.4.1.cmml" xref="S4.E21.m1.4.4.1.1.4.1"></plus><ci id="S4.E21.m1.4.4.1.1.4.2.cmml" xref="S4.E21.m1.4.4.1.1.4.2">𝜇</ci><apply id="S4.E21.m1.4.4.1.1.4.3.cmml" xref="S4.E21.m1.4.4.1.1.4.3"><ci id="S4.E21.m1.4.4.1.1.4.3.1.cmml" xref="S4.E21.m1.4.4.1.1.4.3.1">⋅</ci><ci id="S4.E21.m1.4.4.1.1.4.3.2.cmml" xref="S4.E21.m1.4.4.1.1.4.3.2">italic-ϵ</ci><ci id="S4.E21.m1.4.4.1.1.4.3.3.cmml" xref="S4.E21.m1.4.4.1.1.4.3.3">𝜎</ci></apply></apply></apply><apply id="S4.E21.m1.4.4.1.1c.cmml" xref="S4.E21.m1.4.4.1"><eq id="S4.E21.m1.4.4.1.1.5.cmml" xref="S4.E21.m1.4.4.1.1.5"></eq><share href="https://arxiv.org/html/2404.18214v2#S4.E21.m1.4.4.1.1.4.cmml" id="S4.E21.m1.4.4.1.1d.cmml" xref="S4.E21.m1.4.4.1"></share><apply id="S4.E21.m1.4.4.1.1.6.cmml" xref="S4.E21.m1.4.4.1.1.6"><plus id="S4.E21.m1.4.4.1.1.6.1.cmml" xref="S4.E21.m1.4.4.1.1.6.1"></plus><ci id="S4.E21.m1.4.4.1.1.6.2.cmml" xref="S4.E21.m1.4.4.1.1.6.2">𝜇</ci><apply id="S4.E21.m1.4.4.1.1.6.3.cmml" xref="S4.E21.m1.4.4.1.1.6.3"><ci id="S4.E21.m1.4.4.1.1.6.3.1.cmml" xref="S4.E21.m1.4.4.1.1.6.3.1">⋅</ci><ci id="S4.E21.m1.4.4.1.1.6.3.2.cmml" xref="S4.E21.m1.4.4.1.1.6.3.2">italic-ϵ</ci><apply id="S4.E21.m1.3.3.cmml" xref="S4.E21.m1.3.3"><root id="S4.E21.m1.3.3a.cmml" xref="S4.E21.m1.3.3"></root><apply id="S4.E21.m1.3.3.3.4.cmml" xref="S4.E21.m1.3.3.3.3"><exp id="S4.E21.m1.2.2.2.2.cmml" xref="S4.E21.m1.2.2.2.2"></exp><apply id="S4.E21.m1.3.3.3.3.1.1.2.cmml" xref="S4.E21.m1.3.3.3.3.1.1.1"><log id="S4.E21.m1.1.1.1.1.cmml" xref="S4.E21.m1.1.1.1.1"></log><apply id="S4.E21.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E21.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1.2">𝜎</ci><cn id="S4.E21.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S4.E21.m1.3.3.3.3.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.4c">z=\mu+\epsilon\cdot\sigma=\mu+\epsilon\cdot{\sqrt{\exp\bigl{(}{\log(\sigma^{2}%
)}\bigr{)}}},</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m1.4d">italic_z = italic_μ + italic_ϵ ⋅ italic_σ = italic_μ + italic_ϵ ⋅ square-root start_ARG roman_exp ( roman_log ( italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="e^{int}=e^{mu}+\epsilon\cdot\exp(\frac{e^{lv}}{2})," class="ltx_Math" display="block" id="S4.E22.m1.3"><semantics id="S4.E22.m1.3a"><mrow id="S4.E22.m1.3.3.1" xref="S4.E22.m1.3.3.1.1.cmml"><mrow id="S4.E22.m1.3.3.1.1" xref="S4.E22.m1.3.3.1.1.cmml"><msup id="S4.E22.m1.3.3.1.1.2" xref="S4.E22.m1.3.3.1.1.2.cmml"><mi id="S4.E22.m1.3.3.1.1.2.2" xref="S4.E22.m1.3.3.1.1.2.2.cmml">e</mi><mrow id="S4.E22.m1.3.3.1.1.2.3" xref="S4.E22.m1.3.3.1.1.2.3.cmml"><mi id="S4.E22.m1.3.3.1.1.2.3.2" xref="S4.E22.m1.3.3.1.1.2.3.2.cmml">i</mi><mo id="S4.E22.m1.3.3.1.1.2.3.1" xref="S4.E22.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E22.m1.3.3.1.1.2.3.3" xref="S4.E22.m1.3.3.1.1.2.3.3.cmml">n</mi><mo id="S4.E22.m1.3.3.1.1.2.3.1a" xref="S4.E22.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E22.m1.3.3.1.1.2.3.4" xref="S4.E22.m1.3.3.1.1.2.3.4.cmml">t</mi></mrow></msup><mo id="S4.E22.m1.3.3.1.1.1" xref="S4.E22.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E22.m1.3.3.1.1.3" xref="S4.E22.m1.3.3.1.1.3.cmml"><msup id="S4.E22.m1.3.3.1.1.3.2" xref="S4.E22.m1.3.3.1.1.3.2.cmml"><mi id="S4.E22.m1.3.3.1.1.3.2.2" xref="S4.E22.m1.3.3.1.1.3.2.2.cmml">e</mi><mrow id="S4.E22.m1.3.3.1.1.3.2.3" xref="S4.E22.m1.3.3.1.1.3.2.3.cmml"><mi id="S4.E22.m1.3.3.1.1.3.2.3.2" xref="S4.E22.m1.3.3.1.1.3.2.3.2.cmml">m</mi><mo id="S4.E22.m1.3.3.1.1.3.2.3.1" xref="S4.E22.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E22.m1.3.3.1.1.3.2.3.3" xref="S4.E22.m1.3.3.1.1.3.2.3.3.cmml">u</mi></mrow></msup><mo id="S4.E22.m1.3.3.1.1.3.1" xref="S4.E22.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S4.E22.m1.3.3.1.1.3.3" xref="S4.E22.m1.3.3.1.1.3.3.cmml"><mi id="S4.E22.m1.3.3.1.1.3.3.2" xref="S4.E22.m1.3.3.1.1.3.3.2.cmml">ϵ</mi><mo id="S4.E22.m1.3.3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E22.m1.3.3.1.1.3.3.1.cmml">⋅</mo><mrow id="S4.E22.m1.3.3.1.1.3.3.3.2" xref="S4.E22.m1.3.3.1.1.3.3.3.1.cmml"><mi id="S4.E22.m1.1.1" xref="S4.E22.m1.1.1.cmml">exp</mi><mo id="S4.E22.m1.3.3.1.1.3.3.3.2a" xref="S4.E22.m1.3.3.1.1.3.3.3.1.cmml">⁡</mo><mrow id="S4.E22.m1.3.3.1.1.3.3.3.2.1" xref="S4.E22.m1.3.3.1.1.3.3.3.1.cmml"><mo id="S4.E22.m1.3.3.1.1.3.3.3.2.1.1" stretchy="false" xref="S4.E22.m1.3.3.1.1.3.3.3.1.cmml">(</mo><mfrac id="S4.E22.m1.2.2" xref="S4.E22.m1.2.2.cmml"><msup id="S4.E22.m1.2.2.2" xref="S4.E22.m1.2.2.2.cmml"><mi id="S4.E22.m1.2.2.2.2" xref="S4.E22.m1.2.2.2.2.cmml">e</mi><mrow id="S4.E22.m1.2.2.2.3" xref="S4.E22.m1.2.2.2.3.cmml"><mi id="S4.E22.m1.2.2.2.3.2" xref="S4.E22.m1.2.2.2.3.2.cmml">l</mi><mo id="S4.E22.m1.2.2.2.3.1" xref="S4.E22.m1.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E22.m1.2.2.2.3.3" xref="S4.E22.m1.2.2.2.3.3.cmml">v</mi></mrow></msup><mn id="S4.E22.m1.2.2.3" xref="S4.E22.m1.2.2.3.cmml">2</mn></mfrac><mo id="S4.E22.m1.3.3.1.1.3.3.3.2.1.2" stretchy="false" xref="S4.E22.m1.3.3.1.1.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E22.m1.3.3.1.2" xref="S4.E22.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E22.m1.3b"><apply id="S4.E22.m1.3.3.1.1.cmml" xref="S4.E22.m1.3.3.1"><eq id="S4.E22.m1.3.3.1.1.1.cmml" xref="S4.E22.m1.3.3.1.1.1"></eq><apply id="S4.E22.m1.3.3.1.1.2.cmml" xref="S4.E22.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2">superscript</csymbol><ci id="S4.E22.m1.3.3.1.1.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2">𝑒</ci><apply id="S4.E22.m1.3.3.1.1.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.3"><times id="S4.E22.m1.3.3.1.1.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.2.3.1"></times><ci id="S4.E22.m1.3.3.1.1.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.2.3.2">𝑖</ci><ci id="S4.E22.m1.3.3.1.1.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.2.3.3">𝑛</ci><ci id="S4.E22.m1.3.3.1.1.2.3.4.cmml" xref="S4.E22.m1.3.3.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S4.E22.m1.3.3.1.1.3.cmml" xref="S4.E22.m1.3.3.1.1.3"><plus id="S4.E22.m1.3.3.1.1.3.1.cmml" xref="S4.E22.m1.3.3.1.1.3.1"></plus><apply id="S4.E22.m1.3.3.1.1.3.2.cmml" xref="S4.E22.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.3.2.1.cmml" xref="S4.E22.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S4.E22.m1.3.3.1.1.3.2.2.cmml" xref="S4.E22.m1.3.3.1.1.3.2.2">𝑒</ci><apply id="S4.E22.m1.3.3.1.1.3.2.3.cmml" xref="S4.E22.m1.3.3.1.1.3.2.3"><times id="S4.E22.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.3.2.3.1"></times><ci id="S4.E22.m1.3.3.1.1.3.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.3.2.3.2">𝑚</ci><ci id="S4.E22.m1.3.3.1.1.3.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.3.2.3.3">𝑢</ci></apply></apply><apply id="S4.E22.m1.3.3.1.1.3.3.cmml" xref="S4.E22.m1.3.3.1.1.3.3"><ci id="S4.E22.m1.3.3.1.1.3.3.1.cmml" xref="S4.E22.m1.3.3.1.1.3.3.1">⋅</ci><ci id="S4.E22.m1.3.3.1.1.3.3.2.cmml" xref="S4.E22.m1.3.3.1.1.3.3.2">italic-ϵ</ci><apply id="S4.E22.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E22.m1.3.3.1.1.3.3.3.2"><exp id="S4.E22.m1.1.1.cmml" xref="S4.E22.m1.1.1"></exp><apply id="S4.E22.m1.2.2.cmml" xref="S4.E22.m1.2.2"><divide id="S4.E22.m1.2.2.1.cmml" xref="S4.E22.m1.2.2"></divide><apply id="S4.E22.m1.2.2.2.cmml" xref="S4.E22.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E22.m1.2.2.2.1.cmml" xref="S4.E22.m1.2.2.2">superscript</csymbol><ci id="S4.E22.m1.2.2.2.2.cmml" xref="S4.E22.m1.2.2.2.2">𝑒</ci><apply id="S4.E22.m1.2.2.2.3.cmml" xref="S4.E22.m1.2.2.2.3"><times id="S4.E22.m1.2.2.2.3.1.cmml" xref="S4.E22.m1.2.2.2.3.1"></times><ci id="S4.E22.m1.2.2.2.3.2.cmml" xref="S4.E22.m1.2.2.2.3.2">𝑙</ci><ci id="S4.E22.m1.2.2.2.3.3.cmml" xref="S4.E22.m1.2.2.2.3.3">𝑣</ci></apply></apply><cn id="S4.E22.m1.2.2.3.cmml" type="integer" xref="S4.E22.m1.2.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m1.3c">e^{int}=e^{mu}+\epsilon\cdot\exp(\frac{e^{lv}}{2}),</annotation><annotation encoding="application/x-llamapun" id="S4.E22.m1.3d">italic_e start_POSTSUPERSCRIPT italic_i italic_n italic_t end_POSTSUPERSCRIPT = italic_e start_POSTSUPERSCRIPT italic_m italic_u end_POSTSUPERSCRIPT + italic_ϵ ⋅ roman_exp ( divide start_ARG italic_e start_POSTSUPERSCRIPT italic_l italic_v end_POSTSUPERSCRIPT end_ARG start_ARG 2 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.9">where Eq.(22) is the feature calculation of Eq.(21), <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_σ</annotation></semantics></math> is the standard deviation, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_ϵ</annotation></semantics></math> is the Gaussian noise shaped like <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">italic_σ</annotation></semantics></math> sampled from the standard normal distribution <math alttext="\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.2"><semantics id="S4.SS3.p4.4.m4.2a"><mrow id="S4.SS3.p4.4.m4.2.3" xref="S4.SS3.p4.4.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p4.4.m4.2.3.2" xref="S4.SS3.p4.4.m4.2.3.2.cmml">𝒩</mi><mo id="S4.SS3.p4.4.m4.2.3.1" xref="S4.SS3.p4.4.m4.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p4.4.m4.2.3.3.2" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml"><mo id="S4.SS3.p4.4.m4.2.3.3.2.1" stretchy="false" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">0</mn><mo id="S4.SS3.p4.4.m4.2.3.3.2.2" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p4.4.m4.2.2" xref="S4.SS3.p4.4.m4.2.2.cmml">1</mn><mo id="S4.SS3.p4.4.m4.2.3.3.2.3" stretchy="false" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.2b"><apply id="S4.SS3.p4.4.m4.2.3.cmml" xref="S4.SS3.p4.4.m4.2.3"><times id="S4.SS3.p4.4.m4.2.3.1.cmml" xref="S4.SS3.p4.4.m4.2.3.1"></times><ci id="S4.SS3.p4.4.m4.2.3.2.cmml" xref="S4.SS3.p4.4.m4.2.3.2">𝒩</ci><interval closure="open" id="S4.SS3.p4.4.m4.2.3.3.1.cmml" xref="S4.SS3.p4.4.m4.2.3.3.2"><cn id="S4.SS3.p4.4.m4.1.1.cmml" type="integer" xref="S4.SS3.p4.4.m4.1.1">0</cn><cn id="S4.SS3.p4.4.m4.2.2.cmml" type="integer" xref="S4.SS3.p4.4.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.2c">\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.2d">caligraphic_N ( 0 , 1 )</annotation></semantics></math>. The randomly sampled Gaussian noise allows the VAE to learn that <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.1"><semantics id="S4.SS3.p4.5.m5.1a"><mi id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.1b"><ci id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.1d">italic_μ</annotation></semantics></math> and <math alttext="\log(\sigma^{2})" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m6.2"><semantics id="S4.SS3.p4.6.m6.2a"><mrow id="S4.SS3.p4.6.m6.2.2.1" xref="S4.SS3.p4.6.m6.2.2.2.cmml"><mi id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml">log</mi><mo id="S4.SS3.p4.6.m6.2.2.1a" xref="S4.SS3.p4.6.m6.2.2.2.cmml">⁡</mo><mrow id="S4.SS3.p4.6.m6.2.2.1.1" xref="S4.SS3.p4.6.m6.2.2.2.cmml"><mo id="S4.SS3.p4.6.m6.2.2.1.1.2" stretchy="false" xref="S4.SS3.p4.6.m6.2.2.2.cmml">(</mo><msup id="S4.SS3.p4.6.m6.2.2.1.1.1" xref="S4.SS3.p4.6.m6.2.2.1.1.1.cmml"><mi id="S4.SS3.p4.6.m6.2.2.1.1.1.2" xref="S4.SS3.p4.6.m6.2.2.1.1.1.2.cmml">σ</mi><mn id="S4.SS3.p4.6.m6.2.2.1.1.1.3" xref="S4.SS3.p4.6.m6.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.SS3.p4.6.m6.2.2.1.1.3" stretchy="false" xref="S4.SS3.p4.6.m6.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.2b"><apply id="S4.SS3.p4.6.m6.2.2.2.cmml" xref="S4.SS3.p4.6.m6.2.2.1"><log id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1"></log><apply id="S4.SS3.p4.6.m6.2.2.1.1.1.cmml" xref="S4.SS3.p4.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS3.p4.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.p4.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS3.p4.6.m6.2.2.1.1.1.2">𝜎</ci><cn id="S4.SS3.p4.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p4.6.m6.2.2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.2c">\log(\sigma^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m6.2d">roman_log ( italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> bring the original sample distribution close to <math alttext="\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.SS3.p4.7.m7.2"><semantics id="S4.SS3.p4.7.m7.2a"><mrow id="S4.SS3.p4.7.m7.2.3" xref="S4.SS3.p4.7.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p4.7.m7.2.3.2" xref="S4.SS3.p4.7.m7.2.3.2.cmml">𝒩</mi><mo id="S4.SS3.p4.7.m7.2.3.1" xref="S4.SS3.p4.7.m7.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p4.7.m7.2.3.3.2" xref="S4.SS3.p4.7.m7.2.3.3.1.cmml"><mo id="S4.SS3.p4.7.m7.2.3.3.2.1" stretchy="false" xref="S4.SS3.p4.7.m7.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p4.7.m7.1.1" xref="S4.SS3.p4.7.m7.1.1.cmml">0</mn><mo id="S4.SS3.p4.7.m7.2.3.3.2.2" xref="S4.SS3.p4.7.m7.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p4.7.m7.2.2" xref="S4.SS3.p4.7.m7.2.2.cmml">1</mn><mo id="S4.SS3.p4.7.m7.2.3.3.2.3" stretchy="false" xref="S4.SS3.p4.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m7.2b"><apply id="S4.SS3.p4.7.m7.2.3.cmml" xref="S4.SS3.p4.7.m7.2.3"><times id="S4.SS3.p4.7.m7.2.3.1.cmml" xref="S4.SS3.p4.7.m7.2.3.1"></times><ci id="S4.SS3.p4.7.m7.2.3.2.cmml" xref="S4.SS3.p4.7.m7.2.3.2">𝒩</ci><interval closure="open" id="S4.SS3.p4.7.m7.2.3.3.1.cmml" xref="S4.SS3.p4.7.m7.2.3.3.2"><cn id="S4.SS3.p4.7.m7.1.1.cmml" type="integer" xref="S4.SS3.p4.7.m7.1.1">0</cn><cn id="S4.SS3.p4.7.m7.2.2.cmml" type="integer" xref="S4.SS3.p4.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m7.2c">\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.7.m7.2d">caligraphic_N ( 0 , 1 )</annotation></semantics></math> as a prior distribution. <math alttext="\epsilon\cdot\sigma" class="ltx_Math" display="inline" id="S4.SS3.p4.8.m8.1"><semantics id="S4.SS3.p4.8.m8.1a"><mrow id="S4.SS3.p4.8.m8.1.1" xref="S4.SS3.p4.8.m8.1.1.cmml"><mi id="S4.SS3.p4.8.m8.1.1.2" xref="S4.SS3.p4.8.m8.1.1.2.cmml">ϵ</mi><mo id="S4.SS3.p4.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p4.8.m8.1.1.1.cmml">⋅</mo><mi id="S4.SS3.p4.8.m8.1.1.3" xref="S4.SS3.p4.8.m8.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.8.m8.1b"><apply id="S4.SS3.p4.8.m8.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1"><ci id="S4.SS3.p4.8.m8.1.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1.1">⋅</ci><ci id="S4.SS3.p4.8.m8.1.1.2.cmml" xref="S4.SS3.p4.8.m8.1.1.2">italic-ϵ</ci><ci id="S4.SS3.p4.8.m8.1.1.3.cmml" xref="S4.SS3.p4.8.m8.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.8.m8.1c">\epsilon\cdot\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.8.m8.1d">italic_ϵ ⋅ italic_σ</annotation></semantics></math> allows the random sampling process to be differentiable, which allows the model to be optimized by the training methods of backpropagation and gradient descent, the computation which essentially scales <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS3.p4.9.m9.1"><semantics id="S4.SS3.p4.9.m9.1a"><mi id="S4.SS3.p4.9.m9.1.1" xref="S4.SS3.p4.9.m9.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.9.m9.1b"><ci id="S4.SS3.p4.9.m9.1.1.cmml" xref="S4.SS3.p4.9.m9.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.9.m9.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.9.m9.1d">italic_ϵ</annotation></semantics></math> so that it has the encoder output’s variance and also ensures the differentiability of the sampling step.</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.2">The VAE in MIDCL retains only the encoder and discards the reconstruction works of the decoder, so the part of the loss function abandons the reconstruction loss, and only the KLD is used as a measure of the difference between the distribution of the latent variable and the sampling source <math alttext="\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.2"><semantics id="S4.SS3.p5.1.m1.2a"><mrow id="S4.SS3.p5.1.m1.2.3" xref="S4.SS3.p5.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.2.3.2" xref="S4.SS3.p5.1.m1.2.3.2.cmml">𝒩</mi><mo id="S4.SS3.p5.1.m1.2.3.1" xref="S4.SS3.p5.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p5.1.m1.2.3.3.2" xref="S4.SS3.p5.1.m1.2.3.3.1.cmml"><mo id="S4.SS3.p5.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p5.1.m1.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.p5.1.m1.2.3.3.2.2" xref="S4.SS3.p5.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p5.1.m1.2.2" xref="S4.SS3.p5.1.m1.2.2.cmml">1</mn><mo id="S4.SS3.p5.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS3.p5.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.2b"><apply id="S4.SS3.p5.1.m1.2.3.cmml" xref="S4.SS3.p5.1.m1.2.3"><times id="S4.SS3.p5.1.m1.2.3.1.cmml" xref="S4.SS3.p5.1.m1.2.3.1"></times><ci id="S4.SS3.p5.1.m1.2.3.2.cmml" xref="S4.SS3.p5.1.m1.2.3.2">𝒩</ci><interval closure="open" id="S4.SS3.p5.1.m1.2.3.3.1.cmml" xref="S4.SS3.p5.1.m1.2.3.3.2"><cn id="S4.SS3.p5.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p5.1.m1.1.1">0</cn><cn id="S4.SS3.p5.1.m1.2.2.cmml" type="integer" xref="S4.SS3.p5.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.2c">\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.2d">caligraphic_N ( 0 , 1 )</annotation></semantics></math> of <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1"><semantics id="S4.SS3.p5.2.m2.1a"><mi id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><ci id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.2.m2.1d">italic_ϵ</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{KL}=-\frac{1}{2}\sum_{i=1}^{k}\bigl{(}1+\log(\sigma_{i}^{2})-\mu_%
{i}^{2}-\sigma_{i}^{2}\bigr{)}." class="ltx_Math" display="block" id="S4.E23.m1.2"><semantics id="S4.E23.m1.2a"><mrow id="S4.E23.m1.2.2.1" xref="S4.E23.m1.2.2.1.1.cmml"><mrow id="S4.E23.m1.2.2.1.1" xref="S4.E23.m1.2.2.1.1.cmml"><msub id="S4.E23.m1.2.2.1.1.3" xref="S4.E23.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.2.2.1.1.3.2" xref="S4.E23.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E23.m1.2.2.1.1.3.3" xref="S4.E23.m1.2.2.1.1.3.3.cmml"><mi id="S4.E23.m1.2.2.1.1.3.3.2" xref="S4.E23.m1.2.2.1.1.3.3.2.cmml">K</mi><mo id="S4.E23.m1.2.2.1.1.3.3.1" xref="S4.E23.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E23.m1.2.2.1.1.3.3.3" xref="S4.E23.m1.2.2.1.1.3.3.3.cmml">L</mi></mrow></msub><mo id="S4.E23.m1.2.2.1.1.2" xref="S4.E23.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E23.m1.2.2.1.1.1" xref="S4.E23.m1.2.2.1.1.1.cmml"><mo id="S4.E23.m1.2.2.1.1.1a" xref="S4.E23.m1.2.2.1.1.1.cmml">−</mo><mrow id="S4.E23.m1.2.2.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.cmml"><mfrac id="S4.E23.m1.2.2.1.1.1.1.3" xref="S4.E23.m1.2.2.1.1.1.1.3.cmml"><mn id="S4.E23.m1.2.2.1.1.1.1.3.2" xref="S4.E23.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mn id="S4.E23.m1.2.2.1.1.1.1.3.3" xref="S4.E23.m1.2.2.1.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S4.E23.m1.2.2.1.1.1.1.2" xref="S4.E23.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E23.m1.2.2.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.cmml"><munderover id="S4.E23.m1.2.2.1.1.1.1.1.2" xref="S4.E23.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E23.m1.2.2.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.2" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.1" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.3" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E23.m1.2.2.1.1.1.1.1.2.3" xref="S4.E23.m1.2.2.1.1.1.1.1.2.3.cmml">k</mi></munderover><mrow id="S4.E23.m1.2.2.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E23.m1.1.1" xref="S4.E23.m1.1.1.cmml">log</mi><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">σ</mi><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msubsup><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2a" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml">σ</mi><mi id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml">i</mi><mn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.3" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml">2</mn></msubsup></mrow><mo id="S4.E23.m1.2.2.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E23.m1.2.2.1.2" lspace="0em" xref="S4.E23.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E23.m1.2b"><apply id="S4.E23.m1.2.2.1.1.cmml" xref="S4.E23.m1.2.2.1"><eq id="S4.E23.m1.2.2.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.2"></eq><apply id="S4.E23.m1.2.2.1.1.3.cmml" xref="S4.E23.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.3.1.cmml" xref="S4.E23.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E23.m1.2.2.1.1.3.2.cmml" xref="S4.E23.m1.2.2.1.1.3.2">ℒ</ci><apply id="S4.E23.m1.2.2.1.1.3.3.cmml" xref="S4.E23.m1.2.2.1.1.3.3"><times id="S4.E23.m1.2.2.1.1.3.3.1.cmml" xref="S4.E23.m1.2.2.1.1.3.3.1"></times><ci id="S4.E23.m1.2.2.1.1.3.3.2.cmml" xref="S4.E23.m1.2.2.1.1.3.3.2">𝐾</ci><ci id="S4.E23.m1.2.2.1.1.3.3.3.cmml" xref="S4.E23.m1.2.2.1.1.3.3.3">𝐿</ci></apply></apply><apply id="S4.E23.m1.2.2.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1"><minus id="S4.E23.m1.2.2.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1"></minus><apply id="S4.E23.m1.2.2.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1"><times id="S4.E23.m1.2.2.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.2"></times><apply id="S4.E23.m1.2.2.1.1.1.1.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.3"><divide id="S4.E23.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.3"></divide><cn id="S4.E23.m1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.3.2">1</cn><cn id="S4.E23.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.3.3">2</cn></apply><apply id="S4.E23.m1.2.2.1.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1"><apply id="S4.E23.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E23.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E23.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.2"></sum><apply id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3"><eq id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E23.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1"><minus id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.2"></minus><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1"><plus id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.2"></plus><cn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><log id="S4.E23.m1.1.1.cmml" xref="S4.E23.m1.1.1"></log><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝜎</ci><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">𝜇</ci><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><cn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.2">𝜎</ci><ci id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><cn id="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml" type="integer" xref="S4.E23.m1.2.2.1.1.1.1.1.1.1.1.4.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m1.2c">\mathcal{L}_{KL}=-\frac{1}{2}\sum_{i=1}^{k}\bigl{(}1+\log(\sigma_{i}^{2})-\mu_%
{i}^{2}-\sigma_{i}^{2}\bigr{)}.</annotation><annotation encoding="application/x-llamapun" id="S4.E23.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( 1 + roman_log ( italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) - italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.1">The discarded reconstruction loss will remain in the overall optimization content of the model as part of the prediction outcome loss and intention contrastive learning. The process of minimizing the loss function enables the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">italic_k</annotation></semantics></math>-dimensional latent intentions learned and disentangled by VAE to be more independent and less entangled for the next step of contrastive learning.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Contrastive Learning Layer</h3>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span><span class="ltx_text ltx_font_bold" id="S4.SS4.SSS1.1.1">Intention-based Contrastive Learning</span>
</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.6">The contrastive learning of intentions is optimized using the Triplet loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib44" title="">44</a>]</cite> function to optimize the learning process of VAE. The anchor point is the sequence feature <math alttext="e_{s}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.1.m1.1"><semantics id="S4.SS4.SSS1.p1.1.m1.1a"><msubsup id="S4.SS4.SSS1.p1.1.m1.1.1" xref="S4.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS1.p1.1.m1.1.1.2.2" xref="S4.SS4.SSS1.p1.1.m1.1.1.2.2.cmml">e</mi><mi id="S4.SS4.SSS1.p1.1.m1.1.1.2.3" xref="S4.SS4.SSS1.p1.1.m1.1.1.2.3.cmml">s</mi><mi id="S4.SS4.SSS1.p1.1.m1.1.1.3" xref="S4.SS4.SSS1.p1.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.1.m1.1b"><apply id="S4.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1.2.2">𝑒</ci><ci id="S4.SS4.SSS1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1.2.3">𝑠</ci></apply><ci id="S4.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.1.m1.1c">e_{s}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="u" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.2.m2.1"><semantics id="S4.SS4.SSS1.p1.2.m2.1a"><mi id="S4.SS4.SSS1.p1.2.m2.1.1" xref="S4.SS4.SSS1.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.2.m2.1b"><ci id="S4.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.2.m2.1d">italic_u</annotation></semantics></math>, the positive sample is the intention <math alttext="I_{pos}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.3.m3.1"><semantics id="S4.SS4.SSS1.p1.3.m3.1a"><msubsup id="S4.SS4.SSS1.p1.3.m3.1.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.2.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.2.cmml">I</mi><mrow id="S4.SS4.SSS1.p1.3.m3.1.1.2.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.2" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.2.cmml">p</mi><mo id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.3.cmml">o</mi><mo id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1a" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.4" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.4.cmml">s</mi></mrow><mi id="S4.SS4.SSS1.p1.3.m3.1.1.3" xref="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.3.m3.1b"><apply id="S4.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.2">𝐼</ci><apply id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3"><times id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.1"></times><ci id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.2">𝑝</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.3">𝑜</ci><ci id="S4.SS4.SSS1.p1.3.m3.1.1.2.3.4.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S4.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS1.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.3.m3.1c">I_{pos}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> with the highest similarity to <math alttext="e_{s}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.4.m4.1"><semantics id="S4.SS4.SSS1.p1.4.m4.1a"><msubsup id="S4.SS4.SSS1.p1.4.m4.1.1" xref="S4.SS4.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS4.SSS1.p1.4.m4.1.1.2.2" xref="S4.SS4.SSS1.p1.4.m4.1.1.2.2.cmml">e</mi><mi id="S4.SS4.SSS1.p1.4.m4.1.1.2.3" xref="S4.SS4.SSS1.p1.4.m4.1.1.2.3.cmml">s</mi><mi id="S4.SS4.SSS1.p1.4.m4.1.1.3" xref="S4.SS4.SSS1.p1.4.m4.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.4.m4.1b"><apply id="S4.SS4.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1">superscript</csymbol><apply id="S4.SS4.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1.2.2">𝑒</ci><ci id="S4.SS4.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1.2.3">𝑠</ci></apply><ci id="S4.SS4.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS4.SSS1.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.4.m4.1c">e_{s}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, and the negative sample is the intention <math alttext="I_{neg}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.5.m5.1"><semantics id="S4.SS4.SSS1.p1.5.m5.1a"><msubsup id="S4.SS4.SSS1.p1.5.m5.1.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.2.cmml">I</mi><mrow id="S4.SS4.SSS1.p1.5.m5.1.1.2.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2.cmml">n</mi><mo id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3.cmml">e</mi><mo id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1a" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.4" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.4.cmml">g</mi></mrow><mi id="S4.SS4.SSS1.p1.5.m5.1.1.3" xref="S4.SS4.SSS1.p1.5.m5.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.5.m5.1b"><apply id="S4.SS4.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1">superscript</csymbol><apply id="S4.SS4.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.2">𝐼</ci><apply id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3"><times id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.1"></times><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.2">𝑛</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.3">𝑒</ci><ci id="S4.SS4.SSS1.p1.5.m5.1.1.2.3.4.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS4.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS4.SSS1.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.5.m5.1c">I_{neg}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.5.m5.1d">italic_I start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> with the lowest similarity to <math alttext="e_{s}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.6.m6.1"><semantics id="S4.SS4.SSS1.p1.6.m6.1a"><msubsup id="S4.SS4.SSS1.p1.6.m6.1.1" xref="S4.SS4.SSS1.p1.6.m6.1.1.cmml"><mi id="S4.SS4.SSS1.p1.6.m6.1.1.2.2" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.2.cmml">e</mi><mi id="S4.SS4.SSS1.p1.6.m6.1.1.2.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.3.cmml">s</mi><mi id="S4.SS4.SSS1.p1.6.m6.1.1.3" xref="S4.SS4.SSS1.p1.6.m6.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.6.m6.1b"><apply id="S4.SS4.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS4.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.2">𝑒</ci><ci id="S4.SS4.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.2.3">𝑠</ci></apply><ci id="S4.SS4.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS4.SSS1.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.6.m6.1c">e_{s}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.6.m6.1d">italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}I_{pos}^{u}=\mathrm{arg\,max}\bigl{(}sim(e_{s}^{u},e^{int})\bigr{%
)},\\
I_{neg}^{u}=\mathrm{arg\,min}\bigl{(}sim(e_{s}^{u},e^{int})\bigr{)},\end{split}" class="ltx_Math" display="block" id="S4.E24.m1.43"><semantics id="S4.E24.m1.43a"><mtable displaystyle="true" id="S4.E24.m1.43.43.3" rowspacing="0pt"><mtr id="S4.E24.m1.43.43.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E24.m1.43.43.3b"><mrow id="S4.E24.m1.42.42.2.41.21.21.21"><mrow id="S4.E24.m1.42.42.2.41.21.21.21.1"><msubsup id="S4.E24.m1.42.42.2.41.21.21.21.1.2"><mi id="S4.E24.m1.1.1.1.1.1.1" xref="S4.E24.m1.1.1.1.1.1.1.cmml">I</mi><mrow id="S4.E24.m1.2.2.2.2.2.2.1" xref="S4.E24.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E24.m1.2.2.2.2.2.2.1.2" xref="S4.E24.m1.2.2.2.2.2.2.1.2.cmml">p</mi><mo id="S4.E24.m1.2.2.2.2.2.2.1.1" xref="S4.E24.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E24.m1.2.2.2.2.2.2.1.3" xref="S4.E24.m1.2.2.2.2.2.2.1.3.cmml">o</mi><mo id="S4.E24.m1.2.2.2.2.2.2.1.1a" xref="S4.E24.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E24.m1.2.2.2.2.2.2.1.4" xref="S4.E24.m1.2.2.2.2.2.2.1.4.cmml">s</mi></mrow><mi id="S4.E24.m1.3.3.3.3.3.3.1" xref="S4.E24.m1.3.3.3.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E24.m1.4.4.4.4.4.4" xref="S4.E24.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S4.E24.m1.42.42.2.41.21.21.21.1.1"><mi id="S4.E24.m1.5.5.5.5.5.5" xref="S4.E24.m1.5.5.5.5.5.5.cmml">arg</mi><mo id="S4.E24.m1.42.42.2.41.21.21.21.1.1.2" lspace="0.170em">⁢</mo><mi id="S4.E24.m1.6.6.6.6.6.6" xref="S4.E24.m1.6.6.6.6.6.6.cmml">max</mi><mo id="S4.E24.m1.42.42.2.41.21.21.21.1.1.2a">⁢</mo><mrow id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1"><mo id="S4.E24.m1.7.7.7.7.7.7" maxsize="120%" minsize="120%">(</mo><mrow id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1"><mi id="S4.E24.m1.8.8.8.8.8.8" xref="S4.E24.m1.8.8.8.8.8.8.cmml">s</mi><mo id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.3">⁢</mo><mi id="S4.E24.m1.9.9.9.9.9.9" xref="S4.E24.m1.9.9.9.9.9.9.cmml">i</mi><mo id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.3a">⁢</mo><mi id="S4.E24.m1.10.10.10.10.10.10" xref="S4.E24.m1.10.10.10.10.10.10.cmml">m</mi><mo id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.3b">⁢</mo><mrow id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.2.2"><mo id="S4.E24.m1.11.11.11.11.11.11" stretchy="false">(</mo><msubsup id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.1.1.1"><mi id="S4.E24.m1.12.12.12.12.12.12" xref="S4.E24.m1.12.12.12.12.12.12.cmml">e</mi><mi id="S4.E24.m1.13.13.13.13.13.13.1" xref="S4.E24.m1.13.13.13.13.13.13.1.cmml">s</mi><mi id="S4.E24.m1.14.14.14.14.14.14.1" xref="S4.E24.m1.14.14.14.14.14.14.1.cmml">u</mi></msubsup><mo id="S4.E24.m1.15.15.15.15.15.15">,</mo><msup id="S4.E24.m1.42.42.2.41.21.21.21.1.1.1.1.1.2.2.2"><mi id="S4.E24.m1.16.16.16.16.16.16" xref="S4.E24.m1.16.16.16.16.16.16.cmml">e</mi><mrow id="S4.E24.m1.17.17.17.17.17.17.1" xref="S4.E24.m1.17.17.17.17.17.17.1.cmml"><mi id="S4.E24.m1.17.17.17.17.17.17.1.2" xref="S4.E24.m1.17.17.17.17.17.17.1.2.cmml">i</mi><mo id="S4.E24.m1.17.17.17.17.17.17.1.1" xref="S4.E24.m1.17.17.17.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E24.m1.17.17.17.17.17.17.1.3" xref="S4.E24.m1.17.17.17.17.17.17.1.3.cmml">n</mi><mo id="S4.E24.m1.17.17.17.17.17.17.1.1a" xref="S4.E24.m1.17.17.17.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E24.m1.17.17.17.17.17.17.1.4" xref="S4.E24.m1.17.17.17.17.17.17.1.4.cmml">t</mi></mrow></msup><mo id="S4.E24.m1.18.18.18.18.18.18" stretchy="false">)</mo></mrow></mrow><mo id="S4.E24.m1.19.19.19.19.19.19" maxsize="120%" minsize="120%">)</mo></mrow></mrow></mrow><mo id="S4.E24.m1.20.20.20.20.20.20">,</mo></mrow></mtd></mtr><mtr id="S4.E24.m1.43.43.3c"><mtd class="ltx_align_right" columnalign="right" id="S4.E24.m1.43.43.3d"><mrow id="S4.E24.m1.43.43.3.42.21.21.21"><mrow id="S4.E24.m1.43.43.3.42.21.21.21.1"><msubsup id="S4.E24.m1.43.43.3.42.21.21.21.1.2"><mi id="S4.E24.m1.21.21.21.1.1.1" xref="S4.E24.m1.21.21.21.1.1.1.cmml">I</mi><mrow id="S4.E24.m1.22.22.22.2.2.2.1" xref="S4.E24.m1.22.22.22.2.2.2.1.cmml"><mi id="S4.E24.m1.22.22.22.2.2.2.1.2" xref="S4.E24.m1.22.22.22.2.2.2.1.2.cmml">n</mi><mo id="S4.E24.m1.22.22.22.2.2.2.1.1" xref="S4.E24.m1.22.22.22.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E24.m1.22.22.22.2.2.2.1.3" xref="S4.E24.m1.22.22.22.2.2.2.1.3.cmml">e</mi><mo id="S4.E24.m1.22.22.22.2.2.2.1.1a" xref="S4.E24.m1.22.22.22.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E24.m1.22.22.22.2.2.2.1.4" xref="S4.E24.m1.22.22.22.2.2.2.1.4.cmml">g</mi></mrow><mi id="S4.E24.m1.23.23.23.3.3.3.1" xref="S4.E24.m1.23.23.23.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E24.m1.24.24.24.4.4.4" xref="S4.E24.m1.24.24.24.4.4.4.cmml">=</mo><mrow id="S4.E24.m1.43.43.3.42.21.21.21.1.1"><mi id="S4.E24.m1.25.25.25.5.5.5" xref="S4.E24.m1.25.25.25.5.5.5.cmml">arg</mi><mo id="S4.E24.m1.43.43.3.42.21.21.21.1.1.2" lspace="0.170em">⁢</mo><mi id="S4.E24.m1.26.26.26.6.6.6" xref="S4.E24.m1.26.26.26.6.6.6.cmml">min</mi><mo id="S4.E24.m1.43.43.3.42.21.21.21.1.1.2a">⁢</mo><mrow id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1"><mo id="S4.E24.m1.27.27.27.7.7.7" maxsize="120%" minsize="120%">(</mo><mrow id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1"><mi id="S4.E24.m1.28.28.28.8.8.8" xref="S4.E24.m1.28.28.28.8.8.8.cmml">s</mi><mo id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.3">⁢</mo><mi id="S4.E24.m1.29.29.29.9.9.9" xref="S4.E24.m1.29.29.29.9.9.9.cmml">i</mi><mo id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.3a">⁢</mo><mi id="S4.E24.m1.30.30.30.10.10.10" xref="S4.E24.m1.30.30.30.10.10.10.cmml">m</mi><mo id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.3b">⁢</mo><mrow id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.2.2"><mo id="S4.E24.m1.31.31.31.11.11.11" stretchy="false">(</mo><msubsup id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.1.1.1"><mi id="S4.E24.m1.32.32.32.12.12.12" xref="S4.E24.m1.32.32.32.12.12.12.cmml">e</mi><mi id="S4.E24.m1.33.33.33.13.13.13.1" xref="S4.E24.m1.33.33.33.13.13.13.1.cmml">s</mi><mi id="S4.E24.m1.34.34.34.14.14.14.1" xref="S4.E24.m1.34.34.34.14.14.14.1.cmml">u</mi></msubsup><mo id="S4.E24.m1.35.35.35.15.15.15">,</mo><msup id="S4.E24.m1.43.43.3.42.21.21.21.1.1.1.1.1.2.2.2"><mi id="S4.E24.m1.36.36.36.16.16.16" xref="S4.E24.m1.36.36.36.16.16.16.cmml">e</mi><mrow id="S4.E24.m1.37.37.37.17.17.17.1" xref="S4.E24.m1.37.37.37.17.17.17.1.cmml"><mi id="S4.E24.m1.37.37.37.17.17.17.1.2" xref="S4.E24.m1.37.37.37.17.17.17.1.2.cmml">i</mi><mo id="S4.E24.m1.37.37.37.17.17.17.1.1" xref="S4.E24.m1.37.37.37.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E24.m1.37.37.37.17.17.17.1.3" xref="S4.E24.m1.37.37.37.17.17.17.1.3.cmml">n</mi><mo id="S4.E24.m1.37.37.37.17.17.17.1.1a" xref="S4.E24.m1.37.37.37.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E24.m1.37.37.37.17.17.17.1.4" xref="S4.E24.m1.37.37.37.17.17.17.1.4.cmml">t</mi></mrow></msup><mo id="S4.E24.m1.38.38.38.18.18.18" stretchy="false">)</mo></mrow></mrow><mo id="S4.E24.m1.39.39.39.19.19.19" maxsize="120%" minsize="120%">)</mo></mrow></mrow></mrow><mo id="S4.E24.m1.40.40.40.20.20.20">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E24.m1.43b"><apply id="S4.E24.m1.41.41.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E24.m1.41.41.1.1.1.1.1.cmml"><eq id="S4.E24.m1.4.4.4.4.4.4.cmml" xref="S4.E24.m1.4.4.4.4.4.4"></eq><apply id="S4.E24.m1.41.41.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.1.1.3.1.cmml">superscript</csymbol><apply id="S4.E24.m1.41.41.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E24.m1.1.1.1.1.1.1.cmml" xref="S4.E24.m1.1.1.1.1.1.1">𝐼</ci><apply id="S4.E24.m1.2.2.2.2.2.2.1.cmml" xref="S4.E24.m1.2.2.2.2.2.2.1"><times id="S4.E24.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E24.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E24.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E24.m1.2.2.2.2.2.2.1.2">𝑝</ci><ci id="S4.E24.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E24.m1.2.2.2.2.2.2.1.3">𝑜</ci><ci id="S4.E24.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E24.m1.2.2.2.2.2.2.1.4">𝑠</ci></apply></apply><ci id="S4.E24.m1.3.3.3.3.3.3.1.cmml" xref="S4.E24.m1.3.3.3.3.3.3.1">𝑢</ci></apply><apply id="S4.E24.m1.41.41.1.1.1.1.1.1.cmml"><times id="S4.E24.m1.41.41.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E24.m1.5.5.5.5.5.5.cmml" xref="S4.E24.m1.5.5.5.5.5.5">arg</ci><ci id="S4.E24.m1.6.6.6.6.6.6.cmml" xref="S4.E24.m1.6.6.6.6.6.6">max</ci><apply id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.cmml"><times id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.3.cmml"></times><ci id="S4.E24.m1.8.8.8.8.8.8.cmml" xref="S4.E24.m1.8.8.8.8.8.8">𝑠</ci><ci id="S4.E24.m1.9.9.9.9.9.9.cmml" xref="S4.E24.m1.9.9.9.9.9.9">𝑖</ci><ci id="S4.E24.m1.10.10.10.10.10.10.cmml" xref="S4.E24.m1.10.10.10.10.10.10">𝑚</ci><interval closure="open" id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.2.3.cmml"><apply id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E24.m1.12.12.12.12.12.12.cmml" xref="S4.E24.m1.12.12.12.12.12.12">𝑒</ci><ci id="S4.E24.m1.13.13.13.13.13.13.1.cmml" xref="S4.E24.m1.13.13.13.13.13.13.1">𝑠</ci></apply><ci id="S4.E24.m1.14.14.14.14.14.14.1.cmml" xref="S4.E24.m1.14.14.14.14.14.14.1">𝑢</ci></apply><apply id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">superscript</csymbol><ci id="S4.E24.m1.16.16.16.16.16.16.cmml" xref="S4.E24.m1.16.16.16.16.16.16">𝑒</ci><apply id="S4.E24.m1.17.17.17.17.17.17.1.cmml" xref="S4.E24.m1.17.17.17.17.17.17.1"><times id="S4.E24.m1.17.17.17.17.17.17.1.1.cmml" xref="S4.E24.m1.17.17.17.17.17.17.1.1"></times><ci id="S4.E24.m1.17.17.17.17.17.17.1.2.cmml" xref="S4.E24.m1.17.17.17.17.17.17.1.2">𝑖</ci><ci id="S4.E24.m1.17.17.17.17.17.17.1.3.cmml" xref="S4.E24.m1.17.17.17.17.17.17.1.3">𝑛</ci><ci id="S4.E24.m1.17.17.17.17.17.17.1.4.cmml" xref="S4.E24.m1.17.17.17.17.17.17.1.4">𝑡</ci></apply></apply></interval></apply></apply></apply><apply id="S4.E24.m1.41.41.1.1.1.2.2.cmml"><eq id="S4.E24.m1.24.24.24.4.4.4.cmml" xref="S4.E24.m1.24.24.24.4.4.4"></eq><apply id="S4.E24.m1.41.41.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.2.2.3.1.cmml">superscript</csymbol><apply id="S4.E24.m1.41.41.1.1.1.2.2.3.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.2.2.3.2.1.cmml">subscript</csymbol><ci id="S4.E24.m1.21.21.21.1.1.1.cmml" xref="S4.E24.m1.21.21.21.1.1.1">𝐼</ci><apply id="S4.E24.m1.22.22.22.2.2.2.1.cmml" xref="S4.E24.m1.22.22.22.2.2.2.1"><times id="S4.E24.m1.22.22.22.2.2.2.1.1.cmml" xref="S4.E24.m1.22.22.22.2.2.2.1.1"></times><ci id="S4.E24.m1.22.22.22.2.2.2.1.2.cmml" xref="S4.E24.m1.22.22.22.2.2.2.1.2">𝑛</ci><ci id="S4.E24.m1.22.22.22.2.2.2.1.3.cmml" xref="S4.E24.m1.22.22.22.2.2.2.1.3">𝑒</ci><ci id="S4.E24.m1.22.22.22.2.2.2.1.4.cmml" xref="S4.E24.m1.22.22.22.2.2.2.1.4">𝑔</ci></apply></apply><ci id="S4.E24.m1.23.23.23.3.3.3.1.cmml" xref="S4.E24.m1.23.23.23.3.3.3.1">𝑢</ci></apply><apply id="S4.E24.m1.41.41.1.1.1.2.2.1.cmml"><times id="S4.E24.m1.41.41.1.1.1.2.2.1.2.cmml"></times><ci id="S4.E24.m1.25.25.25.5.5.5.cmml" xref="S4.E24.m1.25.25.25.5.5.5">arg</ci><ci id="S4.E24.m1.26.26.26.6.6.6.cmml" xref="S4.E24.m1.26.26.26.6.6.6">min</ci><apply id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.cmml"><times id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.3.cmml"></times><ci id="S4.E24.m1.28.28.28.8.8.8.cmml" xref="S4.E24.m1.28.28.28.8.8.8">𝑠</ci><ci id="S4.E24.m1.29.29.29.9.9.9.cmml" xref="S4.E24.m1.29.29.29.9.9.9">𝑖</ci><ci id="S4.E24.m1.30.30.30.10.10.10.cmml" xref="S4.E24.m1.30.30.30.10.10.10">𝑚</ci><interval closure="open" id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.2.3.cmml"><apply id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E24.m1.32.32.32.12.12.12.cmml" xref="S4.E24.m1.32.32.32.12.12.12">𝑒</ci><ci id="S4.E24.m1.33.33.33.13.13.13.1.cmml" xref="S4.E24.m1.33.33.33.13.13.13.1">𝑠</ci></apply><ci id="S4.E24.m1.34.34.34.14.14.14.1.cmml" xref="S4.E24.m1.34.34.34.14.14.14.1">𝑢</ci></apply><apply id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E24.m1.41.41.1.1.1.2.2.1.1.1.1.2.2.2.1.cmml">superscript</csymbol><ci id="S4.E24.m1.36.36.36.16.16.16.cmml" xref="S4.E24.m1.36.36.36.16.16.16">𝑒</ci><apply id="S4.E24.m1.37.37.37.17.17.17.1.cmml" xref="S4.E24.m1.37.37.37.17.17.17.1"><times id="S4.E24.m1.37.37.37.17.17.17.1.1.cmml" xref="S4.E24.m1.37.37.37.17.17.17.1.1"></times><ci id="S4.E24.m1.37.37.37.17.17.17.1.2.cmml" xref="S4.E24.m1.37.37.37.17.17.17.1.2">𝑖</ci><ci id="S4.E24.m1.37.37.37.17.17.17.1.3.cmml" xref="S4.E24.m1.37.37.37.17.17.17.1.3">𝑛</ci><ci id="S4.E24.m1.37.37.37.17.17.17.1.4.cmml" xref="S4.E24.m1.37.37.37.17.17.17.1.4">𝑡</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E24.m1.43c">\begin{split}I_{pos}^{u}=\mathrm{arg\,max}\bigl{(}sim(e_{s}^{u},e^{int})\bigr{%
)},\\
I_{neg}^{u}=\mathrm{arg\,min}\bigl{(}sim(e_{s}^{u},e^{int})\bigr{)},\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E24.m1.43d">start_ROW start_CELL italic_I start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_arg roman_max ( italic_s italic_i italic_m ( italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUPERSCRIPT italic_i italic_n italic_t end_POSTSUPERSCRIPT ) ) , end_CELL end_ROW start_ROW start_CELL italic_I start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_arg roman_min ( italic_s italic_i italic_m ( italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUPERSCRIPT italic_i italic_n italic_t end_POSTSUPERSCRIPT ) ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS1.p2">
<p class="ltx_p" id="S4.SS4.SSS1.p2.1">where the intentions of positive and negative samples are derived from the similarity matrix of sequence features and intention features, and are extracted by index, the found positive and negative samples are used to construct the loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{TRI}=\sum_{u=1}^{N}\bigl{[}\|{e_{s}^{u}-I_{pos}^{u}}\|_{2}^{2}-\|%
{e_{s}^{u}-I_{neg}^{u}}\|_{2}^{2}+\xi\bigr{]}_{+}," class="ltx_Math" display="block" id="S4.E25.m1.1"><semantics id="S4.E25.m1.1a"><mrow id="S4.E25.m1.1.1.1" xref="S4.E25.m1.1.1.1.1.cmml"><mrow id="S4.E25.m1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.cmml"><msub id="S4.E25.m1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E25.m1.1.1.1.1.3.2" xref="S4.E25.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E25.m1.1.1.1.1.3.3" xref="S4.E25.m1.1.1.1.1.3.3.cmml"><mi id="S4.E25.m1.1.1.1.1.3.3.2" xref="S4.E25.m1.1.1.1.1.3.3.2.cmml">T</mi><mo id="S4.E25.m1.1.1.1.1.3.3.1" xref="S4.E25.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.3.3.3" xref="S4.E25.m1.1.1.1.1.3.3.3.cmml">R</mi><mo id="S4.E25.m1.1.1.1.1.3.3.1a" xref="S4.E25.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.3.3.4" xref="S4.E25.m1.1.1.1.1.3.3.4.cmml">I</mi></mrow></msub><mo id="S4.E25.m1.1.1.1.1.2" rspace="0.111em" xref="S4.E25.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E25.m1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.cmml"><munderover id="S4.E25.m1.1.1.1.1.1.2" xref="S4.E25.m1.1.1.1.1.1.2.cmml"><mo id="S4.E25.m1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E25.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E25.m1.1.1.1.1.1.2.2.3" xref="S4.E25.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E25.m1.1.1.1.1.1.2.2.3.2" xref="S4.E25.m1.1.1.1.1.1.2.2.3.2.cmml">u</mi><mo id="S4.E25.m1.1.1.1.1.1.2.2.3.1" xref="S4.E25.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E25.m1.1.1.1.1.1.2.2.3.3" xref="S4.E25.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E25.m1.1.1.1.1.1.2.3" xref="S4.E25.m1.1.1.1.1.1.2.3.cmml">N</mi></munderover><msub id="S4.E25.m1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E25.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">o</mi><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">−</mo><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml"><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.2" stretchy="false" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.2.cmml">e</mi><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.3.cmml">s</mi><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.cmml"><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.2" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.2.cmml">n</mi><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1a" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.4" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.4.cmml">g</mi></mrow><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.3" stretchy="false" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.3.cmml">2</mn><mn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mi id="S4.E25.m1.1.1.1.1.1.1.1.1.1.4" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.4.cmml">ξ</mi></mrow><mo id="S4.E25.m1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E25.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S4.E25.m1.1.1.1.1.1.1.3" xref="S4.E25.m1.1.1.1.1.1.1.3.cmml">+</mo></msub></mrow></mrow><mo id="S4.E25.m1.1.1.1.2" xref="S4.E25.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E25.m1.1b"><apply id="S4.E25.m1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1"><eq id="S4.E25.m1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.2"></eq><apply id="S4.E25.m1.1.1.1.1.3.cmml" xref="S4.E25.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.3.1.cmml" xref="S4.E25.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E25.m1.1.1.1.1.3.2.cmml" xref="S4.E25.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E25.m1.1.1.1.1.3.3.cmml" xref="S4.E25.m1.1.1.1.1.3.3"><times id="S4.E25.m1.1.1.1.1.3.3.1.cmml" xref="S4.E25.m1.1.1.1.1.3.3.1"></times><ci id="S4.E25.m1.1.1.1.1.3.3.2.cmml" xref="S4.E25.m1.1.1.1.1.3.3.2">𝑇</ci><ci id="S4.E25.m1.1.1.1.1.3.3.3.cmml" xref="S4.E25.m1.1.1.1.1.3.3.3">𝑅</ci><ci id="S4.E25.m1.1.1.1.1.3.3.4.cmml" xref="S4.E25.m1.1.1.1.1.3.3.4">𝐼</ci></apply></apply><apply id="S4.E25.m1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1"><apply id="S4.E25.m1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E25.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E25.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.2.2.3"><eq id="S4.E25.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E25.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E25.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E25.m1.1.1.1.1.1.2.2.3.2">𝑢</ci><cn id="S4.E25.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E25.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E25.m1.1.1.1.1.1.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E25.m1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E25.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1"><plus id="S4.E25.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.3"></plus><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2"><minus id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.3"></minus><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑒</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply><cn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1"><minus id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.1"></minus><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.2">𝑒</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.2.3">𝑢</ci></apply><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3">superscript</csymbol><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.2">𝐼</ci><apply id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3"><times id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.1"></times><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.2">𝑛</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.3">𝑒</ci><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.4.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.2.3.4">𝑔</ci></apply></apply><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.1.3.3">𝑢</ci></apply></apply></apply><cn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.3.cmml" type="integer" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.1.3">2</cn></apply><cn id="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.2.2.3">2</cn></apply></apply><ci id="S4.E25.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E25.m1.1.1.1.1.1.1.1.1.1.4">𝜉</ci></apply></apply><plus id="S4.E25.m1.1.1.1.1.1.1.3.cmml" xref="S4.E25.m1.1.1.1.1.1.1.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E25.m1.1c">\mathcal{L}_{TRI}=\sum_{u=1}^{N}\bigl{[}\|{e_{s}^{u}-I_{pos}^{u}}\|_{2}^{2}-\|%
{e_{s}^{u}-I_{neg}^{u}}\|_{2}^{2}+\xi\bigr{]}_{+},</annotation><annotation encoding="application/x-llamapun" id="S4.E25.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_T italic_R italic_I end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_u = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ ∥ italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT - italic_I start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∥ italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT - italic_I start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ξ ] start_POSTSUBSCRIPT + end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS1.p3">
<p class="ltx_p" id="S4.SS4.SSS1.p3.2">where <math alttext="\xi" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p3.1.m1.1"><semantics id="S4.SS4.SSS1.p3.1.m1.1a"><mi id="S4.SS4.SSS1.p3.1.m1.1.1" xref="S4.SS4.SSS1.p3.1.m1.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p3.1.m1.1b"><ci id="S4.SS4.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p3.1.m1.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p3.1.m1.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p3.1.m1.1d">italic_ξ</annotation></semantics></math> is the hyperparameter used to constrain the minimum distance between positive and negative samples. Eq.(25) expects to bring the anchor point as close as possible to the distance between positive samples and as far away from the distance between negative samples, as a way of mitigating the noise-negative optimization that invalid intentions associated with the current user may bring to the final representation of the intention. Since the spacing between positive and negative samples may be less than <math alttext="\xi" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p3.2.m2.1"><semantics id="S4.SS4.SSS1.p3.2.m2.1a"><mi id="S4.SS4.SSS1.p3.2.m2.1.1" xref="S4.SS4.SSS1.p3.2.m2.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p3.2.m2.1b"><ci id="S4.SS4.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p3.2.m2.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p3.2.m2.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p3.2.m2.1d">italic_ξ</annotation></semantics></math>, the result of Eq.(25) always takes a non-negative value. Combining this with the KLD from above yields an overall loss in VAE:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E26">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{VAE}=\mathcal{L}_{KL}+\mathcal{L}_{TRI}." class="ltx_Math" display="block" id="S4.E26.m1.1"><semantics id="S4.E26.m1.1a"><mrow id="S4.E26.m1.1.1.1" xref="S4.E26.m1.1.1.1.1.cmml"><mrow id="S4.E26.m1.1.1.1.1" xref="S4.E26.m1.1.1.1.1.cmml"><msub id="S4.E26.m1.1.1.1.1.2" xref="S4.E26.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E26.m1.1.1.1.1.2.2" xref="S4.E26.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E26.m1.1.1.1.1.2.3" xref="S4.E26.m1.1.1.1.1.2.3.cmml"><mi id="S4.E26.m1.1.1.1.1.2.3.2" xref="S4.E26.m1.1.1.1.1.2.3.2.cmml">V</mi><mo id="S4.E26.m1.1.1.1.1.2.3.1" xref="S4.E26.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E26.m1.1.1.1.1.2.3.3" xref="S4.E26.m1.1.1.1.1.2.3.3.cmml">A</mi><mo id="S4.E26.m1.1.1.1.1.2.3.1a" xref="S4.E26.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E26.m1.1.1.1.1.2.3.4" xref="S4.E26.m1.1.1.1.1.2.3.4.cmml">E</mi></mrow></msub><mo id="S4.E26.m1.1.1.1.1.1" xref="S4.E26.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E26.m1.1.1.1.1.3" xref="S4.E26.m1.1.1.1.1.3.cmml"><msub id="S4.E26.m1.1.1.1.1.3.2" xref="S4.E26.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E26.m1.1.1.1.1.3.2.2" xref="S4.E26.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.E26.m1.1.1.1.1.3.2.3" xref="S4.E26.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E26.m1.1.1.1.1.3.2.3.2" xref="S4.E26.m1.1.1.1.1.3.2.3.2.cmml">K</mi><mo id="S4.E26.m1.1.1.1.1.3.2.3.1" xref="S4.E26.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E26.m1.1.1.1.1.3.2.3.3" xref="S4.E26.m1.1.1.1.1.3.2.3.3.cmml">L</mi></mrow></msub><mo id="S4.E26.m1.1.1.1.1.3.1" xref="S4.E26.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S4.E26.m1.1.1.1.1.3.3" xref="S4.E26.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E26.m1.1.1.1.1.3.3.2" xref="S4.E26.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E26.m1.1.1.1.1.3.3.3" xref="S4.E26.m1.1.1.1.1.3.3.3.cmml"><mi id="S4.E26.m1.1.1.1.1.3.3.3.2" xref="S4.E26.m1.1.1.1.1.3.3.3.2.cmml">T</mi><mo id="S4.E26.m1.1.1.1.1.3.3.3.1" xref="S4.E26.m1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E26.m1.1.1.1.1.3.3.3.3" xref="S4.E26.m1.1.1.1.1.3.3.3.3.cmml">R</mi><mo id="S4.E26.m1.1.1.1.1.3.3.3.1a" xref="S4.E26.m1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E26.m1.1.1.1.1.3.3.3.4" xref="S4.E26.m1.1.1.1.1.3.3.3.4.cmml">I</mi></mrow></msub></mrow></mrow><mo id="S4.E26.m1.1.1.1.2" lspace="0em" xref="S4.E26.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E26.m1.1b"><apply id="S4.E26.m1.1.1.1.1.cmml" xref="S4.E26.m1.1.1.1"><eq id="S4.E26.m1.1.1.1.1.1.cmml" xref="S4.E26.m1.1.1.1.1.1"></eq><apply id="S4.E26.m1.1.1.1.1.2.cmml" xref="S4.E26.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.1.1.2.1.cmml" xref="S4.E26.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E26.m1.1.1.1.1.2.2.cmml" xref="S4.E26.m1.1.1.1.1.2.2">ℒ</ci><apply id="S4.E26.m1.1.1.1.1.2.3.cmml" xref="S4.E26.m1.1.1.1.1.2.3"><times id="S4.E26.m1.1.1.1.1.2.3.1.cmml" xref="S4.E26.m1.1.1.1.1.2.3.1"></times><ci id="S4.E26.m1.1.1.1.1.2.3.2.cmml" xref="S4.E26.m1.1.1.1.1.2.3.2">𝑉</ci><ci id="S4.E26.m1.1.1.1.1.2.3.3.cmml" xref="S4.E26.m1.1.1.1.1.2.3.3">𝐴</ci><ci id="S4.E26.m1.1.1.1.1.2.3.4.cmml" xref="S4.E26.m1.1.1.1.1.2.3.4">𝐸</ci></apply></apply><apply id="S4.E26.m1.1.1.1.1.3.cmml" xref="S4.E26.m1.1.1.1.1.3"><plus id="S4.E26.m1.1.1.1.1.3.1.cmml" xref="S4.E26.m1.1.1.1.1.3.1"></plus><apply id="S4.E26.m1.1.1.1.1.3.2.cmml" xref="S4.E26.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.1.1.3.2.1.cmml" xref="S4.E26.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E26.m1.1.1.1.1.3.2.2.cmml" xref="S4.E26.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S4.E26.m1.1.1.1.1.3.2.3.cmml" xref="S4.E26.m1.1.1.1.1.3.2.3"><times id="S4.E26.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E26.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E26.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E26.m1.1.1.1.1.3.2.3.2">𝐾</ci><ci id="S4.E26.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E26.m1.1.1.1.1.3.2.3.3">𝐿</ci></apply></apply><apply id="S4.E26.m1.1.1.1.1.3.3.cmml" xref="S4.E26.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E26.m1.1.1.1.1.3.3.1.cmml" xref="S4.E26.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E26.m1.1.1.1.1.3.3.2.cmml" xref="S4.E26.m1.1.1.1.1.3.3.2">ℒ</ci><apply id="S4.E26.m1.1.1.1.1.3.3.3.cmml" xref="S4.E26.m1.1.1.1.1.3.3.3"><times id="S4.E26.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E26.m1.1.1.1.1.3.3.3.1"></times><ci id="S4.E26.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E26.m1.1.1.1.1.3.3.3.2">𝑇</ci><ci id="S4.E26.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E26.m1.1.1.1.1.3.3.3.3">𝑅</ci><ci id="S4.E26.m1.1.1.1.1.3.3.3.4.cmml" xref="S4.E26.m1.1.1.1.1.3.3.3.4">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E26.m1.1c">\mathcal{L}_{VAE}=\mathcal{L}_{KL}+\mathcal{L}_{TRI}.</annotation><annotation encoding="application/x-llamapun" id="S4.E26.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_V italic_A italic_E end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_T italic_R italic_I end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span><span class="ltx_text ltx_font_bold" id="S4.SS4.SSS2.1.1">Sequence-based Contrastive Learning</span>
</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">Reference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib33" title="">33</a>]</cite>, three stochastic enhancement operators and two informative enhancement operators are introduced into the augmented operator called <math alttext="AO" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.1.m1.1"><semantics id="S4.SS4.SSS2.p1.1.m1.1a"><mrow id="S4.SS4.SSS2.p1.1.m1.1.1" xref="S4.SS4.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.1.1.2" xref="S4.SS4.SSS2.p1.1.m1.1.1.2.cmml">A</mi><mo id="S4.SS4.SSS2.p1.1.m1.1.1.1" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.1.m1.1.1.3" xref="S4.SS4.SSS2.p1.1.m1.1.1.3.cmml">O</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.1.m1.1b"><apply id="S4.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1"><times id="S4.SS4.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1"></times><ci id="S4.SS4.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.2">𝐴</ci><ci id="S4.SS4.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.1.m1.1c">AO</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.1.m1.1d">italic_A italic_O</annotation></semantics></math> to provide positive and negative samples for contrastive learning. In order to ensure that the tail items have an effect on the sequence coding, we will not make any enhancements to the last item.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p2">
<p class="ltx_p" id="S4.SS4.SSS2.p2.1">(1) <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS2.p2.1.1">Stochastic Augmentation Operator</span>.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS2.p3">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.2.1">Crop</span>:
Remove a portion of elements in the input sequence, typically a continuous segment of the sequence. By cropping, the model needs to learn to make inferences in the missing part, thus improving the understanding of the local structure of the sequence. The length of the cropping is controlled by the parameter <math alttext="\gamma_{c}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">γ</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝛾</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\gamma_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and the position of the cropping is determined by the parameter <math alttext="c" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_c</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;L_{c}=\lfloor{\gamma_{c}\times|H^{u}|}\rfloor,\\
&amp;H_{Crop}^{u}=[H_{c}^{u},\dots,H_{c+1}^{u},\dots,H_{c+L_{c}-1}^{u}],\\
&amp;AO_{Crop}(H^{u})=H^{u}-H_{Crop}^{u}.\end{split}" class="ltx_Math" display="block" id="S4.E27.m1.54"><semantics id="S4.E27.m1.54a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E27.m1.54.54.4" rowspacing="0pt"><mtr id="S4.E27.m1.54.54.4a"><mtd id="S4.E27.m1.54.54.4b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E27.m1.54.54.4c"><mrow id="S4.E27.m1.52.52.2.51.14.14.14"><mrow id="S4.E27.m1.52.52.2.51.14.14.14.1"><msub id="S4.E27.m1.52.52.2.51.14.14.14.1.2"><mi id="S4.E27.m1.1.1.1.1.1.1" xref="S4.E27.m1.1.1.1.1.1.1.cmml">L</mi><mi id="S4.E27.m1.2.2.2.2.2.2.1" xref="S4.E27.m1.2.2.2.2.2.2.1.cmml">c</mi></msub><mo id="S4.E27.m1.3.3.3.3.3.3" xref="S4.E27.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E27.m1.52.52.2.51.14.14.14.1.1.1"><mo id="S4.E27.m1.4.4.4.4.4.4" stretchy="false">⌊</mo><mrow id="S4.E27.m1.52.52.2.51.14.14.14.1.1.1.1"><msub id="S4.E27.m1.52.52.2.51.14.14.14.1.1.1.1.2"><mi id="S4.E27.m1.5.5.5.5.5.5" xref="S4.E27.m1.5.5.5.5.5.5.cmml">γ</mi><mi id="S4.E27.m1.6.6.6.6.6.6.1" xref="S4.E27.m1.6.6.6.6.6.6.1.cmml">c</mi></msub><mo id="S4.E27.m1.7.7.7.7.7.7" lspace="0.222em" rspace="0.222em" xref="S4.E27.m1.7.7.7.7.7.7.cmml">×</mo><mrow id="S4.E27.m1.52.52.2.51.14.14.14.1.1.1.1.1.1"><mo id="S4.E27.m1.8.8.8.8.8.8" stretchy="false">|</mo><msup id="S4.E27.m1.52.52.2.51.14.14.14.1.1.1.1.1.1.1"><mi id="S4.E27.m1.9.9.9.9.9.9" xref="S4.E27.m1.9.9.9.9.9.9.cmml">H</mi><mi id="S4.E27.m1.10.10.10.10.10.10.1" xref="S4.E27.m1.10.10.10.10.10.10.1.cmml">u</mi></msup><mo id="S4.E27.m1.11.11.11.11.11.11" stretchy="false">|</mo></mrow></mrow><mo id="S4.E27.m1.12.12.12.12.12.12" stretchy="false">⌋</mo></mrow></mrow><mo id="S4.E27.m1.13.13.13.13.13.13">,</mo></mrow></mtd></mtr><mtr id="S4.E27.m1.54.54.4d"><mtd id="S4.E27.m1.54.54.4e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E27.m1.54.54.4f"><mrow id="S4.E27.m1.53.53.3.52.23.23.23"><mrow id="S4.E27.m1.53.53.3.52.23.23.23.1"><msubsup id="S4.E27.m1.53.53.3.52.23.23.23.1.4"><mi id="S4.E27.m1.14.14.14.1.1.1" xref="S4.E27.m1.14.14.14.1.1.1.cmml">H</mi><mrow id="S4.E27.m1.15.15.15.2.2.2.1" xref="S4.E27.m1.15.15.15.2.2.2.1.cmml"><mi id="S4.E27.m1.15.15.15.2.2.2.1.2" xref="S4.E27.m1.15.15.15.2.2.2.1.2.cmml">C</mi><mo id="S4.E27.m1.15.15.15.2.2.2.1.1" xref="S4.E27.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E27.m1.15.15.15.2.2.2.1.3" xref="S4.E27.m1.15.15.15.2.2.2.1.3.cmml">r</mi><mo id="S4.E27.m1.15.15.15.2.2.2.1.1a" xref="S4.E27.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E27.m1.15.15.15.2.2.2.1.4" xref="S4.E27.m1.15.15.15.2.2.2.1.4.cmml">o</mi><mo id="S4.E27.m1.15.15.15.2.2.2.1.1b" xref="S4.E27.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E27.m1.15.15.15.2.2.2.1.5" xref="S4.E27.m1.15.15.15.2.2.2.1.5.cmml">p</mi></mrow><mi id="S4.E27.m1.16.16.16.3.3.3.1" xref="S4.E27.m1.16.16.16.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E27.m1.17.17.17.4.4.4" xref="S4.E27.m1.17.17.17.4.4.4.cmml">=</mo><mrow id="S4.E27.m1.53.53.3.52.23.23.23.1.3.3"><mo id="S4.E27.m1.18.18.18.5.5.5" stretchy="false">[</mo><msubsup id="S4.E27.m1.53.53.3.52.23.23.23.1.1.1.1"><mi id="S4.E27.m1.19.19.19.6.6.6" xref="S4.E27.m1.19.19.19.6.6.6.cmml">H</mi><mi id="S4.E27.m1.20.20.20.7.7.7.1" xref="S4.E27.m1.20.20.20.7.7.7.1.cmml">c</mi><mi id="S4.E27.m1.21.21.21.8.8.8.1" xref="S4.E27.m1.21.21.21.8.8.8.1.cmml">u</mi></msubsup><mo id="S4.E27.m1.22.22.22.9.9.9">,</mo><mi id="S4.E27.m1.23.23.23.10.10.10" mathvariant="normal" xref="S4.E27.m1.23.23.23.10.10.10.cmml">…</mi><mo id="S4.E27.m1.24.24.24.11.11.11">,</mo><msubsup id="S4.E27.m1.53.53.3.52.23.23.23.1.2.2.2"><mi id="S4.E27.m1.25.25.25.12.12.12" xref="S4.E27.m1.25.25.25.12.12.12.cmml">H</mi><mrow id="S4.E27.m1.26.26.26.13.13.13.1" xref="S4.E27.m1.26.26.26.13.13.13.1.cmml"><mi id="S4.E27.m1.26.26.26.13.13.13.1.2" xref="S4.E27.m1.26.26.26.13.13.13.1.2.cmml">c</mi><mo id="S4.E27.m1.26.26.26.13.13.13.1.1" xref="S4.E27.m1.26.26.26.13.13.13.1.1.cmml">+</mo><mn id="S4.E27.m1.26.26.26.13.13.13.1.3" xref="S4.E27.m1.26.26.26.13.13.13.1.3.cmml">1</mn></mrow><mi id="S4.E27.m1.27.27.27.14.14.14.1" xref="S4.E27.m1.27.27.27.14.14.14.1.cmml">u</mi></msubsup><mo id="S4.E27.m1.28.28.28.15.15.15">,</mo><mi id="S4.E27.m1.29.29.29.16.16.16" mathvariant="normal" xref="S4.E27.m1.29.29.29.16.16.16.cmml">…</mi><mo id="S4.E27.m1.30.30.30.17.17.17">,</mo><msubsup id="S4.E27.m1.53.53.3.52.23.23.23.1.3.3.3"><mi id="S4.E27.m1.31.31.31.18.18.18" xref="S4.E27.m1.31.31.31.18.18.18.cmml">H</mi><mrow id="S4.E27.m1.32.32.32.19.19.19.1" xref="S4.E27.m1.32.32.32.19.19.19.1.cmml"><mrow id="S4.E27.m1.32.32.32.19.19.19.1.2" xref="S4.E27.m1.32.32.32.19.19.19.1.2.cmml"><mi id="S4.E27.m1.32.32.32.19.19.19.1.2.2" xref="S4.E27.m1.32.32.32.19.19.19.1.2.2.cmml">c</mi><mo id="S4.E27.m1.32.32.32.19.19.19.1.2.1" xref="S4.E27.m1.32.32.32.19.19.19.1.2.1.cmml">+</mo><msub id="S4.E27.m1.32.32.32.19.19.19.1.2.3" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3.cmml"><mi id="S4.E27.m1.32.32.32.19.19.19.1.2.3.2" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3.2.cmml">L</mi><mi id="S4.E27.m1.32.32.32.19.19.19.1.2.3.3" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3.3.cmml">c</mi></msub></mrow><mo id="S4.E27.m1.32.32.32.19.19.19.1.1" xref="S4.E27.m1.32.32.32.19.19.19.1.1.cmml">−</mo><mn id="S4.E27.m1.32.32.32.19.19.19.1.3" xref="S4.E27.m1.32.32.32.19.19.19.1.3.cmml">1</mn></mrow><mi id="S4.E27.m1.33.33.33.20.20.20.1" xref="S4.E27.m1.33.33.33.20.20.20.1.cmml">u</mi></msubsup><mo id="S4.E27.m1.34.34.34.21.21.21" stretchy="false">]</mo></mrow></mrow><mo id="S4.E27.m1.35.35.35.22.22.22">,</mo></mrow></mtd></mtr><mtr id="S4.E27.m1.54.54.4g"><mtd id="S4.E27.m1.54.54.4h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E27.m1.54.54.4i"><mrow id="S4.E27.m1.54.54.4.53.16.16.16"><mrow id="S4.E27.m1.54.54.4.53.16.16.16.1"><mrow id="S4.E27.m1.54.54.4.53.16.16.16.1.1"><mi id="S4.E27.m1.36.36.36.1.1.1" xref="S4.E27.m1.36.36.36.1.1.1.cmml">A</mi><mo id="S4.E27.m1.54.54.4.53.16.16.16.1.1.2">⁢</mo><msub id="S4.E27.m1.54.54.4.53.16.16.16.1.1.3"><mi id="S4.E27.m1.37.37.37.2.2.2" xref="S4.E27.m1.37.37.37.2.2.2.cmml">O</mi><mrow id="S4.E27.m1.38.38.38.3.3.3.1" xref="S4.E27.m1.38.38.38.3.3.3.1.cmml"><mi id="S4.E27.m1.38.38.38.3.3.3.1.2" xref="S4.E27.m1.38.38.38.3.3.3.1.2.cmml">C</mi><mo id="S4.E27.m1.38.38.38.3.3.3.1.1" xref="S4.E27.m1.38.38.38.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E27.m1.38.38.38.3.3.3.1.3" xref="S4.E27.m1.38.38.38.3.3.3.1.3.cmml">r</mi><mo id="S4.E27.m1.38.38.38.3.3.3.1.1a" xref="S4.E27.m1.38.38.38.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E27.m1.38.38.38.3.3.3.1.4" xref="S4.E27.m1.38.38.38.3.3.3.1.4.cmml">o</mi><mo id="S4.E27.m1.38.38.38.3.3.3.1.1b" xref="S4.E27.m1.38.38.38.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E27.m1.38.38.38.3.3.3.1.5" xref="S4.E27.m1.38.38.38.3.3.3.1.5.cmml">p</mi></mrow></msub><mo id="S4.E27.m1.54.54.4.53.16.16.16.1.1.2a">⁢</mo><mrow id="S4.E27.m1.54.54.4.53.16.16.16.1.1.1.1"><mo id="S4.E27.m1.39.39.39.4.4.4" stretchy="false">(</mo><msup id="S4.E27.m1.54.54.4.53.16.16.16.1.1.1.1.1"><mi id="S4.E27.m1.40.40.40.5.5.5" xref="S4.E27.m1.40.40.40.5.5.5.cmml">H</mi><mi id="S4.E27.m1.41.41.41.6.6.6.1" xref="S4.E27.m1.41.41.41.6.6.6.1.cmml">u</mi></msup><mo id="S4.E27.m1.42.42.42.7.7.7" stretchy="false">)</mo></mrow></mrow><mo id="S4.E27.m1.43.43.43.8.8.8" xref="S4.E27.m1.43.43.43.8.8.8.cmml">=</mo><mrow id="S4.E27.m1.54.54.4.53.16.16.16.1.2"><msup id="S4.E27.m1.54.54.4.53.16.16.16.1.2.1"><mi id="S4.E27.m1.44.44.44.9.9.9" xref="S4.E27.m1.44.44.44.9.9.9.cmml">H</mi><mi id="S4.E27.m1.45.45.45.10.10.10.1" xref="S4.E27.m1.45.45.45.10.10.10.1.cmml">u</mi></msup><mo id="S4.E27.m1.46.46.46.11.11.11" xref="S4.E27.m1.46.46.46.11.11.11.cmml">−</mo><msubsup id="S4.E27.m1.54.54.4.53.16.16.16.1.2.2"><mi id="S4.E27.m1.47.47.47.12.12.12" xref="S4.E27.m1.47.47.47.12.12.12.cmml">H</mi><mrow id="S4.E27.m1.48.48.48.13.13.13.1" xref="S4.E27.m1.48.48.48.13.13.13.1.cmml"><mi id="S4.E27.m1.48.48.48.13.13.13.1.2" xref="S4.E27.m1.48.48.48.13.13.13.1.2.cmml">C</mi><mo id="S4.E27.m1.48.48.48.13.13.13.1.1" xref="S4.E27.m1.48.48.48.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E27.m1.48.48.48.13.13.13.1.3" xref="S4.E27.m1.48.48.48.13.13.13.1.3.cmml">r</mi><mo id="S4.E27.m1.48.48.48.13.13.13.1.1a" xref="S4.E27.m1.48.48.48.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E27.m1.48.48.48.13.13.13.1.4" xref="S4.E27.m1.48.48.48.13.13.13.1.4.cmml">o</mi><mo id="S4.E27.m1.48.48.48.13.13.13.1.1b" xref="S4.E27.m1.48.48.48.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E27.m1.48.48.48.13.13.13.1.5" xref="S4.E27.m1.48.48.48.13.13.13.1.5.cmml">p</mi></mrow><mi id="S4.E27.m1.49.49.49.14.14.14.1" xref="S4.E27.m1.49.49.49.14.14.14.1.cmml">u</mi></msubsup></mrow></mrow><mo id="S4.E27.m1.50.50.50.15.15.15" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E27.m1.54b"><apply id="S4.E27.m1.51.51.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E27.m1.51.51.1.1.1.1.1.cmml"><eq id="S4.E27.m1.3.3.3.3.3.3.cmml" xref="S4.E27.m1.3.3.3.3.3.3"></eq><apply id="S4.E27.m1.51.51.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E27.m1.1.1.1.1.1.1.cmml" xref="S4.E27.m1.1.1.1.1.1.1">𝐿</ci><ci id="S4.E27.m1.2.2.2.2.2.2.1.cmml" xref="S4.E27.m1.2.2.2.2.2.2.1">𝑐</ci></apply><apply id="S4.E27.m1.51.51.1.1.1.1.1.1.2.cmml"><floor id="S4.E27.m1.51.51.1.1.1.1.1.1.2.1.cmml"></floor><apply id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.cmml"><times id="S4.E27.m1.7.7.7.7.7.7.cmml" xref="S4.E27.m1.7.7.7.7.7.7"></times><apply id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E27.m1.5.5.5.5.5.5.cmml" xref="S4.E27.m1.5.5.5.5.5.5">𝛾</ci><ci id="S4.E27.m1.6.6.6.6.6.6.1.cmml" xref="S4.E27.m1.6.6.6.6.6.6.1">𝑐</ci></apply><apply id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.1.2.cmml"><abs id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.1.2.1.cmml"></abs><apply id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E27.m1.9.9.9.9.9.9.cmml" xref="S4.E27.m1.9.9.9.9.9.9">𝐻</ci><ci id="S4.E27.m1.10.10.10.10.10.10.1.cmml" xref="S4.E27.m1.10.10.10.10.10.10.1">𝑢</ci></apply></apply></apply></apply></apply><apply id="S4.E27.m1.51.51.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.cmml"><eq id="S4.E27.m1.17.17.17.4.4.4.cmml" xref="S4.E27.m1.17.17.17.4.4.4"></eq><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.5.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.5.1.cmml">superscript</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.5.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.5.2.1.cmml">subscript</csymbol><ci id="S4.E27.m1.14.14.14.1.1.1.cmml" xref="S4.E27.m1.14.14.14.1.1.1">𝐻</ci><apply id="S4.E27.m1.15.15.15.2.2.2.1.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1"><times id="S4.E27.m1.15.15.15.2.2.2.1.1.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1.1"></times><ci id="S4.E27.m1.15.15.15.2.2.2.1.2.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1.2">𝐶</ci><ci id="S4.E27.m1.15.15.15.2.2.2.1.3.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1.3">𝑟</ci><ci id="S4.E27.m1.15.15.15.2.2.2.1.4.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1.4">𝑜</ci><ci id="S4.E27.m1.15.15.15.2.2.2.1.5.cmml" xref="S4.E27.m1.15.15.15.2.2.2.1.5">𝑝</ci></apply></apply><ci id="S4.E27.m1.16.16.16.3.3.3.1.cmml" xref="S4.E27.m1.16.16.16.3.3.3.1">𝑢</ci></apply><list id="S4.E27.m1.51.51.1.1.1.2.2.1.1.3.4.cmml"><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E27.m1.19.19.19.6.6.6.cmml" xref="S4.E27.m1.19.19.19.6.6.6">𝐻</ci><ci id="S4.E27.m1.20.20.20.7.7.7.1.cmml" xref="S4.E27.m1.20.20.20.7.7.7.1">𝑐</ci></apply><ci id="S4.E27.m1.21.21.21.8.8.8.1.cmml" xref="S4.E27.m1.21.21.21.8.8.8.1">𝑢</ci></apply><ci id="S4.E27.m1.23.23.23.10.10.10.cmml" xref="S4.E27.m1.23.23.23.10.10.10">…</ci><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.2.2.2.1.cmml">superscript</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.2.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E27.m1.25.25.25.12.12.12.cmml" xref="S4.E27.m1.25.25.25.12.12.12">𝐻</ci><apply id="S4.E27.m1.26.26.26.13.13.13.1.cmml" xref="S4.E27.m1.26.26.26.13.13.13.1"><plus id="S4.E27.m1.26.26.26.13.13.13.1.1.cmml" xref="S4.E27.m1.26.26.26.13.13.13.1.1"></plus><ci id="S4.E27.m1.26.26.26.13.13.13.1.2.cmml" xref="S4.E27.m1.26.26.26.13.13.13.1.2">𝑐</ci><cn id="S4.E27.m1.26.26.26.13.13.13.1.3.cmml" type="integer" xref="S4.E27.m1.26.26.26.13.13.13.1.3">1</cn></apply></apply><ci id="S4.E27.m1.27.27.27.14.14.14.1.cmml" xref="S4.E27.m1.27.27.27.14.14.14.1">𝑢</ci></apply><ci id="S4.E27.m1.29.29.29.16.16.16.cmml" xref="S4.E27.m1.29.29.29.16.16.16">…</ci><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.3.3.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.3.3.3.1.cmml">superscript</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.1.1.3.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.1.1.3.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E27.m1.31.31.31.18.18.18.cmml" xref="S4.E27.m1.31.31.31.18.18.18">𝐻</ci><apply id="S4.E27.m1.32.32.32.19.19.19.1.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1"><minus id="S4.E27.m1.32.32.32.19.19.19.1.1.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.1"></minus><apply id="S4.E27.m1.32.32.32.19.19.19.1.2.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2"><plus id="S4.E27.m1.32.32.32.19.19.19.1.2.1.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.1"></plus><ci id="S4.E27.m1.32.32.32.19.19.19.1.2.2.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.2">𝑐</ci><apply id="S4.E27.m1.32.32.32.19.19.19.1.2.3.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S4.E27.m1.32.32.32.19.19.19.1.2.3.1.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3">subscript</csymbol><ci id="S4.E27.m1.32.32.32.19.19.19.1.2.3.2.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3.2">𝐿</ci><ci id="S4.E27.m1.32.32.32.19.19.19.1.2.3.3.cmml" xref="S4.E27.m1.32.32.32.19.19.19.1.2.3.3">𝑐</ci></apply></apply><cn id="S4.E27.m1.32.32.32.19.19.19.1.3.cmml" type="integer" xref="S4.E27.m1.32.32.32.19.19.19.1.3">1</cn></apply></apply><ci id="S4.E27.m1.33.33.33.20.20.20.1.cmml" xref="S4.E27.m1.33.33.33.20.20.20.1">𝑢</ci></apply></list></apply><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.cmml"><eq id="S4.E27.m1.43.43.43.8.8.8.cmml" xref="S4.E27.m1.43.43.43.8.8.8"></eq><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.cmml"><times id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.2.cmml"></times><ci id="S4.E27.m1.36.36.36.1.1.1.cmml" xref="S4.E27.m1.36.36.36.1.1.1">𝐴</ci><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.4.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.4.1.cmml">subscript</csymbol><ci id="S4.E27.m1.37.37.37.2.2.2.cmml" xref="S4.E27.m1.37.37.37.2.2.2">𝑂</ci><apply id="S4.E27.m1.38.38.38.3.3.3.1.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1"><times id="S4.E27.m1.38.38.38.3.3.3.1.1.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1.1"></times><ci id="S4.E27.m1.38.38.38.3.3.3.1.2.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1.2">𝐶</ci><ci id="S4.E27.m1.38.38.38.3.3.3.1.3.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1.3">𝑟</ci><ci id="S4.E27.m1.38.38.38.3.3.3.1.4.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1.4">𝑜</ci><ci id="S4.E27.m1.38.38.38.3.3.3.1.5.cmml" xref="S4.E27.m1.38.38.38.3.3.3.1.5">𝑝</ci></apply></apply><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.2.2.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E27.m1.40.40.40.5.5.5.cmml" xref="S4.E27.m1.40.40.40.5.5.5">𝐻</ci><ci id="S4.E27.m1.41.41.41.6.6.6.1.cmml" xref="S4.E27.m1.41.41.41.6.6.6.1">𝑢</ci></apply></apply><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.cmml"><minus id="S4.E27.m1.46.46.46.11.11.11.cmml" xref="S4.E27.m1.46.46.46.11.11.11"></minus><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.2.1.cmml">superscript</csymbol><ci id="S4.E27.m1.44.44.44.9.9.9.cmml" xref="S4.E27.m1.44.44.44.9.9.9">𝐻</ci><ci id="S4.E27.m1.45.45.45.10.10.10.1.cmml" xref="S4.E27.m1.45.45.45.10.10.10.1">𝑢</ci></apply><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.3.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.3.1.cmml">superscript</csymbol><apply id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E27.m1.51.51.1.1.1.2.2.2.2.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E27.m1.47.47.47.12.12.12.cmml" xref="S4.E27.m1.47.47.47.12.12.12">𝐻</ci><apply id="S4.E27.m1.48.48.48.13.13.13.1.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1"><times id="S4.E27.m1.48.48.48.13.13.13.1.1.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1.1"></times><ci id="S4.E27.m1.48.48.48.13.13.13.1.2.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1.2">𝐶</ci><ci id="S4.E27.m1.48.48.48.13.13.13.1.3.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1.3">𝑟</ci><ci id="S4.E27.m1.48.48.48.13.13.13.1.4.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1.4">𝑜</ci><ci id="S4.E27.m1.48.48.48.13.13.13.1.5.cmml" xref="S4.E27.m1.48.48.48.13.13.13.1.5">𝑝</ci></apply></apply><ci id="S4.E27.m1.49.49.49.14.14.14.1.cmml" xref="S4.E27.m1.49.49.49.14.14.14.1">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E27.m1.54c">\begin{split}&amp;L_{c}=\lfloor{\gamma_{c}\times|H^{u}|}\rfloor,\\
&amp;H_{Crop}^{u}=[H_{c}^{u},\dots,H_{c+1}^{u},\dots,H_{c+L_{c}-1}^{u}],\\
&amp;AO_{Crop}(H^{u})=H^{u}-H_{Crop}^{u}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E27.m1.54d">start_ROW start_CELL end_CELL start_CELL italic_L start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = ⌊ italic_γ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT × | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ⌋ , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_H start_POSTSUBSCRIPT italic_C italic_r italic_o italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ italic_H start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_c + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_c + italic_L start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_A italic_O start_POSTSUBSCRIPT italic_C italic_r italic_o italic_p end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT - italic_H start_POSTSUBSCRIPT italic_C italic_r italic_o italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.5.1">Mask</span>:
Some elements in the input sequence are masked out, which are often replaced by special markers (e.g. <math alttext="[MASK]" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml"><mo id="S4.I1.i2.p1.1.m1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.1.m1.1.1.2.1.cmml">[</mo><mrow id="S4.I1.i2.p1.1.m1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.1.1.2.cmml">M</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.1.1.3.cmml">A</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1a" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.4" xref="S4.I1.i2.p1.1.m1.1.1.1.1.4.cmml">S</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1b" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.5" xref="S4.I1.i2.p1.1.m1.1.1.1.1.5.cmml">K</mi></mrow><mo id="S4.I1.i2.p1.1.m1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1"><times id="S4.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1"></times><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.2">𝑀</ci><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.3">𝐴</ci><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.4.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.4">𝑆</ci><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.5.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.5">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">[MASK]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">[ italic_M italic_A italic_S italic_K ]</annotation></semantics></math>), similar to the pre-training approach of the Cloze Task in BERT. The number of masks is controlled by the parameter <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><msub id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">γ</mi><mi id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">𝛾</ci><ci id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, and the positions of masks are the values of <math alttext="L_{m}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><msub id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">L</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝐿</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">L_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">italic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> elements randomly selected from the sequence <math alttext="[1,2,\dots,|H^{u}|]" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.4"><semantics id="S4.I1.i2.p1.4.m4.4a"><mrow id="S4.I1.i2.p1.4.m4.4.4.1" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml">[</mo><mn id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml">1</mn><mo id="S4.I1.i2.p1.4.m4.4.4.1.3" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml">,</mo><mn id="S4.I1.i2.p1.4.m4.2.2" xref="S4.I1.i2.p1.4.m4.2.2.cmml">2</mn><mo id="S4.I1.i2.p1.4.m4.4.4.1.4" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml">,</mo><mi id="S4.I1.i2.p1.4.m4.3.3" mathvariant="normal" xref="S4.I1.i2.p1.4.m4.3.3.cmml">…</mi><mo id="S4.I1.i2.p1.4.m4.4.4.1.5" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml">,</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.1.1.1" xref="S4.I1.i2.p1.4.m4.4.4.1.1.2.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.1.1.2.1.cmml">|</mo><msup id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.2" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.2.cmml">H</mi><mi id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.3" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.I1.i2.p1.4.m4.4.4.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.1.1.2.1.cmml">|</mo></mrow><mo id="S4.I1.i2.p1.4.m4.4.4.1.6" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.4b"><list id="S4.I1.i2.p1.4.m4.4.4.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1"><cn id="S4.I1.i2.p1.4.m4.1.1.cmml" type="integer" xref="S4.I1.i2.p1.4.m4.1.1">1</cn><cn id="S4.I1.i2.p1.4.m4.2.2.cmml" type="integer" xref="S4.I1.i2.p1.4.m4.2.2">2</cn><ci id="S4.I1.i2.p1.4.m4.3.3.cmml" xref="S4.I1.i2.p1.4.m4.3.3">…</ci><apply id="S4.I1.i2.p1.4.m4.4.4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1"><abs id="S4.I1.i2.p1.4.m4.4.4.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.2"></abs><apply id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.2">𝐻</ci><ci id="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.1.1.1.1.3">𝑢</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.4c">[1,2,\dots,|H^{u}|]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.4d">[ 1 , 2 , … , | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ]</annotation></semantics></math> as the index of the markers of <math alttext="[MASK]" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><mrow id="S4.I1.i2.p1.5.m5.1.1.1" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml"><mo id="S4.I1.i2.p1.5.m5.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.5.m5.1.1.2.1.cmml">[</mo><mrow id="S4.I1.i2.p1.5.m5.1.1.1.1" xref="S4.I1.i2.p1.5.m5.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.1.1.2.cmml">M</mi><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.1" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.1.1.3.cmml">A</mi><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.1a" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.4" xref="S4.I1.i2.p1.5.m5.1.1.1.1.4.cmml">S</mi><mo id="S4.I1.i2.p1.5.m5.1.1.1.1.1b" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.5.m5.1.1.1.1.5" xref="S4.I1.i2.p1.5.m5.1.1.1.1.5.cmml">K</mi></mrow><mo id="S4.I1.i2.p1.5.m5.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.5.m5.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i2.p1.5.m5.1.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1"><times id="S4.I1.i2.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.1"></times><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.2">𝑀</ci><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.3">𝐴</ci><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.4.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.4">𝑆</ci><ci id="S4.I1.i2.p1.5.m5.1.1.1.1.5.cmml" xref="S4.I1.i2.p1.5.m5.1.1.1.1.5">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">[MASK]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">[ italic_M italic_A italic_S italic_K ]</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E28">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;Len(H_{Mask}^{u})=L_{m}=\lfloor{\gamma_{m}\times|H^{u}|}\rfloor,%
\\
&amp;AO_{Mask}(H^{u})=\bigl{[}H_{1}^{u},\dots,[MASK],\dots,H_{|H^{u}|}^{u}\bigr{]}%
.\end{split}" class="ltx_Math" display="block" id="S4.E28.m1.54"><semantics id="S4.E28.m1.54a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E28.m1.54.54.3" rowspacing="0pt"><mtr id="S4.E28.m1.54.54.3a"><mtd id="S4.E28.m1.54.54.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.54.54.3c"><mrow id="S4.E28.m1.53.53.2.52.23.23.23"><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1"><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1.1"><mi id="S4.E28.m1.1.1.1.1.1.1" xref="S4.E28.m1.1.1.1.1.1.1.cmml">L</mi><mo id="S4.E28.m1.53.53.2.52.23.23.23.1.1.2">⁢</mo><mi id="S4.E28.m1.2.2.2.2.2.2" xref="S4.E28.m1.2.2.2.2.2.2.cmml">e</mi><mo id="S4.E28.m1.53.53.2.52.23.23.23.1.1.2a">⁢</mo><mi id="S4.E28.m1.3.3.3.3.3.3" xref="S4.E28.m1.3.3.3.3.3.3.cmml">n</mi><mo id="S4.E28.m1.53.53.2.52.23.23.23.1.1.2b">⁢</mo><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1.1.1.1"><mo id="S4.E28.m1.4.4.4.4.4.4" stretchy="false">(</mo><msubsup id="S4.E28.m1.53.53.2.52.23.23.23.1.1.1.1.1"><mi id="S4.E28.m1.5.5.5.5.5.5" xref="S4.E28.m1.5.5.5.5.5.5.cmml">H</mi><mrow id="S4.E28.m1.6.6.6.6.6.6.1" xref="S4.E28.m1.6.6.6.6.6.6.1.cmml"><mi id="S4.E28.m1.6.6.6.6.6.6.1.2" xref="S4.E28.m1.6.6.6.6.6.6.1.2.cmml">M</mi><mo id="S4.E28.m1.6.6.6.6.6.6.1.1" xref="S4.E28.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="S4.E28.m1.6.6.6.6.6.6.1.3" xref="S4.E28.m1.6.6.6.6.6.6.1.3.cmml">a</mi><mo id="S4.E28.m1.6.6.6.6.6.6.1.1a" xref="S4.E28.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="S4.E28.m1.6.6.6.6.6.6.1.4" xref="S4.E28.m1.6.6.6.6.6.6.1.4.cmml">s</mi><mo id="S4.E28.m1.6.6.6.6.6.6.1.1b" xref="S4.E28.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="S4.E28.m1.6.6.6.6.6.6.1.5" xref="S4.E28.m1.6.6.6.6.6.6.1.5.cmml">k</mi></mrow><mi id="S4.E28.m1.7.7.7.7.7.7.1" xref="S4.E28.m1.7.7.7.7.7.7.1.cmml">u</mi></msubsup><mo id="S4.E28.m1.8.8.8.8.8.8" stretchy="false">)</mo></mrow></mrow><mo id="S4.E28.m1.9.9.9.9.9.9" xref="S4.E28.m1.9.9.9.9.9.9.cmml">=</mo><msub id="S4.E28.m1.53.53.2.52.23.23.23.1.4"><mi id="S4.E28.m1.10.10.10.10.10.10" xref="S4.E28.m1.10.10.10.10.10.10.cmml">L</mi><mi id="S4.E28.m1.11.11.11.11.11.11.1" xref="S4.E28.m1.11.11.11.11.11.11.1.cmml">m</mi></msub><mo id="S4.E28.m1.12.12.12.12.12.12" xref="S4.E28.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1.2.1"><mo id="S4.E28.m1.13.13.13.13.13.13" stretchy="false">⌊</mo><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1.2.1.1"><msub id="S4.E28.m1.53.53.2.52.23.23.23.1.2.1.1.2"><mi id="S4.E28.m1.14.14.14.14.14.14" xref="S4.E28.m1.14.14.14.14.14.14.cmml">γ</mi><mi id="S4.E28.m1.15.15.15.15.15.15.1" xref="S4.E28.m1.15.15.15.15.15.15.1.cmml">m</mi></msub><mo id="S4.E28.m1.16.16.16.16.16.16" lspace="0.222em" rspace="0.222em" xref="S4.E28.m1.16.16.16.16.16.16.cmml">×</mo><mrow id="S4.E28.m1.53.53.2.52.23.23.23.1.2.1.1.1.1"><mo id="S4.E28.m1.17.17.17.17.17.17" stretchy="false">|</mo><msup id="S4.E28.m1.53.53.2.52.23.23.23.1.2.1.1.1.1.1"><mi id="S4.E28.m1.18.18.18.18.18.18" xref="S4.E28.m1.18.18.18.18.18.18.cmml">H</mi><mi id="S4.E28.m1.19.19.19.19.19.19.1" xref="S4.E28.m1.19.19.19.19.19.19.1.cmml">u</mi></msup><mo id="S4.E28.m1.20.20.20.20.20.20" stretchy="false">|</mo></mrow></mrow><mo id="S4.E28.m1.21.21.21.21.21.21" stretchy="false">⌋</mo></mrow></mrow><mo id="S4.E28.m1.22.22.22.22.22.22">,</mo></mrow></mtd></mtr><mtr id="S4.E28.m1.54.54.3d"><mtd id="S4.E28.m1.54.54.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E28.m1.54.54.3f"><mrow id="S4.E28.m1.54.54.3.53.30.30.30"><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1"><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1.1"><mi id="S4.E28.m1.23.23.23.1.1.1" xref="S4.E28.m1.23.23.23.1.1.1.cmml">A</mi><mo id="S4.E28.m1.54.54.3.53.30.30.30.1.1.2">⁢</mo><msub id="S4.E28.m1.54.54.3.53.30.30.30.1.1.3"><mi id="S4.E28.m1.24.24.24.2.2.2" xref="S4.E28.m1.24.24.24.2.2.2.cmml">O</mi><mrow id="S4.E28.m1.25.25.25.3.3.3.1" xref="S4.E28.m1.25.25.25.3.3.3.1.cmml"><mi id="S4.E28.m1.25.25.25.3.3.3.1.2" xref="S4.E28.m1.25.25.25.3.3.3.1.2.cmml">M</mi><mo id="S4.E28.m1.25.25.25.3.3.3.1.1" xref="S4.E28.m1.25.25.25.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E28.m1.25.25.25.3.3.3.1.3" xref="S4.E28.m1.25.25.25.3.3.3.1.3.cmml">a</mi><mo id="S4.E28.m1.25.25.25.3.3.3.1.1a" xref="S4.E28.m1.25.25.25.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E28.m1.25.25.25.3.3.3.1.4" xref="S4.E28.m1.25.25.25.3.3.3.1.4.cmml">s</mi><mo id="S4.E28.m1.25.25.25.3.3.3.1.1b" xref="S4.E28.m1.25.25.25.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E28.m1.25.25.25.3.3.3.1.5" xref="S4.E28.m1.25.25.25.3.3.3.1.5.cmml">k</mi></mrow></msub><mo id="S4.E28.m1.54.54.3.53.30.30.30.1.1.2a">⁢</mo><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1.1.1.1"><mo id="S4.E28.m1.26.26.26.4.4.4" stretchy="false">(</mo><msup id="S4.E28.m1.54.54.3.53.30.30.30.1.1.1.1.1"><mi id="S4.E28.m1.27.27.27.5.5.5" xref="S4.E28.m1.27.27.27.5.5.5.cmml">H</mi><mi id="S4.E28.m1.28.28.28.6.6.6.1" xref="S4.E28.m1.28.28.28.6.6.6.1.cmml">u</mi></msup><mo id="S4.E28.m1.29.29.29.7.7.7" stretchy="false">)</mo></mrow></mrow><mo id="S4.E28.m1.30.30.30.8.8.8" xref="S4.E28.m1.30.30.30.8.8.8.cmml">=</mo><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1.4.3"><mo id="S4.E28.m1.31.31.31.9.9.9" maxsize="120%" minsize="120%">[</mo><msubsup id="S4.E28.m1.54.54.3.53.30.30.30.1.2.1.1"><mi id="S4.E28.m1.32.32.32.10.10.10" xref="S4.E28.m1.32.32.32.10.10.10.cmml">H</mi><mn id="S4.E28.m1.33.33.33.11.11.11.1" xref="S4.E28.m1.33.33.33.11.11.11.1.cmml">1</mn><mi id="S4.E28.m1.34.34.34.12.12.12.1" xref="S4.E28.m1.34.34.34.12.12.12.1.cmml">u</mi></msubsup><mo id="S4.E28.m1.35.35.35.13.13.13">,</mo><mi id="S4.E28.m1.36.36.36.14.14.14" mathvariant="normal" xref="S4.E28.m1.36.36.36.14.14.14.cmml">…</mi><mo id="S4.E28.m1.37.37.37.15.15.15">,</mo><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1.3.2.2"><mo id="S4.E28.m1.38.38.38.16.16.16" stretchy="false">[</mo><mrow id="S4.E28.m1.54.54.3.53.30.30.30.1.3.2.2.1.1"><mi id="S4.E28.m1.39.39.39.17.17.17" xref="S4.E28.m1.39.39.39.17.17.17.cmml">M</mi><mo id="S4.E28.m1.54.54.3.53.30.30.30.1.3.2.2.1.1.1">⁢</mo><mi id="S4.E28.m1.40.40.40.18.18.18" xref="S4.E28.m1.40.40.40.18.18.18.cmml">A</mi><mo id="S4.E28.m1.54.54.3.53.30.30.30.1.3.2.2.1.1.1a">⁢</mo><mi id="S4.E28.m1.41.41.41.19.19.19" xref="S4.E28.m1.41.41.41.19.19.19.cmml">S</mi><mo id="S4.E28.m1.54.54.3.53.30.30.30.1.3.2.2.1.1.1b">⁢</mo><mi id="S4.E28.m1.42.42.42.20.20.20" xref="S4.E28.m1.42.42.42.20.20.20.cmml">K</mi></mrow><mo id="S4.E28.m1.43.43.43.21.21.21" stretchy="false">]</mo></mrow><mo id="S4.E28.m1.44.44.44.22.22.22">,</mo><mi id="S4.E28.m1.45.45.45.23.23.23" mathvariant="normal" xref="S4.E28.m1.45.45.45.23.23.23.cmml">…</mi><mo id="S4.E28.m1.46.46.46.24.24.24">,</mo><msubsup id="S4.E28.m1.54.54.3.53.30.30.30.1.4.3.3"><mi id="S4.E28.m1.47.47.47.25.25.25" xref="S4.E28.m1.47.47.47.25.25.25.cmml">H</mi><mrow id="S4.E28.m1.48.48.48.26.26.26.1.1" xref="S4.E28.m1.48.48.48.26.26.26.1.2.cmml"><mo id="S4.E28.m1.48.48.48.26.26.26.1.1.2" stretchy="false" xref="S4.E28.m1.48.48.48.26.26.26.1.2.1.cmml">|</mo><msup id="S4.E28.m1.48.48.48.26.26.26.1.1.1" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1.cmml"><mi id="S4.E28.m1.48.48.48.26.26.26.1.1.1.2" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1.2.cmml">H</mi><mi id="S4.E28.m1.48.48.48.26.26.26.1.1.1.3" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1.3.cmml">u</mi></msup><mo id="S4.E28.m1.48.48.48.26.26.26.1.1.3" stretchy="false" xref="S4.E28.m1.48.48.48.26.26.26.1.2.1.cmml">|</mo></mrow><mi id="S4.E28.m1.49.49.49.27.27.27.1" xref="S4.E28.m1.49.49.49.27.27.27.1.cmml">u</mi></msubsup><mo id="S4.E28.m1.50.50.50.28.28.28" maxsize="120%" minsize="120%">]</mo></mrow></mrow><mo id="S4.E28.m1.51.51.51.29.29.29" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E28.m1.54b"><apply id="S4.E28.m1.52.52.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E28.m1.52.52.1.1.1.1.1.cmml"><and id="S4.E28.m1.52.52.1.1.1.1.1a.cmml"></and><apply id="S4.E28.m1.52.52.1.1.1.1.1b.cmml"><eq id="S4.E28.m1.9.9.9.9.9.9.cmml" xref="S4.E28.m1.9.9.9.9.9.9"></eq><apply id="S4.E28.m1.52.52.1.1.1.1.1.1.cmml"><times id="S4.E28.m1.52.52.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E28.m1.1.1.1.1.1.1.cmml" xref="S4.E28.m1.1.1.1.1.1.1">𝐿</ci><ci id="S4.E28.m1.2.2.2.2.2.2.cmml" xref="S4.E28.m1.2.2.2.2.2.2">𝑒</ci><ci id="S4.E28.m1.3.3.3.3.3.3.cmml" xref="S4.E28.m1.3.3.3.3.3.3">𝑛</ci><apply id="S4.E28.m1.52.52.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E28.m1.52.52.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E28.m1.5.5.5.5.5.5.cmml" xref="S4.E28.m1.5.5.5.5.5.5">𝐻</ci><apply id="S4.E28.m1.6.6.6.6.6.6.1.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1"><times id="S4.E28.m1.6.6.6.6.6.6.1.1.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1.1"></times><ci id="S4.E28.m1.6.6.6.6.6.6.1.2.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1.2">𝑀</ci><ci id="S4.E28.m1.6.6.6.6.6.6.1.3.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1.3">𝑎</ci><ci id="S4.E28.m1.6.6.6.6.6.6.1.4.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1.4">𝑠</ci><ci id="S4.E28.m1.6.6.6.6.6.6.1.5.cmml" xref="S4.E28.m1.6.6.6.6.6.6.1.5">𝑘</ci></apply></apply><ci id="S4.E28.m1.7.7.7.7.7.7.1.cmml" xref="S4.E28.m1.7.7.7.7.7.7.1">𝑢</ci></apply></apply><apply id="S4.E28.m1.52.52.1.1.1.1.1.5.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.1.1.5.1.cmml">subscript</csymbol><ci id="S4.E28.m1.10.10.10.10.10.10.cmml" xref="S4.E28.m1.10.10.10.10.10.10">𝐿</ci><ci id="S4.E28.m1.11.11.11.11.11.11.1.cmml" xref="S4.E28.m1.11.11.11.11.11.11.1">𝑚</ci></apply></apply><apply id="S4.E28.m1.52.52.1.1.1.1.1c.cmml"><eq id="S4.E28.m1.12.12.12.12.12.12.cmml" xref="S4.E28.m1.12.12.12.12.12.12"></eq><share href="https://arxiv.org/html/2404.18214v2#S4.E28.m1.52.52.1.1.1.1.1.5.cmml" id="S4.E28.m1.52.52.1.1.1.1.1d.cmml"></share><apply id="S4.E28.m1.52.52.1.1.1.1.1.2.2.cmml"><floor id="S4.E28.m1.52.52.1.1.1.1.1.2.2.1.cmml"></floor><apply id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.cmml"><times id="S4.E28.m1.16.16.16.16.16.16.cmml" xref="S4.E28.m1.16.16.16.16.16.16"></times><apply id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E28.m1.14.14.14.14.14.14.cmml" xref="S4.E28.m1.14.14.14.14.14.14">𝛾</ci><ci id="S4.E28.m1.15.15.15.15.15.15.1.cmml" xref="S4.E28.m1.15.15.15.15.15.15.1">𝑚</ci></apply><apply id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.1.2.cmml"><abs id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.1.2.1.cmml"></abs><apply id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.1.1.2.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E28.m1.18.18.18.18.18.18.cmml" xref="S4.E28.m1.18.18.18.18.18.18">𝐻</ci><ci id="S4.E28.m1.19.19.19.19.19.19.1.cmml" xref="S4.E28.m1.19.19.19.19.19.19.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E28.m1.52.52.1.1.1.2.2.cmml"><eq id="S4.E28.m1.30.30.30.8.8.8.cmml" xref="S4.E28.m1.30.30.30.8.8.8"></eq><apply id="S4.E28.m1.52.52.1.1.1.2.2.1.cmml"><times id="S4.E28.m1.52.52.1.1.1.2.2.1.2.cmml"></times><ci id="S4.E28.m1.23.23.23.1.1.1.cmml" xref="S4.E28.m1.23.23.23.1.1.1">𝐴</ci><apply id="S4.E28.m1.52.52.1.1.1.2.2.1.4.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.1.4.1.cmml">subscript</csymbol><ci id="S4.E28.m1.24.24.24.2.2.2.cmml" xref="S4.E28.m1.24.24.24.2.2.2">𝑂</ci><apply id="S4.E28.m1.25.25.25.3.3.3.1.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1"><times id="S4.E28.m1.25.25.25.3.3.3.1.1.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1.1"></times><ci id="S4.E28.m1.25.25.25.3.3.3.1.2.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1.2">𝑀</ci><ci id="S4.E28.m1.25.25.25.3.3.3.1.3.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1.3">𝑎</ci><ci id="S4.E28.m1.25.25.25.3.3.3.1.4.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1.4">𝑠</ci><ci id="S4.E28.m1.25.25.25.3.3.3.1.5.cmml" xref="S4.E28.m1.25.25.25.3.3.3.1.5">𝑘</ci></apply></apply><apply id="S4.E28.m1.52.52.1.1.1.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E28.m1.27.27.27.5.5.5.cmml" xref="S4.E28.m1.27.27.27.5.5.5">𝐻</ci><ci id="S4.E28.m1.28.28.28.6.6.6.1.cmml" xref="S4.E28.m1.28.28.28.6.6.6.1">𝑢</ci></apply></apply><list id="S4.E28.m1.52.52.1.1.1.2.2.4.4.cmml"><apply id="S4.E28.m1.52.52.1.1.1.2.2.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E28.m1.52.52.1.1.1.2.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E28.m1.32.32.32.10.10.10.cmml" xref="S4.E28.m1.32.32.32.10.10.10">𝐻</ci><cn id="S4.E28.m1.33.33.33.11.11.11.1.cmml" type="integer" xref="S4.E28.m1.33.33.33.11.11.11.1">1</cn></apply><ci id="S4.E28.m1.34.34.34.12.12.12.1.cmml" xref="S4.E28.m1.34.34.34.12.12.12.1">𝑢</ci></apply><ci id="S4.E28.m1.36.36.36.14.14.14.cmml" xref="S4.E28.m1.36.36.36.14.14.14">…</ci><apply id="S4.E28.m1.52.52.1.1.1.2.2.3.2.2.2.cmml"><csymbol cd="latexml" id="S4.E28.m1.52.52.1.1.1.2.2.3.2.2.2.1.cmml">delimited-[]</csymbol><apply id="S4.E28.m1.52.52.1.1.1.2.2.3.2.2.1.1.cmml"><times id="S4.E28.m1.52.52.1.1.1.2.2.3.2.2.1.1.1.cmml"></times><ci id="S4.E28.m1.39.39.39.17.17.17.cmml" xref="S4.E28.m1.39.39.39.17.17.17">𝑀</ci><ci id="S4.E28.m1.40.40.40.18.18.18.cmml" xref="S4.E28.m1.40.40.40.18.18.18">𝐴</ci><ci id="S4.E28.m1.41.41.41.19.19.19.cmml" xref="S4.E28.m1.41.41.41.19.19.19">𝑆</ci><ci id="S4.E28.m1.42.42.42.20.20.20.cmml" xref="S4.E28.m1.42.42.42.20.20.20">𝐾</ci></apply></apply><ci id="S4.E28.m1.45.45.45.23.23.23.cmml" xref="S4.E28.m1.45.45.45.23.23.23">…</ci><apply id="S4.E28.m1.52.52.1.1.1.2.2.4.3.3.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.4.3.3.1.cmml">superscript</csymbol><apply id="S4.E28.m1.52.52.1.1.1.2.2.4.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E28.m1.52.52.1.1.1.2.2.4.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E28.m1.47.47.47.25.25.25.cmml" xref="S4.E28.m1.47.47.47.25.25.25">𝐻</ci><apply id="S4.E28.m1.48.48.48.26.26.26.1.2.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1"><abs id="S4.E28.m1.48.48.48.26.26.26.1.2.1.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1.2"></abs><apply id="S4.E28.m1.48.48.48.26.26.26.1.1.1.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1"><csymbol cd="ambiguous" id="S4.E28.m1.48.48.48.26.26.26.1.1.1.1.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1">superscript</csymbol><ci id="S4.E28.m1.48.48.48.26.26.26.1.1.1.2.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1.2">𝐻</ci><ci id="S4.E28.m1.48.48.48.26.26.26.1.1.1.3.cmml" xref="S4.E28.m1.48.48.48.26.26.26.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S4.E28.m1.49.49.49.27.27.27.1.cmml" xref="S4.E28.m1.49.49.49.27.27.27.1">𝑢</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E28.m1.54c">\begin{split}&amp;Len(H_{Mask}^{u})=L_{m}=\lfloor{\gamma_{m}\times|H^{u}|}\rfloor,%
\\
&amp;AO_{Mask}(H^{u})=\bigl{[}H_{1}^{u},\dots,[MASK],\dots,H_{|H^{u}|}^{u}\bigr{]}%
.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E28.m1.54d">start_ROW start_CELL end_CELL start_CELL italic_L italic_e italic_n ( italic_H start_POSTSUBSCRIPT italic_M italic_a italic_s italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = italic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = ⌊ italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ⌋ , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_A italic_O start_POSTSUBSCRIPT italic_M italic_a italic_s italic_k end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = [ italic_H start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , [ italic_M italic_A italic_S italic_K ] , … , italic_H start_POSTSUBSCRIPT | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.2.1">Reorder</span>:
Randomly change the order of elements in a sequence. The reordering allows the model to learn to deal with different arrangements of elements and increase its ability to understand the global structure of the sequence. The length of the reordering is controlled by the parameter <math alttext="\gamma_{r}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><msub id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">γ</mi><mi id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝛾</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\gamma_{r}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, the positions of the elements of the selected sequence are randomly disrupted, and the starting position is determined by the parameter <math alttext="r" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_r</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;L_{r}=\lfloor{\gamma_{r}\times|H^{u}|}\rfloor,\\
&amp;H_{Reorder}^{u}=\mathrm{Random}(H_{r}^{u},\dots,H_{r+1}^{u},\dots,H_{r+L_{r}-%
1}^{u}),\\
&amp;AO_{Reorder}(H^{u})=\bigl{[}H_{1}^{u},\dots,H_{Reorder}^{u},\dots,H_{|H^{u}|}%
^{u}\bigr{]}.\end{split}" class="ltx_Math" display="block" id="S4.E29.m1.66"><semantics id="S4.E29.m1.66a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E29.m1.66.66.4" rowspacing="0pt"><mtr id="S4.E29.m1.66.66.4a"><mtd id="S4.E29.m1.66.66.4b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.66.66.4c"><mrow id="S4.E29.m1.64.64.2.63.14.14.14"><mrow id="S4.E29.m1.64.64.2.63.14.14.14.1"><msub id="S4.E29.m1.64.64.2.63.14.14.14.1.2"><mi id="S4.E29.m1.1.1.1.1.1.1" xref="S4.E29.m1.1.1.1.1.1.1.cmml">L</mi><mi id="S4.E29.m1.2.2.2.2.2.2.1" xref="S4.E29.m1.2.2.2.2.2.2.1.cmml">r</mi></msub><mo id="S4.E29.m1.3.3.3.3.3.3" xref="S4.E29.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E29.m1.64.64.2.63.14.14.14.1.1.1"><mo id="S4.E29.m1.4.4.4.4.4.4" stretchy="false">⌊</mo><mrow id="S4.E29.m1.64.64.2.63.14.14.14.1.1.1.1"><msub id="S4.E29.m1.64.64.2.63.14.14.14.1.1.1.1.2"><mi id="S4.E29.m1.5.5.5.5.5.5" xref="S4.E29.m1.5.5.5.5.5.5.cmml">γ</mi><mi id="S4.E29.m1.6.6.6.6.6.6.1" xref="S4.E29.m1.6.6.6.6.6.6.1.cmml">r</mi></msub><mo id="S4.E29.m1.7.7.7.7.7.7" lspace="0.222em" rspace="0.222em" xref="S4.E29.m1.7.7.7.7.7.7.cmml">×</mo><mrow id="S4.E29.m1.64.64.2.63.14.14.14.1.1.1.1.1.1"><mo id="S4.E29.m1.8.8.8.8.8.8" stretchy="false">|</mo><msup id="S4.E29.m1.64.64.2.63.14.14.14.1.1.1.1.1.1.1"><mi id="S4.E29.m1.9.9.9.9.9.9" xref="S4.E29.m1.9.9.9.9.9.9.cmml">H</mi><mi id="S4.E29.m1.10.10.10.10.10.10.1" xref="S4.E29.m1.10.10.10.10.10.10.1.cmml">u</mi></msup><mo id="S4.E29.m1.11.11.11.11.11.11" stretchy="false">|</mo></mrow></mrow><mo id="S4.E29.m1.12.12.12.12.12.12" stretchy="false">⌋</mo></mrow></mrow><mo id="S4.E29.m1.13.13.13.13.13.13">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.66.66.4d"><mtd id="S4.E29.m1.66.66.4e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.66.66.4f"><mrow id="S4.E29.m1.65.65.3.64.24.24.24"><mrow id="S4.E29.m1.65.65.3.64.24.24.24.1"><msubsup id="S4.E29.m1.65.65.3.64.24.24.24.1.4"><mi id="S4.E29.m1.14.14.14.1.1.1" xref="S4.E29.m1.14.14.14.1.1.1.cmml">H</mi><mrow id="S4.E29.m1.15.15.15.2.2.2.1" xref="S4.E29.m1.15.15.15.2.2.2.1.cmml"><mi id="S4.E29.m1.15.15.15.2.2.2.1.2" xref="S4.E29.m1.15.15.15.2.2.2.1.2.cmml">R</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.3" xref="S4.E29.m1.15.15.15.2.2.2.1.3.cmml">e</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1a" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.4" xref="S4.E29.m1.15.15.15.2.2.2.1.4.cmml">o</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1b" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.5" xref="S4.E29.m1.15.15.15.2.2.2.1.5.cmml">r</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1c" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.6" xref="S4.E29.m1.15.15.15.2.2.2.1.6.cmml">d</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1d" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.7" xref="S4.E29.m1.15.15.15.2.2.2.1.7.cmml">e</mi><mo id="S4.E29.m1.15.15.15.2.2.2.1.1e" xref="S4.E29.m1.15.15.15.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E29.m1.15.15.15.2.2.2.1.8" xref="S4.E29.m1.15.15.15.2.2.2.1.8.cmml">r</mi></mrow><mi id="S4.E29.m1.16.16.16.3.3.3.1" xref="S4.E29.m1.16.16.16.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.17.17.17.4.4.4" xref="S4.E29.m1.17.17.17.4.4.4.cmml">=</mo><mrow id="S4.E29.m1.65.65.3.64.24.24.24.1.3"><mi id="S4.E29.m1.18.18.18.5.5.5" xref="S4.E29.m1.18.18.18.5.5.5.cmml">Random</mi><mo id="S4.E29.m1.65.65.3.64.24.24.24.1.3.4">⁢</mo><mrow id="S4.E29.m1.65.65.3.64.24.24.24.1.3.3.3"><mo id="S4.E29.m1.19.19.19.6.6.6" stretchy="false">(</mo><msubsup id="S4.E29.m1.65.65.3.64.24.24.24.1.1.1.1.1"><mi id="S4.E29.m1.20.20.20.7.7.7" xref="S4.E29.m1.20.20.20.7.7.7.cmml">H</mi><mi id="S4.E29.m1.21.21.21.8.8.8.1" xref="S4.E29.m1.21.21.21.8.8.8.1.cmml">r</mi><mi id="S4.E29.m1.22.22.22.9.9.9.1" xref="S4.E29.m1.22.22.22.9.9.9.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.23.23.23.10.10.10">,</mo><mi id="S4.E29.m1.24.24.24.11.11.11" mathvariant="normal" xref="S4.E29.m1.24.24.24.11.11.11.cmml">…</mi><mo id="S4.E29.m1.25.25.25.12.12.12">,</mo><msubsup id="S4.E29.m1.65.65.3.64.24.24.24.1.2.2.2.2"><mi id="S4.E29.m1.26.26.26.13.13.13" xref="S4.E29.m1.26.26.26.13.13.13.cmml">H</mi><mrow id="S4.E29.m1.27.27.27.14.14.14.1" xref="S4.E29.m1.27.27.27.14.14.14.1.cmml"><mi id="S4.E29.m1.27.27.27.14.14.14.1.2" xref="S4.E29.m1.27.27.27.14.14.14.1.2.cmml">r</mi><mo id="S4.E29.m1.27.27.27.14.14.14.1.1" xref="S4.E29.m1.27.27.27.14.14.14.1.1.cmml">+</mo><mn id="S4.E29.m1.27.27.27.14.14.14.1.3" xref="S4.E29.m1.27.27.27.14.14.14.1.3.cmml">1</mn></mrow><mi id="S4.E29.m1.28.28.28.15.15.15.1" xref="S4.E29.m1.28.28.28.15.15.15.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.29.29.29.16.16.16">,</mo><mi id="S4.E29.m1.30.30.30.17.17.17" mathvariant="normal" xref="S4.E29.m1.30.30.30.17.17.17.cmml">…</mi><mo id="S4.E29.m1.31.31.31.18.18.18">,</mo><msubsup id="S4.E29.m1.65.65.3.64.24.24.24.1.3.3.3.3"><mi id="S4.E29.m1.32.32.32.19.19.19" xref="S4.E29.m1.32.32.32.19.19.19.cmml">H</mi><mrow id="S4.E29.m1.33.33.33.20.20.20.1" xref="S4.E29.m1.33.33.33.20.20.20.1.cmml"><mrow id="S4.E29.m1.33.33.33.20.20.20.1.2" xref="S4.E29.m1.33.33.33.20.20.20.1.2.cmml"><mi id="S4.E29.m1.33.33.33.20.20.20.1.2.2" xref="S4.E29.m1.33.33.33.20.20.20.1.2.2.cmml">r</mi><mo id="S4.E29.m1.33.33.33.20.20.20.1.2.1" xref="S4.E29.m1.33.33.33.20.20.20.1.2.1.cmml">+</mo><msub id="S4.E29.m1.33.33.33.20.20.20.1.2.3" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3.cmml"><mi id="S4.E29.m1.33.33.33.20.20.20.1.2.3.2" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3.2.cmml">L</mi><mi id="S4.E29.m1.33.33.33.20.20.20.1.2.3.3" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3.3.cmml">r</mi></msub></mrow><mo id="S4.E29.m1.33.33.33.20.20.20.1.1" xref="S4.E29.m1.33.33.33.20.20.20.1.1.cmml">−</mo><mn id="S4.E29.m1.33.33.33.20.20.20.1.3" xref="S4.E29.m1.33.33.33.20.20.20.1.3.cmml">1</mn></mrow><mi id="S4.E29.m1.34.34.34.21.21.21.1" xref="S4.E29.m1.34.34.34.21.21.21.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.35.35.35.22.22.22" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E29.m1.36.36.36.23.23.23">,</mo></mrow></mtd></mtr><mtr id="S4.E29.m1.66.66.4g"><mtd id="S4.E29.m1.66.66.4h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E29.m1.66.66.4i"><mrow id="S4.E29.m1.66.66.4.65.27.27.27"><mrow id="S4.E29.m1.66.66.4.65.27.27.27.1"><mrow id="S4.E29.m1.66.66.4.65.27.27.27.1.1"><mi id="S4.E29.m1.37.37.37.1.1.1" xref="S4.E29.m1.37.37.37.1.1.1.cmml">A</mi><mo id="S4.E29.m1.66.66.4.65.27.27.27.1.1.2">⁢</mo><msub id="S4.E29.m1.66.66.4.65.27.27.27.1.1.3"><mi id="S4.E29.m1.38.38.38.2.2.2" xref="S4.E29.m1.38.38.38.2.2.2.cmml">O</mi><mrow id="S4.E29.m1.39.39.39.3.3.3.1" xref="S4.E29.m1.39.39.39.3.3.3.1.cmml"><mi id="S4.E29.m1.39.39.39.3.3.3.1.2" xref="S4.E29.m1.39.39.39.3.3.3.1.2.cmml">R</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.3" xref="S4.E29.m1.39.39.39.3.3.3.1.3.cmml">e</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1a" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.4" xref="S4.E29.m1.39.39.39.3.3.3.1.4.cmml">o</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1b" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.5" xref="S4.E29.m1.39.39.39.3.3.3.1.5.cmml">r</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1c" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.6" xref="S4.E29.m1.39.39.39.3.3.3.1.6.cmml">d</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1d" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.7" xref="S4.E29.m1.39.39.39.3.3.3.1.7.cmml">e</mi><mo id="S4.E29.m1.39.39.39.3.3.3.1.1e" xref="S4.E29.m1.39.39.39.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E29.m1.39.39.39.3.3.3.1.8" xref="S4.E29.m1.39.39.39.3.3.3.1.8.cmml">r</mi></mrow></msub><mo id="S4.E29.m1.66.66.4.65.27.27.27.1.1.2a">⁢</mo><mrow id="S4.E29.m1.66.66.4.65.27.27.27.1.1.1.1"><mo id="S4.E29.m1.40.40.40.4.4.4" stretchy="false">(</mo><msup id="S4.E29.m1.66.66.4.65.27.27.27.1.1.1.1.1"><mi id="S4.E29.m1.41.41.41.5.5.5" xref="S4.E29.m1.41.41.41.5.5.5.cmml">H</mi><mi id="S4.E29.m1.42.42.42.6.6.6.1" xref="S4.E29.m1.42.42.42.6.6.6.1.cmml">u</mi></msup><mo id="S4.E29.m1.43.43.43.7.7.7" stretchy="false">)</mo></mrow></mrow><mo id="S4.E29.m1.44.44.44.8.8.8" xref="S4.E29.m1.44.44.44.8.8.8.cmml">=</mo><mrow id="S4.E29.m1.66.66.4.65.27.27.27.1.4.3"><mo id="S4.E29.m1.45.45.45.9.9.9" maxsize="120%" minsize="120%">[</mo><msubsup id="S4.E29.m1.66.66.4.65.27.27.27.1.2.1.1"><mi id="S4.E29.m1.46.46.46.10.10.10" xref="S4.E29.m1.46.46.46.10.10.10.cmml">H</mi><mn id="S4.E29.m1.47.47.47.11.11.11.1" xref="S4.E29.m1.47.47.47.11.11.11.1.cmml">1</mn><mi id="S4.E29.m1.48.48.48.12.12.12.1" xref="S4.E29.m1.48.48.48.12.12.12.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.49.49.49.13.13.13">,</mo><mi id="S4.E29.m1.50.50.50.14.14.14" mathvariant="normal" xref="S4.E29.m1.50.50.50.14.14.14.cmml">…</mi><mo id="S4.E29.m1.51.51.51.15.15.15">,</mo><msubsup id="S4.E29.m1.66.66.4.65.27.27.27.1.3.2.2"><mi id="S4.E29.m1.52.52.52.16.16.16" xref="S4.E29.m1.52.52.52.16.16.16.cmml">H</mi><mrow id="S4.E29.m1.53.53.53.17.17.17.1" xref="S4.E29.m1.53.53.53.17.17.17.1.cmml"><mi id="S4.E29.m1.53.53.53.17.17.17.1.2" xref="S4.E29.m1.53.53.53.17.17.17.1.2.cmml">R</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.3" xref="S4.E29.m1.53.53.53.17.17.17.1.3.cmml">e</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1a" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.4" xref="S4.E29.m1.53.53.53.17.17.17.1.4.cmml">o</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1b" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.5" xref="S4.E29.m1.53.53.53.17.17.17.1.5.cmml">r</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1c" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.6" xref="S4.E29.m1.53.53.53.17.17.17.1.6.cmml">d</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1d" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.7" xref="S4.E29.m1.53.53.53.17.17.17.1.7.cmml">e</mi><mo id="S4.E29.m1.53.53.53.17.17.17.1.1e" xref="S4.E29.m1.53.53.53.17.17.17.1.1.cmml">⁢</mo><mi id="S4.E29.m1.53.53.53.17.17.17.1.8" xref="S4.E29.m1.53.53.53.17.17.17.1.8.cmml">r</mi></mrow><mi id="S4.E29.m1.54.54.54.18.18.18.1" xref="S4.E29.m1.54.54.54.18.18.18.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.55.55.55.19.19.19">,</mo><mi id="S4.E29.m1.56.56.56.20.20.20" mathvariant="normal" xref="S4.E29.m1.56.56.56.20.20.20.cmml">…</mi><mo id="S4.E29.m1.57.57.57.21.21.21">,</mo><msubsup id="S4.E29.m1.66.66.4.65.27.27.27.1.4.3.3"><mi id="S4.E29.m1.58.58.58.22.22.22" xref="S4.E29.m1.58.58.58.22.22.22.cmml">H</mi><mrow id="S4.E29.m1.59.59.59.23.23.23.1.1" xref="S4.E29.m1.59.59.59.23.23.23.1.2.cmml"><mo id="S4.E29.m1.59.59.59.23.23.23.1.1.2" stretchy="false" xref="S4.E29.m1.59.59.59.23.23.23.1.2.1.cmml">|</mo><msup id="S4.E29.m1.59.59.59.23.23.23.1.1.1" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1.cmml"><mi id="S4.E29.m1.59.59.59.23.23.23.1.1.1.2" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1.2.cmml">H</mi><mi id="S4.E29.m1.59.59.59.23.23.23.1.1.1.3" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1.3.cmml">u</mi></msup><mo id="S4.E29.m1.59.59.59.23.23.23.1.1.3" stretchy="false" xref="S4.E29.m1.59.59.59.23.23.23.1.2.1.cmml">|</mo></mrow><mi id="S4.E29.m1.60.60.60.24.24.24.1" xref="S4.E29.m1.60.60.60.24.24.24.1.cmml">u</mi></msubsup><mo id="S4.E29.m1.61.61.61.25.25.25" maxsize="120%" minsize="120%">]</mo></mrow></mrow><mo id="S4.E29.m1.62.62.62.26.26.26" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E29.m1.66b"><apply id="S4.E29.m1.63.63.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E29.m1.63.63.1.1.1.1.1.cmml"><eq id="S4.E29.m1.3.3.3.3.3.3.cmml" xref="S4.E29.m1.3.3.3.3.3.3"></eq><apply id="S4.E29.m1.63.63.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E29.m1.1.1.1.1.1.1.cmml" xref="S4.E29.m1.1.1.1.1.1.1">𝐿</ci><ci id="S4.E29.m1.2.2.2.2.2.2.1.cmml" xref="S4.E29.m1.2.2.2.2.2.2.1">𝑟</ci></apply><apply id="S4.E29.m1.63.63.1.1.1.1.1.1.2.cmml"><floor id="S4.E29.m1.63.63.1.1.1.1.1.1.2.1.cmml"></floor><apply id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.cmml"><times id="S4.E29.m1.7.7.7.7.7.7.cmml" xref="S4.E29.m1.7.7.7.7.7.7"></times><apply id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E29.m1.5.5.5.5.5.5.cmml" xref="S4.E29.m1.5.5.5.5.5.5">𝛾</ci><ci id="S4.E29.m1.6.6.6.6.6.6.1.cmml" xref="S4.E29.m1.6.6.6.6.6.6.1">𝑟</ci></apply><apply id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.1.2.cmml"><abs id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.1.2.1.cmml"></abs><apply id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E29.m1.9.9.9.9.9.9.cmml" xref="S4.E29.m1.9.9.9.9.9.9">𝐻</ci><ci id="S4.E29.m1.10.10.10.10.10.10.1.cmml" xref="S4.E29.m1.10.10.10.10.10.10.1">𝑢</ci></apply></apply></apply></apply></apply><apply id="S4.E29.m1.63.63.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.cmml"><eq id="S4.E29.m1.17.17.17.4.4.4.cmml" xref="S4.E29.m1.17.17.17.4.4.4"></eq><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.5.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.5.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.5.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.5.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.14.14.14.1.1.1.cmml" xref="S4.E29.m1.14.14.14.1.1.1">𝐻</ci><apply id="S4.E29.m1.15.15.15.2.2.2.1.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1"><times id="S4.E29.m1.15.15.15.2.2.2.1.1.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.1"></times><ci id="S4.E29.m1.15.15.15.2.2.2.1.2.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.2">𝑅</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.3.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.3">𝑒</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.4.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.4">𝑜</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.5.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.5">𝑟</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.6.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.6">𝑑</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.7.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.7">𝑒</ci><ci id="S4.E29.m1.15.15.15.2.2.2.1.8.cmml" xref="S4.E29.m1.15.15.15.2.2.2.1.8">𝑟</ci></apply></apply><ci id="S4.E29.m1.16.16.16.3.3.3.1.cmml" xref="S4.E29.m1.16.16.16.3.3.3.1">𝑢</ci></apply><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.cmml"><times id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.4.cmml"></times><ci id="S4.E29.m1.18.18.18.5.5.5.cmml" xref="S4.E29.m1.18.18.18.5.5.5">Random</ci><vector id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.3.4.cmml"><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.20.20.20.7.7.7.cmml" xref="S4.E29.m1.20.20.20.7.7.7">𝐻</ci><ci id="S4.E29.m1.21.21.21.8.8.8.1.cmml" xref="S4.E29.m1.21.21.21.8.8.8.1">𝑟</ci></apply><ci id="S4.E29.m1.22.22.22.9.9.9.1.cmml" xref="S4.E29.m1.22.22.22.9.9.9.1">𝑢</ci></apply><ci id="S4.E29.m1.24.24.24.11.11.11.cmml" xref="S4.E29.m1.24.24.24.11.11.11">…</ci><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.2.2.2.2.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.26.26.26.13.13.13.cmml" xref="S4.E29.m1.26.26.26.13.13.13">𝐻</ci><apply id="S4.E29.m1.27.27.27.14.14.14.1.cmml" xref="S4.E29.m1.27.27.27.14.14.14.1"><plus id="S4.E29.m1.27.27.27.14.14.14.1.1.cmml" xref="S4.E29.m1.27.27.27.14.14.14.1.1"></plus><ci id="S4.E29.m1.27.27.27.14.14.14.1.2.cmml" xref="S4.E29.m1.27.27.27.14.14.14.1.2">𝑟</ci><cn id="S4.E29.m1.27.27.27.14.14.14.1.3.cmml" type="integer" xref="S4.E29.m1.27.27.27.14.14.14.1.3">1</cn></apply></apply><ci id="S4.E29.m1.28.28.28.15.15.15.1.cmml" xref="S4.E29.m1.28.28.28.15.15.15.1">𝑢</ci></apply><ci id="S4.E29.m1.30.30.30.17.17.17.cmml" xref="S4.E29.m1.30.30.30.17.17.17">…</ci><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.3.3.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.3.3.3.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.3.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.1.1.3.3.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.32.32.32.19.19.19.cmml" xref="S4.E29.m1.32.32.32.19.19.19">𝐻</ci><apply id="S4.E29.m1.33.33.33.20.20.20.1.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1"><minus id="S4.E29.m1.33.33.33.20.20.20.1.1.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.1"></minus><apply id="S4.E29.m1.33.33.33.20.20.20.1.2.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2"><plus id="S4.E29.m1.33.33.33.20.20.20.1.2.1.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.1"></plus><ci id="S4.E29.m1.33.33.33.20.20.20.1.2.2.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.2">𝑟</ci><apply id="S4.E29.m1.33.33.33.20.20.20.1.2.3.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3"><csymbol cd="ambiguous" id="S4.E29.m1.33.33.33.20.20.20.1.2.3.1.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3">subscript</csymbol><ci id="S4.E29.m1.33.33.33.20.20.20.1.2.3.2.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3.2">𝐿</ci><ci id="S4.E29.m1.33.33.33.20.20.20.1.2.3.3.cmml" xref="S4.E29.m1.33.33.33.20.20.20.1.2.3.3">𝑟</ci></apply></apply><cn id="S4.E29.m1.33.33.33.20.20.20.1.3.cmml" type="integer" xref="S4.E29.m1.33.33.33.20.20.20.1.3">1</cn></apply></apply><ci id="S4.E29.m1.34.34.34.21.21.21.1.cmml" xref="S4.E29.m1.34.34.34.21.21.21.1">𝑢</ci></apply></vector></apply></apply><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.cmml"><eq id="S4.E29.m1.44.44.44.8.8.8.cmml" xref="S4.E29.m1.44.44.44.8.8.8"></eq><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.cmml"><times id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.2.cmml"></times><ci id="S4.E29.m1.37.37.37.1.1.1.cmml" xref="S4.E29.m1.37.37.37.1.1.1">𝐴</ci><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.4.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.4.1.cmml">subscript</csymbol><ci id="S4.E29.m1.38.38.38.2.2.2.cmml" xref="S4.E29.m1.38.38.38.2.2.2">𝑂</ci><apply id="S4.E29.m1.39.39.39.3.3.3.1.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1"><times id="S4.E29.m1.39.39.39.3.3.3.1.1.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.1"></times><ci id="S4.E29.m1.39.39.39.3.3.3.1.2.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.2">𝑅</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.3.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.3">𝑒</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.4.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.4">𝑜</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.5.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.5">𝑟</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.6.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.6">𝑑</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.7.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.7">𝑒</ci><ci id="S4.E29.m1.39.39.39.3.3.3.1.8.cmml" xref="S4.E29.m1.39.39.39.3.3.3.1.8">𝑟</ci></apply></apply><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E29.m1.41.41.41.5.5.5.cmml" xref="S4.E29.m1.41.41.41.5.5.5">𝐻</ci><ci id="S4.E29.m1.42.42.42.6.6.6.1.cmml" xref="S4.E29.m1.42.42.42.6.6.6.1">𝑢</ci></apply></apply><list id="S4.E29.m1.63.63.1.1.1.2.2.2.2.4.4.cmml"><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.46.46.46.10.10.10.cmml" xref="S4.E29.m1.46.46.46.10.10.10">𝐻</ci><cn id="S4.E29.m1.47.47.47.11.11.11.1.cmml" type="integer" xref="S4.E29.m1.47.47.47.11.11.11.1">1</cn></apply><ci id="S4.E29.m1.48.48.48.12.12.12.1.cmml" xref="S4.E29.m1.48.48.48.12.12.12.1">𝑢</ci></apply><ci id="S4.E29.m1.50.50.50.14.14.14.cmml" xref="S4.E29.m1.50.50.50.14.14.14">…</ci><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.3.2.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.3.2.2.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.3.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.3.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.52.52.52.16.16.16.cmml" xref="S4.E29.m1.52.52.52.16.16.16">𝐻</ci><apply id="S4.E29.m1.53.53.53.17.17.17.1.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1"><times id="S4.E29.m1.53.53.53.17.17.17.1.1.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.1"></times><ci id="S4.E29.m1.53.53.53.17.17.17.1.2.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.2">𝑅</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.3.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.3">𝑒</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.4.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.4">𝑜</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.5.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.5">𝑟</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.6.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.6">𝑑</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.7.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.7">𝑒</ci><ci id="S4.E29.m1.53.53.53.17.17.17.1.8.cmml" xref="S4.E29.m1.53.53.53.17.17.17.1.8">𝑟</ci></apply></apply><ci id="S4.E29.m1.54.54.54.18.18.18.1.cmml" xref="S4.E29.m1.54.54.54.18.18.18.1">𝑢</ci></apply><ci id="S4.E29.m1.56.56.56.20.20.20.cmml" xref="S4.E29.m1.56.56.56.20.20.20">…</ci><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.4.3.3.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.4.3.3.1.cmml">superscript</csymbol><apply id="S4.E29.m1.63.63.1.1.1.2.2.2.2.4.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E29.m1.63.63.1.1.1.2.2.2.2.4.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E29.m1.58.58.58.22.22.22.cmml" xref="S4.E29.m1.58.58.58.22.22.22">𝐻</ci><apply id="S4.E29.m1.59.59.59.23.23.23.1.2.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1"><abs id="S4.E29.m1.59.59.59.23.23.23.1.2.1.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1.2"></abs><apply id="S4.E29.m1.59.59.59.23.23.23.1.1.1.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1"><csymbol cd="ambiguous" id="S4.E29.m1.59.59.59.23.23.23.1.1.1.1.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1">superscript</csymbol><ci id="S4.E29.m1.59.59.59.23.23.23.1.1.1.2.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1.2">𝐻</ci><ci id="S4.E29.m1.59.59.59.23.23.23.1.1.1.3.cmml" xref="S4.E29.m1.59.59.59.23.23.23.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S4.E29.m1.60.60.60.24.24.24.1.cmml" xref="S4.E29.m1.60.60.60.24.24.24.1">𝑢</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E29.m1.66c">\begin{split}&amp;L_{r}=\lfloor{\gamma_{r}\times|H^{u}|}\rfloor,\\
&amp;H_{Reorder}^{u}=\mathrm{Random}(H_{r}^{u},\dots,H_{r+1}^{u},\dots,H_{r+L_{r}-%
1}^{u}),\\
&amp;AO_{Reorder}(H^{u})=\bigl{[}H_{1}^{u},\dots,H_{Reorder}^{u},\dots,H_{|H^{u}|}%
^{u}\bigr{]}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E29.m1.66d">start_ROW start_CELL end_CELL start_CELL italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = ⌊ italic_γ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ⌋ , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_H start_POSTSUBSCRIPT italic_R italic_e italic_o italic_r italic_d italic_e italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Random ( italic_H start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_r + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_r + italic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_A italic_O start_POSTSUBSCRIPT italic_R italic_e italic_o italic_r italic_d italic_e italic_r end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = [ italic_H start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_R italic_e italic_o italic_r italic_d italic_e italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p4">
<p class="ltx_p" id="S4.SS4.SSS2.p4.1">(2) <span class="ltx_text ltx_font_bold" id="S4.SS4.SSS2.p4.1.1">Informative Augmentation Operator</span>.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS2.p5">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.2.1">Insert</span>:
Inserting similar elements into the input sequence, i.e., the most similar items of the item, is generally measured by cosine similarity. The insertion method can give the model to adapt to longer sequences and feel richer contextual information. The number of insertions is controlled by the parameter <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1.1"><semantics id="S4.I2.i1.p1.1.m1.1a"><msub id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml"><mi id="S4.I2.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.p1.1.m1.1.1.2.cmml">γ</mi><mi id="S4.I2.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><apply id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.p1.1.m1.1.1.2">𝛾</ci><ci id="S4.I2.i1.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">\gamma_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and the location of the insertions <math alttext="{Sample}_{i}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.2.m2.1"><semantics id="S4.I2.i1.p1.2.m2.1a"><mrow id="S4.I2.i1.p1.2.m2.1.1" xref="S4.I2.i1.p1.2.m2.1.1.cmml"><mi id="S4.I2.i1.p1.2.m2.1.1.2" xref="S4.I2.i1.p1.2.m2.1.1.2.cmml">S</mi><mo id="S4.I2.i1.p1.2.m2.1.1.1" xref="S4.I2.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i1.p1.2.m2.1.1.3" xref="S4.I2.i1.p1.2.m2.1.1.3.cmml">a</mi><mo id="S4.I2.i1.p1.2.m2.1.1.1a" xref="S4.I2.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i1.p1.2.m2.1.1.4" xref="S4.I2.i1.p1.2.m2.1.1.4.cmml">m</mi><mo id="S4.I2.i1.p1.2.m2.1.1.1b" xref="S4.I2.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i1.p1.2.m2.1.1.5" xref="S4.I2.i1.p1.2.m2.1.1.5.cmml">p</mi><mo id="S4.I2.i1.p1.2.m2.1.1.1c" xref="S4.I2.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i1.p1.2.m2.1.1.6" xref="S4.I2.i1.p1.2.m2.1.1.6.cmml">l</mi><mo id="S4.I2.i1.p1.2.m2.1.1.1d" xref="S4.I2.i1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.I2.i1.p1.2.m2.1.1.7" xref="S4.I2.i1.p1.2.m2.1.1.7.cmml"><mi id="S4.I2.i1.p1.2.m2.1.1.7.2" xref="S4.I2.i1.p1.2.m2.1.1.7.2.cmml">e</mi><mi id="S4.I2.i1.p1.2.m2.1.1.7.3" xref="S4.I2.i1.p1.2.m2.1.1.7.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.2.m2.1b"><apply id="S4.I2.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1"><times id="S4.I2.i1.p1.2.m2.1.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1.1"></times><ci id="S4.I2.i1.p1.2.m2.1.1.2.cmml" xref="S4.I2.i1.p1.2.m2.1.1.2">𝑆</ci><ci id="S4.I2.i1.p1.2.m2.1.1.3.cmml" xref="S4.I2.i1.p1.2.m2.1.1.3">𝑎</ci><ci id="S4.I2.i1.p1.2.m2.1.1.4.cmml" xref="S4.I2.i1.p1.2.m2.1.1.4">𝑚</ci><ci id="S4.I2.i1.p1.2.m2.1.1.5.cmml" xref="S4.I2.i1.p1.2.m2.1.1.5">𝑝</ci><ci id="S4.I2.i1.p1.2.m2.1.1.6.cmml" xref="S4.I2.i1.p1.2.m2.1.1.6">𝑙</ci><apply id="S4.I2.i1.p1.2.m2.1.1.7.cmml" xref="S4.I2.i1.p1.2.m2.1.1.7"><csymbol cd="ambiguous" id="S4.I2.i1.p1.2.m2.1.1.7.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1.7">subscript</csymbol><ci id="S4.I2.i1.p1.2.m2.1.1.7.2.cmml" xref="S4.I2.i1.p1.2.m2.1.1.7.2">𝑒</ci><ci id="S4.I2.i1.p1.2.m2.1.1.7.3.cmml" xref="S4.I2.i1.p1.2.m2.1.1.7.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.2.m2.1c">{Sample}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.2.m2.1d">italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is randomly sampled:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;Len({Sample}_{i})=L_{i}=\lfloor{\gamma_{i}\times|H^{u}|}\rfloor,%
\\
&amp;{Sample}_{i}=\{I_{1},I_{2},\dots,I_{L_{i}}|I_{i}\in|H^{u}|-1\},\\
&amp;AO_{Insert}(H^{u})\\
&amp;=\bigl{[}H_{1}^{u},\dots,\widehat{H_{I}^{u}},H_{I}^{u},\dots,H_{|H^{u}|}^{u}%
\bigr{]},I\in{Sample}_{i}.\end{split}" class="ltx_Math" display="block" id="S4.E30.m1.100"><semantics id="S4.E30.m1.100a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E30.m1.100.100.5" rowspacing="0pt"><mtr id="S4.E30.m1.100.100.5a"><mtd id="S4.E30.m1.100.100.5b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E30.m1.100.100.5c"><mrow id="S4.E30.m1.97.97.2.96.27.27.27"><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1"><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.1"><mi id="S4.E30.m1.1.1.1.1.1.1" xref="S4.E30.m1.1.1.1.1.1.1.cmml">L</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.2">⁢</mo><mi id="S4.E30.m1.2.2.2.2.2.2" xref="S4.E30.m1.2.2.2.2.2.2.cmml">e</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.2a">⁢</mo><mi id="S4.E30.m1.3.3.3.3.3.3" xref="S4.E30.m1.3.3.3.3.3.3.cmml">n</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.2b">⁢</mo><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1"><mo id="S4.E30.m1.4.4.4.4.4.4" stretchy="false">(</mo><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1"><mi id="S4.E30.m1.5.5.5.5.5.5" xref="S4.E30.m1.5.5.5.5.5.5.cmml">S</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.1">⁢</mo><mi id="S4.E30.m1.6.6.6.6.6.6" xref="S4.E30.m1.6.6.6.6.6.6.cmml">a</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.1a">⁢</mo><mi id="S4.E30.m1.7.7.7.7.7.7" xref="S4.E30.m1.7.7.7.7.7.7.cmml">m</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.1b">⁢</mo><mi id="S4.E30.m1.8.8.8.8.8.8" xref="S4.E30.m1.8.8.8.8.8.8.cmml">p</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.1c">⁢</mo><mi id="S4.E30.m1.9.9.9.9.9.9" xref="S4.E30.m1.9.9.9.9.9.9.cmml">l</mi><mo id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.1d">⁢</mo><msub id="S4.E30.m1.97.97.2.96.27.27.27.1.1.1.1.1.2"><mi id="S4.E30.m1.10.10.10.10.10.10" xref="S4.E30.m1.10.10.10.10.10.10.cmml">e</mi><mi id="S4.E30.m1.11.11.11.11.11.11.1" xref="S4.E30.m1.11.11.11.11.11.11.1.cmml">i</mi></msub></mrow><mo id="S4.E30.m1.12.12.12.12.12.12" stretchy="false">)</mo></mrow></mrow><mo id="S4.E30.m1.13.13.13.13.13.13" xref="S4.E30.m1.13.13.13.13.13.13.cmml">=</mo><msub id="S4.E30.m1.97.97.2.96.27.27.27.1.4"><mi id="S4.E30.m1.14.14.14.14.14.14" xref="S4.E30.m1.14.14.14.14.14.14.cmml">L</mi><mi id="S4.E30.m1.15.15.15.15.15.15.1" xref="S4.E30.m1.15.15.15.15.15.15.1.cmml">i</mi></msub><mo id="S4.E30.m1.16.16.16.16.16.16" xref="S4.E30.m1.16.16.16.16.16.16.cmml">=</mo><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.2.1"><mo id="S4.E30.m1.17.17.17.17.17.17" stretchy="false">⌊</mo><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.2.1.1"><msub id="S4.E30.m1.97.97.2.96.27.27.27.1.2.1.1.2"><mi id="S4.E30.m1.18.18.18.18.18.18" xref="S4.E30.m1.18.18.18.18.18.18.cmml">γ</mi><mi id="S4.E30.m1.19.19.19.19.19.19.1" xref="S4.E30.m1.19.19.19.19.19.19.1.cmml">i</mi></msub><mo id="S4.E30.m1.20.20.20.20.20.20" lspace="0.222em" rspace="0.222em" xref="S4.E30.m1.20.20.20.20.20.20.cmml">×</mo><mrow id="S4.E30.m1.97.97.2.96.27.27.27.1.2.1.1.1.1"><mo id="S4.E30.m1.21.21.21.21.21.21" stretchy="false">|</mo><msup id="S4.E30.m1.97.97.2.96.27.27.27.1.2.1.1.1.1.1"><mi id="S4.E30.m1.22.22.22.22.22.22" xref="S4.E30.m1.22.22.22.22.22.22.cmml">H</mi><mi id="S4.E30.m1.23.23.23.23.23.23.1" xref="S4.E30.m1.23.23.23.23.23.23.1.cmml">u</mi></msup><mo id="S4.E30.m1.24.24.24.24.24.24" stretchy="false">|</mo></mrow></mrow><mo id="S4.E30.m1.25.25.25.25.25.25" stretchy="false">⌋</mo></mrow></mrow><mo id="S4.E30.m1.26.26.26.26.26.26">,</mo></mrow></mtd></mtr><mtr id="S4.E30.m1.100.100.5d"><mtd id="S4.E30.m1.100.100.5e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E30.m1.100.100.5f"><mrow id="S4.E30.m1.98.98.3.97.32.32.32"><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1"><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.3"><mi id="S4.E30.m1.27.27.27.1.1.1" xref="S4.E30.m1.27.27.27.1.1.1.cmml">S</mi><mo id="S4.E30.m1.98.98.3.97.32.32.32.1.3.1">⁢</mo><mi id="S4.E30.m1.28.28.28.2.2.2" xref="S4.E30.m1.28.28.28.2.2.2.cmml">a</mi><mo id="S4.E30.m1.98.98.3.97.32.32.32.1.3.1a">⁢</mo><mi id="S4.E30.m1.29.29.29.3.3.3" xref="S4.E30.m1.29.29.29.3.3.3.cmml">m</mi><mo id="S4.E30.m1.98.98.3.97.32.32.32.1.3.1b">⁢</mo><mi id="S4.E30.m1.30.30.30.4.4.4" xref="S4.E30.m1.30.30.30.4.4.4.cmml">p</mi><mo id="S4.E30.m1.98.98.3.97.32.32.32.1.3.1c">⁢</mo><mi id="S4.E30.m1.31.31.31.5.5.5" xref="S4.E30.m1.31.31.31.5.5.5.cmml">l</mi><mo id="S4.E30.m1.98.98.3.97.32.32.32.1.3.1d">⁢</mo><msub id="S4.E30.m1.98.98.3.97.32.32.32.1.3.2"><mi id="S4.E30.m1.32.32.32.6.6.6" xref="S4.E30.m1.32.32.32.6.6.6.cmml">e</mi><mi id="S4.E30.m1.33.33.33.7.7.7.1" xref="S4.E30.m1.33.33.33.7.7.7.1.cmml">i</mi></msub></mrow><mo id="S4.E30.m1.34.34.34.8.8.8" xref="S4.E30.m1.34.34.34.8.8.8.cmml">=</mo><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2"><mo id="S4.E30.m1.35.35.35.9.9.9" stretchy="false">{</mo><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.1.1.1"><msub id="S4.E30.m1.98.98.3.97.32.32.32.1.1.1.1.1.1"><mi id="S4.E30.m1.36.36.36.10.10.10" xref="S4.E30.m1.36.36.36.10.10.10.cmml">I</mi><mn id="S4.E30.m1.37.37.37.11.11.11.1" xref="S4.E30.m1.37.37.37.11.11.11.1.cmml">1</mn></msub><mo id="S4.E30.m1.38.38.38.12.12.12">,</mo><msub id="S4.E30.m1.98.98.3.97.32.32.32.1.1.1.1.2.2"><mi id="S4.E30.m1.39.39.39.13.13.13" xref="S4.E30.m1.39.39.39.13.13.13.cmml">I</mi><mn id="S4.E30.m1.40.40.40.14.14.14.1" xref="S4.E30.m1.40.40.40.14.14.14.1.cmml">2</mn></msub><mo id="S4.E30.m1.41.41.41.15.15.15">,</mo><mi id="S4.E30.m1.42.42.42.16.16.16" mathvariant="normal" xref="S4.E30.m1.42.42.42.16.16.16.cmml">…</mi><mo id="S4.E30.m1.43.43.43.17.17.17">,</mo><msub id="S4.E30.m1.98.98.3.97.32.32.32.1.1.1.1.3.3"><mi id="S4.E30.m1.44.44.44.18.18.18" xref="S4.E30.m1.44.44.44.18.18.18.cmml">I</mi><msub id="S4.E30.m1.45.45.45.19.19.19.1" xref="S4.E30.m1.45.45.45.19.19.19.1.cmml"><mi id="S4.E30.m1.45.45.45.19.19.19.1.2" xref="S4.E30.m1.45.45.45.19.19.19.1.2.cmml">L</mi><mi id="S4.E30.m1.45.45.45.19.19.19.1.3" xref="S4.E30.m1.45.45.45.19.19.19.1.3.cmml">i</mi></msub></msub></mrow><mo id="S4.E30.m1.46.46.46.20.20.20" lspace="0em" rspace="0em">|</mo><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2.2"><msub id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2.2.2"><mi id="S4.E30.m1.47.47.47.21.21.21" xref="S4.E30.m1.47.47.47.21.21.21.cmml">I</mi><mi id="S4.E30.m1.48.48.48.22.22.22.1" xref="S4.E30.m1.48.48.48.22.22.22.1.cmml">i</mi></msub><mo id="S4.E30.m1.49.49.49.23.23.23" xref="S4.E30.m1.49.49.49.23.23.23.cmml">∈</mo><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2.2.1"><mrow id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2.2.1.1.1"><mo id="S4.E30.m1.50.50.50.24.24.24" stretchy="false">|</mo><msup id="S4.E30.m1.98.98.3.97.32.32.32.1.2.2.2.1.1.1.1"><mi id="S4.E30.m1.51.51.51.25.25.25" xref="S4.E30.m1.51.51.51.25.25.25.cmml">H</mi><mi id="S4.E30.m1.52.52.52.26.26.26.1" xref="S4.E30.m1.52.52.52.26.26.26.1.cmml">u</mi></msup><mo id="S4.E30.m1.53.53.53.27.27.27" stretchy="false">|</mo></mrow><mo id="S4.E30.m1.54.54.54.28.28.28" xref="S4.E30.m1.54.54.54.28.28.28.cmml">−</mo><mn id="S4.E30.m1.55.55.55.29.29.29" xref="S4.E30.m1.55.55.55.29.29.29.cmml">1</mn></mrow></mrow><mo id="S4.E30.m1.56.56.56.30.30.30" stretchy="false">}</mo></mrow></mrow><mo id="S4.E30.m1.57.57.57.31.31.31">,</mo></mrow></mtd></mtr><mtr id="S4.E30.m1.100.100.5g"><mtd id="S4.E30.m1.100.100.5h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E30.m1.100.100.5i"><mrow id="S4.E30.m1.99.99.4.98.8.8"><mi id="S4.E30.m1.58.58.58.1.1.1" xref="S4.E30.m1.58.58.58.1.1.1.cmml">A</mi><mo id="S4.E30.m1.99.99.4.98.8.8.9">⁢</mo><msub id="S4.E30.m1.99.99.4.98.8.8.10"><mi id="S4.E30.m1.59.59.59.2.2.2" xref="S4.E30.m1.59.59.59.2.2.2.cmml">O</mi><mrow id="S4.E30.m1.60.60.60.3.3.3.1" xref="S4.E30.m1.60.60.60.3.3.3.1.cmml"><mi id="S4.E30.m1.60.60.60.3.3.3.1.2" xref="S4.E30.m1.60.60.60.3.3.3.1.2.cmml">I</mi><mo id="S4.E30.m1.60.60.60.3.3.3.1.1" xref="S4.E30.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E30.m1.60.60.60.3.3.3.1.3" xref="S4.E30.m1.60.60.60.3.3.3.1.3.cmml">n</mi><mo id="S4.E30.m1.60.60.60.3.3.3.1.1a" xref="S4.E30.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E30.m1.60.60.60.3.3.3.1.4" xref="S4.E30.m1.60.60.60.3.3.3.1.4.cmml">s</mi><mo id="S4.E30.m1.60.60.60.3.3.3.1.1b" xref="S4.E30.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E30.m1.60.60.60.3.3.3.1.5" xref="S4.E30.m1.60.60.60.3.3.3.1.5.cmml">e</mi><mo id="S4.E30.m1.60.60.60.3.3.3.1.1c" xref="S4.E30.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E30.m1.60.60.60.3.3.3.1.6" xref="S4.E30.m1.60.60.60.3.3.3.1.6.cmml">r</mi><mo id="S4.E30.m1.60.60.60.3.3.3.1.1d" xref="S4.E30.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E30.m1.60.60.60.3.3.3.1.7" xref="S4.E30.m1.60.60.60.3.3.3.1.7.cmml">t</mi></mrow></msub><mo id="S4.E30.m1.99.99.4.98.8.8.9a">⁢</mo><mrow id="S4.E30.m1.99.99.4.98.8.8.8.1"><mo id="S4.E30.m1.61.61.61.4.4.4" stretchy="false">(</mo><msup id="S4.E30.m1.99.99.4.98.8.8.8.1.1"><mi id="S4.E30.m1.62.62.62.5.5.5" xref="S4.E30.m1.62.62.62.5.5.5.cmml">H</mi><mi id="S4.E30.m1.63.63.63.6.6.6.1" xref="S4.E30.m1.63.63.63.6.6.6.1.cmml">u</mi></msup><mo id="S4.E30.m1.64.64.64.7.7.7" stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E30.m1.100.100.5j"><mtd id="S4.E30.m1.100.100.5k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E30.m1.100.100.5l"><mrow id="S4.E30.m1.100.100.5.99.32.32.32"><mrow id="S4.E30.m1.100.100.5.99.32.32.32.1"><mrow id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1"><mi id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1.4"></mi><mo id="S4.E30.m1.65.65.65.1.1.1" xref="S4.E30.m1.65.65.65.1.1.1.cmml">=</mo><mrow id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1.3.3"><mo id="S4.E30.m1.66.66.66.2.2.2" maxsize="120%" minsize="120%">[</mo><msubsup id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1.1.1.1"><mi id="S4.E30.m1.67.67.67.3.3.3" xref="S4.E30.m1.67.67.67.3.3.3.cmml">H</mi><mn id="S4.E30.m1.68.68.68.4.4.4.1" xref="S4.E30.m1.68.68.68.4.4.4.1.cmml">1</mn><mi id="S4.E30.m1.69.69.69.5.5.5.1" xref="S4.E30.m1.69.69.69.5.5.5.1.cmml">u</mi></msubsup><mo id="S4.E30.m1.70.70.70.6.6.6">,</mo><mi id="S4.E30.m1.71.71.71.7.7.7" mathvariant="normal" xref="S4.E30.m1.71.71.71.7.7.7.cmml">…</mi><mo id="S4.E30.m1.72.72.72.8.8.8">,</mo><mover accent="true" id="S4.E30.m1.73.73.73.9.9.9" xref="S4.E30.m1.73.73.73.9.9.9.cmml"><msubsup id="S4.E30.m1.73.73.73.9.9.9.2" xref="S4.E30.m1.73.73.73.9.9.9.2.cmml"><mi id="S4.E30.m1.73.73.73.9.9.9.2.2.2" xref="S4.E30.m1.73.73.73.9.9.9.2.2.2.cmml">H</mi><mi id="S4.E30.m1.73.73.73.9.9.9.2.2.3" xref="S4.E30.m1.73.73.73.9.9.9.2.2.3.cmml">I</mi><mi id="S4.E30.m1.73.73.73.9.9.9.2.3" xref="S4.E30.m1.73.73.73.9.9.9.2.3.cmml">u</mi></msubsup><mo id="S4.E30.m1.73.73.73.9.9.9.1" xref="S4.E30.m1.73.73.73.9.9.9.1.cmml">^</mo></mover><mo id="S4.E30.m1.74.74.74.10.10.10">,</mo><msubsup id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1.2.2.2"><mi id="S4.E30.m1.75.75.75.11.11.11" xref="S4.E30.m1.75.75.75.11.11.11.cmml">H</mi><mi id="S4.E30.m1.76.76.76.12.12.12.1" xref="S4.E30.m1.76.76.76.12.12.12.1.cmml">I</mi><mi id="S4.E30.m1.77.77.77.13.13.13.1" xref="S4.E30.m1.77.77.77.13.13.13.1.cmml">u</mi></msubsup><mo id="S4.E30.m1.78.78.78.14.14.14">,</mo><mi id="S4.E30.m1.79.79.79.15.15.15" mathvariant="normal" xref="S4.E30.m1.79.79.79.15.15.15.cmml">…</mi><mo id="S4.E30.m1.80.80.80.16.16.16">,</mo><msubsup id="S4.E30.m1.100.100.5.99.32.32.32.1.1.1.3.3.3"><mi id="S4.E30.m1.81.81.81.17.17.17" xref="S4.E30.m1.81.81.81.17.17.17.cmml">H</mi><mrow id="S4.E30.m1.82.82.82.18.18.18.1.1" xref="S4.E30.m1.82.82.82.18.18.18.1.2.cmml"><mo id="S4.E30.m1.82.82.82.18.18.18.1.1.2" stretchy="false" xref="S4.E30.m1.82.82.82.18.18.18.1.2.1.cmml">|</mo><msup id="S4.E30.m1.82.82.82.18.18.18.1.1.1" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1.cmml"><mi id="S4.E30.m1.82.82.82.18.18.18.1.1.1.2" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1.2.cmml">H</mi><mi id="S4.E30.m1.82.82.82.18.18.18.1.1.1.3" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1.3.cmml">u</mi></msup><mo id="S4.E30.m1.82.82.82.18.18.18.1.1.3" stretchy="false" xref="S4.E30.m1.82.82.82.18.18.18.1.2.1.cmml">|</mo></mrow><mi id="S4.E30.m1.83.83.83.19.19.19.1" xref="S4.E30.m1.83.83.83.19.19.19.1.cmml">u</mi></msubsup><mo id="S4.E30.m1.84.84.84.20.20.20" maxsize="120%" minsize="120%">]</mo></mrow></mrow><mo id="S4.E30.m1.85.85.85.21.21.21">,</mo><mrow id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2"><mi id="S4.E30.m1.86.86.86.22.22.22" xref="S4.E30.m1.86.86.86.22.22.22.cmml">I</mi><mo id="S4.E30.m1.87.87.87.23.23.23" xref="S4.E30.m1.87.87.87.23.23.23.cmml">∈</mo><mrow id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1"><mi id="S4.E30.m1.88.88.88.24.24.24" xref="S4.E30.m1.88.88.88.24.24.24.cmml">S</mi><mo id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.1">⁢</mo><mi id="S4.E30.m1.89.89.89.25.25.25" xref="S4.E30.m1.89.89.89.25.25.25.cmml">a</mi><mo id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.1a">⁢</mo><mi id="S4.E30.m1.90.90.90.26.26.26" xref="S4.E30.m1.90.90.90.26.26.26.cmml">m</mi><mo id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.1b">⁢</mo><mi id="S4.E30.m1.91.91.91.27.27.27" xref="S4.E30.m1.91.91.91.27.27.27.cmml">p</mi><mo id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.1c">⁢</mo><mi id="S4.E30.m1.92.92.92.28.28.28" xref="S4.E30.m1.92.92.92.28.28.28.cmml">l</mi><mo id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.1d">⁢</mo><msub id="S4.E30.m1.100.100.5.99.32.32.32.1.2.2.1.2"><mi id="S4.E30.m1.93.93.93.29.29.29" xref="S4.E30.m1.93.93.93.29.29.29.cmml">e</mi><mi id="S4.E30.m1.94.94.94.30.30.30.1" xref="S4.E30.m1.94.94.94.30.30.30.1.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E30.m1.95.95.95.31.31.31" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E30.m1.100b"><apply id="S4.E30.m1.96.96.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E30.m1.96.96.1.1.1.1.1.cmml"><and id="S4.E30.m1.96.96.1.1.1.1.1a.cmml"></and><apply id="S4.E30.m1.96.96.1.1.1.1.1b.cmml"><eq id="S4.E30.m1.13.13.13.13.13.13.cmml" xref="S4.E30.m1.13.13.13.13.13.13"></eq><apply id="S4.E30.m1.96.96.1.1.1.1.1.1.cmml"><times id="S4.E30.m1.96.96.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E30.m1.1.1.1.1.1.1.cmml" xref="S4.E30.m1.1.1.1.1.1.1">𝐿</ci><ci id="S4.E30.m1.2.2.2.2.2.2.cmml" xref="S4.E30.m1.2.2.2.2.2.2">𝑒</ci><ci id="S4.E30.m1.3.3.3.3.3.3.cmml" xref="S4.E30.m1.3.3.3.3.3.3">𝑛</ci><apply id="S4.E30.m1.96.96.1.1.1.1.1.1.1.1.1.cmml"><times id="S4.E30.m1.96.96.1.1.1.1.1.1.1.1.1.1.cmml"></times><ci id="S4.E30.m1.5.5.5.5.5.5.cmml" xref="S4.E30.m1.5.5.5.5.5.5">𝑆</ci><ci id="S4.E30.m1.6.6.6.6.6.6.cmml" xref="S4.E30.m1.6.6.6.6.6.6">𝑎</ci><ci id="S4.E30.m1.7.7.7.7.7.7.cmml" xref="S4.E30.m1.7.7.7.7.7.7">𝑚</ci><ci id="S4.E30.m1.8.8.8.8.8.8.cmml" xref="S4.E30.m1.8.8.8.8.8.8">𝑝</ci><ci id="S4.E30.m1.9.9.9.9.9.9.cmml" xref="S4.E30.m1.9.9.9.9.9.9">𝑙</ci><apply id="S4.E30.m1.96.96.1.1.1.1.1.1.1.1.1.7.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.1.1.1.1.1.1.7.1.cmml">subscript</csymbol><ci id="S4.E30.m1.10.10.10.10.10.10.cmml" xref="S4.E30.m1.10.10.10.10.10.10">𝑒</ci><ci id="S4.E30.m1.11.11.11.11.11.11.1.cmml" xref="S4.E30.m1.11.11.11.11.11.11.1">𝑖</ci></apply></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.1.1.5.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.1.1.5.1.cmml">subscript</csymbol><ci id="S4.E30.m1.14.14.14.14.14.14.cmml" xref="S4.E30.m1.14.14.14.14.14.14">𝐿</ci><ci id="S4.E30.m1.15.15.15.15.15.15.1.cmml" xref="S4.E30.m1.15.15.15.15.15.15.1">𝑖</ci></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.1.1c.cmml"><eq id="S4.E30.m1.16.16.16.16.16.16.cmml" xref="S4.E30.m1.16.16.16.16.16.16"></eq><share href="https://arxiv.org/html/2404.18214v2#S4.E30.m1.96.96.1.1.1.1.1.5.cmml" id="S4.E30.m1.96.96.1.1.1.1.1d.cmml"></share><apply id="S4.E30.m1.96.96.1.1.1.1.1.2.2.cmml"><floor id="S4.E30.m1.96.96.1.1.1.1.1.2.2.1.cmml"></floor><apply id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.cmml"><times id="S4.E30.m1.20.20.20.20.20.20.cmml" xref="S4.E30.m1.20.20.20.20.20.20"></times><apply id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E30.m1.18.18.18.18.18.18.cmml" xref="S4.E30.m1.18.18.18.18.18.18">𝛾</ci><ci id="S4.E30.m1.19.19.19.19.19.19.1.cmml" xref="S4.E30.m1.19.19.19.19.19.19.1">𝑖</ci></apply><apply id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.1.2.cmml"><abs id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.1.2.1.cmml"></abs><apply id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.1.1.2.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E30.m1.22.22.22.22.22.22.cmml" xref="S4.E30.m1.22.22.22.22.22.22">𝐻</ci><ci id="S4.E30.m1.23.23.23.23.23.23.1.cmml" xref="S4.E30.m1.23.23.23.23.23.23.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.cmml"><eq id="S4.E30.m1.34.34.34.8.8.8.cmml" xref="S4.E30.m1.34.34.34.8.8.8"></eq><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.4.cmml"><times id="S4.E30.m1.96.96.1.1.1.2.2.1.1.4.1.cmml"></times><ci id="S4.E30.m1.27.27.27.1.1.1.cmml" xref="S4.E30.m1.27.27.27.1.1.1">𝑆</ci><ci id="S4.E30.m1.28.28.28.2.2.2.cmml" xref="S4.E30.m1.28.28.28.2.2.2">𝑎</ci><ci id="S4.E30.m1.29.29.29.3.3.3.cmml" xref="S4.E30.m1.29.29.29.3.3.3">𝑚</ci><ci id="S4.E30.m1.30.30.30.4.4.4.cmml" xref="S4.E30.m1.30.30.30.4.4.4">𝑝</ci><ci id="S4.E30.m1.31.31.31.5.5.5.cmml" xref="S4.E30.m1.31.31.31.5.5.5">𝑙</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.4.7.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.4.7.1.cmml">subscript</csymbol><ci id="S4.E30.m1.32.32.32.6.6.6.cmml" xref="S4.E30.m1.32.32.32.6.6.6">𝑒</ci><ci id="S4.E30.m1.33.33.33.7.7.7.1.cmml" xref="S4.E30.m1.33.33.33.7.7.7.1">𝑖</ci></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.3.cmml"><csymbol cd="latexml" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.3.1.cmml">conditional-set</csymbol><list id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.4.cmml"><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S4.E30.m1.36.36.36.10.10.10.cmml" xref="S4.E30.m1.36.36.36.10.10.10">𝐼</ci><cn id="S4.E30.m1.37.37.37.11.11.11.1.cmml" type="integer" xref="S4.E30.m1.37.37.37.11.11.11.1">1</cn></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E30.m1.39.39.39.13.13.13.cmml" xref="S4.E30.m1.39.39.39.13.13.13">𝐼</ci><cn id="S4.E30.m1.40.40.40.14.14.14.1.cmml" type="integer" xref="S4.E30.m1.40.40.40.14.14.14.1">2</cn></apply><ci id="S4.E30.m1.42.42.42.16.16.16.cmml" xref="S4.E30.m1.42.42.42.16.16.16">…</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S4.E30.m1.44.44.44.18.18.18.cmml" xref="S4.E30.m1.44.44.44.18.18.18">𝐼</ci><apply id="S4.E30.m1.45.45.45.19.19.19.1.cmml" xref="S4.E30.m1.45.45.45.19.19.19.1"><csymbol cd="ambiguous" id="S4.E30.m1.45.45.45.19.19.19.1.1.cmml" xref="S4.E30.m1.45.45.45.19.19.19.1">subscript</csymbol><ci id="S4.E30.m1.45.45.45.19.19.19.1.2.cmml" xref="S4.E30.m1.45.45.45.19.19.19.1.2">𝐿</ci><ci id="S4.E30.m1.45.45.45.19.19.19.1.3.cmml" xref="S4.E30.m1.45.45.45.19.19.19.1.3">𝑖</ci></apply></apply></list><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.cmml"><in id="S4.E30.m1.49.49.49.23.23.23.cmml" xref="S4.E30.m1.49.49.49.23.23.23"></in><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E30.m1.47.47.47.21.21.21.cmml" xref="S4.E30.m1.47.47.47.21.21.21">𝐼</ci><ci id="S4.E30.m1.48.48.48.22.22.22.1.cmml" xref="S4.E30.m1.48.48.48.22.22.22.1">𝑖</ci></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.1.cmml"><minus id="S4.E30.m1.54.54.54.28.28.28.cmml" xref="S4.E30.m1.54.54.54.28.28.28"></minus><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.1.1.2.cmml"><abs id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.1.1.2.1.cmml"></abs><apply id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.1.1.2.2.2.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E30.m1.51.51.51.25.25.25.cmml" xref="S4.E30.m1.51.51.51.25.25.25">𝐻</ci><ci id="S4.E30.m1.52.52.52.26.26.26.1.cmml" xref="S4.E30.m1.52.52.52.26.26.26.1">𝑢</ci></apply></apply><cn id="S4.E30.m1.55.55.55.29.29.29.cmml" type="integer" xref="S4.E30.m1.55.55.55.29.29.29">1</cn></apply></apply></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.cmml"><eq id="S4.E30.m1.65.65.65.1.1.1.cmml" xref="S4.E30.m1.65.65.65.1.1.1"></eq><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.cmml"><times id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.2.cmml"></times><ci id="S4.E30.m1.58.58.58.1.1.1.cmml" xref="S4.E30.m1.58.58.58.1.1.1">𝐴</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.4.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.4.1.cmml">subscript</csymbol><ci id="S4.E30.m1.59.59.59.2.2.2.cmml" xref="S4.E30.m1.59.59.59.2.2.2">𝑂</ci><apply id="S4.E30.m1.60.60.60.3.3.3.1.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1"><times id="S4.E30.m1.60.60.60.3.3.3.1.1.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.1"></times><ci id="S4.E30.m1.60.60.60.3.3.3.1.2.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.2">𝐼</ci><ci id="S4.E30.m1.60.60.60.3.3.3.1.3.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.3">𝑛</ci><ci id="S4.E30.m1.60.60.60.3.3.3.1.4.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.4">𝑠</ci><ci id="S4.E30.m1.60.60.60.3.3.3.1.5.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.5">𝑒</ci><ci id="S4.E30.m1.60.60.60.3.3.3.1.6.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.6">𝑟</ci><ci id="S4.E30.m1.60.60.60.3.3.3.1.7.cmml" xref="S4.E30.m1.60.60.60.3.3.3.1.7">𝑡</ci></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E30.m1.62.62.62.5.5.5.cmml" xref="S4.E30.m1.62.62.62.5.5.5">𝐻</ci><ci id="S4.E30.m1.63.63.63.6.6.6.1.cmml" xref="S4.E30.m1.63.63.63.6.6.6.1">𝑢</ci></apply></apply><list id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.4.4.cmml"><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E30.m1.67.67.67.3.3.3.cmml" xref="S4.E30.m1.67.67.67.3.3.3">𝐻</ci><cn id="S4.E30.m1.68.68.68.4.4.4.1.cmml" type="integer" xref="S4.E30.m1.68.68.68.4.4.4.1">1</cn></apply><ci id="S4.E30.m1.69.69.69.5.5.5.1.cmml" xref="S4.E30.m1.69.69.69.5.5.5.1">𝑢</ci></apply><ci id="S4.E30.m1.71.71.71.7.7.7.cmml" xref="S4.E30.m1.71.71.71.7.7.7">…</ci><apply id="S4.E30.m1.73.73.73.9.9.9.cmml" xref="S4.E30.m1.73.73.73.9.9.9"><ci id="S4.E30.m1.73.73.73.9.9.9.1.cmml" xref="S4.E30.m1.73.73.73.9.9.9.1">^</ci><apply id="S4.E30.m1.73.73.73.9.9.9.2.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2"><csymbol cd="ambiguous" id="S4.E30.m1.73.73.73.9.9.9.2.1.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2">superscript</csymbol><apply id="S4.E30.m1.73.73.73.9.9.9.2.2.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2"><csymbol cd="ambiguous" id="S4.E30.m1.73.73.73.9.9.9.2.2.1.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2">subscript</csymbol><ci id="S4.E30.m1.73.73.73.9.9.9.2.2.2.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2.2.2">𝐻</ci><ci id="S4.E30.m1.73.73.73.9.9.9.2.2.3.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2.2.3">𝐼</ci></apply><ci id="S4.E30.m1.73.73.73.9.9.9.2.3.cmml" xref="S4.E30.m1.73.73.73.9.9.9.2.3">𝑢</ci></apply></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.3.2.2.1.cmml">superscript</csymbol><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.3.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.3.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E30.m1.75.75.75.11.11.11.cmml" xref="S4.E30.m1.75.75.75.11.11.11">𝐻</ci><ci id="S4.E30.m1.76.76.76.12.12.12.1.cmml" xref="S4.E30.m1.76.76.76.12.12.12.1">𝐼</ci></apply><ci id="S4.E30.m1.77.77.77.13.13.13.1.cmml" xref="S4.E30.m1.77.77.77.13.13.13.1">𝑢</ci></apply><ci id="S4.E30.m1.79.79.79.15.15.15.cmml" xref="S4.E30.m1.79.79.79.15.15.15">…</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.4.3.3.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.4.3.3.1.cmml">superscript</csymbol><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.4.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.1.1.4.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E30.m1.81.81.81.17.17.17.cmml" xref="S4.E30.m1.81.81.81.17.17.17">𝐻</ci><apply id="S4.E30.m1.82.82.82.18.18.18.1.2.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1"><abs id="S4.E30.m1.82.82.82.18.18.18.1.2.1.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1.2"></abs><apply id="S4.E30.m1.82.82.82.18.18.18.1.1.1.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1"><csymbol cd="ambiguous" id="S4.E30.m1.82.82.82.18.18.18.1.1.1.1.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1">superscript</csymbol><ci id="S4.E30.m1.82.82.82.18.18.18.1.1.1.2.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1.2">𝐻</ci><ci id="S4.E30.m1.82.82.82.18.18.18.1.1.1.3.cmml" xref="S4.E30.m1.82.82.82.18.18.18.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S4.E30.m1.83.83.83.19.19.19.1.cmml" xref="S4.E30.m1.83.83.83.19.19.19.1">𝑢</ci></apply></list></apply><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.2.2.cmml"><in id="S4.E30.m1.87.87.87.23.23.23.cmml" xref="S4.E30.m1.87.87.87.23.23.23"></in><ci id="S4.E30.m1.86.86.86.22.22.22.cmml" xref="S4.E30.m1.86.86.86.22.22.22">𝐼</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.2.2.3.cmml"><times id="S4.E30.m1.96.96.1.1.1.2.2.2.2.2.2.3.1.cmml"></times><ci id="S4.E30.m1.88.88.88.24.24.24.cmml" xref="S4.E30.m1.88.88.88.24.24.24">𝑆</ci><ci id="S4.E30.m1.89.89.89.25.25.25.cmml" xref="S4.E30.m1.89.89.89.25.25.25">𝑎</ci><ci id="S4.E30.m1.90.90.90.26.26.26.cmml" xref="S4.E30.m1.90.90.90.26.26.26">𝑚</ci><ci id="S4.E30.m1.91.91.91.27.27.27.cmml" xref="S4.E30.m1.91.91.91.27.27.27">𝑝</ci><ci id="S4.E30.m1.92.92.92.28.28.28.cmml" xref="S4.E30.m1.92.92.92.28.28.28">𝑙</ci><apply id="S4.E30.m1.96.96.1.1.1.2.2.2.2.2.2.3.7.cmml"><csymbol cd="ambiguous" id="S4.E30.m1.96.96.1.1.1.2.2.2.2.2.2.3.7.1.cmml">subscript</csymbol><ci id="S4.E30.m1.93.93.93.29.29.29.cmml" xref="S4.E30.m1.93.93.93.29.29.29">𝑒</ci><ci id="S4.E30.m1.94.94.94.30.30.30.1.cmml" xref="S4.E30.m1.94.94.94.30.30.30.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E30.m1.100c">\begin{split}&amp;Len({Sample}_{i})=L_{i}=\lfloor{\gamma_{i}\times|H^{u}|}\rfloor,%
\\
&amp;{Sample}_{i}=\{I_{1},I_{2},\dots,I_{L_{i}}|I_{i}\in|H^{u}|-1\},\\
&amp;AO_{Insert}(H^{u})\\
&amp;=\bigl{[}H_{1}^{u},\dots,\widehat{H_{I}^{u}},H_{I}^{u},\dots,H_{|H^{u}|}^{u}%
\bigr{]},I\in{Sample}_{i}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E30.m1.100d">start_ROW start_CELL end_CELL start_CELL italic_L italic_e italic_n ( italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ⌊ italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ⌋ , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { italic_I start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_I start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 } , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_A italic_O start_POSTSUBSCRIPT italic_I italic_n italic_s italic_e italic_r italic_t end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = [ italic_H start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , over^ start_ARG italic_H start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_ARG , italic_H start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] , italic_I ∈ italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.2.1">Substitute</span>:
Replacing selected items with the most similar items in the input sequence. Substitution helps the model to adapt to different elements and improves robustness to changes in the sequence as a whole or in the items. The number of substitutions is controlled by the parameter <math alttext="\gamma_{s}" class="ltx_Math" display="inline" id="S4.I2.i2.p1.1.m1.1"><semantics id="S4.I2.i2.p1.1.m1.1a"><msub id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">γ</mi><mi id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2">𝛾</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">\gamma_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and the location of the substitutions is randomly sampled <math alttext="{Sample}_{s}" class="ltx_Math" display="inline" id="S4.I2.i2.p1.2.m2.1"><semantics id="S4.I2.i2.p1.2.m2.1a"><mrow id="S4.I2.i2.p1.2.m2.1.1" xref="S4.I2.i2.p1.2.m2.1.1.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.2.cmml">S</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i2.p1.2.m2.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.3.cmml">a</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1a" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i2.p1.2.m2.1.1.4" xref="S4.I2.i2.p1.2.m2.1.1.4.cmml">m</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1b" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i2.p1.2.m2.1.1.5" xref="S4.I2.i2.p1.2.m2.1.1.5.cmml">p</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1c" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I2.i2.p1.2.m2.1.1.6" xref="S4.I2.i2.p1.2.m2.1.1.6.cmml">l</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1d" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.I2.i2.p1.2.m2.1.1.7" xref="S4.I2.i2.p1.2.m2.1.1.7.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.7.2" xref="S4.I2.i2.p1.2.m2.1.1.7.2.cmml">e</mi><mi id="S4.I2.i2.p1.2.m2.1.1.7.3" xref="S4.I2.i2.p1.2.m2.1.1.7.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.2.m2.1b"><apply id="S4.I2.i2.p1.2.m2.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1"><times id="S4.I2.i2.p1.2.m2.1.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1.1"></times><ci id="S4.I2.i2.p1.2.m2.1.1.2.cmml" xref="S4.I2.i2.p1.2.m2.1.1.2">𝑆</ci><ci id="S4.I2.i2.p1.2.m2.1.1.3.cmml" xref="S4.I2.i2.p1.2.m2.1.1.3">𝑎</ci><ci id="S4.I2.i2.p1.2.m2.1.1.4.cmml" xref="S4.I2.i2.p1.2.m2.1.1.4">𝑚</ci><ci id="S4.I2.i2.p1.2.m2.1.1.5.cmml" xref="S4.I2.i2.p1.2.m2.1.1.5">𝑝</ci><ci id="S4.I2.i2.p1.2.m2.1.1.6.cmml" xref="S4.I2.i2.p1.2.m2.1.1.6">𝑙</ci><apply id="S4.I2.i2.p1.2.m2.1.1.7.cmml" xref="S4.I2.i2.p1.2.m2.1.1.7"><csymbol cd="ambiguous" id="S4.I2.i2.p1.2.m2.1.1.7.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1.7">subscript</csymbol><ci id="S4.I2.i2.p1.2.m2.1.1.7.2.cmml" xref="S4.I2.i2.p1.2.m2.1.1.7.2">𝑒</ci><ci id="S4.I2.i2.p1.2.m2.1.1.7.3.cmml" xref="S4.I2.i2.p1.2.m2.1.1.7.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.2.m2.1c">{Sample}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.2.m2.1d">italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;Len({Sample}_{s})=L_{s}=\lfloor{\gamma_{s}\times|H^{u}|}\rfloor,%
\\
&amp;{Sample}_{s}=\{S_{1},S_{2},\dots,S_{L_{s}}|S_{i}\in|H^{u}|-1\},\\
&amp;AO_{Substitute}(H^{u})\\
&amp;=\bigl{[}H_{1}^{u},\dots,\widehat{H_{S}^{u}},\dots,H_{|H^{u}|}^{u}\bigr{]},S%
\in{Sample}_{s}.\end{split}" class="ltx_Math" display="block" id="S4.E31.m1.96"><semantics id="S4.E31.m1.96a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E31.m1.96.96.5" rowspacing="0pt"><mtr id="S4.E31.m1.96.96.5a"><mtd id="S4.E31.m1.96.96.5b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E31.m1.96.96.5c"><mrow id="S4.E31.m1.93.93.2.92.27.27.27"><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1"><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.1"><mi id="S4.E31.m1.1.1.1.1.1.1" xref="S4.E31.m1.1.1.1.1.1.1.cmml">L</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.2">⁢</mo><mi id="S4.E31.m1.2.2.2.2.2.2" xref="S4.E31.m1.2.2.2.2.2.2.cmml">e</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.2a">⁢</mo><mi id="S4.E31.m1.3.3.3.3.3.3" xref="S4.E31.m1.3.3.3.3.3.3.cmml">n</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.2b">⁢</mo><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1"><mo id="S4.E31.m1.4.4.4.4.4.4" stretchy="false">(</mo><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1"><mi id="S4.E31.m1.5.5.5.5.5.5" xref="S4.E31.m1.5.5.5.5.5.5.cmml">S</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.1">⁢</mo><mi id="S4.E31.m1.6.6.6.6.6.6" xref="S4.E31.m1.6.6.6.6.6.6.cmml">a</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.1a">⁢</mo><mi id="S4.E31.m1.7.7.7.7.7.7" xref="S4.E31.m1.7.7.7.7.7.7.cmml">m</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.1b">⁢</mo><mi id="S4.E31.m1.8.8.8.8.8.8" xref="S4.E31.m1.8.8.8.8.8.8.cmml">p</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.1c">⁢</mo><mi id="S4.E31.m1.9.9.9.9.9.9" xref="S4.E31.m1.9.9.9.9.9.9.cmml">l</mi><mo id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.1d">⁢</mo><msub id="S4.E31.m1.93.93.2.92.27.27.27.1.1.1.1.1.2"><mi id="S4.E31.m1.10.10.10.10.10.10" xref="S4.E31.m1.10.10.10.10.10.10.cmml">e</mi><mi id="S4.E31.m1.11.11.11.11.11.11.1" xref="S4.E31.m1.11.11.11.11.11.11.1.cmml">s</mi></msub></mrow><mo id="S4.E31.m1.12.12.12.12.12.12" stretchy="false">)</mo></mrow></mrow><mo id="S4.E31.m1.13.13.13.13.13.13" xref="S4.E31.m1.13.13.13.13.13.13.cmml">=</mo><msub id="S4.E31.m1.93.93.2.92.27.27.27.1.4"><mi id="S4.E31.m1.14.14.14.14.14.14" xref="S4.E31.m1.14.14.14.14.14.14.cmml">L</mi><mi id="S4.E31.m1.15.15.15.15.15.15.1" xref="S4.E31.m1.15.15.15.15.15.15.1.cmml">s</mi></msub><mo id="S4.E31.m1.16.16.16.16.16.16" xref="S4.E31.m1.16.16.16.16.16.16.cmml">=</mo><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.2.1"><mo id="S4.E31.m1.17.17.17.17.17.17" stretchy="false">⌊</mo><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.2.1.1"><msub id="S4.E31.m1.93.93.2.92.27.27.27.1.2.1.1.2"><mi id="S4.E31.m1.18.18.18.18.18.18" xref="S4.E31.m1.18.18.18.18.18.18.cmml">γ</mi><mi id="S4.E31.m1.19.19.19.19.19.19.1" xref="S4.E31.m1.19.19.19.19.19.19.1.cmml">s</mi></msub><mo id="S4.E31.m1.20.20.20.20.20.20" lspace="0.222em" rspace="0.222em" xref="S4.E31.m1.20.20.20.20.20.20.cmml">×</mo><mrow id="S4.E31.m1.93.93.2.92.27.27.27.1.2.1.1.1.1"><mo id="S4.E31.m1.21.21.21.21.21.21" stretchy="false">|</mo><msup id="S4.E31.m1.93.93.2.92.27.27.27.1.2.1.1.1.1.1"><mi id="S4.E31.m1.22.22.22.22.22.22" xref="S4.E31.m1.22.22.22.22.22.22.cmml">H</mi><mi id="S4.E31.m1.23.23.23.23.23.23.1" xref="S4.E31.m1.23.23.23.23.23.23.1.cmml">u</mi></msup><mo id="S4.E31.m1.24.24.24.24.24.24" stretchy="false">|</mo></mrow></mrow><mo id="S4.E31.m1.25.25.25.25.25.25" stretchy="false">⌋</mo></mrow></mrow><mo id="S4.E31.m1.26.26.26.26.26.26">,</mo></mrow></mtd></mtr><mtr id="S4.E31.m1.96.96.5d"><mtd id="S4.E31.m1.96.96.5e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E31.m1.96.96.5f"><mrow id="S4.E31.m1.94.94.3.93.32.32.32"><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1"><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.3"><mi id="S4.E31.m1.27.27.27.1.1.1" xref="S4.E31.m1.27.27.27.1.1.1.cmml">S</mi><mo id="S4.E31.m1.94.94.3.93.32.32.32.1.3.1">⁢</mo><mi id="S4.E31.m1.28.28.28.2.2.2" xref="S4.E31.m1.28.28.28.2.2.2.cmml">a</mi><mo id="S4.E31.m1.94.94.3.93.32.32.32.1.3.1a">⁢</mo><mi id="S4.E31.m1.29.29.29.3.3.3" xref="S4.E31.m1.29.29.29.3.3.3.cmml">m</mi><mo id="S4.E31.m1.94.94.3.93.32.32.32.1.3.1b">⁢</mo><mi id="S4.E31.m1.30.30.30.4.4.4" xref="S4.E31.m1.30.30.30.4.4.4.cmml">p</mi><mo id="S4.E31.m1.94.94.3.93.32.32.32.1.3.1c">⁢</mo><mi id="S4.E31.m1.31.31.31.5.5.5" xref="S4.E31.m1.31.31.31.5.5.5.cmml">l</mi><mo id="S4.E31.m1.94.94.3.93.32.32.32.1.3.1d">⁢</mo><msub id="S4.E31.m1.94.94.3.93.32.32.32.1.3.2"><mi id="S4.E31.m1.32.32.32.6.6.6" xref="S4.E31.m1.32.32.32.6.6.6.cmml">e</mi><mi id="S4.E31.m1.33.33.33.7.7.7.1" xref="S4.E31.m1.33.33.33.7.7.7.1.cmml">s</mi></msub></mrow><mo id="S4.E31.m1.34.34.34.8.8.8" xref="S4.E31.m1.34.34.34.8.8.8.cmml">=</mo><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2"><mo id="S4.E31.m1.35.35.35.9.9.9" stretchy="false">{</mo><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.1.1.1"><msub id="S4.E31.m1.94.94.3.93.32.32.32.1.1.1.1.1.1"><mi id="S4.E31.m1.36.36.36.10.10.10" xref="S4.E31.m1.36.36.36.10.10.10.cmml">S</mi><mn id="S4.E31.m1.37.37.37.11.11.11.1" xref="S4.E31.m1.37.37.37.11.11.11.1.cmml">1</mn></msub><mo id="S4.E31.m1.38.38.38.12.12.12">,</mo><msub id="S4.E31.m1.94.94.3.93.32.32.32.1.1.1.1.2.2"><mi id="S4.E31.m1.39.39.39.13.13.13" xref="S4.E31.m1.39.39.39.13.13.13.cmml">S</mi><mn id="S4.E31.m1.40.40.40.14.14.14.1" xref="S4.E31.m1.40.40.40.14.14.14.1.cmml">2</mn></msub><mo id="S4.E31.m1.41.41.41.15.15.15">,</mo><mi id="S4.E31.m1.42.42.42.16.16.16" mathvariant="normal" xref="S4.E31.m1.42.42.42.16.16.16.cmml">…</mi><mo id="S4.E31.m1.43.43.43.17.17.17">,</mo><msub id="S4.E31.m1.94.94.3.93.32.32.32.1.1.1.1.3.3"><mi id="S4.E31.m1.44.44.44.18.18.18" xref="S4.E31.m1.44.44.44.18.18.18.cmml">S</mi><msub id="S4.E31.m1.45.45.45.19.19.19.1" xref="S4.E31.m1.45.45.45.19.19.19.1.cmml"><mi id="S4.E31.m1.45.45.45.19.19.19.1.2" xref="S4.E31.m1.45.45.45.19.19.19.1.2.cmml">L</mi><mi id="S4.E31.m1.45.45.45.19.19.19.1.3" xref="S4.E31.m1.45.45.45.19.19.19.1.3.cmml">s</mi></msub></msub></mrow><mo id="S4.E31.m1.46.46.46.20.20.20" lspace="0em" rspace="0em">|</mo><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2.2"><msub id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2.2.2"><mi id="S4.E31.m1.47.47.47.21.21.21" xref="S4.E31.m1.47.47.47.21.21.21.cmml">S</mi><mi id="S4.E31.m1.48.48.48.22.22.22.1" xref="S4.E31.m1.48.48.48.22.22.22.1.cmml">i</mi></msub><mo id="S4.E31.m1.49.49.49.23.23.23" xref="S4.E31.m1.49.49.49.23.23.23.cmml">∈</mo><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2.2.1"><mrow id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2.2.1.1.1"><mo id="S4.E31.m1.50.50.50.24.24.24" stretchy="false">|</mo><msup id="S4.E31.m1.94.94.3.93.32.32.32.1.2.2.2.1.1.1.1"><mi id="S4.E31.m1.51.51.51.25.25.25" xref="S4.E31.m1.51.51.51.25.25.25.cmml">H</mi><mi id="S4.E31.m1.52.52.52.26.26.26.1" xref="S4.E31.m1.52.52.52.26.26.26.1.cmml">u</mi></msup><mo id="S4.E31.m1.53.53.53.27.27.27" stretchy="false">|</mo></mrow><mo id="S4.E31.m1.54.54.54.28.28.28" xref="S4.E31.m1.54.54.54.28.28.28.cmml">−</mo><mn id="S4.E31.m1.55.55.55.29.29.29" xref="S4.E31.m1.55.55.55.29.29.29.cmml">1</mn></mrow></mrow><mo id="S4.E31.m1.56.56.56.30.30.30" stretchy="false">}</mo></mrow></mrow><mo id="S4.E31.m1.57.57.57.31.31.31">,</mo></mrow></mtd></mtr><mtr id="S4.E31.m1.96.96.5g"><mtd id="S4.E31.m1.96.96.5h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E31.m1.96.96.5i"><mrow id="S4.E31.m1.95.95.4.94.8.8"><mi id="S4.E31.m1.58.58.58.1.1.1" xref="S4.E31.m1.58.58.58.1.1.1.cmml">A</mi><mo id="S4.E31.m1.95.95.4.94.8.8.9">⁢</mo><msub id="S4.E31.m1.95.95.4.94.8.8.10"><mi id="S4.E31.m1.59.59.59.2.2.2" xref="S4.E31.m1.59.59.59.2.2.2.cmml">O</mi><mrow id="S4.E31.m1.60.60.60.3.3.3.1" xref="S4.E31.m1.60.60.60.3.3.3.1.cmml"><mi id="S4.E31.m1.60.60.60.3.3.3.1.2" xref="S4.E31.m1.60.60.60.3.3.3.1.2.cmml">S</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.3" xref="S4.E31.m1.60.60.60.3.3.3.1.3.cmml">u</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1a" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.4" xref="S4.E31.m1.60.60.60.3.3.3.1.4.cmml">b</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1b" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.5" xref="S4.E31.m1.60.60.60.3.3.3.1.5.cmml">s</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1c" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.6" xref="S4.E31.m1.60.60.60.3.3.3.1.6.cmml">t</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1d" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.7" xref="S4.E31.m1.60.60.60.3.3.3.1.7.cmml">i</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1e" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.8" xref="S4.E31.m1.60.60.60.3.3.3.1.8.cmml">t</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1f" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.9" xref="S4.E31.m1.60.60.60.3.3.3.1.9.cmml">u</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1g" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.10" xref="S4.E31.m1.60.60.60.3.3.3.1.10.cmml">t</mi><mo id="S4.E31.m1.60.60.60.3.3.3.1.1h" xref="S4.E31.m1.60.60.60.3.3.3.1.1.cmml">⁢</mo><mi id="S4.E31.m1.60.60.60.3.3.3.1.11" xref="S4.E31.m1.60.60.60.3.3.3.1.11.cmml">e</mi></mrow></msub><mo id="S4.E31.m1.95.95.4.94.8.8.9a">⁢</mo><mrow id="S4.E31.m1.95.95.4.94.8.8.8.1"><mo id="S4.E31.m1.61.61.61.4.4.4" stretchy="false">(</mo><msup id="S4.E31.m1.95.95.4.94.8.8.8.1.1"><mi id="S4.E31.m1.62.62.62.5.5.5" xref="S4.E31.m1.62.62.62.5.5.5.cmml">H</mi><mi id="S4.E31.m1.63.63.63.6.6.6.1" xref="S4.E31.m1.63.63.63.6.6.6.1.cmml">u</mi></msup><mo id="S4.E31.m1.64.64.64.7.7.7" stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E31.m1.96.96.5j"><mtd id="S4.E31.m1.96.96.5k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E31.m1.96.96.5l"><mrow id="S4.E31.m1.96.96.5.95.28.28.28"><mrow id="S4.E31.m1.96.96.5.95.28.28.28.1"><mrow id="S4.E31.m1.96.96.5.95.28.28.28.1.1.1"><mi id="S4.E31.m1.96.96.5.95.28.28.28.1.1.1.3"></mi><mo id="S4.E31.m1.65.65.65.1.1.1" xref="S4.E31.m1.65.65.65.1.1.1.cmml">=</mo><mrow id="S4.E31.m1.96.96.5.95.28.28.28.1.1.1.2.2"><mo id="S4.E31.m1.66.66.66.2.2.2" maxsize="120%" minsize="120%">[</mo><msubsup id="S4.E31.m1.96.96.5.95.28.28.28.1.1.1.1.1.1"><mi id="S4.E31.m1.67.67.67.3.3.3" xref="S4.E31.m1.67.67.67.3.3.3.cmml">H</mi><mn id="S4.E31.m1.68.68.68.4.4.4.1" xref="S4.E31.m1.68.68.68.4.4.4.1.cmml">1</mn><mi id="S4.E31.m1.69.69.69.5.5.5.1" xref="S4.E31.m1.69.69.69.5.5.5.1.cmml">u</mi></msubsup><mo id="S4.E31.m1.70.70.70.6.6.6">,</mo><mi id="S4.E31.m1.71.71.71.7.7.7" mathvariant="normal" xref="S4.E31.m1.71.71.71.7.7.7.cmml">…</mi><mo id="S4.E31.m1.72.72.72.8.8.8">,</mo><mover accent="true" id="S4.E31.m1.73.73.73.9.9.9" xref="S4.E31.m1.73.73.73.9.9.9.cmml"><msubsup id="S4.E31.m1.73.73.73.9.9.9.2" xref="S4.E31.m1.73.73.73.9.9.9.2.cmml"><mi id="S4.E31.m1.73.73.73.9.9.9.2.2.2" xref="S4.E31.m1.73.73.73.9.9.9.2.2.2.cmml">H</mi><mi id="S4.E31.m1.73.73.73.9.9.9.2.2.3" xref="S4.E31.m1.73.73.73.9.9.9.2.2.3.cmml">S</mi><mi id="S4.E31.m1.73.73.73.9.9.9.2.3" xref="S4.E31.m1.73.73.73.9.9.9.2.3.cmml">u</mi></msubsup><mo id="S4.E31.m1.73.73.73.9.9.9.1" xref="S4.E31.m1.73.73.73.9.9.9.1.cmml">^</mo></mover><mo id="S4.E31.m1.74.74.74.10.10.10">,</mo><mi id="S4.E31.m1.75.75.75.11.11.11" mathvariant="normal" xref="S4.E31.m1.75.75.75.11.11.11.cmml">…</mi><mo id="S4.E31.m1.76.76.76.12.12.12">,</mo><msubsup id="S4.E31.m1.96.96.5.95.28.28.28.1.1.1.2.2.2"><mi id="S4.E31.m1.77.77.77.13.13.13" xref="S4.E31.m1.77.77.77.13.13.13.cmml">H</mi><mrow id="S4.E31.m1.78.78.78.14.14.14.1.1" xref="S4.E31.m1.78.78.78.14.14.14.1.2.cmml"><mo id="S4.E31.m1.78.78.78.14.14.14.1.1.2" stretchy="false" xref="S4.E31.m1.78.78.78.14.14.14.1.2.1.cmml">|</mo><msup id="S4.E31.m1.78.78.78.14.14.14.1.1.1" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1.cmml"><mi id="S4.E31.m1.78.78.78.14.14.14.1.1.1.2" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1.2.cmml">H</mi><mi id="S4.E31.m1.78.78.78.14.14.14.1.1.1.3" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1.3.cmml">u</mi></msup><mo id="S4.E31.m1.78.78.78.14.14.14.1.1.3" stretchy="false" xref="S4.E31.m1.78.78.78.14.14.14.1.2.1.cmml">|</mo></mrow><mi id="S4.E31.m1.79.79.79.15.15.15.1" xref="S4.E31.m1.79.79.79.15.15.15.1.cmml">u</mi></msubsup><mo id="S4.E31.m1.80.80.80.16.16.16" maxsize="120%" minsize="120%">]</mo></mrow></mrow><mo id="S4.E31.m1.81.81.81.17.17.17">,</mo><mrow id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2"><mi id="S4.E31.m1.82.82.82.18.18.18" xref="S4.E31.m1.82.82.82.18.18.18.cmml">S</mi><mo id="S4.E31.m1.83.83.83.19.19.19" xref="S4.E31.m1.83.83.83.19.19.19.cmml">∈</mo><mrow id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1"><mi id="S4.E31.m1.84.84.84.20.20.20" xref="S4.E31.m1.84.84.84.20.20.20.cmml">S</mi><mo id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.1">⁢</mo><mi id="S4.E31.m1.85.85.85.21.21.21" xref="S4.E31.m1.85.85.85.21.21.21.cmml">a</mi><mo id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.1a">⁢</mo><mi id="S4.E31.m1.86.86.86.22.22.22" xref="S4.E31.m1.86.86.86.22.22.22.cmml">m</mi><mo id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.1b">⁢</mo><mi id="S4.E31.m1.87.87.87.23.23.23" xref="S4.E31.m1.87.87.87.23.23.23.cmml">p</mi><mo id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.1c">⁢</mo><mi id="S4.E31.m1.88.88.88.24.24.24" xref="S4.E31.m1.88.88.88.24.24.24.cmml">l</mi><mo id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.1d">⁢</mo><msub id="S4.E31.m1.96.96.5.95.28.28.28.1.2.2.1.2"><mi id="S4.E31.m1.89.89.89.25.25.25" xref="S4.E31.m1.89.89.89.25.25.25.cmml">e</mi><mi id="S4.E31.m1.90.90.90.26.26.26.1" xref="S4.E31.m1.90.90.90.26.26.26.1.cmml">s</mi></msub></mrow></mrow></mrow><mo id="S4.E31.m1.91.91.91.27.27.27" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E31.m1.96b"><apply id="S4.E31.m1.92.92.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E31.m1.92.92.1.1.1.1.1.cmml"><and id="S4.E31.m1.92.92.1.1.1.1.1a.cmml"></and><apply id="S4.E31.m1.92.92.1.1.1.1.1b.cmml"><eq id="S4.E31.m1.13.13.13.13.13.13.cmml" xref="S4.E31.m1.13.13.13.13.13.13"></eq><apply id="S4.E31.m1.92.92.1.1.1.1.1.1.cmml"><times id="S4.E31.m1.92.92.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E31.m1.1.1.1.1.1.1.cmml" xref="S4.E31.m1.1.1.1.1.1.1">𝐿</ci><ci id="S4.E31.m1.2.2.2.2.2.2.cmml" xref="S4.E31.m1.2.2.2.2.2.2">𝑒</ci><ci id="S4.E31.m1.3.3.3.3.3.3.cmml" xref="S4.E31.m1.3.3.3.3.3.3">𝑛</ci><apply id="S4.E31.m1.92.92.1.1.1.1.1.1.1.1.1.cmml"><times id="S4.E31.m1.92.92.1.1.1.1.1.1.1.1.1.1.cmml"></times><ci id="S4.E31.m1.5.5.5.5.5.5.cmml" xref="S4.E31.m1.5.5.5.5.5.5">𝑆</ci><ci id="S4.E31.m1.6.6.6.6.6.6.cmml" xref="S4.E31.m1.6.6.6.6.6.6">𝑎</ci><ci id="S4.E31.m1.7.7.7.7.7.7.cmml" xref="S4.E31.m1.7.7.7.7.7.7">𝑚</ci><ci id="S4.E31.m1.8.8.8.8.8.8.cmml" xref="S4.E31.m1.8.8.8.8.8.8">𝑝</ci><ci id="S4.E31.m1.9.9.9.9.9.9.cmml" xref="S4.E31.m1.9.9.9.9.9.9">𝑙</ci><apply id="S4.E31.m1.92.92.1.1.1.1.1.1.1.1.1.7.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.1.1.1.1.1.1.7.1.cmml">subscript</csymbol><ci id="S4.E31.m1.10.10.10.10.10.10.cmml" xref="S4.E31.m1.10.10.10.10.10.10">𝑒</ci><ci id="S4.E31.m1.11.11.11.11.11.11.1.cmml" xref="S4.E31.m1.11.11.11.11.11.11.1">𝑠</ci></apply></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.1.1.5.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.1.1.5.1.cmml">subscript</csymbol><ci id="S4.E31.m1.14.14.14.14.14.14.cmml" xref="S4.E31.m1.14.14.14.14.14.14">𝐿</ci><ci id="S4.E31.m1.15.15.15.15.15.15.1.cmml" xref="S4.E31.m1.15.15.15.15.15.15.1">𝑠</ci></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.1.1c.cmml"><eq id="S4.E31.m1.16.16.16.16.16.16.cmml" xref="S4.E31.m1.16.16.16.16.16.16"></eq><share href="https://arxiv.org/html/2404.18214v2#S4.E31.m1.92.92.1.1.1.1.1.5.cmml" id="S4.E31.m1.92.92.1.1.1.1.1d.cmml"></share><apply id="S4.E31.m1.92.92.1.1.1.1.1.2.2.cmml"><floor id="S4.E31.m1.92.92.1.1.1.1.1.2.2.1.cmml"></floor><apply id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.cmml"><times id="S4.E31.m1.20.20.20.20.20.20.cmml" xref="S4.E31.m1.20.20.20.20.20.20"></times><apply id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E31.m1.18.18.18.18.18.18.cmml" xref="S4.E31.m1.18.18.18.18.18.18">𝛾</ci><ci id="S4.E31.m1.19.19.19.19.19.19.1.cmml" xref="S4.E31.m1.19.19.19.19.19.19.1">𝑠</ci></apply><apply id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.1.2.cmml"><abs id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.1.2.1.cmml"></abs><apply id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.1.1.2.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E31.m1.22.22.22.22.22.22.cmml" xref="S4.E31.m1.22.22.22.22.22.22">𝐻</ci><ci id="S4.E31.m1.23.23.23.23.23.23.1.cmml" xref="S4.E31.m1.23.23.23.23.23.23.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.cmml"><eq id="S4.E31.m1.34.34.34.8.8.8.cmml" xref="S4.E31.m1.34.34.34.8.8.8"></eq><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.4.cmml"><times id="S4.E31.m1.92.92.1.1.1.2.2.1.1.4.1.cmml"></times><ci id="S4.E31.m1.27.27.27.1.1.1.cmml" xref="S4.E31.m1.27.27.27.1.1.1">𝑆</ci><ci id="S4.E31.m1.28.28.28.2.2.2.cmml" xref="S4.E31.m1.28.28.28.2.2.2">𝑎</ci><ci id="S4.E31.m1.29.29.29.3.3.3.cmml" xref="S4.E31.m1.29.29.29.3.3.3">𝑚</ci><ci id="S4.E31.m1.30.30.30.4.4.4.cmml" xref="S4.E31.m1.30.30.30.4.4.4">𝑝</ci><ci id="S4.E31.m1.31.31.31.5.5.5.cmml" xref="S4.E31.m1.31.31.31.5.5.5">𝑙</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.4.7.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.4.7.1.cmml">subscript</csymbol><ci id="S4.E31.m1.32.32.32.6.6.6.cmml" xref="S4.E31.m1.32.32.32.6.6.6">𝑒</ci><ci id="S4.E31.m1.33.33.33.7.7.7.1.cmml" xref="S4.E31.m1.33.33.33.7.7.7.1">𝑠</ci></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.3.cmml"><csymbol cd="latexml" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.3.1.cmml">conditional-set</csymbol><list id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.4.cmml"><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S4.E31.m1.36.36.36.10.10.10.cmml" xref="S4.E31.m1.36.36.36.10.10.10">𝑆</ci><cn id="S4.E31.m1.37.37.37.11.11.11.1.cmml" type="integer" xref="S4.E31.m1.37.37.37.11.11.11.1">1</cn></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E31.m1.39.39.39.13.13.13.cmml" xref="S4.E31.m1.39.39.39.13.13.13">𝑆</ci><cn id="S4.E31.m1.40.40.40.14.14.14.1.cmml" type="integer" xref="S4.E31.m1.40.40.40.14.14.14.1">2</cn></apply><ci id="S4.E31.m1.42.42.42.16.16.16.cmml" xref="S4.E31.m1.42.42.42.16.16.16">…</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S4.E31.m1.44.44.44.18.18.18.cmml" xref="S4.E31.m1.44.44.44.18.18.18">𝑆</ci><apply id="S4.E31.m1.45.45.45.19.19.19.1.cmml" xref="S4.E31.m1.45.45.45.19.19.19.1"><csymbol cd="ambiguous" id="S4.E31.m1.45.45.45.19.19.19.1.1.cmml" xref="S4.E31.m1.45.45.45.19.19.19.1">subscript</csymbol><ci id="S4.E31.m1.45.45.45.19.19.19.1.2.cmml" xref="S4.E31.m1.45.45.45.19.19.19.1.2">𝐿</ci><ci id="S4.E31.m1.45.45.45.19.19.19.1.3.cmml" xref="S4.E31.m1.45.45.45.19.19.19.1.3">𝑠</ci></apply></apply></list><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.cmml"><in id="S4.E31.m1.49.49.49.23.23.23.cmml" xref="S4.E31.m1.49.49.49.23.23.23"></in><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E31.m1.47.47.47.21.21.21.cmml" xref="S4.E31.m1.47.47.47.21.21.21">𝑆</ci><ci id="S4.E31.m1.48.48.48.22.22.22.1.cmml" xref="S4.E31.m1.48.48.48.22.22.22.1">𝑖</ci></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.1.cmml"><minus id="S4.E31.m1.54.54.54.28.28.28.cmml" xref="S4.E31.m1.54.54.54.28.28.28"></minus><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.1.1.2.cmml"><abs id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.1.1.2.1.cmml"></abs><apply id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.1.1.2.2.2.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E31.m1.51.51.51.25.25.25.cmml" xref="S4.E31.m1.51.51.51.25.25.25">𝐻</ci><ci id="S4.E31.m1.52.52.52.26.26.26.1.cmml" xref="S4.E31.m1.52.52.52.26.26.26.1">𝑢</ci></apply></apply><cn id="S4.E31.m1.55.55.55.29.29.29.cmml" type="integer" xref="S4.E31.m1.55.55.55.29.29.29">1</cn></apply></apply></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.cmml"><eq id="S4.E31.m1.65.65.65.1.1.1.cmml" xref="S4.E31.m1.65.65.65.1.1.1"></eq><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.cmml"><times id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.2.cmml"></times><ci id="S4.E31.m1.58.58.58.1.1.1.cmml" xref="S4.E31.m1.58.58.58.1.1.1">𝐴</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.4.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.4.1.cmml">subscript</csymbol><ci id="S4.E31.m1.59.59.59.2.2.2.cmml" xref="S4.E31.m1.59.59.59.2.2.2">𝑂</ci><apply id="S4.E31.m1.60.60.60.3.3.3.1.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1"><times id="S4.E31.m1.60.60.60.3.3.3.1.1.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.1"></times><ci id="S4.E31.m1.60.60.60.3.3.3.1.2.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.2">𝑆</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.3.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.3">𝑢</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.4.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.4">𝑏</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.5.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.5">𝑠</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.6.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.6">𝑡</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.7.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.7">𝑖</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.8.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.8">𝑡</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.9.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.9">𝑢</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.10.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.10">𝑡</ci><ci id="S4.E31.m1.60.60.60.3.3.3.1.11.cmml" xref="S4.E31.m1.60.60.60.3.3.3.1.11">𝑒</ci></apply></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E31.m1.62.62.62.5.5.5.cmml" xref="S4.E31.m1.62.62.62.5.5.5">𝐻</ci><ci id="S4.E31.m1.63.63.63.6.6.6.1.cmml" xref="S4.E31.m1.63.63.63.6.6.6.1">𝑢</ci></apply></apply><list id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.3.3.cmml"><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E31.m1.67.67.67.3.3.3.cmml" xref="S4.E31.m1.67.67.67.3.3.3">𝐻</ci><cn id="S4.E31.m1.68.68.68.4.4.4.1.cmml" type="integer" xref="S4.E31.m1.68.68.68.4.4.4.1">1</cn></apply><ci id="S4.E31.m1.69.69.69.5.5.5.1.cmml" xref="S4.E31.m1.69.69.69.5.5.5.1">𝑢</ci></apply><ci id="S4.E31.m1.71.71.71.7.7.7.cmml" xref="S4.E31.m1.71.71.71.7.7.7">…</ci><apply id="S4.E31.m1.73.73.73.9.9.9.cmml" xref="S4.E31.m1.73.73.73.9.9.9"><ci id="S4.E31.m1.73.73.73.9.9.9.1.cmml" xref="S4.E31.m1.73.73.73.9.9.9.1">^</ci><apply id="S4.E31.m1.73.73.73.9.9.9.2.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2"><csymbol cd="ambiguous" id="S4.E31.m1.73.73.73.9.9.9.2.1.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2">superscript</csymbol><apply id="S4.E31.m1.73.73.73.9.9.9.2.2.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2"><csymbol cd="ambiguous" id="S4.E31.m1.73.73.73.9.9.9.2.2.1.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2">subscript</csymbol><ci id="S4.E31.m1.73.73.73.9.9.9.2.2.2.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2.2.2">𝐻</ci><ci id="S4.E31.m1.73.73.73.9.9.9.2.2.3.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2.2.3">𝑆</ci></apply><ci id="S4.E31.m1.73.73.73.9.9.9.2.3.cmml" xref="S4.E31.m1.73.73.73.9.9.9.2.3">𝑢</ci></apply></apply><ci id="S4.E31.m1.75.75.75.11.11.11.cmml" xref="S4.E31.m1.75.75.75.11.11.11">…</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.3.2.2.1.cmml">superscript</csymbol><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.3.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.1.1.3.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E31.m1.77.77.77.13.13.13.cmml" xref="S4.E31.m1.77.77.77.13.13.13">𝐻</ci><apply id="S4.E31.m1.78.78.78.14.14.14.1.2.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1"><abs id="S4.E31.m1.78.78.78.14.14.14.1.2.1.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1.2"></abs><apply id="S4.E31.m1.78.78.78.14.14.14.1.1.1.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1"><csymbol cd="ambiguous" id="S4.E31.m1.78.78.78.14.14.14.1.1.1.1.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1">superscript</csymbol><ci id="S4.E31.m1.78.78.78.14.14.14.1.1.1.2.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1.2">𝐻</ci><ci id="S4.E31.m1.78.78.78.14.14.14.1.1.1.3.cmml" xref="S4.E31.m1.78.78.78.14.14.14.1.1.1.3">𝑢</ci></apply></apply></apply><ci id="S4.E31.m1.79.79.79.15.15.15.1.cmml" xref="S4.E31.m1.79.79.79.15.15.15.1">𝑢</ci></apply></list></apply><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.2.2.cmml"><in id="S4.E31.m1.83.83.83.19.19.19.cmml" xref="S4.E31.m1.83.83.83.19.19.19"></in><ci id="S4.E31.m1.82.82.82.18.18.18.cmml" xref="S4.E31.m1.82.82.82.18.18.18">𝑆</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.2.2.3.cmml"><times id="S4.E31.m1.92.92.1.1.1.2.2.2.2.2.2.3.1.cmml"></times><ci id="S4.E31.m1.84.84.84.20.20.20.cmml" xref="S4.E31.m1.84.84.84.20.20.20">𝑆</ci><ci id="S4.E31.m1.85.85.85.21.21.21.cmml" xref="S4.E31.m1.85.85.85.21.21.21">𝑎</ci><ci id="S4.E31.m1.86.86.86.22.22.22.cmml" xref="S4.E31.m1.86.86.86.22.22.22">𝑚</ci><ci id="S4.E31.m1.87.87.87.23.23.23.cmml" xref="S4.E31.m1.87.87.87.23.23.23">𝑝</ci><ci id="S4.E31.m1.88.88.88.24.24.24.cmml" xref="S4.E31.m1.88.88.88.24.24.24">𝑙</ci><apply id="S4.E31.m1.92.92.1.1.1.2.2.2.2.2.2.3.7.cmml"><csymbol cd="ambiguous" id="S4.E31.m1.92.92.1.1.1.2.2.2.2.2.2.3.7.1.cmml">subscript</csymbol><ci id="S4.E31.m1.89.89.89.25.25.25.cmml" xref="S4.E31.m1.89.89.89.25.25.25">𝑒</ci><ci id="S4.E31.m1.90.90.90.26.26.26.1.cmml" xref="S4.E31.m1.90.90.90.26.26.26.1">𝑠</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E31.m1.96c">\begin{split}&amp;Len({Sample}_{s})=L_{s}=\lfloor{\gamma_{s}\times|H^{u}|}\rfloor,%
\\
&amp;{Sample}_{s}=\{S_{1},S_{2},\dots,S_{L_{s}}|S_{i}\in|H^{u}|-1\},\\
&amp;AO_{Substitute}(H^{u})\\
&amp;=\bigl{[}H_{1}^{u},\dots,\widehat{H_{S}^{u}},\dots,H_{|H^{u}|}^{u}\bigr{]},S%
\in{Sample}_{s}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E31.m1.96d">start_ROW start_CELL end_CELL start_CELL italic_L italic_e italic_n ( italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) = italic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = ⌊ italic_γ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT × | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | ⌋ , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = { italic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_S start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | - 1 } , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_A italic_O start_POSTSUBSCRIPT italic_S italic_u italic_b italic_s italic_t italic_i italic_t italic_u italic_t italic_e end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = [ italic_H start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , over^ start_ARG italic_H start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT end_ARG , … , italic_H start_POSTSUBSCRIPT | italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] , italic_S ∈ italic_S italic_a italic_m italic_p italic_l italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p6">
<p class="ltx_p" id="S4.SS4.SSS2.p6.5">Let <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p6.1.m1.1"><semantics id="S4.SS4.SSS2.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS2.p6.1.m1.1.1" xref="S4.SS4.SSS2.p6.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p6.1.m1.1b"><ci id="S4.SS4.SSS2.p6.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p6.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p6.1.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p6.1.m1.1d">caligraphic_A</annotation></semantics></math> be a randomly selected augmentation operator from <math alttext="AO" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p6.2.m2.1"><semantics id="S4.SS4.SSS2.p6.2.m2.1a"><mrow id="S4.SS4.SSS2.p6.2.m2.1.1" xref="S4.SS4.SSS2.p6.2.m2.1.1.cmml"><mi id="S4.SS4.SSS2.p6.2.m2.1.1.2" xref="S4.SS4.SSS2.p6.2.m2.1.1.2.cmml">A</mi><mo id="S4.SS4.SSS2.p6.2.m2.1.1.1" xref="S4.SS4.SSS2.p6.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p6.2.m2.1.1.3" xref="S4.SS4.SSS2.p6.2.m2.1.1.3.cmml">O</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p6.2.m2.1b"><apply id="S4.SS4.SSS2.p6.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p6.2.m2.1.1"><times id="S4.SS4.SSS2.p6.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p6.2.m2.1.1.1"></times><ci id="S4.SS4.SSS2.p6.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p6.2.m2.1.1.2">𝐴</ci><ci id="S4.SS4.SSS2.p6.2.m2.1.1.3.cmml" xref="S4.SS4.SSS2.p6.2.m2.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p6.2.m2.1c">AO</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p6.2.m2.1d">italic_A italic_O</annotation></semantics></math>, and each batch of sequences <math alttext="{\{H^{u}\}}_{u=1}^{N}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p6.3.m3.1"><semantics id="S4.SS4.SSS2.p6.3.m3.1a"><msubsup id="S4.SS4.SSS2.p6.3.m3.1.1" xref="S4.SS4.SSS2.p6.3.m3.1.1.cmml"><mrow id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.2.cmml"><mo id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.2.cmml">{</mo><msup id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.2" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.2.cmml">H</mi><mi id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.3" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS4.SSS2.p6.3.m3.1.1.1.3" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.cmml"><mi id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.2" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.2.cmml">u</mi><mo id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.1" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.3" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS4.SSS2.p6.3.m3.1.1.3" xref="S4.SS4.SSS2.p6.3.m3.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p6.3.m3.1b"><apply id="S4.SS4.SSS2.p6.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p6.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p6.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p6.3.m3.1.1.1.2.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1">subscript</csymbol><set id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.2.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1"><apply id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.2">𝐻</ci><ci id="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.1.1.1.3">𝑢</ci></apply></set><apply id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3"><eq id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.1.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.1"></eq><ci id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.2.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.2">𝑢</ci><cn id="S4.SS4.SSS2.p6.3.m3.1.1.1.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p6.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS4.SSS2.p6.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p6.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p6.3.m3.1c">{\{H^{u}\}}_{u=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p6.3.m3.1d">{ italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_u = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p6.4.m4.1"><semantics id="S4.SS4.SSS2.p6.4.m4.1a"><mi id="S4.SS4.SSS2.p6.4.m4.1.1" xref="S4.SS4.SSS2.p6.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p6.4.m4.1b"><ci id="S4.SS4.SSS2.p6.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p6.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p6.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p6.4.m4.1d">italic_N</annotation></semantics></math> users is input into the sequence contrastive learning module, and each time two kinds of <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p6.5.m5.1"><semantics id="S4.SS4.SSS2.p6.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS2.p6.5.m5.1.1" xref="S4.SS4.SSS2.p6.5.m5.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p6.5.m5.1b"><ci id="S4.SS4.SSS2.p6.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p6.5.m5.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p6.5.m5.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p6.5.m5.1d">caligraphic_A</annotation></semantics></math> are selected to generate the augmented sequences:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}\mathcal{A}_{1}(\{H^{u}\})=[H_{a_{1}}^{1},\dots,H_{a_{1}}^{u},%
\dots,H_{a_{1}}^{N}],\\
\mathcal{A}_{2}(\{H^{u}\})=[H_{a_{2}}^{1},\dots,H_{a_{2}}^{u},\dots,H_{a_{2}}^%
{N}].\end{split}" class="ltx_Math" display="block" id="S4.E32.m1.57"><semantics id="S4.E32.m1.57a"><mtable displaystyle="true" id="S4.E32.m1.57.57.3" rowspacing="0pt"><mtr id="S4.E32.m1.57.57.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E32.m1.57.57.3b"><mrow id="S4.E32.m1.56.56.2.55.28.28.28"><mrow id="S4.E32.m1.56.56.2.55.28.28.28.1"><mrow id="S4.E32.m1.56.56.2.55.28.28.28.1.1"><msub id="S4.E32.m1.56.56.2.55.28.28.28.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S4.E32.m1.1.1.1.1.1.1" xref="S4.E32.m1.1.1.1.1.1.1.cmml">𝒜</mi><mn id="S4.E32.m1.2.2.2.2.2.2.1" xref="S4.E32.m1.2.2.2.2.2.2.1.cmml">1</mn></msub><mo id="S4.E32.m1.56.56.2.55.28.28.28.1.1.2">⁢</mo><mrow id="S4.E32.m1.56.56.2.55.28.28.28.1.1.1.1"><mo id="S4.E32.m1.3.3.3.3.3.3" stretchy="false">(</mo><mrow id="S4.E32.m1.56.56.2.55.28.28.28.1.1.1.1.1"><mo id="S4.E32.m1.4.4.4.4.4.4" stretchy="false">{</mo><msup id="S4.E32.m1.56.56.2.55.28.28.28.1.1.1.1.1.1.1"><mi id="S4.E32.m1.5.5.5.5.5.5" xref="S4.E32.m1.5.5.5.5.5.5.cmml">H</mi><mi id="S4.E32.m1.6.6.6.6.6.6.1" xref="S4.E32.m1.6.6.6.6.6.6.1.cmml">u</mi></msup><mo id="S4.E32.m1.7.7.7.7.7.7" stretchy="false">}</mo></mrow><mo id="S4.E32.m1.8.8.8.8.8.8" stretchy="false">)</mo></mrow></mrow><mo id="S4.E32.m1.9.9.9.9.9.9" xref="S4.E32.m1.9.9.9.9.9.9.cmml">=</mo><mrow id="S4.E32.m1.56.56.2.55.28.28.28.1.4.3"><mo id="S4.E32.m1.10.10.10.10.10.10" stretchy="false">[</mo><msubsup id="S4.E32.m1.56.56.2.55.28.28.28.1.2.1.1"><mi id="S4.E32.m1.11.11.11.11.11.11" xref="S4.E32.m1.11.11.11.11.11.11.cmml">H</mi><msub id="S4.E32.m1.12.12.12.12.12.12.1" xref="S4.E32.m1.12.12.12.12.12.12.1.cmml"><mi id="S4.E32.m1.12.12.12.12.12.12.1.2" xref="S4.E32.m1.12.12.12.12.12.12.1.2.cmml">a</mi><mn id="S4.E32.m1.12.12.12.12.12.12.1.3" xref="S4.E32.m1.12.12.12.12.12.12.1.3.cmml">1</mn></msub><mn id="S4.E32.m1.13.13.13.13.13.13.1" xref="S4.E32.m1.13.13.13.13.13.13.1.cmml">1</mn></msubsup><mo id="S4.E32.m1.14.14.14.14.14.14">,</mo><mi id="S4.E32.m1.15.15.15.15.15.15" mathvariant="normal" xref="S4.E32.m1.15.15.15.15.15.15.cmml">…</mi><mo id="S4.E32.m1.16.16.16.16.16.16">,</mo><msubsup id="S4.E32.m1.56.56.2.55.28.28.28.1.3.2.2"><mi id="S4.E32.m1.17.17.17.17.17.17" xref="S4.E32.m1.17.17.17.17.17.17.cmml">H</mi><msub id="S4.E32.m1.18.18.18.18.18.18.1" xref="S4.E32.m1.18.18.18.18.18.18.1.cmml"><mi id="S4.E32.m1.18.18.18.18.18.18.1.2" xref="S4.E32.m1.18.18.18.18.18.18.1.2.cmml">a</mi><mn id="S4.E32.m1.18.18.18.18.18.18.1.3" xref="S4.E32.m1.18.18.18.18.18.18.1.3.cmml">1</mn></msub><mi id="S4.E32.m1.19.19.19.19.19.19.1" xref="S4.E32.m1.19.19.19.19.19.19.1.cmml">u</mi></msubsup><mo id="S4.E32.m1.20.20.20.20.20.20">,</mo><mi id="S4.E32.m1.21.21.21.21.21.21" mathvariant="normal" xref="S4.E32.m1.21.21.21.21.21.21.cmml">…</mi><mo id="S4.E32.m1.22.22.22.22.22.22">,</mo><msubsup id="S4.E32.m1.56.56.2.55.28.28.28.1.4.3.3"><mi id="S4.E32.m1.23.23.23.23.23.23" xref="S4.E32.m1.23.23.23.23.23.23.cmml">H</mi><msub id="S4.E32.m1.24.24.24.24.24.24.1" xref="S4.E32.m1.24.24.24.24.24.24.1.cmml"><mi id="S4.E32.m1.24.24.24.24.24.24.1.2" xref="S4.E32.m1.24.24.24.24.24.24.1.2.cmml">a</mi><mn id="S4.E32.m1.24.24.24.24.24.24.1.3" xref="S4.E32.m1.24.24.24.24.24.24.1.3.cmml">1</mn></msub><mi id="S4.E32.m1.25.25.25.25.25.25.1" xref="S4.E32.m1.25.25.25.25.25.25.1.cmml">N</mi></msubsup><mo id="S4.E32.m1.26.26.26.26.26.26" stretchy="false">]</mo></mrow></mrow><mo id="S4.E32.m1.27.27.27.27.27.27">,</mo></mrow></mtd></mtr><mtr id="S4.E32.m1.57.57.3c"><mtd class="ltx_align_right" columnalign="right" id="S4.E32.m1.57.57.3d"><mrow id="S4.E32.m1.57.57.3.56.28.28.28"><mrow id="S4.E32.m1.57.57.3.56.28.28.28.1"><mrow id="S4.E32.m1.57.57.3.56.28.28.28.1.1"><msub id="S4.E32.m1.57.57.3.56.28.28.28.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S4.E32.m1.28.28.28.1.1.1" xref="S4.E32.m1.28.28.28.1.1.1.cmml">𝒜</mi><mn id="S4.E32.m1.29.29.29.2.2.2.1" xref="S4.E32.m1.29.29.29.2.2.2.1.cmml">2</mn></msub><mo id="S4.E32.m1.57.57.3.56.28.28.28.1.1.2">⁢</mo><mrow id="S4.E32.m1.57.57.3.56.28.28.28.1.1.1.1"><mo id="S4.E32.m1.30.30.30.3.3.3" stretchy="false">(</mo><mrow id="S4.E32.m1.57.57.3.56.28.28.28.1.1.1.1.1"><mo id="S4.E32.m1.31.31.31.4.4.4" stretchy="false">{</mo><msup id="S4.E32.m1.57.57.3.56.28.28.28.1.1.1.1.1.1.1"><mi id="S4.E32.m1.32.32.32.5.5.5" xref="S4.E32.m1.32.32.32.5.5.5.cmml">H</mi><mi id="S4.E32.m1.33.33.33.6.6.6.1" xref="S4.E32.m1.33.33.33.6.6.6.1.cmml">u</mi></msup><mo id="S4.E32.m1.34.34.34.7.7.7" stretchy="false">}</mo></mrow><mo id="S4.E32.m1.35.35.35.8.8.8" stretchy="false">)</mo></mrow></mrow><mo id="S4.E32.m1.36.36.36.9.9.9" xref="S4.E32.m1.36.36.36.9.9.9.cmml">=</mo><mrow id="S4.E32.m1.57.57.3.56.28.28.28.1.4.3"><mo id="S4.E32.m1.37.37.37.10.10.10" stretchy="false">[</mo><msubsup id="S4.E32.m1.57.57.3.56.28.28.28.1.2.1.1"><mi id="S4.E32.m1.38.38.38.11.11.11" xref="S4.E32.m1.38.38.38.11.11.11.cmml">H</mi><msub id="S4.E32.m1.39.39.39.12.12.12.1" xref="S4.E32.m1.39.39.39.12.12.12.1.cmml"><mi id="S4.E32.m1.39.39.39.12.12.12.1.2" xref="S4.E32.m1.39.39.39.12.12.12.1.2.cmml">a</mi><mn id="S4.E32.m1.39.39.39.12.12.12.1.3" xref="S4.E32.m1.39.39.39.12.12.12.1.3.cmml">2</mn></msub><mn id="S4.E32.m1.40.40.40.13.13.13.1" xref="S4.E32.m1.40.40.40.13.13.13.1.cmml">1</mn></msubsup><mo id="S4.E32.m1.41.41.41.14.14.14">,</mo><mi id="S4.E32.m1.42.42.42.15.15.15" mathvariant="normal" xref="S4.E32.m1.42.42.42.15.15.15.cmml">…</mi><mo id="S4.E32.m1.43.43.43.16.16.16">,</mo><msubsup id="S4.E32.m1.57.57.3.56.28.28.28.1.3.2.2"><mi id="S4.E32.m1.44.44.44.17.17.17" xref="S4.E32.m1.44.44.44.17.17.17.cmml">H</mi><msub id="S4.E32.m1.45.45.45.18.18.18.1" xref="S4.E32.m1.45.45.45.18.18.18.1.cmml"><mi id="S4.E32.m1.45.45.45.18.18.18.1.2" xref="S4.E32.m1.45.45.45.18.18.18.1.2.cmml">a</mi><mn id="S4.E32.m1.45.45.45.18.18.18.1.3" xref="S4.E32.m1.45.45.45.18.18.18.1.3.cmml">2</mn></msub><mi id="S4.E32.m1.46.46.46.19.19.19.1" xref="S4.E32.m1.46.46.46.19.19.19.1.cmml">u</mi></msubsup><mo id="S4.E32.m1.47.47.47.20.20.20">,</mo><mi id="S4.E32.m1.48.48.48.21.21.21" mathvariant="normal" xref="S4.E32.m1.48.48.48.21.21.21.cmml">…</mi><mo id="S4.E32.m1.49.49.49.22.22.22">,</mo><msubsup id="S4.E32.m1.57.57.3.56.28.28.28.1.4.3.3"><mi id="S4.E32.m1.50.50.50.23.23.23" xref="S4.E32.m1.50.50.50.23.23.23.cmml">H</mi><msub id="S4.E32.m1.51.51.51.24.24.24.1" xref="S4.E32.m1.51.51.51.24.24.24.1.cmml"><mi id="S4.E32.m1.51.51.51.24.24.24.1.2" xref="S4.E32.m1.51.51.51.24.24.24.1.2.cmml">a</mi><mn id="S4.E32.m1.51.51.51.24.24.24.1.3" xref="S4.E32.m1.51.51.51.24.24.24.1.3.cmml">2</mn></msub><mi id="S4.E32.m1.52.52.52.25.25.25.1" xref="S4.E32.m1.52.52.52.25.25.25.1.cmml">N</mi></msubsup><mo id="S4.E32.m1.53.53.53.26.26.26" stretchy="false">]</mo></mrow></mrow><mo id="S4.E32.m1.54.54.54.27.27.27" lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E32.m1.57b"><apply id="S4.E32.m1.55.55.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E32.m1.55.55.1.1.1.1.1.cmml"><eq id="S4.E32.m1.9.9.9.9.9.9.cmml" xref="S4.E32.m1.9.9.9.9.9.9"></eq><apply id="S4.E32.m1.55.55.1.1.1.1.1.1.cmml"><times id="S4.E32.m1.55.55.1.1.1.1.1.1.2.cmml"></times><apply id="S4.E32.m1.55.55.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E32.m1.1.1.1.1.1.1.cmml" xref="S4.E32.m1.1.1.1.1.1.1">𝒜</ci><cn id="S4.E32.m1.2.2.2.2.2.2.1.cmml" type="integer" xref="S4.E32.m1.2.2.2.2.2.2.1">1</cn></apply><set id="S4.E32.m1.55.55.1.1.1.1.1.1.1.1.1.2.cmml"><apply id="S4.E32.m1.55.55.1.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E32.m1.5.5.5.5.5.5.cmml" xref="S4.E32.m1.5.5.5.5.5.5">𝐻</ci><ci id="S4.E32.m1.6.6.6.6.6.6.1.cmml" xref="S4.E32.m1.6.6.6.6.6.6.1">𝑢</ci></apply></set></apply><list id="S4.E32.m1.55.55.1.1.1.1.1.4.4.cmml"><apply id="S4.E32.m1.55.55.1.1.1.1.1.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.1.1.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.11.11.11.11.11.11.cmml" xref="S4.E32.m1.11.11.11.11.11.11">𝐻</ci><apply id="S4.E32.m1.12.12.12.12.12.12.1.cmml" xref="S4.E32.m1.12.12.12.12.12.12.1"><csymbol cd="ambiguous" id="S4.E32.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.E32.m1.12.12.12.12.12.12.1">subscript</csymbol><ci id="S4.E32.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.E32.m1.12.12.12.12.12.12.1.2">𝑎</ci><cn id="S4.E32.m1.12.12.12.12.12.12.1.3.cmml" type="integer" xref="S4.E32.m1.12.12.12.12.12.12.1.3">1</cn></apply></apply><cn id="S4.E32.m1.13.13.13.13.13.13.1.cmml" type="integer" xref="S4.E32.m1.13.13.13.13.13.13.1">1</cn></apply><ci id="S4.E32.m1.15.15.15.15.15.15.cmml" xref="S4.E32.m1.15.15.15.15.15.15">…</ci><apply id="S4.E32.m1.55.55.1.1.1.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.3.2.2.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.1.1.3.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.3.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.17.17.17.17.17.17.cmml" xref="S4.E32.m1.17.17.17.17.17.17">𝐻</ci><apply id="S4.E32.m1.18.18.18.18.18.18.1.cmml" xref="S4.E32.m1.18.18.18.18.18.18.1"><csymbol cd="ambiguous" id="S4.E32.m1.18.18.18.18.18.18.1.1.cmml" xref="S4.E32.m1.18.18.18.18.18.18.1">subscript</csymbol><ci id="S4.E32.m1.18.18.18.18.18.18.1.2.cmml" xref="S4.E32.m1.18.18.18.18.18.18.1.2">𝑎</ci><cn id="S4.E32.m1.18.18.18.18.18.18.1.3.cmml" type="integer" xref="S4.E32.m1.18.18.18.18.18.18.1.3">1</cn></apply></apply><ci id="S4.E32.m1.19.19.19.19.19.19.1.cmml" xref="S4.E32.m1.19.19.19.19.19.19.1">𝑢</ci></apply><ci id="S4.E32.m1.21.21.21.21.21.21.cmml" xref="S4.E32.m1.21.21.21.21.21.21">…</ci><apply id="S4.E32.m1.55.55.1.1.1.1.1.4.3.3.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.4.3.3.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.1.1.4.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.1.1.4.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.23.23.23.23.23.23.cmml" xref="S4.E32.m1.23.23.23.23.23.23">𝐻</ci><apply id="S4.E32.m1.24.24.24.24.24.24.1.cmml" xref="S4.E32.m1.24.24.24.24.24.24.1"><csymbol cd="ambiguous" id="S4.E32.m1.24.24.24.24.24.24.1.1.cmml" xref="S4.E32.m1.24.24.24.24.24.24.1">subscript</csymbol><ci id="S4.E32.m1.24.24.24.24.24.24.1.2.cmml" xref="S4.E32.m1.24.24.24.24.24.24.1.2">𝑎</ci><cn id="S4.E32.m1.24.24.24.24.24.24.1.3.cmml" type="integer" xref="S4.E32.m1.24.24.24.24.24.24.1.3">1</cn></apply></apply><ci id="S4.E32.m1.25.25.25.25.25.25.1.cmml" xref="S4.E32.m1.25.25.25.25.25.25.1">𝑁</ci></apply></list></apply><apply id="S4.E32.m1.55.55.1.1.1.2.2.cmml"><eq id="S4.E32.m1.36.36.36.9.9.9.cmml" xref="S4.E32.m1.36.36.36.9.9.9"></eq><apply id="S4.E32.m1.55.55.1.1.1.2.2.1.cmml"><times id="S4.E32.m1.55.55.1.1.1.2.2.1.2.cmml"></times><apply id="S4.E32.m1.55.55.1.1.1.2.2.1.3.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.1.3.1.cmml">subscript</csymbol><ci id="S4.E32.m1.28.28.28.1.1.1.cmml" xref="S4.E32.m1.28.28.28.1.1.1">𝒜</ci><cn id="S4.E32.m1.29.29.29.2.2.2.1.cmml" type="integer" xref="S4.E32.m1.29.29.29.2.2.2.1">2</cn></apply><set id="S4.E32.m1.55.55.1.1.1.2.2.1.1.1.1.2.cmml"><apply id="S4.E32.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><ci id="S4.E32.m1.32.32.32.5.5.5.cmml" xref="S4.E32.m1.32.32.32.5.5.5">𝐻</ci><ci id="S4.E32.m1.33.33.33.6.6.6.1.cmml" xref="S4.E32.m1.33.33.33.6.6.6.1">𝑢</ci></apply></set></apply><list id="S4.E32.m1.55.55.1.1.1.2.2.4.4.cmml"><apply id="S4.E32.m1.55.55.1.1.1.2.2.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.2.1.1.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.2.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.38.38.38.11.11.11.cmml" xref="S4.E32.m1.38.38.38.11.11.11">𝐻</ci><apply id="S4.E32.m1.39.39.39.12.12.12.1.cmml" xref="S4.E32.m1.39.39.39.12.12.12.1"><csymbol cd="ambiguous" id="S4.E32.m1.39.39.39.12.12.12.1.1.cmml" xref="S4.E32.m1.39.39.39.12.12.12.1">subscript</csymbol><ci id="S4.E32.m1.39.39.39.12.12.12.1.2.cmml" xref="S4.E32.m1.39.39.39.12.12.12.1.2">𝑎</ci><cn id="S4.E32.m1.39.39.39.12.12.12.1.3.cmml" type="integer" xref="S4.E32.m1.39.39.39.12.12.12.1.3">2</cn></apply></apply><cn id="S4.E32.m1.40.40.40.13.13.13.1.cmml" type="integer" xref="S4.E32.m1.40.40.40.13.13.13.1">1</cn></apply><ci id="S4.E32.m1.42.42.42.15.15.15.cmml" xref="S4.E32.m1.42.42.42.15.15.15">…</ci><apply id="S4.E32.m1.55.55.1.1.1.2.2.3.2.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.3.2.2.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.2.2.3.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.3.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.44.44.44.17.17.17.cmml" xref="S4.E32.m1.44.44.44.17.17.17">𝐻</ci><apply id="S4.E32.m1.45.45.45.18.18.18.1.cmml" xref="S4.E32.m1.45.45.45.18.18.18.1"><csymbol cd="ambiguous" id="S4.E32.m1.45.45.45.18.18.18.1.1.cmml" xref="S4.E32.m1.45.45.45.18.18.18.1">subscript</csymbol><ci id="S4.E32.m1.45.45.45.18.18.18.1.2.cmml" xref="S4.E32.m1.45.45.45.18.18.18.1.2">𝑎</ci><cn id="S4.E32.m1.45.45.45.18.18.18.1.3.cmml" type="integer" xref="S4.E32.m1.45.45.45.18.18.18.1.3">2</cn></apply></apply><ci id="S4.E32.m1.46.46.46.19.19.19.1.cmml" xref="S4.E32.m1.46.46.46.19.19.19.1">𝑢</ci></apply><ci id="S4.E32.m1.48.48.48.21.21.21.cmml" xref="S4.E32.m1.48.48.48.21.21.21">…</ci><apply id="S4.E32.m1.55.55.1.1.1.2.2.4.3.3.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.4.3.3.1.cmml">superscript</csymbol><apply id="S4.E32.m1.55.55.1.1.1.2.2.4.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E32.m1.55.55.1.1.1.2.2.4.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E32.m1.50.50.50.23.23.23.cmml" xref="S4.E32.m1.50.50.50.23.23.23">𝐻</ci><apply id="S4.E32.m1.51.51.51.24.24.24.1.cmml" xref="S4.E32.m1.51.51.51.24.24.24.1"><csymbol cd="ambiguous" id="S4.E32.m1.51.51.51.24.24.24.1.1.cmml" xref="S4.E32.m1.51.51.51.24.24.24.1">subscript</csymbol><ci id="S4.E32.m1.51.51.51.24.24.24.1.2.cmml" xref="S4.E32.m1.51.51.51.24.24.24.1.2">𝑎</ci><cn id="S4.E32.m1.51.51.51.24.24.24.1.3.cmml" type="integer" xref="S4.E32.m1.51.51.51.24.24.24.1.3">2</cn></apply></apply><ci id="S4.E32.m1.52.52.52.25.25.25.1.cmml" xref="S4.E32.m1.52.52.52.25.25.25.1">𝑁</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E32.m1.57c">\begin{split}\mathcal{A}_{1}(\{H^{u}\})=[H_{a_{1}}^{1},\dots,H_{a_{1}}^{u},%
\dots,H_{a_{1}}^{N}],\\
\mathcal{A}_{2}(\{H^{u}\})=[H_{a_{2}}^{1},\dots,H_{a_{2}}^{u},\dots,H_{a_{2}}^%
{N}].\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E32.m1.57d">start_ROW start_CELL caligraphic_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( { italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT } ) = [ italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ] , end_CELL end_ROW start_ROW start_CELL caligraphic_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( { italic_H start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT } ) = [ italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ] . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p7">
<p class="ltx_p" id="S4.SS4.SSS2.p7.5">For <math alttext="u" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p7.1.m1.1"><semantics id="S4.SS4.SSS2.p7.1.m1.1a"><mi id="S4.SS4.SSS2.p7.1.m1.1.1" xref="S4.SS4.SSS2.p7.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p7.1.m1.1b"><ci id="S4.SS4.SSS2.p7.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p7.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p7.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p7.1.m1.1d">italic_u</annotation></semantics></math>, <math alttext="2N" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p7.2.m2.1"><semantics id="S4.SS4.SSS2.p7.2.m2.1a"><mrow id="S4.SS4.SSS2.p7.2.m2.1.1" xref="S4.SS4.SSS2.p7.2.m2.1.1.cmml"><mn id="S4.SS4.SSS2.p7.2.m2.1.1.2" xref="S4.SS4.SSS2.p7.2.m2.1.1.2.cmml">2</mn><mo id="S4.SS4.SSS2.p7.2.m2.1.1.1" xref="S4.SS4.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p7.2.m2.1.1.3" xref="S4.SS4.SSS2.p7.2.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p7.2.m2.1b"><apply id="S4.SS4.SSS2.p7.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p7.2.m2.1.1"><times id="S4.SS4.SSS2.p7.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p7.2.m2.1.1.1"></times><cn id="S4.SS4.SSS2.p7.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.SSS2.p7.2.m2.1.1.2">2</cn><ci id="S4.SS4.SSS2.p7.2.m2.1.1.3.cmml" xref="S4.SS4.SSS2.p7.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p7.2.m2.1c">2N</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p7.2.m2.1d">2 italic_N</annotation></semantics></math> augmented sequences are obtained, only <math alttext="2" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p7.3.m3.1"><semantics id="S4.SS4.SSS2.p7.3.m3.1a"><mn id="S4.SS4.SSS2.p7.3.m3.1.1" xref="S4.SS4.SSS2.p7.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p7.3.m3.1b"><cn id="S4.SS4.SSS2.p7.3.m3.1.1.cmml" type="integer" xref="S4.SS4.SSS2.p7.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p7.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p7.3.m3.1d">2</annotation></semantics></math> of which belong to itself and the remaining <math alttext="2(N-1)" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p7.4.m4.1"><semantics id="S4.SS4.SSS2.p7.4.m4.1a"><mrow id="S4.SS4.SSS2.p7.4.m4.1.1" xref="S4.SS4.SSS2.p7.4.m4.1.1.cmml"><mn id="S4.SS4.SSS2.p7.4.m4.1.1.3" xref="S4.SS4.SSS2.p7.4.m4.1.1.3.cmml">2</mn><mo id="S4.SS4.SSS2.p7.4.m4.1.1.2" xref="S4.SS4.SSS2.p7.4.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS2.p7.4.m4.1.1.1.1" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.2" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.2.cmml">N</mi><mo id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.1" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.3" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p7.4.m4.1b"><apply id="S4.SS4.SSS2.p7.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p7.4.m4.1.1"><times id="S4.SS4.SSS2.p7.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p7.4.m4.1.1.2"></times><cn id="S4.SS4.SSS2.p7.4.m4.1.1.3.cmml" type="integer" xref="S4.SS4.SSS2.p7.4.m4.1.1.3">2</cn><apply id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1"><minus id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.1"></minus><ci id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.2">𝑁</ci><cn id="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS4.SSS2.p7.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p7.4.m4.1c">2(N-1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p7.4.m4.1d">2 ( italic_N - 1 )</annotation></semantics></math> are not. The sequences belonging to <math alttext="u" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p7.5.m5.1"><semantics id="S4.SS4.SSS2.p7.5.m5.1a"><mi id="S4.SS4.SSS2.p7.5.m5.1.1" xref="S4.SS4.SSS2.p7.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p7.5.m5.1b"><ci id="S4.SS4.SSS2.p7.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p7.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p7.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p7.5.m5.1d">italic_u</annotation></semantics></math> itself are extracted as positive samples and the other sequences as negative samples, which are input to the encoder given by Sect.<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S4.SS2" title="4.2 Embedded Layer ‣ 4 Methodology ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">4.2</span></a> to generate the augmented sequence features:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;e_{pos_{1}}^{u}=\mathrm{Encoder}(H_{a_{1}}^{u}),e_{pos_{2}}^{u}=%
\mathrm{Encoder}(H_{a_{2}}^{u}),\\
&amp;e_{neg}^{u}=\mathrm{Encoder}(H_{neg}^{u}),\end{split}" class="ltx_Math" display="block" id="S4.E33.m1.36"><semantics id="S4.E33.m1.36a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E33.m1.36.36.3" rowspacing="0pt"><mtr id="S4.E33.m1.36.36.3a"><mtd id="S4.E33.m1.36.36.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E33.m1.36.36.3c"><mrow id="S4.E33.m1.35.35.2.34.23.23.23"><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1"><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1"><msubsup id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1.2"><mi id="S4.E33.m1.1.1.1.1.1.1" xref="S4.E33.m1.1.1.1.1.1.1.cmml">e</mi><mrow id="S4.E33.m1.2.2.2.2.2.2.1" xref="S4.E33.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E33.m1.2.2.2.2.2.2.1.2" xref="S4.E33.m1.2.2.2.2.2.2.1.2.cmml">p</mi><mo id="S4.E33.m1.2.2.2.2.2.2.1.1" xref="S4.E33.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E33.m1.2.2.2.2.2.2.1.3" xref="S4.E33.m1.2.2.2.2.2.2.1.3.cmml">o</mi><mo id="S4.E33.m1.2.2.2.2.2.2.1.1a" xref="S4.E33.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><msub id="S4.E33.m1.2.2.2.2.2.2.1.4" xref="S4.E33.m1.2.2.2.2.2.2.1.4.cmml"><mi id="S4.E33.m1.2.2.2.2.2.2.1.4.2" xref="S4.E33.m1.2.2.2.2.2.2.1.4.2.cmml">s</mi><mn id="S4.E33.m1.2.2.2.2.2.2.1.4.3" xref="S4.E33.m1.2.2.2.2.2.2.1.4.3.cmml">1</mn></msub></mrow><mi id="S4.E33.m1.3.3.3.3.3.3.1" xref="S4.E33.m1.3.3.3.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.4.4.4.4.4.4" xref="S4.E33.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1.1"><mi id="S4.E33.m1.5.5.5.5.5.5" xref="S4.E33.m1.5.5.5.5.5.5.cmml">Encoder</mi><mo id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1.1.2">⁢</mo><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1.1.1.1"><mo id="S4.E33.m1.6.6.6.6.6.6" stretchy="false">(</mo><msubsup id="S4.E33.m1.35.35.2.34.23.23.23.1.1.1.1.1.1.1"><mi id="S4.E33.m1.7.7.7.7.7.7" xref="S4.E33.m1.7.7.7.7.7.7.cmml">H</mi><msub id="S4.E33.m1.8.8.8.8.8.8.1" xref="S4.E33.m1.8.8.8.8.8.8.1.cmml"><mi id="S4.E33.m1.8.8.8.8.8.8.1.2" xref="S4.E33.m1.8.8.8.8.8.8.1.2.cmml">a</mi><mn id="S4.E33.m1.8.8.8.8.8.8.1.3" xref="S4.E33.m1.8.8.8.8.8.8.1.3.cmml">1</mn></msub><mi id="S4.E33.m1.9.9.9.9.9.9.1" xref="S4.E33.m1.9.9.9.9.9.9.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.10.10.10.10.10.10" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E33.m1.11.11.11.11.11.11">,</mo><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2"><msubsup id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2.2"><mi id="S4.E33.m1.12.12.12.12.12.12" xref="S4.E33.m1.12.12.12.12.12.12.cmml">e</mi><mrow id="S4.E33.m1.13.13.13.13.13.13.1" xref="S4.E33.m1.13.13.13.13.13.13.1.cmml"><mi id="S4.E33.m1.13.13.13.13.13.13.1.2" xref="S4.E33.m1.13.13.13.13.13.13.1.2.cmml">p</mi><mo id="S4.E33.m1.13.13.13.13.13.13.1.1" xref="S4.E33.m1.13.13.13.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E33.m1.13.13.13.13.13.13.1.3" xref="S4.E33.m1.13.13.13.13.13.13.1.3.cmml">o</mi><mo id="S4.E33.m1.13.13.13.13.13.13.1.1a" xref="S4.E33.m1.13.13.13.13.13.13.1.1.cmml">⁢</mo><msub id="S4.E33.m1.13.13.13.13.13.13.1.4" xref="S4.E33.m1.13.13.13.13.13.13.1.4.cmml"><mi id="S4.E33.m1.13.13.13.13.13.13.1.4.2" xref="S4.E33.m1.13.13.13.13.13.13.1.4.2.cmml">s</mi><mn id="S4.E33.m1.13.13.13.13.13.13.1.4.3" xref="S4.E33.m1.13.13.13.13.13.13.1.4.3.cmml">2</mn></msub></mrow><mi id="S4.E33.m1.14.14.14.14.14.14.1" xref="S4.E33.m1.14.14.14.14.14.14.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.15.15.15.15.15.15" xref="S4.E33.m1.15.15.15.15.15.15.cmml">=</mo><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2.1"><mi id="S4.E33.m1.16.16.16.16.16.16" xref="S4.E33.m1.16.16.16.16.16.16.cmml">Encoder</mi><mo id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2.1.2">⁢</mo><mrow id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2.1.1.1"><mo id="S4.E33.m1.17.17.17.17.17.17" stretchy="false">(</mo><msubsup id="S4.E33.m1.35.35.2.34.23.23.23.1.2.2.1.1.1.1"><mi id="S4.E33.m1.18.18.18.18.18.18" xref="S4.E33.m1.18.18.18.18.18.18.cmml">H</mi><msub id="S4.E33.m1.19.19.19.19.19.19.1" xref="S4.E33.m1.19.19.19.19.19.19.1.cmml"><mi id="S4.E33.m1.19.19.19.19.19.19.1.2" xref="S4.E33.m1.19.19.19.19.19.19.1.2.cmml">a</mi><mn id="S4.E33.m1.19.19.19.19.19.19.1.3" xref="S4.E33.m1.19.19.19.19.19.19.1.3.cmml">2</mn></msub><mi id="S4.E33.m1.20.20.20.20.20.20.1" xref="S4.E33.m1.20.20.20.20.20.20.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.21.21.21.21.21.21" stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E33.m1.22.22.22.22.22.22">,</mo></mrow></mtd></mtr><mtr id="S4.E33.m1.36.36.3d"><mtd id="S4.E33.m1.36.36.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E33.m1.36.36.3f"><mrow id="S4.E33.m1.36.36.3.35.12.12.12"><mrow id="S4.E33.m1.36.36.3.35.12.12.12.1"><msubsup id="S4.E33.m1.36.36.3.35.12.12.12.1.2"><mi id="S4.E33.m1.23.23.23.1.1.1" xref="S4.E33.m1.23.23.23.1.1.1.cmml">e</mi><mrow id="S4.E33.m1.24.24.24.2.2.2.1" xref="S4.E33.m1.24.24.24.2.2.2.1.cmml"><mi id="S4.E33.m1.24.24.24.2.2.2.1.2" xref="S4.E33.m1.24.24.24.2.2.2.1.2.cmml">n</mi><mo id="S4.E33.m1.24.24.24.2.2.2.1.1" xref="S4.E33.m1.24.24.24.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E33.m1.24.24.24.2.2.2.1.3" xref="S4.E33.m1.24.24.24.2.2.2.1.3.cmml">e</mi><mo id="S4.E33.m1.24.24.24.2.2.2.1.1a" xref="S4.E33.m1.24.24.24.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E33.m1.24.24.24.2.2.2.1.4" xref="S4.E33.m1.24.24.24.2.2.2.1.4.cmml">g</mi></mrow><mi id="S4.E33.m1.25.25.25.3.3.3.1" xref="S4.E33.m1.25.25.25.3.3.3.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.26.26.26.4.4.4" xref="S4.E33.m1.26.26.26.4.4.4.cmml">=</mo><mrow id="S4.E33.m1.36.36.3.35.12.12.12.1.1"><mi id="S4.E33.m1.27.27.27.5.5.5" xref="S4.E33.m1.27.27.27.5.5.5.cmml">Encoder</mi><mo id="S4.E33.m1.36.36.3.35.12.12.12.1.1.2">⁢</mo><mrow id="S4.E33.m1.36.36.3.35.12.12.12.1.1.1.1"><mo id="S4.E33.m1.28.28.28.6.6.6" stretchy="false">(</mo><msubsup id="S4.E33.m1.36.36.3.35.12.12.12.1.1.1.1.1"><mi id="S4.E33.m1.29.29.29.7.7.7" xref="S4.E33.m1.29.29.29.7.7.7.cmml">H</mi><mrow id="S4.E33.m1.30.30.30.8.8.8.1" xref="S4.E33.m1.30.30.30.8.8.8.1.cmml"><mi id="S4.E33.m1.30.30.30.8.8.8.1.2" xref="S4.E33.m1.30.30.30.8.8.8.1.2.cmml">n</mi><mo id="S4.E33.m1.30.30.30.8.8.8.1.1" xref="S4.E33.m1.30.30.30.8.8.8.1.1.cmml">⁢</mo><mi id="S4.E33.m1.30.30.30.8.8.8.1.3" xref="S4.E33.m1.30.30.30.8.8.8.1.3.cmml">e</mi><mo id="S4.E33.m1.30.30.30.8.8.8.1.1a" xref="S4.E33.m1.30.30.30.8.8.8.1.1.cmml">⁢</mo><mi id="S4.E33.m1.30.30.30.8.8.8.1.4" xref="S4.E33.m1.30.30.30.8.8.8.1.4.cmml">g</mi></mrow><mi id="S4.E33.m1.31.31.31.9.9.9.1" xref="S4.E33.m1.31.31.31.9.9.9.1.cmml">u</mi></msubsup><mo id="S4.E33.m1.32.32.32.10.10.10" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E33.m1.33.33.33.11.11.11">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E33.m1.36b"><apply id="S4.E33.m1.34.34.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E33.m1.34.34.1.1.1.1.1.cmml"><eq id="S4.E33.m1.4.4.4.4.4.4.cmml" xref="S4.E33.m1.4.4.4.4.4.4"></eq><apply id="S4.E33.m1.34.34.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.1.1.3.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.1.1.1.1.1.1.cmml" xref="S4.E33.m1.1.1.1.1.1.1">𝑒</ci><apply id="S4.E33.m1.2.2.2.2.2.2.1.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1"><times id="S4.E33.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E33.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.2">𝑝</ci><ci id="S4.E33.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.3">𝑜</ci><apply id="S4.E33.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.4"><csymbol cd="ambiguous" id="S4.E33.m1.2.2.2.2.2.2.1.4.1.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.4">subscript</csymbol><ci id="S4.E33.m1.2.2.2.2.2.2.1.4.2.cmml" xref="S4.E33.m1.2.2.2.2.2.2.1.4.2">𝑠</ci><cn id="S4.E33.m1.2.2.2.2.2.2.1.4.3.cmml" type="integer" xref="S4.E33.m1.2.2.2.2.2.2.1.4.3">1</cn></apply></apply></apply><ci id="S4.E33.m1.3.3.3.3.3.3.1.cmml" xref="S4.E33.m1.3.3.3.3.3.3.1">𝑢</ci></apply><apply id="S4.E33.m1.34.34.1.1.1.1.1.1.cmml"><times id="S4.E33.m1.34.34.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E33.m1.5.5.5.5.5.5.cmml" xref="S4.E33.m1.5.5.5.5.5.5">Encoder</ci><apply id="S4.E33.m1.34.34.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.7.7.7.7.7.7.cmml" xref="S4.E33.m1.7.7.7.7.7.7">𝐻</ci><apply id="S4.E33.m1.8.8.8.8.8.8.1.cmml" xref="S4.E33.m1.8.8.8.8.8.8.1"><csymbol cd="ambiguous" id="S4.E33.m1.8.8.8.8.8.8.1.1.cmml" xref="S4.E33.m1.8.8.8.8.8.8.1">subscript</csymbol><ci id="S4.E33.m1.8.8.8.8.8.8.1.2.cmml" xref="S4.E33.m1.8.8.8.8.8.8.1.2">𝑎</ci><cn id="S4.E33.m1.8.8.8.8.8.8.1.3.cmml" type="integer" xref="S4.E33.m1.8.8.8.8.8.8.1.3">1</cn></apply></apply><ci id="S4.E33.m1.9.9.9.9.9.9.1.cmml" xref="S4.E33.m1.9.9.9.9.9.9.1">𝑢</ci></apply></apply></apply><apply id="S4.E33.m1.34.34.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.cmml"><eq id="S4.E33.m1.15.15.15.15.15.15.cmml" xref="S4.E33.m1.15.15.15.15.15.15"></eq><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.1.1.3.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.12.12.12.12.12.12.cmml" xref="S4.E33.m1.12.12.12.12.12.12">𝑒</ci><apply id="S4.E33.m1.13.13.13.13.13.13.1.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1"><times id="S4.E33.m1.13.13.13.13.13.13.1.1.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.1"></times><ci id="S4.E33.m1.13.13.13.13.13.13.1.2.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.2">𝑝</ci><ci id="S4.E33.m1.13.13.13.13.13.13.1.3.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.3">𝑜</ci><apply id="S4.E33.m1.13.13.13.13.13.13.1.4.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.4"><csymbol cd="ambiguous" id="S4.E33.m1.13.13.13.13.13.13.1.4.1.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.4">subscript</csymbol><ci id="S4.E33.m1.13.13.13.13.13.13.1.4.2.cmml" xref="S4.E33.m1.13.13.13.13.13.13.1.4.2">𝑠</ci><cn id="S4.E33.m1.13.13.13.13.13.13.1.4.3.cmml" type="integer" xref="S4.E33.m1.13.13.13.13.13.13.1.4.3">2</cn></apply></apply></apply><ci id="S4.E33.m1.14.14.14.14.14.14.1.cmml" xref="S4.E33.m1.14.14.14.14.14.14.1">𝑢</ci></apply><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.cmml"><times id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.2.cmml"></times><ci id="S4.E33.m1.16.16.16.16.16.16.cmml" xref="S4.E33.m1.16.16.16.16.16.16">Encoder</ci><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.18.18.18.18.18.18.cmml" xref="S4.E33.m1.18.18.18.18.18.18">𝐻</ci><apply id="S4.E33.m1.19.19.19.19.19.19.1.cmml" xref="S4.E33.m1.19.19.19.19.19.19.1"><csymbol cd="ambiguous" id="S4.E33.m1.19.19.19.19.19.19.1.1.cmml" xref="S4.E33.m1.19.19.19.19.19.19.1">subscript</csymbol><ci id="S4.E33.m1.19.19.19.19.19.19.1.2.cmml" xref="S4.E33.m1.19.19.19.19.19.19.1.2">𝑎</ci><cn id="S4.E33.m1.19.19.19.19.19.19.1.3.cmml" type="integer" xref="S4.E33.m1.19.19.19.19.19.19.1.3">2</cn></apply></apply><ci id="S4.E33.m1.20.20.20.20.20.20.1.cmml" xref="S4.E33.m1.20.20.20.20.20.20.1">𝑢</ci></apply></apply></apply><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.cmml"><eq id="S4.E33.m1.26.26.26.4.4.4.cmml" xref="S4.E33.m1.26.26.26.4.4.4"></eq><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.2.2.3.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.3.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.2.2.3.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.23.23.23.1.1.1.cmml" xref="S4.E33.m1.23.23.23.1.1.1">𝑒</ci><apply id="S4.E33.m1.24.24.24.2.2.2.1.cmml" xref="S4.E33.m1.24.24.24.2.2.2.1"><times id="S4.E33.m1.24.24.24.2.2.2.1.1.cmml" xref="S4.E33.m1.24.24.24.2.2.2.1.1"></times><ci id="S4.E33.m1.24.24.24.2.2.2.1.2.cmml" xref="S4.E33.m1.24.24.24.2.2.2.1.2">𝑛</ci><ci id="S4.E33.m1.24.24.24.2.2.2.1.3.cmml" xref="S4.E33.m1.24.24.24.2.2.2.1.3">𝑒</ci><ci id="S4.E33.m1.24.24.24.2.2.2.1.4.cmml" xref="S4.E33.m1.24.24.24.2.2.2.1.4">𝑔</ci></apply></apply><ci id="S4.E33.m1.25.25.25.3.3.3.1.cmml" xref="S4.E33.m1.25.25.25.3.3.3.1">𝑢</ci></apply><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.cmml"><times id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.2.cmml"></times><ci id="S4.E33.m1.27.27.27.5.5.5.cmml" xref="S4.E33.m1.27.27.27.5.5.5">Encoder</ci><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.1.cmml">superscript</csymbol><apply id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E33.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E33.m1.29.29.29.7.7.7.cmml" xref="S4.E33.m1.29.29.29.7.7.7">𝐻</ci><apply id="S4.E33.m1.30.30.30.8.8.8.1.cmml" xref="S4.E33.m1.30.30.30.8.8.8.1"><times id="S4.E33.m1.30.30.30.8.8.8.1.1.cmml" xref="S4.E33.m1.30.30.30.8.8.8.1.1"></times><ci id="S4.E33.m1.30.30.30.8.8.8.1.2.cmml" xref="S4.E33.m1.30.30.30.8.8.8.1.2">𝑛</ci><ci id="S4.E33.m1.30.30.30.8.8.8.1.3.cmml" xref="S4.E33.m1.30.30.30.8.8.8.1.3">𝑒</ci><ci id="S4.E33.m1.30.30.30.8.8.8.1.4.cmml" xref="S4.E33.m1.30.30.30.8.8.8.1.4">𝑔</ci></apply></apply><ci id="S4.E33.m1.31.31.31.9.9.9.1.cmml" xref="S4.E33.m1.31.31.31.9.9.9.1">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E33.m1.36c">\begin{split}&amp;e_{pos_{1}}^{u}=\mathrm{Encoder}(H_{a_{1}}^{u}),e_{pos_{2}}^{u}=%
\mathrm{Encoder}(H_{a_{2}}^{u}),\\
&amp;e_{neg}^{u}=\mathrm{Encoder}(H_{neg}^{u}),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E33.m1.36d">start_ROW start_CELL end_CELL start_CELL italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Encoder ( italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) , italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Encoder ( italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_e start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_Encoder ( italic_H start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p8">
<p class="ltx_p" id="S4.SS4.SSS2.p8.3">where <math alttext="e_{pos_{1}}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p8.1.m1.1"><semantics id="S4.SS4.SSS2.p8.1.m1.1a"><msubsup id="S4.SS4.SSS2.p8.1.m1.1.1" xref="S4.SS4.SSS2.p8.1.m1.1.1.cmml"><mi id="S4.SS4.SSS2.p8.1.m1.1.1.2.2" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.2.cmml">e</mi><mrow id="S4.SS4.SSS2.p8.1.m1.1.1.2.3" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.2" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.2.cmml">p</mi><mo id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.3" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1a" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.cmml"><mi id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.2" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.2.cmml">s</mi><mn id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.3" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.3.cmml">1</mn></msub></mrow><mi id="S4.SS4.SSS2.p8.1.m1.1.1.3" xref="S4.SS4.SSS2.p8.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p8.1.m1.1b"><apply id="S4.SS4.SSS2.p8.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.1.m1.1.1.1.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p8.1.m1.1.1.2.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.1.m1.1.1.2.1.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p8.1.m1.1.1.2.2.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.2">𝑒</ci><apply id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3"><times id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.1"></times><ci id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.2">𝑝</ci><ci id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.3.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.3">𝑜</ci><apply id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.1.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4">subscript</csymbol><ci id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.2.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.2">𝑠</ci><cn id="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.3.cmml" type="integer" xref="S4.SS4.SSS2.p8.1.m1.1.1.2.3.4.3">1</cn></apply></apply></apply><ci id="S4.SS4.SSS2.p8.1.m1.1.1.3.cmml" xref="S4.SS4.SSS2.p8.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p8.1.m1.1c">e_{pos_{1}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p8.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="e_{pos_{2}}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p8.2.m2.1"><semantics id="S4.SS4.SSS2.p8.2.m2.1a"><msubsup id="S4.SS4.SSS2.p8.2.m2.1.1" xref="S4.SS4.SSS2.p8.2.m2.1.1.cmml"><mi id="S4.SS4.SSS2.p8.2.m2.1.1.2.2" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.2.cmml">e</mi><mrow id="S4.SS4.SSS2.p8.2.m2.1.1.2.3" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.2" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.2.cmml">p</mi><mo id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.3" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.3.cmml">o</mi><mo id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1a" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.cmml"><mi id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.2" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.2.cmml">s</mi><mn id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.3" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.3.cmml">2</mn></msub></mrow><mi id="S4.SS4.SSS2.p8.2.m2.1.1.3" xref="S4.SS4.SSS2.p8.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p8.2.m2.1b"><apply id="S4.SS4.SSS2.p8.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p8.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.2.m2.1.1.2.1.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p8.2.m2.1.1.2.2.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.2">𝑒</ci><apply id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3"><times id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.1"></times><ci id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.2">𝑝</ci><ci id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.3.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.3">𝑜</ci><apply id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.1.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4">subscript</csymbol><ci id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.2.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.2">𝑠</ci><cn id="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.3.cmml" type="integer" xref="S4.SS4.SSS2.p8.2.m2.1.1.2.3.4.3">2</cn></apply></apply></apply><ci id="S4.SS4.SSS2.p8.2.m2.1.1.3.cmml" xref="S4.SS4.SSS2.p8.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p8.2.m2.1c">e_{pos_{2}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p8.2.m2.1d">italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> are positive sample features and <math alttext="e_{neg}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p8.3.m3.1"><semantics id="S4.SS4.SSS2.p8.3.m3.1a"><msubsup id="S4.SS4.SSS2.p8.3.m3.1.1" xref="S4.SS4.SSS2.p8.3.m3.1.1.cmml"><mi id="S4.SS4.SSS2.p8.3.m3.1.1.2.2" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.2.cmml">e</mi><mrow id="S4.SS4.SSS2.p8.3.m3.1.1.2.3" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.2" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.2.cmml">n</mi><mo id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.3" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.3.cmml">e</mi><mo id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1a" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.4" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.4.cmml">g</mi></mrow><mi id="S4.SS4.SSS2.p8.3.m3.1.1.3" xref="S4.SS4.SSS2.p8.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p8.3.m3.1b"><apply id="S4.SS4.SSS2.p8.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p8.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p8.3.m3.1.1.2.1.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p8.3.m3.1.1.2.2.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.2">𝑒</ci><apply id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3"><times id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.1"></times><ci id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.2">𝑛</ci><ci id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.3.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.3">𝑒</ci><ci id="S4.SS4.SSS2.p8.3.m3.1.1.2.3.4.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS4.SSS2.p8.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p8.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p8.3.m3.1c">e_{neg}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p8.3.m3.1d">italic_e start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is a negative sample feature. Construct InfoNCE loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{SCL}=\mathcal{L}_{SCL}(e_{pos_{1}}^{u},e_{pos_{2}}^{u})+\mathcal{%
L}_{SCL}(e_{pos_{2}}^{u},e_{pos_{1}}^{u})," class="ltx_Math" display="block" id="S4.E34.m1.1"><semantics id="S4.E34.m1.1a"><mrow id="S4.E34.m1.1.1.1" xref="S4.E34.m1.1.1.1.1.cmml"><mrow id="S4.E34.m1.1.1.1.1" xref="S4.E34.m1.1.1.1.1.cmml"><msub id="S4.E34.m1.1.1.1.1.6" xref="S4.E34.m1.1.1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E34.m1.1.1.1.1.6.2" xref="S4.E34.m1.1.1.1.1.6.2.cmml">ℒ</mi><mrow id="S4.E34.m1.1.1.1.1.6.3" xref="S4.E34.m1.1.1.1.1.6.3.cmml"><mi id="S4.E34.m1.1.1.1.1.6.3.2" xref="S4.E34.m1.1.1.1.1.6.3.2.cmml">S</mi><mo id="S4.E34.m1.1.1.1.1.6.3.1" xref="S4.E34.m1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.6.3.3" xref="S4.E34.m1.1.1.1.1.6.3.3.cmml">C</mi><mo id="S4.E34.m1.1.1.1.1.6.3.1a" xref="S4.E34.m1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.6.3.4" xref="S4.E34.m1.1.1.1.1.6.3.4.cmml">L</mi></mrow></msub><mo id="S4.E34.m1.1.1.1.1.5" xref="S4.E34.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E34.m1.1.1.1.1.4" xref="S4.E34.m1.1.1.1.1.4.cmml"><mrow id="S4.E34.m1.1.1.1.1.2.2" xref="S4.E34.m1.1.1.1.1.2.2.cmml"><msub id="S4.E34.m1.1.1.1.1.2.2.4" xref="S4.E34.m1.1.1.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E34.m1.1.1.1.1.2.2.4.2" xref="S4.E34.m1.1.1.1.1.2.2.4.2.cmml">ℒ</mi><mrow id="S4.E34.m1.1.1.1.1.2.2.4.3" xref="S4.E34.m1.1.1.1.1.2.2.4.3.cmml"><mi id="S4.E34.m1.1.1.1.1.2.2.4.3.2" xref="S4.E34.m1.1.1.1.1.2.2.4.3.2.cmml">S</mi><mo id="S4.E34.m1.1.1.1.1.2.2.4.3.1" xref="S4.E34.m1.1.1.1.1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.2.2.4.3.3" xref="S4.E34.m1.1.1.1.1.2.2.4.3.3.cmml">C</mi><mo id="S4.E34.m1.1.1.1.1.2.2.4.3.1a" xref="S4.E34.m1.1.1.1.1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.2.2.4.3.4" xref="S4.E34.m1.1.1.1.1.2.2.4.3.4.cmml">L</mi></mrow></msub><mo id="S4.E34.m1.1.1.1.1.2.2.3" xref="S4.E34.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E34.m1.1.1.1.1.2.2.2.2" xref="S4.E34.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S4.E34.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S4.E34.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S4.E34.m1.1.1.1.1.1.1.1.1.1" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml"><mi id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.2" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.2.cmml">s</mi><mn id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.3" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.3.cmml">1</mn></msub></mrow><mi id="S4.E34.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E34.m1.1.1.1.1.2.2.2.2.4" xref="S4.E34.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S4.E34.m1.1.1.1.1.2.2.2.2.2" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">e</mi><mrow id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.2" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml">p</mi><mo id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.3" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml">o</mi><mo id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1a" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.cmml"><mi id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.2" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.2.cmml">s</mi><mn id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.3" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.3.cmml">2</mn></msub></mrow><mi id="S4.E34.m1.1.1.1.1.2.2.2.2.2.3" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E34.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S4.E34.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E34.m1.1.1.1.1.4.5" xref="S4.E34.m1.1.1.1.1.4.5.cmml">+</mo><mrow id="S4.E34.m1.1.1.1.1.4.4" xref="S4.E34.m1.1.1.1.1.4.4.cmml"><msub id="S4.E34.m1.1.1.1.1.4.4.4" xref="S4.E34.m1.1.1.1.1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E34.m1.1.1.1.1.4.4.4.2" xref="S4.E34.m1.1.1.1.1.4.4.4.2.cmml">ℒ</mi><mrow id="S4.E34.m1.1.1.1.1.4.4.4.3" xref="S4.E34.m1.1.1.1.1.4.4.4.3.cmml"><mi id="S4.E34.m1.1.1.1.1.4.4.4.3.2" xref="S4.E34.m1.1.1.1.1.4.4.4.3.2.cmml">S</mi><mo id="S4.E34.m1.1.1.1.1.4.4.4.3.1" xref="S4.E34.m1.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.4.4.4.3.3" xref="S4.E34.m1.1.1.1.1.4.4.4.3.3.cmml">C</mi><mo id="S4.E34.m1.1.1.1.1.4.4.4.3.1a" xref="S4.E34.m1.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.4.4.4.3.4" xref="S4.E34.m1.1.1.1.1.4.4.4.3.4.cmml">L</mi></mrow></msub><mo id="S4.E34.m1.1.1.1.1.4.4.3" xref="S4.E34.m1.1.1.1.1.4.4.3.cmml">⁢</mo><mrow id="S4.E34.m1.1.1.1.1.4.4.2.2" xref="S4.E34.m1.1.1.1.1.4.4.2.3.cmml"><mo id="S4.E34.m1.1.1.1.1.4.4.2.2.3" stretchy="false" xref="S4.E34.m1.1.1.1.1.4.4.2.3.cmml">(</mo><msubsup id="S4.E34.m1.1.1.1.1.3.3.1.1.1" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.2" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.2.cmml">e</mi><mrow id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.cmml"><mi id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.2" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.3" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1a" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.cmml"><mi id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.2" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.2.cmml">s</mi><mn id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.3" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.3.cmml">2</mn></msub></mrow><mi id="S4.E34.m1.1.1.1.1.3.3.1.1.1.3" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E34.m1.1.1.1.1.4.4.2.2.4" xref="S4.E34.m1.1.1.1.1.4.4.2.3.cmml">,</mo><msubsup id="S4.E34.m1.1.1.1.1.4.4.2.2.2" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.cmml"><mi id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.2" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.2.cmml">e</mi><mrow id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.cmml"><mi id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.2" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.2.cmml">p</mi><mo id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.3" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.3.cmml">o</mi><mo id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1a" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.cmml"><mi id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.2" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.2.cmml">s</mi><mn id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.3" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.3.cmml">1</mn></msub></mrow><mi id="S4.E34.m1.1.1.1.1.4.4.2.2.2.3" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E34.m1.1.1.1.1.4.4.2.2.5" stretchy="false" xref="S4.E34.m1.1.1.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E34.m1.1.1.1.2" xref="S4.E34.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E34.m1.1b"><apply id="S4.E34.m1.1.1.1.1.cmml" xref="S4.E34.m1.1.1.1"><eq id="S4.E34.m1.1.1.1.1.5.cmml" xref="S4.E34.m1.1.1.1.1.5"></eq><apply id="S4.E34.m1.1.1.1.1.6.cmml" xref="S4.E34.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.6.1.cmml" xref="S4.E34.m1.1.1.1.1.6">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.6.2.cmml" xref="S4.E34.m1.1.1.1.1.6.2">ℒ</ci><apply id="S4.E34.m1.1.1.1.1.6.3.cmml" xref="S4.E34.m1.1.1.1.1.6.3"><times id="S4.E34.m1.1.1.1.1.6.3.1.cmml" xref="S4.E34.m1.1.1.1.1.6.3.1"></times><ci id="S4.E34.m1.1.1.1.1.6.3.2.cmml" xref="S4.E34.m1.1.1.1.1.6.3.2">𝑆</ci><ci id="S4.E34.m1.1.1.1.1.6.3.3.cmml" xref="S4.E34.m1.1.1.1.1.6.3.3">𝐶</ci><ci id="S4.E34.m1.1.1.1.1.6.3.4.cmml" xref="S4.E34.m1.1.1.1.1.6.3.4">𝐿</ci></apply></apply><apply id="S4.E34.m1.1.1.1.1.4.cmml" xref="S4.E34.m1.1.1.1.1.4"><plus id="S4.E34.m1.1.1.1.1.4.5.cmml" xref="S4.E34.m1.1.1.1.1.4.5"></plus><apply id="S4.E34.m1.1.1.1.1.2.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2"><times id="S4.E34.m1.1.1.1.1.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.3"></times><apply id="S4.E34.m1.1.1.1.1.2.2.4.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.2.2.4.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.2.2.4.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.2">ℒ</ci><apply id="S4.E34.m1.1.1.1.1.2.2.4.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.3"><times id="S4.E34.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.3.1"></times><ci id="S4.E34.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.3.2">𝑆</ci><ci id="S4.E34.m1.1.1.1.1.2.2.4.3.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.3.3">𝐶</ci><ci id="S4.E34.m1.1.1.1.1.2.2.4.3.4.cmml" xref="S4.E34.m1.1.1.1.1.2.2.4.3.4">𝐿</ci></apply></apply><interval closure="open" id="S4.E34.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2"><apply id="S4.E34.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑜</ci><apply id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.1.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.2.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.2">𝑠</ci><cn id="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.3.cmml" type="integer" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.2.3.4.3">1</cn></apply></apply></apply><ci id="S4.E34.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E34.m1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E34.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.2">𝑒</ci><apply id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3"><times id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.1"></times><ci id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.2">𝑝</ci><ci id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.3">𝑜</ci><apply id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.1.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.2.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.2">𝑠</ci><cn id="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.3.cmml" type="integer" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.2.3.4.3">2</cn></apply></apply></apply><ci id="S4.E34.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.2.2.2.2.2.3">𝑢</ci></apply></interval></apply><apply id="S4.E34.m1.1.1.1.1.4.4.cmml" xref="S4.E34.m1.1.1.1.1.4.4"><times id="S4.E34.m1.1.1.1.1.4.4.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.3"></times><apply id="S4.E34.m1.1.1.1.1.4.4.4.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.4.4.4.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.4.4.4.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.2">ℒ</ci><apply id="S4.E34.m1.1.1.1.1.4.4.4.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.3"><times id="S4.E34.m1.1.1.1.1.4.4.4.3.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.3.1"></times><ci id="S4.E34.m1.1.1.1.1.4.4.4.3.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.3.2">𝑆</ci><ci id="S4.E34.m1.1.1.1.1.4.4.4.3.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.3.3">𝐶</ci><ci id="S4.E34.m1.1.1.1.1.4.4.4.3.4.cmml" xref="S4.E34.m1.1.1.1.1.4.4.4.3.4">𝐿</ci></apply></apply><interval closure="open" id="S4.E34.m1.1.1.1.1.4.4.2.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2"><apply id="S4.E34.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1">superscript</csymbol><apply id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.1.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.2.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.2">𝑒</ci><apply id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3"><times id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.1"></times><ci id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.2.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.2">𝑝</ci><ci id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.3.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.3">𝑜</ci><apply id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.1.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.2.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.2">𝑠</ci><cn id="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.3.cmml" type="integer" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.2.3.4.3">2</cn></apply></apply></apply><ci id="S4.E34.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S4.E34.m1.1.1.1.1.3.3.1.1.1.3">𝑢</ci></apply><apply id="S4.E34.m1.1.1.1.1.4.4.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2">superscript</csymbol><apply id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.2">𝑒</ci><apply id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3"><times id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.1"></times><ci id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.2">𝑝</ci><ci id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.3">𝑜</ci><apply id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.1.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4">subscript</csymbol><ci id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.2.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.2">𝑠</ci><cn id="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.3.cmml" type="integer" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.2.3.4.3">1</cn></apply></apply></apply><ci id="S4.E34.m1.1.1.1.1.4.4.2.2.2.3.cmml" xref="S4.E34.m1.1.1.1.1.4.4.2.2.2.3">𝑢</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E34.m1.1c">\mathcal{L}_{SCL}=\mathcal{L}_{SCL}(e_{pos_{1}}^{u},e_{pos_{2}}^{u})+\mathcal{%
L}_{SCL}(e_{pos_{2}}^{u},e_{pos_{1}}^{u}),</annotation><annotation encoding="application/x-llamapun" id="S4.E34.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT ( italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) + caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT ( italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p9">
<p class="ltx_p" id="S4.SS4.SSS2.p9.1">and</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\begin{split}&amp;\mathcal{L}_{SCL}(e_{pos_{1}}^{u},e_{pos_{2}}^{u})=\\
&amp;-\log\frac{\exp\bigl{(}sim(e_{pos_{1}}^{u},e_{pos_{2}}^{u})/\tau\bigr{)}}{%
\sum_{neg}\exp\bigl{(}sim(e_{pos_{1}}^{u},e_{neg}^{u})/\tau\bigr{)}},\end{split}" class="ltx_Math" display="block" id="S4.E35.m1.20"><semantics id="S4.E35.m1.20a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E35.m1.20.20.4" rowspacing="0pt"><mtr id="S4.E35.m1.20.20.4a"><mtd id="S4.E35.m1.20.20.4b" xref="S4.E35.m1.17.17.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E35.m1.20.20.4c"><mrow id="S4.E35.m1.19.19.3.18.14.14"><mrow id="S4.E35.m1.19.19.3.18.14.14.14"><msub id="S4.E35.m1.19.19.3.18.14.14.14.4"><mi class="ltx_font_mathcaligraphic" id="S4.E35.m1.1.1.1.1.1.1" xref="S4.E35.m1.1.1.1.1.1.1.cmml">ℒ</mi><mrow id="S4.E35.m1.2.2.2.2.2.2.1" xref="S4.E35.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E35.m1.2.2.2.2.2.2.1.2" xref="S4.E35.m1.2.2.2.2.2.2.1.2.cmml">S</mi><mo id="S4.E35.m1.2.2.2.2.2.2.1.1" xref="S4.E35.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E35.m1.2.2.2.2.2.2.1.3" xref="S4.E35.m1.2.2.2.2.2.2.1.3.cmml">C</mi><mo id="S4.E35.m1.2.2.2.2.2.2.1.1a" xref="S4.E35.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E35.m1.2.2.2.2.2.2.1.4" xref="S4.E35.m1.2.2.2.2.2.2.1.4.cmml">L</mi></mrow></msub><mo id="S4.E35.m1.19.19.3.18.14.14.14.3" xref="S4.E35.m1.17.17.1.1.1.cmml">⁢</mo><mrow id="S4.E35.m1.19.19.3.18.14.14.14.2.2"><mo id="S4.E35.m1.3.3.3.3.3.3" stretchy="false" xref="S4.E35.m1.17.17.1.1.1.cmml">(</mo><msubsup id="S4.E35.m1.18.18.2.17.13.13.13.1.1.1"><mi id="S4.E35.m1.4.4.4.4.4.4" xref="S4.E35.m1.4.4.4.4.4.4.cmml">e</mi><mrow id="S4.E35.m1.5.5.5.5.5.5.1" xref="S4.E35.m1.5.5.5.5.5.5.1.cmml"><mi id="S4.E35.m1.5.5.5.5.5.5.1.2" xref="S4.E35.m1.5.5.5.5.5.5.1.2.cmml">p</mi><mo id="S4.E35.m1.5.5.5.5.5.5.1.1" xref="S4.E35.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S4.E35.m1.5.5.5.5.5.5.1.3" xref="S4.E35.m1.5.5.5.5.5.5.1.3.cmml">o</mi><mo id="S4.E35.m1.5.5.5.5.5.5.1.1a" xref="S4.E35.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><msub id="S4.E35.m1.5.5.5.5.5.5.1.4" xref="S4.E35.m1.5.5.5.5.5.5.1.4.cmml"><mi id="S4.E35.m1.5.5.5.5.5.5.1.4.2" xref="S4.E35.m1.5.5.5.5.5.5.1.4.2.cmml">s</mi><mn id="S4.E35.m1.5.5.5.5.5.5.1.4.3" xref="S4.E35.m1.5.5.5.5.5.5.1.4.3.cmml">1</mn></msub></mrow><mi id="S4.E35.m1.6.6.6.6.6.6.1" xref="S4.E35.m1.6.6.6.6.6.6.1.cmml">u</mi></msubsup><mo id="S4.E35.m1.7.7.7.7.7.7" xref="S4.E35.m1.17.17.1.1.1.cmml">,</mo><msubsup id="S4.E35.m1.19.19.3.18.14.14.14.2.2.2"><mi id="S4.E35.m1.8.8.8.8.8.8" xref="S4.E35.m1.8.8.8.8.8.8.cmml">e</mi><mrow id="S4.E35.m1.9.9.9.9.9.9.1" xref="S4.E35.m1.9.9.9.9.9.9.1.cmml"><mi id="S4.E35.m1.9.9.9.9.9.9.1.2" xref="S4.E35.m1.9.9.9.9.9.9.1.2.cmml">p</mi><mo id="S4.E35.m1.9.9.9.9.9.9.1.1" xref="S4.E35.m1.9.9.9.9.9.9.1.1.cmml">⁢</mo><mi id="S4.E35.m1.9.9.9.9.9.9.1.3" xref="S4.E35.m1.9.9.9.9.9.9.1.3.cmml">o</mi><mo id="S4.E35.m1.9.9.9.9.9.9.1.1a" xref="S4.E35.m1.9.9.9.9.9.9.1.1.cmml">⁢</mo><msub id="S4.E35.m1.9.9.9.9.9.9.1.4" xref="S4.E35.m1.9.9.9.9.9.9.1.4.cmml"><mi id="S4.E35.m1.9.9.9.9.9.9.1.4.2" xref="S4.E35.m1.9.9.9.9.9.9.1.4.2.cmml">s</mi><mn id="S4.E35.m1.9.9.9.9.9.9.1.4.3" xref="S4.E35.m1.9.9.9.9.9.9.1.4.3.cmml">2</mn></msub></mrow><mi id="S4.E35.m1.10.10.10.10.10.10.1" xref="S4.E35.m1.10.10.10.10.10.10.1.cmml">u</mi></msubsup><mo id="S4.E35.m1.11.11.11.11.11.11" stretchy="false" xref="S4.E35.m1.17.17.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E35.m1.12.12.12.12.12.12" xref="S4.E35.m1.12.12.12.12.12.12.cmml">=</mo><mi id="S4.E35.m1.19.19.3.18.14.14.15" xref="S4.E35.m1.17.17.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="S4.E35.m1.20.20.4d"><mtd id="S4.E35.m1.20.20.4e" xref="S4.E35.m1.17.17.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E35.m1.20.20.4f"><mrow id="S4.E35.m1.20.20.4.19.5.5.5"><mrow id="S4.E35.m1.20.20.4.19.5.5.5.1"><mo id="S4.E35.m1.20.20.4.19.5.5.5.1a" rspace="0.167em" xref="S4.E35.m1.17.17.1.1.1.cmml">−</mo><mrow id="S4.E35.m1.20.20.4.19.5.5.5.1.1"><mi id="S4.E35.m1.14.14.14.2.2.2" xref="S4.E35.m1.14.14.14.2.2.2.cmml">log</mi><mo id="S4.E35.m1.20.20.4.19.5.5.5.1.1a" lspace="0.167em" xref="S4.E35.m1.17.17.1.1.1.cmml">⁡</mo><mfrac id="S4.E35.m1.15.15.15.3.3.3" xref="S4.E35.m1.15.15.15.3.3.3.cmml"><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2" xref="S4.E35.m1.15.15.15.3.3.3.2.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.1.1" xref="S4.E35.m1.15.15.15.3.3.3.1.1.cmml">exp</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2a" xref="S4.E35.m1.15.15.15.3.3.3.2.3.cmml">⁡</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1" xref="S4.E35.m1.15.15.15.3.3.3.2.3.cmml"><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.2" maxsize="120%" minsize="120%" xref="S4.E35.m1.15.15.15.3.3.3.2.3.cmml">(</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.cmml"><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.4" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.4.cmml">s</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.5" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.5.cmml">i</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3a" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.6" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.6.cmml">m</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3b" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.3.cmml"><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1a" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.2.cmml">s</mi><mn id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.3.cmml">1</mn></msub></mrow><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.4" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.2.cmml">e</mi><mrow id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.2.cmml">p</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.3.cmml">o</mi><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1a" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.2" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.2.cmml">s</mi><mn id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.3.cmml">2</mn></msub></mrow><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.3" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.3.cmml">/</mo><mi id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.4" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E35.m1.15.15.15.3.3.3.2.2.1.3" maxsize="120%" minsize="120%" xref="S4.E35.m1.15.15.15.3.3.3.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E35.m1.15.15.15.3.3.3.4" xref="S4.E35.m1.15.15.15.3.3.3.4.cmml"><msub id="S4.E35.m1.15.15.15.3.3.3.4.3" xref="S4.E35.m1.15.15.15.3.3.3.4.3.cmml"><mo id="S4.E35.m1.15.15.15.3.3.3.4.3.2" xref="S4.E35.m1.15.15.15.3.3.3.4.3.2.cmml">∑</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.4.3.3" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.3.3.2" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.2.cmml">n</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.3.3.1" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.3.3.3" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.3.cmml">e</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.3.3.1a" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.3.3.4" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.4.cmml">g</mi></mrow></msub><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.3.1" xref="S4.E35.m1.15.15.15.3.3.3.3.1.cmml">exp</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1a" xref="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml">⁡</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml"><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.2" maxsize="120%" minsize="120%" xref="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml">(</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.cmml"><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.4" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.4.cmml">s</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.5" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.5.cmml">i</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3a" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.6" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.6.cmml">m</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3b" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.3" stretchy="false" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.2.cmml">e</mi><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1a" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.2.cmml">s</mi><mn id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.3.cmml">1</mn></msub></mrow><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.4" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.2.cmml">e</mi><mrow id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.2" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.2.cmml">n</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.3.cmml">e</mi><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1a" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.4" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.4.cmml">g</mi></mrow><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.5" stretchy="false" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.3" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.4" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.3" maxsize="120%" minsize="120%" xref="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E35.m1.16.16.16.4.4.4" xref="S4.E35.m1.17.17.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E35.m1.20b"><apply id="S4.E35.m1.17.17.1.1.1.cmml" xref="S4.E35.m1.20.20.4b"><eq id="S4.E35.m1.12.12.12.12.12.12.cmml" xref="S4.E35.m1.12.12.12.12.12.12"></eq><apply id="S4.E35.m1.17.17.1.1.1.2.cmml" xref="S4.E35.m1.20.20.4b"><times id="S4.E35.m1.17.17.1.1.1.2.3.cmml" xref="S4.E35.m1.20.20.4b"></times><apply id="S4.E35.m1.17.17.1.1.1.2.4.cmml" xref="S4.E35.m1.20.20.4b"><csymbol cd="ambiguous" id="S4.E35.m1.17.17.1.1.1.2.4.1.cmml" xref="S4.E35.m1.20.20.4b">subscript</csymbol><ci id="S4.E35.m1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.1.1.1.1.1.1">ℒ</ci><apply id="S4.E35.m1.2.2.2.2.2.2.1.cmml" xref="S4.E35.m1.2.2.2.2.2.2.1"><times id="S4.E35.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E35.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E35.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E35.m1.2.2.2.2.2.2.1.2">𝑆</ci><ci id="S4.E35.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E35.m1.2.2.2.2.2.2.1.3">𝐶</ci><ci id="S4.E35.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E35.m1.2.2.2.2.2.2.1.4">𝐿</ci></apply></apply><interval closure="open" id="S4.E35.m1.17.17.1.1.1.2.2.3.cmml" xref="S4.E35.m1.20.20.4b"><apply id="S4.E35.m1.17.17.1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.20.20.4b"><csymbol cd="ambiguous" id="S4.E35.m1.17.17.1.1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.20.20.4b">superscript</csymbol><apply id="S4.E35.m1.17.17.1.1.1.1.1.1.1.2.cmml" xref="S4.E35.m1.20.20.4b"><csymbol cd="ambiguous" id="S4.E35.m1.17.17.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E35.m1.20.20.4b">subscript</csymbol><ci id="S4.E35.m1.4.4.4.4.4.4.cmml" xref="S4.E35.m1.4.4.4.4.4.4">𝑒</ci><apply id="S4.E35.m1.5.5.5.5.5.5.1.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1"><times id="S4.E35.m1.5.5.5.5.5.5.1.1.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.1"></times><ci id="S4.E35.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.2">𝑝</ci><ci id="S4.E35.m1.5.5.5.5.5.5.1.3.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.3">𝑜</ci><apply id="S4.E35.m1.5.5.5.5.5.5.1.4.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.4"><csymbol cd="ambiguous" id="S4.E35.m1.5.5.5.5.5.5.1.4.1.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.4">subscript</csymbol><ci id="S4.E35.m1.5.5.5.5.5.5.1.4.2.cmml" xref="S4.E35.m1.5.5.5.5.5.5.1.4.2">𝑠</ci><cn id="S4.E35.m1.5.5.5.5.5.5.1.4.3.cmml" type="integer" xref="S4.E35.m1.5.5.5.5.5.5.1.4.3">1</cn></apply></apply></apply><ci id="S4.E35.m1.6.6.6.6.6.6.1.cmml" xref="S4.E35.m1.6.6.6.6.6.6.1">𝑢</ci></apply><apply id="S4.E35.m1.17.17.1.1.1.2.2.2.2.cmml" xref="S4.E35.m1.20.20.4b"><csymbol cd="ambiguous" id="S4.E35.m1.17.17.1.1.1.2.2.2.2.1.cmml" xref="S4.E35.m1.20.20.4b">superscript</csymbol><apply id="S4.E35.m1.17.17.1.1.1.2.2.2.2.2.cmml" xref="S4.E35.m1.20.20.4b"><csymbol cd="ambiguous" id="S4.E35.m1.17.17.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E35.m1.20.20.4b">subscript</csymbol><ci id="S4.E35.m1.8.8.8.8.8.8.cmml" xref="S4.E35.m1.8.8.8.8.8.8">𝑒</ci><apply id="S4.E35.m1.9.9.9.9.9.9.1.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1"><times id="S4.E35.m1.9.9.9.9.9.9.1.1.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.1"></times><ci id="S4.E35.m1.9.9.9.9.9.9.1.2.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.2">𝑝</ci><ci id="S4.E35.m1.9.9.9.9.9.9.1.3.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.3">𝑜</ci><apply id="S4.E35.m1.9.9.9.9.9.9.1.4.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.4"><csymbol cd="ambiguous" id="S4.E35.m1.9.9.9.9.9.9.1.4.1.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.4">subscript</csymbol><ci id="S4.E35.m1.9.9.9.9.9.9.1.4.2.cmml" xref="S4.E35.m1.9.9.9.9.9.9.1.4.2">𝑠</ci><cn id="S4.E35.m1.9.9.9.9.9.9.1.4.3.cmml" type="integer" xref="S4.E35.m1.9.9.9.9.9.9.1.4.3">2</cn></apply></apply></apply><ci id="S4.E35.m1.10.10.10.10.10.10.1.cmml" xref="S4.E35.m1.10.10.10.10.10.10.1">𝑢</ci></apply></interval></apply><apply id="S4.E35.m1.17.17.1.1.1.4.cmml" xref="S4.E35.m1.20.20.4b"><minus id="S4.E35.m1.13.13.13.1.1.1.cmml" xref="S4.E35.m1.20.20.4b"></minus><apply id="S4.E35.m1.17.17.1.1.1.4.2.cmml" xref="S4.E35.m1.20.20.4b"><log id="S4.E35.m1.14.14.14.2.2.2.cmml" xref="S4.E35.m1.14.14.14.2.2.2"></log><apply id="S4.E35.m1.15.15.15.3.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3"><divide id="S4.E35.m1.15.15.15.3.3.3.5.cmml" xref="S4.E35.m1.15.15.15.3.3.3"></divide><apply id="S4.E35.m1.15.15.15.3.3.3.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2"><exp id="S4.E35.m1.15.15.15.3.3.3.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.1.1"></exp><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1"><divide id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.3"></divide><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2"><times id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.3"></times><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.4">𝑠</ci><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.5.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.5">𝑖</ci><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.6.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.6">𝑚</ci><interval closure="open" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2"><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3"><times id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.3">𝑜</ci><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.2">𝑠</ci><cn id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.3.cmml" type="integer" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.2.3.4.3">1</cn></apply></apply></apply><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.2">𝑒</ci><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3"><times id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.1"></times><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.2">𝑝</ci><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.3">𝑜</ci><apply id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.2">𝑠</ci><cn id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.3.cmml" type="integer" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.2.3.4.3">2</cn></apply></apply></apply><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E35.m1.15.15.15.3.3.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4"><apply id="S4.E35.m1.15.15.15.3.3.3.4.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3">subscript</csymbol><sum id="S4.E35.m1.15.15.15.3.3.3.4.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.2"></sum><apply id="S4.E35.m1.15.15.15.3.3.3.4.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3"><times id="S4.E35.m1.15.15.15.3.3.3.4.3.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.1"></times><ci id="S4.E35.m1.15.15.15.3.3.3.4.3.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.2">𝑛</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.3.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.3">𝑒</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.3.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.3.3.4">𝑔</ci></apply></apply><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1"><exp id="S4.E35.m1.15.15.15.3.3.3.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.3.1"></exp><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1"><divide id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.3"></divide><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2"><times id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.3"></times><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.4">𝑠</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.5.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.5">𝑖</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.6.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.6">𝑚</ci><interval closure="open" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2"><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3"><times id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.3">𝑜</ci><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.2">𝑠</ci><cn id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.3.cmml" type="integer" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.2.3.4.3">1</cn></apply></apply></apply><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.2">𝑒</ci><apply id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3"><times id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.1"></times><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.2">𝑛</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.3">𝑒</ci><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.2.3.4">𝑔</ci></apply></apply><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.4.cmml" xref="S4.E35.m1.15.15.15.3.3.3.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E35.m1.20c">\begin{split}&amp;\mathcal{L}_{SCL}(e_{pos_{1}}^{u},e_{pos_{2}}^{u})=\\
&amp;-\log\frac{\exp\bigl{(}sim(e_{pos_{1}}^{u},e_{pos_{2}}^{u})/\tau\bigr{)}}{%
\sum_{neg}\exp\bigl{(}sim(e_{pos_{1}}^{u},e_{neg}^{u})/\tau\bigr{)}},\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E35.m1.20d">start_ROW start_CELL end_CELL start_CELL caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT ( italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) = end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL - roman_log divide start_ARG roman_exp ( italic_s italic_i italic_m ( italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT roman_exp ( italic_s italic_i italic_m ( italic_e start_POSTSUBSCRIPT italic_p italic_o italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) / italic_τ ) end_ARG , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.SSS2.p10">
<p class="ltx_p" id="S4.SS4.SSS2.p10.6">where <math alttext="sim(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.1.m1.2"><semantics id="S4.SS4.SSS2.p10.1.m1.2a"><mrow id="S4.SS4.SSS2.p10.1.m1.2.3" xref="S4.SS4.SSS2.p10.1.m1.2.3.cmml"><mi id="S4.SS4.SSS2.p10.1.m1.2.3.2" xref="S4.SS4.SSS2.p10.1.m1.2.3.2.cmml">s</mi><mo id="S4.SS4.SSS2.p10.1.m1.2.3.1" xref="S4.SS4.SSS2.p10.1.m1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p10.1.m1.2.3.3" xref="S4.SS4.SSS2.p10.1.m1.2.3.3.cmml">i</mi><mo id="S4.SS4.SSS2.p10.1.m1.2.3.1a" xref="S4.SS4.SSS2.p10.1.m1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p10.1.m1.2.3.4" xref="S4.SS4.SSS2.p10.1.m1.2.3.4.cmml">m</mi><mo id="S4.SS4.SSS2.p10.1.m1.2.3.1b" xref="S4.SS4.SSS2.p10.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS4.SSS2.p10.1.m1.2.3.5.2" xref="S4.SS4.SSS2.p10.1.m1.2.3.5.1.cmml"><mo id="S4.SS4.SSS2.p10.1.m1.2.3.5.2.1" stretchy="false" xref="S4.SS4.SSS2.p10.1.m1.2.3.5.1.cmml">(</mo><mo id="S4.SS4.SSS2.p10.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS4.SSS2.p10.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS4.SSS2.p10.1.m1.2.3.5.2.2" rspace="0em" xref="S4.SS4.SSS2.p10.1.m1.2.3.5.1.cmml">,</mo><mo id="S4.SS4.SSS2.p10.1.m1.2.2" lspace="0em" rspace="0em" xref="S4.SS4.SSS2.p10.1.m1.2.2.cmml">⋅</mo><mo id="S4.SS4.SSS2.p10.1.m1.2.3.5.2.3" stretchy="false" xref="S4.SS4.SSS2.p10.1.m1.2.3.5.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.1.m1.2b"><apply id="S4.SS4.SSS2.p10.1.m1.2.3.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3"><times id="S4.SS4.SSS2.p10.1.m1.2.3.1.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3.1"></times><ci id="S4.SS4.SSS2.p10.1.m1.2.3.2.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3.2">𝑠</ci><ci id="S4.SS4.SSS2.p10.1.m1.2.3.3.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3.3">𝑖</ci><ci id="S4.SS4.SSS2.p10.1.m1.2.3.4.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3.4">𝑚</ci><interval closure="open" id="S4.SS4.SSS2.p10.1.m1.2.3.5.1.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.3.5.2"><ci id="S4.SS4.SSS2.p10.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p10.1.m1.1.1">⋅</ci><ci id="S4.SS4.SSS2.p10.1.m1.2.2.cmml" xref="S4.SS4.SSS2.p10.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.1.m1.2c">sim(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.1.m1.2d">italic_s italic_i italic_m ( ⋅ , ⋅ )</annotation></semantics></math> is the dot product similarity, <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.2.m2.1"><semantics id="S4.SS4.SSS2.p10.2.m2.1a"><mi id="S4.SS4.SSS2.p10.2.m2.1.1" xref="S4.SS4.SSS2.p10.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.2.m2.1b"><ci id="S4.SS4.SSS2.p10.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p10.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.2.m2.1d">italic_τ</annotation></semantics></math> is the temperature coefficient, used to control the sharpness of the sample similarity. The smaller the value the more the model can focus on the distinction between positive and negative samples, the larger the value makes the probability distribution the smoother, so as to weaken the model’s sensitivity to the noise, and improve the robustness. Eq.(35) wants to expand the similarity between <math alttext="H_{a_{1}}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.3.m3.1"><semantics id="S4.SS4.SSS2.p10.3.m3.1a"><msubsup id="S4.SS4.SSS2.p10.3.m3.1.1" xref="S4.SS4.SSS2.p10.3.m3.1.1.cmml"><mi id="S4.SS4.SSS2.p10.3.m3.1.1.2.2" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.2.cmml">H</mi><msub id="S4.SS4.SSS2.p10.3.m3.1.1.2.3" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.2" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3.2.cmml">a</mi><mn id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.3" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3.3.cmml">1</mn></msub><mi id="S4.SS4.SSS2.p10.3.m3.1.1.3" xref="S4.SS4.SSS2.p10.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.3.m3.1b"><apply id="S4.SS4.SSS2.p10.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p10.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.3.m3.1.1.2.1.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p10.3.m3.1.1.2.2.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.2">𝐻</ci><apply id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3.2">𝑎</ci><cn id="S4.SS4.SSS2.p10.3.m3.1.1.2.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p10.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS4.SSS2.p10.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p10.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.3.m3.1c">H_{a_{1}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.3.m3.1d">italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="H_{a_{2}}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.4.m4.1"><semantics id="S4.SS4.SSS2.p10.4.m4.1a"><msubsup id="S4.SS4.SSS2.p10.4.m4.1.1" xref="S4.SS4.SSS2.p10.4.m4.1.1.cmml"><mi id="S4.SS4.SSS2.p10.4.m4.1.1.2.2" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.2.cmml">H</mi><msub id="S4.SS4.SSS2.p10.4.m4.1.1.2.3" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.2" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3.2.cmml">a</mi><mn id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.3" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3.3.cmml">2</mn></msub><mi id="S4.SS4.SSS2.p10.4.m4.1.1.3" xref="S4.SS4.SSS2.p10.4.m4.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.4.m4.1b"><apply id="S4.SS4.SSS2.p10.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.4.m4.1.1.1.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p10.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.4.m4.1.1.2.1.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p10.4.m4.1.1.2.2.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.2">𝐻</ci><apply id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3">subscript</csymbol><ci id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3.2">𝑎</ci><cn id="S4.SS4.SSS2.p10.4.m4.1.1.2.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p10.4.m4.1.1.2.3.3">2</cn></apply></apply><ci id="S4.SS4.SSS2.p10.4.m4.1.1.3.cmml" xref="S4.SS4.SSS2.p10.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.4.m4.1c">H_{a_{2}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.4.m4.1d">italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, and reduce the similarity between <math alttext="H_{a_{1}}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.5.m5.1"><semantics id="S4.SS4.SSS2.p10.5.m5.1a"><msubsup id="S4.SS4.SSS2.p10.5.m5.1.1" xref="S4.SS4.SSS2.p10.5.m5.1.1.cmml"><mi id="S4.SS4.SSS2.p10.5.m5.1.1.2.2" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.2.cmml">H</mi><msub id="S4.SS4.SSS2.p10.5.m5.1.1.2.3" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.2" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3.2.cmml">a</mi><mn id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.3" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3.3.cmml">1</mn></msub><mi id="S4.SS4.SSS2.p10.5.m5.1.1.3" xref="S4.SS4.SSS2.p10.5.m5.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.5.m5.1b"><apply id="S4.SS4.SSS2.p10.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.5.m5.1.1.1.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p10.5.m5.1.1.2.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.5.m5.1.1.2.1.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p10.5.m5.1.1.2.2.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.2">𝐻</ci><apply id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3">subscript</csymbol><ci id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3.2">𝑎</ci><cn id="S4.SS4.SSS2.p10.5.m5.1.1.2.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p10.5.m5.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS4.SSS2.p10.5.m5.1.1.3.cmml" xref="S4.SS4.SSS2.p10.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.5.m5.1c">H_{a_{1}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.5.m5.1d">italic_H start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="H_{neg}^{u}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p10.6.m6.1"><semantics id="S4.SS4.SSS2.p10.6.m6.1a"><msubsup id="S4.SS4.SSS2.p10.6.m6.1.1" xref="S4.SS4.SSS2.p10.6.m6.1.1.cmml"><mi id="S4.SS4.SSS2.p10.6.m6.1.1.2.2" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.2.cmml">H</mi><mrow id="S4.SS4.SSS2.p10.6.m6.1.1.2.3" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.cmml"><mi id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.2" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.2.cmml">n</mi><mo id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.3" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.3.cmml">e</mi><mo id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1a" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.4" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.4.cmml">g</mi></mrow><mi id="S4.SS4.SSS2.p10.6.m6.1.1.3" xref="S4.SS4.SSS2.p10.6.m6.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p10.6.m6.1b"><apply id="S4.SS4.SSS2.p10.6.m6.1.1.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.6.m6.1.1.1.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1">superscript</csymbol><apply id="S4.SS4.SSS2.p10.6.m6.1.1.2.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p10.6.m6.1.1.2.1.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p10.6.m6.1.1.2.2.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.2">𝐻</ci><apply id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3"><times id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.1"></times><ci id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.2.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.2">𝑛</ci><ci id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.3.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.3">𝑒</ci><ci id="S4.SS4.SSS2.p10.6.m6.1.1.2.3.4.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS4.SSS2.p10.6.m6.1.1.3.cmml" xref="S4.SS4.SSS2.p10.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p10.6.m6.1c">H_{neg}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p10.6.m6.1d">italic_H start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, replacing the positive samples is in the same way. Eq.(34) is the sum of the losses of the two positive samples as the overall loss function of the contrastive learning layer.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Multi-Task Training</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">The user’s sequence features and intention features both contain potential information about the user, and the concatenation of two features as the final representation of the user’s input to the prediction layer, which calculates the dot product with the user’s to-be-predicted items and returns the interaction probability:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E36">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="IP_{i}^{u}=\sigma\bigl{(}\mathrm{MLP}(e_{s}^{u}\|I_{pos}^{u})\cdot e_{i}^{u}%
\bigr{)},e_{i}^{u}\in NI^{u}," class="ltx_Math" display="block" id="S4.E36.m1.1"><semantics id="S4.E36.m1.1a"><mrow id="S4.E36.m1.1.1.1"><mrow id="S4.E36.m1.1.1.1.1.2" xref="S4.E36.m1.1.1.1.1.3.cmml"><mrow id="S4.E36.m1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E36.m1.1.1.1.1.1.1.3" xref="S4.E36.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.3.2" xref="S4.E36.m1.1.1.1.1.1.1.3.2.cmml">I</mi><mo id="S4.E36.m1.1.1.1.1.1.1.3.1" xref="S4.E36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E36.m1.1.1.1.1.1.1.3.3" xref="S4.E36.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.3.3.2.2" xref="S4.E36.m1.1.1.1.1.1.1.3.3.2.2.cmml">P</mi><mi id="S4.E36.m1.1.1.1.1.1.1.3.3.2.3" xref="S4.E36.m1.1.1.1.1.1.1.3.3.2.3.cmml">i</mi><mi id="S4.E36.m1.1.1.1.1.1.1.3.3.3" xref="S4.E36.m1.1.1.1.1.1.1.3.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E36.m1.1.1.1.1.1.1.2" xref="S4.E36.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E36.m1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.3" xref="S4.E36.m1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S4.E36.m1.1.1.1.1.1.1.1.2" xref="S4.E36.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">MLP</mi><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msubsup id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">o</mi><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><msubsup id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E36.m1.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E36.m1.1.1.1.1.2.3" xref="S4.E36.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E36.m1.1.1.1.1.2.2" xref="S4.E36.m1.1.1.1.1.2.2.cmml"><msubsup id="S4.E36.m1.1.1.1.1.2.2.2" xref="S4.E36.m1.1.1.1.1.2.2.2.cmml"><mi id="S4.E36.m1.1.1.1.1.2.2.2.2.2" xref="S4.E36.m1.1.1.1.1.2.2.2.2.2.cmml">e</mi><mi id="S4.E36.m1.1.1.1.1.2.2.2.2.3" xref="S4.E36.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="S4.E36.m1.1.1.1.1.2.2.2.3" xref="S4.E36.m1.1.1.1.1.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E36.m1.1.1.1.1.2.2.1" xref="S4.E36.m1.1.1.1.1.2.2.1.cmml">∈</mo><mrow id="S4.E36.m1.1.1.1.1.2.2.3" xref="S4.E36.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E36.m1.1.1.1.1.2.2.3.2" xref="S4.E36.m1.1.1.1.1.2.2.3.2.cmml">N</mi><mo id="S4.E36.m1.1.1.1.1.2.2.3.1" xref="S4.E36.m1.1.1.1.1.2.2.3.1.cmml">⁢</mo><msup id="S4.E36.m1.1.1.1.1.2.2.3.3" xref="S4.E36.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E36.m1.1.1.1.1.2.2.3.3.2" xref="S4.E36.m1.1.1.1.1.2.2.3.3.2.cmml">I</mi><mi id="S4.E36.m1.1.1.1.1.2.2.3.3.3" xref="S4.E36.m1.1.1.1.1.2.2.3.3.3.cmml">u</mi></msup></mrow></mrow></mrow><mo id="S4.E36.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E36.m1.1b"><apply id="S4.E36.m1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.3a.cmml" xref="S4.E36.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1"><eq id="S4.E36.m1.1.1.1.1.1.1.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E36.m1.1.1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3"><times id="S4.E36.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E36.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.2">𝐼</ci><apply id="S4.E36.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E36.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3.2.2">𝑃</ci><ci id="S4.E36.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S4.E36.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.3.3.3">𝑢</ci></apply></apply><apply id="S4.E36.m1.1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1"><times id="S4.E36.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.E36.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1"><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.3">MLP</ci><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑒</ci><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑒</ci><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E36.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="S4.E36.m1.1.1.1.1.2.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2"><in id="S4.E36.m1.1.1.1.1.2.2.1.cmml" xref="S4.E36.m1.1.1.1.1.2.2.1"></in><apply id="S4.E36.m1.1.1.1.1.2.2.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E36.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E36.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2.2.2">𝑒</ci><ci id="S4.E36.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E36.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E36.m1.1.1.1.1.2.2.2.3">𝑢</ci></apply><apply id="S4.E36.m1.1.1.1.1.2.2.3.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3"><times id="S4.E36.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.1"></times><ci id="S4.E36.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.2">𝑁</ci><apply id="S4.E36.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E36.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.3">superscript</csymbol><ci id="S4.E36.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.3.2">𝐼</ci><ci id="S4.E36.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E36.m1.1.1.1.1.2.2.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E36.m1.1c">IP_{i}^{u}=\sigma\bigl{(}\mathrm{MLP}(e_{s}^{u}\|I_{pos}^{u})\cdot e_{i}^{u}%
\bigr{)},e_{i}^{u}\in NI^{u},</annotation><annotation encoding="application/x-llamapun" id="S4.E36.m1.1d">italic_I italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = italic_σ ( roman_MLP ( italic_e start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∥ italic_I start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ⋅ italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) , italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∈ italic_N italic_I start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.4">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS5.p2.1.m1.1"><semantics id="S4.SS5.p2.1.m1.1a"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">italic_σ</annotation></semantics></math> is the <math alttext="\mathrm{Sigmoid}" class="ltx_Math" display="inline" id="S4.SS5.p2.2.m2.1"><semantics id="S4.SS5.p2.2.m2.1a"><mi id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">Sigmoid</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><ci id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">Sigmoid</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">\mathrm{Sigmoid}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.2.m2.1d">roman_Sigmoid</annotation></semantics></math> function and <math alttext="NI^{u}" class="ltx_Math" display="inline" id="S4.SS5.p2.3.m3.1"><semantics id="S4.SS5.p2.3.m3.1a"><mrow id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml"><mi id="S4.SS5.p2.3.m3.1.1.2" xref="S4.SS5.p2.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS5.p2.3.m3.1.1.1" xref="S4.SS5.p2.3.m3.1.1.1.cmml">⁢</mo><msup id="S4.SS5.p2.3.m3.1.1.3" xref="S4.SS5.p2.3.m3.1.1.3.cmml"><mi id="S4.SS5.p2.3.m3.1.1.3.2" xref="S4.SS5.p2.3.m3.1.1.3.2.cmml">I</mi><mi id="S4.SS5.p2.3.m3.1.1.3.3" xref="S4.SS5.p2.3.m3.1.1.3.3.cmml">u</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><apply id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1"><times id="S4.SS5.p2.3.m3.1.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1.1"></times><ci id="S4.SS5.p2.3.m3.1.1.2.cmml" xref="S4.SS5.p2.3.m3.1.1.2">𝑁</ci><apply id="S4.SS5.p2.3.m3.1.1.3.cmml" xref="S4.SS5.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.p2.3.m3.1.1.3.1.cmml" xref="S4.SS5.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS5.p2.3.m3.1.1.3.2.cmml" xref="S4.SS5.p2.3.m3.1.1.3.2">𝐼</ci><ci id="S4.SS5.p2.3.m3.1.1.3.3.cmml" xref="S4.SS5.p2.3.m3.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">NI^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.3.m3.1d">italic_N italic_I start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is the set of <math alttext="u" class="ltx_Math" display="inline" id="S4.SS5.p2.4.m4.1"><semantics id="S4.SS5.p2.4.m4.1a"><mi id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><ci id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.4.m4.1d">italic_u</annotation></semantics></math>’s to-be-predicted items. For the predicted loss of the interaction item at the next moment, the Cross-Entropy loss function is used:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E37">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{PRE}=-\frac{1}{N}\sum_{i=1}^{N}y_{i}^{u}\cdot\log(IP_{i}^{u})." class="ltx_Math" display="block" id="S4.E37.m1.2"><semantics id="S4.E37.m1.2a"><mrow id="S4.E37.m1.2.2.1" xref="S4.E37.m1.2.2.1.1.cmml"><mrow id="S4.E37.m1.2.2.1.1" xref="S4.E37.m1.2.2.1.1.cmml"><msub id="S4.E37.m1.2.2.1.1.3" xref="S4.E37.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E37.m1.2.2.1.1.3.2" xref="S4.E37.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E37.m1.2.2.1.1.3.3" xref="S4.E37.m1.2.2.1.1.3.3.cmml"><mi id="S4.E37.m1.2.2.1.1.3.3.2" xref="S4.E37.m1.2.2.1.1.3.3.2.cmml">P</mi><mo id="S4.E37.m1.2.2.1.1.3.3.1" xref="S4.E37.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E37.m1.2.2.1.1.3.3.3" xref="S4.E37.m1.2.2.1.1.3.3.3.cmml">R</mi><mo id="S4.E37.m1.2.2.1.1.3.3.1a" xref="S4.E37.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E37.m1.2.2.1.1.3.3.4" xref="S4.E37.m1.2.2.1.1.3.3.4.cmml">E</mi></mrow></msub><mo id="S4.E37.m1.2.2.1.1.2" xref="S4.E37.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E37.m1.2.2.1.1.1" xref="S4.E37.m1.2.2.1.1.1.cmml"><mo id="S4.E37.m1.2.2.1.1.1a" xref="S4.E37.m1.2.2.1.1.1.cmml">−</mo><mrow id="S4.E37.m1.2.2.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.cmml"><mfrac id="S4.E37.m1.2.2.1.1.1.1.3" xref="S4.E37.m1.2.2.1.1.1.1.3.cmml"><mn id="S4.E37.m1.2.2.1.1.1.1.3.2" xref="S4.E37.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mi id="S4.E37.m1.2.2.1.1.1.1.3.3" xref="S4.E37.m1.2.2.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.E37.m1.2.2.1.1.1.1.2" xref="S4.E37.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E37.m1.2.2.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.cmml"><munderover id="S4.E37.m1.2.2.1.1.1.1.1.2" xref="S4.E37.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E37.m1.2.2.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.2" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.1" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.3" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E37.m1.2.2.1.1.1.1.1.2.3" xref="S4.E37.m1.2.2.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S4.E37.m1.2.2.1.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.1.cmml"><msubsup id="S4.E37.m1.2.2.1.1.1.1.1.1.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup><mo id="S4.E37.m1.2.2.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E37.m1.2.2.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E37.m1.1.1" xref="S4.E37.m1.1.1.cmml">log</mi><mo id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1a" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup></mrow><mo id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E37.m1.2.2.1.2" lspace="0em" xref="S4.E37.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E37.m1.2b"><apply id="S4.E37.m1.2.2.1.1.cmml" xref="S4.E37.m1.2.2.1"><eq id="S4.E37.m1.2.2.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.2"></eq><apply id="S4.E37.m1.2.2.1.1.3.cmml" xref="S4.E37.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.3.1.cmml" xref="S4.E37.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E37.m1.2.2.1.1.3.2.cmml" xref="S4.E37.m1.2.2.1.1.3.2">ℒ</ci><apply id="S4.E37.m1.2.2.1.1.3.3.cmml" xref="S4.E37.m1.2.2.1.1.3.3"><times id="S4.E37.m1.2.2.1.1.3.3.1.cmml" xref="S4.E37.m1.2.2.1.1.3.3.1"></times><ci id="S4.E37.m1.2.2.1.1.3.3.2.cmml" xref="S4.E37.m1.2.2.1.1.3.3.2">𝑃</ci><ci id="S4.E37.m1.2.2.1.1.3.3.3.cmml" xref="S4.E37.m1.2.2.1.1.3.3.3">𝑅</ci><ci id="S4.E37.m1.2.2.1.1.3.3.4.cmml" xref="S4.E37.m1.2.2.1.1.3.3.4">𝐸</ci></apply></apply><apply id="S4.E37.m1.2.2.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1"><minus id="S4.E37.m1.2.2.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1"></minus><apply id="S4.E37.m1.2.2.1.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1"><times id="S4.E37.m1.2.2.1.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.2"></times><apply id="S4.E37.m1.2.2.1.1.1.1.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.3"><divide id="S4.E37.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.3"></divide><cn id="S4.E37.m1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S4.E37.m1.2.2.1.1.1.1.3.2">1</cn><ci id="S4.E37.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E37.m1.2.2.1.1.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1"><apply id="S4.E37.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E37.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E37.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.2"></sum><apply id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3"><eq id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E37.m1.2.2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E37.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1"><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.2">⋅</ci><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1"><log id="S4.E37.m1.1.1.cmml" xref="S4.E37.m1.1.1"></log><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E37.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E37.m1.2c">\mathcal{L}_{PRE}=-\frac{1}{N}\sum_{i=1}^{N}y_{i}^{u}\cdot\log(IP_{i}^{u}).</annotation><annotation encoding="application/x-llamapun" id="S4.E37.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_P italic_R italic_E end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ⋅ roman_log ( italic_I italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.3">The <math alttext="y_{i}^{u}" class="ltx_Math" display="inline" id="S4.SS5.p3.1.m1.1"><semantics id="S4.SS5.p3.1.m1.1a"><msubsup id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml"><mi id="S4.SS5.p3.1.m1.1.1.2.2" xref="S4.SS5.p3.1.m1.1.1.2.2.cmml">y</mi><mi id="S4.SS5.p3.1.m1.1.1.2.3" xref="S4.SS5.p3.1.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS5.p3.1.m1.1.1.3" xref="S4.SS5.p3.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.1.m1.1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS5.p3.1.m1.1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p3.1.m1.1.1.2.1.cmml" xref="S4.SS5.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p3.1.m1.1.1.2.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2.2">𝑦</ci><ci id="S4.SS5.p3.1.m1.1.1.2.3.cmml" xref="S4.SS5.p3.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS5.p3.1.m1.1.1.3.cmml" xref="S4.SS5.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">y_{i}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> in Eq.(37) is the true label of <math alttext="u" class="ltx_Math" display="inline" id="S4.SS5.p3.2.m2.1"><semantics id="S4.SS5.p3.2.m2.1a"><mi id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><ci id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.2.m2.1d">italic_u</annotation></semantics></math>’s interaction behavior to <math alttext="i" class="ltx_Math" display="inline" id="S4.SS5.p3.3.m3.1"><semantics id="S4.SS5.p3.3.m3.1a"><mi id="S4.SS5.p3.3.m3.1.1" xref="S4.SS5.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.3.m3.1b"><ci id="S4.SS5.p3.3.m3.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.3.m3.1d">italic_i</annotation></semantics></math>, and the one with the highest predicted probability is compared. Combining the intention loss and sequence loss in the contrastive learning part, the final loss function in the MIDCL training part is the weighted sum of the three losses:</p>
</div>
<div class="ltx_para" id="S4.SS5.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.E38">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{MIDCL}=\mathcal{L}_{PRE}+\alpha\cdot\mathcal{L}_{VAE}+\beta\cdot%
\mathcal{L}_{SCL}." class="ltx_Math" display="block" id="S4.E38.m1.1"><semantics id="S4.E38.m1.1a"><mrow id="S4.E38.m1.1.1.1" xref="S4.E38.m1.1.1.1.1.cmml"><mrow id="S4.E38.m1.1.1.1.1" xref="S4.E38.m1.1.1.1.1.cmml"><msub id="S4.E38.m1.1.1.1.1.2" xref="S4.E38.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E38.m1.1.1.1.1.2.2" xref="S4.E38.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E38.m1.1.1.1.1.2.3" xref="S4.E38.m1.1.1.1.1.2.3.cmml"><mi id="S4.E38.m1.1.1.1.1.2.3.2" xref="S4.E38.m1.1.1.1.1.2.3.2.cmml">M</mi><mo id="S4.E38.m1.1.1.1.1.2.3.1" xref="S4.E38.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.2.3.3" xref="S4.E38.m1.1.1.1.1.2.3.3.cmml">I</mi><mo id="S4.E38.m1.1.1.1.1.2.3.1a" xref="S4.E38.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.2.3.4" xref="S4.E38.m1.1.1.1.1.2.3.4.cmml">D</mi><mo id="S4.E38.m1.1.1.1.1.2.3.1b" xref="S4.E38.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.2.3.5" xref="S4.E38.m1.1.1.1.1.2.3.5.cmml">C</mi><mo id="S4.E38.m1.1.1.1.1.2.3.1c" xref="S4.E38.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.2.3.6" xref="S4.E38.m1.1.1.1.1.2.3.6.cmml">L</mi></mrow></msub><mo id="S4.E38.m1.1.1.1.1.1" xref="S4.E38.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E38.m1.1.1.1.1.3" xref="S4.E38.m1.1.1.1.1.3.cmml"><msub id="S4.E38.m1.1.1.1.1.3.2" xref="S4.E38.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E38.m1.1.1.1.1.3.2.2" xref="S4.E38.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.E38.m1.1.1.1.1.3.2.3" xref="S4.E38.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E38.m1.1.1.1.1.3.2.3.2" xref="S4.E38.m1.1.1.1.1.3.2.3.2.cmml">P</mi><mo id="S4.E38.m1.1.1.1.1.3.2.3.1" xref="S4.E38.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.2.3.3" xref="S4.E38.m1.1.1.1.1.3.2.3.3.cmml">R</mi><mo id="S4.E38.m1.1.1.1.1.3.2.3.1a" xref="S4.E38.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.2.3.4" xref="S4.E38.m1.1.1.1.1.3.2.3.4.cmml">E</mi></mrow></msub><mo id="S4.E38.m1.1.1.1.1.3.1" xref="S4.E38.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E38.m1.1.1.1.1.3.3" xref="S4.E38.m1.1.1.1.1.3.3.cmml"><mi id="S4.E38.m1.1.1.1.1.3.3.2" xref="S4.E38.m1.1.1.1.1.3.3.2.cmml">α</mi><mo id="S4.E38.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E38.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S4.E38.m1.1.1.1.1.3.3.3" xref="S4.E38.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E38.m1.1.1.1.1.3.3.3.2" xref="S4.E38.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S4.E38.m1.1.1.1.1.3.3.3.3" xref="S4.E38.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E38.m1.1.1.1.1.3.3.3.3.2" xref="S4.E38.m1.1.1.1.1.3.3.3.3.2.cmml">V</mi><mo id="S4.E38.m1.1.1.1.1.3.3.3.3.1" xref="S4.E38.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.3.3.3.3" xref="S4.E38.m1.1.1.1.1.3.3.3.3.3.cmml">A</mi><mo id="S4.E38.m1.1.1.1.1.3.3.3.3.1a" xref="S4.E38.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.3.3.3.4" xref="S4.E38.m1.1.1.1.1.3.3.3.3.4.cmml">E</mi></mrow></msub></mrow><mo id="S4.E38.m1.1.1.1.1.3.1a" xref="S4.E38.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E38.m1.1.1.1.1.3.4" xref="S4.E38.m1.1.1.1.1.3.4.cmml"><mi id="S4.E38.m1.1.1.1.1.3.4.2" xref="S4.E38.m1.1.1.1.1.3.4.2.cmml">β</mi><mo id="S4.E38.m1.1.1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E38.m1.1.1.1.1.3.4.1.cmml">⋅</mo><msub id="S4.E38.m1.1.1.1.1.3.4.3" xref="S4.E38.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E38.m1.1.1.1.1.3.4.3.2" xref="S4.E38.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S4.E38.m1.1.1.1.1.3.4.3.3" xref="S4.E38.m1.1.1.1.1.3.4.3.3.cmml"><mi id="S4.E38.m1.1.1.1.1.3.4.3.3.2" xref="S4.E38.m1.1.1.1.1.3.4.3.3.2.cmml">S</mi><mo id="S4.E38.m1.1.1.1.1.3.4.3.3.1" xref="S4.E38.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.4.3.3.3" xref="S4.E38.m1.1.1.1.1.3.4.3.3.3.cmml">C</mi><mo id="S4.E38.m1.1.1.1.1.3.4.3.3.1a" xref="S4.E38.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S4.E38.m1.1.1.1.1.3.4.3.3.4" xref="S4.E38.m1.1.1.1.1.3.4.3.3.4.cmml">L</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E38.m1.1.1.1.2" lspace="0em" xref="S4.E38.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E38.m1.1b"><apply id="S4.E38.m1.1.1.1.1.cmml" xref="S4.E38.m1.1.1.1"><eq id="S4.E38.m1.1.1.1.1.1.cmml" xref="S4.E38.m1.1.1.1.1.1"></eq><apply id="S4.E38.m1.1.1.1.1.2.cmml" xref="S4.E38.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E38.m1.1.1.1.1.2.1.cmml" xref="S4.E38.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E38.m1.1.1.1.1.2.2.cmml" xref="S4.E38.m1.1.1.1.1.2.2">ℒ</ci><apply id="S4.E38.m1.1.1.1.1.2.3.cmml" xref="S4.E38.m1.1.1.1.1.2.3"><times id="S4.E38.m1.1.1.1.1.2.3.1.cmml" xref="S4.E38.m1.1.1.1.1.2.3.1"></times><ci id="S4.E38.m1.1.1.1.1.2.3.2.cmml" xref="S4.E38.m1.1.1.1.1.2.3.2">𝑀</ci><ci id="S4.E38.m1.1.1.1.1.2.3.3.cmml" xref="S4.E38.m1.1.1.1.1.2.3.3">𝐼</ci><ci id="S4.E38.m1.1.1.1.1.2.3.4.cmml" xref="S4.E38.m1.1.1.1.1.2.3.4">𝐷</ci><ci id="S4.E38.m1.1.1.1.1.2.3.5.cmml" xref="S4.E38.m1.1.1.1.1.2.3.5">𝐶</ci><ci id="S4.E38.m1.1.1.1.1.2.3.6.cmml" xref="S4.E38.m1.1.1.1.1.2.3.6">𝐿</ci></apply></apply><apply id="S4.E38.m1.1.1.1.1.3.cmml" xref="S4.E38.m1.1.1.1.1.3"><plus id="S4.E38.m1.1.1.1.1.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.1"></plus><apply id="S4.E38.m1.1.1.1.1.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E38.m1.1.1.1.1.3.2.1.cmml" xref="S4.E38.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E38.m1.1.1.1.1.3.2.2.cmml" xref="S4.E38.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S4.E38.m1.1.1.1.1.3.2.3.cmml" xref="S4.E38.m1.1.1.1.1.3.2.3"><times id="S4.E38.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E38.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.2.3.2">𝑃</ci><ci id="S4.E38.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.2.3.3">𝑅</ci><ci id="S4.E38.m1.1.1.1.1.3.2.3.4.cmml" xref="S4.E38.m1.1.1.1.1.3.2.3.4">𝐸</ci></apply></apply><apply id="S4.E38.m1.1.1.1.1.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.3"><ci id="S4.E38.m1.1.1.1.1.3.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.3.1">⋅</ci><ci id="S4.E38.m1.1.1.1.1.3.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S4.E38.m1.1.1.1.1.3.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E38.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E38.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S4.E38.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.3"><times id="S4.E38.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S4.E38.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.3.2">𝑉</ci><ci id="S4.E38.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.3.3">𝐴</ci><ci id="S4.E38.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S4.E38.m1.1.1.1.1.3.3.3.3.4">𝐸</ci></apply></apply></apply><apply id="S4.E38.m1.1.1.1.1.3.4.cmml" xref="S4.E38.m1.1.1.1.1.3.4"><ci id="S4.E38.m1.1.1.1.1.3.4.1.cmml" xref="S4.E38.m1.1.1.1.1.3.4.1">⋅</ci><ci id="S4.E38.m1.1.1.1.1.3.4.2.cmml" xref="S4.E38.m1.1.1.1.1.3.4.2">𝛽</ci><apply id="S4.E38.m1.1.1.1.1.3.4.3.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S4.E38.m1.1.1.1.1.3.4.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S4.E38.m1.1.1.1.1.3.4.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="S4.E38.m1.1.1.1.1.3.4.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.3"><times id="S4.E38.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S4.E38.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.3.2">𝑆</ci><ci id="S4.E38.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.3.3">𝐶</ci><ci id="S4.E38.m1.1.1.1.1.3.4.3.3.4.cmml" xref="S4.E38.m1.1.1.1.1.3.4.3.3.4">𝐿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E38.m1.1c">\mathcal{L}_{MIDCL}=\mathcal{L}_{PRE}+\alpha\cdot\mathcal{L}_{VAE}+\beta\cdot%
\mathcal{L}_{SCL}.</annotation><annotation encoding="application/x-llamapun" id="S4.E38.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_M italic_I italic_D italic_C italic_L end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_P italic_R italic_E end_POSTSUBSCRIPT + italic_α ⋅ caligraphic_L start_POSTSUBSCRIPT italic_V italic_A italic_E end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we wish to explore the following questions:</p>
</div>
<div class="ltx_para" id="S5.p2">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">RQ1</span>: How does MIDCL perform compared to other baseline methods?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">RQ2</span>: How do the various hyperparameters affect MIDCL?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">RQ3</span>: Are modules that intention disentanglement and contrastive learning in MIDCL effective?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">RQ4</span>: How is intention optimized during the training of MIDCL?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setting</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS1.1.1">Datasets</span>
</h4>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">We choose four real-world datasets, which record the real interaction records of users on different platforms. The specific information about each dataset is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.T1" title="Table 1 ‣ 5.1.1 Datasets ‣ 5.1 Experimental Setting ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.3.2" style="font-size:90%;">Statistics of the real-world datasets (after preprocessing).</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.1" style="padding:1pt 2.8pt;">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.2" style="padding:1pt 2.8pt;">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.3" style="padding:1pt 2.8pt;">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.4" style="padding:1pt 2.8pt;">#Actions</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.5" style="padding:1pt 2.8pt;">Sparsity</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.6" style="padding:1pt 2.8pt;">Avg.len</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.1" style="padding:1pt 2.8pt;">Yelp</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.2" style="padding:1pt 2.8pt;">30,431</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.3" style="padding:1pt 2.8pt;">20,033</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.4" style="padding:1pt 2.8pt;">316,354</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.5" style="padding:1pt 2.8pt;">99.95%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.4.2.1.6" style="padding:1pt 2.8pt;">10.4</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.3.2">
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.1" style="padding:1pt 2.8pt;">Gowalla</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.2" style="padding:1pt 2.8pt;">86,168</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.3" style="padding:1pt 2.8pt;">1,271,638</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.4" style="padding:1pt 2.8pt;">6,397,903</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.5" style="padding:1pt 2.8pt;">99.99%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.3.2.6" style="padding:1pt 2.8pt;">74.3</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.4.3">
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.1" style="padding:1pt 2.8pt;">Toys</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.2" style="padding:1pt 2.8pt;">19,412</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.3" style="padding:1pt 2.8pt;">11,924</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.4" style="padding:1pt 2.8pt;">167,597</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.5" style="padding:1pt 2.8pt;">99.93%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.4.4.3.6" style="padding:1pt 2.8pt;">8.6</td>
</tr>
<tr class="ltx_tr" id="S5.T1.4.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.1" style="padding:1pt 2.8pt;">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.2" style="padding:1pt 2.8pt;">22,363</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.3" style="padding:1pt 2.8pt;">12,101</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.4" style="padding:1pt 2.8pt;">198,502</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.5" style="padding:1pt 2.8pt;">99.93%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.4.5.4.6" style="padding:1pt 2.8pt;">8.9</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Yelp<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><span class="ltx_text ltx_font_medium" id="footnote1.5">https://www.yelp.com/dataset</span></span></span></span></span>: The dataset is derived from the Yelp ratings network for sentiment computing and social analytics, which contains about 7 million reviews and other business records provided by about 2 million users.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">Gowalla<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_medium" id="footnote2.5">https://snap.stanford.edu/data/loc-gowalla.html</span></span></span></span></span>: This dataset is divided into friend relationship data and location check-in data, and we choose the interaction information of location check-in to model the user’s geographic trajectory prediction.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">Toys &amp; Beauty<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><span class="ltx_text ltx_font_medium" id="footnote3.5">https://jmcauley.ucsd.edu/data/amazon</span></span></span></span></span>: Contains toys and beauty sales data from Amazon, which can be used for marketing analysis and user purchase behavior prediction.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p3">
<p class="ltx_p" id="S5.SS1.SSS1.p3.3">All of the users’ records are sorted by timestamp, based on the ‘5-Core’ criterion, all datasets are deleted for each user and item with less than <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p3.1.m1.1"><semantics id="S5.SS1.SSS1.p3.1.m1.1a"><mn id="S5.SS1.SSS1.p3.1.m1.1.1" xref="S5.SS1.SSS1.p3.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p3.1.m1.1b"><cn id="S5.SS1.SSS1.p3.1.m1.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p3.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p3.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p3.1.m1.1d">5</annotation></semantics></math> interactions, and with reference to the leave-one-out strategy, the validation set takes the penultimate item, the test set takes the last item, i.e., the one that has been interacted with most recently, as a positive sample, and then <math alttext="99" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p3.2.m2.1"><semantics id="S5.SS1.SSS1.p3.2.m2.1a"><mn id="S5.SS1.SSS1.p3.2.m2.1.1" xref="S5.SS1.SSS1.p3.2.m2.1.1.cmml">99</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p3.2.m2.1b"><cn id="S5.SS1.SSS1.p3.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p3.2.m2.1.1">99</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p3.2.m2.1c">99</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p3.2.m2.1d">99</annotation></semantics></math> items from the remaining set of uninteracted items are taken as negative samples, constituting the test set of <math alttext="1:99" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p3.3.m3.1"><semantics id="S5.SS1.SSS1.p3.3.m3.1a"><mrow id="S5.SS1.SSS1.p3.3.m3.1.1" xref="S5.SS1.SSS1.p3.3.m3.1.1.cmml"><mn id="S5.SS1.SSS1.p3.3.m3.1.1.2" xref="S5.SS1.SSS1.p3.3.m3.1.1.2.cmml">1</mn><mo id="S5.SS1.SSS1.p3.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S5.SS1.SSS1.p3.3.m3.1.1.1.cmml">:</mo><mn id="S5.SS1.SSS1.p3.3.m3.1.1.3" xref="S5.SS1.SSS1.p3.3.m3.1.1.3.cmml">99</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p3.3.m3.1b"><apply id="S5.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S5.SS1.SSS1.p3.3.m3.1.1"><ci id="S5.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S5.SS1.SSS1.p3.3.m3.1.1.1">:</ci><cn id="S5.SS1.SSS1.p3.3.m3.1.1.2.cmml" type="integer" xref="S5.SS1.SSS1.p3.3.m3.1.1.2">1</cn><cn id="S5.SS1.SSS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.SSS1.p3.3.m3.1.1.3">99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p3.3.m3.1c">1:99</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p3.3.m3.1d">1 : 99</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p4">
<p class="ltx_p" id="S5.SS1.SSS1.p4.1">In order to enrich the content of the training set, the sequences of the last two items of each cut are sequentially used as the training set labels starting from the second item, and the training portion is all the items before this label, starting from the second item is to ensure that the length of the training portion is at least <math alttext="1" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p4.1.m1.1"><semantics id="S5.SS1.SSS1.p4.1.m1.1a"><mn id="S5.SS1.SSS1.p4.1.m1.1.1" xref="S5.SS1.SSS1.p4.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p4.1.m1.1b"><cn id="S5.SS1.SSS1.p4.1.m1.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p4.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p4.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p4.1.m1.1d">1</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.1.1">Evaluation Metrics</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.3">In this experiment, we choose <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.3.1">Hit Ratio</span> (HR@<math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mi id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><ci id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">italic_K</annotation></semantics></math>), <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.3.2">Mean Reciprocal</span> (MRR) and <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.3.3">Normalized Discounted Cumulative Gain</span> (NDCG@<math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><mi id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><ci id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.2.m2.1d">italic_K</annotation></semantics></math>) to evaluate model performance where <math alttext="K\in\{5,10\}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.3.m3.2"><semantics id="S5.SS1.SSS2.p1.3.m3.2a"><mrow id="S5.SS1.SSS2.p1.3.m3.2.3" xref="S5.SS1.SSS2.p1.3.m3.2.3.cmml"><mi id="S5.SS1.SSS2.p1.3.m3.2.3.2" xref="S5.SS1.SSS2.p1.3.m3.2.3.2.cmml">K</mi><mo id="S5.SS1.SSS2.p1.3.m3.2.3.1" xref="S5.SS1.SSS2.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S5.SS1.SSS2.p1.3.m3.2.3.3.2" xref="S5.SS1.SSS2.p1.3.m3.2.3.3.1.cmml"><mo id="S5.SS1.SSS2.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S5.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">{</mo><mn id="S5.SS1.SSS2.p1.3.m3.1.1" xref="S5.SS1.SSS2.p1.3.m3.1.1.cmml">5</mn><mo id="S5.SS1.SSS2.p1.3.m3.2.3.3.2.2" xref="S5.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS2.p1.3.m3.2.2" xref="S5.SS1.SSS2.p1.3.m3.2.2.cmml">10</mn><mo id="S5.SS1.SSS2.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S5.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.3.m3.2b"><apply id="S5.SS1.SSS2.p1.3.m3.2.3.cmml" xref="S5.SS1.SSS2.p1.3.m3.2.3"><in id="S5.SS1.SSS2.p1.3.m3.2.3.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.2.3.1"></in><ci id="S5.SS1.SSS2.p1.3.m3.2.3.2.cmml" xref="S5.SS1.SSS2.p1.3.m3.2.3.2">𝐾</ci><set id="S5.SS1.SSS2.p1.3.m3.2.3.3.1.cmml" xref="S5.SS1.SSS2.p1.3.m3.2.3.3.2"><cn id="S5.SS1.SSS2.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.1.1">5</cn><cn id="S5.SS1.SSS2.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS1.SSS2.p1.3.m3.2.2">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.3.m3.2c">K\in\{5,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.3.m3.2d">italic_K ∈ { 5 , 10 }</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.1.1">Baseline Methods</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">We compare MIDCL with the following ten baesline methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS3.p2">
<p class="ltx_p" id="S5.SS1.SSS3.p2.1">(1) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p2.1.1">Machine Learning based methods</span>.</p>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i1.p1.1.1">BPR-MF</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib45" title="">45</a>]</cite>: Incorporating Matrix Factorization based Collaborative Filtering methods and implicit feedback-based ranking learning methods.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i2.p1.1.1">FPMC</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib2" title="">2</a>]</cite>: Combining Matrix Factorization with Markov Chain for personalized recommendations.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS3.p3">
<p class="ltx_p" id="S5.SS1.SSS3.p3.1">(2) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p3.1.1">Deep Learning based methods</span>.</p>
<ul class="ltx_itemize" id="S5.I4">
<li class="ltx_item" id="S5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i1.p1">
<p class="ltx_p" id="S5.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I4.i1.p1.1.1">Caser</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib5" title="">5</a>]</cite>: Mining the local features of sequences using convolution kernels in two different directions, vertically and horizontally, respectively.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i2.p1">
<p class="ltx_p" id="S5.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I4.i2.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib4" title="">4</a>]</cite>: Modeling progressive dependencies of user sequence elements via Gated Recurrent Unit (GRU)s.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i3.p1">
<p class="ltx_p" id="S5.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I4.i3.p1.1.1">GRU4Rec<sup class="ltx_sup" id="S5.I4.i3.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="S5.I4.i3.p1.1.1.1.1">+</span></sup></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib46" title="">46</a>]</cite>: Improvements to the loss function, sampling method and regularization technique based on GRU4Rec.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i4.p1">
<p class="ltx_p" id="S5.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I4.i4.p1.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib6" title="">6</a>]</cite>: Based on the self-attention mechanism (Transformer) , it can accept longer sequences than GRU and capture potential features among items.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i5.p1">
<p class="ltx_p" id="S5.I4.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I4.i5.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib9" title="">9</a>]</cite>: A Transformer-based recommendation model for large sequences, with a pre-training approach and fine-tuning strategy, and with a deep bi-directional self-attention mechanism to capture the dependencies between complex items in user interaction sequences.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.SSS3.p4">
<p class="ltx_p" id="S5.SS1.SSS3.p4.1">(3) <span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.p4.1.1">Contrastive Learning based methods</span>.</p>
<ul class="ltx_itemize" id="S5.I5">
<li class="ltx_item" id="S5.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i1.p1">
<p class="ltx_p" id="S5.I5.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S5.I5.i1.p1.2.2">S<sup class="ltx_sup" id="S5.I5.i1.p1.2.2.1"><span class="ltx_text ltx_font_medium" id="S5.I5.i1.p1.2.2.1.1">3</span></sup>-Rec<math alttext="{{}_{\text{MIP}}}" class="ltx_Math" display="inline" id="S5.I5.i1.p1.2.2.m2.1"><semantics id="S5.I5.i1.p1.2.2.m2.1a"><msub id="S5.I5.i1.p1.2.2.m2.1.1" xref="S5.I5.i1.p1.2.2.m2.1.1.cmml"><mi id="S5.I5.i1.p1.2.2.m2.1.1a" xref="S5.I5.i1.p1.2.2.m2.1.1.cmml"></mi><mtext class="ltx_mathvariant_bold" id="S5.I5.i1.p1.2.2.m2.1.1.1" xref="S5.I5.i1.p1.2.2.m2.1.1.1a.cmml">MIP</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.I5.i1.p1.2.2.m2.1b"><apply id="S5.I5.i1.p1.2.2.m2.1.1.cmml" xref="S5.I5.i1.p1.2.2.m2.1.1"><ci id="S5.I5.i1.p1.2.2.m2.1.1.1a.cmml" xref="S5.I5.i1.p1.2.2.m2.1.1.1"><mtext class="ltx_mathvariant_bold" id="S5.I5.i1.p1.2.2.m2.1.1.1.cmml" mathsize="70%" xref="S5.I5.i1.p1.2.2.m2.1.1.1">MIP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I5.i1.p1.2.2.m2.1c">{{}_{\text{MIP}}}</annotation><annotation encoding="application/x-llamapun" id="S5.I5.i1.p1.2.2.m2.1d">start_FLOATSUBSCRIPT MIP end_FLOATSUBSCRIPT</annotation></semantics></math></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib31" title="">31</a>]</cite>: A self-supervised pretraining model based on MIM and proposes four types of learning objectives. In the comparative experiment in this section, we only use MIP i.e. Masked Item Prediction.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i2.p1">
<p class="ltx_p" id="S5.I5.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I5.i2.p1.1.1">CL4SRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib32" title="">32</a>]</cite>: Combining a multi-task contrastive learning model with a multi-head self-attention mechanism, three stochastic enhancement operators are proposed for generating positive and negative samples in contrastive learning.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I5.i3.p1">
<p class="ltx_p" id="S5.I5.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I5.i3.p1.1.1">CoSeRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#bib.bib33" title="">33</a>]</cite>: A contrastive learning framework based on the Transformer encoder proposes two informative enhancement operators based on CL4SRec, aiming to maintain model robustness.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4 </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS4.1.1">Implementation Details</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.16">All model parameters in the baselines are taken from the original papers, where fixes the parameters with embedding dimension as 64, batch size as 256 and the maximum sequence length as 50. Our method is implemented in PyTorch, the optimizer is chosen as <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS4.p1.16.1">Adam</span>, the learning rate is <math alttext="1e^{-2}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.1.m1.1"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><mrow id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml"><mn id="S5.SS1.SSS4.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.p1.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS1.SSS4.p1.1.m1.1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.1.cmml">⁢</mo><msup id="S5.SS1.SSS4.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml"><mi id="S5.SS1.SSS4.p1.1.m1.1.1.3.2" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.SS1.SSS4.p1.1.m1.1.1.3.3" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3.cmml"><mo id="S5.SS1.SSS4.p1.1.m1.1.1.3.3a" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS4.p1.1.m1.1.1.3.3.2" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><apply id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1"><times id="S5.SS1.SSS4.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.1"></times><cn id="S5.SS1.SSS4.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.SSS4.p1.1.m1.1.1.2">1</cn><apply id="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS1.SSS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.2">𝑒</ci><apply id="S5.SS1.SSS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3"><minus id="S5.SS1.SSS4.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3"></minus><cn id="S5.SS1.SSS4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">1e^{-2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.1.m1.1d">1 italic_e start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. The self-attention blocks and attention heads of Transformer encoder as 4, the <math alttext="\xi" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.2.m2.1"><semantics id="S5.SS1.SSS4.p1.2.m2.1a"><mi id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.1b"><ci id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.1c">\xi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.2.m2.1d">italic_ξ</annotation></semantics></math> in <math alttext="\mathcal{L}_{TRI}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.3.m3.1"><semantics id="S5.SS1.SSS4.p1.3.m3.1a"><msub id="S5.SS1.SSS4.p1.3.m3.1.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS4.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S5.SS1.SSS4.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml"><mi id="S5.SS1.SSS4.p1.3.m3.1.1.3.2" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.2.cmml">T</mi><mo id="S5.SS1.SSS4.p1.3.m3.1.1.3.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.3.m3.1.1.3.3" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.3.cmml">R</mi><mo id="S5.SS1.SSS4.p1.3.m3.1.1.3.1a" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.3.m3.1.1.3.4" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.4.cmml">I</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.3.m3.1b"><apply id="S5.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.2">ℒ</ci><apply id="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3"><times id="S5.SS1.SSS4.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.1"></times><ci id="S5.SS1.SSS4.p1.3.m3.1.1.3.2.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.2">𝑇</ci><ci id="S5.SS1.SSS4.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.3">𝑅</ci><ci id="S5.SS1.SSS4.p1.3.m3.1.1.3.4.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.4">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.3.m3.1c">\mathcal{L}_{TRI}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_T italic_R italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is 1.5, the <math alttext="\gamma_{c}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.4.m4.1"><semantics id="S5.SS1.SSS4.p1.4.m4.1a"><msub id="S5.SS1.SSS4.p1.4.m4.1.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.cmml"><mi id="S5.SS1.SSS4.p1.4.m4.1.1.2" xref="S5.SS1.SSS4.p1.4.m4.1.1.2.cmml">γ</mi><mi id="S5.SS1.SSS4.p1.4.m4.1.1.3" xref="S5.SS1.SSS4.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.4.m4.1b"><apply id="S5.SS1.SSS4.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.2">𝛾</ci><ci id="S5.SS1.SSS4.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.4.m4.1c">\gamma_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.4.m4.1d">italic_γ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\gamma_{m}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.5.m5.1"><semantics id="S5.SS1.SSS4.p1.5.m5.1a"><msub id="S5.SS1.SSS4.p1.5.m5.1.1" xref="S5.SS1.SSS4.p1.5.m5.1.1.cmml"><mi id="S5.SS1.SSS4.p1.5.m5.1.1.2" xref="S5.SS1.SSS4.p1.5.m5.1.1.2.cmml">γ</mi><mi id="S5.SS1.SSS4.p1.5.m5.1.1.3" xref="S5.SS1.SSS4.p1.5.m5.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.5.m5.1b"><apply id="S5.SS1.SSS4.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1.2">𝛾</ci><ci id="S5.SS1.SSS4.p1.5.m5.1.1.3.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.5.m5.1c">\gamma_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.5.m5.1d">italic_γ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\gamma_{r}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.6.m6.1"><semantics id="S5.SS1.SSS4.p1.6.m6.1a"><msub id="S5.SS1.SSS4.p1.6.m6.1.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.cmml"><mi id="S5.SS1.SSS4.p1.6.m6.1.1.2" xref="S5.SS1.SSS4.p1.6.m6.1.1.2.cmml">γ</mi><mi id="S5.SS1.SSS4.p1.6.m6.1.1.3" xref="S5.SS1.SSS4.p1.6.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.6.m6.1b"><apply id="S5.SS1.SSS4.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.6.m6.1.1.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.6.m6.1.1.2.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.2">𝛾</ci><ci id="S5.SS1.SSS4.p1.6.m6.1.1.3.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.6.m6.1c">\gamma_{r}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.6.m6.1d">italic_γ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.7.m7.1"><semantics id="S5.SS1.SSS4.p1.7.m7.1a"><msub id="S5.SS1.SSS4.p1.7.m7.1.1" xref="S5.SS1.SSS4.p1.7.m7.1.1.cmml"><mi id="S5.SS1.SSS4.p1.7.m7.1.1.2" xref="S5.SS1.SSS4.p1.7.m7.1.1.2.cmml">γ</mi><mi id="S5.SS1.SSS4.p1.7.m7.1.1.3" xref="S5.SS1.SSS4.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.7.m7.1b"><apply id="S5.SS1.SSS4.p1.7.m7.1.1.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.7.m7.1.1.1.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.7.m7.1.1.2.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1.2">𝛾</ci><ci id="S5.SS1.SSS4.p1.7.m7.1.1.3.cmml" xref="S5.SS1.SSS4.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.7.m7.1c">\gamma_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.7.m7.1d">italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\gamma_{s}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.8.m8.1"><semantics id="S5.SS1.SSS4.p1.8.m8.1a"><msub id="S5.SS1.SSS4.p1.8.m8.1.1" xref="S5.SS1.SSS4.p1.8.m8.1.1.cmml"><mi id="S5.SS1.SSS4.p1.8.m8.1.1.2" xref="S5.SS1.SSS4.p1.8.m8.1.1.2.cmml">γ</mi><mi id="S5.SS1.SSS4.p1.8.m8.1.1.3" xref="S5.SS1.SSS4.p1.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.8.m8.1b"><apply id="S5.SS1.SSS4.p1.8.m8.1.1.cmml" xref="S5.SS1.SSS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.8.m8.1.1.1.cmml" xref="S5.SS1.SSS4.p1.8.m8.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.8.m8.1.1.2.cmml" xref="S5.SS1.SSS4.p1.8.m8.1.1.2">𝛾</ci><ci id="S5.SS1.SSS4.p1.8.m8.1.1.3.cmml" xref="S5.SS1.SSS4.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.8.m8.1c">\gamma_{s}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.8.m8.1d">italic_γ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="AO" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.9.m9.1"><semantics id="S5.SS1.SSS4.p1.9.m9.1a"><mrow id="S5.SS1.SSS4.p1.9.m9.1.1" xref="S5.SS1.SSS4.p1.9.m9.1.1.cmml"><mi id="S5.SS1.SSS4.p1.9.m9.1.1.2" xref="S5.SS1.SSS4.p1.9.m9.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS4.p1.9.m9.1.1.1" xref="S5.SS1.SSS4.p1.9.m9.1.1.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.9.m9.1.1.3" xref="S5.SS1.SSS4.p1.9.m9.1.1.3.cmml">O</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.9.m9.1b"><apply id="S5.SS1.SSS4.p1.9.m9.1.1.cmml" xref="S5.SS1.SSS4.p1.9.m9.1.1"><times id="S5.SS1.SSS4.p1.9.m9.1.1.1.cmml" xref="S5.SS1.SSS4.p1.9.m9.1.1.1"></times><ci id="S5.SS1.SSS4.p1.9.m9.1.1.2.cmml" xref="S5.SS1.SSS4.p1.9.m9.1.1.2">𝐴</ci><ci id="S5.SS1.SSS4.p1.9.m9.1.1.3.cmml" xref="S5.SS1.SSS4.p1.9.m9.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.9.m9.1c">AO</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.9.m9.1d">italic_A italic_O</annotation></semantics></math> are set to 0.2, 0.3, 0.3, 0.2, 0.3, respectively. The temperature coefficient <math alttext="\tau" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.10.m10.1"><semantics id="S5.SS1.SSS4.p1.10.m10.1a"><mi id="S5.SS1.SSS4.p1.10.m10.1.1" xref="S5.SS1.SSS4.p1.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.10.m10.1b"><ci id="S5.SS1.SSS4.p1.10.m10.1.1.cmml" xref="S5.SS1.SSS4.p1.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.10.m10.1d">italic_τ</annotation></semantics></math> in <math alttext="\mathcal{L}_{SCL}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.11.m11.1"><semantics id="S5.SS1.SSS4.p1.11.m11.1a"><msub id="S5.SS1.SSS4.p1.11.m11.1.1" xref="S5.SS1.SSS4.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS4.p1.11.m11.1.1.2" xref="S5.SS1.SSS4.p1.11.m11.1.1.2.cmml">ℒ</mi><mrow id="S5.SS1.SSS4.p1.11.m11.1.1.3" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.cmml"><mi id="S5.SS1.SSS4.p1.11.m11.1.1.3.2" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.2.cmml">S</mi><mo id="S5.SS1.SSS4.p1.11.m11.1.1.3.1" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.11.m11.1.1.3.3" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.3.cmml">C</mi><mo id="S5.SS1.SSS4.p1.11.m11.1.1.3.1a" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.SSS4.p1.11.m11.1.1.3.4" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.11.m11.1b"><apply id="S5.SS1.SSS4.p1.11.m11.1.1.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.11.m11.1.1.1.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.11.m11.1.1.2.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.2">ℒ</ci><apply id="S5.SS1.SSS4.p1.11.m11.1.1.3.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.3"><times id="S5.SS1.SSS4.p1.11.m11.1.1.3.1.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.1"></times><ci id="S5.SS1.SSS4.p1.11.m11.1.1.3.2.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.2">𝑆</ci><ci id="S5.SS1.SSS4.p1.11.m11.1.1.3.3.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.3">𝐶</ci><ci id="S5.SS1.SSS4.p1.11.m11.1.1.3.4.cmml" xref="S5.SS1.SSS4.p1.11.m11.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.11.m11.1c">\mathcal{L}_{SCL}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.11.m11.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math> is taken as 0.8, the weighting factors <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.12.m12.1"><semantics id="S5.SS1.SSS4.p1.12.m12.1a"><mi id="S5.SS1.SSS4.p1.12.m12.1.1" xref="S5.SS1.SSS4.p1.12.m12.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.12.m12.1b"><ci id="S5.SS1.SSS4.p1.12.m12.1.1.cmml" xref="S5.SS1.SSS4.p1.12.m12.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.12.m12.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.12.m12.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.13.m13.1"><semantics id="S5.SS1.SSS4.p1.13.m13.1a"><mi id="S5.SS1.SSS4.p1.13.m13.1.1" xref="S5.SS1.SSS4.p1.13.m13.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.13.m13.1b"><ci id="S5.SS1.SSS4.p1.13.m13.1.1.cmml" xref="S5.SS1.SSS4.p1.13.m13.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.13.m13.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.13.m13.1d">italic_β</annotation></semantics></math> within <math alttext="\{0.1,0.2,0.3,0.4,0.5\}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.14.m14.5"><semantics id="S5.SS1.SSS4.p1.14.m14.5a"><mrow id="S5.SS1.SSS4.p1.14.m14.5.6.2" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml"><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.1" stretchy="false" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">{</mo><mn id="S5.SS1.SSS4.p1.14.m14.1.1" xref="S5.SS1.SSS4.p1.14.m14.1.1.cmml">0.1</mn><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.2" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.14.m14.2.2" xref="S5.SS1.SSS4.p1.14.m14.2.2.cmml">0.2</mn><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.3" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.14.m14.3.3" xref="S5.SS1.SSS4.p1.14.m14.3.3.cmml">0.3</mn><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.4" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.14.m14.4.4" xref="S5.SS1.SSS4.p1.14.m14.4.4.cmml">0.4</mn><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.5" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.14.m14.5.5" xref="S5.SS1.SSS4.p1.14.m14.5.5.cmml">0.5</mn><mo id="S5.SS1.SSS4.p1.14.m14.5.6.2.6" stretchy="false" xref="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.14.m14.5b"><set id="S5.SS1.SSS4.p1.14.m14.5.6.1.cmml" xref="S5.SS1.SSS4.p1.14.m14.5.6.2"><cn id="S5.SS1.SSS4.p1.14.m14.1.1.cmml" type="float" xref="S5.SS1.SSS4.p1.14.m14.1.1">0.1</cn><cn id="S5.SS1.SSS4.p1.14.m14.2.2.cmml" type="float" xref="S5.SS1.SSS4.p1.14.m14.2.2">0.2</cn><cn id="S5.SS1.SSS4.p1.14.m14.3.3.cmml" type="float" xref="S5.SS1.SSS4.p1.14.m14.3.3">0.3</cn><cn id="S5.SS1.SSS4.p1.14.m14.4.4.cmml" type="float" xref="S5.SS1.SSS4.p1.14.m14.4.4">0.4</cn><cn id="S5.SS1.SSS4.p1.14.m14.5.5.cmml" type="float" xref="S5.SS1.SSS4.p1.14.m14.5.5">0.5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.14.m14.5c">\{0.1,0.2,0.3,0.4,0.5\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.14.m14.5d">{ 0.1 , 0.2 , 0.3 , 0.4 , 0.5 }</annotation></semantics></math>, and the number of intentions <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.15.m15.1"><semantics id="S5.SS1.SSS4.p1.15.m15.1a"><mi id="S5.SS1.SSS4.p1.15.m15.1.1" xref="S5.SS1.SSS4.p1.15.m15.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.15.m15.1b"><ci id="S5.SS1.SSS4.p1.15.m15.1.1.cmml" xref="S5.SS1.SSS4.p1.15.m15.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.15.m15.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.15.m15.1d">italic_k</annotation></semantics></math> within <math alttext="\{8,16,32,64,128\}" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.16.m16.5"><semantics id="S5.SS1.SSS4.p1.16.m16.5a"><mrow id="S5.SS1.SSS4.p1.16.m16.5.6.2" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml"><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.1" stretchy="false" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">{</mo><mn id="S5.SS1.SSS4.p1.16.m16.1.1" xref="S5.SS1.SSS4.p1.16.m16.1.1.cmml">8</mn><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.2" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.16.m16.2.2" xref="S5.SS1.SSS4.p1.16.m16.2.2.cmml">16</mn><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.3" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.16.m16.3.3" xref="S5.SS1.SSS4.p1.16.m16.3.3.cmml">32</mn><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.4" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.16.m16.4.4" xref="S5.SS1.SSS4.p1.16.m16.4.4.cmml">64</mn><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.5" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.16.m16.5.5" xref="S5.SS1.SSS4.p1.16.m16.5.5.cmml">128</mn><mo id="S5.SS1.SSS4.p1.16.m16.5.6.2.6" stretchy="false" xref="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.16.m16.5b"><set id="S5.SS1.SSS4.p1.16.m16.5.6.1.cmml" xref="S5.SS1.SSS4.p1.16.m16.5.6.2"><cn id="S5.SS1.SSS4.p1.16.m16.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.16.m16.1.1">8</cn><cn id="S5.SS1.SSS4.p1.16.m16.2.2.cmml" type="integer" xref="S5.SS1.SSS4.p1.16.m16.2.2">16</cn><cn id="S5.SS1.SSS4.p1.16.m16.3.3.cmml" type="integer" xref="S5.SS1.SSS4.p1.16.m16.3.3">32</cn><cn id="S5.SS1.SSS4.p1.16.m16.4.4.cmml" type="integer" xref="S5.SS1.SSS4.p1.16.m16.4.4">64</cn><cn id="S5.SS1.SSS4.p1.16.m16.5.5.cmml" type="integer" xref="S5.SS1.SSS4.p1.16.m16.5.5">128</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.16.m16.5c">\{8,16,32,64,128\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.16.m16.5d">{ 8 , 16 , 32 , 64 , 128 }</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance Comparison (RQ1)</h3>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.4.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.5.2" style="font-size:90%;">Performance comparisons of different methods. The best score is bolded in each row, and the second best is underlined. The last column shows the relative improvement from our method compared to the best baseline result.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T2.2" style="width:433.6pt;height:244.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-118.5pt,66.8pt) scale(0.646655142295911,0.646655142295911) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.3" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.3.1">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.2.2.2.4" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.4.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.5.1">BPR-MF</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.2.2.2.6" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.6.1">FPMC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.7" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.7.1">Caser</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.8" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.8.1">GRU4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.1.1.1.1.1">GRU4Rec<sup class="ltx_sup" id="S5.T2.1.1.1.1.1.1">+</sup></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.9" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.9.1">SASRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.2.2.2.10" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.10.1">BERT4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.2" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.2.1">S<math alttext="{}^{3}\text{-Rec}_{MIP}" class="ltx_Math" display="inline" id="S5.T2.2.2.2.2.1.m1.1"><semantics id="S5.T2.2.2.2.2.1.m1.1a"><mmultiscripts id="S5.T2.2.2.2.2.1.m1.1.1" xref="S5.T2.2.2.2.2.1.m1.1.1.cmml"><mtext id="S5.T2.2.2.2.2.1.m1.1.1.2.2" xref="S5.T2.2.2.2.2.1.m1.1.1.2.2a.cmml">-Rec</mtext><mrow id="S5.T2.2.2.2.2.1.m1.1.1.2.3" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.cmml"><mi id="S5.T2.2.2.2.2.1.m1.1.1.2.3.2" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.2.cmml">M</mi><mo id="S5.T2.2.2.2.2.1.m1.1.1.2.3.1" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.T2.2.2.2.2.1.m1.1.1.2.3.3" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.3.cmml">I</mi><mo id="S5.T2.2.2.2.2.1.m1.1.1.2.3.1a" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.T2.2.2.2.2.1.m1.1.1.2.3.4" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.4.cmml">P</mi></mrow><mrow id="S5.T2.2.2.2.2.1.m1.1.1a" xref="S5.T2.2.2.2.2.1.m1.1.1.cmml"></mrow><mprescripts id="S5.T2.2.2.2.2.1.m1.1.1b" xref="S5.T2.2.2.2.2.1.m1.1.1.cmml"></mprescripts><mrow id="S5.T2.2.2.2.2.1.m1.1.1c" xref="S5.T2.2.2.2.2.1.m1.1.1.cmml"></mrow><mn id="S5.T2.2.2.2.2.1.m1.1.1.3" xref="S5.T2.2.2.2.2.1.m1.1.1.3.cmml">3</mn></mmultiscripts><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.1.m1.1b"><apply id="S5.T2.2.2.2.2.1.m1.1.1.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.2.2.2.2.1.m1.1.1.1.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1">superscript</csymbol><apply id="S5.T2.2.2.2.2.1.m1.1.1.2.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.2.2.2.2.1.m1.1.1.2.1.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S5.T2.2.2.2.2.1.m1.1.1.2.2a.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.2"><mtext id="S5.T2.2.2.2.2.1.m1.1.1.2.2.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.2">-Rec</mtext></ci><apply id="S5.T2.2.2.2.2.1.m1.1.1.2.3.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3"><times id="S5.T2.2.2.2.2.1.m1.1.1.2.3.1.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.1"></times><ci id="S5.T2.2.2.2.2.1.m1.1.1.2.3.2.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.2">𝑀</ci><ci id="S5.T2.2.2.2.2.1.m1.1.1.2.3.3.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.3">𝐼</ci><ci id="S5.T2.2.2.2.2.1.m1.1.1.2.3.4.cmml" xref="S5.T2.2.2.2.2.1.m1.1.1.2.3.4">𝑃</ci></apply></apply><cn id="S5.T2.2.2.2.2.1.m1.1.1.3.cmml" type="integer" xref="S5.T2.2.2.2.2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.1.m1.1c">{}^{3}\text{-Rec}_{MIP}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.2.1.m1.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT -Rec start_POSTSUBSCRIPT italic_M italic_I italic_P end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.11" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.11.1">CL4SRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.2.2.2.12" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.12.1">CoSeRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.2.2.2.13" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.2.13.1">MIDCL</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T2.2.2.2.14" style="padding:1pt 4.3pt;">Improv.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.2.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.2.2.3.1.1" rowspan="5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.3.1.1.1">Yelp</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.2.2.3.1.2" style="padding:1pt 4.3pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.3" style="padding:1pt 4.3pt;">0.4512</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.2.2.3.1.4" style="padding:1pt 4.3pt;">0.4823</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.5" style="padding:1pt 4.3pt;">0.5123</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.6" style="padding:1pt 4.3pt;">0.5277</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.7" style="padding:1pt 4.3pt;">0.5513</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.8" style="padding:1pt 4.3pt;">0.5672</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.2.2.3.1.9" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.3.1.9.1">0.5942</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.10" style="padding:1pt 4.3pt;">0.5381</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.2.2.3.1.11" style="padding:1pt 4.3pt;">0.5726</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.2.2.3.1.12" style="padding:1pt 4.3pt;">0.5808</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.2.2.3.1.13" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.3.1.13.1">0.6375</span></td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S5.T2.2.2.3.1.14" style="padding:1pt 4.3pt;">7.29%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.4.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.4.2.1" style="padding:1pt 4.3pt;">HR@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.2" style="padding:1pt 4.3pt;">0.5877</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.4.2.3" style="padding:1pt 4.3pt;">0.6173</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.4" style="padding:1pt 4.3pt;">0.6589</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.5" style="padding:1pt 4.3pt;">0.6854</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.6" style="padding:1pt 4.3pt;">0.7143</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.7" style="padding:1pt 4.3pt;">0.7378</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.4.2.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.4.2.8.1">0.7683</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.9" style="padding:1pt 4.3pt;">0.7264</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.4.2.10" style="padding:1pt 4.3pt;">0.7429</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.4.2.11" style="padding:1pt 4.3pt;">0.7548</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.4.2.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.4.2.12.1">0.7970</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.4.2.13" style="padding:1pt 4.3pt;">3.74%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.5.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.5.3.1" style="padding:1pt 4.3pt;">MRR</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.2" style="padding:1pt 4.3pt;">0.2908</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.5.3.3" style="padding:1pt 4.3pt;">0.3306</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.4" style="padding:1pt 4.3pt;">0.3528</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.5" style="padding:1pt 4.3pt;">0.3659</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.6" style="padding:1pt 4.3pt;">0.3761</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.7" style="padding:1pt 4.3pt;">0.3896</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.5.3.8" style="padding:1pt 4.3pt;">0.4142</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.9" style="padding:1pt 4.3pt;">0.3617</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.5.3.10" style="padding:1pt 4.3pt;">0.4084</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.5.3.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.5.3.11.1">0.4167</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.5.3.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.5.3.12.1">0.4320</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.5.3.13" style="padding:1pt 4.3pt;">3.67%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.6.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.6.4.1" style="padding:1pt 4.3pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.2" style="padding:1pt 4.3pt;">0.3228</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.6.4.3" style="padding:1pt 4.3pt;">0.3615</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.4" style="padding:1pt 4.3pt;">0.3547</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.5" style="padding:1pt 4.3pt;">0.3782</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.6" style="padding:1pt 4.3pt;">0.3858</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.7" style="padding:1pt 4.3pt;">0.4098</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.6.4.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.6.4.8.1">0.4352</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.9" style="padding:1pt 4.3pt;">0.3760</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.6.4.10" style="padding:1pt 4.3pt;">0.4130</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.6.4.11" style="padding:1pt 4.3pt;">0.4280</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.6.4.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.6.4.12.1">0.4669</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.6.4.13" style="padding:1pt 4.3pt;">7.28%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.7.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.7.5.1" style="padding:1pt 4.3pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.2" style="padding:1pt 4.3pt;">0.3752</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.7.5.3" style="padding:1pt 4.3pt;">0.4128</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.4" style="padding:1pt 4.3pt;">0.4092</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.5" style="padding:1pt 4.3pt;">0.4251</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.6" style="padding:1pt 4.3pt;">0.4476</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.7" style="padding:1pt 4.3pt;">0.4564</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.7.5.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.7.5.8.1">0.4837</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.9" style="padding:1pt 4.3pt;">0.4355</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.7.5.10" style="padding:1pt 4.3pt;">0.4586</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.7.5.11" style="padding:1pt 4.3pt;">0.46298</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.7.5.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.7.5.12.1">0.5187</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.7.5.13" style="padding:1pt 4.3pt;">7.24%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.8.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.2.8.6.1" rowspan="5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.8.6.1.1">Gowalla</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.2.2.8.6.2" style="padding:1pt 4.3pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.3" style="padding:1pt 4.3pt;">0.3260</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.8.6.4" style="padding:1pt 4.3pt;">0.3751</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.5" style="padding:1pt 4.3pt;">0.4529</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.6" style="padding:1pt 4.3pt;">0.4397</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.7" style="padding:1pt 4.3pt;">0.4658</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.8.6.8.1">0.5673</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.8.6.9" style="padding:1pt 4.3pt;">0.5624</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.10" style="padding:1pt 4.3pt;">0.4214</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.8.6.11" style="padding:1pt 4.3pt;">0.4601</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.8.6.12" style="padding:1pt 4.3pt;">0.4586</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.8.6.13" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.8.6.13.1">0.6049</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.2.2.8.6.14" style="padding:1pt 4.3pt;">6.63%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.9.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.9.7.1" style="padding:1pt 4.3pt;">HR@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.2" style="padding:1pt 4.3pt;">0.4112</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.9.7.3" style="padding:1pt 4.3pt;">0.4581</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.4" style="padding:1pt 4.3pt;">0.5038</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.5" style="padding:1pt 4.3pt;">0.4813</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.6" style="padding:1pt 4.3pt;">0.5160</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.7" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.9.7.7.1">0.6152</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.9.7.8" style="padding:1pt 4.3pt;">0.6080</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.9" style="padding:1pt 4.3pt;">0.4697</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.9.7.10" style="padding:1pt 4.3pt;">0.5095</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.9.7.11" style="padding:1pt 4.3pt;">0.5079</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.9.7.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.9.7.12.1">0.6454</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.9.7.13" style="padding:1pt 4.3pt;">4.90%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.10.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.10.8.1" style="padding:1pt 4.3pt;">MRR</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.2" style="padding:1pt 4.3pt;">0.3038</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.10.8.3" style="padding:1pt 4.3pt;">0.3494</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.4" style="padding:1pt 4.3pt;">0.3913</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.5" style="padding:1pt 4.3pt;">0.3685</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.6" style="padding:1pt 4.3pt;">0.3962</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.7" style="padding:1pt 4.3pt;">0.5108</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.10.8.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.10.8.8.1">0.5189</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.9" style="padding:1pt 4.3pt;">0.3515</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.10.8.10" style="padding:1pt 4.3pt;">0.3908</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.10.8.11" style="padding:1pt 4.3pt;">0.3840</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.10.8.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.10.8.12.1">0.5311</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.10.8.13" style="padding:1pt 4.3pt;">2.35%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.11.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.11.9.1" style="padding:1pt 4.3pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.2" style="padding:1pt 4.3pt;">0.3134</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.11.9.3" style="padding:1pt 4.3pt;">0.3515</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.4" style="padding:1pt 4.3pt;">0.4143</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.5" style="padding:1pt 4.3pt;">0.3782</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.6" style="padding:1pt 4.3pt;">0.4079</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.7" style="padding:1pt 4.3pt;">0.5075</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.11.9.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.11.9.8.1">0.5186</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.9" style="padding:1pt 4.3pt;">0.3652</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.11.9.10" style="padding:1pt 4.3pt;">0.4167</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.11.9.11" style="padding:1pt 4.3pt;">0.4012</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.11.9.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.11.9.12.1">0.5455</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.11.9.13" style="padding:1pt 4.3pt;">5.19%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.12.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.12.10.1" style="padding:1pt 4.3pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.2" style="padding:1pt 4.3pt;">0.3469</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.12.10.3" style="padding:1pt 4.3pt;">0.3905</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.4" style="padding:1pt 4.3pt;">0.4431</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.5" style="padding:1pt 4.3pt;">0.4195</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.6" style="padding:1pt 4.3pt;">0.4337</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.7" style="padding:1pt 4.3pt;">0.5230</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.12.10.8" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.12.10.8.1">0.5341</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.9" style="padding:1pt 4.3pt;">0.3975</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.12.10.10" style="padding:1pt 4.3pt;">0.4418</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.12.10.11" style="padding:1pt 4.3pt;">0.4398</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.12.10.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.12.10.12.1">0.5587</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.12.10.13" style="padding:1pt 4.3pt;">4.61%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.13.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.2.13.11.1" rowspan="5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.13.11.1.1">Toys</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.2.2.13.11.2" style="padding:1pt 4.3pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.3" style="padding:1pt 4.3pt;">0.3074</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.13.11.4" style="padding:1pt 4.3pt;">0.3105</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.5" style="padding:1pt 4.3pt;">0.3153</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.6" style="padding:1pt 4.3pt;">0.2935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.7" style="padding:1pt 4.3pt;">0.3371</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.8" style="padding:1pt 4.3pt;">0.3644</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.13.11.9" style="padding:1pt 4.3pt;">0.3530</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.10" style="padding:1pt 4.3pt;">0.3417</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.13.11.11" style="padding:1pt 4.3pt;">0.3605</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.13.11.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.13.11.12.1">0.3758</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.13.11.13" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.13.11.13.1">0.4137</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.2.2.13.11.14" style="padding:1pt 4.3pt;">10.08%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.14.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.14.12.1" style="padding:1pt 4.3pt;">HR@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.2" style="padding:1pt 4.3pt;">0.3809</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.14.12.3" style="padding:1pt 4.3pt;">0.3862</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.4" style="padding:1pt 4.3pt;">0.3910</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.5" style="padding:1pt 4.3pt;">0.3793</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.6" style="padding:1pt 4.3pt;">0.4176</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.7" style="padding:1pt 4.3pt;">0.4586</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.14.12.8" style="padding:1pt 4.3pt;">0.4489</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.9" style="padding:1pt 4.3pt;">0.4273</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.14.12.10" style="padding:1pt 4.3pt;">0.4501</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.14.12.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.14.12.11.1">0.4641</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.14.12.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.14.12.12.1">0.5180</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.14.12.13" style="padding:1pt 4.3pt;">11.61%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.15.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.15.13.1" style="padding:1pt 4.3pt;">MRR</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.2" style="padding:1pt 4.3pt;">0.2081</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.15.13.3" style="padding:1pt 4.3pt;">0.2152</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.4" style="padding:1pt 4.3pt;">0.2133</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.5" style="padding:1pt 4.3pt;">0.2017</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.6" style="padding:1pt 4.3pt;">0.2329</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.7" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.15.13.7.1">0.2803</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.15.13.8" style="padding:1pt 4.3pt;">0.2698</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.9" style="padding:1pt 4.3pt;">0.2414</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.15.13.10" style="padding:1pt 4.3pt;">0.2648</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.15.13.11" style="padding:1pt 4.3pt;">0.2417</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.15.13.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.15.13.12.1">0.2968</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.15.13.13" style="padding:1pt 4.3pt;">5.89%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.16.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.16.14.1" style="padding:1pt 4.3pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.2" style="padding:1pt 4.3pt;">0.2226</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.16.14.3" style="padding:1pt 4.3pt;">0.2288</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.4" style="padding:1pt 4.3pt;">0.2278</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.5" style="padding:1pt 4.3pt;">0.2174</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.6" style="padding:1pt 4.3pt;">0.2476</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.7" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.16.14.7.1">0.2786</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.16.14.8" style="padding:1pt 4.3pt;">0.2675</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.9" style="padding:1pt 4.3pt;">0.2512</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.16.14.10" style="padding:1pt 4.3pt;">0.2718</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.16.14.11" style="padding:1pt 4.3pt;">0.2609</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.16.14.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.16.14.12.1">0.3155</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.16.14.13" style="padding:1pt 4.3pt;">13.24%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.17.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.17.15.1" style="padding:1pt 4.3pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.2" style="padding:1pt 4.3pt;">0.2453</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.17.15.3" style="padding:1pt 4.3pt;">0.2529</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.4" style="padding:1pt 4.3pt;">0.2651</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.5" style="padding:1pt 4.3pt;">0.2397</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.6" style="padding:1pt 4.3pt;">0.2781</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.7" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.17.15.7.1">0.3089</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.17.15.8" style="padding:1pt 4.3pt;">0.2984</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.9" style="padding:1pt 4.3pt;">0.2789</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.17.15.10" style="padding:1pt 4.3pt;">0.3157</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.17.15.11" style="padding:1pt 4.3pt;">0.3073</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.17.15.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.17.15.12.1">0.3491</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.17.15.13" style="padding:1pt 4.3pt;">13.01%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.18.16">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S5.T2.2.2.18.16.1" rowspan="5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S5.T2.2.2.18.16.1.1">Beauty</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.2.2.18.16.2" style="padding:1pt 4.3pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.3" style="padding:1pt 4.3pt;">0.3089</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.18.16.4" style="padding:1pt 4.3pt;">0.3142</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.5" style="padding:1pt 4.3pt;">0.3145</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.6" style="padding:1pt 4.3pt;">0.3068</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.7" style="padding:1pt 4.3pt;">0.3246</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.8" style="padding:1pt 4.3pt;">0.3719</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.18.16.9" style="padding:1pt 4.3pt;">0.3669</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.10" style="padding:1pt 4.3pt;">0.3128</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.18.16.11" style="padding:1pt 4.3pt;">0.3970</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.18.16.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.18.16.12.1">0.4005</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.2.2.18.16.13" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.18.16.13.1">0.4339</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.2.2.18.16.14" style="padding:1pt 4.3pt;">8.34%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.19.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.19.17.1" style="padding:1pt 4.3pt;">HR@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.2" style="padding:1pt 4.3pt;">0.3968</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.19.17.3" style="padding:1pt 4.3pt;">0.4012</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.4" style="padding:1pt 4.3pt;">0.4119</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.5" style="padding:1pt 4.3pt;">0.3879</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.6" style="padding:1pt 4.3pt;">0.4343</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.7" style="padding:1pt 4.3pt;">0.4679</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.19.17.8" style="padding:1pt 4.3pt;">0.4641</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.9" style="padding:1pt 4.3pt;">0.4290</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.19.17.10" style="padding:1pt 4.3pt;">0.4843</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.19.17.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.19.17.11.1">0.5044</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.19.17.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.19.17.12.1">0.5305</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.19.17.13" style="padding:1pt 4.3pt;">5.17%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.20.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.20.18.1" style="padding:1pt 4.3pt;">MRR</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.2" style="padding:1pt 4.3pt;">0.2274</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.20.18.3" style="padding:1pt 4.3pt;">0.2329</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.4" style="padding:1pt 4.3pt;">0.2388</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.5" style="padding:1pt 4.3pt;">0.2388</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.6" style="padding:1pt 4.3pt;">0.2556</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.7" style="padding:1pt 4.3pt;">0.2868</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.20.18.8" style="padding:1pt 4.3pt;">0.2837</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.9" style="padding:1pt 4.3pt;">0.2352</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.20.18.10" style="padding:1pt 4.3pt;">0.2695</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.20.18.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.20.18.11.1">0.2940</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.20.18.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.20.18.12.1">0.3148</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.20.18.13" style="padding:1pt 4.3pt;">7.07%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.21.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.2.2.21.19.1" style="padding:1pt 4.3pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.2" style="padding:1pt 4.3pt;">0.2480</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.21.19.3" style="padding:1pt 4.3pt;">0.2534</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.4" style="padding:1pt 4.3pt;">0.2548</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.5" style="padding:1pt 4.3pt;">0.2394</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.6" style="padding:1pt 4.3pt;">0.2479</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.7" style="padding:1pt 4.3pt;">0.2854</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.21.19.8" style="padding:1pt 4.3pt;">0.2815</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.9" style="padding:1pt 4.3pt;">0.2437</td>
<td class="ltx_td ltx_align_center" id="S5.T2.2.2.21.19.10" style="padding:1pt 4.3pt;">0.2871</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.21.19.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.21.19.11.1">0.3073</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.2.2.21.19.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.21.19.12.1">0.3347</span></td>
<td class="ltx_td ltx_align_right" id="S5.T2.2.2.21.19.13" style="padding:1pt 4.3pt;">8.92%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.2.2.22.20">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T2.2.2.22.20.1" style="padding:1pt 4.3pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.2" style="padding:1pt 4.3pt;">0.2534</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.2.2.22.20.3" style="padding:1pt 4.3pt;">0.2714</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.4" style="padding:1pt 4.3pt;">0.2681</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.5" style="padding:1pt 4.3pt;">0.2499</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.6" style="padding:1pt 4.3pt;">0.2700</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.7" style="padding:1pt 4.3pt;">0.3063</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.2.2.22.20.8" style="padding:1pt 4.3pt;">0.3058</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.9" style="padding:1pt 4.3pt;">0.2686</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.2.2.22.20.10" style="padding:1pt 4.3pt;">0.3003</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.2.2.22.20.11" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.2.2.22.20.11.1">0.3253</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.2.2.22.20.12" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.2.2.22.20.12.1">0.3660</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.2.2.22.20.13" style="padding:1pt 4.3pt;">12.51%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.T2" title="Table 2 ‣ 5.2 Performance Comparison (RQ1) ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance comparisons results between several baseline methods and MIDCL. Based on the table, the following conclusions can be summarized. First, BPR-MF and FPMC perform poorly compared to other deep learning methods, and contrastive learning improves model performance in some scenarios. For example, in <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.1">Beauty</span>, CoSeRec performs better than other methods except MIDCL, but the Transformer-based methods such as SASRec and BERT4Rec perform better in <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.2">Gowalla</span>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.2">Moreover, The performance of S<sup class="ltx_sup" id="S5.SS2.p2.2.1">3</sup>-Rec<math alttext="{{}_{\text{MIP}}}" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1a" xref="S5.SS2.p2.2.m2.1.1.cmml"></mi><mtext id="S5.SS2.p2.2.m2.1.1.1" xref="S5.SS2.p2.2.m2.1.1.1a.cmml">MIP</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><ci id="S5.SS2.p2.2.m2.1.1.1a.cmml" xref="S5.SS2.p2.2.m2.1.1.1"><mtext id="S5.SS2.p2.2.m2.1.1.1.cmml" mathsize="70%" xref="S5.SS2.p2.2.m2.1.1.1">MIP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">{{}_{\text{MIP}}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">start_FLOATSUBSCRIPT MIP end_FLOATSUBSCRIPT</annotation></semantics></math> is the worst among the 3 models based on contrast learning, mainly because only the former MIP self-supervised task was used for training in the experiments, whereas both CL4SRec and CoSeRec augmented the user’s sequences and were able to achieve better results in the process of contrastive learning; CoSeRec was supplemented with two additional augmentation factors in comparison to CL4SRec, and thus performs better under most of the datasets.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Finally, MIDCL outperforms other methods on all four real datasets because it combines intention disentanglement and contrastive learning on top of the Transformer encoder, enabling it to better understand users’ interactive intentions. On the HR@10 metric, MIDCL leads the next best performing model by 2.87%, 3.02%, 5.39%, and 2.61% in the four datasets, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Hyper-parameter Sensitivity Analysis (RQ2)</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.2">In this section, we verify the hyper-parameter sensitivity of MIDCL with respect to the weighting factors <math alttext="\alpha\&amp;\beta" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS3.p1.1.m1.1.1.1.cmml">&amp;</mo><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><and id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></and><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝛼</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\alpha\&amp;\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_α &amp; italic_β</annotation></semantics></math> and the number of intentions <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_k</annotation></semantics></math> in the four datasets mentioned above, respectively.</p>
</div>
<figure class="ltx_figure" id="S5.F4.sf1">
</figure>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.5">Fig.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig3</span> depicts the effect of the Hyper-Parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_α</annotation></semantics></math> on the performance, where fixing <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><mi id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><ci id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_β</annotation></semantics></math> as 0.3 and <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.1"><semantics id="S5.SS3.p2.3.m3.1a"><mi id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><ci id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">italic_k</annotation></semantics></math> as 8. we can see that each dataset essentially reaches its best performance at <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S5.SS3.p2.4.m4.1"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">α</mi><mo id="S5.SS3.p2.4.m4.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><eq id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1"></eq><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">𝛼</ci><cn id="S5.SS3.p2.4.m4.1.1.3.cmml" type="float" xref="S5.SS3.p2.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.4.m4.1d">italic_α = 0.1</annotation></semantics></math>. Because the loss function of VAE consists of the KLD of the latent spatial prior distribution and the ternary loss, if the weighting factor is increased, the decline of the main loss, i.e. the cross-entropy loss function, is gradually affected. Especially when <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS3.p2.5.m5.1"><semantics id="S5.SS3.p2.5.m5.1a"><mi id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><ci id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.5.m5.1d">italic_α</annotation></semantics></math> reaches 0.5, the metrics of each dataset basically fall off a cliff.</p>
</div>
<figure class="ltx_figure" id="S5.F4.sf2">
</figure>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.7">Fig.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig4</span> shows the effect of the Hyper-Parameter <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mi id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><ci id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">italic_β</annotation></semantics></math> on the performance, where fixing <math alttext="\alpha" class="ltx_Math" display="inline" id="S5.SS3.p3.2.m2.1"><semantics id="S5.SS3.p3.2.m2.1a"><mi id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><ci id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.2.m2.1d">italic_α</annotation></semantics></math> as 0.1 and <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS3.p3.3.m3.1"><semantics id="S5.SS3.p3.3.m3.1a"><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.3.m3.1d">italic_k</annotation></semantics></math> as 8. As shown, the best-performing phases of each dataset are basically in the range of <math alttext="\left[0.2,0.4\right]" class="ltx_Math" display="inline" id="S5.SS3.p3.4.m4.2"><semantics id="S5.SS3.p3.4.m4.2a"><mrow id="S5.SS3.p3.4.m4.2.3.2" xref="S5.SS3.p3.4.m4.2.3.1.cmml"><mo id="S5.SS3.p3.4.m4.2.3.2.1" xref="S5.SS3.p3.4.m4.2.3.1.cmml">[</mo><mn id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml">0.2</mn><mo id="S5.SS3.p3.4.m4.2.3.2.2" xref="S5.SS3.p3.4.m4.2.3.1.cmml">,</mo><mn id="S5.SS3.p3.4.m4.2.2" xref="S5.SS3.p3.4.m4.2.2.cmml">0.4</mn><mo id="S5.SS3.p3.4.m4.2.3.2.3" xref="S5.SS3.p3.4.m4.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.2b"><interval closure="closed" id="S5.SS3.p3.4.m4.2.3.1.cmml" xref="S5.SS3.p3.4.m4.2.3.2"><cn id="S5.SS3.p3.4.m4.1.1.cmml" type="float" xref="S5.SS3.p3.4.m4.1.1">0.2</cn><cn id="S5.SS3.p3.4.m4.2.2.cmml" type="float" xref="S5.SS3.p3.4.m4.2.2">0.4</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.2c">\left[0.2,0.4\right]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.4.m4.2d">[ 0.2 , 0.4 ]</annotation></semantics></math> for <math alttext="\beta" class="ltx_Math" display="inline" id="S5.SS3.p3.5.m5.1"><semantics id="S5.SS3.p3.5.m5.1a"><mi id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><ci id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.5.m5.1d">italic_β</annotation></semantics></math>, with <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.1">Gowalla</span> having the best performance at <math alttext="\beta=0.4" class="ltx_Math" display="inline" id="S5.SS3.p3.6.m6.1"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml"><mi id="S5.SS3.p3.6.m6.1.1.2" xref="S5.SS3.p3.6.m6.1.1.2.cmml">β</mi><mo id="S5.SS3.p3.6.m6.1.1.1" xref="S5.SS3.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.6.m6.1.1.3" xref="S5.SS3.p3.6.m6.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1"><eq id="S5.SS3.p3.6.m6.1.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1.1"></eq><ci id="S5.SS3.p3.6.m6.1.1.2.cmml" xref="S5.SS3.p3.6.m6.1.1.2">𝛽</ci><cn id="S5.SS3.p3.6.m6.1.1.3.cmml" type="float" xref="S5.SS3.p3.6.m6.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">\beta=0.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.6.m6.1d">italic_β = 0.4</annotation></semantics></math>, and <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.2">Toys</span> &amp; <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.3">Beauty</span> having the best at <math alttext="\beta=0.2" class="ltx_Math" display="inline" id="S5.SS3.p3.7.m7.1"><semantics id="S5.SS3.p3.7.m7.1a"><mrow id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml"><mi id="S5.SS3.p3.7.m7.1.1.2" xref="S5.SS3.p3.7.m7.1.1.2.cmml">β</mi><mo id="S5.SS3.p3.7.m7.1.1.1" xref="S5.SS3.p3.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.7.m7.1.1.3" xref="S5.SS3.p3.7.m7.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><apply id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1"><eq id="S5.SS3.p3.7.m7.1.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1.1"></eq><ci id="S5.SS3.p3.7.m7.1.1.2.cmml" xref="S5.SS3.p3.7.m7.1.1.2">𝛽</ci><cn id="S5.SS3.p3.7.m7.1.1.3.cmml" type="float" xref="S5.SS3.p3.7.m7.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">\beta=0.2</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.7.m7.1d">italic_β = 0.2</annotation></semantics></math>. In particular, the metrics and trends in <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.4">Toys</span> and <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.5">Beauty</span> are close to each other because they are both part of the same Amazon dataset, but <span class="ltx_text ltx_font_italic" id="S5.SS3.p3.7.6">Gowalla</span> is a different type of large dataset.</p>
</div>
<figure class="ltx_figure" id="S5.F4.sf3">
</figure>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.4">Fig.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig5</span> describes the influence of number of intentions <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS3.p4.1.m1.1"><semantics id="S5.SS3.p4.1.m1.1a"><mi id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><ci id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.1.m1.1d">italic_k</annotation></semantics></math>. We can find that none of the datasets are sensitive to <math alttext="{k}" class="ltx_Math" display="inline" id="S5.SS3.p4.2.m2.1"><semantics id="S5.SS3.p4.2.m2.1a"><mi id="S5.SS3.p4.2.m2.1.1" xref="S5.SS3.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.2.m2.1b"><ci id="S5.SS3.p4.2.m2.1.1.cmml" xref="S5.SS3.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.2.m2.1c">{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.2.m2.1d">italic_k</annotation></semantics></math>, with <span class="ltx_text ltx_font_italic" id="S5.SS3.p4.4.1">Toys</span> showing a slight decrease in performance at <math alttext="k=32" class="ltx_Math" display="inline" id="S5.SS3.p4.3.m3.1"><semantics id="S5.SS3.p4.3.m3.1a"><mrow id="S5.SS3.p4.3.m3.1.1" xref="S5.SS3.p4.3.m3.1.1.cmml"><mi id="S5.SS3.p4.3.m3.1.1.2" xref="S5.SS3.p4.3.m3.1.1.2.cmml">k</mi><mo id="S5.SS3.p4.3.m3.1.1.1" xref="S5.SS3.p4.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.3.m3.1.1.3" xref="S5.SS3.p4.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.3.m3.1b"><apply id="S5.SS3.p4.3.m3.1.1.cmml" xref="S5.SS3.p4.3.m3.1.1"><eq id="S5.SS3.p4.3.m3.1.1.1.cmml" xref="S5.SS3.p4.3.m3.1.1.1"></eq><ci id="S5.SS3.p4.3.m3.1.1.2.cmml" xref="S5.SS3.p4.3.m3.1.1.2">𝑘</ci><cn id="S5.SS3.p4.3.m3.1.1.3.cmml" type="integer" xref="S5.SS3.p4.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.3.m3.1c">k=32</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.3.m3.1d">italic_k = 32</annotation></semantics></math>, and <span class="ltx_text ltx_font_italic" id="S5.SS3.p4.4.2">Gowalla</span>, on the contrary, showing the best performance at this point. If the change of this hyper-parameter does not bring a large change to the model during the training process, the speed of convergence as well as the resource consumption will serve as a valuable metric for reference, so the choice of <math alttext="k=8" class="ltx_Math" display="inline" id="S5.SS3.p4.4.m4.1"><semantics id="S5.SS3.p4.4.m4.1a"><mrow id="S5.SS3.p4.4.m4.1.1" xref="S5.SS3.p4.4.m4.1.1.cmml"><mi id="S5.SS3.p4.4.m4.1.1.2" xref="S5.SS3.p4.4.m4.1.1.2.cmml">k</mi><mo id="S5.SS3.p4.4.m4.1.1.1" xref="S5.SS3.p4.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p4.4.m4.1.1.3" xref="S5.SS3.p4.4.m4.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.4.m4.1b"><apply id="S5.SS3.p4.4.m4.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1"><eq id="S5.SS3.p4.4.m4.1.1.1.cmml" xref="S5.SS3.p4.4.m4.1.1.1"></eq><ci id="S5.SS3.p4.4.m4.1.1.2.cmml" xref="S5.SS3.p4.4.m4.1.1.2">𝑘</ci><cn id="S5.SS3.p4.4.m4.1.1.3.cmml" type="integer" xref="S5.SS3.p4.4.m4.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.4.m4.1c">k=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p4.4.m4.1d">italic_k = 8</annotation></semantics></math> will not bring an impact on the performance of the model as well as significantly reduce the time of training and loss convergence.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Study (RQ3)</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.3">To verify the validity of each module of MIDCL, the intention disentanglement module of VAE, the contrastive learning module, and the original encoder module only for sequential recommendation are removed from the model, and the experiments are conducted under the conditions of <math alttext="k=8" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">k</mi><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><eq id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></eq><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝑘</ci><cn id="S5.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS4.p1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">k=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_k = 8</annotation></semantics></math>, <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><mrow id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS4.p1.2.m2.1.1.1" xref="S5.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><eq id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1.1"></eq><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">𝛼</ci><cn id="S5.SS4.p1.2.m2.1.1.3.cmml" type="float" xref="S5.SS4.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_α = 0.1</annotation></semantics></math> and <math alttext="\beta=0.3" class="ltx_Math" display="inline" id="S5.SS4.p1.3.m3.1"><semantics id="S5.SS4.p1.3.m3.1a"><mrow id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml"><mi id="S5.SS4.p1.3.m3.1.1.2" xref="S5.SS4.p1.3.m3.1.1.2.cmml">β</mi><mo id="S5.SS4.p1.3.m3.1.1.1" xref="S5.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.3.m3.1.1.3" xref="S5.SS4.p1.3.m3.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><apply id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1"><eq id="S5.SS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1.1"></eq><ci id="S5.SS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.p1.3.m3.1.1.2">𝛽</ci><cn id="S5.SS4.p1.3.m3.1.1.3.cmml" type="float" xref="S5.SS4.p1.3.m3.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">\beta=0.3</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m3.1d">italic_β = 0.3</annotation></semantics></math>, respectively.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.4.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.5.2" style="font-size:90%;">Ablation study of MIDCL on <span class="ltx_text ltx_font_italic" id="S5.T3.5.2.1">Yelp</span> and <span class="ltx_text ltx_font_italic" id="S5.T3.5.2.2">Beauty</span> (H means HR and N means NDCG).</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.6.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.6.1.1.1" style="padding:1pt 2.8pt;">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.6.1.1.2" style="padding:1pt 2.8pt;">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.3" style="padding:1pt 2.8pt;">H@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.4" style="padding:1pt 2.8pt;">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.5" style="padding:1pt 2.8pt;">N@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.1.1.6" style="padding:1pt 2.8pt;">N@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.6.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.6.2.1.1" rowspan="4" style="padding:1pt 2.8pt;"><span class="ltx_text" id="S5.T3.6.2.1.1.1">Yelp</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.6.2.1.2" style="padding:1pt 2.8pt;">MIDCL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.2.1.3" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.2.1.3.1">0.6375</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.2.1.4" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.2.1.4.1">0.7970</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.2.1.5" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.2.1.5.1">0.4669</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.2.1.6" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.2.1.6.1">0.5187</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.3.2.1" style="padding:1pt 2.8pt;">w/o MID</th>
<td class="ltx_td ltx_align_center" id="S5.T3.6.3.2.2" style="padding:1pt 2.8pt;">0.6186</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.3.2.3" style="padding:1pt 2.8pt;">0.7691</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.3.2.4" style="padding:1pt 2.8pt;">0.4584</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.3.2.5" style="padding:1pt 2.8pt;">0.5073</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.4.3.1" style="padding:1pt 2.8pt;">w/o CL</th>
<td class="ltx_td ltx_align_center" id="S5.T3.6.4.3.2" style="padding:1pt 2.8pt;">0.6164</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.4.3.3" style="padding:1pt 2.8pt;">0.7736</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.4.3.4" style="padding:1pt 2.8pt;">0.4441</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.4.3.5" style="padding:1pt 2.8pt;">0.4951</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.5.4.1" style="padding:1pt 2.8pt;">only SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.6.5.4.2" style="padding:1pt 2.8pt;">0.5914</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.5.4.3" style="padding:1pt 2.8pt;">0.7566</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.5.4.4" style="padding:1pt 2.8pt;">0.4288</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.5.4.5" style="padding:1pt 2.8pt;">0.4822</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T3.6.6.5.1" rowspan="4" style="padding:1pt 2.8pt;"><span class="ltx_text" id="S5.T3.6.6.5.1.1">Beauty</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.6.6.5.2" style="padding:1pt 2.8pt;">MIDCL</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.6.5.3" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.6.5.3.1">0.4339</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.6.5.4" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.6.5.4.1">0.5305</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.6.5.5" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.6.5.5.1">0.3347</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.6.6.5.6" style="padding:1pt 2.8pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.6.6.5.6.1">0.3660</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.7.6.1" style="padding:1pt 2.8pt;">w/o MID</th>
<td class="ltx_td ltx_align_center" id="S5.T3.6.7.6.2" style="padding:1pt 2.8pt;">0.4069</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.7.6.3" style="padding:1pt 2.8pt;">0.5040</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.7.6.4" style="padding:1pt 2.8pt;">0.3129</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.7.6.5" style="padding:1pt 2.8pt;">0.3442</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.6.8.7.1" style="padding:1pt 2.8pt;">w/o CL</th>
<td class="ltx_td ltx_align_center" id="S5.T3.6.8.7.2" style="padding:1pt 2.8pt;">0.3905</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.8.7.3" style="padding:1pt 2.8pt;">0.4804</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.8.7.4" style="padding:1pt 2.8pt;">0.3098</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.8.7.5" style="padding:1pt 2.8pt;">0.3325</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T3.6.9.8.1" style="padding:1pt 2.8pt;">only SR</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.6.9.8.2" style="padding:1pt 2.8pt;">0.3864</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.6.9.8.3" style="padding:1pt 2.8pt;">0.4764</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.6.9.8.4" style="padding:1pt 2.8pt;">0.3022</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.6.9.8.5" style="padding:1pt 2.8pt;">0.3312</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2404.18214v2#S5.T3" title="Table 3 ‣ 5.4 Ablation Study (RQ3) ‣ 5 Experiments ‣ Contrastive Learning Method for Sequential Recommendation based on Multi-Intention Disentanglement"><span class="ltx_text ltx_ref_tag">3</span></a> records the results of each ablation model on the evaluation metrics. As shown above, both the intention disentanglement and contrastive learning modules contribute to MIDCL, and both modules are more effective than simple embedding encoder module for sequential recommendation only, with the importance of contrastive learning being more pronounced.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Intention Visualization (RQ4)</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">We design the visualization process of the intention and user embedding to verify our method and figure out how the disentangled intention changes during the training process. In order to present the results on a two-dimensional plane, we choose t-SNE to reduce feature dimensionality and combine it with K-Means clustering to observe the distance between intentions and user’s features.</p>
</div>
<figure class="ltx_figure" id="S5.F13.sf1">
</figure>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.2">Fig.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig6</span> illustrates the different stages of a certain training process in which the sequence and intention features of users are clustered after dimensionality reduction to the two-dimensional plane, where the large dark blue dots indicate the disentangled <math alttext="k" class="ltx_Math" display="inline" id="S5.SS5.p2.1.m1.1"><semantics id="S5.SS5.p2.1.m1.1a"><mi id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><ci id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.1.m1.1d">italic_k</annotation></semantics></math>-intents, and this time <math alttext="k=8" class="ltx_Math" display="inline" id="S5.SS5.p2.2.m2.1"><semantics id="S5.SS5.p2.2.m2.1a"><mrow id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml"><mi id="S5.SS5.p2.2.m2.1.1.2" xref="S5.SS5.p2.2.m2.1.1.2.cmml">k</mi><mo id="S5.SS5.p2.2.m2.1.1.1" xref="S5.SS5.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.2.m2.1.1.3" xref="S5.SS5.p2.2.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><apply id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1"><eq id="S5.SS5.p2.2.m2.1.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1.1"></eq><ci id="S5.SS5.p2.2.m2.1.1.2.cmml" xref="S5.SS5.p2.2.m2.1.1.2">𝑘</ci><cn id="S5.SS5.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.SS5.p2.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">k=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.2.m2.1d">italic_k = 8</annotation></semantics></math> is used as an example. The remaining small dots of eight different colors indicate the sequence features of the users in one batch-size, the same color represents the same clusters, and the features of the users with the same clusters means they have a higher degree of similarity.</p>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">As shown in the figure, (a) represents the beginning of the training of all the user’s sequence features present a number of clusters of different sizes and randomly distributed; subsequently, from (b) to (e), the user features began to gradually spread; as the gradient of the loss decreases, each user began to draw closer to its similar intentions from (f) to (h); at the end in (i), when the iteration tends to stabilize, all users basically have found the closest to their own intention representation, and constitute the <math alttext="k" class="ltx_Math" display="inline" id="S5.SS5.p3.1.m1.1"><semantics id="S5.SS5.p3.1.m1.1a"><mi id="S5.SS5.p3.1.m1.1.1" xref="S5.SS5.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.1.m1.1b"><ci id="S5.SS5.p3.1.m1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p3.1.m1.1d">italic_k</annotation></semantics></math> clusters. With given data, it is reasonable to assume that users within the same cluster have the most similar intention, and they are more likely to produce similar even same interaction behaviors in the next moment.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose a contrastive learning method MIDCL based on multi-intention disentanglement for sequential recommendation, which enables the prediction of the next item in a sequence by mining user’s intention. First, the behavioral sequences are embedded by Transformer encoder; second, multi-intentions of users are disentangled based on VAE in the potential space with a parameter-sharing Transformer encoder, whose dimensions are used as the number of user’s latent intentions; finally, we propose two contrastive learning paradigms to optimize the feature representations of the intentions and sequences, respectively, to weaken the negative impact of irrelevant intentions. The experimental results on four real-world datasets show that MIDCL achieves the optimal results in all baseline methods and validates the contribution of the intention disentanglement and contrastive learning modules. To explore changes in intention with training, we also conduct the visualization of the intentions as a way to demonstrate the feasibility and interpretability of intention disentanglement module.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">For future work, we will focus on evaluating the incremental impact of each user action on intentionality, as well as the disentanglement and analysis of multiple intentions during each interaction, and consider the contextual information from the interaction scenario and the social network, etc., which will yield a more comprehensive and personalized representation of the user’s interactive intention.</p>
</div>
<div class="ltx_para" id="S6.p3">
<span class="ltx_ERROR undefined" id="S6.p3.1">\bmhead</span>
<p class="ltx_p" id="S6.p3.2">Acknowledgements</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">This paper is supported by the National Key Research and Development Program of China (314) and the Independent Project of National Key Laboratory (2024-SKL-005).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"> Page L, Brin S, Motwani R, et al. 1998. The pagerank citation ranking: Bring order to the web. Technical report, Stanford University.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"> Rendle S, Freudenthaler C, Schmidt-Thieme L. 2010. Factorizing personalized markov chains for next-basket recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">WWW</span>. 811-820.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"> He R, McAuley J. 2016. Fusing similarity models with markov chains for sparse sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">ICDM</span>. 191-200.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"> Hidasi B, Karatzoglou A, Baltrunas L, et al. 2016. Session-based recommendations with recurrent neural networks[J]. In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">ICLR</span>. 1–10.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"> Tang J, Wang K. 2018. Personalized top-n sequential recommendation via convolutional sequence embedding. In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">WSDM</span>. 565-573.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"> Kang W C, McAuley J. 2018. Self-attentive sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">ICDM</span>. 197-206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"> Vaswani A, Shazeer N, Parmar N, et al. 2017. Attention is all you need. In <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">NIPS</span>. 30: 5998-6008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"> Li J, Wang Y, McAuley J. 2020. Time interval aware self-attention for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">WSDM</span>. 322-330.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"> Sun F, Liu J, Wu J, et al. 2019. BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">CIKM</span>. 1441-1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"> Zhou Z, Wang T, Hou L, et al. 2022. Decoupled Hyperbolic Graph Attention Network for Modeling Substitutable and Complementary Item Relationships. In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">CIKM</span>. 2763-2772.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"> Luo S, Zhang X, Xiao Y, et al. 2022. HySAGE: A hybrid static and adaptive graph embedding network for context-drifting recommendations. In <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">CIKM</span>. 1389-1398.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"> Chang J, Gao C, Zheng Y, et al. 2021. Sequential recommendation with graph neural networks. In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">SIGIR</span>. 378-387.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"> Zhao S, Wei W, Zou D, et al. 2022. Multi-view intent disentangle graph networks for bundle recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">AAAI</span>. 36(4): 4379-4387.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"> Zhao R, Ju S, Peng J, et al. 2022. Two-Level Graph Path Reasoning for Conversational Recommendation with User Realistic Preference. In <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">CIKM</span>. 2701-2710.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"> Sun Y, Yuan N J, Xie X, et al. 2017. Collaborative intent prediction with real-time contextual data. ACM Transactions on Information Systems (TOIS). 35(4): 1-33.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"> Tanjim M M, Su C, Benjamin E, et al. 2020. Attentive sequential models of latent intent for next item recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">WWW</span>. 2528-2534.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"> Song W, Xiao Z, Wang Y, et al. 2019. Session-based social recommendation via dynamic graph attention networks. In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">WSDM</span>. 555-563.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"> Fan Z, Liu Z, Zhang J, et al. 2021. Continuous-time sequential recommendation with temporal graph collaborative transformer. In <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">CIKM</span>. 433-442.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"> Chen L, Yang N, Yu P S. 2022. Time lag aware sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">CIKM</span>. 212-221.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"> Ma Y, Liu Z, Zhuang C, et al. 2022. Non-stationary Time-aware Kernelized Attention for Temporal Event Prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">SIGKDD</span>. 1224-1232.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"> Kingma D P, Welling M. 2014. Auto-Encoding Variational Bayes. stat. 1050: 1.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"> Ma J, Zhou C, Cui P, et al. 2019. Learning disentangled representations for recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">NIPS</span>. 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"> Tian Y, Chang J, Niu Y, et al. 2022. When multi-level meets multi-interest: A multi-grained neural model for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">SIGIR</span>. 1632-1641.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"> Wang Y, Zhang H, Liu Z, et al. 2022. Contrastvae: Contrastive variational autoencoder for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">CIKM</span>. 2056-2066.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"> He W, Sun G, Lu J, et al. 2023. Candidate-aware Graph Contrastive Learning for Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">SIGIR</span>. 1670-1679.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"> Ma J, Zhou C, Yang H, et al. 2020. Disentangled self-supervision in sequential recommenders. In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">SIGKDD</span>. 483-491.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"> Li X, Sun A, Zhao M, et al. 2023. Multi-Intention Oriented Contrastive Learning for Sequential Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">WSDM</span>. 411-419.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"> Chen Y, Liu Z, Li J, et al. 2022. Intent contrastive learning for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">WWW</span>. 2172-2182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"> Qin X, Yuan H, Zhao P, et al. 2024. Intent Contrastive Learning with Cross Subsequences for Sequential Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">WSDM</span>. 548-556.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"> Ren X, Xia L, Zhao J, et al. 2023. Disentangled Contrastive Collaborative Filtering. arXiv preprint arXiv:2305.02759.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"> Zhou K, Wang H, Zhao W X, et al. 2020. S3-rec: Self-supervised learning for sequential recommendation with mutual information maximization. In <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">CIKM</span>. 1893-1902.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"> Xie X, Sun F, Liu Z, et al. 2022. Contrastive learning for sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">ICDE</span>. 1259-1273.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"> Liu Z, Chen Y, Li J, et al. 2021. Contrastive self-supervised sequential recommendation with robust augmentation. arXiv preprint arXiv:2108.06479.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"> Girshick R, Donahue J, Darrell T, et al. 2014. Rich feature hierarchies for accurate object detection and semantic segmentation. In <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">CVPR</span>. 580-587.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"> He K, Fan H, Wu Y, et al. 2020. Momentum contrast for unsupervised visual representation learning. In <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">CVPR</span>. 9729-9738.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"> Oord A, Li Y, Vinyals O. 2018. Representation learning with contrastive predictive coding. arXiv preprint arXiv:1807.03748.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"> Poole B, Ozair S, Van Den Oord A, et al. 2019. On variational bounds of mutual information. In <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">ICML</span>. 5171-5180.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"> Hjelm R D, Fedorov A, Lavoie-Marchildon S, et al. 2018. Learning deep representations by mutual information estimation and maximization. arXiv preprint arXiv:1808.06670.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"> Bachman P, Hjelm R D, Buchwalter W. 2019. Learning Representations by Maximizing Mutual Information Across Views. In <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">NIPS</span>. 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"> Shaw P, Uszkoreit J, Vaswani A. 2018. Self-attention with relative position representations. arXiv preprint arXiv:1803.02155.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"> Su J, Ahmed M, Lu Y, et al. 2024. Roformer: Enhanced transformer with rotary position embedding. Neurocomputing. 568: 127063.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"> Touvron H, Lavril T, Izacard G, et al. 2023. Llama: Open and efficient foundation language models. arXiv preprint arXiv:2302.13971.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"> He K, Zhang X, Ren S, et al. 2016. Deep residual learning for image recognition. In <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">CVPR</span>. 770-778.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"> Schroff F, Kalenichenko D, Philbin J. 2015. Facenet: A unified embedding for face recognition and clustering.In <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">CVPR</span>. 815-823.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"> Rendle S, Freudenthaler C, Gantner Z, et al. 2009. BPR: Bayesian personalized ranking from implicit feedback. In <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">UAI</span>. 452-461.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"> Hidasi B, Karatzoglou A. 2018. Recurrent neural networks with top-k gains for session-based recommendations. In <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">CIKM</span>. 843-852.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue May 14 18:20:37 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
