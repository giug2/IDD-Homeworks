<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.15617] VeryFL: A Verify Federated Learning Framework Embedded with Blockchain</title><meta property="og:description" content="Blockchain-empowered federated learning (FL) has provoked extensive research recently. Various blockchain-based federated learning algorithm, architecture and mechanism have been designed to solve issues like single po…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VeryFL: A Verify Federated Learning Framework Embedded with Blockchain">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="VeryFL: A Verify Federated Learning Framework Embedded with Blockchain">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.15617">

<!--Generated on Tue Feb 27 17:14:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning,  Model Ownership,  Blockchain,  Framework
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">VeryFL: A Verify Federated Learning Framework Embedded with Blockchain</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yihao Li,
Yanyi Lai,
Chuan Chen*, 
and Zibin Zheng, 
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Blockchain-empowered federated learning (FL) has provoked extensive research recently. Various blockchain-based federated learning algorithm, architecture and mechanism have been designed to solve issues like single point failure and data falsification brought by centralized FL paradigm. Moreover, it is easier to allocate incentives to nodes with the help of the blockchain. Various centralized federated learning frameworks like FedML, have emerged in the community to help boost the research on FL. However, decentralized blockchain-based federated learning framework is still missing, which cause inconvenience for researcher to reproduce or verify the algorithm performance based on blockchain. Inspired by the above issues, we have designed and developed a blockchain-based federated learning framework by embedding Ethereum network. This report will present the overall structure of this framework, which proposes a code practice paradigm for the combination of FL with blockchain and, at the same time, compatible with normal FL training task. In addition to implement some blockchain federated learning algorithms on smart contract to help execute a FL training, we also propose a model ownership authentication architecture based on blockchain and model watermarking to protect the intellectual property rights of models. These mechanism on blockchain shows an underlying support of blockchain for federated learning to provide a verifiable training, aggregation and incentive distribution procedure and thus we named this framework VeryFL (A <span id="id1.id1.1" class="ltx_text ltx_framed ltx_framed_underline">Ver</span>if<span id="id1.id1.2" class="ltx_text ltx_framed ltx_framed_underline">y</span> <span id="id1.id1.3" class="ltx_text ltx_framed ltx_framed_underline">Federated Learninig</span> Framework Embedded with Blockchain) . The source code is avaliable on <a target="_blank" href="https://github.com/GTMLLab/VeryFL" title="" class="ltx_ref ltx_href">https://github.com/GTMLLab/VeryFL</a></p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated Learning, Model Ownership, Blockchain, Framework

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning is a distributed machine learning paradigm that allows all participants to collaboratively train machine learning models from multiple data sources without disclosing private data. Federated learning offers a solution to challenges associated with data silos and privacy preservation, presenting a wide spectrum of potential applications. In recent years, federated learning has been a popular research field in machine learning, with numerous significant works focusing on heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, communication efficiency <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, privacy protection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and other difficult problems. However, federated learning under centralized server still face the risk of single point failure, data falsification and lack of incentives. Moreover, federated learning model which is trained by multiple parties is exposed to risks such as model illegal copying, misuse and free-riding<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and thus need a mechanism to protect intellectual property rights. To face both of the risks brought by centralized paradigm and model rights, blockchain has become a novel solutions for FL to solve these challenges and build a more robust and secure execution environment.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison with existing federated learning open-source frameworks</figcaption>
<table id="S1.T1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S1.T1.1.1.1" class="ltx_tr">
<th id="S1.T1.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;"></th>
<th id="S1.T1.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.2.1.1" class="ltx_p"><span id="S1.T1.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">FL Benchmark</span></span>
</span>
</th>
<th id="S1.T1.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.3.1.1" class="ltx_p"><span id="S1.T1.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">Blockchain Embedded</span></span>
</span>
</th>
<th id="S1.T1.1.1.1.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.4.1.1" class="ltx_p"><span id="S1.T1.1.1.1.4.1.1.1" class="ltx_text ltx_font_bold">FL-side Architecture</span></span>
</span>
</th>
<th id="S1.T1.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.5.1.1" class="ltx_p"><span id="S1.T1.1.1.1.5.1.1.1" class="ltx_text ltx_font_bold">Model Authentication</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S1.T1.1.2.1" class="ltx_tr">
<td id="S1.T1.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.1.1.1" class="ltx_p">EasyFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.2.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.2.1.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.3.1.1" class="ltx_p"><span id="S1.T1.1.2.1.3.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.2.1.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.2.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.4.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.2.1.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle ltx_border_t" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.2.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.5.1.1" class="ltx_p"><span id="S1.T1.1.2.1.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.3.2" class="ltx_tr">
<td id="S1.T1.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_middle" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.1.1.1" class="ltx_p">FedML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.3.2.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.2.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.3.2.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.3.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.3.1.1" class="ltx_p"><span id="S1.T1.1.3.2.3.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.3.2.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.3.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.4.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.3.2.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.3.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.5.1.1" class="ltx_p"><span id="S1.T1.1.3.2.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.4.3" class="ltx_tr">
<td id="S1.T1.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_middle" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.4.3.1.1.1" class="ltx_p">GFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.4.3.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.4.3.2.1.1" class="ltx_p"><span id="S1.T1.1.4.3.2.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.4.3.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.4.3.3.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.4.3.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.4.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.4.3.4.1.1" class="ltx_p"><span id="S1.T1.1.4.3.4.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.4.3.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.4.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.4.3.5.1.1" class="ltx_p"><span id="S1.T1.1.4.3.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.5.4" class="ltx_tr">
<td id="S1.T1.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_middle" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.5.4.1.1.1" class="ltx_p">FedCoin <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.5.4.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.5.4.2.1.1" class="ltx_p"><span id="S1.T1.1.5.4.2.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.5.4.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.5.4.3.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.5.4.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.5.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.5.4.4.1.1" class="ltx_p"><span id="S1.T1.1.5.4.4.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.5.4.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.5.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.5.4.5.1.1" class="ltx_p"><span id="S1.T1.1.5.4.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.6.5" class="ltx_tr">
<td id="S1.T1.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_middle" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.6.5.1.1.1" class="ltx_p">blocklearning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.6.5.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.6.5.2.1.1" class="ltx_p"><span id="S1.T1.1.6.5.2.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.6.5.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.6.5.3.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.6.5.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.6.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.6.5.4.1.1" class="ltx_p"><span id="S1.T1.1.6.5.4.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.6.5.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.6.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.6.5.5.1.1" class="ltx_p"><span id="S1.T1.1.6.5.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.7.6" class="ltx_tr">
<td id="S1.T1.1.7.6.1" class="ltx_td ltx_align_justify ltx_align_middle" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.7.6.1.1.1" class="ltx_p">FLoBc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></span>
</span>
</td>
<td id="S1.T1.1.7.6.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.7.6.2.1.1" class="ltx_p"><span id="S1.T1.1.7.6.2.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.7.6.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.7.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.7.6.3.1.1" class="ltx_p">✓</span>
</span>
</td>
<td id="S1.T1.1.7.6.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.7.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.7.6.4.1.1" class="ltx_p"><span id="S1.T1.1.7.6.4.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
<td id="S1.T1.1.7.6.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.7.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.7.6.5.1.1" class="ltx_p"><span id="S1.T1.1.7.6.5.1.1.1" class="ltx_text ltx_font_bold">-</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.8.7" class="ltx_tr">
<td id="S1.T1.1.8.7.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:142.3pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.8.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.8.7.1.1.1" class="ltx_p"><span id="S1.T1.1.8.7.1.1.1.1" class="ltx_text ltx_font_bold">VeryFL</span></span>
</span>
</td>
<td id="S1.T1.1.8.7.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.8.7.2.1.1" class="ltx_p"><span id="S1.T1.1.8.7.2.1.1.1" class="ltx_text ltx_font_bold">✓</span></span>
</span>
</td>
<td id="S1.T1.1.8.7.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.8.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.8.7.3.1.1" class="ltx_p"><span id="S1.T1.1.8.7.3.1.1.1" class="ltx_text ltx_font_bold">✓</span></span>
</span>
</td>
<td id="S1.T1.1.8.7.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.8.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.8.7.4.1.1" class="ltx_p"><span id="S1.T1.1.8.7.4.1.1.1" class="ltx_text ltx_font_bold">✓</span></span>
</span>
</td>
<td id="S1.T1.1.8.7.5" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_middle ltx_border_bb" style="width:85.4pt;padding-left:5.0pt;padding-right:5.0pt;">
<span id="S1.T1.1.8.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.8.7.5.1.1" class="ltx_p"><span id="S1.T1.1.8.7.5.1.1.1" class="ltx_text ltx_font_bold">✓</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Currently, the open-source framework of federated learning is mainly based on centralized client-server paradigm. For example, FedML is a large-scale federated learning framework that can be deployed to serve as a federated learning infrastructure in production environment. And for experimental propose, there are many frameworks which contains a lot of benchmark to help reproduce the FL experiment such as EasyFL.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, after investigating the existing blockchain-based FL framework on Github, we found that there is still a lack of the blockchain-based FL framework that provides a convenient experimental environment. Existing frameworks are either a demo to design a specific algorithm or lack of the basic benchmark of FL to execute experiments compared with the centralized FL frameworks. For example, FedCoin builds a p2p payment system for FL, but it lacks the basic FL algorithm and dataset to run other experiment on it. Based on the above investigation, we find that it is necessary to build a unified federated learning framework embedded with blockchain to provide the relative experiment with an execution environment.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Next, we will introduce our open-source framework VeryFL based on PyTorch and Ethereum. Different from existing federated learning frameworks, VeryFL extends the support for algorithm concerned with blockchain federated learning and have three main features. (1) VeryFL comes with the basic federated learninig algorithm and benchmark dataset to execute FL experiment like other centralized FL framework. (2) VeryFL embedded with the Ethereum network which is interacted through the python SDK. Many on-chain mechanism can be ealisy implemented with smart contract and verified in real blochchain environment. (3) VeryFL designs algorithm to provide model ownership verification services to protect model rights through blockchain. Smart contracts are introduced to assist in model authentication and are responsible for the distribution, management and identification of model tokens.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We summarize the characteristics of the existing mainstream open-source frameworks alongside the VeryFL framework in Table <a href="#S1.T1" title="TABLE I ‣ I Introduction ‣ VeryFL: A Verify Federated Learning Framework Embedded with Blockchain" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The characteristics of VeryFL are delineated as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Usability:</span> VeryFL offers benchmark datasets and aggregation algorithms for federated learning, requiring minimal configuration in the absence of specialized demands, thereby presenting a novice-friendly environment.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Scalability:</span> Owing to its modular design, VeryFL is readily extensible, facilitating users to customize datasets, aggregation algorithms, and other components pertinent to their specific tasks.
</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Blockchain Embedded:</span> We embedded Ethereum for user to write and invoke on-chain mechanism through smart contract. Beyond providing foundational support for federated learning, VeryFL also affords a prototype system for model ownership verification, thereby broadening the scope of federated learning applications.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p"><span id="S1.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Model Rights Protection:</span> We implement our Tokenized Model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> on VeryFL. With the watermark embedded in the model, we implement a framework where the blockchain turns the model into a non-fungible token(NFT) for the first time to better protect the model rights and allow model to be transacted.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In the subsequent sections, we will introduce VeryFL in detail. Section 2 will introduce the architecture and various technologies utilized in VeryFL. Section 3 will introduce the novel attributes of VeryFL. Section 4 will provide practical instances of using VeryFL. Finally, Section 5 will be reserved for summarization and prospective outlooks.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Framework</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we will introduce the overall framework of VeryFL constructed upon PyTorch and Ethereum. The framework is shown in Fig. <a href="#S2.F1" title="Figure 1 ‣ II Framework ‣ VeryFL: A Verify Federated Learning Framework Embedded with Blockchain" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. With the help of Brownie SDK, the blockchain (smart contracts) provides Python API together with PyTorch at the foundational layer. Atop the Python API, we encapsulate the federated learning process into a <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">Task</em> class to perform FL training and we wrap the blockchain API into <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">ChainProxy</em> class to deal the interaction with the smart contract. Therefore, the architecture can be roughly divided into two principal modules: the blockchain component and the federated learning task component.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2311.15617/assets/figure/framework_3.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="287" height="180" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Framework of VeryFL.</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Blockchain</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Blockchain often acts as a de-trusted ledger among FL training nodes to provide a unchangeable record of the FL training process. Therefore, the blockchain module is mainly responsible for the management and election of the client, recording of the training process, and distribution of the incentives. In the blockchain module, smart contracts are executed on the Ethereum blockchain network using Solidity, subsequently interacting with PyTorch via the Python SDK, Brownie. Ethereum is an programmable blockchain platform, designed to facilitate smart contracts and decentralized applications. Solidity is a programming language tailored specifically for Ethereum smart contracts, while Brownie is a Python-based development framework for the development and testing of Ethereum smart contracts. These components together form a comprehensive ecosystem.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">In VeryFL, blochchain module acts as an manager of the training network. If a user wishes to participate in federated learning training, it is first required to apply for an accounts id for user management. For model copyright protection, blockchain will distribute watermark for each unique model, serving as an identifier for model copyright. This token is bound to the model and is recorded in the blockchain, specifying the user to whom it belongs. And for training management, client and server will upload per-round training result including accuarcy, loss and dataset size to the blockchain for client selection and incentive distribution. Through this bottom blockchain module, many on-chain mechanism can be implemented on the Ethereum network.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Federate Learning Task</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In common blockchain-FL, all node has the equal opportunity to perform aggregation and no specific defined server. However, to keep the compatibility with the centralized FL, VeryFL still defines the <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">Aggregator</span> class to perform the aggregation task. With the election of the blockchain during each trainig round, we handle this aggregator to different client and simulate the decentralized aggregation process.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">The main entry of the FL task is in <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">Task</span> object. It encapsulates necessary components for a federated learning process and controls the training logic where the FL training process starts. With the passed-in-parameters, <span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_italic">Task</span> will initialized the component like models, datasets and federated learning algorithms. VeryFL provides some benchmarks dataset and models and some embedded FL algorithm, facilitating a rapid construction of a federated learning workflow. In addition to benchmarks provided by VeryFL by default, users can easily customize these components according to their individual requirements by inheriting from the corresponding abstract classes and rewriting the core code of algorithm.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Features</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Federated Learning Framework</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Similar with all other federated learning frameworks, the framework comes with several common federated learning benchmarks and image classification datasets in order to make it easy for users to quickly start a federated learning experiment. Common federated learning experiments are often conducted on the CIFAR10, CIFAR100, and FashionMnist datasets, and the framework provides pre-configurations in the Benchmark module to get start and running quickly. In addition to the basic configuration and modules, some utils classes are designed to personalize the experiment. For example, <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_italic">DatasetSpliter</span> is provided at the dataset partition to support federated learning experiments with Non-IID data distribution.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">On-chain Mechanism with Smart Contract</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">With the help of the programmable Ethereum, VeryFL can implement the on-chain mechanism or algorithm through smart contract. With the help of brownie python API, VeryFL can call these predefined smart contract during training process. Many research on blockchain-FL focus on building reliable, private and secure FL system. This feature provide us with the convenience to test our on-chain FL algorithm in a real blockchain network. VeryFL implement some example smart contract to execute the client registration, client election and training result record functions.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Model Ownership verification with Blockchain</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Beyond the FL training functions of VeryFL, we also build a model rights protection and transaction platform on VaryFL as an example of blockchain empowered federated learning. The basic algorithm references the model watermarking techology represented by FedIPR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The proposal of combining FedIPR with blockchain model watermarking algorithm is based on the need for model ownership authentication, where by embedding specific watermarking information, the trainer can claim ownership of the model. Different with the FedIPR scenario, the framework hands over the distribution, recording and authentication process of watermarks to smart contracts to manage, making the distribution process of watermarks more trustworthy. Furthermore, through this process, VeryFL establish a model-user-watermark mapping, where the model trained by the user itself is recorded on the chain as an on-chain asset similar to NFT through the watermark as a representative. In this way, emulating the nature of NFT, we can implement marketable behaviors such as trading and ownership verification against deep learning models. A detailed description of the above process is documented in our previous papers where we propose the tokenized model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Code Practice</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Modulized Design</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">In order to facilitate the subsequent expansion of the federated learning algorithm, most parts of the framework have adopted modular design. Decoupling each parts of the federated learning makes it possible for VeryFL to contains different FL algorithm. With the predefined benchmark’s configure file as the entry point which is passed into <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">Task</span> object, the server, the model, the dataset, the client and the trainer, are instantiated as a single object and assembled together for the training of federated learning. The advantage of implementing each part as a module is that framework can reuse the same parts of the federated learning algorithm as much as possible. For instance, FedAvg and FedProx only differ in client training, the same <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">Aggregator</span> module can be reused on both algorithms. While in other cases, implementing a federated learning algorithm requires implementing both <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_italic">Aggregator</span> and <span id="S4.SS1.p1.1.4" class="ltx_text ltx_font_italic">Trainer</span>. By adopting modular design, we can easily extend new FL algorithm into VeryFL.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Task Start</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To facilitate a quick start of a task, by importing the predefined training parameters and passing it into Task, we can quickly start a federated learning training task.</p>
</div>
<figure id="S4.SS2.tab1" class="ltx_float ltx_lstlisting">
<div id="S4.SS2.tab1.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed ltx_framed_rectangle ltx_listing" style="background-color:#FFFFFF;border-color: #000000;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSB0YXNrIGltcG9ydCBUYXNrCmltcG9ydCBjb25maWcuYmVuY2htYXJrCmdsb2JhbF9hcmdzLCB0cmFpbl9hcmdzLCBhbGdvcml0aG0gPSBiZW5jaG1hcmsuZ2V0X2FyZ3MoKQpjbGFzc2lmaWNhdGlvbl90YXNrID0gVGFzayhnbG9iYWxfYXJncz1nbG9iYWxfYXJncywgdHJhaW5fYXJncz10cmFpbl9hcmdzLCBhbGdvcml0aG09YWxnb3JpdGhtKQpjbGFzc2lmaWNhdGlvbl90YXNrLnJ1bigp" download="source_code/Task.py">⬇</a></div>
<div id="lstnumberx1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx1.1" class="ltx_text ltx_lst_keyword" style="font-size:80%;"><span id="lstnumberx1.1.1" class="ltx_text" style="color:#0000FF;">from</span></span><span id="lstnumberx1.2" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx1.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">task</span><span id="lstnumberx1.4" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx1.5" class="ltx_text ltx_lst_keyword" style="font-size:80%;"><span id="lstnumberx1.5.1" class="ltx_text" style="color:#0000FF;">import</span></span><span id="lstnumberx1.6" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx1.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">Task</span>
</div>
<div id="lstnumberx2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx2.1" class="ltx_text ltx_lst_keyword" style="font-size:80%;"><span id="lstnumberx2.1.1" class="ltx_text" style="color:#0000FF;">import</span></span><span id="lstnumberx2.2" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx2.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">config</span><span id="lstnumberx2.4" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx2.5" class="ltx_text ltx_lst_identifier" style="font-size:80%;">benchmark</span>
</div>
<div id="lstnumberx3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx3.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">global_args</span><span id="lstnumberx3.2" class="ltx_text" style="font-size:80%;">,</span><span id="lstnumberx3.3" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx3.4" class="ltx_text ltx_lst_identifier" style="font-size:80%;">train_args</span><span id="lstnumberx3.5" class="ltx_text" style="font-size:80%;">,</span><span id="lstnumberx3.6" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx3.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">algorithm</span><span id="lstnumberx3.8" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx3.9" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx3.10" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx3.11" class="ltx_text ltx_lst_identifier" style="font-size:80%;">benchmark</span><span id="lstnumberx3.12" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx3.13" class="ltx_text ltx_lst_identifier" style="font-size:80%;">get_args</span><span id="lstnumberx3.14" class="ltx_text" style="font-size:80%;">()</span>
</div>
<div id="lstnumberx4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx4.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">classification_task</span><span id="lstnumberx4.2" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx4.3" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx4.4" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx4.5" class="ltx_text ltx_lst_identifier" style="font-size:80%;">Task</span><span id="lstnumberx4.6" class="ltx_text" style="font-size:80%;">(</span><span id="lstnumberx4.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">global_args</span><span id="lstnumberx4.8" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx4.9" class="ltx_text ltx_lst_identifier" style="font-size:80%;">global_args</span><span id="lstnumberx4.10" class="ltx_text" style="font-size:80%;">,</span><span id="lstnumberx4.11" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx4.12" class="ltx_text ltx_lst_identifier" style="font-size:80%;">train_args</span><span id="lstnumberx4.13" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx4.14" class="ltx_text ltx_lst_identifier" style="font-size:80%;">train_args</span><span id="lstnumberx4.15" class="ltx_text" style="font-size:80%;">,</span><span id="lstnumberx4.16" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx4.17" class="ltx_text ltx_lst_identifier" style="font-size:80%;">algorithm</span><span id="lstnumberx4.18" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx4.19" class="ltx_text ltx_lst_identifier" style="font-size:80%;">algorithm</span><span id="lstnumberx4.20" class="ltx_text" style="font-size:80%;">)</span>
</div>
<div id="lstnumberx5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx5.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">classification_task</span><span id="lstnumberx5.2" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx5.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">run</span><span id="lstnumberx5.4" class="ltx_text" style="font-size:80%;">()</span>
</div>
</div>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">VeryFL provides benchmark for FL tasks. In <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_italic">Benchmark</span> class, VeryFL devided the arguments of the FL training into <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_italic">global_args</span>, <span id="S4.SS2.p2.1.3" class="ltx_text ltx_font_italic">train_args</span> and <span id="S4.SS2.p2.1.4" class="ltx_text ltx_font_italic">Algorithm</span>. The <span id="S4.SS2.p2.1.5" class="ltx_text ltx_font_italic">global_args</span> controls the overall setting of a FL task like model, datasets and number of clients. The <span id="S4.SS2.p2.1.6" class="ltx_text ltx_font_italic">train_args</span> controls the traing arguments in local model training like learning rate, optimizer and weight decay. By changing the parameters in <span id="S4.SS2.p2.1.7" class="ltx_text ltx_font_italic">Benchmark</span>, VeryFL can start a customized training.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Blockchain Interface</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Since blockchain development is almost inevitably accompanied by the writing of Solidity, VeryFL provides <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">ChainProxy</span> as the interface to interact with the blockchain. Users can deploy smart contracts written by themselves and write wrapper functions in <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">ChainProxy</span> to wrap the smart contracts interface into python functions that can work together with PyTorch.</p>
</div>
<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS3.SSS1.5.1.1" class="ltx_text">IV-C</span>1 </span>Start Ethereum Network</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">The following code line 1 shows the process of starting the blockchain network, which start an instance of a blockchain network. After starting the network successfully, VeryFL begins to deploy the smart contracts.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS3.SSS2.5.1.1" class="ltx_text">IV-C</span>2 </span>Deployment of Smart Contracts</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">At the begining, the blockchain will have ten accounts whose addresses is stored in a list. We use accounts[0] as the server accounts to deploy smart contracts. The deployment procedure is shown in line 4, 5. The server accounts After deployment, VeryFL can call functions through the object of a smart contract instance.</p>
</div>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS3.SSS3.5.1.1" class="ltx_text">IV-C</span>3 </span>Predefined Smart Contract</h4>

<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.1" class="ltx_p">VeryFL provides some predefined smart contract which have already been wrapped in <span id="S4.SS3.SSS3.p1.1.1" class="ltx_text ltx_font_italic">ChainProxy</span>. They provides the registration function that corresponds the client to the blockchain user’s address, the training result recording function and the model watermark function mentioned in Chapter 3. These processes can be called to supervise and manage the FL training.</p>
</div>
<figure id="S4.SS3.SSS3.tab1" class="ltx_float ltx_lstlisting">
<div id="S4.SS3.SSS3.tab1.1" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed ltx_framed_rectangle ltx_listing" style="background-color:#FFFFFF;border-color: #000000;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZnJvbSBicm93bmllLnByb2plY3QuY2hhaW5TZXJ2ZXIgaW1wb3J0ICoKbmV0d29yay5jb25uZWN0KCdkZXZlbG9wbWVudCcpCnNlcnZlcl9hY2NvdW50cyA9IGFjY291bnRzWzBdCndhdGVybWFya05lZ290aWF0aW9uLmRlcGxveSh7J2Zyb20nOnNlcnZlcl9hY2NvdW50c30pCmNsaWVudE1hbmFnZXIuZGVwbG95KHsnZnJvbSc6c2VydmVyX2FjY291bnRzfSkK" download="source_code/ChainProxy.py">⬇</a></div>
<div id="lstnumberx6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span id="lstnumberx6.1" class="ltx_text ltx_lst_keyword" style="font-size:80%;"><span id="lstnumberx6.1.1" class="ltx_text" style="color:#0000FF;">from</span></span><span id="lstnumberx6.2" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx6.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">brownie</span><span id="lstnumberx6.4" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx6.5" class="ltx_text ltx_lst_identifier" style="font-size:80%;">project</span><span id="lstnumberx6.6" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx6.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">chainServer</span><span id="lstnumberx6.8" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx6.9" class="ltx_text ltx_lst_keyword" style="font-size:80%;"><span id="lstnumberx6.9.1" class="ltx_text" style="color:#0000FF;">import</span></span><span id="lstnumberx6.10" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx6.11" class="ltx_text" style="font-size:80%;">*</span>
</div>
<div id="lstnumberx7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span id="lstnumberx7.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">network</span><span id="lstnumberx7.2" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx7.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">connect</span><span id="lstnumberx7.4" class="ltx_text" style="font-size:80%;">(</span><span id="lstnumberx7.5" class="ltx_text ltx_lst_string" style="font-size:80%;"><span id="lstnumberx7.5.1" class="ltx_text" style="color:#FF8000;">’development’</span></span><span id="lstnumberx7.6" class="ltx_text" style="font-size:80%;">)</span>
</div>
<div id="lstnumberx8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="lstnumberx8.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">server_accounts</span><span id="lstnumberx8.2" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx8.3" class="ltx_text" style="font-size:80%;">=</span><span id="lstnumberx8.4" class="ltx_text ltx_lst_space" style="font-size:80%;"> </span><span id="lstnumberx8.5" class="ltx_text ltx_lst_identifier" style="font-size:80%;">accounts</span><span id="lstnumberx8.6" class="ltx_text" style="font-size:80%;">[0]</span>
</div>
<div id="lstnumberx9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span id="lstnumberx9.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">watermarkNegotiation</span><span id="lstnumberx9.2" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx9.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">deploy</span><span id="lstnumberx9.4" class="ltx_text" style="font-size:80%;">({</span><span id="lstnumberx9.5" class="ltx_text ltx_lst_string" style="font-size:80%;"><span id="lstnumberx9.5.1" class="ltx_text" style="color:#FF8000;">’from’</span></span><span id="lstnumberx9.6" class="ltx_text" style="font-size:80%;">:</span><span id="lstnumberx9.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">server_accounts</span><span id="lstnumberx9.8" class="ltx_text" style="font-size:80%;">})</span>
</div>
<div id="lstnumberx10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span><span id="lstnumberx10.1" class="ltx_text ltx_lst_identifier" style="font-size:80%;">clientManager</span><span id="lstnumberx10.2" class="ltx_text" style="font-size:80%;">.</span><span id="lstnumberx10.3" class="ltx_text ltx_lst_identifier" style="font-size:80%;">deploy</span><span id="lstnumberx10.4" class="ltx_text" style="font-size:80%;">({</span><span id="lstnumberx10.5" class="ltx_text ltx_lst_string" style="font-size:80%;"><span id="lstnumberx10.5.1" class="ltx_text" style="color:#FF8000;">’from’</span></span><span id="lstnumberx10.6" class="ltx_text" style="font-size:80%;">:</span><span id="lstnumberx10.7" class="ltx_text ltx_lst_identifier" style="font-size:80%;">server_accounts</span><span id="lstnumberx10.8" class="ltx_text" style="font-size:80%;">})</span>
</div>
</div>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Future Work</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This report present an open-source framework VeryFL. In this framework, we design an extensive and flexible workflow for FL. Besides, we also embed blockchain into this framework to help boost the research of blockchain-empowered federated learning. With the help of embedded Ethereum network, we design a prototype system for model ownership verification mechanism and the incentive mechanism as an example of combining blockchain with FL. We will reproduce more blockchain-based algorithm on this platform to help user verify these algorithm conveniently.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith, “Federated optimization in heterogeneous networks,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, vol. 2, pp. 429–450, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. Reddi, S. Stich, and A. T. Suresh, “Scaffold: Stochastic controlled averaging for federated learning,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Model-contrastive federated learning,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2021, pp. 10 713–10 722.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
D. Rothchild, A. Panda, E. Ullah, N. Ivkin, I. Stoica, V. Braverman, J. Gonzalez, and R. Arora, “Fetchsgd: Communication-efficient federated learning with sketching,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2020, pp. 8253–8265.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
H.-P. Wang, S. Stich, Y. He, and M. Fritz, “Progfed: effective, communication, and computation efficient federated learning by progressive training,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2022, pp. 23 034–23 054.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Zhao, H. Zhu, F. Wang, R. Lu, Z. Liu, and H. Li, “Pvd-fl: A privacy-preserving and verifiable decentralized federated learning framework,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>, vol. 17, pp. 2059–2073, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. Sun, J. Qian, and X. Chen, “Ldp-fl: Practical private aggregation in federated learning with local differential privacy,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.15789</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B. Li, L. Fan, H. Gu, J. Li, and Q. Yang, “Fedipr: Ownership verification for federated deep neural network models,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, vol. 45, no. 4, pp. 4521–4536, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
W. Zhuang, X. Gan, Y. Wen, and S. Zhang, “Easyfl: A low-code federated learning platform for dummies,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. He, S. Li, J. So, X. Zeng, M. Zhang, H. Wang, X. Wang, P. Vepakomma, A. Singh, H. Qiu <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Fedml: A research library and benchmark for federated machine learning,” <em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.13518</em>, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
“Gfl,” <a target="_blank" href="https://github.com/GalaxyLearning/GFL" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/GalaxyLearning/GFL</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Liu, Z. Ai, S. Sun, S. Zhang, Z. Liu, and H. Yu, “Fedcoin: A peer-to-peer payment system for federated learning,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Federated learning: privacy and incentive</em>.   Springer, 2020, pp. 125–138.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
“blocklearning,” <a target="_blank" href="https://github.com/hacdias/blocklearning" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/hacdias/blocklearning</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
M. Ghanem, F. Dawoud, H. Gamal, E. Soliman, and T. El-Batt, “Flobc: A decentralized blockchain-based federated learning framework,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2022 Fourth International Conference on Blockchain Computing and Applications (BCCA)</em>.   IEEE, 2022, pp. 85–92.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y. Li, Y. Lai, T. Liao, C. Chen, and Z. Zheng, “Tokenized model: A blockchain-empowered decentralized model ownership verification platform,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv</em>, 2023.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2311.15616" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2311.15617" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2311.15617">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.15617" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2311.15618" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 17:14:21 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
