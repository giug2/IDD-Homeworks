<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Low-resource neural machine translation with morphological modeling</title>
<!--Generated on Thu May  2 17:12:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2404.02392v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S1" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Model architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1.SSS1" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Attention augmentations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1.SSS2" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Morphological encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1.SSS3" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.3 </span>Target-side morphology learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1.SSS4" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.4 </span>Morphological inference</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS2" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS3" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Official Gazette</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS4" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Jw.org website</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS5" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Bilingual dictionaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS6" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span>Monolingual data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS7" title="In 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.7 </span>Data augmentations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.SS1" title="In 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.SS2" title="In 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.SS3" title="In 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S4" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S5" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S6" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A1" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Model, training and inference hyper-parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A2" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Dataset summary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A3" title="In Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Morphological decoding algorithm</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Low-resource neural machine translation with morphological modeling</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Antoine Nzeyimana 
<br class="ltx_break"/>University of Massachusetts Amherst 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.1.id1">anthonzeyi@gmail.com</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.1">Morphological modeling in neural machine translation (NMT) is a promising approach to achieving open-vocabulary machine translation for morphologically-rich languages. However, existing methods such as sub-word tokenization and character-based models are limited to the surface forms of the words. In this work, we propose a framework-solution for modeling complex morphology in low-resource settings. A two-tier transformer architecture is chosen to encode morphological information at the inputs. At the target-side output, a multi-task multi-label training scheme coupled with a beam search-based decoder are found to improve machine translation performance. An attention augmentation scheme to the transformer model is proposed in a generic form to allow integration of pre-trained language models and also facilitate modeling of word order relationships between the source and target languages. Several data augmentation techniques are evaluated and shown to increase translation performance in low-resource settings. We evaluate our proposed solution on Kinyarwanda <math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" stretchy="false" xref="id1.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">↔</annotation></semantics></math> English translation using public-domain parallel text. Our final models achieve competitive performance in relation to large multi-lingual models. We hope that our results will motivate more use of explicit morphological information and the proposed model and data augmentations in low-resource NMT.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">Low-resource neural machine translation with morphological modeling</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.1.2.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1.1">Antoine Nzeyimana</span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.2.1">University of Massachusetts Amherst</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.3.3">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.3.3.1"><span class="ltx_text ltx_font_typewriter" id="p1.1.2.1.1.3.3.1.1">anthonzeyi@gmail.com</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Neural Machine Translation (NMT) has become a predominant approach in developing machine translation systems. Two important innovations in recent state-of-the-art NMT systems are the use of the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib35" title="">2017</a>)</cite> and sub-word tokenization methods such as byte-pair encoding (BPE) <cite class="ltx_cite ltx_citemacro_cite">Sennrich et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib32" title="">2016</a>)</cite>. However, for morphologically-rich languages(MRLs), BPE-based tokenization is only limited to the surface forms of the words and less grounded on exact lexical units (i.e. morphemes), especially in the presence morphographemic alternations <cite class="ltx_cite ltx_citemacro_cite">Bundy and Wallen (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib5" title="">1984</a>)</cite> and non-concatenative morphology <cite class="ltx_cite ltx_citemacro_cite">Kastner et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib13" title="">2019</a>)</cite>. In this work, we tackle the challenge of modeling complex morphology in low-resource NMT and evaluate on Kinyarwanda, a low-resource and morphologically-rich language spoken by more than 15 million people in Eastern and Central Africa<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://en.wikipedia.org/wiki/Kinyarwanda" title="">https://en.wikipedia.org/wiki/Kinyarwanda</a></span></span></span>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To model the complex morphology of MRLs in machine translation, one has to consider both source-side modeling (i.e. morphological encoding) and target-side generation of inflected forms (i.e. morphological prediction). We explicitly use the morphological structure of the words and the associated morphemes, which form the basic lexical units. For source-side encoding, morphemes are first produced by a morphological analyzer before being passed to the source encoder through an embedding mechanism. On the target side, the morphological structure must be predicted along with morphemes, which are then consumed by an inflected form synthesizer to produce surface forms. Therefore, this approach enables open vocabulary machine translation since morphemes can be meaningfully combined to form new inflected forms not seen during training.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Previous research has shown that certain adaptations to NMT models, such as the integration of pre-trained language models <cite class="ltx_cite ltx_citemacro_cite">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib39" title="">2020</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib33" title="">2021</a>)</cite>, can improve machine translation performance. We explore this idea to improve low-resource machine translation between Kinyarwanda and English. Our model augmentation focuses on biasing the attention computation in the transformer model. Beside augmentation from pre-trained language model integration, we also devise an augmentation based solely on the word order relationship between source and target languages. These model augmentations bring substantial improvement in translation performance when parallel text is scarce.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">One of the main challenges facing machine translation for low-resource languages obviously is parallel data scarcity. When the training data has limited lexical coverage, the NMT model may tend to hallucinate <cite class="ltx_cite ltx_citemacro_cite">Raunak et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib29" title="">2021</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib38" title="">2023</a>)</cite>. Additionally, for a morphology-aware translation model, there is a problem of misaligned vocabularies between source and target languages. This makes it harder for the model to learn to copy unknown words and other tokens that need to be copied without translation such as proper names.
To address these challenges, we take a data-centric approach by developing tools to extract more parallel data from public-domain documents and websites.
We also use various data augmentation techniques to increase lexical coverage and improve token copying ability where necessary. By combining these data-centric approaches with our morphology-aware NMT model, we achieve competitive translation performance in relation to larger multi-lingual NMT models. To have a comprehensive evaluation, we evaluate our models on three different benchmarks covering different domains, namely Wikipedia, News and Covid-19.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In short, our contribution in this work can be summarized as follow:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose and evaluate methods for source-side and target-side morphological modeling in neural machine translation of morphologically-rich languages.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a generic method for attention augmentation in the transformer architecture, including a new cross-positional encoding technique to fit word order relationships between source and target language.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We evaluate on Kinyarwanda<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mo id="S1.I1.i3.p1.1.m1.1.1" stretchy="false" xref="S1.I1.i3.p1.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><ci id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">↔</annotation></semantics></math>English translation across three benchmarks and achieve competitive performance in relation to existing large multi-lingual NMT models.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We release tools for parallel corpus construction from public-domain sources and make our source code publicly available to allow reproducibility<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/anzeyimana/KinMT_NAACL2024" title="">https://github.com/anzeyimana/KinMT_NAACL2024</a></span></span></span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.3">Machine translation (MT) can be considered as the task of accurately mapping a sequence of tokens (e.g. phrase, sentence, paragraph) in the source language <math alttext="S=(s_{1},s_{2},...s_{n})" class="ltx_Math" display="inline" id="S2.p1.1.m1.3"><semantics id="S2.p1.1.m1.3a"><mrow id="S2.p1.1.m1.3.3" xref="S2.p1.1.m1.3.3.cmml"><mi id="S2.p1.1.m1.3.3.5" xref="S2.p1.1.m1.3.3.5.cmml">S</mi><mo id="S2.p1.1.m1.3.3.4" xref="S2.p1.1.m1.3.3.4.cmml">=</mo><mrow id="S2.p1.1.m1.3.3.3.3" xref="S2.p1.1.m1.3.3.3.4.cmml"><mo id="S2.p1.1.m1.3.3.3.3.4" stretchy="false" xref="S2.p1.1.m1.3.3.3.4.cmml">(</mo><msub id="S2.p1.1.m1.1.1.1.1.1" xref="S2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.1.1.1.2" xref="S2.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mn id="S2.p1.1.m1.1.1.1.1.1.3" xref="S2.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.1.m1.3.3.3.3.5" xref="S2.p1.1.m1.3.3.3.4.cmml">,</mo><msub id="S2.p1.1.m1.2.2.2.2.2" xref="S2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S2.p1.1.m1.2.2.2.2.2.2" xref="S2.p1.1.m1.2.2.2.2.2.2.cmml">s</mi><mn id="S2.p1.1.m1.2.2.2.2.2.3" xref="S2.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.1.m1.3.3.3.3.6" xref="S2.p1.1.m1.3.3.3.4.cmml">,</mo><mrow id="S2.p1.1.m1.3.3.3.3.3" xref="S2.p1.1.m1.3.3.3.3.3.cmml"><mi id="S2.p1.1.m1.3.3.3.3.3.2" mathvariant="normal" xref="S2.p1.1.m1.3.3.3.3.3.2.cmml">…</mi><mo id="S2.p1.1.m1.3.3.3.3.3.1" xref="S2.p1.1.m1.3.3.3.3.3.1.cmml">⁢</mo><msub id="S2.p1.1.m1.3.3.3.3.3.3" xref="S2.p1.1.m1.3.3.3.3.3.3.cmml"><mi id="S2.p1.1.m1.3.3.3.3.3.3.2" xref="S2.p1.1.m1.3.3.3.3.3.3.2.cmml">s</mi><mi id="S2.p1.1.m1.3.3.3.3.3.3.3" xref="S2.p1.1.m1.3.3.3.3.3.3.3.cmml">n</mi></msub></mrow><mo id="S2.p1.1.m1.3.3.3.3.7" stretchy="false" xref="S2.p1.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.3b"><apply id="S2.p1.1.m1.3.3.cmml" xref="S2.p1.1.m1.3.3"><eq id="S2.p1.1.m1.3.3.4.cmml" xref="S2.p1.1.m1.3.3.4"></eq><ci id="S2.p1.1.m1.3.3.5.cmml" xref="S2.p1.1.m1.3.3.5">𝑆</ci><vector id="S2.p1.1.m1.3.3.3.4.cmml" xref="S2.p1.1.m1.3.3.3.3"><apply id="S2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.1.1.1.2">𝑠</ci><cn id="S2.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S2.p1.1.m1.2.2.2.2.2.cmml" xref="S2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S2.p1.1.m1.2.2.2.2.2.2">𝑠</ci><cn id="S2.p1.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S2.p1.1.m1.2.2.2.2.2.3">2</cn></apply><apply id="S2.p1.1.m1.3.3.3.3.3.cmml" xref="S2.p1.1.m1.3.3.3.3.3"><times id="S2.p1.1.m1.3.3.3.3.3.1.cmml" xref="S2.p1.1.m1.3.3.3.3.3.1"></times><ci id="S2.p1.1.m1.3.3.3.3.3.2.cmml" xref="S2.p1.1.m1.3.3.3.3.3.2">…</ci><apply id="S2.p1.1.m1.3.3.3.3.3.3.cmml" xref="S2.p1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.3.3.3.3.1.cmml" xref="S2.p1.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.p1.1.m1.3.3.3.3.3.3.2.cmml" xref="S2.p1.1.m1.3.3.3.3.3.3.2">𝑠</ci><ci id="S2.p1.1.m1.3.3.3.3.3.3.3.cmml" xref="S2.p1.1.m1.3.3.3.3.3.3.3">𝑛</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.3c">S=(s_{1},s_{2},...s_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.3d">italic_S = ( italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> to a sequence of tokens in the target language <math alttext="T=(t_{1},t_{2},...t_{m})" class="ltx_Math" display="inline" id="S2.p1.2.m2.3"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3" xref="S2.p1.2.m2.3.3.cmml"><mi id="S2.p1.2.m2.3.3.5" xref="S2.p1.2.m2.3.3.5.cmml">T</mi><mo id="S2.p1.2.m2.3.3.4" xref="S2.p1.2.m2.3.3.4.cmml">=</mo><mrow id="S2.p1.2.m2.3.3.3.3" xref="S2.p1.2.m2.3.3.3.4.cmml"><mo id="S2.p1.2.m2.3.3.3.3.4" stretchy="false" xref="S2.p1.2.m2.3.3.3.4.cmml">(</mo><msub id="S2.p1.2.m2.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.1.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.2.cmml">t</mi><mn id="S2.p1.2.m2.1.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.3.3.5" xref="S2.p1.2.m2.3.3.3.4.cmml">,</mo><msub id="S2.p1.2.m2.2.2.2.2.2" xref="S2.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.p1.2.m2.2.2.2.2.2.2" xref="S2.p1.2.m2.2.2.2.2.2.2.cmml">t</mi><mn id="S2.p1.2.m2.2.2.2.2.2.3" xref="S2.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.2.m2.3.3.3.3.6" xref="S2.p1.2.m2.3.3.3.4.cmml">,</mo><mrow id="S2.p1.2.m2.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.cmml"><mi id="S2.p1.2.m2.3.3.3.3.3.2" mathvariant="normal" xref="S2.p1.2.m2.3.3.3.3.3.2.cmml">…</mi><mo id="S2.p1.2.m2.3.3.3.3.3.1" xref="S2.p1.2.m2.3.3.3.3.3.1.cmml">⁢</mo><msub id="S2.p1.2.m2.3.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.3.cmml"><mi id="S2.p1.2.m2.3.3.3.3.3.3.2" xref="S2.p1.2.m2.3.3.3.3.3.3.2.cmml">t</mi><mi id="S2.p1.2.m2.3.3.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.3.3.cmml">m</mi></msub></mrow><mo id="S2.p1.2.m2.3.3.3.3.7" stretchy="false" xref="S2.p1.2.m2.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><apply id="S2.p1.2.m2.3.3.cmml" xref="S2.p1.2.m2.3.3"><eq id="S2.p1.2.m2.3.3.4.cmml" xref="S2.p1.2.m2.3.3.4"></eq><ci id="S2.p1.2.m2.3.3.5.cmml" xref="S2.p1.2.m2.3.3.5">𝑇</ci><vector id="S2.p1.2.m2.3.3.3.4.cmml" xref="S2.p1.2.m2.3.3.3.3"><apply id="S2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1.2">𝑡</ci><cn id="S2.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.p1.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S2.p1.2.m2.2.2.2.2.2.cmml" xref="S2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.p1.2.m2.2.2.2.2.2.2">𝑡</ci><cn id="S2.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.p1.2.m2.2.2.2.2.2.3">2</cn></apply><apply id="S2.p1.2.m2.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3"><times id="S2.p1.2.m2.3.3.3.3.3.1.cmml" xref="S2.p1.2.m2.3.3.3.3.3.1"></times><ci id="S2.p1.2.m2.3.3.3.3.3.2.cmml" xref="S2.p1.2.m2.3.3.3.3.3.2">…</ci><apply id="S2.p1.2.m2.3.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.3.3.3.3.1.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S2.p1.2.m2.3.3.3.3.3.3.2.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3.2">𝑡</ci><ci id="S2.p1.2.m2.3.3.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">T=(t_{1},t_{2},...t_{m})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.3d">italic_T = ( italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_t start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> with the same meaning. The learning problem is then to estimate a conditional probability model that produces the optimal translation <math alttext="T^{*}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><msup id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">T</mi><mo id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝑇</ci><times id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">T^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_T start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, that is:</p>
</div>
<div class="ltx_para" id="S2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T^{*}=\operatorname*{arg\,max}_{T}P(T|S,T_{&lt;};\Theta),\vspace{-0.15in}" class="ltx_Math" display="block" id="S2.Ex1.m1.3"><semantics id="S2.Ex1.m1.3a"><mrow id="S2.Ex1.m1.3.3.1" xref="S2.Ex1.m1.3.3.1.1.cmml"><mrow id="S2.Ex1.m1.3.3.1.1" xref="S2.Ex1.m1.3.3.1.1.cmml"><msup id="S2.Ex1.m1.3.3.1.1.3" xref="S2.Ex1.m1.3.3.1.1.3.cmml"><mi id="S2.Ex1.m1.3.3.1.1.3.2" xref="S2.Ex1.m1.3.3.1.1.3.2.cmml">T</mi><mo id="S2.Ex1.m1.3.3.1.1.3.3" xref="S2.Ex1.m1.3.3.1.1.3.3.cmml">∗</mo></msup><mo id="S2.Ex1.m1.3.3.1.1.2" xref="S2.Ex1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.3.3.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.cmml"><mrow id="S2.Ex1.m1.3.3.1.1.1.3" xref="S2.Ex1.m1.3.3.1.1.1.3.cmml"><munder id="S2.Ex1.m1.3.3.1.1.1.3.1" xref="S2.Ex1.m1.3.3.1.1.1.3.1.cmml"><mrow id="S2.Ex1.m1.3.3.1.1.1.3.1.2" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.cmml"><mi id="S2.Ex1.m1.3.3.1.1.1.3.1.2.2" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S2.Ex1.m1.3.3.1.1.1.3.1.2.1" lspace="0.170em" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S2.Ex1.m1.3.3.1.1.1.3.1.2.3" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.Ex1.m1.3.3.1.1.1.3.1.3" xref="S2.Ex1.m1.3.3.1.1.1.3.1.3.cmml">T</mi></munder><mo id="S2.Ex1.m1.3.3.1.1.1.3a" xref="S2.Ex1.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S2.Ex1.m1.3.3.1.1.1.3.2" xref="S2.Ex1.m1.3.3.1.1.1.3.2.cmml">P</mi></mrow><mo id="S2.Ex1.m1.3.3.1.1.1.2" xref="S2.Ex1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.3.3.1.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.3.3.1.1.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.3.3.1.1.1.1.1.1.3" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml">T</mi><mo fence="false" id="S2.Ex1.m1.3.3.1.1.1.1.1.1.2" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">S</mi><mo id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">T</mi><mo id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">&lt;</mo></msub><mo id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.Ex1.m1.2.2" mathvariant="normal" xref="S2.Ex1.m1.2.2.cmml">Θ</mi></mrow></mrow><mo id="S2.Ex1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.3.3.1.2" xref="S2.Ex1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.3b"><apply id="S2.Ex1.m1.3.3.1.1.cmml" xref="S2.Ex1.m1.3.3.1"><eq id="S2.Ex1.m1.3.3.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2"></eq><apply id="S2.Ex1.m1.3.3.1.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.3">superscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.3.2">𝑇</ci><times id="S2.Ex1.m1.3.3.1.1.3.3.cmml" xref="S2.Ex1.m1.3.3.1.1.3.3"></times></apply><apply id="S2.Ex1.m1.3.3.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1"><times id="S2.Ex1.m1.3.3.1.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.2"></times><apply id="S2.Ex1.m1.3.3.1.1.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3"><apply id="S2.Ex1.m1.3.3.1.1.1.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.1.3.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1">subscript</csymbol><apply id="S2.Ex1.m1.3.3.1.1.1.3.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2"><times id="S2.Ex1.m1.3.3.1.1.1.3.1.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.1"></times><ci id="S2.Ex1.m1.3.3.1.1.1.3.1.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.2">arg</ci><ci id="S2.Ex1.m1.3.3.1.1.1.3.1.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.Ex1.m1.3.3.1.1.1.3.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.1.3">𝑇</ci></apply><ci id="S2.Ex1.m1.3.3.1.1.1.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.3.2">𝑃</ci></apply><apply id="S2.Ex1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.2">conditional</csymbol><ci id="S2.Ex1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.3">𝑇</ci><list id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1"><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝑆</ci><apply id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑇</ci><lt id="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1.1.1.1.1.3"></lt></apply><ci id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2">Θ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.3c">T^{*}=\operatorname*{arg\,max}_{T}P(T|S,T_{&lt;};\Theta),\vspace{-0.15in}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.3d">italic_T start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT italic_P ( italic_T | italic_S , italic_T start_POSTSUBSCRIPT &lt; end_POSTSUBSCRIPT ; roman_Θ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.2">where <math alttext="T_{&lt;}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">T</mi><mo id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">&lt;</mo></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝑇</ci><lt id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3"></lt></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">T_{&lt;}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_T start_POSTSUBSCRIPT &lt; end_POSTSUBSCRIPT</annotation></semantics></math> accounts for the previous output context and <math alttext="\Theta" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" mathvariant="normal" xref="S2.p3.2.m2.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">roman_Θ</annotation></semantics></math> are parameters of the model (that is a neural network in the case of NMT).</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">In this section, we describe our model architecture as an extension of the basic Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib35" title="">2017</a>)</cite> to enable morphological modeling and attention augmentation. We also describe our data-centric approaches to dataset development and augmentation in the context of the low-resource Kinyarwanda<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mo id="S2.p4.1.m1.1.1" stretchy="false" xref="S2.p4.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">↔</annotation></semantics></math>English machine translation.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Model architecture</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib35" title="">2017</a>)</cite> for machine translation uses a multi-layer bidirectional encoder to process source language input, and then feeds to an auto-regressive decoder to produce the target language output. Our adaptation of the transformer encoder is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.F1" title="Figure 1 ‣ 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">1</span></a> while the decoder is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.F2" title="Figure 2 ‣ 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2</span></a>. They both use pre-LayerNorm configuration <cite class="ltx_cite ltx_citemacro_cite">Nguyen and Salazar (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib21" title="">2019</a>)</cite> of the transformer.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.11">The <span class="ltx_text ltx_font_bold" id="S2.SS1.p2.11.1">attention module</span> of the transformer architecture is designed as querying a dictionary made of key-value pairs using a softmax function and then projecting a weighted sum of value vectors to an output vector, that is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Attention(Q,K,V)=Softmax(\frac{QK^{T}}{\sqrt{d}})V," class="ltx_Math" display="block" id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1.2" xref="S2.E1.m1.5.5.1.1.2.cmml"><mi id="S2.E1.m1.5.5.1.1.2.2" xref="S2.E1.m1.5.5.1.1.2.2.cmml">A</mi><mo id="S2.E1.m1.5.5.1.1.2.1" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.3" xref="S2.E1.m1.5.5.1.1.2.3.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.2.1a" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.4" xref="S2.E1.m1.5.5.1.1.2.4.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.2.1b" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.5" xref="S2.E1.m1.5.5.1.1.2.5.cmml">e</mi><mo id="S2.E1.m1.5.5.1.1.2.1c" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.6" xref="S2.E1.m1.5.5.1.1.2.6.cmml">n</mi><mo id="S2.E1.m1.5.5.1.1.2.1d" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.7" xref="S2.E1.m1.5.5.1.1.2.7.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.2.1e" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.8" xref="S2.E1.m1.5.5.1.1.2.8.cmml">i</mi><mo id="S2.E1.m1.5.5.1.1.2.1f" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.9" xref="S2.E1.m1.5.5.1.1.2.9.cmml">o</mi><mo id="S2.E1.m1.5.5.1.1.2.1g" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.2.10" xref="S2.E1.m1.5.5.1.1.2.10.cmml">n</mi><mo id="S2.E1.m1.5.5.1.1.2.1h" xref="S2.E1.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.2.11.2" xref="S2.E1.m1.5.5.1.1.2.11.1.cmml"><mo id="S2.E1.m1.5.5.1.1.2.11.2.1" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.11.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">Q</mi><mo id="S2.E1.m1.5.5.1.1.2.11.2.2" xref="S2.E1.m1.5.5.1.1.2.11.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">K</mi><mo id="S2.E1.m1.5.5.1.1.2.11.2.3" xref="S2.E1.m1.5.5.1.1.2.11.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">V</mi><mo id="S2.E1.m1.5.5.1.1.2.11.2.4" stretchy="false" xref="S2.E1.m1.5.5.1.1.2.11.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.2" xref="S2.E1.m1.5.5.1.1.3.2.cmml">S</mi><mo id="S2.E1.m1.5.5.1.1.3.1" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.3" xref="S2.E1.m1.5.5.1.1.3.3.cmml">o</mi><mo id="S2.E1.m1.5.5.1.1.3.1a" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.4" xref="S2.E1.m1.5.5.1.1.3.4.cmml">f</mi><mo id="S2.E1.m1.5.5.1.1.3.1b" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.5" xref="S2.E1.m1.5.5.1.1.3.5.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.3.1c" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.6" xref="S2.E1.m1.5.5.1.1.3.6.cmml">m</mi><mo id="S2.E1.m1.5.5.1.1.3.1d" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.7" xref="S2.E1.m1.5.5.1.1.3.7.cmml">a</mi><mo id="S2.E1.m1.5.5.1.1.3.1e" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.8" xref="S2.E1.m1.5.5.1.1.3.8.cmml">x</mi><mo id="S2.E1.m1.5.5.1.1.3.1f" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.3.9.2" xref="S2.E1.m1.4.4.cmml"><mo id="S2.E1.m1.5.5.1.1.3.9.2.1" stretchy="false" xref="S2.E1.m1.4.4.cmml">(</mo><mfrac id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml"><mi id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.2.cmml">Q</mi><mo id="S2.E1.m1.4.4.2.1" xref="S2.E1.m1.4.4.2.1.cmml">⁢</mo><msup id="S2.E1.m1.4.4.2.3" xref="S2.E1.m1.4.4.2.3.cmml"><mi id="S2.E1.m1.4.4.2.3.2" xref="S2.E1.m1.4.4.2.3.2.cmml">K</mi><mi id="S2.E1.m1.4.4.2.3.3" xref="S2.E1.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><mi id="S2.E1.m1.4.4.3.2" xref="S2.E1.m1.4.4.3.2.cmml">d</mi></msqrt></mfrac><mo id="S2.E1.m1.5.5.1.1.3.9.2.2" stretchy="false" xref="S2.E1.m1.4.4.cmml">)</mo></mrow><mo id="S2.E1.m1.5.5.1.1.3.1g" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.1.1.3.10" xref="S2.E1.m1.5.5.1.1.3.10.cmml">V</mi></mrow></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><eq id="S2.E1.m1.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1"></eq><apply id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2"><times id="S2.E1.m1.5.5.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.1"></times><ci id="S2.E1.m1.5.5.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2">𝐴</ci><ci id="S2.E1.m1.5.5.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.3">𝑡</ci><ci id="S2.E1.m1.5.5.1.1.2.4.cmml" xref="S2.E1.m1.5.5.1.1.2.4">𝑡</ci><ci id="S2.E1.m1.5.5.1.1.2.5.cmml" xref="S2.E1.m1.5.5.1.1.2.5">𝑒</ci><ci id="S2.E1.m1.5.5.1.1.2.6.cmml" xref="S2.E1.m1.5.5.1.1.2.6">𝑛</ci><ci id="S2.E1.m1.5.5.1.1.2.7.cmml" xref="S2.E1.m1.5.5.1.1.2.7">𝑡</ci><ci id="S2.E1.m1.5.5.1.1.2.8.cmml" xref="S2.E1.m1.5.5.1.1.2.8">𝑖</ci><ci id="S2.E1.m1.5.5.1.1.2.9.cmml" xref="S2.E1.m1.5.5.1.1.2.9">𝑜</ci><ci id="S2.E1.m1.5.5.1.1.2.10.cmml" xref="S2.E1.m1.5.5.1.1.2.10">𝑛</ci><vector id="S2.E1.m1.5.5.1.1.2.11.1.cmml" xref="S2.E1.m1.5.5.1.1.2.11.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑄</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐾</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑉</ci></vector></apply><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><times id="S2.E1.m1.5.5.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.1"></times><ci id="S2.E1.m1.5.5.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2">𝑆</ci><ci id="S2.E1.m1.5.5.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3">𝑜</ci><ci id="S2.E1.m1.5.5.1.1.3.4.cmml" xref="S2.E1.m1.5.5.1.1.3.4">𝑓</ci><ci id="S2.E1.m1.5.5.1.1.3.5.cmml" xref="S2.E1.m1.5.5.1.1.3.5">𝑡</ci><ci id="S2.E1.m1.5.5.1.1.3.6.cmml" xref="S2.E1.m1.5.5.1.1.3.6">𝑚</ci><ci id="S2.E1.m1.5.5.1.1.3.7.cmml" xref="S2.E1.m1.5.5.1.1.3.7">𝑎</ci><ci id="S2.E1.m1.5.5.1.1.3.8.cmml" xref="S2.E1.m1.5.5.1.1.3.8">𝑥</ci><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.5.5.1.1.3.9.2"><divide id="S2.E1.m1.4.4.1.cmml" xref="S2.E1.m1.5.5.1.1.3.9.2"></divide><apply id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"><times id="S2.E1.m1.4.4.2.1.cmml" xref="S2.E1.m1.4.4.2.1"></times><ci id="S2.E1.m1.4.4.2.2.cmml" xref="S2.E1.m1.4.4.2.2">𝑄</ci><apply id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.3.1.cmml" xref="S2.E1.m1.4.4.2.3">superscript</csymbol><ci id="S2.E1.m1.4.4.2.3.2.cmml" xref="S2.E1.m1.4.4.2.3.2">𝐾</ci><ci id="S2.E1.m1.4.4.2.3.3.cmml" xref="S2.E1.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><root id="S2.E1.m1.4.4.3a.cmml" xref="S2.E1.m1.4.4.3"></root><ci id="S2.E1.m1.4.4.3.2.cmml" xref="S2.E1.m1.4.4.3.2">𝑑</ci></apply></apply><ci id="S2.E1.m1.5.5.1.1.3.10.cmml" xref="S2.E1.m1.5.5.1.1.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">Attention(Q,K,V)=Softmax(\frac{QK^{T}}{\sqrt{d}})V,</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( italic_Q , italic_K , italic_V ) = italic_S italic_o italic_f italic_t italic_m italic_a italic_x ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) italic_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.6">where <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_K</annotation></semantics></math>,<math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_Q</annotation></semantics></math>,<math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_V</annotation></semantics></math> are projections of the hidden representations of inputs at a given layer. Given a hidden representation of a token <math alttext="v_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">v</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝑣</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> attending to a sequence of tokens with hidden representations <math alttext="(w_{1},w_{2},...w_{n})" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.3"><semantics id="S2.SS1.p2.5.m5.3a"><mrow id="S2.SS1.p2.5.m5.3.3.3" xref="S2.SS1.p2.5.m5.3.3.4.cmml"><mo id="S2.SS1.p2.5.m5.3.3.3.4" stretchy="false" xref="S2.SS1.p2.5.m5.3.3.4.cmml">(</mo><msub id="S2.SS1.p2.5.m5.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.1.1.2" xref="S2.SS1.p2.5.m5.1.1.1.1.2.cmml">w</mi><mn id="S2.SS1.p2.5.m5.1.1.1.1.3" xref="S2.SS1.p2.5.m5.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p2.5.m5.3.3.3.5" xref="S2.SS1.p2.5.m5.3.3.4.cmml">,</mo><msub id="S2.SS1.p2.5.m5.2.2.2.2" xref="S2.SS1.p2.5.m5.2.2.2.2.cmml"><mi id="S2.SS1.p2.5.m5.2.2.2.2.2" xref="S2.SS1.p2.5.m5.2.2.2.2.2.cmml">w</mi><mn id="S2.SS1.p2.5.m5.2.2.2.2.3" xref="S2.SS1.p2.5.m5.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p2.5.m5.3.3.3.6" xref="S2.SS1.p2.5.m5.3.3.4.cmml">,</mo><mrow id="S2.SS1.p2.5.m5.3.3.3.3" xref="S2.SS1.p2.5.m5.3.3.3.3.cmml"><mi id="S2.SS1.p2.5.m5.3.3.3.3.2" mathvariant="normal" xref="S2.SS1.p2.5.m5.3.3.3.3.2.cmml">…</mi><mo id="S2.SS1.p2.5.m5.3.3.3.3.1" xref="S2.SS1.p2.5.m5.3.3.3.3.1.cmml">⁢</mo><msub id="S2.SS1.p2.5.m5.3.3.3.3.3" xref="S2.SS1.p2.5.m5.3.3.3.3.3.cmml"><mi id="S2.SS1.p2.5.m5.3.3.3.3.3.2" xref="S2.SS1.p2.5.m5.3.3.3.3.3.2.cmml">w</mi><mi id="S2.SS1.p2.5.m5.3.3.3.3.3.3" xref="S2.SS1.p2.5.m5.3.3.3.3.3.3.cmml">n</mi></msub></mrow><mo id="S2.SS1.p2.5.m5.3.3.3.7" stretchy="false" xref="S2.SS1.p2.5.m5.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.3b"><vector id="S2.SS1.p2.5.m5.3.3.4.cmml" xref="S2.SS1.p2.5.m5.3.3.3"><apply id="S2.SS1.p2.5.m5.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.2">𝑤</ci><cn id="S2.SS1.p2.5.m5.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.5.m5.1.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.5.m5.2.2.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.2.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.2.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2.2">𝑤</ci><cn id="S2.SS1.p2.5.m5.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.5.m5.2.2.2.2.3">2</cn></apply><apply id="S2.SS1.p2.5.m5.3.3.3.3.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3"><times id="S2.SS1.p2.5.m5.3.3.3.3.1.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.1"></times><ci id="S2.SS1.p2.5.m5.3.3.3.3.2.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.2">…</ci><apply id="S2.SS1.p2.5.m5.3.3.3.3.3.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.3.3.3.3.3.1.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.3.3.3.3.3.2.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.3.2">𝑤</ci><ci id="S2.SS1.p2.5.m5.3.3.3.3.3.3.cmml" xref="S2.SS1.p2.5.m5.3.3.3.3.3.3">𝑛</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.3c">(w_{1},w_{2},...w_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.3d">( italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>, the output of the attention module corresponding to <math alttext="v_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><msub id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">v</mi><mi id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">𝑣</ci><ci id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}v^{{}^{\prime}}_{i}=\sum_{j=1}^{n}\frac{\exp(\alpha_{ij})}{\sum_{%
j^{\prime}=1}^{n}\exp(\alpha_{ij^{\prime}})}(w_{j}W_{V}),\\
\text{where the logits }\alpha_{ij}=\frac{1}{\sqrt{d}}(v_{i}W_{Q})(w_{j}W_{K})%
^{T},\end{split}" class="ltx_Math" display="block" id="S2.E2.m1.37"><semantics id="S2.E2.m1.37a"><mtable displaystyle="true" id="S2.E2.m1.37.37.3" rowspacing="0pt"><mtr id="S2.E2.m1.37.37.3a"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.37.37.3b"><mrow id="S2.E2.m1.36.36.2.35.16.16.16"><mrow id="S2.E2.m1.36.36.2.35.16.16.16.1"><msubsup id="S2.E2.m1.36.36.2.35.16.16.16.1.2"><mi id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">v</mi><mi id="S2.E2.m1.3.3.3.3.3.3.1" xref="S2.E2.m1.3.3.3.3.3.3.1.cmml">i</mi><msup id="S2.E2.m1.2.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.2.1.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.1a" xref="S2.E2.m1.2.2.2.2.2.2.1.cmml"></mi><mo id="S2.E2.m1.2.2.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.2.2.1.1.cmml">′</mo></msup></msubsup><mo id="S2.E2.m1.4.4.4.4.4.4" rspace="0.111em" xref="S2.E2.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S2.E2.m1.36.36.2.35.16.16.16.1.1"><munderover id="S2.E2.m1.36.36.2.35.16.16.16.1.1.2"><mo id="S2.E2.m1.5.5.5.5.5.5" movablelimits="false" xref="S2.E2.m1.5.5.5.5.5.5.cmml">∑</mo><mrow id="S2.E2.m1.6.6.6.6.6.6.1" xref="S2.E2.m1.6.6.6.6.6.6.1.cmml"><mi id="S2.E2.m1.6.6.6.6.6.6.1.2" xref="S2.E2.m1.6.6.6.6.6.6.1.2.cmml">j</mi><mo id="S2.E2.m1.6.6.6.6.6.6.1.1" xref="S2.E2.m1.6.6.6.6.6.6.1.1.cmml">=</mo><mn id="S2.E2.m1.6.6.6.6.6.6.1.3" xref="S2.E2.m1.6.6.6.6.6.6.1.3.cmml">1</mn></mrow><mi id="S2.E2.m1.7.7.7.7.7.7.1" xref="S2.E2.m1.7.7.7.7.7.7.1.cmml">n</mi></munderover><mrow id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1"><mfrac id="S2.E2.m1.8.8.8.8.8.8" xref="S2.E2.m1.8.8.8.8.8.8.cmml"><mrow id="S2.E2.m1.8.8.8.8.8.8.2.2" xref="S2.E2.m1.8.8.8.8.8.8.2.3.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.1.1" xref="S2.E2.m1.8.8.8.8.8.8.1.1.cmml">exp</mi><mo id="S2.E2.m1.8.8.8.8.8.8.2.2a" xref="S2.E2.m1.8.8.8.8.8.8.2.3.cmml">⁡</mo><mrow id="S2.E2.m1.8.8.8.8.8.8.2.2.1" xref="S2.E2.m1.8.8.8.8.8.8.2.3.cmml"><mo id="S2.E2.m1.8.8.8.8.8.8.2.2.1.2" stretchy="false" xref="S2.E2.m1.8.8.8.8.8.8.2.3.cmml">(</mo><msub id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.2" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.2.cmml">α</mi><mrow id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.2" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.2.cmml">i</mi><mo id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.1" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.3" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.8.8.8.8.8.8.2.2.1.3" stretchy="false" xref="S2.E2.m1.8.8.8.8.8.8.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E2.m1.8.8.8.8.8.8.4" xref="S2.E2.m1.8.8.8.8.8.8.4.cmml"><msubsup id="S2.E2.m1.8.8.8.8.8.8.4.3" xref="S2.E2.m1.8.8.8.8.8.8.4.3.cmml"><mo id="S2.E2.m1.8.8.8.8.8.8.4.3.2.2" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.cmml"><msup id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.2" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.2.cmml">j</mi><mo id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.3" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.3.cmml">′</mo></msup><mo id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.1" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.3" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.8.8.8.8.8.8.4.3.3" xref="S2.E2.m1.8.8.8.8.8.8.4.3.3.cmml">n</mi></msubsup><mrow id="S2.E2.m1.8.8.8.8.8.8.4.2.1" xref="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.3.1" xref="S2.E2.m1.8.8.8.8.8.8.3.1.cmml">exp</mi><mo id="S2.E2.m1.8.8.8.8.8.8.4.2.1a" xref="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml">⁡</mo><mrow id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1" xref="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml"><mo id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.2" stretchy="false" xref="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml">(</mo><msub id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.2" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.2.cmml">α</mi><mrow id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.2" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.2.cmml">i</mi><mo id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.1" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.1.cmml">⁢</mo><msup id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.2" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.2.cmml">j</mi><mo id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.3" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><mo id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.3" stretchy="false" xref="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.2">⁢</mo><mrow id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.1.1"><mo id="S2.E2.m1.9.9.9.9.9.9" stretchy="false">(</mo><mrow id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.1.1.1"><msub id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.1.1.1.2"><mi id="S2.E2.m1.10.10.10.10.10.10" xref="S2.E2.m1.10.10.10.10.10.10.cmml">w</mi><mi id="S2.E2.m1.11.11.11.11.11.11.1" xref="S2.E2.m1.11.11.11.11.11.11.1.cmml">j</mi></msub><mo id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.1.1.1.1">⁢</mo><msub id="S2.E2.m1.36.36.2.35.16.16.16.1.1.1.1.1.1.3"><mi id="S2.E2.m1.12.12.12.12.12.12" xref="S2.E2.m1.12.12.12.12.12.12.cmml">W</mi><mi id="S2.E2.m1.13.13.13.13.13.13.1" xref="S2.E2.m1.13.13.13.13.13.13.1.cmml">V</mi></msub></mrow><mo id="S2.E2.m1.14.14.14.14.14.14" stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.15.15.15.15.15.15">,</mo></mrow></mtd></mtr><mtr id="S2.E2.m1.37.37.3c"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.37.37.3d"><mrow id="S2.E2.m1.37.37.3.36.20.20.20"><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1"><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.3"><mtext id="S2.E2.m1.16.16.16.1.1.1" xref="S2.E2.m1.16.16.16.1.1.1a.cmml">where the logits </mtext><mo id="S2.E2.m1.37.37.3.36.20.20.20.1.3.1">⁢</mo><msub id="S2.E2.m1.37.37.3.36.20.20.20.1.3.2"><mi id="S2.E2.m1.17.17.17.2.2.2" xref="S2.E2.m1.17.17.17.2.2.2.cmml">α</mi><mrow id="S2.E2.m1.18.18.18.3.3.3.1" xref="S2.E2.m1.18.18.18.3.3.3.1.cmml"><mi id="S2.E2.m1.18.18.18.3.3.3.1.2" xref="S2.E2.m1.18.18.18.3.3.3.1.2.cmml">i</mi><mo id="S2.E2.m1.18.18.18.3.3.3.1.1" xref="S2.E2.m1.18.18.18.3.3.3.1.1.cmml">⁢</mo><mi id="S2.E2.m1.18.18.18.3.3.3.1.3" xref="S2.E2.m1.18.18.18.3.3.3.1.3.cmml">j</mi></mrow></msub></mrow><mo id="S2.E2.m1.19.19.19.4.4.4" xref="S2.E2.m1.19.19.19.4.4.4.cmml">=</mo><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.2"><mfrac id="S2.E2.m1.20.20.20.5.5.5" xref="S2.E2.m1.20.20.20.5.5.5.cmml"><mn id="S2.E2.m1.20.20.20.5.5.5.2" xref="S2.E2.m1.20.20.20.5.5.5.2.cmml">1</mn><msqrt id="S2.E2.m1.20.20.20.5.5.5.3" xref="S2.E2.m1.20.20.20.5.5.5.3.cmml"><mi id="S2.E2.m1.20.20.20.5.5.5.3.2" xref="S2.E2.m1.20.20.20.5.5.5.3.2.cmml">d</mi></msqrt></mfrac><mo id="S2.E2.m1.37.37.3.36.20.20.20.1.2.3">⁢</mo><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.1.1.1"><mo id="S2.E2.m1.21.21.21.6.6.6" stretchy="false">(</mo><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.1.1.1.1"><msub id="S2.E2.m1.37.37.3.36.20.20.20.1.1.1.1.1.2"><mi id="S2.E2.m1.22.22.22.7.7.7" xref="S2.E2.m1.22.22.22.7.7.7.cmml">v</mi><mi id="S2.E2.m1.23.23.23.8.8.8.1" xref="S2.E2.m1.23.23.23.8.8.8.1.cmml">i</mi></msub><mo id="S2.E2.m1.37.37.3.36.20.20.20.1.1.1.1.1.1">⁢</mo><msub id="S2.E2.m1.37.37.3.36.20.20.20.1.1.1.1.1.3"><mi id="S2.E2.m1.24.24.24.9.9.9" xref="S2.E2.m1.24.24.24.9.9.9.cmml">W</mi><mi id="S2.E2.m1.25.25.25.10.10.10.1" xref="S2.E2.m1.25.25.25.10.10.10.1.cmml">Q</mi></msub></mrow><mo id="S2.E2.m1.26.26.26.11.11.11" stretchy="false">)</mo></mrow><mo id="S2.E2.m1.37.37.3.36.20.20.20.1.2.3a">⁢</mo><msup id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2"><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2.1.1"><mo id="S2.E2.m1.27.27.27.12.12.12" stretchy="false">(</mo><mrow id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2.1.1.1"><msub id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2.1.1.1.2"><mi id="S2.E2.m1.28.28.28.13.13.13" xref="S2.E2.m1.28.28.28.13.13.13.cmml">w</mi><mi id="S2.E2.m1.29.29.29.14.14.14.1" xref="S2.E2.m1.29.29.29.14.14.14.1.cmml">j</mi></msub><mo id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2.1.1.1.1">⁢</mo><msub id="S2.E2.m1.37.37.3.36.20.20.20.1.2.2.1.1.1.3"><mi id="S2.E2.m1.30.30.30.15.15.15" xref="S2.E2.m1.30.30.30.15.15.15.cmml">W</mi><mi id="S2.E2.m1.31.31.31.16.16.16.1" xref="S2.E2.m1.31.31.31.16.16.16.1.cmml">K</mi></msub></mrow><mo id="S2.E2.m1.32.32.32.17.17.17" stretchy="false">)</mo></mrow><mi id="S2.E2.m1.33.33.33.18.18.18.1" xref="S2.E2.m1.33.33.33.18.18.18.1.cmml">T</mi></msup></mrow></mrow><mo id="S2.E2.m1.34.34.34.19.19.19">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E2.m1.37b"><apply id="S2.E2.m1.35.35.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S2.E2.m1.35.35.1.1.1.1.1.cmml"><eq id="S2.E2.m1.4.4.4.4.4.4.cmml" xref="S2.E2.m1.4.4.4.4.4.4"></eq><apply id="S2.E2.m1.35.35.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.3.1.cmml">subscript</csymbol><apply id="S2.E2.m1.35.35.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.3.2.1.cmml">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">𝑣</ci><apply id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1"><ci id="S2.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.1">′</ci></apply></apply><ci id="S2.E2.m1.3.3.3.3.3.3.1.cmml" xref="S2.E2.m1.3.3.3.3.3.3.1">𝑖</ci></apply><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.cmml"><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.1.2.1.cmml">superscript</csymbol><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><sum id="S2.E2.m1.5.5.5.5.5.5.cmml" xref="S2.E2.m1.5.5.5.5.5.5"></sum><apply id="S2.E2.m1.6.6.6.6.6.6.1.cmml" xref="S2.E2.m1.6.6.6.6.6.6.1"><eq id="S2.E2.m1.6.6.6.6.6.6.1.1.cmml" xref="S2.E2.m1.6.6.6.6.6.6.1.1"></eq><ci id="S2.E2.m1.6.6.6.6.6.6.1.2.cmml" xref="S2.E2.m1.6.6.6.6.6.6.1.2">𝑗</ci><cn id="S2.E2.m1.6.6.6.6.6.6.1.3.cmml" type="integer" xref="S2.E2.m1.6.6.6.6.6.6.1.3">1</cn></apply></apply><ci id="S2.E2.m1.7.7.7.7.7.7.1.cmml" xref="S2.E2.m1.7.7.7.7.7.7.1">𝑛</ci></apply><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.1.cmml"><times id="S2.E2.m1.35.35.1.1.1.1.1.1.1.2.cmml"></times><apply id="S2.E2.m1.8.8.8.8.8.8.cmml" xref="S2.E2.m1.8.8.8.8.8.8"><divide id="S2.E2.m1.8.8.8.8.8.8.5.cmml" xref="S2.E2.m1.8.8.8.8.8.8"></divide><apply id="S2.E2.m1.8.8.8.8.8.8.2.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2"><exp id="S2.E2.m1.8.8.8.8.8.8.1.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.1.1"></exp><apply id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.2">𝛼</ci><apply id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3"><times id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.1"></times><ci id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.2">𝑖</ci><ci id="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.2.2.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S2.E2.m1.8.8.8.8.8.8.4.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4"><apply id="S2.E2.m1.8.8.8.8.8.8.4.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.4.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3">superscript</csymbol><apply id="S2.E2.m1.8.8.8.8.8.8.4.3.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.4.3.2.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3">subscript</csymbol><sum id="S2.E2.m1.8.8.8.8.8.8.4.3.2.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.2"></sum><apply id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3"><eq id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.1"></eq><apply id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2">superscript</csymbol><ci id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.2">𝑗</ci><ci id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.2.3">′</ci></apply><cn id="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.8.8.8.8.8.8.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.8.8.8.8.8.8.4.3.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.3.3">𝑛</ci></apply><apply id="S2.E2.m1.8.8.8.8.8.8.4.2.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1"><exp id="S2.E2.m1.8.8.8.8.8.8.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.3.1"></exp><apply id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.2">𝛼</ci><apply id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3"><times id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.1"></times><ci id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.2">𝑖</ci><apply id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.1.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3">superscript</csymbol><ci id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.2.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.2">𝑗</ci><ci id="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.3.cmml" xref="S2.E2.m1.8.8.8.8.8.8.4.2.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.cmml"><times id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.1.cmml"></times><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S2.E2.m1.10.10.10.10.10.10.cmml" xref="S2.E2.m1.10.10.10.10.10.10">𝑤</ci><ci id="S2.E2.m1.11.11.11.11.11.11.1.cmml" xref="S2.E2.m1.11.11.11.11.11.11.1">𝑗</ci></apply><apply id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S2.E2.m1.12.12.12.12.12.12.cmml" xref="S2.E2.m1.12.12.12.12.12.12">𝑊</ci><ci id="S2.E2.m1.13.13.13.13.13.13.1.cmml" xref="S2.E2.m1.13.13.13.13.13.13.1">𝑉</ci></apply></apply></apply></apply></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.cmml"><eq id="S2.E2.m1.19.19.19.4.4.4.cmml" xref="S2.E2.m1.19.19.19.4.4.4"></eq><apply id="S2.E2.m1.35.35.1.1.1.2.2.4.cmml"><times id="S2.E2.m1.35.35.1.1.1.2.2.4.1.cmml"></times><ci id="S2.E2.m1.16.16.16.1.1.1a.cmml" xref="S2.E2.m1.16.16.16.1.1.1"><mtext id="S2.E2.m1.16.16.16.1.1.1.cmml" xref="S2.E2.m1.16.16.16.1.1.1">where the logits </mtext></ci><apply id="S2.E2.m1.35.35.1.1.1.2.2.4.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.4.3.1.cmml">subscript</csymbol><ci id="S2.E2.m1.17.17.17.2.2.2.cmml" xref="S2.E2.m1.17.17.17.2.2.2">𝛼</ci><apply id="S2.E2.m1.18.18.18.3.3.3.1.cmml" xref="S2.E2.m1.18.18.18.3.3.3.1"><times id="S2.E2.m1.18.18.18.3.3.3.1.1.cmml" xref="S2.E2.m1.18.18.18.3.3.3.1.1"></times><ci id="S2.E2.m1.18.18.18.3.3.3.1.2.cmml" xref="S2.E2.m1.18.18.18.3.3.3.1.2">𝑖</ci><ci id="S2.E2.m1.18.18.18.3.3.3.1.3.cmml" xref="S2.E2.m1.18.18.18.3.3.3.1.3">𝑗</ci></apply></apply></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.2.cmml"><times id="S2.E2.m1.35.35.1.1.1.2.2.2.3.cmml"></times><apply id="S2.E2.m1.20.20.20.5.5.5.cmml" xref="S2.E2.m1.20.20.20.5.5.5"><divide id="S2.E2.m1.20.20.20.5.5.5.1.cmml" xref="S2.E2.m1.20.20.20.5.5.5"></divide><cn id="S2.E2.m1.20.20.20.5.5.5.2.cmml" type="integer" xref="S2.E2.m1.20.20.20.5.5.5.2">1</cn><apply id="S2.E2.m1.20.20.20.5.5.5.3.cmml" xref="S2.E2.m1.20.20.20.5.5.5.3"><root id="S2.E2.m1.20.20.20.5.5.5.3a.cmml" xref="S2.E2.m1.20.20.20.5.5.5.3"></root><ci id="S2.E2.m1.20.20.20.5.5.5.3.2.cmml" xref="S2.E2.m1.20.20.20.5.5.5.3.2">𝑑</ci></apply></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.cmml"><times id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.1.cmml"></times><apply id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S2.E2.m1.22.22.22.7.7.7.cmml" xref="S2.E2.m1.22.22.22.7.7.7">𝑣</ci><ci id="S2.E2.m1.23.23.23.8.8.8.1.cmml" xref="S2.E2.m1.23.23.23.8.8.8.1">𝑖</ci></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S2.E2.m1.24.24.24.9.9.9.cmml" xref="S2.E2.m1.24.24.24.9.9.9">𝑊</ci><ci id="S2.E2.m1.25.25.25.10.10.10.1.cmml" xref="S2.E2.m1.25.25.25.10.10.10.1">𝑄</ci></apply></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.2.2.2.cmml">superscript</csymbol><apply id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.cmml"><times id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.1.cmml"></times><apply id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.2.1.cmml">subscript</csymbol><ci id="S2.E2.m1.28.28.28.13.13.13.cmml" xref="S2.E2.m1.28.28.28.13.13.13">𝑤</ci><ci id="S2.E2.m1.29.29.29.14.14.14.1.cmml" xref="S2.E2.m1.29.29.29.14.14.14.1">𝑗</ci></apply><apply id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E2.m1.35.35.1.1.1.2.2.2.2.1.1.1.3.1.cmml">subscript</csymbol><ci id="S2.E2.m1.30.30.30.15.15.15.cmml" xref="S2.E2.m1.30.30.30.15.15.15">𝑊</ci><ci id="S2.E2.m1.31.31.31.16.16.16.1.cmml" xref="S2.E2.m1.31.31.31.16.16.16.1">𝐾</ci></apply></apply><ci id="S2.E2.m1.33.33.33.18.18.18.1.cmml" xref="S2.E2.m1.33.33.33.18.18.18.1">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.37c">\begin{split}v^{{}^{\prime}}_{i}=\sum_{j=1}^{n}\frac{\exp(\alpha_{ij})}{\sum_{%
j^{\prime}=1}^{n}\exp(\alpha_{ij^{\prime}})}(w_{j}W_{V}),\\
\text{where the logits }\alpha_{ij}=\frac{1}{\sqrt{d}}(v_{i}W_{Q})(w_{j}W_{K})%
^{T},\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.37d">start_ROW start_CELL italic_v start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_exp ( italic_α start_POSTSUBSCRIPT italic_i italic_j start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) end_ARG ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ) , end_CELL end_ROW start_ROW start_CELL where the logits italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ) ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.10">with <math alttext="W_{Q}\in\mathbb{R}^{d\times d_{K}},W_{K}\in\mathbb{R}^{d\times d_{K}}," class="ltx_Math" display="inline" id="S2.SS1.p2.7.m1.1"><semantics id="S2.SS1.p2.7.m1.1a"><mrow id="S2.SS1.p2.7.m1.1.1.1"><mrow id="S2.SS1.p2.7.m1.1.1.1.1.2" xref="S2.SS1.p2.7.m1.1.1.1.1.3.cmml"><mrow id="S2.SS1.p2.7.m1.1.1.1.1.1.1" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.cmml"><msub id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.2" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.3" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo id="S2.SS1.p2.7.m1.1.1.1.1.1.1.1" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.3.cmml">K</mi></msub></mrow></msup></mrow><mo id="S2.SS1.p2.7.m1.1.1.1.1.2.3" xref="S2.SS1.p2.7.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.SS1.p2.7.m1.1.1.1.1.2.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.cmml"><msub id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.3" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="S2.SS1.p2.7.m1.1.1.1.1.2.2.1" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.1.cmml">∈</mo><msup id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.2.cmml">d</mi><mo id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msub id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.2" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.3" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.3.cmml">K</mi></msub></mrow></msup></mrow></mrow><mo id="S2.SS1.p2.7.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m1.1b"><apply id="S2.SS1.p2.7.m1.1.1.1.1.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.3a.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p2.7.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1"><in id="S2.SS1.p2.7.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.1"></in><apply id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3"><times id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.2">𝑑</ci><apply id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.1.1.3.3.3.3">𝐾</ci></apply></apply></apply></apply><apply id="S2.SS1.p2.7.m1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2"><in id="S2.SS1.p2.7.m1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.1"></in><apply id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.2.3">𝐾</ci></apply><apply id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.2">ℝ</ci><apply id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3"><times id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.1"></times><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.2">𝑑</ci><apply id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.2">𝑑</ci><ci id="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S2.SS1.p2.7.m1.1.1.1.1.2.2.3.3.3.3">𝐾</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m1.1c">W_{Q}\in\mathbb{R}^{d\times d_{K}},W_{K}\in\mathbb{R}^{d\times d_{K}},</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m1.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math> and <math alttext="W_{V}\in\mathbb{R}^{d\times d_{V}}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m2.1"><semantics id="S2.SS1.p2.8.m2.1a"><mrow id="S2.SS1.p2.8.m2.1.1" xref="S2.SS1.p2.8.m2.1.1.cmml"><msub id="S2.SS1.p2.8.m2.1.1.2" xref="S2.SS1.p2.8.m2.1.1.2.cmml"><mi id="S2.SS1.p2.8.m2.1.1.2.2" xref="S2.SS1.p2.8.m2.1.1.2.2.cmml">W</mi><mi id="S2.SS1.p2.8.m2.1.1.2.3" xref="S2.SS1.p2.8.m2.1.1.2.3.cmml">V</mi></msub><mo id="S2.SS1.p2.8.m2.1.1.1" xref="S2.SS1.p2.8.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p2.8.m2.1.1.3" xref="S2.SS1.p2.8.m2.1.1.3.cmml"><mi id="S2.SS1.p2.8.m2.1.1.3.2" xref="S2.SS1.p2.8.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p2.8.m2.1.1.3.3" xref="S2.SS1.p2.8.m2.1.1.3.3.cmml"><mi id="S2.SS1.p2.8.m2.1.1.3.3.2" xref="S2.SS1.p2.8.m2.1.1.3.3.2.cmml">d</mi><mo id="S2.SS1.p2.8.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p2.8.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.SS1.p2.8.m2.1.1.3.3.3" xref="S2.SS1.p2.8.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.p2.8.m2.1.1.3.3.3.2" xref="S2.SS1.p2.8.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S2.SS1.p2.8.m2.1.1.3.3.3.3" xref="S2.SS1.p2.8.m2.1.1.3.3.3.3.cmml">V</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m2.1b"><apply id="S2.SS1.p2.8.m2.1.1.cmml" xref="S2.SS1.p2.8.m2.1.1"><in id="S2.SS1.p2.8.m2.1.1.1.cmml" xref="S2.SS1.p2.8.m2.1.1.1"></in><apply id="S2.SS1.p2.8.m2.1.1.2.cmml" xref="S2.SS1.p2.8.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m2.1.1.2.1.cmml" xref="S2.SS1.p2.8.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.8.m2.1.1.2.2.cmml" xref="S2.SS1.p2.8.m2.1.1.2.2">𝑊</ci><ci id="S2.SS1.p2.8.m2.1.1.2.3.cmml" xref="S2.SS1.p2.8.m2.1.1.2.3">𝑉</ci></apply><apply id="S2.SS1.p2.8.m2.1.1.3.cmml" xref="S2.SS1.p2.8.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m2.1.1.3.1.cmml" xref="S2.SS1.p2.8.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.p2.8.m2.1.1.3.2.cmml" xref="S2.SS1.p2.8.m2.1.1.3.2">ℝ</ci><apply id="S2.SS1.p2.8.m2.1.1.3.3.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3"><times id="S2.SS1.p2.8.m2.1.1.3.3.1.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.1"></times><ci id="S2.SS1.p2.8.m2.1.1.3.3.2.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.2">𝑑</ci><apply id="S2.SS1.p2.8.m2.1.1.3.3.3.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.8.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.3.2">𝑑</ci><ci id="S2.SS1.p2.8.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.p2.8.m2.1.1.3.3.3.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m2.1c">W_{V}\in\mathbb{R}^{d\times d_{V}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m2.1d">italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> being learnable projection matrices. <math alttext="d,d_{K}" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m3.2"><semantics id="S2.SS1.p2.9.m3.2a"><mrow id="S2.SS1.p2.9.m3.2.2.1" xref="S2.SS1.p2.9.m3.2.2.2.cmml"><mi id="S2.SS1.p2.9.m3.1.1" xref="S2.SS1.p2.9.m3.1.1.cmml">d</mi><mo id="S2.SS1.p2.9.m3.2.2.1.2" xref="S2.SS1.p2.9.m3.2.2.2.cmml">,</mo><msub id="S2.SS1.p2.9.m3.2.2.1.1" xref="S2.SS1.p2.9.m3.2.2.1.1.cmml"><mi id="S2.SS1.p2.9.m3.2.2.1.1.2" xref="S2.SS1.p2.9.m3.2.2.1.1.2.cmml">d</mi><mi id="S2.SS1.p2.9.m3.2.2.1.1.3" xref="S2.SS1.p2.9.m3.2.2.1.1.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m3.2b"><list id="S2.SS1.p2.9.m3.2.2.2.cmml" xref="S2.SS1.p2.9.m3.2.2.1"><ci id="S2.SS1.p2.9.m3.1.1.cmml" xref="S2.SS1.p2.9.m3.1.1">𝑑</ci><apply id="S2.SS1.p2.9.m3.2.2.1.1.cmml" xref="S2.SS1.p2.9.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m3.2.2.1.1.1.cmml" xref="S2.SS1.p2.9.m3.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m3.2.2.1.1.2.cmml" xref="S2.SS1.p2.9.m3.2.2.1.1.2">𝑑</ci><ci id="S2.SS1.p2.9.m3.2.2.1.1.3.cmml" xref="S2.SS1.p2.9.m3.2.2.1.1.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m3.2c">d,d_{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m3.2d">italic_d , italic_d start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{V}" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m4.1"><semantics id="S2.SS1.p2.10.m4.1a"><msub id="S2.SS1.p2.10.m4.1.1" xref="S2.SS1.p2.10.m4.1.1.cmml"><mi id="S2.SS1.p2.10.m4.1.1.2" xref="S2.SS1.p2.10.m4.1.1.2.cmml">d</mi><mi id="S2.SS1.p2.10.m4.1.1.3" xref="S2.SS1.p2.10.m4.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m4.1b"><apply id="S2.SS1.p2.10.m4.1.1.cmml" xref="S2.SS1.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m4.1.1.1.cmml" xref="S2.SS1.p2.10.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.10.m4.1.1.2.cmml" xref="S2.SS1.p2.10.m4.1.1.2">𝑑</ci><ci id="S2.SS1.p2.10.m4.1.1.3.cmml" xref="S2.SS1.p2.10.m4.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m4.1c">d_{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m4.1d">italic_d start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> are the dimensions of the input, key and value respectively.</p>
</div>
<figure class="ltx_figure" id="S2.SS1.1">
<div class="ltx_block" id="S2.SS1.1.1">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_missing ltx_missing_image" id="S2.SS1.1.g1" src=""/>
<figure class="ltx_figure ltx_align_center" id="S2.F1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span> Encoder architecture</figcaption>
</figure>
</div>
</figure>
<figure class="ltx_figure" id="S2.SS1.2">
<div class="ltx_block" id="S2.SS1.2.1">
<img alt="[Uncaptioned image]" class="ltx_graphics ltx_missing ltx_missing_image" id="S2.SS1.2.g1" src=""/>
<figure class="ltx_figure ltx_align_center" id="S2.F2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> Decoder architecture</figcaption>
</figure>
</div>
</figure>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Attention augmentations</h4>
<div class="ltx_para" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.2"><cite class="ltx_cite ltx_citemacro_citet">Ke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib14" title="">2020</a>)</cite> proposed to add bias terms to the logits <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.1.m1.1"><semantics id="S2.SS1.SSS1.p1.1.m1.1a"><msub id="S2.SS1.SSS1.p1.1.m1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.1.1.2" xref="S2.SS1.SSS1.p1.1.m1.1.1.2.cmml">α</mi><mrow id="S2.SS1.SSS1.p1.1.m1.1.1.3" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.1.1.3.2" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.SSS1.p1.1.m1.1.1.3.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p1.1.m1.1.1.3.3" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.1b"><apply id="S2.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.2">𝛼</ci><apply id="S2.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.3"><times id="S2.SS1.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S2.SS1.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.E2" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2</span></a> as untied positional encoding, disentangling a mixing of token and position embeddings. We generalize this structure by allowing more biases to be added to the logits <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.2.m2.1"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><msub id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.2.cmml">α</mi><mrow id="S2.SS1.SSS1.p1.2.m2.1.1.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S2.SS1.SSS1.p1.2.m2.1.1.3.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><apply id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.2">𝛼</ci><apply id="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3"><times id="S2.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S2.SS1.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.2.m2.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.E2" title="In 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS1.p2">
<p class="ltx_p" id="S2.SS1.SSS1.p2.1">Specifically, we explore augmenting two attention components in the transformer architecture by making the following extensions:</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.2"><span class="ltx_text ltx_font_italic" id="S2.I1.i1.p1.2.1">For <span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.2.1.1">Source-to-source self-attention</span> at each encoder layer</span>: We integrate embeddings from a pre-trained BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib8" title="">2019</a>)</cite> model. This adds rich contextual information as BERT models are pre-trained on large monolingual data and perform well on language understanding tasks. We also add positional encodings at this level, similar to <cite class="ltx_cite ltx_citemacro_cite">Ke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib14" title="">2020</a>)</cite>. Therefore, the logits <math alttext="\alpha_{ij}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml">α</mi><mrow id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S2.I1.i1.p1.1.m1.1.1.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">𝛼</ci><apply id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\alpha_{ij}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> at encoder layer <math alttext="l" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><mi id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><ci id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">italic_l</annotation></semantics></math> become:</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="S2.I1.ix1.p1">
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{ij}=\frac{1}{\sqrt{3d}}[" class="ltx_math_unparsed" display="inline" id="S2.E3X.2.1.1.m1.1"><semantics id="S2.E3X.2.1.1.m1.1a"><mrow id="S2.E3X.2.1.1.m1.1b"><msub id="S2.E3X.2.1.1.m1.1.1"><mi id="S2.E3X.2.1.1.m1.1.1.2">α</mi><mrow id="S2.E3X.2.1.1.m1.1.1.3"><mi id="S2.E3X.2.1.1.m1.1.1.3.2">i</mi><mo id="S2.E3X.2.1.1.m1.1.1.3.1">⁢</mo><mi id="S2.E3X.2.1.1.m1.1.1.3.3">j</mi></mrow></msub><mo id="S2.E3X.2.1.1.m1.1.2">=</mo><mstyle displaystyle="true" id="S2.E3X.2.1.1.m1.1.3"><mfrac id="S2.E3X.2.1.1.m1.1.3a"><mn id="S2.E3X.2.1.1.m1.1.3.2">1</mn><msqrt id="S2.E3X.2.1.1.m1.1.3.3"><mrow id="S2.E3X.2.1.1.m1.1.3.3.2"><mn id="S2.E3X.2.1.1.m1.1.3.3.2.2">3</mn><mo id="S2.E3X.2.1.1.m1.1.3.3.2.1">⁢</mo><mi id="S2.E3X.2.1.1.m1.1.3.3.2.3">d</mi></mrow></msqrt></mfrac></mstyle><mo id="S2.E3X.2.1.1.m1.1.4" stretchy="false">[</mo></mrow><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.1c">\displaystyle\alpha_{ij}=\frac{1}{\sqrt{3d}}[</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG square-root start_ARG 3 italic_d end_ARG end_ARG [</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle(x_{i}^{(l)}W_{Q}^{(l)})(x_{j}^{(l)}W_{K}^{(l)})^{T}" class="ltx_Math" display="inline" id="S2.E3X.3.2.2.m1.6"><semantics id="S2.E3X.3.2.2.m1.6a"><mrow id="S2.E3X.3.2.2.m1.6.6" xref="S2.E3X.3.2.2.m1.6.6.cmml"><mrow id="S2.E3X.3.2.2.m1.5.5.1.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.cmml"><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.cmml">(</mo><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.cmml"><msubsup id="S2.E3X.3.2.2.m1.5.5.1.1.1.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.2.cmml">x</mi><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.3.cmml">i</mi><mrow id="S2.E3X.3.2.2.m1.1.1.1.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.cmml"><mo id="S2.E3X.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">(</mo><mi id="S2.E3X.3.2.2.m1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.E3X.3.2.2.m1.5.5.1.1.1.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E3X.3.2.2.m1.5.5.1.1.1.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.2.cmml">W</mi><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.3.cmml">Q</mi><mrow id="S2.E3X.3.2.2.m1.2.2.1.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.cmml"><mo id="S2.E3X.3.2.2.m1.2.2.1.3.1" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.cmml">(</mo><mi id="S2.E3X.3.2.2.m1.2.2.1.1" xref="S2.E3X.3.2.2.m1.2.2.1.1.cmml">l</mi><mo id="S2.E3X.3.2.2.m1.2.2.1.3.2" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E3X.3.2.2.m1.5.5.1.1.3" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.cmml">)</mo></mrow><mo id="S2.E3X.3.2.2.m1.6.6.3" xref="S2.E3X.3.2.2.m1.6.6.3.cmml">⁢</mo><msup id="S2.E3X.3.2.2.m1.6.6.2" xref="S2.E3X.3.2.2.m1.6.6.2.cmml"><mrow id="S2.E3X.3.2.2.m1.6.6.2.1.1" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.cmml"><mo id="S2.E3X.3.2.2.m1.6.6.2.1.1.2" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.E3X.3.2.2.m1.6.6.2.1.1.1" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.cmml"><msubsup id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.cmml"><mi id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.2" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.2.cmml">x</mi><mi id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.3" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.3.cmml">j</mi><mrow id="S2.E3X.3.2.2.m1.3.3.1.3" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.cmml"><mo id="S2.E3X.3.2.2.m1.3.3.1.3.1" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.cmml">(</mo><mi id="S2.E3X.3.2.2.m1.3.3.1.1" xref="S2.E3X.3.2.2.m1.3.3.1.1.cmml">l</mi><mo id="S2.E3X.3.2.2.m1.3.3.1.3.2" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.1" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.cmml"><mi id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.2" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.2.cmml">W</mi><mi id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.3" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.3.cmml">K</mi><mrow id="S2.E3X.3.2.2.m1.4.4.1.3" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.cmml"><mo id="S2.E3X.3.2.2.m1.4.4.1.3.1" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.cmml">(</mo><mi id="S2.E3X.3.2.2.m1.4.4.1.1" xref="S2.E3X.3.2.2.m1.4.4.1.1.cmml">l</mi><mo id="S2.E3X.3.2.2.m1.4.4.1.3.2" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E3X.3.2.2.m1.6.6.2.1.1.3" stretchy="false" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E3X.3.2.2.m1.6.6.2.3" xref="S2.E3X.3.2.2.m1.6.6.2.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.6b"><apply id="S2.E3X.3.2.2.m1.6.6.cmml" xref="S2.E3X.3.2.2.m1.6.6"><times id="S2.E3X.3.2.2.m1.6.6.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.3"></times><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1"><times id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1"></times><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.2">𝑥</ci><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E3X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.2">𝑊</ci><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.3.2.3">𝑄</ci></apply><ci id="S2.E3X.3.2.2.m1.2.2.1.1.cmml" xref="S2.E3X.3.2.2.m1.2.2.1.1">𝑙</ci></apply></apply><apply id="S2.E3X.3.2.2.m1.6.6.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.2.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1"><times id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.1"></times><apply id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.2">𝑥</ci><ci id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.2.2.3">𝑗</ci></apply><ci id="S2.E3X.3.2.2.m1.3.3.1.1.cmml" xref="S2.E3X.3.2.2.m1.3.3.1.1">𝑙</ci></apply><apply id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.2">𝑊</ci><ci id="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.1.1.1.3.2.3">𝐾</ci></apply><ci id="S2.E3X.3.2.2.m1.4.4.1.1.cmml" xref="S2.E3X.3.2.2.m1.4.4.1.1">𝑙</ci></apply></apply><ci id="S2.E3X.3.2.2.m1.6.6.2.3.cmml" xref="S2.E3X.3.2.2.m1.6.6.2.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.6c">\displaystyle(x_{i}^{(l)}W_{Q}^{(l)})(x_{j}^{(l)}W_{K}^{(l)})^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.6d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+(p_{i}U_{Q})(p_{j}U_{K})^{T}+r_{j-i}" class="ltx_Math" display="inline" id="S2.E3Xa.2.1.1.m1.2"><semantics id="S2.E3Xa.2.1.1.m1.2a"><mrow id="S2.E3Xa.2.1.1.m1.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.cmml"><mrow id="S2.E3Xa.2.1.1.m1.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.cmml"><mo id="S2.E3Xa.2.1.1.m1.2.2.2a" xref="S2.E3Xa.2.1.1.m1.2.2.2.cmml">+</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.cmml"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">U</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub></mrow><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S2.E3Xa.2.1.1.m1.2.2.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.cmml"><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml"><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml"><msub id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.cmml">p</mi><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.cmml">j</mi></msub><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.cmml">U</mi><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msub></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.3.cmml">+</mo><msub id="S2.E3Xa.2.1.1.m1.2.2.4" xref="S2.E3Xa.2.1.1.m1.2.2.4.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.4.2" xref="S2.E3Xa.2.1.1.m1.2.2.4.2.cmml">r</mi><mrow id="S2.E3Xa.2.1.1.m1.2.2.4.3" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.4.3.2" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.2.cmml">j</mi><mo id="S2.E3Xa.2.1.1.m1.2.2.4.3.1" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.1.cmml">−</mo><mi id="S2.E3Xa.2.1.1.m1.2.2.4.3.3" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.3.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.2b"><apply id="S2.E3Xa.2.1.1.m1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2"><plus id="S2.E3Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.3"></plus><apply id="S2.E3Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2"><plus id="S2.E3Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2"></plus><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2"><times id="S2.E3Xa.2.1.1.m1.2.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.3"></times><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></times><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝑈</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1"><times id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1"></times><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2">𝑝</ci><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2">𝑈</ci><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3">𝐾</ci></apply></apply><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3">𝑇</ci></apply></apply></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.4.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.4.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.2.2.4.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4.2">𝑟</ci><apply id="S2.E3Xa.2.1.1.m1.2.2.4.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4.3"><minus id="S2.E3Xa.2.1.1.m1.2.2.4.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.1"></minus><ci id="S2.E3Xa.2.1.1.m1.2.2.4.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.2">𝑗</ci><ci id="S2.E3Xa.2.1.1.m1.2.2.4.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.2c">\displaystyle+(p_{i}U_{Q})(p_{j}U_{K})^{T}+r_{j-i}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.2d">+ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ) ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_r start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+(x_{i}^{(l)}V_{Q}^{(l)})(b_{j}V_{K}^{(l)})^{T}]," class="ltx_math_unparsed" display="inline" id="S2.E3Xb.2.1.1.m1.3"><semantics id="S2.E3Xb.2.1.1.m1.3a"><mrow id="S2.E3Xb.2.1.1.m1.3b"><mo id="S2.E3Xb.2.1.1.m1.3.4">+</mo><mrow id="S2.E3Xb.2.1.1.m1.3.5"><mo id="S2.E3Xb.2.1.1.m1.3.5.1" stretchy="false">(</mo><msubsup id="S2.E3Xb.2.1.1.m1.3.5.2"><mi id="S2.E3Xb.2.1.1.m1.3.5.2.2.2">x</mi><mi id="S2.E3Xb.2.1.1.m1.3.5.2.2.3">i</mi><mrow id="S2.E3Xb.2.1.1.m1.1.1.1.3"><mo id="S2.E3Xb.2.1.1.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="S2.E3Xb.2.1.1.m1.1.1.1.1">l</mi><mo id="S2.E3Xb.2.1.1.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><msubsup id="S2.E3Xb.2.1.1.m1.3.5.3"><mi id="S2.E3Xb.2.1.1.m1.3.5.3.2.2">V</mi><mi id="S2.E3Xb.2.1.1.m1.3.5.3.2.3">Q</mi><mrow id="S2.E3Xb.2.1.1.m1.2.2.1.3"><mo id="S2.E3Xb.2.1.1.m1.2.2.1.3.1" stretchy="false">(</mo><mi id="S2.E3Xb.2.1.1.m1.2.2.1.1">l</mi><mo id="S2.E3Xb.2.1.1.m1.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S2.E3Xb.2.1.1.m1.3.5.4" stretchy="false">)</mo></mrow><msup id="S2.E3Xb.2.1.1.m1.3.6"><mrow id="S2.E3Xb.2.1.1.m1.3.6.2"><mo id="S2.E3Xb.2.1.1.m1.3.6.2.1" stretchy="false">(</mo><msub id="S2.E3Xb.2.1.1.m1.3.6.2.2"><mi id="S2.E3Xb.2.1.1.m1.3.6.2.2.2">b</mi><mi id="S2.E3Xb.2.1.1.m1.3.6.2.2.3">j</mi></msub><msubsup id="S2.E3Xb.2.1.1.m1.3.6.2.3"><mi id="S2.E3Xb.2.1.1.m1.3.6.2.3.2.2">V</mi><mi id="S2.E3Xb.2.1.1.m1.3.6.2.3.2.3">K</mi><mrow id="S2.E3Xb.2.1.1.m1.3.3.1.3"><mo id="S2.E3Xb.2.1.1.m1.3.3.1.3.1" stretchy="false">(</mo><mi id="S2.E3Xb.2.1.1.m1.3.3.1.1">l</mi><mo id="S2.E3Xb.2.1.1.m1.3.3.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S2.E3Xb.2.1.1.m1.3.6.2.4" stretchy="false">)</mo></mrow><mi id="S2.E3Xb.2.1.1.m1.3.6.3">T</mi></msup><mo id="S2.E3Xb.2.1.1.m1.3.7" stretchy="false">]</mo><mo id="S2.E3Xb.2.1.1.m1.3.8">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E3Xb.2.1.1.m1.3c">\displaystyle+(x_{i}^{(l)}V_{Q}^{(l)})(b_{j}V_{K}^{(l)})^{T}],</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xb.2.1.1.m1.3d">+ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ( italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.I1.ix1.p1.12">where <math alttext="x_{i}^{(l)}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.1.m1.1"><semantics id="S2.I1.ix1.p1.1.m1.1a"><msubsup id="S2.I1.ix1.p1.1.m1.1.2" xref="S2.I1.ix1.p1.1.m1.1.2.cmml"><mi id="S2.I1.ix1.p1.1.m1.1.2.2.2" xref="S2.I1.ix1.p1.1.m1.1.2.2.2.cmml">x</mi><mi id="S2.I1.ix1.p1.1.m1.1.2.2.3" xref="S2.I1.ix1.p1.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.I1.ix1.p1.1.m1.1.1.1.3" xref="S2.I1.ix1.p1.1.m1.1.2.cmml"><mo id="S2.I1.ix1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.1.m1.1.2.cmml">(</mo><mi id="S2.I1.ix1.p1.1.m1.1.1.1.1" xref="S2.I1.ix1.p1.1.m1.1.1.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.1.m1.1b"><apply id="S2.I1.ix1.p1.1.m1.1.2.cmml" xref="S2.I1.ix1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.1.m1.1.2.1.cmml" xref="S2.I1.ix1.p1.1.m1.1.2">superscript</csymbol><apply id="S2.I1.ix1.p1.1.m1.1.2.2.cmml" xref="S2.I1.ix1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.1.m1.1.2.2.1.cmml" xref="S2.I1.ix1.p1.1.m1.1.2">subscript</csymbol><ci id="S2.I1.ix1.p1.1.m1.1.2.2.2.cmml" xref="S2.I1.ix1.p1.1.m1.1.2.2.2">𝑥</ci><ci id="S2.I1.ix1.p1.1.m1.1.2.2.3.cmml" xref="S2.I1.ix1.p1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.I1.ix1.p1.1.m1.1.1.1.1.cmml" xref="S2.I1.ix1.p1.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.1.m1.1c">x_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="x_{j}^{(l)}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.2.m2.1"><semantics id="S2.I1.ix1.p1.2.m2.1a"><msubsup id="S2.I1.ix1.p1.2.m2.1.2" xref="S2.I1.ix1.p1.2.m2.1.2.cmml"><mi id="S2.I1.ix1.p1.2.m2.1.2.2.2" xref="S2.I1.ix1.p1.2.m2.1.2.2.2.cmml">x</mi><mi id="S2.I1.ix1.p1.2.m2.1.2.2.3" xref="S2.I1.ix1.p1.2.m2.1.2.2.3.cmml">j</mi><mrow id="S2.I1.ix1.p1.2.m2.1.1.1.3" xref="S2.I1.ix1.p1.2.m2.1.2.cmml"><mo id="S2.I1.ix1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.2.m2.1.2.cmml">(</mo><mi id="S2.I1.ix1.p1.2.m2.1.1.1.1" xref="S2.I1.ix1.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.2.m2.1b"><apply id="S2.I1.ix1.p1.2.m2.1.2.cmml" xref="S2.I1.ix1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.2.m2.1.2.1.cmml" xref="S2.I1.ix1.p1.2.m2.1.2">superscript</csymbol><apply id="S2.I1.ix1.p1.2.m2.1.2.2.cmml" xref="S2.I1.ix1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.2.m2.1.2.2.1.cmml" xref="S2.I1.ix1.p1.2.m2.1.2">subscript</csymbol><ci id="S2.I1.ix1.p1.2.m2.1.2.2.2.cmml" xref="S2.I1.ix1.p1.2.m2.1.2.2.2">𝑥</ci><ci id="S2.I1.ix1.p1.2.m2.1.2.2.3.cmml" xref="S2.I1.ix1.p1.2.m2.1.2.2.3">𝑗</ci></apply><ci id="S2.I1.ix1.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.ix1.p1.2.m2.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.2.m2.1c">x_{j}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> are hidden representations of source tokens at positions <math alttext="i" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.3.m3.1"><semantics id="S2.I1.ix1.p1.3.m3.1a"><mi id="S2.I1.ix1.p1.3.m3.1.1" xref="S2.I1.ix1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.3.m3.1b"><ci id="S2.I1.ix1.p1.3.m3.1.1.cmml" xref="S2.I1.ix1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.4.m4.1"><semantics id="S2.I1.ix1.p1.4.m4.1a"><mi id="S2.I1.ix1.p1.4.m4.1.1" xref="S2.I1.ix1.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.4.m4.1b"><ci id="S2.I1.ix1.p1.4.m4.1.1.cmml" xref="S2.I1.ix1.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.4.m4.1d">italic_j</annotation></semantics></math> respectively of the encoder layer <math alttext="l" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.5.m5.1"><semantics id="S2.I1.ix1.p1.5.m5.1a"><mi id="S2.I1.ix1.p1.5.m5.1.1" xref="S2.I1.ix1.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.5.m5.1b"><ci id="S2.I1.ix1.p1.5.m5.1.1.cmml" xref="S2.I1.ix1.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.5.m5.1d">italic_l</annotation></semantics></math>; <math alttext="p_{i}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.6.m6.1"><semantics id="S2.I1.ix1.p1.6.m6.1a"><msub id="S2.I1.ix1.p1.6.m6.1.1" xref="S2.I1.ix1.p1.6.m6.1.1.cmml"><mi id="S2.I1.ix1.p1.6.m6.1.1.2" xref="S2.I1.ix1.p1.6.m6.1.1.2.cmml">p</mi><mi id="S2.I1.ix1.p1.6.m6.1.1.3" xref="S2.I1.ix1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.6.m6.1b"><apply id="S2.I1.ix1.p1.6.m6.1.1.cmml" xref="S2.I1.ix1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.6.m6.1.1.1.cmml" xref="S2.I1.ix1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.I1.ix1.p1.6.m6.1.1.2.cmml" xref="S2.I1.ix1.p1.6.m6.1.1.2">𝑝</ci><ci id="S2.I1.ix1.p1.6.m6.1.1.3.cmml" xref="S2.I1.ix1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.6.m6.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="p_{j}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.7.m7.1"><semantics id="S2.I1.ix1.p1.7.m7.1a"><msub id="S2.I1.ix1.p1.7.m7.1.1" xref="S2.I1.ix1.p1.7.m7.1.1.cmml"><mi id="S2.I1.ix1.p1.7.m7.1.1.2" xref="S2.I1.ix1.p1.7.m7.1.1.2.cmml">p</mi><mi id="S2.I1.ix1.p1.7.m7.1.1.3" xref="S2.I1.ix1.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.7.m7.1b"><apply id="S2.I1.ix1.p1.7.m7.1.1.cmml" xref="S2.I1.ix1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.7.m7.1.1.1.cmml" xref="S2.I1.ix1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.I1.ix1.p1.7.m7.1.1.2.cmml" xref="S2.I1.ix1.p1.7.m7.1.1.2">𝑝</ci><ci id="S2.I1.ix1.p1.7.m7.1.1.3.cmml" xref="S2.I1.ix1.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.7.m7.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.7.m7.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are absolute position embeddings; <math alttext="r_{j-i}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.8.m8.1"><semantics id="S2.I1.ix1.p1.8.m8.1a"><msub id="S2.I1.ix1.p1.8.m8.1.1" xref="S2.I1.ix1.p1.8.m8.1.1.cmml"><mi id="S2.I1.ix1.p1.8.m8.1.1.2" xref="S2.I1.ix1.p1.8.m8.1.1.2.cmml">r</mi><mrow id="S2.I1.ix1.p1.8.m8.1.1.3" xref="S2.I1.ix1.p1.8.m8.1.1.3.cmml"><mi id="S2.I1.ix1.p1.8.m8.1.1.3.2" xref="S2.I1.ix1.p1.8.m8.1.1.3.2.cmml">j</mi><mo id="S2.I1.ix1.p1.8.m8.1.1.3.1" xref="S2.I1.ix1.p1.8.m8.1.1.3.1.cmml">−</mo><mi id="S2.I1.ix1.p1.8.m8.1.1.3.3" xref="S2.I1.ix1.p1.8.m8.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.8.m8.1b"><apply id="S2.I1.ix1.p1.8.m8.1.1.cmml" xref="S2.I1.ix1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.8.m8.1.1.1.cmml" xref="S2.I1.ix1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.I1.ix1.p1.8.m8.1.1.2.cmml" xref="S2.I1.ix1.p1.8.m8.1.1.2">𝑟</ci><apply id="S2.I1.ix1.p1.8.m8.1.1.3.cmml" xref="S2.I1.ix1.p1.8.m8.1.1.3"><minus id="S2.I1.ix1.p1.8.m8.1.1.3.1.cmml" xref="S2.I1.ix1.p1.8.m8.1.1.3.1"></minus><ci id="S2.I1.ix1.p1.8.m8.1.1.3.2.cmml" xref="S2.I1.ix1.p1.8.m8.1.1.3.2">𝑗</ci><ci id="S2.I1.ix1.p1.8.m8.1.1.3.3.cmml" xref="S2.I1.ix1.p1.8.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.8.m8.1c">r_{j-i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.8.m8.1d">italic_r start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a relative position embedding; <math alttext="b_{j}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.9.m9.1"><semantics id="S2.I1.ix1.p1.9.m9.1a"><msub id="S2.I1.ix1.p1.9.m9.1.1" xref="S2.I1.ix1.p1.9.m9.1.1.cmml"><mi id="S2.I1.ix1.p1.9.m9.1.1.2" xref="S2.I1.ix1.p1.9.m9.1.1.2.cmml">b</mi><mi id="S2.I1.ix1.p1.9.m9.1.1.3" xref="S2.I1.ix1.p1.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.9.m9.1b"><apply id="S2.I1.ix1.p1.9.m9.1.1.cmml" xref="S2.I1.ix1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.9.m9.1.1.1.cmml" xref="S2.I1.ix1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.I1.ix1.p1.9.m9.1.1.2.cmml" xref="S2.I1.ix1.p1.9.m9.1.1.2">𝑏</ci><ci id="S2.I1.ix1.p1.9.m9.1.1.3.cmml" xref="S2.I1.ix1.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.9.m9.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.9.m9.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is a pre-trained BERT embedding of token at position <math alttext="j" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.10.m10.1"><semantics id="S2.I1.ix1.p1.10.m10.1a"><mi id="S2.I1.ix1.p1.10.m10.1.1" xref="S2.I1.ix1.p1.10.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.10.m10.1b"><ci id="S2.I1.ix1.p1.10.m10.1.1.cmml" xref="S2.I1.ix1.p1.10.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.10.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.10.m10.1d">italic_j</annotation></semantics></math> and <math alttext="W_{Q}^{(l)},W_{K}^{(l)},U_{Q},U_{K},V_{Q}^{(l)}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.11.m11.8"><semantics id="S2.I1.ix1.p1.11.m11.8a"><mrow id="S2.I1.ix1.p1.11.m11.8.8.5" xref="S2.I1.ix1.p1.11.m11.8.8.6.cmml"><msubsup id="S2.I1.ix1.p1.11.m11.4.4.1.1" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.cmml"><mi id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.2" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.2.2.cmml">W</mi><mi id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.3" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.2.3.cmml">Q</mi><mrow id="S2.I1.ix1.p1.11.m11.1.1.1.3" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.cmml"><mo id="S2.I1.ix1.p1.11.m11.1.1.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.cmml">(</mo><mi id="S2.I1.ix1.p1.11.m11.1.1.1.1" xref="S2.I1.ix1.p1.11.m11.1.1.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.11.m11.1.1.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.I1.ix1.p1.11.m11.8.8.5.6" xref="S2.I1.ix1.p1.11.m11.8.8.6.cmml">,</mo><msubsup id="S2.I1.ix1.p1.11.m11.5.5.2.2" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.cmml"><mi id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.2" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.2.2.cmml">W</mi><mi id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.3" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.2.3.cmml">K</mi><mrow id="S2.I1.ix1.p1.11.m11.2.2.1.3" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.cmml"><mo id="S2.I1.ix1.p1.11.m11.2.2.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.cmml">(</mo><mi id="S2.I1.ix1.p1.11.m11.2.2.1.1" xref="S2.I1.ix1.p1.11.m11.2.2.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.11.m11.2.2.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.I1.ix1.p1.11.m11.8.8.5.7" xref="S2.I1.ix1.p1.11.m11.8.8.6.cmml">,</mo><msub id="S2.I1.ix1.p1.11.m11.6.6.3.3" xref="S2.I1.ix1.p1.11.m11.6.6.3.3.cmml"><mi id="S2.I1.ix1.p1.11.m11.6.6.3.3.2" xref="S2.I1.ix1.p1.11.m11.6.6.3.3.2.cmml">U</mi><mi id="S2.I1.ix1.p1.11.m11.6.6.3.3.3" xref="S2.I1.ix1.p1.11.m11.6.6.3.3.3.cmml">Q</mi></msub><mo id="S2.I1.ix1.p1.11.m11.8.8.5.8" xref="S2.I1.ix1.p1.11.m11.8.8.6.cmml">,</mo><msub id="S2.I1.ix1.p1.11.m11.7.7.4.4" xref="S2.I1.ix1.p1.11.m11.7.7.4.4.cmml"><mi id="S2.I1.ix1.p1.11.m11.7.7.4.4.2" xref="S2.I1.ix1.p1.11.m11.7.7.4.4.2.cmml">U</mi><mi id="S2.I1.ix1.p1.11.m11.7.7.4.4.3" xref="S2.I1.ix1.p1.11.m11.7.7.4.4.3.cmml">K</mi></msub><mo id="S2.I1.ix1.p1.11.m11.8.8.5.9" xref="S2.I1.ix1.p1.11.m11.8.8.6.cmml">,</mo><msubsup id="S2.I1.ix1.p1.11.m11.8.8.5.5" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.cmml"><mi id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.2" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.2.2.cmml">V</mi><mi id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.3" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.2.3.cmml">Q</mi><mrow id="S2.I1.ix1.p1.11.m11.3.3.1.3" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.cmml"><mo id="S2.I1.ix1.p1.11.m11.3.3.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.cmml">(</mo><mi id="S2.I1.ix1.p1.11.m11.3.3.1.1" xref="S2.I1.ix1.p1.11.m11.3.3.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.11.m11.3.3.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.11.m11.8b"><list id="S2.I1.ix1.p1.11.m11.8.8.6.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5"><apply id="S2.I1.ix1.p1.11.m11.4.4.1.1.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.4.4.1.1.1.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1">superscript</csymbol><apply id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.1.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1">subscript</csymbol><ci id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.2.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.2.2">𝑊</ci><ci id="S2.I1.ix1.p1.11.m11.4.4.1.1.2.3.cmml" xref="S2.I1.ix1.p1.11.m11.4.4.1.1.2.3">𝑄</ci></apply><ci id="S2.I1.ix1.p1.11.m11.1.1.1.1.cmml" xref="S2.I1.ix1.p1.11.m11.1.1.1.1">𝑙</ci></apply><apply id="S2.I1.ix1.p1.11.m11.5.5.2.2.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.5.5.2.2.1.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2">superscript</csymbol><apply id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.1.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2">subscript</csymbol><ci id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.2.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.2.2">𝑊</ci><ci id="S2.I1.ix1.p1.11.m11.5.5.2.2.2.3.cmml" xref="S2.I1.ix1.p1.11.m11.5.5.2.2.2.3">𝐾</ci></apply><ci id="S2.I1.ix1.p1.11.m11.2.2.1.1.cmml" xref="S2.I1.ix1.p1.11.m11.2.2.1.1">𝑙</ci></apply><apply id="S2.I1.ix1.p1.11.m11.6.6.3.3.cmml" xref="S2.I1.ix1.p1.11.m11.6.6.3.3"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.6.6.3.3.1.cmml" xref="S2.I1.ix1.p1.11.m11.6.6.3.3">subscript</csymbol><ci id="S2.I1.ix1.p1.11.m11.6.6.3.3.2.cmml" xref="S2.I1.ix1.p1.11.m11.6.6.3.3.2">𝑈</ci><ci id="S2.I1.ix1.p1.11.m11.6.6.3.3.3.cmml" xref="S2.I1.ix1.p1.11.m11.6.6.3.3.3">𝑄</ci></apply><apply id="S2.I1.ix1.p1.11.m11.7.7.4.4.cmml" xref="S2.I1.ix1.p1.11.m11.7.7.4.4"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.7.7.4.4.1.cmml" xref="S2.I1.ix1.p1.11.m11.7.7.4.4">subscript</csymbol><ci id="S2.I1.ix1.p1.11.m11.7.7.4.4.2.cmml" xref="S2.I1.ix1.p1.11.m11.7.7.4.4.2">𝑈</ci><ci id="S2.I1.ix1.p1.11.m11.7.7.4.4.3.cmml" xref="S2.I1.ix1.p1.11.m11.7.7.4.4.3">𝐾</ci></apply><apply id="S2.I1.ix1.p1.11.m11.8.8.5.5.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.8.8.5.5.1.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5">superscript</csymbol><apply id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.1.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5">subscript</csymbol><ci id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.2.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.2.2">𝑉</ci><ci id="S2.I1.ix1.p1.11.m11.8.8.5.5.2.3.cmml" xref="S2.I1.ix1.p1.11.m11.8.8.5.5.2.3">𝑄</ci></apply><ci id="S2.I1.ix1.p1.11.m11.3.3.1.1.cmml" xref="S2.I1.ix1.p1.11.m11.3.3.1.1">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.11.m11.8c">W_{Q}^{(l)},W_{K}^{(l)},U_{Q},U_{K},V_{Q}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.11.m11.8d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="V_{K}^{(l)}" class="ltx_Math" display="inline" id="S2.I1.ix1.p1.12.m12.1"><semantics id="S2.I1.ix1.p1.12.m12.1a"><msubsup id="S2.I1.ix1.p1.12.m12.1.2" xref="S2.I1.ix1.p1.12.m12.1.2.cmml"><mi id="S2.I1.ix1.p1.12.m12.1.2.2.2" xref="S2.I1.ix1.p1.12.m12.1.2.2.2.cmml">V</mi><mi id="S2.I1.ix1.p1.12.m12.1.2.2.3" xref="S2.I1.ix1.p1.12.m12.1.2.2.3.cmml">K</mi><mrow id="S2.I1.ix1.p1.12.m12.1.1.1.3" xref="S2.I1.ix1.p1.12.m12.1.2.cmml"><mo id="S2.I1.ix1.p1.12.m12.1.1.1.3.1" stretchy="false" xref="S2.I1.ix1.p1.12.m12.1.2.cmml">(</mo><mi id="S2.I1.ix1.p1.12.m12.1.1.1.1" xref="S2.I1.ix1.p1.12.m12.1.1.1.1.cmml">l</mi><mo id="S2.I1.ix1.p1.12.m12.1.1.1.3.2" stretchy="false" xref="S2.I1.ix1.p1.12.m12.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.ix1.p1.12.m12.1b"><apply id="S2.I1.ix1.p1.12.m12.1.2.cmml" xref="S2.I1.ix1.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.12.m12.1.2.1.cmml" xref="S2.I1.ix1.p1.12.m12.1.2">superscript</csymbol><apply id="S2.I1.ix1.p1.12.m12.1.2.2.cmml" xref="S2.I1.ix1.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S2.I1.ix1.p1.12.m12.1.2.2.1.cmml" xref="S2.I1.ix1.p1.12.m12.1.2">subscript</csymbol><ci id="S2.I1.ix1.p1.12.m12.1.2.2.2.cmml" xref="S2.I1.ix1.p1.12.m12.1.2.2.2">𝑉</ci><ci id="S2.I1.ix1.p1.12.m12.1.2.2.3.cmml" xref="S2.I1.ix1.p1.12.m12.1.2.2.3">𝐾</ci></apply><ci id="S2.I1.ix1.p1.12.m12.1.1.1.1.cmml" xref="S2.I1.ix1.p1.12.m12.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.ix1.p1.12.m12.1c">V_{K}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.ix1.p1.12.m12.1d">italic_V start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable projection matrices. We note that this formulation requires the source encoder to match the same token vocabulary as the BERT embedding model.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.2"><span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.1.1">For <span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1.1">target-to-source cross-attention</span> at each decoder layer <math alttext="l" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.1.m1.1"><semantics id="S2.I1.i2.p1.1.1.m1.1a"><mi id="S2.I1.i2.p1.1.1.m1.1.1" xref="S2.I1.i2.p1.1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.1.m1.1b"><ci id="S2.I1.i2.p1.1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.1.m1.1d">italic_l</annotation></semantics></math></span>, we also augment the attention logits with pre-trained BERT embeddings of the source sequence. Additionally, we propose a new type of embedding: <span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.2.2">cross-positional embeddings</span>. These are embeddings that align target sequence positions to input sequence positions. Their role can be thought as of learning word order relationships between source and target languages. Their formulation is closely similar to the untied positional encoding proposed by <cite class="ltx_cite ltx_citemacro_cite">Ke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib14" title="">2020</a>)</cite>, but they cross from target to source positions, thus, we name them cross-positional (XPOS) encodings. The attention logits <math alttext="\alpha_{ij}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m1.1"><semantics id="S2.I1.i2.p1.2.m1.1a"><msubsup id="S2.I1.i2.p1.2.m1.1.1" xref="S2.I1.i2.p1.2.m1.1.1.cmml"><mi id="S2.I1.i2.p1.2.m1.1.1.2.2" xref="S2.I1.i2.p1.2.m1.1.1.2.2.cmml">α</mi><mrow id="S2.I1.i2.p1.2.m1.1.1.2.3" xref="S2.I1.i2.p1.2.m1.1.1.2.3.cmml"><mi id="S2.I1.i2.p1.2.m1.1.1.2.3.2" xref="S2.I1.i2.p1.2.m1.1.1.2.3.2.cmml">i</mi><mo id="S2.I1.i2.p1.2.m1.1.1.2.3.1" xref="S2.I1.i2.p1.2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.2.m1.1.1.2.3.3" xref="S2.I1.i2.p1.2.m1.1.1.2.3.3.cmml">j</mi></mrow><msup id="S2.I1.i2.p1.2.m1.1.1.3" xref="S2.I1.i2.p1.2.m1.1.1.3.cmml"><mi id="S2.I1.i2.p1.2.m1.1.1.3a" xref="S2.I1.i2.p1.2.m1.1.1.3.cmml"></mi><mo id="S2.I1.i2.p1.2.m1.1.1.3.1" xref="S2.I1.i2.p1.2.m1.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m1.1b"><apply id="S2.I1.i2.p1.2.m1.1.1.cmml" xref="S2.I1.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m1.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.2.m1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m1.1.1.2.1.cmml" xref="S2.I1.i2.p1.2.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.2.m1.1.1.2.2.cmml" xref="S2.I1.i2.p1.2.m1.1.1.2.2">𝛼</ci><apply id="S2.I1.i2.p1.2.m1.1.1.2.3.cmml" xref="S2.I1.i2.p1.2.m1.1.1.2.3"><times id="S2.I1.i2.p1.2.m1.1.1.2.3.1.cmml" xref="S2.I1.i2.p1.2.m1.1.1.2.3.1"></times><ci id="S2.I1.i2.p1.2.m1.1.1.2.3.2.cmml" xref="S2.I1.i2.p1.2.m1.1.1.2.3.2">𝑖</ci><ci id="S2.I1.i2.p1.2.m1.1.1.2.3.3.cmml" xref="S2.I1.i2.p1.2.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.I1.i2.p1.2.m1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m1.1.1.3"><ci id="S2.I1.i2.p1.2.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.2.m1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m1.1c">\alpha_{ij}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> at this level thus become:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{ij}^{{}^{\prime}}=\frac{1}{\sqrt{3d}}[" class="ltx_math_unparsed" display="inline" id="S2.E4X.2.1.1.m1.1"><semantics id="S2.E4X.2.1.1.m1.1a"><mrow id="S2.E4X.2.1.1.m1.1b"><msubsup id="S2.E4X.2.1.1.m1.1.1"><mi id="S2.E4X.2.1.1.m1.1.1.2.2">α</mi><mrow id="S2.E4X.2.1.1.m1.1.1.2.3"><mi id="S2.E4X.2.1.1.m1.1.1.2.3.2">i</mi><mo id="S2.E4X.2.1.1.m1.1.1.2.3.1">⁢</mo><mi id="S2.E4X.2.1.1.m1.1.1.2.3.3">j</mi></mrow><msup id="S2.E4X.2.1.1.m1.1.1.3"><mi id="S2.E4X.2.1.1.m1.1.1.3a"></mi><mo id="S2.E4X.2.1.1.m1.1.1.3.1">′</mo></msup></msubsup><mo id="S2.E4X.2.1.1.m1.1.2">=</mo><mstyle displaystyle="true" id="S2.E4X.2.1.1.m1.1.3"><mfrac id="S2.E4X.2.1.1.m1.1.3a"><mn id="S2.E4X.2.1.1.m1.1.3.2">1</mn><msqrt id="S2.E4X.2.1.1.m1.1.3.3"><mrow id="S2.E4X.2.1.1.m1.1.3.3.2"><mn id="S2.E4X.2.1.1.m1.1.3.3.2.2">3</mn><mo id="S2.E4X.2.1.1.m1.1.3.3.2.1">⁢</mo><mi id="S2.E4X.2.1.1.m1.1.3.3.2.3">d</mi></mrow></msqrt></mfrac></mstyle><mo id="S2.E4X.2.1.1.m1.1.4" stretchy="false">[</mo></mrow><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.1c">\displaystyle\alpha_{ij}^{{}^{\prime}}=\frac{1}{\sqrt{3d}}[</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.2.1.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG square-root start_ARG 3 italic_d end_ARG end_ARG [</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle(y_{i}^{(l)}W_{Q}^{{}^{\prime}(l)})(x_{j}^{(L)}W_{K}^{{}^{\prime}%
(l)})^{T}" class="ltx_math_unparsed" display="inline" id="S2.E4X.3.2.2.m1.4"><semantics id="S2.E4X.3.2.2.m1.4a"><mrow id="S2.E4X.3.2.2.m1.4.4"><mrow id="S2.E4X.3.2.2.m1.3.3.1.1"><mo id="S2.E4X.3.2.2.m1.3.3.1.1.2" stretchy="false">(</mo><mrow id="S2.E4X.3.2.2.m1.3.3.1.1.1"><msubsup id="S2.E4X.3.2.2.m1.3.3.1.1.1.2"><mi id="S2.E4X.3.2.2.m1.3.3.1.1.1.2.2.2">y</mi><mi id="S2.E4X.3.2.2.m1.3.3.1.1.1.2.2.3">i</mi><mrow id="S2.E4X.3.2.2.m1.1.1.1.3"><mo id="S2.E4X.3.2.2.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="S2.E4X.3.2.2.m1.1.1.1.1">l</mi><mo id="S2.E4X.3.2.2.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S2.E4X.3.2.2.m1.3.3.1.1.1.1">⁢</mo><msubsup id="S2.E4X.3.2.2.m1.3.3.1.1.1.3"><mi id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.2.2">W</mi><mi id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.2.3">Q</mi><mmultiscripts id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1"><mrow id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1.2"><mo id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1.2.1" stretchy="false">(</mo><mi id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1.2.2">l</mi><mo id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1a"></mprescripts><mrow id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1b"></mrow><mo id="S2.E4X.3.2.2.m1.3.3.1.1.1.3.3.1.3">′</mo></mmultiscripts></msubsup></mrow><mo id="S2.E4X.3.2.2.m1.3.3.1.1.3" stretchy="false">)</mo></mrow><mo id="S2.E4X.3.2.2.m1.4.4.3">⁢</mo><msup id="S2.E4X.3.2.2.m1.4.4.2"><mrow id="S2.E4X.3.2.2.m1.4.4.2.1.1"><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.2" stretchy="false">(</mo><mrow id="S2.E4X.3.2.2.m1.4.4.2.1.1.1"><msubsup id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.2"><mi id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.2.2.2">x</mi><mi id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.2.2.3">j</mi><mrow id="S2.E4X.3.2.2.m1.2.2.1.3"><mo id="S2.E4X.3.2.2.m1.2.2.1.3.1" stretchy="false">(</mo><mi id="S2.E4X.3.2.2.m1.2.2.1.1">L</mi><mo id="S2.E4X.3.2.2.m1.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.1">⁢</mo><msubsup id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3"><mi id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.2.2">W</mi><mi id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.2.3">K</mi><mmultiscripts id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1"><mrow id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1.2"><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1.2.1" stretchy="false">(</mo><mi id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1.2.2">l</mi><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1a"></mprescripts><mrow id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1b"></mrow><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.1.3.3.1.3">′</mo></mmultiscripts></msubsup></mrow><mo id="S2.E4X.3.2.2.m1.4.4.2.1.1.3" stretchy="false">)</mo></mrow><mi id="S2.E4X.3.2.2.m1.4.4.2.3">T</mi></msup></mrow><annotation encoding="application/x-tex" id="S2.E4X.3.2.2.m1.4b">\displaystyle(y_{i}^{(l)}W_{Q}^{{}^{\prime}(l)})(x_{j}^{(L)}W_{K}^{{}^{\prime}%
(l)})^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.3.2.2.m1.4c">( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+(p_{i}^{{}^{\prime}}U_{Q}^{{}^{\prime}})(p_{j}^{{}^{\prime}}U_{K%
}^{{}^{\prime}})^{T}+r_{j-i}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.E4Xa.2.1.1.m1.2"><semantics id="S2.E4Xa.2.1.1.m1.2a"><mrow id="S2.E4Xa.2.1.1.m1.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.cmml"><mrow id="S2.E4Xa.2.1.1.m1.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.2a" xref="S2.E4Xa.2.1.1.m1.2.2.2.cmml">+</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.cmml"><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><msup id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3a" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml">Q</mi><msup id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3a" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.1" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml">′</mo></msup></msubsup></mrow><mo id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S2.E4Xa.2.1.1.m1.2.2.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.cmml"><mrow id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml"><msubsup id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.2.cmml">p</mi><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.3.cmml">j</mi><msup id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3a" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.2.cmml">U</mi><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.3.cmml">K</mi><msup id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3a" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.1" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.1.cmml">′</mo></msup></msubsup></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.2.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.3.cmml">+</mo><msubsup id="S2.E4Xa.2.1.1.m1.2.2.4" xref="S2.E4Xa.2.1.1.m1.2.2.4.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.4.2.2" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.2.cmml">r</mi><mrow id="S2.E4Xa.2.1.1.m1.2.2.4.2.3" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.2" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.2.cmml">j</mi><mo id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.1" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.1.cmml">−</mo><mi id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.3" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.3.cmml">i</mi></mrow><msup id="S2.E4Xa.2.1.1.m1.2.2.4.3" xref="S2.E4Xa.2.1.1.m1.2.2.4.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.2.2.4.3a" xref="S2.E4Xa.2.1.1.m1.2.2.4.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.2.2.4.3.1" xref="S2.E4Xa.2.1.1.m1.2.2.4.3.1.cmml">′</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.E4Xa.2.1.1.m1.2b"><apply id="S2.E4Xa.2.1.1.m1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2"><plus id="S2.E4Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.3"></plus><apply id="S2.E4Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2"><plus id="S2.E4Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2"></plus><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2"><times id="S2.E4Xa.2.1.1.m1.2.2.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.3"></times><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1"><times id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></times><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3"><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.1">′</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3">𝑄</ci></apply><apply id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3"><ci id="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.1">′</ci></apply></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1"><times id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.1"></times><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.2">𝑝</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3"><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.2.3.1">′</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.2">𝑈</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.2.3">𝐾</ci></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3"><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.1.1.1.3.3.1">′</ci></apply></apply></apply><ci id="S2.E4Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.2.2.2.3">𝑇</ci></apply></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.4.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.4.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4">superscript</csymbol><apply id="S2.E4Xa.2.1.1.m1.2.2.4.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.2.2.4.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.2.2.4.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.2">𝑟</ci><apply id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3"><minus id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.1"></minus><ci id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.2">𝑗</ci><ci id="S2.E4Xa.2.1.1.m1.2.2.4.2.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.2.3.3">𝑖</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.2.2.4.3.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.3"><ci id="S2.E4Xa.2.1.1.m1.2.2.4.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.2.2.4.3.1">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4Xa.2.1.1.m1.2c">\displaystyle+(p_{i}^{{}^{\prime}}U_{Q}^{{}^{\prime}})(p_{j}^{{}^{\prime}}U_{K%
}^{{}^{\prime}})^{T}+r_{j-i}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.E4Xa.2.1.1.m1.2d">+ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ) ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT + italic_r start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+(y_{i}^{(l)}V_{Q}^{{}^{\prime}(l)})(b_{j}V_{K}^{{}^{\prime}(l)})%
^{T}]," class="ltx_math_unparsed" display="inline" id="S2.E4Xb.2.1.1.m1.1"><semantics id="S2.E4Xb.2.1.1.m1.1a"><mrow id="S2.E4Xb.2.1.1.m1.1b"><mo id="S2.E4Xb.2.1.1.m1.1.2">+</mo><mrow id="S2.E4Xb.2.1.1.m1.1.3"><mo id="S2.E4Xb.2.1.1.m1.1.3.1" stretchy="false">(</mo><msubsup id="S2.E4Xb.2.1.1.m1.1.3.2"><mi id="S2.E4Xb.2.1.1.m1.1.3.2.2.2">y</mi><mi id="S2.E4Xb.2.1.1.m1.1.3.2.2.3">i</mi><mrow id="S2.E4Xb.2.1.1.m1.1.1.1.3"><mo id="S2.E4Xb.2.1.1.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="S2.E4Xb.2.1.1.m1.1.1.1.1">l</mi><mo id="S2.E4Xb.2.1.1.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><msubsup id="S2.E4Xb.2.1.1.m1.1.3.3"><mi id="S2.E4Xb.2.1.1.m1.1.3.3.2.2">V</mi><mi id="S2.E4Xb.2.1.1.m1.1.3.3.2.3">Q</mi><mmultiscripts id="S2.E4Xb.2.1.1.m1.1.3.3.3.1"><mrow id="S2.E4Xb.2.1.1.m1.1.3.3.3.1.2"><mo id="S2.E4Xb.2.1.1.m1.1.3.3.3.1.2.1" stretchy="false">(</mo><mi id="S2.E4Xb.2.1.1.m1.1.3.3.3.1.2.2">l</mi><mo id="S2.E4Xb.2.1.1.m1.1.3.3.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.E4Xb.2.1.1.m1.1.3.3.3.1a"></mprescripts><mrow id="S2.E4Xb.2.1.1.m1.1.3.3.3.1b"></mrow><mo id="S2.E4Xb.2.1.1.m1.1.3.3.3.1.3">′</mo></mmultiscripts></msubsup><mo id="S2.E4Xb.2.1.1.m1.1.3.4" stretchy="false">)</mo></mrow><msup id="S2.E4Xb.2.1.1.m1.1.4"><mrow id="S2.E4Xb.2.1.1.m1.1.4.2"><mo id="S2.E4Xb.2.1.1.m1.1.4.2.1" stretchy="false">(</mo><msub id="S2.E4Xb.2.1.1.m1.1.4.2.2"><mi id="S2.E4Xb.2.1.1.m1.1.4.2.2.2">b</mi><mi id="S2.E4Xb.2.1.1.m1.1.4.2.2.3">j</mi></msub><msubsup id="S2.E4Xb.2.1.1.m1.1.4.2.3"><mi id="S2.E4Xb.2.1.1.m1.1.4.2.3.2.2">V</mi><mi id="S2.E4Xb.2.1.1.m1.1.4.2.3.2.3">K</mi><mmultiscripts id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1"><mrow id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1.2"><mo id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1.2.1" stretchy="false">(</mo><mi id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1.2.2">l</mi><mo id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1a"></mprescripts><mrow id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1b"></mrow><mo id="S2.E4Xb.2.1.1.m1.1.4.2.3.3.1.3">′</mo></mmultiscripts></msubsup><mo id="S2.E4Xb.2.1.1.m1.1.4.2.4" stretchy="false">)</mo></mrow><mi id="S2.E4Xb.2.1.1.m1.1.4.3">T</mi></msup><mo id="S2.E4Xb.2.1.1.m1.1.5" stretchy="false">]</mo><mo id="S2.E4Xb.2.1.1.m1.1.6">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E4Xb.2.1.1.m1.1c">\displaystyle+(y_{i}^{(l)}V_{Q}^{{}^{\prime}(l)})(b_{j}V_{K}^{{}^{\prime}(l)})%
^{T}],</annotation><annotation encoding="application/x-llamapun" id="S2.E4Xb.2.1.1.m1.1d">+ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ( italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.I1.i2.p1.14">where <math alttext="y_{i}^{(l)}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m1.1"><semantics id="S2.I1.i2.p1.3.m1.1a"><msubsup id="S2.I1.i2.p1.3.m1.1.2" xref="S2.I1.i2.p1.3.m1.1.2.cmml"><mi id="S2.I1.i2.p1.3.m1.1.2.2.2" xref="S2.I1.i2.p1.3.m1.1.2.2.2.cmml">y</mi><mi id="S2.I1.i2.p1.3.m1.1.2.2.3" xref="S2.I1.i2.p1.3.m1.1.2.2.3.cmml">i</mi><mrow id="S2.I1.i2.p1.3.m1.1.1.1.3" xref="S2.I1.i2.p1.3.m1.1.2.cmml"><mo id="S2.I1.i2.p1.3.m1.1.1.1.3.1" stretchy="false" xref="S2.I1.i2.p1.3.m1.1.2.cmml">(</mo><mi id="S2.I1.i2.p1.3.m1.1.1.1.1" xref="S2.I1.i2.p1.3.m1.1.1.1.1.cmml">l</mi><mo id="S2.I1.i2.p1.3.m1.1.1.1.3.2" stretchy="false" xref="S2.I1.i2.p1.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m1.1b"><apply id="S2.I1.i2.p1.3.m1.1.2.cmml" xref="S2.I1.i2.p1.3.m1.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m1.1.2.1.cmml" xref="S2.I1.i2.p1.3.m1.1.2">superscript</csymbol><apply id="S2.I1.i2.p1.3.m1.1.2.2.cmml" xref="S2.I1.i2.p1.3.m1.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m1.1.2.2.1.cmml" xref="S2.I1.i2.p1.3.m1.1.2">subscript</csymbol><ci id="S2.I1.i2.p1.3.m1.1.2.2.2.cmml" xref="S2.I1.i2.p1.3.m1.1.2.2.2">𝑦</ci><ci id="S2.I1.i2.p1.3.m1.1.2.2.3.cmml" xref="S2.I1.i2.p1.3.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.I1.i2.p1.3.m1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m1.1c">y_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden representation of the target token at position <math alttext="i" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m2.1"><semantics id="S2.I1.i2.p1.4.m2.1a"><mi id="S2.I1.i2.p1.4.m2.1.1" xref="S2.I1.i2.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m2.1b"><ci id="S2.I1.i2.p1.4.m2.1.1.cmml" xref="S2.I1.i2.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m2.1d">italic_i</annotation></semantics></math> and <math alttext="x_{j}^{(L)}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.5.m3.1"><semantics id="S2.I1.i2.p1.5.m3.1a"><msubsup id="S2.I1.i2.p1.5.m3.1.2" xref="S2.I1.i2.p1.5.m3.1.2.cmml"><mi id="S2.I1.i2.p1.5.m3.1.2.2.2" xref="S2.I1.i2.p1.5.m3.1.2.2.2.cmml">x</mi><mi id="S2.I1.i2.p1.5.m3.1.2.2.3" xref="S2.I1.i2.p1.5.m3.1.2.2.3.cmml">j</mi><mrow id="S2.I1.i2.p1.5.m3.1.1.1.3" xref="S2.I1.i2.p1.5.m3.1.2.cmml"><mo id="S2.I1.i2.p1.5.m3.1.1.1.3.1" stretchy="false" xref="S2.I1.i2.p1.5.m3.1.2.cmml">(</mo><mi id="S2.I1.i2.p1.5.m3.1.1.1.1" xref="S2.I1.i2.p1.5.m3.1.1.1.1.cmml">L</mi><mo id="S2.I1.i2.p1.5.m3.1.1.1.3.2" stretchy="false" xref="S2.I1.i2.p1.5.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.5.m3.1b"><apply id="S2.I1.i2.p1.5.m3.1.2.cmml" xref="S2.I1.i2.p1.5.m3.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.5.m3.1.2.1.cmml" xref="S2.I1.i2.p1.5.m3.1.2">superscript</csymbol><apply id="S2.I1.i2.p1.5.m3.1.2.2.cmml" xref="S2.I1.i2.p1.5.m3.1.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.5.m3.1.2.2.1.cmml" xref="S2.I1.i2.p1.5.m3.1.2">subscript</csymbol><ci id="S2.I1.i2.p1.5.m3.1.2.2.2.cmml" xref="S2.I1.i2.p1.5.m3.1.2.2.2">𝑥</ci><ci id="S2.I1.i2.p1.5.m3.1.2.2.3.cmml" xref="S2.I1.i2.p1.5.m3.1.2.2.3">𝑗</ci></apply><ci id="S2.I1.i2.p1.5.m3.1.1.1.1.cmml" xref="S2.I1.i2.p1.5.m3.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.5.m3.1c">x_{j}^{(L)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.5.m3.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden representation of source token at position <math alttext="j" class="ltx_Math" display="inline" id="S2.I1.i2.p1.6.m4.1"><semantics id="S2.I1.i2.p1.6.m4.1a"><mi id="S2.I1.i2.p1.6.m4.1.1" xref="S2.I1.i2.p1.6.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.6.m4.1b"><ci id="S2.I1.i2.p1.6.m4.1.1.cmml" xref="S2.I1.i2.p1.6.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.6.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.6.m4.1d">italic_j</annotation></semantics></math> of the final encoder layer <math alttext="L" class="ltx_Math" display="inline" id="S2.I1.i2.p1.7.m5.1"><semantics id="S2.I1.i2.p1.7.m5.1a"><mi id="S2.I1.i2.p1.7.m5.1.1" xref="S2.I1.i2.p1.7.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.7.m5.1b"><ci id="S2.I1.i2.p1.7.m5.1.1.cmml" xref="S2.I1.i2.p1.7.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.7.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.7.m5.1d">italic_L</annotation></semantics></math>. <math alttext="p_{i}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.8.m6.1"><semantics id="S2.I1.i2.p1.8.m6.1a"><msubsup id="S2.I1.i2.p1.8.m6.1.1" xref="S2.I1.i2.p1.8.m6.1.1.cmml"><mi id="S2.I1.i2.p1.8.m6.1.1.2.2" xref="S2.I1.i2.p1.8.m6.1.1.2.2.cmml">p</mi><mi id="S2.I1.i2.p1.8.m6.1.1.2.3" xref="S2.I1.i2.p1.8.m6.1.1.2.3.cmml">i</mi><msup id="S2.I1.i2.p1.8.m6.1.1.3" xref="S2.I1.i2.p1.8.m6.1.1.3.cmml"><mi id="S2.I1.i2.p1.8.m6.1.1.3a" xref="S2.I1.i2.p1.8.m6.1.1.3.cmml"></mi><mo id="S2.I1.i2.p1.8.m6.1.1.3.1" xref="S2.I1.i2.p1.8.m6.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.8.m6.1b"><apply id="S2.I1.i2.p1.8.m6.1.1.cmml" xref="S2.I1.i2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.8.m6.1.1.1.cmml" xref="S2.I1.i2.p1.8.m6.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.8.m6.1.1.2.cmml" xref="S2.I1.i2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.8.m6.1.1.2.1.cmml" xref="S2.I1.i2.p1.8.m6.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.8.m6.1.1.2.2.cmml" xref="S2.I1.i2.p1.8.m6.1.1.2.2">𝑝</ci><ci id="S2.I1.i2.p1.8.m6.1.1.2.3.cmml" xref="S2.I1.i2.p1.8.m6.1.1.2.3">𝑖</ci></apply><apply id="S2.I1.i2.p1.8.m6.1.1.3.cmml" xref="S2.I1.i2.p1.8.m6.1.1.3"><ci id="S2.I1.i2.p1.8.m6.1.1.3.1.cmml" xref="S2.I1.i2.p1.8.m6.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.8.m6.1c">p_{i}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.8.m6.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="p_{j}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.9.m7.1"><semantics id="S2.I1.i2.p1.9.m7.1a"><msubsup id="S2.I1.i2.p1.9.m7.1.1" xref="S2.I1.i2.p1.9.m7.1.1.cmml"><mi id="S2.I1.i2.p1.9.m7.1.1.2.2" xref="S2.I1.i2.p1.9.m7.1.1.2.2.cmml">p</mi><mi id="S2.I1.i2.p1.9.m7.1.1.2.3" xref="S2.I1.i2.p1.9.m7.1.1.2.3.cmml">j</mi><msup id="S2.I1.i2.p1.9.m7.1.1.3" xref="S2.I1.i2.p1.9.m7.1.1.3.cmml"><mi id="S2.I1.i2.p1.9.m7.1.1.3a" xref="S2.I1.i2.p1.9.m7.1.1.3.cmml"></mi><mo id="S2.I1.i2.p1.9.m7.1.1.3.1" xref="S2.I1.i2.p1.9.m7.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.9.m7.1b"><apply id="S2.I1.i2.p1.9.m7.1.1.cmml" xref="S2.I1.i2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.9.m7.1.1.1.cmml" xref="S2.I1.i2.p1.9.m7.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.9.m7.1.1.2.cmml" xref="S2.I1.i2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.9.m7.1.1.2.1.cmml" xref="S2.I1.i2.p1.9.m7.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.9.m7.1.1.2.2.cmml" xref="S2.I1.i2.p1.9.m7.1.1.2.2">𝑝</ci><ci id="S2.I1.i2.p1.9.m7.1.1.2.3.cmml" xref="S2.I1.i2.p1.9.m7.1.1.2.3">𝑗</ci></apply><apply id="S2.I1.i2.p1.9.m7.1.1.3.cmml" xref="S2.I1.i2.p1.9.m7.1.1.3"><ci id="S2.I1.i2.p1.9.m7.1.1.3.1.cmml" xref="S2.I1.i2.p1.9.m7.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.9.m7.1c">p_{j}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.9.m7.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are absolute target and source XPOS embeddings, <math alttext="r_{j-i}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.10.m8.1"><semantics id="S2.I1.i2.p1.10.m8.1a"><msubsup id="S2.I1.i2.p1.10.m8.1.1" xref="S2.I1.i2.p1.10.m8.1.1.cmml"><mi id="S2.I1.i2.p1.10.m8.1.1.2.2" xref="S2.I1.i2.p1.10.m8.1.1.2.2.cmml">r</mi><mrow id="S2.I1.i2.p1.10.m8.1.1.2.3" xref="S2.I1.i2.p1.10.m8.1.1.2.3.cmml"><mi id="S2.I1.i2.p1.10.m8.1.1.2.3.2" xref="S2.I1.i2.p1.10.m8.1.1.2.3.2.cmml">j</mi><mo id="S2.I1.i2.p1.10.m8.1.1.2.3.1" xref="S2.I1.i2.p1.10.m8.1.1.2.3.1.cmml">−</mo><mi id="S2.I1.i2.p1.10.m8.1.1.2.3.3" xref="S2.I1.i2.p1.10.m8.1.1.2.3.3.cmml">i</mi></mrow><msup id="S2.I1.i2.p1.10.m8.1.1.3" xref="S2.I1.i2.p1.10.m8.1.1.3.cmml"><mi id="S2.I1.i2.p1.10.m8.1.1.3a" xref="S2.I1.i2.p1.10.m8.1.1.3.cmml"></mi><mo id="S2.I1.i2.p1.10.m8.1.1.3.1" xref="S2.I1.i2.p1.10.m8.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.10.m8.1b"><apply id="S2.I1.i2.p1.10.m8.1.1.cmml" xref="S2.I1.i2.p1.10.m8.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.10.m8.1.1.1.cmml" xref="S2.I1.i2.p1.10.m8.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.10.m8.1.1.2.cmml" xref="S2.I1.i2.p1.10.m8.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.10.m8.1.1.2.1.cmml" xref="S2.I1.i2.p1.10.m8.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.10.m8.1.1.2.2.cmml" xref="S2.I1.i2.p1.10.m8.1.1.2.2">𝑟</ci><apply id="S2.I1.i2.p1.10.m8.1.1.2.3.cmml" xref="S2.I1.i2.p1.10.m8.1.1.2.3"><minus id="S2.I1.i2.p1.10.m8.1.1.2.3.1.cmml" xref="S2.I1.i2.p1.10.m8.1.1.2.3.1"></minus><ci id="S2.I1.i2.p1.10.m8.1.1.2.3.2.cmml" xref="S2.I1.i2.p1.10.m8.1.1.2.3.2">𝑗</ci><ci id="S2.I1.i2.p1.10.m8.1.1.2.3.3.cmml" xref="S2.I1.i2.p1.10.m8.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.I1.i2.p1.10.m8.1.1.3.cmml" xref="S2.I1.i2.p1.10.m8.1.1.3"><ci id="S2.I1.i2.p1.10.m8.1.1.3.1.cmml" xref="S2.I1.i2.p1.10.m8.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.10.m8.1c">r_{j-i}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.10.m8.1d">italic_r start_POSTSUBSCRIPT italic_j - italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a target-to-source relative XPOS embedding, <math alttext="b_{j}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.11.m9.1"><semantics id="S2.I1.i2.p1.11.m9.1a"><msub id="S2.I1.i2.p1.11.m9.1.1" xref="S2.I1.i2.p1.11.m9.1.1.cmml"><mi id="S2.I1.i2.p1.11.m9.1.1.2" xref="S2.I1.i2.p1.11.m9.1.1.2.cmml">b</mi><mi id="S2.I1.i2.p1.11.m9.1.1.3" xref="S2.I1.i2.p1.11.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.11.m9.1b"><apply id="S2.I1.i2.p1.11.m9.1.1.cmml" xref="S2.I1.i2.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.11.m9.1.1.1.cmml" xref="S2.I1.i2.p1.11.m9.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.11.m9.1.1.2.cmml" xref="S2.I1.i2.p1.11.m9.1.1.2">𝑏</ci><ci id="S2.I1.i2.p1.11.m9.1.1.3.cmml" xref="S2.I1.i2.p1.11.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.11.m9.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.11.m9.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is a pre-trained BERT embedding of source token at position <math alttext="j" class="ltx_Math" display="inline" id="S2.I1.i2.p1.12.m10.1"><semantics id="S2.I1.i2.p1.12.m10.1a"><mi id="S2.I1.i2.p1.12.m10.1.1" xref="S2.I1.i2.p1.12.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.12.m10.1b"><ci id="S2.I1.i2.p1.12.m10.1.1.cmml" xref="S2.I1.i2.p1.12.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.12.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.12.m10.1d">italic_j</annotation></semantics></math> and <math alttext="W_{Q}^{{}^{\prime}(l)},W_{K}^{{}^{\prime}(l)},U_{Q}^{{}^{\prime}},U_{K}^{{}^{%
\prime}},V_{Q}^{{}^{\prime}(l)}" class="ltx_math_unparsed" display="inline" id="S2.I1.i2.p1.13.m11.5"><semantics id="S2.I1.i2.p1.13.m11.5a"><mrow id="S2.I1.i2.p1.13.m11.5.5.5"><msubsup id="S2.I1.i2.p1.13.m11.1.1.1.1"><mi id="S2.I1.i2.p1.13.m11.1.1.1.1.2.2">W</mi><mi id="S2.I1.i2.p1.13.m11.1.1.1.1.2.3">Q</mi><mmultiscripts id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1"><mrow id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1.2"><mo id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1.2.1" stretchy="false">(</mo><mi id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1.2.2">l</mi><mo id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1a"></mprescripts><mrow id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1b"></mrow><mo id="S2.I1.i2.p1.13.m11.1.1.1.1.3.1.3">′</mo></mmultiscripts></msubsup><mo id="S2.I1.i2.p1.13.m11.5.5.5.6">,</mo><msubsup id="S2.I1.i2.p1.13.m11.2.2.2.2"><mi id="S2.I1.i2.p1.13.m11.2.2.2.2.2.2">W</mi><mi id="S2.I1.i2.p1.13.m11.2.2.2.2.2.3">K</mi><mmultiscripts id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1"><mrow id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1.2"><mo id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1.2.1" stretchy="false">(</mo><mi id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1.2.2">l</mi><mo id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1a"></mprescripts><mrow id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1b"></mrow><mo id="S2.I1.i2.p1.13.m11.2.2.2.2.3.1.3">′</mo></mmultiscripts></msubsup><mo id="S2.I1.i2.p1.13.m11.5.5.5.7">,</mo><msubsup id="S2.I1.i2.p1.13.m11.3.3.3.3"><mi id="S2.I1.i2.p1.13.m11.3.3.3.3.2.2">U</mi><mi id="S2.I1.i2.p1.13.m11.3.3.3.3.2.3">Q</mi><msup id="S2.I1.i2.p1.13.m11.3.3.3.3.3"><mi id="S2.I1.i2.p1.13.m11.3.3.3.3.3a"></mi><mo id="S2.I1.i2.p1.13.m11.3.3.3.3.3.1">′</mo></msup></msubsup><mo id="S2.I1.i2.p1.13.m11.5.5.5.8">,</mo><msubsup id="S2.I1.i2.p1.13.m11.4.4.4.4"><mi id="S2.I1.i2.p1.13.m11.4.4.4.4.2.2">U</mi><mi id="S2.I1.i2.p1.13.m11.4.4.4.4.2.3">K</mi><msup id="S2.I1.i2.p1.13.m11.4.4.4.4.3"><mi id="S2.I1.i2.p1.13.m11.4.4.4.4.3a"></mi><mo id="S2.I1.i2.p1.13.m11.4.4.4.4.3.1">′</mo></msup></msubsup><mo id="S2.I1.i2.p1.13.m11.5.5.5.9">,</mo><msubsup id="S2.I1.i2.p1.13.m11.5.5.5.5"><mi id="S2.I1.i2.p1.13.m11.5.5.5.5.2.2">V</mi><mi id="S2.I1.i2.p1.13.m11.5.5.5.5.2.3">Q</mi><mmultiscripts id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1"><mrow id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1.2"><mo id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1.2.1" stretchy="false">(</mo><mi id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1.2.2">l</mi><mo id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1a"></mprescripts><mrow id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1b"></mrow><mo id="S2.I1.i2.p1.13.m11.5.5.5.5.3.1.3">′</mo></mmultiscripts></msubsup></mrow><annotation encoding="application/x-tex" id="S2.I1.i2.p1.13.m11.5b">W_{Q}^{{}^{\prime}(l)},W_{K}^{{}^{\prime}(l)},U_{Q}^{{}^{\prime}},U_{K}^{{}^{%
\prime}},V_{Q}^{{}^{\prime}(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.13.m11.5c">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_U start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_U start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_V start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="V_{K}^{{}^{\prime}(l)}" class="ltx_math_unparsed" display="inline" id="S2.I1.i2.p1.14.m12.1"><semantics id="S2.I1.i2.p1.14.m12.1a"><msubsup id="S2.I1.i2.p1.14.m12.1.1"><mi id="S2.I1.i2.p1.14.m12.1.1.2.2">V</mi><mi id="S2.I1.i2.p1.14.m12.1.1.2.3">K</mi><mmultiscripts id="S2.I1.i2.p1.14.m12.1.1.3.1"><mrow id="S2.I1.i2.p1.14.m12.1.1.3.1.2"><mo id="S2.I1.i2.p1.14.m12.1.1.3.1.2.1" stretchy="false">(</mo><mi id="S2.I1.i2.p1.14.m12.1.1.3.1.2.2">l</mi><mo id="S2.I1.i2.p1.14.m12.1.1.3.1.2.3" stretchy="false">)</mo></mrow><mprescripts id="S2.I1.i2.p1.14.m12.1.1.3.1a"></mprescripts><mrow id="S2.I1.i2.p1.14.m12.1.1.3.1b"></mrow><mo id="S2.I1.i2.p1.14.m12.1.1.3.1.3">′</mo></mmultiscripts></msubsup><annotation encoding="application/x-tex" id="S2.I1.i2.p1.14.m12.1b">V_{K}^{{}^{\prime}(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.14.m12.1c">italic_V start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> are the learnable projection matrices.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Morphological encoding</h4>
<div class="ltx_para" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.1">For most transformer-based encoder-decoder models, the first layer inputs are usually formed by mapping each sub-word token, such as those produced by BPE, to a learnable embedding vector. However, BPE-produced tokens do not always carry explicit lexical meaning. In fact, they cannot model non-concatenative morphology and other morpho-graphemic processes as these BPE tokens are solely based on the surface forms. Inspired by the work of <cite class="ltx_cite ltx_citemacro_citet">Nzeyimana and Rubungo (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib23" title="">2022</a>)</cite>, we explore using a small transformer encoder to form a word-compositional model based on the morphological structure and the associated morphemes.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS2.p2">
<p class="ltx_p" id="S2.SS1.SSS2.p2.1">Depicted at the input layers in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.F1" title="Figure 1 ‣ 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">1</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.F2" title="Figure 2 ‣ 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2</span></a>, the morphological encoder or <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p2.1.1">Morpho-Encoder</span> is a small transformer encoder that processes a set of four embedding units at the word composition level: (1) <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p2.1.2">the stem</span>, (2) a <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p2.1.3">variable number of affixes</span>, (3) a coarse-grained <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p2.1.4">part-of-speech (POS) tag</span> and, (4) a fine-grained <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p2.1.5">affix set index</span>. An affix set represents one of many frequent affix combinations observed empirically. Thus, the affix set index is equivalent to a fine-grained <span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p2.1.6">morphological tag</span>.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS2.p3">
<p class="ltx_p" id="S2.SS1.SSS2.p3.1">The <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p3.1.1">Morpho-Encoder</span> processes all word-compositional units as a set without any ordering information. This is because none of these units can be repeated in the same word. In cases of stem reduplication phenomena <cite class="ltx_cite ltx_citemacro_cite">Inkelas and Zoll (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib11" title="">2000</a>)</cite>, only one stem is used, while the reduplication structure is captured by the affix set. At the output of the <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p3.1.2">Morpho-Encoder</span>, hidden representations corresponding to units other than the affixes are pulled and concatenated together to form a word hidden vector to feed to the main sequence model. In addition to this, a new stem embedding vector at the sequence level is also concatenated with the pulled vectors from the <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p3.1.3">Morpho-Encoder</span> to form the final hidden vector representing the word.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS2.p4">
<p class="ltx_p" id="S2.SS1.SSS2.p4.1">In our experiments, we use 24,000 most frequent affix combinations as affix sets. Any infrequent combination of affixes can always be reduced to a frequent one by removing one or more affixes. However, all affixes still contribute to the word composition via the <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p4.1.1">Morpho-Encoder</span>.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS2.p5">
<p class="ltx_p" id="S2.SS1.SSS2.p5.1">We note that the <span class="ltx_text ltx_font_italic" id="S2.SS1.SSS2.p5.1.1">Morpho-Encoder</span> applies to both the encoder and the auto-regressive decoder’s input layers for all types of tokens. While the word-compositional model above relates mostly to inflected forms, we are able generalize this to other typed of tokens such as proper names, numbers and punctuation marks. For these other tokens, we process them using BPE and consider the resulting sub-word tokens as special stems without affixes.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.3 </span>Target-side morphology learning</h4>
<div class="ltx_para" id="S2.SS1.SSS3.p1">
<p class="ltx_p" id="S2.SS1.SSS3.p1.10">Considering the morphological model employed at the input layer, the decoder outputs for a morphologically-rich target language must be used to predict the same types of morphological units used at the input layer, namely, the stem, affixes, the POS tag and the affix set. This becomes a multi-task and multi-label (MTML) classification problem which requires optimizing multiple objectives, corresponding to 4 types loss functions:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{S}" class="ltx_Math" display="inline" id="S2.E5X.2.1.1.m1.1"><semantics id="S2.E5X.2.1.1.m1.1a"><msub id="S2.E5X.2.1.1.m1.1.1" xref="S2.E5X.2.1.1.m1.1.1.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.2" mathvariant="normal" xref="S2.E5X.2.1.1.m1.1.1.2.cmml">ℓ</mi><mi id="S2.E5X.2.1.1.m1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.1b"><apply id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2">ℓ</ci><ci id="S2.E5X.2.1.1.m1.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.1c">\displaystyle\ell_{S}</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.2.1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\ell_{CE}(f_{S}(h^{L}),y_{S})" class="ltx_Math" display="inline" id="S2.E5X.3.2.2.m1.2"><semantics id="S2.E5X.3.2.2.m1.2a"><mrow id="S2.E5X.3.2.2.m1.2.2" xref="S2.E5X.3.2.2.m1.2.2.cmml"><mi id="S2.E5X.3.2.2.m1.2.2.4" xref="S2.E5X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S2.E5X.3.2.2.m1.2.2.3" xref="S2.E5X.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S2.E5X.3.2.2.m1.2.2.2" xref="S2.E5X.3.2.2.m1.2.2.2.cmml"><msub id="S2.E5X.3.2.2.m1.2.2.2.4" xref="S2.E5X.3.2.2.m1.2.2.2.4.cmml"><mi id="S2.E5X.3.2.2.m1.2.2.2.4.2" mathvariant="normal" xref="S2.E5X.3.2.2.m1.2.2.2.4.2.cmml">ℓ</mi><mrow id="S2.E5X.3.2.2.m1.2.2.2.4.3" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.cmml"><mi id="S2.E5X.3.2.2.m1.2.2.2.4.3.2" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.2.cmml">C</mi><mo id="S2.E5X.3.2.2.m1.2.2.2.4.3.1" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S2.E5X.3.2.2.m1.2.2.2.4.3.3" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo id="S2.E5X.3.2.2.m1.2.2.2.3" xref="S2.E5X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E5X.3.2.2.m1.2.2.2.2.2" xref="S2.E5X.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S2.E5X.3.2.2.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E5X.3.2.2.m1.2.2.2.2.3.cmml">(</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">S</mi></msub><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msup><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.2.2.2.2.2.4" xref="S2.E5X.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E5X.3.2.2.m1.2.2.2.2.2.2" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.2" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.3" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2.3.cmml">S</mi></msub><mo id="S2.E5X.3.2.2.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E5X.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.3.2.2.m1.2b"><apply id="S2.E5X.3.2.2.m1.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.2"><eq id="S2.E5X.3.2.2.m1.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.2.2.4.cmml" xref="S2.E5X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S2.E5X.3.2.2.m1.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2"><times id="S2.E5X.3.2.2.m1.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.3"></times><apply id="S2.E5X.3.2.2.m1.2.2.2.4.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.2.2.4.1.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.2.2.2.4.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4.2">ℓ</ci><apply id="S2.E5X.3.2.2.m1.2.2.2.4.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4.3"><times id="S2.E5X.3.2.2.m1.2.2.2.4.3.1.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.1"></times><ci id="S2.E5X.3.2.2.m1.2.2.2.4.3.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.2">𝐶</ci><ci id="S2.E5X.3.2.2.m1.2.2.2.4.3.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="S2.E5X.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2.2"><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1"><times id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.3">𝑆</ci></apply><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.E5X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2.2.2.3">𝑆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.3.2.2.m1.2c">\displaystyle=\ell_{CE}(f_{S}(h^{L}),y_{S})</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.3.2.2.m1.2d">= roman_ℓ start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ( italic_h start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) , italic_y start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{A}^{(i)}" class="ltx_Math" display="inline" id="S2.E5Xa.2.1.1.m1.1"><semantics id="S2.E5Xa.2.1.1.m1.1a"><msubsup id="S2.E5Xa.2.1.1.m1.1.2" xref="S2.E5Xa.2.1.1.m1.1.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.2.2.2" mathvariant="normal" xref="S2.E5Xa.2.1.1.m1.1.2.2.2.cmml">ℓ</mi><mi id="S2.E5Xa.2.1.1.m1.1.2.2.3" xref="S2.E5Xa.2.1.1.m1.1.2.2.3.cmml">A</mi><mrow id="S2.E5Xa.2.1.1.m1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.1.2.cmml"><mo id="S2.E5Xa.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.2.cmml">(</mo><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.1b"><apply id="S2.E5Xa.2.1.1.m1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.2">superscript</csymbol><apply id="S2.E5Xa.2.1.1.m1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.1.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.2">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.2.2.2">ℓ</ci><ci id="S2.E5Xa.2.1.1.m1.1.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.2.2.3">𝐴</ci></apply><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.1c">\displaystyle\ell_{A}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.2.1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\ell_{BCE}(f_{A}(h^{L}),y_{A}^{(i)}),\forall i\in\mathcal{A}" class="ltx_Math" display="inline" id="S2.E5Xa.3.2.2.m1.3"><semantics id="S2.E5Xa.3.2.2.m1.3a"><mrow id="S2.E5Xa.3.2.2.m1.3.3.2" xref="S2.E5Xa.3.2.2.m1.3.3.3.cmml"><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.4" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.4.cmml"></mi><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.cmml"><msub id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.2" mathvariant="normal" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.2.cmml">ℓ</mi><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.2.cmml">B</mi><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.3.cmml">C</mi><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1a" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.4" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.4.cmml">E</mi></mrow></msub><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml">A</mi></msub><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msup><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.4" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml">A</mi><mrow id="S2.E5Xa.3.2.2.m1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml"><mo id="S2.E5Xa.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E5Xa.3.2.2.m1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.cmml">i</mi><mo id="S2.E5Xa.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.5" stretchy="false" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5Xa.3.2.2.m1.3.3.2.3" xref="S2.E5Xa.3.2.2.m1.3.3.3a.cmml">,</mo><mrow id="S2.E5Xa.3.2.2.m1.3.3.2.2" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.cmml"><mrow id="S2.E5Xa.3.2.2.m1.3.3.2.2.2" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2.cmml"><mo id="S2.E5Xa.3.2.2.m1.3.3.2.2.2.1" rspace="0.167em" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2.1.cmml">∀</mo><mi id="S2.E5Xa.3.2.2.m1.3.3.2.2.2.2" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2.2.cmml">i</mi></mrow><mo id="S2.E5Xa.3.2.2.m1.3.3.2.2.1" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E5Xa.3.2.2.m1.3.3.2.2.3" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.3.cmml">𝒜</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.3.2.2.m1.3b"><apply id="S2.E5Xa.3.2.2.m1.3.3.3.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.3.3.3a.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1"><eq id="S2.E5Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="S2.E5Xa.3.2.2.m1.2.2.1.1.4.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.4">absent</csymbol><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2"><times id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.3"></times><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.2">ℓ</ci><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3"><times id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.1"></times><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.2">𝐵</ci><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.3">𝐶</ci><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.4.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.4.3.4">𝐸</ci></apply></apply><interval closure="open" id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2"><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1"><times id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.3">𝐴</ci></apply><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2">superscript</csymbol><apply id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S2.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3">𝐴</ci></apply><ci id="S2.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1">𝑖</ci></apply></interval></apply></apply><apply id="S2.E5Xa.3.2.2.m1.3.3.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2"><in id="S2.E5Xa.3.2.2.m1.3.3.2.2.1.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.1"></in><apply id="S2.E5Xa.3.2.2.m1.3.3.2.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2"><csymbol cd="latexml" id="S2.E5Xa.3.2.2.m1.3.3.2.2.2.1.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2.1">for-all</csymbol><ci id="S2.E5Xa.3.2.2.m1.3.3.2.2.2.2.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.2.2">𝑖</ci></apply><ci id="S2.E5Xa.3.2.2.m1.3.3.2.2.3.cmml" xref="S2.E5Xa.3.2.2.m1.3.3.2.2.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.3.2.2.m1.3c">\displaystyle=\ell_{BCE}(f_{A}(h^{L}),y_{A}^{(i)}),\forall i\in\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.3.2.2.m1.3d">= roman_ℓ start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT ( italic_h start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) , italic_y start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) , ∀ italic_i ∈ caligraphic_A</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{P}" class="ltx_Math" display="inline" id="S2.E5Xb.2.1.1.m1.1"><semantics id="S2.E5Xb.2.1.1.m1.1a"><msub id="S2.E5Xb.2.1.1.m1.1.1" xref="S2.E5Xb.2.1.1.m1.1.1.cmml"><mi id="S2.E5Xb.2.1.1.m1.1.1.2" mathvariant="normal" xref="S2.E5Xb.2.1.1.m1.1.1.2.cmml">ℓ</mi><mi id="S2.E5Xb.2.1.1.m1.1.1.3" xref="S2.E5Xb.2.1.1.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E5Xb.2.1.1.m1.1b"><apply id="S2.E5Xb.2.1.1.m1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.1.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.1.1.2">ℓ</ci><ci id="S2.E5Xb.2.1.1.m1.1.1.3.cmml" xref="S2.E5Xb.2.1.1.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xb.2.1.1.m1.1c">\displaystyle\ell_{P}</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xb.2.1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\ell_{CE}(f_{P}(h^{L}),y_{P})" class="ltx_Math" display="inline" id="S2.E5Xb.3.2.2.m1.2"><semantics id="S2.E5Xb.3.2.2.m1.2a"><mrow id="S2.E5Xb.3.2.2.m1.2.2" xref="S2.E5Xb.3.2.2.m1.2.2.cmml"><mi id="S2.E5Xb.3.2.2.m1.2.2.4" xref="S2.E5Xb.3.2.2.m1.2.2.4.cmml"></mi><mo id="S2.E5Xb.3.2.2.m1.2.2.3" xref="S2.E5Xb.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S2.E5Xb.3.2.2.m1.2.2.2" xref="S2.E5Xb.3.2.2.m1.2.2.2.cmml"><msub id="S2.E5Xb.3.2.2.m1.2.2.2.4" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.cmml"><mi id="S2.E5Xb.3.2.2.m1.2.2.2.4.2" mathvariant="normal" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.2.cmml">ℓ</mi><mrow id="S2.E5Xb.3.2.2.m1.2.2.2.4.3" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.cmml"><mi id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.2" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.2.cmml">C</mi><mo id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.1" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.3" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo id="S2.E5Xb.3.2.2.m1.2.2.2.3" xref="S2.E5Xb.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E5Xb.3.2.2.m1.2.2.2.2.2" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.3.cmml">(</mo><mrow id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">P</mi></msub><mo id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msup><mo id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.4" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.2" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.3" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.3.cmml">P</mi></msub><mo id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xb.3.2.2.m1.2b"><apply id="S2.E5Xb.3.2.2.m1.2.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2"><eq id="S2.E5Xb.3.2.2.m1.2.2.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S2.E5Xb.3.2.2.m1.2.2.4.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.4">absent</csymbol><apply id="S2.E5Xb.3.2.2.m1.2.2.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2"><times id="S2.E5Xb.3.2.2.m1.2.2.2.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.3"></times><apply id="S2.E5Xb.3.2.2.m1.2.2.2.4.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E5Xb.3.2.2.m1.2.2.2.4.1.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4">subscript</csymbol><ci id="S2.E5Xb.3.2.2.m1.2.2.2.4.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.2">ℓ</ci><apply id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3"><times id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.1.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.1"></times><ci id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.2">𝐶</ci><ci id="S2.E5Xb.3.2.2.m1.2.2.2.4.3.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="S2.E5Xb.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2"><apply id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1"><times id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.3.3">𝑃</ci></apply><apply id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E5Xb.3.2.2.m1.2.2.2.2.2.2.3">𝑃</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xb.3.2.2.m1.2c">\displaystyle=\ell_{CE}(f_{P}(h^{L}),y_{P})</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xb.3.2.2.m1.2d">= roman_ℓ start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_h start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) , italic_y start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell_{AS}" class="ltx_Math" display="inline" id="S2.E5Xc.2.1.1.m1.1"><semantics id="S2.E5Xc.2.1.1.m1.1a"><msub id="S2.E5Xc.2.1.1.m1.1.1" xref="S2.E5Xc.2.1.1.m1.1.1.cmml"><mi id="S2.E5Xc.2.1.1.m1.1.1.2" mathvariant="normal" xref="S2.E5Xc.2.1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S2.E5Xc.2.1.1.m1.1.1.3" xref="S2.E5Xc.2.1.1.m1.1.1.3.cmml"><mi id="S2.E5Xc.2.1.1.m1.1.1.3.2" xref="S2.E5Xc.2.1.1.m1.1.1.3.2.cmml">A</mi><mo id="S2.E5Xc.2.1.1.m1.1.1.3.1" xref="S2.E5Xc.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E5Xc.2.1.1.m1.1.1.3.3" xref="S2.E5Xc.2.1.1.m1.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E5Xc.2.1.1.m1.1b"><apply id="S2.E5Xc.2.1.1.m1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E5Xc.2.1.1.m1.1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E5Xc.2.1.1.m1.1.1.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.2">ℓ</ci><apply id="S2.E5Xc.2.1.1.m1.1.1.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3"><times id="S2.E5Xc.2.1.1.m1.1.1.3.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3.1"></times><ci id="S2.E5Xc.2.1.1.m1.1.1.3.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3.2">𝐴</ci><ci id="S2.E5Xc.2.1.1.m1.1.1.3.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xc.2.1.1.m1.1c">\displaystyle\ell_{AS}</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xc.2.1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT italic_A italic_S end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\ell_{CE}(f_{AS}(h^{L}),y_{AS})," class="ltx_Math" display="inline" id="S2.E5Xc.3.2.2.m1.1"><semantics id="S2.E5Xc.3.2.2.m1.1a"><mrow id="S2.E5Xc.3.2.2.m1.1.1.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.4" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.4.cmml"></mi><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.cmml"><msub id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.2" mathvariant="normal" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.2.cmml">ℓ</mi><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.2.cmml">C</mi><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.3.cmml">E</mi></mrow></msub><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">A</mi><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">S</mi></mrow></msub><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msup><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.4" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.2.cmml">A</mi><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.1" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.3.cmml">S</mi></mrow></msub><mo id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5Xc.3.2.2.m1.1.1.1.2" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xc.3.2.2.m1.1b"><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1"><eq id="S2.E5Xc.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.3"></eq><csymbol cd="latexml" id="S2.E5Xc.3.2.2.m1.1.1.1.1.4.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.4">absent</csymbol><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2"><times id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.3"></times><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.2">ℓ</ci><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3"><times id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.1"></times><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.2">𝐶</ci><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2"><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1"><times id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2">𝐴</ci><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3">𝑆</ci></apply></apply><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.2">𝑦</ci><apply id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3"><times id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.2">𝐴</ci><ci id="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E5Xc.3.2.2.m1.1.1.1.1.2.2.2.2.3.3">𝑆</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xc.3.2.2.m1.1c">\displaystyle=\ell_{CE}(f_{AS}(h^{L}),y_{AS}),</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xc.3.2.2.m1.1d">= roman_ℓ start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_A italic_S end_POSTSUBSCRIPT ( italic_h start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) , italic_y start_POSTSUBSCRIPT italic_A italic_S end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS3.p1.9">where <math alttext="h^{L}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.1.m1.1"><semantics id="S2.SS1.SSS3.p1.1.m1.1a"><msup id="S2.SS1.SSS3.p1.1.m1.1.1" xref="S2.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.1.m1.1.1.2" xref="S2.SS1.SSS3.p1.1.m1.1.1.2.cmml">h</mi><mi id="S2.SS1.SSS3.p1.1.m1.1.1.3" xref="S2.SS1.SSS3.p1.1.m1.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.1.m1.1b"><apply id="S2.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.1.m1.1.1.2">ℎ</ci><ci id="S2.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS3.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.1.m1.1c">h^{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.1.m1.1d">italic_h start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> is the decoder output, <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.2.m2.1"><semantics id="S2.SS1.SSS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS3.p1.2.m2.1.1" xref="S2.SS1.SSS3.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.2.m2.1b"><ci id="S2.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS3.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.2.m2.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.2.m2.1d">caligraphic_A</annotation></semantics></math> is the set of affix indices, <math alttext="f_{S},f_{A},f_{P}," class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.3.m3.1"><semantics id="S2.SS1.SSS3.p1.3.m3.1a"><mrow id="S2.SS1.SSS3.p1.3.m3.1.1.1"><mrow id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.4.cmml"><msub id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.2" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.2.cmml">f</mi><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.3" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.4" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.4.cmml">,</mo><msub id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.cmml"><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.2" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.2.cmml">f</mi><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.3" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.3.cmml">A</mi></msub><mo id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.5" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.4.cmml">,</mo><msub id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.cmml"><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.2" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.2.cmml">f</mi><mi id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.3" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.3.cmml">P</mi></msub></mrow><mo id="S2.SS1.SSS3.p1.3.m3.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.3.m3.1b"><list id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.4.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3"><apply id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.2">𝑓</ci><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.1.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.2">𝑓</ci><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.3.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.2.2.3">𝐴</ci></apply><apply id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.2">𝑓</ci><ci id="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.3.cmml" xref="S2.SS1.SSS3.p1.3.m3.1.1.1.1.3.3.3">𝑃</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.3.m3.1c">f_{S},f_{A},f_{P},</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ,</annotation></semantics></math> and <math alttext="f_{AS}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.4.m4.1"><semantics id="S2.SS1.SSS3.p1.4.m4.1a"><msub id="S2.SS1.SSS3.p1.4.m4.1.1" xref="S2.SS1.SSS3.p1.4.m4.1.1.cmml"><mi id="S2.SS1.SSS3.p1.4.m4.1.1.2" xref="S2.SS1.SSS3.p1.4.m4.1.1.2.cmml">f</mi><mrow id="S2.SS1.SSS3.p1.4.m4.1.1.3" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.4.m4.1.1.3.2" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.2.cmml">A</mi><mo id="S2.SS1.SSS3.p1.4.m4.1.1.3.1" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS3.p1.4.m4.1.1.3.3" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.4.m4.1b"><apply id="S2.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.4.m4.1.1.1.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.4.m4.1.1.2.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1.2">𝑓</ci><apply id="S2.SS1.SSS3.p1.4.m4.1.1.3.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1.3"><times id="S2.SS1.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.1"></times><ci id="S2.SS1.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.2">𝐴</ci><ci id="S2.SS1.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.4.m4.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.4.m4.1c">f_{AS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_A italic_S end_POSTSUBSCRIPT</annotation></semantics></math> are prediction heads transforming the decoder output to probabilities over the sets of stems, affixes, POS tags and affix sets respectively. <math alttext="y_{S},y_{A},y_{P}," class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.5.m5.1"><semantics id="S2.SS1.SSS3.p1.5.m5.1a"><mrow id="S2.SS1.SSS3.p1.5.m5.1.1.1"><mrow id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.4.cmml"><msub id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.2" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.3" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.4" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.4.cmml">,</mo><msub id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.cmml"><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.2" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.3" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.3.cmml">A</mi></msub><mo id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.5" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.4.cmml">,</mo><msub id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.cmml"><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.2" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.2.cmml">y</mi><mi id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.3" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.3.cmml">P</mi></msub></mrow><mo id="S2.SS1.SSS3.p1.5.m5.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.5.m5.1b"><list id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.4.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3"><apply id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.1.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.3.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.2.2.3">𝐴</ci></apply><apply id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.2">𝑦</ci><ci id="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.3.cmml" xref="S2.SS1.SSS3.p1.5.m5.1.1.1.1.3.3.3">𝑃</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.5.m5.1c">y_{S},y_{A},y_{P},</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ,</annotation></semantics></math> and <math alttext="y_{AS}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.6.m6.1"><semantics id="S2.SS1.SSS3.p1.6.m6.1a"><msub id="S2.SS1.SSS3.p1.6.m6.1.1" xref="S2.SS1.SSS3.p1.6.m6.1.1.cmml"><mi id="S2.SS1.SSS3.p1.6.m6.1.1.2" xref="S2.SS1.SSS3.p1.6.m6.1.1.2.cmml">y</mi><mrow id="S2.SS1.SSS3.p1.6.m6.1.1.3" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.6.m6.1.1.3.2" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.2.cmml">A</mi><mo id="S2.SS1.SSS3.p1.6.m6.1.1.3.1" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS3.p1.6.m6.1.1.3.3" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.6.m6.1b"><apply id="S2.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.6.m6.1.1.1.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.6.m6.1.1.2.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1.2">𝑦</ci><apply id="S2.SS1.SSS3.p1.6.m6.1.1.3.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1.3"><times id="S2.SS1.SSS3.p1.6.m6.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.1"></times><ci id="S2.SS1.SSS3.p1.6.m6.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.2">𝐴</ci><ci id="S2.SS1.SSS3.p1.6.m6.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.6.m6.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.6.m6.1c">y_{AS}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_A italic_S end_POSTSUBSCRIPT</annotation></semantics></math> respectively correspond to the stem, affixes, POS tags and affix set of a target word <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.7.m7.1"><semantics id="S2.SS1.SSS3.p1.7.m7.1a"><mi id="S2.SS1.SSS3.p1.7.m7.1.1" xref="S2.SS1.SSS3.p1.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.7.m7.1b"><ci id="S2.SS1.SSS3.p1.7.m7.1.1.cmml" xref="S2.SS1.SSS3.p1.7.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.7.m7.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.7.m7.1d">italic_y</annotation></semantics></math>. <math alttext="\ell_{CE}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.8.m8.1"><semantics id="S2.SS1.SSS3.p1.8.m8.1a"><msub id="S2.SS1.SSS3.p1.8.m8.1.1" xref="S2.SS1.SSS3.p1.8.m8.1.1.cmml"><mi id="S2.SS1.SSS3.p1.8.m8.1.1.2" mathvariant="normal" xref="S2.SS1.SSS3.p1.8.m8.1.1.2.cmml">ℓ</mi><mrow id="S2.SS1.SSS3.p1.8.m8.1.1.3" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.8.m8.1.1.3.2" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.2.cmml">C</mi><mo id="S2.SS1.SSS3.p1.8.m8.1.1.3.1" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS3.p1.8.m8.1.1.3.3" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.8.m8.1b"><apply id="S2.SS1.SSS3.p1.8.m8.1.1.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.8.m8.1.1.1.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.8.m8.1.1.2.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1.2">ℓ</ci><apply id="S2.SS1.SSS3.p1.8.m8.1.1.3.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1.3"><times id="S2.SS1.SSS3.p1.8.m8.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.1"></times><ci id="S2.SS1.SSS3.p1.8.m8.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.2">𝐶</ci><ci id="S2.SS1.SSS3.p1.8.m8.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.8.m8.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.8.m8.1c">\ell_{CE}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.8.m8.1d">roman_ℓ start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT</annotation></semantics></math> is a cross-entropy loss function and <math alttext="\ell_{BCE}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.9.m9.1"><semantics id="S2.SS1.SSS3.p1.9.m9.1a"><msub id="S2.SS1.SSS3.p1.9.m9.1.1" xref="S2.SS1.SSS3.p1.9.m9.1.1.cmml"><mi id="S2.SS1.SSS3.p1.9.m9.1.1.2" mathvariant="normal" xref="S2.SS1.SSS3.p1.9.m9.1.1.2.cmml">ℓ</mi><mrow id="S2.SS1.SSS3.p1.9.m9.1.1.3" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.9.m9.1.1.3.2" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.2.cmml">B</mi><mo id="S2.SS1.SSS3.p1.9.m9.1.1.3.1" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS3.p1.9.m9.1.1.3.3" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.3.cmml">C</mi><mo id="S2.SS1.SSS3.p1.9.m9.1.1.3.1a" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS3.p1.9.m9.1.1.3.4" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.9.m9.1b"><apply id="S2.SS1.SSS3.p1.9.m9.1.1.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.9.m9.1.1.1.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.9.m9.1.1.2.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.2">ℓ</ci><apply id="S2.SS1.SSS3.p1.9.m9.1.1.3.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.3"><times id="S2.SS1.SSS3.p1.9.m9.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.1"></times><ci id="S2.SS1.SSS3.p1.9.m9.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.2">𝐵</ci><ci id="S2.SS1.SSS3.p1.9.m9.1.1.3.3.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.3">𝐶</ci><ci id="S2.SS1.SSS3.p1.9.m9.1.1.3.4.cmml" xref="S2.SS1.SSS3.p1.9.m9.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.9.m9.1c">\ell_{BCE}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.9.m9.1d">roman_ℓ start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT</annotation></semantics></math> is a binary cross-entropy loss function.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS3.p2">
<p class="ltx_p" id="S2.SS1.SSS3.p2.1">A naive approach to the MTML problem consists of summing up all the losses and optimizing the sum. However, this can lead to a biased outcome since individual losses take on different ranges and have varying levels of optimization difficulty. Complicating the problem further is the fact that individual objectives can contribute conflicting gradients, making it harder to train the multi-task model with standard gradient descent algorithms. A potential solution to this problem comes form the multi-lingual NMT literature with a scheme called Gradient Vaccine <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib36" title="">2020</a>)</cite>. This method attempts to mediate conflicting gradient updates from individual losses by encouraging more geometrically aligned parameter updates. We evaluate both the naive summation and the Gradient Vaccine methods in our experiments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.4 </span>Morphological inference</h4>
<div class="ltx_para" id="S2.SS1.SSS4.p1">
<p class="ltx_p" id="S2.SS1.SSS4.p1.1">The decoder architecture presented in subsection <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1.SSS3" title="2.1.3 Target-side morphology learning ‣ 2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2.1.3</span></a> only predicts separate probabilities for stem, POS tag, affix set and affixes. But the translation task must produce surface forms to generate the output text. The challenge of this task is that greedily picking the items with maximum probability may not produce the best output and may even produce incompatible stems and affixes, that is, we must produce a stem and affixes of the same inflection group (e.g. verb, noun, pronoun, etc..). It is also known that beam search algorithm generally produces better sequence outputs than greedy decoding. Therefore, we design an adaptation of the beam search algorithm, where at each step, we produce a list of scored candidate surface forms together with their morphological information to feed back to the decoder’s input. The design criteria is to make sure the top predicted items can form compatible pairs of stems and affix sets. The main requirement for the algorithm is the availability of a morphological synthesizer that can produce surface forms given an inflection group, the stem and compatible affixes. The morphological synthesizer must also respect all existing morpho-graphemic rules for the language. We we provide detailed pseudocode for the decoding algorithm in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A3" title="Appendix C Morphological decoding algorithm ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">C</span></a>. The algorithm has 4 basic steps:</p>
<ol class="ltx_enumerate" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p" id="S2.I2.i1.p1.1">voting on inflection group</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p" id="S2.I2.i2.p1.1">filtering out less probable stems and affixes</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I2.i3.p1">
<p class="ltx_p" id="S2.I2.i3.p1.1">selecting target affixes, and finally</p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S2.I2.i4.p1">
<p class="ltx_p" id="S2.I2.i4.p1.1">morphological synthesis for each final stem and affixes combination.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Dataset</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Dataset development and data-centric approaches to neural machine translation (NMT) are of paramount importance for low-resource languages. This is because the most limiting factor is the scarcity of parallel data. While describing the data collection process and pre-processing steps is important, it is equally important to fully disclose the data provenance as there are typically a limited number of sources of parallel data per language. We conduct our experiments using public-domain parallel text. In this section, we describe our parallel data gathering process as well as the reliable sources we used to source Kinyarwanda-English bitext. We also describe simple data augmentation techniques we used to boost the performance of our experimental models. Due to copyright and licensing restrictions, we cannot redistribute our experimental dataset. Instead, we release the tools used for their construction from original sources. The sizes of the parallel datasets we gathered are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A2" title="Appendix B Dataset summary ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Official Gazette</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Official gazettes are periodical government journals typically with policy and regulation content. When a country has multiple official languages, content may be available as parallel text with each paragraph of the journal available in each official language. We took this opportunity and collected an experimental parallel text from the Official Gazette of the Republic of Rwanda<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.minijust.gov.rw/official-gazette" title="">https://www.minijust.gov.rw/official-gazette</a></span></span></span>, where Kinyarwanda, French, English and Swahili are all official languages. This is an important source of parallel text given that it covers multiple sectors and is usually written with high standards by professionals, part of a dedicated government agency.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">The main content of Rwanda’s official gazette is provided in a multi-column portable document format (PDF), mostly 3 columns for Kinyarwanda, English and French. In our experiments, we process page content streams by making low level modifications to Apache PDFBox Java library<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://pdfbox.apache.org/" title="">https://pdfbox.apache.org/</a></span></span></span>, where the inputs are unordered set of raw characters with their X-Y page coordinates and font information. We track columns by detecting margins (by sorting X-coordinates of glyphs) and reconstruct text across consecutive pages. A key opportunity for parallel alignment comes from the fact that most official gazettes paragraphs are grouped by consecutive article numbers such as “Ingingo ya 1/Article 1”, “Ingingo ya 2/Article 2”, and so on. We use these article enumerations as anchors to finding parallel paragraphs across the three languages. A language identification component is also required to know which column correspond with which language as the column ordering has been changing over time.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Jw.org website</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Jw.org website publishes religious and biblical teachings by Jehovah’s Witnesses, with cross-references into multiple languages. While this website data has been used for low-resource machine translation before <cite class="ltx_cite ltx_citemacro_cite">Agić and Vulić (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib2" title="">2019</a>)</cite>, the isolated corpus is no longer available due to license restrictions. However, the content of the original website is still available to web browsers and crawlers. We take this advantage and gather data from the site to experiment with English<math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><mo id="S2.SS4.p1.1.m1.1.1" stretchy="false" xref="S2.SS4.p1.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">↔</annotation></semantics></math>Kinyarwanda machine translation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Bilingual dictionaries</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">Bilingual dictionaries are also useful for low-resource machine translation. While most of their parallel data are made of single words, they can still contribute to the translation task, albeit without any sentence-level context.
The 2006 version of the Iriza dictionary <cite class="ltx_cite ltx_citemacro_cite">Habumuremyi and Uwamahoro (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib10" title="">2006</a>)</cite> is generally publicly available in PDF format. Similar to the Official Gazette case, we use low level modifications to the Apache PDFBox library and extract dictionary entries grouped by a source word and a target synset. Another bilingual dictionary we used is <span class="ltx_text ltx_font_italic" id="S2.SS5.p1.1.1">kinyarwanda.net</span> website<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://kinyarwanda.digital/" title="">https://kinyarwanda.digital/</a></span></span></span>, which was developed by volunteers to help people learning Kinyarwanda or English. In addition to these bilingual dictionaries, we manually translated about 8,000 Kinyarwanda words whose stems could not be found in any of the existing parallel data sources. Some of these terms include recently incorporated but frequently used Kinyarwanda words such as loanwords and also alternate common spellings. Examples include words such as: ‘abazunguzayi’ (<span class="ltx_text ltx_font_italic" id="S2.SS5.p1.1.2">hawkers</span>), ‘akabyiniro’ (<span class="ltx_text ltx_font_italic" id="S2.SS5.p1.1.3">night club</span>), ‘canke’ (from Kirundi: <span class="ltx_text ltx_font_italic" id="S2.SS5.p1.1.4">or</span>), ‘mitiweli’ (from French: “mutuelle santé”). Together with data from bilingual dictionaries, the above dataset forms a special training subset we call ‘lexical data’, because it augments the lexical coverage of our main dataset. We evaluate its effectiveness in our experiments.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6 </span>Monolingual data</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.1">Backtranslation <cite class="ltx_cite ltx_citemacro_cite">Edunov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib9" title="">2018</a>)</cite> is a proven technique for leveraging monolingual data in machine translation. We developed a corpus of Kinyarwanda text by crawling more than 200 websites and extracting text from several books to form a monolingual dataset to use for back-translation. The final corpus contains about 400 million words and tokens or 16 million sentences. We also formed an English text corpus of similar size by crawling eight major Rwandan and East African English newspapers (3.3 million sentences) in addition to Wikipedia English corpus (7.3 million sentences)<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.kaggle.com/datasets/mikeortman/wikipedia-sentences" title="">https://www.kaggle.com/datasets/mikeortman/wikipedia-sentences</a></span></span></span> and global English news data (5.4 million sentences)<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://data.statmt.org/news-crawl/en/news.2020.en.shuffled.deduped.gz" title="">https://data.statmt.org/news-crawl/en/news.2020.en.shuffled.deduped.gz</a></span></span></span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7 </span>Data augmentations</h3>
<div class="ltx_para" id="S2.SS7.p1">
<p class="ltx_p" id="S2.SS7.p1.1">Source to target copying in NMT is a desirable ability when faced with untranslatable terms such as proper names. However, when the source and target vocabularies are not shared, it is harder for the model to learn this ability.
In order to enforce this copying ability in our NMT model, we take a data-centric approach by including untranslatable terms in our dataset with the same source and target text. This augmentation includes the following datasets: (1) All numeric tokens and proper names from our Kinyarwanda monolingual corpus, (2) Names of locations from the World Cities dataset<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/datasets/world-cities/blob/master/data/world-cities.csv" title="">https://github.com/datasets/world-cities/blob/master/data/world-cities.csv</a></span></span></span>, and (3) Names of people from CMU Names corpus <cite class="ltx_cite ltx_citemacro_cite">Kantrowitz and Ross (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib12" title="">2018</a>)</cite> and the Names Dataset <cite class="ltx_cite ltx_citemacro_cite">Remy (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib30" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS7.p2">
<p class="ltx_p" id="S2.SS7.p2.1">We also add synthetic data for number spellings by using rule-based synthesizers to spell 200,000 random integers between zero and 999 billions. For Kinyarwanda side, we developed our own synthesizer, while we used <span class="ltx_text ltx_font_typewriter" id="S2.SS7.p2.1.1">inflect</span> python package<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://pypi.org/project/inflect/" title="">https://pypi.org/project/inflect/</a></span></span></span> for English.</p>
</div>
<div class="ltx_para" id="S2.SS7.p3">
<p class="ltx_p" id="S2.SS7.p3.1">Code-switching is one characteristic of some low-resource languages such as Kinyarwanda. To cope with this issue, we add foreign language terms and their English translations to the training dataset for Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S2.SS7.p3.1.m1.1"><semantics id="S2.SS7.p3.1.m1.1a"><mo id="S2.SS7.p3.1.m1.1.1" stretchy="false" xref="S2.SS7.p3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.SS7.p3.1.m1.1b"><ci id="S2.SS7.p3.1.m1.1.1.cmml" xref="S2.SS7.p3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p3.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.SS7.p3.1.m1.1d">→</annotation></semantics></math> English models as if the foreign terms were valid Kinyarwanda inputs. For this, we include all English phrases from <span class="ltx_text ltx_font_italic" id="S2.SS7.p3.1.1">kinyarwanda.net</span> online dictionary, 100 popular French terms and 20 popular Swahili terms.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental setup</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">The model presented in section <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S2.SS1" title="2.1 Model architecture ‣ 2 Methods ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2.1</span></a> was implemented from scratch using PyTorch framework <cite class="ltx_cite ltx_citemacro_cite">Paszke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib26" title="">2019</a>)</cite> version 1.13.1. Our model hyper-parameters along with training and inference hyper-parameters are provided in appendix <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A1" title="Appendix A Model, training and inference hyper-parameters ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">A</span></a>. Training was done using a hardware platform with 8 Nvidia RTX 4090 GPUs, with 256 gigabytes of system memory, on a Linux operating system. We used mixed precision training with lower precision in BFLOAT-16 format. For Kinyarwanda<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mo id="S3.SS1.p1.1.m1.1.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">→</annotation></semantics></math>English model, one gradient update step takes 0.5 second and convergence is achieved after 40 epochs. For English<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mo id="S3.SS1.p1.2.m2.1.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">→</annotation></semantics></math>Kinyarwanda model with Gradient Vaccine scheme, one gradient update step takes 1.1 seconds while convergence is achieved after 8 epochs.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">In all our experiments on Kinyarwanda <math alttext="\leftrightarrow" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mo id="S3.SS1.p2.1.m1.1.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.1.cmml">↔</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">↔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\leftrightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">↔</annotation></semantics></math> English translation, only Kinyarwanda side (as source or target) is morphologically modelled, while the English side always uses sub-word tokenization. For Kinyarwanda source side with attention augmentation, we use a pre-trained BERT model similar to KinyaBERT <cite class="ltx_cite ltx_citemacro_cite">Nzeyimana and Rubungo (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib23" title="">2022</a>)</cite> whose input units/token ids are the same as for the NMT encoder. In fact, this pre-trained KinyaBERT model has the same two-tier architecture as the NMT encoder. Therefore, they are aligned to the same words/tokens. We use a Kinyarwanda morphological analyzer<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/anzeyimana/DeepKIN" title="">https://github.com/anzeyimana/DeepKIN</a></span></span></span> to perform both tokenization, morphological analysis and disambiguation <cite class="ltx_cite ltx_citemacro_cite">Nzeyimana (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib22" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">On English sides (either source or target), we do not perform morphological analysis and only use a standard single-tier transformer architecture. On the source side, we use a BPE-based tokenization and a corresponding pre-trained RoBERTA model provided by fairseq package <cite class="ltx_cite ltx_citemacro_cite">Ott et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib24" title="">2019</a>)</cite>. Similarly, on English target side, we use a BPE-based tokenization from a Transformer-based auto-regressive English language model <cite class="ltx_cite ltx_citemacro_cite">Ng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib20" title="">2019</a>)</cite> from the same fairseq package.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.3" style="width:424.9pt;height:62.4pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-36.3pt,5.3pt) scale(0.854017912231684,0.854017912231684) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.3.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T1.3.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T1.3.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T1.3.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T1.3.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.1.1.5.1">Average</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T1.3.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.2.1.1.1">Use copy data?</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.3.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</td>
<td class="ltx_td ltx_align_center" id="S3.T1.3.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</td>
<td class="ltx_td ltx_align_center" id="S3.T1.3.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.1.2.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</td>
<td class="ltx_td ltx_align_center" id="S3.T1.3.1.2.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.1.2.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">CHR++</td>
</tr>
<tr class="ltx_tr" id="S3.T1.3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.3.1.3.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">No</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.3.1.3.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.1.3.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.3.1.3.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.1.3.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.3.1.3.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.1.3.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.3.1.3.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.3.1.3.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.6</th>
</tr>
<tr class="ltx_tr" id="S3.T1.3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S3.T1.3.1.4.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Yes</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.3.1.4.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.2.1">56.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.1.4.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.3.1">40.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.3.1.4.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.4.1">54.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.1.4.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.5.1">39.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.3.1.4.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.6.1">52.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.1.4.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.7.1">34.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.3.1.4.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.8.1">54.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.3.1.4.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.3.1.4.3.9.1">38.0</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Impact of proper name copying ability: <span class="ltx_text ltx_font_bold" id="S3.T1.2.1">Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T1.2.1.m1.1"><semantics id="S3.T1.2.1.m1.1b"><mo id="S3.T1.2.1.m1.1.1" stretchy="false" xref="S3.T1.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.1.m1.1c"><ci id="S3.T1.2.1.m1.1.1.cmml" xref="S3.T1.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.1.m1.1e">→</annotation></semantics></math> English</span>. Maximum scores are shown in bold.</figcaption>
</figure>
<figure class="ltx_table" id="S3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.1" style="width:424.9pt;height:81pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-73.2pt,13.8pt) scale(0.7436693792777,0.7436693792777) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.2.1">#Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T2.1.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T2.1.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T2.1.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T2.1.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.6.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T2.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">Setup</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T2.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1">(<math alttext="\times" class="ltx_Math" display="inline" id="S3.T2.1.1.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.1.m1.1b"><times id="S3.T2.1.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.1.1.m1.1d">×</annotation></semantics></math> 1M)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">CHR++</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">188</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.5</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T2.1.1.4.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text" id="S3.T2.1.1.4.2.1.1"></span> + XPOS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.4.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">190</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.9</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.8</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T2.1.1.5.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text" id="S3.T2.1.1.5.3.1.1"></span> + BERT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.1.5.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">190</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.5.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.5</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.5.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.5.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.3</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.5.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.5.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.7</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S3.T2.1.1.6.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text" id="S3.T2.1.1.6.4.1.1"></span> + BERT + XPOS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T2.1.1.6.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">192</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.1.6.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.3.1">59.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T2.1.1.6.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.4.1">43.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.1.6.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.5.1">58.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T2.1.1.6.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.6.1">41.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.1.6.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.7.1">56.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T2.1.1.6.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.8.1">37.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.1.6.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.9.1">58.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T2.1.1.6.4.10" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.6.4.10.1">40.5</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Impact of attention augmentation: <span class="ltx_text ltx_font_bold" id="S3.T2.3.1">Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T2.3.1.m1.1"><semantics id="S3.T2.3.1.m1.1b"><mo id="S3.T2.3.1.m1.1.1" stretchy="false" xref="S3.T2.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.1.m1.1c"><ci id="S3.T2.3.1.m1.1.1.cmml" xref="S3.T2.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.1.m1.1e">→</annotation></semantics></math> English</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.3" style="width:424.9pt;height:48.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-110.3pt,12.3pt) scale(0.65820587210734,0.65820587210734) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T3.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.3.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T3.3.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T3.3.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T3.3.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T3.3.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.1.5.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T3.3.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.2.2.1.1">Setup</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T3.3.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T3.3.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T3.3.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.3.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T3.3.1.2.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">CHR++</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.3.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.3.1.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho + BERT + XPOS without Lexical Data</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.1.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.3.1.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.1.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.3.1.3.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.1.3.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.3.1.3.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.1.3.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.3.1.3.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.2</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S3.T3.3.1.4.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho + BERT + XPOS + Lexical Data</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.3.1.4.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.2.1">59.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T3.3.1.4.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.3.1">43.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.3.1.4.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.4.1">58.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T3.3.1.4.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.5.1">41.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.3.1.4.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.6.1">56.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T3.3.1.4.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.7.1">37.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.3.1.4.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.8.1">58.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T3.3.1.4.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.4.2.9.1">40.5</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Impact of lexical data (bilingual dictionaries): <span class="ltx_text ltx_font_bold" id="S3.T3.2.1">Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T3.2.1.m1.1"><semantics id="S3.T3.2.1.m1.1b"><mo id="S3.T3.2.1.m1.1.1" stretchy="false" xref="S3.T3.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.1.m1.1c"><ci id="S3.T3.2.1.m1.1.1.cmml" xref="S3.T3.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.1.m1.1e">→</annotation></semantics></math> English</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.1" style="width:424.9pt;height:52.9pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-80.3pt,9.9pt) scale(0.725678177042765,0.725678177042765) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.1.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T4.1.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.1.2.1">#Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T4.1.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T4.1.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T4.1.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T4.1.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.1.6.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T4.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.2.1">Setup</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T4.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1.1">(<math alttext="\times" class="ltx_Math" display="inline" id="S3.T4.1.1.1.1.1.m1.1"><semantics id="S3.T4.1.1.1.1.1.m1.1a"><mo id="S3.T4.1.1.1.1.1.m1.1.1" xref="S3.T4.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.1.1.m1.1b"><times id="S3.T4.1.1.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T4.1.1.1.1.1.m1.1d">×</annotation></semantics></math> 1M)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T4.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T4.1.1.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T4.1.1.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T4.1.1.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">CHR++</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">BPE Seq2Seq + XPOS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">187</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">30.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.5</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S3.T4.1.1.4.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho + XPOS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T4.1.1.4.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">190</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.1.1.4.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.3.1">57.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.1.1.4.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.4.1">41.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.1.1.4.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.5.1">55.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.1.1.4.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.6.1">39.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.1.1.4.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.7.1">54.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.1.1.4.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.8.1">35.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.1.1.4.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.9.1">55.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.1.1.4.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.4.2.10.1">38.8</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Impact of source side morphological modeling: <span class="ltx_text ltx_font_bold" id="S3.T4.3.1">Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T4.3.1.m1.1"><semantics id="S3.T4.3.1.m1.1b"><mo id="S3.T4.3.1.m1.1.1" stretchy="false" xref="S3.T4.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T4.3.1.m1.1c"><ci id="S3.T4.3.1.m1.1.1.cmml" xref="S3.T4.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.3.1.m1.1e">→</annotation></semantics></math> English</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T5.1" style="width:424.9pt;height:73.2pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-104.0pt,17.7pt) scale(0.671466298215754,0.671466298215754) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.1.1.2.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T5.1.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T5.1.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T5.1.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T5.1.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T5.1.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T5.1.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.2.1.6.1">Average</span></th>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T5.1.1.3.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.3.2.1.1">Setup</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T5.1.1.3.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.3.2.2.1">#Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.3.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.3.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.3.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.3.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.3.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.3.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.3.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.3.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T5.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T5.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.1">(<math alttext="\times" class="ltx_Math" display="inline" id="S3.T5.1.1.1.1.1.m1.1"><semantics id="S3.T5.1.1.1.1.1.m1.1a"><mo id="S3.T5.1.1.1.1.1.m1.1.1" xref="S3.T5.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.1.m1.1b"><times id="S3.T5.1.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T5.1.1.1.1.1.m1.1d">×</annotation></semantics></math> 1M)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T5.1.1.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">ChrF++</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.1.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">BPE Seq2Seq + XPOS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">187</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">30.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">31.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.4.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.7</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T5.1.1.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho + XPOS (Loss summation)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T5.1.1.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">196</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.2</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">32.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.5.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.0</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.5.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.0</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S3.T5.1.1.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Morpho + XPOS + GradVacc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T5.1.1.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">196</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.1.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.3.1">37.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T5.1.1.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.4.1">38.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.1.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.5.1">41.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T5.1.1.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.6.1">42.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.1.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.7.1">32.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T5.1.1.6.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.8.1">33.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T5.1.1.6.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.9.1">37.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T5.1.1.6.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.6.3.10.1">38.0</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Impact of target side morphological modeling: <span class="ltx_text ltx_font_bold" id="S3.T5.3.1">English <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T5.3.1.m1.1"><semantics id="S3.T5.3.1.m1.1b"><mo id="S3.T5.3.1.m1.1.1" stretchy="false" xref="S3.T5.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T5.3.1.m1.1c"><ci id="S3.T5.3.1.m1.1.1.cmml" xref="S3.T5.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.1.m1.1e">→</annotation></semantics></math> Kinyarwanda</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T6.3" style="width:424.9pt;height:101.7pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-127.8pt,30.4pt) scale(0.624335650163469,0.624335650163469) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T6.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T6.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T6.3.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T6.3.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T6.3.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T6.3.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T6.3.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.2.2.1.1">Setup</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T6.3.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.2.2.2.1">#Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.3.3">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T6.3.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.3.3.2.1">x 1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T6.3.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T6.3.1.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.3.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T6.3.1.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T6.3.1.4.1.1.1">Morpho + XPOS + BERT + Backtransl. (<span class="ltx_text ltx_font_bold" id="S3.T6.3.1.4.1.1.1.1">Ours</span>)</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T6.3.1.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">403</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.1.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.4.1.3.1">53.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T6.3.1.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.4.1.4.1">53.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.1.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.4.1.5.1">58.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T6.3.1.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.4.1.6.1">61.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.1.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.7*</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T6.3.1.4.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.2*</td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Helsinki-opus-mt <cite class="ltx_cite ltx_citemacro_cite">Tiedemann and Thottingal (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib34" title="">2020</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T6.3.1.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">76</th>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.7</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.3</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">27.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.5.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">27.2</td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NLLB-200 600M (distilled) <cite class="ltx_cite ltx_citemacro_cite">Costa-jussà et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib6" title="">2022</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T6.3.1.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">600</th>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.5</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.7</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.6.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.3</td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.7.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mBART <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib17" title="">2020</a>)</cite> fine-tuned on our dataset</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T6.3.1.7.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">610</th>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.7.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.7.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.5</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.7.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.7.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.1</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.7.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.7.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.2</td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T6.3.1.8.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NLLB-200 3.3B <cite class="ltx_cite ltx_citemacro_cite">Costa-jussà et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib6" title="">2022</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T6.3.1.8.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">3,300</th>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.8.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.8.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.9</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.8.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T6.3.1.8.5.5.1">57.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.8.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.6</td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.1.8.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T6.3.1.8.5.7.1">50.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T6.3.1.8.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T6.3.1.8.5.8.1">52.4</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.1.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T6.3.1.9.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Google Translate</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T6.3.1.9.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T6.3.1.9.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T6.3.1.9.6.3.1">59.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T6.3.1.9.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T6.3.1.9.6.4.1">60.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T6.3.1.9.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T6.3.1.9.6.5.1">76.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T6.3.1.9.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T6.3.1.9.6.6.1">87.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T6.3.1.9.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.5</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T6.3.1.9.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.6</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span><span class="ltx_text ltx_font_bold" id="S3.T6.2.1">English <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T6.2.1.m1.1"><semantics id="S3.T6.2.1.m1.1b"><mo id="S3.T6.2.1.m1.1.1" stretchy="false" xref="S3.T6.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T6.2.1.m1.1c"><ci id="S3.T6.2.1.m1.1.1.cmml" xref="S3.T6.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.2.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T6.2.1.m1.1e">→</annotation></semantics></math> Kinyarwanda</span>: Comparison of our large model performance after back-translation in relation to open-source models and Google Translate. chrF2 scores are computed using SacreBLEU <cite class="ltx_cite ltx_citemacro_citep">(Post, <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib28" title="">2018</a>)</cite> with 10000 bootstraps for significance testing. Highest scores among open source models (p-value &lt; 0.002) are shown in bold. Overall best scores are underlined. *On TICO-19, our model outperforms Google Translate (p-value &lt; 0.002).</figcaption>
</figure>
<figure class="ltx_table" id="S3.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T7.3" style="width:424.9pt;height:101.7pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-127.8pt,30.4pt) scale(0.624335650163469,0.624335650163469) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T7.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T7.3.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T7.3.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T7.3.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T7.3.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">FLORES-200</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T7.3.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">MAFAND-MT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="S3.T7.3.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">TICO-19</th>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.2.2.1.1">Setup</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T7.3.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.2.2.2.1">#Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dev</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Test</th>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.3.3">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T7.3.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.3.3.2.1">x 1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T7.3.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T7.3.1.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">chrF2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T7.3.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T7.3.1.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.1.4.1.1.1">Morpho + XPOS + BERT + Backtransl. (<span class="ltx_text ltx_font_bold" id="S3.T7.3.1.4.1.1.1.1">Ours</span>)</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T7.3.1.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">396</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.4.1.5.1">54.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.4.1.6.1">59.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.1.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.1.4.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.1</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Helsinki-opus-mt <cite class="ltx_cite ltx_citemacro_cite">Tiedemann and Thottingal (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib34" title="">2020</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T7.3.1.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">76</th>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.1</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.1</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">29.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.5.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">29.7</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NLLB-200 600M (distilled) <cite class="ltx_cite ltx_citemacro_cite">Costa-jussà et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib6" title="">2022</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T7.3.1.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">600</th>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.3</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.9</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.6.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.6</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.7.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mBART <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib17" title="">2020</a>)</cite> fine-tuned on our dataset</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T7.3.1.7.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">610</th>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.1</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.0</td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.7.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.7.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.8</td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S3.T7.3.1.8.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NLLB-200 3.3B <cite class="ltx_cite ltx_citemacro_cite">Costa-jussà et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib6" title="">2022</a>)</cite>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T7.3.1.8.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">3,300</th>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.8.5.3.1">56.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.8.5.4.1">56.0</span></td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.8.5.5.1">55.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T7.3.1.8.5.6.1">59.6</span></td>
<td class="ltx_td ltx_align_center" id="S3.T7.3.1.8.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T7.3.1.8.5.7.1">53.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.3.1.8.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S3.T7.3.1.8.5.8.1">54.1</span></td>
</tr>
<tr class="ltx_tr" id="S3.T7.3.1.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T7.3.1.9.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Google Translate</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T7.3.1.9.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T7.3.1.9.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.1.9.6.3.1">60.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T7.3.1.9.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.1.9.6.4.1">59.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T7.3.1.9.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.1.9.6.5.1">57.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T7.3.1.9.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.1.9.6.6.1">64.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T7.3.1.9.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.8</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T7.3.1.9.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.4</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="ltx_text ltx_font_bold" id="S3.T7.2.1">Kinyarwanda <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T7.2.1.m1.1"><semantics id="S3.T7.2.1.m1.1b"><mo id="S3.T7.2.1.m1.1.1" stretchy="false" xref="S3.T7.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T7.2.1.m1.1c"><ci id="S3.T7.2.1.m1.1.1.cmml" xref="S3.T7.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T7.2.1.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T7.2.1.m1.1e">→</annotation></semantics></math> English</span>: Comparison of our large model performance after back-translation in relation to open-source models and Google Translate. chrF2 scores are computed using SacreBLEU <cite class="ltx_cite ltx_citemacro_citep">(Post, <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib28" title="">2018</a>)</cite> with 10000 bootstraps for significance testing. Highest scores among open source models (p-value &lt; 0.002) are shown in bold. Overall best scores are underlined.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Evaluation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">We evaluate our models on three different benchmarks that include Kinyarwanda, namely FLORES-200 <cite class="ltx_cite ltx_citemacro_cite">Costa-jussà et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib6" title="">2022</a>)</cite>, MAFAND-MT <cite class="ltx_cite ltx_citemacro_cite">Adelani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib1" title="">2022</a>)</cite> and TICO-19 <cite class="ltx_cite ltx_citemacro_cite">Anastasopoulos et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib3" title="">2020</a>)</cite>. This allow us to have a picture on how the models perform on different domains, respectively Wikipedia, News and Covid-19. Our main evaluation metric is ChrF++ <cite class="ltx_cite ltx_citemacro_cite">Popović (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib27" title="">2017</a>)</cite> which includes both character-level and word-level n-gram evaluation, does not rely to any sub-word tokenization and has been shown to correlate better with human judgements than the more traditional BLUE score. We use TorchMetrics <cite class="ltx_cite ltx_citemacro_cite">Detlefsen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib7" title="">2022</a>)</cite> package’s default implementation of ChrF++. For Kinyarwanda<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mo id="S3.SS2.p1.1.m1.1.1" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">→</annotation></semantics></math> English translation, we also evaluate with BLEURT scores <cite class="ltx_cite ltx_citemacro_cite">Sellam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib31" title="">2020</a>)</cite>, an embedding-based metric with higher correlation with human judgement. We use a pre-trained PyTorch implementation of BLEURT<span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/lucadiliello/bleurt-pytorch" title="">https://github.com/lucadiliello/bleurt-pytorch</a></span></span></span>. We did not use BLEURT scores for English<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mo id="S3.SS2.p1.2.m2.1.1" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">→</annotation></semantics></math>Kinyarwanda because there was no available pre-trained BLEURT model for Kinyarwanda and the pre-training cost is very high.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">The baseline BPE-based models in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T4" title="Table 4 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T5" title="Table 5 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">5</span></a> use a SentencePiece <cite class="ltx_cite ltx_citemacro_cite">Kudo and Richardson (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib15" title="">2018</a>)</cite> tokenizer, with 32K-token vocabularies for either source or target. The SentencePiece tokenizers are trained/optimized on 16M sentences of text for each language. Source and target vocabularies are not shared. The NMT models in this case use the same Transformer backbone as the morphological models, but without morphological modeling or BERT attention augmentation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Results</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Results in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T1" title="Table 1 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">1</span></a> through Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T5" title="Table 5 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">5</span></a> show our ablation study results, evaluating the various contributions. In Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T1" title="Table 1 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">1</span></a>, we show the improvement across all three benchmarks from adding proper names data to induce token-copying ability. In Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T2" title="Table 2 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">2</span></a>, we evaluate the impact of our attention augmentation scheme. The results show substantial improvement by adding BERT and XPOS attention augmentations. Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T3" title="Table 3 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">3</span></a> confirms the effectiveness of adding bilingual dictionary data to the training set. In Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T4" title="Table 4 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T5" title="Table 5 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">5</span></a>, we find a large performance gap between standard transformer with BPE-based tokenization (BPE Seq2Seq) and our morphology-based models (Morpho), which confirms the effectiveness of our morphological modeling. Finally, in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T6" title="Table 6 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">6</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#S3.T7" title="Table 7 ‣ 3.1 Experimental setup ‣ 3 Experiments ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">7</span></a>, we use back-translation and train 400M-parameter models that perform better than strong baselines including NLLB-200 (3.3B parameters for English<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mo id="S3.SS3.p1.1.m1.1.1" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">→</annotation></semantics></math> Kinyarwanda, 600M parameters for both directions) and fine-tuned mBART (610M parameters). For English<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mo id="S3.SS3.p1.2.m2.1.1" stretchy="false" xref="S3.SS3.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">→</annotation></semantics></math>Kinyarwanda, we achieve performance exceeding that of Google Translate on the out-of-domain TICO-19 benchmark.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Morphological modeling in NMT is an actively researched subject often leading to improvements in translation. However most of this research has focused on European languages. <cite class="ltx_cite ltx_citemacro_citet">Ataman and Federico (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib4" title="">2018</a>)</cite> shows that an RNN-based word compositional model improves NMT on several languages. <cite class="ltx_cite ltx_citemacro_citet">Weller-Di Marco and Fraser (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib37" title="">2020</a>)</cite> evaluates both source-side and target-side morphology modeling between English and German using a lemma+tag representation. <cite class="ltx_cite ltx_citemacro_citet">Passban et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib25" title="">2018</a>)</cite> proposes using multi-task learning of target-side morphology with a weighted average loss function. However, <cite class="ltx_cite ltx_citemacro_citet">Macháček et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib18" title="">2018</a>)</cite> does not find improvement when using unsupervised morphological analysers. Our studies differs in that it uses a different morphological representation, that is the two-tier architecture, and we also evaluate on a relatively lower resourced language.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">The idea of model augmentation with pre-trained language models (PLM) have been previously explored by <cite class="ltx_cite ltx_citemacro_citet">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib33" title="">2021</a>)</cite>, and <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib39" title="">2020</a>)</cite> who use a drop-net scheme to integrate BERT embeddings. Also, there have been attempts to model word order relationships between source and target languages <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib16" title="">2017</a>); Murthy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#bib.bib19" title="">2019</a>)</cite>. Our model architecture provides a more generic approach through the attention augmentation.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This work combines three techniques of morphological modeling, attention augmentation and data augmentation to improve machine translation performance for a low-resource morphologically-rich language. Our ablation results indicate improvement from each individual contribution. Baseline improvements from morphological modeling are more pronounced at the target side than at the source side. This work expands the landscape of modeling complex morphology in NMT and provides a potential framework-solution for machine translation of low-resource morphologically rich languages.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Our morphological modeling proposal requires an effective morphological analyzer and was only evaluated on one morphologically-rich language, that is Kinyarwanda. Morphological analyzers are not available for all languages and this will limit the applicability of our technique. The proposed data augmentation technique for enabling proper name copying ability works in most cases, but we also observed some few cases where inexact copies are produced. Similarly, even with lexical data added to our training, we still observe some cases of hallucinated output words, mostly when the model encounters unseen words. Finally, the proposed morphological decoding algorithm is slower than standard beam search because of the filtering steps and morphological synthesis performed before producing a candidate output token.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Given the above limitations, our model does not grant complete reliability and the produced translations still require post-editing to be used in high-stake applications. However, there are no major risks for using the model in normal use cases as a translation aid tool.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Adelani et al. (2022)</span>
<span class="ltx_bibblock">
David Adelani, Jesujoba Alabi, Angela Fan, Julia Kreutzer, Xiaoyu Shen, Machel
Reid, Dana Ruiter, Dietrich Klakow, Peter Nabende, Ernie Chang, et al. 2022.

</span>
<span class="ltx_bibblock">A few thousand translations go a long way! leveraging pre-trained
models for african news translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 2022 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies</em>, pages 3053–3070.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agić and Vulić (2019)</span>
<span class="ltx_bibblock">
Željko Agić and Ivan Vulić. 2019.

</span>
<span class="ltx_bibblock">Jw300: A wide-coverage parallel corpus for low-resource languages.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 57th Annual Meeting of the Association
for Computational Linguistics</em>, pages 3204–3210.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anastasopoulos et al. (2020)</span>
<span class="ltx_bibblock">
Antonios Anastasopoulos, Alessandro Cattelan, Zi-Yi Dou, Marcello Federico,
Christian Federmann, Dmitriy Genzel, Franscisco Guzmán, Junjie Hu,
Macduff Hughes, Philipp Koehn, et al. 2020.

</span>
<span class="ltx_bibblock">Tico-19: the translation initiative for covid-19.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 1st Workshop on NLP for COVID-19 (Part 2)
at EMNLP 2020</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ataman and Federico (2018)</span>
<span class="ltx_bibblock">
Duygu Ataman and Marcello Federico. 2018.

</span>
<span class="ltx_bibblock">Compositional representation of morphologically-rich input for neural
machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:1805.02036</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bundy and Wallen (1984)</span>
<span class="ltx_bibblock">
Alan Bundy and Lincoln Wallen. 1984.

</span>
<span class="ltx_bibblock">Morphographemics: Alias: spelling rules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Catalogue of Artificial Intelligence Tools</em>, pages 76–77.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Costa-jussà et al. (2022)</span>
<span class="ltx_bibblock">
Marta R Costa-jussà, James Cross, Onur Çelebi, Maha Elbayad, Kenneth
Heafield, Kevin Heffernan, Elahe Kalbassi, Janice Lam, Daniel Licht, Jean
Maillard, et al. 2022.

</span>
<span class="ltx_bibblock">No language left behind: Scaling human-centered machine translation.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Detlefsen et al. (2022)</span>
<span class="ltx_bibblock">
Nicki Skafte Detlefsen, Jiri Borovec, Justus Schock, Ananya Harsh Jha, Teddy
Koker, Luca Di Liello, Daniel Stancl, Changsheng Quan, Maxim Grechkin, and
William Falcon. 2022.

</span>
<span class="ltx_bibblock">Torchmetrics-measuring reproducibility in pytorch.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Journal of Open Source Software</em>, 7(70):4101.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, pages 4171–4186.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edunov et al. (2018)</span>
<span class="ltx_bibblock">
Sergey Edunov, Myle Ott, Michael Auli, and David Grangier. 2018.

</span>
<span class="ltx_bibblock">Understanding back-translation at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing</em>, pages 489–500.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Habumuremyi and Uwamahoro (2006)</span>
<span class="ltx_bibblock">
Emmanuel Habumuremyi and Claudine Uwamahoro. 2006.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">IRIZA-STARTER 2006: A Bilingual Kinyarwanda-English and
English-Kinyarwanda Dictionary</em>.

</span>
<span class="ltx_bibblock">Rwanda Community Net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Inkelas and Zoll (2000)</span>
<span class="ltx_bibblock">
Sharon Inkelas and Cheryl Zoll. 2000.

</span>
<span class="ltx_bibblock">Reduplication as morphological doubling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Manuscript, University of California, Berkeley and
Massachusetts Institute of Technology</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kantrowitz and Ross (2018)</span>
<span class="ltx_bibblock">
Mark Kantrowitz and Bill Ross. 2018.

</span>
<span class="ltx_bibblock">Names corpus, version 1.3.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kastner et al. (2019)</span>
<span class="ltx_bibblock">
Itamar Kastner, Matthew A Tucker, Artemis Alexiadou, Ruth Kramer, Alec Marantz,
and Isabel Oltra Massuet. 2019.

</span>
<span class="ltx_bibblock">Non-concatenative morphology.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Ms., Humboldt-Universität zu Berlin and Oakland
University</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. (2020)</span>
<span class="ltx_bibblock">
Guolin Ke, Di He, and Tie-Yan Liu. 2020.

</span>
<span class="ltx_bibblock">Rethinking positional encoding in language pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2006.15595</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo and Richardson (2018)</span>
<span class="ltx_bibblock">
Taku Kudo and John Richardson. 2018.

</span>
<span class="ltx_bibblock">Sentencepiece: A simple and language independent subword tokenizer
and detokenizer for neural text processing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing: System Demonstrations</em>, pages 66–71.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Junhui Li, Deyi Xiong, Zhaopeng Tu, Muhua Zhu, Min Zhang, and Guodong Zhou.
2017.

</span>
<span class="ltx_bibblock">Modeling source syntax for neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 55th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 688–697.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Yinhan Liu, Jiatao Gu, Naman Goyal, Xian Li, Sergey Edunov, Marjan
Ghazvininejad, Mike Lewis, and Luke Zettlemoyer. 2020.

</span>
<span class="ltx_bibblock">Multilingual denoising pre-training for neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Transactions of the Association for Computational Linguistics</em>,
8:726–742.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Macháček et al. (2018)</span>
<span class="ltx_bibblock">
Dominik Macháček, Jonáš Vidra, and Ondřej Bojar.
2018.

</span>
<span class="ltx_bibblock">Morphological and language-agnostic word segmentation for nmt.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International Conference on Text, Speech, and Dialogue</em>,
pages 277–284. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Murthy et al. (2019)</span>
<span class="ltx_bibblock">
Rudra Murthy, Anoop Kunchukuttan, and Pushpak Bhattacharyya. 2019.

</span>
<span class="ltx_bibblock">Addressing word-order divergence in multilingual neural machine
translation for extremely low resource languages.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, pages 3868–3873.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ng et al. (2019)</span>
<span class="ltx_bibblock">
Nathan Ng, Kyra Yee, Alexei Baevski, Myle Ott, Michael Auli, and Sergey Edunov.
2019.

</span>
<span class="ltx_bibblock">Facebook fair’s wmt19 news translation task submission.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1907.06616</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen and Salazar (2019)</span>
<span class="ltx_bibblock">
Toan Q Nguyen and Julian Salazar. 2019.

</span>
<span class="ltx_bibblock">Transformers without tears: Improving the normalization of
self-attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 16th International Conference on Spoken
Language Translation</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nzeyimana (2020)</span>
<span class="ltx_bibblock">
Antoine Nzeyimana. 2020.

</span>
<span class="ltx_bibblock">Morphological disambiguation from stemming data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 28th International Conference on
Computational Linguistics</em>, pages 4649–4660.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nzeyimana and Rubungo (2022)</span>
<span class="ltx_bibblock">
Antoine Nzeyimana and Andre Niyongabo Rubungo. 2022.

</span>
<span class="ltx_bibblock">Kinyabert: a morphology-aware kinyarwanda language model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 60th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 5347–5363.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ott et al. (2019)</span>
<span class="ltx_bibblock">
Myle Ott, Sergey Edunov, Alexei Baevski, Angela Fan, Sam Gross, Nathan Ng,
David Grangier, and Michael Auli. 2019.

</span>
<span class="ltx_bibblock">fairseq: A fast, extensible toolkit for sequence modeling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics (Demonstrations)</em>,
pages 48–53.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Passban et al. (2018)</span>
<span class="ltx_bibblock">
Peyman Passban, Qun Liu, and Andy Way. 2018.

</span>
<span class="ltx_bibblock">Improving character-based decoding using target-side morphological
information for neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:1804.06506</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al.
2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in neural information processing systems</em>, 32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Popović (2017)</span>
<span class="ltx_bibblock">
Maja Popović. 2017.

</span>
<span class="ltx_bibblock">chrf++: words helping character n-grams.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the second conference on machine
translation</em>, pages 612–618.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post (2018)</span>
<span class="ltx_bibblock">
Matt Post. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.aclweb.org/anthology/W18-6319" title="">A call for clarity
in reporting BLEU scores</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the Third Conference on Machine Translation:
Research Papers</em>, pages 186–191, Belgium, Brussels. Association for
Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raunak et al. (2021)</span>
<span class="ltx_bibblock">
Vikas Raunak, Arul Menezes, and Marcin Junczys-Dowmunt. 2021.

</span>
<span class="ltx_bibblock">The curious case of hallucinations in neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 2021 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies</em>, pages 1172–1183.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Remy (2021)</span>
<span class="ltx_bibblock">
Philippe Remy. 2021.

</span>
<span class="ltx_bibblock">Name dataset.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/philipperemy/name-dataset" title="">https://github.com/philipperemy/name-dataset</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sellam et al. (2020)</span>
<span class="ltx_bibblock">
Thibault Sellam, Dipanjan Das, and Ankur Parikh. 2020.

</span>
<span class="ltx_bibblock">Bleurt: Learning robust metrics for text generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics</em>, pages 7881–7892.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch. 2016.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 54th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 1715–1725.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Zewei Sun, Mingxuan Wang, and Lei Li. 2021.

</span>
<span class="ltx_bibblock">Multilingual translation via grafting pre-trained language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2109.05256</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tiedemann and Thottingal (2020)</span>
<span class="ltx_bibblock">
Jörg Tiedemann and Santhosh Thottingal. 2020.

</span>
<span class="ltx_bibblock">Opus-mt–building open translation services for the world.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 22nd Annual Conference of the European
Association for Machine Translation</em>, pages 479–480.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Zirui Wang, Yulia Tsvetkov, Orhan Firat, and Yuan Cao. 2020.

</span>
<span class="ltx_bibblock">Gradient vaccine: Investigating and improving multi-task optimization
in massively multilingual models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weller-Di Marco and Fraser (2020)</span>
<span class="ltx_bibblock">
Marion Weller-Di Marco and Alexander Fraser. 2020.

</span>
<span class="ltx_bibblock">Modeling word formation in english–german neural machine
translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics</em>, pages 4227–4232.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Weijia Xu, Sweta Agrawal, Eleftheria Briakou, Marianna J Martindale, and Marine
Carpuat. 2023.

</span>
<span class="ltx_bibblock">Understanding and detecting hallucinations in neural machine
translation via model introspection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Transactions of the Association for Computational Linguistics</em>,
11:546–564.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2020)</span>
<span class="ltx_bibblock">
Jinhua Zhu, Yingce Xia, Lijun Wu, Di He, Tao Qin, Wengang Zhou, Houqiang Li,
and Tie-Yan Liu. 2020.

</span>
<span class="ltx_bibblock">Incorporating bert into neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2002.06823</em>.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Model, training and inference hyper-parameters</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Our model hyper-parameters along with training and inference hyper-parameters are provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.02392v1#A1.T8" title="Table 8 ‣ Appendix A Model, training and inference hyper-parameters ‣ Low-resource neural machine translation with morphological modeling"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T8.7" style="width:398.9pt;height:795.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(64.0pt,-127.5pt) scale(1.47236486997144,1.47236486997144) ;">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.7.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T8.7.7.8.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.7.7.8.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T8.7.7.8.1.1.1">Hyper-parameter</span></td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="A1.T8.7.7.8.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T8.7.7.8.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.9.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.7.7.9.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T8.7.7.9.2.1.1">Model</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A1.T8.7.7.9.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.10.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.10.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer hidden dimensions</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.10.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">768</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.11.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.11.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer feed-forward dimension</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.11.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">3072</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.12.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.12.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer attention heads</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.12.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">12</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.13.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.13.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer encoder layers with BERT</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.13.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">5</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.14.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.14.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer encoder layers without BERT</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.14.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">8</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.15.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.15.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer decoder layers with GPT</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.15.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">7</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.16.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.16.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer decoder layers without GPT</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.16.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">8</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.17.10">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.17.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text ltx_font_italic" id="A1.T8.7.7.17.10.1.1">Morpho-Encoder</span> hidden dimension</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.17.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">128</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.18.11">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.18.11.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text ltx_font_italic" id="A1.T8.7.7.18.11.1.1">Morpho-Encoder</span> feed-forward dimension</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.18.11.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">512</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.19.12">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.19.12.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text ltx_font_italic" id="A1.T8.7.7.19.12.1.1">Morpho-Encoder</span> attention heads</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.19.12.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">4</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.20.13">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.20.13.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">
<span class="ltx_text ltx_font_italic" id="A1.T8.7.7.20.13.1.1">Morpho-Encoder</span> layers</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.20.13.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">3</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.21.14">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.21.14.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Dropout</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.21.14.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.1</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.22.15">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.22.15.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Maximum sequence length</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.22.15.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">512</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.23.16">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.7.7.23.16.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T8.7.7.23.16.1.1">Training</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A1.T8.7.7.23.16.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.24.17">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.24.17.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Batch size</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.24.17.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">32K tokens</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.25.18">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.25.18.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Peak learning rate</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.25.18.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.0005</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.26.19">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.26.19.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Learning rate schedule</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.26.19.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">inverse sqrt</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.27.20">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.27.20.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Warm-up steps</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.27.20.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">8000</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.28.21">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.28.21.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Optimizer</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.28.21.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Adam</td>
</tr>
<tr class="ltx_tr" id="A1.T8.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.2.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Adam’s <math alttext="\beta_{1}" class="ltx_Math" display="inline" id="A1.T8.1.1.1.1.m1.1"><semantics id="A1.T8.1.1.1.1.m1.1a"><msub id="A1.T8.1.1.1.1.m1.1.1" xref="A1.T8.1.1.1.1.m1.1.1.cmml"><mi id="A1.T8.1.1.1.1.m1.1.1.2" xref="A1.T8.1.1.1.1.m1.1.1.2.cmml">β</mi><mn id="A1.T8.1.1.1.1.m1.1.1.3" xref="A1.T8.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T8.1.1.1.1.m1.1b"><apply id="A1.T8.1.1.1.1.m1.1.1.cmml" xref="A1.T8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T8.1.1.1.1.m1.1.1.1.cmml" xref="A1.T8.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.T8.1.1.1.1.m1.1.1.2.cmml" xref="A1.T8.1.1.1.1.m1.1.1.2">𝛽</ci><cn id="A1.T8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A1.T8.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.1.1.1.1.m1.1c">\beta_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.T8.1.1.1.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\beta_{2}" class="ltx_Math" display="inline" id="A1.T8.2.2.2.2.m2.1"><semantics id="A1.T8.2.2.2.2.m2.1a"><msub id="A1.T8.2.2.2.2.m2.1.1" xref="A1.T8.2.2.2.2.m2.1.1.cmml"><mi id="A1.T8.2.2.2.2.m2.1.1.2" xref="A1.T8.2.2.2.2.m2.1.1.2.cmml">β</mi><mn id="A1.T8.2.2.2.2.m2.1.1.3" xref="A1.T8.2.2.2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T8.2.2.2.2.m2.1b"><apply id="A1.T8.2.2.2.2.m2.1.1.cmml" xref="A1.T8.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.T8.2.2.2.2.m2.1.1.1.cmml" xref="A1.T8.2.2.2.2.m2.1.1">subscript</csymbol><ci id="A1.T8.2.2.2.2.m2.1.1.2.cmml" xref="A1.T8.2.2.2.2.m2.1.1.2">𝛽</ci><cn id="A1.T8.2.2.2.2.m2.1.1.3.cmml" type="integer" xref="A1.T8.2.2.2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.2.2.2.2.m2.1c">\beta_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.T8.2.2.2.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.2.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.9, 0.98</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.29.22">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.29.22.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Maximum training epochs</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.29.22.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">40</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.30.23">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.7.7.30.23.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A1.T8.7.7.30.23.1.1">Morphological inference</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A1.T8.7.7.30.23.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.31.24">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.7.7.31.24.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Beam width</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.7.7.31.24.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">4</td>
</tr>
<tr class="ltx_tr" id="A1.T8.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.3.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Top scores <math alttext="M" class="ltx_Math" display="inline" id="A1.T8.3.3.3.1.m1.1"><semantics id="A1.T8.3.3.3.1.m1.1a"><mi id="A1.T8.3.3.3.1.m1.1.1" xref="A1.T8.3.3.3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.T8.3.3.3.1.m1.1b"><ci id="A1.T8.3.3.3.1.m1.1.1.cmml" xref="A1.T8.3.3.3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.3.3.3.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A1.T8.3.3.3.1.m1.1d">italic_M</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.3.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">8</td>
</tr>
<tr class="ltx_tr" id="A1.T8.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.4.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Cut-off gap <math alttext="\delta" class="ltx_Math" display="inline" id="A1.T8.4.4.4.1.m1.1"><semantics id="A1.T8.4.4.4.1.m1.1a"><mi id="A1.T8.4.4.4.1.m1.1.1" xref="A1.T8.4.4.4.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="A1.T8.4.4.4.1.m1.1b"><ci id="A1.T8.4.4.4.1.m1.1.1.cmml" xref="A1.T8.4.4.4.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.4.4.4.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="A1.T8.4.4.4.1.m1.1d">italic_δ</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.4.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.3</td>
</tr>
<tr class="ltx_tr" id="A1.T8.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.5.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Minimum affix probability <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.T8.5.5.5.1.m1.1"><semantics id="A1.T8.5.5.5.1.m1.1a"><mi id="A1.T8.5.5.5.1.m1.1.1" xref="A1.T8.5.5.5.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.T8.5.5.5.1.m1.1b"><ci id="A1.T8.5.5.5.1.m1.1.1.cmml" xref="A1.T8.5.5.5.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.5.5.5.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.T8.5.5.5.1.m1.1d">italic_γ</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.5.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.3</td>
</tr>
<tr class="ltx_tr" id="A1.T8.6.6.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A1.T8.6.6.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Global correlation weight <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T8.6.6.6.1.m1.1"><semantics id="A1.T8.6.6.6.1.m1.1a"><mi id="A1.T8.6.6.6.1.m1.1.1" xref="A1.T8.6.6.6.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.T8.6.6.6.1.m1.1b"><ci id="A1.T8.6.6.6.1.m1.1.1.cmml" xref="A1.T8.6.6.6.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.6.6.6.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.T8.6.6.6.1.m1.1d">italic_α</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="A1.T8.6.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">0.08</td>
</tr>
<tr class="ltx_tr" id="A1.T8.7.7.7">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="A1.T8.7.7.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Surface form score stop gap <math alttext="log(\beta)" class="ltx_Math" display="inline" id="A1.T8.7.7.7.1.m1.1"><semantics id="A1.T8.7.7.7.1.m1.1a"><mrow id="A1.T8.7.7.7.1.m1.1.2" xref="A1.T8.7.7.7.1.m1.1.2.cmml"><mi id="A1.T8.7.7.7.1.m1.1.2.2" xref="A1.T8.7.7.7.1.m1.1.2.2.cmml">l</mi><mo id="A1.T8.7.7.7.1.m1.1.2.1" xref="A1.T8.7.7.7.1.m1.1.2.1.cmml">⁢</mo><mi id="A1.T8.7.7.7.1.m1.1.2.3" xref="A1.T8.7.7.7.1.m1.1.2.3.cmml">o</mi><mo id="A1.T8.7.7.7.1.m1.1.2.1a" xref="A1.T8.7.7.7.1.m1.1.2.1.cmml">⁢</mo><mi id="A1.T8.7.7.7.1.m1.1.2.4" xref="A1.T8.7.7.7.1.m1.1.2.4.cmml">g</mi><mo id="A1.T8.7.7.7.1.m1.1.2.1b" xref="A1.T8.7.7.7.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.T8.7.7.7.1.m1.1.2.5.2" xref="A1.T8.7.7.7.1.m1.1.2.cmml"><mo id="A1.T8.7.7.7.1.m1.1.2.5.2.1" stretchy="false" xref="A1.T8.7.7.7.1.m1.1.2.cmml">(</mo><mi id="A1.T8.7.7.7.1.m1.1.1" xref="A1.T8.7.7.7.1.m1.1.1.cmml">β</mi><mo id="A1.T8.7.7.7.1.m1.1.2.5.2.2" stretchy="false" xref="A1.T8.7.7.7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.T8.7.7.7.1.m1.1b"><apply id="A1.T8.7.7.7.1.m1.1.2.cmml" xref="A1.T8.7.7.7.1.m1.1.2"><times id="A1.T8.7.7.7.1.m1.1.2.1.cmml" xref="A1.T8.7.7.7.1.m1.1.2.1"></times><ci id="A1.T8.7.7.7.1.m1.1.2.2.cmml" xref="A1.T8.7.7.7.1.m1.1.2.2">𝑙</ci><ci id="A1.T8.7.7.7.1.m1.1.2.3.cmml" xref="A1.T8.7.7.7.1.m1.1.2.3">𝑜</ci><ci id="A1.T8.7.7.7.1.m1.1.2.4.cmml" xref="A1.T8.7.7.7.1.m1.1.2.4">𝑔</ci><ci id="A1.T8.7.7.7.1.m1.1.1.cmml" xref="A1.T8.7.7.7.1.m1.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.7.7.7.1.m1.1c">log(\beta)</annotation><annotation encoding="application/x-llamapun" id="A1.T8.7.7.7.1.m1.1d">italic_l italic_o italic_g ( italic_β )</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="A1.T8.7.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">2.0</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Hyper-parameter settings</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Dataset summary</h2>
<figure class="ltx_table" id="A2.T9">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T9.1" style="width:390.3pt;height:342.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(72.1pt,-63.3pt) scale(1.58622229474486,1.58622229474486) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T9.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T9.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="A2.T9.1.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.1.1.1.1">Subset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A2.T9.1.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.1.1.2.1">Size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T9.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A2.T9.1.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.2.1.1.1">Parallel sentences</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A2.T9.1.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.3.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Jw.org website</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.3.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">562,417 sentences</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.4.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Rwanda’s official gazette</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.4.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">113,127 sentences</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A2.T9.1.1.5.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.5.4.1.1">Lexical data</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A2.T9.1.1.5.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.6.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Iriza dictionary 2006</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.6.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">108,870 words</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.7.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.7.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Kinyarwanda.net</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.7.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">10,653 words</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.8.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.8.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Manually translated</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.8.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">8,000 words</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.9.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A2.T9.1.1.9.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.9.8.1.1">Augmented data</span></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A2.T9.1.1.9.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"></td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.10.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.10.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Spelled numbers</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.10.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">200,000 phrases</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.11.10">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A2.T9.1.1.11.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Copy data (e.g. Proper names)</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T9.1.1.11.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">157,668 words</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1.12.11">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="A2.T9.1.1.12.11.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Code-switching foreign terms</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A2.T9.1.1.12.11.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">10,276 terms</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Summary of our experimental parallel dataset</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Morphological decoding algorithm</h2>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.38">
<div class="ltx_listingline" id="algorithm1.38.39">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.40">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="algorithm1.1.1">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_bold" id="algorithm1.1.1.2">Subroutine:</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.1.1.1"><math alttext="\textnormal{{inflectionGroupProbabilities}}(T_{s},T_{p},T_{a},P_{s},P_{p},P_{a%
},M,G)" class="ltx_Math" display="inline" id="algorithm1.1.1.1.m1.8"><semantics id="algorithm1.1.1.1.m1.8a"><mrow id="algorithm1.1.1.1.m1.8.8" xref="algorithm1.1.1.1.m1.8.8.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.1.1.1.m1.8.8.8" xref="algorithm1.1.1.1.m1.8.8.8b.cmml"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.1.1.1.m1.8.8.8.1nest">inflectionGroupProbabilities</em></mtext><mo id="algorithm1.1.1.1.m1.8.8.7" xref="algorithm1.1.1.1.m1.8.8.7.cmml">⁢</mo><mrow id="algorithm1.1.1.1.m1.8.8.6.6" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml"><mo id="algorithm1.1.1.1.m1.8.8.6.6.7" stretchy="false" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">(</mo><msub id="algorithm1.1.1.1.m1.3.3.1.1.1" xref="algorithm1.1.1.1.m1.3.3.1.1.1.cmml"><mi id="algorithm1.1.1.1.m1.3.3.1.1.1.2" xref="algorithm1.1.1.1.m1.3.3.1.1.1.2.cmml">T</mi><mi id="algorithm1.1.1.1.m1.3.3.1.1.1.3" xref="algorithm1.1.1.1.m1.3.3.1.1.1.3.cmml">s</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.8" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><msub id="algorithm1.1.1.1.m1.4.4.2.2.2" xref="algorithm1.1.1.1.m1.4.4.2.2.2.cmml"><mi id="algorithm1.1.1.1.m1.4.4.2.2.2.2" xref="algorithm1.1.1.1.m1.4.4.2.2.2.2.cmml">T</mi><mi id="algorithm1.1.1.1.m1.4.4.2.2.2.3" xref="algorithm1.1.1.1.m1.4.4.2.2.2.3.cmml">p</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.9" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><msub id="algorithm1.1.1.1.m1.5.5.3.3.3" xref="algorithm1.1.1.1.m1.5.5.3.3.3.cmml"><mi id="algorithm1.1.1.1.m1.5.5.3.3.3.2" xref="algorithm1.1.1.1.m1.5.5.3.3.3.2.cmml">T</mi><mi id="algorithm1.1.1.1.m1.5.5.3.3.3.3" xref="algorithm1.1.1.1.m1.5.5.3.3.3.3.cmml">a</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.10" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><msub id="algorithm1.1.1.1.m1.6.6.4.4.4" xref="algorithm1.1.1.1.m1.6.6.4.4.4.cmml"><mi id="algorithm1.1.1.1.m1.6.6.4.4.4.2" xref="algorithm1.1.1.1.m1.6.6.4.4.4.2.cmml">P</mi><mi id="algorithm1.1.1.1.m1.6.6.4.4.4.3" xref="algorithm1.1.1.1.m1.6.6.4.4.4.3.cmml">s</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.11" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><msub id="algorithm1.1.1.1.m1.7.7.5.5.5" xref="algorithm1.1.1.1.m1.7.7.5.5.5.cmml"><mi id="algorithm1.1.1.1.m1.7.7.5.5.5.2" xref="algorithm1.1.1.1.m1.7.7.5.5.5.2.cmml">P</mi><mi id="algorithm1.1.1.1.m1.7.7.5.5.5.3" xref="algorithm1.1.1.1.m1.7.7.5.5.5.3.cmml">p</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.12" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><msub id="algorithm1.1.1.1.m1.8.8.6.6.6" xref="algorithm1.1.1.1.m1.8.8.6.6.6.cmml"><mi id="algorithm1.1.1.1.m1.8.8.6.6.6.2" xref="algorithm1.1.1.1.m1.8.8.6.6.6.2.cmml">P</mi><mi id="algorithm1.1.1.1.m1.8.8.6.6.6.3" xref="algorithm1.1.1.1.m1.8.8.6.6.6.3.cmml">a</mi></msub><mo id="algorithm1.1.1.1.m1.8.8.6.6.13" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><mi id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml">M</mi><mo id="algorithm1.1.1.1.m1.8.8.6.6.14" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">,</mo><mi id="algorithm1.1.1.1.m1.2.2" xref="algorithm1.1.1.1.m1.2.2.cmml">G</mi><mo id="algorithm1.1.1.1.m1.8.8.6.6.15" stretchy="false" xref="algorithm1.1.1.1.m1.8.8.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.8b"><apply id="algorithm1.1.1.1.m1.8.8.cmml" xref="algorithm1.1.1.1.m1.8.8"><times id="algorithm1.1.1.1.m1.8.8.7.cmml" xref="algorithm1.1.1.1.m1.8.8.7"></times><ci id="algorithm1.1.1.1.m1.8.8.8b.cmml" xref="algorithm1.1.1.1.m1.8.8.8"><mtext class="ltx_mathvariant_monospace" id="algorithm1.1.1.1.m1.8.8.8.cmml" xref="algorithm1.1.1.1.m1.8.8.8"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.1.1.1.m1.8.8.8.1anest">inflectionGroupProbabilities</em></mtext></ci><vector id="algorithm1.1.1.1.m1.8.8.6.7.cmml" xref="algorithm1.1.1.1.m1.8.8.6.6"><apply id="algorithm1.1.1.1.m1.3.3.1.1.1.cmml" xref="algorithm1.1.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.3.3.1.1.1.1.cmml" xref="algorithm1.1.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="algorithm1.1.1.1.m1.3.3.1.1.1.2.cmml" xref="algorithm1.1.1.1.m1.3.3.1.1.1.2">𝑇</ci><ci id="algorithm1.1.1.1.m1.3.3.1.1.1.3.cmml" xref="algorithm1.1.1.1.m1.3.3.1.1.1.3">𝑠</ci></apply><apply id="algorithm1.1.1.1.m1.4.4.2.2.2.cmml" xref="algorithm1.1.1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.4.4.2.2.2.1.cmml" xref="algorithm1.1.1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="algorithm1.1.1.1.m1.4.4.2.2.2.2.cmml" xref="algorithm1.1.1.1.m1.4.4.2.2.2.2">𝑇</ci><ci id="algorithm1.1.1.1.m1.4.4.2.2.2.3.cmml" xref="algorithm1.1.1.1.m1.4.4.2.2.2.3">𝑝</ci></apply><apply id="algorithm1.1.1.1.m1.5.5.3.3.3.cmml" xref="algorithm1.1.1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.5.5.3.3.3.1.cmml" xref="algorithm1.1.1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="algorithm1.1.1.1.m1.5.5.3.3.3.2.cmml" xref="algorithm1.1.1.1.m1.5.5.3.3.3.2">𝑇</ci><ci id="algorithm1.1.1.1.m1.5.5.3.3.3.3.cmml" xref="algorithm1.1.1.1.m1.5.5.3.3.3.3">𝑎</ci></apply><apply id="algorithm1.1.1.1.m1.6.6.4.4.4.cmml" xref="algorithm1.1.1.1.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.6.6.4.4.4.1.cmml" xref="algorithm1.1.1.1.m1.6.6.4.4.4">subscript</csymbol><ci id="algorithm1.1.1.1.m1.6.6.4.4.4.2.cmml" xref="algorithm1.1.1.1.m1.6.6.4.4.4.2">𝑃</ci><ci id="algorithm1.1.1.1.m1.6.6.4.4.4.3.cmml" xref="algorithm1.1.1.1.m1.6.6.4.4.4.3">𝑠</ci></apply><apply id="algorithm1.1.1.1.m1.7.7.5.5.5.cmml" xref="algorithm1.1.1.1.m1.7.7.5.5.5"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.7.7.5.5.5.1.cmml" xref="algorithm1.1.1.1.m1.7.7.5.5.5">subscript</csymbol><ci id="algorithm1.1.1.1.m1.7.7.5.5.5.2.cmml" xref="algorithm1.1.1.1.m1.7.7.5.5.5.2">𝑃</ci><ci id="algorithm1.1.1.1.m1.7.7.5.5.5.3.cmml" xref="algorithm1.1.1.1.m1.7.7.5.5.5.3">𝑝</ci></apply><apply id="algorithm1.1.1.1.m1.8.8.6.6.6.cmml" xref="algorithm1.1.1.1.m1.8.8.6.6.6"><csymbol cd="ambiguous" id="algorithm1.1.1.1.m1.8.8.6.6.6.1.cmml" xref="algorithm1.1.1.1.m1.8.8.6.6.6">subscript</csymbol><ci id="algorithm1.1.1.1.m1.8.8.6.6.6.2.cmml" xref="algorithm1.1.1.1.m1.8.8.6.6.6.2">𝑃</ci><ci id="algorithm1.1.1.1.m1.8.8.6.6.6.3.cmml" xref="algorithm1.1.1.1.m1.8.8.6.6.6.3">𝑎</ci></apply><ci id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1">𝑀</ci><ci id="algorithm1.1.1.1.m1.2.2.cmml" xref="algorithm1.1.1.1.m1.2.2">𝐺</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.8c">\textnormal{{inflectionGroupProbabilities}}(T_{s},T_{p},T_{a},P_{s},P_{p},P_{a%
},M,G)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.1.m1.8d">inflectionGroupProbabilities ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_M , italic_G )</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.41">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.2.2">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="W\leftarrow M\times G" class="ltx_Math" display="inline" id="algorithm1.2.2.m1.1"><semantics id="algorithm1.2.2.m1.1a"><mrow id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml"><mi id="algorithm1.2.2.m1.1.1.2" xref="algorithm1.2.2.m1.1.1.2.cmml">W</mi><mo id="algorithm1.2.2.m1.1.1.1" stretchy="false" xref="algorithm1.2.2.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.2.2.m1.1.1.3" xref="algorithm1.2.2.m1.1.1.3.cmml"><mi id="algorithm1.2.2.m1.1.1.3.2" xref="algorithm1.2.2.m1.1.1.3.2.cmml">M</mi><mo id="algorithm1.2.2.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm1.2.2.m1.1.1.3.1.cmml">×</mo><mi id="algorithm1.2.2.m1.1.1.3.3" xref="algorithm1.2.2.m1.1.1.3.3.cmml">G</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><apply id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1"><ci id="algorithm1.2.2.m1.1.1.1.cmml" xref="algorithm1.2.2.m1.1.1.1">←</ci><ci id="algorithm1.2.2.m1.1.1.2.cmml" xref="algorithm1.2.2.m1.1.1.2">𝑊</ci><apply id="algorithm1.2.2.m1.1.1.3.cmml" xref="algorithm1.2.2.m1.1.1.3"><times id="algorithm1.2.2.m1.1.1.3.1.cmml" xref="algorithm1.2.2.m1.1.1.3.1"></times><ci id="algorithm1.2.2.m1.1.1.3.2.cmml" xref="algorithm1.2.2.m1.1.1.3.2">𝑀</ci><ci id="algorithm1.2.2.m1.1.1.3.3.cmml" xref="algorithm1.2.2.m1.1.1.3.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">W\leftarrow M\times G</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m1.1d">italic_W ← italic_M × italic_G</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm1.2.2.1">array</span>
</div>
<div class="ltx_listingline" id="algorithm1.4.4">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="W[i,g]\leftarrow-100" class="ltx_Math" display="inline" id="algorithm1.3.3.m1.2"><semantics id="algorithm1.3.3.m1.2a"><mrow id="algorithm1.3.3.m1.2.3" xref="algorithm1.3.3.m1.2.3.cmml"><mrow id="algorithm1.3.3.m1.2.3.2" xref="algorithm1.3.3.m1.2.3.2.cmml"><mi id="algorithm1.3.3.m1.2.3.2.2" xref="algorithm1.3.3.m1.2.3.2.2.cmml">W</mi><mo id="algorithm1.3.3.m1.2.3.2.1" xref="algorithm1.3.3.m1.2.3.2.1.cmml">⁢</mo><mrow id="algorithm1.3.3.m1.2.3.2.3.2" xref="algorithm1.3.3.m1.2.3.2.3.1.cmml"><mo id="algorithm1.3.3.m1.2.3.2.3.2.1" stretchy="false" xref="algorithm1.3.3.m1.2.3.2.3.1.cmml">[</mo><mi id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml">i</mi><mo id="algorithm1.3.3.m1.2.3.2.3.2.2" xref="algorithm1.3.3.m1.2.3.2.3.1.cmml">,</mo><mi id="algorithm1.3.3.m1.2.2" xref="algorithm1.3.3.m1.2.2.cmml">g</mi><mo id="algorithm1.3.3.m1.2.3.2.3.2.3" stretchy="false" xref="algorithm1.3.3.m1.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.3.3.m1.2.3.1" stretchy="false" xref="algorithm1.3.3.m1.2.3.1.cmml">←</mo><mrow id="algorithm1.3.3.m1.2.3.3" xref="algorithm1.3.3.m1.2.3.3.cmml"><mo id="algorithm1.3.3.m1.2.3.3a" xref="algorithm1.3.3.m1.2.3.3.cmml">−</mo><mn id="algorithm1.3.3.m1.2.3.3.2" xref="algorithm1.3.3.m1.2.3.3.2.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.2b"><apply id="algorithm1.3.3.m1.2.3.cmml" xref="algorithm1.3.3.m1.2.3"><ci id="algorithm1.3.3.m1.2.3.1.cmml" xref="algorithm1.3.3.m1.2.3.1">←</ci><apply id="algorithm1.3.3.m1.2.3.2.cmml" xref="algorithm1.3.3.m1.2.3.2"><times id="algorithm1.3.3.m1.2.3.2.1.cmml" xref="algorithm1.3.3.m1.2.3.2.1"></times><ci id="algorithm1.3.3.m1.2.3.2.2.cmml" xref="algorithm1.3.3.m1.2.3.2.2">𝑊</ci><interval closure="closed" id="algorithm1.3.3.m1.2.3.2.3.1.cmml" xref="algorithm1.3.3.m1.2.3.2.3.2"><ci id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">𝑖</ci><ci id="algorithm1.3.3.m1.2.2.cmml" xref="algorithm1.3.3.m1.2.2">𝑔</ci></interval></apply><apply id="algorithm1.3.3.m1.2.3.3.cmml" xref="algorithm1.3.3.m1.2.3.3"><minus id="algorithm1.3.3.m1.2.3.3.1.cmml" xref="algorithm1.3.3.m1.2.3.3"></minus><cn id="algorithm1.3.3.m1.2.3.3.2.cmml" type="integer" xref="algorithm1.3.3.m1.2.3.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.2c">W[i,g]\leftarrow-100</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m1.2d">italic_W [ italic_i , italic_g ] ← - 100</annotation></semantics></math>, <math alttext="\forall i=1,2,..M,\forall g=1,2,..G" class="ltx_math_unparsed" display="inline" id="algorithm1.4.4.m2.2"><semantics id="algorithm1.4.4.m2.2a"><mrow id="algorithm1.4.4.m2.2b"><mo id="algorithm1.4.4.m2.2.3" rspace="0.167em">∀</mo><mi id="algorithm1.4.4.m2.2.4">i</mi><mo id="algorithm1.4.4.m2.2.5">=</mo><mn id="algorithm1.4.4.m2.1.1">1</mn><mo id="algorithm1.4.4.m2.2.6">,</mo><mn id="algorithm1.4.4.m2.2.2">2</mn><mo id="algorithm1.4.4.m2.2.7">,</mo><mo id="algorithm1.4.4.m2.2.8" lspace="0em" rspace="0.0835em">.</mo><mo id="algorithm1.4.4.m2.2.9" lspace="0.0835em" rspace="0.167em">.</mo><mi id="algorithm1.4.4.m2.2.10">M</mi><mo id="algorithm1.4.4.m2.2.11">,</mo><mo id="algorithm1.4.4.m2.2.12" rspace="0.167em">∀</mo><mi id="algorithm1.4.4.m2.2.13">g</mi><mo id="algorithm1.4.4.m2.2.14">=</mo><mn id="algorithm1.4.4.m2.2.15">1</mn><mo id="algorithm1.4.4.m2.2.16">,</mo><mn id="algorithm1.4.4.m2.2.17">2</mn><mo id="algorithm1.4.4.m2.2.18">,</mo><mo id="algorithm1.4.4.m2.2.19" lspace="0em" rspace="0.0835em">.</mo><mo id="algorithm1.4.4.m2.2.20" lspace="0.0835em" rspace="0.167em">.</mo><mi id="algorithm1.4.4.m2.2.21">G</mi></mrow><annotation encoding="application/x-tex" id="algorithm1.4.4.m2.2c">\forall i=1,2,..M,\forall g=1,2,..G</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m2.2d">∀ italic_i = 1 , 2 , . . italic_M , ∀ italic_g = 1 , 2 , . . italic_G</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.6.6">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.6.6.3">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.6.6.2"><math alttext="i\leftarrow 1" class="ltx_Math" display="inline" id="algorithm1.5.5.1.m1.1"><semantics id="algorithm1.5.5.1.m1.1a"><mrow id="algorithm1.5.5.1.m1.1.1" xref="algorithm1.5.5.1.m1.1.1.cmml"><mi id="algorithm1.5.5.1.m1.1.1.2" xref="algorithm1.5.5.1.m1.1.1.2.cmml">i</mi><mo id="algorithm1.5.5.1.m1.1.1.1" stretchy="false" xref="algorithm1.5.5.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.5.5.1.m1.1.1.3" xref="algorithm1.5.5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.1.m1.1b"><apply id="algorithm1.5.5.1.m1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1"><ci id="algorithm1.5.5.1.m1.1.1.1.cmml" xref="algorithm1.5.5.1.m1.1.1.1">←</ci><ci id="algorithm1.5.5.1.m1.1.1.2.cmml" xref="algorithm1.5.5.1.m1.1.1.2">𝑖</ci><cn id="algorithm1.5.5.1.m1.1.1.3.cmml" type="integer" xref="algorithm1.5.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.1.m1.1c">i\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.1.m1.1d">italic_i ← 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="algorithm1.6.6.2.1">to</span> <math alttext="M" class="ltx_Math" display="inline" id="algorithm1.6.6.2.m2.1"><semantics id="algorithm1.6.6.2.m2.1a"><mi id="algorithm1.6.6.2.m2.1.1" xref="algorithm1.6.6.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.2.m2.1b"><ci id="algorithm1.6.6.2.m2.1.1.cmml" xref="algorithm1.6.6.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.2.m2.1d">italic_M</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.6.6.4">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.42">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="g_{s}\leftarrow\textnormal{{getInflectionGroup}}(T_{s}[i]" class="ltx_math_unparsed" display="inline" id="algorithm1.7.7.m1.1"><semantics id="algorithm1.7.7.m1.1a"><mrow id="algorithm1.7.7.m1.1b"><msub id="algorithm1.7.7.m1.1.2"><mi id="algorithm1.7.7.m1.1.2.2">g</mi><mi id="algorithm1.7.7.m1.1.2.3">s</mi></msub><mo id="algorithm1.7.7.m1.1.3" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.7.7.m1.1.4">getInflectionGroup</mtext><mrow id="algorithm1.7.7.m1.1.5"><mo id="algorithm1.7.7.m1.1.5.1" stretchy="false">(</mo><msub id="algorithm1.7.7.m1.1.5.2"><mi id="algorithm1.7.7.m1.1.5.2.2">T</mi><mi id="algorithm1.7.7.m1.1.5.2.3">s</mi></msub><mrow id="algorithm1.7.7.m1.1.5.3"><mo id="algorithm1.7.7.m1.1.5.3.1" stretchy="false">[</mo><mi id="algorithm1.7.7.m1.1.1">i</mi><mo id="algorithm1.7.7.m1.1.5.3.2" stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">g_{s}\leftarrow\textnormal{{getInflectionGroup}}(T_{s}[i]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m1.1d">italic_g start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← getInflectionGroup ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_i ]</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="algorithm1.8.8">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="W[i,g_{s}]\leftarrow\textnormal{{max}}(W[i,g_{s}],\textnormal{{log}}(P_{s}[T_{%
s}[i]]" class="ltx_math_unparsed" display="inline" id="algorithm1.8.8.m1.4"><semantics id="algorithm1.8.8.m1.4a"><mrow id="algorithm1.8.8.m1.4b"><mi id="algorithm1.8.8.m1.4.5">W</mi><mrow id="algorithm1.8.8.m1.4.6"><mo id="algorithm1.8.8.m1.4.6.1" stretchy="false">[</mo><mi id="algorithm1.8.8.m1.1.1">i</mi><mo id="algorithm1.8.8.m1.4.6.2">,</mo><msub id="algorithm1.8.8.m1.4.6.3"><mi id="algorithm1.8.8.m1.4.6.3.2">g</mi><mi id="algorithm1.8.8.m1.4.6.3.3">s</mi></msub><mo id="algorithm1.8.8.m1.4.6.4" stretchy="false">]</mo></mrow><mo id="algorithm1.8.8.m1.4.7" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.8.8.m1.4.8">max</mtext><mrow id="algorithm1.8.8.m1.4.9"><mo id="algorithm1.8.8.m1.4.9.1" stretchy="false">(</mo><mi id="algorithm1.8.8.m1.4.9.2">W</mi><mrow id="algorithm1.8.8.m1.4.9.3"><mo id="algorithm1.8.8.m1.4.9.3.1" stretchy="false">[</mo><mi id="algorithm1.8.8.m1.2.2">i</mi><mo id="algorithm1.8.8.m1.4.9.3.2">,</mo><msub id="algorithm1.8.8.m1.4.9.3.3"><mi id="algorithm1.8.8.m1.4.9.3.3.2">g</mi><mi id="algorithm1.8.8.m1.4.9.3.3.3">s</mi></msub><mo id="algorithm1.8.8.m1.4.9.3.4" stretchy="false">]</mo></mrow><mo id="algorithm1.8.8.m1.4.9.4">,</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.8.8.m1.4.4">log</mtext><mrow id="algorithm1.8.8.m1.4.9.5"><mo id="algorithm1.8.8.m1.4.9.5.1" stretchy="false">(</mo><msub id="algorithm1.8.8.m1.4.9.5.2"><mi id="algorithm1.8.8.m1.4.9.5.2.2">P</mi><mi id="algorithm1.8.8.m1.4.9.5.2.3">s</mi></msub><mrow id="algorithm1.8.8.m1.4.9.5.3"><mo id="algorithm1.8.8.m1.4.9.5.3.1" stretchy="false">[</mo><msub id="algorithm1.8.8.m1.4.9.5.3.2"><mi id="algorithm1.8.8.m1.4.9.5.3.2.2">T</mi><mi id="algorithm1.8.8.m1.4.9.5.3.2.3">s</mi></msub><mrow id="algorithm1.8.8.m1.4.9.5.3.3"><mo id="algorithm1.8.8.m1.4.9.5.3.3.1" stretchy="false">[</mo><mi id="algorithm1.8.8.m1.3.3">i</mi><mo id="algorithm1.8.8.m1.4.9.5.3.3.2" stretchy="false">]</mo></mrow><mo id="algorithm1.8.8.m1.4.9.5.3.4" stretchy="false">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.4c">W[i,g_{s}]\leftarrow\textnormal{{max}}(W[i,g_{s}],\textnormal{{log}}(P_{s}[T_{%
s}[i]]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.4d">italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ] ← max ( italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ] , log ( italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_i ] ]</annotation></semantics></math>))

</div>
<div class="ltx_listingline" id="algorithm1.9.9">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="g_{p}\leftarrow\textnormal{{getInflectionGroup}}(T_{p}[i]" class="ltx_math_unparsed" display="inline" id="algorithm1.9.9.m1.1"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1b"><msub id="algorithm1.9.9.m1.1.2"><mi id="algorithm1.9.9.m1.1.2.2">g</mi><mi id="algorithm1.9.9.m1.1.2.3">p</mi></msub><mo id="algorithm1.9.9.m1.1.3" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.9.9.m1.1.4">getInflectionGroup</mtext><mrow id="algorithm1.9.9.m1.1.5"><mo id="algorithm1.9.9.m1.1.5.1" stretchy="false">(</mo><msub id="algorithm1.9.9.m1.1.5.2"><mi id="algorithm1.9.9.m1.1.5.2.2">T</mi><mi id="algorithm1.9.9.m1.1.5.2.3">p</mi></msub><mrow id="algorithm1.9.9.m1.1.5.3"><mo id="algorithm1.9.9.m1.1.5.3.1" stretchy="false">[</mo><mi id="algorithm1.9.9.m1.1.1">i</mi><mo id="algorithm1.9.9.m1.1.5.3.2" stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">g_{p}\leftarrow\textnormal{{getInflectionGroup}}(T_{p}[i]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ← getInflectionGroup ( italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT [ italic_i ]</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="W[i,g_{p}]\leftarrow\textnormal{{max}}(W[i,g_{p}],\textnormal{{log}}(P_{p}[T_{%
p}[i]]" class="ltx_math_unparsed" display="inline" id="algorithm1.10.10.m1.4"><semantics id="algorithm1.10.10.m1.4a"><mrow id="algorithm1.10.10.m1.4b"><mi id="algorithm1.10.10.m1.4.5">W</mi><mrow id="algorithm1.10.10.m1.4.6"><mo id="algorithm1.10.10.m1.4.6.1" stretchy="false">[</mo><mi id="algorithm1.10.10.m1.1.1">i</mi><mo id="algorithm1.10.10.m1.4.6.2">,</mo><msub id="algorithm1.10.10.m1.4.6.3"><mi id="algorithm1.10.10.m1.4.6.3.2">g</mi><mi id="algorithm1.10.10.m1.4.6.3.3">p</mi></msub><mo id="algorithm1.10.10.m1.4.6.4" stretchy="false">]</mo></mrow><mo id="algorithm1.10.10.m1.4.7" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.10.10.m1.4.8">max</mtext><mrow id="algorithm1.10.10.m1.4.9"><mo id="algorithm1.10.10.m1.4.9.1" stretchy="false">(</mo><mi id="algorithm1.10.10.m1.4.9.2">W</mi><mrow id="algorithm1.10.10.m1.4.9.3"><mo id="algorithm1.10.10.m1.4.9.3.1" stretchy="false">[</mo><mi id="algorithm1.10.10.m1.2.2">i</mi><mo id="algorithm1.10.10.m1.4.9.3.2">,</mo><msub id="algorithm1.10.10.m1.4.9.3.3"><mi id="algorithm1.10.10.m1.4.9.3.3.2">g</mi><mi id="algorithm1.10.10.m1.4.9.3.3.3">p</mi></msub><mo id="algorithm1.10.10.m1.4.9.3.4" stretchy="false">]</mo></mrow><mo id="algorithm1.10.10.m1.4.9.4">,</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.10.10.m1.4.4">log</mtext><mrow id="algorithm1.10.10.m1.4.9.5"><mo id="algorithm1.10.10.m1.4.9.5.1" stretchy="false">(</mo><msub id="algorithm1.10.10.m1.4.9.5.2"><mi id="algorithm1.10.10.m1.4.9.5.2.2">P</mi><mi id="algorithm1.10.10.m1.4.9.5.2.3">p</mi></msub><mrow id="algorithm1.10.10.m1.4.9.5.3"><mo id="algorithm1.10.10.m1.4.9.5.3.1" stretchy="false">[</mo><msub id="algorithm1.10.10.m1.4.9.5.3.2"><mi id="algorithm1.10.10.m1.4.9.5.3.2.2">T</mi><mi id="algorithm1.10.10.m1.4.9.5.3.2.3">p</mi></msub><mrow id="algorithm1.10.10.m1.4.9.5.3.3"><mo id="algorithm1.10.10.m1.4.9.5.3.3.1" stretchy="false">[</mo><mi id="algorithm1.10.10.m1.3.3">i</mi><mo id="algorithm1.10.10.m1.4.9.5.3.3.2" stretchy="false">]</mo></mrow><mo id="algorithm1.10.10.m1.4.9.5.3.4" stretchy="false">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.4c">W[i,g_{p}]\leftarrow\textnormal{{max}}(W[i,g_{p}],\textnormal{{log}}(P_{p}[T_{%
p}[i]]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.4d">italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ] ← max ( italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ] , log ( italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT [ italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT [ italic_i ] ]</annotation></semantics></math>))

</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="g_{a}\leftarrow\textnormal{{getInflectionGroup}}(T_{a}[i]" class="ltx_math_unparsed" display="inline" id="algorithm1.11.11.m1.1"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1b"><msub id="algorithm1.11.11.m1.1.2"><mi id="algorithm1.11.11.m1.1.2.2">g</mi><mi id="algorithm1.11.11.m1.1.2.3">a</mi></msub><mo id="algorithm1.11.11.m1.1.3" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.11.11.m1.1.4">getInflectionGroup</mtext><mrow id="algorithm1.11.11.m1.1.5"><mo id="algorithm1.11.11.m1.1.5.1" stretchy="false">(</mo><msub id="algorithm1.11.11.m1.1.5.2"><mi id="algorithm1.11.11.m1.1.5.2.2">T</mi><mi id="algorithm1.11.11.m1.1.5.2.3">a</mi></msub><mrow id="algorithm1.11.11.m1.1.5.3"><mo id="algorithm1.11.11.m1.1.5.3.1" stretchy="false">[</mo><mi id="algorithm1.11.11.m1.1.1">i</mi><mo id="algorithm1.11.11.m1.1.5.3.2" stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">g_{a}\leftarrow\textnormal{{getInflectionGroup}}(T_{a}[i]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.1d">italic_g start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← getInflectionGroup ( italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT [ italic_i ]</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="algorithm1.12.12">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="W[i,g_{a}]\leftarrow\textnormal{{max}}(W[i,g_{a}],\textnormal{{log}}(P_{a}[T_{%
a}[i]]" class="ltx_math_unparsed" display="inline" id="algorithm1.12.12.m1.4"><semantics id="algorithm1.12.12.m1.4a"><mrow id="algorithm1.12.12.m1.4b"><mi id="algorithm1.12.12.m1.4.5">W</mi><mrow id="algorithm1.12.12.m1.4.6"><mo id="algorithm1.12.12.m1.4.6.1" stretchy="false">[</mo><mi id="algorithm1.12.12.m1.1.1">i</mi><mo id="algorithm1.12.12.m1.4.6.2">,</mo><msub id="algorithm1.12.12.m1.4.6.3"><mi id="algorithm1.12.12.m1.4.6.3.2">g</mi><mi id="algorithm1.12.12.m1.4.6.3.3">a</mi></msub><mo id="algorithm1.12.12.m1.4.6.4" stretchy="false">]</mo></mrow><mo id="algorithm1.12.12.m1.4.7" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.12.12.m1.4.8">max</mtext><mrow id="algorithm1.12.12.m1.4.9"><mo id="algorithm1.12.12.m1.4.9.1" stretchy="false">(</mo><mi id="algorithm1.12.12.m1.4.9.2">W</mi><mrow id="algorithm1.12.12.m1.4.9.3"><mo id="algorithm1.12.12.m1.4.9.3.1" stretchy="false">[</mo><mi id="algorithm1.12.12.m1.2.2">i</mi><mo id="algorithm1.12.12.m1.4.9.3.2">,</mo><msub id="algorithm1.12.12.m1.4.9.3.3"><mi id="algorithm1.12.12.m1.4.9.3.3.2">g</mi><mi id="algorithm1.12.12.m1.4.9.3.3.3">a</mi></msub><mo id="algorithm1.12.12.m1.4.9.3.4" stretchy="false">]</mo></mrow><mo id="algorithm1.12.12.m1.4.9.4">,</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.12.12.m1.4.4">log</mtext><mrow id="algorithm1.12.12.m1.4.9.5"><mo id="algorithm1.12.12.m1.4.9.5.1" stretchy="false">(</mo><msub id="algorithm1.12.12.m1.4.9.5.2"><mi id="algorithm1.12.12.m1.4.9.5.2.2">P</mi><mi id="algorithm1.12.12.m1.4.9.5.2.3">a</mi></msub><mrow id="algorithm1.12.12.m1.4.9.5.3"><mo id="algorithm1.12.12.m1.4.9.5.3.1" stretchy="false">[</mo><msub id="algorithm1.12.12.m1.4.9.5.3.2"><mi id="algorithm1.12.12.m1.4.9.5.3.2.2">T</mi><mi id="algorithm1.12.12.m1.4.9.5.3.2.3">a</mi></msub><mrow id="algorithm1.12.12.m1.4.9.5.3.3"><mo id="algorithm1.12.12.m1.4.9.5.3.3.1" stretchy="false">[</mo><mi id="algorithm1.12.12.m1.3.3">i</mi><mo id="algorithm1.12.12.m1.4.9.5.3.3.2" stretchy="false">]</mo></mrow><mo id="algorithm1.12.12.m1.4.9.5.3.4" stretchy="false">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.4c">W[i,g_{a}]\leftarrow\textnormal{{max}}(W[i,g_{a}],\textnormal{{log}}(P_{a}[T_{%
a}[i]]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.4d">italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ] ← max ( italic_W [ italic_i , italic_g start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ] , log ( italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT [ italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT [ italic_i ] ]</annotation></semantics></math>))

</div>
<div class="ltx_listingline" id="algorithm1.38.43">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div class="ltx_listingline" id="algorithm1.38.44">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm1.13.13">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="V\leftarrow G" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">V</mi><mo id="algorithm1.13.13.m1.1.1.1" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.cmml">←</mo><mi id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1">←</ci><ci id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2">𝑉</ci><ci id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">V\leftarrow G</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">italic_V ← italic_G</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm1.13.13.1">array</span>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="V[g]\leftarrow\sum_{i=1}^{M}{W[i,g]},\forall g=1,2,..G" class="ltx_math_unparsed" display="inline" id="algorithm1.14.14.m1.5"><semantics id="algorithm1.14.14.m1.5a"><mrow id="algorithm1.14.14.m1.5b"><mi id="algorithm1.14.14.m1.5.6">V</mi><mrow id="algorithm1.14.14.m1.5.7"><mo id="algorithm1.14.14.m1.5.7.1" stretchy="false">[</mo><mi id="algorithm1.14.14.m1.1.1">g</mi><mo id="algorithm1.14.14.m1.5.7.2" stretchy="false">]</mo></mrow><mo id="algorithm1.14.14.m1.5.8" rspace="0.111em" stretchy="false">←</mo><msubsup id="algorithm1.14.14.m1.5.9"><mo id="algorithm1.14.14.m1.5.9.2.2">∑</mo><mrow id="algorithm1.14.14.m1.5.9.2.3"><mi id="algorithm1.14.14.m1.5.9.2.3.2">i</mi><mo id="algorithm1.14.14.m1.5.9.2.3.1">=</mo><mn id="algorithm1.14.14.m1.5.9.2.3.3">1</mn></mrow><mi id="algorithm1.14.14.m1.5.9.3">M</mi></msubsup><mi id="algorithm1.14.14.m1.5.10">W</mi><mrow id="algorithm1.14.14.m1.5.11"><mo id="algorithm1.14.14.m1.5.11.1" stretchy="false">[</mo><mi id="algorithm1.14.14.m1.2.2">i</mi><mo id="algorithm1.14.14.m1.5.11.2">,</mo><mi id="algorithm1.14.14.m1.3.3">g</mi><mo id="algorithm1.14.14.m1.5.11.3" stretchy="false">]</mo></mrow><mo id="algorithm1.14.14.m1.5.12">,</mo><mo id="algorithm1.14.14.m1.5.13" rspace="0.167em">∀</mo><mi id="algorithm1.14.14.m1.5.14">g</mi><mo id="algorithm1.14.14.m1.5.15">=</mo><mn id="algorithm1.14.14.m1.4.4">1</mn><mo id="algorithm1.14.14.m1.5.16">,</mo><mn id="algorithm1.14.14.m1.5.5">2</mn><mo id="algorithm1.14.14.m1.5.17">,</mo><mo id="algorithm1.14.14.m1.5.18" lspace="0em" rspace="0.0835em">.</mo><mo id="algorithm1.14.14.m1.5.19" lspace="0.0835em" rspace="0.167em">.</mo><mi id="algorithm1.14.14.m1.5.20">G</mi></mrow><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.5c">V[g]\leftarrow\sum_{i=1}^{M}{W[i,g]},\forall g=1,2,..G</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.5d">italic_V [ italic_g ] ← ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_W [ italic_i , italic_g ] , ∀ italic_g = 1 , 2 , . . italic_G</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.15.15">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="P_{g}\leftarrow\textnormal{{softmax}}(V)" class="ltx_Math" display="inline" id="algorithm1.15.15.m1.1"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.2" xref="algorithm1.15.15.m1.1.2.cmml"><msub id="algorithm1.15.15.m1.1.2.2" xref="algorithm1.15.15.m1.1.2.2.cmml"><mi id="algorithm1.15.15.m1.1.2.2.2" xref="algorithm1.15.15.m1.1.2.2.2.cmml">P</mi><mi id="algorithm1.15.15.m1.1.2.2.3" xref="algorithm1.15.15.m1.1.2.2.3.cmml">g</mi></msub><mo id="algorithm1.15.15.m1.1.2.1" stretchy="false" xref="algorithm1.15.15.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.15.15.m1.1.2.3" xref="algorithm1.15.15.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.15.15.m1.1.2.3.2" xref="algorithm1.15.15.m1.1.2.3.2a.cmml">softmax</mtext><mo id="algorithm1.15.15.m1.1.2.3.1" xref="algorithm1.15.15.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm1.15.15.m1.1.2.3.3.2" xref="algorithm1.15.15.m1.1.2.3.cmml"><mo id="algorithm1.15.15.m1.1.2.3.3.2.1" stretchy="false" xref="algorithm1.15.15.m1.1.2.3.cmml">(</mo><mi id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml">V</mi><mo id="algorithm1.15.15.m1.1.2.3.3.2.2" stretchy="false" xref="algorithm1.15.15.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.2.cmml" xref="algorithm1.15.15.m1.1.2"><ci id="algorithm1.15.15.m1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.2.1">←</ci><apply id="algorithm1.15.15.m1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.2.2.1.cmml" xref="algorithm1.15.15.m1.1.2.2">subscript</csymbol><ci id="algorithm1.15.15.m1.1.2.2.2.cmml" xref="algorithm1.15.15.m1.1.2.2.2">𝑃</ci><ci id="algorithm1.15.15.m1.1.2.2.3.cmml" xref="algorithm1.15.15.m1.1.2.2.3">𝑔</ci></apply><apply id="algorithm1.15.15.m1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.2.3"><times id="algorithm1.15.15.m1.1.2.3.1.cmml" xref="algorithm1.15.15.m1.1.2.3.1"></times><ci id="algorithm1.15.15.m1.1.2.3.2a.cmml" xref="algorithm1.15.15.m1.1.2.3.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.15.15.m1.1.2.3.2.cmml" xref="algorithm1.15.15.m1.1.2.3.2">softmax</mtext></ci><ci id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">P_{g}\leftarrow\textnormal{{softmax}}(V)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.15.m1.1d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ← softmax ( italic_V )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.16.16">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.16.16.2">return</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.16.16.1"><math alttext="P_{g}" class="ltx_Math" display="inline" id="algorithm1.16.16.1.m1.1"><semantics id="algorithm1.16.16.1.m1.1a"><msub id="algorithm1.16.16.1.m1.1.1" xref="algorithm1.16.16.1.m1.1.1.cmml"><mi id="algorithm1.16.16.1.m1.1.1.2" xref="algorithm1.16.16.1.m1.1.1.2.cmml">P</mi><mi id="algorithm1.16.16.1.m1.1.1.3" xref="algorithm1.16.16.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.1.m1.1b"><apply id="algorithm1.16.16.1.m1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.1.m1.1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1">subscript</csymbol><ci id="algorithm1.16.16.1.m1.1.1.2.cmml" xref="algorithm1.16.16.1.m1.1.1.2">𝑃</ci><ci id="algorithm1.16.16.1.m1.1.1.3.cmml" xref="algorithm1.16.16.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.1.m1.1c">P_{g}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.16.16.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.45">
<span class="ltx_tag ltx_tag_listingline">21</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.46">
<span class="ltx_tag ltx_tag_listingline">22</span>
</div>
<div class="ltx_listingline" id="algorithm1.17.17">
<span class="ltx_tag ltx_tag_listingline">23</span><span class="ltx_text ltx_font_bold" id="algorithm1.17.17.2">Subroutine:</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.17.17.1"><math alttext="\textnormal{{filterAndCutOff}}(T,P,g,\delta,\gamma)" class="ltx_Math" display="inline" id="algorithm1.17.17.1.m1.5"><semantics id="algorithm1.17.17.1.m1.5a"><mrow id="algorithm1.17.17.1.m1.5.6" xref="algorithm1.17.17.1.m1.5.6.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.17.17.1.m1.5.6.2" xref="algorithm1.17.17.1.m1.5.6.2b.cmml"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.17.17.1.m1.5.6.2.1nest">filterAndCutOff</em></mtext><mo id="algorithm1.17.17.1.m1.5.6.1" xref="algorithm1.17.17.1.m1.5.6.1.cmml">⁢</mo><mrow id="algorithm1.17.17.1.m1.5.6.3.2" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml"><mo id="algorithm1.17.17.1.m1.5.6.3.2.1" stretchy="false" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">(</mo><mi id="algorithm1.17.17.1.m1.1.1" xref="algorithm1.17.17.1.m1.1.1.cmml">T</mi><mo id="algorithm1.17.17.1.m1.5.6.3.2.2" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">,</mo><mi id="algorithm1.17.17.1.m1.2.2" xref="algorithm1.17.17.1.m1.2.2.cmml">P</mi><mo id="algorithm1.17.17.1.m1.5.6.3.2.3" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">,</mo><mi id="algorithm1.17.17.1.m1.3.3" xref="algorithm1.17.17.1.m1.3.3.cmml">g</mi><mo id="algorithm1.17.17.1.m1.5.6.3.2.4" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">,</mo><mi id="algorithm1.17.17.1.m1.4.4" xref="algorithm1.17.17.1.m1.4.4.cmml">δ</mi><mo id="algorithm1.17.17.1.m1.5.6.3.2.5" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">,</mo><mi id="algorithm1.17.17.1.m1.5.5" xref="algorithm1.17.17.1.m1.5.5.cmml">γ</mi><mo id="algorithm1.17.17.1.m1.5.6.3.2.6" stretchy="false" xref="algorithm1.17.17.1.m1.5.6.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.1.m1.5b"><apply id="algorithm1.17.17.1.m1.5.6.cmml" xref="algorithm1.17.17.1.m1.5.6"><times id="algorithm1.17.17.1.m1.5.6.1.cmml" xref="algorithm1.17.17.1.m1.5.6.1"></times><ci id="algorithm1.17.17.1.m1.5.6.2b.cmml" xref="algorithm1.17.17.1.m1.5.6.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.17.17.1.m1.5.6.2.cmml" xref="algorithm1.17.17.1.m1.5.6.2"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.17.17.1.m1.5.6.2.1anest">filterAndCutOff</em></mtext></ci><vector id="algorithm1.17.17.1.m1.5.6.3.1.cmml" xref="algorithm1.17.17.1.m1.5.6.3.2"><ci id="algorithm1.17.17.1.m1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1">𝑇</ci><ci id="algorithm1.17.17.1.m1.2.2.cmml" xref="algorithm1.17.17.1.m1.2.2">𝑃</ci><ci id="algorithm1.17.17.1.m1.3.3.cmml" xref="algorithm1.17.17.1.m1.3.3">𝑔</ci><ci id="algorithm1.17.17.1.m1.4.4.cmml" xref="algorithm1.17.17.1.m1.4.4">𝛿</ci><ci id="algorithm1.17.17.1.m1.5.5.cmml" xref="algorithm1.17.17.1.m1.5.5">𝛾</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.1.m1.5c">\textnormal{{filterAndCutOff}}(T,P,g,\delta,\gamma)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.17.17.1.m1.5d">filterAndCutOff ( italic_T , italic_P , italic_g , italic_δ , italic_γ )</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.47">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.18.18">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T^{{}^{\prime}}\leftarrow[~{}]" class="ltx_Math" display="inline" id="algorithm1.18.18.m1.1"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><msup id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml"><mi id="algorithm1.18.18.m1.1.1.2.2" xref="algorithm1.18.18.m1.1.1.2.2.cmml">T</mi><msup id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml"><mi id="algorithm1.18.18.m1.1.1.2.3a" xref="algorithm1.18.18.m1.1.1.2.3.cmml"></mi><mo id="algorithm1.18.18.m1.1.1.2.3.1" xref="algorithm1.18.18.m1.1.1.2.3.1.cmml">′</mo></msup></msup><mo id="algorithm1.18.18.m1.1.1.1" stretchy="false" xref="algorithm1.18.18.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.18.18.m1.1.1.3.2" xref="algorithm1.18.18.m1.1.1.cmml"><mo id="algorithm1.18.18.m1.1.1.3.2.1" rspace="0.330em" stretchy="false" xref="algorithm1.18.18.m1.1.1.3.1.cmml">[</mo><mo id="algorithm1.18.18.m1.1.1.3.2.2" stretchy="false" xref="algorithm1.18.18.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><ci id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1">←</ci><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1.2">superscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2">𝑇</ci><apply id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3"><ci id="algorithm1.18.18.m1.1.1.2.3.1.cmml" xref="algorithm1.18.18.m1.1.1.2.3.1">′</ci></apply></apply><list id="algorithm1.18.18.m1.1.1.3.1.cmml" xref="algorithm1.18.18.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">T^{{}^{\prime}}\leftarrow[~{}]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.18.m1.1d">italic_T start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← [ ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.19.19">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="pp\leftarrow 0" class="ltx_Math" display="inline" id="algorithm1.19.19.m1.1"><semantics id="algorithm1.19.19.m1.1a"><mrow id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><mrow id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml"><mi id="algorithm1.19.19.m1.1.1.2.2" xref="algorithm1.19.19.m1.1.1.2.2.cmml">p</mi><mo id="algorithm1.19.19.m1.1.1.2.1" xref="algorithm1.19.19.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.19.19.m1.1.1.2.3" xref="algorithm1.19.19.m1.1.1.2.3.cmml">p</mi></mrow><mo id="algorithm1.19.19.m1.1.1.1" stretchy="false" xref="algorithm1.19.19.m1.1.1.1.cmml">←</mo><mn id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><ci id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1.1">←</ci><apply id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2"><times id="algorithm1.19.19.m1.1.1.2.1.cmml" xref="algorithm1.19.19.m1.1.1.2.1"></times><ci id="algorithm1.19.19.m1.1.1.2.2.cmml" xref="algorithm1.19.19.m1.1.1.2.2">𝑝</ci><ci id="algorithm1.19.19.m1.1.1.2.3.cmml" xref="algorithm1.19.19.m1.1.1.2.3">𝑝</ci></apply><cn id="algorithm1.19.19.m1.1.1.3.cmml" type="integer" xref="algorithm1.19.19.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">pp\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="algorithm1.19.19.m1.1d">italic_p italic_p ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.20.20">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.20.20.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.20.20.1"><math alttext="i\in T" class="ltx_Math" display="inline" id="algorithm1.20.20.1.m1.1"><semantics id="algorithm1.20.20.1.m1.1a"><mrow id="algorithm1.20.20.1.m1.1.1" xref="algorithm1.20.20.1.m1.1.1.cmml"><mi id="algorithm1.20.20.1.m1.1.1.2" xref="algorithm1.20.20.1.m1.1.1.2.cmml">i</mi><mo id="algorithm1.20.20.1.m1.1.1.1" xref="algorithm1.20.20.1.m1.1.1.1.cmml">∈</mo><mi id="algorithm1.20.20.1.m1.1.1.3" xref="algorithm1.20.20.1.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.1.m1.1b"><apply id="algorithm1.20.20.1.m1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1"><in id="algorithm1.20.20.1.m1.1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1"></in><ci id="algorithm1.20.20.1.m1.1.1.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2">𝑖</ci><ci id="algorithm1.20.20.1.m1.1.1.3.cmml" xref="algorithm1.20.20.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.1.m1.1c">i\in T</annotation><annotation encoding="application/x-llamapun" id="algorithm1.20.20.1.m1.1d">italic_i ∈ italic_T</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.20.20.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.22.22">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.22.22.3">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.22.22.2">(<math alttext="\textnormal{{getInflectionGroup}}(i)=g" class="ltx_Math" display="inline" id="algorithm1.21.21.1.m1.1"><semantics id="algorithm1.21.21.1.m1.1a"><mrow id="algorithm1.21.21.1.m1.1.2" xref="algorithm1.21.21.1.m1.1.2.cmml"><mrow id="algorithm1.21.21.1.m1.1.2.2" xref="algorithm1.21.21.1.m1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.21.21.1.m1.1.2.2.2" xref="algorithm1.21.21.1.m1.1.2.2.2b.cmml"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.21.21.1.m1.1.2.2.2.1nest">getInflectionGroup</em></mtext><mo id="algorithm1.21.21.1.m1.1.2.2.1" xref="algorithm1.21.21.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="algorithm1.21.21.1.m1.1.2.2.3.2" xref="algorithm1.21.21.1.m1.1.2.2.cmml"><mo id="algorithm1.21.21.1.m1.1.2.2.3.2.1" stretchy="false" xref="algorithm1.21.21.1.m1.1.2.2.cmml">(</mo><mi id="algorithm1.21.21.1.m1.1.1" xref="algorithm1.21.21.1.m1.1.1.cmml">i</mi><mo id="algorithm1.21.21.1.m1.1.2.2.3.2.2" stretchy="false" xref="algorithm1.21.21.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.21.21.1.m1.1.2.1" xref="algorithm1.21.21.1.m1.1.2.1.cmml">=</mo><mi id="algorithm1.21.21.1.m1.1.2.3" xref="algorithm1.21.21.1.m1.1.2.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.1.m1.1b"><apply id="algorithm1.21.21.1.m1.1.2.cmml" xref="algorithm1.21.21.1.m1.1.2"><eq id="algorithm1.21.21.1.m1.1.2.1.cmml" xref="algorithm1.21.21.1.m1.1.2.1"></eq><apply id="algorithm1.21.21.1.m1.1.2.2.cmml" xref="algorithm1.21.21.1.m1.1.2.2"><times id="algorithm1.21.21.1.m1.1.2.2.1.cmml" xref="algorithm1.21.21.1.m1.1.2.2.1"></times><ci id="algorithm1.21.21.1.m1.1.2.2.2b.cmml" xref="algorithm1.21.21.1.m1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.21.21.1.m1.1.2.2.2.cmml" xref="algorithm1.21.21.1.m1.1.2.2.2"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.21.21.1.m1.1.2.2.2.1anest">getInflectionGroup</em></mtext></ci><ci id="algorithm1.21.21.1.m1.1.1.cmml" xref="algorithm1.21.21.1.m1.1.1">𝑖</ci></apply><ci id="algorithm1.21.21.1.m1.1.2.3.cmml" xref="algorithm1.21.21.1.m1.1.2.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.1.m1.1c">\textnormal{{getInflectionGroup}}(i)=g</annotation><annotation encoding="application/x-llamapun" id="algorithm1.21.21.1.m1.1d">getInflectionGroup ( italic_i ) = italic_g</annotation></semantics></math>) and (<math alttext="P[i]\geq\gamma" class="ltx_Math" display="inline" id="algorithm1.22.22.2.m2.1"><semantics id="algorithm1.22.22.2.m2.1a"><mrow id="algorithm1.22.22.2.m2.1.2" xref="algorithm1.22.22.2.m2.1.2.cmml"><mrow id="algorithm1.22.22.2.m2.1.2.2" xref="algorithm1.22.22.2.m2.1.2.2.cmml"><mi id="algorithm1.22.22.2.m2.1.2.2.2" xref="algorithm1.22.22.2.m2.1.2.2.2.cmml">P</mi><mo id="algorithm1.22.22.2.m2.1.2.2.1" xref="algorithm1.22.22.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="algorithm1.22.22.2.m2.1.2.2.3.2" xref="algorithm1.22.22.2.m2.1.2.2.3.1.cmml"><mo id="algorithm1.22.22.2.m2.1.2.2.3.2.1" stretchy="false" xref="algorithm1.22.22.2.m2.1.2.2.3.1.1.cmml">[</mo><mi id="algorithm1.22.22.2.m2.1.1" xref="algorithm1.22.22.2.m2.1.1.cmml">i</mi><mo id="algorithm1.22.22.2.m2.1.2.2.3.2.2" stretchy="false" xref="algorithm1.22.22.2.m2.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.22.22.2.m2.1.2.1" xref="algorithm1.22.22.2.m2.1.2.1.cmml">≥</mo><mi id="algorithm1.22.22.2.m2.1.2.3" xref="algorithm1.22.22.2.m2.1.2.3.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.2.m2.1b"><apply id="algorithm1.22.22.2.m2.1.2.cmml" xref="algorithm1.22.22.2.m2.1.2"><geq id="algorithm1.22.22.2.m2.1.2.1.cmml" xref="algorithm1.22.22.2.m2.1.2.1"></geq><apply id="algorithm1.22.22.2.m2.1.2.2.cmml" xref="algorithm1.22.22.2.m2.1.2.2"><times id="algorithm1.22.22.2.m2.1.2.2.1.cmml" xref="algorithm1.22.22.2.m2.1.2.2.1"></times><ci id="algorithm1.22.22.2.m2.1.2.2.2.cmml" xref="algorithm1.22.22.2.m2.1.2.2.2">𝑃</ci><apply id="algorithm1.22.22.2.m2.1.2.2.3.1.cmml" xref="algorithm1.22.22.2.m2.1.2.2.3.2"><csymbol cd="latexml" id="algorithm1.22.22.2.m2.1.2.2.3.1.1.cmml" xref="algorithm1.22.22.2.m2.1.2.2.3.2.1">delimited-[]</csymbol><ci id="algorithm1.22.22.2.m2.1.1.cmml" xref="algorithm1.22.22.2.m2.1.1">𝑖</ci></apply></apply><ci id="algorithm1.22.22.2.m2.1.2.3.cmml" xref="algorithm1.22.22.2.m2.1.2.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.2.m2.1c">P[i]\geq\gamma</annotation><annotation encoding="application/x-llamapun" id="algorithm1.22.22.2.m2.1d">italic_P [ italic_i ] ≥ italic_γ</annotation></semantics></math>)</em> <span class="ltx_text ltx_font_bold" id="algorithm1.22.22.4">then</span>
</div>
<div class="ltx_listingline" id="algorithm1.23.23">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="T^{{}^{\prime}}.append(i)" class="ltx_Math" display="inline" id="algorithm1.23.23.m1.3"><semantics id="algorithm1.23.23.m1.3a"><mrow id="algorithm1.23.23.m1.3.3.2" xref="algorithm1.23.23.m1.3.3.3.cmml"><msup id="algorithm1.23.23.m1.2.2.1.1" xref="algorithm1.23.23.m1.2.2.1.1.cmml"><mi id="algorithm1.23.23.m1.2.2.1.1.2" xref="algorithm1.23.23.m1.2.2.1.1.2.cmml">T</mi><msup id="algorithm1.23.23.m1.2.2.1.1.3" xref="algorithm1.23.23.m1.2.2.1.1.3.cmml"><mi id="algorithm1.23.23.m1.2.2.1.1.3a" xref="algorithm1.23.23.m1.2.2.1.1.3.cmml"></mi><mo id="algorithm1.23.23.m1.2.2.1.1.3.1" xref="algorithm1.23.23.m1.2.2.1.1.3.1.cmml">′</mo></msup></msup><mo id="algorithm1.23.23.m1.3.3.2.3" lspace="0em" rspace="0.167em" xref="algorithm1.23.23.m1.3.3.3a.cmml">.</mo><mrow id="algorithm1.23.23.m1.3.3.2.2" xref="algorithm1.23.23.m1.3.3.2.2.cmml"><mi id="algorithm1.23.23.m1.3.3.2.2.2" xref="algorithm1.23.23.m1.3.3.2.2.2.cmml">a</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mi id="algorithm1.23.23.m1.3.3.2.2.3" xref="algorithm1.23.23.m1.3.3.2.2.3.cmml">p</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1a" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mi id="algorithm1.23.23.m1.3.3.2.2.4" xref="algorithm1.23.23.m1.3.3.2.2.4.cmml">p</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1b" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mi id="algorithm1.23.23.m1.3.3.2.2.5" xref="algorithm1.23.23.m1.3.3.2.2.5.cmml">e</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1c" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mi id="algorithm1.23.23.m1.3.3.2.2.6" xref="algorithm1.23.23.m1.3.3.2.2.6.cmml">n</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1d" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mi id="algorithm1.23.23.m1.3.3.2.2.7" xref="algorithm1.23.23.m1.3.3.2.2.7.cmml">d</mi><mo id="algorithm1.23.23.m1.3.3.2.2.1e" xref="algorithm1.23.23.m1.3.3.2.2.1.cmml">⁢</mo><mrow id="algorithm1.23.23.m1.3.3.2.2.8.2" xref="algorithm1.23.23.m1.3.3.2.2.cmml"><mo id="algorithm1.23.23.m1.3.3.2.2.8.2.1" stretchy="false" xref="algorithm1.23.23.m1.3.3.2.2.cmml">(</mo><mi id="algorithm1.23.23.m1.1.1" xref="algorithm1.23.23.m1.1.1.cmml">i</mi><mo id="algorithm1.23.23.m1.3.3.2.2.8.2.2" stretchy="false" xref="algorithm1.23.23.m1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m1.3b"><apply id="algorithm1.23.23.m1.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3a.cmml" xref="algorithm1.23.23.m1.3.3.2.3">formulae-sequence</csymbol><apply id="algorithm1.23.23.m1.2.2.1.1.cmml" xref="algorithm1.23.23.m1.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.2.2.1.1.1.cmml" xref="algorithm1.23.23.m1.2.2.1.1">superscript</csymbol><ci id="algorithm1.23.23.m1.2.2.1.1.2.cmml" xref="algorithm1.23.23.m1.2.2.1.1.2">𝑇</ci><apply id="algorithm1.23.23.m1.2.2.1.1.3.cmml" xref="algorithm1.23.23.m1.2.2.1.1.3"><ci id="algorithm1.23.23.m1.2.2.1.1.3.1.cmml" xref="algorithm1.23.23.m1.2.2.1.1.3.1">′</ci></apply></apply><apply id="algorithm1.23.23.m1.3.3.2.2.cmml" xref="algorithm1.23.23.m1.3.3.2.2"><times id="algorithm1.23.23.m1.3.3.2.2.1.cmml" xref="algorithm1.23.23.m1.3.3.2.2.1"></times><ci id="algorithm1.23.23.m1.3.3.2.2.2.cmml" xref="algorithm1.23.23.m1.3.3.2.2.2">𝑎</ci><ci id="algorithm1.23.23.m1.3.3.2.2.3.cmml" xref="algorithm1.23.23.m1.3.3.2.2.3">𝑝</ci><ci id="algorithm1.23.23.m1.3.3.2.2.4.cmml" xref="algorithm1.23.23.m1.3.3.2.2.4">𝑝</ci><ci id="algorithm1.23.23.m1.3.3.2.2.5.cmml" xref="algorithm1.23.23.m1.3.3.2.2.5">𝑒</ci><ci id="algorithm1.23.23.m1.3.3.2.2.6.cmml" xref="algorithm1.23.23.m1.3.3.2.2.6">𝑛</ci><ci id="algorithm1.23.23.m1.3.3.2.2.7.cmml" xref="algorithm1.23.23.m1.3.3.2.2.7">𝑑</ci><ci id="algorithm1.23.23.m1.1.1.cmml" xref="algorithm1.23.23.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.3c">T^{{}^{\prime}}.append(i)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.23.23.m1.3d">italic_T start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT . italic_a italic_p italic_p italic_e italic_n italic_d ( italic_i )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.24.24">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.24.24.2">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.24.24.1"><math alttext="(pp-P[i])&gt;\delta" class="ltx_Math" display="inline" id="algorithm1.24.24.1.m1.2"><semantics id="algorithm1.24.24.1.m1.2a"><mrow id="algorithm1.24.24.1.m1.2.2" xref="algorithm1.24.24.1.m1.2.2.cmml"><mrow id="algorithm1.24.24.1.m1.2.2.1.1" xref="algorithm1.24.24.1.m1.2.2.1.1.1.cmml"><mo id="algorithm1.24.24.1.m1.2.2.1.1.2" stretchy="false" xref="algorithm1.24.24.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.24.24.1.m1.2.2.1.1.1" xref="algorithm1.24.24.1.m1.2.2.1.1.1.cmml"><mrow id="algorithm1.24.24.1.m1.2.2.1.1.1.2" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.cmml"><mi id="algorithm1.24.24.1.m1.2.2.1.1.1.2.2" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.2.cmml">p</mi><mo id="algorithm1.24.24.1.m1.2.2.1.1.1.2.1" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.24.24.1.m1.2.2.1.1.1.2.3" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.3.cmml">p</mi></mrow><mo id="algorithm1.24.24.1.m1.2.2.1.1.1.1" xref="algorithm1.24.24.1.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="algorithm1.24.24.1.m1.2.2.1.1.1.3" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.cmml"><mi id="algorithm1.24.24.1.m1.2.2.1.1.1.3.2" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.2.cmml">P</mi><mo id="algorithm1.24.24.1.m1.2.2.1.1.1.3.1" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.2" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.1.cmml"><mo id="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.2.1" stretchy="false" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.1.1.cmml">[</mo><mi id="algorithm1.24.24.1.m1.1.1" xref="algorithm1.24.24.1.m1.1.1.cmml">i</mi><mo id="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.2.2" stretchy="false" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="algorithm1.24.24.1.m1.2.2.1.1.3" stretchy="false" xref="algorithm1.24.24.1.m1.2.2.1.1.1.cmml">)</mo></mrow><mo id="algorithm1.24.24.1.m1.2.2.2" xref="algorithm1.24.24.1.m1.2.2.2.cmml">&gt;</mo><mi id="algorithm1.24.24.1.m1.2.2.3" xref="algorithm1.24.24.1.m1.2.2.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.1.m1.2b"><apply id="algorithm1.24.24.1.m1.2.2.cmml" xref="algorithm1.24.24.1.m1.2.2"><gt id="algorithm1.24.24.1.m1.2.2.2.cmml" xref="algorithm1.24.24.1.m1.2.2.2"></gt><apply id="algorithm1.24.24.1.m1.2.2.1.1.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1"><minus id="algorithm1.24.24.1.m1.2.2.1.1.1.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.1"></minus><apply id="algorithm1.24.24.1.m1.2.2.1.1.1.2.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2"><times id="algorithm1.24.24.1.m1.2.2.1.1.1.2.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.1"></times><ci id="algorithm1.24.24.1.m1.2.2.1.1.1.2.2.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.2">𝑝</ci><ci id="algorithm1.24.24.1.m1.2.2.1.1.1.2.3.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.2.3">𝑝</ci></apply><apply id="algorithm1.24.24.1.m1.2.2.1.1.1.3.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3"><times id="algorithm1.24.24.1.m1.2.2.1.1.1.3.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.1"></times><ci id="algorithm1.24.24.1.m1.2.2.1.1.1.3.2.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.2">𝑃</ci><apply id="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.2"><csymbol cd="latexml" id="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.1.1.cmml" xref="algorithm1.24.24.1.m1.2.2.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="algorithm1.24.24.1.m1.1.1.cmml" xref="algorithm1.24.24.1.m1.1.1">𝑖</ci></apply></apply></apply><ci id="algorithm1.24.24.1.m1.2.2.3.cmml" xref="algorithm1.24.24.1.m1.2.2.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.1.m1.2c">(pp-P[i])&gt;\delta</annotation><annotation encoding="application/x-llamapun" id="algorithm1.24.24.1.m1.2d">( italic_p italic_p - italic_P [ italic_i ] ) &gt; italic_δ</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.24.24.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.48">
<span class="ltx_tag ltx_tag_listingline">31</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
break

</div>
<div class="ltx_listingline" id="algorithm1.25.25">
<span class="ltx_tag ltx_tag_listingline">32</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="pp\leftarrow P[i]" class="ltx_Math" display="inline" id="algorithm1.25.25.m1.1"><semantics id="algorithm1.25.25.m1.1a"><mrow id="algorithm1.25.25.m1.1.2" xref="algorithm1.25.25.m1.1.2.cmml"><mrow id="algorithm1.25.25.m1.1.2.2" xref="algorithm1.25.25.m1.1.2.2.cmml"><mi id="algorithm1.25.25.m1.1.2.2.2" xref="algorithm1.25.25.m1.1.2.2.2.cmml">p</mi><mo id="algorithm1.25.25.m1.1.2.2.1" xref="algorithm1.25.25.m1.1.2.2.1.cmml">⁢</mo><mi id="algorithm1.25.25.m1.1.2.2.3" xref="algorithm1.25.25.m1.1.2.2.3.cmml">p</mi></mrow><mo id="algorithm1.25.25.m1.1.2.1" stretchy="false" xref="algorithm1.25.25.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.25.25.m1.1.2.3" xref="algorithm1.25.25.m1.1.2.3.cmml"><mi id="algorithm1.25.25.m1.1.2.3.2" xref="algorithm1.25.25.m1.1.2.3.2.cmml">P</mi><mo id="algorithm1.25.25.m1.1.2.3.1" xref="algorithm1.25.25.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm1.25.25.m1.1.2.3.3.2" xref="algorithm1.25.25.m1.1.2.3.3.1.cmml"><mo id="algorithm1.25.25.m1.1.2.3.3.2.1" stretchy="false" xref="algorithm1.25.25.m1.1.2.3.3.1.1.cmml">[</mo><mi id="algorithm1.25.25.m1.1.1" xref="algorithm1.25.25.m1.1.1.cmml">i</mi><mo id="algorithm1.25.25.m1.1.2.3.3.2.2" stretchy="false" xref="algorithm1.25.25.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m1.1b"><apply id="algorithm1.25.25.m1.1.2.cmml" xref="algorithm1.25.25.m1.1.2"><ci id="algorithm1.25.25.m1.1.2.1.cmml" xref="algorithm1.25.25.m1.1.2.1">←</ci><apply id="algorithm1.25.25.m1.1.2.2.cmml" xref="algorithm1.25.25.m1.1.2.2"><times id="algorithm1.25.25.m1.1.2.2.1.cmml" xref="algorithm1.25.25.m1.1.2.2.1"></times><ci id="algorithm1.25.25.m1.1.2.2.2.cmml" xref="algorithm1.25.25.m1.1.2.2.2">𝑝</ci><ci id="algorithm1.25.25.m1.1.2.2.3.cmml" xref="algorithm1.25.25.m1.1.2.2.3">𝑝</ci></apply><apply id="algorithm1.25.25.m1.1.2.3.cmml" xref="algorithm1.25.25.m1.1.2.3"><times id="algorithm1.25.25.m1.1.2.3.1.cmml" xref="algorithm1.25.25.m1.1.2.3.1"></times><ci id="algorithm1.25.25.m1.1.2.3.2.cmml" xref="algorithm1.25.25.m1.1.2.3.2">𝑃</ci><apply id="algorithm1.25.25.m1.1.2.3.3.1.cmml" xref="algorithm1.25.25.m1.1.2.3.3.2"><csymbol cd="latexml" id="algorithm1.25.25.m1.1.2.3.3.1.1.cmml" xref="algorithm1.25.25.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="algorithm1.25.25.m1.1.1.cmml" xref="algorithm1.25.25.m1.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m1.1c">pp\leftarrow P[i]</annotation><annotation encoding="application/x-llamapun" id="algorithm1.25.25.m1.1d">italic_p italic_p ← italic_P [ italic_i ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.38.49">
<span class="ltx_tag ltx_tag_listingline">33</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.38.50">
<span class="ltx_tag ltx_tag_listingline">34</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm1.26.26">
<span class="ltx_tag ltx_tag_listingline">35</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.26.26.2">return</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.26.26.1"><math alttext="T^{{}^{\prime}}" class="ltx_Math" display="inline" id="algorithm1.26.26.1.m1.1"><semantics id="algorithm1.26.26.1.m1.1a"><msup id="algorithm1.26.26.1.m1.1.1" xref="algorithm1.26.26.1.m1.1.1.cmml"><mi id="algorithm1.26.26.1.m1.1.1.2" xref="algorithm1.26.26.1.m1.1.1.2.cmml">T</mi><msup id="algorithm1.26.26.1.m1.1.1.3" xref="algorithm1.26.26.1.m1.1.1.3.cmml"><mi id="algorithm1.26.26.1.m1.1.1.3a" xref="algorithm1.26.26.1.m1.1.1.3.cmml"></mi><mo id="algorithm1.26.26.1.m1.1.1.3.1" xref="algorithm1.26.26.1.m1.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.1.m1.1b"><apply id="algorithm1.26.26.1.m1.1.1.cmml" xref="algorithm1.26.26.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.1.m1.1.1.1.cmml" xref="algorithm1.26.26.1.m1.1.1">superscript</csymbol><ci id="algorithm1.26.26.1.m1.1.1.2.cmml" xref="algorithm1.26.26.1.m1.1.1.2">𝑇</ci><apply id="algorithm1.26.26.1.m1.1.1.3.cmml" xref="algorithm1.26.26.1.m1.1.1.3"><ci id="algorithm1.26.26.1.m1.1.1.3.1.cmml" xref="algorithm1.26.26.1.m1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.1.m1.1c">T^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.26.26.1.m1.1d">italic_T start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.51">
<span class="ltx_tag ltx_tag_listingline">36</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.52">
<span class="ltx_tag ltx_tag_listingline">37</span>
</div>
<div class="ltx_listingline" id="algorithm1.27.27">
<span class="ltx_tag ltx_tag_listingline">38</span><span class="ltx_text ltx_font_bold" id="algorithm1.27.27.2">Subroutine:</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.27.27.1"><math alttext="\textnormal{{computeScore}}(T_{s},T_{p},T_{a},P_{s},P_{p},P_{a},\rho[.,.],\alpha)" class="ltx_math_unparsed" display="inline" id="algorithm1.27.27.1.m1.1"><semantics id="algorithm1.27.27.1.m1.1a"><mrow id="algorithm1.27.27.1.m1.1b"><mtext class="ltx_mathvariant_monospace" id="algorithm1.27.27.1.m1.1.2"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm1.27.27.1.m1.1.2.1nest">computeScore</em></mtext><mrow id="algorithm1.27.27.1.m1.1.3"><mo id="algorithm1.27.27.1.m1.1.3.1" stretchy="false">(</mo><msub id="algorithm1.27.27.1.m1.1.3.2"><mi id="algorithm1.27.27.1.m1.1.3.2.2">T</mi><mi id="algorithm1.27.27.1.m1.1.3.2.3">s</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.3">,</mo><msub id="algorithm1.27.27.1.m1.1.3.4"><mi id="algorithm1.27.27.1.m1.1.3.4.2">T</mi><mi id="algorithm1.27.27.1.m1.1.3.4.3">p</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.5">,</mo><msub id="algorithm1.27.27.1.m1.1.3.6"><mi id="algorithm1.27.27.1.m1.1.3.6.2">T</mi><mi id="algorithm1.27.27.1.m1.1.3.6.3">a</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.7">,</mo><msub id="algorithm1.27.27.1.m1.1.3.8"><mi id="algorithm1.27.27.1.m1.1.3.8.2">P</mi><mi id="algorithm1.27.27.1.m1.1.3.8.3">s</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.9">,</mo><msub id="algorithm1.27.27.1.m1.1.3.10"><mi id="algorithm1.27.27.1.m1.1.3.10.2">P</mi><mi id="algorithm1.27.27.1.m1.1.3.10.3">p</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.11">,</mo><msub id="algorithm1.27.27.1.m1.1.3.12"><mi id="algorithm1.27.27.1.m1.1.3.12.2">P</mi><mi id="algorithm1.27.27.1.m1.1.3.12.3">a</mi></msub><mo id="algorithm1.27.27.1.m1.1.3.13">,</mo><mi id="algorithm1.27.27.1.m1.1.1">ρ</mi><mrow id="algorithm1.27.27.1.m1.1.3.14"><mo id="algorithm1.27.27.1.m1.1.3.14.1" stretchy="false">[</mo><mo id="algorithm1.27.27.1.m1.1.3.14.2" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm1.27.27.1.m1.1.3.14.3">,</mo><mo id="algorithm1.27.27.1.m1.1.3.14.4" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm1.27.27.1.m1.1.3.14.5" stretchy="false">]</mo></mrow><mo id="algorithm1.27.27.1.m1.1.3.15">,</mo><mi id="algorithm1.27.27.1.m1.1.3.16">α</mi><mo id="algorithm1.27.27.1.m1.1.3.17" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm1.27.27.1.m1.1c">\textnormal{{computeScore}}(T_{s},T_{p},T_{a},P_{s},P_{p},P_{a},\rho[.,.],\alpha)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.27.27.1.m1.1d">computeScore ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_ρ [ . , . ] , italic_α )</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.53">
<span class="ltx_tag ltx_tag_listingline">39</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.28.28">
<span class="ltx_tag ltx_tag_listingline">40</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="C\leftarrow|T_{s}|\times|T_{p}|\times|T_{a}|" class="ltx_Math" display="inline" id="algorithm1.28.28.m1.3"><semantics id="algorithm1.28.28.m1.3a"><mrow id="algorithm1.28.28.m1.3.3" xref="algorithm1.28.28.m1.3.3.cmml"><mi id="algorithm1.28.28.m1.3.3.5" xref="algorithm1.28.28.m1.3.3.5.cmml">C</mi><mo id="algorithm1.28.28.m1.3.3.4" stretchy="false" xref="algorithm1.28.28.m1.3.3.4.cmml">←</mo><mrow id="algorithm1.28.28.m1.3.3.3" xref="algorithm1.28.28.m1.3.3.3.cmml"><mrow id="algorithm1.28.28.m1.1.1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.1.2.cmml"><mo id="algorithm1.28.28.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.28.28.m1.1.1.1.1.2.1.cmml">|</mo><msub id="algorithm1.28.28.m1.1.1.1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.28.28.m1.1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2.cmml">T</mi><mi id="algorithm1.28.28.m1.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="algorithm1.28.28.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm1.28.28.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="algorithm1.28.28.m1.3.3.3.4" rspace="0.222em" xref="algorithm1.28.28.m1.3.3.3.4.cmml">×</mo><mrow id="algorithm1.28.28.m1.2.2.2.2.1" xref="algorithm1.28.28.m1.2.2.2.2.2.cmml"><mo id="algorithm1.28.28.m1.2.2.2.2.1.2" stretchy="false" xref="algorithm1.28.28.m1.2.2.2.2.2.1.cmml">|</mo><msub id="algorithm1.28.28.m1.2.2.2.2.1.1" xref="algorithm1.28.28.m1.2.2.2.2.1.1.cmml"><mi id="algorithm1.28.28.m1.2.2.2.2.1.1.2" xref="algorithm1.28.28.m1.2.2.2.2.1.1.2.cmml">T</mi><mi id="algorithm1.28.28.m1.2.2.2.2.1.1.3" xref="algorithm1.28.28.m1.2.2.2.2.1.1.3.cmml">p</mi></msub><mo id="algorithm1.28.28.m1.2.2.2.2.1.3" rspace="0.055em" stretchy="false" xref="algorithm1.28.28.m1.2.2.2.2.2.1.cmml">|</mo></mrow><mo id="algorithm1.28.28.m1.3.3.3.4a" rspace="0.222em" xref="algorithm1.28.28.m1.3.3.3.4.cmml">×</mo><mrow id="algorithm1.28.28.m1.3.3.3.3.1" xref="algorithm1.28.28.m1.3.3.3.3.2.cmml"><mo id="algorithm1.28.28.m1.3.3.3.3.1.2" stretchy="false" xref="algorithm1.28.28.m1.3.3.3.3.2.1.cmml">|</mo><msub id="algorithm1.28.28.m1.3.3.3.3.1.1" xref="algorithm1.28.28.m1.3.3.3.3.1.1.cmml"><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.2" xref="algorithm1.28.28.m1.3.3.3.3.1.1.2.cmml">T</mi><mi id="algorithm1.28.28.m1.3.3.3.3.1.1.3" xref="algorithm1.28.28.m1.3.3.3.3.1.1.3.cmml">a</mi></msub><mo id="algorithm1.28.28.m1.3.3.3.3.1.3" stretchy="false" xref="algorithm1.28.28.m1.3.3.3.3.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m1.3b"><apply id="algorithm1.28.28.m1.3.3.cmml" xref="algorithm1.28.28.m1.3.3"><ci id="algorithm1.28.28.m1.3.3.4.cmml" xref="algorithm1.28.28.m1.3.3.4">←</ci><ci id="algorithm1.28.28.m1.3.3.5.cmml" xref="algorithm1.28.28.m1.3.3.5">𝐶</ci><apply id="algorithm1.28.28.m1.3.3.3.cmml" xref="algorithm1.28.28.m1.3.3.3"><times id="algorithm1.28.28.m1.3.3.3.4.cmml" xref="algorithm1.28.28.m1.3.3.3.4"></times><apply id="algorithm1.28.28.m1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1"><abs id="algorithm1.28.28.m1.1.1.1.1.2.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.2"></abs><apply id="algorithm1.28.28.m1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2">𝑇</ci><ci id="algorithm1.28.28.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="algorithm1.28.28.m1.2.2.2.2.2.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1"><abs id="algorithm1.28.28.m1.2.2.2.2.2.1.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1.2"></abs><apply id="algorithm1.28.28.m1.2.2.2.2.1.1.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.2.2.2.2.1.1.1.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.2.2.2.2.1.1.2.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1.1.2">𝑇</ci><ci id="algorithm1.28.28.m1.2.2.2.2.1.1.3.cmml" xref="algorithm1.28.28.m1.2.2.2.2.1.1.3">𝑝</ci></apply></apply><apply id="algorithm1.28.28.m1.3.3.3.3.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1"><abs id="algorithm1.28.28.m1.3.3.3.3.2.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.2"></abs><apply id="algorithm1.28.28.m1.3.3.3.3.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.3.3.3.3.1.1.1.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1">subscript</csymbol><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.2.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.2">𝑇</ci><ci id="algorithm1.28.28.m1.3.3.3.3.1.1.3.cmml" xref="algorithm1.28.28.m1.3.3.3.3.1.1.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.3c">C\leftarrow|T_{s}|\times|T_{p}|\times|T_{a}|</annotation><annotation encoding="application/x-llamapun" id="algorithm1.28.28.m1.3d">italic_C ← | italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | × | italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT | × | italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT |</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm1.28.28.1">array</span>
</div>
<div class="ltx_listingline" id="algorithm1.29.29">
<span class="ltx_tag ltx_tag_listingline">41</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="tot\leftarrow 0" class="ltx_Math" display="inline" id="algorithm1.29.29.m1.1"><semantics id="algorithm1.29.29.m1.1a"><mrow id="algorithm1.29.29.m1.1.1" xref="algorithm1.29.29.m1.1.1.cmml"><mrow id="algorithm1.29.29.m1.1.1.2" xref="algorithm1.29.29.m1.1.1.2.cmml"><mi id="algorithm1.29.29.m1.1.1.2.2" xref="algorithm1.29.29.m1.1.1.2.2.cmml">t</mi><mo id="algorithm1.29.29.m1.1.1.2.1" xref="algorithm1.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.29.29.m1.1.1.2.3" xref="algorithm1.29.29.m1.1.1.2.3.cmml">o</mi><mo id="algorithm1.29.29.m1.1.1.2.1a" xref="algorithm1.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.29.29.m1.1.1.2.4" xref="algorithm1.29.29.m1.1.1.2.4.cmml">t</mi></mrow><mo id="algorithm1.29.29.m1.1.1.1" stretchy="false" xref="algorithm1.29.29.m1.1.1.1.cmml">←</mo><mn id="algorithm1.29.29.m1.1.1.3" xref="algorithm1.29.29.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m1.1b"><apply id="algorithm1.29.29.m1.1.1.cmml" xref="algorithm1.29.29.m1.1.1"><ci id="algorithm1.29.29.m1.1.1.1.cmml" xref="algorithm1.29.29.m1.1.1.1">←</ci><apply id="algorithm1.29.29.m1.1.1.2.cmml" xref="algorithm1.29.29.m1.1.1.2"><times id="algorithm1.29.29.m1.1.1.2.1.cmml" xref="algorithm1.29.29.m1.1.1.2.1"></times><ci id="algorithm1.29.29.m1.1.1.2.2.cmml" xref="algorithm1.29.29.m1.1.1.2.2">𝑡</ci><ci id="algorithm1.29.29.m1.1.1.2.3.cmml" xref="algorithm1.29.29.m1.1.1.2.3">𝑜</ci><ci id="algorithm1.29.29.m1.1.1.2.4.cmml" xref="algorithm1.29.29.m1.1.1.2.4">𝑡</ci></apply><cn id="algorithm1.29.29.m1.1.1.3.cmml" type="integer" xref="algorithm1.29.29.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">tot\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="algorithm1.29.29.m1.1d">italic_t italic_o italic_t ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.30.30">
<span class="ltx_tag ltx_tag_listingline">42</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.30.30.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.30.30.1"><math alttext="s\in Ts" class="ltx_Math" display="inline" id="algorithm1.30.30.1.m1.1"><semantics id="algorithm1.30.30.1.m1.1a"><mrow id="algorithm1.30.30.1.m1.1.1" xref="algorithm1.30.30.1.m1.1.1.cmml"><mi id="algorithm1.30.30.1.m1.1.1.2" xref="algorithm1.30.30.1.m1.1.1.2.cmml">s</mi><mo id="algorithm1.30.30.1.m1.1.1.1" xref="algorithm1.30.30.1.m1.1.1.1.cmml">∈</mo><mrow id="algorithm1.30.30.1.m1.1.1.3" xref="algorithm1.30.30.1.m1.1.1.3.cmml"><mi id="algorithm1.30.30.1.m1.1.1.3.2" xref="algorithm1.30.30.1.m1.1.1.3.2.cmml">T</mi><mo id="algorithm1.30.30.1.m1.1.1.3.1" xref="algorithm1.30.30.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.30.30.1.m1.1.1.3.3" xref="algorithm1.30.30.1.m1.1.1.3.3.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.1.m1.1b"><apply id="algorithm1.30.30.1.m1.1.1.cmml" xref="algorithm1.30.30.1.m1.1.1"><in id="algorithm1.30.30.1.m1.1.1.1.cmml" xref="algorithm1.30.30.1.m1.1.1.1"></in><ci id="algorithm1.30.30.1.m1.1.1.2.cmml" xref="algorithm1.30.30.1.m1.1.1.2">𝑠</ci><apply id="algorithm1.30.30.1.m1.1.1.3.cmml" xref="algorithm1.30.30.1.m1.1.1.3"><times id="algorithm1.30.30.1.m1.1.1.3.1.cmml" xref="algorithm1.30.30.1.m1.1.1.3.1"></times><ci id="algorithm1.30.30.1.m1.1.1.3.2.cmml" xref="algorithm1.30.30.1.m1.1.1.3.2">𝑇</ci><ci id="algorithm1.30.30.1.m1.1.1.3.3.cmml" xref="algorithm1.30.30.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.1.m1.1c">s\in Ts</annotation><annotation encoding="application/x-llamapun" id="algorithm1.30.30.1.m1.1d">italic_s ∈ italic_T italic_s</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.30.30.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.31.31">
<span class="ltx_tag ltx_tag_listingline">43</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.31.31.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.31.31.1"><math alttext="p\in Tp" class="ltx_Math" display="inline" id="algorithm1.31.31.1.m1.1"><semantics id="algorithm1.31.31.1.m1.1a"><mrow id="algorithm1.31.31.1.m1.1.1" xref="algorithm1.31.31.1.m1.1.1.cmml"><mi id="algorithm1.31.31.1.m1.1.1.2" xref="algorithm1.31.31.1.m1.1.1.2.cmml">p</mi><mo id="algorithm1.31.31.1.m1.1.1.1" xref="algorithm1.31.31.1.m1.1.1.1.cmml">∈</mo><mrow id="algorithm1.31.31.1.m1.1.1.3" xref="algorithm1.31.31.1.m1.1.1.3.cmml"><mi id="algorithm1.31.31.1.m1.1.1.3.2" xref="algorithm1.31.31.1.m1.1.1.3.2.cmml">T</mi><mo id="algorithm1.31.31.1.m1.1.1.3.1" xref="algorithm1.31.31.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.31.31.1.m1.1.1.3.3" xref="algorithm1.31.31.1.m1.1.1.3.3.cmml">p</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.1.m1.1b"><apply id="algorithm1.31.31.1.m1.1.1.cmml" xref="algorithm1.31.31.1.m1.1.1"><in id="algorithm1.31.31.1.m1.1.1.1.cmml" xref="algorithm1.31.31.1.m1.1.1.1"></in><ci id="algorithm1.31.31.1.m1.1.1.2.cmml" xref="algorithm1.31.31.1.m1.1.1.2">𝑝</ci><apply id="algorithm1.31.31.1.m1.1.1.3.cmml" xref="algorithm1.31.31.1.m1.1.1.3"><times id="algorithm1.31.31.1.m1.1.1.3.1.cmml" xref="algorithm1.31.31.1.m1.1.1.3.1"></times><ci id="algorithm1.31.31.1.m1.1.1.3.2.cmml" xref="algorithm1.31.31.1.m1.1.1.3.2">𝑇</ci><ci id="algorithm1.31.31.1.m1.1.1.3.3.cmml" xref="algorithm1.31.31.1.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.1.m1.1c">p\in Tp</annotation><annotation encoding="application/x-llamapun" id="algorithm1.31.31.1.m1.1d">italic_p ∈ italic_T italic_p</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.31.31.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.32.32">
<span class="ltx_tag ltx_tag_listingline">44</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.32.32.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.32.32.1"><math alttext="a\in Ta" class="ltx_Math" display="inline" id="algorithm1.32.32.1.m1.1"><semantics id="algorithm1.32.32.1.m1.1a"><mrow id="algorithm1.32.32.1.m1.1.1" xref="algorithm1.32.32.1.m1.1.1.cmml"><mi id="algorithm1.32.32.1.m1.1.1.2" xref="algorithm1.32.32.1.m1.1.1.2.cmml">a</mi><mo id="algorithm1.32.32.1.m1.1.1.1" xref="algorithm1.32.32.1.m1.1.1.1.cmml">∈</mo><mrow id="algorithm1.32.32.1.m1.1.1.3" xref="algorithm1.32.32.1.m1.1.1.3.cmml"><mi id="algorithm1.32.32.1.m1.1.1.3.2" xref="algorithm1.32.32.1.m1.1.1.3.2.cmml">T</mi><mo id="algorithm1.32.32.1.m1.1.1.3.1" xref="algorithm1.32.32.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.32.32.1.m1.1.1.3.3" xref="algorithm1.32.32.1.m1.1.1.3.3.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.1.m1.1b"><apply id="algorithm1.32.32.1.m1.1.1.cmml" xref="algorithm1.32.32.1.m1.1.1"><in id="algorithm1.32.32.1.m1.1.1.1.cmml" xref="algorithm1.32.32.1.m1.1.1.1"></in><ci id="algorithm1.32.32.1.m1.1.1.2.cmml" xref="algorithm1.32.32.1.m1.1.1.2">𝑎</ci><apply id="algorithm1.32.32.1.m1.1.1.3.cmml" xref="algorithm1.32.32.1.m1.1.1.3"><times id="algorithm1.32.32.1.m1.1.1.3.1.cmml" xref="algorithm1.32.32.1.m1.1.1.3.1"></times><ci id="algorithm1.32.32.1.m1.1.1.3.2.cmml" xref="algorithm1.32.32.1.m1.1.1.3.2">𝑇</ci><ci id="algorithm1.32.32.1.m1.1.1.3.3.cmml" xref="algorithm1.32.32.1.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.1.m1.1c">a\in Ta</annotation><annotation encoding="application/x-llamapun" id="algorithm1.32.32.1.m1.1d">italic_a ∈ italic_T italic_a</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.32.32.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.33.33">
<span class="ltx_tag ltx_tag_listingline">45</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="c\leftarrow\exp(\alpha\textnormal{{log}}(\rho[s,a])+\textnormal{{log}}P_{s}[s]%
+\textnormal{{log}}P_{p}[p]+\textnormal{{log}}P_{a}[a])" class="ltx_Math" display="inline" id="algorithm1.33.33.m1.7"><semantics id="algorithm1.33.33.m1.7a"><mrow id="algorithm1.33.33.m1.7.7" xref="algorithm1.33.33.m1.7.7.cmml"><mi id="algorithm1.33.33.m1.7.7.3" xref="algorithm1.33.33.m1.7.7.3.cmml">c</mi><mo id="algorithm1.33.33.m1.7.7.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.2.cmml">←</mo><mrow id="algorithm1.33.33.m1.7.7.1.1" xref="algorithm1.33.33.m1.7.7.1.2.cmml"><mi id="algorithm1.33.33.m1.6.6" xref="algorithm1.33.33.m1.6.6.cmml">exp</mi><mo id="algorithm1.33.33.m1.7.7.1.1a" xref="algorithm1.33.33.m1.7.7.1.2.cmml">⁡</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1" xref="algorithm1.33.33.m1.7.7.1.2.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.2.cmml">(</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.cmml"><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.cmml"><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.1.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.3.cmml">α</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.1.4" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.4a.cmml">log</mtext><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.2a" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">ρ</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">[</mo><mi id="algorithm1.33.33.m1.1.1" xref="algorithm1.33.33.m1.1.1.cmml">s</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="algorithm1.33.33.m1.2.2" xref="algorithm1.33.33.m1.2.2.cmml">a</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.3.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.2a.cmml">log</mtext><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.3.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.1.cmml">⁢</mo><msub id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.cmml"><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.2.cmml">P</mi><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.3.cmml">s</mi></msub><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.3.1a" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.1.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.1.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.2.1" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.1.1.cmml">[</mo><mi id="algorithm1.33.33.m1.3.3" xref="algorithm1.33.33.m1.3.3.cmml">s</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.2.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.1.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.2a" xref="algorithm1.33.33.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.4" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.4.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.2a.cmml">log</mtext><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.4.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.1.cmml">⁢</mo><msub id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.cmml"><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.2.cmml">P</mi><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.3.cmml">p</mi></msub><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.4.1a" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.1.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.1.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.2.1" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.1.1.cmml">[</mo><mi id="algorithm1.33.33.m1.4.4" xref="algorithm1.33.33.m1.4.4.cmml">p</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.2.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.1.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.2b" xref="algorithm1.33.33.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.5" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.5.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.2a.cmml">log</mtext><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.5.1" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.1.cmml">⁢</mo><msub id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.cmml"><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.2.cmml">P</mi><mi id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.3" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.3.cmml">a</mi></msub><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.5.1a" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.1.cmml">⁢</mo><mrow id="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.2" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.1.cmml"><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.2.1" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.1.1.cmml">[</mo><mi id="algorithm1.33.33.m1.5.5" xref="algorithm1.33.33.m1.5.5.cmml">a</mi><mo id="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.2.2" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="algorithm1.33.33.m1.7.7.1.1.1.3" stretchy="false" xref="algorithm1.33.33.m1.7.7.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.7b"><apply id="algorithm1.33.33.m1.7.7.cmml" xref="algorithm1.33.33.m1.7.7"><ci id="algorithm1.33.33.m1.7.7.2.cmml" xref="algorithm1.33.33.m1.7.7.2">←</ci><ci id="algorithm1.33.33.m1.7.7.3.cmml" xref="algorithm1.33.33.m1.7.7.3">𝑐</ci><apply id="algorithm1.33.33.m1.7.7.1.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1"><exp id="algorithm1.33.33.m1.6.6.cmml" xref="algorithm1.33.33.m1.6.6"></exp><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1"><plus id="algorithm1.33.33.m1.7.7.1.1.1.1.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.2"></plus><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1"><times id="algorithm1.33.33.m1.7.7.1.1.1.1.1.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.2"></times><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.1.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.3">𝛼</ci><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.1.4a.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.4"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.1.4.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.4">log</mtext></ci><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1"><times id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.1"></times><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.2">𝜌</ci><interval closure="closed" id="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.1.1.1.1.3.2"><ci id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1">𝑠</ci><ci id="algorithm1.33.33.m1.2.2.cmml" xref="algorithm1.33.33.m1.2.2">𝑎</ci></interval></apply></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3"><times id="algorithm1.33.33.m1.7.7.1.1.1.1.3.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.1"></times><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.3.2a.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.3.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.2">log</mtext></ci><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.2">𝑃</ci><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.3.3">𝑠</ci></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.2"><csymbol cd="latexml" id="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.3.4.2.1">delimited-[]</csymbol><ci id="algorithm1.33.33.m1.3.3.cmml" xref="algorithm1.33.33.m1.3.3">𝑠</ci></apply></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.4.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4"><times id="algorithm1.33.33.m1.7.7.1.1.1.1.4.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.1"></times><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.4.2a.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.4.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.2">log</mtext></ci><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3">subscript</csymbol><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.2">𝑃</ci><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.3.3">𝑝</ci></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.2"><csymbol cd="latexml" id="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.4.4.2.1">delimited-[]</csymbol><ci id="algorithm1.33.33.m1.4.4.cmml" xref="algorithm1.33.33.m1.4.4">𝑝</ci></apply></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.5.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5"><times id="algorithm1.33.33.m1.7.7.1.1.1.1.5.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.1"></times><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.5.2a.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.2"><mtext class="ltx_mathvariant_monospace" id="algorithm1.33.33.m1.7.7.1.1.1.1.5.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.2">log</mtext></ci><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3">subscript</csymbol><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.2.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.2">𝑃</ci><ci id="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.3.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.3.3">𝑎</ci></apply><apply id="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.2"><csymbol cd="latexml" id="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.1.1.cmml" xref="algorithm1.33.33.m1.7.7.1.1.1.1.5.4.2.1">delimited-[]</csymbol><ci id="algorithm1.33.33.m1.5.5.cmml" xref="algorithm1.33.33.m1.5.5">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.7c">c\leftarrow\exp(\alpha\textnormal{{log}}(\rho[s,a])+\textnormal{{log}}P_{s}[s]%
+\textnormal{{log}}P_{p}[p]+\textnormal{{log}}P_{a}[a])</annotation><annotation encoding="application/x-llamapun" id="algorithm1.33.33.m1.7d">italic_c ← roman_exp ( italic_α log ( italic_ρ [ italic_s , italic_a ] ) + log italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_s ] + log italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT [ italic_p ] + log italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT [ italic_a ] )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.34.34">
<span class="ltx_tag ltx_tag_listingline">46</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="C[s,p,a]\leftarrow c" class="ltx_Math" display="inline" id="algorithm1.34.34.m1.3"><semantics id="algorithm1.34.34.m1.3a"><mrow id="algorithm1.34.34.m1.3.4" xref="algorithm1.34.34.m1.3.4.cmml"><mrow id="algorithm1.34.34.m1.3.4.2" xref="algorithm1.34.34.m1.3.4.2.cmml"><mi id="algorithm1.34.34.m1.3.4.2.2" xref="algorithm1.34.34.m1.3.4.2.2.cmml">C</mi><mo id="algorithm1.34.34.m1.3.4.2.1" xref="algorithm1.34.34.m1.3.4.2.1.cmml">⁢</mo><mrow id="algorithm1.34.34.m1.3.4.2.3.2" xref="algorithm1.34.34.m1.3.4.2.3.1.cmml"><mo id="algorithm1.34.34.m1.3.4.2.3.2.1" stretchy="false" xref="algorithm1.34.34.m1.3.4.2.3.1.cmml">[</mo><mi id="algorithm1.34.34.m1.1.1" xref="algorithm1.34.34.m1.1.1.cmml">s</mi><mo id="algorithm1.34.34.m1.3.4.2.3.2.2" xref="algorithm1.34.34.m1.3.4.2.3.1.cmml">,</mo><mi id="algorithm1.34.34.m1.2.2" xref="algorithm1.34.34.m1.2.2.cmml">p</mi><mo id="algorithm1.34.34.m1.3.4.2.3.2.3" xref="algorithm1.34.34.m1.3.4.2.3.1.cmml">,</mo><mi id="algorithm1.34.34.m1.3.3" xref="algorithm1.34.34.m1.3.3.cmml">a</mi><mo id="algorithm1.34.34.m1.3.4.2.3.2.4" stretchy="false" xref="algorithm1.34.34.m1.3.4.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.34.34.m1.3.4.1" stretchy="false" xref="algorithm1.34.34.m1.3.4.1.cmml">←</mo><mi id="algorithm1.34.34.m1.3.4.3" xref="algorithm1.34.34.m1.3.4.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.3b"><apply id="algorithm1.34.34.m1.3.4.cmml" xref="algorithm1.34.34.m1.3.4"><ci id="algorithm1.34.34.m1.3.4.1.cmml" xref="algorithm1.34.34.m1.3.4.1">←</ci><apply id="algorithm1.34.34.m1.3.4.2.cmml" xref="algorithm1.34.34.m1.3.4.2"><times id="algorithm1.34.34.m1.3.4.2.1.cmml" xref="algorithm1.34.34.m1.3.4.2.1"></times><ci id="algorithm1.34.34.m1.3.4.2.2.cmml" xref="algorithm1.34.34.m1.3.4.2.2">𝐶</ci><list id="algorithm1.34.34.m1.3.4.2.3.1.cmml" xref="algorithm1.34.34.m1.3.4.2.3.2"><ci id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1">𝑠</ci><ci id="algorithm1.34.34.m1.2.2.cmml" xref="algorithm1.34.34.m1.2.2">𝑝</ci><ci id="algorithm1.34.34.m1.3.3.cmml" xref="algorithm1.34.34.m1.3.3">𝑎</ci></list></apply><ci id="algorithm1.34.34.m1.3.4.3.cmml" xref="algorithm1.34.34.m1.3.4.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.3c">C[s,p,a]\leftarrow c</annotation><annotation encoding="application/x-llamapun" id="algorithm1.34.34.m1.3d">italic_C [ italic_s , italic_p , italic_a ] ← italic_c</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.35.35">
<span class="ltx_tag ltx_tag_listingline">47</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="tot\leftarrow tot+c" class="ltx_Math" display="inline" id="algorithm1.35.35.m1.1"><semantics id="algorithm1.35.35.m1.1a"><mrow id="algorithm1.35.35.m1.1.1" xref="algorithm1.35.35.m1.1.1.cmml"><mrow id="algorithm1.35.35.m1.1.1.2" xref="algorithm1.35.35.m1.1.1.2.cmml"><mi id="algorithm1.35.35.m1.1.1.2.2" xref="algorithm1.35.35.m1.1.1.2.2.cmml">t</mi><mo id="algorithm1.35.35.m1.1.1.2.1" xref="algorithm1.35.35.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.35.35.m1.1.1.2.3" xref="algorithm1.35.35.m1.1.1.2.3.cmml">o</mi><mo id="algorithm1.35.35.m1.1.1.2.1a" xref="algorithm1.35.35.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.35.35.m1.1.1.2.4" xref="algorithm1.35.35.m1.1.1.2.4.cmml">t</mi></mrow><mo id="algorithm1.35.35.m1.1.1.1" stretchy="false" xref="algorithm1.35.35.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.35.35.m1.1.1.3" xref="algorithm1.35.35.m1.1.1.3.cmml"><mrow id="algorithm1.35.35.m1.1.1.3.2" xref="algorithm1.35.35.m1.1.1.3.2.cmml"><mi id="algorithm1.35.35.m1.1.1.3.2.2" xref="algorithm1.35.35.m1.1.1.3.2.2.cmml">t</mi><mo id="algorithm1.35.35.m1.1.1.3.2.1" xref="algorithm1.35.35.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algorithm1.35.35.m1.1.1.3.2.3" xref="algorithm1.35.35.m1.1.1.3.2.3.cmml">o</mi><mo id="algorithm1.35.35.m1.1.1.3.2.1a" xref="algorithm1.35.35.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algorithm1.35.35.m1.1.1.3.2.4" xref="algorithm1.35.35.m1.1.1.3.2.4.cmml">t</mi></mrow><mo id="algorithm1.35.35.m1.1.1.3.1" xref="algorithm1.35.35.m1.1.1.3.1.cmml">+</mo><mi id="algorithm1.35.35.m1.1.1.3.3" xref="algorithm1.35.35.m1.1.1.3.3.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.35.35.m1.1b"><apply id="algorithm1.35.35.m1.1.1.cmml" xref="algorithm1.35.35.m1.1.1"><ci id="algorithm1.35.35.m1.1.1.1.cmml" xref="algorithm1.35.35.m1.1.1.1">←</ci><apply id="algorithm1.35.35.m1.1.1.2.cmml" xref="algorithm1.35.35.m1.1.1.2"><times id="algorithm1.35.35.m1.1.1.2.1.cmml" xref="algorithm1.35.35.m1.1.1.2.1"></times><ci id="algorithm1.35.35.m1.1.1.2.2.cmml" xref="algorithm1.35.35.m1.1.1.2.2">𝑡</ci><ci id="algorithm1.35.35.m1.1.1.2.3.cmml" xref="algorithm1.35.35.m1.1.1.2.3">𝑜</ci><ci id="algorithm1.35.35.m1.1.1.2.4.cmml" xref="algorithm1.35.35.m1.1.1.2.4">𝑡</ci></apply><apply id="algorithm1.35.35.m1.1.1.3.cmml" xref="algorithm1.35.35.m1.1.1.3"><plus id="algorithm1.35.35.m1.1.1.3.1.cmml" xref="algorithm1.35.35.m1.1.1.3.1"></plus><apply id="algorithm1.35.35.m1.1.1.3.2.cmml" xref="algorithm1.35.35.m1.1.1.3.2"><times id="algorithm1.35.35.m1.1.1.3.2.1.cmml" xref="algorithm1.35.35.m1.1.1.3.2.1"></times><ci id="algorithm1.35.35.m1.1.1.3.2.2.cmml" xref="algorithm1.35.35.m1.1.1.3.2.2">𝑡</ci><ci id="algorithm1.35.35.m1.1.1.3.2.3.cmml" xref="algorithm1.35.35.m1.1.1.3.2.3">𝑜</ci><ci id="algorithm1.35.35.m1.1.1.3.2.4.cmml" xref="algorithm1.35.35.m1.1.1.3.2.4">𝑡</ci></apply><ci id="algorithm1.35.35.m1.1.1.3.3.cmml" xref="algorithm1.35.35.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.35.35.m1.1c">tot\leftarrow tot+c</annotation><annotation encoding="application/x-llamapun" id="algorithm1.35.35.m1.1d">italic_t italic_o italic_t ← italic_t italic_o italic_t + italic_c</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.38.54">
<span class="ltx_tag ltx_tag_listingline">48</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm1.38.55">
<span class="ltx_tag ltx_tag_listingline">49</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm1.38.56">
<span class="ltx_tag ltx_tag_listingline">50</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm1.38.57">
<span class="ltx_tag ltx_tag_listingline">51</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm1.38.58">
<span class="ltx_tag ltx_tag_listingline">52</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm1.37.37">
<span class="ltx_tag ltx_tag_listingline">53</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="C[s,p,a]\leftarrow C[s,p,a]/tot" class="ltx_Math" display="inline" id="algorithm1.36.36.m1.6"><semantics id="algorithm1.36.36.m1.6a"><mrow id="algorithm1.36.36.m1.6.7" xref="algorithm1.36.36.m1.6.7.cmml"><mrow id="algorithm1.36.36.m1.6.7.2" xref="algorithm1.36.36.m1.6.7.2.cmml"><mi id="algorithm1.36.36.m1.6.7.2.2" xref="algorithm1.36.36.m1.6.7.2.2.cmml">C</mi><mo id="algorithm1.36.36.m1.6.7.2.1" xref="algorithm1.36.36.m1.6.7.2.1.cmml">⁢</mo><mrow id="algorithm1.36.36.m1.6.7.2.3.2" xref="algorithm1.36.36.m1.6.7.2.3.1.cmml"><mo id="algorithm1.36.36.m1.6.7.2.3.2.1" stretchy="false" xref="algorithm1.36.36.m1.6.7.2.3.1.cmml">[</mo><mi id="algorithm1.36.36.m1.1.1" xref="algorithm1.36.36.m1.1.1.cmml">s</mi><mo id="algorithm1.36.36.m1.6.7.2.3.2.2" xref="algorithm1.36.36.m1.6.7.2.3.1.cmml">,</mo><mi id="algorithm1.36.36.m1.2.2" xref="algorithm1.36.36.m1.2.2.cmml">p</mi><mo id="algorithm1.36.36.m1.6.7.2.3.2.3" xref="algorithm1.36.36.m1.6.7.2.3.1.cmml">,</mo><mi id="algorithm1.36.36.m1.3.3" xref="algorithm1.36.36.m1.3.3.cmml">a</mi><mo id="algorithm1.36.36.m1.6.7.2.3.2.4" stretchy="false" xref="algorithm1.36.36.m1.6.7.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.36.36.m1.6.7.1" stretchy="false" xref="algorithm1.36.36.m1.6.7.1.cmml">←</mo><mrow id="algorithm1.36.36.m1.6.7.3" xref="algorithm1.36.36.m1.6.7.3.cmml"><mrow id="algorithm1.36.36.m1.6.7.3.2" xref="algorithm1.36.36.m1.6.7.3.2.cmml"><mrow id="algorithm1.36.36.m1.6.7.3.2.2" xref="algorithm1.36.36.m1.6.7.3.2.2.cmml"><mi id="algorithm1.36.36.m1.6.7.3.2.2.2" xref="algorithm1.36.36.m1.6.7.3.2.2.2.cmml">C</mi><mo id="algorithm1.36.36.m1.6.7.3.2.2.1" xref="algorithm1.36.36.m1.6.7.3.2.2.1.cmml">⁢</mo><mrow id="algorithm1.36.36.m1.6.7.3.2.2.3.2" xref="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml"><mo id="algorithm1.36.36.m1.6.7.3.2.2.3.2.1" stretchy="false" xref="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml">[</mo><mi id="algorithm1.36.36.m1.4.4" xref="algorithm1.36.36.m1.4.4.cmml">s</mi><mo id="algorithm1.36.36.m1.6.7.3.2.2.3.2.2" xref="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml">,</mo><mi id="algorithm1.36.36.m1.5.5" xref="algorithm1.36.36.m1.5.5.cmml">p</mi><mo id="algorithm1.36.36.m1.6.7.3.2.2.3.2.3" xref="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml">,</mo><mi id="algorithm1.36.36.m1.6.6" xref="algorithm1.36.36.m1.6.6.cmml">a</mi><mo id="algorithm1.36.36.m1.6.7.3.2.2.3.2.4" stretchy="false" xref="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.36.36.m1.6.7.3.2.1" xref="algorithm1.36.36.m1.6.7.3.2.1.cmml">/</mo><mi id="algorithm1.36.36.m1.6.7.3.2.3" xref="algorithm1.36.36.m1.6.7.3.2.3.cmml">t</mi></mrow><mo id="algorithm1.36.36.m1.6.7.3.1" xref="algorithm1.36.36.m1.6.7.3.1.cmml">⁢</mo><mi id="algorithm1.36.36.m1.6.7.3.3" xref="algorithm1.36.36.m1.6.7.3.3.cmml">o</mi><mo id="algorithm1.36.36.m1.6.7.3.1a" xref="algorithm1.36.36.m1.6.7.3.1.cmml">⁢</mo><mi id="algorithm1.36.36.m1.6.7.3.4" xref="algorithm1.36.36.m1.6.7.3.4.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.36.36.m1.6b"><apply id="algorithm1.36.36.m1.6.7.cmml" xref="algorithm1.36.36.m1.6.7"><ci id="algorithm1.36.36.m1.6.7.1.cmml" xref="algorithm1.36.36.m1.6.7.1">←</ci><apply id="algorithm1.36.36.m1.6.7.2.cmml" xref="algorithm1.36.36.m1.6.7.2"><times id="algorithm1.36.36.m1.6.7.2.1.cmml" xref="algorithm1.36.36.m1.6.7.2.1"></times><ci id="algorithm1.36.36.m1.6.7.2.2.cmml" xref="algorithm1.36.36.m1.6.7.2.2">𝐶</ci><list id="algorithm1.36.36.m1.6.7.2.3.1.cmml" xref="algorithm1.36.36.m1.6.7.2.3.2"><ci id="algorithm1.36.36.m1.1.1.cmml" xref="algorithm1.36.36.m1.1.1">𝑠</ci><ci id="algorithm1.36.36.m1.2.2.cmml" xref="algorithm1.36.36.m1.2.2">𝑝</ci><ci id="algorithm1.36.36.m1.3.3.cmml" xref="algorithm1.36.36.m1.3.3">𝑎</ci></list></apply><apply id="algorithm1.36.36.m1.6.7.3.cmml" xref="algorithm1.36.36.m1.6.7.3"><times id="algorithm1.36.36.m1.6.7.3.1.cmml" xref="algorithm1.36.36.m1.6.7.3.1"></times><apply id="algorithm1.36.36.m1.6.7.3.2.cmml" xref="algorithm1.36.36.m1.6.7.3.2"><divide id="algorithm1.36.36.m1.6.7.3.2.1.cmml" xref="algorithm1.36.36.m1.6.7.3.2.1"></divide><apply id="algorithm1.36.36.m1.6.7.3.2.2.cmml" xref="algorithm1.36.36.m1.6.7.3.2.2"><times id="algorithm1.36.36.m1.6.7.3.2.2.1.cmml" xref="algorithm1.36.36.m1.6.7.3.2.2.1"></times><ci id="algorithm1.36.36.m1.6.7.3.2.2.2.cmml" xref="algorithm1.36.36.m1.6.7.3.2.2.2">𝐶</ci><list id="algorithm1.36.36.m1.6.7.3.2.2.3.1.cmml" xref="algorithm1.36.36.m1.6.7.3.2.2.3.2"><ci id="algorithm1.36.36.m1.4.4.cmml" xref="algorithm1.36.36.m1.4.4">𝑠</ci><ci id="algorithm1.36.36.m1.5.5.cmml" xref="algorithm1.36.36.m1.5.5">𝑝</ci><ci id="algorithm1.36.36.m1.6.6.cmml" xref="algorithm1.36.36.m1.6.6">𝑎</ci></list></apply><ci id="algorithm1.36.36.m1.6.7.3.2.3.cmml" xref="algorithm1.36.36.m1.6.7.3.2.3">𝑡</ci></apply><ci id="algorithm1.36.36.m1.6.7.3.3.cmml" xref="algorithm1.36.36.m1.6.7.3.3">𝑜</ci><ci id="algorithm1.36.36.m1.6.7.3.4.cmml" xref="algorithm1.36.36.m1.6.7.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.36.36.m1.6c">C[s,p,a]\leftarrow C[s,p,a]/tot</annotation><annotation encoding="application/x-llamapun" id="algorithm1.36.36.m1.6d">italic_C [ italic_s , italic_p , italic_a ] ← italic_C [ italic_s , italic_p , italic_a ] / italic_t italic_o italic_t</annotation></semantics></math>; <math alttext="\forall s\in T_{s},\forall p\in T_{p},\forall a\in T_{a}" class="ltx_Math" display="inline" id="algorithm1.37.37.m2.2"><semantics id="algorithm1.37.37.m2.2a"><mrow id="algorithm1.37.37.m2.2.2.2" xref="algorithm1.37.37.m2.2.2.3.cmml"><mrow id="algorithm1.37.37.m2.1.1.1.1" xref="algorithm1.37.37.m2.1.1.1.1.cmml"><mrow id="algorithm1.37.37.m2.1.1.1.1.2" xref="algorithm1.37.37.m2.1.1.1.1.2.cmml"><mo id="algorithm1.37.37.m2.1.1.1.1.2.1" rspace="0.167em" xref="algorithm1.37.37.m2.1.1.1.1.2.1.cmml">∀</mo><mi id="algorithm1.37.37.m2.1.1.1.1.2.2" xref="algorithm1.37.37.m2.1.1.1.1.2.2.cmml">s</mi></mrow><mo id="algorithm1.37.37.m2.1.1.1.1.1" xref="algorithm1.37.37.m2.1.1.1.1.1.cmml">∈</mo><msub id="algorithm1.37.37.m2.1.1.1.1.3" xref="algorithm1.37.37.m2.1.1.1.1.3.cmml"><mi id="algorithm1.37.37.m2.1.1.1.1.3.2" xref="algorithm1.37.37.m2.1.1.1.1.3.2.cmml">T</mi><mi id="algorithm1.37.37.m2.1.1.1.1.3.3" xref="algorithm1.37.37.m2.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="algorithm1.37.37.m2.2.2.2.3" xref="algorithm1.37.37.m2.2.2.3a.cmml">,</mo><mrow id="algorithm1.37.37.m2.2.2.2.2.2" xref="algorithm1.37.37.m2.2.2.2.2.3.cmml"><mrow id="algorithm1.37.37.m2.2.2.2.2.1.1" xref="algorithm1.37.37.m2.2.2.2.2.1.1.cmml"><mrow id="algorithm1.37.37.m2.2.2.2.2.1.1.2" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2.cmml"><mo id="algorithm1.37.37.m2.2.2.2.2.1.1.2.1" rspace="0.167em" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2.1.cmml">∀</mo><mi id="algorithm1.37.37.m2.2.2.2.2.1.1.2.2" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2.2.cmml">p</mi></mrow><mo id="algorithm1.37.37.m2.2.2.2.2.1.1.1" xref="algorithm1.37.37.m2.2.2.2.2.1.1.1.cmml">∈</mo><msub id="algorithm1.37.37.m2.2.2.2.2.1.1.3" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3.cmml"><mi id="algorithm1.37.37.m2.2.2.2.2.1.1.3.2" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3.2.cmml">T</mi><mi id="algorithm1.37.37.m2.2.2.2.2.1.1.3.3" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3.3.cmml">p</mi></msub></mrow><mo id="algorithm1.37.37.m2.2.2.2.2.2.3" xref="algorithm1.37.37.m2.2.2.2.2.3a.cmml">,</mo><mrow id="algorithm1.37.37.m2.2.2.2.2.2.2" xref="algorithm1.37.37.m2.2.2.2.2.2.2.cmml"><mrow id="algorithm1.37.37.m2.2.2.2.2.2.2.2" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2.cmml"><mo id="algorithm1.37.37.m2.2.2.2.2.2.2.2.1" rspace="0.167em" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2.1.cmml">∀</mo><mi id="algorithm1.37.37.m2.2.2.2.2.2.2.2.2" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2.2.cmml">a</mi></mrow><mo id="algorithm1.37.37.m2.2.2.2.2.2.2.1" xref="algorithm1.37.37.m2.2.2.2.2.2.2.1.cmml">∈</mo><msub id="algorithm1.37.37.m2.2.2.2.2.2.2.3" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3.cmml"><mi id="algorithm1.37.37.m2.2.2.2.2.2.2.3.2" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3.2.cmml">T</mi><mi id="algorithm1.37.37.m2.2.2.2.2.2.2.3.3" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3.3.cmml">a</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.37.37.m2.2b"><apply id="algorithm1.37.37.m2.2.2.3.cmml" xref="algorithm1.37.37.m2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.37.37.m2.2.2.3a.cmml" xref="algorithm1.37.37.m2.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.37.37.m2.1.1.1.1.cmml" xref="algorithm1.37.37.m2.1.1.1.1"><in id="algorithm1.37.37.m2.1.1.1.1.1.cmml" xref="algorithm1.37.37.m2.1.1.1.1.1"></in><apply id="algorithm1.37.37.m2.1.1.1.1.2.cmml" xref="algorithm1.37.37.m2.1.1.1.1.2"><csymbol cd="latexml" id="algorithm1.37.37.m2.1.1.1.1.2.1.cmml" xref="algorithm1.37.37.m2.1.1.1.1.2.1">for-all</csymbol><ci id="algorithm1.37.37.m2.1.1.1.1.2.2.cmml" xref="algorithm1.37.37.m2.1.1.1.1.2.2">𝑠</ci></apply><apply id="algorithm1.37.37.m2.1.1.1.1.3.cmml" xref="algorithm1.37.37.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.37.37.m2.1.1.1.1.3.1.cmml" xref="algorithm1.37.37.m2.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.37.37.m2.1.1.1.1.3.2.cmml" xref="algorithm1.37.37.m2.1.1.1.1.3.2">𝑇</ci><ci id="algorithm1.37.37.m2.1.1.1.1.3.3.cmml" xref="algorithm1.37.37.m2.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="algorithm1.37.37.m2.2.2.2.2.3.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.37.37.m2.2.2.2.2.3a.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.37.37.m2.2.2.2.2.1.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1"><in id="algorithm1.37.37.m2.2.2.2.2.1.1.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.1"></in><apply id="algorithm1.37.37.m2.2.2.2.2.1.1.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2"><csymbol cd="latexml" id="algorithm1.37.37.m2.2.2.2.2.1.1.2.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2.1">for-all</csymbol><ci id="algorithm1.37.37.m2.2.2.2.2.1.1.2.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.2.2">𝑝</ci></apply><apply id="algorithm1.37.37.m2.2.2.2.2.1.1.3.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.37.37.m2.2.2.2.2.1.1.3.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3">subscript</csymbol><ci id="algorithm1.37.37.m2.2.2.2.2.1.1.3.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3.2">𝑇</ci><ci id="algorithm1.37.37.m2.2.2.2.2.1.1.3.3.cmml" xref="algorithm1.37.37.m2.2.2.2.2.1.1.3.3">𝑝</ci></apply></apply><apply id="algorithm1.37.37.m2.2.2.2.2.2.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2"><in id="algorithm1.37.37.m2.2.2.2.2.2.2.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.1"></in><apply id="algorithm1.37.37.m2.2.2.2.2.2.2.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2"><csymbol cd="latexml" id="algorithm1.37.37.m2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2.1">for-all</csymbol><ci id="algorithm1.37.37.m2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.2.2">𝑎</ci></apply><apply id="algorithm1.37.37.m2.2.2.2.2.2.2.3.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.37.37.m2.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3">subscript</csymbol><ci id="algorithm1.37.37.m2.2.2.2.2.2.2.3.2.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3.2">𝑇</ci><ci id="algorithm1.37.37.m2.2.2.2.2.2.2.3.3.cmml" xref="algorithm1.37.37.m2.2.2.2.2.2.2.3.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.37.37.m2.2c">\forall s\in T_{s},\forall p\in T_{p},\forall a\in T_{a}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.37.37.m2.2d">∀ italic_s ∈ italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , ∀ italic_p ∈ italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , ∀ italic_a ∈ italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm1.37.37.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.37.37.2" style="color:#0000FF;">Normalize </span>
</div>
<div class="ltx_listingline" id="algorithm1.38.59">
<span class="ltx_tag ltx_tag_listingline">54</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.38.38">
<span class="ltx_tag ltx_tag_listingline">55</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.38.38.2">return</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.38.38.1"><math alttext="C" class="ltx_Math" display="inline" id="algorithm1.38.38.1.m1.1"><semantics id="algorithm1.38.38.1.m1.1a"><mi id="algorithm1.38.38.1.m1.1.1" xref="algorithm1.38.38.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.38.38.1.m1.1b"><ci id="algorithm1.38.38.1.m1.1.1.cmml" xref="algorithm1.38.38.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.38.38.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="algorithm1.38.38.1.m1.1d">italic_C</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm1.38.60">
<span class="ltx_tag ltx_tag_listingline">56</span>
</div>
<div class="ltx_listingline" id="algorithm1.38.61">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.40.1.1">Algorithm 1</span> </span>Inflection generation helper subroutines</figcaption>
</figure>
<figure class="ltx_float ltx_algorithm" id="algorithm2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm2.36">
<div class="ltx_listingline" id="algorithm2.36.37">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="algorithm2.36.38">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="algorithm2.10.10">
<span class="ltx_text ltx_font_bold" id="algorithm2.10.10.1">Input :</span> Probability distributions returned by the neural network (softmax heads) for stems, POS tags, affix sets (<math alttext="P_{s},P_{p},P_{a}" class="ltx_Math" display="inline" id="algorithm2.1.1.m1.3"><semantics id="algorithm2.1.1.m1.3a"><mrow id="algorithm2.1.1.m1.3.3.3" xref="algorithm2.1.1.m1.3.3.4.cmml"><msub id="algorithm2.1.1.m1.1.1.1.1" xref="algorithm2.1.1.m1.1.1.1.1.cmml"><mi id="algorithm2.1.1.m1.1.1.1.1.2" xref="algorithm2.1.1.m1.1.1.1.1.2.cmml">P</mi><mi id="algorithm2.1.1.m1.1.1.1.1.3" xref="algorithm2.1.1.m1.1.1.1.1.3.cmml">s</mi></msub><mo id="algorithm2.1.1.m1.3.3.3.4" xref="algorithm2.1.1.m1.3.3.4.cmml">,</mo><msub id="algorithm2.1.1.m1.2.2.2.2" xref="algorithm2.1.1.m1.2.2.2.2.cmml"><mi id="algorithm2.1.1.m1.2.2.2.2.2" xref="algorithm2.1.1.m1.2.2.2.2.2.cmml">P</mi><mi id="algorithm2.1.1.m1.2.2.2.2.3" xref="algorithm2.1.1.m1.2.2.2.2.3.cmml">p</mi></msub><mo id="algorithm2.1.1.m1.3.3.3.5" xref="algorithm2.1.1.m1.3.3.4.cmml">,</mo><msub id="algorithm2.1.1.m1.3.3.3.3" xref="algorithm2.1.1.m1.3.3.3.3.cmml"><mi id="algorithm2.1.1.m1.3.3.3.3.2" xref="algorithm2.1.1.m1.3.3.3.3.2.cmml">P</mi><mi id="algorithm2.1.1.m1.3.3.3.3.3" xref="algorithm2.1.1.m1.3.3.3.3.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.3b"><list id="algorithm2.1.1.m1.3.3.4.cmml" xref="algorithm2.1.1.m1.3.3.3"><apply id="algorithm2.1.1.m1.1.1.1.1.cmml" xref="algorithm2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.1.1.1.1.1.cmml" xref="algorithm2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="algorithm2.1.1.m1.1.1.1.1.2.cmml" xref="algorithm2.1.1.m1.1.1.1.1.2">𝑃</ci><ci id="algorithm2.1.1.m1.1.1.1.1.3.cmml" xref="algorithm2.1.1.m1.1.1.1.1.3">𝑠</ci></apply><apply id="algorithm2.1.1.m1.2.2.2.2.cmml" xref="algorithm2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.2.2.2.2.1.cmml" xref="algorithm2.1.1.m1.2.2.2.2">subscript</csymbol><ci id="algorithm2.1.1.m1.2.2.2.2.2.cmml" xref="algorithm2.1.1.m1.2.2.2.2.2">𝑃</ci><ci id="algorithm2.1.1.m1.2.2.2.2.3.cmml" xref="algorithm2.1.1.m1.2.2.2.2.3">𝑝</ci></apply><apply id="algorithm2.1.1.m1.3.3.3.3.cmml" xref="algorithm2.1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.3.3.3.3.1.cmml" xref="algorithm2.1.1.m1.3.3.3.3">subscript</csymbol><ci id="algorithm2.1.1.m1.3.3.3.3.2.cmml" xref="algorithm2.1.1.m1.3.3.3.3.2">𝑃</ci><ci id="algorithm2.1.1.m1.3.3.3.3.3.cmml" xref="algorithm2.1.1.m1.3.3.3.3.3">𝑎</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.3c">P_{s},P_{p},P_{a}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.1.1.m1.3d">italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>); probability values returned for each affix (multi-label heads) <math alttext="P_{f}" class="ltx_Math" display="inline" id="algorithm2.2.2.m2.1"><semantics id="algorithm2.2.2.m2.1a"><msub id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><mi id="algorithm2.2.2.m2.1.1.2" xref="algorithm2.2.2.m2.1.1.2.cmml">P</mi><mi id="algorithm2.2.2.m2.1.1.3" xref="algorithm2.2.2.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2">𝑃</ci><ci id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">P_{f}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.2.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="M" class="ltx_Math" display="inline" id="algorithm2.3.3.m3.1"><semantics id="algorithm2.3.3.m3.1a"><mi id="algorithm2.3.3.m3.1.1" xref="algorithm2.3.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.1b"><ci id="algorithm2.3.3.m3.1.1.cmml" xref="algorithm2.3.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm2.3.3.m3.1d">italic_M</annotation></semantics></math>: number of top items (stems, POS tags, affix sets) to consider; <math alttext="N" class="ltx_Math" display="inline" id="algorithm2.4.4.m4.1"><semantics id="algorithm2.4.4.m4.1a"><mi id="algorithm2.4.4.m4.1.1" xref="algorithm2.4.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m4.1b"><ci id="algorithm2.4.4.m4.1.1.cmml" xref="algorithm2.4.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="algorithm2.4.4.m4.1d">italic_N</annotation></semantics></math>: number of top affixes to consider; number of inflection groups <math alttext="G" class="ltx_Math" display="inline" id="algorithm2.5.5.m5.1"><semantics id="algorithm2.5.5.m5.1a"><mi id="algorithm2.5.5.m5.1.1" xref="algorithm2.5.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m5.1b"><ci id="algorithm2.5.5.m5.1.1.cmml" xref="algorithm2.5.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="algorithm2.5.5.m5.1d">italic_G</annotation></semantics></math>; <math alttext="\rho[.,.]" class="ltx_math_unparsed" display="inline" id="algorithm2.6.6.m6.1"><semantics id="algorithm2.6.6.m6.1a"><mrow id="algorithm2.6.6.m6.1b"><mi id="algorithm2.6.6.m6.1.1">ρ</mi><mrow id="algorithm2.6.6.m6.1.2"><mo id="algorithm2.6.6.m6.1.2.1" stretchy="false">[</mo><mo id="algorithm2.6.6.m6.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.6.6.m6.1.2.3">,</mo><mo id="algorithm2.6.6.m6.1.2.4" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.6.6.m6.1.2.5" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.6.6.m6.1c">\rho[.,.]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.6.6.m6.1d">italic_ρ [ . , . ]</annotation></semantics></math>: corpus-computed correlation of stems and affix sets; <math alttext="\alpha" class="ltx_Math" display="inline" id="algorithm2.7.7.m7.1"><semantics id="algorithm2.7.7.m7.1a"><mi id="algorithm2.7.7.m7.1.1" xref="algorithm2.7.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m7.1b"><ci id="algorithm2.7.7.m7.1.1.cmml" xref="algorithm2.7.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m7.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="algorithm2.7.7.m7.1d">italic_α</annotation></semantics></math>: stem-affix set correlation weight; <math alttext="\beta" class="ltx_Math" display="inline" id="algorithm2.8.8.m8.1"><semantics id="algorithm2.8.8.m8.1a"><mi id="algorithm2.8.8.m8.1.1" xref="algorithm2.8.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m8.1b"><ci id="algorithm2.8.8.m8.1.1.cmml" xref="algorithm2.8.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m8.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="algorithm2.8.8.m8.1d">italic_β</annotation></semantics></math>: maximum probability gap for inflection groups; <math alttext="\gamma" class="ltx_Math" display="inline" id="algorithm2.9.9.m9.1"><semantics id="algorithm2.9.9.m9.1a"><mi id="algorithm2.9.9.m9.1.1" xref="algorithm2.9.9.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m9.1b"><ci id="algorithm2.9.9.m9.1.1.cmml" xref="algorithm2.9.9.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m9.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="algorithm2.9.9.m9.1d">italic_γ</annotation></semantics></math>: minimum affix probability; <math alttext="\delta" class="ltx_Math" display="inline" id="algorithm2.10.10.m10.1"><semantics id="algorithm2.10.10.m10.1a"><mi id="algorithm2.10.10.m10.1.1" xref="algorithm2.10.10.m10.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m10.1b"><ci id="algorithm2.10.10.m10.1.1.cmml" xref="algorithm2.10.10.m10.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m10.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="algorithm2.10.10.m10.1d">italic_δ</annotation></semantics></math>: maximum probability gap for stems, POS tags and affix sets.
</div>
<div class="ltx_listingline" id="algorithm2.36.39">
<span class="ltx_text ltx_font_bold" id="algorithm2.36.39.1">Output :</span> Candidate inflected forms and their scores.
</div>
<div class="ltx_listingline" id="algorithm2.36.40">
<span class="ltx_tag ltx_tag_listingline">3</span>
</div>
<div class="ltx_listingline" id="algorithm2.36.41">
<span class="ltx_tag ltx_tag_listingline">4</span>
</div>
<div class="ltx_listingline" id="algorithm2.11.11">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_font_bold" id="algorithm2.11.11.2">Subroutine</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.11.11.1"><math alttext="\textnormal{{generateInflections}}(P_{s},P_{p},P_{a},P_{f},\rho[.,.],\alpha,%
\beta,\gamma,\delta)" class="ltx_math_unparsed" display="inline" id="algorithm2.11.11.1.m1.1"><semantics id="algorithm2.11.11.1.m1.1a"><mrow id="algorithm2.11.11.1.m1.1b"><mtext class="ltx_mathvariant_monospace" id="algorithm2.11.11.1.m1.1.2"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm2.11.11.1.m1.1.2.1nest">generateInflections</em></mtext><mrow id="algorithm2.11.11.1.m1.1.3"><mo id="algorithm2.11.11.1.m1.1.3.1" stretchy="false">(</mo><msub id="algorithm2.11.11.1.m1.1.3.2"><mi id="algorithm2.11.11.1.m1.1.3.2.2">P</mi><mi id="algorithm2.11.11.1.m1.1.3.2.3">s</mi></msub><mo id="algorithm2.11.11.1.m1.1.3.3">,</mo><msub id="algorithm2.11.11.1.m1.1.3.4"><mi id="algorithm2.11.11.1.m1.1.3.4.2">P</mi><mi id="algorithm2.11.11.1.m1.1.3.4.3">p</mi></msub><mo id="algorithm2.11.11.1.m1.1.3.5">,</mo><msub id="algorithm2.11.11.1.m1.1.3.6"><mi id="algorithm2.11.11.1.m1.1.3.6.2">P</mi><mi id="algorithm2.11.11.1.m1.1.3.6.3">a</mi></msub><mo id="algorithm2.11.11.1.m1.1.3.7">,</mo><msub id="algorithm2.11.11.1.m1.1.3.8"><mi id="algorithm2.11.11.1.m1.1.3.8.2">P</mi><mi id="algorithm2.11.11.1.m1.1.3.8.3">f</mi></msub><mo id="algorithm2.11.11.1.m1.1.3.9">,</mo><mi id="algorithm2.11.11.1.m1.1.1">ρ</mi><mrow id="algorithm2.11.11.1.m1.1.3.10"><mo id="algorithm2.11.11.1.m1.1.3.10.1" stretchy="false">[</mo><mo id="algorithm2.11.11.1.m1.1.3.10.2" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.11.11.1.m1.1.3.10.3">,</mo><mo id="algorithm2.11.11.1.m1.1.3.10.4" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.11.11.1.m1.1.3.10.5" stretchy="false">]</mo></mrow><mo id="algorithm2.11.11.1.m1.1.3.11">,</mo><mi id="algorithm2.11.11.1.m1.1.3.12">α</mi><mo id="algorithm2.11.11.1.m1.1.3.13">,</mo><mi id="algorithm2.11.11.1.m1.1.3.14">β</mi><mo id="algorithm2.11.11.1.m1.1.3.15">,</mo><mi id="algorithm2.11.11.1.m1.1.3.16">γ</mi><mo id="algorithm2.11.11.1.m1.1.3.17">,</mo><mi id="algorithm2.11.11.1.m1.1.3.18">δ</mi><mo id="algorithm2.11.11.1.m1.1.3.19" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.11.11.1.m1.1c">\textnormal{{generateInflections}}(P_{s},P_{p},P_{a},P_{f},\rho[.,.],\alpha,%
\beta,\gamma,\delta)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.11.11.1.m1.1d">generateInflections ( italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT , italic_ρ [ . , . ] , italic_α , italic_β , italic_γ , italic_δ )</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm2.36.42">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.12.12">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_typewriter" id="algorithm2.12.12.2" style="color:#0000FF;">/* </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.12.12.1" style="color:#0000FF;">All <math alttext="\textnormal{{argSort}}(.)" class="ltx_math_unparsed" display="inline" id="algorithm2.12.12.1.m1.1"><semantics id="algorithm2.12.12.1.m1.1a"><mrow id="algorithm2.12.12.1.m1.1b"><mtext class="ltx_mathvariant_monospace" id="algorithm2.12.12.1.m1.1.1" mathcolor="#0000FF">argSort</mtext><mrow id="algorithm2.12.12.1.m1.1.2"><mo id="algorithm2.12.12.1.m1.1.2.1" mathcolor="#0000FF" stretchy="false">(</mo><mo id="algorithm2.12.12.1.m1.1.2.2" lspace="0em" mathcolor="#0000FF" rspace="0.167em">.</mo><mo id="algorithm2.12.12.1.m1.1.2.3" mathcolor="#0000FF" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.12.12.1.m1.1c">\textnormal{{argSort}}(.)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.12.12.1.m1.1d">argSort ( . )</annotation></semantics></math> calls are in decreasing order  */</span>
</div>
<div class="ltx_listingline" id="algorithm2.14.14">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="T_{s}\leftarrow\textnormal{{argSort}}(P_{s})[:M]" class="ltx_math_unparsed" display="inline" id="algorithm2.13.13.m1.1"><semantics id="algorithm2.13.13.m1.1a"><mrow id="algorithm2.13.13.m1.1b"><msub id="algorithm2.13.13.m1.1.1"><mi id="algorithm2.13.13.m1.1.1.2">T</mi><mi id="algorithm2.13.13.m1.1.1.3">s</mi></msub><mo id="algorithm2.13.13.m1.1.2" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.13.13.m1.1.3">argSort</mtext><mrow id="algorithm2.13.13.m1.1.4"><mo id="algorithm2.13.13.m1.1.4.1" stretchy="false">(</mo><msub id="algorithm2.13.13.m1.1.4.2"><mi id="algorithm2.13.13.m1.1.4.2.2">P</mi><mi id="algorithm2.13.13.m1.1.4.2.3">s</mi></msub><mo id="algorithm2.13.13.m1.1.4.3" stretchy="false">)</mo></mrow><mrow id="algorithm2.13.13.m1.1.5"><mo id="algorithm2.13.13.m1.1.5.1" stretchy="false">[</mo><mo id="algorithm2.13.13.m1.1.5.2" rspace="0.278em">:</mo><mi id="algorithm2.13.13.m1.1.5.3">M</mi><mo id="algorithm2.13.13.m1.1.5.4" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.13.13.m1.1c">T_{s}\leftarrow\textnormal{{argSort}}(P_{s})[:M]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.13.13.m1.1d">italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← argSort ( italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) [ : italic_M ]</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm2.14.14.2" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.14.14.1" style="color:#0000FF;">Up to <math alttext="M" class="ltx_Math" display="inline" id="algorithm2.14.14.1.m1.1"><semantics id="algorithm2.14.14.1.m1.1a"><mi id="algorithm2.14.14.1.m1.1.1" mathcolor="#0000FF" xref="algorithm2.14.14.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.1.m1.1b"><ci id="algorithm2.14.14.1.m1.1.1.cmml" xref="algorithm2.14.14.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="algorithm2.14.14.1.m1.1d">italic_M</annotation></semantics></math> items </span>
</div>
<div class="ltx_listingline" id="algorithm2.36.43">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.15.15">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{p}\leftarrow\textnormal{{argSort}}(P_{p})[:M]" class="ltx_math_unparsed" display="inline" id="algorithm2.15.15.m1.1"><semantics id="algorithm2.15.15.m1.1a"><mrow id="algorithm2.15.15.m1.1b"><msub id="algorithm2.15.15.m1.1.1"><mi id="algorithm2.15.15.m1.1.1.2">T</mi><mi id="algorithm2.15.15.m1.1.1.3">p</mi></msub><mo id="algorithm2.15.15.m1.1.2" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.15.15.m1.1.3">argSort</mtext><mrow id="algorithm2.15.15.m1.1.4"><mo id="algorithm2.15.15.m1.1.4.1" stretchy="false">(</mo><msub id="algorithm2.15.15.m1.1.4.2"><mi id="algorithm2.15.15.m1.1.4.2.2">P</mi><mi id="algorithm2.15.15.m1.1.4.2.3">p</mi></msub><mo id="algorithm2.15.15.m1.1.4.3" stretchy="false">)</mo></mrow><mrow id="algorithm2.15.15.m1.1.5"><mo id="algorithm2.15.15.m1.1.5.1" stretchy="false">[</mo><mo id="algorithm2.15.15.m1.1.5.2" rspace="0.278em">:</mo><mi id="algorithm2.15.15.m1.1.5.3">M</mi><mo id="algorithm2.15.15.m1.1.5.4" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.15.15.m1.1c">T_{p}\leftarrow\textnormal{{argSort}}(P_{p})[:M]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.15.15.m1.1d">italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ← argSort ( italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) [ : italic_M ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.16.16">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{a}\leftarrow\textnormal{{argSort}}(P_{a})[:M]" class="ltx_math_unparsed" display="inline" id="algorithm2.16.16.m1.1"><semantics id="algorithm2.16.16.m1.1a"><mrow id="algorithm2.16.16.m1.1b"><msub id="algorithm2.16.16.m1.1.1"><mi id="algorithm2.16.16.m1.1.1.2">T</mi><mi id="algorithm2.16.16.m1.1.1.3">a</mi></msub><mo id="algorithm2.16.16.m1.1.2" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.16.16.m1.1.3">argSort</mtext><mrow id="algorithm2.16.16.m1.1.4"><mo id="algorithm2.16.16.m1.1.4.1" stretchy="false">(</mo><msub id="algorithm2.16.16.m1.1.4.2"><mi id="algorithm2.16.16.m1.1.4.2.2">P</mi><mi id="algorithm2.16.16.m1.1.4.2.3">a</mi></msub><mo id="algorithm2.16.16.m1.1.4.3" stretchy="false">)</mo></mrow><mrow id="algorithm2.16.16.m1.1.5"><mo id="algorithm2.16.16.m1.1.5.1" stretchy="false">[</mo><mo id="algorithm2.16.16.m1.1.5.2" rspace="0.278em">:</mo><mi id="algorithm2.16.16.m1.1.5.3">M</mi><mo id="algorithm2.16.16.m1.1.5.4" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.16.16.m1.1c">T_{a}\leftarrow\textnormal{{argSort}}(P_{a})[:M]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.16.16.m1.1d">italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← argSort ( italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) [ : italic_M ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.17.17">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{f}\leftarrow\textnormal{{argSort}}(P_{f})[:N]" class="ltx_math_unparsed" display="inline" id="algorithm2.17.17.m1.1"><semantics id="algorithm2.17.17.m1.1a"><mrow id="algorithm2.17.17.m1.1b"><msub id="algorithm2.17.17.m1.1.1"><mi id="algorithm2.17.17.m1.1.1.2">T</mi><mi id="algorithm2.17.17.m1.1.1.3">f</mi></msub><mo id="algorithm2.17.17.m1.1.2" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.17.17.m1.1.3">argSort</mtext><mrow id="algorithm2.17.17.m1.1.4"><mo id="algorithm2.17.17.m1.1.4.1" stretchy="false">(</mo><msub id="algorithm2.17.17.m1.1.4.2"><mi id="algorithm2.17.17.m1.1.4.2.2">P</mi><mi id="algorithm2.17.17.m1.1.4.2.3">f</mi></msub><mo id="algorithm2.17.17.m1.1.4.3" stretchy="false">)</mo></mrow><mrow id="algorithm2.17.17.m1.1.5"><mo id="algorithm2.17.17.m1.1.5.1" stretchy="false">[</mo><mo id="algorithm2.17.17.m1.1.5.2" rspace="0.278em">:</mo><mi id="algorithm2.17.17.m1.1.5.3">N</mi><mo id="algorithm2.17.17.m1.1.5.4" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.1c">T_{f}\leftarrow\textnormal{{argSort}}(P_{f})[:N]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.17.17.m1.1d">italic_T start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ← argSort ( italic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) [ : italic_N ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.18.18">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="P_{g}\leftarrow\textnormal{{inflectionGroupProbabilities}}(T_{s},T_{p},T_{a},P%
_{s},P_{p},P_{a},M,G)" class="ltx_Math" display="inline" id="algorithm2.18.18.m1.8"><semantics id="algorithm2.18.18.m1.8a"><mrow id="algorithm2.18.18.m1.8.8" xref="algorithm2.18.18.m1.8.8.cmml"><msub id="algorithm2.18.18.m1.8.8.8" xref="algorithm2.18.18.m1.8.8.8.cmml"><mi id="algorithm2.18.18.m1.8.8.8.2" xref="algorithm2.18.18.m1.8.8.8.2.cmml">P</mi><mi id="algorithm2.18.18.m1.8.8.8.3" xref="algorithm2.18.18.m1.8.8.8.3.cmml">g</mi></msub><mo id="algorithm2.18.18.m1.8.8.7" stretchy="false" xref="algorithm2.18.18.m1.8.8.7.cmml">←</mo><mrow id="algorithm2.18.18.m1.8.8.6" xref="algorithm2.18.18.m1.8.8.6.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.18.18.m1.8.8.6.8" xref="algorithm2.18.18.m1.8.8.6.8a.cmml">inflectionGroupProbabilities</mtext><mo id="algorithm2.18.18.m1.8.8.6.7" xref="algorithm2.18.18.m1.8.8.6.7.cmml">⁢</mo><mrow id="algorithm2.18.18.m1.8.8.6.6.6" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml"><mo id="algorithm2.18.18.m1.8.8.6.6.6.7" stretchy="false" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">(</mo><msub id="algorithm2.18.18.m1.3.3.1.1.1.1" xref="algorithm2.18.18.m1.3.3.1.1.1.1.cmml"><mi id="algorithm2.18.18.m1.3.3.1.1.1.1.2" xref="algorithm2.18.18.m1.3.3.1.1.1.1.2.cmml">T</mi><mi id="algorithm2.18.18.m1.3.3.1.1.1.1.3" xref="algorithm2.18.18.m1.3.3.1.1.1.1.3.cmml">s</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.8" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><msub id="algorithm2.18.18.m1.4.4.2.2.2.2" xref="algorithm2.18.18.m1.4.4.2.2.2.2.cmml"><mi id="algorithm2.18.18.m1.4.4.2.2.2.2.2" xref="algorithm2.18.18.m1.4.4.2.2.2.2.2.cmml">T</mi><mi id="algorithm2.18.18.m1.4.4.2.2.2.2.3" xref="algorithm2.18.18.m1.4.4.2.2.2.2.3.cmml">p</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.9" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><msub id="algorithm2.18.18.m1.5.5.3.3.3.3" xref="algorithm2.18.18.m1.5.5.3.3.3.3.cmml"><mi id="algorithm2.18.18.m1.5.5.3.3.3.3.2" xref="algorithm2.18.18.m1.5.5.3.3.3.3.2.cmml">T</mi><mi id="algorithm2.18.18.m1.5.5.3.3.3.3.3" xref="algorithm2.18.18.m1.5.5.3.3.3.3.3.cmml">a</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.10" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><msub id="algorithm2.18.18.m1.6.6.4.4.4.4" xref="algorithm2.18.18.m1.6.6.4.4.4.4.cmml"><mi id="algorithm2.18.18.m1.6.6.4.4.4.4.2" xref="algorithm2.18.18.m1.6.6.4.4.4.4.2.cmml">P</mi><mi id="algorithm2.18.18.m1.6.6.4.4.4.4.3" xref="algorithm2.18.18.m1.6.6.4.4.4.4.3.cmml">s</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.11" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><msub id="algorithm2.18.18.m1.7.7.5.5.5.5" xref="algorithm2.18.18.m1.7.7.5.5.5.5.cmml"><mi id="algorithm2.18.18.m1.7.7.5.5.5.5.2" xref="algorithm2.18.18.m1.7.7.5.5.5.5.2.cmml">P</mi><mi id="algorithm2.18.18.m1.7.7.5.5.5.5.3" xref="algorithm2.18.18.m1.7.7.5.5.5.5.3.cmml">p</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.12" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><msub id="algorithm2.18.18.m1.8.8.6.6.6.6" xref="algorithm2.18.18.m1.8.8.6.6.6.6.cmml"><mi id="algorithm2.18.18.m1.8.8.6.6.6.6.2" xref="algorithm2.18.18.m1.8.8.6.6.6.6.2.cmml">P</mi><mi id="algorithm2.18.18.m1.8.8.6.6.6.6.3" xref="algorithm2.18.18.m1.8.8.6.6.6.6.3.cmml">a</mi></msub><mo id="algorithm2.18.18.m1.8.8.6.6.6.13" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><mi id="algorithm2.18.18.m1.1.1" xref="algorithm2.18.18.m1.1.1.cmml">M</mi><mo id="algorithm2.18.18.m1.8.8.6.6.6.14" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">,</mo><mi id="algorithm2.18.18.m1.2.2" xref="algorithm2.18.18.m1.2.2.cmml">G</mi><mo id="algorithm2.18.18.m1.8.8.6.6.6.15" stretchy="false" xref="algorithm2.18.18.m1.8.8.6.6.7.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.8b"><apply id="algorithm2.18.18.m1.8.8.cmml" xref="algorithm2.18.18.m1.8.8"><ci id="algorithm2.18.18.m1.8.8.7.cmml" xref="algorithm2.18.18.m1.8.8.7">←</ci><apply id="algorithm2.18.18.m1.8.8.8.cmml" xref="algorithm2.18.18.m1.8.8.8"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.8.8.8.1.cmml" xref="algorithm2.18.18.m1.8.8.8">subscript</csymbol><ci id="algorithm2.18.18.m1.8.8.8.2.cmml" xref="algorithm2.18.18.m1.8.8.8.2">𝑃</ci><ci id="algorithm2.18.18.m1.8.8.8.3.cmml" xref="algorithm2.18.18.m1.8.8.8.3">𝑔</ci></apply><apply id="algorithm2.18.18.m1.8.8.6.cmml" xref="algorithm2.18.18.m1.8.8.6"><times id="algorithm2.18.18.m1.8.8.6.7.cmml" xref="algorithm2.18.18.m1.8.8.6.7"></times><ci id="algorithm2.18.18.m1.8.8.6.8a.cmml" xref="algorithm2.18.18.m1.8.8.6.8"><mtext class="ltx_mathvariant_monospace" id="algorithm2.18.18.m1.8.8.6.8.cmml" xref="algorithm2.18.18.m1.8.8.6.8">inflectionGroupProbabilities</mtext></ci><vector id="algorithm2.18.18.m1.8.8.6.6.7.cmml" xref="algorithm2.18.18.m1.8.8.6.6.6"><apply id="algorithm2.18.18.m1.3.3.1.1.1.1.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.3.3.1.1.1.1.1.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.1">subscript</csymbol><ci id="algorithm2.18.18.m1.3.3.1.1.1.1.2.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.1.2">𝑇</ci><ci id="algorithm2.18.18.m1.3.3.1.1.1.1.3.cmml" xref="algorithm2.18.18.m1.3.3.1.1.1.1.3">𝑠</ci></apply><apply id="algorithm2.18.18.m1.4.4.2.2.2.2.cmml" xref="algorithm2.18.18.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.4.4.2.2.2.2.1.cmml" xref="algorithm2.18.18.m1.4.4.2.2.2.2">subscript</csymbol><ci id="algorithm2.18.18.m1.4.4.2.2.2.2.2.cmml" xref="algorithm2.18.18.m1.4.4.2.2.2.2.2">𝑇</ci><ci id="algorithm2.18.18.m1.4.4.2.2.2.2.3.cmml" xref="algorithm2.18.18.m1.4.4.2.2.2.2.3">𝑝</ci></apply><apply id="algorithm2.18.18.m1.5.5.3.3.3.3.cmml" xref="algorithm2.18.18.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.5.5.3.3.3.3.1.cmml" xref="algorithm2.18.18.m1.5.5.3.3.3.3">subscript</csymbol><ci id="algorithm2.18.18.m1.5.5.3.3.3.3.2.cmml" xref="algorithm2.18.18.m1.5.5.3.3.3.3.2">𝑇</ci><ci id="algorithm2.18.18.m1.5.5.3.3.3.3.3.cmml" xref="algorithm2.18.18.m1.5.5.3.3.3.3.3">𝑎</ci></apply><apply id="algorithm2.18.18.m1.6.6.4.4.4.4.cmml" xref="algorithm2.18.18.m1.6.6.4.4.4.4"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.6.6.4.4.4.4.1.cmml" xref="algorithm2.18.18.m1.6.6.4.4.4.4">subscript</csymbol><ci id="algorithm2.18.18.m1.6.6.4.4.4.4.2.cmml" xref="algorithm2.18.18.m1.6.6.4.4.4.4.2">𝑃</ci><ci id="algorithm2.18.18.m1.6.6.4.4.4.4.3.cmml" xref="algorithm2.18.18.m1.6.6.4.4.4.4.3">𝑠</ci></apply><apply id="algorithm2.18.18.m1.7.7.5.5.5.5.cmml" xref="algorithm2.18.18.m1.7.7.5.5.5.5"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.7.7.5.5.5.5.1.cmml" xref="algorithm2.18.18.m1.7.7.5.5.5.5">subscript</csymbol><ci id="algorithm2.18.18.m1.7.7.5.5.5.5.2.cmml" xref="algorithm2.18.18.m1.7.7.5.5.5.5.2">𝑃</ci><ci id="algorithm2.18.18.m1.7.7.5.5.5.5.3.cmml" xref="algorithm2.18.18.m1.7.7.5.5.5.5.3">𝑝</ci></apply><apply id="algorithm2.18.18.m1.8.8.6.6.6.6.cmml" xref="algorithm2.18.18.m1.8.8.6.6.6.6"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.8.8.6.6.6.6.1.cmml" xref="algorithm2.18.18.m1.8.8.6.6.6.6">subscript</csymbol><ci id="algorithm2.18.18.m1.8.8.6.6.6.6.2.cmml" xref="algorithm2.18.18.m1.8.8.6.6.6.6.2">𝑃</ci><ci id="algorithm2.18.18.m1.8.8.6.6.6.6.3.cmml" xref="algorithm2.18.18.m1.8.8.6.6.6.6.3">𝑎</ci></apply><ci id="algorithm2.18.18.m1.1.1.cmml" xref="algorithm2.18.18.m1.1.1">𝑀</ci><ci id="algorithm2.18.18.m1.2.2.cmml" xref="algorithm2.18.18.m1.2.2">𝐺</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.8c">P_{g}\leftarrow\textnormal{{inflectionGroupProbabilities}}(T_{s},T_{p},T_{a},P%
_{s},P_{p},P_{a},M,G)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.18.18.m1.8d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ← inflectionGroupProbabilities ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_M , italic_G )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.19">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="G_{s}\leftarrow\textnormal{{argSort}}(P_{g})" class="ltx_Math" display="inline" id="algorithm2.19.19.m1.1"><semantics id="algorithm2.19.19.m1.1a"><mrow id="algorithm2.19.19.m1.1.1" xref="algorithm2.19.19.m1.1.1.cmml"><msub id="algorithm2.19.19.m1.1.1.3" xref="algorithm2.19.19.m1.1.1.3.cmml"><mi id="algorithm2.19.19.m1.1.1.3.2" xref="algorithm2.19.19.m1.1.1.3.2.cmml">G</mi><mi id="algorithm2.19.19.m1.1.1.3.3" xref="algorithm2.19.19.m1.1.1.3.3.cmml">s</mi></msub><mo id="algorithm2.19.19.m1.1.1.2" stretchy="false" xref="algorithm2.19.19.m1.1.1.2.cmml">←</mo><mrow id="algorithm2.19.19.m1.1.1.1" xref="algorithm2.19.19.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.19.19.m1.1.1.1.3" xref="algorithm2.19.19.m1.1.1.1.3a.cmml">argSort</mtext><mo id="algorithm2.19.19.m1.1.1.1.2" xref="algorithm2.19.19.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm2.19.19.m1.1.1.1.1.1" xref="algorithm2.19.19.m1.1.1.1.1.1.1.cmml"><mo id="algorithm2.19.19.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm2.19.19.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm2.19.19.m1.1.1.1.1.1.1" xref="algorithm2.19.19.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.19.19.m1.1.1.1.1.1.1.2" xref="algorithm2.19.19.m1.1.1.1.1.1.1.2.cmml">P</mi><mi id="algorithm2.19.19.m1.1.1.1.1.1.1.3" xref="algorithm2.19.19.m1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="algorithm2.19.19.m1.1.1.1.1.1.3" stretchy="false" xref="algorithm2.19.19.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.m1.1b"><apply id="algorithm2.19.19.m1.1.1.cmml" xref="algorithm2.19.19.m1.1.1"><ci id="algorithm2.19.19.m1.1.1.2.cmml" xref="algorithm2.19.19.m1.1.1.2">←</ci><apply id="algorithm2.19.19.m1.1.1.3.cmml" xref="algorithm2.19.19.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.19.19.m1.1.1.3.1.cmml" xref="algorithm2.19.19.m1.1.1.3">subscript</csymbol><ci id="algorithm2.19.19.m1.1.1.3.2.cmml" xref="algorithm2.19.19.m1.1.1.3.2">𝐺</ci><ci id="algorithm2.19.19.m1.1.1.3.3.cmml" xref="algorithm2.19.19.m1.1.1.3.3">𝑠</ci></apply><apply id="algorithm2.19.19.m1.1.1.1.cmml" xref="algorithm2.19.19.m1.1.1.1"><times id="algorithm2.19.19.m1.1.1.1.2.cmml" xref="algorithm2.19.19.m1.1.1.1.2"></times><ci id="algorithm2.19.19.m1.1.1.1.3a.cmml" xref="algorithm2.19.19.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="algorithm2.19.19.m1.1.1.1.3.cmml" xref="algorithm2.19.19.m1.1.1.1.3">argSort</mtext></ci><apply id="algorithm2.19.19.m1.1.1.1.1.1.1.cmml" xref="algorithm2.19.19.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.19.19.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.19.19.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.19.19.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.19.19.m1.1.1.1.1.1.1.2">𝑃</ci><ci id="algorithm2.19.19.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.19.19.m1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.m1.1c">G_{s}\leftarrow\textnormal{{argSort}}(P_{g})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.19.19.m1.1d">italic_G start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← argSort ( italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.20.20">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="pp\leftarrow 0" class="ltx_Math" display="inline" id="algorithm2.20.20.m1.1"><semantics id="algorithm2.20.20.m1.1a"><mrow id="algorithm2.20.20.m1.1.1" xref="algorithm2.20.20.m1.1.1.cmml"><mrow id="algorithm2.20.20.m1.1.1.2" xref="algorithm2.20.20.m1.1.1.2.cmml"><mi id="algorithm2.20.20.m1.1.1.2.2" xref="algorithm2.20.20.m1.1.1.2.2.cmml">p</mi><mo id="algorithm2.20.20.m1.1.1.2.1" xref="algorithm2.20.20.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.20.20.m1.1.1.2.3" xref="algorithm2.20.20.m1.1.1.2.3.cmml">p</mi></mrow><mo id="algorithm2.20.20.m1.1.1.1" stretchy="false" xref="algorithm2.20.20.m1.1.1.1.cmml">←</mo><mn id="algorithm2.20.20.m1.1.1.3" xref="algorithm2.20.20.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.20.20.m1.1b"><apply id="algorithm2.20.20.m1.1.1.cmml" xref="algorithm2.20.20.m1.1.1"><ci id="algorithm2.20.20.m1.1.1.1.cmml" xref="algorithm2.20.20.m1.1.1.1">←</ci><apply id="algorithm2.20.20.m1.1.1.2.cmml" xref="algorithm2.20.20.m1.1.1.2"><times id="algorithm2.20.20.m1.1.1.2.1.cmml" xref="algorithm2.20.20.m1.1.1.2.1"></times><ci id="algorithm2.20.20.m1.1.1.2.2.cmml" xref="algorithm2.20.20.m1.1.1.2.2">𝑝</ci><ci id="algorithm2.20.20.m1.1.1.2.3.cmml" xref="algorithm2.20.20.m1.1.1.2.3">𝑝</ci></apply><cn id="algorithm2.20.20.m1.1.1.3.cmml" type="integer" xref="algorithm2.20.20.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.20.20.m1.1c">pp\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="algorithm2.20.20.m1.1d">italic_p italic_p ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.21.21">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="R\leftarrow[~{}]" class="ltx_Math" display="inline" id="algorithm2.21.21.m1.1"><semantics id="algorithm2.21.21.m1.1a"><mrow id="algorithm2.21.21.m1.1.1" xref="algorithm2.21.21.m1.1.1.cmml"><mi id="algorithm2.21.21.m1.1.1.2" xref="algorithm2.21.21.m1.1.1.2.cmml">R</mi><mo id="algorithm2.21.21.m1.1.1.1" stretchy="false" xref="algorithm2.21.21.m1.1.1.1.cmml">←</mo><mrow id="algorithm2.21.21.m1.1.1.3.2" xref="algorithm2.21.21.m1.1.1.cmml"><mo id="algorithm2.21.21.m1.1.1.3.2.1" rspace="0.330em" stretchy="false" xref="algorithm2.21.21.m1.1.1.3.1.cmml">[</mo><mo id="algorithm2.21.21.m1.1.1.3.2.2" stretchy="false" xref="algorithm2.21.21.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.21.21.m1.1b"><apply id="algorithm2.21.21.m1.1.1.cmml" xref="algorithm2.21.21.m1.1.1"><ci id="algorithm2.21.21.m1.1.1.1.cmml" xref="algorithm2.21.21.m1.1.1.1">←</ci><ci id="algorithm2.21.21.m1.1.1.2.cmml" xref="algorithm2.21.21.m1.1.1.2">𝑅</ci><list id="algorithm2.21.21.m1.1.1.3.1.cmml" xref="algorithm2.21.21.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.21.21.m1.1c">R\leftarrow[~{}]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.21.21.m1.1d">italic_R ← [ ]</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="algorithm2.21.21.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.21.21.2" style="color:#0000FF;">List of inflections to return </span>
</div>
<div class="ltx_listingline" id="algorithm2.36.44">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.22.22">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm2.22.22.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.22.22.1"><math alttext="g\in G_{s}" class="ltx_Math" display="inline" id="algorithm2.22.22.1.m1.1"><semantics id="algorithm2.22.22.1.m1.1a"><mrow id="algorithm2.22.22.1.m1.1.1" xref="algorithm2.22.22.1.m1.1.1.cmml"><mi id="algorithm2.22.22.1.m1.1.1.2" xref="algorithm2.22.22.1.m1.1.1.2.cmml">g</mi><mo id="algorithm2.22.22.1.m1.1.1.1" xref="algorithm2.22.22.1.m1.1.1.1.cmml">∈</mo><msub id="algorithm2.22.22.1.m1.1.1.3" xref="algorithm2.22.22.1.m1.1.1.3.cmml"><mi id="algorithm2.22.22.1.m1.1.1.3.2" xref="algorithm2.22.22.1.m1.1.1.3.2.cmml">G</mi><mi id="algorithm2.22.22.1.m1.1.1.3.3" xref="algorithm2.22.22.1.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.22.22.1.m1.1b"><apply id="algorithm2.22.22.1.m1.1.1.cmml" xref="algorithm2.22.22.1.m1.1.1"><in id="algorithm2.22.22.1.m1.1.1.1.cmml" xref="algorithm2.22.22.1.m1.1.1.1"></in><ci id="algorithm2.22.22.1.m1.1.1.2.cmml" xref="algorithm2.22.22.1.m1.1.1.2">𝑔</ci><apply id="algorithm2.22.22.1.m1.1.1.3.cmml" xref="algorithm2.22.22.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.22.22.1.m1.1.1.3.1.cmml" xref="algorithm2.22.22.1.m1.1.1.3">subscript</csymbol><ci id="algorithm2.22.22.1.m1.1.1.3.2.cmml" xref="algorithm2.22.22.1.m1.1.1.3.2">𝐺</ci><ci id="algorithm2.22.22.1.m1.1.1.3.3.cmml" xref="algorithm2.22.22.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.22.22.1.m1.1c">g\in G_{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.22.22.1.m1.1d">italic_g ∈ italic_G start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.22.22.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.23.23">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="T_{s}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{s},P_{s},g,%
\delta,0)" class="ltx_Math" display="inline" id="algorithm2.23.23.m1.5"><semantics id="algorithm2.23.23.m1.5a"><mrow id="algorithm2.23.23.m1.5.5" xref="algorithm2.23.23.m1.5.5.cmml"><msubsup id="algorithm2.23.23.m1.5.5.4" xref="algorithm2.23.23.m1.5.5.4.cmml"><mi id="algorithm2.23.23.m1.5.5.4.2.2" xref="algorithm2.23.23.m1.5.5.4.2.2.cmml">T</mi><mi id="algorithm2.23.23.m1.5.5.4.2.3" xref="algorithm2.23.23.m1.5.5.4.2.3.cmml">s</mi><msup id="algorithm2.23.23.m1.5.5.4.3" xref="algorithm2.23.23.m1.5.5.4.3.cmml"><mi id="algorithm2.23.23.m1.5.5.4.3a" xref="algorithm2.23.23.m1.5.5.4.3.cmml"></mi><mo id="algorithm2.23.23.m1.5.5.4.3.1" xref="algorithm2.23.23.m1.5.5.4.3.1.cmml">′</mo></msup></msubsup><mo id="algorithm2.23.23.m1.5.5.3" stretchy="false" xref="algorithm2.23.23.m1.5.5.3.cmml">←</mo><mrow id="algorithm2.23.23.m1.5.5.2" xref="algorithm2.23.23.m1.5.5.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.23.23.m1.5.5.2.4" xref="algorithm2.23.23.m1.5.5.2.4a.cmml">filterAndCutOff</mtext><mo id="algorithm2.23.23.m1.5.5.2.3" xref="algorithm2.23.23.m1.5.5.2.3.cmml">⁢</mo><mrow id="algorithm2.23.23.m1.5.5.2.2.2" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml"><mo id="algorithm2.23.23.m1.5.5.2.2.2.3" stretchy="false" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">(</mo><msub id="algorithm2.23.23.m1.4.4.1.1.1.1" xref="algorithm2.23.23.m1.4.4.1.1.1.1.cmml"><mi id="algorithm2.23.23.m1.4.4.1.1.1.1.2" xref="algorithm2.23.23.m1.4.4.1.1.1.1.2.cmml">T</mi><mi id="algorithm2.23.23.m1.4.4.1.1.1.1.3" xref="algorithm2.23.23.m1.4.4.1.1.1.1.3.cmml">s</mi></msub><mo id="algorithm2.23.23.m1.5.5.2.2.2.4" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">,</mo><msub id="algorithm2.23.23.m1.5.5.2.2.2.2" xref="algorithm2.23.23.m1.5.5.2.2.2.2.cmml"><mi id="algorithm2.23.23.m1.5.5.2.2.2.2.2" xref="algorithm2.23.23.m1.5.5.2.2.2.2.2.cmml">P</mi><mi id="algorithm2.23.23.m1.5.5.2.2.2.2.3" xref="algorithm2.23.23.m1.5.5.2.2.2.2.3.cmml">s</mi></msub><mo id="algorithm2.23.23.m1.5.5.2.2.2.5" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.23.23.m1.1.1" xref="algorithm2.23.23.m1.1.1.cmml">g</mi><mo id="algorithm2.23.23.m1.5.5.2.2.2.6" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.23.23.m1.2.2" xref="algorithm2.23.23.m1.2.2.cmml">δ</mi><mo id="algorithm2.23.23.m1.5.5.2.2.2.7" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">,</mo><mn id="algorithm2.23.23.m1.3.3" xref="algorithm2.23.23.m1.3.3.cmml">0</mn><mo id="algorithm2.23.23.m1.5.5.2.2.2.8" stretchy="false" xref="algorithm2.23.23.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.23.23.m1.5b"><apply id="algorithm2.23.23.m1.5.5.cmml" xref="algorithm2.23.23.m1.5.5"><ci id="algorithm2.23.23.m1.5.5.3.cmml" xref="algorithm2.23.23.m1.5.5.3">←</ci><apply id="algorithm2.23.23.m1.5.5.4.cmml" xref="algorithm2.23.23.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.23.23.m1.5.5.4.1.cmml" xref="algorithm2.23.23.m1.5.5.4">superscript</csymbol><apply id="algorithm2.23.23.m1.5.5.4.2.cmml" xref="algorithm2.23.23.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.23.23.m1.5.5.4.2.1.cmml" xref="algorithm2.23.23.m1.5.5.4">subscript</csymbol><ci id="algorithm2.23.23.m1.5.5.4.2.2.cmml" xref="algorithm2.23.23.m1.5.5.4.2.2">𝑇</ci><ci id="algorithm2.23.23.m1.5.5.4.2.3.cmml" xref="algorithm2.23.23.m1.5.5.4.2.3">𝑠</ci></apply><apply id="algorithm2.23.23.m1.5.5.4.3.cmml" xref="algorithm2.23.23.m1.5.5.4.3"><ci id="algorithm2.23.23.m1.5.5.4.3.1.cmml" xref="algorithm2.23.23.m1.5.5.4.3.1">′</ci></apply></apply><apply id="algorithm2.23.23.m1.5.5.2.cmml" xref="algorithm2.23.23.m1.5.5.2"><times id="algorithm2.23.23.m1.5.5.2.3.cmml" xref="algorithm2.23.23.m1.5.5.2.3"></times><ci id="algorithm2.23.23.m1.5.5.2.4a.cmml" xref="algorithm2.23.23.m1.5.5.2.4"><mtext class="ltx_mathvariant_monospace" id="algorithm2.23.23.m1.5.5.2.4.cmml" xref="algorithm2.23.23.m1.5.5.2.4">filterAndCutOff</mtext></ci><vector id="algorithm2.23.23.m1.5.5.2.2.3.cmml" xref="algorithm2.23.23.m1.5.5.2.2.2"><apply id="algorithm2.23.23.m1.4.4.1.1.1.1.cmml" xref="algorithm2.23.23.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.23.23.m1.4.4.1.1.1.1.1.cmml" xref="algorithm2.23.23.m1.4.4.1.1.1.1">subscript</csymbol><ci id="algorithm2.23.23.m1.4.4.1.1.1.1.2.cmml" xref="algorithm2.23.23.m1.4.4.1.1.1.1.2">𝑇</ci><ci id="algorithm2.23.23.m1.4.4.1.1.1.1.3.cmml" xref="algorithm2.23.23.m1.4.4.1.1.1.1.3">𝑠</ci></apply><apply id="algorithm2.23.23.m1.5.5.2.2.2.2.cmml" xref="algorithm2.23.23.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.23.23.m1.5.5.2.2.2.2.1.cmml" xref="algorithm2.23.23.m1.5.5.2.2.2.2">subscript</csymbol><ci id="algorithm2.23.23.m1.5.5.2.2.2.2.2.cmml" xref="algorithm2.23.23.m1.5.5.2.2.2.2.2">𝑃</ci><ci id="algorithm2.23.23.m1.5.5.2.2.2.2.3.cmml" xref="algorithm2.23.23.m1.5.5.2.2.2.2.3">𝑠</ci></apply><ci id="algorithm2.23.23.m1.1.1.cmml" xref="algorithm2.23.23.m1.1.1">𝑔</ci><ci id="algorithm2.23.23.m1.2.2.cmml" xref="algorithm2.23.23.m1.2.2">𝛿</ci><cn id="algorithm2.23.23.m1.3.3.cmml" type="integer" xref="algorithm2.23.23.m1.3.3">0</cn></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.23.23.m1.5c">T_{s}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{s},P_{s},g,%
\delta,0)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.23.23.m1.5d">italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← filterAndCutOff ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_g , italic_δ , 0 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.24.24">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{p}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{p},P_{p},g,%
\delta,0)" class="ltx_Math" display="inline" id="algorithm2.24.24.m1.5"><semantics id="algorithm2.24.24.m1.5a"><mrow id="algorithm2.24.24.m1.5.5" xref="algorithm2.24.24.m1.5.5.cmml"><msubsup id="algorithm2.24.24.m1.5.5.4" xref="algorithm2.24.24.m1.5.5.4.cmml"><mi id="algorithm2.24.24.m1.5.5.4.2.2" xref="algorithm2.24.24.m1.5.5.4.2.2.cmml">T</mi><mi id="algorithm2.24.24.m1.5.5.4.2.3" xref="algorithm2.24.24.m1.5.5.4.2.3.cmml">p</mi><msup id="algorithm2.24.24.m1.5.5.4.3" xref="algorithm2.24.24.m1.5.5.4.3.cmml"><mi id="algorithm2.24.24.m1.5.5.4.3a" xref="algorithm2.24.24.m1.5.5.4.3.cmml"></mi><mo id="algorithm2.24.24.m1.5.5.4.3.1" xref="algorithm2.24.24.m1.5.5.4.3.1.cmml">′</mo></msup></msubsup><mo id="algorithm2.24.24.m1.5.5.3" stretchy="false" xref="algorithm2.24.24.m1.5.5.3.cmml">←</mo><mrow id="algorithm2.24.24.m1.5.5.2" xref="algorithm2.24.24.m1.5.5.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.24.24.m1.5.5.2.4" xref="algorithm2.24.24.m1.5.5.2.4a.cmml">filterAndCutOff</mtext><mo id="algorithm2.24.24.m1.5.5.2.3" xref="algorithm2.24.24.m1.5.5.2.3.cmml">⁢</mo><mrow id="algorithm2.24.24.m1.5.5.2.2.2" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml"><mo id="algorithm2.24.24.m1.5.5.2.2.2.3" stretchy="false" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">(</mo><msub id="algorithm2.24.24.m1.4.4.1.1.1.1" xref="algorithm2.24.24.m1.4.4.1.1.1.1.cmml"><mi id="algorithm2.24.24.m1.4.4.1.1.1.1.2" xref="algorithm2.24.24.m1.4.4.1.1.1.1.2.cmml">T</mi><mi id="algorithm2.24.24.m1.4.4.1.1.1.1.3" xref="algorithm2.24.24.m1.4.4.1.1.1.1.3.cmml">p</mi></msub><mo id="algorithm2.24.24.m1.5.5.2.2.2.4" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">,</mo><msub id="algorithm2.24.24.m1.5.5.2.2.2.2" xref="algorithm2.24.24.m1.5.5.2.2.2.2.cmml"><mi id="algorithm2.24.24.m1.5.5.2.2.2.2.2" xref="algorithm2.24.24.m1.5.5.2.2.2.2.2.cmml">P</mi><mi id="algorithm2.24.24.m1.5.5.2.2.2.2.3" xref="algorithm2.24.24.m1.5.5.2.2.2.2.3.cmml">p</mi></msub><mo id="algorithm2.24.24.m1.5.5.2.2.2.5" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.24.24.m1.1.1" xref="algorithm2.24.24.m1.1.1.cmml">g</mi><mo id="algorithm2.24.24.m1.5.5.2.2.2.6" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.24.24.m1.2.2" xref="algorithm2.24.24.m1.2.2.cmml">δ</mi><mo id="algorithm2.24.24.m1.5.5.2.2.2.7" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">,</mo><mn id="algorithm2.24.24.m1.3.3" xref="algorithm2.24.24.m1.3.3.cmml">0</mn><mo id="algorithm2.24.24.m1.5.5.2.2.2.8" stretchy="false" xref="algorithm2.24.24.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.24.24.m1.5b"><apply id="algorithm2.24.24.m1.5.5.cmml" xref="algorithm2.24.24.m1.5.5"><ci id="algorithm2.24.24.m1.5.5.3.cmml" xref="algorithm2.24.24.m1.5.5.3">←</ci><apply id="algorithm2.24.24.m1.5.5.4.cmml" xref="algorithm2.24.24.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.24.24.m1.5.5.4.1.cmml" xref="algorithm2.24.24.m1.5.5.4">superscript</csymbol><apply id="algorithm2.24.24.m1.5.5.4.2.cmml" xref="algorithm2.24.24.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.24.24.m1.5.5.4.2.1.cmml" xref="algorithm2.24.24.m1.5.5.4">subscript</csymbol><ci id="algorithm2.24.24.m1.5.5.4.2.2.cmml" xref="algorithm2.24.24.m1.5.5.4.2.2">𝑇</ci><ci id="algorithm2.24.24.m1.5.5.4.2.3.cmml" xref="algorithm2.24.24.m1.5.5.4.2.3">𝑝</ci></apply><apply id="algorithm2.24.24.m1.5.5.4.3.cmml" xref="algorithm2.24.24.m1.5.5.4.3"><ci id="algorithm2.24.24.m1.5.5.4.3.1.cmml" xref="algorithm2.24.24.m1.5.5.4.3.1">′</ci></apply></apply><apply id="algorithm2.24.24.m1.5.5.2.cmml" xref="algorithm2.24.24.m1.5.5.2"><times id="algorithm2.24.24.m1.5.5.2.3.cmml" xref="algorithm2.24.24.m1.5.5.2.3"></times><ci id="algorithm2.24.24.m1.5.5.2.4a.cmml" xref="algorithm2.24.24.m1.5.5.2.4"><mtext class="ltx_mathvariant_monospace" id="algorithm2.24.24.m1.5.5.2.4.cmml" xref="algorithm2.24.24.m1.5.5.2.4">filterAndCutOff</mtext></ci><vector id="algorithm2.24.24.m1.5.5.2.2.3.cmml" xref="algorithm2.24.24.m1.5.5.2.2.2"><apply id="algorithm2.24.24.m1.4.4.1.1.1.1.cmml" xref="algorithm2.24.24.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.24.24.m1.4.4.1.1.1.1.1.cmml" xref="algorithm2.24.24.m1.4.4.1.1.1.1">subscript</csymbol><ci id="algorithm2.24.24.m1.4.4.1.1.1.1.2.cmml" xref="algorithm2.24.24.m1.4.4.1.1.1.1.2">𝑇</ci><ci id="algorithm2.24.24.m1.4.4.1.1.1.1.3.cmml" xref="algorithm2.24.24.m1.4.4.1.1.1.1.3">𝑝</ci></apply><apply id="algorithm2.24.24.m1.5.5.2.2.2.2.cmml" xref="algorithm2.24.24.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.24.24.m1.5.5.2.2.2.2.1.cmml" xref="algorithm2.24.24.m1.5.5.2.2.2.2">subscript</csymbol><ci id="algorithm2.24.24.m1.5.5.2.2.2.2.2.cmml" xref="algorithm2.24.24.m1.5.5.2.2.2.2.2">𝑃</ci><ci id="algorithm2.24.24.m1.5.5.2.2.2.2.3.cmml" xref="algorithm2.24.24.m1.5.5.2.2.2.2.3">𝑝</ci></apply><ci id="algorithm2.24.24.m1.1.1.cmml" xref="algorithm2.24.24.m1.1.1">𝑔</ci><ci id="algorithm2.24.24.m1.2.2.cmml" xref="algorithm2.24.24.m1.2.2">𝛿</ci><cn id="algorithm2.24.24.m1.3.3.cmml" type="integer" xref="algorithm2.24.24.m1.3.3">0</cn></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.24.24.m1.5c">T_{p}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{p},P_{p},g,%
\delta,0)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.24.24.m1.5d">italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← filterAndCutOff ( italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_g , italic_δ , 0 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.25.25">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{a}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{a},P_{a},g,%
\delta,0)" class="ltx_Math" display="inline" id="algorithm2.25.25.m1.5"><semantics id="algorithm2.25.25.m1.5a"><mrow id="algorithm2.25.25.m1.5.5" xref="algorithm2.25.25.m1.5.5.cmml"><msubsup id="algorithm2.25.25.m1.5.5.4" xref="algorithm2.25.25.m1.5.5.4.cmml"><mi id="algorithm2.25.25.m1.5.5.4.2.2" xref="algorithm2.25.25.m1.5.5.4.2.2.cmml">T</mi><mi id="algorithm2.25.25.m1.5.5.4.2.3" xref="algorithm2.25.25.m1.5.5.4.2.3.cmml">a</mi><msup id="algorithm2.25.25.m1.5.5.4.3" xref="algorithm2.25.25.m1.5.5.4.3.cmml"><mi id="algorithm2.25.25.m1.5.5.4.3a" xref="algorithm2.25.25.m1.5.5.4.3.cmml"></mi><mo id="algorithm2.25.25.m1.5.5.4.3.1" xref="algorithm2.25.25.m1.5.5.4.3.1.cmml">′</mo></msup></msubsup><mo id="algorithm2.25.25.m1.5.5.3" stretchy="false" xref="algorithm2.25.25.m1.5.5.3.cmml">←</mo><mrow id="algorithm2.25.25.m1.5.5.2" xref="algorithm2.25.25.m1.5.5.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.25.25.m1.5.5.2.4" xref="algorithm2.25.25.m1.5.5.2.4a.cmml">filterAndCutOff</mtext><mo id="algorithm2.25.25.m1.5.5.2.3" xref="algorithm2.25.25.m1.5.5.2.3.cmml">⁢</mo><mrow id="algorithm2.25.25.m1.5.5.2.2.2" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml"><mo id="algorithm2.25.25.m1.5.5.2.2.2.3" stretchy="false" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">(</mo><msub id="algorithm2.25.25.m1.4.4.1.1.1.1" xref="algorithm2.25.25.m1.4.4.1.1.1.1.cmml"><mi id="algorithm2.25.25.m1.4.4.1.1.1.1.2" xref="algorithm2.25.25.m1.4.4.1.1.1.1.2.cmml">T</mi><mi id="algorithm2.25.25.m1.4.4.1.1.1.1.3" xref="algorithm2.25.25.m1.4.4.1.1.1.1.3.cmml">a</mi></msub><mo id="algorithm2.25.25.m1.5.5.2.2.2.4" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">,</mo><msub id="algorithm2.25.25.m1.5.5.2.2.2.2" xref="algorithm2.25.25.m1.5.5.2.2.2.2.cmml"><mi id="algorithm2.25.25.m1.5.5.2.2.2.2.2" xref="algorithm2.25.25.m1.5.5.2.2.2.2.2.cmml">P</mi><mi id="algorithm2.25.25.m1.5.5.2.2.2.2.3" xref="algorithm2.25.25.m1.5.5.2.2.2.2.3.cmml">a</mi></msub><mo id="algorithm2.25.25.m1.5.5.2.2.2.5" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.25.25.m1.1.1" xref="algorithm2.25.25.m1.1.1.cmml">g</mi><mo id="algorithm2.25.25.m1.5.5.2.2.2.6" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.25.25.m1.2.2" xref="algorithm2.25.25.m1.2.2.cmml">δ</mi><mo id="algorithm2.25.25.m1.5.5.2.2.2.7" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">,</mo><mn id="algorithm2.25.25.m1.3.3" xref="algorithm2.25.25.m1.3.3.cmml">0</mn><mo id="algorithm2.25.25.m1.5.5.2.2.2.8" stretchy="false" xref="algorithm2.25.25.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.25.25.m1.5b"><apply id="algorithm2.25.25.m1.5.5.cmml" xref="algorithm2.25.25.m1.5.5"><ci id="algorithm2.25.25.m1.5.5.3.cmml" xref="algorithm2.25.25.m1.5.5.3">←</ci><apply id="algorithm2.25.25.m1.5.5.4.cmml" xref="algorithm2.25.25.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.25.25.m1.5.5.4.1.cmml" xref="algorithm2.25.25.m1.5.5.4">superscript</csymbol><apply id="algorithm2.25.25.m1.5.5.4.2.cmml" xref="algorithm2.25.25.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.25.25.m1.5.5.4.2.1.cmml" xref="algorithm2.25.25.m1.5.5.4">subscript</csymbol><ci id="algorithm2.25.25.m1.5.5.4.2.2.cmml" xref="algorithm2.25.25.m1.5.5.4.2.2">𝑇</ci><ci id="algorithm2.25.25.m1.5.5.4.2.3.cmml" xref="algorithm2.25.25.m1.5.5.4.2.3">𝑎</ci></apply><apply id="algorithm2.25.25.m1.5.5.4.3.cmml" xref="algorithm2.25.25.m1.5.5.4.3"><ci id="algorithm2.25.25.m1.5.5.4.3.1.cmml" xref="algorithm2.25.25.m1.5.5.4.3.1">′</ci></apply></apply><apply id="algorithm2.25.25.m1.5.5.2.cmml" xref="algorithm2.25.25.m1.5.5.2"><times id="algorithm2.25.25.m1.5.5.2.3.cmml" xref="algorithm2.25.25.m1.5.5.2.3"></times><ci id="algorithm2.25.25.m1.5.5.2.4a.cmml" xref="algorithm2.25.25.m1.5.5.2.4"><mtext class="ltx_mathvariant_monospace" id="algorithm2.25.25.m1.5.5.2.4.cmml" xref="algorithm2.25.25.m1.5.5.2.4">filterAndCutOff</mtext></ci><vector id="algorithm2.25.25.m1.5.5.2.2.3.cmml" xref="algorithm2.25.25.m1.5.5.2.2.2"><apply id="algorithm2.25.25.m1.4.4.1.1.1.1.cmml" xref="algorithm2.25.25.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.25.25.m1.4.4.1.1.1.1.1.cmml" xref="algorithm2.25.25.m1.4.4.1.1.1.1">subscript</csymbol><ci id="algorithm2.25.25.m1.4.4.1.1.1.1.2.cmml" xref="algorithm2.25.25.m1.4.4.1.1.1.1.2">𝑇</ci><ci id="algorithm2.25.25.m1.4.4.1.1.1.1.3.cmml" xref="algorithm2.25.25.m1.4.4.1.1.1.1.3">𝑎</ci></apply><apply id="algorithm2.25.25.m1.5.5.2.2.2.2.cmml" xref="algorithm2.25.25.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.25.25.m1.5.5.2.2.2.2.1.cmml" xref="algorithm2.25.25.m1.5.5.2.2.2.2">subscript</csymbol><ci id="algorithm2.25.25.m1.5.5.2.2.2.2.2.cmml" xref="algorithm2.25.25.m1.5.5.2.2.2.2.2">𝑃</ci><ci id="algorithm2.25.25.m1.5.5.2.2.2.2.3.cmml" xref="algorithm2.25.25.m1.5.5.2.2.2.2.3">𝑎</ci></apply><ci id="algorithm2.25.25.m1.1.1.cmml" xref="algorithm2.25.25.m1.1.1">𝑔</ci><ci id="algorithm2.25.25.m1.2.2.cmml" xref="algorithm2.25.25.m1.2.2">𝛿</ci><cn id="algorithm2.25.25.m1.3.3.cmml" type="integer" xref="algorithm2.25.25.m1.3.3">0</cn></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.25.25.m1.5c">T_{a}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{a},P_{a},g,%
\delta,0)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.25.25.m1.5d">italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← filterAndCutOff ( italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_g , italic_δ , 0 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.26.26">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="T_{f}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{f},P_{f},g,%
\delta,\gamma)" class="ltx_Math" display="inline" id="algorithm2.26.26.m1.5"><semantics id="algorithm2.26.26.m1.5a"><mrow id="algorithm2.26.26.m1.5.5" xref="algorithm2.26.26.m1.5.5.cmml"><msubsup id="algorithm2.26.26.m1.5.5.4" xref="algorithm2.26.26.m1.5.5.4.cmml"><mi id="algorithm2.26.26.m1.5.5.4.2.2" xref="algorithm2.26.26.m1.5.5.4.2.2.cmml">T</mi><mi id="algorithm2.26.26.m1.5.5.4.2.3" xref="algorithm2.26.26.m1.5.5.4.2.3.cmml">f</mi><msup id="algorithm2.26.26.m1.5.5.4.3" xref="algorithm2.26.26.m1.5.5.4.3.cmml"><mi id="algorithm2.26.26.m1.5.5.4.3a" xref="algorithm2.26.26.m1.5.5.4.3.cmml"></mi><mo id="algorithm2.26.26.m1.5.5.4.3.1" xref="algorithm2.26.26.m1.5.5.4.3.1.cmml">′</mo></msup></msubsup><mo id="algorithm2.26.26.m1.5.5.3" stretchy="false" xref="algorithm2.26.26.m1.5.5.3.cmml">←</mo><mrow id="algorithm2.26.26.m1.5.5.2" xref="algorithm2.26.26.m1.5.5.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.26.26.m1.5.5.2.4" xref="algorithm2.26.26.m1.5.5.2.4a.cmml">filterAndCutOff</mtext><mo id="algorithm2.26.26.m1.5.5.2.3" xref="algorithm2.26.26.m1.5.5.2.3.cmml">⁢</mo><mrow id="algorithm2.26.26.m1.5.5.2.2.2" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml"><mo id="algorithm2.26.26.m1.5.5.2.2.2.3" stretchy="false" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">(</mo><msub id="algorithm2.26.26.m1.4.4.1.1.1.1" xref="algorithm2.26.26.m1.4.4.1.1.1.1.cmml"><mi id="algorithm2.26.26.m1.4.4.1.1.1.1.2" xref="algorithm2.26.26.m1.4.4.1.1.1.1.2.cmml">T</mi><mi id="algorithm2.26.26.m1.4.4.1.1.1.1.3" xref="algorithm2.26.26.m1.4.4.1.1.1.1.3.cmml">f</mi></msub><mo id="algorithm2.26.26.m1.5.5.2.2.2.4" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">,</mo><msub id="algorithm2.26.26.m1.5.5.2.2.2.2" xref="algorithm2.26.26.m1.5.5.2.2.2.2.cmml"><mi id="algorithm2.26.26.m1.5.5.2.2.2.2.2" xref="algorithm2.26.26.m1.5.5.2.2.2.2.2.cmml">P</mi><mi id="algorithm2.26.26.m1.5.5.2.2.2.2.3" xref="algorithm2.26.26.m1.5.5.2.2.2.2.3.cmml">f</mi></msub><mo id="algorithm2.26.26.m1.5.5.2.2.2.5" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.26.26.m1.1.1" xref="algorithm2.26.26.m1.1.1.cmml">g</mi><mo id="algorithm2.26.26.m1.5.5.2.2.2.6" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.26.26.m1.2.2" xref="algorithm2.26.26.m1.2.2.cmml">δ</mi><mo id="algorithm2.26.26.m1.5.5.2.2.2.7" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">,</mo><mi id="algorithm2.26.26.m1.3.3" xref="algorithm2.26.26.m1.3.3.cmml">γ</mi><mo id="algorithm2.26.26.m1.5.5.2.2.2.8" stretchy="false" xref="algorithm2.26.26.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.26.26.m1.5b"><apply id="algorithm2.26.26.m1.5.5.cmml" xref="algorithm2.26.26.m1.5.5"><ci id="algorithm2.26.26.m1.5.5.3.cmml" xref="algorithm2.26.26.m1.5.5.3">←</ci><apply id="algorithm2.26.26.m1.5.5.4.cmml" xref="algorithm2.26.26.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.26.26.m1.5.5.4.1.cmml" xref="algorithm2.26.26.m1.5.5.4">superscript</csymbol><apply id="algorithm2.26.26.m1.5.5.4.2.cmml" xref="algorithm2.26.26.m1.5.5.4"><csymbol cd="ambiguous" id="algorithm2.26.26.m1.5.5.4.2.1.cmml" xref="algorithm2.26.26.m1.5.5.4">subscript</csymbol><ci id="algorithm2.26.26.m1.5.5.4.2.2.cmml" xref="algorithm2.26.26.m1.5.5.4.2.2">𝑇</ci><ci id="algorithm2.26.26.m1.5.5.4.2.3.cmml" xref="algorithm2.26.26.m1.5.5.4.2.3">𝑓</ci></apply><apply id="algorithm2.26.26.m1.5.5.4.3.cmml" xref="algorithm2.26.26.m1.5.5.4.3"><ci id="algorithm2.26.26.m1.5.5.4.3.1.cmml" xref="algorithm2.26.26.m1.5.5.4.3.1">′</ci></apply></apply><apply id="algorithm2.26.26.m1.5.5.2.cmml" xref="algorithm2.26.26.m1.5.5.2"><times id="algorithm2.26.26.m1.5.5.2.3.cmml" xref="algorithm2.26.26.m1.5.5.2.3"></times><ci id="algorithm2.26.26.m1.5.5.2.4a.cmml" xref="algorithm2.26.26.m1.5.5.2.4"><mtext class="ltx_mathvariant_monospace" id="algorithm2.26.26.m1.5.5.2.4.cmml" xref="algorithm2.26.26.m1.5.5.2.4">filterAndCutOff</mtext></ci><vector id="algorithm2.26.26.m1.5.5.2.2.3.cmml" xref="algorithm2.26.26.m1.5.5.2.2.2"><apply id="algorithm2.26.26.m1.4.4.1.1.1.1.cmml" xref="algorithm2.26.26.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.26.26.m1.4.4.1.1.1.1.1.cmml" xref="algorithm2.26.26.m1.4.4.1.1.1.1">subscript</csymbol><ci id="algorithm2.26.26.m1.4.4.1.1.1.1.2.cmml" xref="algorithm2.26.26.m1.4.4.1.1.1.1.2">𝑇</ci><ci id="algorithm2.26.26.m1.4.4.1.1.1.1.3.cmml" xref="algorithm2.26.26.m1.4.4.1.1.1.1.3">𝑓</ci></apply><apply id="algorithm2.26.26.m1.5.5.2.2.2.2.cmml" xref="algorithm2.26.26.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.26.26.m1.5.5.2.2.2.2.1.cmml" xref="algorithm2.26.26.m1.5.5.2.2.2.2">subscript</csymbol><ci id="algorithm2.26.26.m1.5.5.2.2.2.2.2.cmml" xref="algorithm2.26.26.m1.5.5.2.2.2.2.2">𝑃</ci><ci id="algorithm2.26.26.m1.5.5.2.2.2.2.3.cmml" xref="algorithm2.26.26.m1.5.5.2.2.2.2.3">𝑓</ci></apply><ci id="algorithm2.26.26.m1.1.1.cmml" xref="algorithm2.26.26.m1.1.1">𝑔</ci><ci id="algorithm2.26.26.m1.2.2.cmml" xref="algorithm2.26.26.m1.2.2">𝛿</ci><ci id="algorithm2.26.26.m1.3.3.cmml" xref="algorithm2.26.26.m1.3.3">𝛾</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.26.26.m1.5c">T_{f}^{{}^{\prime}}\leftarrow\textnormal{{filterAndCutOff}}(T_{f},P_{f},g,%
\delta,\gamma)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.26.26.m1.5d">italic_T start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← filterAndCutOff ( italic_T start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT , italic_g , italic_δ , italic_γ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.27.27">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="C_{g}\leftarrow\textnormal{{computeScore}}(T_{s}^{{}^{\prime}},T_{p}^{{}^{%
\prime}},T_{a}^{{}^{\prime}},P_{s},P_{p},P_{a},\rho[.,.],\alpha)" class="ltx_math_unparsed" display="inline" id="algorithm2.27.27.m1.1"><semantics id="algorithm2.27.27.m1.1a"><mrow id="algorithm2.27.27.m1.1b"><msub id="algorithm2.27.27.m1.1.2"><mi id="algorithm2.27.27.m1.1.2.2">C</mi><mi id="algorithm2.27.27.m1.1.2.3">g</mi></msub><mo id="algorithm2.27.27.m1.1.3" stretchy="false">←</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.27.27.m1.1.4">computeScore</mtext><mrow id="algorithm2.27.27.m1.1.5"><mo id="algorithm2.27.27.m1.1.5.1" stretchy="false">(</mo><msubsup id="algorithm2.27.27.m1.1.5.2"><mi id="algorithm2.27.27.m1.1.5.2.2.2">T</mi><mi id="algorithm2.27.27.m1.1.5.2.2.3">s</mi><msup id="algorithm2.27.27.m1.1.5.2.3"><mi id="algorithm2.27.27.m1.1.5.2.3a"></mi><mo id="algorithm2.27.27.m1.1.5.2.3.1">′</mo></msup></msubsup><mo id="algorithm2.27.27.m1.1.5.3">,</mo><msubsup id="algorithm2.27.27.m1.1.5.4"><mi id="algorithm2.27.27.m1.1.5.4.2.2">T</mi><mi id="algorithm2.27.27.m1.1.5.4.2.3">p</mi><msup id="algorithm2.27.27.m1.1.5.4.3"><mi id="algorithm2.27.27.m1.1.5.4.3a"></mi><mo id="algorithm2.27.27.m1.1.5.4.3.1">′</mo></msup></msubsup><mo id="algorithm2.27.27.m1.1.5.5">,</mo><msubsup id="algorithm2.27.27.m1.1.5.6"><mi id="algorithm2.27.27.m1.1.5.6.2.2">T</mi><mi id="algorithm2.27.27.m1.1.5.6.2.3">a</mi><msup id="algorithm2.27.27.m1.1.5.6.3"><mi id="algorithm2.27.27.m1.1.5.6.3a"></mi><mo id="algorithm2.27.27.m1.1.5.6.3.1">′</mo></msup></msubsup><mo id="algorithm2.27.27.m1.1.5.7">,</mo><msub id="algorithm2.27.27.m1.1.5.8"><mi id="algorithm2.27.27.m1.1.5.8.2">P</mi><mi id="algorithm2.27.27.m1.1.5.8.3">s</mi></msub><mo id="algorithm2.27.27.m1.1.5.9">,</mo><msub id="algorithm2.27.27.m1.1.5.10"><mi id="algorithm2.27.27.m1.1.5.10.2">P</mi><mi id="algorithm2.27.27.m1.1.5.10.3">p</mi></msub><mo id="algorithm2.27.27.m1.1.5.11">,</mo><msub id="algorithm2.27.27.m1.1.5.12"><mi id="algorithm2.27.27.m1.1.5.12.2">P</mi><mi id="algorithm2.27.27.m1.1.5.12.3">a</mi></msub><mo id="algorithm2.27.27.m1.1.5.13">,</mo><mi id="algorithm2.27.27.m1.1.1">ρ</mi><mrow id="algorithm2.27.27.m1.1.5.14"><mo id="algorithm2.27.27.m1.1.5.14.1" stretchy="false">[</mo><mo id="algorithm2.27.27.m1.1.5.14.2" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.27.27.m1.1.5.14.3">,</mo><mo id="algorithm2.27.27.m1.1.5.14.4" lspace="0em" rspace="0.167em">.</mo><mo id="algorithm2.27.27.m1.1.5.14.5" stretchy="false">]</mo></mrow><mo id="algorithm2.27.27.m1.1.5.15">,</mo><mi id="algorithm2.27.27.m1.1.5.16">α</mi><mo id="algorithm2.27.27.m1.1.5.17" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="algorithm2.27.27.m1.1c">C_{g}\leftarrow\textnormal{{computeScore}}(T_{s}^{{}^{\prime}},T_{p}^{{}^{%
\prime}},T_{a}^{{}^{\prime}},P_{s},P_{p},P_{a},\rho[.,.],\alpha)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.27.27.m1.1d">italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ← computeScore ( italic_T start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_T start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_T start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_ρ [ . , . ] , italic_α )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.28.28">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="L_{g}\leftarrow\textnormal{{argSort}}(C_{g})" class="ltx_Math" display="inline" id="algorithm2.28.28.m1.1"><semantics id="algorithm2.28.28.m1.1a"><mrow id="algorithm2.28.28.m1.1.1" xref="algorithm2.28.28.m1.1.1.cmml"><msub id="algorithm2.28.28.m1.1.1.3" xref="algorithm2.28.28.m1.1.1.3.cmml"><mi id="algorithm2.28.28.m1.1.1.3.2" xref="algorithm2.28.28.m1.1.1.3.2.cmml">L</mi><mi id="algorithm2.28.28.m1.1.1.3.3" xref="algorithm2.28.28.m1.1.1.3.3.cmml">g</mi></msub><mo id="algorithm2.28.28.m1.1.1.2" stretchy="false" xref="algorithm2.28.28.m1.1.1.2.cmml">←</mo><mrow id="algorithm2.28.28.m1.1.1.1" xref="algorithm2.28.28.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.28.28.m1.1.1.1.3" xref="algorithm2.28.28.m1.1.1.1.3a.cmml">argSort</mtext><mo id="algorithm2.28.28.m1.1.1.1.2" xref="algorithm2.28.28.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm2.28.28.m1.1.1.1.1.1" xref="algorithm2.28.28.m1.1.1.1.1.1.1.cmml"><mo id="algorithm2.28.28.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm2.28.28.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm2.28.28.m1.1.1.1.1.1.1" xref="algorithm2.28.28.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.28.28.m1.1.1.1.1.1.1.2" xref="algorithm2.28.28.m1.1.1.1.1.1.1.2.cmml">C</mi><mi id="algorithm2.28.28.m1.1.1.1.1.1.1.3" xref="algorithm2.28.28.m1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="algorithm2.28.28.m1.1.1.1.1.1.3" stretchy="false" xref="algorithm2.28.28.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.28.28.m1.1b"><apply id="algorithm2.28.28.m1.1.1.cmml" xref="algorithm2.28.28.m1.1.1"><ci id="algorithm2.28.28.m1.1.1.2.cmml" xref="algorithm2.28.28.m1.1.1.2">←</ci><apply id="algorithm2.28.28.m1.1.1.3.cmml" xref="algorithm2.28.28.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.28.28.m1.1.1.3.1.cmml" xref="algorithm2.28.28.m1.1.1.3">subscript</csymbol><ci id="algorithm2.28.28.m1.1.1.3.2.cmml" xref="algorithm2.28.28.m1.1.1.3.2">𝐿</ci><ci id="algorithm2.28.28.m1.1.1.3.3.cmml" xref="algorithm2.28.28.m1.1.1.3.3">𝑔</ci></apply><apply id="algorithm2.28.28.m1.1.1.1.cmml" xref="algorithm2.28.28.m1.1.1.1"><times id="algorithm2.28.28.m1.1.1.1.2.cmml" xref="algorithm2.28.28.m1.1.1.1.2"></times><ci id="algorithm2.28.28.m1.1.1.1.3a.cmml" xref="algorithm2.28.28.m1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="algorithm2.28.28.m1.1.1.1.3.cmml" xref="algorithm2.28.28.m1.1.1.1.3">argSort</mtext></ci><apply id="algorithm2.28.28.m1.1.1.1.1.1.1.cmml" xref="algorithm2.28.28.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.28.28.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.28.28.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.28.28.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.28.28.m1.1.1.1.1.1.1.2">𝐶</ci><ci id="algorithm2.28.28.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.28.28.m1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.28.28.m1.1c">L_{g}\leftarrow\textnormal{{argSort}}(C_{g})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.28.28.m1.1d">italic_L start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ← argSort ( italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.29.29">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm2.29.29.2">foreach</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.29.29.1"><math alttext="(s,p,a)\in L_{s}" class="ltx_Math" display="inline" id="algorithm2.29.29.1.m1.3"><semantics id="algorithm2.29.29.1.m1.3a"><mrow id="algorithm2.29.29.1.m1.3.4" xref="algorithm2.29.29.1.m1.3.4.cmml"><mrow id="algorithm2.29.29.1.m1.3.4.2.2" xref="algorithm2.29.29.1.m1.3.4.2.1.cmml"><mo id="algorithm2.29.29.1.m1.3.4.2.2.1" stretchy="false" xref="algorithm2.29.29.1.m1.3.4.2.1.cmml">(</mo><mi id="algorithm2.29.29.1.m1.1.1" xref="algorithm2.29.29.1.m1.1.1.cmml">s</mi><mo id="algorithm2.29.29.1.m1.3.4.2.2.2" xref="algorithm2.29.29.1.m1.3.4.2.1.cmml">,</mo><mi id="algorithm2.29.29.1.m1.2.2" xref="algorithm2.29.29.1.m1.2.2.cmml">p</mi><mo id="algorithm2.29.29.1.m1.3.4.2.2.3" xref="algorithm2.29.29.1.m1.3.4.2.1.cmml">,</mo><mi id="algorithm2.29.29.1.m1.3.3" xref="algorithm2.29.29.1.m1.3.3.cmml">a</mi><mo id="algorithm2.29.29.1.m1.3.4.2.2.4" stretchy="false" xref="algorithm2.29.29.1.m1.3.4.2.1.cmml">)</mo></mrow><mo id="algorithm2.29.29.1.m1.3.4.1" xref="algorithm2.29.29.1.m1.3.4.1.cmml">∈</mo><msub id="algorithm2.29.29.1.m1.3.4.3" xref="algorithm2.29.29.1.m1.3.4.3.cmml"><mi id="algorithm2.29.29.1.m1.3.4.3.2" xref="algorithm2.29.29.1.m1.3.4.3.2.cmml">L</mi><mi id="algorithm2.29.29.1.m1.3.4.3.3" xref="algorithm2.29.29.1.m1.3.4.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.29.29.1.m1.3b"><apply id="algorithm2.29.29.1.m1.3.4.cmml" xref="algorithm2.29.29.1.m1.3.4"><in id="algorithm2.29.29.1.m1.3.4.1.cmml" xref="algorithm2.29.29.1.m1.3.4.1"></in><vector id="algorithm2.29.29.1.m1.3.4.2.1.cmml" xref="algorithm2.29.29.1.m1.3.4.2.2"><ci id="algorithm2.29.29.1.m1.1.1.cmml" xref="algorithm2.29.29.1.m1.1.1">𝑠</ci><ci id="algorithm2.29.29.1.m1.2.2.cmml" xref="algorithm2.29.29.1.m1.2.2">𝑝</ci><ci id="algorithm2.29.29.1.m1.3.3.cmml" xref="algorithm2.29.29.1.m1.3.3">𝑎</ci></vector><apply id="algorithm2.29.29.1.m1.3.4.3.cmml" xref="algorithm2.29.29.1.m1.3.4.3"><csymbol cd="ambiguous" id="algorithm2.29.29.1.m1.3.4.3.1.cmml" xref="algorithm2.29.29.1.m1.3.4.3">subscript</csymbol><ci id="algorithm2.29.29.1.m1.3.4.3.2.cmml" xref="algorithm2.29.29.1.m1.3.4.3.2">𝐿</ci><ci id="algorithm2.29.29.1.m1.3.4.3.3.cmml" xref="algorithm2.29.29.1.m1.3.4.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.29.29.1.m1.3c">(s,p,a)\in L_{s}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.29.29.1.m1.3d">( italic_s , italic_p , italic_a ) ∈ italic_L start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.29.29.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.36.45">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="algorithm2.36.45.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.36.45.2" style="color:#0000FF;">Formulate affixes by merging affix set’s  </span>
</div>
<div class="ltx_listingline" id="algorithm2.36.46">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="algorithm2.36.46.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.36.46.2" style="color:#0000FF;">own affixes and extra predicted affixes </span>
</div>
<div class="ltx_listingline" id="algorithm2.30.30">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="f\leftarrow\textnormal{{affixMerge}}(a,T_{f}^{{}^{\prime}})" class="ltx_Math" display="inline" id="algorithm2.30.30.m1.2"><semantics id="algorithm2.30.30.m1.2a"><mrow id="algorithm2.30.30.m1.2.2" xref="algorithm2.30.30.m1.2.2.cmml"><mi id="algorithm2.30.30.m1.2.2.3" xref="algorithm2.30.30.m1.2.2.3.cmml">f</mi><mo id="algorithm2.30.30.m1.2.2.2" stretchy="false" xref="algorithm2.30.30.m1.2.2.2.cmml">←</mo><mrow id="algorithm2.30.30.m1.2.2.1" xref="algorithm2.30.30.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.30.30.m1.2.2.1.3" xref="algorithm2.30.30.m1.2.2.1.3a.cmml">affixMerge</mtext><mo id="algorithm2.30.30.m1.2.2.1.2" xref="algorithm2.30.30.m1.2.2.1.2.cmml">⁢</mo><mrow id="algorithm2.30.30.m1.2.2.1.1.1" xref="algorithm2.30.30.m1.2.2.1.1.2.cmml"><mo id="algorithm2.30.30.m1.2.2.1.1.1.2" stretchy="false" xref="algorithm2.30.30.m1.2.2.1.1.2.cmml">(</mo><mi id="algorithm2.30.30.m1.1.1" xref="algorithm2.30.30.m1.1.1.cmml">a</mi><mo id="algorithm2.30.30.m1.2.2.1.1.1.3" xref="algorithm2.30.30.m1.2.2.1.1.2.cmml">,</mo><msubsup id="algorithm2.30.30.m1.2.2.1.1.1.1" xref="algorithm2.30.30.m1.2.2.1.1.1.1.cmml"><mi id="algorithm2.30.30.m1.2.2.1.1.1.1.2.2" xref="algorithm2.30.30.m1.2.2.1.1.1.1.2.2.cmml">T</mi><mi id="algorithm2.30.30.m1.2.2.1.1.1.1.2.3" xref="algorithm2.30.30.m1.2.2.1.1.1.1.2.3.cmml">f</mi><msup id="algorithm2.30.30.m1.2.2.1.1.1.1.3" xref="algorithm2.30.30.m1.2.2.1.1.1.1.3.cmml"><mi id="algorithm2.30.30.m1.2.2.1.1.1.1.3a" xref="algorithm2.30.30.m1.2.2.1.1.1.1.3.cmml"></mi><mo id="algorithm2.30.30.m1.2.2.1.1.1.1.3.1" xref="algorithm2.30.30.m1.2.2.1.1.1.1.3.1.cmml">′</mo></msup></msubsup><mo id="algorithm2.30.30.m1.2.2.1.1.1.4" stretchy="false" xref="algorithm2.30.30.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.30.30.m1.2b"><apply id="algorithm2.30.30.m1.2.2.cmml" xref="algorithm2.30.30.m1.2.2"><ci id="algorithm2.30.30.m1.2.2.2.cmml" xref="algorithm2.30.30.m1.2.2.2">←</ci><ci id="algorithm2.30.30.m1.2.2.3.cmml" xref="algorithm2.30.30.m1.2.2.3">𝑓</ci><apply id="algorithm2.30.30.m1.2.2.1.cmml" xref="algorithm2.30.30.m1.2.2.1"><times id="algorithm2.30.30.m1.2.2.1.2.cmml" xref="algorithm2.30.30.m1.2.2.1.2"></times><ci id="algorithm2.30.30.m1.2.2.1.3a.cmml" xref="algorithm2.30.30.m1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="algorithm2.30.30.m1.2.2.1.3.cmml" xref="algorithm2.30.30.m1.2.2.1.3">affixMerge</mtext></ci><interval closure="open" id="algorithm2.30.30.m1.2.2.1.1.2.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1"><ci id="algorithm2.30.30.m1.1.1.cmml" xref="algorithm2.30.30.m1.1.1">𝑎</ci><apply id="algorithm2.30.30.m1.2.2.1.1.1.1.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.30.30.m1.2.2.1.1.1.1.1.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1">superscript</csymbol><apply id="algorithm2.30.30.m1.2.2.1.1.1.1.2.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.30.30.m1.2.2.1.1.1.1.2.1.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm2.30.30.m1.2.2.1.1.1.1.2.2.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1.2.2">𝑇</ci><ci id="algorithm2.30.30.m1.2.2.1.1.1.1.2.3.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1.2.3">𝑓</ci></apply><apply id="algorithm2.30.30.m1.2.2.1.1.1.1.3.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1.3"><ci id="algorithm2.30.30.m1.2.2.1.1.1.1.3.1.cmml" xref="algorithm2.30.30.m1.2.2.1.1.1.1.3.1">′</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.30.30.m1.2c">f\leftarrow\textnormal{{affixMerge}}(a,T_{f}^{{}^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="algorithm2.30.30.m1.2d">italic_f ← affixMerge ( italic_a , italic_T start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.36.47">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_typewriter" id="algorithm2.36.47.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.36.47.2" style="color:#0000FF;">Call morphological synthesizer </span>
</div>
<div class="ltx_listingline" id="algorithm2.31.31">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="{surface\leftarrow\textnormal{{morphoSynthesis}}(s,f)}" class="ltx_Math" display="inline" id="algorithm2.31.31.m1.2"><semantics id="algorithm2.31.31.m1.2a"><mrow id="algorithm2.31.31.m1.2.3" xref="algorithm2.31.31.m1.2.3.cmml"><mrow id="algorithm2.31.31.m1.2.3.2" xref="algorithm2.31.31.m1.2.3.2.cmml"><mi id="algorithm2.31.31.m1.2.3.2.2" xref="algorithm2.31.31.m1.2.3.2.2.cmml">s</mi><mo id="algorithm2.31.31.m1.2.3.2.1" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.3" xref="algorithm2.31.31.m1.2.3.2.3.cmml">u</mi><mo id="algorithm2.31.31.m1.2.3.2.1a" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.4" xref="algorithm2.31.31.m1.2.3.2.4.cmml">r</mi><mo id="algorithm2.31.31.m1.2.3.2.1b" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.5" xref="algorithm2.31.31.m1.2.3.2.5.cmml">f</mi><mo id="algorithm2.31.31.m1.2.3.2.1c" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.6" xref="algorithm2.31.31.m1.2.3.2.6.cmml">a</mi><mo id="algorithm2.31.31.m1.2.3.2.1d" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.7" xref="algorithm2.31.31.m1.2.3.2.7.cmml">c</mi><mo id="algorithm2.31.31.m1.2.3.2.1e" xref="algorithm2.31.31.m1.2.3.2.1.cmml">⁢</mo><mi id="algorithm2.31.31.m1.2.3.2.8" xref="algorithm2.31.31.m1.2.3.2.8.cmml">e</mi></mrow><mo id="algorithm2.31.31.m1.2.3.1" stretchy="false" xref="algorithm2.31.31.m1.2.3.1.cmml">←</mo><mrow id="algorithm2.31.31.m1.2.3.3" xref="algorithm2.31.31.m1.2.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm2.31.31.m1.2.3.3.2" xref="algorithm2.31.31.m1.2.3.3.2a.cmml">morphoSynthesis</mtext><mo id="algorithm2.31.31.m1.2.3.3.1" xref="algorithm2.31.31.m1.2.3.3.1.cmml">⁢</mo><mrow id="algorithm2.31.31.m1.2.3.3.3.2" xref="algorithm2.31.31.m1.2.3.3.3.1.cmml"><mo id="algorithm2.31.31.m1.2.3.3.3.2.1" stretchy="false" xref="algorithm2.31.31.m1.2.3.3.3.1.cmml">(</mo><mi id="algorithm2.31.31.m1.1.1" xref="algorithm2.31.31.m1.1.1.cmml">s</mi><mo id="algorithm2.31.31.m1.2.3.3.3.2.2" xref="algorithm2.31.31.m1.2.3.3.3.1.cmml">,</mo><mi id="algorithm2.31.31.m1.2.2" xref="algorithm2.31.31.m1.2.2.cmml">f</mi><mo id="algorithm2.31.31.m1.2.3.3.3.2.3" stretchy="false" xref="algorithm2.31.31.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.31.31.m1.2b"><apply id="algorithm2.31.31.m1.2.3.cmml" xref="algorithm2.31.31.m1.2.3"><ci id="algorithm2.31.31.m1.2.3.1.cmml" xref="algorithm2.31.31.m1.2.3.1">←</ci><apply id="algorithm2.31.31.m1.2.3.2.cmml" xref="algorithm2.31.31.m1.2.3.2"><times id="algorithm2.31.31.m1.2.3.2.1.cmml" xref="algorithm2.31.31.m1.2.3.2.1"></times><ci id="algorithm2.31.31.m1.2.3.2.2.cmml" xref="algorithm2.31.31.m1.2.3.2.2">𝑠</ci><ci id="algorithm2.31.31.m1.2.3.2.3.cmml" xref="algorithm2.31.31.m1.2.3.2.3">𝑢</ci><ci id="algorithm2.31.31.m1.2.3.2.4.cmml" xref="algorithm2.31.31.m1.2.3.2.4">𝑟</ci><ci id="algorithm2.31.31.m1.2.3.2.5.cmml" xref="algorithm2.31.31.m1.2.3.2.5">𝑓</ci><ci id="algorithm2.31.31.m1.2.3.2.6.cmml" xref="algorithm2.31.31.m1.2.3.2.6">𝑎</ci><ci id="algorithm2.31.31.m1.2.3.2.7.cmml" xref="algorithm2.31.31.m1.2.3.2.7">𝑐</ci><ci id="algorithm2.31.31.m1.2.3.2.8.cmml" xref="algorithm2.31.31.m1.2.3.2.8">𝑒</ci></apply><apply id="algorithm2.31.31.m1.2.3.3.cmml" xref="algorithm2.31.31.m1.2.3.3"><times id="algorithm2.31.31.m1.2.3.3.1.cmml" xref="algorithm2.31.31.m1.2.3.3.1"></times><ci id="algorithm2.31.31.m1.2.3.3.2a.cmml" xref="algorithm2.31.31.m1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="algorithm2.31.31.m1.2.3.3.2.cmml" xref="algorithm2.31.31.m1.2.3.3.2">morphoSynthesis</mtext></ci><interval closure="open" id="algorithm2.31.31.m1.2.3.3.3.1.cmml" xref="algorithm2.31.31.m1.2.3.3.3.2"><ci id="algorithm2.31.31.m1.1.1.cmml" xref="algorithm2.31.31.m1.1.1">𝑠</ci><ci id="algorithm2.31.31.m1.2.2.cmml" xref="algorithm2.31.31.m1.2.2">𝑓</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.31.31.m1.2c">{surface\leftarrow\textnormal{{morphoSynthesis}}(s,f)}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.31.31.m1.2d">italic_s italic_u italic_r italic_f italic_a italic_c italic_e ← morphoSynthesis ( italic_s , italic_f )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.32.32">
<span class="ltx_tag ltx_tag_listingline">31</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm2.32.32.2">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.32.32.1"><math alttext="surface\neq\textnormal{{null}}" class="ltx_Math" display="inline" id="algorithm2.32.32.1.m1.1"><semantics id="algorithm2.32.32.1.m1.1a"><mrow id="algorithm2.32.32.1.m1.1.1" xref="algorithm2.32.32.1.m1.1.1.cmml"><mrow id="algorithm2.32.32.1.m1.1.1.2" xref="algorithm2.32.32.1.m1.1.1.2.cmml"><mi id="algorithm2.32.32.1.m1.1.1.2.2" xref="algorithm2.32.32.1.m1.1.1.2.2.cmml">s</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.3" xref="algorithm2.32.32.1.m1.1.1.2.3.cmml">u</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1a" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.4" xref="algorithm2.32.32.1.m1.1.1.2.4.cmml">r</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1b" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.5" xref="algorithm2.32.32.1.m1.1.1.2.5.cmml">f</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1c" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.6" xref="algorithm2.32.32.1.m1.1.1.2.6.cmml">a</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1d" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.7" xref="algorithm2.32.32.1.m1.1.1.2.7.cmml">c</mi><mo id="algorithm2.32.32.1.m1.1.1.2.1e" xref="algorithm2.32.32.1.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.32.32.1.m1.1.1.2.8" xref="algorithm2.32.32.1.m1.1.1.2.8.cmml">e</mi></mrow><mo id="algorithm2.32.32.1.m1.1.1.1" xref="algorithm2.32.32.1.m1.1.1.1.cmml">≠</mo><mtext class="ltx_mathvariant_monospace" id="algorithm2.32.32.1.m1.1.1.3" xref="algorithm2.32.32.1.m1.1.1.3b.cmml"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm2.32.32.1.m1.1.1.3.1nest">null</em></mtext></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.32.32.1.m1.1b"><apply id="algorithm2.32.32.1.m1.1.1.cmml" xref="algorithm2.32.32.1.m1.1.1"><neq id="algorithm2.32.32.1.m1.1.1.1.cmml" xref="algorithm2.32.32.1.m1.1.1.1"></neq><apply id="algorithm2.32.32.1.m1.1.1.2.cmml" xref="algorithm2.32.32.1.m1.1.1.2"><times id="algorithm2.32.32.1.m1.1.1.2.1.cmml" xref="algorithm2.32.32.1.m1.1.1.2.1"></times><ci id="algorithm2.32.32.1.m1.1.1.2.2.cmml" xref="algorithm2.32.32.1.m1.1.1.2.2">𝑠</ci><ci id="algorithm2.32.32.1.m1.1.1.2.3.cmml" xref="algorithm2.32.32.1.m1.1.1.2.3">𝑢</ci><ci id="algorithm2.32.32.1.m1.1.1.2.4.cmml" xref="algorithm2.32.32.1.m1.1.1.2.4">𝑟</ci><ci id="algorithm2.32.32.1.m1.1.1.2.5.cmml" xref="algorithm2.32.32.1.m1.1.1.2.5">𝑓</ci><ci id="algorithm2.32.32.1.m1.1.1.2.6.cmml" xref="algorithm2.32.32.1.m1.1.1.2.6">𝑎</ci><ci id="algorithm2.32.32.1.m1.1.1.2.7.cmml" xref="algorithm2.32.32.1.m1.1.1.2.7">𝑐</ci><ci id="algorithm2.32.32.1.m1.1.1.2.8.cmml" xref="algorithm2.32.32.1.m1.1.1.2.8">𝑒</ci></apply><ci id="algorithm2.32.32.1.m1.1.1.3b.cmml" xref="algorithm2.32.32.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="algorithm2.32.32.1.m1.1.1.3.cmml" xref="algorithm2.32.32.1.m1.1.1.3"><em class="ltx_emph ltx_font_typewriter ltx_font_upright" id="algorithm2.32.32.1.m1.1.1.3.1anest">null</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.32.32.1.m1.1c">surface\neq\textnormal{{null}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.32.32.1.m1.1d">italic_s italic_u italic_r italic_f italic_a italic_c italic_e ≠ null</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.32.32.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm2.33.33">
<span class="ltx_tag ltx_tag_listingline">32</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="R.append((surface,s,p,a,f,C_{g}[s,p,a]))" class="ltx_Math" display="inline" id="algorithm2.33.33.m1.9"><semantics id="algorithm2.33.33.m1.9a"><mrow id="algorithm2.33.33.m1.9.9.1" xref="algorithm2.33.33.m1.9.9.2.cmml"><mi id="algorithm2.33.33.m1.8.8" xref="algorithm2.33.33.m1.8.8.cmml">R</mi><mo id="algorithm2.33.33.m1.9.9.1.2" lspace="0em" rspace="0.167em" xref="algorithm2.33.33.m1.9.9.2a.cmml">.</mo><mrow id="algorithm2.33.33.m1.9.9.1.1" xref="algorithm2.33.33.m1.9.9.1.1.cmml"><mi id="algorithm2.33.33.m1.9.9.1.1.3" xref="algorithm2.33.33.m1.9.9.1.1.3.cmml">a</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.4" xref="algorithm2.33.33.m1.9.9.1.1.4.cmml">p</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2a" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.5" xref="algorithm2.33.33.m1.9.9.1.1.5.cmml">p</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2b" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.6" xref="algorithm2.33.33.m1.9.9.1.1.6.cmml">e</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2c" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.7" xref="algorithm2.33.33.m1.9.9.1.1.7.cmml">n</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2d" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.8" xref="algorithm2.33.33.m1.9.9.1.1.8.cmml">d</mi><mo id="algorithm2.33.33.m1.9.9.1.1.2e" xref="algorithm2.33.33.m1.9.9.1.1.2.cmml">⁢</mo><mrow id="algorithm2.33.33.m1.9.9.1.1.1.1" xref="algorithm2.33.33.m1.9.9.1.1.cmml"><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.2" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.cmml">(</mo><mrow id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml"><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.3" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">(</mo><mrow id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.3" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.3.cmml">u</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1a" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.4" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.4.cmml">r</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1b" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.5" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.5.cmml">f</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1c" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.6" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.6.cmml">a</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1d" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.7" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.7.cmml">c</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1e" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.8" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.8.cmml">e</mi></mrow><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.4" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">,</mo><mi id="algorithm2.33.33.m1.4.4" xref="algorithm2.33.33.m1.4.4.cmml">s</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.5" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">,</mo><mi id="algorithm2.33.33.m1.5.5" xref="algorithm2.33.33.m1.5.5.cmml">p</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.6" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">,</mo><mi id="algorithm2.33.33.m1.6.6" xref="algorithm2.33.33.m1.6.6.cmml">a</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.7" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">,</mo><mi id="algorithm2.33.33.m1.7.7" xref="algorithm2.33.33.m1.7.7.cmml">f</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.8" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">,</mo><mrow id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.cmml"><msub id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.cmml"><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.2.cmml">C</mi><mi id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.3" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.3.cmml">g</mi></msub><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.1" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml"><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2.1" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml">[</mo><mi id="algorithm2.33.33.m1.1.1" xref="algorithm2.33.33.m1.1.1.cmml">s</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2.2" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="algorithm2.33.33.m1.2.2" xref="algorithm2.33.33.m1.2.2.cmml">p</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2.3" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="algorithm2.33.33.m1.3.3" xref="algorithm2.33.33.m1.3.3.cmml">a</mi><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2.4" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.9" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="algorithm2.33.33.m1.9.9.1.1.1.1.3" stretchy="false" xref="algorithm2.33.33.m1.9.9.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.33.33.m1.9b"><apply id="algorithm2.33.33.m1.9.9.2.cmml" xref="algorithm2.33.33.m1.9.9.1"><csymbol cd="ambiguous" id="algorithm2.33.33.m1.9.9.2a.cmml" xref="algorithm2.33.33.m1.9.9.1.2">formulae-sequence</csymbol><ci id="algorithm2.33.33.m1.8.8.cmml" xref="algorithm2.33.33.m1.8.8">𝑅</ci><apply id="algorithm2.33.33.m1.9.9.1.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1"><times id="algorithm2.33.33.m1.9.9.1.1.2.cmml" xref="algorithm2.33.33.m1.9.9.1.1.2"></times><ci id="algorithm2.33.33.m1.9.9.1.1.3.cmml" xref="algorithm2.33.33.m1.9.9.1.1.3">𝑎</ci><ci id="algorithm2.33.33.m1.9.9.1.1.4.cmml" xref="algorithm2.33.33.m1.9.9.1.1.4">𝑝</ci><ci id="algorithm2.33.33.m1.9.9.1.1.5.cmml" xref="algorithm2.33.33.m1.9.9.1.1.5">𝑝</ci><ci id="algorithm2.33.33.m1.9.9.1.1.6.cmml" xref="algorithm2.33.33.m1.9.9.1.1.6">𝑒</ci><ci id="algorithm2.33.33.m1.9.9.1.1.7.cmml" xref="algorithm2.33.33.m1.9.9.1.1.7">𝑛</ci><ci id="algorithm2.33.33.m1.9.9.1.1.8.cmml" xref="algorithm2.33.33.m1.9.9.1.1.8">𝑑</ci><vector id="algorithm2.33.33.m1.9.9.1.1.1.1.1.3.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2"><apply id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1"><times id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.1"></times><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.2">𝑠</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.3">𝑢</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.4.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.4">𝑟</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.5.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.5">𝑓</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.6.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.6">𝑎</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.7.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.7">𝑐</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.8.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.1.1.8">𝑒</ci></apply><ci id="algorithm2.33.33.m1.4.4.cmml" xref="algorithm2.33.33.m1.4.4">𝑠</ci><ci id="algorithm2.33.33.m1.5.5.cmml" xref="algorithm2.33.33.m1.5.5">𝑝</ci><ci id="algorithm2.33.33.m1.6.6.cmml" xref="algorithm2.33.33.m1.6.6">𝑎</ci><ci id="algorithm2.33.33.m1.7.7.cmml" xref="algorithm2.33.33.m1.7.7">𝑓</ci><apply id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2"><times id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.1"></times><apply id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.2.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.2">𝐶</ci><ci id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.3.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.2.3">𝑔</ci></apply><list id="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.1.cmml" xref="algorithm2.33.33.m1.9.9.1.1.1.1.1.2.2.3.2"><ci id="algorithm2.33.33.m1.1.1.cmml" xref="algorithm2.33.33.m1.1.1">𝑠</ci><ci id="algorithm2.33.33.m1.2.2.cmml" xref="algorithm2.33.33.m1.2.2">𝑝</ci><ci id="algorithm2.33.33.m1.3.3.cmml" xref="algorithm2.33.33.m1.3.3">𝑎</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.33.33.m1.9c">R.append((surface,s,p,a,f,C_{g}[s,p,a]))</annotation><annotation encoding="application/x-llamapun" id="algorithm2.33.33.m1.9d">italic_R . italic_a italic_p italic_p italic_e italic_n italic_d ( ( italic_s italic_u italic_r italic_f italic_a italic_c italic_e , italic_s , italic_p , italic_a , italic_f , italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT [ italic_s , italic_p , italic_a ] ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.36.48">
<span class="ltx_tag ltx_tag_listingline">33</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.36.49">
<span class="ltx_tag ltx_tag_listingline">34</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm2.34.34">
<span class="ltx_tag ltx_tag_listingline">35</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm2.34.34.2">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.34.34.1"><math alttext="(pp-P_{g}[g])&gt;\beta" class="ltx_Math" display="inline" id="algorithm2.34.34.1.m1.2"><semantics id="algorithm2.34.34.1.m1.2a"><mrow id="algorithm2.34.34.1.m1.2.2" xref="algorithm2.34.34.1.m1.2.2.cmml"><mrow id="algorithm2.34.34.1.m1.2.2.1.1" xref="algorithm2.34.34.1.m1.2.2.1.1.1.cmml"><mo id="algorithm2.34.34.1.m1.2.2.1.1.2" stretchy="false" xref="algorithm2.34.34.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="algorithm2.34.34.1.m1.2.2.1.1.1" xref="algorithm2.34.34.1.m1.2.2.1.1.1.cmml"><mrow id="algorithm2.34.34.1.m1.2.2.1.1.1.2" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.cmml"><mi id="algorithm2.34.34.1.m1.2.2.1.1.1.2.2" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.2.cmml">p</mi><mo id="algorithm2.34.34.1.m1.2.2.1.1.1.2.1" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="algorithm2.34.34.1.m1.2.2.1.1.1.2.3" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.3.cmml">p</mi></mrow><mo id="algorithm2.34.34.1.m1.2.2.1.1.1.1" xref="algorithm2.34.34.1.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="algorithm2.34.34.1.m1.2.2.1.1.1.3" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.cmml"><msub id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.cmml"><mi id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.2" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.2.cmml">P</mi><mi id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.3" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.3.cmml">g</mi></msub><mo id="algorithm2.34.34.1.m1.2.2.1.1.1.3.1" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.2" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.1.cmml"><mo id="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.2.1" stretchy="false" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.1.1.cmml">[</mo><mi id="algorithm2.34.34.1.m1.1.1" xref="algorithm2.34.34.1.m1.1.1.cmml">g</mi><mo id="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.2.2" stretchy="false" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="algorithm2.34.34.1.m1.2.2.1.1.3" stretchy="false" xref="algorithm2.34.34.1.m1.2.2.1.1.1.cmml">)</mo></mrow><mo id="algorithm2.34.34.1.m1.2.2.2" xref="algorithm2.34.34.1.m1.2.2.2.cmml">&gt;</mo><mi id="algorithm2.34.34.1.m1.2.2.3" xref="algorithm2.34.34.1.m1.2.2.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.34.34.1.m1.2b"><apply id="algorithm2.34.34.1.m1.2.2.cmml" xref="algorithm2.34.34.1.m1.2.2"><gt id="algorithm2.34.34.1.m1.2.2.2.cmml" xref="algorithm2.34.34.1.m1.2.2.2"></gt><apply id="algorithm2.34.34.1.m1.2.2.1.1.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1"><minus id="algorithm2.34.34.1.m1.2.2.1.1.1.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.1"></minus><apply id="algorithm2.34.34.1.m1.2.2.1.1.1.2.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2"><times id="algorithm2.34.34.1.m1.2.2.1.1.1.2.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.1"></times><ci id="algorithm2.34.34.1.m1.2.2.1.1.1.2.2.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.2">𝑝</ci><ci id="algorithm2.34.34.1.m1.2.2.1.1.1.2.3.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.2.3">𝑝</ci></apply><apply id="algorithm2.34.34.1.m1.2.2.1.1.1.3.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3"><times id="algorithm2.34.34.1.m1.2.2.1.1.1.3.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.1"></times><apply id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.2.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.2">𝑃</ci><ci id="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.3.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.2.3">𝑔</ci></apply><apply id="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.2"><csymbol cd="latexml" id="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.1.1.cmml" xref="algorithm2.34.34.1.m1.2.2.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="algorithm2.34.34.1.m1.1.1.cmml" xref="algorithm2.34.34.1.m1.1.1">𝑔</ci></apply></apply></apply><ci id="algorithm2.34.34.1.m1.2.2.3.cmml" xref="algorithm2.34.34.1.m1.2.2.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.34.34.1.m1.2c">(pp-P_{g}[g])&gt;\beta</annotation><annotation encoding="application/x-llamapun" id="algorithm2.34.34.1.m1.2d">( italic_p italic_p - italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT [ italic_g ] ) &gt; italic_β</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.34.34.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm2.36.50">
<span class="ltx_tag ltx_tag_listingline">36</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
break

</div>
<div class="ltx_listingline" id="algorithm2.35.35">
<span class="ltx_tag ltx_tag_listingline">37</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="pp\leftarrow P_{g}[g]" class="ltx_Math" display="inline" id="algorithm2.35.35.m1.1"><semantics id="algorithm2.35.35.m1.1a"><mrow id="algorithm2.35.35.m1.1.2" xref="algorithm2.35.35.m1.1.2.cmml"><mrow id="algorithm2.35.35.m1.1.2.2" xref="algorithm2.35.35.m1.1.2.2.cmml"><mi id="algorithm2.35.35.m1.1.2.2.2" xref="algorithm2.35.35.m1.1.2.2.2.cmml">p</mi><mo id="algorithm2.35.35.m1.1.2.2.1" xref="algorithm2.35.35.m1.1.2.2.1.cmml">⁢</mo><mi id="algorithm2.35.35.m1.1.2.2.3" xref="algorithm2.35.35.m1.1.2.2.3.cmml">p</mi></mrow><mo id="algorithm2.35.35.m1.1.2.1" stretchy="false" xref="algorithm2.35.35.m1.1.2.1.cmml">←</mo><mrow id="algorithm2.35.35.m1.1.2.3" xref="algorithm2.35.35.m1.1.2.3.cmml"><msub id="algorithm2.35.35.m1.1.2.3.2" xref="algorithm2.35.35.m1.1.2.3.2.cmml"><mi id="algorithm2.35.35.m1.1.2.3.2.2" xref="algorithm2.35.35.m1.1.2.3.2.2.cmml">P</mi><mi id="algorithm2.35.35.m1.1.2.3.2.3" xref="algorithm2.35.35.m1.1.2.3.2.3.cmml">g</mi></msub><mo id="algorithm2.35.35.m1.1.2.3.1" xref="algorithm2.35.35.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm2.35.35.m1.1.2.3.3.2" xref="algorithm2.35.35.m1.1.2.3.3.1.cmml"><mo id="algorithm2.35.35.m1.1.2.3.3.2.1" stretchy="false" xref="algorithm2.35.35.m1.1.2.3.3.1.1.cmml">[</mo><mi id="algorithm2.35.35.m1.1.1" xref="algorithm2.35.35.m1.1.1.cmml">g</mi><mo id="algorithm2.35.35.m1.1.2.3.3.2.2" stretchy="false" xref="algorithm2.35.35.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.35.35.m1.1b"><apply id="algorithm2.35.35.m1.1.2.cmml" xref="algorithm2.35.35.m1.1.2"><ci id="algorithm2.35.35.m1.1.2.1.cmml" xref="algorithm2.35.35.m1.1.2.1">←</ci><apply id="algorithm2.35.35.m1.1.2.2.cmml" xref="algorithm2.35.35.m1.1.2.2"><times id="algorithm2.35.35.m1.1.2.2.1.cmml" xref="algorithm2.35.35.m1.1.2.2.1"></times><ci id="algorithm2.35.35.m1.1.2.2.2.cmml" xref="algorithm2.35.35.m1.1.2.2.2">𝑝</ci><ci id="algorithm2.35.35.m1.1.2.2.3.cmml" xref="algorithm2.35.35.m1.1.2.2.3">𝑝</ci></apply><apply id="algorithm2.35.35.m1.1.2.3.cmml" xref="algorithm2.35.35.m1.1.2.3"><times id="algorithm2.35.35.m1.1.2.3.1.cmml" xref="algorithm2.35.35.m1.1.2.3.1"></times><apply id="algorithm2.35.35.m1.1.2.3.2.cmml" xref="algorithm2.35.35.m1.1.2.3.2"><csymbol cd="ambiguous" id="algorithm2.35.35.m1.1.2.3.2.1.cmml" xref="algorithm2.35.35.m1.1.2.3.2">subscript</csymbol><ci id="algorithm2.35.35.m1.1.2.3.2.2.cmml" xref="algorithm2.35.35.m1.1.2.3.2.2">𝑃</ci><ci id="algorithm2.35.35.m1.1.2.3.2.3.cmml" xref="algorithm2.35.35.m1.1.2.3.2.3">𝑔</ci></apply><apply id="algorithm2.35.35.m1.1.2.3.3.1.cmml" xref="algorithm2.35.35.m1.1.2.3.3.2"><csymbol cd="latexml" id="algorithm2.35.35.m1.1.2.3.3.1.1.cmml" xref="algorithm2.35.35.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="algorithm2.35.35.m1.1.1.cmml" xref="algorithm2.35.35.m1.1.1">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.35.35.m1.1c">pp\leftarrow P_{g}[g]</annotation><annotation encoding="application/x-llamapun" id="algorithm2.35.35.m1.1d">italic_p italic_p ← italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT [ italic_g ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.36.51">
<span class="ltx_tag ltx_tag_listingline">38</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end foreach
</div>
<div class="ltx_listingline" id="algorithm2.36.36">
<span class="ltx_tag ltx_tag_listingline">39</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm2.36.36.2">return</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.36.36.1"><math alttext="R" class="ltx_Math" display="inline" id="algorithm2.36.36.1.m1.1"><semantics id="algorithm2.36.36.1.m1.1a"><mi id="algorithm2.36.36.1.m1.1.1" xref="algorithm2.36.36.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm2.36.36.1.m1.1b"><ci id="algorithm2.36.36.1.m1.1.1.cmml" xref="algorithm2.36.36.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.36.36.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="algorithm2.36.36.1.m1.1d">italic_R</annotation></semantics></math></em>
</div>
<div class="ltx_listingline" id="algorithm2.36.52">
<span class="ltx_tag ltx_tag_listingline">40</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_typewriter" id="algorithm2.36.52.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.36.52.2" style="color:#0000FF;">The returned inflections will be added to the beam  </span>
</div>
<div class="ltx_listingline" id="algorithm2.36.53">
<span class="ltx_tag ltx_tag_listingline">41</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="algorithm2.36.53.1" style="color:#0000FF;">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm2.36.53.2" style="color:#0000FF;">for beam search-based decoding. </span>
</div>
<div class="ltx_listingline" id="algorithm2.36.54">
<span class="ltx_tag ltx_tag_listingline">42</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.36.55">
<span class="ltx_tag ltx_tag_listingline">43</span>
</div>
<div class="ltx_listingline" id="algorithm2.36.56">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm2.38.1.1">Algorithm 2</span> </span>Inflection generation</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu May  2 17:12:00 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
