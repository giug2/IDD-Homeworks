<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2004.11791] Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS.</title><meta property="og:description" content="Federated learning (FL) is a well established method for performing machine learning tasks over massively distributed data. However in settings where data is distributed in a non-iid (not independent and identically diâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2004.11791">

<!--Generated on Sun Mar 17 06:26:46 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
federated learning,  distributed machine learning,  clustering applications
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated learning with hierarchical clustering of local updates to improve training on non-IID data
<br class="ltx_break"><span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">thanks: </span>This work is supported by the SEND project (grant ref.Â 32R16P00706) funded by ERDF and BEIS.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Christopher Briggs
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_font_italic">School of Computing &amp; Mathematics</span>
<br class="ltx_break"><span id="id3.2.id2" class="ltx_text ltx_font_italic">Keele University
<br class="ltx_break"></span>Keele, UK 
<br class="ltx_break">c.briggs@keele.ac.uk
</span></span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhong Fan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_font_italic">School of Computing &amp; Mathematics</span>
<br class="ltx_break"><span id="id5.2.id2" class="ltx_text ltx_font_italic">Keele University
<br class="ltx_break"></span>Keele, UK 
<br class="ltx_break">z.fan@keele.ac.uk
</span></span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peter Andras
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id6.1.id1" class="ltx_text ltx_font_italic">School of Computing &amp; Mathematics</span>
<br class="ltx_break"><span id="id7.2.id2" class="ltx_text ltx_font_italic">Keele University
<br class="ltx_break"></span>Keele, UK 
<br class="ltx_break">p.andras@keele.ac.uk
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">Federated learning (FL) is a well established method for performing machine learning tasks over massively distributed data. However in settings where data is distributed in a non-iid (not independent and identically distributed) fashion - as is typical in real world situations - the joint model produced by FL suffers in terms of test set accuracy and/or communication costs compared to training on iid data. We show that learning a single joint model is often not optimal in the presence of certain types of non-iid data. In this work we present a modification to FL by introducing a hierarchical clustering step (FL+HC) to separate clusters of clients by the similarity of their local updates to the global joint model. Once separated, the clusters are trained independently and in parallel on specialised models. We present a robust empirical analysis of the hyperparameters for FL+HC for several iid and non-iid settings. We show how FL+HC allows model training to converge in fewer communication rounds (significantly so under some non-iid settings) compared to FL without clustering. Additionally, FL+HC allows for a greater percentage of clients to reach a target accuracy compared to standard FL. Finally we make suggestions for good default hyperparameters to promote superior performing specialised models without modifying the the underlying federated learning communication protocol.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
federated learning, distributed machine learning, clustering applications

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction &amp; Background</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The machine learning setting known as federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> allows for local learners to participate in training a joint statistical model <math id="S1.p1.1.m1.1" class="ltx_Math" alttext="f(w)" display="inline"><semantics id="S1.p1.1.m1.1a"><mrow id="S1.p1.1.m1.1.2" xref="S1.p1.1.m1.1.2.cmml"><mi id="S1.p1.1.m1.1.2.2" xref="S1.p1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S1.p1.1.m1.1.2.1" xref="S1.p1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S1.p1.1.m1.1.2.3.2" xref="S1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S1.p1.1.m1.1.2.3.2.1" xref="S1.p1.1.m1.1.2.cmml">(</mo><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S1.p1.1.m1.1.2.3.2.2" xref="S1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.2.cmml" xref="S1.p1.1.m1.1.2"><times id="S1.p1.1.m1.1.2.1.cmml" xref="S1.p1.1.m1.1.2.1"></times><ci id="S1.p1.1.m1.1.2.2.cmml" xref="S1.p1.1.m1.1.2.2">ğ‘“</ci><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">f(w)</annotation></semantics></math> on massively distributed data. This is useful in situations where data cannot be gathered into a single location for legal or privacy reasons.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.2" class="ltx_p">The most common setting for FL employs a central entity for aggregating local learner models from many clients. These clients are typically mobile and Internet-of-Things devices. During training, a fraction of the clients are sent the current state of the global model <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S1.p2.1.m1.1a"><msub id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">w</mi><mi id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1">subscript</csymbol><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">ğ‘¤</ci><ci id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">w_{t}</annotation></semantics></math>. Using only the data available to the client, a training procedure (defined by the central entity) is run locally to work towards minimising some local objective <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="F_{k}(w_{t})" display="inline"><semantics id="S1.p2.2.m2.1a"><mrow id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><msub id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml"><mi id="S1.p2.2.m2.1.1.3.2" xref="S1.p2.2.m2.1.1.3.2.cmml">F</mi><mi id="S1.p2.2.m2.1.1.3.3" xref="S1.p2.2.m2.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">â€‹</mo><mrow id="S1.p2.2.m2.1.1.1.1" xref="S1.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p2.2.m2.1.1.1.1.2" xref="S1.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S1.p2.2.m2.1.1.1.1.1" xref="S1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S1.p2.2.m2.1.1.1.1.1.2" xref="S1.p2.2.m2.1.1.1.1.1.2.cmml">w</mi><mi id="S1.p2.2.m2.1.1.1.1.1.3" xref="S1.p2.2.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S1.p2.2.m2.1.1.1.1.3" xref="S1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><times id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2"></times><apply id="S1.p2.2.m2.1.1.3.cmml" xref="S1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.3.1.cmml" xref="S1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S1.p2.2.m2.1.1.3.2.cmml" xref="S1.p2.2.m2.1.1.3.2">ğ¹</ci><ci id="S1.p2.2.m2.1.1.3.3.cmml" xref="S1.p2.2.m2.1.1.3.3">ğ‘˜</ci></apply><apply id="S1.p2.2.m2.1.1.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S1.p2.2.m2.1.1.1.1.1.2">ğ‘¤</ci><ci id="S1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S1.p2.2.m2.1.1.1.1.1.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">F_{k}(w_{t})</annotation></semantics></math>. For example, training a neural network model for image classification, the stochastic gradient descent (SGD) algorithm could be run on the client to iteratively minimise the classification error over all training images available to the client.</p>
</div>
<div id="S1.p3" class="ltx_para">
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow w_{t}-\eta\nabla F_{k}(w_{t})." display="block"><semantics id="S1.E1.m1.1a"><mrow id="S1.E1.m1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml"><mrow id="S1.E1.m1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml"><msubsup id="S1.E1.m1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.3.cmml"><mi id="S1.E1.m1.1.1.1.1.3.2.2" xref="S1.E1.m1.1.1.1.1.3.2.2.cmml">w</mi><mrow id="S1.E1.m1.1.1.1.1.3.2.3" xref="S1.E1.m1.1.1.1.1.3.2.3.cmml"><mi id="S1.E1.m1.1.1.1.1.3.2.3.2" xref="S1.E1.m1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="S1.E1.m1.1.1.1.1.3.2.3.1" xref="S1.E1.m1.1.1.1.1.3.2.3.1.cmml">+</mo><mn id="S1.E1.m1.1.1.1.1.3.2.3.3" xref="S1.E1.m1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.1.1.1.1.3.3" xref="S1.E1.m1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="S1.E1.m1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.2.cmml">â†</mo><mrow id="S1.E1.m1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.cmml"><msub id="S1.E1.m1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.3.cmml"><mi id="S1.E1.m1.1.1.1.1.1.3.2" xref="S1.E1.m1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S1.E1.m1.1.1.1.1.1.3.3" xref="S1.E1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S1.E1.m1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.2.cmml">âˆ’</mo><mrow id="S1.E1.m1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.3.cmml">Î·</mi><mo lspace="0.167em" rspace="0em" id="S1.E1.m1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S1.E1.m1.1.1.1.1.1.1.4" xref="S1.E1.m1.1.1.1.1.1.1.4.cmml"><mo rspace="0.167em" id="S1.E1.m1.1.1.1.1.1.1.4.1" xref="S1.E1.m1.1.1.1.1.1.1.4.1.cmml">âˆ‡</mo><msub id="S1.E1.m1.1.1.1.1.1.1.4.2" xref="S1.E1.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1.4.2.2" xref="S1.E1.m1.1.1.1.1.1.1.4.2.2.cmml">F</mi><mi id="S1.E1.m1.1.1.1.1.1.1.4.2.3" xref="S1.E1.m1.1.1.1.1.1.1.4.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S1.E1.m1.1.1.1.1.1.1.2a" xref="S1.E1.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S1.E1.m1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.E1.m1.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S1.E1.m1.1.1.1.1.1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S1.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S1.E1.m1.1.1.1.1.1.1.1.1.3" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S1.E1.m1.1.1.1.2" xref="S1.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.1b"><apply id="S1.E1.m1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1"><ci id="S1.E1.m1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.2">â†</ci><apply id="S1.E1.m1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.1.1.1.1.3">superscript</csymbol><apply id="S1.E1.m1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.3.2.1.cmml" xref="S1.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.1.1.1.1.3.2.2.cmml" xref="S1.E1.m1.1.1.1.1.3.2.2">ğ‘¤</ci><apply id="S1.E1.m1.1.1.1.1.3.2.3.cmml" xref="S1.E1.m1.1.1.1.1.3.2.3"><plus id="S1.E1.m1.1.1.1.1.3.2.3.1.cmml" xref="S1.E1.m1.1.1.1.1.3.2.3.1"></plus><ci id="S1.E1.m1.1.1.1.1.3.2.3.2.cmml" xref="S1.E1.m1.1.1.1.1.3.2.3.2">ğ‘¡</ci><cn type="integer" id="S1.E1.m1.1.1.1.1.3.2.3.3.cmml" xref="S1.E1.m1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.1.1.1.1.3.3">ğ‘˜</ci></apply><apply id="S1.E1.m1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1"><minus id="S1.E1.m1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.2"></minus><apply id="S1.E1.m1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.1.1.1.1.1.3.2">ğ‘¤</ci><ci id="S1.E1.m1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.1.1.1.1.1.3.3">ğ‘¡</ci></apply><apply id="S1.E1.m1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1"><times id="S1.E1.m1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.2"></times><ci id="S1.E1.m1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.3">ğœ‚</ci><apply id="S1.E1.m1.1.1.1.1.1.1.4.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4"><ci id="S1.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4.1">âˆ‡</ci><apply id="S1.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S1.E1.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4.2.2">ğ¹</ci><ci id="S1.E1.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.4.2.3">ğ‘˜</ci></apply></apply><apply id="S1.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.2">ğ‘¤</ci><ci id="S1.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.1.1.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.1c">w_{t+1}^{k}\leftarrow w_{t}-\eta\nabla F_{k}(w_{t}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.4" class="ltx_p">The resulting model <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}" display="inline"><semantics id="S1.p4.1.m1.1a"><msubsup id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2.2" xref="S1.p4.1.m1.1.1.2.2.cmml">w</mi><mrow id="S1.p4.1.m1.1.1.2.3" xref="S1.p4.1.m1.1.1.2.3.cmml"><mi id="S1.p4.1.m1.1.1.2.3.2" xref="S1.p4.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S1.p4.1.m1.1.1.2.3.1" xref="S1.p4.1.m1.1.1.2.3.1.cmml">+</mo><mn id="S1.p4.1.m1.1.1.2.3.3" xref="S1.p4.1.m1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">superscript</csymbol><apply id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.2.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.2.cmml" xref="S1.p4.1.m1.1.1.2.2">ğ‘¤</ci><apply id="S1.p4.1.m1.1.1.2.3.cmml" xref="S1.p4.1.m1.1.1.2.3"><plus id="S1.p4.1.m1.1.1.2.3.1.cmml" xref="S1.p4.1.m1.1.1.2.3.1"></plus><ci id="S1.p4.1.m1.1.1.2.3.2.cmml" xref="S1.p4.1.m1.1.1.2.3.2">ğ‘¡</ci><cn type="integer" id="S1.p4.1.m1.1.1.2.3.3.cmml" xref="S1.p4.1.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">w_{t+1}^{k}</annotation></semantics></math> from each client <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="S1.p4.2.m2.1a"><mrow id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">k</mi><mo id="S1.p4.2.m2.1.1.1" xref="S1.p4.2.m2.1.1.1.cmml">âˆˆ</mo><mi id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><in id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1.1"></in><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">ğ‘˜</ci><ci id="S1.p4.2.m2.1.1.3.cmml" xref="S1.p4.2.m2.1.1.3">ğ¾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">k\in K</annotation></semantics></math> is sent back to the central entity where all local models are aggregated in some fashion. The commonly used FederatedAveraging algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> performs a data-weighted average over the parameters of all models to form a new global model <math id="S1.p4.3.m3.1" class="ltx_Math" alttext="w_{t+1}" display="inline"><semantics id="S1.p4.3.m3.1a"><msub id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">w</mi><mrow id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml"><mi id="S1.p4.3.m3.1.1.3.2" xref="S1.p4.3.m3.1.1.3.2.cmml">t</mi><mo id="S1.p4.3.m3.1.1.3.1" xref="S1.p4.3.m3.1.1.3.1.cmml">+</mo><mn id="S1.p4.3.m3.1.1.3.3" xref="S1.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.3.m3.1.1.1.cmml" xref="S1.p4.3.m3.1.1">subscript</csymbol><ci id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2">ğ‘¤</ci><apply id="S1.p4.3.m3.1.1.3.cmml" xref="S1.p4.3.m3.1.1.3"><plus id="S1.p4.3.m3.1.1.3.1.cmml" xref="S1.p4.3.m3.1.1.3.1"></plus><ci id="S1.p4.3.m3.1.1.3.2.cmml" xref="S1.p4.3.m3.1.1.3.2">ğ‘¡</ci><cn type="integer" id="S1.p4.3.m3.1.1.3.3.cmml" xref="S1.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">w_{t+1}</annotation></semantics></math> ready for the next round of training (<math id="S1.p4.4.m4.1" class="ltx_Math" alttext="n_{k}/n" display="inline"><semantics id="S1.p4.4.m4.1a"><mrow id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><msub id="S1.p4.4.m4.1.1.2" xref="S1.p4.4.m4.1.1.2.cmml"><mi id="S1.p4.4.m4.1.1.2.2" xref="S1.p4.4.m4.1.1.2.2.cmml">n</mi><mi id="S1.p4.4.m4.1.1.2.3" xref="S1.p4.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S1.p4.4.m4.1.1.1" xref="S1.p4.4.m4.1.1.1.cmml">/</mo><mi id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><divide id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1.1"></divide><apply id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.2.1.cmml" xref="S1.p4.4.m4.1.1.2">subscript</csymbol><ci id="S1.p4.4.m4.1.1.2.2.cmml" xref="S1.p4.4.m4.1.1.2.2">ğ‘›</ci><ci id="S1.p4.4.m4.1.1.2.3.cmml" xref="S1.p4.4.m4.1.1.2.3">ğ‘˜</ci></apply><ci id="S1.p4.4.m4.1.1.3.cmml" xref="S1.p4.4.m4.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">n_{k}/n</annotation></semantics></math> is the number of samples available to client k versus all samples).</p>
</div>
<div id="S1.p5" class="ltx_para">
<table id="S1.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E2.m1.1" class="ltx_Math" alttext="w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}." display="block"><semantics id="S1.E2.m1.1a"><mrow id="S1.E2.m1.1.1.1" xref="S1.E2.m1.1.1.1.1.cmml"><mrow id="S1.E2.m1.1.1.1.1" xref="S1.E2.m1.1.1.1.1.cmml"><msub id="S1.E2.m1.1.1.1.1.2" xref="S1.E2.m1.1.1.1.1.2.cmml"><mi id="S1.E2.m1.1.1.1.1.2.2" xref="S1.E2.m1.1.1.1.1.2.2.cmml">w</mi><mrow id="S1.E2.m1.1.1.1.1.2.3" xref="S1.E2.m1.1.1.1.1.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.2.3.2" xref="S1.E2.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S1.E2.m1.1.1.1.1.2.3.1" xref="S1.E2.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S1.E2.m1.1.1.1.1.2.3.3" xref="S1.E2.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="S1.E2.m1.1.1.1.1.1" xref="S1.E2.m1.1.1.1.1.1.cmml">â†</mo><mrow id="S1.E2.m1.1.1.1.1.3" xref="S1.E2.m1.1.1.1.1.3.cmml"><munderover id="S1.E2.m1.1.1.1.1.3.1" xref="S1.E2.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S1.E2.m1.1.1.1.1.3.1.2.2" xref="S1.E2.m1.1.1.1.1.3.1.2.2.cmml">âˆ‘</mo><mrow id="S1.E2.m1.1.1.1.1.3.1.2.3" xref="S1.E2.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.3.1.2.3.2" xref="S1.E2.m1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S1.E2.m1.1.1.1.1.3.1.2.3.1" xref="S1.E2.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S1.E2.m1.1.1.1.1.3.1.2.3.3" xref="S1.E2.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E2.m1.1.1.1.1.3.1.3" xref="S1.E2.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S1.E2.m1.1.1.1.1.3.2" xref="S1.E2.m1.1.1.1.1.3.2.cmml"><mfrac id="S1.E2.m1.1.1.1.1.3.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.cmml"><msub id="S1.E2.m1.1.1.1.1.3.2.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.2.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S1.E2.m1.1.1.1.1.3.2.2.2.3" xref="S1.E2.m1.1.1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="S1.E2.m1.1.1.1.1.3.2.2.3" xref="S1.E2.m1.1.1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S1.E2.m1.1.1.1.1.3.2.1" xref="S1.E2.m1.1.1.1.1.3.2.1.cmml">â€‹</mo><msubsup id="S1.E2.m1.1.1.1.1.3.2.3" xref="S1.E2.m1.1.1.1.1.3.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.3.2.2" xref="S1.E2.m1.1.1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="S1.E2.m1.1.1.1.1.3.2.3.2.3" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.3.2.3.2" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="S1.E2.m1.1.1.1.1.3.2.3.2.3.1" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="S1.E2.m1.1.1.1.1.3.2.3.2.3.3" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S1.E2.m1.1.1.1.1.3.2.3.3" xref="S1.E2.m1.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S1.E2.m1.1.1.1.2" xref="S1.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E2.m1.1b"><apply id="S1.E2.m1.1.1.1.1.cmml" xref="S1.E2.m1.1.1.1"><ci id="S1.E2.m1.1.1.1.1.1.cmml" xref="S1.E2.m1.1.1.1.1.1">â†</ci><apply id="S1.E2.m1.1.1.1.1.2.cmml" xref="S1.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.2.1.cmml" xref="S1.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S1.E2.m1.1.1.1.1.2.2.cmml" xref="S1.E2.m1.1.1.1.1.2.2">ğ‘¤</ci><apply id="S1.E2.m1.1.1.1.1.2.3.cmml" xref="S1.E2.m1.1.1.1.1.2.3"><plus id="S1.E2.m1.1.1.1.1.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.2.3.1"></plus><ci id="S1.E2.m1.1.1.1.1.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.2.3.2">ğ‘¡</ci><cn type="integer" id="S1.E2.m1.1.1.1.1.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S1.E2.m1.1.1.1.1.3.cmml" xref="S1.E2.m1.1.1.1.1.3"><apply id="S1.E2.m1.1.1.1.1.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.1.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S1.E2.m1.1.1.1.1.3.1.2.cmml" xref="S1.E2.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.1.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S1.E2.m1.1.1.1.1.3.1.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2.2"></sum><apply id="S1.E2.m1.1.1.1.1.3.1.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2.3"><eq id="S1.E2.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S1.E2.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2.3.2">ğ‘˜</ci><cn type="integer" id="S1.E2.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S1.E2.m1.1.1.1.1.3.1.3.cmml" xref="S1.E2.m1.1.1.1.1.3.1.3">ğ¾</ci></apply><apply id="S1.E2.m1.1.1.1.1.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2"><times id="S1.E2.m1.1.1.1.1.3.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.1"></times><apply id="S1.E2.m1.1.1.1.1.3.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2"><divide id="S1.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2"></divide><apply id="S1.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S1.E2.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2.2">ğ‘›</ci><ci id="S1.E2.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2.3">ğ‘˜</ci></apply><ci id="S1.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.3">ğ‘›</ci></apply><apply id="S1.E2.m1.1.1.1.1.3.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S1.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S1.E2.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.2">ğ‘¤</ci><apply id="S1.E2.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3"><plus id="S1.E2.m1.1.1.1.1.3.2.3.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.1"></plus><ci id="S1.E2.m1.1.1.1.1.3.2.3.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.2">ğ‘¡</ci><cn type="integer" id="S1.E2.m1.1.1.1.1.3.2.3.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S1.E2.m1.1.1.1.1.3.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.3">ğ‘˜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E2.m1.1c">w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Clients can perform one or multiple steps of gradient descent before sending weight updates as orchestrated by the federated algorithm.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">FL has been shown to work well in situations where the data is distributed in an independent and identically distributed (iid) fashion. However, in a typical scenario where data is massively distributed among clients, that data is likely to be unbalanced and non-iid. In this work we explore different non-iid data distributions and apply a hierarchical clustering algorithm to determine client similarity. In this way we can train multiple disjoint models that are targeted to clusters of similar clients with the intention to improve the performance of the training objective for all clients whilst reducing communication in the FL protocol.</p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S1.SS1.5.1.1" class="ltx_text">I-A</span> </span><span id="S1.SS1.6.2" class="ltx_text ltx_font_italic">Contributions</span>
</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p">Our contributions through this work include:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A method for training specialised models for subsets of clients that can increase test set accuracy whilst reducing the number of communication rounds required to reach convergence. This is achieved by clustering the clients by similarity based on their updates to the global joint model after a set number of communication rounds.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A full characterisation of how hierarchical clustering affects test set accuracy when applied during FL training in iid and various non-iid settings.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">An empirical analysis of the effect that varying hyperparameters for FL and the hierarchical clustering algorithm has on forming good specialised models for subsets of clients.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Recommendations for good default hyperparameters to use for training with our method when the non-iid nature of the data is unknown (as is likely to be the case when using FL).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S1.SS2.5.1.1" class="ltx_text">I-B</span> </span><span id="S1.SS2.6.2" class="ltx_text ltx_font_italic">Client statistical heterogeneity</span>
</h3>

<div id="S1.SS2.p1" class="ltx_para">
<p id="S1.SS2.p1.6" class="ltx_p">One of the fundamental challenges for training a single joint model under FL is the presence of non-iid data. There should be no assumption that clients have access to data drawn independently from the same underlying distribution - <math id="S1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}\neq\mathcal{P}_{j}" display="inline"><semantics id="S1.SS2.p1.1.m1.1a"><mrow id="S1.SS2.p1.1.m1.1.1" xref="S1.SS2.p1.1.m1.1.1.cmml"><msub id="S1.SS2.p1.1.m1.1.1.2" xref="S1.SS2.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS2.p1.1.m1.1.1.2.2" xref="S1.SS2.p1.1.m1.1.1.2.2.cmml">ğ’«</mi><mi id="S1.SS2.p1.1.m1.1.1.2.3" xref="S1.SS2.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S1.SS2.p1.1.m1.1.1.1" xref="S1.SS2.p1.1.m1.1.1.1.cmml">â‰ </mo><msub id="S1.SS2.p1.1.m1.1.1.3" xref="S1.SS2.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS2.p1.1.m1.1.1.3.2" xref="S1.SS2.p1.1.m1.1.1.3.2.cmml">ğ’«</mi><mi id="S1.SS2.p1.1.m1.1.1.3.3" xref="S1.SS2.p1.1.m1.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.1.m1.1b"><apply id="S1.SS2.p1.1.m1.1.1.cmml" xref="S1.SS2.p1.1.m1.1.1"><neq id="S1.SS2.p1.1.m1.1.1.1.cmml" xref="S1.SS2.p1.1.m1.1.1.1"></neq><apply id="S1.SS2.p1.1.m1.1.1.2.cmml" xref="S1.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S1.SS2.p1.1.m1.1.1.2.1.cmml" xref="S1.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S1.SS2.p1.1.m1.1.1.2.2.cmml" xref="S1.SS2.p1.1.m1.1.1.2.2">ğ’«</ci><ci id="S1.SS2.p1.1.m1.1.1.2.3.cmml" xref="S1.SS2.p1.1.m1.1.1.2.3">ğ‘–</ci></apply><apply id="S1.SS2.p1.1.m1.1.1.3.cmml" xref="S1.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.SS2.p1.1.m1.1.1.3.1.cmml" xref="S1.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S1.SS2.p1.1.m1.1.1.3.2.cmml" xref="S1.SS2.p1.1.m1.1.1.3.2">ğ’«</ci><ci id="S1.SS2.p1.1.m1.1.1.3.3.cmml" xref="S1.SS2.p1.1.m1.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.1.m1.1c">\mathcal{P}_{i}\neq\mathcal{P}_{j}</annotation></semantics></math> for all pairs of clients <math id="S1.SS2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.SS2.p1.2.m2.1a"><mi id="S1.SS2.p1.2.m2.1.1" xref="S1.SS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.2.m2.1b"><ci id="S1.SS2.p1.2.m2.1.1.cmml" xref="S1.SS2.p1.2.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.2.m2.1c">i</annotation></semantics></math> and <math id="S1.SS2.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S1.SS2.p1.3.m3.1a"><mi id="S1.SS2.p1.3.m3.1.1" xref="S1.SS2.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.3.m3.1b"><ci id="S1.SS2.p1.3.m3.1.1.cmml" xref="S1.SS2.p1.3.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.3.m3.1c">j</annotation></semantics></math>. Unlike under the iid assumption the local model <math id="S1.SS2.p1.4.m4.1" class="ltx_Math" alttext="F_{k}" display="inline"><semantics id="S1.SS2.p1.4.m4.1a"><msub id="S1.SS2.p1.4.m4.1.1" xref="S1.SS2.p1.4.m4.1.1.cmml"><mi id="S1.SS2.p1.4.m4.1.1.2" xref="S1.SS2.p1.4.m4.1.1.2.cmml">F</mi><mi id="S1.SS2.p1.4.m4.1.1.3" xref="S1.SS2.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.4.m4.1b"><apply id="S1.SS2.p1.4.m4.1.1.cmml" xref="S1.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S1.SS2.p1.4.m4.1.1.1.cmml" xref="S1.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S1.SS2.p1.4.m4.1.1.2.cmml" xref="S1.SS2.p1.4.m4.1.1.2">ğ¹</ci><ci id="S1.SS2.p1.4.m4.1.1.3.cmml" xref="S1.SS2.p1.4.m4.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.4.m4.1c">F_{k}</annotation></semantics></math>, in expectation, trained on its own data <math id="S1.SS2.p1.5.m5.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="S1.SS2.p1.5.m5.1a"><msub id="S1.SS2.p1.5.m5.1.1" xref="S1.SS2.p1.5.m5.1.1.cmml"><mi id="S1.SS2.p1.5.m5.1.1.2" xref="S1.SS2.p1.5.m5.1.1.2.cmml">D</mi><mi id="S1.SS2.p1.5.m5.1.1.3" xref="S1.SS2.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.5.m5.1b"><apply id="S1.SS2.p1.5.m5.1.1.cmml" xref="S1.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S1.SS2.p1.5.m5.1.1.1.cmml" xref="S1.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S1.SS2.p1.5.m5.1.1.2.cmml" xref="S1.SS2.p1.5.m5.1.1.2">ğ·</ci><ci id="S1.SS2.p1.5.m5.1.1.3.cmml" xref="S1.SS2.p1.5.m5.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.5.m5.1c">D_{k}</annotation></semantics></math> will be an unreliable approximation of the joint model <math id="S1.SS2.p1.6.m6.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S1.SS2.p1.6.m6.1a"><mi id="S1.SS2.p1.6.m6.1.1" xref="S1.SS2.p1.6.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S1.SS2.p1.6.m6.1b"><ci id="S1.SS2.p1.6.m6.1.1.cmml" xref="S1.SS2.p1.6.m6.1.1">ğ‘“</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS2.p1.6.m6.1c">f</annotation></semantics></math>:</p>
</div>
<div id="S1.SS2.p2" class="ltx_para">
<table id="S1.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E3.m1.3" class="ltx_Math" alttext="\mathbb{E}_{D_{k}}[F_{k}(w)]\neq f(w)" display="block"><semantics id="S1.E3.m1.3a"><mrow id="S1.E3.m1.3.3" xref="S1.E3.m1.3.3.cmml"><mrow id="S1.E3.m1.3.3.1" xref="S1.E3.m1.3.3.1.cmml"><msub id="S1.E3.m1.3.3.1.3" xref="S1.E3.m1.3.3.1.3.cmml"><mi id="S1.E3.m1.3.3.1.3.2" xref="S1.E3.m1.3.3.1.3.2.cmml">ğ”¼</mi><msub id="S1.E3.m1.3.3.1.3.3" xref="S1.E3.m1.3.3.1.3.3.cmml"><mi id="S1.E3.m1.3.3.1.3.3.2" xref="S1.E3.m1.3.3.1.3.3.2.cmml">D</mi><mi id="S1.E3.m1.3.3.1.3.3.3" xref="S1.E3.m1.3.3.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S1.E3.m1.3.3.1.2" xref="S1.E3.m1.3.3.1.2.cmml">â€‹</mo><mrow id="S1.E3.m1.3.3.1.1.1" xref="S1.E3.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S1.E3.m1.3.3.1.1.1.2" xref="S1.E3.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="S1.E3.m1.3.3.1.1.1.1" xref="S1.E3.m1.3.3.1.1.1.1.cmml"><msub id="S1.E3.m1.3.3.1.1.1.1.2" xref="S1.E3.m1.3.3.1.1.1.1.2.cmml"><mi id="S1.E3.m1.3.3.1.1.1.1.2.2" xref="S1.E3.m1.3.3.1.1.1.1.2.2.cmml">F</mi><mi id="S1.E3.m1.3.3.1.1.1.1.2.3" xref="S1.E3.m1.3.3.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S1.E3.m1.3.3.1.1.1.1.1" xref="S1.E3.m1.3.3.1.1.1.1.1.cmml">â€‹</mo><mrow id="S1.E3.m1.3.3.1.1.1.1.3.2" xref="S1.E3.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S1.E3.m1.3.3.1.1.1.1.3.2.1" xref="S1.E3.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S1.E3.m1.1.1" xref="S1.E3.m1.1.1.cmml">w</mi><mo stretchy="false" id="S1.E3.m1.3.3.1.1.1.1.3.2.2" xref="S1.E3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S1.E3.m1.3.3.1.1.1.3" xref="S1.E3.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S1.E3.m1.3.3.2" xref="S1.E3.m1.3.3.2.cmml">â‰ </mo><mrow id="S1.E3.m1.3.3.3" xref="S1.E3.m1.3.3.3.cmml"><mi id="S1.E3.m1.3.3.3.2" xref="S1.E3.m1.3.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S1.E3.m1.3.3.3.1" xref="S1.E3.m1.3.3.3.1.cmml">â€‹</mo><mrow id="S1.E3.m1.3.3.3.3.2" xref="S1.E3.m1.3.3.3.cmml"><mo stretchy="false" id="S1.E3.m1.3.3.3.3.2.1" xref="S1.E3.m1.3.3.3.cmml">(</mo><mi id="S1.E3.m1.2.2" xref="S1.E3.m1.2.2.cmml">w</mi><mo stretchy="false" id="S1.E3.m1.3.3.3.3.2.2" xref="S1.E3.m1.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E3.m1.3b"><apply id="S1.E3.m1.3.3.cmml" xref="S1.E3.m1.3.3"><neq id="S1.E3.m1.3.3.2.cmml" xref="S1.E3.m1.3.3.2"></neq><apply id="S1.E3.m1.3.3.1.cmml" xref="S1.E3.m1.3.3.1"><times id="S1.E3.m1.3.3.1.2.cmml" xref="S1.E3.m1.3.3.1.2"></times><apply id="S1.E3.m1.3.3.1.3.cmml" xref="S1.E3.m1.3.3.1.3"><csymbol cd="ambiguous" id="S1.E3.m1.3.3.1.3.1.cmml" xref="S1.E3.m1.3.3.1.3">subscript</csymbol><ci id="S1.E3.m1.3.3.1.3.2.cmml" xref="S1.E3.m1.3.3.1.3.2">ğ”¼</ci><apply id="S1.E3.m1.3.3.1.3.3.cmml" xref="S1.E3.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S1.E3.m1.3.3.1.3.3.1.cmml" xref="S1.E3.m1.3.3.1.3.3">subscript</csymbol><ci id="S1.E3.m1.3.3.1.3.3.2.cmml" xref="S1.E3.m1.3.3.1.3.3.2">ğ·</ci><ci id="S1.E3.m1.3.3.1.3.3.3.cmml" xref="S1.E3.m1.3.3.1.3.3.3">ğ‘˜</ci></apply></apply><apply id="S1.E3.m1.3.3.1.1.2.cmml" xref="S1.E3.m1.3.3.1.1.1"><csymbol cd="latexml" id="S1.E3.m1.3.3.1.1.2.1.cmml" xref="S1.E3.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S1.E3.m1.3.3.1.1.1.1.cmml" xref="S1.E3.m1.3.3.1.1.1.1"><times id="S1.E3.m1.3.3.1.1.1.1.1.cmml" xref="S1.E3.m1.3.3.1.1.1.1.1"></times><apply id="S1.E3.m1.3.3.1.1.1.1.2.cmml" xref="S1.E3.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E3.m1.3.3.1.1.1.1.2.1.cmml" xref="S1.E3.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S1.E3.m1.3.3.1.1.1.1.2.2.cmml" xref="S1.E3.m1.3.3.1.1.1.1.2.2">ğ¹</ci><ci id="S1.E3.m1.3.3.1.1.1.1.2.3.cmml" xref="S1.E3.m1.3.3.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S1.E3.m1.1.1.cmml" xref="S1.E3.m1.1.1">ğ‘¤</ci></apply></apply></apply><apply id="S1.E3.m1.3.3.3.cmml" xref="S1.E3.m1.3.3.3"><times id="S1.E3.m1.3.3.3.1.cmml" xref="S1.E3.m1.3.3.3.1"></times><ci id="S1.E3.m1.3.3.3.2.cmml" xref="S1.E3.m1.3.3.3.2">ğ‘“</ci><ci id="S1.E3.m1.2.2.cmml" xref="S1.E3.m1.2.2">ğ‘¤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E3.m1.3c">\mathbb{E}_{D_{k}}[F_{k}(w)]\neq f(w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S1.SS2.p3" class="ltx_para">
<p id="S1.SS2.p3.1" class="ltx_p">There are a variety of ways in which the data among clients can be distributed in a non-iid fashion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>:</p>
</div>
<div id="S1.SS2.p4" class="ltx_para">
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p"><span id="S1.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">Feature distribution skew*</span>: The <math id="S1.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}(x)" display="inline"><semantics id="S1.I2.i1.p1.1.m1.1a"><mrow id="S1.I2.i1.p1.1.m1.1.2" xref="S1.I2.i1.p1.1.m1.1.2.cmml"><msub id="S1.I2.i1.p1.1.m1.1.2.2" xref="S1.I2.i1.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.I2.i1.p1.1.m1.1.2.2.2" xref="S1.I2.i1.p1.1.m1.1.2.2.2.cmml">ğ’«</mi><mi id="S1.I2.i1.p1.1.m1.1.2.2.3" xref="S1.I2.i1.p1.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.I2.i1.p1.1.m1.1.2.1" xref="S1.I2.i1.p1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S1.I2.i1.p1.1.m1.1.2.3.2" xref="S1.I2.i1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S1.I2.i1.p1.1.m1.1.2.3.2.1" xref="S1.I2.i1.p1.1.m1.1.2.cmml">(</mo><mi id="S1.I2.i1.p1.1.m1.1.1" xref="S1.I2.i1.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S1.I2.i1.p1.1.m1.1.2.3.2.2" xref="S1.I2.i1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I2.i1.p1.1.m1.1b"><apply id="S1.I2.i1.p1.1.m1.1.2.cmml" xref="S1.I2.i1.p1.1.m1.1.2"><times id="S1.I2.i1.p1.1.m1.1.2.1.cmml" xref="S1.I2.i1.p1.1.m1.1.2.1"></times><apply id="S1.I2.i1.p1.1.m1.1.2.2.cmml" xref="S1.I2.i1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S1.I2.i1.p1.1.m1.1.2.2.1.cmml" xref="S1.I2.i1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S1.I2.i1.p1.1.m1.1.2.2.2.cmml" xref="S1.I2.i1.p1.1.m1.1.2.2.2">ğ’«</ci><ci id="S1.I2.i1.p1.1.m1.1.2.2.3.cmml" xref="S1.I2.i1.p1.1.m1.1.2.2.3">ğ‘–</ci></apply><ci id="S1.I2.i1.p1.1.m1.1.1.cmml" xref="S1.I2.i1.p1.1.m1.1.1">ğ‘¥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i1.p1.1.m1.1c">\mathcal{P}_{i}(x)</annotation></semantics></math> marginal distributions vary between clients. This is the case where the input features are not evenly distributed between clients.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p"><span id="S1.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">Label distribution skew*</span>: The <math id="S1.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}(y)" display="inline"><semantics id="S1.I2.i2.p1.1.m1.1a"><mrow id="S1.I2.i2.p1.1.m1.1.2" xref="S1.I2.i2.p1.1.m1.1.2.cmml"><msub id="S1.I2.i2.p1.1.m1.1.2.2" xref="S1.I2.i2.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.I2.i2.p1.1.m1.1.2.2.2" xref="S1.I2.i2.p1.1.m1.1.2.2.2.cmml">ğ’«</mi><mi id="S1.I2.i2.p1.1.m1.1.2.2.3" xref="S1.I2.i2.p1.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.I2.i2.p1.1.m1.1.2.1" xref="S1.I2.i2.p1.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S1.I2.i2.p1.1.m1.1.2.3.2" xref="S1.I2.i2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S1.I2.i2.p1.1.m1.1.2.3.2.1" xref="S1.I2.i2.p1.1.m1.1.2.cmml">(</mo><mi id="S1.I2.i2.p1.1.m1.1.1" xref="S1.I2.i2.p1.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="S1.I2.i2.p1.1.m1.1.2.3.2.2" xref="S1.I2.i2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I2.i2.p1.1.m1.1b"><apply id="S1.I2.i2.p1.1.m1.1.2.cmml" xref="S1.I2.i2.p1.1.m1.1.2"><times id="S1.I2.i2.p1.1.m1.1.2.1.cmml" xref="S1.I2.i2.p1.1.m1.1.2.1"></times><apply id="S1.I2.i2.p1.1.m1.1.2.2.cmml" xref="S1.I2.i2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S1.I2.i2.p1.1.m1.1.2.2.1.cmml" xref="S1.I2.i2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S1.I2.i2.p1.1.m1.1.2.2.2.cmml" xref="S1.I2.i2.p1.1.m1.1.2.2.2">ğ’«</ci><ci id="S1.I2.i2.p1.1.m1.1.2.2.3.cmml" xref="S1.I2.i2.p1.1.m1.1.2.2.3">ğ‘–</ci></apply><ci id="S1.I2.i2.p1.1.m1.1.1.cmml" xref="S1.I2.i2.p1.1.m1.1.1">ğ‘¦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i2.p1.1.m1.1c">\mathcal{P}_{i}(y)</annotation></semantics></math> marginal distributions vary between clients. This is the case where the data labels are not evenly distributed between clients. For example some clients only have access to data from a subset of all possible labels for a given task.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.3" class="ltx_p"><span id="S1.I2.i3.p1.3.1" class="ltx_text ltx_font_bold">Concept shift (same features, different label)*</span>: The <math id="S1.I2.i3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}(y|x)" display="inline"><semantics id="S1.I2.i3.p1.1.m1.1a"><mrow id="S1.I2.i3.p1.1.m1.1.1" xref="S1.I2.i3.p1.1.m1.1.1.cmml"><msub id="S1.I2.i3.p1.1.m1.1.1.3" xref="S1.I2.i3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.I2.i3.p1.1.m1.1.1.3.2" xref="S1.I2.i3.p1.1.m1.1.1.3.2.cmml">ğ’«</mi><mi id="S1.I2.i3.p1.1.m1.1.1.3.3" xref="S1.I2.i3.p1.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.I2.i3.p1.1.m1.1.1.2" xref="S1.I2.i3.p1.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S1.I2.i3.p1.1.m1.1.1.1.1" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.I2.i3.p1.1.m1.1.1.1.1.2" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.I2.i3.p1.1.m1.1.1.1.1.1" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S1.I2.i3.p1.1.m1.1.1.1.1.1.2" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S1.I2.i3.p1.1.m1.1.1.1.1.1.1" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S1.I2.i3.p1.1.m1.1.1.1.1.1.3" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S1.I2.i3.p1.1.m1.1.1.1.1.3" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I2.i3.p1.1.m1.1b"><apply id="S1.I2.i3.p1.1.m1.1.1.cmml" xref="S1.I2.i3.p1.1.m1.1.1"><times id="S1.I2.i3.p1.1.m1.1.1.2.cmml" xref="S1.I2.i3.p1.1.m1.1.1.2"></times><apply id="S1.I2.i3.p1.1.m1.1.1.3.cmml" xref="S1.I2.i3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.I2.i3.p1.1.m1.1.1.3.1.cmml" xref="S1.I2.i3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S1.I2.i3.p1.1.m1.1.1.3.2.cmml" xref="S1.I2.i3.p1.1.m1.1.1.3.2">ğ’«</ci><ci id="S1.I2.i3.p1.1.m1.1.1.3.3.cmml" xref="S1.I2.i3.p1.1.m1.1.1.3.3">ğ‘–</ci></apply><apply id="S1.I2.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S1.I2.i3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S1.I2.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S1.I2.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.2">ğ‘¦</ci><ci id="S1.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S1.I2.i3.p1.1.m1.1.1.1.1.1.3">ğ‘¥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i3.p1.1.m1.1c">\mathcal{P}_{i}(y|x)</annotation></semantics></math> conditional distributions vary between clients. Here different labels are assigned for the same features across clients. For example, client <math id="S1.I2.i3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.I2.i3.p1.2.m2.1a"><mi id="S1.I2.i3.p1.2.m2.1.1" xref="S1.I2.i3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.I2.i3.p1.2.m2.1b"><ci id="S1.I2.i3.p1.2.m2.1.1.cmml" xref="S1.I2.i3.p1.2.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i3.p1.2.m2.1c">i</annotation></semantics></math> labels all cat images as â€™catâ€™, but client <math id="S1.I2.i3.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S1.I2.i3.p1.3.m3.1a"><mi id="S1.I2.i3.p1.3.m3.1.1" xref="S1.I2.i3.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S1.I2.i3.p1.3.m3.1b"><ci id="S1.I2.i3.p1.3.m3.1.1.cmml" xref="S1.I2.i3.p1.3.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i3.p1.3.m3.1c">j</annotation></semantics></math> labels all cat images as â€™dogâ€™.</p>
</div>
</li>
<li id="S1.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S1.I2.i4.p1" class="ltx_para">
<p id="S1.I2.i4.p1.3" class="ltx_p"><span id="S1.I2.i4.p1.3.1" class="ltx_text ltx_font_bold">Concept shift (same label, different features)</span>: The <math id="S1.I2.i4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}(x|y)" display="inline"><semantics id="S1.I2.i4.p1.1.m1.1a"><mrow id="S1.I2.i4.p1.1.m1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.cmml"><msub id="S1.I2.i4.p1.1.m1.1.1.3" xref="S1.I2.i4.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.I2.i4.p1.1.m1.1.1.3.2" xref="S1.I2.i4.p1.1.m1.1.1.3.2.cmml">ğ’«</mi><mi id="S1.I2.i4.p1.1.m1.1.1.3.3" xref="S1.I2.i4.p1.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.I2.i4.p1.1.m1.1.1.2" xref="S1.I2.i4.p1.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S1.I2.i4.p1.1.m1.1.1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.I2.i4.p1.1.m1.1.1.1.1.2" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.I2.i4.p1.1.m1.1.1.1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.cmml"><mi id="S1.I2.i4.p1.1.m1.1.1.1.1.1.2" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.I2.i4.p1.1.m1.1.1.1.1.1.1" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S1.I2.i4.p1.1.m1.1.1.1.1.1.3" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S1.I2.i4.p1.1.m1.1.1.1.1.3" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.1.m1.1b"><apply id="S1.I2.i4.p1.1.m1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1"><times id="S1.I2.i4.p1.1.m1.1.1.2.cmml" xref="S1.I2.i4.p1.1.m1.1.1.2"></times><apply id="S1.I2.i4.p1.1.m1.1.1.3.cmml" xref="S1.I2.i4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.I2.i4.p1.1.m1.1.1.3.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S1.I2.i4.p1.1.m1.1.1.3.2.cmml" xref="S1.I2.i4.p1.1.m1.1.1.3.2">ğ’«</ci><ci id="S1.I2.i4.p1.1.m1.1.1.3.3.cmml" xref="S1.I2.i4.p1.1.m1.1.1.3.3">ğ‘–</ci></apply><apply id="S1.I2.i4.p1.1.m1.1.1.1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S1.I2.i4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S1.I2.i4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S1.I2.i4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S1.I2.i4.p1.1.m1.1.1.1.1.1.3">ğ‘¦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i4.p1.1.m1.1c">\mathcal{P}_{i}(x|y)</annotation></semantics></math> conditional distributions vary between clients. Here different features across clients are labelled with the same label. For example, client <math id="S1.I2.i4.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.I2.i4.p1.2.m2.1a"><mi id="S1.I2.i4.p1.2.m2.1.1" xref="S1.I2.i4.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.2.m2.1b"><ci id="S1.I2.i4.p1.2.m2.1.1.cmml" xref="S1.I2.i4.p1.2.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i4.p1.2.m2.1c">i</annotation></semantics></math> labels all cat images as â€™catâ€™, but client <math id="S1.I2.i4.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S1.I2.i4.p1.3.m3.1a"><mi id="S1.I2.i4.p1.3.m3.1.1" xref="S1.I2.i4.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S1.I2.i4.p1.3.m3.1b"><ci id="S1.I2.i4.p1.3.m3.1.1.cmml" xref="S1.I2.i4.p1.3.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i4.p1.3.m3.1c">j</annotation></semantics></math> labels all dog images as â€™catâ€™.</p>
</div>
</li>
</ul>
</div>
<div id="S1.SS2.p5" class="ltx_para">
<p id="S1.SS2.p5.1" class="ltx_p">Additionally, clients might have access to varying numbers of training examples. In practice, some degree of all of these non-iid settings may be represented in a given massively distributed dataset. In this work we explore the effect of different non-iid distributions on the ability for hierarchical clustering to determine client similarity from their client updates, namely the starred (<span id="S1.SS2.p5.1.1" class="ltx_text ltx_font_bold">*</span>) non-iid settings above.</p>
</div>
<div id="S1.SS2.p6" class="ltx_para">
<p id="S1.SS2.p6.1" class="ltx_p">Where data is distributed in a highly non-iid fashion, a single joint model may not be able to meet the objectives of all clients simultaneously <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Instead, multiple models targeted towards groups of clients with similar data distributions might be preferred. However in FL, the raw data cannot be inspected by the central entity. As such, only the local model updates can be used to judge the direction in which each client wishes to update the global model. This provides the only proxy for determining client similarity whilst preserving some level of privacy over the local data.</p>
</div>
</section>
<section id="S1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S1.SS3.5.1.1" class="ltx_text">I-C</span> </span><span id="S1.SS3.6.2" class="ltx_text ltx_font_italic">Hierarchical clustering</span>
</h3>

<div id="S1.SS3.p1" class="ltx_para">
<p id="S1.SS3.p1.1" class="ltx_p">Training multiple models for subsets of related clients can be achieved by clustering the model updates received from the clients. Many unsupervised clustering algorithms require an estimation of the number of these clusters a priori. Since we cannot know how many unique data generating distributions the clientâ€™s datasets are drawn from, a clustering algorithm that can determine the number of clusters independently must be employed. However, some clustering methods that determine the number of clusters automatically fail to assign outlying samples to a cluster and simply label them as noise (for example DBSCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>). Hierarchical clustering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is a natural choice for the purpose of clustering where the number of clusters is unknown and where all examples are assigned to the most relevant cluster. Another benefit of using hierarchical clustering is its ability to scale to large numbers of samples and clusters as well as being reasonably interpretable.</p>
</div>
<div id="S1.SS3.p2" class="ltx_para">
<p id="S1.SS3.p2.1" class="ltx_p">In this work we opt to use an agglomerative hierarchical clustering method which begins with all samples belonging to their own singleton cluster. Each sample is simply a vectorised local model update (the parameters of the local model). At each step of the clustering, the pairwise distance between all clusters is calculated to judge their similarity. The two clusters that are most similar are merged. This continues for a total of <math id="S1.SS3.p2.1.m1.1" class="ltx_Math" alttext="N-1" display="inline"><semantics id="S1.SS3.p2.1.m1.1a"><mrow id="S1.SS3.p2.1.m1.1.1" xref="S1.SS3.p2.1.m1.1.1.cmml"><mi id="S1.SS3.p2.1.m1.1.1.2" xref="S1.SS3.p2.1.m1.1.1.2.cmml">N</mi><mo id="S1.SS3.p2.1.m1.1.1.1" xref="S1.SS3.p2.1.m1.1.1.1.cmml">âˆ’</mo><mn id="S1.SS3.p2.1.m1.1.1.3" xref="S1.SS3.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.SS3.p2.1.m1.1b"><apply id="S1.SS3.p2.1.m1.1.1.cmml" xref="S1.SS3.p2.1.m1.1.1"><minus id="S1.SS3.p2.1.m1.1.1.1.cmml" xref="S1.SS3.p2.1.m1.1.1.1"></minus><ci id="S1.SS3.p2.1.m1.1.1.2.cmml" xref="S1.SS3.p2.1.m1.1.1.2">ğ‘</ci><cn type="integer" id="S1.SS3.p2.1.m1.1.1.3.cmml" xref="S1.SS3.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS3.p2.1.m1.1c">N-1</annotation></semantics></math> steps until a single cluster remains, containing all the samples. Thus, a hierarchical structure of similarity between clients is constructed. This structure possesses the property of monotonicity, such that the dissimilarity of two clusters involved in merging increases with successive steps. A distance threshold can act as a hyperparameter to determine when to stop merging clusters. Intuitively, this acts to limit how dissimilar two clusters can be before stopping the merging process.</p>
</div>
<div id="S1.SS3.p3" class="ltx_para">
<p id="S1.SS3.p3.1" class="ltx_p">Two further hyperparameters of the hierarchical clustering algorithm are of importance to our study. The first is the distance metric uses to compute the similarity between clusters. In this work we opt to test L1 (Manhattan), L2 (Euclidean) and cosine distance metrics. Euclidean distance is a common metric used to judge similarity between vectors, however the Manhattan distance works well for sparse vectors and is less affected by outliers. Finally, the cosine distance metric is invariant to scaling effects and therefore only indicates how closely two vectors point in the same direction.</p>
</div>
<div id="S1.SS3.p4" class="ltx_para">
<p id="S1.SS3.p4.1" class="ltx_p">The second important hyperparameter is the linkage mechanism for determining how similar two clusters are. Single linkage determines distance based on the most similar pair of samples across two clusters. Complete linkage determines distance based on the most dissimilar pairs of samples across two clusters. Average linkage averages the samples within each cluster and compares distances based on these averages. Finally Wardâ€™s linkage (which can only be combined with the Euclidean distance metric) seeks to minimise the intra-cluster variance upon merging two clusters.</p>
</div>
<div id="S1.SS3.p5" class="ltx_para">
<p id="S1.SS3.p5.1" class="ltx_p">Our experiments test the ability of combinations of these hyperparameters to produce clusters of client updates that, when averaged, exhibit a higher test set accuracy compared to training using a single joint model (as in the normal FL setting).</p>
</div>
</section>
<section id="S1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S1.SS4.5.1.1" class="ltx_text">I-D</span> </span><span id="S1.SS4.6.2" class="ltx_text ltx_font_italic">Related work</span>
</h3>

<div id="S1.SS4.p1" class="ltx_para">
<p id="S1.SS4.p1.1" class="ltx_p">The FL setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> was envisioned with non-iid data in mind unlike previous works on distributed training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> which focused on iid data in a data center environment. The commonly used FederatedAveraging algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> makes no special adjustments when encountering non-iid data and therefore suffers a penalty in performance and/or communication costs in such circumstances <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Several works have sought to deal with non-iid data in a FL setting. Zhao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> propose sharing a small subset of public data with heterogenous clients to reduce the weight divergence between trained local models, thus increasing rubustness and stability during training. However this relies on a substantial amount of public data being available for a given task. Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, solve the same problem by adding a regularisation term to the local optimisation, limiting the weight divergence of the local and global models. Both of these approaches train a single joint model and work well to increase overall model accuracy. However, under some non-iid data distributions (particularly where clients have competing objectives), a single joint model cannot perform optimally for all clients simultaneously <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. For the purpose of improving performance when faced with client datasets across different timezones, Eichner et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> propose a semi-cyclic method to train pluralistic models that perform model averaging over blocks of clients (e.g. clients in particular timezones). In this work clients are clustered where they are located in a shared timezone. Our approach does not require any extra knowledge about the clients (timezones or otherwise) as only the local updates are observed and used to form the clusters automatically.</p>
</div>
<div id="S1.SS4.p2" class="ltx_para">
<p id="S1.SS4.p2.1" class="ltx_p">By considering each local learning objective as a task, multi-task learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> has been employed in the distributed learning setting in multiple works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Another multi-task learning setup considers the learning objectives of a subset of related clients as a single task. Ghosh et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> use K-means to cluster client updates for the purpose of identifying and isolating byzantine clusters of clients prior to the averaging step. Our work most closely resembles that of Sattler et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> who develop a clustered federated learning (CFL) procedure. This uses an optimal bipartitioning algorithm to separate clients based on cosine similarity for the purpose of producing specialised models for each cluster of clients. In contrast, our work covers a wider range of non-iid settings, similarity measures and allows for training on only a fraction of clients per round of communication. We also employ a single clustering step compared to possibly many in CFL, reducing the load of the clustering procedure on the aggregation server.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Federated learning with hierarchical clustering</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.6" class="ltx_p">Under the FL setting, the assumption is that the objectives for all clients approximate the global objective. However, in the presence of non-iid data, this is not the case. As such, we propose a federated learning with hierarchical clustering (FL+HC) setting. During the FL procedure, a clustering step at communication round <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">n</annotation></semantics></math> is introduced. At the clustering step, we perform a communication round involving all the clients on the global joint model trained up to round <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">n</annotation></semantics></math>. The updated local model from all clients is used to judge the similarity between clients and the hierarchical clustering algorithm is employed to iteratively merge the most similar clusters of clients up to a given distance threshold <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">T</annotation></semantics></math>. Once merging is halted, the determined clusters of clients <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">ğ¶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">C</annotation></semantics></math> are trained independently but simultaneously, initialised with the joint model at its current state. This algorithm is detailed in algorithm <a href="#alg1" title="Algorithm 1 â€£ II Federated learning with hierarchical clustering â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. If a good clustering has been achieved, the average test set accuracy over all clients should outperform that of training a single joint model under FL. Under FL+HC we are training a specialised model <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="f_{c}(w)" display="inline"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.2" xref="S2.p1.5.m5.1.2.cmml"><msub id="S2.p1.5.m5.1.2.2" xref="S2.p1.5.m5.1.2.2.cmml"><mi id="S2.p1.5.m5.1.2.2.2" xref="S2.p1.5.m5.1.2.2.2.cmml">f</mi><mi id="S2.p1.5.m5.1.2.2.3" xref="S2.p1.5.m5.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S2.p1.5.m5.1.2.1" xref="S2.p1.5.m5.1.2.1.cmml">â€‹</mo><mrow id="S2.p1.5.m5.1.2.3.2" xref="S2.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S2.p1.5.m5.1.2.3.2.1" xref="S2.p1.5.m5.1.2.cmml">(</mo><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">w</mi><mo stretchy="false" id="S2.p1.5.m5.1.2.3.2.2" xref="S2.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.2.cmml" xref="S2.p1.5.m5.1.2"><times id="S2.p1.5.m5.1.2.1.cmml" xref="S2.p1.5.m5.1.2.1"></times><apply id="S2.p1.5.m5.1.2.2.cmml" xref="S2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.2.2.1.cmml" xref="S2.p1.5.m5.1.2.2">subscript</csymbol><ci id="S2.p1.5.m5.1.2.2.2.cmml" xref="S2.p1.5.m5.1.2.2.2">ğ‘“</ci><ci id="S2.p1.5.m5.1.2.2.3.cmml" xref="S2.p1.5.m5.1.2.2.3">ğ‘</ci></apply><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">f_{c}(w)</annotation></semantics></math> for every cluster of similar clients <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.p1.6.m6.1a"><mi id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">c</annotation></semantics></math>, each of which have different objectives such that:</p>
</div>
<div id="S2.p2" class="ltx_para">
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.4" class="ltx_Math" alttext="\forall{c\in C},\mathbb{E}_{D_{k}}[F_{k}(w)]=f_{c}(w)\text{ where }k\in c" display="block"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4.2" xref="S2.E4.m1.4.4.3.cmml"><mrow id="S2.E4.m1.3.3.1.1" xref="S2.E4.m1.3.3.1.1.cmml"><mrow id="S2.E4.m1.3.3.1.1.2" xref="S2.E4.m1.3.3.1.1.2.cmml"><mo rspace="0.167em" id="S2.E4.m1.3.3.1.1.2.1" xref="S2.E4.m1.3.3.1.1.2.1.cmml">âˆ€</mo><mi id="S2.E4.m1.3.3.1.1.2.2" xref="S2.E4.m1.3.3.1.1.2.2.cmml">c</mi></mrow><mo id="S2.E4.m1.3.3.1.1.1" xref="S2.E4.m1.3.3.1.1.1.cmml">âˆˆ</mo><mi id="S2.E4.m1.3.3.1.1.3" xref="S2.E4.m1.3.3.1.1.3.cmml">C</mi></mrow><mo id="S2.E4.m1.4.4.2.3" xref="S2.E4.m1.4.4.3a.cmml">,</mo><mrow id="S2.E4.m1.4.4.2.2" xref="S2.E4.m1.4.4.2.2.cmml"><mrow id="S2.E4.m1.4.4.2.2.1" xref="S2.E4.m1.4.4.2.2.1.cmml"><msub id="S2.E4.m1.4.4.2.2.1.3" xref="S2.E4.m1.4.4.2.2.1.3.cmml"><mi id="S2.E4.m1.4.4.2.2.1.3.2" xref="S2.E4.m1.4.4.2.2.1.3.2.cmml">ğ”¼</mi><msub id="S2.E4.m1.4.4.2.2.1.3.3" xref="S2.E4.m1.4.4.2.2.1.3.3.cmml"><mi id="S2.E4.m1.4.4.2.2.1.3.3.2" xref="S2.E4.m1.4.4.2.2.1.3.3.2.cmml">D</mi><mi id="S2.E4.m1.4.4.2.2.1.3.3.3" xref="S2.E4.m1.4.4.2.2.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.2.2.1.2" xref="S2.E4.m1.4.4.2.2.1.2.cmml">â€‹</mo><mrow id="S2.E4.m1.4.4.2.2.1.1.1" xref="S2.E4.m1.4.4.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.2.2.1.1.1.2" xref="S2.E4.m1.4.4.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E4.m1.4.4.2.2.1.1.1.1" xref="S2.E4.m1.4.4.2.2.1.1.1.1.cmml"><msub id="S2.E4.m1.4.4.2.2.1.1.1.1.2" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2.cmml"><mi id="S2.E4.m1.4.4.2.2.1.1.1.1.2.2" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2.2.cmml">F</mi><mi id="S2.E4.m1.4.4.2.2.1.1.1.1.2.3" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.2.2.1.1.1.1.1" xref="S2.E4.m1.4.4.2.2.1.1.1.1.1.cmml">â€‹</mo><mrow id="S2.E4.m1.4.4.2.2.1.1.1.1.3.2" xref="S2.E4.m1.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.2.2.1.1.1.1.3.2.1" xref="S2.E4.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">w</mi><mo stretchy="false" id="S2.E4.m1.4.4.2.2.1.1.1.1.3.2.2" xref="S2.E4.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E4.m1.4.4.2.2.1.1.1.3" xref="S2.E4.m1.4.4.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E4.m1.4.4.2.2.3" xref="S2.E4.m1.4.4.2.2.3.cmml">=</mo><mrow id="S2.E4.m1.4.4.2.2.4" xref="S2.E4.m1.4.4.2.2.4.cmml"><msub id="S2.E4.m1.4.4.2.2.4.2" xref="S2.E4.m1.4.4.2.2.4.2.cmml"><mi id="S2.E4.m1.4.4.2.2.4.2.2" xref="S2.E4.m1.4.4.2.2.4.2.2.cmml">f</mi><mi id="S2.E4.m1.4.4.2.2.4.2.3" xref="S2.E4.m1.4.4.2.2.4.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.2.2.4.1" xref="S2.E4.m1.4.4.2.2.4.1.cmml">â€‹</mo><mrow id="S2.E4.m1.4.4.2.2.4.3.2" xref="S2.E4.m1.4.4.2.2.4.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.2.2.4.3.2.1" xref="S2.E4.m1.4.4.2.2.4.cmml">(</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">w</mi><mo stretchy="false" id="S2.E4.m1.4.4.2.2.4.3.2.2" xref="S2.E4.m1.4.4.2.2.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.2.2.4.1a" xref="S2.E4.m1.4.4.2.2.4.1.cmml">â€‹</mo><mtext id="S2.E4.m1.4.4.2.2.4.4" xref="S2.E4.m1.4.4.2.2.4.4a.cmml">Â whereÂ </mtext><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.2.2.4.1b" xref="S2.E4.m1.4.4.2.2.4.1.cmml">â€‹</mo><mi id="S2.E4.m1.4.4.2.2.4.5" xref="S2.E4.m1.4.4.2.2.4.5.cmml">k</mi></mrow><mo id="S2.E4.m1.4.4.2.2.5" xref="S2.E4.m1.4.4.2.2.5.cmml">âˆˆ</mo><mi id="S2.E4.m1.4.4.2.2.6" xref="S2.E4.m1.4.4.2.2.6.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.3.cmml" xref="S2.E4.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.3a.cmml" xref="S2.E4.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S2.E4.m1.3.3.1.1.cmml" xref="S2.E4.m1.3.3.1.1"><in id="S2.E4.m1.3.3.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1"></in><apply id="S2.E4.m1.3.3.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2"><csymbol cd="latexml" id="S2.E4.m1.3.3.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1">for-all</csymbol><ci id="S2.E4.m1.3.3.1.1.2.2.cmml" xref="S2.E4.m1.3.3.1.1.2.2">ğ‘</ci></apply><ci id="S2.E4.m1.3.3.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.3">ğ¶</ci></apply><apply id="S2.E4.m1.4.4.2.2.cmml" xref="S2.E4.m1.4.4.2.2"><and id="S2.E4.m1.4.4.2.2a.cmml" xref="S2.E4.m1.4.4.2.2"></and><apply id="S2.E4.m1.4.4.2.2b.cmml" xref="S2.E4.m1.4.4.2.2"><eq id="S2.E4.m1.4.4.2.2.3.cmml" xref="S2.E4.m1.4.4.2.2.3"></eq><apply id="S2.E4.m1.4.4.2.2.1.cmml" xref="S2.E4.m1.4.4.2.2.1"><times id="S2.E4.m1.4.4.2.2.1.2.cmml" xref="S2.E4.m1.4.4.2.2.1.2"></times><apply id="S2.E4.m1.4.4.2.2.1.3.cmml" xref="S2.E4.m1.4.4.2.2.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.2.2.1.3.1.cmml" xref="S2.E4.m1.4.4.2.2.1.3">subscript</csymbol><ci id="S2.E4.m1.4.4.2.2.1.3.2.cmml" xref="S2.E4.m1.4.4.2.2.1.3.2">ğ”¼</ci><apply id="S2.E4.m1.4.4.2.2.1.3.3.cmml" xref="S2.E4.m1.4.4.2.2.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.2.2.1.3.3.1.cmml" xref="S2.E4.m1.4.4.2.2.1.3.3">subscript</csymbol><ci id="S2.E4.m1.4.4.2.2.1.3.3.2.cmml" xref="S2.E4.m1.4.4.2.2.1.3.3.2">ğ·</ci><ci id="S2.E4.m1.4.4.2.2.1.3.3.3.cmml" xref="S2.E4.m1.4.4.2.2.1.3.3.3">ğ‘˜</ci></apply></apply><apply id="S2.E4.m1.4.4.2.2.1.1.2.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.4.4.2.2.1.1.2.1.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.4.4.2.2.1.1.1.1.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1"><times id="S2.E4.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1.1"></times><apply id="S2.E4.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2.2">ğ¹</ci><ci id="S2.E4.m1.4.4.2.2.1.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.2.2.1.1.1.1.2.3">ğ‘˜</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">ğ‘¤</ci></apply></apply></apply><apply id="S2.E4.m1.4.4.2.2.4.cmml" xref="S2.E4.m1.4.4.2.2.4"><times id="S2.E4.m1.4.4.2.2.4.1.cmml" xref="S2.E4.m1.4.4.2.2.4.1"></times><apply id="S2.E4.m1.4.4.2.2.4.2.cmml" xref="S2.E4.m1.4.4.2.2.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.2.2.4.2.1.cmml" xref="S2.E4.m1.4.4.2.2.4.2">subscript</csymbol><ci id="S2.E4.m1.4.4.2.2.4.2.2.cmml" xref="S2.E4.m1.4.4.2.2.4.2.2">ğ‘“</ci><ci id="S2.E4.m1.4.4.2.2.4.2.3.cmml" xref="S2.E4.m1.4.4.2.2.4.2.3">ğ‘</ci></apply><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">ğ‘¤</ci><ci id="S2.E4.m1.4.4.2.2.4.4a.cmml" xref="S2.E4.m1.4.4.2.2.4.4"><mtext id="S2.E4.m1.4.4.2.2.4.4.cmml" xref="S2.E4.m1.4.4.2.2.4.4">Â whereÂ </mtext></ci><ci id="S2.E4.m1.4.4.2.2.4.5.cmml" xref="S2.E4.m1.4.4.2.2.4.5">ğ‘˜</ci></apply></apply><apply id="S2.E4.m1.4.4.2.2c.cmml" xref="S2.E4.m1.4.4.2.2"><in id="S2.E4.m1.4.4.2.2.5.cmml" xref="S2.E4.m1.4.4.2.2.5"></in><share href="#S2.E4.m1.4.4.2.2.4.cmml" id="S2.E4.m1.4.4.2.2d.cmml" xref="S2.E4.m1.4.4.2.2"></share><ci id="S2.E4.m1.4.4.2.2.6.cmml" xref="S2.E4.m1.4.4.2.2.6">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">\forall{c\in C},\mathbb{E}_{D_{k}}[F_{k}(w)]=f_{c}(w)\text{ where }k\in c</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The operation required to perform the hierarchical clustering runs in <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(n^{3})" display="inline"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">ğ’ª</mi><mo lspace="0em" rspace="0em" id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S2.p3.1.m1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p3.1.m1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.p3.1.m1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="S2.p3.1.m1.1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.3.cmml">3</mn></msup><mo stretchy="false" id="S2.p3.1.m1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><times id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2"></times><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">ğ’ª</ci><apply id="S2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.1.2">ğ‘›</ci><cn type="integer" id="S2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.1.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathcal{O}(n^{3})</annotation></semantics></math> time. As the operation occurs on the server which is assumed to be large enough to aggregate the updates from many clients, and only occurs once during training, the impact on the overall training operation is not significant.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.31.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.32.2" class="ltx_text ltx_font_smallcaps">Federated learning with hierarchical clustering (FL+HC)</span>. <math id="alg1.15.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.15.m1.1b"><mi id="alg1.15.m1.1.1" xref="alg1.15.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.15.m1.1c"><ci id="alg1.15.m1.1.1.cmml" xref="alg1.15.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m1.1d">n</annotation></semantics></math> is the number of rounds of FL prior to clustering, <math id="alg1.16.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.16.m2.1b"><mi id="alg1.16.m2.1.1" xref="alg1.16.m2.1.1.cmml">Î±</mi><annotation-xml encoding="MathML-Content" id="alg1.16.m2.1c"><ci id="alg1.16.m2.1.1.cmml" xref="alg1.16.m2.1.1">ğ›¼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.m2.1d">\alpha</annotation></semantics></math> is the fraction of clients selected to participate in each round of FL and <math id="alg1.17.m3.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.17.m3.1b"><mi id="alg1.17.m3.1.1" xref="alg1.17.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.17.m3.1c"><ci id="alg1.17.m3.1.1.cmml" xref="alg1.17.m3.1.1">ğ‘ƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.m3.1d">P</annotation></semantics></math> is the set of hyperparameters for the hierarchical clustering algorithm. The <math id="alg1.18.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.18.m4.1b"><mi id="alg1.18.m4.1.1" xref="alg1.18.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.18.m4.1c"><ci id="alg1.18.m4.1.1.cmml" xref="alg1.18.m4.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.m4.1d">K</annotation></semantics></math> clients are indexed by <math id="alg1.19.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.19.m5.1b"><mi id="alg1.19.m5.1.1" xref="alg1.19.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.19.m5.1c"><ci id="alg1.19.m5.1.1.cmml" xref="alg1.19.m5.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.m5.1d">k</annotation></semantics></math> and <math id="alg1.20.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.20.m6.1b"><mi id="alg1.20.m6.1.1" xref="alg1.20.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.20.m6.1c"><ci id="alg1.20.m6.1.1.cmml" xref="alg1.20.m6.1.1">ğ¶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.m6.1d">C</annotation></semantics></math> discovered clusters are indexed by <math id="alg1.21.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.21.m7.1b"><mi id="alg1.21.m7.1.1" xref="alg1.21.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.21.m7.1c"><ci id="alg1.21.m7.1.1.cmml" xref="alg1.21.m7.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.m7.1d">c</annotation></semantics></math>. <math id="alg1.22.m8.1" class="ltx_Math" alttext="K_{c}" display="inline"><semantics id="alg1.22.m8.1b"><msub id="alg1.22.m8.1.1" xref="alg1.22.m8.1.1.cmml"><mi id="alg1.22.m8.1.1.2" xref="alg1.22.m8.1.1.2.cmml">K</mi><mi id="alg1.22.m8.1.1.3" xref="alg1.22.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.22.m8.1c"><apply id="alg1.22.m8.1.1.cmml" xref="alg1.22.m8.1.1"><csymbol cd="ambiguous" id="alg1.22.m8.1.1.1.cmml" xref="alg1.22.m8.1.1">subscript</csymbol><ci id="alg1.22.m8.1.1.2.cmml" xref="alg1.22.m8.1.1.2">ğ¾</ci><ci id="alg1.22.m8.1.1.3.cmml" xref="alg1.22.m8.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.m8.1d">K_{c}</annotation></semantics></math> is the set of clients in cluster <math id="alg1.23.m9.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.23.m9.1b"><mi id="alg1.23.m9.1.1" xref="alg1.23.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.23.m9.1c"><ci id="alg1.23.m9.1.1.cmml" xref="alg1.23.m9.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.m9.1d">c</annotation></semantics></math>. On the client, <math id="alg1.24.m10.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.24.m10.1b"><mi id="alg1.24.m10.1.1" xref="alg1.24.m10.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.24.m10.1c"><ci id="alg1.24.m10.1.1.cmml" xref="alg1.24.m10.1.1">ğµ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.m10.1d">B</annotation></semantics></math> is the local mini-batch size, <math id="alg1.25.m11.1" class="ltx_Math" alttext="\mathcal{P}_{k}" display="inline"><semantics id="alg1.25.m11.1b"><msub id="alg1.25.m11.1.1" xref="alg1.25.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.25.m11.1.1.2" xref="alg1.25.m11.1.1.2.cmml">ğ’«</mi><mi id="alg1.25.m11.1.1.3" xref="alg1.25.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.25.m11.1c"><apply id="alg1.25.m11.1.1.cmml" xref="alg1.25.m11.1.1"><csymbol cd="ambiguous" id="alg1.25.m11.1.1.1.cmml" xref="alg1.25.m11.1.1">subscript</csymbol><ci id="alg1.25.m11.1.1.2.cmml" xref="alg1.25.m11.1.1.2">ğ’«</ci><ci id="alg1.25.m11.1.1.3.cmml" xref="alg1.25.m11.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.m11.1d">\mathcal{P}_{k}</annotation></semantics></math> is the dataset available to client <math id="alg1.26.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.26.m12.1b"><mi id="alg1.26.m12.1.1" xref="alg1.26.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.26.m12.1c"><ci id="alg1.26.m12.1.1.cmml" xref="alg1.26.m12.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.m12.1d">k</annotation></semantics></math>, <math id="alg1.27.m13.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.27.m13.1b"><mi id="alg1.27.m13.1.1" xref="alg1.27.m13.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.27.m13.1c"><ci id="alg1.27.m13.1.1.cmml" xref="alg1.27.m13.1.1">ğ¸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.m13.1d">E</annotation></semantics></math> is the number of local epochs, and <math id="alg1.28.m14.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.28.m14.1b"><mi id="alg1.28.m14.1.1" xref="alg1.28.m14.1.1.cmml">Î·</mi><annotation-xml encoding="MathML-Content" id="alg1.28.m14.1c"><ci id="alg1.28.m14.1.1.cmml" xref="alg1.28.m14.1.1">ğœ‚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.m14.1d">\eta</annotation></semantics></math> is the learning rate</figcaption>
<div id="alg1.33" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.2.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.3" class="ltx_text ltx_font_bold">procedure</span>Â <span id="alg1.l1.1" class="ltx_text ltx_font_smallcaps">FL+HC<span id="alg1.l1.1.1" class="ltx_text ltx_font_upright" style="float:right;"><math id="alg1.l1.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l1.1.1.m1.1a"><mo id="alg1.l1.1.1.m1.1.1" xref="alg1.l1.1.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.1.1.m1.1b"><ci id="alg1.l1.1.1.m1.1.1.cmml" xref="alg1.l1.1.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.1.m1.1c">\triangleright</annotation></semantics></math> On server
</span></span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Â Â Â Â Â Initialise <math id="alg1.l2.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">w</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">ğ‘¤</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w_{0}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Â Â Â Â Â <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span>Â each round <math id="alg1.l3.m1.2" class="ltx_Math" alttext="t\in[1,n]" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mi id="alg1.l3.m1.2.3.2" xref="alg1.l3.m1.2.3.2.cmml">t</mi><mo id="alg1.l3.m1.2.3.1" xref="alg1.l3.m1.2.3.1.cmml">âˆˆ</mo><mrow id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.2.3.3.2.1" xref="alg1.l3.m1.2.3.3.1.cmml">[</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.2.3.3.2.2" xref="alg1.l3.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">n</mi><mo stretchy="false" id="alg1.l3.m1.2.3.3.2.3" xref="alg1.l3.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><in id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1"></in><ci id="alg1.l3.m1.2.3.2.cmml" xref="alg1.l3.m1.2.3.2">ğ‘¡</ci><interval closure="closed" id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">ğ‘›</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">t\in[1,n]</annotation></semantics></math>Â <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>Â Â Â Â Â Â Â Â Â <math id="alg1.l4.m1.1" class="ltx_Math" alttext="w_{t+1}\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml"><mi id="alg1.l4.m1.1.1.2.3.2" xref="alg1.l4.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l4.m1.1.1.2.3.1" xref="alg1.l4.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l4.m1.1.1.2.3.3" xref="alg1.l4.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">â†</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">â†</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">ğ‘¤</ci><apply id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3"><plus id="alg1.l4.m1.1.1.2.3.1.cmml" xref="alg1.l4.m1.1.1.2.3.1"></plus><ci id="alg1.l4.m1.1.1.2.3.2.cmml" xref="alg1.l4.m1.1.1.2.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l4.m1.1.1.2.3.3.cmml" xref="alg1.l4.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">w_{t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_smallcaps">FederatedLearning</span>(<math id="alg1.l4.m2.2" class="ltx_Math" alttext="w_{t},K" display="inline"><semantics id="alg1.l4.m2.2a"><mrow id="alg1.l4.m2.2.2.1" xref="alg1.l4.m2.2.2.2.cmml"><msub id="alg1.l4.m2.2.2.1.1" xref="alg1.l4.m2.2.2.1.1.cmml"><mi id="alg1.l4.m2.2.2.1.1.2" xref="alg1.l4.m2.2.2.1.1.2.cmml">w</mi><mi id="alg1.l4.m2.2.2.1.1.3" xref="alg1.l4.m2.2.2.1.1.3.cmml">t</mi></msub><mo id="alg1.l4.m2.2.2.1.2" xref="alg1.l4.m2.2.2.2.cmml">,</mo><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.2b"><list id="alg1.l4.m2.2.2.2.cmml" xref="alg1.l4.m2.2.2.1"><apply id="alg1.l4.m2.2.2.1.1.cmml" xref="alg1.l4.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.2.2.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l4.m2.2.2.1.1.2.cmml" xref="alg1.l4.m2.2.2.1.1.2">ğ‘¤</ci><ci id="alg1.l4.m2.2.2.1.1.3.cmml" xref="alg1.l4.m2.2.2.1.1.3">ğ‘¡</ci></apply><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">ğ¾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.2c">w_{t},K</annotation></semantics></math>)

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>Â Â Â Â Â <span id="alg1.l5.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l5.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Â Â Â Â Â <math id="alg1.l6.m1.1" class="ltx_Math" alttext="w\leftarrow w_{t+1}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">w</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">â†</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">w</mi><mrow id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.3.3.2" xref="alg1.l6.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l6.m1.1.1.3.3.1" xref="alg1.l6.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l6.m1.1.1.3.3.3" xref="alg1.l6.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">â†</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">ğ‘¤</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">ğ‘¤</ci><apply id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3"><plus id="alg1.l6.m1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.3.3.1"></plus><ci id="alg1.l6.m1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.3.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l6.m1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">w\leftarrow w_{t+1}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Â Â Â Â Â <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>Â each client <math id="alg1.l7.m1.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">k</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">âˆˆ</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">ğ‘˜</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">ğ¾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">k\in K</annotation></semantics></math>Â <span id="alg1.l7.1" class="ltx_text ltx_font_bold">do<span id="alg1.l7.1.1" class="ltx_text ltx_font_medium" style="float:right;"><math id="alg1.l7.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l7.1.1.m1.1a"><mo id="alg1.l7.1.1.m1.1.1" xref="alg1.l7.1.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.1.m1.1b"><ci id="alg1.l7.1.1.m1.1.1.cmml" xref="alg1.l7.1.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.1.m1.1c">\triangleright</annotation></semantics></math> In parallel
</span></span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>Â Â Â Â Â Â Â Â Â <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\Delta w^{k}\leftarrow" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mrow id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.2.1" xref="alg1.l8.m1.1.1.2.1.cmml">â€‹</mo><msup id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">k</mi></msup></mrow><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">â†</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">â†</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><times id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2.1"></times><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">Î”</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">ğ‘¤</ci><ci id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">ğ‘˜</ci></apply></apply><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\Delta w^{k}\leftarrow</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l8.m2.2" class="ltx_Math" alttext="k,w" display="inline"><semantics id="alg1.l8.m2.2a"><mrow id="alg1.l8.m2.2.3.2" xref="alg1.l8.m2.2.3.1.cmml"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">k</mi><mo id="alg1.l8.m2.2.3.2.1" xref="alg1.l8.m2.2.3.1.cmml">,</mo><mi id="alg1.l8.m2.2.2" xref="alg1.l8.m2.2.2.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.2b"><list id="alg1.l8.m2.2.3.1.cmml" xref="alg1.l8.m2.2.3.2"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">ğ‘˜</ci><ci id="alg1.l8.m2.2.2.cmml" xref="alg1.l8.m2.2.2">ğ‘¤</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.2c">k,w</annotation></semantics></math>)

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>Â Â Â Â Â <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>Â Â Â Â Â <math id="alg1.l10.m1.1" class="ltx_Math" alttext="C\leftarrow" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">C</mi><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">â†</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">â†</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">ğ¶</ci><csymbol cd="latexml" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">C\leftarrow</annotation></semantics></math> HierarchicalClusteringAlgorithm(<math id="alg1.l10.m2.2" class="ltx_Math" alttext="\Delta w,P" display="inline"><semantics id="alg1.l10.m2.2a"><mrow id="alg1.l10.m2.2.2.1" xref="alg1.l10.m2.2.2.2.cmml"><mrow id="alg1.l10.m2.2.2.1.1" xref="alg1.l10.m2.2.2.1.1.cmml"><mi mathvariant="normal" id="alg1.l10.m2.2.2.1.1.2" xref="alg1.l10.m2.2.2.1.1.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.2.2.1.1.1" xref="alg1.l10.m2.2.2.1.1.1.cmml">â€‹</mo><mi id="alg1.l10.m2.2.2.1.1.3" xref="alg1.l10.m2.2.2.1.1.3.cmml">w</mi></mrow><mo id="alg1.l10.m2.2.2.1.2" xref="alg1.l10.m2.2.2.2.cmml">,</mo><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.2b"><list id="alg1.l10.m2.2.2.2.cmml" xref="alg1.l10.m2.2.2.1"><apply id="alg1.l10.m2.2.2.1.1.cmml" xref="alg1.l10.m2.2.2.1.1"><times id="alg1.l10.m2.2.2.1.1.1.cmml" xref="alg1.l10.m2.2.2.1.1.1"></times><ci id="alg1.l10.m2.2.2.1.1.2.cmml" xref="alg1.l10.m2.2.2.1.1.2">Î”</ci><ci id="alg1.l10.m2.2.2.1.1.3.cmml" xref="alg1.l10.m2.2.2.1.1.3">ğ‘¤</ci></apply><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">ğ‘ƒ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.2c">\Delta w,P</annotation></semantics></math>)

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.2.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>Â Â Â Â Â <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>Â <math id="alg1.l11.m1.1" class="ltx_Math" alttext="c\in C" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">c</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">âˆˆ</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><in id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></in><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">ğ‘</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">ğ¶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">c\in C</annotation></semantics></math>Â <span id="alg1.l11.1" class="ltx_text ltx_font_bold">do<span id="alg1.l11.1.1" class="ltx_text ltx_font_medium" style="float:right;"><math id="alg1.l11.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l11.1.1.m1.1a"><mo id="alg1.l11.1.1.m1.1.1" xref="alg1.l11.1.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.1.1.m1.1b"><ci id="alg1.l11.1.1.m1.1.1.cmml" xref="alg1.l11.1.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.1.1.m1.1c">\triangleright</annotation></semantics></math> In parallel
</span></span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>Â Â Â Â Â Â Â Â Â <math id="alg1.l12.m1.2" class="ltx_Math" alttext="w_{c,0}\leftarrow w" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.3" xref="alg1.l12.m1.2.3.cmml"><msub id="alg1.l12.m1.2.3.2" xref="alg1.l12.m1.2.3.2.cmml"><mi id="alg1.l12.m1.2.3.2.2" xref="alg1.l12.m1.2.3.2.2.cmml">w</mi><mrow id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l12.m1.2.2.2.4.1" xref="alg1.l12.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml">0</mn></mrow></msub><mo stretchy="false" id="alg1.l12.m1.2.3.1" xref="alg1.l12.m1.2.3.1.cmml">â†</mo><mi id="alg1.l12.m1.2.3.3" xref="alg1.l12.m1.2.3.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.3.cmml" xref="alg1.l12.m1.2.3"><ci id="alg1.l12.m1.2.3.1.cmml" xref="alg1.l12.m1.2.3.1">â†</ci><apply id="alg1.l12.m1.2.3.2.cmml" xref="alg1.l12.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.2.3.2.1.cmml" xref="alg1.l12.m1.2.3.2">subscript</csymbol><ci id="alg1.l12.m1.2.3.2.2.cmml" xref="alg1.l12.m1.2.3.2.2">ğ‘¤</ci><list id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.4"><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">ğ‘</ci><cn type="integer" id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2">0</cn></list></apply><ci id="alg1.l12.m1.2.3.3.cmml" xref="alg1.l12.m1.2.3.3">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">w_{c,0}\leftarrow w</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>Â Â Â Â Â Â Â Â Â <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>Â each round <math id="alg1.l13.m1.3" class="ltx_Math" alttext="t=1,2,\dots" display="inline"><semantics id="alg1.l13.m1.3a"><mrow id="alg1.l13.m1.3.4" xref="alg1.l13.m1.3.4.cmml"><mi id="alg1.l13.m1.3.4.2" xref="alg1.l13.m1.3.4.2.cmml">t</mi><mo id="alg1.l13.m1.3.4.1" xref="alg1.l13.m1.3.4.1.cmml">=</mo><mrow id="alg1.l13.m1.3.4.3.2" xref="alg1.l13.m1.3.4.3.1.cmml"><mn id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">1</mn><mo id="alg1.l13.m1.3.4.3.2.1" xref="alg1.l13.m1.3.4.3.1.cmml">,</mo><mn id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml">2</mn><mo id="alg1.l13.m1.3.4.3.2.2" xref="alg1.l13.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml">â€¦</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.3b"><apply id="alg1.l13.m1.3.4.cmml" xref="alg1.l13.m1.3.4"><eq id="alg1.l13.m1.3.4.1.cmml" xref="alg1.l13.m1.3.4.1"></eq><ci id="alg1.l13.m1.3.4.2.cmml" xref="alg1.l13.m1.3.4.2">ğ‘¡</ci><list id="alg1.l13.m1.3.4.3.1.cmml" xref="alg1.l13.m1.3.4.3.2"><cn type="integer" id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">1</cn><cn type="integer" id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2">2</cn><ci id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3">â€¦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.3c">t=1,2,\dots</annotation></semantics></math>Â <span id="alg1.l13.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â <math id="alg1.l14.m1.2" class="ltx_Math" alttext="w_{c,t+1}\leftarrow" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3" xref="alg1.l14.m1.2.3.cmml"><msub id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.2.cmml"><mi id="alg1.l14.m1.2.3.2.2" xref="alg1.l14.m1.2.3.2.2.cmml">w</mi><mrow id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l14.m1.2.2.2.2.1" xref="alg1.l14.m1.2.2.2.2.1.cmml"><mi id="alg1.l14.m1.2.2.2.2.1.2" xref="alg1.l14.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.2.2.1.1" xref="alg1.l14.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.2.2.1.3" xref="alg1.l14.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="alg1.l14.m1.2.3.1" xref="alg1.l14.m1.2.3.1.cmml">â†</mo><mi id="alg1.l14.m1.2.3.3" xref="alg1.l14.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.3.cmml" xref="alg1.l14.m1.2.3"><ci id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.1">â†</ci><apply id="alg1.l14.m1.2.3.2.cmml" xref="alg1.l14.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.2.1.cmml" xref="alg1.l14.m1.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.2.3.2.2.cmml" xref="alg1.l14.m1.2.3.2.2">ğ‘¤</ci><list id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">ğ‘</ci><apply id="alg1.l14.m1.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.1"><plus id="alg1.l14.m1.2.2.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.1.1"></plus><ci id="alg1.l14.m1.2.2.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.2.2.1.2">ğ‘¡</ci><cn type="integer" id="alg1.l14.m1.2.2.2.2.1.3.cmml" xref="alg1.l14.m1.2.2.2.2.1.3">1</cn></apply></list></apply><csymbol cd="latexml" id="alg1.l14.m1.2.3.3.cmml" xref="alg1.l14.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">w_{c,t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l14.2" class="ltx_text ltx_font_smallcaps">FederatedLearning</span>(<math id="alg1.l14.m2.4" class="ltx_Math" alttext="w_{c,t},K_{c}" display="inline"><semantics id="alg1.l14.m2.4a"><mrow id="alg1.l14.m2.4.4.2" xref="alg1.l14.m2.4.4.3.cmml"><msub id="alg1.l14.m2.3.3.1.1" xref="alg1.l14.m2.3.3.1.1.cmml"><mi id="alg1.l14.m2.3.3.1.1.2" xref="alg1.l14.m2.3.3.1.1.2.cmml">w</mi><mrow id="alg1.l14.m2.2.2.2.4" xref="alg1.l14.m2.2.2.2.3.cmml"><mi id="alg1.l14.m2.1.1.1.1" xref="alg1.l14.m2.1.1.1.1.cmml">c</mi><mo id="alg1.l14.m2.2.2.2.4.1" xref="alg1.l14.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l14.m2.2.2.2.2" xref="alg1.l14.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l14.m2.4.4.2.3" xref="alg1.l14.m2.4.4.3.cmml">,</mo><msub id="alg1.l14.m2.4.4.2.2" xref="alg1.l14.m2.4.4.2.2.cmml"><mi id="alg1.l14.m2.4.4.2.2.2" xref="alg1.l14.m2.4.4.2.2.2.cmml">K</mi><mi id="alg1.l14.m2.4.4.2.2.3" xref="alg1.l14.m2.4.4.2.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.4b"><list id="alg1.l14.m2.4.4.3.cmml" xref="alg1.l14.m2.4.4.2"><apply id="alg1.l14.m2.3.3.1.1.cmml" xref="alg1.l14.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.3.3.1.1.1.cmml" xref="alg1.l14.m2.3.3.1.1">subscript</csymbol><ci id="alg1.l14.m2.3.3.1.1.2.cmml" xref="alg1.l14.m2.3.3.1.1.2">ğ‘¤</ci><list id="alg1.l14.m2.2.2.2.3.cmml" xref="alg1.l14.m2.2.2.2.4"><ci id="alg1.l14.m2.1.1.1.1.cmml" xref="alg1.l14.m2.1.1.1.1">ğ‘</ci><ci id="alg1.l14.m2.2.2.2.2.cmml" xref="alg1.l14.m2.2.2.2.2">ğ‘¡</ci></list></apply><apply id="alg1.l14.m2.4.4.2.2.cmml" xref="alg1.l14.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l14.m2.4.4.2.2.1.cmml" xref="alg1.l14.m2.4.4.2.2">subscript</csymbol><ci id="alg1.l14.m2.4.4.2.2.2.cmml" xref="alg1.l14.m2.4.4.2.2.2">ğ¾</ci><ci id="alg1.l14.m2.4.4.2.2.3.cmml" xref="alg1.l14.m2.4.4.2.2.3">ğ‘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.4c">w_{c,t},K_{c}</annotation></semantics></math>)

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>Â Â Â Â Â Â Â Â Â <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>Â Â Â Â Â <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span><span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l17.3" class="ltx_text ltx_font_bold">procedure</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.2.1.1" class="ltx_text" style="font-size:80%;">19:</span></span><span id="alg1.l19.3" class="ltx_text ltx_font_bold">procedure</span>Â <span id="alg1.l19.4" class="ltx_text ltx_font_smallcaps">FederatedLearning</span>(<math id="alg1.l19.m1.2" class="ltx_Math" alttext="w_{t},K" display="inline"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.2.1" xref="alg1.l19.m1.2.2.2.cmml"><msub id="alg1.l19.m1.2.2.1.1" xref="alg1.l19.m1.2.2.1.1.cmml"><mi id="alg1.l19.m1.2.2.1.1.2" xref="alg1.l19.m1.2.2.1.1.2.cmml">w</mi><mi id="alg1.l19.m1.2.2.1.1.3" xref="alg1.l19.m1.2.2.1.1.3.cmml">t</mi></msub><mo id="alg1.l19.m1.2.2.1.2" xref="alg1.l19.m1.2.2.2.cmml">,</mo><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><list id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.1"><apply id="alg1.l19.m1.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l19.m1.2.2.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.2">ğ‘¤</ci><ci id="alg1.l19.m1.2.2.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.3">ğ‘¡</ci></apply><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">ğ¾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">w_{t},K</annotation></semantics></math>)<span id="alg1.l19.1" class="ltx_text" style="float:right;"><math id="alg1.l19.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l19.1.m1.1a"><mo id="alg1.l19.1.m1.1.1" xref="alg1.l19.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l19.1.m1.1b"><ci id="alg1.l19.1.m1.1.1.cmml" xref="alg1.l19.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.1.m1.1c">\triangleright</annotation></semantics></math> On server
</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>Â Â Â Â Â <math id="alg1.l20.m1.3" class="ltx_Math" alttext="m\leftarrow\max{(\alpha\cdot K,1)}" display="inline"><semantics id="alg1.l20.m1.3a"><mrow id="alg1.l20.m1.3.3" xref="alg1.l20.m1.3.3.cmml"><mi id="alg1.l20.m1.3.3.3" xref="alg1.l20.m1.3.3.3.cmml">m</mi><mo stretchy="false" id="alg1.l20.m1.3.3.2" xref="alg1.l20.m1.3.3.2.cmml">â†</mo><mrow id="alg1.l20.m1.3.3.1.1" xref="alg1.l20.m1.3.3.1.2.cmml"><mi id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml">max</mi><mo id="alg1.l20.m1.3.3.1.1a" xref="alg1.l20.m1.3.3.1.2.cmml">â¡</mo><mrow id="alg1.l20.m1.3.3.1.1.1" xref="alg1.l20.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.2" xref="alg1.l20.m1.3.3.1.2.cmml">(</mo><mrow id="alg1.l20.m1.3.3.1.1.1.1" xref="alg1.l20.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l20.m1.3.3.1.1.1.1.2" xref="alg1.l20.m1.3.3.1.1.1.1.2.cmml">Î±</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l20.m1.3.3.1.1.1.1.1" xref="alg1.l20.m1.3.3.1.1.1.1.1.cmml">â‹…</mo><mi id="alg1.l20.m1.3.3.1.1.1.1.3" xref="alg1.l20.m1.3.3.1.1.1.1.3.cmml">K</mi></mrow><mo id="alg1.l20.m1.3.3.1.1.1.3" xref="alg1.l20.m1.3.3.1.2.cmml">,</mo><mn id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l20.m1.3.3.1.1.1.4" xref="alg1.l20.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.3b"><apply id="alg1.l20.m1.3.3.cmml" xref="alg1.l20.m1.3.3"><ci id="alg1.l20.m1.3.3.2.cmml" xref="alg1.l20.m1.3.3.2">â†</ci><ci id="alg1.l20.m1.3.3.3.cmml" xref="alg1.l20.m1.3.3.3">ğ‘š</ci><apply id="alg1.l20.m1.3.3.1.2.cmml" xref="alg1.l20.m1.3.3.1.1"><max id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"></max><apply id="alg1.l20.m1.3.3.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1"><ci id="alg1.l20.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.1">â‹…</ci><ci id="alg1.l20.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.2">ğ›¼</ci><ci id="alg1.l20.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l20.m1.3.3.1.1.1.1.3">ğ¾</ci></apply><cn type="integer" id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.3c">m\leftarrow\max{(\alpha\cdot K,1)}</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>Â Â Â Â Â <math id="alg1.l21.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msub id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml"><mi id="alg1.l21.m1.1.1.2.2" xref="alg1.l21.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">â†</mo><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">â†</ci><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2.2">ğ‘†</ci><ci id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">ğ‘¡</ci></apply><csymbol cd="latexml" id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">S_{t}\leftarrow</annotation></semantics></math> (random set of <math id="alg1.l21.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l21.m2.1a"><mi id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><ci id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">m</annotation></semantics></math> clients)

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.2.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>Â Â Â Â Â <span id="alg1.l22.3" class="ltx_text ltx_font_bold">for</span>Â each client <math id="alg1.l22.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">k</mi><mo id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">âˆˆ</mo><msub id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.3.2" xref="alg1.l22.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l22.m1.1.1.3.3" xref="alg1.l22.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><in id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1"></in><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">ğ‘˜</ci><apply id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.3.2">ğ‘†</ci><ci id="alg1.l22.m1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.3.3">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">k\in S_{t}</annotation></semantics></math>Â <span id="alg1.l22.1" class="ltx_text ltx_font_bold">do<span id="alg1.l22.1.1" class="ltx_text ltx_font_medium" style="float:right;"><math id="alg1.l22.1.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l22.1.1.m1.1a"><mo id="alg1.l22.1.1.m1.1.1" xref="alg1.l22.1.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l22.1.1.m1.1b"><ci id="alg1.l22.1.1.m1.1.1.cmml" xref="alg1.l22.1.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.1.1.m1.1c">\triangleright</annotation></semantics></math> In parallel
</span></span>
</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>Â Â Â Â Â Â Â Â Â <math id="alg1.l23.m1.1" class="ltx_Math" alttext="w_{t+1}^{k}\leftarrow" display="inline"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><msubsup id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.2.2.2" xref="alg1.l23.m1.1.1.2.2.2.cmml">w</mi><mrow id="alg1.l23.m1.1.1.2.2.3" xref="alg1.l23.m1.1.1.2.2.3.cmml"><mi id="alg1.l23.m1.1.1.2.2.3.2" xref="alg1.l23.m1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l23.m1.1.1.2.2.3.1" xref="alg1.l23.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l23.m1.1.1.2.2.3.3" xref="alg1.l23.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l23.m1.1.1.2.3" xref="alg1.l23.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">â†</mo><mi id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><ci id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1">â†</ci><apply id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.2">superscript</csymbol><apply id="alg1.l23.m1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.2.1.cmml" xref="alg1.l23.m1.1.1.2">subscript</csymbol><ci id="alg1.l23.m1.1.1.2.2.2.cmml" xref="alg1.l23.m1.1.1.2.2.2">ğ‘¤</ci><apply id="alg1.l23.m1.1.1.2.2.3.cmml" xref="alg1.l23.m1.1.1.2.2.3"><plus id="alg1.l23.m1.1.1.2.2.3.1.cmml" xref="alg1.l23.m1.1.1.2.2.3.1"></plus><ci id="alg1.l23.m1.1.1.2.2.3.2.cmml" xref="alg1.l23.m1.1.1.2.2.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l23.m1.1.1.2.2.3.3.cmml" xref="alg1.l23.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l23.m1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.2.3">ğ‘˜</ci></apply><csymbol cd="latexml" id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">w_{t+1}^{k}\leftarrow</annotation></semantics></math> <span id="alg1.l23.2" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l23.m2.2" class="ltx_Math" alttext="k,w_{t}" display="inline"><semantics id="alg1.l23.m2.2a"><mrow id="alg1.l23.m2.2.2.1" xref="alg1.l23.m2.2.2.2.cmml"><mi id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml">k</mi><mo id="alg1.l23.m2.2.2.1.2" xref="alg1.l23.m2.2.2.2.cmml">,</mo><msub id="alg1.l23.m2.2.2.1.1" xref="alg1.l23.m2.2.2.1.1.cmml"><mi id="alg1.l23.m2.2.2.1.1.2" xref="alg1.l23.m2.2.2.1.1.2.cmml">w</mi><mi id="alg1.l23.m2.2.2.1.1.3" xref="alg1.l23.m2.2.2.1.1.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.2b"><list id="alg1.l23.m2.2.2.2.cmml" xref="alg1.l23.m2.2.2.1"><ci id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1">ğ‘˜</ci><apply id="alg1.l23.m2.2.2.1.1.cmml" xref="alg1.l23.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l23.m2.2.2.1.1.1.cmml" xref="alg1.l23.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l23.m2.2.2.1.1.2.cmml" xref="alg1.l23.m2.2.2.1.1.2">ğ‘¤</ci><ci id="alg1.l23.m2.2.2.1.1.3.cmml" xref="alg1.l23.m2.2.2.1.1.3">ğ‘¡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.2c">k,w_{t}</annotation></semantics></math>)

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>Â Â Â Â Â <span id="alg1.l24.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l24.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>Â Â Â Â Â <math id="alg1.l25.m1.1" class="ltx_Math" alttext="w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}" display="inline"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><msub id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.2.2" xref="alg1.l25.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l25.m1.1.1.2.3" xref="alg1.l25.m1.1.1.2.3.cmml"><mi id="alg1.l25.m1.1.1.2.3.2" xref="alg1.l25.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l25.m1.1.1.2.3.1" xref="alg1.l25.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l25.m1.1.1.2.3.3" xref="alg1.l25.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1.cmml">â†</mo><mrow id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml"><msubsup id="alg1.l25.m1.1.1.3.1" xref="alg1.l25.m1.1.1.3.1.cmml"><mo id="alg1.l25.m1.1.1.3.1.2.2" xref="alg1.l25.m1.1.1.3.1.2.2.cmml">âˆ‘</mo><mrow id="alg1.l25.m1.1.1.3.1.2.3" xref="alg1.l25.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l25.m1.1.1.3.1.2.3.2" xref="alg1.l25.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l25.m1.1.1.3.1.2.3.1" xref="alg1.l25.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l25.m1.1.1.3.1.2.3.3" xref="alg1.l25.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l25.m1.1.1.3.1.3" xref="alg1.l25.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l25.m1.1.1.3.2" xref="alg1.l25.m1.1.1.3.2.cmml"><mfrac id="alg1.l25.m1.1.1.3.2.2" xref="alg1.l25.m1.1.1.3.2.2.cmml"><msub id="alg1.l25.m1.1.1.3.2.2.2" xref="alg1.l25.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l25.m1.1.1.3.2.2.2.2" xref="alg1.l25.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg1.l25.m1.1.1.3.2.2.2.3" xref="alg1.l25.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l25.m1.1.1.3.2.2.3" xref="alg1.l25.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l25.m1.1.1.3.2.1" xref="alg1.l25.m1.1.1.3.2.1.cmml">â€‹</mo><msubsup id="alg1.l25.m1.1.1.3.2.3" xref="alg1.l25.m1.1.1.3.2.3.cmml"><mi id="alg1.l25.m1.1.1.3.2.3.2.2" xref="alg1.l25.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="alg1.l25.m1.1.1.3.2.3.2.3" xref="alg1.l25.m1.1.1.3.2.3.2.3.cmml"><mi id="alg1.l25.m1.1.1.3.2.3.2.3.2" xref="alg1.l25.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="alg1.l25.m1.1.1.3.2.3.2.3.1" xref="alg1.l25.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="alg1.l25.m1.1.1.3.2.3.2.3.3" xref="alg1.l25.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l25.m1.1.1.3.2.3.3" xref="alg1.l25.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><ci id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">â†</ci><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.2">subscript</csymbol><ci id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2.2">ğ‘¤</ci><apply id="alg1.l25.m1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.2.3"><plus id="alg1.l25.m1.1.1.2.3.1.cmml" xref="alg1.l25.m1.1.1.2.3.1"></plus><ci id="alg1.l25.m1.1.1.2.3.2.cmml" xref="alg1.l25.m1.1.1.2.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l25.m1.1.1.2.3.3.cmml" xref="alg1.l25.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3"><apply id="alg1.l25.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.1.1.cmml" xref="alg1.l25.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l25.m1.1.1.3.1.2.cmml" xref="alg1.l25.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.1.2.1.cmml" xref="alg1.l25.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l25.m1.1.1.3.1.2.2.cmml" xref="alg1.l25.m1.1.1.3.1.2.2"></sum><apply id="alg1.l25.m1.1.1.3.1.2.3.cmml" xref="alg1.l25.m1.1.1.3.1.2.3"><eq id="alg1.l25.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l25.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l25.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l25.m1.1.1.3.1.2.3.2">ğ‘˜</ci><cn type="integer" id="alg1.l25.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l25.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l25.m1.1.1.3.1.3.cmml" xref="alg1.l25.m1.1.1.3.1.3">ğ¾</ci></apply><apply id="alg1.l25.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.3.2"><times id="alg1.l25.m1.1.1.3.2.1.cmml" xref="alg1.l25.m1.1.1.3.2.1"></times><apply id="alg1.l25.m1.1.1.3.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.2"><divide id="alg1.l25.m1.1.1.3.2.2.1.cmml" xref="alg1.l25.m1.1.1.3.2.2"></divide><apply id="alg1.l25.m1.1.1.3.2.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l25.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.2.2.2">ğ‘›</ci><ci id="alg1.l25.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.2.2.3">ğ‘˜</ci></apply><ci id="alg1.l25.m1.1.1.3.2.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.2.3">ğ‘›</ci></apply><apply id="alg1.l25.m1.1.1.3.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.3.1.cmml" xref="alg1.l25.m1.1.1.3.2.3">superscript</csymbol><apply id="alg1.l25.m1.1.1.3.2.3.2.cmml" xref="alg1.l25.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l25.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.3.2.2">ğ‘¤</ci><apply id="alg1.l25.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.3.2.3"><plus id="alg1.l25.m1.1.1.3.2.3.2.3.1.cmml" xref="alg1.l25.m1.1.1.3.2.3.2.3.1"></plus><ci id="alg1.l25.m1.1.1.3.2.3.2.3.2.cmml" xref="alg1.l25.m1.1.1.3.2.3.2.3.2">ğ‘¡</ci><cn type="integer" id="alg1.l25.m1.1.1.3.2.3.2.3.3.cmml" xref="alg1.l25.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="alg1.l25.m1.1.1.3.2.3.3.cmml" xref="alg1.l25.m1.1.1.3.2.3.3">ğ‘˜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">w_{t+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span><span id="alg1.l26.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l26.3" class="ltx_text ltx_font_bold">procedure</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l27.1.1.1" class="ltx_text" style="font-size:80%;">27:</span></span>
</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l28.3.1.1" class="ltx_text" style="font-size:80%;">28:</span></span><span id="alg1.l28.4" class="ltx_text ltx_font_bold">procedure</span>Â <span id="alg1.l28.5" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l28.m1.2" class="ltx_Math" alttext="k,w" display="inline"><semantics id="alg1.l28.m1.2a"><mrow id="alg1.l28.m1.2.3.2" xref="alg1.l28.m1.2.3.1.cmml"><mi id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">k</mi><mo id="alg1.l28.m1.2.3.2.1" xref="alg1.l28.m1.2.3.1.cmml">,</mo><mi id="alg1.l28.m1.2.2" xref="alg1.l28.m1.2.2.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.2b"><list id="alg1.l28.m1.2.3.1.cmml" xref="alg1.l28.m1.2.3.2"><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">ğ‘˜</ci><ci id="alg1.l28.m1.2.2.cmml" xref="alg1.l28.m1.2.2">ğ‘¤</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.2c">k,w</annotation></semantics></math>)<span id="alg1.l28.2" class="ltx_text" style="float:right;"><math id="alg1.l28.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l28.1.m1.1a"><mo id="alg1.l28.1.m1.1.1" xref="alg1.l28.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg1.l28.1.m1.1b"><ci id="alg1.l28.1.m1.1.1.cmml" xref="alg1.l28.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.1.m1.1c">\triangleright</annotation></semantics></math> On client <math id="alg1.l28.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l28.2.m2.1a"><mi id="alg1.l28.2.m2.1.1" xref="alg1.l28.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l28.2.m2.1b"><ci id="alg1.l28.2.m2.1.1.cmml" xref="alg1.l28.2.m2.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.2.m2.1c">k</annotation></semantics></math>
</span>
</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span>Â Â Â Â Â <math id="alg1.l29.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow" display="inline"><semantics id="alg1.l29.m1.1a"><mrow id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2.cmml">â„¬</mi><mo stretchy="false" id="alg1.l29.m1.1.1.1" xref="alg1.l29.m1.1.1.1.cmml">â†</mo><mi id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b"><apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1"><ci id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1">â†</ci><ci id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2">â„¬</ci><csymbol cd="latexml" id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.1c">\mathcal{B}\leftarrow</annotation></semantics></math> (Split <math id="alg1.l29.m2.1" class="ltx_Math" alttext="\mathcal{P}_{k}" display="inline"><semantics id="alg1.l29.m2.1a"><msub id="alg1.l29.m2.1.1" xref="alg1.l29.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l29.m2.1.1.2" xref="alg1.l29.m2.1.1.2.cmml">ğ’«</mi><mi id="alg1.l29.m2.1.1.3" xref="alg1.l29.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l29.m2.1b"><apply id="alg1.l29.m2.1.1.cmml" xref="alg1.l29.m2.1.1"><csymbol cd="ambiguous" id="alg1.l29.m2.1.1.1.cmml" xref="alg1.l29.m2.1.1">subscript</csymbol><ci id="alg1.l29.m2.1.1.2.cmml" xref="alg1.l29.m2.1.1.2">ğ’«</ci><ci id="alg1.l29.m2.1.1.3.cmml" xref="alg1.l29.m2.1.1.3">ğ‘˜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m2.1c">\mathcal{P}_{k}</annotation></semantics></math> into batches of size <math id="alg1.l29.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l29.m3.1a"><mi id="alg1.l29.m3.1.1" xref="alg1.l29.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l29.m3.1b"><ci id="alg1.l29.m3.1.1.cmml" xref="alg1.l29.m3.1.1">ğµ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m3.1c">B</annotation></semantics></math>)

</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l30.1.1.1" class="ltx_text" style="font-size:80%;">30:</span></span>Â Â Â Â Â <span id="alg1.l30.2" class="ltx_text ltx_font_bold">for</span>Â each local epoch <math id="alg1.l30.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l30.m1.1a"><mi id="alg1.l30.m1.1.1" xref="alg1.l30.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.1b"><ci id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.1c">i</annotation></semantics></math> from 1 to <math id="alg1.l30.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l30.m2.1a"><mi id="alg1.l30.m2.1.1" xref="alg1.l30.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l30.m2.1b"><ci id="alg1.l30.m2.1.1.cmml" xref="alg1.l30.m2.1.1">ğ¸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m2.1c">E</annotation></semantics></math>Â <span id="alg1.l30.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l31.1.1.1" class="ltx_text" style="font-size:80%;">31:</span></span>Â Â Â Â Â Â Â Â Â <span id="alg1.l31.2" class="ltx_text ltx_font_bold">for</span>Â batch <math id="alg1.l31.m1.1" class="ltx_Math" alttext="b\in\mathcal{B}" display="inline"><semantics id="alg1.l31.m1.1a"><mrow id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml"><mi id="alg1.l31.m1.1.1.2" xref="alg1.l31.m1.1.1.2.cmml">b</mi><mo id="alg1.l31.m1.1.1.1" xref="alg1.l31.m1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l31.m1.1.1.3" xref="alg1.l31.m1.1.1.3.cmml">â„¬</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><apply id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1"><in id="alg1.l31.m1.1.1.1.cmml" xref="alg1.l31.m1.1.1.1"></in><ci id="alg1.l31.m1.1.1.2.cmml" xref="alg1.l31.m1.1.1.2">ğ‘</ci><ci id="alg1.l31.m1.1.1.3.cmml" xref="alg1.l31.m1.1.1.3">â„¬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">b\in\mathcal{B}</annotation></semantics></math>Â <span id="alg1.l31.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l32.1.1.1" class="ltx_text" style="font-size:80%;">32:</span></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â <math id="alg1.l32.m1.2" class="ltx_Math" alttext="w\leftarrow w-\eta\nabla\mathcal{L}(w;b)" display="inline"><semantics id="alg1.l32.m1.2a"><mrow id="alg1.l32.m1.2.3" xref="alg1.l32.m1.2.3.cmml"><mi id="alg1.l32.m1.2.3.2" xref="alg1.l32.m1.2.3.2.cmml">w</mi><mo stretchy="false" id="alg1.l32.m1.2.3.1" xref="alg1.l32.m1.2.3.1.cmml">â†</mo><mrow id="alg1.l32.m1.2.3.3" xref="alg1.l32.m1.2.3.3.cmml"><mi id="alg1.l32.m1.2.3.3.2" xref="alg1.l32.m1.2.3.3.2.cmml">w</mi><mo id="alg1.l32.m1.2.3.3.1" xref="alg1.l32.m1.2.3.3.1.cmml">âˆ’</mo><mrow id="alg1.l32.m1.2.3.3.3" xref="alg1.l32.m1.2.3.3.3.cmml"><mi id="alg1.l32.m1.2.3.3.3.2" xref="alg1.l32.m1.2.3.3.3.2.cmml">Î·</mi><mo lspace="0.167em" rspace="0em" id="alg1.l32.m1.2.3.3.3.1" xref="alg1.l32.m1.2.3.3.3.1.cmml">â€‹</mo><mrow id="alg1.l32.m1.2.3.3.3.3" xref="alg1.l32.m1.2.3.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l32.m1.2.3.3.3.3.1" xref="alg1.l32.m1.2.3.3.3.3.1.cmml">âˆ‡</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l32.m1.2.3.3.3.3.2" xref="alg1.l32.m1.2.3.3.3.3.2.cmml">â„’</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l32.m1.2.3.3.3.1a" xref="alg1.l32.m1.2.3.3.3.1.cmml">â€‹</mo><mrow id="alg1.l32.m1.2.3.3.3.4.2" xref="alg1.l32.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l32.m1.2.3.3.3.4.2.1" xref="alg1.l32.m1.2.3.3.3.4.1.cmml">(</mo><mi id="alg1.l32.m1.1.1" xref="alg1.l32.m1.1.1.cmml">w</mi><mo id="alg1.l32.m1.2.3.3.3.4.2.2" xref="alg1.l32.m1.2.3.3.3.4.1.cmml">;</mo><mi id="alg1.l32.m1.2.2" xref="alg1.l32.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg1.l32.m1.2.3.3.3.4.2.3" xref="alg1.l32.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.2b"><apply id="alg1.l32.m1.2.3.cmml" xref="alg1.l32.m1.2.3"><ci id="alg1.l32.m1.2.3.1.cmml" xref="alg1.l32.m1.2.3.1">â†</ci><ci id="alg1.l32.m1.2.3.2.cmml" xref="alg1.l32.m1.2.3.2">ğ‘¤</ci><apply id="alg1.l32.m1.2.3.3.cmml" xref="alg1.l32.m1.2.3.3"><minus id="alg1.l32.m1.2.3.3.1.cmml" xref="alg1.l32.m1.2.3.3.1"></minus><ci id="alg1.l32.m1.2.3.3.2.cmml" xref="alg1.l32.m1.2.3.3.2">ğ‘¤</ci><apply id="alg1.l32.m1.2.3.3.3.cmml" xref="alg1.l32.m1.2.3.3.3"><times id="alg1.l32.m1.2.3.3.3.1.cmml" xref="alg1.l32.m1.2.3.3.3.1"></times><ci id="alg1.l32.m1.2.3.3.3.2.cmml" xref="alg1.l32.m1.2.3.3.3.2">ğœ‚</ci><apply id="alg1.l32.m1.2.3.3.3.3.cmml" xref="alg1.l32.m1.2.3.3.3.3"><ci id="alg1.l32.m1.2.3.3.3.3.1.cmml" xref="alg1.l32.m1.2.3.3.3.3.1">âˆ‡</ci><ci id="alg1.l32.m1.2.3.3.3.3.2.cmml" xref="alg1.l32.m1.2.3.3.3.3.2">â„’</ci></apply><list id="alg1.l32.m1.2.3.3.3.4.1.cmml" xref="alg1.l32.m1.2.3.3.3.4.2"><ci id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1">ğ‘¤</ci><ci id="alg1.l32.m1.2.2.cmml" xref="alg1.l32.m1.2.2">ğ‘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.2c">w\leftarrow w-\eta\nabla\mathcal{L}(w;b)</annotation></semantics></math>

</div>
<div id="alg1.l33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l33.1.1.1" class="ltx_text" style="font-size:80%;">33:</span></span>Â Â Â Â Â Â Â Â Â <span id="alg1.l33.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l33.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l34.1.1.1" class="ltx_text" style="font-size:80%;">34:</span></span>Â Â Â Â Â <span id="alg1.l34.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l34.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l35.1.1.1" class="ltx_text" style="font-size:80%;">35:</span></span>Â Â Â Â Â return <math id="alg1.l35.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l35.m1.1a"><mi id="alg1.l35.m1.1.1" xref="alg1.l35.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l35.m1.1b"><ci id="alg1.l35.m1.1.1.cmml" xref="alg1.l35.m1.1.1">ğ‘¤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l35.m1.1c">w</annotation></semantics></math> to server

</div>
<div id="alg1.l36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l36.1.1.1" class="ltx_text" style="font-size:80%;">36:</span></span><span id="alg1.l36.2" class="ltx_text ltx_font_bold">end</span>Â <span id="alg1.l36.3" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Experiment setup</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Our work focuses on the computer vision image classification problem of identifying handwritten digits from pixel data. The well-known MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> was chosen for this purpose as it has been studied by various FL researchers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and provides a simple enough task to test various clustered settings and data partitions. The MNIST dataset contains 60,000 training examples and 10,000 test examples.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.4" class="ltx_p">The data partitions were designed specifically to target various ways in which data distributions might differ between clients. The iid setting shuffles all the data and divides it among 100 clients evenly (600 training examples each). In this scenario, <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{i}=\mathcal{P}_{j}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.2.2" xref="S2.SS1.p2.1.m1.1.1.2.2.cmml">ğ’«</mi><mi id="S2.SS1.p2.1.m1.1.1.2.3" xref="S2.SS1.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.p2.1.m1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.cmml">=</mo><msub id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.3.2.cmml">ğ’«</mi><mi id="S2.SS1.p2.1.m1.1.1.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><eq id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1"></eq><apply id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2.2">ğ’«</ci><ci id="S2.SS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.p2.1.m1.1.1.2.3">ğ‘–</ci></apply><apply id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2">ğ’«</ci><ci id="S2.SS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{P}_{i}=\mathcal{P}_{j}</annotation></semantics></math> for all pairs of clients <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">i</annotation></semantics></math> and <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">j</annotation></semantics></math>. The first non-iid setting, referred to as pathological non-iid (as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>) partitions the data such that clients receive digits corresponding to only 2 labels. For example the first client might receive 300 examples labelled as 2 and 300 examples labelled as 7. Subsequent clients might receive different labels. Again all clients have 600 examples to perform local learning on. In this setting, we test how the FL model performs with label distribution skew, as <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{P}(y)" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.2" xref="S2.SS1.p2.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.4.m4.1.2.2" xref="S2.SS1.p2.4.m4.1.2.2.cmml">ğ’«</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.4.m4.1.2.1" xref="S2.SS1.p2.4.m4.1.2.1.cmml">â€‹</mo><mrow id="S2.SS1.p2.4.m4.1.2.3.2" xref="S2.SS1.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS1.p2.4.m4.1.2.3.2.1" xref="S2.SS1.p2.4.m4.1.2.cmml">(</mo><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">y</mi><mo stretchy="false" id="S2.SS1.p2.4.m4.1.2.3.2.2" xref="S2.SS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.2.cmml" xref="S2.SS1.p2.4.m4.1.2"><times id="S2.SS1.p2.4.m4.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.2.1"></times><ci id="S2.SS1.p2.4.m4.1.2.2.cmml" xref="S2.SS1.p2.4.m4.1.2.2">ğ’«</ci><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">ğ‘¦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\mathcal{P}(y)</annotation></semantics></math> varies across clients.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">The next non-iid setting, referred to as label-swapped non-iid (described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>) first shuffles the data and then partitions the data into four groups. For each group two digit labels are swapped. For example one group might swap all digits labelled as 3 to 9 and vice versa. Each group is then evenly distributed to 25 clients, resulting in 100 clients each with 600 training examples. This way the clients naturally form 4 clusters and allow us to test FLâ€™s ability to train models in the presence of concept shift (<math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{P}(y|x)" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">ğ’«</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">â€‹</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.1.m1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.SS1.p3.1.m1.1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.SS1.p3.1.m1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><times id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2"></times><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">ğ’«</ci><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2">ğ‘¦</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3">ğ‘¥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\mathcal{P}(y|x)</annotation></semantics></math> varies between clients).</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.2" class="ltx_p">The final non-iid setting represents a slightly more challenging task, but a more realistic setting. The FEMNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> is used to classify not only 10 handwritten digits but also 26 uppercase and 26 lowercase letters and is pre-partitioned according to the person who wrote the characters. From the original 3500 users in the dataset, 367 users were randomly selected to form the dataset for each of 367 clients. Each client has access to an uneven number of samples (between 12 and 386 samples). This scenario tests FL in the presence of feature distribution skew, where <math id="S2.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{P}(x)" display="inline"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.1.m1.1.2.2" xref="S2.SS1.p4.1.m1.1.2.2.cmml">ğ’«</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p4.1.m1.1.2.1" xref="S2.SS1.p4.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S2.SS1.p4.1.m1.1.2.3.2" xref="S2.SS1.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p4.1.m1.1.2.3.2.1" xref="S2.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p4.1.m1.1.2.3.2.2" xref="S2.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.2"><times id="S2.SS1.p4.1.m1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.1.2.1"></times><ci id="S2.SS1.p4.1.m1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.1.2.2">ğ’«</ci><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">ğ‘¥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\mathcal{P}(x)</annotation></semantics></math> varies over the clients as different users write characters in subtly different ways. Additionally, due to the uneven sample sizes, <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{P}(y)" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><mrow id="S2.SS1.p4.2.m2.1.2" xref="S2.SS1.p4.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.2.m2.1.2.2" xref="S2.SS1.p4.2.m2.1.2.2.cmml">ğ’«</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p4.2.m2.1.2.1" xref="S2.SS1.p4.2.m2.1.2.1.cmml">â€‹</mo><mrow id="S2.SS1.p4.2.m2.1.2.3.2" xref="S2.SS1.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p4.2.m2.1.2.3.2.1" xref="S2.SS1.p4.2.m2.1.2.cmml">(</mo><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">y</mi><mo stretchy="false" id="S2.SS1.p4.2.m2.1.2.3.2.2" xref="S2.SS1.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.2.cmml" xref="S2.SS1.p4.2.m2.1.2"><times id="S2.SS1.p4.2.m2.1.2.1.cmml" xref="S2.SS1.p4.2.m2.1.2.1"></times><ci id="S2.SS1.p4.2.m2.1.2.2.cmml" xref="S2.SS1.p4.2.m2.1.2.2">ğ’«</ci><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">ğ‘¦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">\mathcal{P}(y)</annotation></semantics></math> will also vary to some degree between clients. The conditional distributions are expected to remain the same in FEMNIST.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">The test dataset that each client has access to is always drawn from the same distribution as the training data in all partitioning schemes described above.</p>
</div>
<div id="S2.SS1.p6" class="ltx_para">
<p id="S2.SS1.p6.1" class="ltx_p">To perform machine learning on this dataset, a simple convolutional neural network was designed taking single channel, 28 x 28 pixel images and passing these through two 5x5 convolutional layers (32 and 64 channels respectively) with Relu activations. Each convolutional layer is followed by a 2x2 max pooling layer. Finally the network passes data through a fully connected dense layer with 512 units and Relu activations and provides output via a softmax classification over the 10 possible digit labels (62 in the case of FEMNIST).</p>
</div>
<div id="S2.SS1.p7" class="ltx_para">
<p id="S2.SS1.p7.1" class="ltx_p">FederatedAveraging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is used to train a global model over 50 training rounds for each data partitioning scheme described above. This is repeated using varying client fractions (0.1, 0.2, 0.5 and 1.0) for each round of training. In these experiments (and all subsequent ones), we use mini-batch stochastic gradient descent on the client with a batch size of 10 over 3 epochs per communication round and set the learning rate to 0.1. The results from these experiments form a baseline against which we compare FL+HC.</p>
</div>
<div id="S2.SS1.p8" class="ltx_para">
<p id="S2.SS1.p8.2" class="ltx_p">For our experiments with applying hierarchical clustering to FL in order to provide better, personalised models targeted to clients with similar updates, we first train a global model for <math id="S2.SS1.p8.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p8.1.m1.1a"><mi id="S2.SS1.p8.1.m1.1.1" xref="S2.SS1.p8.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p8.1.m1.1b"><ci id="S2.SS1.p8.1.m1.1.1.cmml" xref="S2.SS1.p8.1.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p8.1.m1.1c">n</annotation></semantics></math> communication rounds. This global model is then trained for a further 3 epochs on all clients to produce <math id="S2.SS1.p8.2.m2.1" class="ltx_Math" alttext="\Delta w" display="inline"><semantics id="S2.SS1.p8.2.m2.1a"><mrow id="S2.SS1.p8.2.m2.1.1" xref="S2.SS1.p8.2.m2.1.1.cmml"><mi mathvariant="normal" id="S2.SS1.p8.2.m2.1.1.2" xref="S2.SS1.p8.2.m2.1.1.2.cmml">Î”</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p8.2.m2.1.1.1" xref="S2.SS1.p8.2.m2.1.1.1.cmml">â€‹</mo><mi id="S2.SS1.p8.2.m2.1.1.3" xref="S2.SS1.p8.2.m2.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p8.2.m2.1b"><apply id="S2.SS1.p8.2.m2.1.1.cmml" xref="S2.SS1.p8.2.m2.1.1"><times id="S2.SS1.p8.2.m2.1.1.1.cmml" xref="S2.SS1.p8.2.m2.1.1.1"></times><ci id="S2.SS1.p8.2.m2.1.1.2.cmml" xref="S2.SS1.p8.2.m2.1.1.2">Î”</ci><ci id="S2.SS1.p8.2.m2.1.1.3.cmml" xref="S2.SS1.p8.2.m2.1.1.3">ğ‘¤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p8.2.m2.1c">\Delta w</annotation></semantics></math> (the difference between the global model and local model parameters). The model parameters are reshaped to form a vector and used as feature inputs to the agglomerative hierarchical clustering algorithm. The clustering algorithm returns a number of clusters each containing subsets of clients that are most similar to one another. FL then proceeds for each cluster independently for a total of 50 communication rounds.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Results &amp; Discussion</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In all our experiments we report the average test set accuracy over all clients in the round directly after the clustering step and at round 50 (where training accuracy begins to plateau using FederatedAveraging with no clustering). At round 50 the model is expected to be close to a stationary solution to the global objective under all settings. We also report the percentage of clients who reach a target of 99% test set accuracy (80% for the FEMNIST non-iid setting) in the round after the clustering step and at round 50. Finally, we report the increase/decrease in all these statistics compared to ordinary federated learning with no clustering step. These statistics provide evidence that clustering clients by similarity has a beneficial effect on both the average test set accuracy over all clients and the percentage of clients that perform well at the given task, in most circumstances.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Effect of varying client fraction and number of rounds prior to clustering</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In the following experiments we use Wardâ€™s linkage mechanism, Euclidean distance metric and fix the distance threshold to 3.0 (10.0 for FEMNIST) to determine when to halt merging of clusters. We varied the fraction of clients participating in each round of training and the number of rounds prior to clustering to see the effect that more rounds of training has on the ability to find good clusters of similar clients. Specifically, the client fraction was tested for 0.1x, 0.2x, 0.5x and 1.0x clients and the number of rounds prior to clustering was tested for 1, 3, 5 and 10 rounds.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">In the iid setting, hierarchical clustering was unable to separate clients into clusters for most experiments, instead falling back on the single joint model. This is to be expected as clients with iid partitioned data should return similar updates. However, where the number of rounds prior to clustering was set to just 1 (regardless of client fraction), clusters were identified resulting in a very slightly reduced average test accuracy compared to using the single joint model. This indicates that the stochastic nature of the optimisation on the clients hinders the ability to determine client update similarity until more training iterations have been performed.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">Under the pathological non-iid setting, there are no strictly pre-defined clusters of similar clients due to the way the data is partitioned. Despite this, we would expect that groups of clients that have access to the same digit labels might produce similar client updates and therefore, some clustering of these updates to produce specialised models may benefit these clients. <a href="#S3.T1" title="TABLE I â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ I</span></a> shows the results of varying client fraction and the number of rounds prior to clustering for the pathological non-iid setting. In all these results FL+HC outperforms ordinary federated learning. The greatest improvement compared to FL appears to occur where the number of rounds prior to the clustering step is set to 1, resulting in a jump in test set accuracy in the 2nd round of between 1.3x and 1.9x. The final test set accuracy (at round 50) remains the same under FL and FL+HC, but FL+HC asymptotes much more quickly. Similarly, the percentage of clients reaching the target test set accuracy (99%) exhibits this same jump directly after the clustering step. The percentage of clients reaching the target accuracy is also greatly improved at round 50 compared to FL (1.2x to 2.0x). <a href="#S3.F1" title="Figure 1 â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 1</span></a> and <a href="#S3.F2" title="Figure 2 â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 2</span></a> show how test accuracy and the number of client reaching the target accuracy evolves over communication rounds compared to FL. In general, we see a greater improvement in the metrics we are measuring for client fractions <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mo id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><lt id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">&lt;</annotation></semantics></math>1.0.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>FL+HC pathological non-iid setting - cf is the fraction of clients participating in each round of FL, n is the number of rounds of FL prior to clustering. We report the mean test accuracy percentage and the percentage of clients reaching the target accuracy of 99% directly after the clustering step and at round 50. We also report, in brackets, the increase/decrease in each statistic compared to FL). Values in <span id="S3.T1.2.1" class="ltx_text ltx_font_bold">bold</span> signify the best performance compared to FL in each column.</figcaption>
<table id="S3.T1.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.3.1.1" class="ltx_tr">
<th id="S3.T1.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T1.3.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"></th>
<th id="S3.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">test acc</th>
<th id="S3.T1.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">% clients</th>
</tr>
<tr id="S3.T1.3.2.2" class="ltx_tr">
<th id="S3.T1.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">cf</th>
<th id="S3.T1.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">n</th>
<th id="S3.T1.3.2.2.3" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T1.3.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T1.3.2.2.4" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T1.3.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.2.2.4.1.1" class="ltx_p">50</span>
</span>
</th>
<th id="S3.T1.3.2.2.5" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T1.3.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T1.3.2.2.6" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T1.3.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.2.2.6.1.1" class="ltx_p">50</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.3.3.1" class="ltx_tr">
<th id="S3.T1.3.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T1.3.3.1.1.1" class="ltx_text">0.1</span></th>
<th id="S3.T1.3.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T1.3.3.1.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.1.3.1.1" class="ltx_p"><span id="S3.T1.3.3.1.3.1.1.1" class="ltx_text ltx_font_bold">91.1 (1.9x)</span></span>
</span>
</td>
<td id="S3.T1.3.3.1.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.1.4.1.1" class="ltx_p">98.5 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.3.1.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.1.5.1.1" class="ltx_p">62.0 (20.7x)</span>
</span>
</td>
<td id="S3.T1.3.3.1.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.3.1.6.1.1" class="ltx_p">83.0 (1.8x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.4.2" class="ltx_tr">
<th id="S3.T1.3.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T1.3.4.2.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.4.2.2.1.1" class="ltx_p">80.4 (1.7x)</span>
</span>
</td>
<td id="S3.T1.3.4.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.4.2.3.1.1" class="ltx_p">97.1 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.4.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.4.2.4.1.1" class="ltx_p">46.0 (46.0x)</span>
</span>
</td>
<td id="S3.T1.3.4.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.4.2.5.1.1" class="ltx_p">67.0 (1.5x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.5.3" class="ltx_tr">
<th id="S3.T1.3.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T1.3.5.3.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.5.3.2.1.1" class="ltx_p">89.3 (1.1x)</span>
</span>
</td>
<td id="S3.T1.3.5.3.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.5.3.3.1.1" class="ltx_p">97.9 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.5.3.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.5.3.4.1.1" class="ltx_p">45.0 (7.5x)</span>
</span>
</td>
<td id="S3.T1.3.5.3.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.5.3.5.1.1" class="ltx_p">74.0 (1.6x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.6.4" class="ltx_tr">
<th id="S3.T1.3.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T1.3.6.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.6.4.2.1.1" class="ltx_p">92.0 (1.1x)</span>
</span>
</td>
<td id="S3.T1.3.6.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.6.4.3.1.1" class="ltx_p">98.2 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.6.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.6.4.4.1.1" class="ltx_p">40.0 (2.9x)</span>
</span>
</td>
<td id="S3.T1.3.6.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.6.4.5.1.1" class="ltx_p">77.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.7.5" class="ltx_tr">
<th id="S3.T1.3.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T1.3.7.5.1.1" class="ltx_text">0.2</span></th>
<th id="S3.T1.3.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T1.3.7.5.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.7.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.7.5.3.1.1" class="ltx_p">91.4 (1.6x)</span>
</span>
</td>
<td id="S3.T1.3.7.5.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.7.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.7.5.4.1.1" class="ltx_p"><span id="S3.T1.3.7.5.4.1.1.1" class="ltx_text ltx_font_bold">98.7 (1.0x)</span></span>
</span>
</td>
<td id="S3.T1.3.7.5.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.7.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.7.5.5.1.1" class="ltx_p">63.0 (31.5x)</span>
</span>
</td>
<td id="S3.T1.3.7.5.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.7.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.7.5.6.1.1" class="ltx_p"><span id="S3.T1.3.7.5.6.1.1.1" class="ltx_text ltx_font_bold">87.0 (2.0x)</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.3.8.6" class="ltx_tr">
<th id="S3.T1.3.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T1.3.8.6.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.8.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.8.6.2.1.1" class="ltx_p">92.5 (1.6x)</span>
</span>
</td>
<td id="S3.T1.3.8.6.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.8.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.8.6.3.1.1" class="ltx_p">98.3 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.8.6.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.8.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.8.6.4.1.1" class="ltx_p">58.0 (14.5x)</span>
</span>
</td>
<td id="S3.T1.3.8.6.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.8.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.8.6.5.1.1" class="ltx_p">73.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.9.7" class="ltx_tr">
<th id="S3.T1.3.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T1.3.9.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.9.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.9.7.2.1.1" class="ltx_p">90.2 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.9.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.9.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.9.7.3.1.1" class="ltx_p">98.4 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.9.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.9.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.9.7.4.1.1" class="ltx_p">49.0 (5.4x)</span>
</span>
</td>
<td id="S3.T1.3.9.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.9.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.9.7.5.1.1" class="ltx_p">74.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.10.8" class="ltx_tr">
<th id="S3.T1.3.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T1.3.10.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.10.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.10.8.2.1.1" class="ltx_p">93.6 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.10.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.10.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.10.8.3.1.1" class="ltx_p">98.3 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.10.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.10.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.10.8.4.1.1" class="ltx_p">55.0 (3.9x)</span>
</span>
</td>
<td id="S3.T1.3.10.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.10.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.10.8.5.1.1" class="ltx_p">71.0 (1.6x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.11.9" class="ltx_tr">
<th id="S3.T1.3.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T1.3.11.9.1.1" class="ltx_text">0.5</span></th>
<th id="S3.T1.3.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T1.3.11.9.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.11.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.11.9.3.1.1" class="ltx_p">91.9 (1.5x)</span>
</span>
</td>
<td id="S3.T1.3.11.9.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.11.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.11.9.4.1.1" class="ltx_p">98.7 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.11.9.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.11.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.11.9.5.1.1" class="ltx_p"><span id="S3.T1.3.11.9.5.1.1.1" class="ltx_text ltx_font_bold">68.0 (68.0x)</span></span>
</span>
</td>
<td id="S3.T1.3.11.9.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.11.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.11.9.6.1.1" class="ltx_p">89.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.12.10" class="ltx_tr">
<th id="S3.T1.3.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T1.3.12.10.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.12.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.12.10.2.1.1" class="ltx_p">94.6 (1.1x)</span>
</span>
</td>
<td id="S3.T1.3.12.10.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.12.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.12.10.3.1.1" class="ltx_p">98.8 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.12.10.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.12.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.12.10.4.1.1" class="ltx_p">67.0 (16.8x)</span>
</span>
</td>
<td id="S3.T1.3.12.10.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.12.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.12.10.5.1.1" class="ltx_p">83.0 (1.6x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.13.11" class="ltx_tr">
<th id="S3.T1.3.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T1.3.13.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.13.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.13.11.2.1.1" class="ltx_p">93.6 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.13.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.13.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.13.11.3.1.1" class="ltx_p">98.3 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.13.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.13.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.13.11.4.1.1" class="ltx_p">61.0 (7.6x)</span>
</span>
</td>
<td id="S3.T1.3.13.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.13.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.13.11.5.1.1" class="ltx_p">78.0 (1.5x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.14.12" class="ltx_tr">
<th id="S3.T1.3.14.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T1.3.14.12.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.14.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.14.12.2.1.1" class="ltx_p">93.8 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.14.12.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.14.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.14.12.3.1.1" class="ltx_p">98.0 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.14.12.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.14.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.14.12.4.1.1" class="ltx_p">39.0 (2.0x)</span>
</span>
</td>
<td id="S3.T1.3.14.12.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.14.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.14.12.5.1.1" class="ltx_p">63.0 (1.2x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.15.13" class="ltx_tr">
<th id="S3.T1.3.15.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="4"><span id="S3.T1.3.15.13.1.1" class="ltx_text">1.0</span></th>
<th id="S3.T1.3.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T1.3.15.13.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.15.13.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.15.13.3.1.1" class="ltx_p">94.1 (1.3x)</span>
</span>
</td>
<td id="S3.T1.3.15.13.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.15.13.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.15.13.4.1.1" class="ltx_p">98.6 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.15.13.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.15.13.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.15.13.5.1.1" class="ltx_p">64.0 (32.0x)</span>
</span>
</td>
<td id="S3.T1.3.15.13.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T1.3.15.13.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.15.13.6.1.1" class="ltx_p">77.0 (1.6x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.16.14" class="ltx_tr">
<th id="S3.T1.3.16.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T1.3.16.14.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.16.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.16.14.2.1.1" class="ltx_p">94.3 (1.1x)</span>
</span>
</td>
<td id="S3.T1.3.16.14.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.16.14.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.16.14.3.1.1" class="ltx_p">98.5 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.16.14.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.16.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.16.14.4.1.1" class="ltx_p">64.0 (8.0x)</span>
</span>
</td>
<td id="S3.T1.3.16.14.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.16.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.16.14.5.1.1" class="ltx_p">81.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.17.15" class="ltx_tr">
<th id="S3.T1.3.17.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T1.3.17.15.2" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.17.15.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.17.15.2.1.1" class="ltx_p">93.6 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.17.15.3" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.17.15.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.17.15.3.1.1" class="ltx_p">99.1 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.17.15.4" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.17.15.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.17.15.4.1.1" class="ltx_p">61.0 (5.1x)</span>
</span>
</td>
<td id="S3.T1.3.17.15.5" class="ltx_td ltx_align_justify">
<span id="S3.T1.3.17.15.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.17.15.5.1.1" class="ltx_p">82.0 (1.7x)</span>
</span>
</td>
</tr>
<tr id="S3.T1.3.18.16" class="ltx_tr">
<th id="S3.T1.3.18.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">10</th>
<td id="S3.T1.3.18.16.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T1.3.18.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.18.16.2.1.1" class="ltx_p">95.6 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.18.16.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T1.3.18.16.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.18.16.3.1.1" class="ltx_p">98.8 (1.0x)</span>
</span>
</td>
<td id="S3.T1.3.18.16.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T1.3.18.16.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.18.16.4.1.1" class="ltx_p">48.0 (2.8x)</span>
</span>
</td>
<td id="S3.T1.3.18.16.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T1.3.18.16.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.3.18.16.5.1.1" class="ltx_p">70.0 (1.4x)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2004.11791/assets/non-iid-02-1-final--.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Pathological non-iid setting, using client fraction = 0.2 and number of rounds prior to clustering = 1. The black vertical lines show the round where the clustering step occurs in FL+HC.</figcaption>
</figure>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2004.11791/assets/non-iid-02-10-final--.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Pathological non-iid setting, using client fraction = 0.2 and number of rounds prior to clustering = 10.</figcaption>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>FL+HC label-swapped non-iid setting - Empty values are due to 0 clients reaching target accuracy of 80% in FL comparison.</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T2.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"></th>
<th id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">test acc</th>
<th id="S3.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">% clients</th>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<th id="S3.T2.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">cf</th>
<th id="S3.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">n</th>
<th id="S3.T2.1.2.2.3" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T2.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T2.1.2.2.4" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T2.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.2.2.4.1.1" class="ltx_p">50</span>
</span>
</th>
<th id="S3.T2.1.2.2.5" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T2.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T2.1.2.2.6" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T2.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.2.2.6.1.1" class="ltx_p">50</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.1.3.1" class="ltx_tr">
<th id="S3.T2.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T2.1.3.1.1.1" class="ltx_text">0.1</span></th>
<th id="S3.T2.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T2.1.3.1.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.3.1.3.1.1" class="ltx_p">98.2 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.3.1.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.3.1.4.1.1" class="ltx_p">98.7 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.3.1.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.3.1.5.1.1" class="ltx_p">49.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.3.1.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.3.1.6.1.1" class="ltx_p">61.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.4.2" class="ltx_tr">
<th id="S3.T2.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T2.1.4.2.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.4.2.2.1.1" class="ltx_p">98.1 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.4.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.4.2.3.1.1" class="ltx_p">99.0 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.4.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.4.2.4.1.1" class="ltx_p">46.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.4.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.4.2.5.1.1" class="ltx_p">74.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.5.3" class="ltx_tr">
<th id="S3.T2.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T2.1.5.3.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.5.3.2.1.1" class="ltx_p">98.4 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.5.3.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.5.3.3.1.1" class="ltx_p">99.0 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.5.3.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.5.3.4.1.1" class="ltx_p">48.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.5.3.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.5.3.5.1.1" class="ltx_p">73.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.6.4" class="ltx_tr">
<th id="S3.T2.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T2.1.6.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.6.4.2.1.1" class="ltx_p"><span id="S3.T2.1.6.4.2.1.1.1" class="ltx_text ltx_font_bold">98.6 (1.4x)</span></span>
</span>
</td>
<td id="S3.T2.1.6.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.6.4.3.1.1" class="ltx_p"><span id="S3.T2.1.6.4.3.1.1.1" class="ltx_text ltx_font_bold">99.0 (1.3x)</span></span>
</span>
</td>
<td id="S3.T2.1.6.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.6.4.4.1.1" class="ltx_p"><span id="S3.T2.1.6.4.4.1.1.1" class="ltx_text ltx_font_bold">63.0 (5.3x)</span></span>
</span>
</td>
<td id="S3.T2.1.6.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.6.4.5.1.1" class="ltx_p">75.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.7.5" class="ltx_tr">
<th id="S3.T2.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T2.1.7.5.1.1" class="ltx_text">0.2</span></th>
<th id="S3.T2.1.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T2.1.7.5.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.7.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.7.5.3.1.1" class="ltx_p">98.2 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.7.5.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.7.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.7.5.4.1.1" class="ltx_p">98.6 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.7.5.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.7.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.7.5.5.1.1" class="ltx_p">48.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.7.5.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.7.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.7.5.6.1.1" class="ltx_p">64.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.8.6" class="ltx_tr">
<th id="S3.T2.1.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T2.1.8.6.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.8.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.8.6.2.1.1" class="ltx_p">98.2 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.8.6.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.8.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.8.6.3.1.1" class="ltx_p">99.1 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.8.6.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.8.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.8.6.4.1.1" class="ltx_p">43.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.8.6.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.8.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.8.6.5.1.1" class="ltx_p">77.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.9.7" class="ltx_tr">
<th id="S3.T2.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T2.1.9.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.9.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.9.7.2.1.1" class="ltx_p">98.4 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.9.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.9.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.9.7.3.1.1" class="ltx_p">99.1 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.9.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.9.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.9.7.4.1.1" class="ltx_p">52.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.9.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.9.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.9.7.5.1.1" class="ltx_p"><span id="S3.T2.1.9.7.5.1.1.1" class="ltx_text ltx_font_bold">80.0 (â€“)</span></span>
</span>
</td>
</tr>
<tr id="S3.T2.1.10.8" class="ltx_tr">
<th id="S3.T2.1.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T2.1.10.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.10.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.10.8.2.1.1" class="ltx_p">98.6 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.10.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.10.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.10.8.3.1.1" class="ltx_p">99.0 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.10.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.10.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.10.8.4.1.1" class="ltx_p">57.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.10.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.10.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.10.8.5.1.1" class="ltx_p">77.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.11.9" class="ltx_tr">
<th id="S3.T2.1.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T2.1.11.9.1.1" class="ltx_text">0.5</span></th>
<th id="S3.T2.1.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T2.1.11.9.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.11.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.11.9.3.1.1" class="ltx_p">98.1 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.11.9.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.11.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.11.9.4.1.1" class="ltx_p">98.5 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.11.9.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.11.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.11.9.5.1.1" class="ltx_p">49.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.11.9.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.11.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.11.9.6.1.1" class="ltx_p">54.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.12.10" class="ltx_tr">
<th id="S3.T2.1.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T2.1.12.10.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.12.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.12.10.2.1.1" class="ltx_p">98.3 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.12.10.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.12.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.12.10.3.1.1" class="ltx_p">99.0 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.12.10.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.12.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.12.10.4.1.1" class="ltx_p">51.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.12.10.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.12.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.12.10.5.1.1" class="ltx_p">73.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.13.11" class="ltx_tr">
<th id="S3.T2.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T2.1.13.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.13.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.13.11.2.1.1" class="ltx_p">98.5 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.13.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.13.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.13.11.3.1.1" class="ltx_p">99.1 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.13.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.13.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.13.11.4.1.1" class="ltx_p">54.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.13.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.13.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.13.11.5.1.1" class="ltx_p">76.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.14.12" class="ltx_tr">
<th id="S3.T2.1.14.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T2.1.14.12.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.14.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.14.12.2.1.1" class="ltx_p">98.6 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.14.12.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.14.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.14.12.3.1.1" class="ltx_p">99.2 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.14.12.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.14.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.14.12.4.1.1" class="ltx_p">61.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.14.12.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.14.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.14.12.5.1.1" class="ltx_p">79.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.15.13" class="ltx_tr">
<th id="S3.T2.1.15.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="4"><span id="S3.T2.1.15.13.1.1" class="ltx_text">1.0</span></th>
<th id="S3.T2.1.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T2.1.15.13.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.15.13.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.15.13.3.1.1" class="ltx_p">98.3 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.15.13.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.15.13.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.15.13.4.1.1" class="ltx_p">98.4 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.15.13.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.15.13.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.15.13.5.1.1" class="ltx_p">53.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.15.13.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T2.1.15.13.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.15.13.6.1.1" class="ltx_p">56.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.16.14" class="ltx_tr">
<th id="S3.T2.1.16.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T2.1.16.14.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.16.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.16.14.2.1.1" class="ltx_p">98.3 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.16.14.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.16.14.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.16.14.3.1.1" class="ltx_p">99.0 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.16.14.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.16.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.16.14.4.1.1" class="ltx_p">54.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.16.14.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.16.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.16.14.5.1.1" class="ltx_p">74.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.17.15" class="ltx_tr">
<th id="S3.T2.1.17.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T2.1.17.15.2" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.17.15.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.17.15.2.1.1" class="ltx_p">98.5 (1.3x)</span>
</span>
</td>
<td id="S3.T2.1.17.15.3" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.17.15.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.17.15.3.1.1" class="ltx_p">99.0 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.17.15.4" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.17.15.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.17.15.4.1.1" class="ltx_p">59.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.17.15.5" class="ltx_td ltx_align_justify">
<span id="S3.T2.1.17.15.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.17.15.5.1.1" class="ltx_p">76.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.18.16" class="ltx_tr">
<th id="S3.T2.1.18.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">10</th>
<td id="S3.T2.1.18.16.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T2.1.18.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.18.16.2.1.1" class="ltx_p">98.6 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.18.16.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T2.1.18.16.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.18.16.3.1.1" class="ltx_p">99.0 (1.2x)</span>
</span>
</td>
<td id="S3.T2.1.18.16.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T2.1.18.16.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.18.16.4.1.1" class="ltx_p">59.0 (â€“)</span>
</span>
</td>
<td id="S3.T2.1.18.16.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T2.1.18.16.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T2.1.18.16.5.1.1" class="ltx_p">74.0 (â€“)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">In the label-swapped non-iid setting, we know how the client datasets are clustered due to the way the data has been partitioned. We therefore expect FL+HC to find the 4 clusters during the cluster step and produce a specialised model for each. Additionally, due to the way the data is partitioned, FL can only achieve a maximum test set accuracy of 80% in this setting due to the conflicting training objectives of each cluster. <a href="#S3.T2" title="TABLE II â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ II</span></a> shows that for all combinations of client fraction and number of rounds prior to clustering, FL+HC performs significantly better than FL on this data. In fact, the average test set accuracy directly after the clustering step is within 1% of that of the iid setting and by round 50, is within 0.1% in most cases (iid test set accuracy at round 50 is Â 99.1% for all client fractions under FL). As FL can only achieve an average test set accuracy of 80%, in most cases under the label-swapped non-iid setting, the percentage of clients achieving the target accuracy of 99% was 0. FL+HC was able to train up to 80% of clients to 99% test set accuracy. <a href="#S3.F3" title="Figure 3 â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 3</span></a> shows how training evolves with increasing communication round for this non-iid setting. Increasing the number of rounds prior to clustering, results in improving numbers of clients reaching the target accuracy. Varying the client fraction appears to have a negligible effect on any of the metrics we recorded.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2004.11791/assets/clust-02-10-final--.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Label-swapped non-iid setting, using client fraction = 0.2 and number of rounds prior to clustering = 10.</figcaption>
</figure>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">The FEMNIST non-iid setting represents a more difficult challenge in that there is an expanded label set to classify and an uneven number of samples on each client. Additionally, the number of samples available to each client is significantly fewer than in the MNIST experiments. <a href="#S3.T3" title="TABLE III â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ III</span></a> details the experimental results for varying client fraction and number of rounds prior to the clustering step for this non-iid setting.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>FL+HC FEMNIST non-iid setting - cf=1, n=3 failed to complete in the time allowed.</figcaption>
<table id="S3.T3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.1.1.1" class="ltx_tr">
<th id="S3.T3.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T3.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"></th>
<th id="S3.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">test acc</th>
<th id="S3.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">% clients</th>
</tr>
<tr id="S3.T3.1.2.2" class="ltx_tr">
<th id="S3.T3.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">cf</th>
<th id="S3.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">n</th>
<th id="S3.T3.1.2.2.3" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T3.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T3.1.2.2.4" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S3.T3.1.2.2.5" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T3.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</th>
<th id="S3.T3.1.2.2.6" class="ltx_td ltx_align_justify ltx_th ltx_th_column">
<span id="S3.T3.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.2.2.6.1.1" class="ltx_p">50</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.1.3.1" class="ltx_tr">
<th id="S3.T3.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T3.1.3.1.1.1" class="ltx_text">0.1</span></th>
<th id="S3.T3.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T3.1.3.1.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.3.1.3.1.1" class="ltx_p">30.7 (2.8x)</span>
</span>
</td>
<td id="S3.T3.1.3.1.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.3.1.4.1.1" class="ltx_p">74.3 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.3.1.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.3.1.5.1.1" class="ltx_p">14.2 (â€“)</span>
</span>
</td>
<td id="S3.T3.1.3.1.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.3.1.6.1.1" class="ltx_p">44.4 (0.9x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.4.2" class="ltx_tr">
<th id="S3.T3.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T3.1.4.2.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.4.2.2.1.1" class="ltx_p">51.4 (1.4x)</span>
</span>
</td>
<td id="S3.T3.1.4.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.4.2.3.1.1" class="ltx_p">73.6 (0.9x)</span>
</span>
</td>
<td id="S3.T3.1.4.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.4.2.4.1.1" class="ltx_p">15.0 (27.5x)</span>
</span>
</td>
<td id="S3.T3.1.4.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.4.2.5.1.1" class="ltx_p">42.2 (0.9x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.5.3" class="ltx_tr">
<th id="S3.T3.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T3.1.5.3.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.5.3.2.1.1" class="ltx_p">69.6 (1.4x)</span>
</span>
</td>
<td id="S3.T3.1.5.3.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.5.3.3.1.1" class="ltx_p"><span id="S3.T3.1.5.3.3.1.1.1" class="ltx_text ltx_font_bold">77.6 (1.0x)</span></span>
</span>
</td>
<td id="S3.T3.1.5.3.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.5.3.4.1.1" class="ltx_p">29.7 (6.4x)</span>
</span>
</td>
<td id="S3.T3.1.5.3.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.5.3.5.1.1" class="ltx_p"><span id="S3.T3.1.5.3.5.1.1.1" class="ltx_text ltx_font_bold">51.2 (1.1x)</span></span>
</span>
</td>
</tr>
<tr id="S3.T3.1.6.4" class="ltx_tr">
<th id="S3.T3.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T3.1.6.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.6.4.2.1.1" class="ltx_p">71.0 (1.1x)</span>
</span>
</td>
<td id="S3.T3.1.6.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.6.4.3.1.1" class="ltx_p">76.3 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.6.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.6.4.4.1.1" class="ltx_p">32.4 (2.0x)</span>
</span>
</td>
<td id="S3.T3.1.6.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.6.4.5.1.1" class="ltx_p">47.1 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.7.5" class="ltx_tr">
<th id="S3.T3.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T3.1.7.5.1.1" class="ltx_text">0.2</span></th>
<th id="S3.T3.1.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T3.1.7.5.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.7.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.7.5.3.1.1" class="ltx_p">12.7 (0.6x)</span>
</span>
</td>
<td id="S3.T3.1.7.5.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.7.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.7.5.4.1.1" class="ltx_p">32.3 (0.4x)</span>
</span>
</td>
<td id="S3.T3.1.7.5.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.7.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.7.5.5.1.1" class="ltx_p">0.5 (â€“)</span>
</span>
</td>
<td id="S3.T3.1.7.5.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.7.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.7.5.6.1.1" class="ltx_p">19.6 (0.4x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.8.6" class="ltx_tr">
<th id="S3.T3.1.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T3.1.8.6.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.8.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.8.6.2.1.1" class="ltx_p">71.2 (1.9x)</span>
</span>
</td>
<td id="S3.T3.1.8.6.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.8.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.8.6.3.1.1" class="ltx_p">77.1 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.8.6.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.8.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.8.6.4.1.1" class="ltx_p"><span id="S3.T3.1.8.6.4.1.1.1" class="ltx_text ltx_font_bold">38.7 (28.4x)</span></span>
</span>
</td>
<td id="S3.T3.1.8.6.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.8.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.8.6.5.1.1" class="ltx_p">48.8 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.9.7" class="ltx_tr">
<th id="S3.T3.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T3.1.9.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.9.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.9.7.2.1.1" class="ltx_p">69.4 (1.3x)</span>
</span>
</td>
<td id="S3.T3.1.9.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.9.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.9.7.3.1.1" class="ltx_p">77.4 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.9.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.9.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.9.7.4.1.1" class="ltx_p">31.3 (4.8x)</span>
</span>
</td>
<td id="S3.T3.1.9.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.9.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.9.7.5.1.1" class="ltx_p">49.3 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.10.8" class="ltx_tr">
<th id="S3.T3.1.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T3.1.10.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.10.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.10.8.2.1.1" class="ltx_p">6.3 (0.1x)</span>
</span>
</td>
<td id="S3.T3.1.10.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.10.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.10.8.3.1.1" class="ltx_p">5.1 (0.1x)</span>
</span>
</td>
<td id="S3.T3.1.10.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.10.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.10.8.4.1.1" class="ltx_p">0.0 (â€“)</span>
</span>
</td>
<td id="S3.T3.1.10.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.10.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.10.8.5.1.1" class="ltx_p">0.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.11.9" class="ltx_tr">
<th id="S3.T3.1.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T3.1.11.9.1.1" class="ltx_text">0.5</span></th>
<th id="S3.T3.1.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T3.1.11.9.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.11.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.11.9.3.1.1" class="ltx_p">43.5 (2.2x)</span>
</span>
</td>
<td id="S3.T3.1.11.9.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.11.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.11.9.4.1.1" class="ltx_p">75.2 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.11.9.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.11.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.11.9.5.1.1" class="ltx_p">15.0 (â€“)</span>
</span>
</td>
<td id="S3.T3.1.11.9.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.11.9.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.11.9.6.1.1" class="ltx_p">46.0 (0.9x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.12.10" class="ltx_tr">
<th id="S3.T3.1.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T3.1.12.10.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.12.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.12.10.2.1.1" class="ltx_p">57.6 (1.5x)</span>
</span>
</td>
<td id="S3.T3.1.12.10.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.12.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.12.10.3.1.1" class="ltx_p">17.2 (0.2x)</span>
</span>
</td>
<td id="S3.T3.1.12.10.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.12.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.12.10.4.1.1" class="ltx_p">28.9 (15.1x)</span>
</span>
</td>
<td id="S3.T3.1.12.10.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.12.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.12.10.5.1.1" class="ltx_p">8.2 (0.2x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.13.11" class="ltx_tr">
<th id="S3.T3.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T3.1.13.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.13.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.13.11.2.1.1" class="ltx_p">69.3 (1.3x)</span>
</span>
</td>
<td id="S3.T3.1.13.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.13.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.13.11.3.1.1" class="ltx_p">77.7 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.13.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.13.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.13.11.4.1.1" class="ltx_p">28.1 (4.7x)</span>
</span>
</td>
<td id="S3.T3.1.13.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.13.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.13.11.5.1.1" class="ltx_p">51.5 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.14.12" class="ltx_tr">
<th id="S3.T3.1.14.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">10</th>
<td id="S3.T3.1.14.12.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.14.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.14.12.2.1.1" class="ltx_p">69.3 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.14.12.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.14.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.14.12.3.1.1" class="ltx_p">75.5 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.14.12.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.14.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.14.12.4.1.1" class="ltx_p">29.7 (1.4x)</span>
</span>
</td>
<td id="S3.T3.1.14.12.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.14.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.14.12.5.1.1" class="ltx_p">45.5 (0.9x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.15.13" class="ltx_tr">
<th id="S3.T3.1.15.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="4"><span id="S3.T3.1.15.13.1.1" class="ltx_text">1</span></th>
<th id="S3.T3.1.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T3.1.15.13.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.15.13.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.15.13.3.1.1" class="ltx_p"><span id="S3.T3.1.15.13.3.1.1.1" class="ltx_text ltx_font_bold">72.3 (2.9x)</span></span>
</span>
</td>
<td id="S3.T3.1.15.13.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.15.13.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.15.13.4.1.1" class="ltx_p">77.7 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.15.13.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.15.13.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.15.13.5.1.1" class="ltx_p">39.2 (0.0x)</span>
</span>
</td>
<td id="S3.T3.1.15.13.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T3.1.15.13.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.15.13.6.1.1" class="ltx_p">52.0 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.16.14" class="ltx_tr">
<th id="S3.T3.1.16.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">3</th>
<td id="S3.T3.1.16.14.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.16.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.16.14.2.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T3.1.16.14.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.16.14.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.16.14.3.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T3.1.16.14.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.16.14.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.16.14.4.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T3.1.16.14.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.16.14.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.16.14.5.1.1" class="ltx_p">â€“</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.17.15" class="ltx_tr">
<th id="S3.T3.1.17.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">5</th>
<td id="S3.T3.1.17.15.2" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.17.15.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.17.15.2.1.1" class="ltx_p">70.7 (1.3x)</span>
</span>
</td>
<td id="S3.T3.1.17.15.3" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.17.15.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.17.15.3.1.1" class="ltx_p">77.9 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.17.15.4" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.17.15.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.17.15.4.1.1" class="ltx_p">31.1 (4.8x)</span>
</span>
</td>
<td id="S3.T3.1.17.15.5" class="ltx_td ltx_align_justify">
<span id="S3.T3.1.17.15.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.17.15.5.1.1" class="ltx_p">51.2 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T3.1.18.16" class="ltx_tr">
<th id="S3.T3.1.18.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">10</th>
<td id="S3.T3.1.18.16.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T3.1.18.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.18.16.2.1.1" class="ltx_p">69.6 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.18.16.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T3.1.18.16.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.18.16.3.1.1" class="ltx_p">75.4 (1.0x)</span>
</span>
</td>
<td id="S3.T3.1.18.16.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T3.1.18.16.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.18.16.4.1.1" class="ltx_p">33.5 (1.4x)</span>
</span>
</td>
<td id="S3.T3.1.18.16.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T3.1.18.16.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T3.1.18.16.5.1.1" class="ltx_p">45.0 (0.9x)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2004.11791/assets/femnist-01-5-final--.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>FEMNIST non-iid setting, using client fraction = 0.1 and number of rounds prior to clustering = 5.</figcaption>
</figure>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.1" class="ltx_p">In most of the experiments, the clustering step has a slightly negative effect on the test accuracy and the percentage of clients reaching the target accuracy compared to FL. However in some cases there is a drastic reduction in these metrics, where the clustering step is clearly creating clusters of dissimilar clients. In general, increasing client fraction has a positive effect on the final test accuracy, indicating that FL+HC benefits from clustering on a joint model that has been trained on more data. Clustering after more rounds of FL, also seems to be beneficial in this setting.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<p id="S3.SS1.p7.1" class="ltx_p">Overall, varying the client fraction seems to have only a small (but positive) effect on test set accuracy or the percentage of clients reaching the target test set accuracy under FL+HC. However there is evidence that increasing the number of rounds prior to the clustering step can result in greater gains over FL. This is most clear in the label-swapped non-iid setting. Additionally, as shown in the figures for the pathological and label-swapped non-iid settings, FL+HC allows more clients to reach the target accuracy in any given communication round.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Effect of varying hierarchical clustering hyperparameters</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The following experiments fix the number of communication rounds prior to clustering at 10 and the fraction of clients participating in each round of FL at 0.2. In this section, we discuss how varying the hyperparameters of the hierarchical clustering algorithm affects our metrics. We also experiment with a range of distance thresholds and report the best performing result for each combination of hyperparameters on each data partitioning scheme.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">In the iid setting, the Euclidean and cosine distance metrics correctly failed to split the clients during the clustering step, resulting in a single cluster representing all the clients. As training continues, the end result is identical to federated learning. The Manhattan distance metric does cluster the clients into subgroups, resulting in reduced overall test accuracy and percentage of clients reaching the target accuracy. However, data stored across clients in the real world is unlikely to be perfectly iid.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">In the pathological non-iid setting (<a href="#S3.T4" title="TABLE IV â€£ III-B Effect of varying hierarchical clustering hyperparameters â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ IV</span></a>), all combinations of hyperparameters yield a final test accuracy similar to, or better than training a single joint model. By round 50, the number of clients reaching the target test accuracy of 99% is significantly better in FL+HC than FL (1.2x to 2.1x). The Manhattan distance metric performs the best overall, followed by the Euclidean distance and finally the cosine distance. Using the Manhattan distance metric, the test accuracy on this pathological non-iid setting directly after the clustering step (round 10) exceeds FL at round 50 on iid data. This represents a vast reduction (<math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mo id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><gt id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">&gt;</annotation></semantics></math>5x) in communication rounds for this type of non-iid data as shown in <a href="#S3.F5" title="Figure 5 â€£ III-B Effect of varying hierarchical clustering hyperparameters â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 5</span></a>. Similarly, the number of clients reaching the target accuracy is greatest under the Manhattan distance metric. As the Manhattan distance metric is preferable for measuring distances between sparse high dimensional vectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, this clearly produces good clusters to train further specialised models from. The linkage method used with each distance metric appears to have a negligible effect on performance under this non-iid setting.</p>
</div>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>FL+HC pathological non-iid setting - dist is the distance metric used judge similarity between client clusters, link is the linkage method used to determine how clients in each cluster are used in the similarity judgement.</figcaption>
<table id="S3.T4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T4.1.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T4.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">test acc</td>
<td id="S3.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">% clients</td>
</tr>
<tr id="S3.T4.1.2.2" class="ltx_tr">
<th id="S3.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dist</th>
<th id="S3.T4.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">link</th>
<td id="S3.T4.1.2.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T4.1.2.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.2.2.4.1.1" class="ltx_p">50</span>
</span>
</td>
<td id="S3.T4.1.2.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T4.1.2.2.6" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.2.2.6.1.1" class="ltx_p">50</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.3.3" class="ltx_tr">
<th id="S3.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T4.1.3.3.1.1" class="ltx_text">cos.</span></th>
<th id="S3.T4.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T4.1.3.3.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.3.3.3.1.1" class="ltx_p">89.3 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.3.3.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.3.3.4.1.1" class="ltx_p">97.8 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.3.3.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.3.3.5.1.1" class="ltx_p">12.0 (0.9x)</span>
</span>
</td>
<td id="S3.T4.1.3.3.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.3.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.3.3.6.1.1" class="ltx_p">55.0 (1.3x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.4.4" class="ltx_tr">
<th id="S3.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T4.1.4.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.4.4.2.1.1" class="ltx_p">91.3 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.4.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.4.4.3.1.1" class="ltx_p">97.8 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.4.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.4.4.4.1.1" class="ltx_p">23.0 (1.6x)</span>
</span>
</td>
<td id="S3.T4.1.4.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.4.4.5.1.1" class="ltx_p">56.0 (1.3x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.5.5" class="ltx_tr">
<th id="S3.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T4.1.5.5.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.5.5.2.1.1" class="ltx_p">92.0 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.5.5.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.5.5.3.1.1" class="ltx_p">97.7 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.5.5.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.5.5.4.1.1" class="ltx_p">19.0 (1.4x)</span>
</span>
</td>
<td id="S3.T4.1.5.5.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.5.5.5.1.1" class="ltx_p">51.0 (1.2x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.6.6" class="ltx_tr">
<th id="S3.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T4.1.6.6.1.1" class="ltx_text">L2</span></th>
<th id="S3.T4.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T4.1.6.6.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.6.6.3.1.1" class="ltx_p">95.5 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.6.6.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.6.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.6.6.4.1.1" class="ltx_p">98.9 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.6.6.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.6.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.6.6.5.1.1" class="ltx_p">69.0 (4.9x)</span>
</span>
</td>
<td id="S3.T4.1.6.6.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.6.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.6.6.6.1.1" class="ltx_p">86.0 (2.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.7.7" class="ltx_tr">
<th id="S3.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T4.1.7.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.7.7.2.1.1" class="ltx_p">96.6 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.7.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.7.7.3.1.1" class="ltx_p">98.8 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.7.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.7.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.7.7.4.1.1" class="ltx_p">72.0 (5.1x)</span>
</span>
</td>
<td id="S3.T4.1.7.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.7.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.7.7.5.1.1" class="ltx_p">84.0 (1.9x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.8.8" class="ltx_tr">
<th id="S3.T4.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T4.1.8.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.8.8.2.1.1" class="ltx_p">93.6 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.8.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.8.8.3.1.1" class="ltx_p">98.1 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.8.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.8.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.8.8.4.1.1" class="ltx_p">44.0 (3.1x)</span>
</span>
</td>
<td id="S3.T4.1.8.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.8.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.8.8.5.1.1" class="ltx_p">67.0 (1.5x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.9.9" class="ltx_tr">
<th id="S3.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ward</th>
<td id="S3.T4.1.9.9.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.9.9.2.1.1" class="ltx_p">97.3 (1.1x)</span>
</span>
</td>
<td id="S3.T4.1.9.9.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.9.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.9.9.3.1.1" class="ltx_p"><span id="S3.T4.1.9.9.3.1.1.1" class="ltx_text ltx_font_bold">99.5 (1.0x)</span></span>
</span>
</td>
<td id="S3.T4.1.9.9.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.9.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.9.9.4.1.1" class="ltx_p">79.0 (5.6x)</span>
</span>
</td>
<td id="S3.T4.1.9.9.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.9.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.9.9.5.1.1" class="ltx_p">89.0 (2.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.10.10" class="ltx_tr">
<th id="S3.T4.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T4.1.10.10.1.1" class="ltx_text">L1</span></th>
<th id="S3.T4.1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T4.1.10.10.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.10.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.10.10.3.1.1" class="ltx_p"><span id="S3.T4.1.10.10.3.1.1.1" class="ltx_text ltx_font_bold">99.4 (1.1x)</span></span>
</span>
</td>
<td id="S3.T4.1.10.10.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.10.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.10.10.4.1.1" class="ltx_p">99.4 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.10.10.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.10.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.10.10.5.1.1" class="ltx_p">89.0 (6.4x)</span>
</span>
</td>
<td id="S3.T4.1.10.10.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T4.1.10.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.10.10.6.1.1" class="ltx_p">91.0 (2.1x)</span>
</span>
</td>
</tr>
<tr id="S3.T4.1.11.11" class="ltx_tr">
<th id="S3.T4.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T4.1.11.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.11.11.2.1.1" class="ltx_p">99.2 (1.1x)</span>
</span>
</td>
<td id="S3.T4.1.11.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.11.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.11.11.3.1.1" class="ltx_p">99.3 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.11.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.11.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.11.11.4.1.1" class="ltx_p"><span id="S3.T4.1.11.11.4.1.1.1" class="ltx_text ltx_font_bold">91.0 (6.5x)</span></span>
</span>
</td>
<td id="S3.T4.1.11.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T4.1.11.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.11.11.5.1.1" class="ltx_p"><span id="S3.T4.1.11.11.5.1.1.1" class="ltx_text ltx_font_bold">92.0 (2.1x)</span></span>
</span>
</td>
</tr>
<tr id="S3.T4.1.12.12" class="ltx_tr">
<th id="S3.T4.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">sing.</th>
<td id="S3.T4.1.12.12.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T4.1.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.12.12.2.1.1" class="ltx_p">99.4 (1.1x)</span>
</span>
</td>
<td id="S3.T4.1.12.12.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T4.1.12.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.12.12.3.1.1" class="ltx_p">99.4 (1.0x)</span>
</span>
</td>
<td id="S3.T4.1.12.12.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T4.1.12.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.12.12.4.1.1" class="ltx_p">87.0 (6.2x)</span>
</span>
</td>
<td id="S3.T4.1.12.12.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T4.1.12.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T4.1.12.12.5.1.1" class="ltx_p">91.0 (2.1x)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2004.11791/assets/non-iid-02-10-man-complete-final.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Pathological non-iid setting, using client fraction = 0.2 and number of rounds prior to clustering = 10, Manhattan distance metric and complete linkage.</figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Under the label-swapped non-iid setting (<a href="#S3.T5" title="TABLE V â€£ III-B Effect of varying hierarchical clustering hyperparameters â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ V</span></a>), FL+HC outperforms FL as expected when encountering clients with competing optimisation objectives. In this setting, experiments using the cosine distance outperform those using Euclidean and Manhattan distance metrics. This shows that the magnitude of the client update vectors has less of an effect than their direction in determining the correct clusters in this setting. As there are clear real clusters of clients in this non-iid setting (clients who have the same labels swapped), this poses a very different task to the pathological non-iid setting. Under all these experiments FL+HC discovers clusters of clients such that the test accuracy approaches that of FL on iid data, but only those experiments using the cosine distance metric reach the same performance. Again, in this non-iid setting, the linkage method has much less of an effect on the metrics we measure. The evolution of test accuracy and number of clients reaching the test accuracy are very similar to <a href="#S3.F3" title="Figure 3 â€£ III-A Effect of varying client fraction and number of rounds prior to clustering â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 3</span></a> under this non-iid setting.</p>
</div>
<figure id="S3.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>FL+HC label-swapped non-iid setting - dist=cosine, linkage=single failed to complete in the time allowed.</figcaption>
<table id="S3.T5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T5.1.1.1" class="ltx_tr">
<th id="S3.T5.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T5.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">test acc</td>
<td id="S3.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">% clients</td>
</tr>
<tr id="S3.T5.1.2.2" class="ltx_tr">
<th id="S3.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dist</th>
<th id="S3.T5.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">link</th>
<td id="S3.T5.1.2.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T5.1.2.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.2.2.4.1.1" class="ltx_p">50</span>
</span>
</td>
<td id="S3.T5.1.2.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T5.1.2.2.6" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.2.2.6.1.1" class="ltx_p">50</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.3.3" class="ltx_tr">
<th id="S3.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T5.1.3.3.1.1" class="ltx_text">cos.</span></th>
<th id="S3.T5.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T5.1.3.3.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.3.3.3.1.1" class="ltx_p"><span id="S3.T5.1.3.3.3.1.1.1" class="ltx_text ltx_font_bold">98.7 (1.3x)</span></span>
</span>
</td>
<td id="S3.T5.1.3.3.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.3.3.4.1.1" class="ltx_p"><span id="S3.T5.1.3.3.4.1.1.1" class="ltx_text ltx_font_bold">99.1 (1.3x)</span></span>
</span>
</td>
<td id="S3.T5.1.3.3.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.3.3.5.1.1" class="ltx_p"><span id="S3.T5.1.3.3.5.1.1.1" class="ltx_text ltx_font_bold">62.0 (â€“)</span></span>
</span>
</td>
<td id="S3.T5.1.3.3.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.3.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.3.3.6.1.1" class="ltx_p"><span id="S3.T5.1.3.3.6.1.1.1" class="ltx_text ltx_font_bold">79.0 (â€“)</span></span>
</span>
</td>
</tr>
<tr id="S3.T5.1.4.4" class="ltx_tr">
<th id="S3.T5.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T5.1.4.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.4.4.2.1.1" class="ltx_p">98.5 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.4.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.4.4.3.1.1" class="ltx_p">99.1 (1.3x)</span>
</span>
</td>
<td id="S3.T5.1.4.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.4.4.4.1.1" class="ltx_p">56.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.4.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.4.4.5.1.1" class="ltx_p">78.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.5.5" class="ltx_tr">
<th id="S3.T5.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T5.1.5.5.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.5.5.2.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T5.1.5.5.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.5.5.3.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T5.1.5.5.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.5.5.4.1.1" class="ltx_p">â€“</span>
</span>
</td>
<td id="S3.T5.1.5.5.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.5.5.5.1.1" class="ltx_p">â€“</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.6.6" class="ltx_tr">
<th id="S3.T5.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T5.1.6.6.1.1" class="ltx_text">L2</span></th>
<th id="S3.T5.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T5.1.6.6.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.6.6.3.1.1" class="ltx_p">98.2 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.6.6.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.6.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.6.6.4.1.1" class="ltx_p">98.3 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.6.6.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.6.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.6.6.5.1.1" class="ltx_p">50.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.6.6.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.6.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.6.6.6.1.1" class="ltx_p">53.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.7.7" class="ltx_tr">
<th id="S3.T5.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T5.1.7.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.7.7.2.1.1" class="ltx_p">98.4 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.7.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.7.7.3.1.1" class="ltx_p">99.1 (1.3x)</span>
</span>
</td>
<td id="S3.T5.1.7.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.7.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.7.7.4.1.1" class="ltx_p">53.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.7.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.7.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.7.7.5.1.1" class="ltx_p">76.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.8.8" class="ltx_tr">
<th id="S3.T5.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T5.1.8.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.8.8.2.1.1" class="ltx_p">98.2 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.8.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.8.8.3.1.1" class="ltx_p">98.3 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.8.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.8.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.8.8.4.1.1" class="ltx_p">47.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.8.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.8.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.8.8.5.1.1" class="ltx_p">51.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.9.9" class="ltx_tr">
<th id="S3.T5.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ward</th>
<td id="S3.T5.1.9.9.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.9.9.2.1.1" class="ltx_p">98.5 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.9.9.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.9.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.9.9.3.1.1" class="ltx_p">99.1 (1.3x)</span>
</span>
</td>
<td id="S3.T5.1.9.9.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.9.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.9.9.4.1.1" class="ltx_p">57.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.9.9.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.9.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.9.9.5.1.1" class="ltx_p">77.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.10.10" class="ltx_tr">
<th id="S3.T5.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T5.1.10.10.1.1" class="ltx_text">L1</span></th>
<th id="S3.T5.1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T5.1.10.10.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.10.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.10.10.3.1.1" class="ltx_p">98.3 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.10.10.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.10.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.10.10.4.1.1" class="ltx_p">98.3 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.10.10.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.10.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.10.10.5.1.1" class="ltx_p">51.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.10.10.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T5.1.10.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.10.10.6.1.1" class="ltx_p">50.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.11.11" class="ltx_tr">
<th id="S3.T5.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T5.1.11.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.11.11.2.1.1" class="ltx_p">98.5 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.11.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.11.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.11.11.3.1.1" class="ltx_p">98.6 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.11.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.11.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.11.11.4.1.1" class="ltx_p">58.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.11.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T5.1.11.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.11.11.5.1.1" class="ltx_p">59.0 (â€“)</span>
</span>
</td>
</tr>
<tr id="S3.T5.1.12.12" class="ltx_tr">
<th id="S3.T5.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">sing.</th>
<td id="S3.T5.1.12.12.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T5.1.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.12.12.2.1.1" class="ltx_p">98.3 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.12.12.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T5.1.12.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.12.12.3.1.1" class="ltx_p">98.4 (1.2x)</span>
</span>
</td>
<td id="S3.T5.1.12.12.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T5.1.12.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.12.12.4.1.1" class="ltx_p">48.0 (â€“)</span>
</span>
</td>
<td id="S3.T5.1.12.12.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T5.1.12.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T5.1.12.12.5.1.1" class="ltx_p">53.0 (â€“)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>FL+HC FEMNIST non-iid setting</figcaption>
<table id="S3.T6.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T6.1.1.1" class="ltx_tr">
<th id="S3.T6.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T6.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">test acc</td>
<td id="S3.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">% clients</td>
</tr>
<tr id="S3.T6.1.2.2" class="ltx_tr">
<th id="S3.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">dist</th>
<th id="S3.T6.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">linkage</th>
<td id="S3.T6.1.2.2.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.2.2.3.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T6.1.2.2.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.2.2.4.1.1" class="ltx_p">50</span>
</span>
</td>
<td id="S3.T6.1.2.2.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.2.2.5.1.1" class="ltx_p">post cluster</span>
</span>
</td>
<td id="S3.T6.1.2.2.6" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.2.2.6.1.1" class="ltx_p">50</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.3.3" class="ltx_tr">
<th id="S3.T6.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S3.T6.1.3.3.1.1" class="ltx_text">cos.</span></th>
<th id="S3.T6.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T6.1.3.3.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.3.3.3.1.1" class="ltx_p">64.2 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.3.3.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.3.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.3.3.4.1.1" class="ltx_p">66.3 (0.8x)</span>
</span>
</td>
<td id="S3.T6.1.3.3.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.3.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.3.3.5.1.1" class="ltx_p">19.6 (0.9x)</span>
</span>
</td>
<td id="S3.T6.1.3.3.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.3.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.3.3.6.1.1" class="ltx_p">20.2 (0.4x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.4.4" class="ltx_tr">
<th id="S3.T6.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T6.1.4.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.4.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.4.4.2.1.1" class="ltx_p">62.6 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.4.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.4.4.3.1.1" class="ltx_p">64.3 (0.8x)</span>
</span>
</td>
<td id="S3.T6.1.4.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.4.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.4.4.4.1.1" class="ltx_p">19.3 (0.9x)</span>
</span>
</td>
<td id="S3.T6.1.4.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.4.4.5.1.1" class="ltx_p">24.5 (0.5x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.5.5" class="ltx_tr">
<th id="S3.T6.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T6.1.5.5.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.5.5.2.1.1" class="ltx_p">65.4 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.5.5.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.5.5.3.1.1" class="ltx_p">74.2 (0.9x)</span>
</span>
</td>
<td id="S3.T6.1.5.5.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.5.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.5.5.4.1.1" class="ltx_p">19.1 (0.9x)</span>
</span>
</td>
<td id="S3.T6.1.5.5.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.5.5.5.1.1" class="ltx_p">40.1 (0.8x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.6.6" class="ltx_tr">
<th id="S3.T6.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="S3.T6.1.6.6.1.1" class="ltx_text">L2</span></th>
<th id="S3.T6.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T6.1.6.6.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.6.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.6.6.3.1.1" class="ltx_p">67.0 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.6.6.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.6.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.6.6.4.1.1" class="ltx_p">78.2 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.6.6.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.6.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.6.6.5.1.1" class="ltx_p">22.3 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.6.6.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.6.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.6.6.6.1.1" class="ltx_p">48.2 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.7.7" class="ltx_tr">
<th id="S3.T6.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">comp.</th>
<td id="S3.T6.1.7.7.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.7.7.2.1.1" class="ltx_p">66.8 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.7.7.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.7.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.7.7.3.1.1" class="ltx_p"><span id="S3.T6.1.7.7.3.1.1.1" class="ltx_text ltx_font_bold">78.7 (1.0x)</span></span>
</span>
</td>
<td id="S3.T6.1.7.7.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.7.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.7.7.4.1.1" class="ltx_p">23.4 (1.1x)</span>
</span>
</td>
<td id="S3.T6.1.7.7.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.7.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.7.7.5.1.1" class="ltx_p">52.3 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.8.8" class="ltx_tr">
<th id="S3.T6.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">sing.</th>
<td id="S3.T6.1.8.8.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.8.8.2.1.1" class="ltx_p">66.4 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.8.8.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.8.8.3.1.1" class="ltx_p">77.0 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.8.8.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.8.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.8.8.4.1.1" class="ltx_p">22.1 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.8.8.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.8.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.8.8.5.1.1" class="ltx_p">47.7 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.9.9" class="ltx_tr">
<th id="S3.T6.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ward</th>
<td id="S3.T6.1.9.9.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.9.9.2.1.1" class="ltx_p"><span id="S3.T6.1.9.9.2.1.1.1" class="ltx_text ltx_font_bold">72.2 (1.1x)</span></span>
</span>
</td>
<td id="S3.T6.1.9.9.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.9.9.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.9.9.3.1.1" class="ltx_p">77.4 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.9.9.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.9.9.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.9.9.4.1.1" class="ltx_p">34.6 (1.6x)</span>
</span>
</td>
<td id="S3.T6.1.9.9.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.9.9.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.9.9.5.1.1" class="ltx_p">48.8 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.10.10" class="ltx_tr">
<th id="S3.T6.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S3.T6.1.10.10.1.1" class="ltx_text">L1</span></th>
<th id="S3.T6.1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ave.</th>
<td id="S3.T6.1.10.10.3" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.10.10.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.10.10.3.1.1" class="ltx_p">66.5 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.10.10.4" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.10.10.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.10.10.4.1.1" class="ltx_p">77.4 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.10.10.5" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.10.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.10.10.5.1.1" class="ltx_p">22.9 (1.1x)</span>
</span>
</td>
<td id="S3.T6.1.10.10.6" class="ltx_td ltx_align_justify ltx_border_t">
<span id="S3.T6.1.10.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.10.10.6.1.1" class="ltx_p">48.0 (1.0x)</span>
</span>
</td>
</tr>
<tr id="S3.T6.1.11.11" class="ltx_tr">
<th id="S3.T6.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">com.</th>
<td id="S3.T6.1.11.11.2" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.11.11.2.1.1" class="ltx_p">69.9 (1.1x)</span>
</span>
</td>
<td id="S3.T6.1.11.11.3" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.11.11.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.11.11.3.1.1" class="ltx_p">76.5 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.11.11.4" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.11.11.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.11.11.4.1.1" class="ltx_p"><span id="S3.T6.1.11.11.4.1.1.1" class="ltx_text ltx_font_bold">36.0 (1.7x)</span></span>
</span>
</td>
<td id="S3.T6.1.11.11.5" class="ltx_td ltx_align_justify">
<span id="S3.T6.1.11.11.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.11.11.5.1.1" class="ltx_p"><span id="S3.T6.1.11.11.5.1.1.1" class="ltx_text ltx_font_bold">54.0 (1.1x)</span></span>
</span>
</td>
</tr>
<tr id="S3.T6.1.12.12" class="ltx_tr">
<th id="S3.T6.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">sing.</th>
<td id="S3.T6.1.12.12.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T6.1.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.12.12.2.1.1" class="ltx_p">66.9 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.12.12.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T6.1.12.12.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.12.12.3.1.1" class="ltx_p">78.7 (1.0x)</span>
</span>
</td>
<td id="S3.T6.1.12.12.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T6.1.12.12.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.12.12.4.1.1" class="ltx_p">23.4 (1.1x)</span>
</span>
</td>
<td id="S3.T6.1.12.12.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T6.1.12.12.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T6.1.12.12.5.1.1" class="ltx_p">51.2 (1.0x)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F6" class="ltx_figure"><img src="/html/2004.11791/assets/femnist-02-10-man-complete-final.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>FEMNIST non-iid setting, using client fraction = 0.2 and number of rounds prior to clustering = 10, Manhattan distance metric and complete linkage.</figcaption>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Our final batch of experiments tests the effect of varying the distance metric and the linkage mechanism in the FEMNIST non-iid setting. The results of these experiments are listed in <a href="#S3.T6" title="TABLE VI â€£ III-B Effect of varying hierarchical clustering hyperparameters â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">TableÂ VI</span></a>. We see very little improvement in test accuracy or number of clients reaching the target accuracy by using FL+HC over FL. Where the cosine distance metric is employed, we see a degradation in performance. In this non-iid setting, the Euclidean distance metric produces the best final test accuracy when combined with complete linkage. The Manhattan distance metric combined with the complete distance metric (<a href="#S3.F6" title="Figure 6 â€£ III-B Effect of varying hierarchical clustering hyperparameters â€£ III Results &amp; Discussion â€£ Federated learning with hierarchical clustering of local updates to improve training on non-IID data This work is supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS." class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">FigureÂ 6</span></a>) allows for the most clients to reach the target accuracy (1.1x more than FL by round 50). Once again, the choice of linkage mechanism has less of an effect on performance compared to the choice of distance metric.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">Overall, by adjusting the hyperparameters of the hierarchical clustering algorithm, we are able to achieve greater test accuracy and an increase in the number of clients reaching a given test accuracy. Where the non-iid setting is defined by differing conditional distributions among clients (as in the label-swapped non-iid setting) the cosine distance metric performs marginally better than other distance metrics. A more natural partitioning of data (by that of the user who wrote the character in the FEMNIST non-iid setting) presents a more difficult challenge and FL+HC provides little advantage over ordinary FL. A good default setting for cases where the nature of how data is distributed among clients is unknown is to use the Manhattan distance metric, combined with the complete linkage method.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Future work</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We have shown how adding a clustering step into the FL process can help to increase performance in some non-iid settings by inspecting the full and clean weight updates from individual clients. However, popular methods for increasing privacy (e.g. differential privacy) use noisy client updates. Future work might look at the effect of this noise on the ability of FL+HC to find good clusterings of clients. Additionally, future work might explore the effect of compression methods (designed to reduce the payload of client updates) on FL+HC. In this work, we have shown that FL+HC works well for non-iid clients using a simple CNN to classify handwritten digits. Although we are confident this method will scale to larger networks and datasets, further work is required to confirm this. Finally, an area we did not cover is FL in the presence of adversaries. A investigation of how FL+HC could used to identify malicious clients could be a promising avenue of research.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this work we have presented federated learning with hierarchical clustering (FL+HC) - a novel method for training specialised machine learning models over distributed datasets. This is achieved by introducing a clustering step in the FL protocol which clusters clients according to the similarity of their model weight updates.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We have shown results for an image classification problem using a CNN trained on simulated distributed data partitioned in a variety of iid and non-iid settings. These results show the efficacy of our approach compared to FL alone. Our first experiments varied the fraction of clients (cf) participating in each round of training and the number of rounds prior to the clustering step (n) of FL+HC. FL+HC provides results identical to FL under iid data for all but n=1. In 2 of 3 of our non-iid settings, FL+HC allows learning to converge more quickly and allows for more clients (up to 2x) to reach a target accuracy at the end of training. A second range of experiments tested the effect of varying the hyperparameters of the hierarchical clustering algorithm. Results among the non-iid settings show that FL+HC can result in a reduction in communication rounds by <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.p2.1.m1.1a"><mo id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><gt id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">&gt;</annotation></semantics></math>5x when using the manhattan distance metric. Different distance metrics result in better performance depending the non-iid nature of the data. Finally we presented a recommendation for the best default settings when training on non-iid data with FL+HC.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
P.Â Kairouz, H.Â B. McMahan, B.Â Avent, A.Â Bellet, M.Â Bennis, A.Â NitinÂ Bhagoji,
K.Â Bonawitz, Z.Â Charles, G.Â Cormode, R.Â Cummings, R.Â G.Â L. Dâ€™Oliveira,
S.Â ElÂ Rouayheb, D.Â Evans, J.Â Gardner, Z.Â Garrett, A.Â GascÃ³n, B.Â Ghazi,
P.Â B. Gibbons, M.Â Gruteser, Z.Â Harchaoui, C.Â He, L.Â He, Z.Â Huo,
B.Â Hutchinson, J.Â Hsu, M.Â Jaggi, T.Â Javidi, G.Â Joshi, M.Â Khodak, J.Â KoneÄnÃ½, A.Â Korolova, F.Â Koushanfar, S.Â Koyejo, T.Â Lepoint, Y.Â Liu,
P.Â Mittal, M.Â Mohri, R.Â Nock, A.Â Ã–zgÃ¼r, R.Â Pagh, M.Â Raykova, H.Â Qi,
D.Â Ramage, R.Â Raskar, D.Â Song, W.Â Song, S.Â U. Stich, Z.Â Sun,
A.Â TheerthaÂ Suresh, F.Â TramÃ¨r, P.Â Vepakomma, J.Â Wang, L.Â Xiong, Z.Â Xu,
Q.Â Yang, F.Â X. Yu, H.Â Yu, and S.Â Zhao, â€œAdvances and Open Problems in
Federated Learning,â€ <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1912.04977, Dec. 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Q.Â Yang, Y.Â Liu, T.Â Chen, and Y.Â Tong, â€œFederated Machine Learning: Concept
and Applications,â€ <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology TIST</em>, vol.Â 10, no.Â 2, pp. 1â€“19, Jan. 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T.Â Li, A.Â K. Sahu, A.Â Talwalkar, and V.Â Smith, â€œFederated Learning:
Challenges, Methods, and Future Directions,â€ <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p.
arXiv:1908.07873, Aug. 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
B.Â McMahan, E.Â Moore, D.Â Ramage, S.Â Hampson, and B.Â A. yÂ Arcas,
â€œCommunication-Efficient Learning of Deep Networks from Decentralized
Data,â€ in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 2017, pp.
1273â€“1282.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
F.Â Sattler, K.-R. MÃ¼ller, and W.Â Samek, â€œClustered Federated Learning:
Model-Agnostic Distributed Multi-Task Optimization under Privacy
Constraints,â€ <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1910.01991, Oct. 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M.Â Ester, H.Â P. Kriegel, J.Â Sander, X.Â X. Kdd, and 1996, â€œA density-based
algorithm for discovering clusters in large spatial databases with noise.â€
in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">International Conference on Knowledge Discovery and Data Mining</em>,
1996.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T.Â Hastie, R.Â Tibshirani, and J.Â Friedman, <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">The Elements of Statistical
Learning</em>, 2ndÂ ed., ser. Springer Series in Statistics.Â Â Â New York: Springer New York, 2009.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
R.Â McDonald, K.Â Hall, and G.Â Mann, â€œDistributed training strategies for the
structured perceptron,â€ in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">NAACL HLT</em>, 2014.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
D.Â Povey, X.Â Zhang, and S.Â Khudanpur, â€œParallel training of DNNs with Natural
Gradient and Parameter Averaging,â€ in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ICLR Workshop Track</em>, 2015.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
K.Â Hsieh, A.Â Phanishayee, O.Â Mutlu, and P.Â B. Gibbons, â€œThe Non-IID Data
Quagmire of Decentralized Machine Learning,â€ <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p.
arXiv:1910.00189, Oct. 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y.Â Zhao, M.Â Li, L.Â Lai, N.Â Suda, D.Â Civin, and V.Â Chandra, â€œFederated
Learning with Non-IID Data,â€ <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1806.00582, Jun.
2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
T.Â Li, A.Â K. Sahu, M.Â Zaheer, M.Â Sanjabi, A.Â Talwalkar, and V.Â Smith,
â€œFederated Optimization for Heterogeneous Networks,â€ <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p.
arXiv:1812.06127, Dec. 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
H.Â Eichner, T.Â Koren, H.Â B. McMahan, N.Â Srebro, and K.Â Talwar, â€œSemi-Cyclic
Stochastic Gradient Descent,â€ in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine
Learning</em>, Apr. 2019, p. arXiv:1904.10120.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y.Â Zhang and Q.Â Yang, â€œA Survey on Multi-Task Learning,â€ <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>,
p. arXiv:1707.08114, Jul. 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S.Â Liu, S.Â J. Pan, and Q.Â Ho, â€œDistributed Multi-Task Relationship
Learning,â€ in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">the 23rd ACM SIGKDD International Conference</em>.Â Â Â New York, New York, USA: ACM Press, 2017,
pp. 937â€“946.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J.Â Wang, M.Â Kolar, and N.Â Srebro, â€œDistributed multi-task learning,â€ in
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Conference on Artificial Intelligence and Statistics</em>, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
V.Â Smith, C.-K. Chiang, M.Â Sanjabi, and A.Â Talwalkar, â€œFederated Multi-Task
Learning,â€ in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, May
2017, p. arXiv:1705.10467.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
A.Â Ghosh, J.Â Hong, D.Â Yin, and K.Â Ramchandran, â€œRobust Federated Learning in
a Heterogeneous Environment,â€ <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1906.06629, Jun.
2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y.Â Lecun, L.Â Bottou, Y.Â Bengio, and P.Â Haffner, â€œGradient-based learning
applied to document recognition,â€ <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol.Â 86,
no.Â 11, pp. 2278â€“2324, 1998.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
S.Â Caldas, P.Â Wu, T.Â Li, J.Â KoneÄnÃ½, H.Â B. McMahan, V.Â Smith, and
A.Â Talwalkar, â€œLEAF: A Benchmark for Federated Settings,â€ in
<em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Workshop on Federated Learning for Data Privacy and Confidentiality</em>,
2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
C.Â C. Aggarwal, A.Â Hinneburg, and D.Â A. Keim, â€œOn the surprising behavior of
distance metrics in high dimensional space,â€ <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Database Theory - Icdt
2001, Proceedings</em>, vol. 1973, pp. 420â€“434, 2001.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2004.11790" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2004.11791" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2004.11791">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2004.11791" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2004.11792" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar 17 06:26:46 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
