<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.07124] FedClust: Tackling Data Heterogeneity in Federated Learning through Weight-Driven Client Clustering</title><meta property="og:description" content="Federated learning (FL) is an emerging distributed machine learning paradigm that enables collaborative training of machine learning models over decentralized devices without exposing their local data. One of the major…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedClust: Tackling Data Heterogeneity in Federated Learning through Weight-Driven Client Clustering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedClust: Tackling Data Heterogeneity in Federated Learning through Weight-Driven Client Clustering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.07124">

<!--Generated on Mon Aug  5 15:13:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning,  Clustered Federated Learning,  Non-IID Data">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">FedClust: Tackling Data Heterogeneity in Federated Learning through Weight-Driven Client Clustering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Md Sirajul Islam
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id3.1.id1" class="ltx_text ltx_affiliation_institution">School of Computing and Informatics
<br class="ltx_break">University of Louisiana at Lafayette</span><span id="id4.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id5.3.id3" class="ltx_text ltx_affiliation_city">Lafayette, LA</span><span id="id6.4.id4" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:md-sirajul.islam1@louisiana.edu">md-sirajul.islam1@louisiana.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simin Javaherian
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id7.1.id1" class="ltx_text ltx_affiliation_institution">School of Computing and Informatics
<br class="ltx_break">University of Louisiana at Lafayette</span><span id="id8.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id9.3.id3" class="ltx_text ltx_affiliation_city">Lafayette, LA</span><span id="id10.4.id4" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:simin.javaherian1@louisiana.edu">simin.javaherian1@louisiana.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fei Xu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id11.1.id1" class="ltx_text ltx_affiliation_institution">School of Computer Science and Technology
<br class="ltx_break">East China Normal University</span><span id="id12.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id13.3.id3" class="ltx_text ltx_affiliation_city">Shanghai</span><span id="id14.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:fxu@cs.ecnu.edu.cn">fxu@cs.ecnu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xu Yuan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id15.1.id1" class="ltx_text ltx_affiliation_institution">Department of Computer and Information Sciences
<br class="ltx_break">University of Delaware</span><span id="id16.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id17.3.id3" class="ltx_text ltx_affiliation_city">Newark, DE</span><span id="id18.4.id4" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xyuan@udel.edu">xyuan@udel.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Li Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id19.1.id1" class="ltx_text ltx_affiliation_institution">School of Computing and Informatics
<br class="ltx_break">University of Louisiana at Lafayette</span><span id="id20.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id21.3.id3" class="ltx_text ltx_affiliation_city">Lafayette, LA</span><span id="id22.4.id4" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:li.chen@louisiana.edu">li.chen@louisiana.edu</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nian-Feng Tzeng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"> <span id="id23.1.id1" class="ltx_text ltx_affiliation_institution">School of Computing and Informatics
<br class="ltx_break">University of Louisiana at Lafayette</span><span id="id24.2.id2" class="ltx_text ltx_affiliation_streetaddress">1 Thørväld Circle</span><span id="id25.3.id3" class="ltx_text ltx_affiliation_city">Lafayette, LA</span><span id="id26.4.id4" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:nianfeng.tzeng@louisiana.edu">nianfeng.tzeng@louisiana.edu</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id2.2" class="ltx_p">Federated learning (FL) is an emerging distributed machine learning paradigm that enables collaborative training of machine learning models over decentralized devices without exposing their local data. One of the major challenges in FL is the presence of uneven data distributions across client devices, violating the well-known assumption of independent-and-identically-distributed (IID) training samples in conventional machine learning. To address the performance degradation issue incurred by such data heterogeneity, clustered federated learning (CFL) shows its promise by grouping clients into separate learning clusters based on the similarity of their local data distributions. However, state-of-the-art CFL approaches require a large number of communication rounds to learn the distribution similarities during training until the formation of clusters is stabilized. Moreover, some of these algorithms heavily rely on a predefined number of clusters, thus limiting their flexibility and adaptability. In this paper, we propose <span id="id2.2.1" class="ltx_text ltx_font_italic">FedClust</span>, a novel approach for CFL that leverages the correlation between local model weights and the data distribution of clients. <span id="id2.2.2" class="ltx_text ltx_font_italic">FedClust</span> groups clients into clusters in a one-shot manner by measuring the similarity degrees among clients based on the strategically selected partial weights of locally trained models. We conduct extensive experiments on four benchmark datasets with different non-IID data settings. Experimental results demonstrate that <span id="id2.2.3" class="ltx_text ltx_font_italic">FedClust</span> achieves higher model accuracy up to <math id="id1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><csymbol cd="latexml" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\sim</annotation></semantics></math>45% as well as faster convergence with a significantly reduced communication cost up to 2.7<math id="id2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="id2.2.m2.1a"><mo id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><times id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">\times</annotation></semantics></math> compared to its state-of-the-art counterparts.</p>
</div>
<div class="ltx_keywords">Federated Learning, Clustered Federated Learning, Non-IID Data
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3673038.3673151</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>The 53rd International Conference on Parallel Processing; August 12–15, 2024; Gotland, Sweden</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>The 53rd International Conference on Parallel Processing (ICPP ’24), August 12–15, 2024, Gotland, Sweden</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3673038.3673151</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-1793-2/24/08</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed computing methodologies</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Modeling and simulation</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With the proliferation of Internet-of-Things (IoT) and the widespread adoption of artificial intelligence across various application domains, machine learning has been increasingly shifted toward the network edge, where computations are performed on edge devices rather than in centralized data centers <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. Such a computing paradigm shift is enabled by the rapid development of the computation and storage capacity on edge devices, able to handle more complex and data-intensive tasks. To analyze and process massive data generated by various edge devices (<span id="S1.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, mobile phones, wearable devices, and autonomous vehicles), the traditional machine learning approach falls short. It requires transmitting large volumes of user data to centralized cloud servers, incurring prohibitive communication costs and raising privacy concerns as well.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) has become a promising solution, allowing for participating devices to collaboratively train a globally shared model under the coordination of a central server, without exposing their local data. Due to its superior privacy-preservation implications, FL has been widely adopted by numerous companies (such as Google <cite class="ltx_cite ltx_citemacro_citep">(Hard et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>) in a variety of applications, including computer vision <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>, natural language processing [23], and human activity recognition <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Tu et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>.
Essentially, FL is a distributed machine learning framework, with training data resident on decentralized client devices.
In classical FL training <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>; Karimireddy et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2020</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, the server broadcasts the current global model to the participating clients. Each client trains the model using its local data and sends its local updates to the server. The server then aggregates model updates from participating clients to update the global model, to be trained in the next round. These steps repeat until achieving a certain level of model accuracy or a pre-specified number of communication rounds.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, deploying FL often involves a number of devices that generate heterogeneous data due to their varying use styles. For instance, different users may watch videos on diverse types of content (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">e.g.</span>, news, sports, and entertainment) and run their smartphones in varying frequencies. The presence of heterogeneous data across client devices breaks the conventional assumption of independent-and-identically-distributed (IID) training data, raising the new challenge of non-IID data distribution in the FL paradigm. Such data heterogeneity not only increases the overall communication cost but also degrades global model performance <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Zhao et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite>, increasingly drawing research attention to mitigate the adverse impact of non-IID data on FL <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Duan et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Briggs et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Kairouz et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Instead of learning a single global model, an alternative approach focuses on attaining personalized models for individual users to arrive at personalized FL, motivated by the observation that the globally learned model may exhibit lower accuracy on a participating device than a local model independently trained on its own data <cite class="ltx_cite ltx_citemacro_citep">(Hanzely and Richtárik, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>.
More specifically, in addition to obtaining a collaboratively-trained global model, each client learns its personalized local model with various techniques such as regularization, local fine-tuning, model interpolation, multi-task learning, and knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Fallah et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Mansour et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2020</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2021</a>, <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Smith et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2017</a>; Luo et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2023</a>; Tan et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>.
Nevertheless, apart from a lack of generalization by its nature, personalized FL suffers from limited scalability, due to the extra computation overhead for learning a personalized model on each participant device. Additionally, it often fails to learn effectively on limited participant-specific data, unable to accurately capture local data distributions.
</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Recently, clustered federated learning (CFL) <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Islam et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2024</a>)</cite> has gained significant attention as a promising solution for tackling data heterogeneity. CFL frameworks
group clients into multiple clusters based on the similarity of their data distributions and train a separate model for each cluster to alleviate the adverse effect of non-IID data.
Most of the existing CFL approaches indirectly measure the data distribution similarity among clients by utilizing their local model updates or the gradients (<span id="S1.p5.1.1" class="ltx_text ltx_font_italic">e.g.</span>, <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>). Despite the promise of CFL, <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">it remains an open challenge for clustering clients optimally</span>.
Existing efforts <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Tu et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> rely on a predefined cluster count,
which is difficult to determine optimally without any prior knowledge about data distributions or learning tasks among the clients. Under the assumption that the server holds a portion of globally shared data, Morafah <span id="S1.p5.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Morafah et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> proposed to cluster clients based on the similarity of the inferences on the shared data using updated local models from clients. Such a data availability assumption on the server may not be practical in reality. Sattler <span id="S1.p5.1.4" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> proposed to iteratively bi-partition clients into clusters based on the cosine similarity among their local model updates. This approach is communication-inefficient as it requires a large number of communication rounds to form stabilized clusters. Moreover, state-of-the-art CFL methods hardly allow the flexibility of balancing generalization and personalization.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">To address the aforementioned limitations, we propose a novel clustered federated learning method, named <span id="S1.p6.1.1" class="ltx_text ltx_font_italic">FedClust</span>, which efficiently groups clients with non-IID data into suitable clusters. The design of <span id="S1.p6.1.2" class="ltx_text ltx_font_italic">FedClust</span> leverages our insight into the implicit relationship between the local model weights and the underlying data distribution on a client device. In particular, <span id="S1.p6.1.3" class="ltx_text ltx_font_italic">FedClust</span> utilizes locally-trained model weights on a client, obtained by performing a few local training iterations on its own data. To measure the similarity among clients, <span id="S1.p6.1.4" class="ltx_text ltx_font_italic">FedClust</span> requires each client to send only the strategically selected partial weights to the server, further reducing the amount of data transmission. After receiving weights from all the clients, <span id="S1.p6.1.5" class="ltx_text ltx_font_italic">FedClust</span> constructs a proximity matrix based on the Euclidean distance to efficiently identify distribution similarities among clients. An agglomerative hierarchical clustering (bottom-up approach) <cite class="ltx_cite ltx_citemacro_citep">(Day and Edelsbrunner, <a href="#bib.bib4" title="" class="ltx_ref">1984</a>)</cite> on the proximity matrix is employed to classify similar clients into an optimal number of clusters. Remarkably, <span id="S1.p6.1.6" class="ltx_text ltx_font_italic">FedClust</span> operates without the need for any proxy data on the server, as opposed to all the existing solutions <cite class="ltx_cite ltx_citemacro_citep">(Morafah et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>; Gong et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite>.
Furthermore, in contrast to its state-of-the-art counterparts <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Briggs et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> which fail to accommodate client dynamics,
<span id="S1.p6.1.7" class="ltx_text ltx_font_italic">FedClust</span> provides an elegant mechanism for effectively incorporating new clients into appropriate clusters on-the-fly.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.3" class="ltx_p">Finally, we have conducted extensive experiments to evaluate the performance of <span id="S1.p7.3.1" class="ltx_text ltx_font_italic">FedClust</span> on four benchmark image classification datasets under different non-IID data settings, with our state-of-the-art counterparts following the LeNet-5 <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">1989</a>)</cite> and ResNet-9 <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> architectures. The experimental results demonstrate that the proposed approach significantly improves overall model accuracy, surpassing both global and personalized baselines by up to <math id="S1.p7.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S1.p7.1.m1.1a"><mo id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><csymbol cd="latexml" id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\sim</annotation></semantics></math>45% and <math id="S1.p7.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S1.p7.2.m2.1a"><mo id="S1.p7.2.m2.1.1" xref="S1.p7.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S1.p7.2.m2.1b"><csymbol cd="latexml" id="S1.p7.2.m2.1.1.cmml" xref="S1.p7.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.2.m2.1c">\sim</annotation></semantics></math>18%, respectively. Moreover, <span id="S1.p7.3.2" class="ltx_text ltx_font_italic">FedClust</span> enables faster convergence due to great reduction in communication costs by 1.2 - 2.7<math id="S1.p7.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S1.p7.3.m3.1a"><mo id="S1.p7.3.m3.1.1" xref="S1.p7.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p7.3.m3.1b"><times id="S1.p7.3.m3.1.1.cmml" xref="S1.p7.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.3.m3.1c">\times</annotation></semantics></math> when compared to state-of-the-art FL methods.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Our key contributions are summarized as follows:</p>
</div>
<div id="S1.p9" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We analyze the relationship of model weights with the underlying data distribution of clients. Moreover, we observe the implicit connection of different layer weights with the local data distributions.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a novel clustered federated learning framework named <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">FedClust</span> to alleviate the adverse impact of non-IID data on FL. Our framework utilizes the similarity among strategically selected partial weights of locally-trained models from participant devices, to optimally form clusters for efficient and effective learning. In addition, we present an elegant strategy to accommodate client dynamics, incorporating newcomers into appropriate clusters in real time.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments under diverse representative settings to evaluate <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">FedClust</span> with a variety of performance metrics. Experimental results demonstrate the advantages of <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_italic">FedClust</span> over the state-of-the-art baselines, especially in improving overall model accuracy and communication efficiency.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">The remainder of this paper is organized as follows. Section 2 describes related work. The background and motivation of this work are introduced in Section 3. In Section 4, we present a brief explanation on the design of our proposed <span id="S1.p10.1.1" class="ltx_text ltx_font_italic">FedClust</span> framework. In Section 5, we evaluate <span id="S1.p10.1.2" class="ltx_text ltx_font_italic">FedClust</span> and compare its performance results with those of state-of-the-art counterparts. Finally, Section 6 concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we review pertinent work on addressing the non-IID data issue in federated learning.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Federated Learning with Non-IID Data</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">In federated learning (FL), data stored in each user device greatly varies due to different usage patterns and habits. Specifically, different users may prefer to browse news on different topics <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, sports, politics, and technology, leading to non-IID data for different users. In reality, it is natural that the data used for FL training are usually non-IID. The most widely used FL algorithm <span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite> fails to achieve optimal performance in the presence of non-IID data across clients. Several studies <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Zhao et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> have shown that non-IID data not only decreases the accuracy of the trained model but also slows down training convergence with larger communication costs. To mitigate the client drift issue caused by non-IID data, <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> introduces a proximal term to the local training objective to keep local models close to the global model. <span id="S2.SS1.p1.1.4" class="ltx_text ltx_font_italic">FedDyn</span> <cite class="ltx_cite ltx_citemacro_citep">(Acar et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> introduces a dynamic regularizer for each client in every round to align the global and the local models.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">In <span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_italic">SCAFFOLD</span> <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>, data heterogeneity is modeled as a source of variance among clients following a variance reduction technique. It estimates the direction of updates for the global model and that of each client. The drift of local training is then calculated by comparing two update directions. Finally, it modifies the local updates by incorporating the drift in local training. <span id="S2.SS1.p2.1.2" class="ltx_text ltx_font_italic">FedNova</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2020b</a>)</cite> considers the number of local training epochs performed by each client during every round of FL to produce an unbiased global model. It normalizes and scales local updates based on the number of local training epochs before updating the global model. While effective under certain scenarios, these global FL methods cannot systematically address the data heterogeneity issue. Several studies <cite class="ltx_cite ltx_citemacro_citep">(Lai et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Javaherian et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2024</a>)</cite> proposed guided participant selection strategies, with a subset of clients is selected to participate in FL training according to some predefined criteria. These approaches provide faster model convergence and better time-to-accuracy performance.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">To mitigate the impact of non-IID data, prior approaches <cite class="ltx_cite ltx_citemacro_citep">(Mansour et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2020</a>; Jiang et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Fallah et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> focused on personalizing the global model with each client’s local data via fine-tuning. They let the global model act as an initial point for learning personalized models at clients based on their local data. Nevertheless, the global model may not be a good initiator, if the local data distributions of clients highly differ among one another. Similarly, Smith <span id="S2.SS1.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Smith et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite> extended multitask learning in FL training to aim at learning personalized models for multiple related tasks with the coordination of a central server. Recent work, <span id="S2.SS1.p3.1.2" class="ltx_text ltx_font_italic">PGFed</span> <cite class="ltx_cite ltx_citemacro_citep">(Luo et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>, formulated client’s local objectives as personalized global objectives to explicitly transfer collaborative knowledge across them.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Clustered Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Alternatively, clustered federated learning (CFL) approaches <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Briggs et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite> have been proposed to efficiently alleviate the challenge due to non-IID data among clients. They divide clients into clusters based on their data distributions so that clients in each cluster collaboratively train one model. Existing CFL approaches mainly differ in the process of identifying the data distribution similarity among clients by using model weights, gradient updates, or local loss.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Since the server cannot access clients’ data in FL, <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Duan et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> proposed to cluster clients based on the cosine similarity of their local model updates or gradients. More specifically, <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">FMTL</span> <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> iteratively bi-partitions clients into clusters. Initially, all clients train a shared model by forming one cluster. Later, the server partitions the initial cluster into two new clusters according to the cosine similarity of their local model updates. The above steps repeat until no new cluster is generated. <span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_italic">IFCA</span> <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> requires a predefined number of clusters. Each client needs to download available models of all clusters at each round and selects one that provides the highest local test accuracy. It incurs large communication costs due to the constant communication between the server and every client to form clusters. Moreover, the performance of <span id="S2.SS2.p2.1.3" class="ltx_text ltx_font_italic">IFCA</span> heavily depends on the prior settings of the cluster count, which is difficult to identify without the knowledge of client local data distributions. Both of the above methods require large numbers of communication rounds to form stable clusters.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Several early pursuits <cite class="ltx_cite ltx_citemacro_citep">(Briggs et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite> determine the number of clusters using the distances of their local model weights. Gong <span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> proposed to pre-cluster clients based on certain statistics of each client’s local data, and then adjust initial clustering by considering the model distance calculated among clients using partial weights. However, sharing statistics of the client’s data with the server compromises the privacy promise of FL. Recently, Vahidian <span id="S2.SS2.p3.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Vahidian et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> proposed <span id="S2.SS2.p3.1.3" class="ltx_text ltx_font_italic">PACFL</span>, which identifies data distribution similarities among clients by using the principal angles over the client data subspaces. Before starting federation, it applies truncated Singular Value Decomposition (SVD) on each client’s local data to obtain a small set of principal vectors which represent its underlying data distribution.</p>
</div>
<figure id="S2.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S2.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.07124/assets/x1.png" id="S2.F1.sf1.g1" class="ltx_graphics ltx_img_square" width="115" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Layer 1 (CL)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S2.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.07124/assets/x2.png" id="S2.F1.sf2.g1" class="ltx_graphics ltx_img_square" width="115" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Layer 7 (CL)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S2.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.07124/assets/x3.png" id="S2.F1.sf3.g1" class="ltx_graphics ltx_img_square" width="115" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Layer 14 (FC)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S2.F1.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.07124/assets/x4.png" id="S2.F1.sf4.g1" class="ltx_graphics ltx_img_square" width="115" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Layer 16 (FC)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Illustration of the distance matrices calculated using different layer weights, where CL indicates convolutional layer and FC indicates fully connected layer. A lighter color in the distance matrices denotes a smaller distance, i.e., the two models are more similar. </figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Background And Motivation</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Federated Learning</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Federated learning (FL) is a privacy-preserving framework that allows distributed clients to collaboratively train machine learning or deep learning models without sharing their local data <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. FL usually involves a set of clients and a central server. Each clients receives its initial global model from the server and then train it for a few local iterations using its local data. The server is responsible for aggregating all local model updates to update the globally shared model. The communication between the server and every client follows a predetermined communication protocol. The server has no prior knowledge about the data distribution across devices as it cannot access the raw data stored in clients.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.9" class="ltx_p">McMahan <span id="S3.SS1.p2.9.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite> first introduced a federated averaging algorithm (<span id="S3.SS1.p2.9.2" class="ltx_text ltx_font_italic">FedAvg</span>) that implements the idea of federated learning. In order to optimize the communication efficiency of FL over real-world data, the <span id="S3.SS1.p2.9.3" class="ltx_text ltx_font_italic">FedAvg</span> algorithm trains a globally shared model across clients by a weighted averaging of the local model parameters of clients. In particular, the goal of <span id="S3.SS1.p2.9.4" class="ltx_text ltx_font_italic">FedAvg</span> is typically to minimize the following objective function:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\min_{\theta}F(\theta)\overset{\scriptscriptstyle\Delta}{=}\sum_{i=1}^{m}\frac{n_{i}}{N}F_{i}(\theta)" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.3" xref="S3.E1.m1.2.3.cmml"><mrow id="S3.E1.m1.2.3.2" xref="S3.E1.m1.2.3.2.cmml"><munder id="S3.E1.m1.2.3.2.1" xref="S3.E1.m1.2.3.2.1.cmml"><mi id="S3.E1.m1.2.3.2.1.2" xref="S3.E1.m1.2.3.2.1.2.cmml">min</mi><mi id="S3.E1.m1.2.3.2.1.3" xref="S3.E1.m1.2.3.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E1.m1.2.3.2a" xref="S3.E1.m1.2.3.2.cmml">⁡</mo><mi id="S3.E1.m1.2.3.2.2" xref="S3.E1.m1.2.3.2.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.1" xref="S3.E1.m1.2.3.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.3.2" xref="S3.E1.m1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.3.3.2.1" xref="S3.E1.m1.2.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.2.3.3.2.2" xref="S3.E1.m1.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.1a" xref="S3.E1.m1.2.3.1.cmml">​</mo><mover accent="true" id="S3.E1.m1.2.3.4" xref="S3.E1.m1.2.3.4.cmml"><mo mathsize="50%" id="S3.E1.m1.2.3.4.2" xref="S3.E1.m1.2.3.4.2.cmml">=</mo><mo mathsize="50%" id="S3.E1.m1.2.3.4.1" xref="S3.E1.m1.2.3.4.1.cmml">Δ</mo></mover><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.1b" xref="S3.E1.m1.2.3.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.5" xref="S3.E1.m1.2.3.5.cmml"><mstyle displaystyle="false" id="S3.E1.m1.2.3.5.1" xref="S3.E1.m1.2.3.5.1.cmml"><msubsup id="S3.E1.m1.2.3.5.1a" xref="S3.E1.m1.2.3.5.1.cmml"><mo maxsize="50%" minsize="50%" stretchy="true" id="S3.E1.m1.2.3.5.1.2.2" xref="S3.E1.m1.2.3.5.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.3.5.1.2.3" xref="S3.E1.m1.2.3.5.1.2.3.cmml"><mi mathsize="71%" id="S3.E1.m1.2.3.5.1.2.3.2" xref="S3.E1.m1.2.3.5.1.2.3.2.cmml">i</mi><mo mathsize="71%" id="S3.E1.m1.2.3.5.1.2.3.1" xref="S3.E1.m1.2.3.5.1.2.3.1.cmml">=</mo><mn mathsize="71%" id="S3.E1.m1.2.3.5.1.2.3.3" xref="S3.E1.m1.2.3.5.1.2.3.3.cmml">1</mn></mrow><mi mathsize="71%" id="S3.E1.m1.2.3.5.1.3" xref="S3.E1.m1.2.3.5.1.3.cmml">m</mi></msubsup></mstyle><mrow id="S3.E1.m1.2.3.5.2" xref="S3.E1.m1.2.3.5.2.cmml"><mstyle displaystyle="false" scriptlevel="+2" id="S3.E1.m1.2.3.5.2.2" xref="S3.E1.m1.2.3.5.2.2.cmml"><mfrac id="S3.E1.m1.2.3.5.2.2a" xref="S3.E1.m1.2.3.5.2.2.cmml"><msub id="S3.E1.m1.2.3.5.2.2.2" xref="S3.E1.m1.2.3.5.2.2.2.cmml"><mi id="S3.E1.m1.2.3.5.2.2.2.2" xref="S3.E1.m1.2.3.5.2.2.2.2.cmml">n</mi><mi id="S3.E1.m1.2.3.5.2.2.2.3" xref="S3.E1.m1.2.3.5.2.2.2.3.cmml">i</mi></msub><mi id="S3.E1.m1.2.3.5.2.2.3" xref="S3.E1.m1.2.3.5.2.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.5.2.1" xref="S3.E1.m1.2.3.5.2.1.cmml">​</mo><msub id="S3.E1.m1.2.3.5.2.3" xref="S3.E1.m1.2.3.5.2.3.cmml"><mi mathsize="50%" id="S3.E1.m1.2.3.5.2.3.2" xref="S3.E1.m1.2.3.5.2.3.2.cmml">F</mi><mi mathsize="71%" id="S3.E1.m1.2.3.5.2.3.3" xref="S3.E1.m1.2.3.5.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.5.2.1a" xref="S3.E1.m1.2.3.5.2.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.5.2.4.2" xref="S3.E1.m1.2.3.5.2.cmml"><mo maxsize="50%" minsize="50%" id="S3.E1.m1.2.3.5.2.4.2.1" xref="S3.E1.m1.2.3.5.2.cmml">(</mo><mi mathsize="50%" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">θ</mi><mo maxsize="50%" minsize="50%" id="S3.E1.m1.2.3.5.2.4.2.2" xref="S3.E1.m1.2.3.5.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.3.cmml" xref="S3.E1.m1.2.3"><times id="S3.E1.m1.2.3.1.cmml" xref="S3.E1.m1.2.3.1"></times><apply id="S3.E1.m1.2.3.2.cmml" xref="S3.E1.m1.2.3.2"><apply id="S3.E1.m1.2.3.2.1.cmml" xref="S3.E1.m1.2.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.1.1.cmml" xref="S3.E1.m1.2.3.2.1">subscript</csymbol><min id="S3.E1.m1.2.3.2.1.2.cmml" xref="S3.E1.m1.2.3.2.1.2"></min><ci id="S3.E1.m1.2.3.2.1.3.cmml" xref="S3.E1.m1.2.3.2.1.3">𝜃</ci></apply><ci id="S3.E1.m1.2.3.2.2.cmml" xref="S3.E1.m1.2.3.2.2">𝐹</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜃</ci><apply id="S3.E1.m1.2.3.4.cmml" xref="S3.E1.m1.2.3.4"><ci id="S3.E1.m1.2.3.4.1.cmml" xref="S3.E1.m1.2.3.4.1">Δ</ci><eq id="S3.E1.m1.2.3.4.2.cmml" xref="S3.E1.m1.2.3.4.2"></eq></apply><apply id="S3.E1.m1.2.3.5.cmml" xref="S3.E1.m1.2.3.5"><apply id="S3.E1.m1.2.3.5.1.cmml" xref="S3.E1.m1.2.3.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.5.1.1.cmml" xref="S3.E1.m1.2.3.5.1">superscript</csymbol><apply id="S3.E1.m1.2.3.5.1.2.cmml" xref="S3.E1.m1.2.3.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.5.1.2.1.cmml" xref="S3.E1.m1.2.3.5.1">subscript</csymbol><sum id="S3.E1.m1.2.3.5.1.2.2.cmml" xref="S3.E1.m1.2.3.5.1.2.2"></sum><apply id="S3.E1.m1.2.3.5.1.2.3.cmml" xref="S3.E1.m1.2.3.5.1.2.3"><eq id="S3.E1.m1.2.3.5.1.2.3.1.cmml" xref="S3.E1.m1.2.3.5.1.2.3.1"></eq><ci id="S3.E1.m1.2.3.5.1.2.3.2.cmml" xref="S3.E1.m1.2.3.5.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.3.5.1.2.3.3.cmml" xref="S3.E1.m1.2.3.5.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.3.5.1.3.cmml" xref="S3.E1.m1.2.3.5.1.3">𝑚</ci></apply><apply id="S3.E1.m1.2.3.5.2.cmml" xref="S3.E1.m1.2.3.5.2"><times id="S3.E1.m1.2.3.5.2.1.cmml" xref="S3.E1.m1.2.3.5.2.1"></times><apply id="S3.E1.m1.2.3.5.2.2.cmml" xref="S3.E1.m1.2.3.5.2.2"><divide id="S3.E1.m1.2.3.5.2.2.1.cmml" xref="S3.E1.m1.2.3.5.2.2"></divide><apply id="S3.E1.m1.2.3.5.2.2.2.cmml" xref="S3.E1.m1.2.3.5.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.5.2.2.2.1.cmml" xref="S3.E1.m1.2.3.5.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.3.5.2.2.2.2.cmml" xref="S3.E1.m1.2.3.5.2.2.2.2">𝑛</ci><ci id="S3.E1.m1.2.3.5.2.2.2.3.cmml" xref="S3.E1.m1.2.3.5.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.3.5.2.2.3.cmml" xref="S3.E1.m1.2.3.5.2.2.3">𝑁</ci></apply><apply id="S3.E1.m1.2.3.5.2.3.cmml" xref="S3.E1.m1.2.3.5.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.5.2.3.1.cmml" xref="S3.E1.m1.2.3.5.2.3">subscript</csymbol><ci id="S3.E1.m1.2.3.5.2.3.2.cmml" xref="S3.E1.m1.2.3.5.2.3.2">𝐹</ci><ci id="S3.E1.m1.2.3.5.2.3.3.cmml" xref="S3.E1.m1.2.3.5.2.3.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\min_{\theta}F(\theta)\overset{\scriptscriptstyle\Delta}{=}\sum_{i=1}^{m}\frac{n_{i}}{N}F_{i}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.8" class="ltx_p">Here, <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation></semantics></math> is the set of participating clients and client <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">i</annotation></semantics></math> has local dataset <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathcal{D}_{i}</annotation></semantics></math>, where <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="n_{i}=|\mathcal{D}_{i}|" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">n</mi><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.4.m4.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></eq><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝑛</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1"><abs id="S3.SS1.p2.4.m4.1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.2"></abs><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">n_{i}=|\mathcal{D}_{i}|</annotation></semantics></math> and <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="N=\sum_{i=1}^{m}n_{i}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">N</mi><mo rspace="0.111em" id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><msubsup id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml"><mo id="S3.SS1.p2.5.m5.1.1.3.1.2.2" xref="S3.SS1.p2.5.m5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.5.m5.1.1.3.1.2.3" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.1.2.3.2" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1.2.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p2.5.m5.1.1.3.1.2.3.3" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.5.m5.1.1.3.1.3" xref="S3.SS1.p2.5.m5.1.1.3.1.3.cmml">m</mi></msubsup><msub id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p2.5.m5.1.1.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></eq><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑁</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><apply id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p2.5.m5.1.1.3.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p2.5.m5.1.1.3.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.2.2"></sum><apply id="S3.SS1.p2.5.m5.1.1.3.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3"><eq id="S3.SS1.p2.5.m5.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.p2.5.m5.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.5.m5.1.1.3.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1.3">𝑚</ci></apply><apply id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">N=\sum_{i=1}^{m}n_{i}</annotation></semantics></math>. The local objective functions of clients can be defined as the empirical loss over their local data <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝒟</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math>, i.e., <math id="S3.SS1.p2.7.m7.4" class="ltx_Math" alttext="F_{i}(\theta)=\frac{1}{n_{i}}\sum_{j_{i}=1}^{n_{i}}f_{j_{i}}(\theta;x_{j_{i}},y_{j_{i}})" display="inline"><semantics id="S3.SS1.p2.7.m7.4a"><mrow id="S3.SS1.p2.7.m7.4.4" xref="S3.SS1.p2.7.m7.4.4.cmml"><mrow id="S3.SS1.p2.7.m7.4.4.4" xref="S3.SS1.p2.7.m7.4.4.4.cmml"><msub id="S3.SS1.p2.7.m7.4.4.4.2" xref="S3.SS1.p2.7.m7.4.4.4.2.cmml"><mi id="S3.SS1.p2.7.m7.4.4.4.2.2" xref="S3.SS1.p2.7.m7.4.4.4.2.2.cmml">F</mi><mi id="S3.SS1.p2.7.m7.4.4.4.2.3" xref="S3.SS1.p2.7.m7.4.4.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.4.4.4.1" xref="S3.SS1.p2.7.m7.4.4.4.1.cmml">​</mo><mrow id="S3.SS1.p2.7.m7.4.4.4.3.2" xref="S3.SS1.p2.7.m7.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.4.3.2.1" xref="S3.SS1.p2.7.m7.4.4.4.cmml">(</mo><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.4.3.2.2" xref="S3.SS1.p2.7.m7.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.7.m7.4.4.3" xref="S3.SS1.p2.7.m7.4.4.3.cmml">=</mo><mrow id="S3.SS1.p2.7.m7.4.4.2" xref="S3.SS1.p2.7.m7.4.4.2.cmml"><mfrac id="S3.SS1.p2.7.m7.4.4.2.4" xref="S3.SS1.p2.7.m7.4.4.2.4.cmml"><mn id="S3.SS1.p2.7.m7.4.4.2.4.2" xref="S3.SS1.p2.7.m7.4.4.2.4.2.cmml">1</mn><msub id="S3.SS1.p2.7.m7.4.4.2.4.3" xref="S3.SS1.p2.7.m7.4.4.2.4.3.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.4.3.2" xref="S3.SS1.p2.7.m7.4.4.2.4.3.2.cmml">n</mi><mi id="S3.SS1.p2.7.m7.4.4.2.4.3.3" xref="S3.SS1.p2.7.m7.4.4.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.4.4.2.3" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">​</mo><mrow id="S3.SS1.p2.7.m7.4.4.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.cmml"><msubsup id="S3.SS1.p2.7.m7.4.4.2.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.cmml"><mo id="S3.SS1.p2.7.m7.4.4.2.2.3.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.cmml"><msub id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.2.cmml">j</mi><mi id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.1" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.1.cmml">=</mo><mn id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p2.7.m7.4.4.2.2.3.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.3.3.2" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3.2.cmml">n</mi><mi id="S3.SS1.p2.7.m7.4.4.2.2.3.3.3" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3.3.cmml">i</mi></msub></msubsup><mrow id="S3.SS1.p2.7.m7.4.4.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.cmml"><msub id="S3.SS1.p2.7.m7.4.4.2.2.2.4" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.4.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.2.cmml">f</mi><msub id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.2.cmml">j</mi><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.4.4.2.2.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml">(</mo><mi id="S3.SS1.p2.7.m7.2.2" xref="S3.SS1.p2.7.m7.2.2.cmml">θ</mi><mo id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.4" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml">;</mo><msub id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2.cmml">x</mi><msub id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.cmml">j</mi><mi id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.5" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.2.cmml">y</mi><msub id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.2.cmml">j</mi><mi id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.6" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.4b"><apply id="S3.SS1.p2.7.m7.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4"><eq id="S3.SS1.p2.7.m7.4.4.3.cmml" xref="S3.SS1.p2.7.m7.4.4.3"></eq><apply id="S3.SS1.p2.7.m7.4.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4.4"><times id="S3.SS1.p2.7.m7.4.4.4.1.cmml" xref="S3.SS1.p2.7.m7.4.4.4.1"></times><apply id="S3.SS1.p2.7.m7.4.4.4.2.cmml" xref="S3.SS1.p2.7.m7.4.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.4.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.4.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.4.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.4.2.2">𝐹</ci><ci id="S3.SS1.p2.7.m7.4.4.4.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.4.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝜃</ci></apply><apply id="S3.SS1.p2.7.m7.4.4.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2"><times id="S3.SS1.p2.7.m7.4.4.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.3"></times><apply id="S3.SS1.p2.7.m7.4.4.2.4.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4"><divide id="S3.SS1.p2.7.m7.4.4.2.4.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4"></divide><cn type="integer" id="S3.SS1.p2.7.m7.4.4.2.4.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4.2">1</cn><apply id="S3.SS1.p2.7.m7.4.4.2.4.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.4.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.4.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4.3.2">𝑛</ci><ci id="S3.SS1.p2.7.m7.4.4.2.4.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.7.m7.4.4.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2"><apply id="S3.SS1.p2.7.m7.4.4.2.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3">superscript</csymbol><apply id="S3.SS1.p2.7.m7.4.4.2.2.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.3.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3">subscript</csymbol><sum id="S3.SS1.p2.7.m7.4.4.2.2.3.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.2"></sum><apply id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3"><eq id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.1"></eq><apply id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.2">𝑗</ci><ci id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.7.m7.4.4.2.2.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.3.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.3.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3.2">𝑛</ci><ci id="S3.SS1.p2.7.m7.4.4.2.2.3.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.7.m7.4.4.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2"><times id="S3.SS1.p2.7.m7.4.4.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.3"></times><apply id="S3.SS1.p2.7.m7.4.4.2.2.2.4.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.4.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.4.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.2">𝑓</ci><apply id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.2">𝑗</ci><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.4.3.3">𝑖</ci></apply></apply><list id="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2"><ci id="S3.SS1.p2.7.m7.2.2.cmml" xref="S3.SS1.p2.7.m7.2.2">𝜃</ci><apply id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.2">𝑦</ci><apply id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.2">𝑗</ci><ci id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.4c">F_{i}(\theta)=\frac{1}{n_{i}}\sum_{j_{i}=1}^{n_{i}}f_{j_{i}}(\theta;x_{j_{i}},y_{j_{i}})</annotation></semantics></math>, where <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">n</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝑛</ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">n_{i}</annotation></semantics></math> is the number of client i’s local samples. It is empirically shown that <span id="S3.SS1.p2.8.1" class="ltx_text ltx_font_italic">FedAvg</span> provides better performance when the data distribution across clients is IID <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. In reality, data produced by different clients are usually non-IID in nature, thus negatively impacting the convergence and performance of federated learning in practical applications. Recently, clustered federated learning (CFL) has attracted research efforts to address the data heterogeneity issue with promising performance improvement.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Motivation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Although CFL-based approaches <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Briggs et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite> have shown lofty improvement over <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_italic">FedAvg</span> when dealing with non-IID data, they still lack efficiency due to their limitations of clustering strategies. We thus identify key limitations as well as opportunities in what follows:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Difficult to determine the cluster count in advance.</span> Most of the existing CFL approaches <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Tu et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> require a given number of clusters apriori, usually very hard to determine without knowing the actual data distributions across clients, despite that model accuracy is highly dependent on the optimal number of clusters.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Require larger communication rounds to form stable clusters.</span>
Some existing CFL approaches <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> can group clients into an appropriate number of clusters. Specifically, <span id="S3.I1.i2.p1.1.2" class="ltx_text ltx_font_italic">FMTL</span> <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> iteratively partitions clients into clusters according to the cosine similarity of their local model updates. While yielding an optimal number of clusters, it is not communication efficient as a large number of communication rounds are needed to form stabilized clusters.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Is it necessary to utilize all model weights?</span> A majority of current CFL approaches use all model weights or model updates to calculate model similarity which reflects the underlying data distribution of clients. It imposes a huge pressure on the server when calculating the similarity over a large number of models simultaneously. In addition, existing literature <cite class="ltx_cite ltx_citemacro_citep">(Long et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2018</a>; Yosinski et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2014</a>; Rozantsev et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite> demonstrates that there are distinctions between the different layers in the same model, and higher layers weights are more task-related compared to lower layers weights. So, is it possible to effectively compare model similarity using just partial weights?</p>
</div>
</li>
</ul>
<p id="S3.SS2.p1.2" class="ltx_p">To address the above limitations, we propose a new clustered federated learning approach, <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_italic">FedClust</span>, that divides clients into a suitable number of clusters in a one-shot manner by calculating the similarity using selected partial weights of clients’ locally trained models.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2407.07124/assets/x5.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>An overview of FedClust. </figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Observation</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Despite previous observations <cite class="ltx_cite ltx_citemacro_citep">(Long et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2018</a>; Yosinski et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2014</a>; Rozantsev et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite> on model layers as discussed before, there is a lack of understanding in how these variations can potentially impact federated learning. In this section, we conduct an experimental study to investigate the implications of model weights from different layers on the underlying data distribution.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">We conduct a simple experiment for a multi-class image classification task on the CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite> dataset with VGG16 <cite class="ltx_cite ltx_citemacro_citep">(Simonyan and Zisserman, <a href="#bib.bib36" title="" class="ltx_ref">2014</a>)</cite>. Specifically, the VGG16 model contains thirteen convolutional layers and three fully connected layers. To simulate non-IID data among clients, we assume 10 different clients and group them into two clusters based on their local label categories, <span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_italic">e.g.</span>, <math id="S3.SS3.p2.1.m1.4" class="ltx_Math" alttext="\mathcal{G}_{1}=\{1,2,\ldots,5\}" display="inline"><semantics id="S3.SS3.p2.1.m1.4a"><mrow id="S3.SS3.p2.1.m1.4.5" xref="S3.SS3.p2.1.m1.4.5.cmml"><msub id="S3.SS3.p2.1.m1.4.5.2" xref="S3.SS3.p2.1.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.4.5.2.2" xref="S3.SS3.p2.1.m1.4.5.2.2.cmml">𝒢</mi><mn id="S3.SS3.p2.1.m1.4.5.2.3" xref="S3.SS3.p2.1.m1.4.5.2.3.cmml">1</mn></msub><mo id="S3.SS3.p2.1.m1.4.5.1" xref="S3.SS3.p2.1.m1.4.5.1.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.4.5.3.2" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.4.5.3.2.1" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml">{</mo><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">1</mn><mo id="S3.SS3.p2.1.m1.4.5.3.2.2" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">2</mn><mo id="S3.SS3.p2.1.m1.4.5.3.2.3" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.1.m1.3.3" xref="S3.SS3.p2.1.m1.3.3.cmml">…</mi><mo id="S3.SS3.p2.1.m1.4.5.3.2.4" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.4.4" xref="S3.SS3.p2.1.m1.4.4.cmml">5</mn><mo stretchy="false" id="S3.SS3.p2.1.m1.4.5.3.2.5" xref="S3.SS3.p2.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.4b"><apply id="S3.SS3.p2.1.m1.4.5.cmml" xref="S3.SS3.p2.1.m1.4.5"><eq id="S3.SS3.p2.1.m1.4.5.1.cmml" xref="S3.SS3.p2.1.m1.4.5.1"></eq><apply id="S3.SS3.p2.1.m1.4.5.2.cmml" xref="S3.SS3.p2.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.4.5.2.1.cmml" xref="S3.SS3.p2.1.m1.4.5.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.4.5.2.2.cmml" xref="S3.SS3.p2.1.m1.4.5.2.2">𝒢</ci><cn type="integer" id="S3.SS3.p2.1.m1.4.5.2.3.cmml" xref="S3.SS3.p2.1.m1.4.5.2.3">1</cn></apply><set id="S3.SS3.p2.1.m1.4.5.3.1.cmml" xref="S3.SS3.p2.1.m1.4.5.3.2"><cn type="integer" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">1</cn><cn type="integer" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">2</cn><ci id="S3.SS3.p2.1.m1.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3">…</ci><cn type="integer" id="S3.SS3.p2.1.m1.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.4c">\mathcal{G}_{1}=\{1,2,\ldots,5\}</annotation></semantics></math> and <math id="S3.SS3.p2.2.m2.5" class="ltx_Math" alttext="\mathcal{G}_{2}=\{6,7,\ldots,10\}." display="inline"><semantics id="S3.SS3.p2.2.m2.5a"><mrow id="S3.SS3.p2.2.m2.5.5.1" xref="S3.SS3.p2.2.m2.5.5.1.1.cmml"><mrow id="S3.SS3.p2.2.m2.5.5.1.1" xref="S3.SS3.p2.2.m2.5.5.1.1.cmml"><msub id="S3.SS3.p2.2.m2.5.5.1.1.2" xref="S3.SS3.p2.2.m2.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.5.5.1.1.2.2" xref="S3.SS3.p2.2.m2.5.5.1.1.2.2.cmml">𝒢</mi><mn id="S3.SS3.p2.2.m2.5.5.1.1.2.3" xref="S3.SS3.p2.2.m2.5.5.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.2.m2.5.5.1.1.1" xref="S3.SS3.p2.2.m2.5.5.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.5.5.1.1.3.2" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.5.5.1.1.3.2.1" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml">{</mo><mn id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">6</mn><mo id="S3.SS3.p2.2.m2.5.5.1.1.3.2.2" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">7</mn><mo id="S3.SS3.p2.2.m2.5.5.1.1.3.2.3" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.2.m2.3.3" xref="S3.SS3.p2.2.m2.3.3.cmml">…</mi><mo id="S3.SS3.p2.2.m2.5.5.1.1.3.2.4" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.4.4" xref="S3.SS3.p2.2.m2.4.4.cmml">10</mn><mo stretchy="false" id="S3.SS3.p2.2.m2.5.5.1.1.3.2.5" xref="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S3.SS3.p2.2.m2.5.5.1.2" xref="S3.SS3.p2.2.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.5b"><apply id="S3.SS3.p2.2.m2.5.5.1.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1"><eq id="S3.SS3.p2.2.m2.5.5.1.1.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.1"></eq><apply id="S3.SS3.p2.2.m2.5.5.1.1.2.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.5.5.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.5.5.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.2.2">𝒢</ci><cn type="integer" id="S3.SS3.p2.2.m2.5.5.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.2.3">2</cn></apply><set id="S3.SS3.p2.2.m2.5.5.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.5.5.1.1.3.2"><cn type="integer" id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">6</cn><cn type="integer" id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2">7</cn><ci id="S3.SS3.p2.2.m2.3.3.cmml" xref="S3.SS3.p2.2.m2.3.3">…</ci><cn type="integer" id="S3.SS3.p2.2.m2.4.4.cmml" xref="S3.SS3.p2.2.m2.4.4">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.5c">\mathcal{G}_{2}=\{6,7,\ldots,10\}.</annotation></semantics></math> Fig. 1 illustrates four different distance matrices which are calculated using the weights of the four different layers (1, 7, 14, and 16) in VGG16.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">From Fig. 1, we observe that the final layer weights implicitly represent the underlying data distribution of clients. Specifically, Figs. 1(a) and 1(b) depict the distance matrices based on the two convolutional layer weights respectively. However, we cannot obtain the cluster structures of the clients from them. The clustering structures of the clients are clearly observed in Figs. 1(d). Moreover, we observed similar clustering patterns using the LeNet-5 model. Based on the above experiments and previous studies <cite class="ltx_cite ltx_citemacro_citep">(Long et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2018</a>; Yosinski et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2014</a>; Rozantsev et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite>, we can conclude that the final layer or the layer with the classifier function reflects the model difference caused by non-IID data. In addition, clients with similar data distributions tend to train the model in a similar manner, resulting in closer distances among final layer’r weights.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Overview</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.3" class="ltx_p">To advance existing CFL pursuits, we propose <span id="S3.SS4.p1.3.1" class="ltx_text ltx_font_italic">FedClust</span> which can identify cluster patterns among clients based on the distance of weights from the final layers of their local models. The proposed method, as described in Algorithm 1, is able to alleviate the effects of non-IID data on practical FL applications. We first focus on clustering clients based on their local data distributions in a federated network. The proposed approach is one-shot clustering that classifies <span id="S3.SS4.p1.3.2" class="ltx_text ltx_font_italic">m</span> clients into <span id="S3.SS4.p1.3.3" class="ltx_text ltx_font_italic">n</span> clusters, i.e., <math id="S3.SS4.p1.1.m1.3" class="ltx_Math" alttext="\mathcal{G}=\{g_{1},\ldots,g_{n}\}" display="inline"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3" xref="S3.SS4.p1.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.3.3.4" xref="S3.SS4.p1.1.m1.3.3.4.cmml">𝒢</mi><mo id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS4.p1.1.m1.3.3.2.2" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.1.m1.3.3.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS4.p1.1.m1.2.2.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.2.2.1.1.1.2" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml">g</mi><mn id="S3.SS4.p1.1.m1.2.2.1.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.1.m1.3.3.2.2.4" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS4.p1.1.m1.3.3.2.2.5" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS4.p1.1.m1.3.3.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml">g</mi><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS4.p1.1.m1.3.3.2.2.6" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><apply id="S3.SS4.p1.1.m1.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3"><eq id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3"></eq><ci id="S3.SS4.p1.1.m1.3.3.4.cmml" xref="S3.SS4.p1.1.m1.3.3.4">𝒢</ci><set id="S3.SS4.p1.1.m1.3.3.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2"><apply id="S3.SS4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2">𝑔</ci><cn type="integer" id="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">…</ci><apply id="S3.SS4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2">𝑔</ci><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">\mathcal{G}=\{g_{1},\ldots,g_{n}\}</annotation></semantics></math>, based on the similarity of their underlying data distributions before starting federation. <span id="S3.SS4.p1.3.4" class="ltx_text ltx_font_italic">FedClust</span> trains one model individually for each cluster <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="g_{k}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑔</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">g_{k}</annotation></semantics></math>, instead of training a common global model for all clients. The objective function for the clients of each cluster <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="{g_{k}}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">g</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑔</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">{g_{k}}</annotation></semantics></math> is defined as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\min_{\theta}F(\theta_{g_{k}})\overset{\scriptscriptstyle\Delta}{=}\sum_{{c_{i}}\in{g_{k}}}{\frac{n_{c_{i}}}{N_{g_{k}}}F_{ik}(\theta_{g_{k}})}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><munder id="S3.E2.m1.2.2.4.1" xref="S3.E2.m1.2.2.4.1.cmml"><mi id="S3.E2.m1.2.2.4.1.2" xref="S3.E2.m1.2.2.4.1.2.cmml">min</mi><mi id="S3.E2.m1.2.2.4.1.3" xref="S3.E2.m1.2.2.4.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S3.E2.m1.2.2.4a" xref="S3.E2.m1.2.2.4.cmml">⁡</mo><mi id="S3.E2.m1.2.2.4.2" xref="S3.E2.m1.2.2.4.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">θ</mi><msub id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml">g</mi><mi id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.3a" xref="S3.E2.m1.2.2.3.cmml">​</mo><mover accent="true" id="S3.E2.m1.2.2.5" xref="S3.E2.m1.2.2.5.cmml"><mo mathsize="50%" id="S3.E2.m1.2.2.5.2" xref="S3.E2.m1.2.2.5.2.cmml">=</mo><mo mathsize="50%" id="S3.E2.m1.2.2.5.1" xref="S3.E2.m1.2.2.5.1.cmml">Δ</mo></mover><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.3b" xref="S3.E2.m1.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mstyle displaystyle="false" id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2a" xref="S3.E2.m1.2.2.2.2.cmml"><mo maxsize="50%" minsize="50%" stretchy="true" id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml"><msub id="S3.E2.m1.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.3.2.cmml"><mi mathsize="71%" id="S3.E2.m1.2.2.2.2.3.2.2" xref="S3.E2.m1.2.2.2.2.3.2.2.cmml">c</mi><mi id="S3.E2.m1.2.2.2.2.3.2.3" xref="S3.E2.m1.2.2.2.2.3.2.3.cmml">i</mi></msub><mo mathsize="71%" id="S3.E2.m1.2.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.3.1.cmml">∈</mo><msub id="S3.E2.m1.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.3.3.cmml"><mi mathsize="71%" id="S3.E2.m1.2.2.2.2.3.3.2" xref="S3.E2.m1.2.2.2.2.3.3.2.cmml">g</mi><mi id="S3.E2.m1.2.2.2.2.3.3.3" xref="S3.E2.m1.2.2.2.2.3.3.3.cmml">k</mi></msub></mrow></msub></mstyle><mrow id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml"><mstyle displaystyle="false" scriptlevel="+2" id="S3.E2.m1.2.2.2.1.3" xref="S3.E2.m1.2.2.2.1.3.cmml"><mfrac id="S3.E2.m1.2.2.2.1.3a" xref="S3.E2.m1.2.2.2.1.3.cmml"><msub id="S3.E2.m1.2.2.2.1.3.2" xref="S3.E2.m1.2.2.2.1.3.2.cmml"><mi id="S3.E2.m1.2.2.2.1.3.2.2" xref="S3.E2.m1.2.2.2.1.3.2.2.cmml">n</mi><msub id="S3.E2.m1.2.2.2.1.3.2.3" xref="S3.E2.m1.2.2.2.1.3.2.3.cmml"><mi id="S3.E2.m1.2.2.2.1.3.2.3.2" xref="S3.E2.m1.2.2.2.1.3.2.3.2.cmml">c</mi><mi id="S3.E2.m1.2.2.2.1.3.2.3.3" xref="S3.E2.m1.2.2.2.1.3.2.3.3.cmml">i</mi></msub></msub><msub id="S3.E2.m1.2.2.2.1.3.3" xref="S3.E2.m1.2.2.2.1.3.3.cmml"><mi id="S3.E2.m1.2.2.2.1.3.3.2" xref="S3.E2.m1.2.2.2.1.3.3.2.cmml">N</mi><msub id="S3.E2.m1.2.2.2.1.3.3.3" xref="S3.E2.m1.2.2.2.1.3.3.3.cmml"><mi id="S3.E2.m1.2.2.2.1.3.3.3.2" xref="S3.E2.m1.2.2.2.1.3.3.3.2.cmml">g</mi><mi id="S3.E2.m1.2.2.2.1.3.3.3.3" xref="S3.E2.m1.2.2.2.1.3.3.3.3.cmml">k</mi></msub></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.2" xref="S3.E2.m1.2.2.2.1.2.cmml">​</mo><msub id="S3.E2.m1.2.2.2.1.4" xref="S3.E2.m1.2.2.2.1.4.cmml"><mi mathsize="50%" id="S3.E2.m1.2.2.2.1.4.2" xref="S3.E2.m1.2.2.2.1.4.2.cmml">F</mi><mrow id="S3.E2.m1.2.2.2.1.4.3" xref="S3.E2.m1.2.2.2.1.4.3.cmml"><mi mathsize="71%" id="S3.E2.m1.2.2.2.1.4.3.2" xref="S3.E2.m1.2.2.2.1.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.4.3.1" xref="S3.E2.m1.2.2.2.1.4.3.1.cmml">​</mo><mi mathsize="71%" id="S3.E2.m1.2.2.2.1.4.3.3" xref="S3.E2.m1.2.2.2.1.4.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.2a" xref="S3.E2.m1.2.2.2.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mo maxsize="50%" minsize="50%" id="S3.E2.m1.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mi mathsize="50%" id="S3.E2.m1.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.2.cmml">θ</mi><msub id="S3.E2.m1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.cmml"><mi mathsize="71%" id="S3.E2.m1.2.2.2.1.1.1.1.3.2" xref="S3.E2.m1.2.2.2.1.1.1.1.3.2.cmml">g</mi><mi id="S3.E2.m1.2.2.2.1.1.1.1.3.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo maxsize="50%" minsize="50%" id="S3.E2.m1.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><times id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></times><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><apply id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.1.cmml" xref="S3.E2.m1.2.2.4.1">subscript</csymbol><min id="S3.E2.m1.2.2.4.1.2.cmml" xref="S3.E2.m1.2.2.4.1.2"></min><ci id="S3.E2.m1.2.2.4.1.3.cmml" xref="S3.E2.m1.2.2.4.1.3">𝜃</ci></apply><ci id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4.2">𝐹</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.2.2.5.cmml" xref="S3.E2.m1.2.2.5"><ci id="S3.E2.m1.2.2.5.1.cmml" xref="S3.E2.m1.2.2.5.1">Δ</ci><eq id="S3.E2.m1.2.2.5.2.cmml" xref="S3.E2.m1.2.2.5.2"></eq></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"></sum><apply id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"><in id="S3.E2.m1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.1"></in><apply id="S3.E2.m1.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.2.2.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2">𝑔</ci><ci id="S3.E2.m1.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1"><times id="S3.E2.m1.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.1.2"></times><apply id="S3.E2.m1.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.1.3"><divide id="S3.E2.m1.2.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.3"></divide><apply id="S3.E2.m1.2.2.2.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.3.2.1.cmml" xref="S3.E2.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.3.2.2.cmml" xref="S3.E2.m1.2.2.2.1.3.2.2">𝑛</ci><apply id="S3.E2.m1.2.2.2.1.3.2.3.cmml" xref="S3.E2.m1.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.3.2.3.1.cmml" xref="S3.E2.m1.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.3.2.3.2.cmml" xref="S3.E2.m1.2.2.2.1.3.2.3.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.1.3.2.3.3.cmml" xref="S3.E2.m1.2.2.2.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.2.2.2.1.3.3.cmml" xref="S3.E2.m1.2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.3.3.1.cmml" xref="S3.E2.m1.2.2.2.1.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.3.3.2.cmml" xref="S3.E2.m1.2.2.2.1.3.3.2">𝑁</ci><apply id="S3.E2.m1.2.2.2.1.3.3.3.cmml" xref="S3.E2.m1.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.3.3.3.1.cmml" xref="S3.E2.m1.2.2.2.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.3.3.3.2.cmml" xref="S3.E2.m1.2.2.2.1.3.3.3.2">𝑔</ci><ci id="S3.E2.m1.2.2.2.1.3.3.3.3.cmml" xref="S3.E2.m1.2.2.2.1.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.1.4.cmml" xref="S3.E2.m1.2.2.2.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.4.1.cmml" xref="S3.E2.m1.2.2.2.1.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.4.2.cmml" xref="S3.E2.m1.2.2.2.1.4.2">𝐹</ci><apply id="S3.E2.m1.2.2.2.1.4.3.cmml" xref="S3.E2.m1.2.2.2.1.4.3"><times id="S3.E2.m1.2.2.2.1.4.3.1.cmml" xref="S3.E2.m1.2.2.2.1.4.3.1"></times><ci id="S3.E2.m1.2.2.2.1.4.3.2.cmml" xref="S3.E2.m1.2.2.2.1.4.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.2.1.4.3.3.cmml" xref="S3.E2.m1.2.2.2.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.2">𝜃</ci><apply id="S3.E2.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3.2">𝑔</ci><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\min_{\theta}F(\theta_{g_{k}})\overset{\scriptscriptstyle\Delta}{=}\sum_{{c_{i}}\in{g_{k}}}{\frac{n_{c_{i}}}{N_{g_{k}}}F_{ik}(\theta_{g_{k}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.10" class="ltx_p">Here, <math id="S3.SS4.p1.4.m1.1" class="ltx_Math" alttext="n_{c_{i}}" display="inline"><semantics id="S3.SS4.p1.4.m1.1a"><msub id="S3.SS4.p1.4.m1.1.1" xref="S3.SS4.p1.4.m1.1.1.cmml"><mi id="S3.SS4.p1.4.m1.1.1.2" xref="S3.SS4.p1.4.m1.1.1.2.cmml">n</mi><msub id="S3.SS4.p1.4.m1.1.1.3" xref="S3.SS4.p1.4.m1.1.1.3.cmml"><mi id="S3.SS4.p1.4.m1.1.1.3.2" xref="S3.SS4.p1.4.m1.1.1.3.2.cmml">c</mi><mi id="S3.SS4.p1.4.m1.1.1.3.3" xref="S3.SS4.p1.4.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m1.1b"><apply id="S3.SS4.p1.4.m1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m1.1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m1.1.1.2.cmml" xref="S3.SS4.p1.4.m1.1.1.2">𝑛</ci><apply id="S3.SS4.p1.4.m1.1.1.3.cmml" xref="S3.SS4.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m1.1.1.3.1.cmml" xref="S3.SS4.p1.4.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.4.m1.1.1.3.2.cmml" xref="S3.SS4.p1.4.m1.1.1.3.2">𝑐</ci><ci id="S3.SS4.p1.4.m1.1.1.3.3.cmml" xref="S3.SS4.p1.4.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m1.1c">n_{c_{i}}</annotation></semantics></math> and <math id="S3.SS4.p1.5.m2.1" class="ltx_Math" alttext="N_{g_{k}}" display="inline"><semantics id="S3.SS4.p1.5.m2.1a"><msub id="S3.SS4.p1.5.m2.1.1" xref="S3.SS4.p1.5.m2.1.1.cmml"><mi id="S3.SS4.p1.5.m2.1.1.2" xref="S3.SS4.p1.5.m2.1.1.2.cmml">N</mi><msub id="S3.SS4.p1.5.m2.1.1.3" xref="S3.SS4.p1.5.m2.1.1.3.cmml"><mi id="S3.SS4.p1.5.m2.1.1.3.2" xref="S3.SS4.p1.5.m2.1.1.3.2.cmml">g</mi><mi id="S3.SS4.p1.5.m2.1.1.3.3" xref="S3.SS4.p1.5.m2.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m2.1b"><apply id="S3.SS4.p1.5.m2.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m2.1.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.2">𝑁</ci><apply id="S3.SS4.p1.5.m2.1.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.5.m2.1.1.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2">𝑔</ci><ci id="S3.SS4.p1.5.m2.1.1.3.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m2.1c">N_{g_{k}}</annotation></semantics></math> denotes the number of data samples for client <math id="S3.SS4.p1.6.m3.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS4.p1.6.m3.1a"><msub id="S3.SS4.p1.6.m3.1.1" xref="S3.SS4.p1.6.m3.1.1.cmml"><mi id="S3.SS4.p1.6.m3.1.1.2" xref="S3.SS4.p1.6.m3.1.1.2.cmml">c</mi><mi id="S3.SS4.p1.6.m3.1.1.3" xref="S3.SS4.p1.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m3.1b"><apply id="S3.SS4.p1.6.m3.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m3.1.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m3.1.1.2.cmml" xref="S3.SS4.p1.6.m3.1.1.2">𝑐</ci><ci id="S3.SS4.p1.6.m3.1.1.3.cmml" xref="S3.SS4.p1.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m3.1c">c_{i}</annotation></semantics></math> and cluster <math id="S3.SS4.p1.7.m4.1" class="ltx_Math" alttext="g_{k}" display="inline"><semantics id="S3.SS4.p1.7.m4.1a"><msub id="S3.SS4.p1.7.m4.1.1" xref="S3.SS4.p1.7.m4.1.1.cmml"><mi id="S3.SS4.p1.7.m4.1.1.2" xref="S3.SS4.p1.7.m4.1.1.2.cmml">g</mi><mi id="S3.SS4.p1.7.m4.1.1.3" xref="S3.SS4.p1.7.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m4.1b"><apply id="S3.SS4.p1.7.m4.1.1.cmml" xref="S3.SS4.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m4.1.1.1.cmml" xref="S3.SS4.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m4.1.1.2.cmml" xref="S3.SS4.p1.7.m4.1.1.2">𝑔</ci><ci id="S3.SS4.p1.7.m4.1.1.3.cmml" xref="S3.SS4.p1.7.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m4.1c">g_{k}</annotation></semantics></math>, respectively, and <math id="S3.SS4.p1.8.m5.1" class="ltx_Math" alttext="F_{ik}(\theta_{g_{k}})" display="inline"><semantics id="S3.SS4.p1.8.m5.1a"><mrow id="S3.SS4.p1.8.m5.1.1" xref="S3.SS4.p1.8.m5.1.1.cmml"><msub id="S3.SS4.p1.8.m5.1.1.3" xref="S3.SS4.p1.8.m5.1.1.3.cmml"><mi id="S3.SS4.p1.8.m5.1.1.3.2" xref="S3.SS4.p1.8.m5.1.1.3.2.cmml">F</mi><mrow id="S3.SS4.p1.8.m5.1.1.3.3" xref="S3.SS4.p1.8.m5.1.1.3.3.cmml"><mi id="S3.SS4.p1.8.m5.1.1.3.3.2" xref="S3.SS4.p1.8.m5.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m5.1.1.3.3.1" xref="S3.SS4.p1.8.m5.1.1.3.3.1.cmml">​</mo><mi id="S3.SS4.p1.8.m5.1.1.3.3.3" xref="S3.SS4.p1.8.m5.1.1.3.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m5.1.1.2" xref="S3.SS4.p1.8.m5.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.8.m5.1.1.1.1" xref="S3.SS4.p1.8.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m5.1.1.1.1.2" xref="S3.SS4.p1.8.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p1.8.m5.1.1.1.1.1" xref="S3.SS4.p1.8.m5.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.8.m5.1.1.1.1.1.2" xref="S3.SS4.p1.8.m5.1.1.1.1.1.2.cmml">θ</mi><msub id="S3.SS4.p1.8.m5.1.1.1.1.1.3" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p1.8.m5.1.1.1.1.1.3.2" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3.2.cmml">g</mi><mi id="S3.SS4.p1.8.m5.1.1.1.1.1.3.3" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.SS4.p1.8.m5.1.1.1.1.3" xref="S3.SS4.p1.8.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m5.1b"><apply id="S3.SS4.p1.8.m5.1.1.cmml" xref="S3.SS4.p1.8.m5.1.1"><times id="S3.SS4.p1.8.m5.1.1.2.cmml" xref="S3.SS4.p1.8.m5.1.1.2"></times><apply id="S3.SS4.p1.8.m5.1.1.3.cmml" xref="S3.SS4.p1.8.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m5.1.1.3.1.cmml" xref="S3.SS4.p1.8.m5.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.8.m5.1.1.3.2.cmml" xref="S3.SS4.p1.8.m5.1.1.3.2">𝐹</ci><apply id="S3.SS4.p1.8.m5.1.1.3.3.cmml" xref="S3.SS4.p1.8.m5.1.1.3.3"><times id="S3.SS4.p1.8.m5.1.1.3.3.1.cmml" xref="S3.SS4.p1.8.m5.1.1.3.3.1"></times><ci id="S3.SS4.p1.8.m5.1.1.3.3.2.cmml" xref="S3.SS4.p1.8.m5.1.1.3.3.2">𝑖</ci><ci id="S3.SS4.p1.8.m5.1.1.3.3.3.cmml" xref="S3.SS4.p1.8.m5.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS4.p1.8.m5.1.1.1.1.1.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1.1.2">𝜃</ci><apply id="S3.SS4.p1.8.m5.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m5.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.8.m5.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.SS4.p1.8.m5.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p1.8.m5.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m5.1c">F_{ik}(\theta_{g_{k}})</annotation></semantics></math> determines the empirical loss on <math id="S3.SS4.p1.9.m6.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS4.p1.9.m6.1a"><msub id="S3.SS4.p1.9.m6.1.1" xref="S3.SS4.p1.9.m6.1.1.cmml"><mi id="S3.SS4.p1.9.m6.1.1.2" xref="S3.SS4.p1.9.m6.1.1.2.cmml">c</mi><mi id="S3.SS4.p1.9.m6.1.1.3" xref="S3.SS4.p1.9.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m6.1b"><apply id="S3.SS4.p1.9.m6.1.1.cmml" xref="S3.SS4.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m6.1.1.1.cmml" xref="S3.SS4.p1.9.m6.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m6.1.1.2.cmml" xref="S3.SS4.p1.9.m6.1.1.2">𝑐</ci><ci id="S3.SS4.p1.9.m6.1.1.3.cmml" xref="S3.SS4.p1.9.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m6.1c">c_{i}</annotation></semantics></math>’s local dataset <math id="S3.SS4.p1.10.m7.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS4.p1.10.m7.1a"><msub id="S3.SS4.p1.10.m7.1.1" xref="S3.SS4.p1.10.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.10.m7.1.1.2" xref="S3.SS4.p1.10.m7.1.1.2.cmml">𝒟</mi><mi id="S3.SS4.p1.10.m7.1.1.3" xref="S3.SS4.p1.10.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m7.1b"><apply id="S3.SS4.p1.10.m7.1.1.cmml" xref="S3.SS4.p1.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m7.1.1.1.cmml" xref="S3.SS4.p1.10.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.10.m7.1.1.2.cmml" xref="S3.SS4.p1.10.m7.1.1.2">𝒟</ci><ci id="S3.SS4.p1.10.m7.1.1.3.cmml" xref="S3.SS4.p1.10.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m7.1c">\mathcal{D}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.2" class="ltx_p">An overview of the proposed framework is depicted in Fig. 2. To minimize computation overhead, our clustering strategy employs a static approach that avoids rescheduling clients in each round. First, the server broadcasts the initial global model to all available clients. Then, each client trains the model on its local data for a few local iterations and sends back the updated final layer weights to the server as the representation of their underlying data distribution. The server then computes the proximity matrix between models based on the final layer weights uploaded by each client. Finally, the server employs agglomerative hierarchical clustering (HC) <cite class="ltx_cite ltx_citemacro_citep">(Day and Edelsbrunner, <a href="#bib.bib4" title="" class="ltx_ref">1984</a>)</cite> on the proximity matrix <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{M}</annotation></semantics></math> to group clients with similar data distribution into the same cluster. The basic idea is that, initially considering each client as a separate cluster, it repeatedly performs the following operations in each iteration: (1) identify the two clusters that exhibit the closest similarity, and (2) combine the two most similar clusters. To determine which clusters should be merged, a linkage criterion (<span id="S3.SS4.p2.2.1" class="ltx_text ltx_font_italic">e.g.</span> single, average, complete, <span id="S3.SS4.p2.2.2" class="ltx_text ltx_font_italic">etc.</span>) is defined <cite class="ltx_cite ltx_citemacro_citep">(Day and Edelsbrunner, <a href="#bib.bib4" title="" class="ltx_ref">1984</a>)</cite>. For instance, the smallest distance between two points in each cluster in “single linkage” is defined as the pairwise Euclidean distance between two clusters. In this paper, we denote <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\lambda</annotation></semantics></math> as the clustering threshold, representing the distance between two clusters. The iterative process continues until a suitable number of clusters have been formed. The above clustering process is done in one communication round.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.2" class="ltx_p">From the next round, the workflow of <span id="S3.SS4.p3.2.1" class="ltx_text ltx_font_italic">FedClust</span> is similar to <span id="S3.SS4.p3.2.2" class="ltx_text ltx_font_italic">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. The server initializes all cluster models with <math id="S3.SS4.p3.1.m1.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="S3.SS4.p3.1.m1.1a"><msubsup id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2.2" xref="S3.SS4.p3.1.m1.1.1.2.2.cmml">θ</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">s</mi><mn id="S3.SS4.p3.1.m1.1.1.2.3" xref="S3.SS4.p3.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.2.1.cmml" xref="S3.SS4.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2.2">𝜃</ci><cn type="integer" id="S3.SS4.p3.1.m1.1.1.2.3.cmml" xref="S3.SS4.p3.1.m1.1.1.2.3">0</cn></apply><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\theta^{0}_{s}</annotation></semantics></math>. A subset of available clients is selected randomly by the server and the server broadcasts <math id="S3.SS4.p3.2.m2.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="S3.SS4.p3.2.m2.1a"><msubsup id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.2.2.cmml">θ</mi><mi id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml">s</mi><mn id="S3.SS4.p3.2.m2.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2.2">𝜃</ci><cn type="integer" id="S3.SS4.p3.2.m2.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.2.3">0</cn></apply><ci id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\theta^{0}_{s}</annotation></semantics></math> to selected clients. Each client trains the model on its local data and performs a few steps of stochastic gradient descent (SGD) updates. The clients send back their updated model parameters along with their cluster IDs to the server. The server conducts model averaging for each cluster after receiving model updates from all clients.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>

<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.19" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.4.4" class="ltx_listingline">
<span id="alg1.4.4.1" class="ltx_text"><span id="alg1.4.4.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Number of available clients <math id="alg1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.1.1.m1.1a"><mi id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">N</annotation></semantics></math>, number of communication rounds <math id="alg1.2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.2.2.m2.1a"><mi id="alg1.2.2.m2.1.1" xref="alg1.2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.1b"><ci id="alg1.2.2.m2.1.1.cmml" xref="alg1.2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m2.1c">T</annotation></semantics></math>, clustering threshold <math id="alg1.3.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.3.3.m3.1a"><mi id="alg1.3.3.m3.1.1" xref="alg1.3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.m3.1b"><ci id="alg1.3.3.m3.1.1.cmml" xref="alg1.3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m3.1c">\lambda</annotation></semantics></math>, sampling rate <math id="alg1.4.4.m4.2" class="ltx_Math" alttext="R\in(0,1]" display="inline"><semantics id="alg1.4.4.m4.2a"><mrow id="alg1.4.4.m4.2.3" xref="alg1.4.4.m4.2.3.cmml"><mi id="alg1.4.4.m4.2.3.2" xref="alg1.4.4.m4.2.3.2.cmml">R</mi><mo id="alg1.4.4.m4.2.3.1" xref="alg1.4.4.m4.2.3.1.cmml">∈</mo><mrow id="alg1.4.4.m4.2.3.3.2" xref="alg1.4.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg1.4.4.m4.2.3.3.2.1" xref="alg1.4.4.m4.2.3.3.1.cmml">(</mo><mn id="alg1.4.4.m4.1.1" xref="alg1.4.4.m4.1.1.cmml">0</mn><mo id="alg1.4.4.m4.2.3.3.2.2" xref="alg1.4.4.m4.2.3.3.1.cmml">,</mo><mn id="alg1.4.4.m4.2.2" xref="alg1.4.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="alg1.4.4.m4.2.3.3.2.3" xref="alg1.4.4.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m4.2b"><apply id="alg1.4.4.m4.2.3.cmml" xref="alg1.4.4.m4.2.3"><in id="alg1.4.4.m4.2.3.1.cmml" xref="alg1.4.4.m4.2.3.1"></in><ci id="alg1.4.4.m4.2.3.2.cmml" xref="alg1.4.4.m4.2.3.2">𝑅</ci><interval closure="open-closed" id="alg1.4.4.m4.2.3.3.1.cmml" xref="alg1.4.4.m4.2.3.3.2"><cn type="integer" id="alg1.4.4.m4.1.1.cmml" xref="alg1.4.4.m4.1.1">0</cn><cn type="integer" id="alg1.4.4.m4.2.2.cmml" xref="alg1.4.4.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m4.2c">R\in(0,1]</annotation></semantics></math>
</div>
<div id="alg1.5.5" class="ltx_listingline">
<span id="alg1.5.5.1" class="ltx_text"><span id="alg1.5.5.1.1" class="ltx_text ltx_font_bold">Init:</span> </span>Server model initialization with <math id="alg1.5.5.m1.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="alg1.5.5.m1.1a"><msubsup id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml"><mi id="alg1.5.5.m1.1.1.2.2" xref="alg1.5.5.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.5.5.m1.1.1.3" xref="alg1.5.5.m1.1.1.3.cmml">s</mi><mn id="alg1.5.5.m1.1.1.2.3" xref="alg1.5.5.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg1.5.5.m1.1.1.1.cmml" xref="alg1.5.5.m1.1.1">subscript</csymbol><apply id="alg1.5.5.m1.1.1.2.cmml" xref="alg1.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg1.5.5.m1.1.1.2.1.cmml" xref="alg1.5.5.m1.1.1">superscript</csymbol><ci id="alg1.5.5.m1.1.1.2.2.cmml" xref="alg1.5.5.m1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.5.5.m1.1.1.2.3.cmml" xref="alg1.5.5.m1.1.1.2.3">0</cn></apply><ci id="alg1.5.5.m1.1.1.3.cmml" xref="alg1.5.5.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">\theta^{0}_{s}</annotation></semantics></math>
</div>
<div id="alg1.19.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="alg1.19.20.1" class="ltx_text ltx_font_bold">for</span> <em id="alg1.19.20.2" class="ltx_emph ltx_font_italic">each round i = 0, 1, 2,…</em> <span id="alg1.19.20.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.19.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.19.21.1" class="ltx_text ltx_font_bold">if</span> <em id="alg1.19.21.2" class="ltx_emph ltx_font_italic">i = 0</em> <span id="alg1.19.21.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Server broadcast <math id="alg1.6.6.m1.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="alg1.6.6.m1.1a"><msubsup id="alg1.6.6.m1.1.1" xref="alg1.6.6.m1.1.1.cmml"><mi id="alg1.6.6.m1.1.1.2.2" xref="alg1.6.6.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.6.6.m1.1.1.3" xref="alg1.6.6.m1.1.1.3.cmml">s</mi><mn id="alg1.6.6.m1.1.1.2.3" xref="alg1.6.6.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.1b"><apply id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1"><csymbol cd="ambiguous" id="alg1.6.6.m1.1.1.1.cmml" xref="alg1.6.6.m1.1.1">subscript</csymbol><apply id="alg1.6.6.m1.1.1.2.cmml" xref="alg1.6.6.m1.1.1"><csymbol cd="ambiguous" id="alg1.6.6.m1.1.1.2.1.cmml" xref="alg1.6.6.m1.1.1">superscript</csymbol><ci id="alg1.6.6.m1.1.1.2.2.cmml" xref="alg1.6.6.m1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.6.6.m1.1.1.2.3.cmml" xref="alg1.6.6.m1.1.1.2.3">0</cn></apply><ci id="alg1.6.6.m1.1.1.3.cmml" xref="alg1.6.6.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m1.1c">\theta^{0}_{s}</annotation></semantics></math> to all available clients.
</div>
<div id="alg1.19.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Each client performs local update and sends back the updated weights of the last layer to the server.
</div>
<div id="alg1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.7.7.m1.1" class="ltx_Math" alttext="\mathcal{M}\leftarrow" display="inline"><semantics id="alg1.7.7.m1.1a"><mrow id="alg1.7.7.m1.1.1" xref="alg1.7.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.7.7.m1.1.1.2" xref="alg1.7.7.m1.1.1.2.cmml">ℳ</mi><mo stretchy="false" id="alg1.7.7.m1.1.1.1" xref="alg1.7.7.m1.1.1.1.cmml">←</mo><mi id="alg1.7.7.m1.1.1.3" xref="alg1.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.1b"><apply id="alg1.7.7.m1.1.1.cmml" xref="alg1.7.7.m1.1.1"><ci id="alg1.7.7.m1.1.1.1.cmml" xref="alg1.7.7.m1.1.1.1">←</ci><ci id="alg1.7.7.m1.1.1.2.cmml" xref="alg1.7.7.m1.1.1.2">ℳ</ci><csymbol cd="latexml" id="alg1.7.7.m1.1.1.3.cmml" xref="alg1.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.1c">\mathcal{M}\leftarrow</annotation></semantics></math> server constructs <math id="alg1.8.8.m2.1" class="ltx_Math" alttext="{\mathcal{M}}" display="inline"><semantics id="alg1.8.8.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.8.8.m2.1.1" xref="alg1.8.8.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.8.8.m2.1b"><ci id="alg1.8.8.m2.1.1.cmml" xref="alg1.8.8.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m2.1c">{\mathcal{M}}</annotation></semantics></math> based on Eq. 3
</div>
<div id="alg1.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.9.9.m1.5" class="ltx_Math" alttext="\left\{C_{1},\ldots,C_{m}\right\}=HC(\mathcal{M},\lambda)" display="inline"><semantics id="alg1.9.9.m1.5a"><mrow id="alg1.9.9.m1.5.5" xref="alg1.9.9.m1.5.5.cmml"><mrow id="alg1.9.9.m1.5.5.2.2" xref="alg1.9.9.m1.5.5.2.3.cmml"><mo id="alg1.9.9.m1.5.5.2.2.3" xref="alg1.9.9.m1.5.5.2.3.cmml">{</mo><msub id="alg1.9.9.m1.4.4.1.1.1" xref="alg1.9.9.m1.4.4.1.1.1.cmml"><mi id="alg1.9.9.m1.4.4.1.1.1.2" xref="alg1.9.9.m1.4.4.1.1.1.2.cmml">C</mi><mn id="alg1.9.9.m1.4.4.1.1.1.3" xref="alg1.9.9.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="alg1.9.9.m1.5.5.2.2.4" xref="alg1.9.9.m1.5.5.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.9.9.m1.1.1" xref="alg1.9.9.m1.1.1.cmml">…</mi><mo id="alg1.9.9.m1.5.5.2.2.5" xref="alg1.9.9.m1.5.5.2.3.cmml">,</mo><msub id="alg1.9.9.m1.5.5.2.2.2" xref="alg1.9.9.m1.5.5.2.2.2.cmml"><mi id="alg1.9.9.m1.5.5.2.2.2.2" xref="alg1.9.9.m1.5.5.2.2.2.2.cmml">C</mi><mi id="alg1.9.9.m1.5.5.2.2.2.3" xref="alg1.9.9.m1.5.5.2.2.2.3.cmml">m</mi></msub><mo id="alg1.9.9.m1.5.5.2.2.6" xref="alg1.9.9.m1.5.5.2.3.cmml">}</mo></mrow><mo id="alg1.9.9.m1.5.5.3" xref="alg1.9.9.m1.5.5.3.cmml">=</mo><mrow id="alg1.9.9.m1.5.5.4" xref="alg1.9.9.m1.5.5.4.cmml"><mi id="alg1.9.9.m1.5.5.4.2" xref="alg1.9.9.m1.5.5.4.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.9.9.m1.5.5.4.1" xref="alg1.9.9.m1.5.5.4.1.cmml">​</mo><mi id="alg1.9.9.m1.5.5.4.3" xref="alg1.9.9.m1.5.5.4.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.9.9.m1.5.5.4.1a" xref="alg1.9.9.m1.5.5.4.1.cmml">​</mo><mrow id="alg1.9.9.m1.5.5.4.4.2" xref="alg1.9.9.m1.5.5.4.4.1.cmml"><mo stretchy="false" id="alg1.9.9.m1.5.5.4.4.2.1" xref="alg1.9.9.m1.5.5.4.4.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.9.9.m1.2.2" xref="alg1.9.9.m1.2.2.cmml">ℳ</mi><mo id="alg1.9.9.m1.5.5.4.4.2.2" xref="alg1.9.9.m1.5.5.4.4.1.cmml">,</mo><mi id="alg1.9.9.m1.3.3" xref="alg1.9.9.m1.3.3.cmml">λ</mi><mo stretchy="false" id="alg1.9.9.m1.5.5.4.4.2.3" xref="alg1.9.9.m1.5.5.4.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.m1.5b"><apply id="alg1.9.9.m1.5.5.cmml" xref="alg1.9.9.m1.5.5"><eq id="alg1.9.9.m1.5.5.3.cmml" xref="alg1.9.9.m1.5.5.3"></eq><set id="alg1.9.9.m1.5.5.2.3.cmml" xref="alg1.9.9.m1.5.5.2.2"><apply id="alg1.9.9.m1.4.4.1.1.1.cmml" xref="alg1.9.9.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.9.9.m1.4.4.1.1.1.1.cmml" xref="alg1.9.9.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.9.9.m1.4.4.1.1.1.2.cmml" xref="alg1.9.9.m1.4.4.1.1.1.2">𝐶</ci><cn type="integer" id="alg1.9.9.m1.4.4.1.1.1.3.cmml" xref="alg1.9.9.m1.4.4.1.1.1.3">1</cn></apply><ci id="alg1.9.9.m1.1.1.cmml" xref="alg1.9.9.m1.1.1">…</ci><apply id="alg1.9.9.m1.5.5.2.2.2.cmml" xref="alg1.9.9.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="alg1.9.9.m1.5.5.2.2.2.1.cmml" xref="alg1.9.9.m1.5.5.2.2.2">subscript</csymbol><ci id="alg1.9.9.m1.5.5.2.2.2.2.cmml" xref="alg1.9.9.m1.5.5.2.2.2.2">𝐶</ci><ci id="alg1.9.9.m1.5.5.2.2.2.3.cmml" xref="alg1.9.9.m1.5.5.2.2.2.3">𝑚</ci></apply></set><apply id="alg1.9.9.m1.5.5.4.cmml" xref="alg1.9.9.m1.5.5.4"><times id="alg1.9.9.m1.5.5.4.1.cmml" xref="alg1.9.9.m1.5.5.4.1"></times><ci id="alg1.9.9.m1.5.5.4.2.cmml" xref="alg1.9.9.m1.5.5.4.2">𝐻</ci><ci id="alg1.9.9.m1.5.5.4.3.cmml" xref="alg1.9.9.m1.5.5.4.3">𝐶</ci><interval closure="open" id="alg1.9.9.m1.5.5.4.4.1.cmml" xref="alg1.9.9.m1.5.5.4.4.2"><ci id="alg1.9.9.m1.2.2.cmml" xref="alg1.9.9.m1.2.2">ℳ</ci><ci id="alg1.9.9.m1.3.3.cmml" xref="alg1.9.9.m1.3.3">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m1.5c">\left\{C_{1},\ldots,C_{m}\right\}=HC(\mathcal{M},\lambda)</annotation></semantics></math> 
</div>
<div id="alg1.19.23" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="alg1.19.23.1" class="ltx_text ltx_font_typewriter">// </span><span id="alg1.19.23.2" class="ltx_text ltx_font_typewriter">employing hierarchical clustering to obtain the clusters</span>
</div>
<div id="alg1.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.10.10.m1.2" class="ltx_Math" alttext="\theta^{0}_{s,m}\leftarrow\theta^{0}_{s}" display="inline"><semantics id="alg1.10.10.m1.2a"><mrow id="alg1.10.10.m1.2.3" xref="alg1.10.10.m1.2.3.cmml"><msubsup id="alg1.10.10.m1.2.3.2" xref="alg1.10.10.m1.2.3.2.cmml"><mi id="alg1.10.10.m1.2.3.2.2.2" xref="alg1.10.10.m1.2.3.2.2.2.cmml">θ</mi><mrow id="alg1.10.10.m1.2.2.2.4" xref="alg1.10.10.m1.2.2.2.3.cmml"><mi id="alg1.10.10.m1.1.1.1.1" xref="alg1.10.10.m1.1.1.1.1.cmml">s</mi><mo id="alg1.10.10.m1.2.2.2.4.1" xref="alg1.10.10.m1.2.2.2.3.cmml">,</mo><mi id="alg1.10.10.m1.2.2.2.2" xref="alg1.10.10.m1.2.2.2.2.cmml">m</mi></mrow><mn id="alg1.10.10.m1.2.3.2.2.3" xref="alg1.10.10.m1.2.3.2.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg1.10.10.m1.2.3.1" xref="alg1.10.10.m1.2.3.1.cmml">←</mo><msubsup id="alg1.10.10.m1.2.3.3" xref="alg1.10.10.m1.2.3.3.cmml"><mi id="alg1.10.10.m1.2.3.3.2.2" xref="alg1.10.10.m1.2.3.3.2.2.cmml">θ</mi><mi id="alg1.10.10.m1.2.3.3.3" xref="alg1.10.10.m1.2.3.3.3.cmml">s</mi><mn id="alg1.10.10.m1.2.3.3.2.3" xref="alg1.10.10.m1.2.3.3.2.3.cmml">0</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.2b"><apply id="alg1.10.10.m1.2.3.cmml" xref="alg1.10.10.m1.2.3"><ci id="alg1.10.10.m1.2.3.1.cmml" xref="alg1.10.10.m1.2.3.1">←</ci><apply id="alg1.10.10.m1.2.3.2.cmml" xref="alg1.10.10.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.2.3.2.1.cmml" xref="alg1.10.10.m1.2.3.2">subscript</csymbol><apply id="alg1.10.10.m1.2.3.2.2.cmml" xref="alg1.10.10.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.2.3.2.2.1.cmml" xref="alg1.10.10.m1.2.3.2">superscript</csymbol><ci id="alg1.10.10.m1.2.3.2.2.2.cmml" xref="alg1.10.10.m1.2.3.2.2.2">𝜃</ci><cn type="integer" id="alg1.10.10.m1.2.3.2.2.3.cmml" xref="alg1.10.10.m1.2.3.2.2.3">0</cn></apply><list id="alg1.10.10.m1.2.2.2.3.cmml" xref="alg1.10.10.m1.2.2.2.4"><ci id="alg1.10.10.m1.1.1.1.1.cmml" xref="alg1.10.10.m1.1.1.1.1">𝑠</ci><ci id="alg1.10.10.m1.2.2.2.2.cmml" xref="alg1.10.10.m1.2.2.2.2">𝑚</ci></list></apply><apply id="alg1.10.10.m1.2.3.3.cmml" xref="alg1.10.10.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.10.10.m1.2.3.3.1.cmml" xref="alg1.10.10.m1.2.3.3">subscript</csymbol><apply id="alg1.10.10.m1.2.3.3.2.cmml" xref="alg1.10.10.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.10.10.m1.2.3.3.2.1.cmml" xref="alg1.10.10.m1.2.3.3">superscript</csymbol><ci id="alg1.10.10.m1.2.3.3.2.2.cmml" xref="alg1.10.10.m1.2.3.3.2.2">𝜃</ci><cn type="integer" id="alg1.10.10.m1.2.3.3.2.3.cmml" xref="alg1.10.10.m1.2.3.3.2.3">0</cn></apply><ci id="alg1.10.10.m1.2.3.3.3.cmml" xref="alg1.10.10.m1.2.3.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.2c">\theta^{0}_{s,m}\leftarrow\theta^{0}_{s}</annotation></semantics></math> 
</div>
<div id="alg1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="alg1.11.11.2" class="ltx_text ltx_font_typewriter">// </span><span id="alg1.11.11.1" class="ltx_text ltx_font_typewriter">clusters model initialization with <math id="alg1.11.11.1.m1.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="alg1.11.11.1.m1.1a"><msubsup id="alg1.11.11.1.m1.1.1" xref="alg1.11.11.1.m1.1.1.cmml"><mi id="alg1.11.11.1.m1.1.1.2.2" xref="alg1.11.11.1.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.11.11.1.m1.1.1.3" xref="alg1.11.11.1.m1.1.1.3.cmml">s</mi><mn id="alg1.11.11.1.m1.1.1.2.3" xref="alg1.11.11.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.11.11.1.m1.1b"><apply id="alg1.11.11.1.m1.1.1.cmml" xref="alg1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.1.1.1.cmml" xref="alg1.11.11.1.m1.1.1">subscript</csymbol><apply id="alg1.11.11.1.m1.1.1.2.cmml" xref="alg1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.1.1.2.1.cmml" xref="alg1.11.11.1.m1.1.1">superscript</csymbol><ci id="alg1.11.11.1.m1.1.1.2.2.cmml" xref="alg1.11.11.1.m1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.11.11.1.m1.1.1.2.3.cmml" xref="alg1.11.11.1.m1.1.1.2.3">0</cn></apply><ci id="alg1.11.11.1.m1.1.1.3.cmml" xref="alg1.11.11.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.1.m1.1c">\theta^{0}_{s}</annotation></semantics></math></span>
</div>
<div id="alg1.19.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.19.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.19.25.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.12.12.m1.2" class="ltx_Math" alttext="n\leftarrow max(R\times N,1)" display="inline"><semantics id="alg1.12.12.m1.2a"><mrow id="alg1.12.12.m1.2.2" xref="alg1.12.12.m1.2.2.cmml"><mi id="alg1.12.12.m1.2.2.3" xref="alg1.12.12.m1.2.2.3.cmml">n</mi><mo stretchy="false" id="alg1.12.12.m1.2.2.2" xref="alg1.12.12.m1.2.2.2.cmml">←</mo><mrow id="alg1.12.12.m1.2.2.1" xref="alg1.12.12.m1.2.2.1.cmml"><mi id="alg1.12.12.m1.2.2.1.3" xref="alg1.12.12.m1.2.2.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.12.12.m1.2.2.1.2" xref="alg1.12.12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.12.12.m1.2.2.1.4" xref="alg1.12.12.m1.2.2.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.12.12.m1.2.2.1.2a" xref="alg1.12.12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.12.12.m1.2.2.1.5" xref="alg1.12.12.m1.2.2.1.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="alg1.12.12.m1.2.2.1.2b" xref="alg1.12.12.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.12.12.m1.2.2.1.1.1" xref="alg1.12.12.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.12.12.m1.2.2.1.1.1.2" xref="alg1.12.12.m1.2.2.1.1.2.cmml">(</mo><mrow id="alg1.12.12.m1.2.2.1.1.1.1" xref="alg1.12.12.m1.2.2.1.1.1.1.cmml"><mi id="alg1.12.12.m1.2.2.1.1.1.1.2" xref="alg1.12.12.m1.2.2.1.1.1.1.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.12.12.m1.2.2.1.1.1.1.1" xref="alg1.12.12.m1.2.2.1.1.1.1.1.cmml">×</mo><mi id="alg1.12.12.m1.2.2.1.1.1.1.3" xref="alg1.12.12.m1.2.2.1.1.1.1.3.cmml">N</mi></mrow><mo id="alg1.12.12.m1.2.2.1.1.1.3" xref="alg1.12.12.m1.2.2.1.1.2.cmml">,</mo><mn id="alg1.12.12.m1.1.1" xref="alg1.12.12.m1.1.1.cmml">1</mn><mo stretchy="false" id="alg1.12.12.m1.2.2.1.1.1.4" xref="alg1.12.12.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.2b"><apply id="alg1.12.12.m1.2.2.cmml" xref="alg1.12.12.m1.2.2"><ci id="alg1.12.12.m1.2.2.2.cmml" xref="alg1.12.12.m1.2.2.2">←</ci><ci id="alg1.12.12.m1.2.2.3.cmml" xref="alg1.12.12.m1.2.2.3">𝑛</ci><apply id="alg1.12.12.m1.2.2.1.cmml" xref="alg1.12.12.m1.2.2.1"><times id="alg1.12.12.m1.2.2.1.2.cmml" xref="alg1.12.12.m1.2.2.1.2"></times><ci id="alg1.12.12.m1.2.2.1.3.cmml" xref="alg1.12.12.m1.2.2.1.3">𝑚</ci><ci id="alg1.12.12.m1.2.2.1.4.cmml" xref="alg1.12.12.m1.2.2.1.4">𝑎</ci><ci id="alg1.12.12.m1.2.2.1.5.cmml" xref="alg1.12.12.m1.2.2.1.5">𝑥</ci><interval closure="open" id="alg1.12.12.m1.2.2.1.1.2.cmml" xref="alg1.12.12.m1.2.2.1.1.1"><apply id="alg1.12.12.m1.2.2.1.1.1.1.cmml" xref="alg1.12.12.m1.2.2.1.1.1.1"><times id="alg1.12.12.m1.2.2.1.1.1.1.1.cmml" xref="alg1.12.12.m1.2.2.1.1.1.1.1"></times><ci id="alg1.12.12.m1.2.2.1.1.1.1.2.cmml" xref="alg1.12.12.m1.2.2.1.1.1.1.2">𝑅</ci><ci id="alg1.12.12.m1.2.2.1.1.1.1.3.cmml" xref="alg1.12.12.m1.2.2.1.1.1.1.3">𝑁</ci></apply><cn type="integer" id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.2c">n\leftarrow max(R\times N,1)</annotation></semantics></math>
</div>
<div id="alg1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.13.13.m1.3" class="ltx_Math" alttext="\mathcal{S}_{i}\leftarrow\left\{k_{1},...,k_{n}\right\}" display="inline"><semantics id="alg1.13.13.m1.3a"><mrow id="alg1.13.13.m1.3.3" xref="alg1.13.13.m1.3.3.cmml"><msub id="alg1.13.13.m1.3.3.4" xref="alg1.13.13.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.13.m1.3.3.4.2" xref="alg1.13.13.m1.3.3.4.2.cmml">𝒮</mi><mi id="alg1.13.13.m1.3.3.4.3" xref="alg1.13.13.m1.3.3.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.13.13.m1.3.3.3" xref="alg1.13.13.m1.3.3.3.cmml">←</mo><mrow id="alg1.13.13.m1.3.3.2.2" xref="alg1.13.13.m1.3.3.2.3.cmml"><mo id="alg1.13.13.m1.3.3.2.2.3" xref="alg1.13.13.m1.3.3.2.3.cmml">{</mo><msub id="alg1.13.13.m1.2.2.1.1.1" xref="alg1.13.13.m1.2.2.1.1.1.cmml"><mi id="alg1.13.13.m1.2.2.1.1.1.2" xref="alg1.13.13.m1.2.2.1.1.1.2.cmml">k</mi><mn id="alg1.13.13.m1.2.2.1.1.1.3" xref="alg1.13.13.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.13.13.m1.3.3.2.2.4" xref="alg1.13.13.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml">…</mi><mo id="alg1.13.13.m1.3.3.2.2.5" xref="alg1.13.13.m1.3.3.2.3.cmml">,</mo><msub id="alg1.13.13.m1.3.3.2.2.2" xref="alg1.13.13.m1.3.3.2.2.2.cmml"><mi id="alg1.13.13.m1.3.3.2.2.2.2" xref="alg1.13.13.m1.3.3.2.2.2.2.cmml">k</mi><mi id="alg1.13.13.m1.3.3.2.2.2.3" xref="alg1.13.13.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="alg1.13.13.m1.3.3.2.2.6" xref="alg1.13.13.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.3b"><apply id="alg1.13.13.m1.3.3.cmml" xref="alg1.13.13.m1.3.3"><ci id="alg1.13.13.m1.3.3.3.cmml" xref="alg1.13.13.m1.3.3.3">←</ci><apply id="alg1.13.13.m1.3.3.4.cmml" xref="alg1.13.13.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.13.13.m1.3.3.4.1.cmml" xref="alg1.13.13.m1.3.3.4">subscript</csymbol><ci id="alg1.13.13.m1.3.3.4.2.cmml" xref="alg1.13.13.m1.3.3.4.2">𝒮</ci><ci id="alg1.13.13.m1.3.3.4.3.cmml" xref="alg1.13.13.m1.3.3.4.3">𝑖</ci></apply><set id="alg1.13.13.m1.3.3.2.3.cmml" xref="alg1.13.13.m1.3.3.2.2"><apply id="alg1.13.13.m1.2.2.1.1.1.cmml" xref="alg1.13.13.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.2.1.1.1.1.cmml" xref="alg1.13.13.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.13.13.m1.2.2.1.1.1.2.cmml" xref="alg1.13.13.m1.2.2.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.13.13.m1.2.2.1.1.1.3.cmml" xref="alg1.13.13.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1">…</ci><apply id="alg1.13.13.m1.3.3.2.2.2.cmml" xref="alg1.13.13.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.3.3.2.2.2.1.cmml" xref="alg1.13.13.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.13.13.m1.3.3.2.2.2.2.cmml" xref="alg1.13.13.m1.3.3.2.2.2.2">𝑘</ci><ci id="alg1.13.13.m1.3.3.2.2.2.3.cmml" xref="alg1.13.13.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.3c">\mathcal{S}_{i}\leftarrow\left\{k_{1},...,k_{n}\right\}</annotation></semantics></math> random set of n clients
</div>
<div id="alg1.19.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span id="alg1.14.14.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.14.14.1" class="ltx_emph ltx_font_italic">each client <math id="alg1.14.14.1.m1.1" class="ltx_Math" alttext="k\in\mathcal{S}_{i}" display="inline"><semantics id="alg1.14.14.1.m1.1a"><mrow id="alg1.14.14.1.m1.1.1" xref="alg1.14.14.1.m1.1.1.cmml"><mi id="alg1.14.14.1.m1.1.1.2" xref="alg1.14.14.1.m1.1.1.2.cmml">k</mi><mo id="alg1.14.14.1.m1.1.1.1" xref="alg1.14.14.1.m1.1.1.1.cmml">∈</mo><msub id="alg1.14.14.1.m1.1.1.3" xref="alg1.14.14.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.14.14.1.m1.1.1.3.2" xref="alg1.14.14.1.m1.1.1.3.2.cmml">𝒮</mi><mi id="alg1.14.14.1.m1.1.1.3.3" xref="alg1.14.14.1.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.1.m1.1b"><apply id="alg1.14.14.1.m1.1.1.cmml" xref="alg1.14.14.1.m1.1.1"><in id="alg1.14.14.1.m1.1.1.1.cmml" xref="alg1.14.14.1.m1.1.1.1"></in><ci id="alg1.14.14.1.m1.1.1.2.cmml" xref="alg1.14.14.1.m1.1.1.2">𝑘</ci><apply id="alg1.14.14.1.m1.1.1.3.cmml" xref="alg1.14.14.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.14.14.1.m1.1.1.3.1.cmml" xref="alg1.14.14.1.m1.1.1.3">subscript</csymbol><ci id="alg1.14.14.1.m1.1.1.3.2.cmml" xref="alg1.14.14.1.m1.1.1.3.2">𝒮</ci><ci id="alg1.14.14.1.m1.1.1.3.3.cmml" xref="alg1.14.14.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.1.m1.1c">k\in\mathcal{S}_{i}</annotation></semantics></math> in parallel</em> <span id="alg1.14.14.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Client <math id="alg1.15.15.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.15.15.m1.1a"><mi id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><ci id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">k</annotation></semantics></math> sends its cluster ID to the server and receives the corresponding cluster model from the server <math id="alg1.16.16.m2.2" class="ltx_Math" alttext="\theta^{i}_{s,m}" display="inline"><semantics id="alg1.16.16.m2.2a"><msubsup id="alg1.16.16.m2.2.3" xref="alg1.16.16.m2.2.3.cmml"><mi id="alg1.16.16.m2.2.3.2.2" xref="alg1.16.16.m2.2.3.2.2.cmml">θ</mi><mrow id="alg1.16.16.m2.2.2.2.4" xref="alg1.16.16.m2.2.2.2.3.cmml"><mi id="alg1.16.16.m2.1.1.1.1" xref="alg1.16.16.m2.1.1.1.1.cmml">s</mi><mo id="alg1.16.16.m2.2.2.2.4.1" xref="alg1.16.16.m2.2.2.2.3.cmml">,</mo><mi id="alg1.16.16.m2.2.2.2.2" xref="alg1.16.16.m2.2.2.2.2.cmml">m</mi></mrow><mi id="alg1.16.16.m2.2.3.2.3" xref="alg1.16.16.m2.2.3.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.16.16.m2.2b"><apply id="alg1.16.16.m2.2.3.cmml" xref="alg1.16.16.m2.2.3"><csymbol cd="ambiguous" id="alg1.16.16.m2.2.3.1.cmml" xref="alg1.16.16.m2.2.3">subscript</csymbol><apply id="alg1.16.16.m2.2.3.2.cmml" xref="alg1.16.16.m2.2.3"><csymbol cd="ambiguous" id="alg1.16.16.m2.2.3.2.1.cmml" xref="alg1.16.16.m2.2.3">superscript</csymbol><ci id="alg1.16.16.m2.2.3.2.2.cmml" xref="alg1.16.16.m2.2.3.2.2">𝜃</ci><ci id="alg1.16.16.m2.2.3.2.3.cmml" xref="alg1.16.16.m2.2.3.2.3">𝑖</ci></apply><list id="alg1.16.16.m2.2.2.2.3.cmml" xref="alg1.16.16.m2.2.2.2.4"><ci id="alg1.16.16.m2.1.1.1.1.cmml" xref="alg1.16.16.m2.1.1.1.1">𝑠</ci><ci id="alg1.16.16.m2.2.2.2.2.cmml" xref="alg1.16.16.m2.2.2.2.2">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m2.2c">\theta^{i}_{s,m}</annotation></semantics></math>
</div>
<div id="alg1.18.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.17.17.m1.2" class="ltx_Math" alttext="{\theta^{i+1}_{k,m}\leftarrow}" display="inline"><semantics id="alg1.17.17.m1.2a"><mrow id="alg1.17.17.m1.2.3" xref="alg1.17.17.m1.2.3.cmml"><msubsup id="alg1.17.17.m1.2.3.2" xref="alg1.17.17.m1.2.3.2.cmml"><mi id="alg1.17.17.m1.2.3.2.2.2" xref="alg1.17.17.m1.2.3.2.2.2.cmml">θ</mi><mrow id="alg1.17.17.m1.2.2.2.4" xref="alg1.17.17.m1.2.2.2.3.cmml"><mi id="alg1.17.17.m1.1.1.1.1" xref="alg1.17.17.m1.1.1.1.1.cmml">k</mi><mo id="alg1.17.17.m1.2.2.2.4.1" xref="alg1.17.17.m1.2.2.2.3.cmml">,</mo><mi id="alg1.17.17.m1.2.2.2.2" xref="alg1.17.17.m1.2.2.2.2.cmml">m</mi></mrow><mrow id="alg1.17.17.m1.2.3.2.2.3" xref="alg1.17.17.m1.2.3.2.2.3.cmml"><mi id="alg1.17.17.m1.2.3.2.2.3.2" xref="alg1.17.17.m1.2.3.2.2.3.2.cmml">i</mi><mo id="alg1.17.17.m1.2.3.2.2.3.1" xref="alg1.17.17.m1.2.3.2.2.3.1.cmml">+</mo><mn id="alg1.17.17.m1.2.3.2.2.3.3" xref="alg1.17.17.m1.2.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.17.17.m1.2.3.1" xref="alg1.17.17.m1.2.3.1.cmml">←</mo><mi id="alg1.17.17.m1.2.3.3" xref="alg1.17.17.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.2b"><apply id="alg1.17.17.m1.2.3.cmml" xref="alg1.17.17.m1.2.3"><ci id="alg1.17.17.m1.2.3.1.cmml" xref="alg1.17.17.m1.2.3.1">←</ci><apply id="alg1.17.17.m1.2.3.2.cmml" xref="alg1.17.17.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.17.17.m1.2.3.2.1.cmml" xref="alg1.17.17.m1.2.3.2">subscript</csymbol><apply id="alg1.17.17.m1.2.3.2.2.cmml" xref="alg1.17.17.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.17.17.m1.2.3.2.2.1.cmml" xref="alg1.17.17.m1.2.3.2">superscript</csymbol><ci id="alg1.17.17.m1.2.3.2.2.2.cmml" xref="alg1.17.17.m1.2.3.2.2.2">𝜃</ci><apply id="alg1.17.17.m1.2.3.2.2.3.cmml" xref="alg1.17.17.m1.2.3.2.2.3"><plus id="alg1.17.17.m1.2.3.2.2.3.1.cmml" xref="alg1.17.17.m1.2.3.2.2.3.1"></plus><ci id="alg1.17.17.m1.2.3.2.2.3.2.cmml" xref="alg1.17.17.m1.2.3.2.2.3.2">𝑖</ci><cn type="integer" id="alg1.17.17.m1.2.3.2.2.3.3.cmml" xref="alg1.17.17.m1.2.3.2.2.3.3">1</cn></apply></apply><list id="alg1.17.17.m1.2.2.2.3.cmml" xref="alg1.17.17.m1.2.2.2.4"><ci id="alg1.17.17.m1.1.1.1.1.cmml" xref="alg1.17.17.m1.1.1.1.1">𝑘</ci><ci id="alg1.17.17.m1.2.2.2.2.cmml" xref="alg1.17.17.m1.2.2.2.2">𝑚</ci></list></apply><csymbol cd="latexml" id="alg1.17.17.m1.2.3.3.cmml" xref="alg1.17.17.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.2c">{\theta^{i+1}_{k,m}\leftarrow}</annotation></semantics></math> ClientUpdate <math id="alg1.18.18.m2.4" class="ltx_Math" alttext="{(\textit{k};\theta^{i}_{s,m})}" display="inline"><semantics id="alg1.18.18.m2.4a"><mrow id="alg1.18.18.m2.4.4.1" xref="alg1.18.18.m2.4.4.2.cmml"><mo stretchy="false" id="alg1.18.18.m2.4.4.1.2" xref="alg1.18.18.m2.4.4.2.cmml">(</mo><mtext class="ltx_mathvariant_italic" id="alg1.18.18.m2.3.3" xref="alg1.18.18.m2.3.3a.cmml">k</mtext><mo id="alg1.18.18.m2.4.4.1.3" xref="alg1.18.18.m2.4.4.2.cmml">;</mo><msubsup id="alg1.18.18.m2.4.4.1.1" xref="alg1.18.18.m2.4.4.1.1.cmml"><mi id="alg1.18.18.m2.4.4.1.1.2.2" xref="alg1.18.18.m2.4.4.1.1.2.2.cmml">θ</mi><mrow id="alg1.18.18.m2.2.2.2.4" xref="alg1.18.18.m2.2.2.2.3.cmml"><mi id="alg1.18.18.m2.1.1.1.1" xref="alg1.18.18.m2.1.1.1.1.cmml">s</mi><mo id="alg1.18.18.m2.2.2.2.4.1" xref="alg1.18.18.m2.2.2.2.3.cmml">,</mo><mi id="alg1.18.18.m2.2.2.2.2" xref="alg1.18.18.m2.2.2.2.2.cmml">m</mi></mrow><mi id="alg1.18.18.m2.4.4.1.1.2.3" xref="alg1.18.18.m2.4.4.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.18.18.m2.4.4.1.4" xref="alg1.18.18.m2.4.4.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.18.m2.4b"><list id="alg1.18.18.m2.4.4.2.cmml" xref="alg1.18.18.m2.4.4.1"><ci id="alg1.18.18.m2.3.3a.cmml" xref="alg1.18.18.m2.3.3"><mtext class="ltx_mathvariant_italic" id="alg1.18.18.m2.3.3.cmml" xref="alg1.18.18.m2.3.3">k</mtext></ci><apply id="alg1.18.18.m2.4.4.1.1.cmml" xref="alg1.18.18.m2.4.4.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m2.4.4.1.1.1.cmml" xref="alg1.18.18.m2.4.4.1.1">subscript</csymbol><apply id="alg1.18.18.m2.4.4.1.1.2.cmml" xref="alg1.18.18.m2.4.4.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m2.4.4.1.1.2.1.cmml" xref="alg1.18.18.m2.4.4.1.1">superscript</csymbol><ci id="alg1.18.18.m2.4.4.1.1.2.2.cmml" xref="alg1.18.18.m2.4.4.1.1.2.2">𝜃</ci><ci id="alg1.18.18.m2.4.4.1.1.2.3.cmml" xref="alg1.18.18.m2.4.4.1.1.2.3">𝑖</ci></apply><list id="alg1.18.18.m2.2.2.2.3.cmml" xref="alg1.18.18.m2.2.2.2.4"><ci id="alg1.18.18.m2.1.1.1.1.cmml" xref="alg1.18.18.m2.1.1.1.1">𝑠</ci><ci id="alg1.18.18.m2.2.2.2.2.cmml" xref="alg1.18.18.m2.2.2.2.2">𝑚</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m2.4c">{(\textit{k};\theta^{i}_{s,m})}</annotation></semantics></math> 
</div>
<div id="alg1.19.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="alg1.19.27.1" class="ltx_text ltx_font_typewriter">// </span><span id="alg1.19.27.2" class="ltx_text ltx_font_typewriter">local SGD training</span>
</div>
<div id="alg1.19.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.19.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math id="alg1.19.19.m1.6" class="ltx_Math" alttext="\theta^{i+1}_{s,m}=\sum_{k\in{C_{m}}}|D_{k}|\theta^{i+1}_{k,m}/\sum_{k\in{C_{m}}}|D_{k}|" display="inline"><semantics id="alg1.19.19.m1.6a"><mrow id="alg1.19.19.m1.6.6" xref="alg1.19.19.m1.6.6.cmml"><msubsup id="alg1.19.19.m1.6.6.4" xref="alg1.19.19.m1.6.6.4.cmml"><mi id="alg1.19.19.m1.6.6.4.2.2" xref="alg1.19.19.m1.6.6.4.2.2.cmml">θ</mi><mrow id="alg1.19.19.m1.2.2.2.4" xref="alg1.19.19.m1.2.2.2.3.cmml"><mi id="alg1.19.19.m1.1.1.1.1" xref="alg1.19.19.m1.1.1.1.1.cmml">s</mi><mo id="alg1.19.19.m1.2.2.2.4.1" xref="alg1.19.19.m1.2.2.2.3.cmml">,</mo><mi id="alg1.19.19.m1.2.2.2.2" xref="alg1.19.19.m1.2.2.2.2.cmml">m</mi></mrow><mrow id="alg1.19.19.m1.6.6.4.2.3" xref="alg1.19.19.m1.6.6.4.2.3.cmml"><mi id="alg1.19.19.m1.6.6.4.2.3.2" xref="alg1.19.19.m1.6.6.4.2.3.2.cmml">i</mi><mo id="alg1.19.19.m1.6.6.4.2.3.1" xref="alg1.19.19.m1.6.6.4.2.3.1.cmml">+</mo><mn id="alg1.19.19.m1.6.6.4.2.3.3" xref="alg1.19.19.m1.6.6.4.2.3.3.cmml">1</mn></mrow></msubsup><mo rspace="0.111em" id="alg1.19.19.m1.6.6.3" xref="alg1.19.19.m1.6.6.3.cmml">=</mo><mrow id="alg1.19.19.m1.6.6.2" xref="alg1.19.19.m1.6.6.2.cmml"><msub id="alg1.19.19.m1.6.6.2.3" xref="alg1.19.19.m1.6.6.2.3.cmml"><mo rspace="0em" id="alg1.19.19.m1.6.6.2.3.2" xref="alg1.19.19.m1.6.6.2.3.2.cmml">∑</mo><mrow id="alg1.19.19.m1.6.6.2.3.3" xref="alg1.19.19.m1.6.6.2.3.3.cmml"><mi id="alg1.19.19.m1.6.6.2.3.3.2" xref="alg1.19.19.m1.6.6.2.3.3.2.cmml">k</mi><mo id="alg1.19.19.m1.6.6.2.3.3.1" xref="alg1.19.19.m1.6.6.2.3.3.1.cmml">∈</mo><msub id="alg1.19.19.m1.6.6.2.3.3.3" xref="alg1.19.19.m1.6.6.2.3.3.3.cmml"><mi id="alg1.19.19.m1.6.6.2.3.3.3.2" xref="alg1.19.19.m1.6.6.2.3.3.3.2.cmml">C</mi><mi id="alg1.19.19.m1.6.6.2.3.3.3.3" xref="alg1.19.19.m1.6.6.2.3.3.3.3.cmml">m</mi></msub></mrow></msub><mrow id="alg1.19.19.m1.6.6.2.2" xref="alg1.19.19.m1.6.6.2.2.cmml"><mrow id="alg1.19.19.m1.5.5.1.1.1" xref="alg1.19.19.m1.5.5.1.1.1.cmml"><mrow id="alg1.19.19.m1.5.5.1.1.1.1.1" xref="alg1.19.19.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.19.19.m1.5.5.1.1.1.1.1.2" xref="alg1.19.19.m1.5.5.1.1.1.1.2.1.cmml">|</mo><msub id="alg1.19.19.m1.5.5.1.1.1.1.1.1" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1.cmml"><mi id="alg1.19.19.m1.5.5.1.1.1.1.1.1.2" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.19.19.m1.5.5.1.1.1.1.1.1.3" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.19.19.m1.5.5.1.1.1.1.1.3" xref="alg1.19.19.m1.5.5.1.1.1.1.2.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.19.19.m1.5.5.1.1.1.2" xref="alg1.19.19.m1.5.5.1.1.1.2.cmml">​</mo><msubsup id="alg1.19.19.m1.5.5.1.1.1.3" xref="alg1.19.19.m1.5.5.1.1.1.3.cmml"><mi id="alg1.19.19.m1.5.5.1.1.1.3.2.2" xref="alg1.19.19.m1.5.5.1.1.1.3.2.2.cmml">θ</mi><mrow id="alg1.19.19.m1.4.4.2.4" xref="alg1.19.19.m1.4.4.2.3.cmml"><mi id="alg1.19.19.m1.3.3.1.1" xref="alg1.19.19.m1.3.3.1.1.cmml">k</mi><mo id="alg1.19.19.m1.4.4.2.4.1" xref="alg1.19.19.m1.4.4.2.3.cmml">,</mo><mi id="alg1.19.19.m1.4.4.2.2" xref="alg1.19.19.m1.4.4.2.2.cmml">m</mi></mrow><mrow id="alg1.19.19.m1.5.5.1.1.1.3.2.3" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.cmml"><mi id="alg1.19.19.m1.5.5.1.1.1.3.2.3.2" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.2.cmml">i</mi><mo id="alg1.19.19.m1.5.5.1.1.1.3.2.3.1" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.1.cmml">+</mo><mn id="alg1.19.19.m1.5.5.1.1.1.3.2.3.3" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo rspace="0.055em" id="alg1.19.19.m1.6.6.2.2.3" xref="alg1.19.19.m1.6.6.2.2.3.cmml">/</mo><mrow id="alg1.19.19.m1.6.6.2.2.2" xref="alg1.19.19.m1.6.6.2.2.2.cmml"><msub id="alg1.19.19.m1.6.6.2.2.2.2" xref="alg1.19.19.m1.6.6.2.2.2.2.cmml"><mo rspace="0em" id="alg1.19.19.m1.6.6.2.2.2.2.2" xref="alg1.19.19.m1.6.6.2.2.2.2.2.cmml">∑</mo><mrow id="alg1.19.19.m1.6.6.2.2.2.2.3" xref="alg1.19.19.m1.6.6.2.2.2.2.3.cmml"><mi id="alg1.19.19.m1.6.6.2.2.2.2.3.2" xref="alg1.19.19.m1.6.6.2.2.2.2.3.2.cmml">k</mi><mo id="alg1.19.19.m1.6.6.2.2.2.2.3.1" xref="alg1.19.19.m1.6.6.2.2.2.2.3.1.cmml">∈</mo><msub id="alg1.19.19.m1.6.6.2.2.2.2.3.3" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3.cmml"><mi id="alg1.19.19.m1.6.6.2.2.2.2.3.3.2" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3.2.cmml">C</mi><mi id="alg1.19.19.m1.6.6.2.2.2.2.3.3.3" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3.3.cmml">m</mi></msub></mrow></msub><mrow id="alg1.19.19.m1.6.6.2.2.2.1.1" xref="alg1.19.19.m1.6.6.2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.19.19.m1.6.6.2.2.2.1.1.2" xref="alg1.19.19.m1.6.6.2.2.2.1.2.1.cmml">|</mo><msub id="alg1.19.19.m1.6.6.2.2.2.1.1.1" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1.cmml"><mi id="alg1.19.19.m1.6.6.2.2.2.1.1.1.2" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1.2.cmml">D</mi><mi id="alg1.19.19.m1.6.6.2.2.2.1.1.1.3" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.19.19.m1.6.6.2.2.2.1.1.3" xref="alg1.19.19.m1.6.6.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.6b"><apply id="alg1.19.19.m1.6.6.cmml" xref="alg1.19.19.m1.6.6"><eq id="alg1.19.19.m1.6.6.3.cmml" xref="alg1.19.19.m1.6.6.3"></eq><apply id="alg1.19.19.m1.6.6.4.cmml" xref="alg1.19.19.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.4.1.cmml" xref="alg1.19.19.m1.6.6.4">subscript</csymbol><apply id="alg1.19.19.m1.6.6.4.2.cmml" xref="alg1.19.19.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.4.2.1.cmml" xref="alg1.19.19.m1.6.6.4">superscript</csymbol><ci id="alg1.19.19.m1.6.6.4.2.2.cmml" xref="alg1.19.19.m1.6.6.4.2.2">𝜃</ci><apply id="alg1.19.19.m1.6.6.4.2.3.cmml" xref="alg1.19.19.m1.6.6.4.2.3"><plus id="alg1.19.19.m1.6.6.4.2.3.1.cmml" xref="alg1.19.19.m1.6.6.4.2.3.1"></plus><ci id="alg1.19.19.m1.6.6.4.2.3.2.cmml" xref="alg1.19.19.m1.6.6.4.2.3.2">𝑖</ci><cn type="integer" id="alg1.19.19.m1.6.6.4.2.3.3.cmml" xref="alg1.19.19.m1.6.6.4.2.3.3">1</cn></apply></apply><list id="alg1.19.19.m1.2.2.2.3.cmml" xref="alg1.19.19.m1.2.2.2.4"><ci id="alg1.19.19.m1.1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1.1">𝑠</ci><ci id="alg1.19.19.m1.2.2.2.2.cmml" xref="alg1.19.19.m1.2.2.2.2">𝑚</ci></list></apply><apply id="alg1.19.19.m1.6.6.2.cmml" xref="alg1.19.19.m1.6.6.2"><apply id="alg1.19.19.m1.6.6.2.3.cmml" xref="alg1.19.19.m1.6.6.2.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.2.3.1.cmml" xref="alg1.19.19.m1.6.6.2.3">subscript</csymbol><sum id="alg1.19.19.m1.6.6.2.3.2.cmml" xref="alg1.19.19.m1.6.6.2.3.2"></sum><apply id="alg1.19.19.m1.6.6.2.3.3.cmml" xref="alg1.19.19.m1.6.6.2.3.3"><in id="alg1.19.19.m1.6.6.2.3.3.1.cmml" xref="alg1.19.19.m1.6.6.2.3.3.1"></in><ci id="alg1.19.19.m1.6.6.2.3.3.2.cmml" xref="alg1.19.19.m1.6.6.2.3.3.2">𝑘</ci><apply id="alg1.19.19.m1.6.6.2.3.3.3.cmml" xref="alg1.19.19.m1.6.6.2.3.3.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.2.3.3.3.1.cmml" xref="alg1.19.19.m1.6.6.2.3.3.3">subscript</csymbol><ci id="alg1.19.19.m1.6.6.2.3.3.3.2.cmml" xref="alg1.19.19.m1.6.6.2.3.3.3.2">𝐶</ci><ci id="alg1.19.19.m1.6.6.2.3.3.3.3.cmml" xref="alg1.19.19.m1.6.6.2.3.3.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.19.19.m1.6.6.2.2.cmml" xref="alg1.19.19.m1.6.6.2.2"><divide id="alg1.19.19.m1.6.6.2.2.3.cmml" xref="alg1.19.19.m1.6.6.2.2.3"></divide><apply id="alg1.19.19.m1.5.5.1.1.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1"><times id="alg1.19.19.m1.5.5.1.1.1.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.2"></times><apply id="alg1.19.19.m1.5.5.1.1.1.1.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1"><abs id="alg1.19.19.m1.5.5.1.1.1.1.2.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1.2"></abs><apply id="alg1.19.19.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.19.19.m1.5.5.1.1.1.1.1.1.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1.2">𝐷</ci><ci id="alg1.19.19.m1.5.5.1.1.1.1.1.1.3.cmml" xref="alg1.19.19.m1.5.5.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="alg1.19.19.m1.5.5.1.1.1.3.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.5.5.1.1.1.3.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3">subscript</csymbol><apply id="alg1.19.19.m1.5.5.1.1.1.3.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.5.5.1.1.1.3.2.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3">superscript</csymbol><ci id="alg1.19.19.m1.5.5.1.1.1.3.2.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3.2.2">𝜃</ci><apply id="alg1.19.19.m1.5.5.1.1.1.3.2.3.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3"><plus id="alg1.19.19.m1.5.5.1.1.1.3.2.3.1.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.1"></plus><ci id="alg1.19.19.m1.5.5.1.1.1.3.2.3.2.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.2">𝑖</ci><cn type="integer" id="alg1.19.19.m1.5.5.1.1.1.3.2.3.3.cmml" xref="alg1.19.19.m1.5.5.1.1.1.3.2.3.3">1</cn></apply></apply><list id="alg1.19.19.m1.4.4.2.3.cmml" xref="alg1.19.19.m1.4.4.2.4"><ci id="alg1.19.19.m1.3.3.1.1.cmml" xref="alg1.19.19.m1.3.3.1.1">𝑘</ci><ci id="alg1.19.19.m1.4.4.2.2.cmml" xref="alg1.19.19.m1.4.4.2.2">𝑚</ci></list></apply></apply><apply id="alg1.19.19.m1.6.6.2.2.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2"><apply id="alg1.19.19.m1.6.6.2.2.2.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.2.2.2.2.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2">subscript</csymbol><sum id="alg1.19.19.m1.6.6.2.2.2.2.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.2"></sum><apply id="alg1.19.19.m1.6.6.2.2.2.2.3.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3"><in id="alg1.19.19.m1.6.6.2.2.2.2.3.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.1"></in><ci id="alg1.19.19.m1.6.6.2.2.2.2.3.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.2">𝑘</ci><apply id="alg1.19.19.m1.6.6.2.2.2.2.3.3.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.2.2.2.2.3.3.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3">subscript</csymbol><ci id="alg1.19.19.m1.6.6.2.2.2.2.3.3.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3.2">𝐶</ci><ci id="alg1.19.19.m1.6.6.2.2.2.2.3.3.3.cmml" xref="alg1.19.19.m1.6.6.2.2.2.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.19.19.m1.6.6.2.2.2.1.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1"><abs id="alg1.19.19.m1.6.6.2.2.2.1.2.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1.2"></abs><apply id="alg1.19.19.m1.6.6.2.2.2.1.1.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m1.6.6.2.2.2.1.1.1.1.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.19.19.m1.6.6.2.2.2.1.1.1.2.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1.2">𝐷</ci><ci id="alg1.19.19.m1.6.6.2.2.2.1.1.1.3.cmml" xref="alg1.19.19.m1.6.6.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.6c">\theta^{i+1}_{s,m}=\sum_{k\in{C_{m}}}|D_{k}|\theta^{i+1}_{k,m}/\sum_{k\in{C_{m}}}|D_{k}|</annotation></semantics></math> 
</div>
<div id="alg1.19.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span id="alg1.19.29.1" class="ltx_text ltx_font_typewriter">// </span><span id="alg1.19.29.2" class="ltx_text ltx_font_typewriter">each cluster model averaging</span>
</div>
<div id="alg1.19.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.19.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>
</div>
<div id="alg1.19.32" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.21.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>FedClust</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Selection of Model Weights</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.3" class="ltx_p"><span id="S4.SS1.p1.3.1" class="ltx_text ltx_font_italic">FedClust</span> utilizes only the final layer weights instead of the full model weights to group clients into clusters. We have observed empirically that there exists an implicit relationship between the local data distribution of clients with the model weights trained on their dataset, consistent with the findings in <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2020a</a>)</cite>. Therefore, <span id="S4.SS1.p1.3.2" class="ltx_text ltx_font_italic">FedClust</span> leverages clients model weights to infer the relative characteristics of the underlying data distribution. The difference in data distribution between clients can be approximated based on the difference in their model weights, referred to as the model distance, after the completion of their local model training. The model distance between the model weights of any two clients <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="c_{p}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">c</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑐</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">c_{p}</annotation></semantics></math> and <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="c_{q}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">c</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑐</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">c_{q}</annotation></semantics></math> can be calculated using <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">l</mi><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑙</ci><cn type="integer" id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">l_{2}</annotation></semantics></math> distance as follows:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.3" class="ltx_Math" alttext="dist(c_{p},c_{q})=\Big{|}\Big{|}\hat{\theta}_{c_{p}}-\hat{\theta}_{c_{q}}\Big{|}\Big{|}_{l_{2}}" display="block"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml"><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mi id="S4.E3.m1.2.2.2.5" xref="S4.E3.m1.2.2.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3a" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mi id="S4.E3.m1.2.2.2.6" xref="S4.E3.m1.2.2.2.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3b" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mi id="S4.E3.m1.2.2.2.7" xref="S4.E3.m1.2.2.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.3c" xref="S4.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="S4.E3.m1.2.2.2.2.2.4" xref="S4.E3.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml">c</mi><mi id="S4.E3.m1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S4.E3.m1.2.2.2.2.2.5" xref="S4.E3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.3.3.4" xref="S4.E3.m1.3.3.4.cmml">=</mo><msub id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><mrow id="S4.E3.m1.3.3.3.1.1" xref="S4.E3.m1.3.3.3.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.3.3.3.1.1.2" xref="S4.E3.m1.3.3.3.1.2.1.cmml">‖</mo><mrow id="S4.E3.m1.3.3.3.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.cmml"><msub id="S4.E3.m1.3.3.3.1.1.1.2" xref="S4.E3.m1.3.3.3.1.1.1.2.cmml"><mover accent="true" id="S4.E3.m1.3.3.3.1.1.1.2.2" xref="S4.E3.m1.3.3.3.1.1.1.2.2.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.2.2.2" xref="S4.E3.m1.3.3.3.1.1.1.2.2.2.cmml">θ</mi><mo id="S4.E3.m1.3.3.3.1.1.1.2.2.1" xref="S4.E3.m1.3.3.3.1.1.1.2.2.1.cmml">^</mo></mover><msub id="S4.E3.m1.3.3.3.1.1.1.2.3" xref="S4.E3.m1.3.3.3.1.1.1.2.3.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.2.3.2" xref="S4.E3.m1.3.3.3.1.1.1.2.3.2.cmml">c</mi><mi id="S4.E3.m1.3.3.3.1.1.1.2.3.3" xref="S4.E3.m1.3.3.3.1.1.1.2.3.3.cmml">p</mi></msub></msub><mo id="S4.E3.m1.3.3.3.1.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.1.cmml">−</mo><msub id="S4.E3.m1.3.3.3.1.1.1.3" xref="S4.E3.m1.3.3.3.1.1.1.3.cmml"><mover accent="true" id="S4.E3.m1.3.3.3.1.1.1.3.2" xref="S4.E3.m1.3.3.3.1.1.1.3.2.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.3.2.2" xref="S4.E3.m1.3.3.3.1.1.1.3.2.2.cmml">θ</mi><mo id="S4.E3.m1.3.3.3.1.1.1.3.2.1" xref="S4.E3.m1.3.3.3.1.1.1.3.2.1.cmml">^</mo></mover><msub id="S4.E3.m1.3.3.3.1.1.1.3.3" xref="S4.E3.m1.3.3.3.1.1.1.3.3.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.3.3.2" xref="S4.E3.m1.3.3.3.1.1.1.3.3.2.cmml">c</mi><mi id="S4.E3.m1.3.3.3.1.1.1.3.3.3" xref="S4.E3.m1.3.3.3.1.1.1.3.3.3.cmml">q</mi></msub></msub></mrow><mo stretchy="false" id="S4.E3.m1.3.3.3.1.1.3" xref="S4.E3.m1.3.3.3.1.2.1.cmml">‖</mo></mrow><msub id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.2" xref="S4.E3.m1.3.3.3.3.2.cmml">l</mi><mn id="S4.E3.m1.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.cmml">2</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3"><eq id="S4.E3.m1.3.3.4.cmml" xref="S4.E3.m1.3.3.4"></eq><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><times id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"></times><ci id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.4">𝑑</ci><ci id="S4.E3.m1.2.2.2.5.cmml" xref="S4.E3.m1.2.2.2.5">𝑖</ci><ci id="S4.E3.m1.2.2.2.6.cmml" xref="S4.E3.m1.2.2.2.6">𝑠</ci><ci id="S4.E3.m1.2.2.2.7.cmml" xref="S4.E3.m1.2.2.2.7">𝑡</ci><interval closure="open" id="S4.E3.m1.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2">𝑐</ci><ci id="S4.E3.m1.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3">𝑞</ci></apply></interval></apply><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3">subscript</csymbol><apply id="S4.E3.m1.3.3.3.1.2.cmml" xref="S4.E3.m1.3.3.3.1.1"><csymbol cd="latexml" id="S4.E3.m1.3.3.3.1.2.1.cmml" xref="S4.E3.m1.3.3.3.1.1.2">norm</csymbol><apply id="S4.E3.m1.3.3.3.1.1.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1"><minus id="S4.E3.m1.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1"></minus><apply id="S4.E3.m1.3.3.3.1.1.1.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.1.1.1.2.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2">subscript</csymbol><apply id="S4.E3.m1.3.3.3.1.1.1.2.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.2"><ci id="S4.E3.m1.3.3.3.1.1.1.2.2.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.2.1">^</ci><ci id="S4.E3.m1.3.3.3.1.1.1.2.2.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.2.2">𝜃</ci></apply><apply id="S4.E3.m1.3.3.3.1.1.1.2.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.1.1.1.2.3.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.1.1.1.2.3.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.3.2">𝑐</ci><ci id="S4.E3.m1.3.3.3.1.1.1.2.3.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.2.3.3">𝑝</ci></apply></apply><apply id="S4.E3.m1.3.3.3.1.1.1.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.1.1.1.3.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.3.3.3.1.1.1.3.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.2"><ci id="S4.E3.m1.3.3.3.1.1.1.3.2.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.2.1">^</ci><ci id="S4.E3.m1.3.3.3.1.1.1.3.2.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.2.2">𝜃</ci></apply><apply id="S4.E3.m1.3.3.3.1.1.1.3.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.1.1.1.3.3.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.1.1.1.3.3.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.3.2">𝑐</ci><ci id="S4.E3.m1.3.3.3.1.1.1.3.3.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.3.3.3">𝑞</ci></apply></apply></apply></apply><apply id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.2">𝑙</ci><cn type="integer" id="S4.E3.m1.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">dist(c_{p},c_{q})=\Big{|}\Big{|}\hat{\theta}_{c_{p}}-\hat{\theta}_{c_{q}}\Big{|}\Big{|}_{l_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.6" class="ltx_p">Generally, if two clients contain similar data distributions, they tend to train models in a similar fashion compared to clients with dissimilar data <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Ouyang et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2020a</a>)</cite>. As a result, the distance between their model weights will be smaller. Therefore, the model distance can be used as a useful metric to cluster clients. The server forms a distance matrix <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathcal{M}</annotation></semantics></math> of size <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="m\times m" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">×</mo><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><times id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></times><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑚</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">m\times m</annotation></semantics></math> after receiving the final layer weights of all client’s models. Each entity of the matrix <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{M}_{pq}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">ℳ</mi><mrow id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">ℳ</ci><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><times id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.1"></times><ci id="S4.SS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.2">𝑝</ci><ci id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\mathcal{M}_{pq}</annotation></semantics></math> represents the computed model distance <math id="S4.SS1.p2.4.m4.2" class="ltx_Math" alttext="dist(c_{p},c_{q})" display="inline"><semantics id="S4.SS1.p2.4.m4.2a"><mrow id="S4.SS1.p2.4.m4.2.2" xref="S4.SS1.p2.4.m4.2.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.4" xref="S4.SS1.p2.4.m4.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.2.2.3" xref="S4.SS1.p2.4.m4.2.2.3.cmml">​</mo><mi id="S4.SS1.p2.4.m4.2.2.5" xref="S4.SS1.p2.4.m4.2.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.2.2.3a" xref="S4.SS1.p2.4.m4.2.2.3.cmml">​</mo><mi id="S4.SS1.p2.4.m4.2.2.6" xref="S4.SS1.p2.4.m4.2.2.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.2.2.3b" xref="S4.SS1.p2.4.m4.2.2.3.cmml">​</mo><mi id="S4.SS1.p2.4.m4.2.2.7" xref="S4.SS1.p2.4.m4.2.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m4.2.2.3c" xref="S4.SS1.p2.4.m4.2.2.3.cmml">​</mo><mrow id="S4.SS1.p2.4.m4.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.4.m4.2.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.1.2.cmml">c</mi><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.1.3.cmml">p</mi></msub><mo id="S4.SS1.p2.4.m4.2.2.2.2.4" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.4.m4.2.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.4.m4.2.2.2.2.2.2" xref="S4.SS1.p2.4.m4.2.2.2.2.2.2.cmml">c</mi><mi id="S4.SS1.p2.4.m4.2.2.2.2.2.3" xref="S4.SS1.p2.4.m4.2.2.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S4.SS1.p2.4.m4.2.2.2.2.5" xref="S4.SS1.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.2b"><apply id="S4.SS1.p2.4.m4.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2"><times id="S4.SS1.p2.4.m4.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.3"></times><ci id="S4.SS1.p2.4.m4.2.2.4.cmml" xref="S4.SS1.p2.4.m4.2.2.4">𝑑</ci><ci id="S4.SS1.p2.4.m4.2.2.5.cmml" xref="S4.SS1.p2.4.m4.2.2.5">𝑖</ci><ci id="S4.SS1.p2.4.m4.2.2.6.cmml" xref="S4.SS1.p2.4.m4.2.2.6">𝑠</ci><ci id="S4.SS1.p2.4.m4.2.2.7.cmml" xref="S4.SS1.p2.4.m4.2.2.7">𝑡</ci><interval closure="open" id="S4.SS1.p2.4.m4.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2"><apply id="S4.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.2">𝑐</ci><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.3">𝑝</ci></apply><apply id="S4.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2.2">𝑐</ci><ci id="S4.SS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.4.m4.2.2.2.2.2.3">𝑞</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.2c">dist(c_{p},c_{q})</annotation></semantics></math> between clients <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="c_{p}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><msub id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">c</mi><mi id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝑐</ci><ci id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">c_{p}</annotation></semantics></math> and <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="c_{q}" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><msub id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">c</mi><mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝑐</ci><ci id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">c_{q}</annotation></semantics></math>. Federated learning training typically involves a large number of client devices and the target machine learning model could be complex with huge parameters, <span id="S4.SS1.p2.6.1" class="ltx_text ltx_font_italic">e.g.</span>, the VGG16 model has a total of 138M weights <cite class="ltx_cite ltx_citemacro_citep">(Simonyan and Zisserman, <a href="#bib.bib36" title="" class="ltx_ref">2014</a>)</cite>. Consequently, clustering methods based on model weights would require higher computation costs, affecting the clustering efficiency.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.3" class="ltx_p">To enhance clustering accuracy and reduce additional computational overheads, we only select the final layer weights of the clients local model instead of full model weights to determine the similarity. In Fig. 1, we have empirically demonstrated that the final layer weight of the model reflects the model difference caused by non-IID data. Therefore, calculating the distance matrix using all weights can lead to a bad similarity matrix thus reducing the clustering accuracy.
Moreover, the lower layers of the model contain the majority portion of the weights. Specifically, in deep learning models, especially those used for image classification tasks, <span id="S4.SS1.p3.3.1" class="ltx_text ltx_font_italic">e.g.</span>, CNN models, the purpose of convolutional layers is to identify and extract features from the input, while the fully connected layers focus on the final classification task. Therefore, fully connected layer weights are more task-related. In <span id="S4.SS1.p3.3.2" class="ltx_text ltx_font_italic">FedClust</span>, we thus choose a subset of the model’s parameters, specifically the weights and bias of the final layer, to serve as a representation of the entire model. We utilize these weights to calculate distance matrix <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathcal{M}</annotation></semantics></math>. It significantly reduces the computation cost as the size of the final layer weights <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="{\hat{\theta}_{c_{p}}}" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.cmml">θ</mi><mo id="S4.SS1.p3.2.m2.1.1.2.1" xref="S4.SS1.p3.2.m2.1.1.2.1.cmml">^</mo></mover><msub id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml">c</mi><mi id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml">p</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"><ci id="S4.SS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2.1">^</ci><ci id="S4.SS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2">𝜃</ci></apply><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.p3.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">{\hat{\theta}_{c_{p}}}</annotation></semantics></math> is much smaller than the full model weights <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="{{\theta}_{c_{p}}}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">θ</mi><msub id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.3.2.cmml">c</mi><mi id="S4.SS1.p3.3.m3.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml">p</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝜃</ci><apply id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.2">𝑐</ci><ci id="S4.SS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">{{\theta}_{c_{p}}}</annotation></semantics></math>.</p>
</div>
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.12" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.2.2" class="ltx_listingline">
<span id="alg2.2.2.1" class="ltx_text"><span id="alg2.2.2.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>New client <math id="alg2.1.1.m1.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="alg2.1.1.m1.1a"><msub id="alg2.1.1.m1.1.1" xref="alg2.1.1.m1.1.1.cmml"><mi id="alg2.1.1.m1.1.1.2" xref="alg2.1.1.m1.1.1.2.cmml">c</mi><mrow id="alg2.1.1.m1.1.1.3" xref="alg2.1.1.m1.1.1.3.cmml"><mi id="alg2.1.1.m1.1.1.3.2" xref="alg2.1.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.m1.1.1.3.1" xref="alg2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="alg2.1.1.m1.1.1.3.3" xref="alg2.1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.1.1.m1.1.1.3.1a" xref="alg2.1.1.m1.1.1.3.1.cmml">​</mo><mi id="alg2.1.1.m1.1.1.3.4" xref="alg2.1.1.m1.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.1b"><apply id="alg2.1.1.m1.1.1.cmml" xref="alg2.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.m1.1.1.1.cmml" xref="alg2.1.1.m1.1.1">subscript</csymbol><ci id="alg2.1.1.m1.1.1.2.cmml" xref="alg2.1.1.m1.1.1.2">𝑐</ci><apply id="alg2.1.1.m1.1.1.3.cmml" xref="alg2.1.1.m1.1.1.3"><times id="alg2.1.1.m1.1.1.3.1.cmml" xref="alg2.1.1.m1.1.1.3.1"></times><ci id="alg2.1.1.m1.1.1.3.2.cmml" xref="alg2.1.1.m1.1.1.3.2">𝑛</ci><ci id="alg2.1.1.m1.1.1.3.3.cmml" xref="alg2.1.1.m1.1.1.3.3">𝑒</ci><ci id="alg2.1.1.m1.1.1.3.4.cmml" xref="alg2.1.1.m1.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.1c">c_{new}</annotation></semantics></math>, Existing clusters partial model weights <math id="alg2.2.2.m2.3" class="ltx_Math" alttext="\{\hat{\theta}_{g_{1}},\ldots,\hat{\theta}_{g_{m}}\}" display="inline"><semantics id="alg2.2.2.m2.3a"><mrow id="alg2.2.2.m2.3.3.2" xref="alg2.2.2.m2.3.3.3.cmml"><mo stretchy="false" id="alg2.2.2.m2.3.3.2.3" xref="alg2.2.2.m2.3.3.3.cmml">{</mo><msub id="alg2.2.2.m2.2.2.1.1" xref="alg2.2.2.m2.2.2.1.1.cmml"><mover accent="true" id="alg2.2.2.m2.2.2.1.1.2" xref="alg2.2.2.m2.2.2.1.1.2.cmml"><mi id="alg2.2.2.m2.2.2.1.1.2.2" xref="alg2.2.2.m2.2.2.1.1.2.2.cmml">θ</mi><mo id="alg2.2.2.m2.2.2.1.1.2.1" xref="alg2.2.2.m2.2.2.1.1.2.1.cmml">^</mo></mover><msub id="alg2.2.2.m2.2.2.1.1.3" xref="alg2.2.2.m2.2.2.1.1.3.cmml"><mi id="alg2.2.2.m2.2.2.1.1.3.2" xref="alg2.2.2.m2.2.2.1.1.3.2.cmml">g</mi><mn id="alg2.2.2.m2.2.2.1.1.3.3" xref="alg2.2.2.m2.2.2.1.1.3.3.cmml">1</mn></msub></msub><mo id="alg2.2.2.m2.3.3.2.4" xref="alg2.2.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg2.2.2.m2.1.1" xref="alg2.2.2.m2.1.1.cmml">…</mi><mo id="alg2.2.2.m2.3.3.2.5" xref="alg2.2.2.m2.3.3.3.cmml">,</mo><msub id="alg2.2.2.m2.3.3.2.2" xref="alg2.2.2.m2.3.3.2.2.cmml"><mover accent="true" id="alg2.2.2.m2.3.3.2.2.2" xref="alg2.2.2.m2.3.3.2.2.2.cmml"><mi id="alg2.2.2.m2.3.3.2.2.2.2" xref="alg2.2.2.m2.3.3.2.2.2.2.cmml">θ</mi><mo id="alg2.2.2.m2.3.3.2.2.2.1" xref="alg2.2.2.m2.3.3.2.2.2.1.cmml">^</mo></mover><msub id="alg2.2.2.m2.3.3.2.2.3" xref="alg2.2.2.m2.3.3.2.2.3.cmml"><mi id="alg2.2.2.m2.3.3.2.2.3.2" xref="alg2.2.2.m2.3.3.2.2.3.2.cmml">g</mi><mi id="alg2.2.2.m2.3.3.2.2.3.3" xref="alg2.2.2.m2.3.3.2.2.3.3.cmml">m</mi></msub></msub><mo stretchy="false" id="alg2.2.2.m2.3.3.2.6" xref="alg2.2.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.m2.3b"><set id="alg2.2.2.m2.3.3.3.cmml" xref="alg2.2.2.m2.3.3.2"><apply id="alg2.2.2.m2.2.2.1.1.cmml" xref="alg2.2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.2.2.m2.2.2.1.1.1.cmml" xref="alg2.2.2.m2.2.2.1.1">subscript</csymbol><apply id="alg2.2.2.m2.2.2.1.1.2.cmml" xref="alg2.2.2.m2.2.2.1.1.2"><ci id="alg2.2.2.m2.2.2.1.1.2.1.cmml" xref="alg2.2.2.m2.2.2.1.1.2.1">^</ci><ci id="alg2.2.2.m2.2.2.1.1.2.2.cmml" xref="alg2.2.2.m2.2.2.1.1.2.2">𝜃</ci></apply><apply id="alg2.2.2.m2.2.2.1.1.3.cmml" xref="alg2.2.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg2.2.2.m2.2.2.1.1.3.1.cmml" xref="alg2.2.2.m2.2.2.1.1.3">subscript</csymbol><ci id="alg2.2.2.m2.2.2.1.1.3.2.cmml" xref="alg2.2.2.m2.2.2.1.1.3.2">𝑔</ci><cn type="integer" id="alg2.2.2.m2.2.2.1.1.3.3.cmml" xref="alg2.2.2.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="alg2.2.2.m2.1.1.cmml" xref="alg2.2.2.m2.1.1">…</ci><apply id="alg2.2.2.m2.3.3.2.2.cmml" xref="alg2.2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg2.2.2.m2.3.3.2.2.1.cmml" xref="alg2.2.2.m2.3.3.2.2">subscript</csymbol><apply id="alg2.2.2.m2.3.3.2.2.2.cmml" xref="alg2.2.2.m2.3.3.2.2.2"><ci id="alg2.2.2.m2.3.3.2.2.2.1.cmml" xref="alg2.2.2.m2.3.3.2.2.2.1">^</ci><ci id="alg2.2.2.m2.3.3.2.2.2.2.cmml" xref="alg2.2.2.m2.3.3.2.2.2.2">𝜃</ci></apply><apply id="alg2.2.2.m2.3.3.2.2.3.cmml" xref="alg2.2.2.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg2.2.2.m2.3.3.2.2.3.1.cmml" xref="alg2.2.2.m2.3.3.2.2.3">subscript</csymbol><ci id="alg2.2.2.m2.3.3.2.2.3.2.cmml" xref="alg2.2.2.m2.3.3.2.2.3.2">𝑔</ci><ci id="alg2.2.2.m2.3.3.2.2.3.3.cmml" xref="alg2.2.2.m2.3.3.2.2.3.3">𝑚</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m2.3c">\{\hat{\theta}_{g_{1}},\ldots,\hat{\theta}_{g_{m}}\}</annotation></semantics></math>
</div>
<div id="alg2.4.4" class="ltx_listingline">
<span id="alg2.4.4.1" class="ltx_text"><span id="alg2.4.4.1.1" class="ltx_text ltx_font_bold">Init:</span> </span>Appropriate cluster <math id="alg2.3.3.m1.1" class="ltx_Math" alttext="g^{*}" display="inline"><semantics id="alg2.3.3.m1.1a"><msup id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml"><mi id="alg2.3.3.m1.1.1.2" xref="alg2.3.3.m1.1.1.2.cmml">g</mi><mo id="alg2.3.3.m1.1.1.3" xref="alg2.3.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><apply id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1"><csymbol cd="ambiguous" id="alg2.3.3.m1.1.1.1.cmml" xref="alg2.3.3.m1.1.1">superscript</csymbol><ci id="alg2.3.3.m1.1.1.2.cmml" xref="alg2.3.3.m1.1.1.2">𝑔</ci><times id="alg2.3.3.m1.1.1.3.cmml" xref="alg2.3.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">g^{*}</annotation></semantics></math> to incorporate <math id="alg2.4.4.m2.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="alg2.4.4.m2.1a"><msub id="alg2.4.4.m2.1.1" xref="alg2.4.4.m2.1.1.cmml"><mi id="alg2.4.4.m2.1.1.2" xref="alg2.4.4.m2.1.1.2.cmml">c</mi><mrow id="alg2.4.4.m2.1.1.3" xref="alg2.4.4.m2.1.1.3.cmml"><mi id="alg2.4.4.m2.1.1.3.2" xref="alg2.4.4.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.m2.1.1.3.1" xref="alg2.4.4.m2.1.1.3.1.cmml">​</mo><mi id="alg2.4.4.m2.1.1.3.3" xref="alg2.4.4.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.4.4.m2.1.1.3.1a" xref="alg2.4.4.m2.1.1.3.1.cmml">​</mo><mi id="alg2.4.4.m2.1.1.3.4" xref="alg2.4.4.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.4.4.m2.1b"><apply id="alg2.4.4.m2.1.1.cmml" xref="alg2.4.4.m2.1.1"><csymbol cd="ambiguous" id="alg2.4.4.m2.1.1.1.cmml" xref="alg2.4.4.m2.1.1">subscript</csymbol><ci id="alg2.4.4.m2.1.1.2.cmml" xref="alg2.4.4.m2.1.1.2">𝑐</ci><apply id="alg2.4.4.m2.1.1.3.cmml" xref="alg2.4.4.m2.1.1.3"><times id="alg2.4.4.m2.1.1.3.1.cmml" xref="alg2.4.4.m2.1.1.3.1"></times><ci id="alg2.4.4.m2.1.1.3.2.cmml" xref="alg2.4.4.m2.1.1.3.2">𝑛</ci><ci id="alg2.4.4.m2.1.1.3.3.cmml" xref="alg2.4.4.m2.1.1.3.3">𝑒</ci><ci id="alg2.4.4.m2.1.1.3.4.cmml" xref="alg2.4.4.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m2.1c">c_{new}</annotation></semantics></math>
</div>
<div id="alg2.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
Server sends the initial global model <math id="alg2.5.5.m1.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="alg2.5.5.m1.1a"><msubsup id="alg2.5.5.m1.1.1" xref="alg2.5.5.m1.1.1.cmml"><mi id="alg2.5.5.m1.1.1.2.2" xref="alg2.5.5.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.5.5.m1.1.1.3" xref="alg2.5.5.m1.1.1.3.cmml">s</mi><mn id="alg2.5.5.m1.1.1.2.3" xref="alg2.5.5.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.1b"><apply id="alg2.5.5.m1.1.1.cmml" xref="alg2.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.m1.1.1.1.cmml" xref="alg2.5.5.m1.1.1">subscript</csymbol><apply id="alg2.5.5.m1.1.1.2.cmml" xref="alg2.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.m1.1.1.2.1.cmml" xref="alg2.5.5.m1.1.1">superscript</csymbol><ci id="alg2.5.5.m1.1.1.2.2.cmml" xref="alg2.5.5.m1.1.1.2.2">𝜃</ci><cn type="integer" id="alg2.5.5.m1.1.1.2.3.cmml" xref="alg2.5.5.m1.1.1.2.3">0</cn></apply><ci id="alg2.5.5.m1.1.1.3.cmml" xref="alg2.5.5.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.1c">\theta^{0}_{s}</annotation></semantics></math> to <math id="alg2.6.6.m2.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="alg2.6.6.m2.1a"><msub id="alg2.6.6.m2.1.1" xref="alg2.6.6.m2.1.1.cmml"><mi id="alg2.6.6.m2.1.1.2" xref="alg2.6.6.m2.1.1.2.cmml">c</mi><mrow id="alg2.6.6.m2.1.1.3" xref="alg2.6.6.m2.1.1.3.cmml"><mi id="alg2.6.6.m2.1.1.3.2" xref="alg2.6.6.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m2.1.1.3.1" xref="alg2.6.6.m2.1.1.3.1.cmml">​</mo><mi id="alg2.6.6.m2.1.1.3.3" xref="alg2.6.6.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m2.1.1.3.1a" xref="alg2.6.6.m2.1.1.3.1.cmml">​</mo><mi id="alg2.6.6.m2.1.1.3.4" xref="alg2.6.6.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.6.6.m2.1b"><apply id="alg2.6.6.m2.1.1.cmml" xref="alg2.6.6.m2.1.1"><csymbol cd="ambiguous" id="alg2.6.6.m2.1.1.1.cmml" xref="alg2.6.6.m2.1.1">subscript</csymbol><ci id="alg2.6.6.m2.1.1.2.cmml" xref="alg2.6.6.m2.1.1.2">𝑐</ci><apply id="alg2.6.6.m2.1.1.3.cmml" xref="alg2.6.6.m2.1.1.3"><times id="alg2.6.6.m2.1.1.3.1.cmml" xref="alg2.6.6.m2.1.1.3.1"></times><ci id="alg2.6.6.m2.1.1.3.2.cmml" xref="alg2.6.6.m2.1.1.3.2">𝑛</ci><ci id="alg2.6.6.m2.1.1.3.3.cmml" xref="alg2.6.6.m2.1.1.3.3">𝑒</ci><ci id="alg2.6.6.m2.1.1.3.4.cmml" xref="alg2.6.6.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m2.1c">c_{new}</annotation></semantics></math>
</div>
<div id="alg2.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
<math id="alg2.7.7.m1.1" class="ltx_Math" alttext="\theta_{c_{new}}\leftarrow" display="inline"><semantics id="alg2.7.7.m1.1a"><mrow id="alg2.7.7.m1.1.1" xref="alg2.7.7.m1.1.1.cmml"><msub id="alg2.7.7.m1.1.1.2" xref="alg2.7.7.m1.1.1.2.cmml"><mi id="alg2.7.7.m1.1.1.2.2" xref="alg2.7.7.m1.1.1.2.2.cmml">θ</mi><msub id="alg2.7.7.m1.1.1.2.3" xref="alg2.7.7.m1.1.1.2.3.cmml"><mi id="alg2.7.7.m1.1.1.2.3.2" xref="alg2.7.7.m1.1.1.2.3.2.cmml">c</mi><mrow id="alg2.7.7.m1.1.1.2.3.3" xref="alg2.7.7.m1.1.1.2.3.3.cmml"><mi id="alg2.7.7.m1.1.1.2.3.3.2" xref="alg2.7.7.m1.1.1.2.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.m1.1.1.2.3.3.1" xref="alg2.7.7.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.7.7.m1.1.1.2.3.3.3" xref="alg2.7.7.m1.1.1.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.m1.1.1.2.3.3.1a" xref="alg2.7.7.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.7.7.m1.1.1.2.3.3.4" xref="alg2.7.7.m1.1.1.2.3.3.4.cmml">w</mi></mrow></msub></msub><mo stretchy="false" id="alg2.7.7.m1.1.1.1" xref="alg2.7.7.m1.1.1.1.cmml">←</mo><mi id="alg2.7.7.m1.1.1.3" xref="alg2.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.7.m1.1b"><apply id="alg2.7.7.m1.1.1.cmml" xref="alg2.7.7.m1.1.1"><ci id="alg2.7.7.m1.1.1.1.cmml" xref="alg2.7.7.m1.1.1.1">←</ci><apply id="alg2.7.7.m1.1.1.2.cmml" xref="alg2.7.7.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.7.7.m1.1.1.2.1.cmml" xref="alg2.7.7.m1.1.1.2">subscript</csymbol><ci id="alg2.7.7.m1.1.1.2.2.cmml" xref="alg2.7.7.m1.1.1.2.2">𝜃</ci><apply id="alg2.7.7.m1.1.1.2.3.cmml" xref="alg2.7.7.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.7.7.m1.1.1.2.3.1.cmml" xref="alg2.7.7.m1.1.1.2.3">subscript</csymbol><ci id="alg2.7.7.m1.1.1.2.3.2.cmml" xref="alg2.7.7.m1.1.1.2.3.2">𝑐</ci><apply id="alg2.7.7.m1.1.1.2.3.3.cmml" xref="alg2.7.7.m1.1.1.2.3.3"><times id="alg2.7.7.m1.1.1.2.3.3.1.cmml" xref="alg2.7.7.m1.1.1.2.3.3.1"></times><ci id="alg2.7.7.m1.1.1.2.3.3.2.cmml" xref="alg2.7.7.m1.1.1.2.3.3.2">𝑛</ci><ci id="alg2.7.7.m1.1.1.2.3.3.3.cmml" xref="alg2.7.7.m1.1.1.2.3.3.3">𝑒</ci><ci id="alg2.7.7.m1.1.1.2.3.3.4.cmml" xref="alg2.7.7.m1.1.1.2.3.3.4">𝑤</ci></apply></apply></apply><csymbol cd="latexml" id="alg2.7.7.m1.1.1.3.cmml" xref="alg2.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m1.1c">\theta_{c_{new}}\leftarrow</annotation></semantics></math> <math id="alg2.8.8.m2.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="alg2.8.8.m2.1a"><msub id="alg2.8.8.m2.1.1" xref="alg2.8.8.m2.1.1.cmml"><mi id="alg2.8.8.m2.1.1.2" xref="alg2.8.8.m2.1.1.2.cmml">c</mi><mrow id="alg2.8.8.m2.1.1.3" xref="alg2.8.8.m2.1.1.3.cmml"><mi id="alg2.8.8.m2.1.1.3.2" xref="alg2.8.8.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi id="alg2.8.8.m2.1.1.3.3" xref="alg2.8.8.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m2.1.1.3.1a" xref="alg2.8.8.m2.1.1.3.1.cmml">​</mo><mi id="alg2.8.8.m2.1.1.3.4" xref="alg2.8.8.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.8.8.m2.1b"><apply id="alg2.8.8.m2.1.1.cmml" xref="alg2.8.8.m2.1.1"><csymbol cd="ambiguous" id="alg2.8.8.m2.1.1.1.cmml" xref="alg2.8.8.m2.1.1">subscript</csymbol><ci id="alg2.8.8.m2.1.1.2.cmml" xref="alg2.8.8.m2.1.1.2">𝑐</ci><apply id="alg2.8.8.m2.1.1.3.cmml" xref="alg2.8.8.m2.1.1.3"><times id="alg2.8.8.m2.1.1.3.1.cmml" xref="alg2.8.8.m2.1.1.3.1"></times><ci id="alg2.8.8.m2.1.1.3.2.cmml" xref="alg2.8.8.m2.1.1.3.2">𝑛</ci><ci id="alg2.8.8.m2.1.1.3.3.cmml" xref="alg2.8.8.m2.1.1.3.3">𝑒</ci><ci id="alg2.8.8.m2.1.1.3.4.cmml" xref="alg2.8.8.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.m2.1c">c_{new}</annotation></semantics></math> trains the model using its local data
</div>
<div id="alg2.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>
<math id="alg2.9.9.m1.1" class="ltx_Math" alttext="{\hat{\theta}_{c_{new}}}\leftarrow" display="inline"><semantics id="alg2.9.9.m1.1a"><mrow id="alg2.9.9.m1.1.1" xref="alg2.9.9.m1.1.1.cmml"><msub id="alg2.9.9.m1.1.1.2" xref="alg2.9.9.m1.1.1.2.cmml"><mover accent="true" id="alg2.9.9.m1.1.1.2.2" xref="alg2.9.9.m1.1.1.2.2.cmml"><mi id="alg2.9.9.m1.1.1.2.2.2" xref="alg2.9.9.m1.1.1.2.2.2.cmml">θ</mi><mo id="alg2.9.9.m1.1.1.2.2.1" xref="alg2.9.9.m1.1.1.2.2.1.cmml">^</mo></mover><msub id="alg2.9.9.m1.1.1.2.3" xref="alg2.9.9.m1.1.1.2.3.cmml"><mi id="alg2.9.9.m1.1.1.2.3.2" xref="alg2.9.9.m1.1.1.2.3.2.cmml">c</mi><mrow id="alg2.9.9.m1.1.1.2.3.3" xref="alg2.9.9.m1.1.1.2.3.3.cmml"><mi id="alg2.9.9.m1.1.1.2.3.3.2" xref="alg2.9.9.m1.1.1.2.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.3.3.1" xref="alg2.9.9.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.3.3.3" xref="alg2.9.9.m1.1.1.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.3.3.1a" xref="alg2.9.9.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.3.3.4" xref="alg2.9.9.m1.1.1.2.3.3.4.cmml">w</mi></mrow></msub></msub><mo stretchy="false" id="alg2.9.9.m1.1.1.1" xref="alg2.9.9.m1.1.1.1.cmml">←</mo><mi id="alg2.9.9.m1.1.1.3" xref="alg2.9.9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.1b"><apply id="alg2.9.9.m1.1.1.cmml" xref="alg2.9.9.m1.1.1"><ci id="alg2.9.9.m1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1">←</ci><apply id="alg2.9.9.m1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.9.9.m1.1.1.2.1.cmml" xref="alg2.9.9.m1.1.1.2">subscript</csymbol><apply id="alg2.9.9.m1.1.1.2.2.cmml" xref="alg2.9.9.m1.1.1.2.2"><ci id="alg2.9.9.m1.1.1.2.2.1.cmml" xref="alg2.9.9.m1.1.1.2.2.1">^</ci><ci id="alg2.9.9.m1.1.1.2.2.2.cmml" xref="alg2.9.9.m1.1.1.2.2.2">𝜃</ci></apply><apply id="alg2.9.9.m1.1.1.2.3.cmml" xref="alg2.9.9.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.9.9.m1.1.1.2.3.1.cmml" xref="alg2.9.9.m1.1.1.2.3">subscript</csymbol><ci id="alg2.9.9.m1.1.1.2.3.2.cmml" xref="alg2.9.9.m1.1.1.2.3.2">𝑐</ci><apply id="alg2.9.9.m1.1.1.2.3.3.cmml" xref="alg2.9.9.m1.1.1.2.3.3"><times id="alg2.9.9.m1.1.1.2.3.3.1.cmml" xref="alg2.9.9.m1.1.1.2.3.3.1"></times><ci id="alg2.9.9.m1.1.1.2.3.3.2.cmml" xref="alg2.9.9.m1.1.1.2.3.3.2">𝑛</ci><ci id="alg2.9.9.m1.1.1.2.3.3.3.cmml" xref="alg2.9.9.m1.1.1.2.3.3.3">𝑒</ci><ci id="alg2.9.9.m1.1.1.2.3.3.4.cmml" xref="alg2.9.9.m1.1.1.2.3.3.4">𝑤</ci></apply></apply></apply><csymbol cd="latexml" id="alg2.9.9.m1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.1c">{\hat{\theta}_{c_{new}}}\leftarrow</annotation></semantics></math> Transmit partial model weights to the server
</div>
<div id="alg2.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>
Server assigns the <math id="alg2.10.10.m1.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="alg2.10.10.m1.1a"><msub id="alg2.10.10.m1.1.1" xref="alg2.10.10.m1.1.1.cmml"><mi id="alg2.10.10.m1.1.1.2" xref="alg2.10.10.m1.1.1.2.cmml">c</mi><mrow id="alg2.10.10.m1.1.1.3" xref="alg2.10.10.m1.1.1.3.cmml"><mi id="alg2.10.10.m1.1.1.3.2" xref="alg2.10.10.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.1" xref="alg2.10.10.m1.1.1.3.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.3" xref="alg2.10.10.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.1a" xref="alg2.10.10.m1.1.1.3.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.4" xref="alg2.10.10.m1.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.1b"><apply id="alg2.10.10.m1.1.1.cmml" xref="alg2.10.10.m1.1.1"><csymbol cd="ambiguous" id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1">subscript</csymbol><ci id="alg2.10.10.m1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.2">𝑐</ci><apply id="alg2.10.10.m1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.3"><times id="alg2.10.10.m1.1.1.3.1.cmml" xref="alg2.10.10.m1.1.1.3.1"></times><ci id="alg2.10.10.m1.1.1.3.2.cmml" xref="alg2.10.10.m1.1.1.3.2">𝑛</ci><ci id="alg2.10.10.m1.1.1.3.3.cmml" xref="alg2.10.10.m1.1.1.3.3">𝑒</ci><ci id="alg2.10.10.m1.1.1.3.4.cmml" xref="alg2.10.10.m1.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.1c">c_{new}</annotation></semantics></math> to cluster <math id="alg2.11.11.m2.1" class="ltx_Math" alttext="g_{m}" display="inline"><semantics id="alg2.11.11.m2.1a"><msub id="alg2.11.11.m2.1.1" xref="alg2.11.11.m2.1.1.cmml"><mi id="alg2.11.11.m2.1.1.2" xref="alg2.11.11.m2.1.1.2.cmml">g</mi><mi id="alg2.11.11.m2.1.1.3" xref="alg2.11.11.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.11.11.m2.1b"><apply id="alg2.11.11.m2.1.1.cmml" xref="alg2.11.11.m2.1.1"><csymbol cd="ambiguous" id="alg2.11.11.m2.1.1.1.cmml" xref="alg2.11.11.m2.1.1">subscript</csymbol><ci id="alg2.11.11.m2.1.1.2.cmml" xref="alg2.11.11.m2.1.1.2">𝑔</ci><ci id="alg2.11.11.m2.1.1.3.cmml" xref="alg2.11.11.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m2.1c">g_{m}</annotation></semantics></math>:
</div>
<div id="alg2.12.12" class="ltx_listingline">
<math id="alg2.12.12.m1.2" class="ltx_Math" alttext="{g^{*}}=\operatorname*{arg\,min}_{g_{m}}dist({\hat{\theta}_{c_{new}}},{\hat{\theta}_{g_{m}})},\&gt;{g_{m}\in{\mathcal{G}}}" display="inline"><semantics id="alg2.12.12.m1.2a"><mrow id="alg2.12.12.m1.2.2.2" xref="alg2.12.12.m1.2.2.3.cmml"><mrow id="alg2.12.12.m1.1.1.1.1" xref="alg2.12.12.m1.1.1.1.1.cmml"><msup id="alg2.12.12.m1.1.1.1.1.4" xref="alg2.12.12.m1.1.1.1.1.4.cmml"><mi id="alg2.12.12.m1.1.1.1.1.4.2" xref="alg2.12.12.m1.1.1.1.1.4.2.cmml">g</mi><mo id="alg2.12.12.m1.1.1.1.1.4.3" xref="alg2.12.12.m1.1.1.1.1.4.3.cmml">∗</mo></msup><mo id="alg2.12.12.m1.1.1.1.1.3" xref="alg2.12.12.m1.1.1.1.1.3.cmml">=</mo><mrow id="alg2.12.12.m1.1.1.1.1.2" xref="alg2.12.12.m1.1.1.1.1.2.cmml"><mrow id="alg2.12.12.m1.1.1.1.1.2.4" xref="alg2.12.12.m1.1.1.1.1.2.4.cmml"><munder id="alg2.12.12.m1.1.1.1.1.2.4.1" xref="alg2.12.12.m1.1.1.1.1.2.4.1.cmml"><mrow id="alg2.12.12.m1.1.1.1.1.2.4.1.2" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2.4.1.2.2" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.2.4.1.2.1" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.2.4.1.2.3" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.3.cmml">min</mi></mrow><msub id="alg2.12.12.m1.1.1.1.1.2.4.1.3" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2.4.1.3.2" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3.2.cmml">g</mi><mi id="alg2.12.12.m1.1.1.1.1.2.4.1.3.3" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3.3.cmml">m</mi></msub></munder><mo id="alg2.12.12.m1.1.1.1.1.2.4a" xref="alg2.12.12.m1.1.1.1.1.2.4.cmml">⁡</mo><mrow id="alg2.12.12.m1.1.1.1.1.2.4.2" xref="alg2.12.12.m1.1.1.1.1.2.4.2.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2.4.2.2" xref="alg2.12.12.m1.1.1.1.1.2.4.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.2.4.2.1" xref="alg2.12.12.m1.1.1.1.1.2.4.2.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.2.4.2.3" xref="alg2.12.12.m1.1.1.1.1.2.4.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.2.4.2.1a" xref="alg2.12.12.m1.1.1.1.1.2.4.2.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.2.4.2.4" xref="alg2.12.12.m1.1.1.1.1.2.4.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.2.4.2.1b" xref="alg2.12.12.m1.1.1.1.1.2.4.2.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.2.4.2.5" xref="alg2.12.12.m1.1.1.1.1.2.4.2.5.cmml">t</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.2.3" xref="alg2.12.12.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="alg2.12.12.m1.1.1.1.1.2.2.2" xref="alg2.12.12.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg2.12.12.m1.1.1.1.1.2.2.2.3" xref="alg2.12.12.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="alg2.12.12.m1.1.1.1.1.1.1.1.1" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.2" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.1" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><msub id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.2" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mrow id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.2" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.4" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">w</mi></mrow></msub></msub><mo id="alg2.12.12.m1.1.1.1.1.2.2.2.4" xref="alg2.12.12.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg2.12.12.m1.1.1.1.1.2.2.2.2" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.2" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mo id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.1" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><msub id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.2" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.2.cmml">g</mi><mi id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.3" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.3.cmml">m</mi></msub></msub><mo stretchy="false" id="alg2.12.12.m1.1.1.1.1.2.2.2.5" xref="alg2.12.12.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.387em" id="alg2.12.12.m1.2.2.2.3" xref="alg2.12.12.m1.2.2.3a.cmml">,</mo><mrow id="alg2.12.12.m1.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.cmml"><msub id="alg2.12.12.m1.2.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.2.cmml"><mi id="alg2.12.12.m1.2.2.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.2.2.cmml">g</mi><mi id="alg2.12.12.m1.2.2.2.2.2.3" xref="alg2.12.12.m1.2.2.2.2.2.3.cmml">m</mi></msub><mo id="alg2.12.12.m1.2.2.2.2.1" xref="alg2.12.12.m1.2.2.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.12.12.m1.2.2.2.2.3" xref="alg2.12.12.m1.2.2.2.2.3.cmml">𝒢</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.12.m1.2b"><apply id="alg2.12.12.m1.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.2.2.3a.cmml" xref="alg2.12.12.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.12.12.m1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1"><eq id="alg2.12.12.m1.1.1.1.1.3.cmml" xref="alg2.12.12.m1.1.1.1.1.3"></eq><apply id="alg2.12.12.m1.1.1.1.1.4.cmml" xref="alg2.12.12.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.4.1.cmml" xref="alg2.12.12.m1.1.1.1.1.4">superscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.4.2.cmml" xref="alg2.12.12.m1.1.1.1.1.4.2">𝑔</ci><times id="alg2.12.12.m1.1.1.1.1.4.3.cmml" xref="alg2.12.12.m1.1.1.1.1.4.3"></times></apply><apply id="alg2.12.12.m1.1.1.1.1.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2"><times id="alg2.12.12.m1.1.1.1.1.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.3"></times><apply id="alg2.12.12.m1.1.1.1.1.2.4.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4"><apply id="alg2.12.12.m1.1.1.1.1.2.4.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.2.4.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1">subscript</csymbol><apply id="alg2.12.12.m1.1.1.1.1.2.4.1.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2"><times id="alg2.12.12.m1.1.1.1.1.2.4.1.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.1"></times><ci id="alg2.12.12.m1.1.1.1.1.2.4.1.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.2">arg</ci><ci id="alg2.12.12.m1.1.1.1.1.2.4.1.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.2.3">min</ci></apply><apply id="alg2.12.12.m1.1.1.1.1.2.4.1.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.2.4.1.3.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3">subscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.2.4.1.3.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3.2">𝑔</ci><ci id="alg2.12.12.m1.1.1.1.1.2.4.1.3.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.1.3.3">𝑚</ci></apply></apply><apply id="alg2.12.12.m1.1.1.1.1.2.4.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2"><times id="alg2.12.12.m1.1.1.1.1.2.4.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2.1"></times><ci id="alg2.12.12.m1.1.1.1.1.2.4.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2.2">𝑑</ci><ci id="alg2.12.12.m1.1.1.1.1.2.4.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2.3">𝑖</ci><ci id="alg2.12.12.m1.1.1.1.1.2.4.2.4.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2.4">𝑠</ci><ci id="alg2.12.12.m1.1.1.1.1.2.4.2.5.cmml" xref="alg2.12.12.m1.1.1.1.1.2.4.2.5">𝑡</ci></apply></apply><interval closure="open" id="alg2.12.12.m1.1.1.1.1.2.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2"><apply id="alg2.12.12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2"><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.2.2">𝜃</ci></apply><apply id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.2">𝑐</ci><apply id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3"><times id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="alg2.12.12.m1.1.1.1.1.1.1.1.1.3.3.4">𝑤</ci></apply></apply></apply><apply id="alg2.12.12.m1.1.1.1.1.2.2.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.2.2.2.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2"><ci id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.2.2">𝜃</ci></apply><apply id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.2">𝑔</ci><ci id="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></apply></apply><apply id="alg2.12.12.m1.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2"><in id="alg2.12.12.m1.2.2.2.2.1.cmml" xref="alg2.12.12.m1.2.2.2.2.1"></in><apply id="alg2.12.12.m1.2.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.2.2.2.2.2.1.cmml" xref="alg2.12.12.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.12.12.m1.2.2.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2.2.2">𝑔</ci><ci id="alg2.12.12.m1.2.2.2.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2.2.2.3">𝑚</ci></apply><ci id="alg2.12.12.m1.2.2.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2.2.3">𝒢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m1.2c">{g^{*}}=\operatorname*{arg\,min}_{g_{m}}dist({\hat{\theta}_{c_{new}}},{\hat{\theta}_{g_{m}})},\&gt;{g_{m}\in{\mathcal{G}}}</annotation></semantics></math> 
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.14.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Incorporating Newcomers</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Incorporating Newcomers</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In reality, client devices may join in or drop out of the federated learning process due to unreliable client communications or other resource limitations. Clients who quit the training have no impact on the model training of their respective clusters. However, it is important to carefully incorporate newcomer clients into appropriate clusters in order to maintain the scalability of our method. <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">FedClust</span> offers an elegant approach to accommodate newcomers who join after the federation procedure to learn their personalized model. The baseline methods except <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">PACFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Vahidian et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> did not clarify the process of incorporating newcomer clients during federation. We outlined the process of how <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">FedClust</span> integrates new participants who joined after the end of the federation in Algorithm 2.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.6" class="ltx_p">Clients who are not in the existing client set are referred to as newcomers. In order to assign each new client <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.1" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.1a" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.4" xref="S4.SS2.p2.1.m1.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑐</ci><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><times id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.1.m1.1.1.3.4.cmml" xref="S4.SS2.p2.1.m1.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">c_{new}</annotation></semantics></math> into a suitable cluster, <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1a" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.4" xref="S4.SS2.p2.2.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑐</ci><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><times id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">c_{new}</annotation></semantics></math> is required to train the initial server model <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\theta^{0}_{s}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msubsup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">θ</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">s</mi><mn id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝜃</ci><cn type="integer" id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">0</cn></apply><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\theta^{0}_{s}</annotation></semantics></math> on its local data, and then sends partially selected weights to the server. <span id="S4.SS2.p2.6.1" class="ltx_text ltx_font_italic">FedClust</span> stores a copy of each cluster’s partial model weights. After receiving the partial model weights from new client <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1a" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.4" xref="S4.SS2.p2.4.m4.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑐</ci><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><times id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3.1"></times><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.4.m4.1.1.3.4.cmml" xref="S4.SS2.p2.4.m4.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">c_{new}</annotation></semantics></math>, the server computes the model distances between the new client <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1a" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.4" xref="S4.SS2.p2.5.m5.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝑐</ci><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><times id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3.1"></times><ci id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.5.m5.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.5.m5.1.1.3.4.cmml" xref="S4.SS2.p2.5.m5.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">c_{new}</annotation></semantics></math>’s model and the models of existing clusters. The cluster with the minimum model distance will be selected as the cluster for <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="c_{new}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.3.2" xref="S4.SS2.p2.6.m6.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.3" xref="S4.SS2.p2.6.m6.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1a" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.4" xref="S4.SS2.p2.6.m6.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝑐</ci><apply id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><times id="S4.SS2.p2.6.m6.1.1.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3.1"></times><ci id="S4.SS2.p2.6.m6.1.1.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.6.m6.1.1.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.6.m6.1.1.3.4.cmml" xref="S4.SS2.p2.6.m6.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">c_{new}</annotation></semantics></math>, represented as follows.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_math_unparsed" alttext="{g^{*}}=\operatorname*{arg\,min}_{g_{m}}dist({\hat{\theta}_{c_{new}}},{\hat{\theta}_{g_{m})},\&gt;{g_{m}\in{\mathcal{G}}}}" display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1b"><msup id="S4.E4.m1.1.1"><mi id="S4.E4.m1.1.1.2">g</mi><mo id="S4.E4.m1.1.1.3">∗</mo></msup><mo id="S4.E4.m1.1.2">=</mo><munder id="S4.E4.m1.1.3"><mrow id="S4.E4.m1.1.3.2"><mi id="S4.E4.m1.1.3.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E4.m1.1.3.2.1">​</mo><mi id="S4.E4.m1.1.3.2.3">min</mi></mrow><msub id="S4.E4.m1.1.3.3"><mi id="S4.E4.m1.1.3.3.2">g</mi><mi id="S4.E4.m1.1.3.3.3">m</mi></msub></munder><mi id="S4.E4.m1.1.4">d</mi><mi id="S4.E4.m1.1.5">i</mi><mi id="S4.E4.m1.1.6">s</mi><mi id="S4.E4.m1.1.7">t</mi><mrow id="S4.E4.m1.1.8"><mo stretchy="false" id="S4.E4.m1.1.8.1">(</mo><msub id="S4.E4.m1.1.8.2"><mover accent="true" id="S4.E4.m1.1.8.2.2"><mi id="S4.E4.m1.1.8.2.2.2">θ</mi><mo id="S4.E4.m1.1.8.2.2.1">^</mo></mover><msub id="S4.E4.m1.1.8.2.3"><mi id="S4.E4.m1.1.8.2.3.2">c</mi><mrow id="S4.E4.m1.1.8.2.3.3"><mi id="S4.E4.m1.1.8.2.3.3.2">n</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.8.2.3.3.1">​</mo><mi id="S4.E4.m1.1.8.2.3.3.3">e</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.8.2.3.3.1a">​</mo><mi id="S4.E4.m1.1.8.2.3.3.4">w</mi></mrow></msub></msub><mo id="S4.E4.m1.1.8.3">,</mo><msub id="S4.E4.m1.1.8.4"><mover accent="true" id="S4.E4.m1.1.8.4.2"><mi id="S4.E4.m1.1.8.4.2.2">θ</mi><mo id="S4.E4.m1.1.8.4.2.1">^</mo></mover><mrow id="S4.E4.m1.1.8.4.3"><msub id="S4.E4.m1.1.8.4.3.1"><mi id="S4.E4.m1.1.8.4.3.1.2">g</mi><mi id="S4.E4.m1.1.8.4.3.1.3">m</mi></msub><mo stretchy="false" id="S4.E4.m1.1.8.4.3.2">)</mo></mrow></msub><mo rspace="0.387em" id="S4.E4.m1.1.8.5">,</mo><msub id="S4.E4.m1.1.8.6"><mi id="S4.E4.m1.1.8.6.2">g</mi><mi id="S4.E4.m1.1.8.6.3">m</mi></msub><mo id="S4.E4.m1.1.8.7">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.8.8">𝒢</mi></mrow></mrow><annotation encoding="application/x-tex" id="S4.E4.m1.1c">{g^{*}}=\operatorname*{arg\,min}_{g_{m}}dist({\hat{\theta}_{c_{new}}},{\hat{\theta}_{g_{m})},\&gt;{g_{m}\in{\mathcal{G}}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets and Models.</span>
We evaluate the performance of <span id="S5.SS1.p1.1.2" class="ltx_text ltx_font_italic">FedClust</span> on different image classification tasks using four popular benchmark datasets, i.e., CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite>, CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite>, Fashion MNIST (FMNIST) <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2017</a>)</cite>, and SVHN <cite class="ltx_cite ltx_citemacro_citep">(Netzer et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2011</a>)</cite>. To imitate non-IID scenarios, we consider three different data heterogeneity settings for each dataset as in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>, i.e., Non-IID label skew (20%), Non-IID label skew (30%), and Non-IID Dir (0.1). In our experiments, we consider LeNet-5 <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">1989</a>)</cite> architecture for CIFAR-10, FMNIST, and SVHN datasets and ResNet-9 <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> architecture for CIFAR-100 dataset.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Baselines Methods.</span> To demonstrate the performance of the proposed method, we compare the results of <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_italic">FedClust</span> against the following state-of-the-art (SOTA) FL baselines. We consider <span id="S5.SS1.p2.1.3" class="ltx_text ltx_font_italic">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>, <span id="S5.SS1.p2.1.4" class="ltx_text ltx_font_italic">FedNova</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2020b</a>)</cite>, and <span id="S5.SS1.p2.1.5" class="ltx_text ltx_font_italic">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> for baselines that train a single global model across all clients. Baselines for SOTA CFL methods include <span id="S5.SS1.p2.1.6" class="ltx_text ltx_font_italic">IFCA</span> <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, <span id="S5.SS1.p2.1.7" class="ltx_text ltx_font_italic">PACFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Vahidian et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> and Clustered-FL (<span id="S5.SS1.p2.1.8" class="ltx_text ltx_font_italic">CFL</span>) <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>. SOTA personalized FL methods include <span id="S5.SS1.p2.1.9" class="ltx_text ltx_font_italic">Per-FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(Fallah et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> and <span id="S5.SS1.p2.1.10" class="ltx_text ltx_font_italic">LG-FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>. In addition, we compare our results with another baseline named <span id="S5.SS1.p2.1.11" class="ltx_text ltx_font_italic">Local</span>, where each client independently trains a model on its local data without any communication with others.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Implementation.</span> We have implemented <span id="S5.SS1.p3.1.2" class="ltx_text ltx_font_italic">FedClust</span> and the baseline methods in PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite>. We assume 100 clients are available for all experiments and 10% of them are sampled randomly in each communication round. We ran each experiment 3 times for 200 communication rounds. We execute all experiments on a server, which is equipped with NVIDIA GeForce RTX 3080Ti GPU, Intel(R) Core(TM) i9-10900X CPU, and 64G RAM. We emulate both the server and clients on the same machine, substantiated by the fact that the performance metrics we consider remain unaffected by the physical location of the server and clients. The wall-clock training time may be affected but this metric is beyond our scope of focus, similar to our counterparts.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.4" class="ltx_p"><span id="S5.SS1.p4.4.1" class="ltx_text ltx_font_bold">Hyperparameters Settings.</span>
In all of our experiments, we use SGD as the local optimizer with the local epoch of 10, and the local batch size of 10. We initialize the models randomly in <span id="S5.SS1.p4.4.2" class="ltx_text ltx_font_italic">LG-FedAvg</span> for a fair comparison instead of using the model produced after many rounds of <span id="S5.SS1.p4.4.3" class="ltx_text ltx_font_italic">FedAvg</span>. For <span id="S5.SS1.p4.4.4" class="ltx_text ltx_font_italic">IFCA</span> and <span id="S5.SS1.p4.4.5" class="ltx_text ltx_font_italic">CFL</span>, we used the same number of clusters as mentioned in the original papers. For <span id="S5.SS1.p4.4.6" class="ltx_text ltx_font_italic">PACFL</span>, we used p = 3 in all of our experiments. The learning rate for <span id="S5.SS1.p4.4.7" class="ltx_text ltx_font_italic">FedAvg</span>, <span id="S5.SS1.p4.4.8" class="ltx_text ltx_font_italic">FedProx</span>, <span id="S5.SS1.p4.4.9" class="ltx_text ltx_font_italic">FedNova</span>, and <span id="S5.SS1.p4.4.10" class="ltx_text ltx_font_italic">CFL</span> was set to (0.1, 0.01, 0.001), while for other baselines, it was 0.01. Momentum was 0.9 for <span id="S5.SS1.p4.4.11" class="ltx_text ltx_font_italic">FedAvg</span>, <span id="S5.SS1.p4.4.12" class="ltx_text ltx_font_italic">FedProx</span>, and <span id="S5.SS1.p4.4.13" class="ltx_text ltx_font_italic">FedNova</span>, whereas for other methods, it was 0.5. In <span id="S5.SS1.p4.4.14" class="ltx_text ltx_font_italic">LG</span>, the number of local layers and global layers were set to 3 and 2. In <span id="S5.SS1.p4.4.15" class="ltx_text ltx_font_italic">Per-FedAvg</span>, we used <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="\alpha=1e-2" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml"><mi id="S5.SS1.p4.1.m1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS1.p4.1.m1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS1.p4.1.m1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.3.cmml"><mrow id="S5.SS1.p4.1.m1.1.1.3.2" xref="S5.SS1.p4.1.m1.1.1.3.2.cmml"><mn id="S5.SS1.p4.1.m1.1.1.3.2.2" xref="S5.SS1.p4.1.m1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS1.p4.1.m1.1.1.3.2.1" xref="S5.SS1.p4.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p4.1.m1.1.1.3.2.3" xref="S5.SS1.p4.1.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="S5.SS1.p4.1.m1.1.1.3.1" xref="S5.SS1.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S5.SS1.p4.1.m1.1.1.3.3" xref="S5.SS1.p4.1.m1.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1"><eq id="S5.SS1.p4.1.m1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1.1"></eq><ci id="S5.SS1.p4.1.m1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2">𝛼</ci><apply id="S5.SS1.p4.1.m1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3"><minus id="S5.SS1.p4.1.m1.1.1.3.1.cmml" xref="S5.SS1.p4.1.m1.1.1.3.1"></minus><apply id="S5.SS1.p4.1.m1.1.1.3.2.cmml" xref="S5.SS1.p4.1.m1.1.1.3.2"><times id="S5.SS1.p4.1.m1.1.1.3.2.1.cmml" xref="S5.SS1.p4.1.m1.1.1.3.2.1"></times><cn type="integer" id="S5.SS1.p4.1.m1.1.1.3.2.2.cmml" xref="S5.SS1.p4.1.m1.1.1.3.2.2">1</cn><ci id="S5.SS1.p4.1.m1.1.1.3.2.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS1.p4.1.m1.1.1.3.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\alpha=1e-2</annotation></semantics></math> and <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="\beta=1e-3" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mrow id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml"><mi id="S5.SS1.p4.2.m2.1.1.2" xref="S5.SS1.p4.2.m2.1.1.2.cmml">β</mi><mo id="S5.SS1.p4.2.m2.1.1.1" xref="S5.SS1.p4.2.m2.1.1.1.cmml">=</mo><mrow id="S5.SS1.p4.2.m2.1.1.3" xref="S5.SS1.p4.2.m2.1.1.3.cmml"><mrow id="S5.SS1.p4.2.m2.1.1.3.2" xref="S5.SS1.p4.2.m2.1.1.3.2.cmml"><mn id="S5.SS1.p4.2.m2.1.1.3.2.2" xref="S5.SS1.p4.2.m2.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS1.p4.2.m2.1.1.3.2.1" xref="S5.SS1.p4.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p4.2.m2.1.1.3.2.3" xref="S5.SS1.p4.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S5.SS1.p4.2.m2.1.1.3.1" xref="S5.SS1.p4.2.m2.1.1.3.1.cmml">−</mo><mn id="S5.SS1.p4.2.m2.1.1.3.3" xref="S5.SS1.p4.2.m2.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><apply id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1"><eq id="S5.SS1.p4.2.m2.1.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1.1"></eq><ci id="S5.SS1.p4.2.m2.1.1.2.cmml" xref="S5.SS1.p4.2.m2.1.1.2">𝛽</ci><apply id="S5.SS1.p4.2.m2.1.1.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3"><minus id="S5.SS1.p4.2.m2.1.1.3.1.cmml" xref="S5.SS1.p4.2.m2.1.1.3.1"></minus><apply id="S5.SS1.p4.2.m2.1.1.3.2.cmml" xref="S5.SS1.p4.2.m2.1.1.3.2"><times id="S5.SS1.p4.2.m2.1.1.3.2.1.cmml" xref="S5.SS1.p4.2.m2.1.1.3.2.1"></times><cn type="integer" id="S5.SS1.p4.2.m2.1.1.3.2.2.cmml" xref="S5.SS1.p4.2.m2.1.1.3.2.2">1</cn><ci id="S5.SS1.p4.2.m2.1.1.3.2.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS1.p4.2.m2.1.1.3.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">\beta=1e-3</annotation></semantics></math>. For <span id="S5.SS1.p4.4.16" class="ltx_text ltx_font_italic">CFL</span>, the values of <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="\epsilon_{1}" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><msub id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml"><mi id="S5.SS1.p4.3.m3.1.1.2" xref="S5.SS1.p4.3.m3.1.1.2.cmml">ϵ</mi><mn id="S5.SS1.p4.3.m3.1.1.3" xref="S5.SS1.p4.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><apply id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.3.m3.1.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p4.3.m3.1.1.2.cmml" xref="S5.SS1.p4.3.m3.1.1.2">italic-ϵ</ci><cn type="integer" id="S5.SS1.p4.3.m3.1.1.3.cmml" xref="S5.SS1.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">\epsilon_{1}</annotation></semantics></math> and <math id="S5.SS1.p4.4.m4.1" class="ltx_Math" alttext="\epsilon_{2}" display="inline"><semantics id="S5.SS1.p4.4.m4.1a"><msub id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml"><mi id="S5.SS1.p4.4.m4.1.1.2" xref="S5.SS1.p4.4.m4.1.1.2.cmml">ϵ</mi><mn id="S5.SS1.p4.4.m4.1.1.3" xref="S5.SS1.p4.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.1b"><apply id="S5.SS1.p4.4.m4.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p4.4.m4.1.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p4.4.m4.1.1.2.cmml" xref="S5.SS1.p4.4.m4.1.1.2">italic-ϵ</ci><cn type="integer" id="S5.SS1.p4.4.m4.1.1.3.cmml" xref="S5.SS1.p4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.1c">\epsilon_{2}</annotation></semantics></math> were 0.4 and 0.6, respectively.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p"><span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> We use the average of the final local test accuracy over all clients and the number of communication rounds required to reach a certain level of model accuracy as the performance metrics. In general, it is desirable to achieve higher model accuracy with fewer communication rounds. We also consider the required communication costs to reach a target accuracy.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Test accuracy comparisons of different approaches over different datasets for Non-IID label skew of 20%</figcaption>
<div id="S5.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:224.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(25.8pt,-13.4pt) scale(1.13502959182068,1.13502959182068) ;">
<table id="S5.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.1.1.1" class="ltx_text" style="font-size:120%;">Method</span></th>
<th id="S5.T1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.1.2.1" class="ltx_text" style="font-size:120%;">CIFAR-10</span></th>
<th id="S5.T1.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.1.3.1" class="ltx_text" style="font-size:120%;">CIFAR-100</span></th>
<th id="S5.T1.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.1.4.1" class="ltx_text" style="font-size:120%;">FMNIST</span></th>
<th id="S5.T1.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.1.5.1" class="ltx_text" style="font-size:120%;">SVHN</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1.2.1" class="ltx_tr">
<td id="S5.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.1.1" class="ltx_text" style="font-size:120%;">Local</span></td>
<td id="S5.T1.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.2.1" class="ltx_text" style="font-size:120%;">79.68 ± 1.32</span></td>
<td id="S5.T1.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.3.1" class="ltx_text" style="font-size:120%;">33.18 ± 0.41</span></td>
<td id="S5.T1.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.4.1" class="ltx_text" style="font-size:120%;">95.68 ± 0.84</span></td>
<td id="S5.T1.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.5.1" class="ltx_text" style="font-size:120%;">80.29 ± 1.61</span></td>
</tr>
<tr id="S5.T1.1.1.3.2" class="ltx_tr">
<td id="S5.T1.1.1.3.2.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.2.1.1" class="ltx_text" style="font-size:120%;">FedAvg</span></td>
<td id="S5.T1.1.1.3.2.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.2.2.1" class="ltx_text" style="font-size:120%;">50.27 ± 2.63</span></td>
<td id="S5.T1.1.1.3.2.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.2.3.1" class="ltx_text" style="font-size:120%;">53.67 ± 0.63</span></td>
<td id="S5.T1.1.1.3.2.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.2.4.1" class="ltx_text" style="font-size:120%;">77.10 ± 3.29</span></td>
<td id="S5.T1.1.1.3.2.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.2.5.1" class="ltx_text" style="font-size:120%;">81.36 ± 0.64</span></td>
</tr>
<tr id="S5.T1.1.1.4.3" class="ltx_tr">
<td id="S5.T1.1.1.4.3.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.3.1.1" class="ltx_text" style="font-size:120%;">FedProx</span></td>
<td id="S5.T1.1.1.4.3.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.3.2.1" class="ltx_text" style="font-size:120%;">51.60 ± 1.40</span></td>
<td id="S5.T1.1.1.4.3.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.3.3.1" class="ltx_text" style="font-size:120%;">54.28 ± 0.76</span></td>
<td id="S5.T1.1.1.4.3.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.3.4.1" class="ltx_text" style="font-size:120%;">74.53 ± 2.16</span></td>
<td id="S5.T1.1.1.4.3.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.3.5.1" class="ltx_text" style="font-size:120%;">79.64 ± 0.80</span></td>
</tr>
<tr id="S5.T1.1.1.5.4" class="ltx_tr">
<td id="S5.T1.1.1.5.4.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.4.1.1" class="ltx_text" style="font-size:120%;">FedNova</span></td>
<td id="S5.T1.1.1.5.4.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.4.2.1" class="ltx_text" style="font-size:120%;">47.38 ± 2.08</span></td>
<td id="S5.T1.1.1.5.4.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.4.3.1" class="ltx_text" style="font-size:120%;">53.90 ± 0.38</span></td>
<td id="S5.T1.1.1.5.4.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.4.4.1" class="ltx_text" style="font-size:120%;">71.33 ± 4.50</span></td>
<td id="S5.T1.1.1.5.4.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.4.5.1" class="ltx_text" style="font-size:120%;">75.56 ± 3.07</span></td>
</tr>
<tr id="S5.T1.1.1.6.5" class="ltx_tr">
<td id="S5.T1.1.1.6.5.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.5.1.1" class="ltx_text" style="font-size:120%;">LG</span></td>
<td id="S5.T1.1.1.6.5.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.5.2.1" class="ltx_text" style="font-size:120%;">85.49 ± 0.87</span></td>
<td id="S5.T1.1.1.6.5.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.5.3.1" class="ltx_text" style="font-size:120%;">54.15 ± 0.29</span></td>
<td id="S5.T1.1.1.6.5.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.5.4.1" class="ltx_text" style="font-size:120%;">95.49 ± 0.75</span></td>
<td id="S5.T1.1.1.6.5.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.5.5.1" class="ltx_text" style="font-size:120%;">91.59 ± 0.42</span></td>
</tr>
<tr id="S5.T1.1.1.7.6" class="ltx_tr">
<td id="S5.T1.1.1.7.6.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.7.6.1.1" class="ltx_text" style="font-size:120%;">PerFedAvg</span></td>
<td id="S5.T1.1.1.7.6.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.7.6.2.1" class="ltx_text" style="font-size:120%;">85.80 ± 0.58</span></td>
<td id="S5.T1.1.1.7.6.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.7.6.3.1" class="ltx_text" style="font-size:120%;">61.29 ± 0.42</span></td>
<td id="S5.T1.1.1.7.6.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.7.6.4.1" class="ltx_text" style="font-size:120%;">95.78 ± 1.28</span></td>
<td id="S5.T1.1.1.7.6.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.7.6.5.1" class="ltx_text" style="font-size:120%;">92.87 ± 1.92</span></td>
</tr>
<tr id="S5.T1.1.1.8.7" class="ltx_tr">
<td id="S5.T1.1.1.8.7.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.8.7.1.1" class="ltx_text" style="font-size:120%;">CFL</span></td>
<td id="S5.T1.1.1.8.7.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.8.7.2.1" class="ltx_text" style="font-size:120%;">51.86 ± 1.31</span></td>
<td id="S5.T1.1.1.8.7.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.8.7.3.1" class="ltx_text" style="font-size:120%;">41.28 ± 1.75</span></td>
<td id="S5.T1.1.1.8.7.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.8.7.4.1" class="ltx_text" style="font-size:120%;">78.44 ± 2.38</span></td>
<td id="S5.T1.1.1.8.7.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.8.7.5.1" class="ltx_text" style="font-size:120%;">73.59 ± 1.86</span></td>
</tr>
<tr id="S5.T1.1.1.9.8" class="ltx_tr">
<td id="S5.T1.1.1.9.8.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.9.8.1.1" class="ltx_text" style="font-size:120%;">IFCA</span></td>
<td id="S5.T1.1.1.9.8.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.9.8.2.1" class="ltx_text" style="font-size:120%;">87.19 ± 0.19</span></td>
<td id="S5.T1.1.1.9.8.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.9.8.3.1" class="ltx_text" style="font-size:120%;">70.35 ± 0.28</span></td>
<td id="S5.T1.1.1.9.8.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.9.8.4.1" class="ltx_text" style="font-size:120%;">96.83 ± 0.24</span></td>
<td id="S5.T1.1.1.9.8.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.9.8.5.1" class="ltx_text" style="font-size:120%;">94.76 ± 0.19</span></td>
</tr>
<tr id="S5.T1.1.1.10.9" class="ltx_tr">
<td id="S5.T1.1.1.10.9.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.10.9.1.1" class="ltx_text" style="font-size:120%;">PACFL</span></td>
<td id="S5.T1.1.1.10.9.2" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.10.9.2.1" class="ltx_text" style="font-size:120%;">88.40 ± 0.48</span></td>
<td id="S5.T1.1.1.10.9.3" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.10.9.3.1" class="ltx_text" style="font-size:120%;">71.06 ± 0.39</span></td>
<td id="S5.T1.1.1.10.9.4" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.10.9.4.1" class="ltx_text" style="font-size:120%;">97.46 ± 0.13</span></td>
<td id="S5.T1.1.1.10.9.5" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.10.9.5.1" class="ltx_text" style="font-size:120%;">95.48 ± 0.27</span></td>
</tr>
<tr id="S5.T1.1.1.11.10" class="ltx_tr">
<td id="S5.T1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T1.1.1.11.10.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">FedClust</span></td>
<td id="S5.T1.1.1.11.10.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T1.1.1.11.10.2.1" class="ltx_text ltx_font_bold" style="font-size:120%;">95.82 ± 0.17</span></td>
<td id="S5.T1.1.1.11.10.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T1.1.1.11.10.3.1" class="ltx_text ltx_font_bold" style="font-size:120%;">73.38 ± 0.24</span></td>
<td id="S5.T1.1.1.11.10.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T1.1.1.11.10.4.1" class="ltx_text ltx_font_bold" style="font-size:120%;">97.92 ± 0.18</span></td>
<td id="S5.T1.1.1.11.10.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T1.1.1.11.10.5.1" class="ltx_text ltx_font_bold" style="font-size:120%;">95.86 ± 0.11</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Test accuracy comparisons of different approaches over different datasets for Non-IID label skew of 30%</figcaption>
<div id="S5.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:224.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(25.8pt,-13.4pt) scale(1.13502959182068,1.13502959182068) ;">
<table id="S5.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.1.1.1.1.1.1" class="ltx_text" style="font-size:120%;">Method</span></th>
<th id="S5.T2.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.1.1.1.1.2.1" class="ltx_text" style="font-size:120%;">CIFAR-10</span></th>
<th id="S5.T2.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.1.1.1.1.3.1" class="ltx_text" style="font-size:120%;">CIFAR-100</span></th>
<th id="S5.T2.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.1.1.1.1.4.1" class="ltx_text" style="font-size:120%;">FMNIST</span></th>
<th id="S5.T2.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.1.1.1.1.5.1" class="ltx_text" style="font-size:120%;">SVHN</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.2.1" class="ltx_tr">
<td id="S5.T2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.1.2.1.1.1" class="ltx_text" style="font-size:120%;">Local</span></td>
<td id="S5.T2.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.1.2.1.2.1" class="ltx_text" style="font-size:120%;">66.51 ± 0.92</span></td>
<td id="S5.T2.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.1.2.1.3.1" class="ltx_text" style="font-size:120%;">23.76 ± 0.84</span></td>
<td id="S5.T2.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.1.2.1.4.1" class="ltx_text" style="font-size:120%;">92.51 ± 0.24</span></td>
<td id="S5.T2.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.1.1.2.1.5.1" class="ltx_text" style="font-size:120%;">68.84 ± 2.86</span></td>
</tr>
<tr id="S5.T2.1.1.3.2" class="ltx_tr">
<td id="S5.T2.1.1.3.2.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.3.2.1.1" class="ltx_text" style="font-size:120%;">FedAvg</span></td>
<td id="S5.T2.1.1.3.2.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.3.2.2.1" class="ltx_text" style="font-size:120%;">57.79 ± 1.08</span></td>
<td id="S5.T2.1.1.3.2.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.3.2.3.1" class="ltx_text" style="font-size:120%;">54.79 ± 0.56</span></td>
<td id="S5.T2.1.1.3.2.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.3.2.4.1" class="ltx_text" style="font-size:120%;">79.90 ± 1.81</span></td>
<td id="S5.T2.1.1.3.2.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.3.2.5.1" class="ltx_text" style="font-size:120%;">82.58 ± 0.75</span></td>
</tr>
<tr id="S5.T2.1.1.4.3" class="ltx_tr">
<td id="S5.T2.1.1.4.3.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.4.3.1.1" class="ltx_text" style="font-size:120%;">FedProx</span></td>
<td id="S5.T2.1.1.4.3.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.4.3.2.1" class="ltx_text" style="font-size:120%;">56.92 ± 1.26</span></td>
<td id="S5.T2.1.1.4.3.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.4.3.3.1" class="ltx_text" style="font-size:120%;">53.65 ± 0.60</span></td>
<td id="S5.T2.1.1.4.3.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.4.3.4.1" class="ltx_text" style="font-size:120%;">81.53 ± 1.48</span></td>
<td id="S5.T2.1.1.4.3.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.4.3.5.1" class="ltx_text" style="font-size:120%;">82.91 ± 1.30</span></td>
</tr>
<tr id="S5.T2.1.1.5.4" class="ltx_tr">
<td id="S5.T2.1.1.5.4.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.5.4.1.1" class="ltx_text" style="font-size:120%;">FedNova</span></td>
<td id="S5.T2.1.1.5.4.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.5.4.2.1" class="ltx_text" style="font-size:120%;">54.15 ± 1.31</span></td>
<td id="S5.T2.1.1.5.4.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.5.4.3.1" class="ltx_text" style="font-size:120%;">54.11 ± 0.95</span></td>
<td id="S5.T2.1.1.5.4.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.5.4.4.1" class="ltx_text" style="font-size:120%;">78.02 ± 2.08</span></td>
<td id="S5.T2.1.1.5.4.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.5.4.5.1" class="ltx_text" style="font-size:120%;">80.26 ± 1.49</span></td>
</tr>
<tr id="S5.T2.1.1.6.5" class="ltx_tr">
<td id="S5.T2.1.1.6.5.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.6.5.1.1" class="ltx_text" style="font-size:120%;">LG</span></td>
<td id="S5.T2.1.1.6.5.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.6.5.2.1" class="ltx_text" style="font-size:120%;">75.42 ± 0.41</span></td>
<td id="S5.T2.1.1.6.5.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.6.5.3.1" class="ltx_text" style="font-size:120%;">36.78 ± 0.68</span></td>
<td id="S5.T2.1.1.6.5.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.6.5.4.1" class="ltx_text" style="font-size:120%;">94.54 ± 0.48</span></td>
<td id="S5.T2.1.1.6.5.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.6.5.5.1" class="ltx_text" style="font-size:120%;">88.07 ± 0.65</span></td>
</tr>
<tr id="S5.T2.1.1.7.6" class="ltx_tr">
<td id="S5.T2.1.1.7.6.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.7.6.1.1" class="ltx_text" style="font-size:120%;">PerFedAvg</span></td>
<td id="S5.T2.1.1.7.6.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.7.6.2.1" class="ltx_text" style="font-size:120%;">78.67 ± 0.32</span></td>
<td id="S5.T2.1.1.7.6.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.7.6.3.1" class="ltx_text" style="font-size:120%;">57.02 ± 0.49</span></td>
<td id="S5.T2.1.1.7.6.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.7.6.4.1" class="ltx_text" style="font-size:120%;">92.35 ± 1.70</span></td>
<td id="S5.T2.1.1.7.6.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.7.6.5.1" class="ltx_text" style="font-size:120%;">92.10 ± 1.27</span></td>
</tr>
<tr id="S5.T2.1.1.8.7" class="ltx_tr">
<td id="S5.T2.1.1.8.7.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.7.1.1" class="ltx_text" style="font-size:120%;">CFL</span></td>
<td id="S5.T2.1.1.8.7.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.7.2.1" class="ltx_text" style="font-size:120%;">52.03 ± 2.84</span></td>
<td id="S5.T2.1.1.8.7.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.7.3.1" class="ltx_text" style="font-size:120%;">35.73 ± 2.14</span></td>
<td id="S5.T2.1.1.8.7.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.7.4.1" class="ltx_text" style="font-size:120%;">78.38 ± 0.42</span></td>
<td id="S5.T2.1.1.8.7.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.7.5.1" class="ltx_text" style="font-size:120%;">74.02 ± 3.90</span></td>
</tr>
<tr id="S5.T2.1.1.9.8" class="ltx_tr">
<td id="S5.T2.1.1.9.8.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.8.1.1" class="ltx_text" style="font-size:120%;">IFCA</span></td>
<td id="S5.T2.1.1.9.8.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.8.2.1" class="ltx_text" style="font-size:120%;">80.21 ± 0.16</span></td>
<td id="S5.T2.1.1.9.8.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.8.3.1" class="ltx_text" style="font-size:120%;">66.21 ± 0.21</span></td>
<td id="S5.T2.1.1.9.8.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.8.4.1" class="ltx_text" style="font-size:120%;">95.29 ± 0.19</span></td>
<td id="S5.T2.1.1.9.8.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.8.5.1" class="ltx_text" style="font-size:120%;">92.87 ± 0.14</span></td>
</tr>
<tr id="S5.T2.1.1.10.9" class="ltx_tr">
<td id="S5.T2.1.1.10.9.1" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.10.9.1.1" class="ltx_text" style="font-size:120%;">PACFL</span></td>
<td id="S5.T2.1.1.10.9.2" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.10.9.2.1" class="ltx_text" style="font-size:120%;">82.35 ± 0.27</span></td>
<td id="S5.T2.1.1.10.9.3" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.10.9.3.1" class="ltx_text" style="font-size:120%;">65.91 ± 0.17</span></td>
<td id="S5.T2.1.1.10.9.4" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.10.9.4.1" class="ltx_text" style="font-size:120%;">95.43 ± 0.07</span></td>
<td id="S5.T2.1.1.10.9.5" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.10.9.5.1" class="ltx_text" style="font-size:120%;">93.05 ± 0.18</span></td>
</tr>
<tr id="S5.T2.1.1.11.10" class="ltx_tr">
<td id="S5.T2.1.1.11.10.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.1.11.10.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">FedClust</span></td>
<td id="S5.T2.1.1.11.10.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.1.11.10.2.1" class="ltx_text ltx_font_bold" style="font-size:120%;">83.21 ± 0.25</span></td>
<td id="S5.T2.1.1.11.10.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.1.11.10.3.1" class="ltx_text ltx_font_bold" style="font-size:120%;">68.33 ± 0.19</span></td>
<td id="S5.T2.1.1.11.10.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.1.11.10.4.1" class="ltx_text ltx_font_bold" style="font-size:120%;">95.70 ± 0.09</span></td>
<td id="S5.T2.1.1.11.10.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.1.1.11.10.5.1" class="ltx_text ltx_font_bold" style="font-size:120%;">93.17 ± 0.04</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Results and Analysis</h3>

<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x6.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x7.png" id="S5.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x8.png" id="S5.F3.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x9.png" id="S5.F3.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Test accuracy versus the number of communication rounds for Non-IID label skew of 20%. FedClust converges faster to reach target accuracy and consistently outperforms other baselines. </figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Performance comparisons.</span>
We compare <span id="S5.SS2.p1.1.2" class="ltx_text ltx_font_italic">FedClust</span> with other SOTA baseline methods under two different widely used Non-IID settings, i.e. Non-IID label skew, and Non-IID Dirichlet label skew <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>. We consider two different Non-IID label skew settings 20% and 30%. In both settings, we start by randomly assigning <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\delta</annotation></semantics></math>% of the total available labels of a dataset to each client and then randomly distributing the samples of each label among clients who own these labels. In Non-IID Dirichlet label skew settings, we assign training data to clients according to the Dirichlet distribution similar to <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>. We run each experiment three times for 200 communication rounds with a local epoch of 10 and report the mean and standard deviation of the average of final local test accuracy.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Table 1, 2, and 3 show the performance comparisons among all approaches under Non-IID label skew (20%), Non-IID label skew (30%), and Non-IID Dir (0.1) settings, respectively. The results show that global FL baselines, i.e. <span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_italic">FedAvg</span>, <span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_italic">FedProx</span>, and <span id="S5.SS2.p2.1.3" class="ltx_text ltx_font_italic">FedNova</span> provide poor performance in all scenarios due to the model drift and weight divergence issues. <span id="S5.SS2.p2.1.4" class="ltx_text ltx_font_italic">Local</span> without any communications costs even perform better than global FL baselines. However, individual clients may not have enough data and thus clustering could be a promising solution. <span id="S5.SS2.p2.1.5" class="ltx_text ltx_font_italic">FedClust</span> consistently demonstrates superior performance compared to SOTA baselines on all datasets for different data heterogeneity settings. In particular, focusing on the CIFAR-10 Non-IID label skew (20%) setup, <span id="S5.SS2.p2.1.6" class="ltx_text ltx_font_italic">FedClust</span> outperforms all SOTA global baseline methods (by +45.5%, +44%, +48.5% for <span id="S5.SS2.p2.1.7" class="ltx_text ltx_font_italic">FedAvg</span>, <span id="S5.SS2.p2.1.8" class="ltx_text ltx_font_italic">FedProx</span>, <span id="S5.SS2.p2.1.9" class="ltx_text ltx_font_italic">FedNova</span>) as well as personalized approaches (by +44%, +10%, +10%, +8.5%, +7% for <span id="S5.SS2.p2.1.10" class="ltx_text ltx_font_italic">CFL</span>, <span id="S5.SS2.p2.1.11" class="ltx_text ltx_font_italic">LG</span>, <span id="S5.SS2.p2.1.12" class="ltx_text ltx_font_italic">PerFedAvg</span>, <span id="S5.SS2.p2.1.13" class="ltx_text ltx_font_italic">IFCA</span>, <span id="S5.SS2.p2.1.14" class="ltx_text ltx_font_italic">PACFL</span>). We tuned the hyperparameters for each baseline in order to achieve the optimal outcome.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Test accuracy comparisons of different approaches over different datasets for Non-IID Dir (0.1)</figcaption>
<div id="S5.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:224.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(25.8pt,-13.4pt) scale(1.13502959182068,1.13502959182068) ;">
<table id="S5.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.1.1.1.1.1.1" class="ltx_text" style="font-size:120%;">Method</span></th>
<th id="S5.T3.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.1.1.1.1.2.1" class="ltx_text" style="font-size:120%;">CIFAR-10</span></th>
<th id="S5.T3.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.1.1.1.1.3.1" class="ltx_text" style="font-size:120%;">CIFAR-100</span></th>
<th id="S5.T3.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.1.1.1.1.4.1" class="ltx_text" style="font-size:120%;">FMNIST</span></th>
<th id="S5.T3.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T3.1.1.1.1.5.1" class="ltx_text" style="font-size:120%;">SVHN</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.2.1" class="ltx_tr">
<td id="S5.T3.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.1.1.2.1.1.1" class="ltx_text" style="font-size:120%;">Local</span></td>
<td id="S5.T3.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.1.1.2.1.2.1" class="ltx_text" style="font-size:120%;">41.80 ± 2.09</span></td>
<td id="S5.T3.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.1.1.2.1.3.1" class="ltx_text" style="font-size:120%;">17.56 ± 0.61</span></td>
<td id="S5.T3.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.1.1.2.1.4.1" class="ltx_text" style="font-size:120%;">70.40 ± 0.86</span></td>
<td id="S5.T3.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.1.1.2.1.5.1" class="ltx_text" style="font-size:120%;">59.06 ± 1.43</span></td>
</tr>
<tr id="S5.T3.1.1.3.2" class="ltx_tr">
<td id="S5.T3.1.1.3.2.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.3.2.1.1" class="ltx_text" style="font-size:120%;">FedAvg</span></td>
<td id="S5.T3.1.1.3.2.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.3.2.2.1" class="ltx_text" style="font-size:120%;">38.25 ± 2.98</span></td>
<td id="S5.T3.1.1.3.2.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.3.2.3.1" class="ltx_text" style="font-size:120%;">45.26 ± 0.47</span></td>
<td id="S5.T3.1.1.3.2.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.3.2.4.1" class="ltx_text" style="font-size:120%;">81.93 ± 0.64</span></td>
<td id="S5.T3.1.1.3.2.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.3.2.5.1" class="ltx_text" style="font-size:120%;">61.26 ± 0.95</span></td>
</tr>
<tr id="S5.T3.1.1.4.3" class="ltx_tr">
<td id="S5.T3.1.1.4.3.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.4.3.1.1" class="ltx_text" style="font-size:120%;">FedProx</span></td>
<td id="S5.T3.1.1.4.3.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.4.3.2.1" class="ltx_text" style="font-size:120%;">42.69 ± 1.47</span></td>
<td id="S5.T3.1.1.4.3.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.4.3.3.1" class="ltx_text" style="font-size:120%;">46.17 ± 0.83</span></td>
<td id="S5.T3.1.1.4.3.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.4.3.4.1" class="ltx_text" style="font-size:120%;">83.32 ± 1.07</span></td>
<td id="S5.T3.1.1.4.3.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.4.3.5.1" class="ltx_text" style="font-size:120%;">62.31 ± 1.72</span></td>
</tr>
<tr id="S5.T3.1.1.5.4" class="ltx_tr">
<td id="S5.T3.1.1.5.4.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.5.4.1.1" class="ltx_text" style="font-size:120%;">FedNova</span></td>
<td id="S5.T3.1.1.5.4.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.5.4.2.1" class="ltx_text" style="font-size:120%;">39.52 ± 1.35</span></td>
<td id="S5.T3.1.1.5.4.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.5.4.3.1" class="ltx_text" style="font-size:120%;">46.55 ± 1.54</span></td>
<td id="S5.T3.1.1.5.4.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.5.4.4.1" class="ltx_text" style="font-size:120%;">83.68 ± 1.61</span></td>
<td id="S5.T3.1.1.5.4.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.5.4.5.1" class="ltx_text" style="font-size:120%;">60.53 ± 2.18</span></td>
</tr>
<tr id="S5.T3.1.1.6.5" class="ltx_tr">
<td id="S5.T3.1.1.6.5.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.6.5.1.1" class="ltx_text" style="font-size:120%;">LG</span></td>
<td id="S5.T3.1.1.6.5.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.6.5.2.1" class="ltx_text" style="font-size:120%;">48.63 ± 0.42</span></td>
<td id="S5.T3.1.1.6.5.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.6.5.3.1" class="ltx_text" style="font-size:120%;">24.27 ± 0.33</span></td>
<td id="S5.T3.1.1.6.5.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.6.5.4.1" class="ltx_text" style="font-size:120%;">74.39 ± 1.26</span></td>
<td id="S5.T3.1.1.6.5.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.6.5.5.1" class="ltx_text" style="font-size:120%;">73.12 ± 0.76</span></td>
</tr>
<tr id="S5.T3.1.1.7.6" class="ltx_tr">
<td id="S5.T3.1.1.7.6.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.7.6.1.1" class="ltx_text" style="font-size:120%;">PerFedAvg</span></td>
<td id="S5.T3.1.1.7.6.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.7.6.2.1" class="ltx_text" style="font-size:120%;">52.83 ± 1.47</span></td>
<td id="S5.T3.1.1.7.6.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.7.6.3.1" class="ltx_text" style="font-size:120%;">34.20 ± 0.29</span></td>
<td id="S5.T3.1.1.7.6.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.7.6.4.1" class="ltx_text" style="font-size:120%;">81.18 ± 1.80</span></td>
<td id="S5.T3.1.1.7.6.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.7.6.5.1" class="ltx_text" style="font-size:120%;">75.07 ± 1.85</span></td>
</tr>
<tr id="S5.T3.1.1.8.7" class="ltx_tr">
<td id="S5.T3.1.1.8.7.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.8.7.1.1" class="ltx_text" style="font-size:120%;">CFL</span></td>
<td id="S5.T3.1.1.8.7.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.8.7.2.1" class="ltx_text" style="font-size:120%;">41.50 ± 0.35</span></td>
<td id="S5.T3.1.1.8.7.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.8.7.3.1" class="ltx_text" style="font-size:120%;">31.62 ± 1.76</span></td>
<td id="S5.T3.1.1.8.7.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.8.7.4.1" class="ltx_text" style="font-size:120%;">74.01 ± 1.19</span></td>
<td id="S5.T3.1.1.8.7.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.8.7.5.1" class="ltx_text" style="font-size:120%;">61.96 ± 1.58</span></td>
</tr>
<tr id="S5.T3.1.1.9.8" class="ltx_tr">
<td id="S5.T3.1.1.9.8.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.8.1.1" class="ltx_text" style="font-size:120%;">IFCA</span></td>
<td id="S5.T3.1.1.9.8.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.8.2.1" class="ltx_text" style="font-size:120%;">50.51 ± 0.61</span></td>
<td id="S5.T3.1.1.9.8.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.8.3.1" class="ltx_text" style="font-size:120%;">46.28 ± 0.23</span></td>
<td id="S5.T3.1.1.9.8.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.8.4.1" class="ltx_text" style="font-size:120%;">84.57 ± 0.41</span></td>
<td id="S5.T3.1.1.9.8.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.8.5.1" class="ltx_text" style="font-size:120%;">74.57 ± 0.40</span></td>
</tr>
<tr id="S5.T3.1.1.10.9" class="ltx_tr">
<td id="S5.T3.1.1.10.9.1" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.10.9.1.1" class="ltx_text" style="font-size:120%;">PACFL</span></td>
<td id="S5.T3.1.1.10.9.2" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.10.9.2.1" class="ltx_text" style="font-size:120%;">51.02 ± 0.24</span></td>
<td id="S5.T3.1.1.10.9.3" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.10.9.3.1" class="ltx_text" style="font-size:120%;">47.58 ± 0.20</span></td>
<td id="S5.T3.1.1.10.9.4" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.10.9.4.1" class="ltx_text" style="font-size:120%;">85.30 ± 0.28</span></td>
<td id="S5.T3.1.1.10.9.5" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.10.9.5.1" class="ltx_text" style="font-size:120%;">76.35 ± 0.46</span></td>
</tr>
<tr id="S5.T3.1.1.11.10" class="ltx_tr">
<td id="S5.T3.1.1.11.10.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T3.1.1.11.10.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">FedClust</span></td>
<td id="S5.T3.1.1.11.10.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T3.1.1.11.10.2.1" class="ltx_text ltx_font_bold" style="font-size:120%;">60.25 ± 0.58</span></td>
<td id="S5.T3.1.1.11.10.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T3.1.1.11.10.3.1" class="ltx_text ltx_font_bold" style="font-size:120%;">49.65 ± 0.17</span></td>
<td id="S5.T3.1.1.11.10.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T3.1.1.11.10.4.1" class="ltx_text ltx_font_bold" style="font-size:120%;">95.51 ± 0.17</span></td>
<td id="S5.T3.1.1.11.10.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T3.1.1.11.10.5.1" class="ltx_text ltx_font_bold" style="font-size:120%;">78.23 ± 0.30</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">Communication cost.</span>
In this experiment, we compare the performance of our <span id="S5.SS2.p3.1.2" class="ltx_text ltx_font_italic">FedClust</span> with baseline methods where the number of communication rounds for the federation is limited under a heterogeneous setting. Herein, we limit the communication round budget to 80 rounds for all personalized baselines. We illustrate the number of communication rounds versus the average of the final local test accuracy across all clients for Non-IID label skew (20%) in Fig. 3. Our proposed approach achieves convergence within only 20 communication rounds in CIFAR-10, FMNIST, and SVHN datasets. From Fig. 3, we can see that the <span id="S5.SS2.p3.1.3" class="ltx_text ltx_font_italic">CFL</span> baseline <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> shows the worst performance on all datasets, except for CIFAR-100. <span id="S5.SS2.p3.1.4" class="ltx_text ltx_font_italic">Per-FedAvg</span> experiences greater advantages as the number of communication rounds increases. It appears that <span id="S5.SS2.p3.1.5" class="ltx_text ltx_font_italic">PACFL</span> and <span id="S5.SS2.p3.1.6" class="ltx_text ltx_font_italic">IFCA</span> are the closest lines to ours for all datasets, with <span id="S5.SS2.p3.1.7" class="ltx_text ltx_font_italic">FedClust</span> consistently outperforming. The reason behind this fact is that <span id="S5.SS2.p3.1.8" class="ltx_text ltx_font_italic">IFCA</span> requires many rounds of federation to form stabilized clusters as it initially starts with random cluster models which are inherently noisy.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Comparison of the number of communications rounds needed for different approaches to reach target top-1 average local test accuracy over different datasets for Non-IID of 20%</figcaption>
<div id="S5.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:381.6pt;height:279.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.8pt,-41.0pt) scale(1.4138675044728,1.4138675044728) ;">
<table id="S5.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.1.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T4.1.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S5.T4.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T4.1.1.1.1.2.1" class="ltx_text">CIFAR-10</span></th>
<td id="S5.T4.1.1.1.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T4.1.1.1.1.3.1" class="ltx_text">CIFAR-100</span></td>
<td id="S5.T4.1.1.1.1.4" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T4.1.1.1.1.4.1" class="ltx_text">FMNIST</span></td>
<td id="S5.T4.1.1.1.1.5" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T4.1.1.1.1.5.1" class="ltx_text">SVHN</span></td>
</tr>
<tr id="S5.T4.1.1.2.2" class="ltx_tr">
<th id="S5.T4.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.1.1.2.2.1.1" class="ltx_text">Target</span></th>
<th id="S5.T4.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.1.1.2.2.2.1" class="ltx_text">80%</span></th>
<td id="S5.T4.1.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.1.2.2.3.1" class="ltx_text">50%</span></td>
<td id="S5.T4.1.1.2.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.1.2.2.4.1" class="ltx_text">75%</span></td>
<td id="S5.T4.1.1.2.2.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.1.2.2.5.1" class="ltx_text">75%</span></td>
</tr>
<tr id="S5.T4.1.1.3.3" class="ltx_tr">
<th id="S5.T4.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<th id="S5.T4.1.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">– –</th>
<td id="S5.T4.1.1.3.3.3" class="ltx_td ltx_align_left ltx_border_t">135</td>
<td id="S5.T4.1.1.3.3.4" class="ltx_td ltx_align_left ltx_border_t">200</td>
<td id="S5.T4.1.1.3.3.5" class="ltx_td ltx_align_left ltx_border_t">150</td>
</tr>
<tr id="S5.T4.1.1.4.4" class="ltx_tr">
<th id="S5.T4.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx</th>
<th id="S5.T4.1.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">– –</th>
<td id="S5.T4.1.1.4.4.3" class="ltx_td ltx_align_left">120</td>
<td id="S5.T4.1.1.4.4.4" class="ltx_td ltx_align_left">200</td>
<td id="S5.T4.1.1.4.4.5" class="ltx_td ltx_align_left">200</td>
</tr>
<tr id="S5.T4.1.1.5.5" class="ltx_tr">
<th id="S5.T4.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedNova</th>
<th id="S5.T4.1.1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">– –</th>
<td id="S5.T4.1.1.5.5.3" class="ltx_td ltx_align_left">125</td>
<td id="S5.T4.1.1.5.5.4" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T4.1.1.5.5.5" class="ltx_td ltx_align_left">150</td>
</tr>
<tr id="S5.T4.1.1.6.6" class="ltx_tr">
<th id="S5.T4.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LG</th>
<th id="S5.T4.1.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">27</th>
<td id="S5.T4.1.1.6.6.3" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T4.1.1.6.6.4" class="ltx_td ltx_align_left">14</td>
<td id="S5.T4.1.1.6.6.5" class="ltx_td ltx_align_left">17</td>
</tr>
<tr id="S5.T4.1.1.7.7" class="ltx_tr">
<th id="S5.T4.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PerFedAvg</th>
<th id="S5.T4.1.1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">54</th>
<td id="S5.T4.1.1.7.7.3" class="ltx_td ltx_align_left">110</td>
<td id="S5.T4.1.1.7.7.4" class="ltx_td ltx_align_left">15</td>
<td id="S5.T4.1.1.7.7.5" class="ltx_td ltx_align_left">37</td>
</tr>
<tr id="S5.T4.1.1.8.8" class="ltx_tr">
<th id="S5.T4.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CFL</th>
<th id="S5.T4.1.1.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">– –</th>
<td id="S5.T4.1.1.8.8.3" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T4.1.1.8.8.4" class="ltx_td ltx_align_left">47</td>
<td id="S5.T4.1.1.8.8.5" class="ltx_td ltx_align_left">– –</td>
</tr>
<tr id="S5.T4.1.1.9.9" class="ltx_tr">
<th id="S5.T4.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">IFCA</th>
<th id="S5.T4.1.1.9.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">28</th>
<td id="S5.T4.1.1.9.9.3" class="ltx_td ltx_align_left">43</td>
<td id="S5.T4.1.1.9.9.4" class="ltx_td ltx_align_left">13</td>
<td id="S5.T4.1.1.9.9.5" class="ltx_td ltx_align_left">19</td>
</tr>
<tr id="S5.T4.1.1.10.10" class="ltx_tr">
<th id="S5.T4.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PACFL</th>
<th id="S5.T4.1.1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">25</th>
<td id="S5.T4.1.1.10.10.3" class="ltx_td ltx_align_left">40</td>
<td id="S5.T4.1.1.10.10.4" class="ltx_td ltx_align_left">13</td>
<td id="S5.T4.1.1.10.10.5" class="ltx_td ltx_align_left">15</td>
</tr>
<tr id="S5.T4.1.1.11.11" class="ltx_tr">
<th id="S5.T4.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T4.1.1.11.11.1.1" class="ltx_text ltx_font_bold">FedClust</span></th>
<th id="S5.T4.1.1.11.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T4.1.1.11.11.2.1" class="ltx_text ltx_font_bold">13</span></th>
<td id="S5.T4.1.1.11.11.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T4.1.1.11.11.3.1" class="ltx_text ltx_font_bold">32</span></td>
<td id="S5.T4.1.1.11.11.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T4.1.1.11.11.4.1" class="ltx_text ltx_font_bold">7</span></td>
<td id="S5.T4.1.1.11.11.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T4.1.1.11.11.5.1" class="ltx_text ltx_font_bold">9</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Comparison of the required communications costs in Mb needed for different approaches to reach target top-1 average local test accuracy over different datasets for Non-IID label skew of 30%</figcaption>
<div id="S5.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:381.6pt;height:279.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.8pt,-41.0pt) scale(1.4138675044728,1.4138675044728) ;">
<table id="S5.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.1.1.1.1.1.1" class="ltx_text">Method</span></th>
<th id="S5.T5.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.1.1.1.1.2.1" class="ltx_text">CIFAR-10</span></th>
<th id="S5.T5.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.1.1.1.1.3.1" class="ltx_text">CIFAR-100</span></th>
<th id="S5.T5.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.1.1.1.1.4.1" class="ltx_text">FMNIST</span></th>
<th id="S5.T5.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T5.1.1.1.1.5.1" class="ltx_text">SVHN</span></th>
</tr>
<tr id="S5.T5.1.1.2.2" class="ltx_tr">
<th id="S5.T5.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.1.1.2.2.1.1" class="ltx_text">Target</span></th>
<th id="S5.T5.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.1.1.2.2.2.1" class="ltx_text">70%</span></th>
<th id="S5.T5.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.1.1.2.2.3.1" class="ltx_text">50%</span></th>
<th id="S5.T5.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.1.1.2.2.4.1" class="ltx_text">80%</span></th>
<th id="S5.T5.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.1.1.2.2.5.1" class="ltx_text">80%</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.1.3.1" class="ltx_tr">
<td id="S5.T5.1.1.3.1.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg</td>
<td id="S5.T5.1.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t">– –</td>
<td id="S5.T5.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">4237.37</td>
<td id="S5.T5.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">79.36</td>
<td id="S5.T5.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t">71.43</td>
</tr>
<tr id="S5.T5.1.1.4.2" class="ltx_tr">
<td id="S5.T5.1.1.4.2.1" class="ltx_td ltx_align_left">FedProx</td>
<td id="S5.T5.1.1.4.2.2" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.4.2.3" class="ltx_td ltx_align_left">4237.37</td>
<td id="S5.T5.1.1.4.2.4" class="ltx_td ltx_align_left">71.43</td>
<td id="S5.T5.1.1.4.2.5" class="ltx_td ltx_align_left">71.43</td>
</tr>
<tr id="S5.T5.1.1.5.3" class="ltx_tr">
<td id="S5.T5.1.1.5.3.1" class="ltx_td ltx_align_left">FedNova</td>
<td id="S5.T5.1.1.5.3.2" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.5.3.3" class="ltx_td ltx_align_left">3601.98</td>
<td id="S5.T5.1.1.5.3.4" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.5.3.5" class="ltx_td ltx_align_left">79.36</td>
</tr>
<tr id="S5.T5.1.1.6.4" class="ltx_tr">
<td id="S5.T5.1.1.6.4.1" class="ltx_td ltx_align_left">LG</td>
<td id="S5.T5.1.1.6.4.2" class="ltx_td ltx_align_left"><span id="S5.T5.1.1.6.4.2.1" class="ltx_text ltx_font_bold">2.11</span></td>
<td id="S5.T5.1.1.6.4.3" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.6.4.4" class="ltx_td ltx_align_left"><span id="S5.T5.1.1.6.4.4.1" class="ltx_text ltx_font_bold">1.26</span></td>
<td id="S5.T5.1.1.6.4.5" class="ltx_td ltx_align_left"><span id="S5.T5.1.1.6.4.5.1" class="ltx_text ltx_font_bold">1.76</span></td>
</tr>
<tr id="S5.T5.1.1.7.5" class="ltx_tr">
<td id="S5.T5.1.1.7.5.1" class="ltx_td ltx_align_left">PerFedAvg</td>
<td id="S5.T5.1.1.7.5.2" class="ltx_td ltx_align_left">23.81</td>
<td id="S5.T5.1.1.7.5.3" class="ltx_td ltx_align_left">6356.06</td>
<td id="S5.T5.1.1.7.5.4" class="ltx_td ltx_align_left">7.54</td>
<td id="S5.T5.1.1.7.5.5" class="ltx_td ltx_align_left">18.65</td>
</tr>
<tr id="S5.T5.1.1.8.6" class="ltx_tr">
<td id="S5.T5.1.1.8.6.1" class="ltx_td ltx_align_left">CFL</td>
<td id="S5.T5.1.1.8.6.2" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.8.6.3" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.8.6.4" class="ltx_td ltx_align_left">– –</td>
<td id="S5.T5.1.1.8.6.5" class="ltx_td ltx_align_left">– –</td>
</tr>
<tr id="S5.T5.1.1.9.7" class="ltx_tr">
<td id="S5.T5.1.1.9.7.1" class="ltx_td ltx_align_left">IFCA</td>
<td id="S5.T5.1.1.9.7.2" class="ltx_td ltx_align_left">16.66</td>
<td id="S5.T5.1.1.9.7.3" class="ltx_td ltx_align_left">3495.19</td>
<td id="S5.T5.1.1.9.7.4" class="ltx_td ltx_align_left">11.30</td>
<td id="S5.T5.1.1.9.7.5" class="ltx_td ltx_align_left">10.71</td>
</tr>
<tr id="S5.T5.1.1.10.8" class="ltx_tr">
<td id="S5.T5.1.1.10.8.1" class="ltx_td ltx_align_left">PACFL</td>
<td id="S5.T5.1.1.10.8.2" class="ltx_td ltx_align_left">10.31</td>
<td id="S5.T5.1.1.10.8.3" class="ltx_td ltx_align_left">1991.60</td>
<td id="S5.T5.1.1.10.8.4" class="ltx_td ltx_align_left">7.53</td>
<td id="S5.T5.1.1.10.8.5" class="ltx_td ltx_align_left">8.73</td>
</tr>
<tr id="S5.T5.1.1.11.9" class="ltx_tr">
<td id="S5.T5.1.1.11.9.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T5.1.1.11.9.1.1" class="ltx_text ltx_font_bold">FedClust</span></td>
<td id="S5.T5.1.1.11.9.2" class="ltx_td ltx_align_left ltx_border_bb">8.66</td>
<td id="S5.T5.1.1.11.9.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T5.1.1.11.9.3.1" class="ltx_text ltx_font_bold">1889.17</span></td>
<td id="S5.T5.1.1.11.9.4" class="ltx_td ltx_align_left ltx_border_bb">4.60</td>
<td id="S5.T5.1.1.11.9.5" class="ltx_td ltx_align_left ltx_border_bb">7.11</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x10.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x11.png" id="S5.F4.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x12.png" id="S5.F4.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2407.07124/assets/x13.png" id="S5.F4.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="106" height="98" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Test accuracy performance of FedClust versus the clustering threshold <math id="S5.F4.2.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F4.2.m1.1b"><mi id="S5.F4.2.m1.1.1" xref="S5.F4.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F4.2.m1.1c"><ci id="S5.F4.2.m1.1.1.cmml" xref="S5.F4.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.2.m1.1d">\lambda</annotation></semantics></math>, and the number of suitable clusters for Non-IID label skew (20%) on CIFAR-10/100, FMNIST, and SVHN datasets. We run each experiment to obtain each point in the plots for 200 communication rounds with local epoch and local batch size of 10, and SGD local optimizer.</figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">We also demonstrate the number of communication rounds needed for each baseline to reach a specified target accuracy in Table 4. The “– –” entries in Table 4, and 5 indicate that the baseline is unable to reach the desired target accuracy. As the results show, <span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_italic">FedClust</span> outperforms all SOTA baseline methods. Table 5 demonstrates the required communication cost needed to reach a target test accuracy across different datasets for Non-IID label skew (30%). The results depict that Global baseline methods are unable to reach the desired accuracy or require higher communication cost. <span id="S5.SS2.p4.1.2" class="ltx_text ltx_font_italic">FedClust</span> significantly reduces the communication cost to reach the target accuracies compared to all baselines except <span id="S5.SS2.p4.1.3" class="ltx_text ltx_font_italic">LG</span> (which benefits from its strategy of communicating a compact representation of raw data rather than model parameters). More specifically, with CIFAR-100, <span id="S5.SS2.p4.1.4" class="ltx_text ltx_font_italic">IFCA</span> requires communication of 3495.19 Mb to achieve the desired accuracy of 50% while <span id="S5.SS2.p4.1.5" class="ltx_text ltx_font_italic">FedClust</span> only requires 1889.17 Mb. This is because the server in <span id="S5.SS2.p4.1.6" class="ltx_text ltx_font_italic">IFCA</span> transmits all cluster models to participating clients in each communication round which incurs significant communication cost. Similarly, for CIFAR-10, <span id="S5.SS2.p4.1.7" class="ltx_text ltx_font_italic">FedClust</span> reduces the communication cost by (1.2 - 2.7)<math id="S5.SS2.p4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS2.p4.1.m1.1a"><mo id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><times id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">\times</annotation></semantics></math>.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Impact of newcomers.</span>
In order to evaluate the performance of the newcomer clients personalized model, we conduct an experiment with Non-IID label skew (20%) in which only 80 out of 100 clients are involved in a federation with 50 rounds. The remaining 20 clients are incorporated into the network after the completion of the federation and receive their corresponding cluster model from the server. The newcomer clients personalize their cluster model for only 5 epochs. The average local test accuracy of the newcomer clients is reported in Table 6. Table 6 demonstrates that <span id="S5.SS2.p5.1.2" class="ltx_text ltx_font_italic">FedClust</span> has the capability to incorporate new participants to learn their personalized model with higher test accuracy.</p>
</div>
<div id="S5.SS2.p6" class="ltx_para">
<p id="S5.SS2.p6.3" class="ltx_p"><span id="S5.SS2.p6.3.1" class="ltx_text ltx_font_bold">Trade-off between generalization and personalization.</span>
To address the data heterogeneity, prior works introduced a proximal term in local optimization or modified the model aggregation method on the server side to benefit from some degree of personalization <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>, <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite>. Despite being effective, they lack the flexibility to balance between globalization and personalization. Our proposed <span id="S5.SS2.p6.3.2" class="ltx_text ltx_font_italic">FedClust</span> framework can naturally navigate this trade-off. The performance of <span id="S5.SS2.p6.3.3" class="ltx_text ltx_font_italic">FedClust</span> in terms of accuracy is illustrated in Fig. 4 for different values of <math id="S5.SS2.p6.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p6.1.m1.1a"><mi id="S5.SS2.p6.1.m1.1.1" xref="S5.SS2.p6.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.1.m1.1b"><ci id="S5.SS2.p6.1.m1.1.1.cmml" xref="S5.SS2.p6.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.1.m1.1c">\lambda</annotation></semantics></math>, which is the clustering threshold that controls the number of clusters. The blue curve and the red bars illustrate the accuracy and number of clusters respectively for each <math id="S5.SS2.p6.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p6.2.m2.1a"><mi id="S5.SS2.p6.2.m2.1.1" xref="S5.SS2.p6.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.2.m2.1b"><ci id="S5.SS2.p6.2.m2.1.1.cmml" xref="S5.SS2.p6.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.2.m2.1c">\lambda</annotation></semantics></math>. By changing the value of <math id="S5.SS2.p6.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p6.3.m3.1a"><mi id="S5.SS2.p6.3.m3.1.1" xref="S5.SS2.p6.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.3.m3.1b"><ci id="S5.SS2.p6.3.m3.1.1.cmml" xref="S5.SS2.p6.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.3.m3.1c">\lambda</annotation></semantics></math>, which is determined based on the dataset, <span id="S5.SS2.p6.3.4" class="ltx_text ltx_font_italic">FedClust</span> can switch from training a fully global model (1 cluster) to training fully personalized models for each client.</p>
</div>
<div id="S5.SS2.p7" class="ltx_para">
<p id="S5.SS2.p7.4" class="ltx_p">Fig. 4 demonstrates that increasing values of <math id="S5.SS2.p7.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p7.1.m1.1a"><mi id="S5.SS2.p7.1.m1.1.1" xref="S5.SS2.p7.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.1.m1.1b"><ci id="S5.SS2.p7.1.m1.1.1.cmml" xref="S5.SS2.p7.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.1.m1.1c">\lambda</annotation></semantics></math> lead to a decrease in the number of clusters, indicating a higher degree of globalization. <span id="S5.SS2.p7.4.1" class="ltx_text ltx_font_italic">FedClust</span> groups all clients into 1 cluster when <math id="S5.SS2.p7.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p7.2.m2.1a"><mi id="S5.SS2.p7.2.m2.1.1" xref="S5.SS2.p7.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.2.m2.1b"><ci id="S5.SS2.p7.2.m2.1.1.cmml" xref="S5.SS2.p7.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.2.m2.1c">\lambda</annotation></semantics></math> is large enough and the scenario becomes similar to the <span id="S5.SS2.p7.4.2" class="ltx_text ltx_font_italic">FedAvg</span> baseline (pure globalization). On the other hand, as <math id="S5.SS2.p7.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p7.3.m3.1a"><mi id="S5.SS2.p7.3.m3.1.1" xref="S5.SS2.p7.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.3.m3.1b"><ci id="S5.SS2.p7.3.m3.1.1.cmml" xref="S5.SS2.p7.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.3.m3.1c">\lambda</annotation></semantics></math> decreases, the number of clusters increases, resulting in a greater level of personalization. Each client forms individual clusters when <math id="S5.SS2.p7.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p7.4.m4.1a"><mi id="S5.SS2.p7.4.m4.1.1" xref="S5.SS2.p7.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.4.m4.1b"><ci id="S5.SS2.p7.4.m4.1.1.cmml" xref="S5.SS2.p7.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.4.m4.1c">\lambda</annotation></semantics></math> is small enough and the scenario degenerates to the Local baseline (pure personalization). The result of our experiments across all datasets demonstrates that all clients benefit from some level of globalization. For Non-IID label skew (20%), Fig. 2 illustrates that the highest accuracy results on CIFAR-10, CIFAR-100, SVHN, and FMNIST datasets are achieved when the number of clusters are 2, 2, 2, and 4, respectively. <span id="S5.SS2.p7.4.3" class="ltx_text ltx_font_italic">IFCA</span> [3] lacks this trade-off flexibility as it requires a predefined number of clusters.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6. </span>Average local test accuracy across unseen clients on different datasets for Non-IID label skew of 20%</figcaption>
<div id="S5.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:204.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(25.8pt,-12.2pt) scale(1.13502959182068,1.13502959182068) ;">
<table id="S5.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.1.1.1.1" class="ltx_tr">
<th id="S5.T6.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.1.1.1.1.1.1" class="ltx_text" style="font-size:120%;">Method</span></th>
<th id="S5.T6.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.1.1.1.1.2.1" class="ltx_text" style="font-size:120%;">CIFAR-10</span></th>
<th id="S5.T6.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.1.1.1.1.3.1" class="ltx_text" style="font-size:120%;">CIFAR-100</span></th>
<th id="S5.T6.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.1.1.1.1.4.1" class="ltx_text" style="font-size:120%;">FMNIST</span></th>
<th id="S5.T6.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S5.T6.1.1.1.1.5.1" class="ltx_text" style="font-size:120%;">SVHN</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.1.1.2.1" class="ltx_tr">
<td id="S5.T6.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T6.1.1.2.1.1.1" class="ltx_text" style="font-size:120%;">Local</span></td>
<td id="S5.T6.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T6.1.1.2.1.2.1" class="ltx_text" style="font-size:120%;">83.39 ± 1.35</span></td>
<td id="S5.T6.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T6.1.1.2.1.3.1" class="ltx_text" style="font-size:120%;">27.91 ± 1.09</span></td>
<td id="S5.T6.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T6.1.1.2.1.4.1" class="ltx_text" style="font-size:120%;">94.45 ± 0.51</span></td>
<td id="S5.T6.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T6.1.1.2.1.5.1" class="ltx_text" style="font-size:120%;">90.62 ± 0.81</span></td>
</tr>
<tr id="S5.T6.1.1.3.2" class="ltx_tr">
<td id="S5.T6.1.1.3.2.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.3.2.1.1" class="ltx_text" style="font-size:120%;">FedAvg</span></td>
<td id="S5.T6.1.1.3.2.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.3.2.2.1" class="ltx_text" style="font-size:120%;">31.72 ± 2.16</span></td>
<td id="S5.T6.1.1.3.2.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.3.2.3.1" class="ltx_text" style="font-size:120%;">32.26 ± 0.48</span></td>
<td id="S5.T6.1.1.3.2.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.3.2.4.1" class="ltx_text" style="font-size:120%;">78.70 ± 2.12</span></td>
<td id="S5.T6.1.1.3.2.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.3.2.5.1" class="ltx_text" style="font-size:120%;">71.18 ± 3.09</span></td>
</tr>
<tr id="S5.T6.1.1.4.3" class="ltx_tr">
<td id="S5.T6.1.1.4.3.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.4.3.1.1" class="ltx_text" style="font-size:120%;">FedProx</span></td>
<td id="S5.T6.1.1.4.3.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.4.3.2.1" class="ltx_text" style="font-size:120%;">27.74 ± 2.38</span></td>
<td id="S5.T6.1.1.4.3.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.4.3.3.1" class="ltx_text" style="font-size:120%;">32.74 ± 1.77</span></td>
<td id="S5.T6.1.1.4.3.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.4.3.4.1" class="ltx_text" style="font-size:120%;">74.19 ± 4.17</span></td>
<td id="S5.T6.1.1.4.3.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.4.3.5.1" class="ltx_text" style="font-size:120%;">73.44 ± 4.23</span></td>
</tr>
<tr id="S5.T6.1.1.5.4" class="ltx_tr">
<td id="S5.T6.1.1.5.4.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.5.4.1.1" class="ltx_text" style="font-size:120%;">FedNova</span></td>
<td id="S5.T6.1.1.5.4.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.5.4.2.1" class="ltx_text" style="font-size:120%;">31.12 ± 1.08</span></td>
<td id="S5.T6.1.1.5.4.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.5.4.3.1" class="ltx_text" style="font-size:120%;">33.53 ± 0.82</span></td>
<td id="S5.T6.1.1.5.4.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.5.4.4.1" class="ltx_text" style="font-size:120%;">73.76 ± 1.85</span></td>
<td id="S5.T6.1.1.5.4.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.5.4.5.1" class="ltx_text" style="font-size:120%;">72.43 ± 2.91</span></td>
</tr>
<tr id="S5.T6.1.1.6.5" class="ltx_tr">
<td id="S5.T6.1.1.6.5.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.6.5.1.1" class="ltx_text" style="font-size:120%;">LG</span></td>
<td id="S5.T6.1.1.6.5.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.6.5.2.1" class="ltx_text" style="font-size:120%;">81.58 ± 0.51</span></td>
<td id="S5.T6.1.1.6.5.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.6.5.3.1" class="ltx_text" style="font-size:120%;">11.08 ± 0.25</span></td>
<td id="S5.T6.1.1.6.5.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.6.5.4.1" class="ltx_text" style="font-size:120%;">95.66 ± 0.33</span></td>
<td id="S5.T6.1.1.6.5.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.6.5.5.1" class="ltx_text" style="font-size:120%;">89.59 ± 0.90</span></td>
</tr>
<tr id="S5.T6.1.1.7.6" class="ltx_tr">
<td id="S5.T6.1.1.7.6.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.7.6.1.1" class="ltx_text" style="font-size:120%;">PerFedAvg</span></td>
<td id="S5.T6.1.1.7.6.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.7.6.2.1" class="ltx_text" style="font-size:120%;">74.65 ± 1.09</span></td>
<td id="S5.T6.1.1.7.6.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.7.6.3.1" class="ltx_text" style="font-size:120%;">31.40 ± 0.36</span></td>
<td id="S5.T6.1.1.7.6.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.7.6.4.1" class="ltx_text" style="font-size:120%;">92.33 ± 0.86</span></td>
<td id="S5.T6.1.1.7.6.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.7.6.5.1" class="ltx_text" style="font-size:120%;">64.16 ± 1.64</span></td>
</tr>
<tr id="S5.T6.1.1.8.7" class="ltx_tr">
<td id="S5.T6.1.1.8.7.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.8.7.1.1" class="ltx_text" style="font-size:120%;">IFCA</span></td>
<td id="S5.T6.1.1.8.7.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.8.7.2.1" class="ltx_text" style="font-size:120%;">85.64 ± 0.54</span></td>
<td id="S5.T6.1.1.8.7.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.8.7.3.1" class="ltx_text" style="font-size:120%;">94.45 ± 0.5</span></td>
<td id="S5.T6.1.1.8.7.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.8.7.4.1" class="ltx_text" style="font-size:120%;">96.63 ± 0.83</span></td>
<td id="S5.T6.1.1.8.7.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.8.7.5.1" class="ltx_text" style="font-size:120%;">94.20 ± 0.15</span></td>
</tr>
<tr id="S5.T6.1.1.9.8" class="ltx_tr">
<td id="S5.T6.1.1.9.8.1" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.9.8.1.1" class="ltx_text" style="font-size:120%;">PACFL</span></td>
<td id="S5.T6.1.1.9.8.2" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.9.8.2.1" class="ltx_text" style="font-size:120%;">85.80 ± 0.66</span></td>
<td id="S5.T6.1.1.9.8.3" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.9.8.3.1" class="ltx_text" style="font-size:120%;">94.45 ± 0.5</span></td>
<td id="S5.T6.1.1.9.8.4" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.9.8.4.1" class="ltx_text" style="font-size:120%;">97.04 ± 0.54</span></td>
<td id="S5.T6.1.1.9.8.5" class="ltx_td ltx_align_left"><span id="S5.T6.1.1.9.8.5.1" class="ltx_text" style="font-size:120%;">94.75 ± 0.11</span></td>
</tr>
<tr id="S5.T6.1.1.10.9" class="ltx_tr">
<td id="S5.T6.1.1.10.9.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T6.1.1.10.9.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">FedClust</span></td>
<td id="S5.T6.1.1.10.9.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T6.1.1.10.9.2.1" class="ltx_text ltx_font_bold" style="font-size:120%;">86.78 ± 0.67</span></td>
<td id="S5.T6.1.1.10.9.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T6.1.1.10.9.3.1" class="ltx_text ltx_font_bold" style="font-size:120%;">97.63 ± 0.29</span></td>
<td id="S5.T6.1.1.10.9.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T6.1.1.10.9.4.1" class="ltx_text ltx_font_bold" style="font-size:120%;">97.63 ± 0.29</span></td>
<td id="S5.T6.1.1.10.9.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T6.1.1.10.9.5.1" class="ltx_text ltx_font_bold" style="font-size:120%;">95.19 ± 0.25</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.SS2.p8" class="ltx_para">
<p id="S5.SS2.p8.1" class="ltx_p"><span id="S5.SS2.p8.1.1" class="ltx_text ltx_font_bold">Computation overhead and privacy.</span>
The computational overhead of <span id="S5.SS2.p8.1.2" class="ltx_text ltx_font_italic">FedClust</span> is minimal compared to the <span id="S5.SS2.p8.1.3" class="ltx_text ltx_font_italic">FedAvg</span> baseline algorithm. It requires performing one-shot HC after the first round. The computational complexity of <span id="S5.SS2.p8.1.4" class="ltx_text ltx_font_italic">FedClust</span> is the same as <span id="S5.SS2.p8.1.5" class="ltx_text ltx_font_italic">FedAvg</span>, with the additional complexity of the one-shot HC (O(<math id="S5.SS2.p8.1.m1.1" class="ltx_Math" alttext="N^{2}" display="inline"><semantics id="S5.SS2.p8.1.m1.1a"><msup id="S5.SS2.p8.1.m1.1.1" xref="S5.SS2.p8.1.m1.1.1.cmml"><mi id="S5.SS2.p8.1.m1.1.1.2" xref="S5.SS2.p8.1.m1.1.1.2.cmml">N</mi><mn id="S5.SS2.p8.1.m1.1.1.3" xref="S5.SS2.p8.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p8.1.m1.1b"><apply id="S5.SS2.p8.1.m1.1.1.cmml" xref="S5.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p8.1.m1.1.1.1.cmml" xref="S5.SS2.p8.1.m1.1.1">superscript</csymbol><ci id="S5.SS2.p8.1.m1.1.1.2.cmml" xref="S5.SS2.p8.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S5.SS2.p8.1.m1.1.1.3.cmml" xref="S5.SS2.p8.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p8.1.m1.1c">N^{2}</annotation></semantics></math>)), where <span id="S5.SS2.p8.1.6" class="ltx_text ltx_font_italic">N</span> is the total number of clients. <span id="S5.SS2.p8.1.7" class="ltx_text ltx_font_italic">FedClust</span> only requires each client to report selected partial weights for efficient client clustering in the first round. From the next round, <span id="S5.SS2.p8.1.8" class="ltx_text ltx_font_italic">FedClust</span> leverages similar kinds of information as <span id="S5.SS2.p8.1.9" class="ltx_text ltx_font_italic">FedAvg</span>. Therefore, <span id="S5.SS2.p8.1.10" class="ltx_text ltx_font_italic">FedClust</span> maintains a similar level of privacy as state-of-the-art FL methods by collecting the least necessary information from clients.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we propose a simple and effective clustered federated learning framework, <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">FedClust</span>, to address the data heterogeneity issue. The proposed framework aims to identify data distribution similarities among clients by exploiting the implicit relationship between the underlying data distribution and model weights. <span id="S6.p1.1.2" class="ltx_text ltx_font_italic">FedClust</span> efficiently groups clients with non-IID data into an appropriate number of clusters according to the similarity among the subset of chosen weights of their locally trained models. The effectiveness of <span id="S6.p1.1.3" class="ltx_text ltx_font_italic">FedClust</span> has been demonstrated through experimental evaluations over four popular datasets with a broad range of data heterogeneity scenarios.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.2" class="ltx_p">This article includes a statistical analysis of <span id="S6.p2.2.1" class="ltx_text ltx_font_italic">FedClust</span>. The convergence analysis of <span id="S6.p2.2.2" class="ltx_text ltx_font_italic">FedClust</span> is left for future work. In addition, <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">\lambda</annotation></semantics></math> is a user-defined hyperparameter which plays a crucial role in determining the number of clusters for our clustering approach. We intend to pursue a data-driven method for dynamically identifying the optimal value of <math id="S6.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S6.p2.2.m2.1a"><mi id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><ci id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">\lambda</annotation></semantics></math> for each dataset in the future.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
The research is supported in part by the NSF under grants OIA-2019511, OIA-2327452, 2348452, and 2315613, in part by the Louisiana BoR under LEQSF(2019-22)-RD-A-21 and LEQSF(2024-27)-RD-B-03, in part by the NSFC under 62372184, and the Sci. and Tech. Commission of Shanghai Municipality under 22DZ2229004.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue
Zhao, Ramon Matas Navarro, Matthew
Mattina, Paul N Whatmough, and
Venkatesh Saligrama. 2020.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic
regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briggs et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Christopher Briggs, Zhong
Fan, and Peter Andras. 2020.

</span>
<span class="ltx_bibblock">Federated learning with hierarchical clustering of
local updates to improve training on non-IID data. In
<em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural
Networks (IJCNN)</em>. IEEE, 1–9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Day and Edelsbrunner (1984)</span>
<span class="ltx_bibblock">
William HE Day and
Herbert Edelsbrunner. 1984.

</span>
<span class="ltx_bibblock">Efficient algorithms for agglomerative hierarchical
clustering methods.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Journal of classification</em>
1, 1 (1984),
7–24.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Moming Duan, Duo Liu,
Xinyuan Ji, Renping Liu,
Liang Liang, Xianzhang Chen, and
Yujuan Tan. 2020.

</span>
<span class="ltx_bibblock">FedGroup: Efficient clustered federated learning
via decomposed data-driven measure.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.06870</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan
Mokhtari, and Asuman Ozdaglar.
2020.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical
guarantees: A model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 33 (2020),
3557–3568.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan
Chung, Dong Yin, and Kannan
Ramchandran. 2020.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 33 (2020),
19586–19597.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Biyao Gong, Tianzhang
Xing, Zhidan Liu, Junfeng Wang, and
Xiuya Liu. 2022.

</span>
<span class="ltx_bibblock">Adaptive Clustered Federated Learning for
Heterogeneous Data in Edge Computing.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">Mobile Networks and Applications</em>
27, 4 (2022),
1520–1530.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely and Richtárik (2020)</span>
<span class="ltx_bibblock">
Filip Hanzely and Peter
Richtárik. 2020.

</span>
<span class="ltx_bibblock">Federated learning of a mixture of global and local
models.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Andrew Hard, Kanishka
Rao, Rajiv Mathews, Swaroop Ramaswamy,
Françoise Beaufays, Sean
Augenstein, Hubert Eichner, Chloé
Kiddon, and Daniel Ramage.
2018.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.03604</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition. In
<em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer
vision and pattern recognition</em>. 770–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Islam et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Md Sirajul Islam, Simin
Javaherian, Fei Xu, Xu Yuan,
Li Chen, and Nian-Feng Tzeng.
2024.

</span>
<span class="ltx_bibblock">FedClust: Optimizing Federated Learning on Non-IID
Data through Weight-Driven Client Clustering.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.04144</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Javaherian et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Simin Javaherian, Sanjeev
Panta, Shelby Williams, Md Sirajul
Islam, and Li Chen. 2024.

</span>
<span class="ltx_bibblock">FedFair^3: Unlocking Threefold Fairness in
Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">in IEEE International Conference on
Communications (ICC)</em> (2024), 1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Yihan Jiang, Jakub
Konečnỳ, Keith Rush, and
Sreeram Kannan. 2019.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via
model agnostic meta learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.12488</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan
McMahan, Brendan Avent, Aurélien
Bellet, Mehdi Bennis, Arjun Nitin
Bhagoji, Kallista Bonawitz, Zachary
Charles, Graham Cormode, Rachel
Cummings, et al<span id="bib.bib15.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.4.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in
Machine Learning</em> 14, 1–2
(2021), 1–210.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al<span id="bib.bib16.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy,
Satyen Kale, Mehryar Mohri,
Sashank Reddi, Sebastian Stich, and
Ananda Theertha Suresh. 2020.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for
federated learning. In <em id="bib.bib16.3.1" class="ltx_emph ltx_font_italic">International Conference on
Machine Learning</em>. PMLR, 5132–5143.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2009)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey
Hinton, et al<span id="bib.bib17.3.1" class="ltx_text">.</span> 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny
images.

</span>
<span class="ltx_bibblock">(2009).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Fan Lai, Xiangfeng Zhu,
Harsha V Madhyastha, and Mosharaf
Chowdhury. 2021.

</span>
<span class="ltx_bibblock">Oort: Efficient Federated Learning via Guided
Participant Selection. In <em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">OSDI</em>.
19–35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (1989)</span>
<span class="ltx_bibblock">
Yann LeCun, Bernhard
Boser, John S Denker, Donnie Henderson,
Richard E Howard, Wayne Hubbard, and
Lawrence D Jackel. 1989.

</span>
<span class="ltx_bibblock">Backpropagation applied to handwritten zip code
recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Neural computation</em> 1,
4 (1989), 541–551.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Qinbin Li, Yiqun Diao,
Quan Chen, and Bingsheng He.
2022.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An
experimental study. In <em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">2022 IEEE 38th
International Conference on Data Engineering (ICDE)</em>. IEEE,
965–978.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu,
Ahmad Beirami, and Virginia Smith.
2021.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through
personalization. In <em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">International Conference on
Machine Learning</em>. PMLR, 6357–6368.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu,
Manzil Zaheer, Maziar Sanjabi,
Ameet Talwalkar, and Virginia Smith.
2020.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>
2 (2020), 429–450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang,
Wenhao Yang, Shusen Wang, and
Zhihua Zhang. 2019.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.02189</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance
Liu, Liu Ziyin, Nicholas B Allen,
Randy P Auerbach, David Brent,
Ruslan Salakhutdinov, and Louis-Philippe
Morency. 2020.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning
with local and global representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.01523</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yang Liu, Anbu Huang,
Yun Luo, He Huang,
Youzhi Liu, Yuanyuan Chen,
Lican Feng, Tianjian Chen,
Han Yu, and Qiang Yang.
2020.

</span>
<span class="ltx_bibblock">Fedvision: An online visual object detection
platform powered by federated learning. In
<em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, Vol. 34. 13172–13179.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Mingsheng Long, Yue Cao,
Zhangjie Cao, Jianmin Wang, and
Michael I Jordan. 2018.

</span>
<span class="ltx_bibblock">Transferable representation learning with deep
adaptation networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">IEEE transactions on pattern analysis and
machine intelligence</em> 41, 12
(2018), 3071–3085.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Jun Luo, Matias Mendieta,
Chen Chen, and Shandong Wu.
2023.

</span>
<span class="ltx_bibblock">PGFed: Personalize Each Client’s Global Objective
for Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">International Conference on Computer Vision</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansour et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yishay Mansour, Mehryar
Mohri, Jae Ro, and Ananda Theertha
Suresh. 2020.

</span>
<span class="ltx_bibblock">Three approaches for personalization with
applications to federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.10619</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morafah et al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Mahdi Morafah, Saeed
Vahidian, Weijia Wang, and Bill Lin.
2023.

</span>
<span class="ltx_bibblock">FLIS: Clustered federated learning via inference
similarity for non-IID data distribution.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">IEEE Open Journal of the Computer Society</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Netzer et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2011)</span>
<span class="ltx_bibblock">
Yuval Netzer, Tao Wang,
Adam Coates, Alessandro Bissacco,
Bo Wu, and Andrew Y Ng.
2011.

</span>
<span class="ltx_bibblock">Reading digits in natural images with unsupervised
feature learning.

</span>
<span class="ltx_bibblock">(2011).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiaomin Ouyang, Zhiyuan
Xie, Jiayu Zhou, Jianwei Huang, and
Guoliang Xing. 2021.

</span>
<span class="ltx_bibblock">Clusterfl: a similarity-aware federated learning
system for human activity recognition. In
<em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 19th Annual International
Conference on Mobile Systems, Applications, and Services</em>.
54–66.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross,
Francisco Massa, Adam Lerer,
James Bradbury, Gregory Chanan,
Trevor Killeen, Zeming Lin,
Natalia Gimelshein, Luca Antiga,
et al<span id="bib.bib33.3.1" class="ltx_text">.</span> 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep
learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.4.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rozantsev et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Artem Rozantsev, Mathieu
Salzmann, and Pascal Fua.
2018.

</span>
<span class="ltx_bibblock">Beyond sharing weights for deep domain adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">IEEE transactions on pattern analysis and
machine intelligence</em> 41, 4
(2018), 801–814.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Felix Sattler,
Klaus-Robert Müller, and Wojciech
Samek. 2020.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic
distributed multitask optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and
learning systems</em> 32, 8
(2020), 3710–3722.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Simonyan and Zisserman (2014)</span>
<span class="ltx_bibblock">
Karen Simonyan and
Andrew Zisserman. 2014.

</span>
<span class="ltx_bibblock">Very deep convolutional networks for large-scale
image recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.1556</em>
(2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai
Chiang, Maziar Sanjabi, and Ameet S
Talwalkar. 2017.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu,
Lizhen Cui, and Qiang Yang.
2022.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and
Learning Systems</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tu et al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Linlin Tu, Xiaomin
Ouyang, Jiayu Zhou, Yuze He, and
Guoliang Xing. 2021.

</span>
<span class="ltx_bibblock">Feddl: Federated learning via dynamic layer sharing
for human activity recognition. In <em id="bib.bib39.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the 19th ACM Conference on Embedded Networked Sensor Systems</em>.
15–28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vahidian et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Saeed Vahidian, Mahdi
Morafah, Weijia Wang, Vyacheslav
Kungurtsev, Chen Chen, Mubarak Shah,
and Bill Lin. 2022.

</span>
<span class="ltx_bibblock">Efficient Distribution Similarity Identification in
Clustered Federated Learning via Principal Angles Between Client Data
Subspaces.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.10526</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2020a)</span>
<span class="ltx_bibblock">
Hao Wang, Zakhary Kaplan,
Di Niu, and Baochun Li.
2020a.

</span>
<span class="ltx_bibblock">Optimizing federated learning on non-iid data with
reinforcement learning. In <em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2020-IEEE
Conference on Computer Communications</em>. IEEE, 1698–1707.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2020b)</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu,
Hao Liang, Gauri Joshi, and
H Vincent Poor. 2020b.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in
heterogeneous federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 33 (2020),
7611–7623.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Han Xiao, Kashif Rasul,
and Roland Vollgraf. 2017.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for
benchmarking machine learning algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1708.07747</em>
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yosinski et al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Jason Yosinski, Jeff
Clune, Yoshua Bengio, and Hod Lipson.
2014.

</span>
<span class="ltx_bibblock">How transferable are features in deep neural
networks?

</span>
<span class="ltx_bibblock"><em id="bib.bib44.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 27 (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li,
Liangzhen Lai, Naveen Suda,
Damon Civin, and Vikas Chandra.
2018.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.07123" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.07124" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.07124">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.07124" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.07125" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 15:13:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
