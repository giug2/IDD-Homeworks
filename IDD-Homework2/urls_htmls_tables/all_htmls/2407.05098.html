<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.05098] FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning</title><meta property="og:description" content="Despite extensive research into data heterogeneity in federated learning (FL), system heterogeneity remains a significant yet often overlooked challenge. Traditional FL approaches typically assume homogeneous hardware …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.05098">

<!--Generated on Mon Aug  5 17:06:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning Diffusion Model Knowledge Distillation ">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">(eccv)                Package eccv Warning: Package ‘hyperref’ is loaded with option ‘pagebackref’, which is *not* recommended for camera-ready version</p>
</div>
<span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>University of Helsinki, Helsinki, Finland
</span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Zhejiang University, Hangzhou, China
</span></span></span><span id="id3" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>Simon Fraser University, Burnaby, Canada
</span></span></span><span id="id4" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">institutetext: </span>Norwegian University of Science and Technology, Gjøvik, Norway </span></span></span><span id="id5" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_note_type">institutetext: </span>The Hong Kong University of Science and Technology (Guangzhou), China
</span></span></span>
<h1 class="ltx_title ltx_title_document">FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Boyu Fan 
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenrui Wu
</span><span class="ltx_author_notes">2233</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiang Su
</span><span class="ltx_author_notes">44</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pan Hui
</span><span class="ltx_author_notes">5511</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Despite extensive research into data heterogeneity in federated learning (FL), system heterogeneity remains a significant yet often overlooked challenge. Traditional FL approaches typically assume homogeneous hardware resources across FL clients, implying that clients can train a global model within a comparable time frame. However, in practical FL systems, clients often have heterogeneous resources, which impacts their training capacity. This discrepancy underscores the importance of exploring model-heterogeneous FL, a paradigm allowing clients to train different models based on their resource capabilities. To address this challenge, we introduce FedTSA, a cluster-based two-stage aggregation method tailored for system heterogeneity in FL. FedTSA begins by clustering clients based on their capabilities, then performs a two-stage aggregation: conventional weight averaging for homogeneous models in Stage 1, and deep mutual learning with a diffusion model for aggregating heterogeneous models in Stage 2. Extensive experiments demonstrate that FedTSA not only outperforms the baselines but also explores various factors influencing model performance, validating FedTSA as a promising approach for model-heterogeneous FL.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Federated Learning Diffusion Model Knowledge Distillation 
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) has emerged as a promising paradigm for privacy-preserving machine learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>. However, system heterogeneity, due to varying client capabilities, poses significant challenges for deploying FL in practice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>. Traditional FL frameworks operate under the assumption that all clients share the same model structure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. In fact, the real-world environments include devices with different capabilities, ranging from resource-constrained devices to high-performance GPU-enabled machines. Some devices may struggle with the computational demands of the global model, leading to prolonged training times, while others might be underutilized, which can lead to inefficiencies and potential training biases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2407.05098/assets/img/introduction_eccv.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="213" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Left:<span id="S1.F1.5.2.1" class="ltx_text ltx_font_upright"> FL in homogeneous settings. All clients share the same global model and the server performs weight averaging to aggregate them. </span>Right:<span id="S1.F1.5.2.2" class="ltx_text ltx_font_upright"> FL in heterogeneous settings. Due to the resource constraints, some clients can only train simple models, leading to heterogeneous models. As these models have different dimensions, how to aggregate them becomes the core challenge.</span></span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A vanilla idea is to allow clients to adopt different model architectures tailored to their capabilities. For instance, a resource-constrained Raspberry Pi might use a two-layer convolutional neural network (CNN) model, while a GPU-equipped PC could employ a ResNet18 model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. When using traditional FL algorithms, such as FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, aggregating these diverse architectures becomes challenging due to the varying dimensions of model parameters, as illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. This discrepancy makes the weight averaging on the server infeasible. Knowledge distillation (KD)-based approaches have been proposed to mitigate this challenge by only aggregating and aligning with the global knowledge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. However, they often require a public dataset on the client side, raising privacy and resource concerns <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. Data-free KD-based methods have emerged as potential solutions to mitigate this limitation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, but they come with substantial communication costs and the issue of low-quality generated data. Another strategy is partial training, where each client trains a subnetwork of the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and only the overlapping subnetworks will be aggregated. However, a critical issue in partial training is the non-overlapping model parameters, which may contain important information but never get updated.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose FedTSA, a cluster-based two-stage aggregation method for model-heterogeneous FL. For any given FL training task, FedTSA starts with clustering clients according to their hardware resources using kernel density estimation (KDE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Afterwards, FedTSA assigns varying pruning rates to different clusters, leading to heterogeneous models across clusters. Within each cluster, the homogeneous clients conduct local updates and perform model aggregation in conventional FL training styles, a process we refer to as Stage 1 aggregation. To aggregate heterogeneous models from Stage 1, we employ deep mutual learning (DML) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> on the server based on the data generated by a diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. This phase is refer to as Stage 2 aggregation. The employment of the diffusion model not only obviates the need for crafting public datasets but also fosters the generation of superior-quality data, enhancing DML efficacy. Moreover, unlike FedGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, computation-intensive data generation tasks are offloaded to the server side, with clients only sending prompts to guide this process, which ensures a high degree of flexibility in training tasks.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our extensive experiments on computer vision (CV) datasets demonstrate FedTSA’s effectiveness, outperforming other state-of-the-art model-heterogeneous FL approaches. We also provide an in-depth analysis of various factors influencing FedTSA, offering valuable insights for future model-heterogeneous FL research.
Our contributions are threefold:
1) We introduce the novel FedTSA framework to enable model-heterogeneous FL. FedTSA first clusters clients according to their processing capabilities using KDE, then conducts a two-stage aggregation to aggregate heterogeneous models.
2) FedTSA innovatively leverages a diffusion model to generate data, thereby addressing the challenges of constructing a public dataset. This approach not only enhances data privacy but also significantly boosts the framework’s adaptability to various training tasks.
3) Extensive experimental evaluations on three CV datasets demonstrate FedTSA’s superior performance over existing baselines. Moreover, our investigations into influential factors present critical insights, further demonstrating FedTSA’s effectiveness.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Model-heterogeneous FL.</span> Different from the conventional FL paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, model-heterogeneous FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> allows clients to train models of varying complexities based on their processing abilities, thus mitigating the system heterogeneity issue. Inspired by the idea of KD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> proposes FedMD, a logit-based FL algorithm. Instead of transferring model parameters, FedMD employs logits as the communicative data medium and trains the global model by aggregating and approaching these logits. However, FedMD relies on a public dataset to align the input data, leading to privacy concerns and extra communication costs. This problem exists in several similar works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Subsequent works such as FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and FedGen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> address these limitations by either leveraging unlabeled data or training a generator to produce synthetic data to achieve data-free KD. However, FedDF requires prior knowledge to choose proper unlabeled data, while FedGen suffers from high computation cost as the generators are deployed and worked in each client. Moreover, the quality of unlabeled data or data generated by generative adversarial networks (GAN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> cannot be guaranteed, potentially leading to a decrease in model performance. Based on the idea of class prototype <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, FedProto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> aggregates heterogeneous models by exchanging and aligning prototypes. In addition, HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> achieves model-heterogeneous FL by only aggregating the overlapping submodel parts, thus enabling clients to train submodels with different sizes. Despite existing methods adopt different strategies to achieve model-heterogeneous FL, none of them illustrate how to allocate different models to the clients.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Diffusion Models.</span> With large-scale training data and model parameters, various text-to-image generative models are now capable of creating high-quality images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. Among them, diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> have achieved significant success in the image synthesis domain and AI-generated content (AIGC) fields, such as the popular Stable Diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> and DALL-E2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. A typical diffusion model includes a forward diffusion stage and a reverse diffusion stage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Given a textual prompt, the diffusion model is able to convert Gaussian noise into a text-compliant image through an iterative denoising step. Despite diffusion models showcasing excellent performance, only a few works have leveraged them in FL. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> combine diffusion models with FL to mitigate non-IID problems, while <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> applies FL to the training process to address privacy issues.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">FedTSA is the first work that leverages the advantages of diffusion models to achieve model-heterogeneous FL. Compared to other methods that either use a well-crafted public dataset or train a generator on the client side, employing a diffusion model not only improves the quality of the generated data but also offers greater flexibility in changing training tasks and better privacy protection.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Motivation Study</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We motivate this study by presenting the impact of system heterogeneity through a small-scale experiment. We establish a heterogeneous system comprising four types of devices, including three Raspberry Pi 4B units, three LattePanda 2 Alpha 864s <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, two PCs without GPU, and one PC equipped with an NVIDIA 3080Ti GPU. These devices range from embedded systems to PCs with GPUs, effectively presenting the system heterogeneity prevalent in real-world scenarios. The core specifications of each device type are detailed in Table <a href="#S3.T2" title="Table 2 ‣ 3 Motivation Study ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Given the limited resources of the Raspberry Pi, we select a FL training task using the MNIST dataset and a CNN model. This model includes two convolutional layers with max pooling, followed by two fully connected layers. Each device serves as a FL client, with an additional machine serving as the central server for aggregation. We employ FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> in this study.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.T2.fig1.1.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S3.T2.fig1.2.2" class="ltx_text" style="font-size:90%;">Device Core Specifications.</span></figcaption>
<table id="S3.T2.fig1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.fig1.3.1.1" class="ltx_tr">
<th id="S3.T2.fig1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Device</th>
<th id="S3.T2.fig1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">CPU</th>
<th id="S3.T2.fig1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Memory</th>
<th id="S3.T2.fig1.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">GPU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.fig1.3.2.1" class="ltx_tr">
<th id="S3.T2.fig1.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Rasp Pi</th>
<td id="S3.T2.fig1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">A72, 1.8GHz</td>
<td id="S3.T2.fig1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">8GB</td>
<td id="S3.T2.fig1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t">N/A</td>
</tr>
<tr id="S3.T2.fig1.3.3.2" class="ltx_tr">
<th id="S3.T2.fig1.3.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">LattePanda</th>
<td id="S3.T2.fig1.3.3.2.2" class="ltx_td ltx_align_center">M3, 3.4GHz</td>
<td id="S3.T2.fig1.3.3.2.3" class="ltx_td ltx_align_center">8GB</td>
<td id="S3.T2.fig1.3.3.2.4" class="ltx_td ltx_align_center">N/A</td>
</tr>
<tr id="S3.T2.fig1.3.4.3" class="ltx_tr">
<th id="S3.T2.fig1.3.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">PC</th>
<td id="S3.T2.fig1.3.4.3.2" class="ltx_td ltx_align_center">i7, 2.2GHz</td>
<td id="S3.T2.fig1.3.4.3.3" class="ltx_td ltx_align_center">16GB</td>
<td id="S3.T2.fig1.3.4.3.4" class="ltx_td ltx_align_center">N/A</td>
</tr>
<tr id="S3.T2.fig1.3.5.4" class="ltx_tr">
<th id="S3.T2.fig1.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">PC with GPU</th>
<td id="S3.T2.fig1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">i7, 2.4GHz</td>
<td id="S3.T2.fig1.3.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">32GB</td>
<td id="S3.T2.fig1.3.5.4.4" class="ltx_td ltx_align_center ltx_border_bb">3080Ti</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.fig2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.T2.fig2.1.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S3.T2.fig2.2.2" class="ltx_text" style="font-size:90%;">Wall-clock convergence times in different settings.</span></figcaption>
<table id="S3.T2.fig2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.fig2.3.1.1" class="ltx_tr">
<th id="S3.T2.fig2.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"><span id="S3.T2.fig2.3.1.1.1.1" class="ltx_text ltx_font_bold">Setting</span></th>
<th id="S3.T2.fig2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.fig2.3.1.1.2.1" class="ltx_text ltx_font_bold">Time (s)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.fig2.3.2.1" class="ltx_tr">
<th id="S3.T2.fig2.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">All devices involved</th>
<td id="S3.T2.fig2.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">2731</td>
</tr>
<tr id="S3.T2.fig2.3.3.2" class="ltx_tr">
<th id="S3.T2.fig2.3.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">No Rasp Pi</th>
<td id="S3.T2.fig2.3.3.2.2" class="ltx_td ltx_align_center ltx_border_t">1428 (-47%)</td>
</tr>
<tr id="S3.T2.fig2.3.4.3" class="ltx_tr">
<th id="S3.T2.fig2.3.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">No Rasp Pi &amp; LattePanda</th>
<td id="S3.T2.fig2.3.4.3.2" class="ltx_td ltx_align_center ltx_border_t">210 (-92%)</td>
</tr>
<tr id="S3.T2.fig2.3.5.4" class="ltx_tr">
<th id="S3.T2.fig2.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Only PC with GPU</th>
<td id="S3.T2.fig2.3.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">143 (-95%)</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">We design four experiments to assess the impact of system heterogeneity. The settings and the wall-clock convergence times are detailed in Table <a href="#S3.T2" title="Table 2 ‣ 3 Motivation Study ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We can observe that when all devices participate in training, the convergence speed is extremely slow, exceeding 2700 seconds. This is attributed to tail latency <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> caused by the existence of Raspberry Pi devices, which delay the process even after other devices have completed their training. The convergence times for the remaining three experiments are reduced to 1428, 210, and 143 seconds, respectively, showing decreases of 47%, 92% and 95% compared to the initial scenario. These results show the idle times of faster devices, highlighting the significant impact of system heterogeneity on FL training efficiency.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Some existing works mitigate this issue by focusing on communication strategies, e.g., by designing asynchronous or semi-asynchronous FL algorithms to improve training efficiency <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. However, such methods either introduce excessive additional communication overhead or suffer from stale models. In this paper, we address this issue fundamentally by facilitating model-heterogeneous training. Specifically, we allow different devices to select models that are well-suited to their system resources, thereby effectively addressing the issue of prolonged waiting times due to insufficient resources.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Problem Definition</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.11" class="ltx_p">In this work, we consider a system heterogeneity setting in FL. Suppose we have <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">n</annotation></semantics></math> clients with their private local dataset <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐷</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">D_{i}</annotation></semantics></math> from distribution <math id="S4.SS1.p1.3.m3.2" class="ltx_Math" alttext="P_{i}(x,y)" display="inline"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3" xref="S4.SS1.p1.3.m3.2.3.cmml"><msub id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.2.cmml"><mi id="S4.SS1.p1.3.m3.2.3.2.2" xref="S4.SS1.p1.3.m3.2.3.2.2.cmml">P</mi><mi id="S4.SS1.p1.3.m3.2.3.2.3" xref="S4.SS1.p1.3.m3.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.3.m3.2.3.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.3.m3.2.3.3.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.1" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">x</mi><mo id="S4.SS1.p1.3.m3.2.3.3.2.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.3" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3"><times id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.1"></times><apply id="S4.SS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.3.2.1.cmml" xref="S4.SS1.p1.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2.2">𝑃</ci><ci id="S4.SS1.p1.3.m3.2.3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S4.SS1.p1.3.m3.2.3.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.3.2"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑥</ci><ci id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">P_{i}(x,y)</annotation></semantics></math>, with <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">x</annotation></semantics></math> and <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">y</annotation></semantics></math> representing the input data and their respective labels. Unlike most works that assume clients have similar hardware resources, we consider the presence of heterogeneous resource distributions among clients, denoted as <math id="S4.SS1.p1.6.m6.4" class="ltx_Math" alttext="R_{1},R_{2},...,R_{n}" display="inline"><semantics id="S4.SS1.p1.6.m6.4a"><mrow id="S4.SS1.p1.6.m6.4.4.3" xref="S4.SS1.p1.6.m6.4.4.4.cmml"><msub id="S4.SS1.p1.6.m6.2.2.1.1" xref="S4.SS1.p1.6.m6.2.2.1.1.cmml"><mi id="S4.SS1.p1.6.m6.2.2.1.1.2" xref="S4.SS1.p1.6.m6.2.2.1.1.2.cmml">R</mi><mn id="S4.SS1.p1.6.m6.2.2.1.1.3" xref="S4.SS1.p1.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.6.m6.4.4.3.4" xref="S4.SS1.p1.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.6.m6.3.3.2.2" xref="S4.SS1.p1.6.m6.3.3.2.2.cmml"><mi id="S4.SS1.p1.6.m6.3.3.2.2.2" xref="S4.SS1.p1.6.m6.3.3.2.2.2.cmml">R</mi><mn id="S4.SS1.p1.6.m6.3.3.2.2.3" xref="S4.SS1.p1.6.m6.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.6.m6.4.4.3.5" xref="S4.SS1.p1.6.m6.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">…</mi><mo id="S4.SS1.p1.6.m6.4.4.3.6" xref="S4.SS1.p1.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.6.m6.4.4.3.3" xref="S4.SS1.p1.6.m6.4.4.3.3.cmml"><mi id="S4.SS1.p1.6.m6.4.4.3.3.2" xref="S4.SS1.p1.6.m6.4.4.3.3.2.cmml">R</mi><mi id="S4.SS1.p1.6.m6.4.4.3.3.3" xref="S4.SS1.p1.6.m6.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.4b"><list id="S4.SS1.p1.6.m6.4.4.4.cmml" xref="S4.SS1.p1.6.m6.4.4.3"><apply id="S4.SS1.p1.6.m6.2.2.1.1.cmml" xref="S4.SS1.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S4.SS1.p1.6.m6.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.2.2.1.1.2.cmml" xref="S4.SS1.p1.6.m6.2.2.1.1.2">𝑅</ci><cn type="integer" id="S4.SS1.p1.6.m6.2.2.1.1.3.cmml" xref="S4.SS1.p1.6.m6.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.p1.6.m6.3.3.2.2.cmml" xref="S4.SS1.p1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.3.3.2.2.1.cmml" xref="S4.SS1.p1.6.m6.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.3.3.2.2.2.cmml" xref="S4.SS1.p1.6.m6.3.3.2.2.2">𝑅</ci><cn type="integer" id="S4.SS1.p1.6.m6.3.3.2.2.3.cmml" xref="S4.SS1.p1.6.m6.3.3.2.2.3">2</cn></apply><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">…</ci><apply id="S4.SS1.p1.6.m6.4.4.3.3.cmml" xref="S4.SS1.p1.6.m6.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.4.4.3.3.1.cmml" xref="S4.SS1.p1.6.m6.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p1.6.m6.4.4.3.3.2.cmml" xref="S4.SS1.p1.6.m6.4.4.3.3.2">𝑅</ci><ci id="S4.SS1.p1.6.m6.4.4.3.3.3.cmml" xref="S4.SS1.p1.6.m6.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.4c">R_{1},R_{2},...,R_{n}</annotation></semantics></math>. Due to the challenge of heterogeneity, a standardized global model <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="W_{g}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑊</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">W_{g}</annotation></semantics></math> loses its applicability, as clients with limited resources cannot afford the computational costs if <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="W_{g}" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><msub id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.p1.8.m8.1.1.2" xref="S4.SS1.p1.8.m8.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.8.m8.1.1.3" xref="S4.SS1.p1.8.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.2">𝑊</ci><ci id="S4.SS1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.p1.8.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">W_{g}</annotation></semantics></math> is complex. Therefore, the problem becomes how to enable clients to deploy different models <math id="S4.SS1.p1.9.m9.4" class="ltx_Math" alttext="W_{1},W_{2},...,W_{n}" display="inline"><semantics id="S4.SS1.p1.9.m9.4a"><mrow id="S4.SS1.p1.9.m9.4.4.3" xref="S4.SS1.p1.9.m9.4.4.4.cmml"><msub id="S4.SS1.p1.9.m9.2.2.1.1" xref="S4.SS1.p1.9.m9.2.2.1.1.cmml"><mi id="S4.SS1.p1.9.m9.2.2.1.1.2" xref="S4.SS1.p1.9.m9.2.2.1.1.2.cmml">W</mi><mn id="S4.SS1.p1.9.m9.2.2.1.1.3" xref="S4.SS1.p1.9.m9.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.9.m9.4.4.3.4" xref="S4.SS1.p1.9.m9.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.9.m9.3.3.2.2" xref="S4.SS1.p1.9.m9.3.3.2.2.cmml"><mi id="S4.SS1.p1.9.m9.3.3.2.2.2" xref="S4.SS1.p1.9.m9.3.3.2.2.2.cmml">W</mi><mn id="S4.SS1.p1.9.m9.3.3.2.2.3" xref="S4.SS1.p1.9.m9.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.9.m9.4.4.3.5" xref="S4.SS1.p1.9.m9.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S4.SS1.p1.9.m9.4.4.3.6" xref="S4.SS1.p1.9.m9.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.9.m9.4.4.3.3" xref="S4.SS1.p1.9.m9.4.4.3.3.cmml"><mi id="S4.SS1.p1.9.m9.4.4.3.3.2" xref="S4.SS1.p1.9.m9.4.4.3.3.2.cmml">W</mi><mi id="S4.SS1.p1.9.m9.4.4.3.3.3" xref="S4.SS1.p1.9.m9.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.4b"><list id="S4.SS1.p1.9.m9.4.4.4.cmml" xref="S4.SS1.p1.9.m9.4.4.3"><apply id="S4.SS1.p1.9.m9.2.2.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.2.2.1.1.2.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1.2">𝑊</ci><cn type="integer" id="S4.SS1.p1.9.m9.2.2.1.1.3.cmml" xref="S4.SS1.p1.9.m9.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.p1.9.m9.3.3.2.2.cmml" xref="S4.SS1.p1.9.m9.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.3.3.2.2.1.cmml" xref="S4.SS1.p1.9.m9.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.9.m9.3.3.2.2.2.cmml" xref="S4.SS1.p1.9.m9.3.3.2.2.2">𝑊</ci><cn type="integer" id="S4.SS1.p1.9.m9.3.3.2.2.3.cmml" xref="S4.SS1.p1.9.m9.3.3.2.2.3">2</cn></apply><ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">…</ci><apply id="S4.SS1.p1.9.m9.4.4.3.3.cmml" xref="S4.SS1.p1.9.m9.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.4.4.3.3.1.cmml" xref="S4.SS1.p1.9.m9.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p1.9.m9.4.4.3.3.2.cmml" xref="S4.SS1.p1.9.m9.4.4.3.3.2">𝑊</ci><ci id="S4.SS1.p1.9.m9.4.4.3.3.3.cmml" xref="S4.SS1.p1.9.m9.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.4c">W_{1},W_{2},...,W_{n}</annotation></semantics></math> according to their respective resources <math id="S4.SS1.p1.10.m10.4" class="ltx_Math" alttext="R_{1},R_{2},...,R_{n}" display="inline"><semantics id="S4.SS1.p1.10.m10.4a"><mrow id="S4.SS1.p1.10.m10.4.4.3" xref="S4.SS1.p1.10.m10.4.4.4.cmml"><msub id="S4.SS1.p1.10.m10.2.2.1.1" xref="S4.SS1.p1.10.m10.2.2.1.1.cmml"><mi id="S4.SS1.p1.10.m10.2.2.1.1.2" xref="S4.SS1.p1.10.m10.2.2.1.1.2.cmml">R</mi><mn id="S4.SS1.p1.10.m10.2.2.1.1.3" xref="S4.SS1.p1.10.m10.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.10.m10.4.4.3.4" xref="S4.SS1.p1.10.m10.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.10.m10.3.3.2.2" xref="S4.SS1.p1.10.m10.3.3.2.2.cmml"><mi id="S4.SS1.p1.10.m10.3.3.2.2.2" xref="S4.SS1.p1.10.m10.3.3.2.2.2.cmml">R</mi><mn id="S4.SS1.p1.10.m10.3.3.2.2.3" xref="S4.SS1.p1.10.m10.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.10.m10.4.4.3.5" xref="S4.SS1.p1.10.m10.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">…</mi><mo id="S4.SS1.p1.10.m10.4.4.3.6" xref="S4.SS1.p1.10.m10.4.4.4.cmml">,</mo><msub id="S4.SS1.p1.10.m10.4.4.3.3" xref="S4.SS1.p1.10.m10.4.4.3.3.cmml"><mi id="S4.SS1.p1.10.m10.4.4.3.3.2" xref="S4.SS1.p1.10.m10.4.4.3.3.2.cmml">R</mi><mi id="S4.SS1.p1.10.m10.4.4.3.3.3" xref="S4.SS1.p1.10.m10.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.4b"><list id="S4.SS1.p1.10.m10.4.4.4.cmml" xref="S4.SS1.p1.10.m10.4.4.3"><apply id="S4.SS1.p1.10.m10.2.2.1.1.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.2.2.1.1.1.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.2.2.1.1.2.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.2">𝑅</ci><cn type="integer" id="S4.SS1.p1.10.m10.2.2.1.1.3.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.p1.10.m10.3.3.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.2.2.1.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.3.3.2.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2">𝑅</ci><cn type="integer" id="S4.SS1.p1.10.m10.3.3.2.2.3.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.3">2</cn></apply><ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">…</ci><apply id="S4.SS1.p1.10.m10.4.4.3.3.cmml" xref="S4.SS1.p1.10.m10.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.4.4.3.3.1.cmml" xref="S4.SS1.p1.10.m10.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p1.10.m10.4.4.3.3.2.cmml" xref="S4.SS1.p1.10.m10.4.4.3.3.2">𝑅</ci><ci id="S4.SS1.p1.10.m10.4.4.3.3.3.cmml" xref="S4.SS1.p1.10.m10.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.4c">R_{1},R_{2},...,R_{n}</annotation></semantics></math>, while still achieve FL training on the server side. Similar to conventional FL approaches, for the <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><msup id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mi id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">i</mi><mrow id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml"><mi id="S4.SS1.p1.11.m11.1.1.3.2" xref="S4.SS1.p1.11.m11.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.11.m11.1.1.3.1" xref="S4.SS1.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.11.m11.1.1.3.3" xref="S4.SS1.p1.11.m11.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">superscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">𝑖</ci><apply id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3"><times id="S4.SS1.p1.11.m11.1.1.3.1.cmml" xref="S4.SS1.p1.11.m11.1.1.3.1"></times><ci id="S4.SS1.p1.11.m11.1.1.3.2.cmml" xref="S4.SS1.p1.11.m11.1.1.3.2">𝑡</ci><ci id="S4.SS1.p1.11.m11.1.1.3.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">i^{th}</annotation></semantics></math> client, the training procedure is to minimize the loss as follows:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.4" class="ltx_Math" alttext="\arg\underset{W_{i}}{\min}\sum_{i=1}^{n}\frac{\left|D_{i}\right|}{N}\mathcal{\ell}_{ce}(f(W_{i};x),y)," display="block"><semantics id="S4.E1.m1.4a"><mrow id="S4.E1.m1.4.4.1" xref="S4.E1.m1.4.4.1.1.cmml"><mrow id="S4.E1.m1.4.4.1.1" xref="S4.E1.m1.4.4.1.1.cmml"><mrow id="S4.E1.m1.4.4.1.1.3" xref="S4.E1.m1.4.4.1.1.3.cmml"><mi id="S4.E1.m1.4.4.1.1.3.1" xref="S4.E1.m1.4.4.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E1.m1.4.4.1.1.3a" xref="S4.E1.m1.4.4.1.1.3.cmml">⁡</mo><munder accentunder="true" id="S4.E1.m1.4.4.1.1.3.2" xref="S4.E1.m1.4.4.1.1.3.2.cmml"><mi id="S4.E1.m1.4.4.1.1.3.2.2" xref="S4.E1.m1.4.4.1.1.3.2.2.cmml">min</mi><msub id="S4.E1.m1.4.4.1.1.3.2.1" xref="S4.E1.m1.4.4.1.1.3.2.1.cmml"><mi id="S4.E1.m1.4.4.1.1.3.2.1.2" xref="S4.E1.m1.4.4.1.1.3.2.1.2.cmml">W</mi><mi id="S4.E1.m1.4.4.1.1.3.2.1.3" xref="S4.E1.m1.4.4.1.1.3.2.1.3.cmml">i</mi></msub></munder></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.1.2" xref="S4.E1.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.4.4.1.1.1" xref="S4.E1.m1.4.4.1.1.1.cmml"><munderover id="S4.E1.m1.4.4.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E1.m1.4.4.1.1.1.2.2.2" xref="S4.E1.m1.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.4.4.1.1.1.2.2.3" xref="S4.E1.m1.4.4.1.1.1.2.2.3.cmml"><mi id="S4.E1.m1.4.4.1.1.1.2.2.3.2" xref="S4.E1.m1.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E1.m1.4.4.1.1.1.2.2.3.1" xref="S4.E1.m1.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.4.4.1.1.1.2.2.3.3" xref="S4.E1.m1.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.4.4.1.1.1.2.3" xref="S4.E1.m1.4.4.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S4.E1.m1.4.4.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.cmml"><mfrac id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.2.cmml"><mo id="S4.E1.m1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E1.m1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.2.cmml">​</mo><msub id="S4.E1.m1.4.4.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E1.m1.4.4.1.1.1.1.3.2" xref="S4.E1.m1.4.4.1.1.1.1.3.2.cmml">ℓ</mi><mrow id="S4.E1.m1.4.4.1.1.1.1.3.3" xref="S4.E1.m1.4.4.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.3.3.2" xref="S4.E1.m1.4.4.1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.1.1.1.3.3.1" xref="S4.E1.m1.4.4.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E1.m1.4.4.1.1.1.1.3.3.3" xref="S4.E1.m1.4.4.1.1.1.1.3.3.3.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.1.1.1.2a" xref="S4.E1.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">x</mi><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.4" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.4.4.1.1.1.1.1.1.3" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">y</mi><mo stretchy="false" id="S4.E1.m1.4.4.1.1.1.1.1.1.4" xref="S4.E1.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E1.m1.4.4.1.2" xref="S4.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.4b"><apply id="S4.E1.m1.4.4.1.1.cmml" xref="S4.E1.m1.4.4.1"><times id="S4.E1.m1.4.4.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.2"></times><apply id="S4.E1.m1.4.4.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.3"><arg id="S4.E1.m1.4.4.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.3.1"></arg><apply id="S4.E1.m1.4.4.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.3.2"><apply id="S4.E1.m1.4.4.1.1.3.2.1.cmml" xref="S4.E1.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.3.2.1.1.cmml" xref="S4.E1.m1.4.4.1.1.3.2.1">subscript</csymbol><ci id="S4.E1.m1.4.4.1.1.3.2.1.2.cmml" xref="S4.E1.m1.4.4.1.1.3.2.1.2">𝑊</ci><ci id="S4.E1.m1.4.4.1.1.3.2.1.3.cmml" xref="S4.E1.m1.4.4.1.1.3.2.1.3">𝑖</ci></apply><min id="S4.E1.m1.4.4.1.1.3.2.2.cmml" xref="S4.E1.m1.4.4.1.1.3.2.2"></min></apply></apply><apply id="S4.E1.m1.4.4.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1"><apply id="S4.E1.m1.4.4.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.2.1.cmml" xref="S4.E1.m1.4.4.1.1.1.2">superscript</csymbol><apply id="S4.E1.m1.4.4.1.1.1.2.2.cmml" xref="S4.E1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.2.2.1.cmml" xref="S4.E1.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S4.E1.m1.4.4.1.1.1.2.2.2.cmml" xref="S4.E1.m1.4.4.1.1.1.2.2.2"></sum><apply id="S4.E1.m1.4.4.1.1.1.2.2.3.cmml" xref="S4.E1.m1.4.4.1.1.1.2.2.3"><eq id="S4.E1.m1.4.4.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.2.2.3.1"></eq><ci id="S4.E1.m1.4.4.1.1.1.2.2.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E1.m1.4.4.1.1.1.2.2.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.4.4.1.1.1.2.3.cmml" xref="S4.E1.m1.4.4.1.1.1.2.3">𝑛</ci></apply><apply id="S4.E1.m1.4.4.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1"><times id="S4.E1.m1.4.4.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.2"></times><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><divide id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1"></divide><apply id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1"><abs id="S4.E1.m1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.2"></abs><apply id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.2">𝐷</ci><ci id="S4.E1.m1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3">𝑁</ci></apply><apply id="S4.E1.m1.4.4.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.2">ℓ</ci><apply id="S4.E1.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3"><times id="S4.E1.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3.1"></times><ci id="S4.E1.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3.2">𝑐</ci><ci id="S4.E1.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.3.3.3">𝑒</ci></apply></apply><interval closure="open" id="S4.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1"><apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1"><times id="S4.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.3">𝑓</ci><list id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1"><apply id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑥</ci></list></apply><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.4c">\arg\underset{W_{i}}{\min}\sum_{i=1}^{n}\frac{\left|D_{i}\right|}{N}\mathcal{\ell}_{ce}(f(W_{i};x),y),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.17" class="ltx_p">where <math id="S4.SS1.p1.12.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.p1.12.m1.1a"><mi id="S4.SS1.p1.12.m1.1.1" xref="S4.SS1.p1.12.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m1.1b"><ci id="S4.SS1.p1.12.m1.1.1.cmml" xref="S4.SS1.p1.12.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m1.1c">N</annotation></semantics></math> is the total number of the training data over all clients, <math id="S4.SS1.p1.13.m2.2" class="ltx_Math" alttext="f(W_{i},x)" display="inline"><semantics id="S4.SS1.p1.13.m2.2a"><mrow id="S4.SS1.p1.13.m2.2.2" xref="S4.SS1.p1.13.m2.2.2.cmml"><mi id="S4.SS1.p1.13.m2.2.2.3" xref="S4.SS1.p1.13.m2.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.13.m2.2.2.2" xref="S4.SS1.p1.13.m2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p1.13.m2.2.2.1.1" xref="S4.SS1.p1.13.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.13.m2.2.2.1.1.2" xref="S4.SS1.p1.13.m2.2.2.1.2.cmml">(</mo><msub id="S4.SS1.p1.13.m2.2.2.1.1.1" xref="S4.SS1.p1.13.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.13.m2.2.2.1.1.1.2" xref="S4.SS1.p1.13.m2.2.2.1.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.13.m2.2.2.1.1.1.3" xref="S4.SS1.p1.13.m2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.13.m2.2.2.1.1.3" xref="S4.SS1.p1.13.m2.2.2.1.2.cmml">,</mo><mi id="S4.SS1.p1.13.m2.1.1" xref="S4.SS1.p1.13.m2.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.p1.13.m2.2.2.1.1.4" xref="S4.SS1.p1.13.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m2.2b"><apply id="S4.SS1.p1.13.m2.2.2.cmml" xref="S4.SS1.p1.13.m2.2.2"><times id="S4.SS1.p1.13.m2.2.2.2.cmml" xref="S4.SS1.p1.13.m2.2.2.2"></times><ci id="S4.SS1.p1.13.m2.2.2.3.cmml" xref="S4.SS1.p1.13.m2.2.2.3">𝑓</ci><interval closure="open" id="S4.SS1.p1.13.m2.2.2.1.2.cmml" xref="S4.SS1.p1.13.m2.2.2.1.1"><apply id="S4.SS1.p1.13.m2.2.2.1.1.1.cmml" xref="S4.SS1.p1.13.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.13.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.13.m2.2.2.1.1.1.2">𝑊</ci><ci id="S4.SS1.p1.13.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.13.m2.2.2.1.1.1.3">𝑖</ci></apply><ci id="S4.SS1.p1.13.m2.1.1.cmml" xref="S4.SS1.p1.13.m2.1.1">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m2.2c">f(W_{i},x)</annotation></semantics></math> denotes the output of model <math id="S4.SS1.p1.14.m3.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S4.SS1.p1.14.m3.1a"><msub id="S4.SS1.p1.14.m3.1.1" xref="S4.SS1.p1.14.m3.1.1.cmml"><mi id="S4.SS1.p1.14.m3.1.1.2" xref="S4.SS1.p1.14.m3.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.14.m3.1.1.3" xref="S4.SS1.p1.14.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m3.1b"><apply id="S4.SS1.p1.14.m3.1.1.cmml" xref="S4.SS1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m3.1.1.1.cmml" xref="S4.SS1.p1.14.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m3.1.1.2.cmml" xref="S4.SS1.p1.14.m3.1.1.2">𝑊</ci><ci id="S4.SS1.p1.14.m3.1.1.3.cmml" xref="S4.SS1.p1.14.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m3.1c">W_{i}</annotation></semantics></math> give the input data <math id="S4.SS1.p1.15.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.15.m4.1a"><mi id="S4.SS1.p1.15.m4.1.1" xref="S4.SS1.p1.15.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m4.1b"><ci id="S4.SS1.p1.15.m4.1.1.cmml" xref="S4.SS1.p1.15.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m4.1c">x</annotation></semantics></math>, and <math id="S4.SS1.p1.16.m5.1" class="ltx_Math" alttext="\mathcal{\ell}_{ce}" display="inline"><semantics id="S4.SS1.p1.16.m5.1a"><msub id="S4.SS1.p1.16.m5.1.1" xref="S4.SS1.p1.16.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.16.m5.1.1.2" xref="S4.SS1.p1.16.m5.1.1.2.cmml">ℓ</mi><mrow id="S4.SS1.p1.16.m5.1.1.3" xref="S4.SS1.p1.16.m5.1.1.3.cmml"><mi id="S4.SS1.p1.16.m5.1.1.3.2" xref="S4.SS1.p1.16.m5.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.16.m5.1.1.3.1" xref="S4.SS1.p1.16.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.16.m5.1.1.3.3" xref="S4.SS1.p1.16.m5.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m5.1b"><apply id="S4.SS1.p1.16.m5.1.1.cmml" xref="S4.SS1.p1.16.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m5.1.1.1.cmml" xref="S4.SS1.p1.16.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.16.m5.1.1.2.cmml" xref="S4.SS1.p1.16.m5.1.1.2">ℓ</ci><apply id="S4.SS1.p1.16.m5.1.1.3.cmml" xref="S4.SS1.p1.16.m5.1.1.3"><times id="S4.SS1.p1.16.m5.1.1.3.1.cmml" xref="S4.SS1.p1.16.m5.1.1.3.1"></times><ci id="S4.SS1.p1.16.m5.1.1.3.2.cmml" xref="S4.SS1.p1.16.m5.1.1.3.2">𝑐</ci><ci id="S4.SS1.p1.16.m5.1.1.3.3.cmml" xref="S4.SS1.p1.16.m5.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m5.1c">\mathcal{\ell}_{ce}</annotation></semantics></math> is the cross entropy-loss. However, the varied architectures of models <math id="S4.SS1.p1.17.m6.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S4.SS1.p1.17.m6.1a"><msub id="S4.SS1.p1.17.m6.1.1" xref="S4.SS1.p1.17.m6.1.1.cmml"><mi id="S4.SS1.p1.17.m6.1.1.2" xref="S4.SS1.p1.17.m6.1.1.2.cmml">W</mi><mi id="S4.SS1.p1.17.m6.1.1.3" xref="S4.SS1.p1.17.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m6.1b"><apply id="S4.SS1.p1.17.m6.1.1.cmml" xref="S4.SS1.p1.17.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.17.m6.1.1.1.cmml" xref="S4.SS1.p1.17.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.17.m6.1.1.2.cmml" xref="S4.SS1.p1.17.m6.1.1.2">𝑊</ci><ci id="S4.SS1.p1.17.m6.1.1.3.cmml" xref="S4.SS1.p1.17.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m6.1c">W_{i}</annotation></semantics></math> imply that the model parameters from clients are incompatible with elementary weight averaging, since they have different dimensions. Therefore, a new strategy is required to aggregate these model parameters on the server side to achieve global update. To tackle this dilemma, we propose a two-stage aggregation framework FedTSA, where clients with similar resources conduct conventional weight averaging within a cluster, while clients with significantly different resources contribute to each other by DML outside the cluster.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Two-Stage Aggregation Framework</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Figure <a href="#S4.F2" title="Figure 2 ‣ 4.2 Two-Stage Aggregation Framework ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the FedTSA framework, highlighting two stages of aggregation, i.e., in-cluster weight averaging aggregation (Stage 1) and server-side DML aggregation (Stage 2). In Stage 1, we harness a resource-driven clustering methodology to categorize clients, leading to <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">n</annotation></semantics></math> distinct clusters. Each cluster receives a unique pruning rate, creating models of varying complexities. Then, clients conduct local updates, but only updates from the same cluster perform weight aggregation, as they share an identical model architecture and thus possess equivalent parameter dimensions. These cluster-based models are sent to the server for Stage 2 aggregation.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2407.05098/assets/img/framework_eccv.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="220" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">FedTSA framework with two-stage aggregation.</span></figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Stage 2 in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.2 Two-Stage Aggregation Framework ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> depicts how models with different architectures achieve aggregation with the help of DML and a diffusion model. Here, data generated from the diffusion model enables knowledge transfer between heterogeneous models. Specifically, each model initially takes these data as inputs to generate logits, which represent the output vectors of the neural network before applying the softmax function. Afterwards, the models perform gradient descent using the same generated data with Kullback Leibler (KL) divergence loss. Contrary to conventional KD-based FL methods, in our setting, no global model exists on the server side. Therefore, KL divergence loss is calculated by comparing each set of logits with a consensus. In this context, the consensus is defined as the average of all logits generated by different models. After the DML process, knowledge is interchanged among models, finishing Stage 2 aggregation. The updated models are sent back to their respective clusters for further updates. Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Two-Stage Aggregation Framework ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> outlines the FedTSA learning process, where the LocalUpdate function is the same as FedAvg.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The diffusion model serves as a fundamental component in this framework, offering three advantages over other KD-based FL methods. First, it eliminates the need for a well-prepared public dataset deployed on server and client sides, thereby reducing client-side computational costs and manpower. Second, it produces higher quality data than GAN-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, improving the quality of logits and benefiting the DML process. Third, by simply altering the prompts, clients are enabled to seamlessly transition between different training tasks.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedTSA</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">m</annotation></semantics></math> clients, prompt <math id="alg1.l1.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">P</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">Server initializes the proxy task to the clients.

</div>
<div id="alg1.l3" class="ltx_listingline">Server collects the running time <math id="alg1.l3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">T</annotation></semantics></math> from all clients.

</div>
<div id="alg1.l4" class="ltx_listingline">clusters<math id="alg1.l4.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mo stretchy="false" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\leftarrow</annotation></semantics></math><span id="alg1.l4.1" class="ltx_text ltx_font_bold">Clustering(<math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l4.1.m1.1a"><mi id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">T</annotation></semantics></math>)</span> <span id="alg1.l4.2" class="ltx_text" style="float:right;"><math id="alg1.l4.2.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l4.2.m1.1a"><mo id="alg1.l4.2.m1.1.1" xref="alg1.l4.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.2.m1.1b"><ci id="alg1.l4.2.m1.1.1.cmml" xref="alg1.l4.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.2.m1.1c">\triangleright</annotation></semantics></math> Clustering is implemented according to Sec <a href="#S4.SS3" title="4.3 Resource-oriented Clustering with Pruned Models ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.4" class="ltx_Math" alttext="t=0,1,\ldots,T-1" display="inline"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><mi id="alg1.l5.m1.4.4.3" xref="alg1.l5.m1.4.4.3.cmml">t</mi><mo id="alg1.l5.m1.4.4.2" xref="alg1.l5.m1.4.4.2.cmml">=</mo><mrow id="alg1.l5.m1.4.4.1.1" xref="alg1.l5.m1.4.4.1.2.cmml"><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">0</mn><mo id="alg1.l5.m1.4.4.1.1.2" xref="alg1.l5.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">1</mn><mo id="alg1.l5.m1.4.4.1.1.3" xref="alg1.l5.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">…</mi><mo id="alg1.l5.m1.4.4.1.1.4" xref="alg1.l5.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l5.m1.4.4.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.2" xref="alg1.l5.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l5.m1.4.4.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l5.m1.4.4.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><eq id="alg1.l5.m1.4.4.2.cmml" xref="alg1.l5.m1.4.4.2"></eq><ci id="alg1.l5.m1.4.4.3.cmml" xref="alg1.l5.m1.4.4.3">𝑡</ci><list id="alg1.l5.m1.4.4.1.2.cmml" xref="alg1.l5.m1.4.4.1.1"><cn type="integer" id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">0</cn><cn type="integer" id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">1</cn><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">…</ci><apply id="alg1.l5.m1.4.4.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1"><minus id="alg1.l5.m1.4.4.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1"></minus><ci id="alg1.l5.m1.4.4.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l5.m1.4.4.1.1.1.3.cmml" xref="alg1.l5.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">t=0,1,\ldots,T-1</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l6" class="ltx_listingline">     <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> cluster <math id="alg1.l6.m1.1" class="ltx_Math" alttext="c\in" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">c</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑐</ci><csymbol cd="latexml" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">c\in</annotation></semantics></math> clusters in parallel <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">         <span id="alg1.l7.1" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l7.m1.1" class="ltx_Math" alttext="i\in" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">i</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∈</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑖</ci><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">i\in</annotation></semantics></math> cluster <math id="alg1.l7.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">c</annotation></semantics></math> in parallel <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">              <math id="alg1.l8.m1.1" class="ltx_Math" alttext="w_{c}^{i}\leftarrow" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msubsup id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2.2" xref="alg1.l8.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.2.2.3" xref="alg1.l8.m1.1.1.2.2.3.cmml">c</mi><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">superscript</csymbol><apply id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l8.m1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.2.2.3">𝑐</ci></apply><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">w_{c}^{i}\leftarrow</annotation></semantics></math> LocalUpdate<math id="alg1.l8.m2.2" class="ltx_Math" alttext="(i,w_{c}^{i})" display="inline"><semantics id="alg1.l8.m2.2a"><mrow id="alg1.l8.m2.2.2.1" xref="alg1.l8.m2.2.2.2.cmml"><mo stretchy="false" id="alg1.l8.m2.2.2.1.2" xref="alg1.l8.m2.2.2.2.cmml">(</mo><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">i</mi><mo id="alg1.l8.m2.2.2.1.3" xref="alg1.l8.m2.2.2.2.cmml">,</mo><msubsup id="alg1.l8.m2.2.2.1.1" xref="alg1.l8.m2.2.2.1.1.cmml"><mi id="alg1.l8.m2.2.2.1.1.2.2" xref="alg1.l8.m2.2.2.1.1.2.2.cmml">w</mi><mi id="alg1.l8.m2.2.2.1.1.2.3" xref="alg1.l8.m2.2.2.1.1.2.3.cmml">c</mi><mi id="alg1.l8.m2.2.2.1.1.3" xref="alg1.l8.m2.2.2.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l8.m2.2.2.1.4" xref="alg1.l8.m2.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.2b"><interval closure="open" id="alg1.l8.m2.2.2.2.cmml" xref="alg1.l8.m2.2.2.1"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑖</ci><apply id="alg1.l8.m2.2.2.1.1.cmml" xref="alg1.l8.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1">superscript</csymbol><apply id="alg1.l8.m2.2.2.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.2.1.cmml" xref="alg1.l8.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l8.m2.2.2.1.1.2.2.cmml" xref="alg1.l8.m2.2.2.1.1.2.2">𝑤</ci><ci id="alg1.l8.m2.2.2.1.1.2.3.cmml" xref="alg1.l8.m2.2.2.1.1.2.3">𝑐</ci></apply><ci id="alg1.l8.m2.2.2.1.1.3.cmml" xref="alg1.l8.m2.2.2.1.1.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.2c">(i,w_{c}^{i})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">         <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">         <math id="alg1.l10.m1.1" class="ltx_Math" alttext="w_{c}^{t}=\frac{1}{\left|c\right|}{\textstyle\sum_{k\in c}w_{k}}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.2" xref="alg1.l10.m1.1.2.cmml"><msubsup id="alg1.l10.m1.1.2.2" xref="alg1.l10.m1.1.2.2.cmml"><mi id="alg1.l10.m1.1.2.2.2.2" xref="alg1.l10.m1.1.2.2.2.2.cmml">w</mi><mi id="alg1.l10.m1.1.2.2.2.3" xref="alg1.l10.m1.1.2.2.2.3.cmml">c</mi><mi id="alg1.l10.m1.1.2.2.3" xref="alg1.l10.m1.1.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l10.m1.1.2.1" xref="alg1.l10.m1.1.2.1.cmml">=</mo><mrow id="alg1.l10.m1.1.2.3" xref="alg1.l10.m1.1.2.3.cmml"><mfrac id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">1</mn><mrow id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo><mi id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml">c</mi><mo id="alg1.l10.m1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.2.3.1" xref="alg1.l10.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l10.m1.1.2.3.2" xref="alg1.l10.m1.1.2.3.2.cmml"><msub id="alg1.l10.m1.1.2.3.2.1" xref="alg1.l10.m1.1.2.3.2.1.cmml"><mo id="alg1.l10.m1.1.2.3.2.1.2" xref="alg1.l10.m1.1.2.3.2.1.2.cmml">∑</mo><mrow id="alg1.l10.m1.1.2.3.2.1.3" xref="alg1.l10.m1.1.2.3.2.1.3.cmml"><mi id="alg1.l10.m1.1.2.3.2.1.3.2" xref="alg1.l10.m1.1.2.3.2.1.3.2.cmml">k</mi><mo id="alg1.l10.m1.1.2.3.2.1.3.1" xref="alg1.l10.m1.1.2.3.2.1.3.1.cmml">∈</mo><mi id="alg1.l10.m1.1.2.3.2.1.3.3" xref="alg1.l10.m1.1.2.3.2.1.3.3.cmml">c</mi></mrow></msub><msub id="alg1.l10.m1.1.2.3.2.2" xref="alg1.l10.m1.1.2.3.2.2.cmml"><mi id="alg1.l10.m1.1.2.3.2.2.2" xref="alg1.l10.m1.1.2.3.2.2.2.cmml">w</mi><mi id="alg1.l10.m1.1.2.3.2.2.3" xref="alg1.l10.m1.1.2.3.2.2.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.2.cmml" xref="alg1.l10.m1.1.2"><eq id="alg1.l10.m1.1.2.1.cmml" xref="alg1.l10.m1.1.2.1"></eq><apply id="alg1.l10.m1.1.2.2.cmml" xref="alg1.l10.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.2.2.1.cmml" xref="alg1.l10.m1.1.2.2">superscript</csymbol><apply id="alg1.l10.m1.1.2.2.2.cmml" xref="alg1.l10.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.2.2.2.1.cmml" xref="alg1.l10.m1.1.2.2">subscript</csymbol><ci id="alg1.l10.m1.1.2.2.2.2.cmml" xref="alg1.l10.m1.1.2.2.2.2">𝑤</ci><ci id="alg1.l10.m1.1.2.2.2.3.cmml" xref="alg1.l10.m1.1.2.2.2.3">𝑐</ci></apply><ci id="alg1.l10.m1.1.2.2.3.cmml" xref="alg1.l10.m1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l10.m1.1.2.3.cmml" xref="alg1.l10.m1.1.2.3"><times id="alg1.l10.m1.1.2.3.1.cmml" xref="alg1.l10.m1.1.2.3.1"></times><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><divide id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"></divide><cn type="integer" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">1</cn><apply id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.3"><abs id="alg1.l10.m1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.3.1"></abs><ci id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">𝑐</ci></apply></apply><apply id="alg1.l10.m1.1.2.3.2.cmml" xref="alg1.l10.m1.1.2.3.2"><apply id="alg1.l10.m1.1.2.3.2.1.cmml" xref="alg1.l10.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.2.3.2.1.1.cmml" xref="alg1.l10.m1.1.2.3.2.1">subscript</csymbol><sum id="alg1.l10.m1.1.2.3.2.1.2.cmml" xref="alg1.l10.m1.1.2.3.2.1.2"></sum><apply id="alg1.l10.m1.1.2.3.2.1.3.cmml" xref="alg1.l10.m1.1.2.3.2.1.3"><in id="alg1.l10.m1.1.2.3.2.1.3.1.cmml" xref="alg1.l10.m1.1.2.3.2.1.3.1"></in><ci id="alg1.l10.m1.1.2.3.2.1.3.2.cmml" xref="alg1.l10.m1.1.2.3.2.1.3.2">𝑘</ci><ci id="alg1.l10.m1.1.2.3.2.1.3.3.cmml" xref="alg1.l10.m1.1.2.3.2.1.3.3">𝑐</ci></apply></apply><apply id="alg1.l10.m1.1.2.3.2.2.cmml" xref="alg1.l10.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.2.3.2.2.1.cmml" xref="alg1.l10.m1.1.2.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.1.2.3.2.2.2.cmml" xref="alg1.l10.m1.1.2.3.2.2.2">𝑤</ci><ci id="alg1.l10.m1.1.2.3.2.2.3.cmml" xref="alg1.l10.m1.1.2.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">w_{c}^{t}=\frac{1}{\left|c\right|}{\textstyle\sum_{k\in c}w_{k}}</annotation></semantics></math> <span id="alg1.l10.1" class="ltx_text" style="float:right;"><math id="alg1.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation></semantics></math> Models within a cluster perform simple weight averaging
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w_{c}^{t+1}\leftarrow" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msubsup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2.2" xref="alg1.l12.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.2.2.3" xref="alg1.l12.m1.1.1.2.2.3.cmml">c</mi><mrow id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.3.1" xref="alg1.l12.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l12.m1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.2.2.3">𝑐</ci></apply><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><plus id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.1"></plus><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w_{c}^{t+1}\leftarrow</annotation></semantics></math><span id="alg1.l12.2" class="ltx_text ltx_font_bold">DML</span>(<math id="alg1.l12.m2.1" class="ltx_Math" alttext="w_{c}^{t}" display="inline"><semantics id="alg1.l12.m2.1a"><msubsup id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml">c</mi><mi id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝑤</ci><ci id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3">𝑐</ci></apply><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">w_{c}^{t}</annotation></semantics></math>) <span id="alg1.l12.1" class="ltx_text" style="float:right;"><math id="alg1.l12.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation></semantics></math> Models from different clusters perform DML to be aggregated
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
</div>
<div id="alg1.l15" class="ltx_listingline">
<span id="alg1.l15.1" class="ltx_text ltx_font_bold">function</span> <span id="alg1.l15.2" class="ltx_text ltx_font_smallcaps">DML</span>(<math id="alg1.l15.m1.1" class="ltx_Math" alttext="\bm{w_{c}}" display="inline"><semantics id="alg1.l15.m1.1a"><msub id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">𝒘</mi><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">𝒄</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝒘</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\bm{w_{c}}</annotation></semantics></math>)

</div>
<div id="alg1.l16" class="ltx_listingline">     Diffusion model generate data <math id="alg1.l16.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">D</mi><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝐷</ci><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">D_{i}</annotation></semantics></math> according to <math id="alg1.l16.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l16.m2.1a"><mi id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">P</annotation></semantics></math>.

</div>
<div id="alg1.l17" class="ltx_listingline">     <span id="alg1.l17.1" class="ltx_text ltx_font_bold">for</span> each global epoch <span id="alg1.l17.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l18" class="ltx_listingline">         <span id="alg1.l18.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l18.m1.2" class="ltx_Math" alttext="\left(x_{i},y_{i}\right)\in D_{i}" display="inline"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><mrow id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.3.cmml"><mo id="alg1.l18.m1.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l18.m1.2.2.2.2.4" xref="alg1.l18.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l18.m1.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l18.m1.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l18.m1.2.2.2.2.5" xref="alg1.l18.m1.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3.cmml">∈</mo><msub id="alg1.l18.m1.2.2.4" xref="alg1.l18.m1.2.2.4.cmml"><mi id="alg1.l18.m1.2.2.4.2" xref="alg1.l18.m1.2.2.4.2.cmml">D</mi><mi id="alg1.l18.m1.2.2.4.3" xref="alg1.l18.m1.2.2.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><in id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3"></in><interval closure="open" id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l18.m1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l18.m1.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l18.m1.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="alg1.l18.m1.2.2.4.cmml" xref="alg1.l18.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.4">subscript</csymbol><ci id="alg1.l18.m1.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.4.2">𝐷</ci><ci id="alg1.l18.m1.2.2.4.3.cmml" xref="alg1.l18.m1.2.2.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">\left(x_{i},y_{i}\right)\in D_{i}</annotation></semantics></math> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l19" class="ltx_listingline">              <math id="alg1.l19.m1.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="alg1.l19.m1.1a"><msub id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">p</mi><mi id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝑝</ci><ci id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">p_{i}</annotation></semantics></math> <math id="alg1.l19.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l19.m2.1a"><mo stretchy="false" id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><ci id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\leftarrow</annotation></semantics></math> Eq.<a href="#S4.E6" title="Equation 6 ‣ 4.4 DML with Diffusion Model ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> <span id="alg1.l19.2" class="ltx_text" style="float:right;"><math id="alg1.l19.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l19.1.m1.1a"><mo id="alg1.l19.1.m1.1.1" xref="alg1.l19.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l19.1.m1.1b"><ci id="alg1.l19.1.m1.1.1.cmml" xref="alg1.l19.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.1.m1.1c">\triangleright</annotation></semantics></math> Calculate the soft prediction of model <math id="alg1.l19.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l19.2.m2.1a"><mi id="alg1.l19.2.m2.1.1" xref="alg1.l19.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.2.m2.1b"><ci id="alg1.l19.2.m2.1.1.cmml" xref="alg1.l19.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.2.m2.1c">w</annotation></semantics></math>
</span>
</div>
<div id="alg1.l20" class="ltx_listingline">              <math id="alg1.l20.m1.1" class="ltx_Math" alttext="L_{kl}\leftarrow" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><msub id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml"><mi id="alg1.l20.m1.1.1.2.2" xref="alg1.l20.m1.1.1.2.2.cmml">L</mi><mrow id="alg1.l20.m1.1.1.2.3" xref="alg1.l20.m1.1.1.2.3.cmml"><mi id="alg1.l20.m1.1.1.2.3.2" xref="alg1.l20.m1.1.1.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.1.1.2.3.1" xref="alg1.l20.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l20.m1.1.1.2.3.3" xref="alg1.l20.m1.1.1.2.3.3.cmml">l</mi></mrow></msub><mo stretchy="false" id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">←</mo><mi id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><ci id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1">←</ci><apply id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.2.1.cmml" xref="alg1.l20.m1.1.1.2">subscript</csymbol><ci id="alg1.l20.m1.1.1.2.2.cmml" xref="alg1.l20.m1.1.1.2.2">𝐿</ci><apply id="alg1.l20.m1.1.1.2.3.cmml" xref="alg1.l20.m1.1.1.2.3"><times id="alg1.l20.m1.1.1.2.3.1.cmml" xref="alg1.l20.m1.1.1.2.3.1"></times><ci id="alg1.l20.m1.1.1.2.3.2.cmml" xref="alg1.l20.m1.1.1.2.3.2">𝑘</ci><ci id="alg1.l20.m1.1.1.2.3.3.cmml" xref="alg1.l20.m1.1.1.2.3.3">𝑙</ci></apply></apply><csymbol cd="latexml" id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">L_{kl}\leftarrow</annotation></semantics></math> Eq.<a href="#S4.E7" title="Equation 7 ‣ 4.4 DML with Diffusion Model ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> &amp; Eq. <a href="#S4.E8" title="Equation 8 ‣ 4.4 DML with Diffusion Model ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> <span id="alg1.l20.1" class="ltx_text" style="float:right;"><math id="alg1.l20.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l20.1.m1.1a"><mo id="alg1.l20.1.m1.1.1" xref="alg1.l20.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l20.1.m1.1b"><ci id="alg1.l20.1.m1.1.1.cmml" xref="alg1.l20.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.1.m1.1c">\triangleright</annotation></semantics></math> Calculate the KL loss with the averaged logits
</span>
</div>
<div id="alg1.l21" class="ltx_listingline">              <math id="alg1.l21.m1.1" class="ltx_Math" alttext="w_{c}^{i}=w_{c}^{i}-\eta\nabla L_{kl}" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msubsup id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml"><mi id="alg1.l21.m1.1.1.2.2.2" xref="alg1.l21.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l21.m1.1.1.2.2.3" xref="alg1.l21.m1.1.1.2.2.3.cmml">c</mi><mi id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">=</mo><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><msubsup id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml"><mi id="alg1.l21.m1.1.1.3.2.2.2" xref="alg1.l21.m1.1.1.3.2.2.2.cmml">w</mi><mi id="alg1.l21.m1.1.1.3.2.2.3" xref="alg1.l21.m1.1.1.3.2.2.3.cmml">c</mi><mi id="alg1.l21.m1.1.1.3.2.3" xref="alg1.l21.m1.1.1.3.2.3.cmml">i</mi></msubsup><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml"><mi id="alg1.l21.m1.1.1.3.3.2" xref="alg1.l21.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l21.m1.1.1.3.3.1" xref="alg1.l21.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l21.m1.1.1.3.3.3" xref="alg1.l21.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l21.m1.1.1.3.3.3.1" xref="alg1.l21.m1.1.1.3.3.3.1.cmml">∇</mo><msub id="alg1.l21.m1.1.1.3.3.3.2" xref="alg1.l21.m1.1.1.3.3.3.2.cmml"><mi id="alg1.l21.m1.1.1.3.3.3.2.2" xref="alg1.l21.m1.1.1.3.3.3.2.2.cmml">L</mi><mrow id="alg1.l21.m1.1.1.3.3.3.2.3" xref="alg1.l21.m1.1.1.3.3.3.2.3.cmml"><mi id="alg1.l21.m1.1.1.3.3.3.2.3.2" xref="alg1.l21.m1.1.1.3.3.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.1.1.3.3.3.2.3.1" xref="alg1.l21.m1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="alg1.l21.m1.1.1.3.3.3.2.3.3" xref="alg1.l21.m1.1.1.3.3.3.2.3.3.cmml">l</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><eq id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></eq><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.2">superscript</csymbol><apply id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.2.1.cmml" xref="alg1.l21.m1.1.1.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.2.cmml" xref="alg1.l21.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l21.m1.1.1.2.2.3.cmml" xref="alg1.l21.m1.1.1.2.2.3">𝑐</ci></apply><ci id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><minus id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></minus><apply id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.1.cmml" xref="alg1.l21.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l21.m1.1.1.3.2.2.cmml" xref="alg1.l21.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.2.2.1.cmml" xref="alg1.l21.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.2.2.2.cmml" xref="alg1.l21.m1.1.1.3.2.2.2">𝑤</ci><ci id="alg1.l21.m1.1.1.3.2.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.2.3">𝑐</ci></apply><ci id="alg1.l21.m1.1.1.3.2.3.cmml" xref="alg1.l21.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3"><times id="alg1.l21.m1.1.1.3.3.1.cmml" xref="alg1.l21.m1.1.1.3.3.1"></times><ci id="alg1.l21.m1.1.1.3.3.2.cmml" xref="alg1.l21.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l21.m1.1.1.3.3.3.cmml" xref="alg1.l21.m1.1.1.3.3.3"><ci id="alg1.l21.m1.1.1.3.3.3.1.cmml" xref="alg1.l21.m1.1.1.3.3.3.1">∇</ci><apply id="alg1.l21.m1.1.1.3.3.3.2.cmml" xref="alg1.l21.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l21.m1.1.1.3.3.3.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l21.m1.1.1.3.3.3.2.2">𝐿</ci><apply id="alg1.l21.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l21.m1.1.1.3.3.3.2.3"><times id="alg1.l21.m1.1.1.3.3.3.2.3.1.cmml" xref="alg1.l21.m1.1.1.3.3.3.2.3.1"></times><ci id="alg1.l21.m1.1.1.3.3.3.2.3.2.cmml" xref="alg1.l21.m1.1.1.3.3.3.2.3.2">𝑘</ci><ci id="alg1.l21.m1.1.1.3.3.3.2.3.3.cmml" xref="alg1.l21.m1.1.1.3.3.3.2.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">w_{c}^{i}=w_{c}^{i}-\eta\nabla L_{kl}</annotation></semantics></math> <span id="alg1.l21.1" class="ltx_text" style="float:right;"><math id="alg1.l21.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l21.1.m1.1a"><mo id="alg1.l21.1.m1.1.1" xref="alg1.l21.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l21.1.m1.1b"><ci id="alg1.l21.1.m1.1.1.cmml" xref="alg1.l21.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.1.m1.1c">\triangleright</annotation></semantics></math> Update the cluster-based model
</span>
</div>
<div id="alg1.l22" class="ltx_listingline">         <span id="alg1.l22.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l22.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l23" class="ltx_listingline">     <span id="alg1.l23.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l23.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l24" class="ltx_listingline">     <span id="alg1.l24.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l24.m1.1" class="ltx_Math" alttext="\bm{w_{c}}" display="inline"><semantics id="alg1.l24.m1.1a"><msub id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">𝒘</mi><mi id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml">𝒄</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1">subscript</csymbol><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">𝒘</ci><ci id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\bm{w_{c}}</annotation></semantics></math> <span id="alg1.l24.1" class="ltx_text" style="float:right;"><math id="alg1.l24.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l24.1.m1.1a"><mo id="alg1.l24.1.m1.1.1" xref="alg1.l24.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l24.1.m1.1b"><ci id="alg1.l24.1.m1.1.1.cmml" xref="alg1.l24.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.1.m1.1c">\triangleright</annotation></semantics></math> Return the updated cluster-based model in cluster c
</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span id="alg1.l25.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l25.2" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Resource-oriented Clustering with Pruned Models</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In our FedTSA framework, clustering serves as the initial step, grouping clients according to hardware resources to enhance efficient training and reduce tail latency. Unlike most existing works that group clients to address data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, our focus is on ensuring resource homogeneity within clusters. While one could categorize resources by hardware like CPU and memory, solely using these attributes is insufficient. Environmental factors, such as temperature shifts and voltage variations, can impact device performance. Moreover, the network condition plays a fundamental role, especially given the multiple communication rounds inherent to the FL paradigm.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We propose to employ a proxy task to acquire the training duration of each client, which will act as a key attribute for clustering. This duration serves as a reflection of the run-time operational efficiency of a given system. For the proxy task, the server dispatches a one-hidden-layer multilayer perceptron (MLP) along with a scaled-down MNIST dataset to the clients. Once the clients receive the model and data, they start the training process and simultaneously record the training durations. These logged durations are then sent back to the server, serving as the essential attribute for the clustering procedure. It is noteworthy that this proxy task can be any lightweight training task that can run on all clients participating in FL.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.3" class="ltx_p">Our clustering method is based on KDE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, which is a non-parametric approach for estimating the density of a distribution. Specifically, given a set of <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">n</annotation></semantics></math> points (<math id="S4.SS3.p3.2.m2.4" class="ltx_Math" alttext="x_{1},x_{2},...,\\
x_{n}" display="inline"><semantics id="S4.SS3.p3.2.m2.4a"><mrow id="S4.SS3.p3.2.m2.4.4.3" xref="S4.SS3.p3.2.m2.4.4.4.cmml"><msub id="S4.SS3.p3.2.m2.2.2.1.1" xref="S4.SS3.p3.2.m2.2.2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.2.2.1.1.2" xref="S4.SS3.p3.2.m2.2.2.1.1.2.cmml">x</mi><mn id="S4.SS3.p3.2.m2.2.2.1.1.3" xref="S4.SS3.p3.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p3.2.m2.4.4.3.4" xref="S4.SS3.p3.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p3.2.m2.3.3.2.2" xref="S4.SS3.p3.2.m2.3.3.2.2.cmml"><mi id="S4.SS3.p3.2.m2.3.3.2.2.2" xref="S4.SS3.p3.2.m2.3.3.2.2.2.cmml">x</mi><mn id="S4.SS3.p3.2.m2.3.3.2.2.3" xref="S4.SS3.p3.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS3.p3.2.m2.4.4.3.5" xref="S4.SS3.p3.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">…</mi><mo id="S4.SS3.p3.2.m2.4.4.3.6" xref="S4.SS3.p3.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p3.2.m2.4.4.3.3" xref="S4.SS3.p3.2.m2.4.4.3.3.cmml"><mi id="S4.SS3.p3.2.m2.4.4.3.3.2" xref="S4.SS3.p3.2.m2.4.4.3.3.2.cmml">x</mi><mi id="S4.SS3.p3.2.m2.4.4.3.3.3" xref="S4.SS3.p3.2.m2.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.4b"><list id="S4.SS3.p3.2.m2.4.4.4.cmml" xref="S4.SS3.p3.2.m2.4.4.3"><apply id="S4.SS3.p3.2.m2.2.2.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.2">𝑥</ci><cn type="integer" id="S4.SS3.p3.2.m2.2.2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.2.2.1.1.3">1</cn></apply><apply id="S4.SS3.p3.2.m2.3.3.2.2.cmml" xref="S4.SS3.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.3.3.2.2.1.cmml" xref="S4.SS3.p3.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.3.3.2.2.2.cmml" xref="S4.SS3.p3.2.m2.3.3.2.2.2">𝑥</ci><cn type="integer" id="S4.SS3.p3.2.m2.3.3.2.2.3.cmml" xref="S4.SS3.p3.2.m2.3.3.2.2.3">2</cn></apply><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">…</ci><apply id="S4.SS3.p3.2.m2.4.4.3.3.cmml" xref="S4.SS3.p3.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.4.4.3.3.1.cmml" xref="S4.SS3.p3.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.4.4.3.3.2.cmml" xref="S4.SS3.p3.2.m2.4.4.3.3.2">𝑥</ci><ci id="S4.SS3.p3.2.m2.4.4.3.3.3.cmml" xref="S4.SS3.p3.2.m2.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.4c">x_{1},x_{2},...,\\
x_{n}</annotation></semantics></math>) which refer to the training durations from the proxy task and reflect the system capacities, the kernel density estimator <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\hat{f}(x)" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.2" xref="S4.SS3.p3.3.m3.1.2.cmml"><mover accent="true" id="S4.SS3.p3.3.m3.1.2.2" xref="S4.SS3.p3.3.m3.1.2.2.cmml"><mi id="S4.SS3.p3.3.m3.1.2.2.2" xref="S4.SS3.p3.3.m3.1.2.2.2.cmml">f</mi><mo id="S4.SS3.p3.3.m3.1.2.2.1" xref="S4.SS3.p3.3.m3.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m3.1.2.1" xref="S4.SS3.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS3.p3.3.m3.1.2.3.2" xref="S4.SS3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.3.m3.1.2.3.2.1" xref="S4.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p3.3.m3.1.2.3.2.2" xref="S4.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.2.cmml" xref="S4.SS3.p3.3.m3.1.2"><times id="S4.SS3.p3.3.m3.1.2.1.cmml" xref="S4.SS3.p3.3.m3.1.2.1"></times><apply id="S4.SS3.p3.3.m3.1.2.2.cmml" xref="S4.SS3.p3.3.m3.1.2.2"><ci id="S4.SS3.p3.3.m3.1.2.2.1.cmml" xref="S4.SS3.p3.3.m3.1.2.2.1">^</ci><ci id="S4.SS3.p3.3.m3.1.2.2.2.cmml" xref="S4.SS3.p3.3.m3.1.2.2.2">𝑓</ci></apply><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\hat{f}(x)</annotation></semantics></math> is given by</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.3" class="ltx_Math" alttext="\hat{f}(x)=\frac{1}{nh}\sum_{i=1}^{n}K(\frac{x-x_{i}}{h})," display="block"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3.1" xref="S4.E2.m1.3.3.1.1.cmml"><mrow id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml"><mrow id="S4.E2.m1.3.3.1.1.2" xref="S4.E2.m1.3.3.1.1.2.cmml"><mover accent="true" id="S4.E2.m1.3.3.1.1.2.2" xref="S4.E2.m1.3.3.1.1.2.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.cmml">f</mi><mo id="S4.E2.m1.3.3.1.1.2.2.1" xref="S4.E2.m1.3.3.1.1.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2.1" xref="S4.E2.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.2.3.2" xref="S4.E2.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.2.3.2.1" xref="S4.E2.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E2.m1.3.3.1.1.2.3.2.2" xref="S4.E2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.1.1.1" xref="S4.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.3" xref="S4.E2.m1.3.3.1.1.3.cmml"><mfrac id="S4.E2.m1.3.3.1.1.3.2" xref="S4.E2.m1.3.3.1.1.3.2.cmml"><mn id="S4.E2.m1.3.3.1.1.3.2.2" xref="S4.E2.m1.3.3.1.1.3.2.2.cmml">1</mn><mrow id="S4.E2.m1.3.3.1.1.3.2.3" xref="S4.E2.m1.3.3.1.1.3.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.3.2.3.2" xref="S4.E2.m1.3.3.1.1.3.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.3.2.3.1" xref="S4.E2.m1.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E2.m1.3.3.1.1.3.2.3.3" xref="S4.E2.m1.3.3.1.1.3.2.3.3.cmml">h</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.3.1" xref="S4.E2.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.3.3" xref="S4.E2.m1.3.3.1.1.3.3.cmml"><munderover id="S4.E2.m1.3.3.1.1.3.3.1" xref="S4.E2.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S4.E2.m1.3.3.1.1.3.3.1.2.2" xref="S4.E2.m1.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E2.m1.3.3.1.1.3.3.1.2.3" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.3.3.1.2.3.2" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E2.m1.3.3.1.1.3.3.1.2.3.1" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E2.m1.3.3.1.1.3.3.1.2.3.3" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.3.3.1.1.3.3.1.3" xref="S4.E2.m1.3.3.1.1.3.3.1.3.cmml">n</mi></munderover><mrow id="S4.E2.m1.3.3.1.1.3.3.2" xref="S4.E2.m1.3.3.1.1.3.3.2.cmml"><mi id="S4.E2.m1.3.3.1.1.3.3.2.2" xref="S4.E2.m1.3.3.1.1.3.3.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.3.3.2.1" xref="S4.E2.m1.3.3.1.1.3.3.2.1.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.3.3.2.3.2" xref="S4.E2.m1.2.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.3.3.2.3.2.1" xref="S4.E2.m1.2.2.cmml">(</mo><mfrac id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">x</mi><mo id="S4.E2.m1.2.2.2.1" xref="S4.E2.m1.2.2.2.1.cmml">−</mo><msub id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml"><mi id="S4.E2.m1.2.2.2.3.2" xref="S4.E2.m1.2.2.2.3.2.cmml">x</mi><mi id="S4.E2.m1.2.2.2.3.3" xref="S4.E2.m1.2.2.2.3.3.cmml">i</mi></msub></mrow><mi id="S4.E2.m1.2.2.3" xref="S4.E2.m1.2.2.3.cmml">h</mi></mfrac><mo stretchy="false" id="S4.E2.m1.3.3.1.1.3.3.2.3.2.2" xref="S4.E2.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.3.3.1.2" xref="S4.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1"><eq id="S4.E2.m1.3.3.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1"></eq><apply id="S4.E2.m1.3.3.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.2"><times id="S4.E2.m1.3.3.1.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.1"></times><apply id="S4.E2.m1.3.3.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2"><ci id="S4.E2.m1.3.3.1.1.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1">^</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2">𝑓</ci></apply><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝑥</ci></apply><apply id="S4.E2.m1.3.3.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.3"><times id="S4.E2.m1.3.3.1.1.3.1.cmml" xref="S4.E2.m1.3.3.1.1.3.1"></times><apply id="S4.E2.m1.3.3.1.1.3.2.cmml" xref="S4.E2.m1.3.3.1.1.3.2"><divide id="S4.E2.m1.3.3.1.1.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.3.2"></divide><cn type="integer" id="S4.E2.m1.3.3.1.1.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.3.2.2">1</cn><apply id="S4.E2.m1.3.3.1.1.3.2.3.cmml" xref="S4.E2.m1.3.3.1.1.3.2.3"><times id="S4.E2.m1.3.3.1.1.3.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.3.2.3.1"></times><ci id="S4.E2.m1.3.3.1.1.3.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.3.2.3.2">𝑛</ci><ci id="S4.E2.m1.3.3.1.1.3.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S4.E2.m1.3.3.1.1.3.3.cmml" xref="S4.E2.m1.3.3.1.1.3.3"><apply id="S4.E2.m1.3.3.1.1.3.3.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1">superscript</csymbol><apply id="S4.E2.m1.3.3.1.1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.3.3.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S4.E2.m1.3.3.1.1.3.3.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.2.2"></sum><apply id="S4.E2.m1.3.3.1.1.3.3.1.2.3.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3"><eq id="S4.E2.m1.3.3.1.1.3.3.1.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S4.E2.m1.3.3.1.1.3.3.1.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E2.m1.3.3.1.1.3.3.1.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.3.3.1.1.3.3.1.3.cmml" xref="S4.E2.m1.3.3.1.1.3.3.1.3">𝑛</ci></apply><apply id="S4.E2.m1.3.3.1.1.3.3.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.2"><times id="S4.E2.m1.3.3.1.1.3.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.2.1"></times><ci id="S4.E2.m1.3.3.1.1.3.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.2.2">𝐾</ci><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.3.3.2.3.2"><divide id="S4.E2.m1.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.3.3.2.3.2"></divide><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><minus id="S4.E2.m1.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.1"></minus><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑥</ci><apply id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.3.1.cmml" xref="S4.E2.m1.2.2.2.3">subscript</csymbol><ci id="S4.E2.m1.2.2.2.3.2.cmml" xref="S4.E2.m1.2.2.2.3.2">𝑥</ci><ci id="S4.E2.m1.2.2.2.3.3.cmml" xref="S4.E2.m1.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">\hat{f}(x)=\frac{1}{nh}\sum_{i=1}^{n}K(\frac{x-x_{i}}{h}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.5" class="ltx_p">where <math id="S4.SS3.p3.4.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S4.SS3.p3.4.m1.1a"><mi id="S4.SS3.p3.4.m1.1.1" xref="S4.SS3.p3.4.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m1.1b"><ci id="S4.SS3.p3.4.m1.1.1.cmml" xref="S4.SS3.p3.4.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m1.1c">h</annotation></semantics></math> is the smoothing parameter named bandwidth and <math id="S4.SS3.p3.5.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p3.5.m2.1a"><mi id="S4.SS3.p3.5.m2.1.1" xref="S4.SS3.p3.5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m2.1b"><ci id="S4.SS3.p3.5.m2.1.1.cmml" xref="S4.SS3.p3.5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m2.1c">K</annotation></semantics></math> is a kernel function that meets the following condition:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\int_{-\infty}^{\infty}K(x)dx=1." display="block"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.cmml"><msubsup id="S4.E3.m1.2.2.1.1.2.1" xref="S4.E3.m1.2.2.1.1.2.1.cmml"><mo id="S4.E3.m1.2.2.1.1.2.1.2.2" xref="S4.E3.m1.2.2.1.1.2.1.2.2.cmml">∫</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.2.3" xref="S4.E3.m1.2.2.1.1.2.1.2.3.cmml"><mo id="S4.E3.m1.2.2.1.1.2.1.2.3a" xref="S4.E3.m1.2.2.1.1.2.1.2.3.cmml">−</mo><mi mathvariant="normal" id="S4.E3.m1.2.2.1.1.2.1.2.3.2" xref="S4.E3.m1.2.2.1.1.2.1.2.3.2.cmml">∞</mi></mrow><mi mathvariant="normal" id="S4.E3.m1.2.2.1.1.2.1.3" xref="S4.E3.m1.2.2.1.1.2.1.3.cmml">∞</mi></msubsup><mrow id="S4.E3.m1.2.2.1.1.2.2" xref="S4.E3.m1.2.2.1.1.2.2.cmml"><mi id="S4.E3.m1.2.2.1.1.2.2.2" xref="S4.E3.m1.2.2.1.1.2.2.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.2.2.1" xref="S4.E3.m1.2.2.1.1.2.2.1.cmml">​</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.3.2" xref="S4.E3.m1.2.2.1.1.2.2.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.1.1.2.2.3.2.1" xref="S4.E3.m1.2.2.1.1.2.2.cmml">(</mo><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E3.m1.2.2.1.1.2.2.3.2.2" xref="S4.E3.m1.2.2.1.1.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.1.1.2.2.1a" xref="S4.E3.m1.2.2.1.1.2.2.1.cmml">​</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.4" xref="S4.E3.m1.2.2.1.1.2.2.4.cmml"><mo rspace="0em" id="S4.E3.m1.2.2.1.1.2.2.4.1" xref="S4.E3.m1.2.2.1.1.2.2.4.1.cmml">𝑑</mo><mi id="S4.E3.m1.2.2.1.1.2.2.4.2" xref="S4.E3.m1.2.2.1.1.2.2.4.2.cmml">x</mi></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.1" xref="S4.E3.m1.2.2.1.1.1.cmml">=</mo><mn id="S4.E3.m1.2.2.1.1.3" xref="S4.E3.m1.2.2.1.1.3.cmml">1</mn></mrow><mo lspace="0em" id="S4.E3.m1.2.2.1.2" xref="S4.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1"><eq id="S4.E3.m1.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1"></eq><apply id="S4.E3.m1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2"><apply id="S4.E3.m1.2.2.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1">subscript</csymbol><int id="S4.E3.m1.2.2.1.1.2.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.2.2"></int><apply id="S4.E3.m1.2.2.1.1.2.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.2.3"><minus id="S4.E3.m1.2.2.1.1.2.1.2.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.2.3"></minus><infinity id="S4.E3.m1.2.2.1.1.2.1.2.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.2.3.2"></infinity></apply></apply><infinity id="S4.E3.m1.2.2.1.1.2.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3"></infinity></apply><apply id="S4.E3.m1.2.2.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2"><times id="S4.E3.m1.2.2.1.1.2.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1"></times><ci id="S4.E3.m1.2.2.1.1.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2">𝐾</ci><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝑥</ci><apply id="S4.E3.m1.2.2.1.1.2.2.4.cmml" xref="S4.E3.m1.2.2.1.1.2.2.4"><csymbol cd="latexml" id="S4.E3.m1.2.2.1.1.2.2.4.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.4.1">differential-d</csymbol><ci id="S4.E3.m1.2.2.1.1.2.2.4.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.4.2">𝑥</ci></apply></apply></apply><cn type="integer" id="S4.E3.m1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\int_{-\infty}^{\infty}K(x)dx=1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.9" class="ltx_p">Given the heterogeneity of device resources in the wild is roughly presented as a Gaussian distribution, we leverage the Gaussian kernel for the estimator given by:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.3" class="ltx_Math" alttext="K(x)=\frac{1}{\sqrt{2\pi}}\exp(-\frac{x^{2}}{2})." display="block"><semantics id="S4.E4.m1.3a"><mrow id="S4.E4.m1.3.3.1" xref="S4.E4.m1.3.3.1.1.cmml"><mrow id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml"><mrow id="S4.E4.m1.3.3.1.1.3" xref="S4.E4.m1.3.3.1.1.3.cmml"><mi id="S4.E4.m1.3.3.1.1.3.2" xref="S4.E4.m1.3.3.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.3.1" xref="S4.E4.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.3.3.1.1.3.3.2" xref="S4.E4.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.1.3.3.2.1" xref="S4.E4.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E4.m1.3.3.1.1.3.3.2.2" xref="S4.E4.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.3.3.1.1.2" xref="S4.E4.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.3.3.1.1.1" xref="S4.E4.m1.3.3.1.1.1.cmml"><mfrac id="S4.E4.m1.3.3.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.3.cmml"><mn id="S4.E4.m1.3.3.1.1.1.3.2" xref="S4.E4.m1.3.3.1.1.1.3.2.cmml">1</mn><msqrt id="S4.E4.m1.3.3.1.1.1.3.3" xref="S4.E4.m1.3.3.1.1.1.3.3.cmml"><mrow id="S4.E4.m1.3.3.1.1.1.3.3.2" xref="S4.E4.m1.3.3.1.1.1.3.3.2.cmml"><mn id="S4.E4.m1.3.3.1.1.1.3.3.2.2" xref="S4.E4.m1.3.3.1.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.1.3.3.2.1" xref="S4.E4.m1.3.3.1.1.1.3.3.2.1.cmml">​</mo><mi id="S4.E4.m1.3.3.1.1.1.3.3.2.3" xref="S4.E4.m1.3.3.1.1.1.3.3.2.3.cmml">π</mi></mrow></msqrt></mfrac><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.3.3.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">exp</mi><mo id="S4.E4.m1.3.3.1.1.1.1.1a" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.3.3.1.1.1.1.1.1.1a" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msup id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mn id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">2</mn></msup><mn id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">2</mn></mfrac></mrow><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E4.m1.3.3.1.2" xref="S4.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.3b"><apply id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1"><eq id="S4.E4.m1.3.3.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2"></eq><apply id="S4.E4.m1.3.3.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.3"><times id="S4.E4.m1.3.3.1.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.3.1"></times><ci id="S4.E4.m1.3.3.1.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.3.2">𝐾</ci><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝑥</ci></apply><apply id="S4.E4.m1.3.3.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1"><times id="S4.E4.m1.3.3.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.2"></times><apply id="S4.E4.m1.3.3.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.3"><divide id="S4.E4.m1.3.3.1.1.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S4.E4.m1.3.3.1.1.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.3.2">1</cn><apply id="S4.E4.m1.3.3.1.1.1.3.3.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3"><root id="S4.E4.m1.3.3.1.1.1.3.3a.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3"></root><apply id="S4.E4.m1.3.3.1.1.1.3.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3.2"><times id="S4.E4.m1.3.3.1.1.1.3.3.2.1.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3.2.1"></times><cn type="integer" id="S4.E4.m1.3.3.1.1.1.3.3.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3.2.2">2</cn><ci id="S4.E4.m1.3.3.1.1.1.3.3.2.3.cmml" xref="S4.E4.m1.3.3.1.1.1.3.3.2.3">𝜋</ci></apply></apply></apply><apply id="S4.E4.m1.3.3.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1"><exp id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"></exp><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1"><minus id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2"><divide id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2"></divide><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑥</ci><cn type="integer" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3">2</cn></apply><cn type="integer" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.3c">K(x)=\frac{1}{\sqrt{2\pi}}\exp(-\frac{x^{2}}{2}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.8" class="ltx_p">With the estimated density function, we can easily acquire a series of local maximum and minimum points, which can naturally serve as the boundaries of different clusters. After clustering, we compute the average processing duration of the clients within each cluster and subsequently map them onto a pruning rate distribution. The cluster with the minimal mean processing duration is assigned a pruning rate of 1.0, indicating an unpruned model. Other clusters’ rates can be calculated by <math id="S4.SS3.p3.6.m1.1" class="ltx_Math" alttext="ratio_{i}=\frac{t_{f}}{t_{i}}" display="inline"><semantics id="S4.SS3.p3.6.m1.1a"><mrow id="S4.SS3.p3.6.m1.1.1" xref="S4.SS3.p3.6.m1.1.1.cmml"><mrow id="S4.SS3.p3.6.m1.1.1.2" xref="S4.SS3.p3.6.m1.1.1.2.cmml"><mi id="S4.SS3.p3.6.m1.1.1.2.2" xref="S4.SS3.p3.6.m1.1.1.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m1.1.1.2.1" xref="S4.SS3.p3.6.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.p3.6.m1.1.1.2.3" xref="S4.SS3.p3.6.m1.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m1.1.1.2.1a" xref="S4.SS3.p3.6.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.p3.6.m1.1.1.2.4" xref="S4.SS3.p3.6.m1.1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m1.1.1.2.1b" xref="S4.SS3.p3.6.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.p3.6.m1.1.1.2.5" xref="S4.SS3.p3.6.m1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m1.1.1.2.1c" xref="S4.SS3.p3.6.m1.1.1.2.1.cmml">​</mo><msub id="S4.SS3.p3.6.m1.1.1.2.6" xref="S4.SS3.p3.6.m1.1.1.2.6.cmml"><mi id="S4.SS3.p3.6.m1.1.1.2.6.2" xref="S4.SS3.p3.6.m1.1.1.2.6.2.cmml">o</mi><mi id="S4.SS3.p3.6.m1.1.1.2.6.3" xref="S4.SS3.p3.6.m1.1.1.2.6.3.cmml">i</mi></msub></mrow><mo id="S4.SS3.p3.6.m1.1.1.1" xref="S4.SS3.p3.6.m1.1.1.1.cmml">=</mo><mfrac id="S4.SS3.p3.6.m1.1.1.3" xref="S4.SS3.p3.6.m1.1.1.3.cmml"><msub id="S4.SS3.p3.6.m1.1.1.3.2" xref="S4.SS3.p3.6.m1.1.1.3.2.cmml"><mi id="S4.SS3.p3.6.m1.1.1.3.2.2" xref="S4.SS3.p3.6.m1.1.1.3.2.2.cmml">t</mi><mi id="S4.SS3.p3.6.m1.1.1.3.2.3" xref="S4.SS3.p3.6.m1.1.1.3.2.3.cmml">f</mi></msub><msub id="S4.SS3.p3.6.m1.1.1.3.3" xref="S4.SS3.p3.6.m1.1.1.3.3.cmml"><mi id="S4.SS3.p3.6.m1.1.1.3.3.2" xref="S4.SS3.p3.6.m1.1.1.3.3.2.cmml">t</mi><mi id="S4.SS3.p3.6.m1.1.1.3.3.3" xref="S4.SS3.p3.6.m1.1.1.3.3.3.cmml">i</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m1.1b"><apply id="S4.SS3.p3.6.m1.1.1.cmml" xref="S4.SS3.p3.6.m1.1.1"><eq id="S4.SS3.p3.6.m1.1.1.1.cmml" xref="S4.SS3.p3.6.m1.1.1.1"></eq><apply id="S4.SS3.p3.6.m1.1.1.2.cmml" xref="S4.SS3.p3.6.m1.1.1.2"><times id="S4.SS3.p3.6.m1.1.1.2.1.cmml" xref="S4.SS3.p3.6.m1.1.1.2.1"></times><ci id="S4.SS3.p3.6.m1.1.1.2.2.cmml" xref="S4.SS3.p3.6.m1.1.1.2.2">𝑟</ci><ci id="S4.SS3.p3.6.m1.1.1.2.3.cmml" xref="S4.SS3.p3.6.m1.1.1.2.3">𝑎</ci><ci id="S4.SS3.p3.6.m1.1.1.2.4.cmml" xref="S4.SS3.p3.6.m1.1.1.2.4">𝑡</ci><ci id="S4.SS3.p3.6.m1.1.1.2.5.cmml" xref="S4.SS3.p3.6.m1.1.1.2.5">𝑖</ci><apply id="S4.SS3.p3.6.m1.1.1.2.6.cmml" xref="S4.SS3.p3.6.m1.1.1.2.6"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m1.1.1.2.6.1.cmml" xref="S4.SS3.p3.6.m1.1.1.2.6">subscript</csymbol><ci id="S4.SS3.p3.6.m1.1.1.2.6.2.cmml" xref="S4.SS3.p3.6.m1.1.1.2.6.2">𝑜</ci><ci id="S4.SS3.p3.6.m1.1.1.2.6.3.cmml" xref="S4.SS3.p3.6.m1.1.1.2.6.3">𝑖</ci></apply></apply><apply id="S4.SS3.p3.6.m1.1.1.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3"><divide id="S4.SS3.p3.6.m1.1.1.3.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3"></divide><apply id="S4.SS3.p3.6.m1.1.1.3.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m1.1.1.3.2.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p3.6.m1.1.1.3.2.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.2.2">𝑡</ci><ci id="S4.SS3.p3.6.m1.1.1.3.2.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.2.3">𝑓</ci></apply><apply id="S4.SS3.p3.6.m1.1.1.3.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m1.1.1.3.3.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.6.m1.1.1.3.3.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3.2">𝑡</ci><ci id="S4.SS3.p3.6.m1.1.1.3.3.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m1.1c">ratio_{i}=\frac{t_{f}}{t_{i}}</annotation></semantics></math>, where <math id="S4.SS3.p3.7.m2.1" class="ltx_Math" alttext="t_{f}" display="inline"><semantics id="S4.SS3.p3.7.m2.1a"><msub id="S4.SS3.p3.7.m2.1.1" xref="S4.SS3.p3.7.m2.1.1.cmml"><mi id="S4.SS3.p3.7.m2.1.1.2" xref="S4.SS3.p3.7.m2.1.1.2.cmml">t</mi><mi id="S4.SS3.p3.7.m2.1.1.3" xref="S4.SS3.p3.7.m2.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m2.1b"><apply id="S4.SS3.p3.7.m2.1.1.cmml" xref="S4.SS3.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m2.1.1.1.cmml" xref="S4.SS3.p3.7.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.7.m2.1.1.2.cmml" xref="S4.SS3.p3.7.m2.1.1.2">𝑡</ci><ci id="S4.SS3.p3.7.m2.1.1.3.cmml" xref="S4.SS3.p3.7.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m2.1c">t_{f}</annotation></semantics></math> is the fastest during and <math id="S4.SS3.p3.8.m3.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S4.SS3.p3.8.m3.1a"><msub id="S4.SS3.p3.8.m3.1.1" xref="S4.SS3.p3.8.m3.1.1.cmml"><mi id="S4.SS3.p3.8.m3.1.1.2" xref="S4.SS3.p3.8.m3.1.1.2.cmml">t</mi><mi id="S4.SS3.p3.8.m3.1.1.3" xref="S4.SS3.p3.8.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m3.1b"><apply id="S4.SS3.p3.8.m3.1.1.cmml" xref="S4.SS3.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m3.1.1.1.cmml" xref="S4.SS3.p3.8.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.8.m3.1.1.2.cmml" xref="S4.SS3.p3.8.m3.1.1.2">𝑡</ci><ci id="S4.SS3.p3.8.m3.1.1.3.cmml" xref="S4.SS3.p3.8.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m3.1c">t_{i}</annotation></semantics></math> is the current one.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.4" class="ltx_p">Neural network pruning has gained significant attention as a technique for decreasing complexity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Leveraging pruning, the amount of computation required to train neural networks can be greatly reduced. Based on this principle, we can create models with diverse computational requirements to cater to different client resources. The pruning rate <math id="S4.SS3.p4.1.m1.2" class="ltx_Math" alttext="p\in(0,1]" display="inline"><semantics id="S4.SS3.p4.1.m1.2a"><mrow id="S4.SS3.p4.1.m1.2.3" xref="S4.SS3.p4.1.m1.2.3.cmml"><mi id="S4.SS3.p4.1.m1.2.3.2" xref="S4.SS3.p4.1.m1.2.3.2.cmml">p</mi><mo id="S4.SS3.p4.1.m1.2.3.1" xref="S4.SS3.p4.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS3.p4.1.m1.2.3.3.2" xref="S4.SS3.p4.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p4.1.m1.2.3.3.2.1" xref="S4.SS3.p4.1.m1.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">0</mn><mo id="S4.SS3.p4.1.m1.2.3.3.2.2" xref="S4.SS3.p4.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p4.1.m1.2.2" xref="S4.SS3.p4.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p4.1.m1.2.3.3.2.3" xref="S4.SS3.p4.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.2b"><apply id="S4.SS3.p4.1.m1.2.3.cmml" xref="S4.SS3.p4.1.m1.2.3"><in id="S4.SS3.p4.1.m1.2.3.1.cmml" xref="S4.SS3.p4.1.m1.2.3.1"></in><ci id="S4.SS3.p4.1.m1.2.3.2.cmml" xref="S4.SS3.p4.1.m1.2.3.2">𝑝</ci><interval closure="open-closed" id="S4.SS3.p4.1.m1.2.3.3.1.cmml" xref="S4.SS3.p4.1.m1.2.3.3.2"><cn type="integer" id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">0</cn><cn type="integer" id="S4.SS3.p4.1.m1.2.2.cmml" xref="S4.SS3.p4.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.2c">p\in(0,1]</annotation></semantics></math> serves as a parameter to modify the architectures of various neural networks. For instance, a fully connected neural network (FCNN) can be pruned by adjusting the number of neurons in each layer, while a CNN can vary the number of input/output channels. For a given <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">p</annotation></semantics></math> value, the weights of a pruned network can be represented as <math id="S4.SS3.p4.3.m3.1" class="ltx_Math" alttext="W^{p}" display="inline"><semantics id="S4.SS3.p4.3.m3.1a"><msup id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml"><mi id="S4.SS3.p4.3.m3.1.1.2" xref="S4.SS3.p4.3.m3.1.1.2.cmml">W</mi><mi id="S4.SS3.p4.3.m3.1.1.3" xref="S4.SS3.p4.3.m3.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><apply id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.1.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p4.3.m3.1.1.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2">𝑊</ci><ci id="S4.SS3.p4.3.m3.1.1.3.cmml" xref="S4.SS3.p4.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">W^{p}</annotation></semantics></math>. This allows us to form different model-heterogeneity levels. Each cluster has a unique <math id="S4.SS3.p4.4.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">p</annotation></semantics></math> value, so clients within a cluster share the same architecture, termed the cluster-based model. Details on server-side aggregation of these models are provided in the subsequent section.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>DML with Diffusion Model</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.2" class="ltx_p">In this section, we present the process of server-side DML with the help of a diffusion model. Denoising diffusion probabilistic models (DDPM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> have been developed as probabilistic models, aiming at learning the underlying data distribution <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="p(x)" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.2" xref="S4.SS4.p1.1.m1.1.2.cmml"><mi id="S4.SS4.p1.1.m1.1.2.2" xref="S4.SS4.p1.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.2.1" xref="S4.SS4.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS4.p1.1.m1.1.2.3.2" xref="S4.SS4.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p1.1.m1.1.2.3.2.1" xref="S4.SS4.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS4.p1.1.m1.1.2.3.2.2" xref="S4.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.2"><times id="S4.SS4.p1.1.m1.1.2.1.cmml" xref="S4.SS4.p1.1.m1.1.2.1"></times><ci id="S4.SS4.p1.1.m1.1.2.2.cmml" xref="S4.SS4.p1.1.m1.1.2.2">𝑝</ci><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">p(x)</annotation></semantics></math>. This is achieved through a gradual denoising process applied to a normally distributed variable, which corresponds to the inverse process of a fixed Markov Chain with a length of <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\mathcal{T}</annotation></semantics></math>,</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.5" class="ltx_Math" alttext="x_{t}=\sqrt{\alpha_{t}}x_{t-1}+\sqrt{1-\alpha_{t}}\epsilon_{t},t\in\{1,2,\cdots,\mathcal{T}\}," display="block"><semantics id="S4.E5.m1.5a"><mrow id="S4.E5.m1.5.5.1"><mrow id="S4.E5.m1.5.5.1.1.2" xref="S4.E5.m1.5.5.1.1.3.cmml"><mrow id="S4.E5.m1.5.5.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.cmml"><msub id="S4.E5.m1.5.5.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.1.2.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.2.2" xref="S4.E5.m1.5.5.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E5.m1.5.5.1.1.1.1.2.3" xref="S4.E5.m1.5.5.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.E5.m1.5.5.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.3.cmml"><mrow id="S4.E5.m1.5.5.1.1.1.1.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.cmml"><msqrt id="S4.E5.m1.5.5.1.1.1.1.3.2.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.cmml"><msub id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.2.cmml">α</mi><mi id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.3" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.3.cmml">t</mi></msub></msqrt><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.1.1.1.1.3.2.1" xref="S4.E5.m1.5.5.1.1.1.1.3.2.1.cmml">​</mo><msub id="S4.E5.m1.5.5.1.1.1.1.3.2.3" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.3.2.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.2.cmml">x</mi><mrow id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.1" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.1.cmml">−</mo><mn id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E5.m1.5.5.1.1.1.1.3.1" xref="S4.E5.m1.5.5.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E5.m1.5.5.1.1.1.1.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.3.cmml"><msqrt id="S4.E5.m1.5.5.1.1.1.1.3.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.cmml"><mrow id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.cmml"><mn id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.2" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.2.cmml">1</mn><mo id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.1" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.1.cmml">−</mo><msub id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.2.cmml">α</mi><mi id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.1.1.1.1.3.3.1" xref="S4.E5.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><msub id="S4.E5.m1.5.5.1.1.1.1.3.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.3.3.3.2" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3.2.cmml">ϵ</mi><mi id="S4.E5.m1.5.5.1.1.1.1.3.3.3.3" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.1.1.2.3" xref="S4.E5.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S4.E5.m1.5.5.1.1.2.2" xref="S4.E5.m1.5.5.1.1.2.2.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2.2" xref="S4.E5.m1.5.5.1.1.2.2.2.cmml">t</mi><mo id="S4.E5.m1.5.5.1.1.2.2.1" xref="S4.E5.m1.5.5.1.1.2.2.1.cmml">∈</mo><mrow id="S4.E5.m1.5.5.1.1.2.2.3.2" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S4.E5.m1.5.5.1.1.2.2.3.2.1" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml">{</mo><mn id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">1</mn><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.2" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mn id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">2</mn><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.3" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">⋯</mi><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.4" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml">𝒯</mi><mo stretchy="false" id="S4.E5.m1.5.5.1.1.2.2.3.2.5" xref="S4.E5.m1.5.5.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.5b"><apply id="S4.E5.m1.5.5.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.3a.cmml" xref="S4.E5.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.5.5.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1"><eq id="S4.E5.m1.5.5.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1"></eq><apply id="S4.E5.m1.5.5.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.2.2">𝑥</ci><ci id="S4.E5.m1.5.5.1.1.1.1.2.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E5.m1.5.5.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3"><plus id="S4.E5.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.1"></plus><apply id="S4.E5.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2"><times id="S4.E5.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.1"></times><apply id="S4.E5.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2"><root id="S4.E5.m1.5.5.1.1.1.1.3.2.2a.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2"></root><apply id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.2">𝛼</ci><ci id="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S4.E5.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.3.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.3.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.2">𝑥</ci><apply id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3"><minus id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.1"></minus><ci id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S4.E5.m1.5.5.1.1.1.1.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3"><times id="S4.E5.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.1"></times><apply id="S4.E5.m1.5.5.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2"><root id="S4.E5.m1.5.5.1.1.1.1.3.3.2a.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2"></root><apply id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2"><minus id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.1"></minus><cn type="integer" id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.2">1</cn><apply id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.2">𝛼</ci><ci id="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E5.m1.5.5.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.3.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.3.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3.2">italic-ϵ</ci><ci id="S4.E5.m1.5.5.1.1.1.1.3.3.3.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S4.E5.m1.5.5.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2"><in id="S4.E5.m1.5.5.1.1.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.1"></in><ci id="S4.E5.m1.5.5.1.1.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2">𝑡</ci><set id="S4.E5.m1.5.5.1.1.2.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2"><cn type="integer" id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">1</cn><cn type="integer" id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">2</cn><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">⋯</ci><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">𝒯</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.5c">x_{t}=\sqrt{\alpha_{t}}x_{t-1}+\sqrt{1-\alpha_{t}}\epsilon_{t},t\in\{1,2,\cdots,\mathcal{T}\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p1.12" class="ltx_p">where sequence <math id="S4.SS4.p1.3.m1.1" class="ltx_Math" alttext="\{x_{t}\}" display="inline"><semantics id="S4.SS4.p1.3.m1.1a"><mrow id="S4.SS4.p1.3.m1.1.1.1" xref="S4.SS4.p1.3.m1.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p1.3.m1.1.1.1.2" xref="S4.SS4.p1.3.m1.1.1.2.cmml">{</mo><msub id="S4.SS4.p1.3.m1.1.1.1.1" xref="S4.SS4.p1.3.m1.1.1.1.1.cmml"><mi id="S4.SS4.p1.3.m1.1.1.1.1.2" xref="S4.SS4.p1.3.m1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS4.p1.3.m1.1.1.1.1.3" xref="S4.SS4.p1.3.m1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS4.p1.3.m1.1.1.1.3" xref="S4.SS4.p1.3.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m1.1b"><set id="S4.SS4.p1.3.m1.1.1.2.cmml" xref="S4.SS4.p1.3.m1.1.1.1"><apply id="S4.SS4.p1.3.m1.1.1.1.1.cmml" xref="S4.SS4.p1.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m1.1.1.1.1.1.cmml" xref="S4.SS4.p1.3.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.3.m1.1.1.1.1.2.cmml" xref="S4.SS4.p1.3.m1.1.1.1.1.2">𝑥</ci><ci id="S4.SS4.p1.3.m1.1.1.1.1.3.cmml" xref="S4.SS4.p1.3.m1.1.1.1.1.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m1.1c">\{x_{t}\}</annotation></semantics></math> changes from <math id="S4.SS4.p1.4.m2.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="S4.SS4.p1.4.m2.1a"><msub id="S4.SS4.p1.4.m2.1.1" xref="S4.SS4.p1.4.m2.1.1.cmml"><mi id="S4.SS4.p1.4.m2.1.1.2" xref="S4.SS4.p1.4.m2.1.1.2.cmml">x</mi><mn id="S4.SS4.p1.4.m2.1.1.3" xref="S4.SS4.p1.4.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m2.1b"><apply id="S4.SS4.p1.4.m2.1.1.cmml" xref="S4.SS4.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m2.1.1.1.cmml" xref="S4.SS4.p1.4.m2.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m2.1.1.2.cmml" xref="S4.SS4.p1.4.m2.1.1.2">𝑥</ci><cn type="integer" id="S4.SS4.p1.4.m2.1.1.3.cmml" xref="S4.SS4.p1.4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m2.1c">x_{1}</annotation></semantics></math> to <math id="S4.SS4.p1.5.m3.1" class="ltx_Math" alttext="x_{T}" display="inline"><semantics id="S4.SS4.p1.5.m3.1a"><msub id="S4.SS4.p1.5.m3.1.1" xref="S4.SS4.p1.5.m3.1.1.cmml"><mi id="S4.SS4.p1.5.m3.1.1.2" xref="S4.SS4.p1.5.m3.1.1.2.cmml">x</mi><mi id="S4.SS4.p1.5.m3.1.1.3" xref="S4.SS4.p1.5.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m3.1b"><apply id="S4.SS4.p1.5.m3.1.1.cmml" xref="S4.SS4.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m3.1.1.1.cmml" xref="S4.SS4.p1.5.m3.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m3.1.1.2.cmml" xref="S4.SS4.p1.5.m3.1.1.2">𝑥</ci><ci id="S4.SS4.p1.5.m3.1.1.3.cmml" xref="S4.SS4.p1.5.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m3.1c">x_{T}</annotation></semantics></math> sampled from a Gaussian distribution <math id="S4.SS4.p1.6.m4.2" class="ltx_Math" alttext="\mathcal{N}(0,I)" display="inline"><semantics id="S4.SS4.p1.6.m4.2a"><mrow id="S4.SS4.p1.6.m4.2.3" xref="S4.SS4.p1.6.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.6.m4.2.3.2" xref="S4.SS4.p1.6.m4.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.6.m4.2.3.1" xref="S4.SS4.p1.6.m4.2.3.1.cmml">​</mo><mrow id="S4.SS4.p1.6.m4.2.3.3.2" xref="S4.SS4.p1.6.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.6.m4.2.3.3.2.1" xref="S4.SS4.p1.6.m4.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p1.6.m4.1.1" xref="S4.SS4.p1.6.m4.1.1.cmml">0</mn><mo id="S4.SS4.p1.6.m4.2.3.3.2.2" xref="S4.SS4.p1.6.m4.2.3.3.1.cmml">,</mo><mi id="S4.SS4.p1.6.m4.2.2" xref="S4.SS4.p1.6.m4.2.2.cmml">I</mi><mo stretchy="false" id="S4.SS4.p1.6.m4.2.3.3.2.3" xref="S4.SS4.p1.6.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m4.2b"><apply id="S4.SS4.p1.6.m4.2.3.cmml" xref="S4.SS4.p1.6.m4.2.3"><times id="S4.SS4.p1.6.m4.2.3.1.cmml" xref="S4.SS4.p1.6.m4.2.3.1"></times><ci id="S4.SS4.p1.6.m4.2.3.2.cmml" xref="S4.SS4.p1.6.m4.2.3.2">𝒩</ci><interval closure="open" id="S4.SS4.p1.6.m4.2.3.3.1.cmml" xref="S4.SS4.p1.6.m4.2.3.3.2"><cn type="integer" id="S4.SS4.p1.6.m4.1.1.cmml" xref="S4.SS4.p1.6.m4.1.1">0</cn><ci id="S4.SS4.p1.6.m4.2.2.cmml" xref="S4.SS4.p1.6.m4.2.2">𝐼</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m4.2c">\mathcal{N}(0,I)</annotation></semantics></math>. At each step, Gaussian noise <math id="S4.SS4.p1.7.m5.1" class="ltx_Math" alttext="\epsilon_{t}" display="inline"><semantics id="S4.SS4.p1.7.m5.1a"><msub id="S4.SS4.p1.7.m5.1.1" xref="S4.SS4.p1.7.m5.1.1.cmml"><mi id="S4.SS4.p1.7.m5.1.1.2" xref="S4.SS4.p1.7.m5.1.1.2.cmml">ϵ</mi><mi id="S4.SS4.p1.7.m5.1.1.3" xref="S4.SS4.p1.7.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m5.1b"><apply id="S4.SS4.p1.7.m5.1.1.cmml" xref="S4.SS4.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.7.m5.1.1.1.cmml" xref="S4.SS4.p1.7.m5.1.1">subscript</csymbol><ci id="S4.SS4.p1.7.m5.1.1.2.cmml" xref="S4.SS4.p1.7.m5.1.1.2">italic-ϵ</ci><ci id="S4.SS4.p1.7.m5.1.1.3.cmml" xref="S4.SS4.p1.7.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m5.1c">\epsilon_{t}</annotation></semantics></math> is added, drawn from <math id="S4.SS4.p1.8.m6.2" class="ltx_Math" alttext="\mathcal{N}(0,I)" display="inline"><semantics id="S4.SS4.p1.8.m6.2a"><mrow id="S4.SS4.p1.8.m6.2.3" xref="S4.SS4.p1.8.m6.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.8.m6.2.3.2" xref="S4.SS4.p1.8.m6.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.8.m6.2.3.1" xref="S4.SS4.p1.8.m6.2.3.1.cmml">​</mo><mrow id="S4.SS4.p1.8.m6.2.3.3.2" xref="S4.SS4.p1.8.m6.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.8.m6.2.3.3.2.1" xref="S4.SS4.p1.8.m6.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p1.8.m6.1.1" xref="S4.SS4.p1.8.m6.1.1.cmml">0</mn><mo id="S4.SS4.p1.8.m6.2.3.3.2.2" xref="S4.SS4.p1.8.m6.2.3.3.1.cmml">,</mo><mi id="S4.SS4.p1.8.m6.2.2" xref="S4.SS4.p1.8.m6.2.2.cmml">I</mi><mo stretchy="false" id="S4.SS4.p1.8.m6.2.3.3.2.3" xref="S4.SS4.p1.8.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m6.2b"><apply id="S4.SS4.p1.8.m6.2.3.cmml" xref="S4.SS4.p1.8.m6.2.3"><times id="S4.SS4.p1.8.m6.2.3.1.cmml" xref="S4.SS4.p1.8.m6.2.3.1"></times><ci id="S4.SS4.p1.8.m6.2.3.2.cmml" xref="S4.SS4.p1.8.m6.2.3.2">𝒩</ci><interval closure="open" id="S4.SS4.p1.8.m6.2.3.3.1.cmml" xref="S4.SS4.p1.8.m6.2.3.3.2"><cn type="integer" id="S4.SS4.p1.8.m6.1.1.cmml" xref="S4.SS4.p1.8.m6.1.1">0</cn><ci id="S4.SS4.p1.8.m6.2.2.cmml" xref="S4.SS4.p1.8.m6.2.2">𝐼</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m6.2c">\mathcal{N}(0,I)</annotation></semantics></math>. <math id="S4.SS4.p1.9.m7.1" class="ltx_Math" alttext="\{\alpha_{t}\}_{t=1}^{\mathcal{T}}" display="inline"><semantics id="S4.SS4.p1.9.m7.1a"><msubsup id="S4.SS4.p1.9.m7.1.1" xref="S4.SS4.p1.9.m7.1.1.cmml"><mrow id="S4.SS4.p1.9.m7.1.1.1.1.1" xref="S4.SS4.p1.9.m7.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p1.9.m7.1.1.1.1.1.2" xref="S4.SS4.p1.9.m7.1.1.1.1.2.cmml">{</mo><msub id="S4.SS4.p1.9.m7.1.1.1.1.1.1" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p1.9.m7.1.1.1.1.1.1.2" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1.2.cmml">α</mi><mi id="S4.SS4.p1.9.m7.1.1.1.1.1.1.3" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS4.p1.9.m7.1.1.1.1.1.3" xref="S4.SS4.p1.9.m7.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS4.p1.9.m7.1.1.1.3" xref="S4.SS4.p1.9.m7.1.1.1.3.cmml"><mi id="S4.SS4.p1.9.m7.1.1.1.3.2" xref="S4.SS4.p1.9.m7.1.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p1.9.m7.1.1.1.3.1" xref="S4.SS4.p1.9.m7.1.1.1.3.1.cmml">=</mo><mn id="S4.SS4.p1.9.m7.1.1.1.3.3" xref="S4.SS4.p1.9.m7.1.1.1.3.3.cmml">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.9.m7.1.1.3" xref="S4.SS4.p1.9.m7.1.1.3.cmml">𝒯</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m7.1b"><apply id="S4.SS4.p1.9.m7.1.1.cmml" xref="S4.SS4.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.9.m7.1.1.2.cmml" xref="S4.SS4.p1.9.m7.1.1">superscript</csymbol><apply id="S4.SS4.p1.9.m7.1.1.1.cmml" xref="S4.SS4.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.9.m7.1.1.1.2.cmml" xref="S4.SS4.p1.9.m7.1.1">subscript</csymbol><set id="S4.SS4.p1.9.m7.1.1.1.1.2.cmml" xref="S4.SS4.p1.9.m7.1.1.1.1.1"><apply id="S4.SS4.p1.9.m7.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.9.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.9.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1.2">𝛼</ci><ci id="S4.SS4.p1.9.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.9.m7.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S4.SS4.p1.9.m7.1.1.1.3.cmml" xref="S4.SS4.p1.9.m7.1.1.1.3"><eq id="S4.SS4.p1.9.m7.1.1.1.3.1.cmml" xref="S4.SS4.p1.9.m7.1.1.1.3.1"></eq><ci id="S4.SS4.p1.9.m7.1.1.1.3.2.cmml" xref="S4.SS4.p1.9.m7.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p1.9.m7.1.1.1.3.3.cmml" xref="S4.SS4.p1.9.m7.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS4.p1.9.m7.1.1.3.cmml" xref="S4.SS4.p1.9.m7.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m7.1c">\{\alpha_{t}\}_{t=1}^{\mathcal{T}}</annotation></semantics></math> is pre-defined constants as the vanilla DDPM. The denoising process is designed to be the inverse of the diffusion process, wherein the Gaussian noise <math id="S4.SS4.p1.10.m8.2" class="ltx_Math" alttext="x_{\mathcal{T}}\sim\mathcal{N}(0,I)" display="inline"><semantics id="S4.SS4.p1.10.m8.2a"><mrow id="S4.SS4.p1.10.m8.2.3" xref="S4.SS4.p1.10.m8.2.3.cmml"><msub id="S4.SS4.p1.10.m8.2.3.2" xref="S4.SS4.p1.10.m8.2.3.2.cmml"><mi id="S4.SS4.p1.10.m8.2.3.2.2" xref="S4.SS4.p1.10.m8.2.3.2.2.cmml">x</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.10.m8.2.3.2.3" xref="S4.SS4.p1.10.m8.2.3.2.3.cmml">𝒯</mi></msub><mo id="S4.SS4.p1.10.m8.2.3.1" xref="S4.SS4.p1.10.m8.2.3.1.cmml">∼</mo><mrow id="S4.SS4.p1.10.m8.2.3.3" xref="S4.SS4.p1.10.m8.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.10.m8.2.3.3.2" xref="S4.SS4.p1.10.m8.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.10.m8.2.3.3.1" xref="S4.SS4.p1.10.m8.2.3.3.1.cmml">​</mo><mrow id="S4.SS4.p1.10.m8.2.3.3.3.2" xref="S4.SS4.p1.10.m8.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.10.m8.2.3.3.3.2.1" xref="S4.SS4.p1.10.m8.2.3.3.3.1.cmml">(</mo><mn id="S4.SS4.p1.10.m8.1.1" xref="S4.SS4.p1.10.m8.1.1.cmml">0</mn><mo id="S4.SS4.p1.10.m8.2.3.3.3.2.2" xref="S4.SS4.p1.10.m8.2.3.3.3.1.cmml">,</mo><mi id="S4.SS4.p1.10.m8.2.2" xref="S4.SS4.p1.10.m8.2.2.cmml">I</mi><mo stretchy="false" id="S4.SS4.p1.10.m8.2.3.3.3.2.3" xref="S4.SS4.p1.10.m8.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m8.2b"><apply id="S4.SS4.p1.10.m8.2.3.cmml" xref="S4.SS4.p1.10.m8.2.3"><csymbol cd="latexml" id="S4.SS4.p1.10.m8.2.3.1.cmml" xref="S4.SS4.p1.10.m8.2.3.1">similar-to</csymbol><apply id="S4.SS4.p1.10.m8.2.3.2.cmml" xref="S4.SS4.p1.10.m8.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.p1.10.m8.2.3.2.1.cmml" xref="S4.SS4.p1.10.m8.2.3.2">subscript</csymbol><ci id="S4.SS4.p1.10.m8.2.3.2.2.cmml" xref="S4.SS4.p1.10.m8.2.3.2.2">𝑥</ci><ci id="S4.SS4.p1.10.m8.2.3.2.3.cmml" xref="S4.SS4.p1.10.m8.2.3.2.3">𝒯</ci></apply><apply id="S4.SS4.p1.10.m8.2.3.3.cmml" xref="S4.SS4.p1.10.m8.2.3.3"><times id="S4.SS4.p1.10.m8.2.3.3.1.cmml" xref="S4.SS4.p1.10.m8.2.3.3.1"></times><ci id="S4.SS4.p1.10.m8.2.3.3.2.cmml" xref="S4.SS4.p1.10.m8.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS4.p1.10.m8.2.3.3.3.1.cmml" xref="S4.SS4.p1.10.m8.2.3.3.3.2"><cn type="integer" id="S4.SS4.p1.10.m8.1.1.cmml" xref="S4.SS4.p1.10.m8.1.1">0</cn><ci id="S4.SS4.p1.10.m8.2.2.cmml" xref="S4.SS4.p1.10.m8.2.2">𝐼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m8.2c">x_{\mathcal{T}}\sim\mathcal{N}(0,I)</annotation></semantics></math> is progressively restored back to its original state <math id="S4.SS4.p1.11.m9.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="S4.SS4.p1.11.m9.1a"><msub id="S4.SS4.p1.11.m9.1.1" xref="S4.SS4.p1.11.m9.1.1.cmml"><mi id="S4.SS4.p1.11.m9.1.1.2" xref="S4.SS4.p1.11.m9.1.1.2.cmml">x</mi><mn id="S4.SS4.p1.11.m9.1.1.3" xref="S4.SS4.p1.11.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.11.m9.1b"><apply id="S4.SS4.p1.11.m9.1.1.cmml" xref="S4.SS4.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.11.m9.1.1.1.cmml" xref="S4.SS4.p1.11.m9.1.1">subscript</csymbol><ci id="S4.SS4.p1.11.m9.1.1.2.cmml" xref="S4.SS4.p1.11.m9.1.1.2">𝑥</ci><cn type="integer" id="S4.SS4.p1.11.m9.1.1.3.cmml" xref="S4.SS4.p1.11.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.11.m9.1c">x_{1}</annotation></semantics></math> through denoising steps, for <math id="S4.SS4.p1.12.m10.4" class="ltx_Math" alttext="t=\mathcal{T},\cdots,1." display="inline"><semantics id="S4.SS4.p1.12.m10.4a"><mrow id="S4.SS4.p1.12.m10.4.4.1" xref="S4.SS4.p1.12.m10.4.4.1.1.cmml"><mrow id="S4.SS4.p1.12.m10.4.4.1.1" xref="S4.SS4.p1.12.m10.4.4.1.1.cmml"><mi id="S4.SS4.p1.12.m10.4.4.1.1.2" xref="S4.SS4.p1.12.m10.4.4.1.1.2.cmml">t</mi><mo id="S4.SS4.p1.12.m10.4.4.1.1.1" xref="S4.SS4.p1.12.m10.4.4.1.1.1.cmml">=</mo><mrow id="S4.SS4.p1.12.m10.4.4.1.1.3.2" xref="S4.SS4.p1.12.m10.4.4.1.1.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.12.m10.1.1" xref="S4.SS4.p1.12.m10.1.1.cmml">𝒯</mi><mo id="S4.SS4.p1.12.m10.4.4.1.1.3.2.1" xref="S4.SS4.p1.12.m10.4.4.1.1.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS4.p1.12.m10.2.2" xref="S4.SS4.p1.12.m10.2.2.cmml">⋯</mi><mo id="S4.SS4.p1.12.m10.4.4.1.1.3.2.2" xref="S4.SS4.p1.12.m10.4.4.1.1.3.1.cmml">,</mo><mn id="S4.SS4.p1.12.m10.3.3" xref="S4.SS4.p1.12.m10.3.3.cmml">1</mn></mrow></mrow><mo lspace="0em" id="S4.SS4.p1.12.m10.4.4.1.2" xref="S4.SS4.p1.12.m10.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.12.m10.4b"><apply id="S4.SS4.p1.12.m10.4.4.1.1.cmml" xref="S4.SS4.p1.12.m10.4.4.1"><eq id="S4.SS4.p1.12.m10.4.4.1.1.1.cmml" xref="S4.SS4.p1.12.m10.4.4.1.1.1"></eq><ci id="S4.SS4.p1.12.m10.4.4.1.1.2.cmml" xref="S4.SS4.p1.12.m10.4.4.1.1.2">𝑡</ci><list id="S4.SS4.p1.12.m10.4.4.1.1.3.1.cmml" xref="S4.SS4.p1.12.m10.4.4.1.1.3.2"><ci id="S4.SS4.p1.12.m10.1.1.cmml" xref="S4.SS4.p1.12.m10.1.1">𝒯</ci><ci id="S4.SS4.p1.12.m10.2.2.cmml" xref="S4.SS4.p1.12.m10.2.2">⋯</ci><cn type="integer" id="S4.SS4.p1.12.m10.3.3.cmml" xref="S4.SS4.p1.12.m10.3.3">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.12.m10.4c">t=\mathcal{T},\cdots,1.</annotation></semantics></math></p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">To enhance efficiency, FedTSA avoids the long training process that is usually required for diffusion models. We simply develop a prompt pool denoted as <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\mathcal{Y}</annotation></semantics></math> and leverage a pre-trained Stable Diffusion v1-4 Model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> for inference. By allowing clients to upload prompts to the server’s prompt pool, we have effectively mitigated concerns about data distribution and potential privacy issues. Moreover, before uploading textual prompts, the implementation of differential privacy techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> can be employed, whereby the inclusion of irrelevant text further safeguards the privacy of the system.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.8" class="ltx_p">In the diffusion model inference stage, when provided with a text prompt <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="y\in\mathcal{Y}" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><mrow id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">y</mi><mo id="S4.SS4.p3.1.m1.1.1.1" xref="S4.SS4.p3.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><in id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1.1"></in><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝑦</ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">y\in\mathcal{Y}</annotation></semantics></math> sent by the clients, the denoising U-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="\epsilon_{\theta}(\cdot)" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><mrow id="S4.SS4.p3.2.m2.1.2" xref="S4.SS4.p3.2.m2.1.2.cmml"><msub id="S4.SS4.p3.2.m2.1.2.2" xref="S4.SS4.p3.2.m2.1.2.2.cmml"><mi id="S4.SS4.p3.2.m2.1.2.2.2" xref="S4.SS4.p3.2.m2.1.2.2.2.cmml">ϵ</mi><mi id="S4.SS4.p3.2.m2.1.2.2.3" xref="S4.SS4.p3.2.m2.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.2.1" xref="S4.SS4.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS4.p3.2.m2.1.2.3.2" xref="S4.SS4.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.2.m2.1.2.3.2.1" xref="S4.SS4.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS4.p3.2.m2.1.2.3.2.2" xref="S4.SS4.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.2.cmml" xref="S4.SS4.p3.2.m2.1.2"><times id="S4.SS4.p3.2.m2.1.2.1.cmml" xref="S4.SS4.p3.2.m2.1.2.1"></times><apply id="S4.SS4.p3.2.m2.1.2.2.cmml" xref="S4.SS4.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.2.2.1.cmml" xref="S4.SS4.p3.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.2.2.2.cmml" xref="S4.SS4.p3.2.m2.1.2.2.2">italic-ϵ</ci><ci id="S4.SS4.p3.2.m2.1.2.2.3.cmml" xref="S4.SS4.p3.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\epsilon_{\theta}(\cdot)</annotation></semantics></math> generates predictions for the data sample <math id="S4.SS4.p3.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS4.p3.3.m3.1a"><mi id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><ci id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">x</annotation></semantics></math>, taking into consideration the conditioning on the text <math id="S4.SS4.p3.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS4.p3.4.m4.1a"><mi id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b"><ci id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">y</annotation></semantics></math>. These generated data <math id="S4.SS4.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{X}=\{x_{i}\}_{i=1}^{N}" display="inline"><semantics id="S4.SS4.p3.5.m5.1a"><mrow id="S4.SS4.p3.5.m5.1.1" xref="S4.SS4.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.5.m5.1.1.3" xref="S4.SS4.p3.5.m5.1.1.3.cmml">𝒳</mi><mo id="S4.SS4.p3.5.m5.1.1.2" xref="S4.SS4.p3.5.m5.1.1.2.cmml">=</mo><msubsup id="S4.SS4.p3.5.m5.1.1.1" xref="S4.SS4.p3.5.m5.1.1.1.cmml"><mrow id="S4.SS4.p3.5.m5.1.1.1.1.1.1" xref="S4.SS4.p3.5.m5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.5.m5.1.1.1.1.1.1.2" xref="S4.SS4.p3.5.m5.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.2" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.3" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS4.p3.5.m5.1.1.1.1.1.1.3" xref="S4.SS4.p3.5.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS4.p3.5.m5.1.1.1.1.3" xref="S4.SS4.p3.5.m5.1.1.1.1.3.cmml"><mi id="S4.SS4.p3.5.m5.1.1.1.1.3.2" xref="S4.SS4.p3.5.m5.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS4.p3.5.m5.1.1.1.1.3.1" xref="S4.SS4.p3.5.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS4.p3.5.m5.1.1.1.1.3.3" xref="S4.SS4.p3.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p3.5.m5.1.1.1.3" xref="S4.SS4.p3.5.m5.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.5.m5.1b"><apply id="S4.SS4.p3.5.m5.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1"><eq id="S4.SS4.p3.5.m5.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.2"></eq><ci id="S4.SS4.p3.5.m5.1.1.3.cmml" xref="S4.SS4.p3.5.m5.1.1.3">𝒳</ci><apply id="S4.SS4.p3.5.m5.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.1">superscript</csymbol><apply id="S4.SS4.p3.5.m5.1.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.1">subscript</csymbol><set id="S4.SS4.p3.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1"><apply id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS4.p3.5.m5.1.1.1.1.3.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.3"><eq id="S4.SS4.p3.5.m5.1.1.1.1.3.1.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.3.1"></eq><ci id="S4.SS4.p3.5.m5.1.1.1.1.3.2.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS4.p3.5.m5.1.1.1.1.3.3.cmml" xref="S4.SS4.p3.5.m5.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS4.p3.5.m5.1.1.1.3.cmml" xref="S4.SS4.p3.5.m5.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.5.m5.1c">\mathcal{X}=\{x_{i}\}_{i=1}^{N}</annotation></semantics></math> is used to conduct knowledge exchange between heterogeneous cluster-based models. Inspired by DML, we observe that mutual guidance between models enhances their generalization abilities. Unlike conventional KD, which may cause a student model to overfit to the teacher model’s outputs, DML introduces increased robustness and diversity. When applied to collaborative training across clusters, DML optimally harnesses inter-cluster knowledge, enabling heterogeneous cluster-based models to communicate. The soft prediction of a model <math id="S4.SS4.p3.6.m6.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S4.SS4.p3.6.m6.1a"><mi id="S4.SS4.p3.6.m6.1.1" xref="S4.SS4.p3.6.m6.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.6.m6.1b"><ci id="S4.SS4.p3.6.m6.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.6.m6.1c">w</annotation></semantics></math> for a given sample <math id="S4.SS4.p3.7.m7.1" class="ltx_Math" alttext="x_{i}\in\mathcal{X}" display="inline"><semantics id="S4.SS4.p3.7.m7.1a"><mrow id="S4.SS4.p3.7.m7.1.1" xref="S4.SS4.p3.7.m7.1.1.cmml"><msub id="S4.SS4.p3.7.m7.1.1.2" xref="S4.SS4.p3.7.m7.1.1.2.cmml"><mi id="S4.SS4.p3.7.m7.1.1.2.2" xref="S4.SS4.p3.7.m7.1.1.2.2.cmml">x</mi><mi id="S4.SS4.p3.7.m7.1.1.2.3" xref="S4.SS4.p3.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS4.p3.7.m7.1.1.1" xref="S4.SS4.p3.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.7.m7.1.1.3" xref="S4.SS4.p3.7.m7.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.7.m7.1b"><apply id="S4.SS4.p3.7.m7.1.1.cmml" xref="S4.SS4.p3.7.m7.1.1"><in id="S4.SS4.p3.7.m7.1.1.1.cmml" xref="S4.SS4.p3.7.m7.1.1.1"></in><apply id="S4.SS4.p3.7.m7.1.1.2.cmml" xref="S4.SS4.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.1.1.2.1.cmml" xref="S4.SS4.p3.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS4.p3.7.m7.1.1.2.2.cmml" xref="S4.SS4.p3.7.m7.1.1.2.2">𝑥</ci><ci id="S4.SS4.p3.7.m7.1.1.2.3.cmml" xref="S4.SS4.p3.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S4.SS4.p3.7.m7.1.1.3.cmml" xref="S4.SS4.p3.7.m7.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.7.m7.1c">x_{i}\in\mathcal{X}</annotation></semantics></math> for a class <math id="S4.SS4.p3.8.m8.4" class="ltx_Math" alttext="c\in\{1,2,\cdots,C\}" display="inline"><semantics id="S4.SS4.p3.8.m8.4a"><mrow id="S4.SS4.p3.8.m8.4.5" xref="S4.SS4.p3.8.m8.4.5.cmml"><mi id="S4.SS4.p3.8.m8.4.5.2" xref="S4.SS4.p3.8.m8.4.5.2.cmml">c</mi><mo id="S4.SS4.p3.8.m8.4.5.1" xref="S4.SS4.p3.8.m8.4.5.1.cmml">∈</mo><mrow id="S4.SS4.p3.8.m8.4.5.3.2" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS4.p3.8.m8.4.5.3.2.1" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml">{</mo><mn id="S4.SS4.p3.8.m8.1.1" xref="S4.SS4.p3.8.m8.1.1.cmml">1</mn><mo id="S4.SS4.p3.8.m8.4.5.3.2.2" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p3.8.m8.2.2" xref="S4.SS4.p3.8.m8.2.2.cmml">2</mn><mo id="S4.SS4.p3.8.m8.4.5.3.2.3" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS4.p3.8.m8.3.3" xref="S4.SS4.p3.8.m8.3.3.cmml">⋯</mi><mo id="S4.SS4.p3.8.m8.4.5.3.2.4" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml">,</mo><mi id="S4.SS4.p3.8.m8.4.4" xref="S4.SS4.p3.8.m8.4.4.cmml">C</mi><mo stretchy="false" id="S4.SS4.p3.8.m8.4.5.3.2.5" xref="S4.SS4.p3.8.m8.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.8.m8.4b"><apply id="S4.SS4.p3.8.m8.4.5.cmml" xref="S4.SS4.p3.8.m8.4.5"><in id="S4.SS4.p3.8.m8.4.5.1.cmml" xref="S4.SS4.p3.8.m8.4.5.1"></in><ci id="S4.SS4.p3.8.m8.4.5.2.cmml" xref="S4.SS4.p3.8.m8.4.5.2">𝑐</ci><set id="S4.SS4.p3.8.m8.4.5.3.1.cmml" xref="S4.SS4.p3.8.m8.4.5.3.2"><cn type="integer" id="S4.SS4.p3.8.m8.1.1.cmml" xref="S4.SS4.p3.8.m8.1.1">1</cn><cn type="integer" id="S4.SS4.p3.8.m8.2.2.cmml" xref="S4.SS4.p3.8.m8.2.2">2</cn><ci id="S4.SS4.p3.8.m8.3.3.cmml" xref="S4.SS4.p3.8.m8.3.3">⋯</ci><ci id="S4.SS4.p3.8.m8.4.4.cmml" xref="S4.SS4.p3.8.m8.4.4">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.8.m8.4c">c\in\{1,2,\cdots,C\}</annotation></semantics></math> is denoted as:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.3" class="ltx_Math" alttext="p_{i}^{c}=\frac{\text{exp}(z_{i}^{c}/T)}{\sum_{m=1}^{C}\text{exp}(z_{i}^{m}/T)}," display="block"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><msubsup id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.2.cmml"><mi id="S4.E6.m1.3.3.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.2.cmml">p</mi><mi id="S4.E6.m1.3.3.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.3.cmml">i</mi><mi id="S4.E6.m1.3.3.1.1.2.3" xref="S4.E6.m1.3.3.1.1.2.3.cmml">c</mi></msubsup><mo id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mtext id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2.cmml">z</mi><mi id="S4.E6.m1.1.1.1.1.1.1.2.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S4.E6.m1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.cmml">c</mi></msubsup><mo id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><msubsup id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml"><mo id="S4.E6.m1.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.3.2" xref="S4.E6.m1.2.2.2.2.2.3.2.cmml">m</mi><mo id="S4.E6.m1.2.2.2.2.2.3.1" xref="S4.E6.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.2.2.2.2.2.3.3" xref="S4.E6.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.3.cmml">C</mi></msubsup><mrow id="S4.E6.m1.2.2.2.1" xref="S4.E6.m1.2.2.2.1.cmml"><mtext id="S4.E6.m1.2.2.2.1.3" xref="S4.E6.m1.2.2.2.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.2.1.2" xref="S4.E6.m1.2.2.2.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.2.1.1.1" xref="S4.E6.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.2.1.1.1.2" xref="S4.E6.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.2.2.2.1.1.1.1" xref="S4.E6.m1.2.2.2.1.1.1.1.cmml"><msubsup id="S4.E6.m1.2.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S4.E6.m1.2.2.2.1.1.1.1.2.2.2" xref="S4.E6.m1.2.2.2.1.1.1.1.2.2.2.cmml">z</mi><mi id="S4.E6.m1.2.2.2.1.1.1.1.2.2.3" xref="S4.E6.m1.2.2.2.1.1.1.1.2.2.3.cmml">i</mi><mi id="S4.E6.m1.2.2.2.1.1.1.1.2.3" xref="S4.E6.m1.2.2.2.1.1.1.1.2.3.cmml">m</mi></msubsup><mo id="S4.E6.m1.2.2.2.1.1.1.1.1" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml">/</mo><mi id="S4.E6.m1.2.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.2.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S4.E6.m1.2.2.2.1.1.1.3" xref="S4.E6.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"></eq><apply id="S4.E6.m1.3.3.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E6.m1.3.3.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2">𝑝</ci><ci id="S4.E6.m1.3.3.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E6.m1.3.3.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.3">𝑐</ci></apply><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><divide id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2"></divide><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><times id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.3a.cmml" xref="S4.E6.m1.1.1.1.3"><mtext id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3">exp</mtext></ci><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><divide id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"></divide><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.2">𝑧</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><apply id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2">superscript</csymbol><apply id="S4.E6.m1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2">subscript</csymbol><sum id="S4.E6.m1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2"></sum><apply id="S4.E6.m1.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.3"><eq id="S4.E6.m1.2.2.2.2.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.3.1"></eq><ci id="S4.E6.m1.2.2.2.2.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="S4.E6.m1.2.2.2.2.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.3">𝐶</ci></apply><apply id="S4.E6.m1.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.1"><times id="S4.E6.m1.2.2.2.1.2.cmml" xref="S4.E6.m1.2.2.2.1.2"></times><ci id="S4.E6.m1.2.2.2.1.3a.cmml" xref="S4.E6.m1.2.2.2.1.3"><mtext id="S4.E6.m1.2.2.2.1.3.cmml" xref="S4.E6.m1.2.2.2.1.3">exp</mtext></ci><apply id="S4.E6.m1.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1"><divide id="S4.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.1"></divide><apply id="S4.E6.m1.2.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2.2.2">𝑧</ci><ci id="S4.E6.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.2.3">𝑚</ci></apply><ci id="S4.E6.m1.2.2.2.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">p_{i}^{c}=\frac{\text{exp}(z_{i}^{c}/T)}{\sum_{m=1}^{C}\text{exp}(z_{i}^{m}/T)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p3.15" class="ltx_p">where <math id="S4.SS4.p3.9.m1.1" class="ltx_Math" alttext="z_{i}^{c}" display="inline"><semantics id="S4.SS4.p3.9.m1.1a"><msubsup id="S4.SS4.p3.9.m1.1.1" xref="S4.SS4.p3.9.m1.1.1.cmml"><mi id="S4.SS4.p3.9.m1.1.1.2.2" xref="S4.SS4.p3.9.m1.1.1.2.2.cmml">z</mi><mi id="S4.SS4.p3.9.m1.1.1.2.3" xref="S4.SS4.p3.9.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS4.p3.9.m1.1.1.3" xref="S4.SS4.p3.9.m1.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.9.m1.1b"><apply id="S4.SS4.p3.9.m1.1.1.cmml" xref="S4.SS4.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.9.m1.1.1.1.cmml" xref="S4.SS4.p3.9.m1.1.1">superscript</csymbol><apply id="S4.SS4.p3.9.m1.1.1.2.cmml" xref="S4.SS4.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.9.m1.1.1.2.1.cmml" xref="S4.SS4.p3.9.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.9.m1.1.1.2.2.cmml" xref="S4.SS4.p3.9.m1.1.1.2.2">𝑧</ci><ci id="S4.SS4.p3.9.m1.1.1.2.3.cmml" xref="S4.SS4.p3.9.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS4.p3.9.m1.1.1.3.cmml" xref="S4.SS4.p3.9.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.9.m1.1c">z_{i}^{c}</annotation></semantics></math> is the logits, denoting the <math id="S4.SS4.p3.10.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS4.p3.10.m2.1a"><mi id="S4.SS4.p3.10.m2.1.1" xref="S4.SS4.p3.10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.10.m2.1b"><ci id="S4.SS4.p3.10.m2.1.1.cmml" xref="S4.SS4.p3.10.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.10.m2.1c">i</annotation></semantics></math>-th element in the model classifier’s outputs <math id="S4.SS4.p3.11.m3.1" class="ltx_Math" alttext="\mathcal{P}=\{z_{i}^{c}\}_{c=1}^{C}" display="inline"><semantics id="S4.SS4.p3.11.m3.1a"><mrow id="S4.SS4.p3.11.m3.1.1" xref="S4.SS4.p3.11.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.11.m3.1.1.3" xref="S4.SS4.p3.11.m3.1.1.3.cmml">𝒫</mi><mo id="S4.SS4.p3.11.m3.1.1.2" xref="S4.SS4.p3.11.m3.1.1.2.cmml">=</mo><msubsup id="S4.SS4.p3.11.m3.1.1.1" xref="S4.SS4.p3.11.m3.1.1.1.cmml"><mrow id="S4.SS4.p3.11.m3.1.1.1.1.1.1" xref="S4.SS4.p3.11.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.11.m3.1.1.1.1.1.1.2" xref="S4.SS4.p3.11.m3.1.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.2" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.3" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.3" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.3.cmml">c</mi></msubsup><mo stretchy="false" id="S4.SS4.p3.11.m3.1.1.1.1.1.1.3" xref="S4.SS4.p3.11.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS4.p3.11.m3.1.1.1.1.3" xref="S4.SS4.p3.11.m3.1.1.1.1.3.cmml"><mi id="S4.SS4.p3.11.m3.1.1.1.1.3.2" xref="S4.SS4.p3.11.m3.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS4.p3.11.m3.1.1.1.1.3.1" xref="S4.SS4.p3.11.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS4.p3.11.m3.1.1.1.1.3.3" xref="S4.SS4.p3.11.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p3.11.m3.1.1.1.3" xref="S4.SS4.p3.11.m3.1.1.1.3.cmml">C</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.11.m3.1b"><apply id="S4.SS4.p3.11.m3.1.1.cmml" xref="S4.SS4.p3.11.m3.1.1"><eq id="S4.SS4.p3.11.m3.1.1.2.cmml" xref="S4.SS4.p3.11.m3.1.1.2"></eq><ci id="S4.SS4.p3.11.m3.1.1.3.cmml" xref="S4.SS4.p3.11.m3.1.1.3">𝒫</ci><apply id="S4.SS4.p3.11.m3.1.1.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.11.m3.1.1.1.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1">superscript</csymbol><apply id="S4.SS4.p3.11.m3.1.1.1.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.11.m3.1.1.1.1.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1">subscript</csymbol><set id="S4.SS4.p3.11.m3.1.1.1.1.1.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1"><apply id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.SS4.p3.11.m3.1.1.1.1.3.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.3"><eq id="S4.SS4.p3.11.m3.1.1.1.1.3.1.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.3.1"></eq><ci id="S4.SS4.p3.11.m3.1.1.1.1.3.2.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.3.2">𝑐</ci><cn type="integer" id="S4.SS4.p3.11.m3.1.1.1.1.3.3.cmml" xref="S4.SS4.p3.11.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS4.p3.11.m3.1.1.1.3.cmml" xref="S4.SS4.p3.11.m3.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.11.m3.1c">\mathcal{P}=\{z_{i}^{c}\}_{c=1}^{C}</annotation></semantics></math> for a given sample <math id="S4.SS4.p3.12.m4.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S4.SS4.p3.12.m4.1a"><msub id="S4.SS4.p3.12.m4.1.1" xref="S4.SS4.p3.12.m4.1.1.cmml"><mi id="S4.SS4.p3.12.m4.1.1.2" xref="S4.SS4.p3.12.m4.1.1.2.cmml">x</mi><mi id="S4.SS4.p3.12.m4.1.1.3" xref="S4.SS4.p3.12.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.12.m4.1b"><apply id="S4.SS4.p3.12.m4.1.1.cmml" xref="S4.SS4.p3.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.12.m4.1.1.1.cmml" xref="S4.SS4.p3.12.m4.1.1">subscript</csymbol><ci id="S4.SS4.p3.12.m4.1.1.2.cmml" xref="S4.SS4.p3.12.m4.1.1.2">𝑥</ci><ci id="S4.SS4.p3.12.m4.1.1.3.cmml" xref="S4.SS4.p3.12.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.12.m4.1c">x_{i}</annotation></semantics></math>. <math id="S4.SS4.p3.13.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS4.p3.13.m5.1a"><mi id="S4.SS4.p3.13.m5.1.1" xref="S4.SS4.p3.13.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.13.m5.1b"><ci id="S4.SS4.p3.13.m5.1.1.cmml" xref="S4.SS4.p3.13.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.13.m5.1c">T</annotation></semantics></math> is a temperature parameter to adjust the impact of logits. Assuming the output logits of a cluster-based model <math id="S4.SS4.p3.14.m6.1" class="ltx_Math" alttext="W_{r}" display="inline"><semantics id="S4.SS4.p3.14.m6.1a"><msub id="S4.SS4.p3.14.m6.1.1" xref="S4.SS4.p3.14.m6.1.1.cmml"><mi id="S4.SS4.p3.14.m6.1.1.2" xref="S4.SS4.p3.14.m6.1.1.2.cmml">W</mi><mi id="S4.SS4.p3.14.m6.1.1.3" xref="S4.SS4.p3.14.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.14.m6.1b"><apply id="S4.SS4.p3.14.m6.1.1.cmml" xref="S4.SS4.p3.14.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.14.m6.1.1.1.cmml" xref="S4.SS4.p3.14.m6.1.1">subscript</csymbol><ci id="S4.SS4.p3.14.m6.1.1.2.cmml" xref="S4.SS4.p3.14.m6.1.1.2">𝑊</ci><ci id="S4.SS4.p3.14.m6.1.1.3.cmml" xref="S4.SS4.p3.14.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.14.m6.1c">W_{r}</annotation></semantics></math> on the generated data are <math id="S4.SS4.p3.15.m7.1" class="ltx_Math" alttext="z_{r}" display="inline"><semantics id="S4.SS4.p3.15.m7.1a"><msub id="S4.SS4.p3.15.m7.1.1" xref="S4.SS4.p3.15.m7.1.1.cmml"><mi id="S4.SS4.p3.15.m7.1.1.2" xref="S4.SS4.p3.15.m7.1.1.2.cmml">z</mi><mi id="S4.SS4.p3.15.m7.1.1.3" xref="S4.SS4.p3.15.m7.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.15.m7.1b"><apply id="S4.SS4.p3.15.m7.1.1.cmml" xref="S4.SS4.p3.15.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.15.m7.1.1.1.cmml" xref="S4.SS4.p3.15.m7.1.1">subscript</csymbol><ci id="S4.SS4.p3.15.m7.1.1.2.cmml" xref="S4.SS4.p3.15.m7.1.1.2">𝑧</ci><ci id="S4.SS4.p3.15.m7.1.1.3.cmml" xref="S4.SS4.p3.15.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.15.m7.1c">z_{r}</annotation></semantics></math>, we compute the global knowledge for cluster-based models with the average logits during the DML process, formulated as:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.1" class="ltx_Math" alttext="z_{avg}=\frac{1}{M}\sum_{r=1}^{M}z_{r}," display="block"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.2.2.cmml">z</mi><mrow id="S4.E7.m1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.1.1.1.1.2.3.2" xref="S4.E7.m1.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.1.1.2.3.1" xref="S4.E7.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E7.m1.1.1.1.1.2.3.3" xref="S4.E7.m1.1.1.1.1.2.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.1.1.2.3.1a" xref="S4.E7.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E7.m1.1.1.1.1.2.3.4" xref="S4.E7.m1.1.1.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml"><mfrac id="S4.E7.m1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.3.2.cmml"><mn id="S4.E7.m1.1.1.1.1.3.2.2" xref="S4.E7.m1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S4.E7.m1.1.1.1.1.3.2.3" xref="S4.E7.m1.1.1.1.1.3.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.1.1.3.1" xref="S4.E7.m1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E7.m1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.3.3.cmml"><munderover id="S4.E7.m1.1.1.1.1.3.3.1" xref="S4.E7.m1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S4.E7.m1.1.1.1.1.3.3.1.2.2" xref="S4.E7.m1.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.1.1.1.1.3.3.1.2.3" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.cmml"><mi id="S4.E7.m1.1.1.1.1.3.3.1.2.3.2" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.2.cmml">r</mi><mo id="S4.E7.m1.1.1.1.1.3.3.1.2.3.1" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E7.m1.1.1.1.1.3.3.1.2.3.3" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.1.1.1.1.3.3.1.3" xref="S4.E7.m1.1.1.1.1.3.3.1.3.cmml">M</mi></munderover><msub id="S4.E7.m1.1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E7.m1.1.1.1.1.3.3.2.2" xref="S4.E7.m1.1.1.1.1.3.3.2.2.cmml">z</mi><mi id="S4.E7.m1.1.1.1.1.3.3.2.3" xref="S4.E7.m1.1.1.1.1.3.3.2.3.cmml">r</mi></msub></mrow></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><eq id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"></eq><apply id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.2.2">𝑧</ci><apply id="S4.E7.m1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.2.3"><times id="S4.E7.m1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.1.1.1.1.2.3.1"></times><ci id="S4.E7.m1.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.1.1.1.1.2.3.2">𝑎</ci><ci id="S4.E7.m1.1.1.1.1.2.3.3.cmml" xref="S4.E7.m1.1.1.1.1.2.3.3">𝑣</ci><ci id="S4.E7.m1.1.1.1.1.2.3.4.cmml" xref="S4.E7.m1.1.1.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3"><times id="S4.E7.m1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.1"></times><apply id="S4.E7.m1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2"><divide id="S4.E7.m1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S4.E7.m1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2.2">1</cn><ci id="S4.E7.m1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.2.3">𝑀</ci></apply><apply id="S4.E7.m1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3"><apply id="S4.E7.m1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1">superscript</csymbol><apply id="S4.E7.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E7.m1.1.1.1.1.3.3.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.2.2"></sum><apply id="S4.E7.m1.1.1.1.1.3.3.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3"><eq id="S4.E7.m1.1.1.1.1.3.3.1.2.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S4.E7.m1.1.1.1.1.3.3.1.2.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.2">𝑟</ci><cn type="integer" id="S4.E7.m1.1.1.1.1.3.3.1.2.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.1.3">𝑀</ci></apply><apply id="S4.E7.m1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2.2">𝑧</ci><ci id="S4.E7.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">z_{avg}=\frac{1}{M}\sum_{r=1}^{M}z_{r},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p3.16" class="ltx_p">where <math id="S4.SS4.p3.16.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS4.p3.16.m1.1a"><mi id="S4.SS4.p3.16.m1.1.1" xref="S4.SS4.p3.16.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.16.m1.1b"><ci id="S4.SS4.p3.16.m1.1.1.cmml" xref="S4.SS4.p3.16.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.16.m1.1c">M</annotation></semantics></math> is the total number of clusters. To evaluate the divergence between two predictions, we apply the KL divergence:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.3" class="ltx_Math" alttext="D_{KL}(p_{2}\|p_{1})=\sum_{i=1}^{N}\sum_{c=1}^{C}p_{2}^{c}(x_{i})\log\frac{p_{2}^{c}(x_{i})}{p_{1}^{c}(x_{i})}." display="block"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml"><msub id="S4.E8.m1.3.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.3.2.cmml">D</mi><mrow id="S4.E8.m1.3.3.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.3.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.3.3.2" xref="S4.E8.m1.3.3.1.1.1.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.3.3.1" xref="S4.E8.m1.3.3.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E8.m1.3.3.1.1.1.3.3.3" xref="S4.E8.m1.3.3.1.1.1.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml">p</mi><mn id="S4.E8.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.cmml">p</mi><mn id="S4.E8.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E8.m1.3.3.1.1.3" xref="S4.E8.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml"><munderover id="S4.E8.m1.3.3.1.1.2.2" xref="S4.E8.m1.3.3.1.1.2.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E8.m1.3.3.1.1.2.2.2.2" xref="S4.E8.m1.3.3.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.3.3.1.1.2.2.2.3" xref="S4.E8.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1.2.2.2.3.2" xref="S4.E8.m1.3.3.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.E8.m1.3.3.1.1.2.2.2.3.1" xref="S4.E8.m1.3.3.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.3.3.1.1.2.2.2.3.3" xref="S4.E8.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.3.3.1.1.2.2.3" xref="S4.E8.m1.3.3.1.1.2.2.3.cmml">N</mi></munderover><mrow id="S4.E8.m1.3.3.1.1.2.1" xref="S4.E8.m1.3.3.1.1.2.1.cmml"><munderover id="S4.E8.m1.3.3.1.1.2.1.2" xref="S4.E8.m1.3.3.1.1.2.1.2.cmml"><mo movablelimits="false" id="S4.E8.m1.3.3.1.1.2.1.2.2.2" xref="S4.E8.m1.3.3.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.3.3.1.1.2.1.2.2.3" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1.2.1.2.2.3.2" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.2.cmml">c</mi><mo id="S4.E8.m1.3.3.1.1.2.1.2.2.3.1" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.3.3.1.1.2.1.2.2.3.3" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.3.3.1.1.2.1.2.3" xref="S4.E8.m1.3.3.1.1.2.1.2.3.cmml">C</mi></munderover><mrow id="S4.E8.m1.3.3.1.1.2.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.cmml"><msubsup id="S4.E8.m1.3.3.1.1.2.1.1.3" xref="S4.E8.m1.3.3.1.1.2.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.2.1.1.3.2.2" xref="S4.E8.m1.3.3.1.1.2.1.1.3.2.2.cmml">p</mi><mn id="S4.E8.m1.3.3.1.1.2.1.1.3.2.3" xref="S4.E8.m1.3.3.1.1.2.1.1.3.2.3.cmml">2</mn><mi id="S4.E8.m1.3.3.1.1.2.1.1.3.3" xref="S4.E8.m1.3.3.1.1.2.1.1.3.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.2.1.1.2" xref="S4.E8.m1.3.3.1.1.2.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.2.1.1.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E8.m1.3.3.1.1.2.1.1.2a" xref="S4.E8.m1.3.3.1.1.2.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.2.1.1.4" xref="S4.E8.m1.3.3.1.1.2.1.1.4.cmml"><mi id="S4.E8.m1.3.3.1.1.2.1.1.4.1" xref="S4.E8.m1.3.3.1.1.2.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.E8.m1.3.3.1.1.2.1.1.4a" xref="S4.E8.m1.3.3.1.1.2.1.1.4.cmml">⁡</mo><mfrac id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.3.2.2.cmml">p</mi><mn id="S4.E8.m1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.3.2.3.cmml">2</mn><mi id="S4.E8.m1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.3.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml"><msubsup id="S4.E8.m1.2.2.2.3" xref="S4.E8.m1.2.2.2.3.cmml"><mi id="S4.E8.m1.2.2.2.3.2.2" xref="S4.E8.m1.2.2.2.3.2.2.cmml">p</mi><mn id="S4.E8.m1.2.2.2.3.2.3" xref="S4.E8.m1.2.2.2.3.2.3.cmml">1</mn><mi id="S4.E8.m1.2.2.2.3.3" xref="S4.E8.m1.2.2.2.3.3.cmml">c</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">​</mo><mrow id="S4.E8.m1.2.2.2.1.1" xref="S4.E8.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.2.1.1.2" xref="S4.E8.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E8.m1.2.2.2.1.1.1" xref="S4.E8.m1.2.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.2.1.1.1.2" xref="S4.E8.m1.2.2.2.1.1.1.2.cmml">x</mi><mi id="S4.E8.m1.2.2.2.1.1.1.3" xref="S4.E8.m1.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m1.2.2.2.1.1.3" xref="S4.E8.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E8.m1.3.3.1.2" xref="S4.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1"><eq id="S4.E8.m1.3.3.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.3"></eq><apply id="S4.E8.m1.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1"><times id="S4.E8.m1.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.3.2">𝐷</ci><apply id="S4.E8.m1.3.3.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.3.3"><times id="S4.E8.m1.3.3.1.1.1.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.3.3.1"></times><ci id="S4.E8.m1.3.3.1.1.1.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.3.3.2">𝐾</ci><ci id="S4.E8.m1.3.3.1.1.1.3.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.3.3.3">𝐿</ci></apply></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.2">𝑝</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.3">2</cn></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.2">𝑝</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2"><apply id="S4.E8.m1.3.3.1.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.2">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.2">subscript</csymbol><sum id="S4.E8.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.2"></sum><apply id="S4.E8.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3"><eq id="S4.E8.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3.1"></eq><ci id="S4.E8.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.3.3.1.1.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.2.3">𝑁</ci></apply><apply id="S4.E8.m1.3.3.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1"><apply id="S4.E8.m1.3.3.1.1.2.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.2.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.1.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2">subscript</csymbol><sum id="S4.E8.m1.3.3.1.1.2.1.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.2.2"></sum><apply id="S4.E8.m1.3.3.1.1.2.1.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3"><eq id="S4.E8.m1.3.3.1.1.2.1.2.2.3.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.1"></eq><ci id="S4.E8.m1.3.3.1.1.2.1.2.2.3.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.2">𝑐</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.2.1.2.2.3.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.3.3.1.1.2.1.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2.3">𝐶</ci></apply><apply id="S4.E8.m1.3.3.1.1.2.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1"><times id="S4.E8.m1.3.3.1.1.2.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.2.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.2.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.1.1.3.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.2.1.1.3.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3.2.2">𝑝</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.2.1.1.3.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3.2.3">2</cn></apply><ci id="S4.E8.m1.3.3.1.1.2.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.3.3">𝑐</ci></apply><apply id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.2">𝑥</ci><ci id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E8.m1.3.3.1.1.2.1.1.4.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.4"><log id="S4.E8.m1.3.3.1.1.2.1.1.4.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.4.1"></log><apply id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2"><divide id="S4.E8.m1.2.2.3.cmml" xref="S4.E8.m1.2.2"></divide><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.3.2.2">𝑝</ci><cn type="integer" id="S4.E8.m1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.3.2.3">2</cn></apply><ci id="S4.E8.m1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.3.3">𝑐</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"><times id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2"></times><apply id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.3.1.cmml" xref="S4.E8.m1.2.2.2.3">superscript</csymbol><apply id="S4.E8.m1.2.2.2.3.2.cmml" xref="S4.E8.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.3.2.1.cmml" xref="S4.E8.m1.2.2.2.3">subscript</csymbol><ci id="S4.E8.m1.2.2.2.3.2.2.cmml" xref="S4.E8.m1.2.2.2.3.2.2">𝑝</ci><cn type="integer" id="S4.E8.m1.2.2.2.3.2.3.cmml" xref="S4.E8.m1.2.2.2.3.2.3">1</cn></apply><ci id="S4.E8.m1.2.2.2.3.3.cmml" xref="S4.E8.m1.2.2.2.3.3">𝑐</ci></apply><apply id="S4.E8.m1.2.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.1.1.1.2">𝑥</ci><ci id="S4.E8.m1.2.2.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">D_{KL}(p_{2}\|p_{1})=\sum_{i=1}^{N}\sum_{c=1}^{C}p_{2}^{c}(x_{i})\log\frac{p_{2}^{c}(x_{i})}{p_{1}^{c}(x_{i})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p3.17" class="ltx_p">The last step is calculating the KL divergence between the logits of each cluster-based model and the global knowledge, acting as a loss function to guide the model update. After each cluster gets the updated cluster-based model from the server, the clients start the local training for the next round with the new model and repeat the Stage 1 and Stage 2 aggregation until the model converges.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p"><span id="S5.SS1.p1.3.1" class="ltx_text ltx_font_bold">Datasets and Models.</span> We evaluate the performance of FedTSA using three benchmark datasets, i.e., CIFAR-10, CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and Tiny-ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. We consider both IID and non-IID data distributions in the experiments. In the IID setting, data is evenly distributed to each client in terms of both quantity and class distribution. In the non-IID settings, we employ the Dirichlet distribution <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="Dir(\alpha)" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.2" xref="S5.SS1.p1.1.m1.1.2.cmml"><mi id="S5.SS1.p1.1.m1.1.2.2" xref="S5.SS1.p1.1.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.m1.1.2.1" xref="S5.SS1.p1.1.m1.1.2.1.cmml">​</mo><mi id="S5.SS1.p1.1.m1.1.2.3" xref="S5.SS1.p1.1.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.m1.1.2.1a" xref="S5.SS1.p1.1.m1.1.2.1.cmml">​</mo><mi id="S5.SS1.p1.1.m1.1.2.4" xref="S5.SS1.p1.1.m1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.m1.1.2.1b" xref="S5.SS1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S5.SS1.p1.1.m1.1.2.5.2" xref="S5.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S5.SS1.p1.1.m1.1.2.5.2.1" xref="S5.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S5.SS1.p1.1.m1.1.2.5.2.2" xref="S5.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.2"><times id="S5.SS1.p1.1.m1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.2.1"></times><ci id="S5.SS1.p1.1.m1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.2.2">𝐷</ci><ci id="S5.SS1.p1.1.m1.1.2.3.cmml" xref="S5.SS1.p1.1.m1.1.2.3">𝑖</ci><ci id="S5.SS1.p1.1.m1.1.2.4.cmml" xref="S5.SS1.p1.1.m1.1.2.4">𝑟</ci><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">Dir(\alpha)</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> to allocate the dataset among the clients, where a smaller <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\alpha</annotation></semantics></math> indicates higher data heterogeneity. We set the <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\alpha</annotation></semantics></math> to 0.3 and 0.6 to introduce different data heterogeneity levels. We use the ResNet18 as the model in the experiments. To incorporate model heterogeneity, we adjust the model complexity by varying the hidden sizes of the residual blocks with a pruning rate, where a smaller rate represents a simpler model.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.6" class="ltx_p"><span id="S5.SS1.p2.6.1" class="ltx_text ltx_font_bold">Hyper-parameters.</span> In the experiments, the hyper-parameters are set as follows. For the general FL training parameters, we set the local update batch size <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">B</annotation></semantics></math> to 100, the number of local epoch <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">E</annotation></semantics></math> to 100, the number of users <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">K</annotation></semantics></math> to 20, the learning rate to 0.03, and the training round to 100. For FedTSA’s specific hyper-parameters, we set the temperature <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mi id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><ci id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">T</annotation></semantics></math> to 5, the number of global epochs to 1, and the DML loss function to KL-only. In terms of the prompts for the diffusion model, we use the format of “A photo of real <math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><mo id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><ci id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">\ast</annotation></semantics></math>”, where <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><mo id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><ci id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">\ast</annotation></semantics></math> can be “bird”, “cat” and other objects according to the training tasks. We also explore the impact of these specific hyper-parameters on model performance.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines and Implementation.</span> Given that the primary contribution of FedTSA is to achieve promising model-heterogeneous FL, we select four FL approaches that allow clients to use different model architectures, i.e., FedProto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and HeteroFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. We also select the vanilla FL algorithm FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and the improved version FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> to underscore the significance of enabling model heterogeneity. For model-homogeneous algorithms, FedAvg and FedProx, we present the results where clients have complete models and pruned models (<math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">p</annotation></semantics></math>=0.6), representing upper and lower accuracy bounds, respectively. For model-heterogeneous algorithms, FedProto, FedMD, FedDF, HeteroFL and FedTSA, we employ three clusters with pruning rates of 1.0, 0.8, and 0.6. These rates correspond to client distributions of 20%, 40%, and 40%, respectively. The experimental results are based on the average of five runs. All experiments are implemented in PyTorch and executed on a server machine with an NVIDIA A100 GPU.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance Evaluation and Analysis</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Performance Comparison.</span> From the results presented in Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we can observe that FedTSA outperforms other FL baselines across both IID and non-IID settings, highlighting its promising performance and robustness to heterogeneous data. An exception is noted in the IID setting of CIFAR-10 dataset, where FedTSA slightly lags behind the upper bound performance of FedAvg. However, we should notice that the upper bounds for FedAvg and FedProx are based on an idealized scenario where all clients have unpruned models. Given this context, FedTSA still maintains a dominant performance over most upper bounds across both IID and non-IID settings. This superior performance is attributed to FedTSA’s innovative strategy. Contrasting with algorithms that conventionally replace the global model with a local model for round updates, FedTSA fosters inter-client learning through DML. Specifically, FedTSA utilizes the KL divergence loss to learn the average logits from other client models, thereby effectively obviating the need to rely on a singular global model. Consequently, each model not only gains knowledge from its counterparts but also sidesteps potential information loss that may arise from direct replacement. Besides, we can notice that FedProto presents the lowest accuracy, revealing that prototype-based FL methods do not perform as well as methods based on knowledge distillation and local training in the presence of model heterogeneity. This is because simpler models produce lower-quality prototypes, which in turn degrades the quality of the aggregated global prototypes, ultimately leading to poor model training outcomes.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S5.T3.3.2" class="ltx_text" style="font-size:90%;">Average test accuracy (%) on three datasets under different degrees of data heterogeneity.</span></figcaption>
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.4.1.1" class="ltx_tr">
<th id="S5.T3.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Dataset</th>
<th id="S5.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">IID/non-IID</th>
<th id="S5.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedAvg</th>
<th id="S5.T3.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedProx</th>
<th id="S5.T3.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedProto</th>
<th id="S5.T3.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedMD</th>
<th id="S5.T3.4.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedDF</th>
<th id="S5.T3.4.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HeteroFL</th>
<th id="S5.T3.4.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedTSA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.4.2.1" class="ltx_tr">
<th id="S5.T3.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S5.T3.4.2.1.1.1" class="ltx_text">CIFAR-10</span></th>
<th id="S5.T3.4.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">IID</th>
<td id="S5.T3.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">84.23-<span id="S5.T3.4.2.1.3.1" class="ltx_text ltx_font_bold">90.86</span>
</td>
<td id="S5.T3.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">83.85-86.47</td>
<td id="S5.T3.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">59.6</td>
<td id="S5.T3.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">74.26</td>
<td id="S5.T3.4.2.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">79.01</td>
<td id="S5.T3.4.2.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">87.61</td>
<td id="S5.T3.4.2.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">89.28</td>
</tr>
<tr id="S5.T3.4.3.2" class="ltx_tr">
<th id="S5.T3.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.6)</th>
<td id="S5.T3.4.3.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">81.54-83.55</td>
<td id="S5.T3.4.3.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">82.31-84.26</td>
<td id="S5.T3.4.3.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.51</td>
<td id="S5.T3.4.3.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">71.33</td>
<td id="S5.T3.4.3.2.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">76.98</td>
<td id="S5.T3.4.3.2.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">85.09</td>
<td id="S5.T3.4.3.2.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.3.2.8.1" class="ltx_text ltx_font_bold">86.72</span></td>
</tr>
<tr id="S5.T3.4.4.3" class="ltx_tr">
<th id="S5.T3.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.3)</th>
<td id="S5.T3.4.4.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">77.25-80.91</td>
<td id="S5.T3.4.4.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">80.71-82.39</td>
<td id="S5.T3.4.4.3.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.33</td>
<td id="S5.T3.4.4.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">70.03</td>
<td id="S5.T3.4.4.3.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">75.12</td>
<td id="S5.T3.4.4.3.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">82.77</td>
<td id="S5.T3.4.4.3.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.4.3.8.1" class="ltx_text ltx_font_bold">84.61</span></td>
</tr>
<tr id="S5.T3.4.5.4" class="ltx_tr">
<th id="S5.T3.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S5.T3.4.5.4.1.1" class="ltx_text">CIFAR-100</span></th>
<th id="S5.T3.4.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">IID</th>
<td id="S5.T3.4.5.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">47.69-50.73</td>
<td id="S5.T3.4.5.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">48.27-51.96</td>
<td id="S5.T3.4.5.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">36.41</td>
<td id="S5.T3.4.5.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">35.24</td>
<td id="S5.T3.4.5.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">39.71</td>
<td id="S5.T3.4.5.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">58.92</td>
<td id="S5.T3.4.5.4.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.5.4.9.1" class="ltx_text ltx_font_bold">60.56</span></td>
</tr>
<tr id="S5.T3.4.6.5" class="ltx_tr">
<th id="S5.T3.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.6)</th>
<td id="S5.T3.4.6.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.94-50.12</td>
<td id="S5.T3.4.6.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">47.95-51.23</td>
<td id="S5.T3.4.6.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">31.07</td>
<td id="S5.T3.4.6.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">30.33</td>
<td id="S5.T3.4.6.5.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">35.98</td>
<td id="S5.T3.4.6.5.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.04</td>
<td id="S5.T3.4.6.5.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.6.5.8.1" class="ltx_text ltx_font_bold">60.02</span></td>
</tr>
<tr id="S5.T3.4.7.6" class="ltx_tr">
<th id="S5.T3.4.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.3)</th>
<td id="S5.T3.4.7.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">45.28-48.31</td>
<td id="S5.T3.4.7.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.24-49.02</td>
<td id="S5.T3.4.7.6.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">28.46</td>
<td id="S5.T3.4.7.6.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">29.78</td>
<td id="S5.T3.4.7.6.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">33.25</td>
<td id="S5.T3.4.7.6.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.37</td>
<td id="S5.T3.4.7.6.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.7.6.8.1" class="ltx_text ltx_font_bold">59.57</span></td>
</tr>
<tr id="S5.T3.4.8.7" class="ltx_tr">
<th id="S5.T3.4.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;" rowspan="3"><span id="S5.T3.4.8.7.1.1" class="ltx_text">Tiny-ImageNet</span></th>
<th id="S5.T3.4.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">IID</th>
<td id="S5.T3.4.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">29.88-31.04</td>
<td id="S5.T3.4.8.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">30.12-31.87</td>
<td id="S5.T3.4.8.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">18.55</td>
<td id="S5.T3.4.8.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">19.23</td>
<td id="S5.T3.4.8.7.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">22.76</td>
<td id="S5.T3.4.8.7.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">34.57</td>
<td id="S5.T3.4.8.7.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.8.7.9.1" class="ltx_text ltx_font_bold">36.28</span></td>
</tr>
<tr id="S5.T3.4.9.8" class="ltx_tr">
<th id="S5.T3.4.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.6)</th>
<td id="S5.T3.4.9.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">27.31-29.53</td>
<td id="S5.T3.4.9.8.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">28.05-30.07</td>
<td id="S5.T3.4.9.8.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">17.84</td>
<td id="S5.T3.4.9.8.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">18.65</td>
<td id="S5.T3.4.9.8.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">21.14</td>
<td id="S5.T3.4.9.8.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">33.82</td>
<td id="S5.T3.4.9.8.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.9.8.8.1" class="ltx_text ltx_font_bold">35.62</span></td>
</tr>
<tr id="S5.T3.4.10.9" class="ltx_tr">
<th id="S5.T3.4.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.3)</th>
<td id="S5.T3.4.10.9.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">26.59-27.49</td>
<td id="S5.T3.4.10.9.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">27.23-29.38</td>
<td id="S5.T3.4.10.9.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">17.03</td>
<td id="S5.T3.4.10.9.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">17.49</td>
<td id="S5.T3.4.10.9.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">20.68</td>
<td id="S5.T3.4.10.9.7" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;">32.73</td>
<td id="S5.T3.4.10.9.8" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T3.4.10.9.8.1" class="ltx_text ltx_font_bold">35.07</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Effect of Different Degrees of Model Heterogeneity.</span> We evaluate the performance of FedTSA across varying degrees of model heterogeneity, comparing it with other model-heterogeneous FL baselines. To introduce model heterogeneity, we continue to use the pruning rate and keep the number of clients to 20. We select CIFAR-10 as the dataset and configure the data distribution to be IID. The specific settings for heterogeneity and the corresponding experimental results are detailed in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S5.T4.3.2" class="ltx_text" style="font-size:90%;">Average test accuracy (%) on CIFAR-10 under different degrees of system heterogeneity.</span></figcaption>
<table id="S5.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.4.1.1" class="ltx_tr">
<th id="S5.T4.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Heterogeneity degrees</th>
<th id="S5.T4.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedProto</th>
<th id="S5.T4.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedMD</th>
<th id="S5.T4.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedDF</th>
<th id="S5.T4.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">HeteroFL</th>
<th id="S5.T4.4.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedTSA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.4.2.1" class="ltx_tr">
<th id="S5.T4.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">[1.0]</th>
<td id="S5.T4.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">74.31</td>
<td id="S5.T4.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">85.23</td>
<td id="S5.T4.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">87.62</td>
<td id="S5.T4.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">91.13</td>
<td id="S5.T4.4.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T4.4.2.1.6.1" class="ltx_text ltx_font_bold">91.56</span></td>
</tr>
<tr id="S5.T4.4.3.2" class="ltx_tr">
<th id="S5.T4.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">[0.5, 1.0]</th>
<td id="S5.T4.4.3.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">62.13</td>
<td id="S5.T4.4.3.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">78.11</td>
<td id="S5.T4.4.3.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">82.43</td>
<td id="S5.T4.4.3.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">83.30</td>
<td id="S5.T4.4.3.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T4.4.3.2.6.1" class="ltx_text ltx_font_bold">89.61</span></td>
</tr>
<tr id="S5.T4.4.4.3" class="ltx_tr">
<th id="S5.T4.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">[0.6, 0.8, 1.0]</th>
<td id="S5.T4.4.4.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">59.60</td>
<td id="S5.T4.4.4.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">74.26</td>
<td id="S5.T4.4.4.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">79.01</td>
<td id="S5.T4.4.4.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">82.61</td>
<td id="S5.T4.4.4.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T4.4.4.3.6.1" class="ltx_text ltx_font_bold">89.28</span></td>
</tr>
<tr id="S5.T4.4.5.4" class="ltx_tr">
<th id="S5.T4.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">[0.1, 0.4, 0.7, 1.0]</th>
<td id="S5.T4.4.5.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">50.03</td>
<td id="S5.T4.4.5.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">64.31</td>
<td id="S5.T4.4.5.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">70.55</td>
<td id="S5.T4.4.5.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">68.21</td>
<td id="S5.T4.4.5.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T4.4.5.4.6.1" class="ltx_text ltx_font_bold">82.37</span></td>
</tr>
<tr id="S5.T4.4.6.5" class="ltx_tr">
<th id="S5.T4.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">[0.1, 0.3, 0.5, 0.7, 1.0]</th>
<td id="S5.T4.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">48.87</td>
<td id="S5.T4.4.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">63.16</td>
<td id="S5.T4.4.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">68.83</td>
<td id="S5.T4.4.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">67.79</td>
<td id="S5.T4.4.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T4.4.6.5.6.1" class="ltx_text ltx_font_bold">80.09</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">We can observe that FedTSA outperforms the baseline methods across all five degrees of heterogeneity. This performance illustrates FedTSA’s robust capability in knowledge exchange within heterogeneous model environments. Notably, the accuracy of HeteroFL decreases significantly when the heterogeneity degrees shift from [0.6, 0.8, 1.0] to [0.1, 0.4, 0.7, 1.0]. The decline can be attributed to HeteroFL’s reliance on a partial training mechanism, where only the common parts of heterogeneous models are aggregated. Therefore, if the pruning rate is excessively low, e.g., 0.1, the resulting model becomes overly simplistic, failing to effectively learn data patterns and thus contributing minimally to the global model. In contrast, FedTSA gains contributions from heterogeneous models through DML, where models with larger pruning rates can guide those with smaller ones, just like KD. That is the reason why FedTSA does not suffer from a significant decrease in accuracy. By effectively harnessing the strengths of models across a spectrum of heterogeneity, FedTSA demonstrates superior adaptability and efficiency in learning from diverse model architectures, thereby enhancing overall performance in model-heterogeneous FL scenarios.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Effect of Global Epochs.</span>
Global epochs represent the epochs on generated data during the DML process. As illustrated in Figures <a href="#S5.F3.sf1" title="Figure 3(a) ‣ Figure 3 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> and <a href="#S5.F3.sf2" title="Figure 3(b) ‣ Figure 3 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, the number of global epochs significantly influences model accuracy for both CIFAR-10 and CIFAR-100 datasets. Contrary to intuition, more global epochs reduce training efficacy. This occurs because the DML process relies on diffusion model-generated data instead of real data from various clients. The primary purpose of DML is to facilitate knowledge exchange among heterogeneous models, utilizing synthetic data as a medium for this interaction. However, too many global epochs cause models to lose their unique dataset features due to the continuous blending of average knowledge via KL divergence loss. Therefore, we limit global epochs to a single iteration for optimal DML performance.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.05098/assets/img/globalepoch4acc_cifar10.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">CIFAR-10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.05098/assets/img/globalepoch4acc_cifar100.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="476" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">CIFAR-100</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Test accuracy (%) with different global epochs in the DML process.</span></figcaption>
</figure>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.4" class="ltx_p"><span id="S5.SS2.p5.4.1" class="ltx_text ltx_font_bold">Effect of Loss Function in DML.</span> In the DML process, we evaluate three loss functions: KL-only, CE-only, and their linear combination. The KL-only function uses only KL divergence loss, reflecting the model’s reliance on ensemble knowledge from generated data. In contrast, CE-only involves training on generated data without inter-model knowledge exchange.
The linear combination loss is formulated as follows:</p>
<table id="S5.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E9.m1.3" class="ltx_Math" alttext="L_{i}(w_{i};\mathcal{X},\mathcal{Y})=\alpha L_{kl}+(1-\alpha)L_{ce}," display="block"><semantics id="S5.E9.m1.3a"><mrow id="S5.E9.m1.3.3.1" xref="S5.E9.m1.3.3.1.1.cmml"><mrow id="S5.E9.m1.3.3.1.1" xref="S5.E9.m1.3.3.1.1.cmml"><mrow id="S5.E9.m1.3.3.1.1.1" xref="S5.E9.m1.3.3.1.1.1.cmml"><msub id="S5.E9.m1.3.3.1.1.1.3" xref="S5.E9.m1.3.3.1.1.1.3.cmml"><mi id="S5.E9.m1.3.3.1.1.1.3.2" xref="S5.E9.m1.3.3.1.1.1.3.2.cmml">L</mi><mi id="S5.E9.m1.3.3.1.1.1.3.3" xref="S5.E9.m1.3.3.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S5.E9.m1.3.3.1.1.1.2" xref="S5.E9.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S5.E9.m1.3.3.1.1.1.1.1" xref="S5.E9.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E9.m1.3.3.1.1.1.1.1.2" xref="S5.E9.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S5.E9.m1.3.3.1.1.1.1.1.1" xref="S5.E9.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S5.E9.m1.3.3.1.1.1.1.1.1.2" xref="S5.E9.m1.3.3.1.1.1.1.1.1.2.cmml">w</mi><mi id="S5.E9.m1.3.3.1.1.1.1.1.1.3" xref="S5.E9.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E9.m1.3.3.1.1.1.1.1.3" xref="S5.E9.m1.3.3.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S5.E9.m1.1.1" xref="S5.E9.m1.1.1.cmml">𝒳</mi><mo id="S5.E9.m1.3.3.1.1.1.1.1.4" xref="S5.E9.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S5.E9.m1.2.2" xref="S5.E9.m1.2.2.cmml">𝒴</mi><mo stretchy="false" id="S5.E9.m1.3.3.1.1.1.1.1.5" xref="S5.E9.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E9.m1.3.3.1.1.3" xref="S5.E9.m1.3.3.1.1.3.cmml">=</mo><mrow id="S5.E9.m1.3.3.1.1.2" xref="S5.E9.m1.3.3.1.1.2.cmml"><mrow id="S5.E9.m1.3.3.1.1.2.3" xref="S5.E9.m1.3.3.1.1.2.3.cmml"><mi id="S5.E9.m1.3.3.1.1.2.3.2" xref="S5.E9.m1.3.3.1.1.2.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S5.E9.m1.3.3.1.1.2.3.1" xref="S5.E9.m1.3.3.1.1.2.3.1.cmml">​</mo><msub id="S5.E9.m1.3.3.1.1.2.3.3" xref="S5.E9.m1.3.3.1.1.2.3.3.cmml"><mi id="S5.E9.m1.3.3.1.1.2.3.3.2" xref="S5.E9.m1.3.3.1.1.2.3.3.2.cmml">L</mi><mrow id="S5.E9.m1.3.3.1.1.2.3.3.3" xref="S5.E9.m1.3.3.1.1.2.3.3.3.cmml"><mi id="S5.E9.m1.3.3.1.1.2.3.3.3.2" xref="S5.E9.m1.3.3.1.1.2.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.E9.m1.3.3.1.1.2.3.3.3.1" xref="S5.E9.m1.3.3.1.1.2.3.3.3.1.cmml">​</mo><mi id="S5.E9.m1.3.3.1.1.2.3.3.3.3" xref="S5.E9.m1.3.3.1.1.2.3.3.3.3.cmml">l</mi></mrow></msub></mrow><mo id="S5.E9.m1.3.3.1.1.2.2" xref="S5.E9.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S5.E9.m1.3.3.1.1.2.1" xref="S5.E9.m1.3.3.1.1.2.1.cmml"><mrow id="S5.E9.m1.3.3.1.1.2.1.1.1" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S5.E9.m1.3.3.1.1.2.1.1.1.2" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S5.E9.m1.3.3.1.1.2.1.1.1.1" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.cmml"><mn id="S5.E9.m1.3.3.1.1.2.1.1.1.1.2" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S5.E9.m1.3.3.1.1.2.1.1.1.1.1" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="S5.E9.m1.3.3.1.1.2.1.1.1.1.3" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S5.E9.m1.3.3.1.1.2.1.1.1.3" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.E9.m1.3.3.1.1.2.1.2" xref="S5.E9.m1.3.3.1.1.2.1.2.cmml">​</mo><msub id="S5.E9.m1.3.3.1.1.2.1.3" xref="S5.E9.m1.3.3.1.1.2.1.3.cmml"><mi id="S5.E9.m1.3.3.1.1.2.1.3.2" xref="S5.E9.m1.3.3.1.1.2.1.3.2.cmml">L</mi><mrow id="S5.E9.m1.3.3.1.1.2.1.3.3" xref="S5.E9.m1.3.3.1.1.2.1.3.3.cmml"><mi id="S5.E9.m1.3.3.1.1.2.1.3.3.2" xref="S5.E9.m1.3.3.1.1.2.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E9.m1.3.3.1.1.2.1.3.3.1" xref="S5.E9.m1.3.3.1.1.2.1.3.3.1.cmml">​</mo><mi id="S5.E9.m1.3.3.1.1.2.1.3.3.3" xref="S5.E9.m1.3.3.1.1.2.1.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><mo id="S5.E9.m1.3.3.1.2" xref="S5.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E9.m1.3b"><apply id="S5.E9.m1.3.3.1.1.cmml" xref="S5.E9.m1.3.3.1"><eq id="S5.E9.m1.3.3.1.1.3.cmml" xref="S5.E9.m1.3.3.1.1.3"></eq><apply id="S5.E9.m1.3.3.1.1.1.cmml" xref="S5.E9.m1.3.3.1.1.1"><times id="S5.E9.m1.3.3.1.1.1.2.cmml" xref="S5.E9.m1.3.3.1.1.1.2"></times><apply id="S5.E9.m1.3.3.1.1.1.3.cmml" xref="S5.E9.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S5.E9.m1.3.3.1.1.1.3.1.cmml" xref="S5.E9.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S5.E9.m1.3.3.1.1.1.3.2.cmml" xref="S5.E9.m1.3.3.1.1.1.3.2">𝐿</ci><ci id="S5.E9.m1.3.3.1.1.1.3.3.cmml" xref="S5.E9.m1.3.3.1.1.1.3.3">𝑖</ci></apply><list id="S5.E9.m1.3.3.1.1.1.1.2.cmml" xref="S5.E9.m1.3.3.1.1.1.1.1"><apply id="S5.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.E9.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S5.E9.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S5.E9.m1.3.3.1.1.1.1.1.1.2">𝑤</ci><ci id="S5.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S5.E9.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S5.E9.m1.1.1.cmml" xref="S5.E9.m1.1.1">𝒳</ci><ci id="S5.E9.m1.2.2.cmml" xref="S5.E9.m1.2.2">𝒴</ci></list></apply><apply id="S5.E9.m1.3.3.1.1.2.cmml" xref="S5.E9.m1.3.3.1.1.2"><plus id="S5.E9.m1.3.3.1.1.2.2.cmml" xref="S5.E9.m1.3.3.1.1.2.2"></plus><apply id="S5.E9.m1.3.3.1.1.2.3.cmml" xref="S5.E9.m1.3.3.1.1.2.3"><times id="S5.E9.m1.3.3.1.1.2.3.1.cmml" xref="S5.E9.m1.3.3.1.1.2.3.1"></times><ci id="S5.E9.m1.3.3.1.1.2.3.2.cmml" xref="S5.E9.m1.3.3.1.1.2.3.2">𝛼</ci><apply id="S5.E9.m1.3.3.1.1.2.3.3.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E9.m1.3.3.1.1.2.3.3.1.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3">subscript</csymbol><ci id="S5.E9.m1.3.3.1.1.2.3.3.2.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3.2">𝐿</ci><apply id="S5.E9.m1.3.3.1.1.2.3.3.3.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3.3"><times id="S5.E9.m1.3.3.1.1.2.3.3.3.1.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3.3.1"></times><ci id="S5.E9.m1.3.3.1.1.2.3.3.3.2.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3.3.2">𝑘</ci><ci id="S5.E9.m1.3.3.1.1.2.3.3.3.3.cmml" xref="S5.E9.m1.3.3.1.1.2.3.3.3.3">𝑙</ci></apply></apply></apply><apply id="S5.E9.m1.3.3.1.1.2.1.cmml" xref="S5.E9.m1.3.3.1.1.2.1"><times id="S5.E9.m1.3.3.1.1.2.1.2.cmml" xref="S5.E9.m1.3.3.1.1.2.1.2"></times><apply id="S5.E9.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S5.E9.m1.3.3.1.1.2.1.1.1"><minus id="S5.E9.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S5.E9.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.2">1</cn><ci id="S5.E9.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S5.E9.m1.3.3.1.1.2.1.1.1.1.3">𝛼</ci></apply><apply id="S5.E9.m1.3.3.1.1.2.1.3.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3"><csymbol cd="ambiguous" id="S5.E9.m1.3.3.1.1.2.1.3.1.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3">subscript</csymbol><ci id="S5.E9.m1.3.3.1.1.2.1.3.2.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3.2">𝐿</ci><apply id="S5.E9.m1.3.3.1.1.2.1.3.3.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3.3"><times id="S5.E9.m1.3.3.1.1.2.1.3.3.1.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3.3.1"></times><ci id="S5.E9.m1.3.3.1.1.2.1.3.3.2.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3.3.2">𝑐</ci><ci id="S5.E9.m1.3.3.1.1.2.1.3.3.3.cmml" xref="S5.E9.m1.3.3.1.1.2.1.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E9.m1.3c">L_{i}(w_{i};\mathcal{X},\mathcal{Y})=\alpha L_{kl}+(1-\alpha)L_{ce},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S5.SS2.p5.3" class="ltx_p">where <math id="S5.SS2.p5.1.m1.1" class="ltx_Math" alttext="L_{kl}" display="inline"><semantics id="S5.SS2.p5.1.m1.1a"><msub id="S5.SS2.p5.1.m1.1.1" xref="S5.SS2.p5.1.m1.1.1.cmml"><mi id="S5.SS2.p5.1.m1.1.1.2" xref="S5.SS2.p5.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS2.p5.1.m1.1.1.3" xref="S5.SS2.p5.1.m1.1.1.3.cmml"><mi id="S5.SS2.p5.1.m1.1.1.3.2" xref="S5.SS2.p5.1.m1.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p5.1.m1.1.1.3.1" xref="S5.SS2.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p5.1.m1.1.1.3.3" xref="S5.SS2.p5.1.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.1b"><apply id="S5.SS2.p5.1.m1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p5.1.m1.1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p5.1.m1.1.1.2.cmml" xref="S5.SS2.p5.1.m1.1.1.2">𝐿</ci><apply id="S5.SS2.p5.1.m1.1.1.3.cmml" xref="S5.SS2.p5.1.m1.1.1.3"><times id="S5.SS2.p5.1.m1.1.1.3.1.cmml" xref="S5.SS2.p5.1.m1.1.1.3.1"></times><ci id="S5.SS2.p5.1.m1.1.1.3.2.cmml" xref="S5.SS2.p5.1.m1.1.1.3.2">𝑘</ci><ci id="S5.SS2.p5.1.m1.1.1.3.3.cmml" xref="S5.SS2.p5.1.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.1c">L_{kl}</annotation></semantics></math> is KL divergence loss, <math id="S5.SS2.p5.2.m2.1" class="ltx_Math" alttext="L_{ce}" display="inline"><semantics id="S5.SS2.p5.2.m2.1a"><msub id="S5.SS2.p5.2.m2.1.1" xref="S5.SS2.p5.2.m2.1.1.cmml"><mi id="S5.SS2.p5.2.m2.1.1.2" xref="S5.SS2.p5.2.m2.1.1.2.cmml">L</mi><mrow id="S5.SS2.p5.2.m2.1.1.3" xref="S5.SS2.p5.2.m2.1.1.3.cmml"><mi id="S5.SS2.p5.2.m2.1.1.3.2" xref="S5.SS2.p5.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p5.2.m2.1.1.3.1" xref="S5.SS2.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p5.2.m2.1.1.3.3" xref="S5.SS2.p5.2.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.2.m2.1b"><apply id="S5.SS2.p5.2.m2.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p5.2.m2.1.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p5.2.m2.1.1.2.cmml" xref="S5.SS2.p5.2.m2.1.1.2">𝐿</ci><apply id="S5.SS2.p5.2.m2.1.1.3.cmml" xref="S5.SS2.p5.2.m2.1.1.3"><times id="S5.SS2.p5.2.m2.1.1.3.1.cmml" xref="S5.SS2.p5.2.m2.1.1.3.1"></times><ci id="S5.SS2.p5.2.m2.1.1.3.2.cmml" xref="S5.SS2.p5.2.m2.1.1.3.2">𝑐</ci><ci id="S5.SS2.p5.2.m2.1.1.3.3.cmml" xref="S5.SS2.p5.2.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.2.m2.1c">L_{ce}</annotation></semantics></math> is cross-entropy (CE) loss, and <math id="S5.SS2.p5.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p5.3.m3.1a"><mi id="S5.SS2.p5.3.m3.1.1" xref="S5.SS2.p5.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.3.m3.1b"><ci id="S5.SS2.p5.3.m3.1.1.cmml" xref="S5.SS2.p5.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.3.m3.1c">\alpha</annotation></semantics></math> is a weighting factor. Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the accuracy differences among these approaches. KL-only converges fastest initially but ultimately underperforms KL+CE in accuracy. While KL+CE is slower and less stable initially, it achieves the highest final accuracy. When the weight of KL divergence loss decreases, for instance, from 1.0 to 0.8, as the figure shows, the performance lies between the KL-only and KL+CE with equal weights. This suggests that combining KL and CE losses enhances global aggregation, but the slight accuracy gain from adding CE loss may not justify the extra computational cost.</p>
</div>
<div id="S5.SS2.p6" class="ltx_para">
<p id="S5.SS2.p6.1" class="ltx_p"><span id="S5.SS2.p6.1.1" class="ltx_text ltx_font_bold">Effect of the Number of Synthetic Images.</span> We explore how different quantities of synthetic images from the diffusion model affect model performance. As shown in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, optimal accuracy is achieved with 200 images for both CIFAR-10 and CIFAR-100 datasets. Beyond this number, additional images do not significantly enhance performance. Conversely, fewer than 150 images lead to reduced efficacy. This highlights the need for a balanced amount of synthetic data in DML: too little limits knowledge quality, while too much is not resource-efficient.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:195.1pt;"><img src="/html/2407.05098/assets/img/loss_selection.png" id="S5.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="461" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.1.1.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F5.1.2.2" class="ltx_text" style="font-size:90%;">Test accuracy (%) on CIFAR-10 among different loss functions in the DML process.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:195.1pt;"><img src="/html/2407.05098/assets/img/synthetic_num.png" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="447" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.2.1.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.2.2.2" class="ltx_text" style="font-size:90%;">Test accuracy (%) among different numbers of synthetic images.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div id="S5.SS2.p7" class="ltx_para">
<p id="S5.SS2.p7.6" class="ltx_p"><span id="S5.SS2.p7.6.1" class="ltx_text ltx_font_bold">Effect of Temperature.</span> The temperature <math id="S5.SS2.p7.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p7.1.m1.1a"><mi id="S5.SS2.p7.1.m1.1.1" xref="S5.SS2.p7.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.1.m1.1b"><ci id="S5.SS2.p7.1.m1.1.1.cmml" xref="S5.SS2.p7.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.1.m1.1c">T</annotation></semantics></math> is a hyperparameter in the softmax function to control the sharpness of the predicted probabilities, as Eq. <a href="#S4.E6" title="Equation 6 ‣ 4.4 DML with Diffusion Model ‣ 4 Methodology ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> indicates. Higher <math id="S5.SS2.p7.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p7.2.m2.1a"><mi id="S5.SS2.p7.2.m2.1.1" xref="S5.SS2.p7.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.2.m2.1b"><ci id="S5.SS2.p7.2.m2.1.1.cmml" xref="S5.SS2.p7.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.2.m2.1c">T</annotation></semantics></math> values create a uniform distribution, while lower values lead to a peaked one. Properly tuning <math id="S5.SS2.p7.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p7.3.m3.1a"><mi id="S5.SS2.p7.3.m3.1.1" xref="S5.SS2.p7.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.3.m3.1b"><ci id="S5.SS2.p7.3.m3.1.1.cmml" xref="S5.SS2.p7.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.3.m3.1c">T</annotation></semantics></math> enhances knowledge exchange in DML, as depicted in Table <a href="#S5.T6" title="Table 6 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Optimal performance is achieved at <math id="S5.SS2.p7.4.m4.1" class="ltx_Math" alttext="T=5" display="inline"><semantics id="S5.SS2.p7.4.m4.1a"><mrow id="S5.SS2.p7.4.m4.1.1" xref="S5.SS2.p7.4.m4.1.1.cmml"><mi id="S5.SS2.p7.4.m4.1.1.2" xref="S5.SS2.p7.4.m4.1.1.2.cmml">T</mi><mo id="S5.SS2.p7.4.m4.1.1.1" xref="S5.SS2.p7.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.p7.4.m4.1.1.3" xref="S5.SS2.p7.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.4.m4.1b"><apply id="S5.SS2.p7.4.m4.1.1.cmml" xref="S5.SS2.p7.4.m4.1.1"><eq id="S5.SS2.p7.4.m4.1.1.1.cmml" xref="S5.SS2.p7.4.m4.1.1.1"></eq><ci id="S5.SS2.p7.4.m4.1.1.2.cmml" xref="S5.SS2.p7.4.m4.1.1.2">𝑇</ci><cn type="integer" id="S5.SS2.p7.4.m4.1.1.3.cmml" xref="S5.SS2.p7.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.4.m4.1c">T=5</annotation></semantics></math> for both IID and non-IID settings, with accuracy declining at higher <math id="S5.SS2.p7.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p7.5.m5.1a"><mi id="S5.SS2.p7.5.m5.1.1" xref="S5.SS2.p7.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.5.m5.1b"><ci id="S5.SS2.p7.5.m5.1.1.cmml" xref="S5.SS2.p7.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.5.m5.1c">T</annotation></semantics></math> values. Notably, the decline in performance exhibits a more gradual trend in non-IID scenarios compared to IID. This can be explained by the smoothing effect of a higher <math id="S5.SS2.p7.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p7.6.m6.1a"><mi id="S5.SS2.p7.6.m6.1.1" xref="S5.SS2.p7.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.6.m6.1b"><ci id="S5.SS2.p7.6.m6.1.1.cmml" xref="S5.SS2.p7.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.6.m6.1c">T</annotation></semantics></math> on the logits output: even if the model lacks confidence for certain classes due to an imbalanced data distribution, the student model still benefits from the teacher’s guidance. Furthermore, the smoothed logits help to prevent the student model from overfitting to classes that have more training data.</p>
</div>
<div id="S5.SS2.p8" class="ltx_para">
<p id="S5.SS2.p8.1" class="ltx_p"><span id="S5.SS2.p8.1.1" class="ltx_text ltx_font_bold">Effect of Prompts.</span> We verify the impact of different prompts on the model performance and test a range of prompts from simple to descriptive, as detailed in Table <a href="#S5.T6" title="Table 6 ‣ 5.2 Performance Evaluation and Analysis ‣ 5 Evaluation ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Taking ’bird’ as an example, we observe that prompt quality significantly impacts performance. A single-word prompt results in 81.31%, while more descriptive prompts improve the accuracy. We explore the reason behind it by examining the generated data and find that simple prompts like a single word can produce abstract images, such as hand-drawn or stitching-style images. Since the model is trained with real-world photos, it cannot generate high-quality logits on these images, leading to degraded Stage 2 aggregation and thus impacting the model performance. We also notice that the model accuracy is nearly identical when using the last two prompts, which shows that FedTSA does not require detailed information about the original dataset, offering better privacy than constructing public datasets by studying raw data.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.T6.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:173.4pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.T6.fig1.1.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S5.T6.fig1.2.2" class="ltx_text" style="font-size:90%;">Test accuracy (%) on CIFAR-10 among different temperatures (T) in the DML process.</span></figcaption>
<table id="S5.T6.fig1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.fig1.3.1.1" class="ltx_tr">
<th id="S5.T6.fig1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">T</th>
<th id="S5.T6.fig1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">IID</th>
<th id="S5.T6.fig1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.6)</th>
<th id="S5.T6.fig1.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Dir(0.3)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.fig1.3.2.1" class="ltx_tr">
<th id="S5.T6.fig1.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1</th>
<td id="S5.T6.fig1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">88.59</td>
<td id="S5.T6.fig1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">87.58</td>
<td id="S5.T6.fig1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">86.96</td>
</tr>
<tr id="S5.T6.fig1.3.3.2" class="ltx_tr">
<th id="S5.T6.fig1.3.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">5</th>
<td id="S5.T6.fig1.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.fig1.3.3.2.2.1" class="ltx_text ltx_font_bold">89.28</span></td>
<td id="S5.T6.fig1.3.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.fig1.3.3.2.3.1" class="ltx_text ltx_font_bold">87.80</span></td>
<td id="S5.T6.fig1.3.3.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.fig1.3.3.2.4.1" class="ltx_text ltx_font_bold">87.10</span></td>
</tr>
<tr id="S5.T6.fig1.3.4.3" class="ltx_tr">
<th id="S5.T6.fig1.3.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10</th>
<td id="S5.T6.fig1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">88.97</td>
<td id="S5.T6.fig1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">87.57</td>
<td id="S5.T6.fig1.3.4.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">86.84</td>
</tr>
<tr id="S5.T6.fig1.3.5.4" class="ltx_tr">
<th id="S5.T6.fig1.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">20</th>
<td id="S5.T6.fig1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">87.30</td>
<td id="S5.T6.fig1.3.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">86.43</td>
<td id="S5.T6.fig1.3.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">86.12</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.T6.4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:260.2pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.T6.4.5.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S5.T6.4.6.2" class="ltx_text" style="font-size:90%;">Test accuracy (%) with different prompts.</span></figcaption>
<table id="S5.T6.4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.4.4.5.1" class="ltx_tr">
<th id="S5.T6.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Prompt</th>
<th id="S5.T6.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Image</th>
<th id="S5.T6.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.1.1.1" class="ltx_tr">
<td id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">“bird"</td>
<td id="S5.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.1.1.1.1.1" class="ltx_text">
<span id="S5.T6.1.1.1.1.1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_align_bottom">
<span id="S5.T6.1.1.1.1.1.m1.1.1.1.1" class="ltx_p">
<span id="S5.T6.1.1.1.1.1.m1.1.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.2pt;height:20.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T6.1.1.1.1.1.m1.1.1.1.1.1.1" class="ltx_p"><span id="S5.T6.1.1.1.1.1.m1.1.1.1.1.1.1.1" class="ltx_text"><img src="/html/2407.05098/assets/img/bird_.png" id="S5.T6.1.1.1.1.1.m1.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="28" height="28" alt="Refer to caption"></span></span>
</span></span></span>
</span></span></td>
<td id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">81.31</td>
</tr>
<tr id="S5.T6.2.2.2" class="ltx_tr">
<td id="S5.T6.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">“a real bird"</td>
<td id="S5.T6.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.2.2.2.1.1" class="ltx_text">
<span id="S5.T6.2.2.2.1.1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_align_bottom">
<span id="S5.T6.2.2.2.1.1.m1.1.1.1.1" class="ltx_p">
<span id="S5.T6.2.2.2.1.1.m1.1.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.2pt;height:20.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T6.2.2.2.1.1.m1.1.1.1.1.1.1" class="ltx_p"><span id="S5.T6.2.2.2.1.1.m1.1.1.1.1.1.1.1" class="ltx_text"><img src="/html/2407.05098/assets/img/arealbird_.png" id="S5.T6.2.2.2.1.1.m1.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="28" height="28" alt="Refer to caption"></span></span>
</span></span></span>
</span></span></td>
<td id="S5.T6.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">85.73</td>
</tr>
<tr id="S5.T6.3.3.3" class="ltx_tr">
<td id="S5.T6.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">“a photo of real bird"</td>
<td id="S5.T6.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.3.3.3.1.1" class="ltx_text">
<span id="S5.T6.3.3.3.1.1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_align_bottom">
<span id="S5.T6.3.3.3.1.1.m1.1.1.1.1" class="ltx_p">
<span id="S5.T6.3.3.3.1.1.m1.1.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.2pt;height:20.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T6.3.3.3.1.1.m1.1.1.1.1.1.1" class="ltx_p"><span id="S5.T6.3.3.3.1.1.m1.1.1.1.1.1.1.1" class="ltx_text"><img src="/html/2407.05098/assets/img/aphotoofrealbird.png" id="S5.T6.3.3.3.1.1.m1.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="28" height="28" alt="Refer to caption"></span></span>
</span></span></span>
</span></span></td>
<td id="S5.T6.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.3.3.3.3.1" class="ltx_text ltx_font_bold">89.28</span></td>
</tr>
<tr id="S5.T6.4.4.4" class="ltx_tr">
<td id="S5.T6.4.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">“a photo of real bird in CIFAR-10 style"</td>
<td id="S5.T6.4.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;"><span id="S5.T6.4.4.4.1.1" class="ltx_text">
<span id="S5.T6.4.4.4.1.1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_align_bottom">
<span id="S5.T6.4.4.4.1.1.m1.1.1.1.1" class="ltx_p">
<span id="S5.T6.4.4.4.1.1.m1.1.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:20.2pt;height:20.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.T6.4.4.4.1.1.m1.1.1.1.1.1.1" class="ltx_p"><span id="S5.T6.4.4.4.1.1.m1.1.1.1.1.1.1.1" class="ltx_text"><img src="/html/2407.05098/assets/img/aphotoofrealbirdinCIFAR10style.png" id="S5.T6.4.4.4.1.1.m1.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="28" height="28" alt="Refer to caption"></span></span>
</span></span></span>
</span></span></td>
<td id="S5.T6.4.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">89.26</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This paper contributes FedTSA, a novel cluster-based two-stage aggregation method for model-heterogeneous FL. FedTSA first conducts clustering to generate heterogeneous cluster-based models, then leverages DML on the server side to aggregate these models based on the data generated by a diffusion model. This approach allows each client to train a model that aligns with its available resources, thereby avoiding straggler issues and enhancing overall efficiency. Experimental results on CV datasets show that FedTSA surpasses baselines in both IID and non-IID settings. Further experiments analyze the impact of various influential factors on model training, providing a deeper understanding of their effects.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Despite the excellent performance of FedTSA, some trade-offs exist. First, the diffusion model introduces additional computational overhead to generate image data. However, it offers better flexibility in switching training tasks by simply adjusting the prompts compared to fixed public datasets. We will explore methods for achieving model-heterogeneous FL without relying on external data. Second, like other existing model-heterogeneous FL methods, FedTSA has only been verified on CV tasks. Adapting and experimenting with FedTSA on natural language processing and multimodal tasks is a primary focus for future work.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Alam, S., Liu, L., Yan, M., Zhang, M.: Fedrolex: Model-heterogeneous federated learning with rolling sub-model extraction. In: Adv. Neural Inform. Process. Syst. (2022), <a target="_blank" href="https://openreview.net/forum?id=OtxyysUdBE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=OtxyysUdBE</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Blalock, D., Gonzalez Ortiz, J.J., Frankle, J., Guttag, J.: What is the state of neural network pruning? In: Dhillon, I., Papailiopoulos, D., Sze, V. (eds.) Proceedings of Machine Learning and Systems. vol. 2, pp. 129–146 (2020), <a target="_blank" href="https://proceedings.mlsys.org/paper_files/paper/2020/file/6c44dc73014d66ba49b28d483a8f8b0d-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/paper_files/paper/2020/file/6c44dc73014d66ba49b28d483a8f8b0d-Paper.pdf</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Bonawitz, K., Eichner, H., Grieskamp, W., Huba, D., Ingerman, A., Ivanov, V., Kiddon, C., Konečný, J., Mazzocchi, S., McMahan, B., Van Overveldt, T., Petrou, D., Ramage, D., Roselander, J.: Towards federated learning at scale: System design. In: Talwalkar, A., Smith, V., Zaharia, M. (eds.) Proceedings of Machine Learning and Systems. vol. 1, pp. 374–388 (2019), <a target="_blank" href="https://proceedings.mlsys.org/paper_files/paper/2019/file/7b770da633baf74895be22a8807f1a8f-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/paper_files/paper/2019/file/7b770da633baf74895be22a8807f1a8f-Paper.pdf</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Caldarola, D., Mancini, M., Galasso, F., Ciccone, M., Rodola, E., Caputo, B.: Cluster-driven graph federated learning over multiple domains. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops. pp. 2749–2758 (June 2021)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chang, H., Shejwalkar, V., Shokri, R., Houmansadr, A.: Cronus: Robust and heterogeneous collaborative learning with black-box knowledge transfer. arXiv preprint arXiv:1912.11279 (2019)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chen, Y., Ning, Y., Slawski, M., Rangwala, H.: Asynchronous online federated learning for edge devices with non-iid data. In: 2020 IEEE International Conference on Big Data (Big Data). pp. 15–24. IEEE (2020)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chrabaszcz, P., Loshchilov, I., Hutter, F.: A downsampled variant of imagenet as an alternative to the cifar datasets. arXiv preprint arXiv:1707.08819 (2017)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Croitoru, F.A., Hondru, V., Ionescu, R.T., Shah, M.: Diffusion models in vision: A survey. IEEE Trans. Pattern Anal. Mach. Intell. <span id="bib.bib8.1.1" class="ltx_text ltx_font_bold">45</span>(9), 10850–10869 (2023). https://doi.org/10.1109/TPAMI.2023.3261988

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Dhariwal, P., Nichol, A.: Diffusion models beat gans on image synthesis. In: Ranzato, M., Beygelzimer, A., Dauphin, Y., Liang, P., Vaughan, J.W. (eds.) Adv. Neural Inform. Process. Syst. vol. 34, pp. 8780–8794. Curran Associates, Inc. (2021), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2021/file/49ad23d1ec9fa4bd8d77d02681df5cfa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2021/file/49ad23d1ec9fa4bd8d77d02681df5cfa-Paper.pdf</a>

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Diao, E., Ding, J., Tarokh, V.: Heterofl: Computation and communication efficient federated learning for heterogeneous clients. In: Int. Conf. Learn. Represent. (2020)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Fan, B., Jiang, S., Su, X., Hui, P.: Model-heterogeneous federated learning for internet of things: Enabling technologies and future directions (2023), <a target="_blank" href="https://arxiv.org/abs/2312.12091" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2312.12091</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Fan, B., Su, X., Tarkoma, S., Hui, P.: Behave differently when clustering: A semi-asynchronous federated learning approach for iot. ACM Trans. Sen. Netw. <span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">20</span>(3) (feb 2024). https://doi.org/10.1145/3639825, <a target="_blank" href="https://doi.org/10.1145/3639825" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3639825</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Gong, X., Sharma, A., Karanam, S., Wu, Z., Chen, T., Doermann, D., Innanje, A.: Preserving privacy in federated learning with ensemble cross-domain knowledge distillation. AAAI <span id="bib.bib13.1.1" class="ltx_text ltx_font_bold">36</span>(11), 11891–11899 (Jun 2022). https://doi.org/10.1609/aaai.v36i11.21446, <a target="_blank" href="https://ojs.aaai.org/index.php/AAAI/article/view/21446" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ojs.aaai.org/index.php/AAAI/article/view/21446</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., Courville, A., Bengio, Y.: Generative adversarial nets. In: Ghahramani, Z., Welling, M., Cortes, C., Lawrence, N., Weinberger, K. (eds.) Adv. Neural Inform. Process. Syst. vol. 27. Curran Associates, Inc. (2014), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2014/file/5ca3e9b122f61f8f06494c97b1afccf3-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2014/file/5ca3e9b122f61f8f06494c97b1afccf3-Paper.pdf</a>

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. In: IEEE Conf. Comput. Vis. Pattern Recog. (June 2016)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Hinton, G., Vinyals, O., Dean, J.: Distilling the knowledge in a neural network (2015), <a target="_blank" href="https://arxiv.org/abs/1503.02531" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1503.02531</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ho, J., Jain, A., Abbeel, P.: Denoising diffusion probabilistic models. In: Larochelle, H., Ranzato, M., Hadsell, R., Balcan, M., Lin, H. (eds.) Advances in Neural Information Processing Systems. vol. 33, pp. 6840–6851. Curran Associates, Inc. (2020), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/4c5bcfec8584af0d967f1ab10179ca4b-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2020/file/4c5bcfec8584af0d967f1ab10179ca4b-Paper.pdf</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Ilhan, F., Su, G., Liu, L.: Scalefl: Resource-adaptive federated learning with heterogeneous clients. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 24532–24541 (June 2023)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Imteaj, A., Thakker, U., Wang, S., Li, J., Amini, M.H.: A survey on federated learning for resource-constrained iot devices. IEEE Internet of Things Journal <span id="bib.bib19.1.1" class="ltx_text ltx_font_bold">9</span>(1), 1–24 (2022). https://doi.org/10.1109/JIOT.2021.3095077

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Jeong, E., Oh, S., Kim, H., Park, J., Bennis, M., Kim, S.L.: Communication-efficient on-device machine learning: Federated distillation and augmentation under non-iid private data (2023), <a target="_blank" href="https://arxiv.org/abs/1811.11479" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1811.11479</a>

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kim, J., Scott, C.D.: Robust kernel density estimation. J. Mach. Learn. Res. <span id="bib.bib21.1.1" class="ltx_text ltx_font_bold">13</span>(1), 2529–2565 (2012)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G.: Learning multiple layers of features from tiny images. Tech. rep., University of Toronto (2009), <a target="_blank" href="https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf</a>

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
LattePanda: Lattepanda alpha 864s specs (2023), <a target="_blank" href="https://www.lattepanda.com/lattepanda-alpha" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.lattepanda.com/lattepanda-alpha</a>, accessed: 2023-10-05

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Li, D., Wang, J.: Fedmd: Heterogenous federated learning via model distillation. arXiv preprint arXiv:1910.03581 (2019)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Li, J., Sharma, N.K., Ports, D.R., Gribble, S.D.: Tales of the tail: Hardware, os, and application-level sources of tail latency. In: Proceedings of the ACM Symposium on Cloud Computing. pp. 1–14 (2014)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Li, Q., Diao, Y., Chen, Q., He, B.: Federated learning on non-iid data silos: An experimental study. In: 2022 IEEE 38th International Conference on Data Engineering (ICDE). pp. 965–978. IEEE (2022)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Li, Q., Wen, Z., Wu, Z., Hu, S., Wang, N., Li, Y., Liu, X., He, B.: A survey on federated learning systems: Vision, hype and reality for data privacy and protection. IEEE Transactions on Knowledge and Data Engineering (2021)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.: Federated optimization in heterogeneous networks. In: Dhillon, I., Papailiopoulos, D., Sze, V. (eds.) Proceedings of Machine Learning and Systems. vol. 2, pp. 429–450 (2020), <a target="_blank" href="https://proceedings.mlsys.org/paper_files/paper/2020/file/1f5fe83998a09396ebe6477d9475ba0c-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/paper_files/paper/2020/file/1f5fe83998a09396ebe6477d9475ba0c-Paper.pdf</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Liao, D., Gao, X., Zhao, Y., Xu, C.Z.: Adaptive channel sparsity for federated learning under system heterogeneity. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 20432–20441 (June 2023)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Lim, W.Y.B., Luong, N.C., Hoang, D.T., Jiao, Y., Liang, Y.C., Yang, Q., Niyato, D., Miao, C.: Federated learning in mobile edge networks: A comprehensive survey. IEEE Communications Surveys &amp; Tutorials <span id="bib.bib30.1.1" class="ltx_text ltx_font_bold">22</span>(3), 2031–2063 (2020). https://doi.org/10.1109/COMST.2020.2986024

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Lin, T., Kong, L., Stich, S.U., Jaggi, M.: Ensemble distillation for robust model fusion in federated learning. In: Larochelle, H., Ranzato, M., Hadsell, R., Balcan, M., Lin, H. (eds.) Adv. Neural Inform. Process. Syst. vol. 33, pp. 2351–2363. Curran Associates, Inc. (2020), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/18df51b97ccd68128e994804f3eccc87-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2020/file/18df51b97ccd68128e994804f3eccc87-Paper.pdf</a>

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., y Arcas, B.A.: Communication-efficient learning of deep networks from decentralized data. In: Artificial intelligence and statistics. pp. 1273–1282. PMLR (2017)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Ouyang, X., Xie, Z., Zhou, J., Huang, J., Xing, G.: Clusterfl: a similarity-aware federated learning system for human activity recognition. In: Proceedings of the 19th Annual International Conference on Mobile Systems, Applications, and Services. p. 54–66. MobiSys ’21, Association for Computing Machinery, New York, NY, USA (2021). https://doi.org/10.1145/3458864.3467681, <a target="_blank" href="https://doi.org/10.1145/3458864.3467681" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3458864.3467681</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Park, J., Han, D.J., Choi, M., Moon, J.: Sageflow: Robust federated learning against both stragglers and adversaries. In: Ranzato, M., Beygelzimer, A., Dauphin, Y., Liang, P., Vaughan, J.W. (eds.) Adv. Neural Inform. Process. Syst. vol. 34, pp. 840–851. Curran Associates, Inc. (2021), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2021/file/076a8133735eb5d7552dc195b125a454-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2021/file/076a8133735eb5d7552dc195b125a454-Paper.pdf</a>

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Phuong, M., Lampert, C.: Towards understanding knowledge distillation. In: Chaudhuri, K., Salakhutdinov, R. (eds.) Int. Conf. Mach. Learn. Proceedings of Machine Learning Research, vol. 97, pp. 5142–5151. PMLR (09–15 Jun 2019), <a target="_blank" href="https://proceedings.mlr.press/v97/phuong19a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v97/phuong19a.html</a>

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Qiao, T., Zhang, J., Xu, D., Tao, D.: Mirrorgan: Learning text-to-image generation by redescription. In: IEEE Conf. Comput. Vis. Pattern Recog. (June 2019)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Ramesh, A., Dhariwal, P., Nichol, A., Chu, C., Chen, M.: Hierarchical text-conditional image generation with clip latents. arXiv preprint arXiv:2204.06125 (2022)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Rombach, R., Blattmann, A., Lorenz, D., Esser, P., Ommer, B.: High-resolution image synthesis with latent diffusion models. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 10684–10695 (June 2022)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P., Brox, T.: U-net: Convolutional networks for biomedical image segmentation. In: Navab, N., Hornegger, J., Wells, W.M., Frangi, A.F. (eds.) Medical Image Computing and Computer-Assisted Intervention – MICCAI 2015. Lecture Notes in Computer Science, vol. 9351, pp. 234–241. Springer International Publishing (2015). https://doi.org/10.1007/978-3-319-24574-4_28

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Ruiz, N., Li, Y., Jampani, V., Pritch, Y., Rubinstein, M., Aberman, K.: Dreambooth: Fine tuning text-to-image diffusion models for subject-driven generation. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 22500–22510 (June 2023)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Snell, J., Swersky, K., Zemel, R.: Prototypical networks for few-shot learning. In: Guyon, I., Luxburg, U.V., Bengio, S., Wallach, H., Fergus, R., Vishwanathan, S., Garnett, R. (eds.) Adv. Neural Inform. Process. Syst. vol. 30. Curran Associates, Inc. (2017), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/cb8da6767461f2812ae4290eac7cbc42-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/cb8da6767461f2812ae4290eac7cbc42-Paper.pdf</a>

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Sun, L., Qian, J., Chen, X.: Ldp-fl: Practical private aggregation in federated learning with local differential privacy. arXiv preprint arXiv:2007.15789 (2020)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Tan, C.M.J., Motani, M.: DropNet: Reducing neural network complexity via iterative pruning. In: III, H.D., Singh, A. (eds.) Int. Conf. Mach. Learn. Proceedings of Machine Learning Research, vol. 119, pp. 9356–9366. PMLR (13–18 Jul 2020), <a target="_blank" href="https://proceedings.mlr.press/v119/tan20a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v119/tan20a.html</a>

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Tan, Y., Long, G., LIU, L., Zhou, T., Lu, Q., Jiang, J., Zhang, C.: Fedproto: Federated prototype learning across heterogeneous clients. AAAI <span id="bib.bib44.1.1" class="ltx_text ltx_font_bold">36</span>(8), 8432–8440 (Jun 2022). https://doi.org/10.1609/aaai.v36i8.20819, <a target="_blank" href="https://ojs.aaai.org/index.php/AAAI/article/view/20819" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ojs.aaai.org/index.php/AAAI/article/view/20819</a>

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Tun, Y.L., Thwal, C.M., Yoon, J.S., Kang, S.M., Zhang, C., Hong, C.S.: Federated learning with diffusion models for privacy-sensitive vision tasks. In: 2023 International Conference on Advanced Technologies for Communications (ATC). pp. 305–310 (2023). https://doi.org/10.1109/ATC58710.2023.10318858

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Wang, J., Liu, Q., Liang, H., Joshi, G., Poor, H.V.: Tackling the objective inconsistency problem in heterogeneous federated optimization. In: Larochelle, H., Ranzato, M., Hadsell, R., Balcan, M., Lin, H. (eds.) Adv. Neural Inform. Process. Syst. vol. 33, pp. 7611–7623. Curran Associates, Inc. (2020), <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/564127c03caab942e503ee6f810f54fd-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2020/file/564127c03caab942e503ee6f810f54fd-Paper.pdf</a>

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Wang, Z., Li, C., Wang, X.: Convolutional neural network pruning with structural redundancy reduction. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 14913–14922 (June 2021)

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Wu, C., Li, Z., Wang, F., Wu, C.: Learning cautiously in federated learning with noisy and heterogeneous clients. In: 2023 IEEE International Conference on Multimedia and Expo (ICME). pp. 660–665 (2023). https://doi.org/10.1109/ICME55011.2023.00119

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Wu, C., Zhu, Y., Zhang, R., Chen, Y., Wang, F., Cui, S.: Fedab: Truthful federated learning with auction-based combinatorial multi-armed bandit. IEEE Internet of Things Journal <span id="bib.bib49.1.1" class="ltx_text ltx_font_bold">10</span>(17), 15159–15170 (2023). https://doi.org/10.1109/JIOT.2023.3264677

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Wu, W., He, L., Lin, W., Mao, R., Maple, C., Jarvis, S.: Safa: A semi-asynchronous protocol for fast federated learning with low overhead. IEEE Transactions on Computers <span id="bib.bib50.1.1" class="ltx_text ltx_font_bold">70</span>(5), 655–668 (2021). https://doi.org/10.1109/TC.2020.2994391

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Yang, M., Su, S., Li, B., Xue, X.: Exploring one-shot semi-supervised federated learning with a pre-trained diffusion model. arXiv preprint arXiv:2305.04063 (2023)

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Ye, M., Fang, X., Du, B., Yuen, P.C., Tao, D.: Heterogeneous federated learning: State-of-the-art and research challenges. ACM Comput. Surv. <span id="bib.bib52.1.1" class="ltx_text ltx_font_bold">56</span>(3) (oct 2023). https://doi.org/10.1145/3625558, <a target="_blank" href="https://doi.org/10.1145/3625558" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3625558</a>

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Zhang, R., Chen, Y., Wu, C., Wang, F.: Multi-level personalized federated learning on heterogeneous and long-tailed data. IEEE Transactions on Mobile Computing pp. 1–14 (2024). https://doi.org/10.1109/TMC.2024.3409159

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhang, R., Chen, Y., Wu, C., Wang, F., Liu, J.: Optimizing efficient personalized federated learning with hypernetworks at edge. IEEE Network <span id="bib.bib54.1.1" class="ltx_text ltx_font_bold">37</span>(4), 120–126 (2023). https://doi.org/10.1109/MNET.008.2200654

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Zhang, T., Gao, L., Lee, S., Zhang, M., Avestimehr, S.: Timelyfl: Heterogeneity-aware asynchronous federated learning with adaptive partial training. In: IEEE Conf. Comput. Vis. Pattern Recog. pp. 5064–5073 (June 2023)

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Zhang, Y., Xiang, T., Hospedales, T.M., Lu, H.: Deep mutual learning. In: IEEE Conf. Comput. Vis. Pattern Recog. (June 2018)

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Zhao, Z., Yang, F., Liang, G.: Federated learning based on diffusion model to cope with non-iid data. In: Chinese Conference on Pattern Recognition and Computer Vision (PRCV). pp. 220–231. Springer (2023)

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Zhu, Z., Hong, J., Zhou, J.: Data-free knowledge distillation for heterogeneous federated learning. In: Meila, M., Zhang, T. (eds.) Int. Conf. Mach. Learn. Proceedings of Machine Learning Research, vol. 139, pp. 12878–12889. PMLR (18–24 Jul 2021), <a target="_blank" href="https://proceedings.mlr.press/v139/zhu21b.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/zhu21b.html</a>

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Pt0.A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>More Implementation Details</h2>

<section id="Pt0.A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.1 </span>Environment</h3>

<div id="Pt0.A1.SS1.p1" class="ltx_para">
<p id="Pt0.A1.SS1.p1.1" class="ltx_p">We conduct experiments under Python 3.8.0 and PyTorch 1.31.1. We use a NVIDIA A100 provided by RunPod<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.runpod.io/</span></span></span> for computation. Weights&amp;Biases<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://wandb.ai/site</span></span></span> is leveraged to track and log the experimental results. Regarding the diffusion model, we choose the Stable Diffusion model v1-4 from Hugging Face<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://huggingface.co/CompVis/stable-diffusion-v1-4</span></span></span>.</p>
</div>
</section>
<section id="Pt0.A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.2 </span>Datasets</h3>

<div id="Pt0.A1.SS2.p1" class="ltx_para">
<p id="Pt0.A1.SS2.p1.1" class="ltx_p"><span id="Pt0.A1.SS2.p1.1.1" class="ltx_text ltx_font_bold">CIFAR-10 and CIFAR-100.</span> CIFAR-10 and CIFAR-100 are benchmark datasets in the field of Computer Vision (CV), which are also popular for evaluating FL methods. CIFAR-10 consists of 60,000 32<math id="Pt0.A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Pt0.A1.SS2.p1.1.m1.1a"><mo id="Pt0.A1.SS2.p1.1.m1.1.1" xref="Pt0.A1.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.p1.1.m1.1b"><times id="Pt0.A1.SS2.p1.1.m1.1.1.cmml" xref="Pt0.A1.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.p1.1.m1.1c">\times</annotation></semantics></math>32 images in 10 classes, with 6000 images per class. CIFAR-100 also consists of 60,000 images but is categorized into 100 classes, each containing 600 images. CIFAR-10 provides a fundamental platform for image classification tasks, offering a relatively simpler challenge. CIFAR-100, on the other hand, presents a more challenging scenario with more fine-grained categories.</p>
</div>
<div id="Pt0.A1.SS2.p2" class="ltx_para">
<p id="Pt0.A1.SS2.p2.1" class="ltx_p"><span id="Pt0.A1.SS2.p2.1.1" class="ltx_text ltx_font_bold">Tiny-ImageNet.</span> Tiny-ImageNet is a simplified version of the larger ImageNet<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://www.image-net.org/</span></span></span> dataset. It consists of 100,000 64<math id="Pt0.A1.SS2.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Pt0.A1.SS2.p2.1.m1.1a"><mo id="Pt0.A1.SS2.p2.1.m1.1.1" xref="Pt0.A1.SS2.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Pt0.A1.SS2.p2.1.m1.1b"><times id="Pt0.A1.SS2.p2.1.m1.1.1.cmml" xref="Pt0.A1.SS2.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.SS2.p2.1.m1.1c">\times</annotation></semantics></math>64 images in 200 classes, which serves as a bridge between simpler datasets like CIFAR and the full-scale ImageNet dataset. Due to its increased complexity, training on Tiny-ImageNet is more demanding, often used to further assess a method’s efficacy. It is noteworthy that accuracy levels on Tiny-ImageNet tend to be significantly lower compared to those achieved on CIFAR datasets, reflecting its heightened challenge.</p>
</div>
</section>
<section id="Pt0.A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.A.3 </span>Models and the Pruned Details</h3>

<div id="Pt0.A1.SS3.p1" class="ltx_para">
<p id="Pt0.A1.SS3.p1.1" class="ltx_p">In all our experiments, we employ the ResNet18 model, which is also leveraged in baseline studies such as HeteroFL and FedProto. To introduce model heterogeneity, we apply a pruning rate to the hidden size, adjusting the input and output channels. The lower the pruning rate, the simpler the model becomes, whereas the higher the pruning rate, the more complex it is. This pruning process is applied to the first convolutional layer, all subsequent residual blocks, and the input size of the first fully connected layer.</p>
</div>
</section>
</section>
<section id="Pt0.A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>Data samples generated by diffusion model</h2>

<div id="Pt0.A2.p1" class="ltx_para">
<p id="Pt0.A2.p1.1" class="ltx_p">We implement a Conditional Generative Adversarial Network (CGAN) to generate images in the style of CIFAR-10-style and present a visualized comparison with images generated by a diffusion model. Figure <a href="#Pt0.A2.F1" title="Figure 1 ‣ Appendix 0.B Data samples generated by diffusion model ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> presents the results. In this figure, each row corresponds to a different class from CIFAR-10, showcasing 10 images per class. The class labels, arranged from top to bottom, are "airplane," "automobile," "bird," "cat," "deer," "dog," "frog," "horse," "ship," and "truck". For guiding the image generation process in the diffusion model, we employ the prompt format “A photo of *”, where “*” represents the aforementioned class names.</p>
</div>
<div id="Pt0.A2.p2" class="ltx_para">
<p id="Pt0.A2.p2.1" class="ltx_p">As we can observe, it is evident that the image quality produced by the diffusion model significantly surpasses that of the CGAN-generated images. In Figure <a href="#Pt0.A2.F1.sf1" title="Figure 1(a) ‣ Figure 1 ‣ Appendix 0.B Data samples generated by diffusion model ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, the majority only exhibit a singular outline, making the corresponding category hardly recognizable. In contrast, most images in Figure <a href="#Pt0.A2.F1.sf2" title="Figure 1(b) ‣ Figure 1 ‣ Appendix 0.B Data samples generated by diffusion model ‣ FedTSA: A Cluster-based Two-Stage Aggregation Method for Model-heterogeneous Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a> accurately depict the corresponding class. High-quality images facilitate the generation of effective representations by models, thereby enhancing knowledge exchange efficiency and contributing to the overall improvement in model performance.</p>
</div>
<figure id="Pt0.A2.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Pt0.A2.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.05098/assets/img/epoch_49_generated_grid.png" id="Pt0.A2.F1.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A2.F1.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="Pt0.A2.F1.sf1.3.2" class="ltx_text" style="font-size:90%;">CGAN-generated images</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Pt0.A2.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2407.05098/assets/img/diffusion_generated_grid.png" id="Pt0.A2.F1.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A2.F1.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="Pt0.A2.F1.sf2.3.2" class="ltx_text" style="font-size:90%;">Diffusion model-generated images</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A2.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="Pt0.A2.F1.3.2" class="ltx_text" style="font-size:90%;">Comparison of image generation quality: CGAN vs. Diffusion Model.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.05097" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.05098" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.05098">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.05098" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.05099" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 17:06:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
