<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.11304] FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts</title><meta property="og:description" content="As Large Language Models (LLMs) push the boundaries of AI capabilities, their demand for data is growing.
Much of this data is private and distributed across edge devices, making Federated Learning (FL) a de-facto alte…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.11304">

<!--Generated on Thu Sep  5 17:57:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Hanzi Mei<sup id="id1.1.id1" class="ltx_sup">1</sup>,
Dongqi Cai<sup id="id2.2.id2" class="ltx_sup">1</sup>,
Ao Zhou<sup id="id3.3.id3" class="ltx_sup">1</sup>,
Shangguang Wang<sup id="id4.4.id4" class="ltx_sup">1</sup>,
Mengwei Xu<sup id="id5.5.id5" class="ltx_sup">1</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.id1" class="ltx_p">As Large Language Models (LLMs) push the boundaries of AI capabilities, their demand for data is growing.
Much of this data is private and distributed across edge devices, making Federated Learning (FL) a de-facto alternative for fine-tuning (i.e., FedLLM).
However, it faces significant challenges due to the inherent heterogeneity among clients, including varying data distributions and diverse task types.
Towards a versatile FedLLM, we replace traditional dense model with a sparsely-activated Mixture-of-Experts (MoE) architecture, whose parallel feed-forward networks enable greater flexibility.
To make it more practical in resource-constrained environments, we present <span id="id6.id1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>, the efficient personalized FL framework to address data heterogeneity, constructing an optimal sub-MoE for each client and bringing the knowledge back to global MoE.
<span id="id6.id1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> is composed of two fine-tuning stages.
In the first stage, <span id="id6.id1.3" class="ltx_text ltx_font_typewriter">FedMoE</span> simplifies the problem by conducting a heuristic search based on observed activation patterns, which identifies a suboptimal submodel for each client.
In the second stage, these submodels are distributed to clients for further training and returned for server aggregating through a novel modular aggregation strategy.
Meanwhile, <span id="id6.id1.4" class="ltx_text ltx_font_typewriter">FedMoE</span> progressively adjusts the submodels to optimal through global expert recommendation.
Experimental results demonstrate the superiority of our method over previous personalized FL methods.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<figure id="Sx1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x1.png" id="Sx1.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Pretrained model on XSUM</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x2.png" id="Sx1.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>5 Epochs fine-tuned on XSUM</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx1.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x3.png" id="Sx1.F1.sf3.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>20 Epochs fine-tuned on XSUM</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx1.F1.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x4.png" id="Sx1.F1.sf4.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>20 Epochs fine-tuned on AG_NEWS</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx1.F1.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x5.png" id="Sx1.F1.sf5.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>20 Epochs fine-tuned on non-IID AG_NEWS</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Heatmap of expert activation frequencies across different training stages and datasets.</figcaption>
</figure>
<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Emerging applications of Large Language Models (LLMs) like ChatGPT and Sora are transforming the AI landscape <cite class="ltx_cite ltx_citemacro_citep">(Wu et al. <a href="#bib.bib44" title="" class="ltx_ref">2023</a>; Liu et al. <a href="#bib.bib23" title="" class="ltx_ref">2024</a>)</cite>.
However, such models require increasing amounts of downstream data for fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al. <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>.
Currently, the public cloud data is running out <cite class="ltx_cite ltx_citemacro_citep">(Villalobos et al. <a href="#bib.bib37" title="" class="ltx_ref">2022</a>)</cite>.
A huge amount of private data is still unexplored on distributed edge devices such as smartphones and autonomous vehicles.
To leverage such distributed and private data, Federated Learning (FL) has become a de-facto approach <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al. <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>, allowing edge devices to process data on-device and collaboratively train stronger LLMs while preserving privacy, noted as FedLLM <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a href="#bib.bib45" title="" class="ltx_ref">2024</a>)</cite>.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Despite the promising vision, FedLLM remains challenging in heterogeneous reality.
Generally, participants possess data that varies in domain and quality due to varying environments, typically noted as non-independent and identically distributed (non-IID) issue <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib53" title="" class="ltx_ref">2021</a>)</cite>.
More critically, when extended to cross-task scenarios with different optimization objectives, the heterogeneity could be further exacerbated.
This difficult but more realistic setting has been researched as task level <cite class="ltx_cite ltx_citemacro_citep">(Cai et al. <a href="#bib.bib4" title="" class="ltx_ref">2023</a>; Yao et al. <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite>.
Therefore, personalized FL has emerged, with some approaches aiming to train proprietary and heterogeneous local models for each client.
Prior studies mainly focus on model distillation or model pruning derived from dense models <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib54" title="" class="ltx_ref">2022</a>; Ilhan, Su, and Liu <a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Recently, Mixture-of-Experts (MoE) <cite class="ltx_cite ltx_citemacro_citep">(Rajbhandari et al. <a href="#bib.bib30" title="" class="ltx_ref">2022</a>; Jiang et al. <a href="#bib.bib13" title="" class="ltx_ref">2024</a>)</cite> has been widely explored to scale up the model efficiently, with experts pretrained to be sparsely activated for various tokens.
We thereby prototype <span id="Sx1.p3.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>, the personalized FL framework that integrates transformer-based MoE into FL to address heterogeneity challenges.
The impetus behind <span id="Sx1.p3.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> stems from the unique and inherent features of MoE model.
The expert-parallel structure along with the sparsely-activated mechanism has the potential to facilitate personalization for different clients, as each client flexibly activates the most relevant parameters.
Furthermore, the MoE model supports on-demand scaling of model capacity <cite class="ltx_cite ltx_citemacro_citep">(Krajewski et al. <a href="#bib.bib18" title="" class="ltx_ref">2024</a>)</cite>, enabling it to adapt to the increasing complexity of data and tasks in FL.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">While the idea is intriguing, deploying MoE models into edge clients is not trivial.
For example, training a Switch Transformers model <cite class="ltx_cite ltx_citemacro_citep">(Fedus, Zoph, and Shazeer <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> with 32 experts per layer demands at least 37GB of memory, overly exceeding the capacity of many client devices.
To further facilitate the practical deployment of <span id="Sx1.p4.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>, we propose an efficient <span id="Sx1.p4.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> fine-tuning system to tackle data heterogeneity while considering resource constraints.
The main idea is to construct a specific, optimal sub-MoE model for each client, and then aggregate the knowledge back to the global MoE model.
The holistic system is composed of two stages.
In the first stage, <span id="Sx1.p4.1.3" class="ltx_text ltx_font_typewriter">FedMoE</span> efficiently reduces the problem complexity by identifying an initial submodel close to optimal for each client. Specifically, it conducts a heuristic search among all experts based on activation patterns observed during preliminary fine-tuning.
In the second stage, the initial submodels are sub-sampled from the global model and distributed to clients for edge training.
After edge training, <span id="Sx1.p4.1.4" class="ltx_text ltx_font_typewriter">FedMoE</span> adopts a modular aggregation strategy in cloud server, sharing the relevant knowledge across clients while excluding negative interference.
Additionally, <span id="Sx1.p4.1.5" class="ltx_text ltx_font_typewriter">FedMoE</span> progressively adjusts the edge model structures through expert recommendation from the global perspective, striking the balance between efficiency and performance.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">In general, our contributions are highlighted as follows:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">We conduct preliminary experiments to demonstrate the characteristics of expert activation during heterogeneous FedLLM fine-tuning.</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">We present <span id="Sx1.I1.i2.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>, an efficient FL system integrating transformer-based MoE models to address heterogeneity issues.
<span id="Sx1.I1.i2.p1.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> dynamically searches and distributes personalized experts for different clients and absorbs the knowledge back into a generic global model.</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments to demonstrate the empirical effectiveness of <span id="Sx1.I1.i3.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>.
Owing to meticulously designed personalization, <span id="Sx1.I1.i3.p1.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> achieves superior performance across all tasks, while reducing the memory footprint and network traffic over existing baselines.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Background and Motivation</h2>

<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Federated Learning</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">The FL paradigm enables multiple edge devices to collaboratively train a shared model through rounds of edge-cloud communications, without sharing the local data <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al. <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>.
In each round, the cloud server randomly selects a set of edge devices (or <span id="Sx2.SSx1.p1.1.1" class="ltx_text ltx_font_italic">clients</span>) and distributes the latest global model for edge fine-tuning.
The server then collects those edge models to update the global model through aggregation.
FL serves as a privacy-friendly training paradigm to utilize decentralized data under legal regulation such as GDPR <cite class="ltx_cite ltx_citemacro_citep">(Wikipedia <a href="#bib.bib40" title="" class="ltx_ref">2024</a>)</cite> and CCPA <cite class="ltx_cite ltx_citemacro_citep">(Wikipedia contributors <a href="#bib.bib41" title="" class="ltx_ref">2024</a>)</cite>.</p>
</div>
<div id="Sx2.SSx1.p2" class="ltx_para">
<p id="Sx2.SSx1.p2.1" class="ltx_p">Despite FL’s effectiveness in building privacy-preserving LLMs, training a generic large model across multiple tasks is still in its infancy.
Given the divergent or even conflicting update directions produced by different tasks, it is challenging for global model to achieve optimal convergence <cite class="ltx_cite ltx_citemacro_citep">(Tan et al. <a href="#bib.bib35" title="" class="ltx_ref">2022</a>)</cite>.
Furthermore, the fine-tuning process in FL is bottlenecked by on-device resources and network transmission <cite class="ltx_cite ltx_citemacro_citep">(Lim et al. <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>.
The global model must be affordable for the weakest device, which restricts the model scale and overall performance. Meanwhile, the resources of other devices are underutilized.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Mixture of Experts</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">Inspired by conditional computation, the MoE architecture breaks the principle of using the same set of parameters for all inputs <cite class="ltx_cite ltx_citemacro_citep">(Shazeer et al. <a href="#bib.bib33" title="" class="ltx_ref">2017</a>)</cite>.
An MoE layer consists of a trainable gating network and a pool of experts, each a feed-forward network (FFN). The gating networks within the MoE determine the pathway of sequentially activated experts for each token.
In the case of Switch Transformers, one of the most popular MoE-based models, the gating network is simplified to a top-1 router. Each token activates one expert per layer based on the probabilities computed by router, leaving the other experts unupdated.</p>
</div>
<div id="Sx2.SSx2.p2" class="ltx_para">
<p id="Sx2.SSx2.p2.1" class="ltx_p">MoE architecture scales up the model capacity in a computationally efficient manner, achieving significant performance improvements across many downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Fedus, Dean, and Zoph <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite>.
The effectiveness also extends from individual tasks to multi-task learning scenarios, where multiple objectives are learned simultaneously <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al. <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Kim et al. <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>.
The advantage of MoE can be attributed to the unique expert-parallel structure and sparsely-activated mechanism, rendering each expert capable of handling specific tasks or data subsets. Therefore, MoE model shows significant potential for adapting to multi-tasking and heterogeneous data environments.</p>
</div>
</section>
<section id="Sx2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Motivation and Preliminary Experiments</h3>

<div id="Sx2.SSx3.p1" class="ltx_para">
<p id="Sx2.SSx3.p1.1" class="ltx_p">Sharing all parameters across clients is not a silver-bullet approach in FL, especially when dealing with heterogeneous data.
Unlike previous FL studies, we aim to train an MoE-architectured backbone. The parameter spaces in sparse layers are disentangled, allowing for a more flexible and on-demand parameter-sharing scheme.
Specifically, a subset of optimal experts can be sub-sampled from the global model, constructing a client-specific heterogeneous model for personalized learning, and bringing the knowledge back to the global model during aggregation.
This novel scheme allows clients to share the most relevant parameters, encouraging cooperation while preventing interference.</p>
</div>
<div id="Sx2.SSx3.p2" class="ltx_para">
<p id="Sx2.SSx3.p2.1" class="ltx_p">However, the main obstacle lies in identifying the optimal experts for specific data under the resource constraints. To gain insights for the design of <span id="Sx2.SSx3.p2.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span>, we conduct a series of preliminary experiments based on Switch Transformers to explore the characteristics of expert activation.</p>
</div>
<div id="Sx2.SSx3.p3" class="ltx_para">
<p id="Sx2.SSx3.p3.1" class="ltx_p"><span id="Sx2.SSx3.p3.1.1" class="ltx_text ltx_font_bold">Observation-1: Expert activation characteristics are skewed and dynamic during fine-tuning.</span> As illustrated in Figure <a href="#Sx1.F1" title="Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, experts exhibit a distinct imbalance in activation frequencies, indicating that only certain experts (those frequently activated) are of critical importance <cite class="ltx_cite ltx_citemacro_citep">(Yi et al. <a href="#bib.bib48" title="" class="ltx_ref">2023</a>; Lu et al. <a href="#bib.bib24" title="" class="ltx_ref">2024</a>)</cite>. The comparison between Figure <a href="#Sx1.F1.sf1" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a> and Figure <a href="#Sx1.F1.sf3" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a> further reveals that fine-tuning significantly alters the activation patterns, enabling the model to identify the optimal experts progressively. This observation suggests that the importance of experts should be assessed dynamically during training, rather than statically beforehand.</p>
</div>
<div id="Sx2.SSx3.p4" class="ltx_para">
<p id="Sx2.SSx3.p4.1" class="ltx_p"><span id="Sx2.SSx3.p4.1.1" class="ltx_text ltx_font_bold">Observation-2: Optimal experts converge quickly and perform comparably.</span> We monitor the activation characteristics at every epoch during fine-tuning on a text summarization task, whose evolution is shown in Figure <a href="#Sx1.F1.sf1" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, Figure <a href="#Sx1.F1.sf2" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a> and Figure <a href="#Sx1.F1.sf3" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>. The optimal experts quickly stabilize after a certain epoch, exhibiting only minor fluctuations in their activation frequencies, which facilitates model pruning. As demonstrated in Figure <a href="#Sx2.F2" title="Figure 2 ‣ Motivation and Preliminary Experiments ‣ Background and Motivation ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the submodel constructed by optimal experts shows a comparable performance to full model, while the submodel built with randomly chosen experts falls short.</p>
</div>
<figure id="Sx2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx2.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x6.png" id="Sx2.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Accuracy</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx2.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x7.png" id="Sx2.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Loss</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Performance of full model (8 experts per layer) and submodels (4 optimal experts per layer, 4 random experts per layer).</figcaption>
</figure>
<div id="Sx2.SSx3.p5" class="ltx_para">
<p id="Sx2.SSx3.p5.1" class="ltx_p"><span id="Sx2.SSx3.p5.1.1" class="ltx_text ltx_font_bold">Observation-3: Optimal experts differ across heterogeneous data, especially when heterogeneity reaches the task level.</span> As illustrated in Figure <a href="#Sx1.F1.sf4" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(d)</span></a> and Figure <a href="#Sx1.F1.sf5" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(e)</span></a>, within the same task, data of diverse distributions favor different subsets of experts, albeit with some overlap. The difference is exacerbated when it comes to different tasks that require distinct knowledge, as demonstrated by Figure <a href="#Sx1.F1.sf3" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a> and Figure <a href="#Sx1.F1.sf5" title="In Figure 1 ‣ Introduction ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(e)</span></a>.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Method</h2>

<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Problem Formulation</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.9" class="ltx_p">In personalized FL, there are <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mi id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><ci id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">n</annotation></semantics></math> clients collaborating to learn <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">m</annotation></semantics></math> types of downstream tasks under varying memory constraints. Each client <math id="Sx3.SSx1.p1.3.m3.4" class="ltx_Math" alttext="k=1,2,\ldots,n" display="inline"><semantics id="Sx3.SSx1.p1.3.m3.4a"><mrow id="Sx3.SSx1.p1.3.m3.4.5" xref="Sx3.SSx1.p1.3.m3.4.5.cmml"><mi id="Sx3.SSx1.p1.3.m3.4.5.2" xref="Sx3.SSx1.p1.3.m3.4.5.2.cmml">k</mi><mo id="Sx3.SSx1.p1.3.m3.4.5.1" xref="Sx3.SSx1.p1.3.m3.4.5.1.cmml">=</mo><mrow id="Sx3.SSx1.p1.3.m3.4.5.3.2" xref="Sx3.SSx1.p1.3.m3.4.5.3.1.cmml"><mn id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml">1</mn><mo id="Sx3.SSx1.p1.3.m3.4.5.3.2.1" xref="Sx3.SSx1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="Sx3.SSx1.p1.3.m3.2.2" xref="Sx3.SSx1.p1.3.m3.2.2.cmml">2</mn><mo id="Sx3.SSx1.p1.3.m3.4.5.3.2.2" xref="Sx3.SSx1.p1.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.p1.3.m3.3.3" xref="Sx3.SSx1.p1.3.m3.3.3.cmml">…</mi><mo id="Sx3.SSx1.p1.3.m3.4.5.3.2.3" xref="Sx3.SSx1.p1.3.m3.4.5.3.1.cmml">,</mo><mi id="Sx3.SSx1.p1.3.m3.4.4" xref="Sx3.SSx1.p1.3.m3.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.4b"><apply id="Sx3.SSx1.p1.3.m3.4.5.cmml" xref="Sx3.SSx1.p1.3.m3.4.5"><eq id="Sx3.SSx1.p1.3.m3.4.5.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.5.1"></eq><ci id="Sx3.SSx1.p1.3.m3.4.5.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.5.2">𝑘</ci><list id="Sx3.SSx1.p1.3.m3.4.5.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.5.3.2"><cn type="integer" id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1">1</cn><cn type="integer" id="Sx3.SSx1.p1.3.m3.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.2.2">2</cn><ci id="Sx3.SSx1.p1.3.m3.3.3.cmml" xref="Sx3.SSx1.p1.3.m3.3.3">…</ci><ci id="Sx3.SSx1.p1.3.m3.4.4.cmml" xref="Sx3.SSx1.p1.3.m3.4.4">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.4c">k=1,2,\ldots,n</annotation></semantics></math> executes edge training based on a local dataset <math id="Sx3.SSx1.p1.4.m4.4" class="ltx_Math" alttext="{\mathcal{D}_{k}}:=\left({\mathcal{X},{\mathcal{Y}_{k}},{p_{k}}\left(x\right)}\right)" display="inline"><semantics id="Sx3.SSx1.p1.4.m4.4a"><mrow id="Sx3.SSx1.p1.4.m4.4.4" xref="Sx3.SSx1.p1.4.m4.4.4.cmml"><msub id="Sx3.SSx1.p1.4.m4.4.4.4" xref="Sx3.SSx1.p1.4.m4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.4.m4.4.4.4.2" xref="Sx3.SSx1.p1.4.m4.4.4.4.2.cmml">𝒟</mi><mi id="Sx3.SSx1.p1.4.m4.4.4.4.3" xref="Sx3.SSx1.p1.4.m4.4.4.4.3.cmml">k</mi></msub><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.4.m4.4.4.3" xref="Sx3.SSx1.p1.4.m4.4.4.3.cmml">:=</mo><mrow id="Sx3.SSx1.p1.4.m4.4.4.2.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml"><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.3" xref="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.4.m4.2.2" xref="Sx3.SSx1.p1.4.m4.2.2.cmml">𝒳</mi><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.4" xref="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml">,</mo><msub id="Sx3.SSx1.p1.4.m4.3.3.1.1.1" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.2" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1.2.cmml">𝒴</mi><mi id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.3" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.5" xref="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml">,</mo><mrow id="Sx3.SSx1.p1.4.m4.4.4.2.2.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.cmml"><msub id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.cmml"><mi id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.2.cmml">p</mi><mi id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.3" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.1" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.3.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.cmml"><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.3.2.1" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.cmml">(</mo><mi id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.3.2.2" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p1.4.m4.4.4.2.2.6" xref="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.4b"><apply id="Sx3.SSx1.p1.4.m4.4.4.cmml" xref="Sx3.SSx1.p1.4.m4.4.4"><csymbol cd="latexml" id="Sx3.SSx1.p1.4.m4.4.4.3.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.3">assign</csymbol><apply id="Sx3.SSx1.p1.4.m4.4.4.4.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.4.m4.4.4.4.1.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.4">subscript</csymbol><ci id="Sx3.SSx1.p1.4.m4.4.4.4.2.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.4.2">𝒟</ci><ci id="Sx3.SSx1.p1.4.m4.4.4.4.3.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.4.3">𝑘</ci></apply><vector id="Sx3.SSx1.p1.4.m4.4.4.2.3.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2"><ci id="Sx3.SSx1.p1.4.m4.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.2.2">𝒳</ci><apply id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.2.cmml" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1.2">𝒴</ci><ci id="Sx3.SSx1.p1.4.m4.3.3.1.1.1.3.cmml" xref="Sx3.SSx1.p1.4.m4.3.3.1.1.1.3">𝑘</ci></apply><apply id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2"><times id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.1.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.1"></times><apply id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.2">𝑝</ci><ci id="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.3.cmml" xref="Sx3.SSx1.p1.4.m4.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">𝑥</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.4c">{\mathcal{D}_{k}}:=\left({\mathcal{X},{\mathcal{Y}_{k}},{p_{k}}\left(x\right)}\right)</annotation></semantics></math>. The input space <math id="Sx3.SSx1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="Sx3.SSx1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.5.m5.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><ci id="Sx3.SSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">\mathcal{X}</annotation></semantics></math> is globally shared, while the input distribution <math id="Sx3.SSx1.p1.6.m6.1" class="ltx_Math" alttext="p_{k}(x)" display="inline"><semantics id="Sx3.SSx1.p1.6.m6.1a"><mrow id="Sx3.SSx1.p1.6.m6.1.2" xref="Sx3.SSx1.p1.6.m6.1.2.cmml"><msub id="Sx3.SSx1.p1.6.m6.1.2.2" xref="Sx3.SSx1.p1.6.m6.1.2.2.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.2.2.2" xref="Sx3.SSx1.p1.6.m6.1.2.2.2.cmml">p</mi><mi id="Sx3.SSx1.p1.6.m6.1.2.2.3" xref="Sx3.SSx1.p1.6.m6.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.6.m6.1.2.1" xref="Sx3.SSx1.p1.6.m6.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.6.m6.1.2.3.2" xref="Sx3.SSx1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.6.m6.1.2.3.2.1" xref="Sx3.SSx1.p1.6.m6.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="Sx3.SSx1.p1.6.m6.1.2.3.2.2" xref="Sx3.SSx1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><apply id="Sx3.SSx1.p1.6.m6.1.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2"><times id="Sx3.SSx1.p1.6.m6.1.2.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.1"></times><apply id="Sx3.SSx1.p1.6.m6.1.2.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.6.m6.1.2.2.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.6.m6.1.2.2.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.2.2">𝑝</ci><ci id="Sx3.SSx1.p1.6.m6.1.2.2.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.2.3">𝑘</ci></apply><ci id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">p_{k}(x)</annotation></semantics></math> can be either IID or non-IID across different clients. The output space <math id="Sx3.SSx1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{Y}_{k}" display="inline"><semantics id="Sx3.SSx1.p1.7.m7.1a"><msub id="Sx3.SSx1.p1.7.m7.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.7.m7.1.1.2" xref="Sx3.SSx1.p1.7.m7.1.1.2.cmml">𝒴</mi><mi id="Sx3.SSx1.p1.7.m7.1.1.3" xref="Sx3.SSx1.p1.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.1b"><apply id="Sx3.SSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.2">𝒴</ci><ci id="Sx3.SSx1.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.1c">\mathcal{Y}_{k}</annotation></semantics></math> corresponds to a target task <math id="Sx3.SSx1.p1.8.m8.4" class="ltx_Math" alttext="\mathcal{T}_{k}\in\left\{{1,2,\ldots,m}\right\}" display="inline"><semantics id="Sx3.SSx1.p1.8.m8.4a"><mrow id="Sx3.SSx1.p1.8.m8.4.5" xref="Sx3.SSx1.p1.8.m8.4.5.cmml"><msub id="Sx3.SSx1.p1.8.m8.4.5.2" xref="Sx3.SSx1.p1.8.m8.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.8.m8.4.5.2.2" xref="Sx3.SSx1.p1.8.m8.4.5.2.2.cmml">𝒯</mi><mi id="Sx3.SSx1.p1.8.m8.4.5.2.3" xref="Sx3.SSx1.p1.8.m8.4.5.2.3.cmml">k</mi></msub><mo id="Sx3.SSx1.p1.8.m8.4.5.1" xref="Sx3.SSx1.p1.8.m8.4.5.1.cmml">∈</mo><mrow id="Sx3.SSx1.p1.8.m8.4.5.3.2" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml"><mo id="Sx3.SSx1.p1.8.m8.4.5.3.2.1" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml">{</mo><mn id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml">1</mn><mo id="Sx3.SSx1.p1.8.m8.4.5.3.2.2" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml">,</mo><mn id="Sx3.SSx1.p1.8.m8.2.2" xref="Sx3.SSx1.p1.8.m8.2.2.cmml">2</mn><mo id="Sx3.SSx1.p1.8.m8.4.5.3.2.3" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.p1.8.m8.3.3" xref="Sx3.SSx1.p1.8.m8.3.3.cmml">…</mi><mo id="Sx3.SSx1.p1.8.m8.4.5.3.2.4" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml">,</mo><mi id="Sx3.SSx1.p1.8.m8.4.4" xref="Sx3.SSx1.p1.8.m8.4.4.cmml">m</mi><mo id="Sx3.SSx1.p1.8.m8.4.5.3.2.5" xref="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.4b"><apply id="Sx3.SSx1.p1.8.m8.4.5.cmml" xref="Sx3.SSx1.p1.8.m8.4.5"><in id="Sx3.SSx1.p1.8.m8.4.5.1.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.1"></in><apply id="Sx3.SSx1.p1.8.m8.4.5.2.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.8.m8.4.5.2.1.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.2">subscript</csymbol><ci id="Sx3.SSx1.p1.8.m8.4.5.2.2.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.2.2">𝒯</ci><ci id="Sx3.SSx1.p1.8.m8.4.5.2.3.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.2.3">𝑘</ci></apply><set id="Sx3.SSx1.p1.8.m8.4.5.3.1.cmml" xref="Sx3.SSx1.p1.8.m8.4.5.3.2"><cn type="integer" id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">1</cn><cn type="integer" id="Sx3.SSx1.p1.8.m8.2.2.cmml" xref="Sx3.SSx1.p1.8.m8.2.2">2</cn><ci id="Sx3.SSx1.p1.8.m8.3.3.cmml" xref="Sx3.SSx1.p1.8.m8.3.3">…</ci><ci id="Sx3.SSx1.p1.8.m8.4.4.cmml" xref="Sx3.SSx1.p1.8.m8.4.4">𝑚</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.4c">\mathcal{T}_{k}\in\left\{{1,2,\ldots,m}\right\}</annotation></semantics></math>. The union <math id="Sx3.SSx1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}=\bigcup\nolimits_{k=1}^{n}{{\mathcal{D}_{k}}}" display="inline"><semantics id="Sx3.SSx1.p1.9.m9.1a"><mrow id="Sx3.SSx1.p1.9.m9.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.9.m9.1.1.2" xref="Sx3.SSx1.p1.9.m9.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="Sx3.SSx1.p1.9.m9.1.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="Sx3.SSx1.p1.9.m9.1.1.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.cmml"><msubsup id="Sx3.SSx1.p1.9.m9.1.1.3.1" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.cmml"><mo id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.2" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.2.cmml">⋃</mo><mrow id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.cmml"><mi id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.2" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.2.cmml">k</mi><mo id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.1" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.1.cmml">=</mo><mn id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx1.p1.9.m9.1.1.3.1.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.3.cmml">n</mi></msubsup><msub id="Sx3.SSx1.p1.9.m9.1.1.3.2" xref="Sx3.SSx1.p1.9.m9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.9.m9.1.1.3.2.2" xref="Sx3.SSx1.p1.9.m9.1.1.3.2.2.cmml">𝒟</mi><mi id="Sx3.SSx1.p1.9.m9.1.1.3.2.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.9.m9.1b"><apply id="Sx3.SSx1.p1.9.m9.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1"><eq id="Sx3.SSx1.p1.9.m9.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.1"></eq><ci id="Sx3.SSx1.p1.9.m9.1.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.2">𝒟</ci><apply id="Sx3.SSx1.p1.9.m9.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3"><apply id="Sx3.SSx1.p1.9.m9.1.1.3.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.1.1.3.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1">superscript</csymbol><apply id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1">subscript</csymbol><union id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.2"></union><apply id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3"><eq id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.1"></eq><ci id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="Sx3.SSx1.p1.9.m9.1.1.3.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.1.3">𝑛</ci></apply><apply id="Sx3.SSx1.p1.9.m9.1.1.3.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.1.1.3.2.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.1.1.3.2.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.2.2">𝒟</ci><ci id="Sx3.SSx1.p1.9.m9.1.1.3.2.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.9.m9.1c">\mathcal{D}=\bigcup\nolimits_{k=1}^{n}{{\mathcal{D}_{k}}}</annotation></semantics></math> represents the overall dataset used for FL.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para">
<p id="Sx3.SSx1.p2.3" class="ltx_p">The local objective of client <math id="Sx3.SSx1.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx3.SSx1.p2.1.m1.1a"><mi id="Sx3.SSx1.p2.1.m1.1.1" xref="Sx3.SSx1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.m1.1b"><ci id="Sx3.SSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.m1.1c">k</annotation></semantics></math> is to minimize the sum of label-smoothed cross-entropy loss and the weighted load balance loss for MoE, while keeping the memory usage of the edge model <math id="Sx3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="Sx3.SSx1.p2.2.m2.1a"><msub id="Sx3.SSx1.p2.2.m2.1.1" xref="Sx3.SSx1.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p2.2.m2.1.1.2" xref="Sx3.SSx1.p2.2.m2.1.1.2.cmml">w</mi><mi id="Sx3.SSx1.p2.2.m2.1.1.3" xref="Sx3.SSx1.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m2.1b"><apply id="Sx3.SSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p2.2.m2.1.1.2">𝑤</ci><ci id="Sx3.SSx1.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m2.1c">w_{k}</annotation></semantics></math> within the memory limit <math id="Sx3.SSx1.p2.3.m3.1" class="ltx_Math" alttext="M_{k}" display="inline"><semantics id="Sx3.SSx1.p2.3.m3.1a"><msub id="Sx3.SSx1.p2.3.m3.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.1.2" xref="Sx3.SSx1.p2.3.m3.1.1.2.cmml">M</mi><mi id="Sx3.SSx1.p2.3.m3.1.1.3" xref="Sx3.SSx1.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m3.1b"><apply id="Sx3.SSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.2">𝑀</ci><ci id="Sx3.SSx1.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m3.1c">M_{k}</annotation></semantics></math>, formulated as:</p>
<table id="Sx6.EGx1" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.Ex1.m1.5" class="ltx_Math" alttext="\displaystyle\min_{w_{k}}\,\mathcal{L}_{k}=\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}\left[\mathcal{L}_{CE}(y,\hat{y}(x;w_{k}))+\alpha\mathcal{L}_{LB}\right]" display="block"><semantics id="Sx3.Ex1.m1.5a"><mrow id="Sx3.Ex1.m1.5.5" xref="Sx3.Ex1.m1.5.5.cmml"><mrow id="Sx3.Ex1.m1.5.5.3" xref="Sx3.Ex1.m1.5.5.3.cmml"><munder id="Sx3.Ex1.m1.5.5.3.1" xref="Sx3.Ex1.m1.5.5.3.1.cmml"><mi id="Sx3.Ex1.m1.5.5.3.1.2" xref="Sx3.Ex1.m1.5.5.3.1.2.cmml">min</mi><msub id="Sx3.Ex1.m1.5.5.3.1.3" xref="Sx3.Ex1.m1.5.5.3.1.3.cmml"><mi id="Sx3.Ex1.m1.5.5.3.1.3.2" xref="Sx3.Ex1.m1.5.5.3.1.3.2.cmml">w</mi><mi id="Sx3.Ex1.m1.5.5.3.1.3.3" xref="Sx3.Ex1.m1.5.5.3.1.3.3.cmml">k</mi></msub></munder><mo lspace="0.337em" id="Sx3.Ex1.m1.5.5.3a" xref="Sx3.Ex1.m1.5.5.3.cmml">⁡</mo><msub id="Sx3.Ex1.m1.5.5.3.2" xref="Sx3.Ex1.m1.5.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex1.m1.5.5.3.2.2" xref="Sx3.Ex1.m1.5.5.3.2.2.cmml">ℒ</mi><mi id="Sx3.Ex1.m1.5.5.3.2.3" xref="Sx3.Ex1.m1.5.5.3.2.3.cmml">k</mi></msub></mrow><mo id="Sx3.Ex1.m1.5.5.2" xref="Sx3.Ex1.m1.5.5.2.cmml">=</mo><mrow id="Sx3.Ex1.m1.5.5.1" xref="Sx3.Ex1.m1.5.5.1.cmml"><msub id="Sx3.Ex1.m1.5.5.1.3" xref="Sx3.Ex1.m1.5.5.1.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.3.2" xref="Sx3.Ex1.m1.5.5.1.3.2.cmml">𝔼</mi><mrow id="Sx3.Ex1.m1.2.2.2" xref="Sx3.Ex1.m1.2.2.2.cmml"><mrow id="Sx3.Ex1.m1.2.2.2.4.2" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.2.2.2.4.2.1" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">(</mo><mi id="Sx3.Ex1.m1.1.1.1.1" xref="Sx3.Ex1.m1.1.1.1.1.cmml">x</mi><mo id="Sx3.Ex1.m1.2.2.2.4.2.2" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">,</mo><mi id="Sx3.Ex1.m1.2.2.2.2" xref="Sx3.Ex1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="Sx3.Ex1.m1.2.2.2.4.2.3" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="Sx3.Ex1.m1.2.2.2.3" xref="Sx3.Ex1.m1.2.2.2.3.cmml">∼</mo><msub id="Sx3.Ex1.m1.2.2.2.5" xref="Sx3.Ex1.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex1.m1.2.2.2.5.2" xref="Sx3.Ex1.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="Sx3.Ex1.m1.2.2.2.5.3" xref="Sx3.Ex1.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.2" xref="Sx3.Ex1.m1.5.5.1.2.cmml">​</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.2.cmml"><mo id="Sx3.Ex1.m1.5.5.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.cmml"><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.cmml"><msub id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.Ex1.m1.4.4" xref="Sx3.Ex1.m1.4.4.cmml">y</mi><mo id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml">,</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="Sx3.Ex1.m1.3.3" xref="Sx3.Ex1.m1.3.3.cmml">x</mi><mo id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.4" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex1.m1.5.5.1.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.2.cmml">+</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.1.1.1.3.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.1.cmml">​</mo><msub id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.3" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.3.cmml">B</mi></mrow></msub></mrow></mrow><mo id="Sx3.Ex1.m1.5.5.1.1.1.3" xref="Sx3.Ex1.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex1.m1.5b"><apply id="Sx3.Ex1.m1.5.5.cmml" xref="Sx3.Ex1.m1.5.5"><eq id="Sx3.Ex1.m1.5.5.2.cmml" xref="Sx3.Ex1.m1.5.5.2"></eq><apply id="Sx3.Ex1.m1.5.5.3.cmml" xref="Sx3.Ex1.m1.5.5.3"><apply id="Sx3.Ex1.m1.5.5.3.1.cmml" xref="Sx3.Ex1.m1.5.5.3.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.1.1.cmml" xref="Sx3.Ex1.m1.5.5.3.1">subscript</csymbol><min id="Sx3.Ex1.m1.5.5.3.1.2.cmml" xref="Sx3.Ex1.m1.5.5.3.1.2"></min><apply id="Sx3.Ex1.m1.5.5.3.1.3.cmml" xref="Sx3.Ex1.m1.5.5.3.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.1.3.1.cmml" xref="Sx3.Ex1.m1.5.5.3.1.3">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.3.1.3.2.cmml" xref="Sx3.Ex1.m1.5.5.3.1.3.2">𝑤</ci><ci id="Sx3.Ex1.m1.5.5.3.1.3.3.cmml" xref="Sx3.Ex1.m1.5.5.3.1.3.3">𝑘</ci></apply></apply><apply id="Sx3.Ex1.m1.5.5.3.2.cmml" xref="Sx3.Ex1.m1.5.5.3.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.2.1.cmml" xref="Sx3.Ex1.m1.5.5.3.2">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.3.2.2.cmml" xref="Sx3.Ex1.m1.5.5.3.2.2">ℒ</ci><ci id="Sx3.Ex1.m1.5.5.3.2.3.cmml" xref="Sx3.Ex1.m1.5.5.3.2.3">𝑘</ci></apply></apply><apply id="Sx3.Ex1.m1.5.5.1.cmml" xref="Sx3.Ex1.m1.5.5.1"><times id="Sx3.Ex1.m1.5.5.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.2"></times><apply id="Sx3.Ex1.m1.5.5.1.3.cmml" xref="Sx3.Ex1.m1.5.5.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.1.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.3">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.1.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.3.2">𝔼</ci><apply id="Sx3.Ex1.m1.2.2.2.cmml" xref="Sx3.Ex1.m1.2.2.2"><csymbol cd="latexml" id="Sx3.Ex1.m1.2.2.2.3.cmml" xref="Sx3.Ex1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="Sx3.Ex1.m1.2.2.2.4.1.cmml" xref="Sx3.Ex1.m1.2.2.2.4.2"><ci id="Sx3.Ex1.m1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.1.1.1.1">𝑥</ci><ci id="Sx3.Ex1.m1.2.2.2.2.cmml" xref="Sx3.Ex1.m1.2.2.2.2">𝑦</ci></interval><apply id="Sx3.Ex1.m1.2.2.2.5.cmml" xref="Sx3.Ex1.m1.2.2.2.5"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.2.2.2.5.1.cmml" xref="Sx3.Ex1.m1.2.2.2.5">subscript</csymbol><ci id="Sx3.Ex1.m1.2.2.2.5.2.cmml" xref="Sx3.Ex1.m1.2.2.2.5.2">𝒟</ci><ci id="Sx3.Ex1.m1.2.2.2.5.3.cmml" xref="Sx3.Ex1.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="Sx3.Ex1.m1.5.5.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1"><csymbol cd="latexml" id="Sx3.Ex1.m1.5.5.1.1.2.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1"><plus id="Sx3.Ex1.m1.5.5.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.2"></plus><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.2"></times><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.2">ℒ</ci><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.1"></times><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.2">𝐶</ci><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply><interval closure="open" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1"><ci id="Sx3.Ex1.m1.4.4.cmml" xref="Sx3.Ex1.m1.4.4">𝑦</ci><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3"><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.1">^</ci><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑦</ci></apply><list id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="Sx3.Ex1.m1.3.3.cmml" xref="Sx3.Ex1.m1.3.3">𝑥</ci><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></interval></apply><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.1"></times><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.2">𝛼</ci><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.2">ℒ</ci><apply id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.1"></times><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.2">𝐿</ci><ci id="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.3.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1.3.3.3.3">𝐵</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex1.m1.5c">\displaystyle\min_{w_{k}}\,\mathcal{L}_{k}=\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}\left[\mathcal{L}_{CE}(y,\hat{y}(x;w_{k}))+\alpha\mathcal{L}_{LB}\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E1.m1.2" class="ltx_Math" alttext="\displaystyle\text{s.t.}\quad\text{mem}(w_{k})\leq M_{k}" display="block"><semantics id="Sx3.E1.m1.2a"><mrow id="Sx3.E1.m1.2.2" xref="Sx3.E1.m1.2.2.cmml"><mrow id="Sx3.E1.m1.2.2.1.1" xref="Sx3.E1.m1.2.2.1.2.cmml"><mtext id="Sx3.E1.m1.1.1" xref="Sx3.E1.m1.1.1a.cmml">s.t.</mtext><mspace width="1em" id="Sx3.E1.m1.2.2.1.1.2" xref="Sx3.E1.m1.2.2.1.2.cmml"></mspace><mrow id="Sx3.E1.m1.2.2.1.1.1" xref="Sx3.E1.m1.2.2.1.1.1.cmml"><mtext id="Sx3.E1.m1.2.2.1.1.1.3" xref="Sx3.E1.m1.2.2.1.1.1.3a.cmml">mem</mtext><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.2.2.1.1.1.2" xref="Sx3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E1.m1.2.2.1.1.1.1.1" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E1.m1.2.2.1.1.1.1.1.2" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E1.m1.2.2.1.1.1.1.1.1" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.E1.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">w</mi><mi id="Sx3.E1.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="Sx3.E1.m1.2.2.1.1.1.1.1.3" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E1.m1.2.2.2" xref="Sx3.E1.m1.2.2.2.cmml">≤</mo><msub id="Sx3.E1.m1.2.2.3" xref="Sx3.E1.m1.2.2.3.cmml"><mi id="Sx3.E1.m1.2.2.3.2" xref="Sx3.E1.m1.2.2.3.2.cmml">M</mi><mi id="Sx3.E1.m1.2.2.3.3" xref="Sx3.E1.m1.2.2.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.2b"><apply id="Sx3.E1.m1.2.2.cmml" xref="Sx3.E1.m1.2.2"><leq id="Sx3.E1.m1.2.2.2.cmml" xref="Sx3.E1.m1.2.2.2"></leq><list id="Sx3.E1.m1.2.2.1.2.cmml" xref="Sx3.E1.m1.2.2.1.1"><ci id="Sx3.E1.m1.1.1a.cmml" xref="Sx3.E1.m1.1.1"><mtext id="Sx3.E1.m1.1.1.cmml" xref="Sx3.E1.m1.1.1">s.t.</mtext></ci><apply id="Sx3.E1.m1.2.2.1.1.1.cmml" xref="Sx3.E1.m1.2.2.1.1.1"><times id="Sx3.E1.m1.2.2.1.1.1.2.cmml" xref="Sx3.E1.m1.2.2.1.1.1.2"></times><ci id="Sx3.E1.m1.2.2.1.1.1.3a.cmml" xref="Sx3.E1.m1.2.2.1.1.1.3"><mtext id="Sx3.E1.m1.2.2.1.1.1.3.cmml" xref="Sx3.E1.m1.2.2.1.1.1.3">mem</mtext></ci><apply id="Sx3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.2">𝑤</ci><ci id="Sx3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E1.m1.2.2.1.1.1.1.1.1.3">𝑘</ci></apply></apply></list><apply id="Sx3.E1.m1.2.2.3.cmml" xref="Sx3.E1.m1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E1.m1.2.2.3.1.cmml" xref="Sx3.E1.m1.2.2.3">subscript</csymbol><ci id="Sx3.E1.m1.2.2.3.2.cmml" xref="Sx3.E1.m1.2.2.3.2">𝑀</ci><ci id="Sx3.E1.m1.2.2.3.3.cmml" xref="Sx3.E1.m1.2.2.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.2c">\displaystyle\text{s.t.}\quad\text{mem}(w_{k})\leq M_{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.p2.4" class="ltx_p">The clients in FL collaboratively train a global model <math id="Sx3.SSx1.p2.4.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="Sx3.SSx1.p2.4.m1.1a"><mi id="Sx3.SSx1.p2.4.m1.1.1" xref="Sx3.SSx1.p2.4.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m1.1b"><ci id="Sx3.SSx1.p2.4.m1.1.1.cmml" xref="Sx3.SSx1.p2.4.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m1.1c">w</annotation></semantics></math> to minimize the global objective function, formulated as:</p>
<table id="Sx6.EGx2" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E2.m1.3" class="ltx_Math" alttext="\displaystyle\min_{w}\,\mathcal{L}=\sum\limits_{k=1}^{n}{\frac{{\left|{{\mathcal{D}_{k}}}\right|}}{{\left|\mathcal{D}\right|}}}{\mathcal{L}_{k}}\left({{w_{k}}}\right)" display="block"><semantics id="Sx3.E2.m1.3a"><mrow id="Sx3.E2.m1.3.3" xref="Sx3.E2.m1.3.3.cmml"><mrow id="Sx3.E2.m1.3.3.3" xref="Sx3.E2.m1.3.3.3.cmml"><munder id="Sx3.E2.m1.3.3.3.1" xref="Sx3.E2.m1.3.3.3.1.cmml"><mi id="Sx3.E2.m1.3.3.3.1.2" xref="Sx3.E2.m1.3.3.3.1.2.cmml">min</mi><mi id="Sx3.E2.m1.3.3.3.1.3" xref="Sx3.E2.m1.3.3.3.1.3.cmml">w</mi></munder><mo lspace="0.337em" id="Sx3.E2.m1.3.3.3a" xref="Sx3.E2.m1.3.3.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.3.3.3.2" xref="Sx3.E2.m1.3.3.3.2.cmml">ℒ</mi></mrow><mo rspace="0.111em" id="Sx3.E2.m1.3.3.2" xref="Sx3.E2.m1.3.3.2.cmml">=</mo><mrow id="Sx3.E2.m1.3.3.1" xref="Sx3.E2.m1.3.3.1.cmml"><munderover id="Sx3.E2.m1.3.3.1.2" xref="Sx3.E2.m1.3.3.1.2.cmml"><mo movablelimits="false" id="Sx3.E2.m1.3.3.1.2.2.2" xref="Sx3.E2.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E2.m1.3.3.1.2.2.3" xref="Sx3.E2.m1.3.3.1.2.2.3.cmml"><mi id="Sx3.E2.m1.3.3.1.2.2.3.2" xref="Sx3.E2.m1.3.3.1.2.2.3.2.cmml">k</mi><mo id="Sx3.E2.m1.3.3.1.2.2.3.1" xref="Sx3.E2.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E2.m1.3.3.1.2.2.3.3" xref="Sx3.E2.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E2.m1.3.3.1.2.3" xref="Sx3.E2.m1.3.3.1.2.3.cmml">n</mi></munderover><mrow id="Sx3.E2.m1.3.3.1.1" xref="Sx3.E2.m1.3.3.1.1.cmml"><mfrac id="Sx3.E2.m1.2.2" xref="Sx3.E2.m1.2.2.cmml"><mrow id="Sx3.E2.m1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.2.cmml"><mo id="Sx3.E2.m1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.2.1.cmml">|</mo><msub id="Sx3.E2.m1.1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.1.1.1.1.1.2" xref="Sx3.E2.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="Sx3.E2.m1.1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E2.m1.1.1.1.1.3" xref="Sx3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="Sx3.E2.m1.2.2.2.3" xref="Sx3.E2.m1.2.2.2.2.cmml"><mo id="Sx3.E2.m1.2.2.2.3.1" xref="Sx3.E2.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.2.2.2.1" xref="Sx3.E2.m1.2.2.2.1.cmml">𝒟</mi><mo id="Sx3.E2.m1.2.2.2.3.2" xref="Sx3.E2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.3.3.1.1.2" xref="Sx3.E2.m1.3.3.1.1.2.cmml">​</mo><msub id="Sx3.E2.m1.3.3.1.1.3" xref="Sx3.E2.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.3.3.1.1.3.2" xref="Sx3.E2.m1.3.3.1.1.3.2.cmml">ℒ</mi><mi id="Sx3.E2.m1.3.3.1.1.3.3" xref="Sx3.E2.m1.3.3.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.3.3.1.1.2a" xref="Sx3.E2.m1.3.3.1.1.2.cmml">​</mo><mrow id="Sx3.E2.m1.3.3.1.1.1.1" xref="Sx3.E2.m1.3.3.1.1.1.1.1.cmml"><mo id="Sx3.E2.m1.3.3.1.1.1.1.2" xref="Sx3.E2.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E2.m1.3.3.1.1.1.1.1" xref="Sx3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="Sx3.E2.m1.3.3.1.1.1.1.1.2" xref="Sx3.E2.m1.3.3.1.1.1.1.1.2.cmml">w</mi><mi id="Sx3.E2.m1.3.3.1.1.1.1.1.3" xref="Sx3.E2.m1.3.3.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E2.m1.3.3.1.1.1.1.3" xref="Sx3.E2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.3b"><apply id="Sx3.E2.m1.3.3.cmml" xref="Sx3.E2.m1.3.3"><eq id="Sx3.E2.m1.3.3.2.cmml" xref="Sx3.E2.m1.3.3.2"></eq><apply id="Sx3.E2.m1.3.3.3.cmml" xref="Sx3.E2.m1.3.3.3"><apply id="Sx3.E2.m1.3.3.3.1.cmml" xref="Sx3.E2.m1.3.3.3.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.3.1.1.cmml" xref="Sx3.E2.m1.3.3.3.1">subscript</csymbol><min id="Sx3.E2.m1.3.3.3.1.2.cmml" xref="Sx3.E2.m1.3.3.3.1.2"></min><ci id="Sx3.E2.m1.3.3.3.1.3.cmml" xref="Sx3.E2.m1.3.3.3.1.3">𝑤</ci></apply><ci id="Sx3.E2.m1.3.3.3.2.cmml" xref="Sx3.E2.m1.3.3.3.2">ℒ</ci></apply><apply id="Sx3.E2.m1.3.3.1.cmml" xref="Sx3.E2.m1.3.3.1"><apply id="Sx3.E2.m1.3.3.1.2.cmml" xref="Sx3.E2.m1.3.3.1.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.1.2.1.cmml" xref="Sx3.E2.m1.3.3.1.2">superscript</csymbol><apply id="Sx3.E2.m1.3.3.1.2.2.cmml" xref="Sx3.E2.m1.3.3.1.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.1.2.2.1.cmml" xref="Sx3.E2.m1.3.3.1.2">subscript</csymbol><sum id="Sx3.E2.m1.3.3.1.2.2.2.cmml" xref="Sx3.E2.m1.3.3.1.2.2.2"></sum><apply id="Sx3.E2.m1.3.3.1.2.2.3.cmml" xref="Sx3.E2.m1.3.3.1.2.2.3"><eq id="Sx3.E2.m1.3.3.1.2.2.3.1.cmml" xref="Sx3.E2.m1.3.3.1.2.2.3.1"></eq><ci id="Sx3.E2.m1.3.3.1.2.2.3.2.cmml" xref="Sx3.E2.m1.3.3.1.2.2.3.2">𝑘</ci><cn type="integer" id="Sx3.E2.m1.3.3.1.2.2.3.3.cmml" xref="Sx3.E2.m1.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.E2.m1.3.3.1.2.3.cmml" xref="Sx3.E2.m1.3.3.1.2.3">𝑛</ci></apply><apply id="Sx3.E2.m1.3.3.1.1.cmml" xref="Sx3.E2.m1.3.3.1.1"><times id="Sx3.E2.m1.3.3.1.1.2.cmml" xref="Sx3.E2.m1.3.3.1.1.2"></times><apply id="Sx3.E2.m1.2.2.cmml" xref="Sx3.E2.m1.2.2"><divide id="Sx3.E2.m1.2.2.3.cmml" xref="Sx3.E2.m1.2.2"></divide><apply id="Sx3.E2.m1.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1"><abs id="Sx3.E2.m1.1.1.1.2.1.cmml" xref="Sx3.E2.m1.1.1.1.1.2"></abs><apply id="Sx3.E2.m1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.1.1.1.1.1.2">𝒟</ci><ci id="Sx3.E2.m1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="Sx3.E2.m1.2.2.2.2.cmml" xref="Sx3.E2.m1.2.2.2.3"><abs id="Sx3.E2.m1.2.2.2.2.1.cmml" xref="Sx3.E2.m1.2.2.2.3.1"></abs><ci id="Sx3.E2.m1.2.2.2.1.cmml" xref="Sx3.E2.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="Sx3.E2.m1.3.3.1.1.3.cmml" xref="Sx3.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.1.1.3.1.cmml" xref="Sx3.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="Sx3.E2.m1.3.3.1.1.3.2.cmml" xref="Sx3.E2.m1.3.3.1.1.3.2">ℒ</ci><ci id="Sx3.E2.m1.3.3.1.1.3.3.cmml" xref="Sx3.E2.m1.3.3.1.1.3.3">𝑘</ci></apply><apply id="Sx3.E2.m1.3.3.1.1.1.1.1.cmml" xref="Sx3.E2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.3.3.1.1.1.1.1.2">𝑤</ci><ci id="Sx3.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="Sx3.E2.m1.3.3.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.3c">\displaystyle\min_{w}\,\mathcal{L}=\sum\limits_{k=1}^{n}{\frac{{\left|{{\mathcal{D}_{k}}}\right|}}{{\left|\mathcal{D}\right|}}}{\mathcal{L}_{k}}\left({{w_{k}}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Overview</h3>

<section id="Sx3.SSx2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Model Structure</h4>

<div id="Sx3.SSx2.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx1.p1.1" class="ltx_p">The cloud hosts a large MoE model with an equal number of experts at every layer, initialized by a pre-trained MoE model. Global model’s extensive capacity enables it to provide a broad range of knowledge and store new information effectively.
The clients host heterogeneous sub-MoEs, differing in both model architecture (i.e., different expert numbers per layer) and parameter space (e.g., different pieces of the global model). These client-specific submodels are sub-sampled from the global model, retaining the most relevant experts to flexibly adapt to data characteristics under memory constraints.</p>
</div>
</section>
<section id="Sx3.SSx2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Workflow</h4>

<div id="Sx3.SSx2.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.SSSx2.p1.1" class="ltx_p"><span id="Sx3.SSx2.SSSx2.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> is structured into two stages, as illustrated in Figure <a href="#Sx3.F3" title="Figure 3 ‣ Workflow ‣ Overview ‣ Method ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
In the first stage, the server collects activation information from clients after memory-efficient fine-tuning at the edge (steps ①–②). Based on this information, the server conducts coarse-grained submodel searches (step ③) to determine an approximate model architecture for each client (i.e., an initial mapping of each client to its preferred expert subset). In the second stage, federated learning begins with the submodels initialized in stage one (step ④). In each round, fine-tuned submodels from different clients are integrated into the global model through modular aggregation (step ⑤–⑦), followed by fine-grained structural adjustments guided by real-time feedback (step ⑧).</p>
</div>
<figure id="Sx3.F3" class="ltx_figure"><img src="/html/2408.11304/assets/x8.png" id="Sx3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="968" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>FedMoE workflow.</figcaption>
</figure>
</section>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Stage One: Coarse-grained Submodel Initialization</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.5" class="ltx_p">To begin with, we employ expert activation probability as a criterion to assess expert importance under specific data distributions, represented as <math id="Sx3.SSx3.p1.1.m1.4" class="ltx_Math" alttext="p_{i,j}=\frac{{{n_{i,j}}}}{N}" display="inline"><semantics id="Sx3.SSx3.p1.1.m1.4a"><mrow id="Sx3.SSx3.p1.1.m1.4.5" xref="Sx3.SSx3.p1.1.m1.4.5.cmml"><msub id="Sx3.SSx3.p1.1.m1.4.5.2" xref="Sx3.SSx3.p1.1.m1.4.5.2.cmml"><mi id="Sx3.SSx3.p1.1.m1.4.5.2.2" xref="Sx3.SSx3.p1.1.m1.4.5.2.2.cmml">p</mi><mrow id="Sx3.SSx3.p1.1.m1.2.2.2.4" xref="Sx3.SSx3.p1.1.m1.2.2.2.3.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx3.p1.1.m1.2.2.2.4.1" xref="Sx3.SSx3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx3.p1.1.m1.2.2.2.2" xref="Sx3.SSx3.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.SSx3.p1.1.m1.4.5.1" xref="Sx3.SSx3.p1.1.m1.4.5.1.cmml">=</mo><mfrac id="Sx3.SSx3.p1.1.m1.4.4" xref="Sx3.SSx3.p1.1.m1.4.4.cmml"><msub id="Sx3.SSx3.p1.1.m1.4.4.2" xref="Sx3.SSx3.p1.1.m1.4.4.2.cmml"><mi id="Sx3.SSx3.p1.1.m1.4.4.2.4" xref="Sx3.SSx3.p1.1.m1.4.4.2.4.cmml">n</mi><mrow id="Sx3.SSx3.p1.1.m1.4.4.2.2.2.4" xref="Sx3.SSx3.p1.1.m1.4.4.2.2.2.3.cmml"><mi id="Sx3.SSx3.p1.1.m1.3.3.1.1.1.1" xref="Sx3.SSx3.p1.1.m1.3.3.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx3.p1.1.m1.4.4.2.2.2.4.1" xref="Sx3.SSx3.p1.1.m1.4.4.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx3.p1.1.m1.4.4.2.2.2.2" xref="Sx3.SSx3.p1.1.m1.4.4.2.2.2.2.cmml">j</mi></mrow></msub><mi id="Sx3.SSx3.p1.1.m1.4.4.4" xref="Sx3.SSx3.p1.1.m1.4.4.4.cmml">N</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.4b"><apply id="Sx3.SSx3.p1.1.m1.4.5.cmml" xref="Sx3.SSx3.p1.1.m1.4.5"><eq id="Sx3.SSx3.p1.1.m1.4.5.1.cmml" xref="Sx3.SSx3.p1.1.m1.4.5.1"></eq><apply id="Sx3.SSx3.p1.1.m1.4.5.2.cmml" xref="Sx3.SSx3.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.1.m1.4.5.2.1.cmml" xref="Sx3.SSx3.p1.1.m1.4.5.2">subscript</csymbol><ci id="Sx3.SSx3.p1.1.m1.4.5.2.2.cmml" xref="Sx3.SSx3.p1.1.m1.4.5.2.2">𝑝</ci><list id="Sx3.SSx3.p1.1.m1.2.2.2.3.cmml" xref="Sx3.SSx3.p1.1.m1.2.2.2.4"><ci id="Sx3.SSx3.p1.1.m1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="Sx3.SSx3.p1.1.m1.2.2.2.2.cmml" xref="Sx3.SSx3.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.SSx3.p1.1.m1.4.4.cmml" xref="Sx3.SSx3.p1.1.m1.4.4"><divide id="Sx3.SSx3.p1.1.m1.4.4.3.cmml" xref="Sx3.SSx3.p1.1.m1.4.4"></divide><apply id="Sx3.SSx3.p1.1.m1.4.4.2.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.1.m1.4.4.2.3.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.2">subscript</csymbol><ci id="Sx3.SSx3.p1.1.m1.4.4.2.4.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.2.4">𝑛</ci><list id="Sx3.SSx3.p1.1.m1.4.4.2.2.2.3.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.2.2.2.4"><ci id="Sx3.SSx3.p1.1.m1.3.3.1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.3.3.1.1.1.1">𝑖</ci><ci id="Sx3.SSx3.p1.1.m1.4.4.2.2.2.2.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.2.2.2.2">𝑗</ci></list></apply><ci id="Sx3.SSx3.p1.1.m1.4.4.4.cmml" xref="Sx3.SSx3.p1.1.m1.4.4.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.4c">p_{i,j}=\frac{{{n_{i,j}}}}{N}</annotation></semantics></math>, where <math id="Sx3.SSx3.p1.2.m2.2" class="ltx_Math" alttext="{n_{i,j}}" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.2a"><msub id="Sx3.SSx3.p1.2.m2.2.3" xref="Sx3.SSx3.p1.2.m2.2.3.cmml"><mi id="Sx3.SSx3.p1.2.m2.2.3.2" xref="Sx3.SSx3.p1.2.m2.2.3.2.cmml">n</mi><mrow id="Sx3.SSx3.p1.2.m2.2.2.2.4" xref="Sx3.SSx3.p1.2.m2.2.2.2.3.cmml"><mi id="Sx3.SSx3.p1.2.m2.1.1.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx3.p1.2.m2.2.2.2.4.1" xref="Sx3.SSx3.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx3.p1.2.m2.2.2.2.2" xref="Sx3.SSx3.p1.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.2b"><apply id="Sx3.SSx3.p1.2.m2.2.3.cmml" xref="Sx3.SSx3.p1.2.m2.2.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.2.m2.2.3.1.cmml" xref="Sx3.SSx3.p1.2.m2.2.3">subscript</csymbol><ci id="Sx3.SSx3.p1.2.m2.2.3.2.cmml" xref="Sx3.SSx3.p1.2.m2.2.3.2">𝑛</ci><list id="Sx3.SSx3.p1.2.m2.2.2.2.3.cmml" xref="Sx3.SSx3.p1.2.m2.2.2.2.4"><ci id="Sx3.SSx3.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.1.1">𝑖</ci><ci id="Sx3.SSx3.p1.2.m2.2.2.2.2.cmml" xref="Sx3.SSx3.p1.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.2c">{n_{i,j}}</annotation></semantics></math> is the activation times of the <math id="Sx3.SSx3.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx3.SSx3.p1.3.m3.1a"><mi id="Sx3.SSx3.p1.3.m3.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><ci id="Sx3.SSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">j</annotation></semantics></math>-th expert in <math id="Sx3.SSx3.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.p1.4.m4.1a"><mi id="Sx3.SSx3.p1.4.m4.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m4.1b"><ci id="Sx3.SSx3.p1.4.m4.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m4.1c">i</annotation></semantics></math>-th layer and <math id="Sx3.SSx3.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx3.p1.5.m5.1a"><mi id="Sx3.SSx3.p1.5.m5.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m5.1b"><ci id="Sx3.SSx3.p1.5.m5.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m5.1c">N</annotation></semantics></math> is the total token count.
Experts with higher activation probabilities are more crucial for the downstream task. Stage one involves a large-scale problem, as it requires fairly evaluating the importance of all experts across a vast number of clients. Conducting such evaluation within the memory limits of edge devices exacerbates the complexity.</p>
</div>
<section id="Sx3.SSx3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Activation Probability Collection</h4>

<div id="Sx3.SSx3.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx3.SSSx1.p1.1" class="ltx_p">The cloud sends a full-scale MoE to clients with all experts working in parallel.
Clients with sufficient memory further equip each expert with LoRA structure and then perform Parameter-Efficient Fine-Tuning (PEFT).
PEFT is a well-established method for memory-efficient fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib11" title="" class="ltx_ref">2021</a>; Sun et al. <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite>.
Since expert preferences converge quickly, fine-tuning only lasts a few rounds (e.g., 5 rounds) to obtain expert activation probabilities on validation datasets.
After gathering activation information, the cloud server performs a static prediction of expert activation probabilities for memory-insufficient clients, based on the intuition that homogeneous data typically favor a similar set of experts.
Specifically, the cloud calculates the estimated probabilities for a given client by averaging the probabilities of other clients with the same task, weighted by their data volume.
Ultimately, the cloud collects activation probabilities for all experts across all clients in a rough yet efficient manner, laying the foundation for constructing personalized models.
</p>
</div>
</section>
<section id="Sx3.SSx3.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Heuristic Submodel Search</h4>

<div id="Sx3.SSx3.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx3.SSSx2.p1.6" class="ltx_p">Based on the activation probabilities, the cloud strives to initialize a suboptimal submodel for each client under its memory constraint.
The issue is further modeled as an optimization problem.
For each client, the cloud aims to find a maximum threshold <math id="Sx3.SSx3.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.1.m1.1a"><mi id="Sx3.SSx3.SSSx2.p1.1.m1.1.1" xref="Sx3.SSx3.SSSx2.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.1.m1.1b"><ci id="Sx3.SSx3.SSSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.1.m1.1c">\theta</annotation></semantics></math>, ensuring the combined activation probabilities of the experts retained in each layer are at least <math id="Sx3.SSx3.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.2.m2.1a"><mi id="Sx3.SSx3.SSSx2.p1.2.m2.1.1" xref="Sx3.SSx3.SSSx2.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.2.m2.1b"><ci id="Sx3.SSx3.SSSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.2.m2.1c">\theta</annotation></semantics></math>. The uniform threshold across each layer guarantees the optimal performance of this model, as some layers only require a few skilled experts, whereas others demand more to collaborate. Additionally, the memory usage of the retained experts and dense layers must not exceed <math id="Sx3.SSx3.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="\alpha(0&lt;\alpha\leqslant 1)" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.3.m3.1a"><mrow id="Sx3.SSx3.SSSx2.p1.3.m3.1.1" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.3" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.2" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.2" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.cmml"><mn id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.2" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.2.cmml">0</mn><mo id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.3" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.3.cmml">&lt;</mo><mi id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.4" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.4.cmml">α</mi><mo id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.5" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.5.cmml">⩽</mo><mn id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.6" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.6.cmml">1</mn></mrow><mo stretchy="false" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.3" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.3.m3.1b"><apply id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1"><times id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.2"></times><ci id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.3">𝛼</ci><apply id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1"><and id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1a.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1"></and><apply id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1b.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1"><lt id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.3.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.3"></lt><cn type="integer" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.2.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.2">0</cn><ci id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.4.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.4">𝛼</ci></apply><apply id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1c.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1"><leq id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.5.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.5"></leq><share href="#Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.4.cmml" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1d.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1"></share><cn type="integer" id="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.6.cmml" xref="Sx3.SSx3.SSSx2.p1.3.m3.1.1.1.1.1.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.3.m3.1c">\alpha(0&lt;\alpha\leqslant 1)</annotation></semantics></math> of total available memory. The reserved memory allows for fine-grained model structural adjustments in the second stage, which potentially requires more experts. Solving for the binary variable <math id="Sx3.SSx3.SSSx2.p1.4.m4.4" class="ltx_Math" alttext="{x_{i,j}}\in\left\{{0,1}\right\}" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.4.m4.4a"><mrow id="Sx3.SSx3.SSSx2.p1.4.m4.4.5" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.cmml"><msub id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.cmml"><mi id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.2" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.2.cmml">x</mi><mrow id="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.4" xref="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.3.cmml"><mi id="Sx3.SSx3.SSSx2.p1.4.m4.1.1.1.1" xref="Sx3.SSx3.SSSx2.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.4.1" xref="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.2" xref="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.1" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.1.cmml">∈</mo><mrow id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.2" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.1.cmml"><mo id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.2.1" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.1.cmml">{</mo><mn id="Sx3.SSx3.SSSx2.p1.4.m4.3.3" xref="Sx3.SSx3.SSSx2.p1.4.m4.3.3.cmml">0</mn><mo id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.2.2" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="Sx3.SSx3.SSSx2.p1.4.m4.4.4" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.4.cmml">1</mn><mo id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.2.3" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.4.m4.4b"><apply id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5"><in id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.1.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.1"></in><apply id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2"><csymbol cd="ambiguous" id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.1.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2">subscript</csymbol><ci id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.2.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.2.2">𝑥</ci><list id="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.3.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.4"><ci id="Sx3.SSx3.SSSx2.p1.4.m4.1.1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.1.1.1.1">𝑖</ci><ci id="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.2.2.2.2">𝑗</ci></list></apply><set id="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.1.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.5.3.2"><cn type="integer" id="Sx3.SSx3.SSSx2.p1.4.m4.3.3.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.3.3">0</cn><cn type="integer" id="Sx3.SSx3.SSSx2.p1.4.m4.4.4.cmml" xref="Sx3.SSx3.SSSx2.p1.4.m4.4.4">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.4.m4.4c">{x_{i,j}}\in\left\{{0,1}\right\}</annotation></semantics></math> that indicates whether to retain the <math id="Sx3.SSx3.SSSx2.p1.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.5.m5.1a"><mi id="Sx3.SSx3.SSSx2.p1.5.m5.1.1" xref="Sx3.SSx3.SSSx2.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.5.m5.1b"><ci id="Sx3.SSx3.SSSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.5.m5.1c">j</annotation></semantics></math>-th expert in the <math id="Sx3.SSx3.SSSx2.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.6.m6.1a"><mi id="Sx3.SSx3.SSSx2.p1.6.m6.1.1" xref="Sx3.SSx3.SSSx2.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.6.m6.1b"><ci id="Sx3.SSx3.SSSx2.p1.6.m6.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.6.m6.1c">i</annotation></semantics></math>-th layer, the problem is formulated as:</p>
<table id="Sx6.EGx3" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.Ex2.m1.2" class="ltx_Math" alttext="\displaystyle\max_{x_{i,j}}\,\theta" display="block"><semantics id="Sx3.Ex2.m1.2a"><mrow id="Sx3.Ex2.m1.2.3" xref="Sx3.Ex2.m1.2.3.cmml"><munder id="Sx3.Ex2.m1.2.3.1" xref="Sx3.Ex2.m1.2.3.1.cmml"><mi id="Sx3.Ex2.m1.2.3.1.2" xref="Sx3.Ex2.m1.2.3.1.2.cmml">max</mi><msub id="Sx3.Ex2.m1.2.2.2" xref="Sx3.Ex2.m1.2.2.2.cmml"><mi id="Sx3.Ex2.m1.2.2.2.4" xref="Sx3.Ex2.m1.2.2.2.4.cmml">x</mi><mrow id="Sx3.Ex2.m1.2.2.2.2.2.4" xref="Sx3.Ex2.m1.2.2.2.2.2.3.cmml"><mi id="Sx3.Ex2.m1.1.1.1.1.1.1" xref="Sx3.Ex2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="Sx3.Ex2.m1.2.2.2.2.2.4.1" xref="Sx3.Ex2.m1.2.2.2.2.2.3.cmml">,</mo><mi id="Sx3.Ex2.m1.2.2.2.2.2.2" xref="Sx3.Ex2.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub></munder><mo lspace="0.337em" id="Sx3.Ex2.m1.2.3a" xref="Sx3.Ex2.m1.2.3.cmml">⁡</mo><mi id="Sx3.Ex2.m1.2.3.2" xref="Sx3.Ex2.m1.2.3.2.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex2.m1.2b"><apply id="Sx3.Ex2.m1.2.3.cmml" xref="Sx3.Ex2.m1.2.3"><apply id="Sx3.Ex2.m1.2.3.1.cmml" xref="Sx3.Ex2.m1.2.3.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.2.3.1.1.cmml" xref="Sx3.Ex2.m1.2.3.1">subscript</csymbol><max id="Sx3.Ex2.m1.2.3.1.2.cmml" xref="Sx3.Ex2.m1.2.3.1.2"></max><apply id="Sx3.Ex2.m1.2.2.2.cmml" xref="Sx3.Ex2.m1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.2.2.2.3.cmml" xref="Sx3.Ex2.m1.2.2.2">subscript</csymbol><ci id="Sx3.Ex2.m1.2.2.2.4.cmml" xref="Sx3.Ex2.m1.2.2.2.4">𝑥</ci><list id="Sx3.Ex2.m1.2.2.2.2.2.3.cmml" xref="Sx3.Ex2.m1.2.2.2.2.2.4"><ci id="Sx3.Ex2.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.1.1.1.1.1.1">𝑖</ci><ci id="Sx3.Ex2.m1.2.2.2.2.2.2.cmml" xref="Sx3.Ex2.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply><ci id="Sx3.Ex2.m1.2.3.2.cmml" xref="Sx3.Ex2.m1.2.3.2">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex2.m1.2c">\displaystyle\max_{x_{i,j}}\,\theta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Sx3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E5.m1.3" class="ltx_Math" alttext="\displaystyle\text{s.t.}\quad\left\{{\begin{array}[]{*{20}{c}}{\sum\limits_{j=1}^{{E_{i}}}{{x_{i,j}}{p_{i,j}}\geqslant\theta},\forall i=1,\ldots,L}\\
{\text{mem}\left({\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{x_{i,j}}{w_{i,j}}+{w_{d}}}}}\right)\leqslant\alpha\cdot M}\end{array}}\right." display="block"><semantics id="Sx3.E5.m1.3a"><mrow id="Sx3.E5.m1.3.3.1" xref="Sx3.E5.m1.3.3.2.cmml"><mtext id="Sx3.E5.m1.2.2" xref="Sx3.E5.m1.2.2a.cmml">s.t.</mtext><mspace width="1em" id="Sx3.E5.m1.3.3.1.2" xref="Sx3.E5.m1.3.3.2.cmml"></mspace><mrow id="Sx3.E5.m1.3.3.1.1.2" xref="Sx3.E5.m1.3.3.1.1.1.cmml"><mo id="Sx3.E5.m1.3.3.1.1.2.1" xref="Sx3.E5.m1.3.3.1.1.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="Sx3.E5.m1.1.1" xref="Sx3.E5.m1.1.1.cmml"><mtr id="Sx3.E5.m1.1.1a" xref="Sx3.E5.m1.1.1.cmml"><mtd id="Sx3.E5.m1.1.1b" xref="Sx3.E5.m1.1.1.cmml"><mrow id="Sx3.E3.9.9.9" xref="Sx3.E3.9.9.10.cmml"><mrow id="Sx3.E3.8.8.8.1" xref="Sx3.E3.8.8.8.1.cmml"><mrow id="Sx3.E3.8.8.8.1.2" xref="Sx3.E3.8.8.8.1.2.cmml"><mstyle displaystyle="false" id="Sx3.E3.8.8.8.1.2.1" xref="Sx3.E3.8.8.8.1.2.1.cmml"><munderover id="Sx3.E3.8.8.8.1.2.1a" xref="Sx3.E3.8.8.8.1.2.1.cmml"><mo movablelimits="false" id="Sx3.E3.8.8.8.1.2.1.2.2" xref="Sx3.E3.8.8.8.1.2.1.2.2.cmml">∑</mo><mrow id="Sx3.E3.8.8.8.1.2.1.2.3" xref="Sx3.E3.8.8.8.1.2.1.2.3.cmml"><mi id="Sx3.E3.8.8.8.1.2.1.2.3.2" xref="Sx3.E3.8.8.8.1.2.1.2.3.2.cmml">j</mi><mo id="Sx3.E3.8.8.8.1.2.1.2.3.1" xref="Sx3.E3.8.8.8.1.2.1.2.3.1.cmml">=</mo><mn id="Sx3.E3.8.8.8.1.2.1.2.3.3" xref="Sx3.E3.8.8.8.1.2.1.2.3.3.cmml">1</mn></mrow><msub id="Sx3.E3.8.8.8.1.2.1.3" xref="Sx3.E3.8.8.8.1.2.1.3.cmml"><mi id="Sx3.E3.8.8.8.1.2.1.3.2" xref="Sx3.E3.8.8.8.1.2.1.3.2.cmml">E</mi><mi id="Sx3.E3.8.8.8.1.2.1.3.3" xref="Sx3.E3.8.8.8.1.2.1.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="Sx3.E3.8.8.8.1.2.2" xref="Sx3.E3.8.8.8.1.2.2.cmml"><msub id="Sx3.E3.8.8.8.1.2.2.2" xref="Sx3.E3.8.8.8.1.2.2.2.cmml"><mi id="Sx3.E3.8.8.8.1.2.2.2.2" xref="Sx3.E3.8.8.8.1.2.2.2.2.cmml">x</mi><mrow id="Sx3.E3.2.2.2.2.4" xref="Sx3.E3.2.2.2.2.3.cmml"><mi id="Sx3.E3.1.1.1.1.1" xref="Sx3.E3.1.1.1.1.1.cmml">i</mi><mo id="Sx3.E3.2.2.2.2.4.1" xref="Sx3.E3.2.2.2.2.3.cmml">,</mo><mi id="Sx3.E3.2.2.2.2.2" xref="Sx3.E3.2.2.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.8.8.8.1.2.2.1" xref="Sx3.E3.8.8.8.1.2.2.1.cmml">​</mo><msub id="Sx3.E3.8.8.8.1.2.2.3" xref="Sx3.E3.8.8.8.1.2.2.3.cmml"><mi id="Sx3.E3.8.8.8.1.2.2.3.2" xref="Sx3.E3.8.8.8.1.2.2.3.2.cmml">p</mi><mrow id="Sx3.E3.4.4.4.2.4" xref="Sx3.E3.4.4.4.2.3.cmml"><mi id="Sx3.E3.3.3.3.1.1" xref="Sx3.E3.3.3.3.1.1.cmml">i</mi><mo id="Sx3.E3.4.4.4.2.4.1" xref="Sx3.E3.4.4.4.2.3.cmml">,</mo><mi id="Sx3.E3.4.4.4.2.2" xref="Sx3.E3.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><mo id="Sx3.E3.8.8.8.1.1" xref="Sx3.E3.8.8.8.1.1.cmml">⩾</mo><mi id="Sx3.E3.8.8.8.1.3" xref="Sx3.E3.8.8.8.1.3.cmml">θ</mi></mrow><mo id="Sx3.E3.9.9.9.3" xref="Sx3.E3.9.9.10a.cmml">,</mo><mrow id="Sx3.E3.9.9.9.2" xref="Sx3.E3.9.9.9.2.cmml"><mrow id="Sx3.E3.9.9.9.2.2" xref="Sx3.E3.9.9.9.2.2.cmml"><mo rspace="0.167em" id="Sx3.E3.9.9.9.2.2.1" xref="Sx3.E3.9.9.9.2.2.1.cmml">∀</mo><mi id="Sx3.E3.9.9.9.2.2.2" xref="Sx3.E3.9.9.9.2.2.2.cmml">i</mi></mrow><mo id="Sx3.E3.9.9.9.2.1" xref="Sx3.E3.9.9.9.2.1.cmml">=</mo><mrow id="Sx3.E3.9.9.9.2.3.2" xref="Sx3.E3.9.9.9.2.3.1.cmml"><mn id="Sx3.E3.5.5.5" xref="Sx3.E3.5.5.5.cmml">1</mn><mo id="Sx3.E3.9.9.9.2.3.2.1" xref="Sx3.E3.9.9.9.2.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.E3.6.6.6" xref="Sx3.E3.6.6.6.cmml">…</mi><mo id="Sx3.E3.9.9.9.2.3.2.2" xref="Sx3.E3.9.9.9.2.3.1.cmml">,</mo><mi id="Sx3.E3.7.7.7" xref="Sx3.E3.7.7.7.cmml">L</mi></mrow></mrow></mrow></mtd><mtd id="Sx3.E5.m1.1.1c" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1d" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1e" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1f" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1g" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1h" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1i" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1j" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1k" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1l" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1m" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1n" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1o" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1p" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1q" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1r" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1s" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1t" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1u" xref="Sx3.E5.m1.1.1.cmml"></mtd></mtr><mtr id="Sx3.E5.m1.1.1v" xref="Sx3.E5.m1.1.1.cmml"><mtd id="Sx3.E5.m1.1.1w" xref="Sx3.E5.m1.1.1.cmml"><mrow id="Sx3.E4.5.5" xref="Sx3.E4.5.5.cmml"><mrow id="Sx3.E4.5.5.5" xref="Sx3.E4.5.5.5.cmml"><mtext id="Sx3.E4.5.5.5.3" xref="Sx3.E4.5.5.5.3a.cmml">mem</mtext><mo lspace="0em" rspace="0em" id="Sx3.E4.5.5.5.2" xref="Sx3.E4.5.5.5.2.cmml">​</mo><mrow id="Sx3.E4.5.5.5.1.1" xref="Sx3.E4.5.5.5.1.1.1.cmml"><mo id="Sx3.E4.5.5.5.1.1.2" xref="Sx3.E4.5.5.5.1.1.1.cmml">(</mo><mrow id="Sx3.E4.5.5.5.1.1.1" xref="Sx3.E4.5.5.5.1.1.1.cmml"><mrow id="Sx3.E4.5.5.5.1.1.1.2" xref="Sx3.E4.5.5.5.1.1.1.2.cmml"><mstyle displaystyle="false" id="Sx3.E4.5.5.5.1.1.1.2.1" xref="Sx3.E4.5.5.5.1.1.1.2.1.cmml"><munderover id="Sx3.E4.5.5.5.1.1.1.2.1a" xref="Sx3.E4.5.5.5.1.1.1.2.1.cmml"><mo movablelimits="false" id="Sx3.E4.5.5.5.1.1.1.2.1.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="Sx3.E4.5.5.5.1.1.1.2.1.2.3" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.2" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.2.cmml">i</mi><mo id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.1" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.3" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E4.5.5.5.1.1.1.2.1.3" xref="Sx3.E4.5.5.5.1.1.1.2.1.3.cmml">L</mi></munderover></mstyle><mrow id="Sx3.E4.5.5.5.1.1.1.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.cmml"><mstyle displaystyle="false" id="Sx3.E4.5.5.5.1.1.1.2.2.1" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.cmml"><munderover id="Sx3.E4.5.5.5.1.1.1.2.2.1a" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.cmml"><mo movablelimits="false" id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.2.cmml">j</mi><mo id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.1" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.1.cmml">=</mo><mn id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.3" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.3.cmml">1</mn></mrow><msub id="Sx3.E4.5.5.5.1.1.1.2.2.1.3" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3.2.cmml">E</mi><mi id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.3" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="Sx3.E4.5.5.5.1.1.1.2.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.cmml"><msub id="Sx3.E4.5.5.5.1.1.1.2.2.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.2.2.2.2.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.2.2.cmml">x</mi><mrow id="Sx3.E4.2.2.2.2.4" xref="Sx3.E4.2.2.2.2.3.cmml"><mi id="Sx3.E4.1.1.1.1.1" xref="Sx3.E4.1.1.1.1.1.cmml">i</mi><mo id="Sx3.E4.2.2.2.2.4.1" xref="Sx3.E4.2.2.2.2.3.cmml">,</mo><mi id="Sx3.E4.2.2.2.2.2" xref="Sx3.E4.2.2.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E4.5.5.5.1.1.1.2.2.2.1" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.1.cmml">​</mo><msub id="Sx3.E4.5.5.5.1.1.1.2.2.2.3" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.3.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.2.2.2.3.2" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.3.2.cmml">w</mi><mrow id="Sx3.E4.4.4.4.2.4" xref="Sx3.E4.4.4.4.2.3.cmml"><mi id="Sx3.E4.3.3.3.1.1" xref="Sx3.E4.3.3.3.1.1.cmml">i</mi><mo id="Sx3.E4.4.4.4.2.4.1" xref="Sx3.E4.4.4.4.2.3.cmml">,</mo><mi id="Sx3.E4.4.4.4.2.2" xref="Sx3.E4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="Sx3.E4.5.5.5.1.1.1.1" xref="Sx3.E4.5.5.5.1.1.1.1.cmml">+</mo><msub id="Sx3.E4.5.5.5.1.1.1.3" xref="Sx3.E4.5.5.5.1.1.1.3.cmml"><mi id="Sx3.E4.5.5.5.1.1.1.3.2" xref="Sx3.E4.5.5.5.1.1.1.3.2.cmml">w</mi><mi id="Sx3.E4.5.5.5.1.1.1.3.3" xref="Sx3.E4.5.5.5.1.1.1.3.3.cmml">d</mi></msub></mrow><mo id="Sx3.E4.5.5.5.1.1.3" xref="Sx3.E4.5.5.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E4.5.5.6" xref="Sx3.E4.5.5.6.cmml">⩽</mo><mrow id="Sx3.E4.5.5.7" xref="Sx3.E4.5.5.7.cmml"><mi id="Sx3.E4.5.5.7.2" xref="Sx3.E4.5.5.7.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.E4.5.5.7.1" xref="Sx3.E4.5.5.7.1.cmml">⋅</mo><mi id="Sx3.E4.5.5.7.3" xref="Sx3.E4.5.5.7.3.cmml">M</mi></mrow></mrow></mtd><mtd id="Sx3.E5.m1.1.1x" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1y" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1z" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1aa" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ab" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ac" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ad" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ae" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1af" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ag" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ah" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ai" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1aj" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ak" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1al" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1am" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1an" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ao" xref="Sx3.E5.m1.1.1.cmml"></mtd><mtd id="Sx3.E5.m1.1.1ap" xref="Sx3.E5.m1.1.1.cmml"></mtd></mtr></mtable><mi id="Sx3.E5.m1.3.3.1.1.2.2" xref="Sx3.E5.m1.3.3.1.1.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.3b"><list id="Sx3.E5.m1.3.3.2.cmml" xref="Sx3.E5.m1.3.3.1"><ci id="Sx3.E5.m1.2.2a.cmml" xref="Sx3.E5.m1.2.2"><mtext id="Sx3.E5.m1.2.2.cmml" xref="Sx3.E5.m1.2.2">s.t.</mtext></ci><apply id="Sx3.E5.m1.3.3.1.1.1.cmml" xref="Sx3.E5.m1.3.3.1.1.2"><csymbol cd="latexml" id="Sx3.E5.m1.3.3.1.1.1.1.cmml" xref="Sx3.E5.m1.3.3.1.1.2.1">cases</csymbol><matrix id="Sx3.E5.m1.1.1.cmml" xref="Sx3.E5.m1.1.1"><matrixrow id="Sx3.E5.m1.1.1a.cmml" xref="Sx3.E5.m1.1.1"><apply id="Sx3.E3.9.9.10.cmml" xref="Sx3.E3.9.9.9"><csymbol cd="ambiguous" id="Sx3.E3.9.9.10a.cmml" xref="Sx3.E3.9.9.9.3">formulae-sequence</csymbol><apply id="Sx3.E3.8.8.8.1.cmml" xref="Sx3.E3.8.8.8.1"><geq id="Sx3.E3.8.8.8.1.1.cmml" xref="Sx3.E3.8.8.8.1.1"></geq><apply id="Sx3.E3.8.8.8.1.2.cmml" xref="Sx3.E3.8.8.8.1.2"><apply id="Sx3.E3.8.8.8.1.2.1.cmml" xref="Sx3.E3.8.8.8.1.2.1"><csymbol cd="ambiguous" id="Sx3.E3.8.8.8.1.2.1.1.cmml" xref="Sx3.E3.8.8.8.1.2.1">superscript</csymbol><apply id="Sx3.E3.8.8.8.1.2.1.2.cmml" xref="Sx3.E3.8.8.8.1.2.1"><csymbol cd="ambiguous" id="Sx3.E3.8.8.8.1.2.1.2.1.cmml" xref="Sx3.E3.8.8.8.1.2.1">subscript</csymbol><sum id="Sx3.E3.8.8.8.1.2.1.2.2.cmml" xref="Sx3.E3.8.8.8.1.2.1.2.2"></sum><apply id="Sx3.E3.8.8.8.1.2.1.2.3.cmml" xref="Sx3.E3.8.8.8.1.2.1.2.3"><eq id="Sx3.E3.8.8.8.1.2.1.2.3.1.cmml" xref="Sx3.E3.8.8.8.1.2.1.2.3.1"></eq><ci id="Sx3.E3.8.8.8.1.2.1.2.3.2.cmml" xref="Sx3.E3.8.8.8.1.2.1.2.3.2">𝑗</ci><cn type="integer" id="Sx3.E3.8.8.8.1.2.1.2.3.3.cmml" xref="Sx3.E3.8.8.8.1.2.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E3.8.8.8.1.2.1.3.cmml" xref="Sx3.E3.8.8.8.1.2.1.3"><csymbol cd="ambiguous" id="Sx3.E3.8.8.8.1.2.1.3.1.cmml" xref="Sx3.E3.8.8.8.1.2.1.3">subscript</csymbol><ci id="Sx3.E3.8.8.8.1.2.1.3.2.cmml" xref="Sx3.E3.8.8.8.1.2.1.3.2">𝐸</ci><ci id="Sx3.E3.8.8.8.1.2.1.3.3.cmml" xref="Sx3.E3.8.8.8.1.2.1.3.3">𝑖</ci></apply></apply><apply id="Sx3.E3.8.8.8.1.2.2.cmml" xref="Sx3.E3.8.8.8.1.2.2"><times id="Sx3.E3.8.8.8.1.2.2.1.cmml" xref="Sx3.E3.8.8.8.1.2.2.1"></times><apply id="Sx3.E3.8.8.8.1.2.2.2.cmml" xref="Sx3.E3.8.8.8.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E3.8.8.8.1.2.2.2.1.cmml" xref="Sx3.E3.8.8.8.1.2.2.2">subscript</csymbol><ci id="Sx3.E3.8.8.8.1.2.2.2.2.cmml" xref="Sx3.E3.8.8.8.1.2.2.2.2">𝑥</ci><list id="Sx3.E3.2.2.2.2.3.cmml" xref="Sx3.E3.2.2.2.2.4"><ci id="Sx3.E3.1.1.1.1.1.cmml" xref="Sx3.E3.1.1.1.1.1">𝑖</ci><ci id="Sx3.E3.2.2.2.2.2.cmml" xref="Sx3.E3.2.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E3.8.8.8.1.2.2.3.cmml" xref="Sx3.E3.8.8.8.1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E3.8.8.8.1.2.2.3.1.cmml" xref="Sx3.E3.8.8.8.1.2.2.3">subscript</csymbol><ci id="Sx3.E3.8.8.8.1.2.2.3.2.cmml" xref="Sx3.E3.8.8.8.1.2.2.3.2">𝑝</ci><list id="Sx3.E3.4.4.4.2.3.cmml" xref="Sx3.E3.4.4.4.2.4"><ci id="Sx3.E3.3.3.3.1.1.cmml" xref="Sx3.E3.3.3.3.1.1">𝑖</ci><ci id="Sx3.E3.4.4.4.2.2.cmml" xref="Sx3.E3.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><ci id="Sx3.E3.8.8.8.1.3.cmml" xref="Sx3.E3.8.8.8.1.3">𝜃</ci></apply><apply id="Sx3.E3.9.9.9.2.cmml" xref="Sx3.E3.9.9.9.2"><eq id="Sx3.E3.9.9.9.2.1.cmml" xref="Sx3.E3.9.9.9.2.1"></eq><apply id="Sx3.E3.9.9.9.2.2.cmml" xref="Sx3.E3.9.9.9.2.2"><csymbol cd="latexml" id="Sx3.E3.9.9.9.2.2.1.cmml" xref="Sx3.E3.9.9.9.2.2.1">for-all</csymbol><ci id="Sx3.E3.9.9.9.2.2.2.cmml" xref="Sx3.E3.9.9.9.2.2.2">𝑖</ci></apply><list id="Sx3.E3.9.9.9.2.3.1.cmml" xref="Sx3.E3.9.9.9.2.3.2"><cn type="integer" id="Sx3.E3.5.5.5.cmml" xref="Sx3.E3.5.5.5">1</cn><ci id="Sx3.E3.6.6.6.cmml" xref="Sx3.E3.6.6.6">…</ci><ci id="Sx3.E3.7.7.7.cmml" xref="Sx3.E3.7.7.7">𝐿</ci></list></apply></apply><cerror id="Sx3.E5.m1.1.1b.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1c.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1d.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1e.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1f.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1g.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1h.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1i.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1j.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1k.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1l.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1m.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1n.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1o.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1p.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1q.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1r.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1s.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1t.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1u.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1v.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1w.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1x.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1y.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1z.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1aa.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1ab.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ac.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1ad.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ae.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1af.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ag.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1ah.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ai.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1aj.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ak.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1al.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1am.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="Sx3.E5.m1.1.1an.cmml" xref="Sx3.E5.m1.1.1"><apply id="Sx3.E4.5.5.cmml" xref="Sx3.E4.5.5"><leq id="Sx3.E4.5.5.6.cmml" xref="Sx3.E4.5.5.6"></leq><apply id="Sx3.E4.5.5.5.cmml" xref="Sx3.E4.5.5.5"><times id="Sx3.E4.5.5.5.2.cmml" xref="Sx3.E4.5.5.5.2"></times><ci id="Sx3.E4.5.5.5.3a.cmml" xref="Sx3.E4.5.5.5.3"><mtext id="Sx3.E4.5.5.5.3.cmml" xref="Sx3.E4.5.5.5.3">mem</mtext></ci><apply id="Sx3.E4.5.5.5.1.1.1.cmml" xref="Sx3.E4.5.5.5.1.1"><plus id="Sx3.E4.5.5.5.1.1.1.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.1"></plus><apply id="Sx3.E4.5.5.5.1.1.1.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2"><apply id="Sx3.E4.5.5.5.1.1.1.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.1.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1">superscript</csymbol><apply id="Sx3.E4.5.5.5.1.1.1.2.1.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.1.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1">subscript</csymbol><sum id="Sx3.E4.5.5.5.1.1.1.2.1.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.2"></sum><apply id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3"><eq id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.1"></eq><ci id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E4.5.5.5.1.1.1.2.1.2.3.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="Sx3.E4.5.5.5.1.1.1.2.1.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.1.3">𝐿</ci></apply><apply id="Sx3.E4.5.5.5.1.1.1.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2"><apply id="Sx3.E4.5.5.5.1.1.1.2.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.2.1.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1">superscript</csymbol><apply id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1">subscript</csymbol><sum id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.2"></sum><apply id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3"><eq id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.1"></eq><ci id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.2">𝑗</ci><cn type="integer" id="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3">subscript</csymbol><ci id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3.2">𝐸</ci><ci id="Sx3.E4.5.5.5.1.1.1.2.2.1.3.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.1.3.3">𝑖</ci></apply></apply><apply id="Sx3.E4.5.5.5.1.1.1.2.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2"><times id="Sx3.E4.5.5.5.1.1.1.2.2.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.1"></times><apply id="Sx3.E4.5.5.5.1.1.1.2.2.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E4.5.5.5.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.2.2">𝑥</ci><list id="Sx3.E4.2.2.2.2.3.cmml" xref="Sx3.E4.2.2.2.2.4"><ci id="Sx3.E4.1.1.1.1.1.cmml" xref="Sx3.E4.1.1.1.1.1">𝑖</ci><ci id="Sx3.E4.2.2.2.2.2.cmml" xref="Sx3.E4.2.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E4.5.5.5.1.1.1.2.2.2.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.2.2.2.3.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.3">subscript</csymbol><ci id="Sx3.E4.5.5.5.1.1.1.2.2.2.3.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.2.2.2.3.2">𝑤</ci><list id="Sx3.E4.4.4.4.2.3.cmml" xref="Sx3.E4.4.4.4.2.4"><ci id="Sx3.E4.3.3.3.1.1.cmml" xref="Sx3.E4.3.3.3.1.1">𝑖</ci><ci id="Sx3.E4.4.4.4.2.2.cmml" xref="Sx3.E4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply><apply id="Sx3.E4.5.5.5.1.1.1.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.5.5.5.1.1.1.3.1.cmml" xref="Sx3.E4.5.5.5.1.1.1.3">subscript</csymbol><ci id="Sx3.E4.5.5.5.1.1.1.3.2.cmml" xref="Sx3.E4.5.5.5.1.1.1.3.2">𝑤</ci><ci id="Sx3.E4.5.5.5.1.1.1.3.3.cmml" xref="Sx3.E4.5.5.5.1.1.1.3.3">𝑑</ci></apply></apply></apply><apply id="Sx3.E4.5.5.7.cmml" xref="Sx3.E4.5.5.7"><ci id="Sx3.E4.5.5.7.1.cmml" xref="Sx3.E4.5.5.7.1">⋅</ci><ci id="Sx3.E4.5.5.7.2.cmml" xref="Sx3.E4.5.5.7.2">𝛼</ci><ci id="Sx3.E4.5.5.7.3.cmml" xref="Sx3.E4.5.5.7.3">𝑀</ci></apply></apply><cerror id="Sx3.E5.m1.1.1ao.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ap.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1aq.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ar.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1as.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1at.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1au.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1av.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1aw.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1ax.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1ay.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1az.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1ba.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bb.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bc.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bd.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1be.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bf.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bg.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bh.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bi.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bj.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bk.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bl.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bm.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bn.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bo.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bp.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bq.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1br.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bs.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bt.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bu.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bv.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1bw.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bx.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror><cerror id="Sx3.E5.m1.1.1by.cmml" xref="Sx3.E5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1bz.cmml" xref="Sx3.E5.m1.1.1">missing-subexpression</csymbol></cerror></matrixrow></matrix></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.3c">\displaystyle\text{s.t.}\quad\left\{{\begin{array}[]{*{20}{c}}{\sum\limits_{j=1}^{{E_{i}}}{{x_{i,j}}{p_{i,j}}\geqslant\theta},\forall i=1,\ldots,L}\\
{\text{mem}\left({\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{x_{i,j}}{w_{i,j}}+{w_{d}}}}}\right)\leqslant\alpha\cdot M}\end{array}}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.SSSx2.p1.10" class="ltx_p">Since solving the NP-hard multi-dimensional knapsack problem directly is computationally prohibitive, we instead employ a heuristic algorithm based on binary search.
In practice, the cloud searches for the optimal threshold <math id="Sx3.SSx3.SSSx2.p1.7.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.7.m1.1a"><mi id="Sx3.SSx3.SSSx2.p1.7.m1.1.1" xref="Sx3.SSx3.SSSx2.p1.7.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.7.m1.1b"><ci id="Sx3.SSx3.SSSx2.p1.7.m1.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.7.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.7.m1.1c">\theta</annotation></semantics></math> within the range of <math id="Sx3.SSx3.SSSx2.p1.8.m2.2" class="ltx_Math" alttext="\left[{0,1}\right]" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.8.m2.2a"><mrow id="Sx3.SSx3.SSSx2.p1.8.m2.2.3.2" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.3.1.cmml"><mo id="Sx3.SSx3.SSSx2.p1.8.m2.2.3.2.1" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.3.1.cmml">[</mo><mn id="Sx3.SSx3.SSSx2.p1.8.m2.1.1" xref="Sx3.SSx3.SSSx2.p1.8.m2.1.1.cmml">0</mn><mo id="Sx3.SSx3.SSSx2.p1.8.m2.2.3.2.2" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.3.1.cmml">,</mo><mn id="Sx3.SSx3.SSSx2.p1.8.m2.2.2" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.2.cmml">1</mn><mo id="Sx3.SSx3.SSSx2.p1.8.m2.2.3.2.3" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.8.m2.2b"><interval closure="closed" id="Sx3.SSx3.SSSx2.p1.8.m2.2.3.1.cmml" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.3.2"><cn type="integer" id="Sx3.SSx3.SSSx2.p1.8.m2.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.8.m2.1.1">0</cn><cn type="integer" id="Sx3.SSx3.SSSx2.p1.8.m2.2.2.cmml" xref="Sx3.SSx3.SSSx2.p1.8.m2.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.8.m2.2c">\left[{0,1}\right]</annotation></semantics></math> by gradually adjusting the bounds of feasible region. For a given threshold, <span id="Sx3.SSx3.SSSx2.p1.10.1" class="ltx_text ltx_font_typewriter">FedMoE</span> attempts to construct a smallest submodel with respect to the threshold and verify whether it exceeds the memory limit.
If not exceed, the lower bound of <math id="Sx3.SSx3.SSSx2.p1.9.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.9.m3.1a"><mi id="Sx3.SSx3.SSSx2.p1.9.m3.1.1" xref="Sx3.SSx3.SSSx2.p1.9.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.9.m3.1b"><ci id="Sx3.SSx3.SSSx2.p1.9.m3.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.9.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.9.m3.1c">\theta</annotation></semantics></math> is adjusted upward to find a more effective submodel; otherwise, the upper bound of <math id="Sx3.SSx3.SSSx2.p1.10.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.SSx3.SSSx2.p1.10.m4.1a"><mi id="Sx3.SSx3.SSSx2.p1.10.m4.1.1" xref="Sx3.SSx3.SSSx2.p1.10.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.SSSx2.p1.10.m4.1b"><ci id="Sx3.SSx3.SSSx2.p1.10.m4.1.1.cmml" xref="Sx3.SSx3.SSSx2.p1.10.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.SSSx2.p1.10.m4.1c">\theta</annotation></semantics></math> is adjusted downward to alleviate memory consumption. The efficient search initializes the client-expert map in the cloud, achieving an ideal balance between memory usage and performance.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated training and submodel adjustments in the second stage.</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l1.m1.3" class="ltx_Math" alttext="r=1,\ldots,R" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mi id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml">r</mi><mo id="alg1.l1.m1.3.4.1" xref="alg1.l1.m1.3.4.1.cmml">=</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">1</mn><mo id="alg1.l1.m1.3.4.3.2.1" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">…</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><eq id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1"></eq><ci id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2">𝑟</ci><list id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">1</cn><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">…</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">r=1,\ldots,R</annotation></semantics></math> <span id="alg1.l1.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>     <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\mathcal{S}\leftarrow" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝒮</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝒮</ci><csymbol cd="latexml" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{S}\leftarrow</annotation></semantics></math> sample subset of clients <math id="alg1.l2.m2.3" class="ltx_Math" alttext="\mathcal{U}=\{u_{1},\ldots,u_{n}\}" display="inline"><semantics id="alg1.l2.m2.3a"><mrow id="alg1.l2.m2.3.3" xref="alg1.l2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.3.3.4" xref="alg1.l2.m2.3.3.4.cmml">𝒰</mi><mo id="alg1.l2.m2.3.3.3" xref="alg1.l2.m2.3.3.3.cmml">=</mo><mrow id="alg1.l2.m2.3.3.2.2" xref="alg1.l2.m2.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l2.m2.3.3.2.2.3" xref="alg1.l2.m2.3.3.2.3.cmml">{</mo><msub id="alg1.l2.m2.2.2.1.1.1" xref="alg1.l2.m2.2.2.1.1.1.cmml"><mi id="alg1.l2.m2.2.2.1.1.1.2" xref="alg1.l2.m2.2.2.1.1.1.2.cmml">u</mi><mn id="alg1.l2.m2.2.2.1.1.1.3" xref="alg1.l2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l2.m2.3.3.2.2.4" xref="alg1.l2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">…</mi><mo id="alg1.l2.m2.3.3.2.2.5" xref="alg1.l2.m2.3.3.2.3.cmml">,</mo><msub id="alg1.l2.m2.3.3.2.2.2" xref="alg1.l2.m2.3.3.2.2.2.cmml"><mi id="alg1.l2.m2.3.3.2.2.2.2" xref="alg1.l2.m2.3.3.2.2.2.2.cmml">u</mi><mi id="alg1.l2.m2.3.3.2.2.2.3" xref="alg1.l2.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="alg1.l2.m2.3.3.2.2.6" xref="alg1.l2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.3b"><apply id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3"><eq id="alg1.l2.m2.3.3.3.cmml" xref="alg1.l2.m2.3.3.3"></eq><ci id="alg1.l2.m2.3.3.4.cmml" xref="alg1.l2.m2.3.3.4">𝒰</ci><set id="alg1.l2.m2.3.3.2.3.cmml" xref="alg1.l2.m2.3.3.2.2"><apply id="alg1.l2.m2.2.2.1.1.1.cmml" xref="alg1.l2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.2.2.1.1.1.1.cmml" xref="alg1.l2.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l2.m2.2.2.1.1.1.2.cmml" xref="alg1.l2.m2.2.2.1.1.1.2">𝑢</ci><cn type="integer" id="alg1.l2.m2.2.2.1.1.1.3.cmml" xref="alg1.l2.m2.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">…</ci><apply id="alg1.l2.m2.3.3.2.2.2.cmml" xref="alg1.l2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m2.3.3.2.2.2.1.cmml" xref="alg1.l2.m2.3.3.2.2.2">subscript</csymbol><ci id="alg1.l2.m2.3.3.2.2.2.2.cmml" xref="alg1.l2.m2.3.3.2.2.2.2">𝑢</ci><ci id="alg1.l2.m2.3.3.2.2.2.3.cmml" xref="alg1.l2.m2.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.3c">\mathcal{U}=\{u_{1},\ldots,u_{n}\}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     Construct and send <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">w</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑤</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w_{k}</annotation></semantics></math> to each <math id="alg1.l3.m2.1" class="ltx_Math" alttext="u_{k}\in\mathcal{S}" display="inline"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><msub id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml"><mi id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">u</mi><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l3.m2.1.1.1" xref="alg1.l3.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><in id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1"></in><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.2">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝑢</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">𝑘</ci></apply><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">u_{k}\in\mathcal{S}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l4.m1.1" class="ltx_Math" alttext="u_{k}\in\mathcal{S}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">u</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑢</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">u_{k}\in\mathcal{S}</annotation></semantics></math> in parallel <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math id="alg1.l5.m1.2" class="ltx_Math" alttext="w_{k}^{*}\leftarrow\textsc{train}(w_{k},\mathcal{D}_{k}^{\text{train}})" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msubsup id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml"><mi id="alg1.l5.m1.2.2.4.2.2" xref="alg1.l5.m1.2.2.4.2.2.cmml">w</mi><mi id="alg1.l5.m1.2.2.4.2.3" xref="alg1.l5.m1.2.2.4.2.3.cmml">k</mi><mo id="alg1.l5.m1.2.2.4.3" xref="alg1.l5.m1.2.2.4.3.cmml">∗</mo></msubsup><mo stretchy="false" id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">←</mo><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.4a.cmml">train</mtext><mo lspace="0em" rspace="0em" id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l5.m1.2.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.2.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l5.m1.2.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml">k</mi><mtext id="alg1.l5.m1.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.3a.cmml">train</mtext></msubsup><mo stretchy="false" id="alg1.l5.m1.2.2.2.2.2.5" xref="alg1.l5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">←</ci><apply id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.4">superscript</csymbol><apply id="alg1.l5.m1.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.2.1.cmml" xref="alg1.l5.m1.2.2.4">subscript</csymbol><ci id="alg1.l5.m1.2.2.4.2.2.cmml" xref="alg1.l5.m1.2.2.4.2.2">𝑤</ci><ci id="alg1.l5.m1.2.2.4.2.3.cmml" xref="alg1.l5.m1.2.2.4.2.3">𝑘</ci></apply><times id="alg1.l5.m1.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.4.3"></times></apply><apply id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"><times id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.3"></times><ci id="alg1.l5.m1.2.2.2.4a.cmml" xref="alg1.l5.m1.2.2.2.4"><mtext class="ltx_font_smallcaps" id="alg1.l5.m1.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.4">train</mtext></ci><interval closure="open" id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.2">𝒟</ci><ci id="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l5.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="alg1.l5.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.3">train</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">w_{k}^{*}\leftarrow\textsc{train}(w_{k},\mathcal{D}_{k}^{\text{train}})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>        <math id="alg1.l6.m1.4" class="ltx_Math" alttext="p_{\text{all\_experts}},\mathit{acc}\leftarrow\textsc{validate}(w_{k}^{*},\mathcal{D}_{k}^{\text{val}})" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mrow id="alg1.l6.m1.2.2.1.1" xref="alg1.l6.m1.2.2.1.2.cmml"><msub id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.2.cmml">p</mi><mtext id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3a.cmml">all_experts</mtext></msub><mo id="alg1.l6.m1.2.2.1.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">,</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">𝑎𝑐𝑐</mi></mrow><mo stretchy="false" id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml">←</mo><mrow id="alg1.l6.m1.4.4.3" xref="alg1.l6.m1.4.4.3.cmml"><mtext class="ltx_font_smallcaps" id="alg1.l6.m1.4.4.3.4" xref="alg1.l6.m1.4.4.3.4a.cmml">validate</mtext><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.3" xref="alg1.l6.m1.4.4.3.3.cmml">​</mo><mrow id="alg1.l6.m1.4.4.3.2.2" xref="alg1.l6.m1.4.4.3.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.4.4.3.2.2.3" xref="alg1.l6.m1.4.4.3.2.3.cmml">(</mo><msubsup id="alg1.l6.m1.3.3.2.1.1.1" xref="alg1.l6.m1.3.3.2.1.1.1.cmml"><mi id="alg1.l6.m1.3.3.2.1.1.1.2.2" xref="alg1.l6.m1.3.3.2.1.1.1.2.2.cmml">w</mi><mi id="alg1.l6.m1.3.3.2.1.1.1.2.3" xref="alg1.l6.m1.3.3.2.1.1.1.2.3.cmml">k</mi><mo id="alg1.l6.m1.3.3.2.1.1.1.3" xref="alg1.l6.m1.3.3.2.1.1.1.3.cmml">∗</mo></msubsup><mo id="alg1.l6.m1.4.4.3.2.2.4" xref="alg1.l6.m1.4.4.3.2.3.cmml">,</mo><msubsup id="alg1.l6.m1.4.4.3.2.2.2" xref="alg1.l6.m1.4.4.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.4.4.3.2.2.2.2.2" xref="alg1.l6.m1.4.4.3.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l6.m1.4.4.3.2.2.2.2.3" xref="alg1.l6.m1.4.4.3.2.2.2.2.3.cmml">k</mi><mtext id="alg1.l6.m1.4.4.3.2.2.2.3" xref="alg1.l6.m1.4.4.3.2.2.2.3a.cmml">val</mtext></msubsup><mo stretchy="false" id="alg1.l6.m1.4.4.3.2.2.5" xref="alg1.l6.m1.4.4.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><ci id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4">←</ci><list id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.1"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2">𝑝</ci><ci id="alg1.l6.m1.2.2.1.1.1.3a.cmml" xref="alg1.l6.m1.2.2.1.1.1.3"><mtext mathsize="70%" id="alg1.l6.m1.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3">all_experts</mtext></ci></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑎𝑐𝑐</ci></list><apply id="alg1.l6.m1.4.4.3.cmml" xref="alg1.l6.m1.4.4.3"><times id="alg1.l6.m1.4.4.3.3.cmml" xref="alg1.l6.m1.4.4.3.3"></times><ci id="alg1.l6.m1.4.4.3.4a.cmml" xref="alg1.l6.m1.4.4.3.4"><mtext class="ltx_font_smallcaps" id="alg1.l6.m1.4.4.3.4.cmml" xref="alg1.l6.m1.4.4.3.4">validate</mtext></ci><interval closure="open" id="alg1.l6.m1.4.4.3.2.3.cmml" xref="alg1.l6.m1.4.4.3.2.2"><apply id="alg1.l6.m1.3.3.2.1.1.1.cmml" xref="alg1.l6.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.2.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.3.3.2.1.1.1.2.cmml" xref="alg1.l6.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.1.1.1.2.1.cmml" xref="alg1.l6.m1.3.3.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.3.3.2.1.1.1.2.2.cmml" xref="alg1.l6.m1.3.3.2.1.1.1.2.2">𝑤</ci><ci id="alg1.l6.m1.3.3.2.1.1.1.2.3.cmml" xref="alg1.l6.m1.3.3.2.1.1.1.2.3">𝑘</ci></apply><times id="alg1.l6.m1.3.3.2.1.1.1.3.cmml" xref="alg1.l6.m1.3.3.2.1.1.1.3"></times></apply><apply id="alg1.l6.m1.4.4.3.2.2.2.cmml" xref="alg1.l6.m1.4.4.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.3.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.4.4.3.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.3.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.4.4.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.3.2.2.2.2.2">𝒟</ci><ci id="alg1.l6.m1.4.4.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.4.4.3.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.4.4.3.2.2.2.3a.cmml" xref="alg1.l6.m1.4.4.3.2.2.2.3"><mtext mathsize="70%" id="alg1.l6.m1.4.4.3.2.2.2.3.cmml" xref="alg1.l6.m1.4.4.3.2.2.2.3">val</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">p_{\text{all\_experts}},\mathit{acc}\leftarrow\textsc{validate}(w_{k}^{*},\mathcal{D}_{k}^{\text{val}})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>        send <math id="alg1.l7.m1.3" class="ltx_Math" alttext="w_{k}^{*},p_{\text{all\_experts}},\mathrm{acc}" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3.2" xref="alg1.l7.m1.3.3.3.cmml"><msubsup id="alg1.l7.m1.2.2.1.1" xref="alg1.l7.m1.2.2.1.1.cmml"><mi id="alg1.l7.m1.2.2.1.1.2.2" xref="alg1.l7.m1.2.2.1.1.2.2.cmml">w</mi><mi id="alg1.l7.m1.2.2.1.1.2.3" xref="alg1.l7.m1.2.2.1.1.2.3.cmml">k</mi><mo id="alg1.l7.m1.2.2.1.1.3" xref="alg1.l7.m1.2.2.1.1.3.cmml">∗</mo></msubsup><mo id="alg1.l7.m1.3.3.2.3" xref="alg1.l7.m1.3.3.3.cmml">,</mo><msub id="alg1.l7.m1.3.3.2.2" xref="alg1.l7.m1.3.3.2.2.cmml"><mi id="alg1.l7.m1.3.3.2.2.2" xref="alg1.l7.m1.3.3.2.2.2.cmml">p</mi><mtext id="alg1.l7.m1.3.3.2.2.3" xref="alg1.l7.m1.3.3.2.2.3a.cmml">all_experts</mtext></msub><mo id="alg1.l7.m1.3.3.2.4" xref="alg1.l7.m1.3.3.3.cmml">,</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">acc</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><list id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.2"><apply id="alg1.l7.m1.2.2.1.1.cmml" xref="alg1.l7.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1">superscript</csymbol><apply id="alg1.l7.m1.2.2.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.2.1.cmml" xref="alg1.l7.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l7.m1.2.2.1.1.2.2.cmml" xref="alg1.l7.m1.2.2.1.1.2.2">𝑤</ci><ci id="alg1.l7.m1.2.2.1.1.2.3.cmml" xref="alg1.l7.m1.2.2.1.1.2.3">𝑘</ci></apply><times id="alg1.l7.m1.2.2.1.1.3.cmml" xref="alg1.l7.m1.2.2.1.1.3"></times></apply><apply id="alg1.l7.m1.3.3.2.2.cmml" xref="alg1.l7.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.2.2.1.cmml" xref="alg1.l7.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l7.m1.3.3.2.2.2.cmml" xref="alg1.l7.m1.3.3.2.2.2">𝑝</ci><ci id="alg1.l7.m1.3.3.2.2.3a.cmml" xref="alg1.l7.m1.3.3.2.2.3"><mtext mathsize="70%" id="alg1.l7.m1.3.3.2.2.3.cmml" xref="alg1.l7.m1.3.3.2.2.3">all_experts</mtext></ci></apply><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">acc</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">w_{k}^{*},p_{\text{all\_experts}},\mathrm{acc}</annotation></semantics></math> to server

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w_{global}\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.3.1a" xref="alg1.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3.4" xref="alg1.l9.m1.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.3.1b" xref="alg1.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3.5" xref="alg1.l9.m1.1.1.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.3.1c" xref="alg1.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3.6" xref="alg1.l9.m1.1.1.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.3.1d" xref="alg1.l9.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3.7" xref="alg1.l9.m1.1.1.2.3.7.cmml">l</mi></mrow></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑤</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><times id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></times><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝑔</ci><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝑙</ci><ci id="alg1.l9.m1.1.1.2.3.4.cmml" xref="alg1.l9.m1.1.1.2.3.4">𝑜</ci><ci id="alg1.l9.m1.1.1.2.3.5.cmml" xref="alg1.l9.m1.1.1.2.3.5">𝑏</ci><ci id="alg1.l9.m1.1.1.2.3.6.cmml" xref="alg1.l9.m1.1.1.2.3.6">𝑎</ci><ci id="alg1.l9.m1.1.1.2.3.7.cmml" xref="alg1.l9.m1.1.1.2.3.7">𝑙</ci></apply></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w_{global}\leftarrow</annotation></semantics></math> modular aggregate <math id="alg1.l9.m2.1" class="ltx_Math" alttext="w_{k}^{*}" display="inline"><semantics id="alg1.l9.m2.1a"><msubsup id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2.2" xref="alg1.l9.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l9.m2.1.1.2.3" xref="alg1.l9.m2.1.1.2.3.cmml">k</mi><mo id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">superscript</csymbol><apply id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.2.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.2.2">𝑤</ci><ci id="alg1.l9.m2.1.1.2.3.cmml" xref="alg1.l9.m2.1.1.2.3">𝑘</ci></apply><times id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">w_{k}^{*}</annotation></semantics></math> for <math id="alg1.l9.m3.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="alg1.l9.m3.1a"><msub id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml"><mi id="alg1.l9.m3.1.1.2" xref="alg1.l9.m3.1.1.2.cmml">u</mi><mi id="alg1.l9.m3.1.1.3" xref="alg1.l9.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><apply id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.1.cmml" xref="alg1.l9.m3.1.1">subscript</csymbol><ci id="alg1.l9.m3.1.1.2.cmml" xref="alg1.l9.m3.1.1.2">𝑢</ci><ci id="alg1.l9.m3.1.1.3.cmml" xref="alg1.l9.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">u_{k}</annotation></semantics></math> in <math id="alg1.l9.m4.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="alg1.l9.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m4.1.1" xref="alg1.l9.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m4.1b"><ci id="alg1.l9.m4.1.1.cmml" xref="alg1.l9.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m4.1c">\mathcal{S}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l10.m1.1" class="ltx_Math" alttext="u_{k}\in\mathcal{S}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">u</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><in id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></in><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑢</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">u_{k}\in\mathcal{S}</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>        <span id="alg1.l11.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\mathit{acc}" display="inline"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">𝑎𝑐𝑐</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑎𝑐𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathit{acc}</annotation></semantics></math> not improved <span id="alg1.l11.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>           <span id="alg1.l12.1" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l12.m1.1" class="ltx_Math" alttext="u_{a}\in\mathcal{U}\setminus{u_{k}}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msub id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">u</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">a</mi></msub><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">∈</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">𝒰</mi><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">∖</mo><msub id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml">u</mi><mi id="alg1.l12.m1.1.1.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><in id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></in><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑢</ci><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑎</ci></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><setdiff id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></setdiff><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝒰</ci><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2">𝑢</ci><ci id="alg1.l12.m1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">u_{a}\in\mathcal{U}\setminus{u_{k}}</annotation></semantics></math> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>              Caculate <math id="alg1.l13.m1.2" class="ltx_Math" alttext="\text{sim}\left({{u_{k}},{u_{a}}}\right)" display="inline"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><mtext id="alg1.l13.m1.2.2.4" xref="alg1.l13.m1.2.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l13.m1.2.2.3" xref="alg1.l13.m1.2.2.3.cmml">​</mo><mrow id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.3.cmml"><mo id="alg1.l13.m1.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2.cmml">u</mi><mi id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l13.m1.2.2.2.2.4" xref="alg1.l13.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.cmml">u</mi><mi id="alg1.l13.m1.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.3.cmml">a</mi></msub><mo id="alg1.l13.m1.2.2.2.2.5" xref="alg1.l13.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><times id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3"></times><ci id="alg1.l13.m1.2.2.4a.cmml" xref="alg1.l13.m1.2.2.4"><mtext id="alg1.l13.m1.2.2.4.cmml" xref="alg1.l13.m1.2.2.4">sim</mtext></ci><interval closure="open" id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">𝑢</ci><ci id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2">𝑢</ci><ci id="alg1.l13.m1.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.3">𝑎</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\text{sim}\left({{u_{k}},{u_{a}}}\right)</annotation></semantics></math> <span id="alg1.l13.1" class="ltx_text" style="float:right;"><span id="alg1.l13.1.1" class="ltx_text ltx_font_italic" style="color:#000000;">// refer to equation (<a href="#Sx3.E6" title="In Expert Recommendation ‣ Stage Two: Federated Training and Fine-grained Submodel Adjustment ‣ Method ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)</span>
</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>           <span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>           <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\mathcal{S}^{\prime}\leftarrow" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msup id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">𝒮</mi><mo id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml">′</mo></msup><mo stretchy="false" id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">←</mo><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">←</ci><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2">superscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝒮</ci><ci id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3">′</ci></apply><csymbol cd="latexml" id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{S}^{\prime}\leftarrow</annotation></semantics></math> top <math id="alg1.l15.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l15.m2.1a"><mi id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><ci id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">K</annotation></semantics></math> similar clients

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>           <math id="alg1.l16.m1.2" class="ltx_Math" alttext="n=\textsc{avg}(n_{\text{expert}}(\mathcal{S}^{\prime}))-n_{\text{expert}}(u_{k})" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><mi id="alg1.l16.m1.2.2.4" xref="alg1.l16.m1.2.2.4.cmml">n</mi><mo id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">=</mo><mrow id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml"><mrow id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="alg1.l16.m1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.3a.cmml">avg</mtext><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml">n</mi><mtext id="alg1.l16.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3a.cmml">expert</mtext></msub><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l16.m1.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml"><msub id="alg1.l16.m1.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.3.cmml"><mi id="alg1.l16.m1.2.2.2.2.3.2" xref="alg1.l16.m1.2.2.2.2.3.2.cmml">n</mi><mtext id="alg1.l16.m1.2.2.2.2.3.3" xref="alg1.l16.m1.2.2.2.2.3.3a.cmml">expert</mtext></msub><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.cmml">​</mo><mrow id="alg1.l16.m1.2.2.2.2.1.1" xref="alg1.l16.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.1.1.2" xref="alg1.l16.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="alg1.l16.m1.2.2.2.2.1.1.1" xref="alg1.l16.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l16.m1.2.2.2.2.1.1.1.2" xref="alg1.l16.m1.2.2.2.2.1.1.1.2.cmml">u</mi><mi id="alg1.l16.m1.2.2.2.2.1.1.1.3" xref="alg1.l16.m1.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.1.1.3" xref="alg1.l16.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><eq id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3"></eq><ci id="alg1.l16.m1.2.2.4.cmml" xref="alg1.l16.m1.2.2.4">𝑛</ci><apply id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2"><minus id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.3"></minus><apply id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.2"></times><ci id="alg1.l16.m1.1.1.1.1.3a.cmml" xref="alg1.l16.m1.1.1.1.1.3"><mtext class="ltx_font_smallcaps" id="alg1.l16.m1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.3">avg</mtext></ci><apply id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.3a.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.3">expert</mtext></ci></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.2">𝒮</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply><apply id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2"><times id="alg1.l16.m1.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2"></times><apply id="alg1.l16.m1.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.3.1.cmml" xref="alg1.l16.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.3.2.cmml" xref="alg1.l16.m1.2.2.2.2.3.2">𝑛</ci><ci id="alg1.l16.m1.2.2.2.2.3.3a.cmml" xref="alg1.l16.m1.2.2.2.2.3.3"><mtext mathsize="70%" id="alg1.l16.m1.2.2.2.2.3.3.cmml" xref="alg1.l16.m1.2.2.2.2.3.3">expert</mtext></ci></apply><apply id="alg1.l16.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l16.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.2.2.1.1.1.2">𝑢</ci><ci id="alg1.l16.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">n=\textsc{avg}(n_{\text{expert}}(\mathcal{S}^{\prime}))-n_{\text{expert}}(u_{k})</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>           <span id="alg1.l17.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l17.m1.1" class="ltx_Math" alttext="n&gt;0" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">n</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">&gt;</mo><mn id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><gt id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></gt><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑛</ci><cn type="integer" id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">n&gt;0</annotation></semantics></math> <span id="alg1.l17.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>              <span id="alg1.l18.1" class="ltx_text ltx_font_bold">for</span> expert out of <math id="alg1.l18.m1.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l18.m1.1a"><msub id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml">w</mi><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">𝑤</ci><ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">w_{k}</annotation></semantics></math> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>                 caculate <math id="alg1.l19.m1.1" class="ltx_Math" alttext="\hat{p}_{\text{expert}}" display="inline"><semantics id="alg1.l19.m1.1a"><msub id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mover accent="true" id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.2.2" xref="alg1.l19.m1.1.1.2.2.cmml">p</mi><mo id="alg1.l19.m1.1.1.2.1" xref="alg1.l19.m1.1.1.2.1.cmml">^</mo></mover><mtext id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3a.cmml">expert</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1">subscript</csymbol><apply id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2"><ci id="alg1.l19.m1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.2.1">^</ci><ci id="alg1.l19.m1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.2.2">𝑝</ci></apply><ci id="alg1.l19.m1.1.1.3a.cmml" xref="alg1.l19.m1.1.1.3"><mtext mathsize="70%" id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">expert</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\hat{p}_{\text{expert}}</annotation></semantics></math> <span id="alg1.l19.1" class="ltx_text" style="float:right;"><span id="alg1.l19.1.1" class="ltx_text ltx_font_italic" style="color:#000000;">// refer to equation (<a href="#Sx3.E8" title="In Expert Recommendation ‣ Stage Two: Federated Training and Fine-grained Submodel Adjustment ‣ Method ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)</span>
</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>              <span id="alg1.l20.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>              <math id="alg1.l21.m1.1" class="ltx_Math" alttext="\mathcal{E}\leftarrow" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">ℰ</mi><mo stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">ℰ</ci><csymbol cd="latexml" id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\mathcal{E}\leftarrow</annotation></semantics></math> top <math id="alg1.l21.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l21.m2.1a"><mi id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><ci id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">n</annotation></semantics></math> experts ranked by highest <math id="alg1.l21.m3.1" class="ltx_Math" alttext="\hat{p}_{\text{expert}}" display="inline"><semantics id="alg1.l21.m3.1a"><msub id="alg1.l21.m3.1.1" xref="alg1.l21.m3.1.1.cmml"><mover accent="true" id="alg1.l21.m3.1.1.2" xref="alg1.l21.m3.1.1.2.cmml"><mi id="alg1.l21.m3.1.1.2.2" xref="alg1.l21.m3.1.1.2.2.cmml">p</mi><mo id="alg1.l21.m3.1.1.2.1" xref="alg1.l21.m3.1.1.2.1.cmml">^</mo></mover><mtext id="alg1.l21.m3.1.1.3" xref="alg1.l21.m3.1.1.3a.cmml">expert</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m3.1b"><apply id="alg1.l21.m3.1.1.cmml" xref="alg1.l21.m3.1.1"><csymbol cd="ambiguous" id="alg1.l21.m3.1.1.1.cmml" xref="alg1.l21.m3.1.1">subscript</csymbol><apply id="alg1.l21.m3.1.1.2.cmml" xref="alg1.l21.m3.1.1.2"><ci id="alg1.l21.m3.1.1.2.1.cmml" xref="alg1.l21.m3.1.1.2.1">^</ci><ci id="alg1.l21.m3.1.1.2.2.cmml" xref="alg1.l21.m3.1.1.2.2">𝑝</ci></apply><ci id="alg1.l21.m3.1.1.3a.cmml" xref="alg1.l21.m3.1.1.3"><mtext mathsize="70%" id="alg1.l21.m3.1.1.3.cmml" xref="alg1.l21.m3.1.1.3">expert</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m3.1c">\hat{p}_{\text{expert}}</annotation></semantics></math>

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>              add experts <math id="alg1.l22.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="alg1.l22.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\mathcal{E}</annotation></semantics></math> to submodel <math id="alg1.l22.m2.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l22.m2.1a"><msub id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml"><mi id="alg1.l22.m2.1.1.2" xref="alg1.l22.m2.1.1.2.cmml">w</mi><mi id="alg1.l22.m2.1.1.3" xref="alg1.l22.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><apply id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1"><csymbol cd="ambiguous" id="alg1.l22.m2.1.1.1.cmml" xref="alg1.l22.m2.1.1">subscript</csymbol><ci id="alg1.l22.m2.1.1.2.cmml" xref="alg1.l22.m2.1.1.2">𝑤</ci><ci id="alg1.l22.m2.1.1.3.cmml" xref="alg1.l22.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">w_{k}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>           <span id="alg1.l23.1" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>              <span id="alg1.l24.1" class="ltx_text ltx_font_bold">for</span> expert within <math id="alg1.l24.m1.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l24.m1.1a"><msub id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">w</mi><mi id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1">subscript</csymbol><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">𝑤</ci><ci id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">w_{k}</annotation></semantics></math> <span id="alg1.l24.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>                 caculate <math id="alg1.l25.m1.1" class="ltx_Math" alttext="\hat{p}_{\text{expert}}" display="inline"><semantics id="alg1.l25.m1.1a"><msub id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><mover accent="true" id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.2.2" xref="alg1.l25.m1.1.1.2.2.cmml">p</mi><mo id="alg1.l25.m1.1.1.2.1" xref="alg1.l25.m1.1.1.2.1.cmml">^</mo></mover><mtext id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3a.cmml">expert</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1">subscript</csymbol><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"><ci id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.2.1">^</ci><ci id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2.2">𝑝</ci></apply><ci id="alg1.l25.m1.1.1.3a.cmml" xref="alg1.l25.m1.1.1.3"><mtext mathsize="70%" id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">expert</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">\hat{p}_{\text{expert}}</annotation></semantics></math> <span id="alg1.l25.1" class="ltx_text" style="float:right;"><span id="alg1.l25.1.1" class="ltx_text ltx_font_italic" style="color:#000000;">// refer to equation (<a href="#Sx3.E8" title="In Expert Recommendation ‣ Stage Two: Federated Training and Fine-grained Submodel Adjustment ‣ Method ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)</span>
</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>              <span id="alg1.l26.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l26.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27:</span>              <math id="alg1.l27.m1.1" class="ltx_Math" alttext="\mathcal{E}\leftarrow" display="inline"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l27.m1.1.1.2" xref="alg1.l27.m1.1.1.2.cmml">ℰ</mi><mo stretchy="false" id="alg1.l27.m1.1.1.1" xref="alg1.l27.m1.1.1.1.cmml">←</mo><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><ci id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1">←</ci><ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">ℰ</ci><csymbol cd="latexml" id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">\mathcal{E}\leftarrow</annotation></semantics></math> top <math id="alg1.l27.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l27.m2.1a"><mi id="alg1.l27.m2.1.1" xref="alg1.l27.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l27.m2.1b"><ci id="alg1.l27.m2.1.1.cmml" xref="alg1.l27.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m2.1c">n</annotation></semantics></math> experts ranked by lowest <math id="alg1.l27.m3.1" class="ltx_Math" alttext="\hat{p}_{\text{expert}}" display="inline"><semantics id="alg1.l27.m3.1a"><msub id="alg1.l27.m3.1.1" xref="alg1.l27.m3.1.1.cmml"><mover accent="true" id="alg1.l27.m3.1.1.2" xref="alg1.l27.m3.1.1.2.cmml"><mi id="alg1.l27.m3.1.1.2.2" xref="alg1.l27.m3.1.1.2.2.cmml">p</mi><mo id="alg1.l27.m3.1.1.2.1" xref="alg1.l27.m3.1.1.2.1.cmml">^</mo></mover><mtext id="alg1.l27.m3.1.1.3" xref="alg1.l27.m3.1.1.3a.cmml">expert</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l27.m3.1b"><apply id="alg1.l27.m3.1.1.cmml" xref="alg1.l27.m3.1.1"><csymbol cd="ambiguous" id="alg1.l27.m3.1.1.1.cmml" xref="alg1.l27.m3.1.1">subscript</csymbol><apply id="alg1.l27.m3.1.1.2.cmml" xref="alg1.l27.m3.1.1.2"><ci id="alg1.l27.m3.1.1.2.1.cmml" xref="alg1.l27.m3.1.1.2.1">^</ci><ci id="alg1.l27.m3.1.1.2.2.cmml" xref="alg1.l27.m3.1.1.2.2">𝑝</ci></apply><ci id="alg1.l27.m3.1.1.3a.cmml" xref="alg1.l27.m3.1.1.3"><mtext mathsize="70%" id="alg1.l27.m3.1.1.3.cmml" xref="alg1.l27.m3.1.1.3">expert</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m3.1c">\hat{p}_{\text{expert}}</annotation></semantics></math>

</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28:</span>              remove experts <math id="alg1.l28.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="alg1.l28.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">\mathcal{E}</annotation></semantics></math> out of submodel <math id="alg1.l28.m2.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="alg1.l28.m2.1a"><msub id="alg1.l28.m2.1.1" xref="alg1.l28.m2.1.1.cmml"><mi id="alg1.l28.m2.1.1.2" xref="alg1.l28.m2.1.1.2.cmml">w</mi><mi id="alg1.l28.m2.1.1.3" xref="alg1.l28.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l28.m2.1b"><apply id="alg1.l28.m2.1.1.cmml" xref="alg1.l28.m2.1.1"><csymbol cd="ambiguous" id="alg1.l28.m2.1.1.1.cmml" xref="alg1.l28.m2.1.1">subscript</csymbol><ci id="alg1.l28.m2.1.1.2.cmml" xref="alg1.l28.m2.1.1.2">𝑤</ci><ci id="alg1.l28.m2.1.1.3.cmml" xref="alg1.l28.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m2.1c">w_{k}</annotation></semantics></math>

</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29:</span>           <span id="alg1.l29.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l29.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30:</span>        <span id="alg1.l30.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l30.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31:</span>     <span id="alg1.l31.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l31.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32:</span>  <span id="alg1.l32.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l32.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
</section>
<section id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Stage Two: Federated Training and Fine-grained Submodel Adjustment</h3>

<div id="Sx3.SSx4.p1" class="ltx_para">
<p id="Sx3.SSx4.p1.1" class="ltx_p">In the second stage shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Heuristic Submodel Search ‣ Stage One: Coarse-grained Submodel Initialization ‣ Method ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, federated training begins with the submodels initialized by the first stage. After fine-tuning on clients’ private data, the submodel is filled with personalized knowledge. The challenge lies in how to encourage cooperation while reducing interference among heterogeneous submodels during aggregation. Additionally, initial submodels may prove suboptimal, either failing to capture personalized knowledge (<span id="Sx3.SSx4.p1.1.1" class="ltx_text ltx_font_italic">underfitting</span>) or being excessively redundant (<span id="Sx3.SSx4.p1.1.2" class="ltx_text ltx_font_italic">overfitting</span>). The cloud serves as a central node, crucial not only for managing model parameters but also for structural model adjustments. Specifically, <span id="Sx3.SSx4.p1.1.3" class="ltx_text ltx_font_typewriter">FedMoE</span> incorporates clients with diverse data distributions and various task types through modular model sub-sampling and aggregation. Afterwards, the cloud progressively adjusts the submodels based on the expert recommendation mechanism from a global perspective, continually optimizing the overall system.</p>
</div>
<section id="Sx3.SSx4.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Submodel Deployment</h4>

<div id="Sx3.SSx4.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p1.1" class="ltx_p">At the beginning of each round, a random selection of clients is chosen to participate in the training. The cloud sub-samples the dense layers and optimal expert subset from the global MoE based on the latest client-expert map, constructing a personalized submodel for each client. Deployed on edge devices, these submodels are fine-tuned on local training dataset. Subsequently, clients perform inference on their validation dataset, collecting the up-to-date expert activation probabilities and validation scores which are sent to cloud along with the edge model parameters.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Modular Aggregation</h4>

<div id="Sx3.SSx4.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p1.1" class="ltx_p">After receiving all edge models, the cloud integrates newly-learned knowledge back into the global model based on the modular aggregation strategy. For parameters of dense layers, the cloud conventionally employs the Federated Averaging (FedAvg) strategy. For parameters of sparse layers, aggregation becomes more complicated due to the heterogeneous expert subsets across clients. In detail, unactivated experts in the global model remain unchanged, experts used by a single client are updated directly, and experts shared by multiple clients are aggregated based on the FedAvg strategy. The expert-corresponding dimensions of routers are updated in the same pattern. Module-granular updates allow for independent optimization of different parts within the global model, fostering collaboration and mutual enhancement while preventing conflicts across different clients.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Expert Recommendation</h4>

<div id="Sx3.SSx4.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx3.p1.2" class="ltx_p">Besides updating the global model, the cloud precisely optimizes the submodel structure to ensure learning efficiency throughout the training cycle. If a client shows no performance gains after several rounds, its model is considered to have reached a bottleneck.
The cloud leverages insights provided by other clients from a global perspective, conducting expert-granular structural adjustments. Specifically, the cloud calculates the cosine similarity between the current client and other clients based on their expert activation probabilities, formulated as:</p>
<table id="Sx6.EGx4" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E6.m1.13" class="ltx_Math" alttext="\displaystyle\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)=\frac{{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{\left({{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{k}}}}\times{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}}\right)}}}}{{\sqrt{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{k}}}}^{2}}}}\times\sqrt{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}^{2}}}}}}" display="block"><semantics id="Sx3.E6.m1.13a"><mrow id="Sx3.E6.m1.13.13" xref="Sx3.E6.m1.13.13.cmml"><mrow id="Sx3.E6.m1.13.13.2" xref="Sx3.E6.m1.13.13.2.cmml"><mtext id="Sx3.E6.m1.13.13.2.4" xref="Sx3.E6.m1.13.13.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="Sx3.E6.m1.13.13.2.3" xref="Sx3.E6.m1.13.13.2.3.cmml">​</mo><mrow id="Sx3.E6.m1.13.13.2.2.2" xref="Sx3.E6.m1.13.13.2.2.3.cmml"><mo id="Sx3.E6.m1.13.13.2.2.2.3" xref="Sx3.E6.m1.13.13.2.2.3.cmml">(</mo><msub id="Sx3.E6.m1.12.12.1.1.1.1" xref="Sx3.E6.m1.12.12.1.1.1.1.cmml"><mi id="Sx3.E6.m1.12.12.1.1.1.1.2" xref="Sx3.E6.m1.12.12.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.12.12.1.1.1.1.3" xref="Sx3.E6.m1.12.12.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E6.m1.13.13.2.2.2.4" xref="Sx3.E6.m1.13.13.2.2.3.cmml">,</mo><msub id="Sx3.E6.m1.13.13.2.2.2.2" xref="Sx3.E6.m1.13.13.2.2.2.2.cmml"><mi id="Sx3.E6.m1.13.13.2.2.2.2.2" xref="Sx3.E6.m1.13.13.2.2.2.2.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.13.13.2.2.2.2.3" xref="Sx3.E6.m1.13.13.2.2.2.2.3.cmml">a</mi></msub><mo id="Sx3.E6.m1.13.13.2.2.2.5" xref="Sx3.E6.m1.13.13.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E6.m1.13.13.3" xref="Sx3.E6.m1.13.13.3.cmml">=</mo><mfrac id="Sx3.E6.m1.11.11" xref="Sx3.E6.m1.11.11.cmml"><mrow id="Sx3.E6.m1.5.5.5" xref="Sx3.E6.m1.5.5.5.cmml"><munderover id="Sx3.E6.m1.5.5.5.6" xref="Sx3.E6.m1.5.5.5.6.cmml"><mo movablelimits="false" id="Sx3.E6.m1.5.5.5.6.2.2" xref="Sx3.E6.m1.5.5.5.6.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.5.5.5.6.2.3" xref="Sx3.E6.m1.5.5.5.6.2.3.cmml"><mi id="Sx3.E6.m1.5.5.5.6.2.3.2" xref="Sx3.E6.m1.5.5.5.6.2.3.2.cmml">i</mi><mo id="Sx3.E6.m1.5.5.5.6.2.3.1" xref="Sx3.E6.m1.5.5.5.6.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.5.5.5.6.2.3.3" xref="Sx3.E6.m1.5.5.5.6.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E6.m1.5.5.5.6.3" xref="Sx3.E6.m1.5.5.5.6.3.cmml">L</mi></munderover><mrow id="Sx3.E6.m1.5.5.5.5" xref="Sx3.E6.m1.5.5.5.5.cmml"><munderover id="Sx3.E6.m1.5.5.5.5.2" xref="Sx3.E6.m1.5.5.5.5.2.cmml"><mo lspace="0.167em" movablelimits="false" rspace="0em" id="Sx3.E6.m1.5.5.5.5.2.2.2" xref="Sx3.E6.m1.5.5.5.5.2.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.5.5.5.5.2.2.3" xref="Sx3.E6.m1.5.5.5.5.2.2.3.cmml"><mi id="Sx3.E6.m1.5.5.5.5.2.2.3.2" xref="Sx3.E6.m1.5.5.5.5.2.2.3.2.cmml">j</mi><mo id="Sx3.E6.m1.5.5.5.5.2.2.3.1" xref="Sx3.E6.m1.5.5.5.5.2.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.5.5.5.5.2.2.3.3" xref="Sx3.E6.m1.5.5.5.5.2.2.3.3.cmml">1</mn></mrow><msub id="Sx3.E6.m1.5.5.5.5.2.3" xref="Sx3.E6.m1.5.5.5.5.2.3.cmml"><mi id="Sx3.E6.m1.5.5.5.5.2.3.2" xref="Sx3.E6.m1.5.5.5.5.2.3.2.cmml">E</mi><mi id="Sx3.E6.m1.5.5.5.5.2.3.3" xref="Sx3.E6.m1.5.5.5.5.2.3.3.cmml">i</mi></msub></munderover><mrow id="Sx3.E6.m1.5.5.5.5.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.cmml"><mo id="Sx3.E6.m1.5.5.5.5.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="Sx3.E6.m1.5.5.5.5.1.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.cmml"><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.cmml"><mo id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.2.cmml">p</mi><mrow id="Sx3.E6.m1.2.2.2.2.2.4" xref="Sx3.E6.m1.2.2.2.2.2.3.cmml"><mi id="Sx3.E6.m1.1.1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.1.1.cmml">i</mi><mo id="Sx3.E6.m1.2.2.2.2.2.4.1" xref="Sx3.E6.m1.2.2.2.2.2.3.cmml">,</mo><mi id="Sx3.E6.m1.2.2.2.2.2.2" xref="Sx3.E6.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo rspace="0.055em" id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.cmml"><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo rspace="0.222em" id="Sx3.E6.m1.5.5.5.5.1.1.1.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.3.cmml">×</mo><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.cmml"><mrow id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.cmml"><mo id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.cmml">(</mo><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.cmml"><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.2.cmml">p</mi><mrow id="Sx3.E6.m1.4.4.4.4.2.4" xref="Sx3.E6.m1.4.4.4.4.2.3.cmml"><mi id="Sx3.E6.m1.3.3.3.3.1.1" xref="Sx3.E6.m1.3.3.3.3.1.1.cmml">i</mi><mo id="Sx3.E6.m1.4.4.4.4.2.4.1" xref="Sx3.E6.m1.4.4.4.4.2.3.cmml">,</mo><mi id="Sx3.E6.m1.4.4.4.4.2.2" xref="Sx3.E6.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.cmml"><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.2" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.3.cmml">a</mi></msub></msub></mrow><mo id="Sx3.E6.m1.5.5.5.5.1.1.3" xref="Sx3.E6.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="Sx3.E6.m1.11.11.11" xref="Sx3.E6.m1.11.11.11.cmml"><msqrt id="Sx3.E6.m1.8.8.8.3" xref="Sx3.E6.m1.8.8.8.3.cmml"><mrow id="Sx3.E6.m1.8.8.8.3.3" xref="Sx3.E6.m1.8.8.8.3.3.cmml"><munderover id="Sx3.E6.m1.8.8.8.3.3.4" xref="Sx3.E6.m1.8.8.8.3.3.4.cmml"><mo movablelimits="false" id="Sx3.E6.m1.8.8.8.3.3.4.2.2" xref="Sx3.E6.m1.8.8.8.3.3.4.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.8.8.8.3.3.4.2.3" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.cmml"><mi id="Sx3.E6.m1.8.8.8.3.3.4.2.3.2" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.2.cmml">i</mi><mo id="Sx3.E6.m1.8.8.8.3.3.4.2.3.1" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.8.8.8.3.3.4.2.3.3" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E6.m1.8.8.8.3.3.4.3" xref="Sx3.E6.m1.8.8.8.3.3.4.3.cmml">L</mi></munderover><mrow id="Sx3.E6.m1.8.8.8.3.3.3" xref="Sx3.E6.m1.8.8.8.3.3.3.cmml"><munderover id="Sx3.E6.m1.8.8.8.3.3.3.2" xref="Sx3.E6.m1.8.8.8.3.3.3.2.cmml"><mo lspace="0.167em" movablelimits="false" rspace="0em" id="Sx3.E6.m1.8.8.8.3.3.3.2.2.2" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.cmml"><mi id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.2" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.2.cmml">j</mi><mo id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.1" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.3" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.3.cmml">1</mn></mrow><msub id="Sx3.E6.m1.8.8.8.3.3.3.2.3" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3.cmml"><mi id="Sx3.E6.m1.8.8.8.3.3.3.2.3.2" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3.2.cmml">E</mi><mi id="Sx3.E6.m1.8.8.8.3.3.3.2.3.3" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3.3.cmml">i</mi></msub></munderover><mmultiscripts id="Sx3.E6.m1.8.8.8.3.3.3.1" xref="Sx3.E6.m1.8.8.8.3.3.3.1.cmml"><mrow id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.cmml"><mo id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.2" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.2" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.2.cmml">p</mi><mrow id="Sx3.E6.m1.7.7.7.2.2.2.2.4" xref="Sx3.E6.m1.7.7.7.2.2.2.2.3.cmml"><mi id="Sx3.E6.m1.6.6.6.1.1.1.1.1" xref="Sx3.E6.m1.6.6.6.1.1.1.1.1.cmml">i</mi><mo id="Sx3.E6.m1.7.7.7.2.2.2.2.4.1" xref="Sx3.E6.m1.7.7.7.2.2.2.2.3.cmml">,</mo><mi id="Sx3.E6.m1.7.7.7.2.2.2.2.2" xref="Sx3.E6.m1.7.7.7.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.3" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.cmml"><mi id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.2" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.3" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.3.cmml">k</mi></msub><mrow id="Sx3.E6.m1.8.8.8.3.3.3.1a" xref="Sx3.E6.m1.8.8.8.3.3.3.1.cmml"></mrow><mrow id="Sx3.E6.m1.8.8.8.3.3.3.1b" xref="Sx3.E6.m1.8.8.8.3.3.3.1.cmml"></mrow><mn id="Sx3.E6.m1.8.8.8.3.3.3.1.3" xref="Sx3.E6.m1.8.8.8.3.3.3.1.3.cmml">2</mn></mmultiscripts></mrow></mrow></msqrt><mo lspace="0.222em" rspace="0.222em" id="Sx3.E6.m1.11.11.11.7" xref="Sx3.E6.m1.11.11.11.7.cmml">×</mo><msqrt id="Sx3.E6.m1.11.11.11.6" xref="Sx3.E6.m1.11.11.11.6.cmml"><mrow id="Sx3.E6.m1.11.11.11.6.3" xref="Sx3.E6.m1.11.11.11.6.3.cmml"><munderover id="Sx3.E6.m1.11.11.11.6.3.4" xref="Sx3.E6.m1.11.11.11.6.3.4.cmml"><mo movablelimits="false" id="Sx3.E6.m1.11.11.11.6.3.4.2.2" xref="Sx3.E6.m1.11.11.11.6.3.4.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.11.11.11.6.3.4.2.3" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.cmml"><mi id="Sx3.E6.m1.11.11.11.6.3.4.2.3.2" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.2.cmml">i</mi><mo id="Sx3.E6.m1.11.11.11.6.3.4.2.3.1" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.11.11.11.6.3.4.2.3.3" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E6.m1.11.11.11.6.3.4.3" xref="Sx3.E6.m1.11.11.11.6.3.4.3.cmml">L</mi></munderover><mrow id="Sx3.E6.m1.11.11.11.6.3.3" xref="Sx3.E6.m1.11.11.11.6.3.3.cmml"><munderover id="Sx3.E6.m1.11.11.11.6.3.3.2" xref="Sx3.E6.m1.11.11.11.6.3.3.2.cmml"><mo lspace="0.167em" movablelimits="false" rspace="0em" id="Sx3.E6.m1.11.11.11.6.3.3.2.2.2" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.2.cmml">∑</mo><mrow id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.cmml"><mi id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.2" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.2.cmml">j</mi><mo id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.1" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.1.cmml">=</mo><mn id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.3" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.3.cmml">1</mn></mrow><msub id="Sx3.E6.m1.11.11.11.6.3.3.2.3" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3.cmml"><mi id="Sx3.E6.m1.11.11.11.6.3.3.2.3.2" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3.2.cmml">E</mi><mi id="Sx3.E6.m1.11.11.11.6.3.3.2.3.3" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3.3.cmml">i</mi></msub></munderover><mmultiscripts id="Sx3.E6.m1.11.11.11.6.3.3.1" xref="Sx3.E6.m1.11.11.11.6.3.3.1.cmml"><mrow id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.cmml"><mo id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.2" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.cmml"><mi id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.2" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.2.cmml">p</mi><mrow id="Sx3.E6.m1.10.10.10.5.2.2.2.4" xref="Sx3.E6.m1.10.10.10.5.2.2.2.3.cmml"><mi id="Sx3.E6.m1.9.9.9.4.1.1.1.1" xref="Sx3.E6.m1.9.9.9.4.1.1.1.1.cmml">i</mi><mo id="Sx3.E6.m1.10.10.10.5.2.2.2.4.1" xref="Sx3.E6.m1.10.10.10.5.2.2.2.3.cmml">,</mo><mi id="Sx3.E6.m1.10.10.10.5.2.2.2.2" xref="Sx3.E6.m1.10.10.10.5.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.3" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.cmml"><mi id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.2" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.2.cmml">𝐮</mi><mi id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.3" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.3.cmml">a</mi></msub><mrow id="Sx3.E6.m1.11.11.11.6.3.3.1a" xref="Sx3.E6.m1.11.11.11.6.3.3.1.cmml"></mrow><mrow id="Sx3.E6.m1.11.11.11.6.3.3.1b" xref="Sx3.E6.m1.11.11.11.6.3.3.1.cmml"></mrow><mn id="Sx3.E6.m1.11.11.11.6.3.3.1.3" xref="Sx3.E6.m1.11.11.11.6.3.3.1.3.cmml">2</mn></mmultiscripts></mrow></mrow></msqrt></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.13b"><apply id="Sx3.E6.m1.13.13.cmml" xref="Sx3.E6.m1.13.13"><eq id="Sx3.E6.m1.13.13.3.cmml" xref="Sx3.E6.m1.13.13.3"></eq><apply id="Sx3.E6.m1.13.13.2.cmml" xref="Sx3.E6.m1.13.13.2"><times id="Sx3.E6.m1.13.13.2.3.cmml" xref="Sx3.E6.m1.13.13.2.3"></times><ci id="Sx3.E6.m1.13.13.2.4a.cmml" xref="Sx3.E6.m1.13.13.2.4"><mtext id="Sx3.E6.m1.13.13.2.4.cmml" xref="Sx3.E6.m1.13.13.2.4">sim</mtext></ci><interval closure="open" id="Sx3.E6.m1.13.13.2.2.3.cmml" xref="Sx3.E6.m1.13.13.2.2.2"><apply id="Sx3.E6.m1.12.12.1.1.1.1.cmml" xref="Sx3.E6.m1.12.12.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.12.12.1.1.1.1.1.cmml" xref="Sx3.E6.m1.12.12.1.1.1.1">subscript</csymbol><ci id="Sx3.E6.m1.12.12.1.1.1.1.2.cmml" xref="Sx3.E6.m1.12.12.1.1.1.1.2">𝐮</ci><ci id="Sx3.E6.m1.12.12.1.1.1.1.3.cmml" xref="Sx3.E6.m1.12.12.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.E6.m1.13.13.2.2.2.2.cmml" xref="Sx3.E6.m1.13.13.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.13.13.2.2.2.2.1.cmml" xref="Sx3.E6.m1.13.13.2.2.2.2">subscript</csymbol><ci id="Sx3.E6.m1.13.13.2.2.2.2.2.cmml" xref="Sx3.E6.m1.13.13.2.2.2.2.2">𝐮</ci><ci id="Sx3.E6.m1.13.13.2.2.2.2.3.cmml" xref="Sx3.E6.m1.13.13.2.2.2.2.3">𝑎</ci></apply></interval></apply><apply id="Sx3.E6.m1.11.11.cmml" xref="Sx3.E6.m1.11.11"><divide id="Sx3.E6.m1.11.11.12.cmml" xref="Sx3.E6.m1.11.11"></divide><apply id="Sx3.E6.m1.5.5.5.cmml" xref="Sx3.E6.m1.5.5.5"><apply id="Sx3.E6.m1.5.5.5.6.cmml" xref="Sx3.E6.m1.5.5.5.6"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.6.1.cmml" xref="Sx3.E6.m1.5.5.5.6">superscript</csymbol><apply id="Sx3.E6.m1.5.5.5.6.2.cmml" xref="Sx3.E6.m1.5.5.5.6"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.6.2.1.cmml" xref="Sx3.E6.m1.5.5.5.6">subscript</csymbol><sum id="Sx3.E6.m1.5.5.5.6.2.2.cmml" xref="Sx3.E6.m1.5.5.5.6.2.2"></sum><apply id="Sx3.E6.m1.5.5.5.6.2.3.cmml" xref="Sx3.E6.m1.5.5.5.6.2.3"><eq id="Sx3.E6.m1.5.5.5.6.2.3.1.cmml" xref="Sx3.E6.m1.5.5.5.6.2.3.1"></eq><ci id="Sx3.E6.m1.5.5.5.6.2.3.2.cmml" xref="Sx3.E6.m1.5.5.5.6.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E6.m1.5.5.5.6.2.3.3.cmml" xref="Sx3.E6.m1.5.5.5.6.2.3.3">1</cn></apply></apply><ci id="Sx3.E6.m1.5.5.5.6.3.cmml" xref="Sx3.E6.m1.5.5.5.6.3">𝐿</ci></apply><apply id="Sx3.E6.m1.5.5.5.5.cmml" xref="Sx3.E6.m1.5.5.5.5"><apply id="Sx3.E6.m1.5.5.5.5.2.cmml" xref="Sx3.E6.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.2.1.cmml" xref="Sx3.E6.m1.5.5.5.5.2">superscript</csymbol><apply id="Sx3.E6.m1.5.5.5.5.2.2.cmml" xref="Sx3.E6.m1.5.5.5.5.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.2.2.1.cmml" xref="Sx3.E6.m1.5.5.5.5.2">subscript</csymbol><sum id="Sx3.E6.m1.5.5.5.5.2.2.2.cmml" xref="Sx3.E6.m1.5.5.5.5.2.2.2"></sum><apply id="Sx3.E6.m1.5.5.5.5.2.2.3.cmml" xref="Sx3.E6.m1.5.5.5.5.2.2.3"><eq id="Sx3.E6.m1.5.5.5.5.2.2.3.1.cmml" xref="Sx3.E6.m1.5.5.5.5.2.2.3.1"></eq><ci id="Sx3.E6.m1.5.5.5.5.2.2.3.2.cmml" xref="Sx3.E6.m1.5.5.5.5.2.2.3.2">𝑗</ci><cn type="integer" id="Sx3.E6.m1.5.5.5.5.2.2.3.3.cmml" xref="Sx3.E6.m1.5.5.5.5.2.2.3.3">1</cn></apply></apply><apply id="Sx3.E6.m1.5.5.5.5.2.3.cmml" xref="Sx3.E6.m1.5.5.5.5.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.2.3.1.cmml" xref="Sx3.E6.m1.5.5.5.5.2.3">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.2.3.2.cmml" xref="Sx3.E6.m1.5.5.5.5.2.3.2">𝐸</ci><ci id="Sx3.E6.m1.5.5.5.5.2.3.3.cmml" xref="Sx3.E6.m1.5.5.5.5.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1"><times id="Sx3.E6.m1.5.5.5.5.1.1.1.3.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.3"></times><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.1.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1">subscript</csymbol><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.1.1.1.2">𝑝</ci><list id="Sx3.E6.m1.2.2.2.2.2.3.cmml" xref="Sx3.E6.m1.2.2.2.2.2.4"><ci id="Sx3.E6.m1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1.1.1.1">𝑖</ci><ci id="Sx3.E6.m1.2.2.2.2.2.2.cmml" xref="Sx3.E6.m1.2.2.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.2">𝐮</ci><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.3.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.2.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2">subscript</csymbol><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.1.1.1.2">𝑝</ci><list id="Sx3.E6.m1.4.4.4.4.2.3.cmml" xref="Sx3.E6.m1.4.4.4.4.2.4"><ci id="Sx3.E6.m1.3.3.3.3.1.1.cmml" xref="Sx3.E6.m1.3.3.3.3.1.1">𝑖</ci><ci id="Sx3.E6.m1.4.4.4.4.2.2.cmml" xref="Sx3.E6.m1.4.4.4.4.2.2">𝑗</ci></list></apply><apply id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.1.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.2.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.2">𝐮</ci><ci id="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.3.cmml" xref="Sx3.E6.m1.5.5.5.5.1.1.1.2.3.3">𝑎</ci></apply></apply></apply></apply></apply><apply id="Sx3.E6.m1.11.11.11.cmml" xref="Sx3.E6.m1.11.11.11"><times id="Sx3.E6.m1.11.11.11.7.cmml" xref="Sx3.E6.m1.11.11.11.7"></times><apply id="Sx3.E6.m1.8.8.8.3.cmml" xref="Sx3.E6.m1.8.8.8.3"><root id="Sx3.E6.m1.8.8.8.3a.cmml" xref="Sx3.E6.m1.8.8.8.3"></root><apply id="Sx3.E6.m1.8.8.8.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3"><apply id="Sx3.E6.m1.8.8.8.3.3.4.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.4.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4">superscript</csymbol><apply id="Sx3.E6.m1.8.8.8.3.3.4.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.4.2.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4">subscript</csymbol><sum id="Sx3.E6.m1.8.8.8.3.3.4.2.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.2.2"></sum><apply id="Sx3.E6.m1.8.8.8.3.3.4.2.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3"><eq id="Sx3.E6.m1.8.8.8.3.3.4.2.3.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.1"></eq><ci id="Sx3.E6.m1.8.8.8.3.3.4.2.3.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E6.m1.8.8.8.3.3.4.2.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.2.3.3">1</cn></apply></apply><ci id="Sx3.E6.m1.8.8.8.3.3.4.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.4.3">𝐿</ci></apply><apply id="Sx3.E6.m1.8.8.8.3.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3"><apply id="Sx3.E6.m1.8.8.8.3.3.3.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.2.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2">superscript</csymbol><apply id="Sx3.E6.m1.8.8.8.3.3.3.2.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.2.2.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2">subscript</csymbol><sum id="Sx3.E6.m1.8.8.8.3.3.3.2.2.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.2"></sum><apply id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3"><eq id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.1"></eq><ci id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.2">𝑗</ci><cn type="integer" id="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.2.3.3">1</cn></apply></apply><apply id="Sx3.E6.m1.8.8.8.3.3.3.2.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.2.3.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3">subscript</csymbol><ci id="Sx3.E6.m1.8.8.8.3.3.3.2.3.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3.2">𝐸</ci><ci id="Sx3.E6.m1.8.8.8.3.3.3.2.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.E6.m1.8.8.8.3.3.3.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.1.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1">superscript</csymbol><apply id="Sx3.E6.m1.8.8.8.3.3.3.1.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.1.1.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1">subscript</csymbol><apply id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1">subscript</csymbol><ci id="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.1.1.1.2">𝑝</ci><list id="Sx3.E6.m1.7.7.7.2.2.2.2.3.cmml" xref="Sx3.E6.m1.7.7.7.2.2.2.2.4"><ci id="Sx3.E6.m1.6.6.6.1.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.6.1.1.1.1.1">𝑖</ci><ci id="Sx3.E6.m1.7.7.7.2.2.2.2.2.cmml" xref="Sx3.E6.m1.7.7.7.2.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.1.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.2.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.2">𝐮</ci><ci id="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.1.3.3">𝑘</ci></apply></apply><cn type="integer" id="Sx3.E6.m1.8.8.8.3.3.3.1.3.cmml" xref="Sx3.E6.m1.8.8.8.3.3.3.1.3">2</cn></apply></apply></apply></apply><apply id="Sx3.E6.m1.11.11.11.6.cmml" xref="Sx3.E6.m1.11.11.11.6"><root id="Sx3.E6.m1.11.11.11.6a.cmml" xref="Sx3.E6.m1.11.11.11.6"></root><apply id="Sx3.E6.m1.11.11.11.6.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3"><apply id="Sx3.E6.m1.11.11.11.6.3.4.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.4.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4">superscript</csymbol><apply id="Sx3.E6.m1.11.11.11.6.3.4.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.4.2.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4">subscript</csymbol><sum id="Sx3.E6.m1.11.11.11.6.3.4.2.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.2.2"></sum><apply id="Sx3.E6.m1.11.11.11.6.3.4.2.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3"><eq id="Sx3.E6.m1.11.11.11.6.3.4.2.3.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.1"></eq><ci id="Sx3.E6.m1.11.11.11.6.3.4.2.3.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E6.m1.11.11.11.6.3.4.2.3.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.2.3.3">1</cn></apply></apply><ci id="Sx3.E6.m1.11.11.11.6.3.4.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.4.3">𝐿</ci></apply><apply id="Sx3.E6.m1.11.11.11.6.3.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3"><apply id="Sx3.E6.m1.11.11.11.6.3.3.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.2.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2">superscript</csymbol><apply id="Sx3.E6.m1.11.11.11.6.3.3.2.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.2.2.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2">subscript</csymbol><sum id="Sx3.E6.m1.11.11.11.6.3.3.2.2.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.2"></sum><apply id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3"><eq id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.1"></eq><ci id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.2">𝑗</ci><cn type="integer" id="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.2.3.3">1</cn></apply></apply><apply id="Sx3.E6.m1.11.11.11.6.3.3.2.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.2.3.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3">subscript</csymbol><ci id="Sx3.E6.m1.11.11.11.6.3.3.2.3.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3.2">𝐸</ci><ci id="Sx3.E6.m1.11.11.11.6.3.3.2.3.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.E6.m1.11.11.11.6.3.3.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.1.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1">superscript</csymbol><apply id="Sx3.E6.m1.11.11.11.6.3.3.1.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.1.1.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1">subscript</csymbol><apply id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1">subscript</csymbol><ci id="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.1.1.1.2">𝑝</ci><list id="Sx3.E6.m1.10.10.10.5.2.2.2.3.cmml" xref="Sx3.E6.m1.10.10.10.5.2.2.2.4"><ci id="Sx3.E6.m1.9.9.9.4.1.1.1.1.cmml" xref="Sx3.E6.m1.9.9.9.4.1.1.1.1">𝑖</ci><ci id="Sx3.E6.m1.10.10.10.5.2.2.2.2.cmml" xref="Sx3.E6.m1.10.10.10.5.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.1.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.2.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.2">𝐮</ci><ci id="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.1.3.3">𝑎</ci></apply></apply><cn type="integer" id="Sx3.E6.m1.11.11.11.6.3.3.1.3.cmml" xref="Sx3.E6.m1.11.11.11.6.3.3.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.13c">\displaystyle\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)=\frac{{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{\left({{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{k}}}}\times{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}}\right)}}}}{{\sqrt{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{k}}}}^{2}}}}\times\sqrt{\sum\limits_{i=1}^{L}{\sum\limits_{j=1}^{{E_{i}}}{{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}^{2}}}}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx3.p1.1" class="ltx_p">The current client takes the top <math id="Sx3.SSx4.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx3.SSx4.SSSx3.p1.1.m1.1a"><mi id="Sx3.SSx4.SSSx3.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p1.1.m1.1c">K</annotation></semantics></math> clients ranked by similarity as reference, as indicated by:</p>
<table id="Sx6.EGx5" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E7.m1.3" class="ltx_Math" alttext="\displaystyle\mathbb{S}\left({{\mathbf{u}_{k}}}\right)=\left\{{\left.{{\mathbf{u}_{a}}}\right|rank\,\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)\leqslant K,a\neq k}\right\}" display="block"><semantics id="Sx3.E7.m1.3a"><mrow id="Sx3.E7.m1.3.3" xref="Sx3.E7.m1.3.3.cmml"><mrow id="Sx3.E7.m1.1.1.1" xref="Sx3.E7.m1.1.1.1.cmml"><mi id="Sx3.E7.m1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.3.cmml">𝕊</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E7.m1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml"><mo id="Sx3.E7.m1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E7.m1.1.1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.1.1.1.1.1.1.2" xref="Sx3.E7.m1.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E7.m1.1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E7.m1.1.1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.3.3.4" xref="Sx3.E7.m1.3.3.4.cmml">=</mo><mrow id="Sx3.E7.m1.3.3.3.2" xref="Sx3.E7.m1.3.3.3.3.cmml"><mo id="Sx3.E7.m1.3.3.3.2.3" xref="Sx3.E7.m1.3.3.3.3.1.cmml">{</mo><msub id="Sx3.E7.m1.2.2.2.1.1" xref="Sx3.E7.m1.2.2.2.1.1.cmml"><mi id="Sx3.E7.m1.2.2.2.1.1.2" xref="Sx3.E7.m1.2.2.2.1.1.2.cmml">𝐮</mi><mi id="Sx3.E7.m1.2.2.2.1.1.3" xref="Sx3.E7.m1.2.2.2.1.1.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" stretchy="true" id="Sx3.E7.m1.3.3.3.2.4" xref="Sx3.E7.m1.3.3.3.3.1.cmml">|</mo><mrow id="Sx3.E7.m1.3.3.3.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.3.cmml"><mrow id="Sx3.E7.m1.3.3.3.2.2.1.1" xref="Sx3.E7.m1.3.3.3.2.2.1.1.cmml"><mrow id="Sx3.E7.m1.3.3.3.2.2.1.1.2" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.cmml"><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.4" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.5" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3a" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.6" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3b" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.7" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.7.cmml">k</mi><mo lspace="0.170em" rspace="0em" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3c" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml">​</mo><mtext id="Sx3.E7.m1.3.3.3.2.2.1.1.2.8" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.8a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3d" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml">​</mo><mrow id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.3.cmml"><mo id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.3" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.2" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.3" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.4" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.cmml"><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.2.cmml">𝐮</mi><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.3" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.3.cmml">a</mi></msub><mo id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.5" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.3.3.3.2.2.1.1.3" xref="Sx3.E7.m1.3.3.3.2.2.1.1.3.cmml">⩽</mo><mi id="Sx3.E7.m1.3.3.3.2.2.1.1.4" xref="Sx3.E7.m1.3.3.3.2.2.1.1.4.cmml">K</mi></mrow><mo id="Sx3.E7.m1.3.3.3.2.2.2.3" xref="Sx3.E7.m1.3.3.3.2.2.3a.cmml">,</mo><mrow id="Sx3.E7.m1.3.3.3.2.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.2.2.cmml"><mi id="Sx3.E7.m1.3.3.3.2.2.2.2.2" xref="Sx3.E7.m1.3.3.3.2.2.2.2.2.cmml">a</mi><mo id="Sx3.E7.m1.3.3.3.2.2.2.2.1" xref="Sx3.E7.m1.3.3.3.2.2.2.2.1.cmml">≠</mo><mi id="Sx3.E7.m1.3.3.3.2.2.2.2.3" xref="Sx3.E7.m1.3.3.3.2.2.2.2.3.cmml">k</mi></mrow></mrow><mo id="Sx3.E7.m1.3.3.3.2.5" xref="Sx3.E7.m1.3.3.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.3b"><apply id="Sx3.E7.m1.3.3.cmml" xref="Sx3.E7.m1.3.3"><eq id="Sx3.E7.m1.3.3.4.cmml" xref="Sx3.E7.m1.3.3.4"></eq><apply id="Sx3.E7.m1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1"><times id="Sx3.E7.m1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.2"></times><ci id="Sx3.E7.m1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.3">𝕊</ci><apply id="Sx3.E7.m1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.2">𝐮</ci><ci id="Sx3.E7.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="Sx3.E7.m1.3.3.3.3.cmml" xref="Sx3.E7.m1.3.3.3.2"><csymbol cd="latexml" id="Sx3.E7.m1.3.3.3.3.1.cmml" xref="Sx3.E7.m1.3.3.3.2.3">conditional-set</csymbol><apply id="Sx3.E7.m1.2.2.2.1.1.cmml" xref="Sx3.E7.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.1.1">subscript</csymbol><ci id="Sx3.E7.m1.2.2.2.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.1.1.2">𝐮</ci><ci id="Sx3.E7.m1.2.2.2.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.1.1.3">𝑎</ci></apply><apply id="Sx3.E7.m1.3.3.3.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.3.2.2.3a.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2.3">formulae-sequence</csymbol><apply id="Sx3.E7.m1.3.3.3.2.2.1.1.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1"><leq id="Sx3.E7.m1.3.3.3.2.2.1.1.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.3"></leq><apply id="Sx3.E7.m1.3.3.3.2.2.1.1.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2"><times id="Sx3.E7.m1.3.3.3.2.2.1.1.2.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.3"></times><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.4.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.4">𝑟</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.5.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.5">𝑎</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.6.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.6">𝑛</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.7.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.7">𝑘</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.8a.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.8"><mtext id="Sx3.E7.m1.3.3.3.2.2.1.1.2.8.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.8">sim</mtext></ci><interval closure="open" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2"><apply id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.2">𝐮</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.1.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.2">𝐮</ci><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.2.2.2.2.3">𝑎</ci></apply></interval></apply><ci id="Sx3.E7.m1.3.3.3.2.2.1.1.4.cmml" xref="Sx3.E7.m1.3.3.3.2.2.1.1.4">𝐾</ci></apply><apply id="Sx3.E7.m1.3.3.3.2.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2.2"><neq id="Sx3.E7.m1.3.3.3.2.2.2.2.1.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2.2.1"></neq><ci id="Sx3.E7.m1.3.3.3.2.2.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2.2.2">𝑎</ci><ci id="Sx3.E7.m1.3.3.3.2.2.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.2.2.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.3c">\displaystyle\mathbb{S}\left({{\mathbf{u}_{k}}}\right)=\left\{{\left.{{\mathbf{u}_{a}}}\right|rank\,\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)\leqslant K,a\neq k}\right\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx3.p1.3" class="ltx_p">If their number of experts exceeds that of the current client, the cloud recommends incorporating more effective experts into its submodel; otherwise, it suggests pruning underperforming experts. To fairly evaluate the effectiveness of all experts (including those within and outside the submodel), the cloud estimates their activation probabilities based on those of top-k most similar clients, formulated as:</p>
<table id="Sx6.EGx6" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="Sx3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.E8.m1.12" class="ltx_Math" alttext="\displaystyle{\left({{{\hat{p}}_{i,j}}}\right)_{{\mathbf{u}_{k}}}}=\frac{{\sum\limits_{{\mathbf{u}_{a}}\in\mathbb{S}\left({{\mathbf{u}_{k}}}\right)}{\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)\times{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}}}}{{\sum\limits_{{\mathbf{u}_{a}}\in\mathbb{S}\left({{\mathbf{u}_{k}}}\right)}{\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)}}}" display="block"><semantics id="Sx3.E8.m1.12a"><mrow id="Sx3.E8.m1.12.12" xref="Sx3.E8.m1.12.12.cmml"><msub id="Sx3.E8.m1.12.12.1" xref="Sx3.E8.m1.12.12.1.cmml"><mrow id="Sx3.E8.m1.12.12.1.1.1" xref="Sx3.E8.m1.12.12.1.1.1.1.cmml"><mo id="Sx3.E8.m1.12.12.1.1.1.2" xref="Sx3.E8.m1.12.12.1.1.1.1.cmml">(</mo><msub id="Sx3.E8.m1.12.12.1.1.1.1" xref="Sx3.E8.m1.12.12.1.1.1.1.cmml"><mover accent="true" id="Sx3.E8.m1.12.12.1.1.1.1.2" xref="Sx3.E8.m1.12.12.1.1.1.1.2.cmml"><mi id="Sx3.E8.m1.12.12.1.1.1.1.2.2" xref="Sx3.E8.m1.12.12.1.1.1.1.2.2.cmml">p</mi><mo id="Sx3.E8.m1.12.12.1.1.1.1.2.1" xref="Sx3.E8.m1.12.12.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="Sx3.E8.m1.2.2.2.4" xref="Sx3.E8.m1.2.2.2.3.cmml"><mi id="Sx3.E8.m1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.E8.m1.2.2.2.4.1" xref="Sx3.E8.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.E8.m1.2.2.2.2" xref="Sx3.E8.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E8.m1.12.12.1.1.1.3" xref="Sx3.E8.m1.12.12.1.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E8.m1.12.12.1.3" xref="Sx3.E8.m1.12.12.1.3.cmml"><mi id="Sx3.E8.m1.12.12.1.3.2" xref="Sx3.E8.m1.12.12.1.3.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.12.12.1.3.3" xref="Sx3.E8.m1.12.12.1.3.3.cmml">k</mi></msub></msub><mo id="Sx3.E8.m1.12.12.2" xref="Sx3.E8.m1.12.12.2.cmml">=</mo><mfrac id="Sx3.E8.m1.11.11" xref="Sx3.E8.m1.11.11.cmml"><mrow id="Sx3.E8.m1.8.8.6" xref="Sx3.E8.m1.8.8.6.cmml"><munder id="Sx3.E8.m1.8.8.6.7" xref="Sx3.E8.m1.8.8.6.7.cmml"><mo movablelimits="false" id="Sx3.E8.m1.8.8.6.7.2" xref="Sx3.E8.m1.8.8.6.7.2.cmml">∑</mo><mrow id="Sx3.E8.m1.3.3.1.1.1" xref="Sx3.E8.m1.3.3.1.1.1.cmml"><msub id="Sx3.E8.m1.3.3.1.1.1.3" xref="Sx3.E8.m1.3.3.1.1.1.3.cmml"><mi id="Sx3.E8.m1.3.3.1.1.1.3.2" xref="Sx3.E8.m1.3.3.1.1.1.3.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.3.3.1.1.1.3.3" xref="Sx3.E8.m1.3.3.1.1.1.3.3.cmml">a</mi></msub><mo id="Sx3.E8.m1.3.3.1.1.1.2" xref="Sx3.E8.m1.3.3.1.1.1.2.cmml">∈</mo><mrow id="Sx3.E8.m1.3.3.1.1.1.1" xref="Sx3.E8.m1.3.3.1.1.1.1.cmml"><mi id="Sx3.E8.m1.3.3.1.1.1.1.3" xref="Sx3.E8.m1.3.3.1.1.1.1.3.cmml">𝕊</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.3.3.1.1.1.1.2" xref="Sx3.E8.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.3.3.1.1.1.1.1.1" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="Sx3.E8.m1.3.3.1.1.1.1.1.1.2" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E8.m1.3.3.1.1.1.1.1.1.3" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="Sx3.E8.m1.8.8.6.6" xref="Sx3.E8.m1.8.8.6.6.cmml"><mrow id="Sx3.E8.m1.7.7.5.5.2" xref="Sx3.E8.m1.7.7.5.5.2.cmml"><mtext id="Sx3.E8.m1.7.7.5.5.2.4" xref="Sx3.E8.m1.7.7.5.5.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.7.7.5.5.2.3" xref="Sx3.E8.m1.7.7.5.5.2.3.cmml">​</mo><mrow id="Sx3.E8.m1.7.7.5.5.2.2.2" xref="Sx3.E8.m1.7.7.5.5.2.2.3.cmml"><mo id="Sx3.E8.m1.7.7.5.5.2.2.2.3" xref="Sx3.E8.m1.7.7.5.5.2.2.3.cmml">(</mo><msub id="Sx3.E8.m1.6.6.4.4.1.1.1.1" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1.cmml"><mi id="Sx3.E8.m1.6.6.4.4.1.1.1.1.2" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.6.6.4.4.1.1.1.1.3" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E8.m1.7.7.5.5.2.2.2.4" xref="Sx3.E8.m1.7.7.5.5.2.2.3.cmml">,</mo><msub id="Sx3.E8.m1.7.7.5.5.2.2.2.2" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2.cmml"><mi id="Sx3.E8.m1.7.7.5.5.2.2.2.2.2" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.7.7.5.5.2.2.2.2.3" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2.3.cmml">a</mi></msub><mo rspace="0.055em" id="Sx3.E8.m1.7.7.5.5.2.2.2.5" xref="Sx3.E8.m1.7.7.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Sx3.E8.m1.8.8.6.6.4" xref="Sx3.E8.m1.8.8.6.6.4.cmml">×</mo><msub id="Sx3.E8.m1.8.8.6.6.3" xref="Sx3.E8.m1.8.8.6.6.3.cmml"><mrow id="Sx3.E8.m1.8.8.6.6.3.1.1" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.cmml"><mo id="Sx3.E8.m1.8.8.6.6.3.1.1.2" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.cmml">(</mo><msub id="Sx3.E8.m1.8.8.6.6.3.1.1.1" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.cmml"><mi id="Sx3.E8.m1.8.8.6.6.3.1.1.1.2" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.2.cmml">p</mi><mrow id="Sx3.E8.m1.5.5.3.3.2.4" xref="Sx3.E8.m1.5.5.3.3.2.3.cmml"><mi id="Sx3.E8.m1.4.4.2.2.1.1" xref="Sx3.E8.m1.4.4.2.2.1.1.cmml">i</mi><mo id="Sx3.E8.m1.5.5.3.3.2.4.1" xref="Sx3.E8.m1.5.5.3.3.2.3.cmml">,</mo><mi id="Sx3.E8.m1.5.5.3.3.2.2" xref="Sx3.E8.m1.5.5.3.3.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E8.m1.8.8.6.6.3.1.1.3" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.cmml">)</mo></mrow><msub id="Sx3.E8.m1.8.8.6.6.3.3" xref="Sx3.E8.m1.8.8.6.6.3.3.cmml"><mi id="Sx3.E8.m1.8.8.6.6.3.3.2" xref="Sx3.E8.m1.8.8.6.6.3.3.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.8.8.6.6.3.3.3" xref="Sx3.E8.m1.8.8.6.6.3.3.3.cmml">a</mi></msub></msub></mrow></mrow><mrow id="Sx3.E8.m1.11.11.9" xref="Sx3.E8.m1.11.11.9.cmml"><munder id="Sx3.E8.m1.11.11.9.4" xref="Sx3.E8.m1.11.11.9.4.cmml"><mo movablelimits="false" id="Sx3.E8.m1.11.11.9.4.2" xref="Sx3.E8.m1.11.11.9.4.2.cmml">∑</mo><mrow id="Sx3.E8.m1.9.9.7.1.1" xref="Sx3.E8.m1.9.9.7.1.1.cmml"><msub id="Sx3.E8.m1.9.9.7.1.1.3" xref="Sx3.E8.m1.9.9.7.1.1.3.cmml"><mi id="Sx3.E8.m1.9.9.7.1.1.3.2" xref="Sx3.E8.m1.9.9.7.1.1.3.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.9.9.7.1.1.3.3" xref="Sx3.E8.m1.9.9.7.1.1.3.3.cmml">a</mi></msub><mo id="Sx3.E8.m1.9.9.7.1.1.2" xref="Sx3.E8.m1.9.9.7.1.1.2.cmml">∈</mo><mrow id="Sx3.E8.m1.9.9.7.1.1.1" xref="Sx3.E8.m1.9.9.7.1.1.1.cmml"><mi id="Sx3.E8.m1.9.9.7.1.1.1.3" xref="Sx3.E8.m1.9.9.7.1.1.1.3.cmml">𝕊</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.9.9.7.1.1.1.2" xref="Sx3.E8.m1.9.9.7.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.9.9.7.1.1.1.1.1" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.cmml"><mo id="Sx3.E8.m1.9.9.7.1.1.1.1.1.2" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.2" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.3" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E8.m1.9.9.7.1.1.1.1.1.3" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="Sx3.E8.m1.11.11.9.3" xref="Sx3.E8.m1.11.11.9.3.cmml"><mtext id="Sx3.E8.m1.11.11.9.3.4" xref="Sx3.E8.m1.11.11.9.3.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.11.11.9.3.3" xref="Sx3.E8.m1.11.11.9.3.3.cmml">​</mo><mrow id="Sx3.E8.m1.11.11.9.3.2.2" xref="Sx3.E8.m1.11.11.9.3.2.3.cmml"><mo id="Sx3.E8.m1.11.11.9.3.2.2.3" xref="Sx3.E8.m1.11.11.9.3.2.3.cmml">(</mo><msub id="Sx3.E8.m1.10.10.8.2.1.1.1" xref="Sx3.E8.m1.10.10.8.2.1.1.1.cmml"><mi id="Sx3.E8.m1.10.10.8.2.1.1.1.2" xref="Sx3.E8.m1.10.10.8.2.1.1.1.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.10.10.8.2.1.1.1.3" xref="Sx3.E8.m1.10.10.8.2.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E8.m1.11.11.9.3.2.2.4" xref="Sx3.E8.m1.11.11.9.3.2.3.cmml">,</mo><msub id="Sx3.E8.m1.11.11.9.3.2.2.2" xref="Sx3.E8.m1.11.11.9.3.2.2.2.cmml"><mi id="Sx3.E8.m1.11.11.9.3.2.2.2.2" xref="Sx3.E8.m1.11.11.9.3.2.2.2.2.cmml">𝐮</mi><mi id="Sx3.E8.m1.11.11.9.3.2.2.2.3" xref="Sx3.E8.m1.11.11.9.3.2.2.2.3.cmml">a</mi></msub><mo id="Sx3.E8.m1.11.11.9.3.2.2.5" xref="Sx3.E8.m1.11.11.9.3.2.3.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E8.m1.12b"><apply id="Sx3.E8.m1.12.12.cmml" xref="Sx3.E8.m1.12.12"><eq id="Sx3.E8.m1.12.12.2.cmml" xref="Sx3.E8.m1.12.12.2"></eq><apply id="Sx3.E8.m1.12.12.1.cmml" xref="Sx3.E8.m1.12.12.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.12.12.1.2.cmml" xref="Sx3.E8.m1.12.12.1">subscript</csymbol><apply id="Sx3.E8.m1.12.12.1.1.1.1.cmml" xref="Sx3.E8.m1.12.12.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.12.12.1.1.1.1.1.cmml" xref="Sx3.E8.m1.12.12.1.1.1">subscript</csymbol><apply id="Sx3.E8.m1.12.12.1.1.1.1.2.cmml" xref="Sx3.E8.m1.12.12.1.1.1.1.2"><ci id="Sx3.E8.m1.12.12.1.1.1.1.2.1.cmml" xref="Sx3.E8.m1.12.12.1.1.1.1.2.1">^</ci><ci id="Sx3.E8.m1.12.12.1.1.1.1.2.2.cmml" xref="Sx3.E8.m1.12.12.1.1.1.1.2.2">𝑝</ci></apply><list id="Sx3.E8.m1.2.2.2.3.cmml" xref="Sx3.E8.m1.2.2.2.4"><ci id="Sx3.E8.m1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1">𝑖</ci><ci id="Sx3.E8.m1.2.2.2.2.cmml" xref="Sx3.E8.m1.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E8.m1.12.12.1.3.cmml" xref="Sx3.E8.m1.12.12.1.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.12.12.1.3.1.cmml" xref="Sx3.E8.m1.12.12.1.3">subscript</csymbol><ci id="Sx3.E8.m1.12.12.1.3.2.cmml" xref="Sx3.E8.m1.12.12.1.3.2">𝐮</ci><ci id="Sx3.E8.m1.12.12.1.3.3.cmml" xref="Sx3.E8.m1.12.12.1.3.3">𝑘</ci></apply></apply><apply id="Sx3.E8.m1.11.11.cmml" xref="Sx3.E8.m1.11.11"><divide id="Sx3.E8.m1.11.11.10.cmml" xref="Sx3.E8.m1.11.11"></divide><apply id="Sx3.E8.m1.8.8.6.cmml" xref="Sx3.E8.m1.8.8.6"><apply id="Sx3.E8.m1.8.8.6.7.cmml" xref="Sx3.E8.m1.8.8.6.7"><csymbol cd="ambiguous" id="Sx3.E8.m1.8.8.6.7.1.cmml" xref="Sx3.E8.m1.8.8.6.7">subscript</csymbol><sum id="Sx3.E8.m1.8.8.6.7.2.cmml" xref="Sx3.E8.m1.8.8.6.7.2"></sum><apply id="Sx3.E8.m1.3.3.1.1.1.cmml" xref="Sx3.E8.m1.3.3.1.1.1"><in id="Sx3.E8.m1.3.3.1.1.1.2.cmml" xref="Sx3.E8.m1.3.3.1.1.1.2"></in><apply id="Sx3.E8.m1.3.3.1.1.1.3.cmml" xref="Sx3.E8.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.3.3.1.1.1.3.1.cmml" xref="Sx3.E8.m1.3.3.1.1.1.3">subscript</csymbol><ci id="Sx3.E8.m1.3.3.1.1.1.3.2.cmml" xref="Sx3.E8.m1.3.3.1.1.1.3.2">𝐮</ci><ci id="Sx3.E8.m1.3.3.1.1.1.3.3.cmml" xref="Sx3.E8.m1.3.3.1.1.1.3.3">𝑎</ci></apply><apply id="Sx3.E8.m1.3.3.1.1.1.1.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1"><times id="Sx3.E8.m1.3.3.1.1.1.1.2.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.2"></times><ci id="Sx3.E8.m1.3.3.1.1.1.1.3.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.3">𝕊</ci><apply id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.2">𝐮</ci><ci id="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.3.3.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="Sx3.E8.m1.8.8.6.6.cmml" xref="Sx3.E8.m1.8.8.6.6"><times id="Sx3.E8.m1.8.8.6.6.4.cmml" xref="Sx3.E8.m1.8.8.6.6.4"></times><apply id="Sx3.E8.m1.7.7.5.5.2.cmml" xref="Sx3.E8.m1.7.7.5.5.2"><times id="Sx3.E8.m1.7.7.5.5.2.3.cmml" xref="Sx3.E8.m1.7.7.5.5.2.3"></times><ci id="Sx3.E8.m1.7.7.5.5.2.4a.cmml" xref="Sx3.E8.m1.7.7.5.5.2.4"><mtext id="Sx3.E8.m1.7.7.5.5.2.4.cmml" xref="Sx3.E8.m1.7.7.5.5.2.4">sim</mtext></ci><interval closure="open" id="Sx3.E8.m1.7.7.5.5.2.2.3.cmml" xref="Sx3.E8.m1.7.7.5.5.2.2.2"><apply id="Sx3.E8.m1.6.6.4.4.1.1.1.1.cmml" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.6.6.4.4.1.1.1.1.1.cmml" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.6.6.4.4.1.1.1.1.2.cmml" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1.2">𝐮</ci><ci id="Sx3.E8.m1.6.6.4.4.1.1.1.1.3.cmml" xref="Sx3.E8.m1.6.6.4.4.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.E8.m1.7.7.5.5.2.2.2.2.cmml" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.7.7.5.5.2.2.2.2.1.cmml" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2">subscript</csymbol><ci id="Sx3.E8.m1.7.7.5.5.2.2.2.2.2.cmml" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2.2">𝐮</ci><ci id="Sx3.E8.m1.7.7.5.5.2.2.2.2.3.cmml" xref="Sx3.E8.m1.7.7.5.5.2.2.2.2.3">𝑎</ci></apply></interval></apply><apply id="Sx3.E8.m1.8.8.6.6.3.cmml" xref="Sx3.E8.m1.8.8.6.6.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.8.8.6.6.3.2.cmml" xref="Sx3.E8.m1.8.8.6.6.3">subscript</csymbol><apply id="Sx3.E8.m1.8.8.6.6.3.1.1.1.cmml" xref="Sx3.E8.m1.8.8.6.6.3.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.8.8.6.6.3.1.1.1.1.cmml" xref="Sx3.E8.m1.8.8.6.6.3.1.1">subscript</csymbol><ci id="Sx3.E8.m1.8.8.6.6.3.1.1.1.2.cmml" xref="Sx3.E8.m1.8.8.6.6.3.1.1.1.2">𝑝</ci><list id="Sx3.E8.m1.5.5.3.3.2.3.cmml" xref="Sx3.E8.m1.5.5.3.3.2.4"><ci id="Sx3.E8.m1.4.4.2.2.1.1.cmml" xref="Sx3.E8.m1.4.4.2.2.1.1">𝑖</ci><ci id="Sx3.E8.m1.5.5.3.3.2.2.cmml" xref="Sx3.E8.m1.5.5.3.3.2.2">𝑗</ci></list></apply><apply id="Sx3.E8.m1.8.8.6.6.3.3.cmml" xref="Sx3.E8.m1.8.8.6.6.3.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.8.8.6.6.3.3.1.cmml" xref="Sx3.E8.m1.8.8.6.6.3.3">subscript</csymbol><ci id="Sx3.E8.m1.8.8.6.6.3.3.2.cmml" xref="Sx3.E8.m1.8.8.6.6.3.3.2">𝐮</ci><ci id="Sx3.E8.m1.8.8.6.6.3.3.3.cmml" xref="Sx3.E8.m1.8.8.6.6.3.3.3">𝑎</ci></apply></apply></apply></apply><apply id="Sx3.E8.m1.11.11.9.cmml" xref="Sx3.E8.m1.11.11.9"><apply id="Sx3.E8.m1.11.11.9.4.cmml" xref="Sx3.E8.m1.11.11.9.4"><csymbol cd="ambiguous" id="Sx3.E8.m1.11.11.9.4.1.cmml" xref="Sx3.E8.m1.11.11.9.4">subscript</csymbol><sum id="Sx3.E8.m1.11.11.9.4.2.cmml" xref="Sx3.E8.m1.11.11.9.4.2"></sum><apply id="Sx3.E8.m1.9.9.7.1.1.cmml" xref="Sx3.E8.m1.9.9.7.1.1"><in id="Sx3.E8.m1.9.9.7.1.1.2.cmml" xref="Sx3.E8.m1.9.9.7.1.1.2"></in><apply id="Sx3.E8.m1.9.9.7.1.1.3.cmml" xref="Sx3.E8.m1.9.9.7.1.1.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.9.9.7.1.1.3.1.cmml" xref="Sx3.E8.m1.9.9.7.1.1.3">subscript</csymbol><ci id="Sx3.E8.m1.9.9.7.1.1.3.2.cmml" xref="Sx3.E8.m1.9.9.7.1.1.3.2">𝐮</ci><ci id="Sx3.E8.m1.9.9.7.1.1.3.3.cmml" xref="Sx3.E8.m1.9.9.7.1.1.3.3">𝑎</ci></apply><apply id="Sx3.E8.m1.9.9.7.1.1.1.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1"><times id="Sx3.E8.m1.9.9.7.1.1.1.2.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.2"></times><ci id="Sx3.E8.m1.9.9.7.1.1.1.3.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.3">𝕊</ci><apply id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.2">𝐮</ci><ci id="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.9.9.7.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="Sx3.E8.m1.11.11.9.3.cmml" xref="Sx3.E8.m1.11.11.9.3"><times id="Sx3.E8.m1.11.11.9.3.3.cmml" xref="Sx3.E8.m1.11.11.9.3.3"></times><ci id="Sx3.E8.m1.11.11.9.3.4a.cmml" xref="Sx3.E8.m1.11.11.9.3.4"><mtext id="Sx3.E8.m1.11.11.9.3.4.cmml" xref="Sx3.E8.m1.11.11.9.3.4">sim</mtext></ci><interval closure="open" id="Sx3.E8.m1.11.11.9.3.2.3.cmml" xref="Sx3.E8.m1.11.11.9.3.2.2"><apply id="Sx3.E8.m1.10.10.8.2.1.1.1.cmml" xref="Sx3.E8.m1.10.10.8.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.10.10.8.2.1.1.1.1.cmml" xref="Sx3.E8.m1.10.10.8.2.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.10.10.8.2.1.1.1.2.cmml" xref="Sx3.E8.m1.10.10.8.2.1.1.1.2">𝐮</ci><ci id="Sx3.E8.m1.10.10.8.2.1.1.1.3.cmml" xref="Sx3.E8.m1.10.10.8.2.1.1.1.3">𝑘</ci></apply><apply id="Sx3.E8.m1.11.11.9.3.2.2.2.cmml" xref="Sx3.E8.m1.11.11.9.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.11.11.9.3.2.2.2.1.cmml" xref="Sx3.E8.m1.11.11.9.3.2.2.2">subscript</csymbol><ci id="Sx3.E8.m1.11.11.9.3.2.2.2.2.cmml" xref="Sx3.E8.m1.11.11.9.3.2.2.2.2">𝐮</ci><ci id="Sx3.E8.m1.11.11.9.3.2.2.2.3.cmml" xref="Sx3.E8.m1.11.11.9.3.2.2.2.3">𝑎</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E8.m1.12c">\displaystyle{\left({{{\hat{p}}_{i,j}}}\right)_{{\mathbf{u}_{k}}}}=\frac{{\sum\limits_{{\mathbf{u}_{a}}\in\mathbb{S}\left({{\mathbf{u}_{k}}}\right)}{\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)\times{{\left({{p_{i,j}}}\right)}_{{\mathbf{u}_{a}}}}}}}{{\sum\limits_{{\mathbf{u}_{a}}\in\mathbb{S}\left({{\mathbf{u}_{k}}}\right)}{\text{sim}\left({{\mathbf{u}_{k}},{\mathbf{u}_{a}}}\right)}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.SSSx3.p1.4" class="ltx_p">Note that this is an exploratory adjustment. If the performance of the adjusted submodel does not improve, its structure will revert to the previous version and remain fixed thereafter.</p>
</div>
</section>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<figure id="Sx4.T1" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>End-to-end performance of different personalized methods in various FL settings.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx4.T1.st1" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(a) </span>Setting: Standard-Hetero-T</figcaption>
<table id="Sx4.T1.st1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T1.st1.1.1.1" class="ltx_tr">
<th id="Sx4.T1.st1.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st1.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.1.1.1.1.1" class="ltx_p" style="width:65.4pt;"><span id="Sx4.T1.st1.1.1.1.1.1.1.1" class="ltx_text">Method</span></span>
</span>
</th>
<th id="Sx4.T1.st1.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Performance</th>
<th id="Sx4.T1.st1.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st1.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.1.1.3.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st1.1.1.1.3.1.1.1" class="ltx_text">
<span id="Sx4.T1.st1.1.1.1.3.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st1.1.1.1.3.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st1.1.1.1.3.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Comm.</span></span>
<span id="Sx4.T1.st1.1.1.1.3.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st1.1.1.1.3.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Vol. (GB)</span></span>
</span></span></span>
</span>
</th>
<th id="Sx4.T1.st1.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st1.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.1.1.4.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st1.1.1.1.4.1.1.1" class="ltx_text">
<span id="Sx4.T1.st1.1.1.1.4.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st1.1.1.1.4.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st1.1.1.1.4.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Mem.</span></span>
<span id="Sx4.T1.st1.1.1.1.4.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st1.1.1.1.4.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Usage (GB)</span></span>
</span></span></span>
</span>
</th>
</tr>
<tr id="Sx4.T1.st1.1.2.2" class="ltx_tr">
<th id="Sx4.T1.st1.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.1.1.1" class="ltx_p" style="width:65.4pt;"></span>
</span>
</th>
<th id="Sx4.T1.st1.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.2.1.1" class="ltx_p" style="width:14.2pt;">task-TC</span>
</span>
</th>
<th id="Sx4.T1.st1.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.3.1.1" class="ltx_p" style="width:14.2pt;">task-RC</span>
</span>
</th>
<th id="Sx4.T1.st1.1.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.4.1.1" class="ltx_p" style="width:14.2pt;">task-TS</span>
</span>
</th>
<th id="Sx4.T1.st1.1.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.5.1.1" class="ltx_p" style="width:31.3pt;"></span>
</span>
</th>
<th id="Sx4.T1.st1.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st1.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.2.2.6.1.1" class="ltx_p" style="width:45.5pt;"></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T1.st1.1.3.1" class="ltx_tr">
<td id="Sx4.T1.st1.1.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.1.1.1" class="ltx_p" style="width:65.4pt;">randomMoE</span>
</span>
</td>
<td id="Sx4.T1.st1.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.2.1.1" class="ltx_p" style="width:14.2pt;">91.63</span>
</span>
</td>
<td id="Sx4.T1.st1.1.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.3.1.1" class="ltx_p" style="width:14.2pt;">84.23</span>
</span>
</td>
<td id="Sx4.T1.st1.1.3.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.4.1.1" class="ltx_p" style="width:14.2pt;">14.51</span>
</span>
</td>
<td id="Sx4.T1.st1.1.3.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st1.1.3.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st1.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.3.1.6.1.1" class="ltx_p" style="width:45.5pt;">15.63</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st1.1.4.2" class="ltx_tr">
<td id="Sx4.T1.st1.1.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.1.1.1" class="ltx_p" style="width:65.4pt;">FedProx</span>
</span>
</td>
<td id="Sx4.T1.st1.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.2.1.1" class="ltx_p" style="width:14.2pt;">92.92</span>
</span>
</td>
<td id="Sx4.T1.st1.1.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.3.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st1.1.4.2.3.1.1.1" class="ltx_text ltx_font_bold">87.99</span></span>
</span>
</td>
<td id="Sx4.T1.st1.1.4.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.4.1.1" class="ltx_p" style="width:14.2pt;">11.94</span>
</span>
</td>
<td id="Sx4.T1.st1.1.4.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st1.1.4.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.4.2.6.1.1" class="ltx_p" style="width:45.5pt;">24.71</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st1.1.5.3" class="ltx_tr">
<td id="Sx4.T1.st1.1.5.3.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.1.1.1" class="ltx_p" style="width:65.4pt;">SCAFFOLD</span>
</span>
</td>
<td id="Sx4.T1.st1.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.2.1.1" class="ltx_p" style="width:14.2pt;">85.98</span>
</span>
</td>
<td id="Sx4.T1.st1.1.5.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.3.1.1" class="ltx_p" style="width:14.2pt;">69.44</span>
</span>
</td>
<td id="Sx4.T1.st1.1.5.3.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.4.1.1" class="ltx_p" style="width:14.2pt;">5.86</span>
</span>
</td>
<td id="Sx4.T1.st1.1.5.3.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.5.1.1" class="ltx_p" style="width:31.3pt;">4.61</span>
</span>
</td>
<td id="Sx4.T1.st1.1.5.3.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.5.3.6.1.1" class="ltx_p" style="width:45.5pt;">17.29</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st1.1.6.4" class="ltx_tr">
<td id="Sx4.T1.st1.1.6.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.1.1.1" class="ltx_p" style="width:65.4pt;">FedMoE (Ours)</span>
</span>
</td>
<td id="Sx4.T1.st1.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.2.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st1.1.6.4.2.1.1.1" class="ltx_text ltx_font_bold">94.76</span></span>
</span>
</td>
<td id="Sx4.T1.st1.1.6.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.3.1.1" class="ltx_p" style="width:14.2pt;">86.64</span>
</span>
</td>
<td id="Sx4.T1.st1.1.6.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.4.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st1.1.6.4.4.1.1.1" class="ltx_text ltx_font_bold">16.92</span></span>
</span>
</td>
<td id="Sx4.T1.st1.1.6.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.5.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st1.1.6.4.5.1.1.1" class="ltx_text ltx_font_bold">1.76</span></span>
</span>
</td>
<td id="Sx4.T1.st1.1.6.4.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st1.1.6.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st1.1.6.4.6.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st1.1.6.4.6.1.1.1" class="ltx_text ltx_font_bold">13.44</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx4.T1.st2" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(b) </span>Setting: Standard-Hetero-TD</figcaption>
<table id="Sx4.T1.st2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T1.st2.1.1.1" class="ltx_tr">
<th id="Sx4.T1.st2.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st2.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.1.1.1.1.1" class="ltx_p" style="width:65.4pt;"><span id="Sx4.T1.st2.1.1.1.1.1.1.1" class="ltx_text">Method</span></span>
</span>
</th>
<th id="Sx4.T1.st2.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Performance</th>
<th id="Sx4.T1.st2.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st2.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.1.1.3.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st2.1.1.1.3.1.1.1" class="ltx_text">
<span id="Sx4.T1.st2.1.1.1.3.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st2.1.1.1.3.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st2.1.1.1.3.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Comm.</span></span>
<span id="Sx4.T1.st2.1.1.1.3.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st2.1.1.1.3.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Vol. (GB)</span></span>
</span></span></span>
</span>
</th>
<th id="Sx4.T1.st2.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st2.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.1.1.4.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st2.1.1.1.4.1.1.1" class="ltx_text">
<span id="Sx4.T1.st2.1.1.1.4.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st2.1.1.1.4.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st2.1.1.1.4.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Mem.</span></span>
<span id="Sx4.T1.st2.1.1.1.4.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st2.1.1.1.4.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Usage (GB)</span></span>
</span></span></span>
</span>
</th>
</tr>
<tr id="Sx4.T1.st2.1.2.2" class="ltx_tr">
<th id="Sx4.T1.st2.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.1.1.1" class="ltx_p" style="width:65.4pt;"></span>
</span>
</th>
<th id="Sx4.T1.st2.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.2.1.1" class="ltx_p" style="width:14.2pt;">task-TC</span>
</span>
</th>
<th id="Sx4.T1.st2.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.3.1.1" class="ltx_p" style="width:14.2pt;">task-RC</span>
</span>
</th>
<th id="Sx4.T1.st2.1.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.4.1.1" class="ltx_p" style="width:14.2pt;">task-TS</span>
</span>
</th>
<th id="Sx4.T1.st2.1.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.5.1.1" class="ltx_p" style="width:31.3pt;"></span>
</span>
</th>
<th id="Sx4.T1.st2.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st2.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.2.2.6.1.1" class="ltx_p" style="width:45.5pt;"></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T1.st2.1.3.1" class="ltx_tr">
<td id="Sx4.T1.st2.1.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.1.1.1" class="ltx_p" style="width:65.4pt;">randomMoE</span>
</span>
</td>
<td id="Sx4.T1.st2.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.2.1.1" class="ltx_p" style="width:14.2pt;">34.19</span>
</span>
</td>
<td id="Sx4.T1.st2.1.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.3.1.1" class="ltx_p" style="width:14.2pt;">82.93</span>
</span>
</td>
<td id="Sx4.T1.st2.1.3.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.4.1.1" class="ltx_p" style="width:14.2pt;">13.51</span>
</span>
</td>
<td id="Sx4.T1.st2.1.3.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st2.1.3.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st2.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.3.1.6.1.1" class="ltx_p" style="width:45.5pt;">15.56</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st2.1.4.2" class="ltx_tr">
<td id="Sx4.T1.st2.1.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.1.1.1" class="ltx_p" style="width:65.4pt;">FedProx</span>
</span>
</td>
<td id="Sx4.T1.st2.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.2.1.1" class="ltx_p" style="width:14.2pt;">85.09</span>
</span>
</td>
<td id="Sx4.T1.st2.1.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.3.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st2.1.4.2.3.1.1.1" class="ltx_text ltx_font_bold">87.57</span></span>
</span>
</td>
<td id="Sx4.T1.st2.1.4.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.4.1.1" class="ltx_p" style="width:14.2pt;">11.76</span>
</span>
</td>
<td id="Sx4.T1.st2.1.4.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st2.1.4.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.4.2.6.1.1" class="ltx_p" style="width:45.5pt;">24.63</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st2.1.5.3" class="ltx_tr">
<td id="Sx4.T1.st2.1.5.3.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.1.1.1" class="ltx_p" style="width:65.4pt;">SCAFFOLD</span>
</span>
</td>
<td id="Sx4.T1.st2.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.2.1.1" class="ltx_p" style="width:14.2pt;">61.72</span>
</span>
</td>
<td id="Sx4.T1.st2.1.5.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.3.1.1" class="ltx_p" style="width:14.2pt;">67.17</span>
</span>
</td>
<td id="Sx4.T1.st2.1.5.3.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.4.1.1" class="ltx_p" style="width:14.2pt;">5.83</span>
</span>
</td>
<td id="Sx4.T1.st2.1.5.3.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.5.1.1" class="ltx_p" style="width:31.3pt;">4.61</span>
</span>
</td>
<td id="Sx4.T1.st2.1.5.3.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.5.3.6.1.1" class="ltx_p" style="width:45.5pt;">17.23</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st2.1.6.4" class="ltx_tr">
<td id="Sx4.T1.st2.1.6.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.1.1.1" class="ltx_p" style="width:65.4pt;">FedMoE (Ours)</span>
</span>
</td>
<td id="Sx4.T1.st2.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.2.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st2.1.6.4.2.1.1.1" class="ltx_text ltx_font_bold">88.44</span></span>
</span>
</td>
<td id="Sx4.T1.st2.1.6.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.3.1.1" class="ltx_p" style="width:14.2pt;">86.55</span>
</span>
</td>
<td id="Sx4.T1.st2.1.6.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.4.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st2.1.6.4.4.1.1.1" class="ltx_text ltx_font_bold">16.63</span></span>
</span>
</td>
<td id="Sx4.T1.st2.1.6.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.5.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st2.1.6.4.5.1.1.1" class="ltx_text ltx_font_bold">1.85</span></span>
</span>
</td>
<td id="Sx4.T1.st2.1.6.4.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st2.1.6.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st2.1.6.4.6.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st2.1.6.4.6.1.1.1" class="ltx_text ltx_font_bold">13.89</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx4.T1.st3" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(c) </span>Setting: Enforced-Hetero-T</figcaption>
<table id="Sx4.T1.st3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T1.st3.1.1.1" class="ltx_tr">
<th id="Sx4.T1.st3.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st3.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.1.1.1.1.1" class="ltx_p" style="width:65.4pt;"><span id="Sx4.T1.st3.1.1.1.1.1.1.1" class="ltx_text">Method</span></span>
</span>
</th>
<th id="Sx4.T1.st3.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Performance</th>
<th id="Sx4.T1.st3.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st3.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.1.1.3.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st3.1.1.1.3.1.1.1" class="ltx_text">
<span id="Sx4.T1.st3.1.1.1.3.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st3.1.1.1.3.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st3.1.1.1.3.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Comm.</span></span>
<span id="Sx4.T1.st3.1.1.1.3.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st3.1.1.1.3.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Vol. (GB)</span></span>
</span></span></span>
</span>
</th>
<th id="Sx4.T1.st3.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st3.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.1.1.4.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st3.1.1.1.4.1.1.1" class="ltx_text">
<span id="Sx4.T1.st3.1.1.1.4.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st3.1.1.1.4.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st3.1.1.1.4.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Mem.</span></span>
<span id="Sx4.T1.st3.1.1.1.4.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st3.1.1.1.4.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Usage (GB)</span></span>
</span></span></span>
</span>
</th>
</tr>
<tr id="Sx4.T1.st3.1.2.2" class="ltx_tr">
<th id="Sx4.T1.st3.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.1.1.1" class="ltx_p" style="width:65.4pt;"></span>
</span>
</th>
<th id="Sx4.T1.st3.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.2.1.1" class="ltx_p" style="width:14.2pt;">task-TC</span>
</span>
</th>
<th id="Sx4.T1.st3.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.3.1.1" class="ltx_p" style="width:14.2pt;">task-RC</span>
</span>
</th>
<th id="Sx4.T1.st3.1.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.4.1.1" class="ltx_p" style="width:14.2pt;">task-TS</span>
</span>
</th>
<th id="Sx4.T1.st3.1.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.5.1.1" class="ltx_p" style="width:31.3pt;"></span>
</span>
</th>
<th id="Sx4.T1.st3.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st3.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.2.2.6.1.1" class="ltx_p" style="width:45.5pt;"></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T1.st3.1.3.1" class="ltx_tr">
<td id="Sx4.T1.st3.1.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.1.1.1" class="ltx_p" style="width:65.4pt;">randomMoE</span>
</span>
</td>
<td id="Sx4.T1.st3.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.2.1.1" class="ltx_p" style="width:14.2pt;">88.86</span>
</span>
</td>
<td id="Sx4.T1.st3.1.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.3.1.1" class="ltx_p" style="width:14.2pt;">82.68</span>
</span>
</td>
<td id="Sx4.T1.st3.1.3.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.4.1.1" class="ltx_p" style="width:14.2pt;">14.37</span>
</span>
</td>
<td id="Sx4.T1.st3.1.3.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st3.1.3.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st3.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.3.1.6.1.1" class="ltx_p" style="width:45.5pt;">15.44</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st3.1.4.2" class="ltx_tr">
<td id="Sx4.T1.st3.1.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.1.1.1" class="ltx_p" style="width:65.4pt;">FedProx</span>
</span>
</td>
<td id="Sx4.T1.st3.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.2.1.1" class="ltx_p" style="width:14.2pt;">92.51</span>
</span>
</td>
<td id="Sx4.T1.st3.1.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.3.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st3.1.4.2.3.1.1.1" class="ltx_text ltx_font_bold">86.69</span></span>
</span>
</td>
<td id="Sx4.T1.st3.1.4.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.4.1.1" class="ltx_p" style="width:14.2pt;">11.88</span>
</span>
</td>
<td id="Sx4.T1.st3.1.4.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st3.1.4.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.4.2.6.1.1" class="ltx_p" style="width:45.5pt;">24.55</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st3.1.5.3" class="ltx_tr">
<td id="Sx4.T1.st3.1.5.3.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.1.1.1" class="ltx_p" style="width:65.4pt;">SCAFFOLD</span>
</span>
</td>
<td id="Sx4.T1.st3.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.2.1.1" class="ltx_p" style="width:14.2pt;">36.17</span>
</span>
</td>
<td id="Sx4.T1.st3.1.5.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.3.1.1" class="ltx_p" style="width:14.2pt;">72.51</span>
</span>
</td>
<td id="Sx4.T1.st3.1.5.3.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.4.1.1" class="ltx_p" style="width:14.2pt;">6.78</span>
</span>
</td>
<td id="Sx4.T1.st3.1.5.3.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.5.1.1" class="ltx_p" style="width:31.3pt;">4.61</span>
</span>
</td>
<td id="Sx4.T1.st3.1.5.3.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.5.3.6.1.1" class="ltx_p" style="width:45.5pt;">17.21</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st3.1.6.4" class="ltx_tr">
<td id="Sx4.T1.st3.1.6.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.1.1.1" class="ltx_p" style="width:65.4pt;">FedMoE (Ours)</span>
</span>
</td>
<td id="Sx4.T1.st3.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.2.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st3.1.6.4.2.1.1.1" class="ltx_text ltx_font_bold">94.85</span></span>
</span>
</td>
<td id="Sx4.T1.st3.1.6.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.3.1.1" class="ltx_p" style="width:14.2pt;">85.79</span>
</span>
</td>
<td id="Sx4.T1.st3.1.6.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.4.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st3.1.6.4.4.1.1.1" class="ltx_text ltx_font_bold">17.19</span></span>
</span>
</td>
<td id="Sx4.T1.st3.1.6.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.5.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st3.1.6.4.5.1.1.1" class="ltx_text ltx_font_bold">1.89</span></span>
</span>
</td>
<td id="Sx4.T1.st3.1.6.4.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st3.1.6.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st3.1.6.4.6.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st3.1.6.4.6.1.1.1" class="ltx_text ltx_font_bold">13.78</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Sx4.T1.st4" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(d) </span>Setting: Enforced-Hetero-TD</figcaption>
<table id="Sx4.T1.st4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T1.st4.1.1.1" class="ltx_tr">
<th id="Sx4.T1.st4.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st4.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.1.1.1.1.1" class="ltx_p" style="width:65.4pt;"><span id="Sx4.T1.st4.1.1.1.1.1.1.1" class="ltx_text">Method</span></span>
</span>
</th>
<th id="Sx4.T1.st4.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Performance</th>
<th id="Sx4.T1.st4.1.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st4.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.1.1.3.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st4.1.1.1.3.1.1.1" class="ltx_text">
<span id="Sx4.T1.st4.1.1.1.3.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st4.1.1.1.3.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st4.1.1.1.3.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Comm.</span></span>
<span id="Sx4.T1.st4.1.1.1.3.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st4.1.1.1.3.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Vol. (GB)</span></span>
</span></span></span>
</span>
</th>
<th id="Sx4.T1.st4.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="Sx4.T1.st4.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.1.1.4.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st4.1.1.1.4.1.1.1" class="ltx_text">
<span id="Sx4.T1.st4.1.1.1.4.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.st4.1.1.1.4.1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.st4.1.1.1.4.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Mem.</span></span>
<span id="Sx4.T1.st4.1.1.1.4.1.1.1.1.2" class="ltx_tr">
<span id="Sx4.T1.st4.1.1.1.4.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Usage (GB)</span></span>
</span></span></span>
</span>
</th>
</tr>
<tr id="Sx4.T1.st4.1.2.2" class="ltx_tr">
<th id="Sx4.T1.st4.1.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.1.1.1" class="ltx_p" style="width:65.4pt;"></span>
</span>
</th>
<th id="Sx4.T1.st4.1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.2.1.1" class="ltx_p" style="width:14.2pt;">task-TC</span>
</span>
</th>
<th id="Sx4.T1.st4.1.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.3.1.1" class="ltx_p" style="width:14.2pt;">task-RC</span>
</span>
</th>
<th id="Sx4.T1.st4.1.2.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.4.1.1" class="ltx_p" style="width:14.2pt;">task-TS</span>
</span>
</th>
<th id="Sx4.T1.st4.1.2.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.5.1.1" class="ltx_p" style="width:31.3pt;"></span>
</span>
</th>
<th id="Sx4.T1.st4.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T1.st4.1.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.2.2.6.1.1" class="ltx_p" style="width:45.5pt;"></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T1.st4.1.3.1" class="ltx_tr">
<td id="Sx4.T1.st4.1.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.1.1.1" class="ltx_p" style="width:65.4pt;">randomMoE</span>
</span>
</td>
<td id="Sx4.T1.st4.1.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.2.1.1" class="ltx_p" style="width:14.2pt;">37.81</span>
</span>
</td>
<td id="Sx4.T1.st4.1.3.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.3.1.1" class="ltx_p" style="width:14.2pt;">82.61</span>
</span>
</td>
<td id="Sx4.T1.st4.1.3.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.4.1.1" class="ltx_p" style="width:14.2pt;">13.80</span>
</span>
</td>
<td id="Sx4.T1.st4.1.3.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st4.1.3.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T1.st4.1.3.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.3.1.6.1.1" class="ltx_p" style="width:45.5pt;">15.45</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st4.1.4.2" class="ltx_tr">
<td id="Sx4.T1.st4.1.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.1.1.1" class="ltx_p" style="width:65.4pt;">FedProx</span>
</span>
</td>
<td id="Sx4.T1.st4.1.4.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.2.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st4.1.4.2.2.1.1.1" class="ltx_text ltx_font_bold ltx_align_center">73.85</span></span>
</span>
</td>
<td id="Sx4.T1.st4.1.4.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.3.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st4.1.4.2.3.1.1.1" class="ltx_text ltx_font_bold">86.59</span></span>
</span>
</td>
<td id="Sx4.T1.st4.1.4.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.4.1.1" class="ltx_p" style="width:14.2pt;">12.03</span>
</span>
</td>
<td id="Sx4.T1.st4.1.4.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.5.1.1" class="ltx_p" style="width:31.3pt;">2.30</span>
</span>
</td>
<td id="Sx4.T1.st4.1.4.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.4.2.6.1.1" class="ltx_p" style="width:45.5pt;">24.51</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st4.1.5.3" class="ltx_tr">
<td id="Sx4.T1.st4.1.5.3.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.1.1.1" class="ltx_p" style="width:65.4pt;">SCAFFOLD</span>
</span>
</td>
<td id="Sx4.T1.st4.1.5.3.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.2.1.1" class="ltx_p" style="width:14.2pt;">69.34</span>
</span>
</td>
<td id="Sx4.T1.st4.1.5.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.3.1.1" class="ltx_p" style="width:14.2pt;">70.69</span>
</span>
</td>
<td id="Sx4.T1.st4.1.5.3.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.4.1.1" class="ltx_p" style="width:14.2pt;">6.96</span>
</span>
</td>
<td id="Sx4.T1.st4.1.5.3.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.5.1.1" class="ltx_p" style="width:31.3pt;">4.61</span>
</span>
</td>
<td id="Sx4.T1.st4.1.5.3.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.5.3.6.1.1" class="ltx_p" style="width:45.5pt;">17.18</span>
</span>
</td>
</tr>
<tr id="Sx4.T1.st4.1.6.4" class="ltx_tr">
<td id="Sx4.T1.st4.1.6.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.1.1.1" class="ltx_p" style="width:65.4pt;">FedMoE (Ours)</span>
</span>
</td>
<td id="Sx4.T1.st4.1.6.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.2.1.1" class="ltx_p" style="width:14.2pt;">73.56</span>
</span>
</td>
<td id="Sx4.T1.st4.1.6.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.3.1.1" class="ltx_p" style="width:14.2pt;">85.84</span>
</span>
</td>
<td id="Sx4.T1.st4.1.6.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.4.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T1.st4.1.6.4.4.1.1.1" class="ltx_text ltx_font_bold">16.78</span></span>
</span>
</td>
<td id="Sx4.T1.st4.1.6.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.5.1.1" class="ltx_p" style="width:31.3pt;"><span id="Sx4.T1.st4.1.6.4.5.1.1.1" class="ltx_text ltx_font_bold">1.95</span></span>
</span>
</td>
<td id="Sx4.T1.st4.1.6.4.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T1.st4.1.6.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T1.st4.1.6.4.6.1.1" class="ltx_p" style="width:45.5pt;"><span id="Sx4.T1.st4.1.6.4.6.1.1.1" class="ltx_text ltx_font_bold">14.04</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Experimental Setups</h3>

<section id="Sx4.SSx1.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">FL Simulations</h4>

<div id="Sx4.SSx1.SSSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx1.p1.1" class="ltx_p">We create four FL simulations based on three classic NLP downstream datasets, including AG News <cite class="ltx_cite ltx_citemacro_citep">(Zhang, Zhao, and LeCun <a href="#bib.bib51" title="" class="ltx_ref">2015</a>)</cite> for text classification (task-TC), SQuAD <cite class="ltx_cite ltx_citemacro_citep">(Rajpurkar et al. <a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> for reading comprehension (task-RC) and XSum <cite class="ltx_cite ltx_citemacro_citep">(Narayan, Cohen, and Lapata <a href="#bib.bib27" title="" class="ltx_ref">2018</a>)</cite> for text summarization (task-TS). The evaluation metrics are accuracy, F1 score and Rouge-2 score, respectively. Each simulation setting mimics a complex real-world scenario. (1) <span id="Sx4.SSx1.SSSx1.p1.1.1" class="ltx_text ltx_font_bold">Standard-Hetero-T</span> involves 30 clients with heterogeneous tasks, and 5 clients are randomly selected for training each round. (2) <span id="Sx4.SSx1.SSSx1.p1.1.2" class="ltx_text ltx_font_bold">Standard-Hetero-TD</span> further introduces data heterogeneity by assigning label-skewed non-IID datasets to clients with identical tasks, following the methodology in FedNLP <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>. (3) <span id="Sx4.SSx1.SSSx1.p1.1.3" class="ltx_text ltx_font_bold">Enforced-Hetero-T</span> simulates a more conflicting scenario by forcibly selecting 3 clients with different task types in each training round, using the same 30-client setup as in Standard-Hetero-T. (4) <span id="Sx4.SSx1.SSSx1.p1.1.4" class="ltx_text ltx_font_bold">Enforced-Hetero-TD</span> adopts conflicting client selection scheme and uses the same 30-client setup as in Standard-Hetero-TD. The clients in the above settings are resource-heterogeneous, with memory capacities ranging from 18GB to 24GB, typical of high-performance smartphones and edge computing platforms.</p>
</div>
</section>
<section id="Sx4.SSx1.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Baselines</h4>

<div id="Sx4.SSx1.SSSx2.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx2.p1.1" class="ltx_p">We compare <span id="Sx4.SSx1.SSSx2.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> with three personalized FL methods: (1) <span id="Sx4.SSx1.SSSx2.p1.1.2" class="ltx_text ltx_font_bold">randomMoE</span> constructs personalized edge models by randomly selecting a subset of experts from the global MoE, ensuring a degree of information isolation among clients. (2) <span id="Sx4.SSx1.SSSx2.p1.1.3" class="ltx_text ltx_font_bold">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> is a federated optimization algorithm that incorporates a regularization term during local updates to mitigate the impacts of heterogeneity. (3) <span id="Sx4.SSx1.SSSx2.p1.1.4" class="ltx_text ltx_font_bold">SCAFFOLD</span> <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al. <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite> employs control variates to correct the local update directions, overcoming client-drift caused by heterogeneous data.</p>
</div>
</section>
<section id="Sx4.SSx1.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Models</h4>

<div id="Sx4.SSx1.SSSx3.p1" class="ltx_para">
<p id="Sx4.SSx1.SSSx3.p1.1" class="ltx_p">The following experiments are conducted based on Switch Transformers architecture whose pre-trained weights are downloaded directly from Hugging Face <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al. <a href="#bib.bib42" title="" class="ltx_ref">2019</a>)</cite>. The global models for <span id="Sx4.SSx1.SSSx3.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> and randomMoE are configured with 32 experts per layer, whereas others are configured with 8 experts per layer due to edge device memory constraints.</p>
</div>
</section>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">End-to-End Performance</h3>

<figure id="Sx4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx4.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x9.png" id="Sx4.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Performance on task-TC</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx4.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x10.png" id="Sx4.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Performance on task-RC</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx4.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x11.png" id="Sx4.F4.sf3.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Performance on task-TS</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx4.F4.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x12.png" id="Sx4.F4.sf4.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Communication volume</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="Sx4.F4.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.11304/assets/x13.png" id="Sx4.F4.sf5.g1" class="ltx_graphics ltx_img_landscape" width="538" height="403" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Peak memory usage</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>End-to-end performance of different personalized methods during training under Enforced-Hetero-T setting.</figcaption>
</figure>
<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.1" class="ltx_p">Table <a href="#Sx4.T1" title="Table 1 ‣ Experiments ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes end-to-end performance of four methods in various FL settings, including task performance, communication volume and peak memory usage. Figure <a href="#Sx4.F4" title="Figure 4 ‣ End-to-End Performance ‣ Experiments ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the end-to-end performance throughout the training process in one of the settings.
From the results, we draw four key observations as follows:</p>
</div>
<div id="Sx4.SSx2.p2" class="ltx_para">
<p id="Sx4.SSx2.p2.1" class="ltx_p"><span id="Sx4.SSx2.p2.1.1" class="ltx_text ltx_font_bold">FedMoE outperforms baselines in overall task performance.</span>
<span id="Sx4.SSx2.p2.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> typically demonstrates comparable or superior performance across various tasks, achieving average improvements of 7.63%, 15.50%, 10.00%, and 12.74% over the best-performing baseline in the four settings. Notably, for complex tasks such as task-TS, <span id="Sx4.SSx2.p2.1.3" class="ltx_text ltx_font_typewriter">FedMoE</span> beats the best baseline non-trivially with improvements of up to 23.09%, effectively avoiding the knowledge interference between different tasks that occurs in FedProx and SCAFFOLD.</p>
</div>
<div id="Sx4.SSx2.p3" class="ltx_para">
<p id="Sx4.SSx2.p3.1" class="ltx_p"><span id="Sx4.SSx2.p3.1.1" class="ltx_text ltx_font_bold">FedMoE achieves faster convergence.</span>
Figures <a href="#Sx4.F4.sf1" title="In Figure 4 ‣ End-to-End Performance ‣ Experiments ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a>–<a href="#Sx4.F4.sf3" title="In Figure 4 ‣ End-to-End Performance ‣ Experiments ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(c)</span></a> illustrate the convergence process across various task types in Enforced-Hetero-T Setting. To achieve 99% of the relative target performance, <span id="Sx4.SSx2.p3.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> demonstrates a speedup of 1.65×, 2.13×, and 1.64× compared to the three baselines, and 1.35×, 2.06×, and 2.92× for 90% of the target performance.</p>
</div>
<div id="Sx4.SSx2.p4" class="ltx_para">
<p id="Sx4.SSx2.p4.1" class="ltx_p"><span id="Sx4.SSx2.p4.1.1" class="ltx_text ltx_font_bold">FedMoE reduces communication overhead and memory usage significantly, making personalized FL resource-efficient.</span>
The communication overhead of <span id="Sx4.SSx2.p4.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> decreases by 19.11%, 19.11%, and 59.56% on average compared to the three baselines, and memory consumption decreases by 11.16%, 43.95%, and 19.97%, respectively.
The optimization methods in FedProx and SCAFFOLD introduce additional memory and communication overheads, which are accumulated during long-term FL training. In contrast, the cost of FedMoE is negligible, with only a one-time roundtrip communication of about 7.46GB and a memory overhead of approximately 13.06GB that lasts for only a few rounds in the first stage.</p>
</div>
<div id="Sx4.SSx2.p5" class="ltx_para">
<p id="Sx4.SSx2.p5.1" class="ltx_p"><span id="Sx4.SSx2.p5.1.1" class="ltx_text ltx_font_bold">FedMoE demonstrates strong robustness and stable performance in complex scenarios.</span>
We calculate the Coefficient of Variation (CV), denoted as <math id="Sx4.SSx2.p5.1.m1.1" class="ltx_Math" alttext="{c_{v}}=\frac{\sigma}{\mu}" display="inline"><semantics id="Sx4.SSx2.p5.1.m1.1a"><mrow id="Sx4.SSx2.p5.1.m1.1.1" xref="Sx4.SSx2.p5.1.m1.1.1.cmml"><msub id="Sx4.SSx2.p5.1.m1.1.1.2" xref="Sx4.SSx2.p5.1.m1.1.1.2.cmml"><mi id="Sx4.SSx2.p5.1.m1.1.1.2.2" xref="Sx4.SSx2.p5.1.m1.1.1.2.2.cmml">c</mi><mi id="Sx4.SSx2.p5.1.m1.1.1.2.3" xref="Sx4.SSx2.p5.1.m1.1.1.2.3.cmml">v</mi></msub><mo id="Sx4.SSx2.p5.1.m1.1.1.1" xref="Sx4.SSx2.p5.1.m1.1.1.1.cmml">=</mo><mfrac id="Sx4.SSx2.p5.1.m1.1.1.3" xref="Sx4.SSx2.p5.1.m1.1.1.3.cmml"><mi id="Sx4.SSx2.p5.1.m1.1.1.3.2" xref="Sx4.SSx2.p5.1.m1.1.1.3.2.cmml">σ</mi><mi id="Sx4.SSx2.p5.1.m1.1.1.3.3" xref="Sx4.SSx2.p5.1.m1.1.1.3.3.cmml">μ</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p5.1.m1.1b"><apply id="Sx4.SSx2.p5.1.m1.1.1.cmml" xref="Sx4.SSx2.p5.1.m1.1.1"><eq id="Sx4.SSx2.p5.1.m1.1.1.1.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.1"></eq><apply id="Sx4.SSx2.p5.1.m1.1.1.2.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx2.p5.1.m1.1.1.2.1.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.2">subscript</csymbol><ci id="Sx4.SSx2.p5.1.m1.1.1.2.2.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.2.2">𝑐</ci><ci id="Sx4.SSx2.p5.1.m1.1.1.2.3.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.2.3">𝑣</ci></apply><apply id="Sx4.SSx2.p5.1.m1.1.1.3.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.3"><divide id="Sx4.SSx2.p5.1.m1.1.1.3.1.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.3"></divide><ci id="Sx4.SSx2.p5.1.m1.1.1.3.2.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.3.2">𝜎</ci><ci id="Sx4.SSx2.p5.1.m1.1.1.3.3.cmml" xref="Sx4.SSx2.p5.1.m1.1.1.3.3">𝜇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p5.1.m1.1c">{c_{v}}=\frac{\sigma}{\mu}</annotation></semantics></math>, across various settings for each task and use the average value as the Composite Variation Index (CVI) to assess the robustness of each method. <span id="Sx4.SSx2.p5.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> with a notably small CVI of 0.0445 and FedProx with a CVI of 0.0569 exhibit relatively stable performance, whereas randomMoE with a CVI of 0.1827 and SCAFFOLD with a CVI of 0.1430 exhibit erratic performance. <span id="Sx4.SSx2.p5.1.3" class="ltx_text ltx_font_typewriter">FedMoE</span> benefits significantly from selecting the most relevant subset of experts for different settings.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Ablation Study</h3>

<figure id="Sx4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation study under Standard-Hetero-T setting.</figcaption>
<table id="Sx4.T2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T2.2.3.1" class="ltx_tr">
<th id="Sx4.T2.2.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_tt">
<span id="Sx4.T2.2.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.3.1.1.1.1" class="ltx_p" style="width:48.4pt;"><span id="Sx4.T2.2.3.1.1.1.1.1" class="ltx_text">Method</span></span>
</span>
</th>
<th id="Sx4.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="3">Performance</th>
<th id="Sx4.T2.2.3.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" colspan="2">Expert Num</th>
</tr>
<tr id="Sx4.T2.2.4.2" class="ltx_tr">
<th id="Sx4.T2.2.4.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row">
<span id="Sx4.T2.2.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.1.1.1" class="ltx_p" style="width:48.4pt;"></span>
</span>
</th>
<th id="Sx4.T2.2.4.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T2.2.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.2.1.1" class="ltx_p" style="width:14.2pt;">task-TC</span>
</span>
</th>
<th id="Sx4.T2.2.4.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T2.2.4.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.3.1.1" class="ltx_p" style="width:14.2pt;">task-RC</span>
</span>
</th>
<th id="Sx4.T2.2.4.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T2.2.4.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.4.1.1" class="ltx_p" style="width:14.2pt;">task-TS</span>
</span>
</th>
<th id="Sx4.T2.2.4.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T2.2.4.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.5.1.1" class="ltx_p" style="width:42.7pt;"><span id="Sx4.T2.2.4.2.5.1.1.1" class="ltx_text">Avg.</span></span>
</span>
</th>
<th id="Sx4.T2.2.4.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="Sx4.T2.2.4.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.4.2.6.1.1" class="ltx_p" style="width:34.1pt;"><span id="Sx4.T2.2.4.2.6.1.1.1" class="ltx_text">Min/Max</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T2.1.1" class="ltx_tr">
<th id="Sx4.T2.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="Sx4.T2.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.2.1.1" class="ltx_p" style="width:48.4pt;">FedMoE</span>
</span>
</th>
<td id="Sx4.T2.1.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T2.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.3.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T2.1.1.3.1.1.1" class="ltx_text ltx_font_bold">94.76</span></span>
</span>
</td>
<td id="Sx4.T2.1.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T2.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.4.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T2.1.1.4.1.1.1" class="ltx_text ltx_font_bold">86.64</span></span>
</span>
</td>
<td id="Sx4.T2.1.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T2.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.5.1.1" class="ltx_p" style="width:14.2pt;"><span id="Sx4.T2.1.1.5.1.1.1" class="ltx_text ltx_font_bold">16.92</span></span>
</span>
</td>
<td id="Sx4.T2.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.1.1.1" class="ltx_p" style="width:42.7pt;"><span id="Sx4.T2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">78 <math id="Sx4.T2.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="Sx4.T2.1.1.1.1.1.1.m1.1a"><mo stretchy="false" id="Sx4.T2.1.1.1.1.1.1.m1.1.1" xref="Sx4.T2.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.1.1.1.1.1.1.m1.1b"><ci id="Sx4.T2.1.1.1.1.1.1.m1.1.1.cmml" xref="Sx4.T2.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.1.1.1.1.1.1.m1.1c">\rightarrow</annotation></semantics></math> 65</span></span>
</span>
</td>
<td id="Sx4.T2.1.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_t">
<span id="Sx4.T2.1.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.1.1.6.1.1" class="ltx_p" style="width:34.1pt;"><span id="Sx4.T2.1.1.6.1.1.1" class="ltx_text ltx_font_bold">52/92</span></span>
</span>
</td>
</tr>
<tr id="Sx4.T2.2.2" class="ltx_tr">
<th id="Sx4.T2.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="Sx4.T2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.2.1.1" class="ltx_p" style="width:48.4pt;">w/o stage1</span>
</span>
</th>
<td id="Sx4.T2.2.2.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T2.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.3.1.1" class="ltx_p" style="width:14.2pt;">92.68</span>
</span>
</td>
<td id="Sx4.T2.2.2.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T2.2.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.4.1.1" class="ltx_p" style="width:14.2pt;">83.90</span>
</span>
</td>
<td id="Sx4.T2.2.2.5" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T2.2.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.5.1.1" class="ltx_p" style="width:14.2pt;">14.50</span>
</span>
</td>
<td id="Sx4.T2.2.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="Sx4.T2.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.1.1.1" class="ltx_p" style="width:42.7pt;">96 <math id="Sx4.T2.2.2.1.1.1.m1.1" class="ltx_centering" alttext="\rightarrow" display="inline"><semantics id="Sx4.T2.2.2.1.1.1.m1.1a"><mo stretchy="false" id="Sx4.T2.2.2.1.1.1.m1.1.1" xref="Sx4.T2.2.2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="Sx4.T2.2.2.1.1.1.m1.1b"><ci id="Sx4.T2.2.2.1.1.1.m1.1.1.cmml" xref="Sx4.T2.2.2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.2.2.1.1.1.m1.1c">\rightarrow</annotation></semantics></math> 104</span>
</span>
</td>
<td id="Sx4.T2.2.2.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top">
<span id="Sx4.T2.2.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.2.6.1.1" class="ltx_p" style="width:34.1pt;">94/118</span>
</span>
</td>
</tr>
<tr id="Sx4.T2.2.5.1" class="ltx_tr">
<th id="Sx4.T2.2.5.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb">
<span id="Sx4.T2.2.5.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.1.1.1" class="ltx_p" style="width:48.4pt;">w/o stage2</span>
</span>
</th>
<td id="Sx4.T2.2.5.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T2.2.5.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.2.1.1" class="ltx_p" style="width:14.2pt;">92.97</span>
</span>
</td>
<td id="Sx4.T2.2.5.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T2.2.5.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.3.1.1" class="ltx_p" style="width:14.2pt;">86.43</span>
</span>
</td>
<td id="Sx4.T2.2.5.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T2.2.5.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.4.1.1" class="ltx_p" style="width:14.2pt;">16.69</span>
</span>
</td>
<td id="Sx4.T2.2.5.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T2.2.5.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.5.1.1" class="ltx_p" style="width:42.7pt;">78</span>
</span>
</td>
<td id="Sx4.T2.2.5.1.6" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_bb">
<span id="Sx4.T2.2.5.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="Sx4.T2.2.5.1.6.1.1" class="ltx_p" style="width:34.1pt;">50/114</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">Table <a href="#Sx4.T2" title="Table 2 ‣ Ablation Study ‣ Experiments ‣ FedMoE: Personalized Federated Learning via Heterogeneous Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares <span id="Sx4.SSx3.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> to variants without either the first or second stage, showing task performance, the evolution of average expert numbers throughout training, and the maximum and minimum expert numbers of clients after training. The results indicate that both stages are vital for achieving strong performance, particularly the first stage where expert-activated information is collected. The second stage plays a pivotal role in adjusting the number of experts. When built upon the solid starting point provided by the first stage, it effectively prunes the redundant experts, thereby improving resource efficiency while maintaining strong performance. The two-stage training paradigm achieves an optimal balance between performance and resource consumption.</p>
</div>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<section id="Sx5.SSx3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Personalized Federated Learning (PFL).</h4>

<div id="Sx5.SSx3.SSSx1.p1" class="ltx_para">
<p id="Sx5.SSx3.SSSx1.p1.1" class="ltx_p">With the growing concern for data privacy and model efficiency, PFL has recently garnered extensive attention <cite class="ltx_cite ltx_citemacro_citep">(Vanhaesebrouck, Bellet, and Tommasi <a href="#bib.bib36" title="" class="ltx_ref">2017</a>; Tan et al. <a href="#bib.bib35" title="" class="ltx_ref">2022</a>; Sabah et al. <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>.
A common strategy is regularization, which adds penalty terms to the loss function or update direction to guide the training process <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib19" title="" class="ltx_ref">2020</a>; Yao and Sun <a href="#bib.bib47" title="" class="ltx_ref">2020</a>; Karimireddy et al. <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>.
However, it is sensitive to regularization parameters and difficult to generalize to complex scenarios.
Another approach is to build heterogeneous submodels for clients, utilizing techniques such as model distillation <cite class="ltx_cite ltx_citemacro_citep">(Ni, Shen, and Zhao <a href="#bib.bib28" title="" class="ltx_ref">2022</a>; Lin et al. <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Zhu et al. <a href="#bib.bib54" title="" class="ltx_ref">2022</a>)</cite>, pruning <cite class="ltx_cite ltx_citemacro_citep">(Ilhan, Su, and Liu <a href="#bib.bib12" title="" class="ltx_ref">2023</a>)</cite>, or quantization <cite class="ltx_cite ltx_citemacro_citep">(Ozkara et al. <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, allowing knowledge transfer between global model and submodels.
However, this approach depends on proxy data and may prolong the training process.
Parameter decoupling makes heterogeneous submodels more structured by separating the model into shared and personalized layers <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al. <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Wu et al. <a href="#bib.bib43" title="" class="ltx_ref">2021</a>; Ma et al. <a href="#bib.bib25" title="" class="ltx_ref">2022</a>; Mei et al. <a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite>. However, designing the optimal layer combination for each client is challenging.
Some studies allow clients to maintain their original heterogeneous models. The server then decomposes, groups, and aggregates these models based on module similarity <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib38" title="" class="ltx_ref">2024</a>, <a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite>. However, calculating modular similarity for large-scale models causes significant computational complexity.</p>
</div>
<div id="Sx5.SSx3.SSSx1.p2" class="ltx_para">
<p id="Sx5.SSx3.SSSx1.p2.1" class="ltx_p"><span id="Sx5.SSx3.SSSx1.p2.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> is one of the first PFL methods that supports LLMs with billion-scale parameters and can efficiently scale up, while previous methods are impractical for LLMs due to their complexity.</p>
</div>
</section>
<section id="Sx5.SSx3.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Mixture of Experts (MoE) Optimizations.</h4>

<div id="Sx5.SSx3.SSSx2.p1" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p1.1" class="ltx_p">MoE has demonstrated effectiveness in handling complex centralized learning issues, including multi-task <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib5" title="" class="ltx_ref">2023a</a>, <a href="#bib.bib6" title="" class="ltx_ref">b</a>)</cite>, multi-domain <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib52" title="" class="ltx_ref">2024</a>)</cite>, and multi-scenario <cite class="ltx_cite ltx_citemacro_citep">(Zou et al. <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>.
For example, AdaMV-MoE <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib5" title="" class="ltx_ref">2023a</a>)</cite> exhibits enhanced performance in multi-task vision recognition by automatically adjusting the number of experts for each task.
Although some FL studies draw inspiration from the MoE concept, they arbitrarily treat the global and local models as individual experts and simply combine their outputs <cite class="ltx_cite ltx_citemacro_citep">(Zec et al. <a href="#bib.bib49" title="" class="ltx_ref">2020</a>; Guo et al. <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Bai et al. <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; Zhang et al. <a href="#bib.bib50" title="" class="ltx_ref">2023</a>)</cite>. Experts at model granularity leads to limited flexibility and inadequate personalization.</p>
</div>
<div id="Sx5.SSx3.SSSx2.p2" class="ltx_para">
<p id="Sx5.SSx3.SSSx2.p2.1" class="ltx_p"><span id="Sx5.SSx3.SSSx2.p2.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> is the first to integrate MoE into FL for a generic and versatile FedLLM, while previous works involve managing a collection of models.</p>
</div>
</section>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusions</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p"><span id="Sx6.p1.1.1" class="ltx_text ltx_font_typewriter">FedMoE</span> addresses the challenges of data heterogeneity in FL by employing models with MoE architecture. Through personalized sub-MoE construction, modular aggregation, and dynamic model adjustments, <span id="Sx6.p1.1.2" class="ltx_text ltx_font_typewriter">FedMoE</span> enhances overall performance across diverse tasks, while significantly reducing memory footprint and network traffic. Empirical experiments demonstrate its effectiveness in cross-task scenarios.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G.; Aggarwal, V.; Singh, A. K.; and Choudhary, S. 2019.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022)</span>
<span class="ltx_bibblock">
Bai, T.; Zhang, Y.; Wang, Y.; Qin, Y.; and Zhang, F. 2022.

</span>
<span class="ltx_bibblock">Multi-site MRI classification using Weighted federated learning based on Mixture of Experts domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">2022 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</em>, 916–921. IEEE.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Bonawitz, K.; Eichner, H.; Grieskamp, W.; Huba, D.; Ingerman, A.; Ivanov, V.; Kiddon, C.; Konečnỳ, J.; Mazzocchi, S.; McMahan, B.; et al. 2019.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of machine learning and systems</em>, 1: 374–388.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2023)</span>
<span class="ltx_bibblock">
Cai, R.; Chen, X.; Liu, S.; Srinivasa, J.; Lee, M.; Kompella, R.; and Wang, Z. 2023.

</span>
<span class="ltx_bibblock">Many-task federated learning: A new problem setting and a simple baseline.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 5037–5045.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Chen, T.; Chen, X.; Du, X.; Rashwan, A.; Yang, F.; Chen, H.; Wang, Z.; and Li, Y. 2023a.

</span>
<span class="ltx_bibblock">Adamv-moe: Adaptive multi-task vision mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 17346–17357.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Chen, Z.; Shen, Y.; Ding, M.; Chen, Z.; Zhao, H.; Learned-Miller, E. G.; and Gan, C. 2023b.

</span>
<span class="ltx_bibblock">Mod-squad: Designing mixtures of experts as modular multi-task learners.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 11828–11837.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus, Dean, and Zoph (2022)</span>
<span class="ltx_bibblock">
Fedus, W.; Dean, J.; and Zoph, B. 2022.

</span>
<span class="ltx_bibblock">A review of sparse expert models in deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.01667</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus, Zoph, and Shazeer (2022)</span>
<span class="ltx_bibblock">
Fedus, W.; Zoph, B.; and Shazeer, N. 2022.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 23(120): 1–39.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2021)</span>
<span class="ltx_bibblock">
Guo, B.; Mei, Y.; Xiao, D.; and Wu, W. 2021.

</span>
<span class="ltx_bibblock">PFL-MoE: personalized federated learning based on mixture of experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Web and Big Data: 5th International Joint Conference, APWeb-WAIM 2021, Guangzhou, China, August 23–25, 2021, Proceedings, Part I 5</em>, 480–486. Springer.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2022)</span>
<span class="ltx_bibblock">
Gupta, S.; Mukherjee, S.; Subudhi, K.; Gonzalez, E.; Jose, D.; Awadallah, A. H.; and Gao, J. 2022.

</span>
<span class="ltx_bibblock">Sparsely activated mixture-of-experts are robust multi-task learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.07689</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Hu, E. J.; Shen, Y.; Wallis, P.; Allen-Zhu, Z.; Li, Y.; Wang, S.; Wang, L.; and Chen, W. 2021.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09685</em>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ilhan, Su, and Liu (2023)</span>
<span class="ltx_bibblock">
Ilhan, F.; Su, G.; and Liu, L. 2023.

</span>
<span class="ltx_bibblock">Scalefl: Resource-adaptive federated learning with heterogeneous clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 24532–24541.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024)</span>
<span class="ltx_bibblock">
Jiang, A. Q.; Sablayrolles, A.; Roux, A.; Mensch, A.; Savary, B.; Bamford, C.; Chaplot, D. S.; Casas, D. d. l.; Hanna, E. B.; Bressand, F.; et al. 2024.

</span>
<span class="ltx_bibblock">Mixtral of experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.04088</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P.; McMahan, H. B.; Avent, B.; Bellet, A.; Bennis, M.; Bhagoji, A. N.; Bonawitz, K.; Charles, Z.; Cormode, G.; Cummings, R.; et al. 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Foundations and trends® in machine learning</em>, 14(1–2): 1–210.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et al. (2020)</span>
<span class="ltx_bibblock">
Kaplan, J.; McCandlish, S.; Henighan, T.; Brown, T. B.; Chess, B.; Child, R.; Gray, S.; Radford, A.; Wu, J.; and Amodei, D. 2020.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.08361</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P.; Kale, S.; Mohri, M.; Reddi, S.; Stich, S.; and Suresh, A. T. 2020.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 5132–5143. PMLR.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2021)</span>
<span class="ltx_bibblock">
Kim, Y. J.; Awan, A. A.; Muzio, A.; Salinas, A. F. C.; Lu, L.; Hendy, A.; Rajbhandari, S.; He, Y.; and Awadalla, H. H. 2021.

</span>
<span class="ltx_bibblock">Scalable and efficient moe training for multitask multilingual models.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.10465</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krajewski et al. (2024)</span>
<span class="ltx_bibblock">
Krajewski, J.; Ludziejewski, J.; Adamczewski, K.; Pióro, M.; Krutul, M.; Antoniak, S.; Ciebiera, K.; Król, K.; Odrzygóźdź, T.; Sankowski, P.; et al. 2024.

</span>
<span class="ltx_bibblock">Scaling laws for fine-grained mixture of experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.07871</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V. 2020.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2: 429–450.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim et al. (2020)</span>
<span class="ltx_bibblock">
Lim, W. Y. B.; Luong, N. C.; Hoang, D. T.; Jiao, Y.; Liang, Y.-C.; Yang, Q.; Niyato, D.; and Miao, C. 2020.

</span>
<span class="ltx_bibblock">Federated learning in mobile edge networks: A comprehensive survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">IEEE communications surveys &amp; tutorials</em>, 22(3): 2031–2063.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2021)</span>
<span class="ltx_bibblock">
Lin, B. Y.; He, C.; Zeng, Z.; Wang, H.; Huang, Y.; Dupuy, C.; Gupta, R.; Soltanolkotabi, M.; Ren, X.; and Avestimehr, S. 2021.

</span>
<span class="ltx_bibblock">Fednlp: Benchmarking federated learning methods for natural language processing tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.08815</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, T.; Kong, L.; Stich, S. U.; and Jaggi, M. 2020.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33: 2351–2363.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Liu, Y.; Zhang, K.; Li, Y.; Yan, Z.; Gao, C.; Chen, R.; Yuan, Z.; Huang, Y.; Sun, H.; Gao, J.; et al. 2024.

</span>
<span class="ltx_bibblock">Sora: A review on background, technology, limitations, and opportunities of large vision models.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.17177</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2024)</span>
<span class="ltx_bibblock">
Lu, X.; Liu, Q.; Xu, Y.; Zhou, A.; Huang, S.; Zhang, B.; Yan, J.; and Li, H. 2024.

</span>
<span class="ltx_bibblock">Not All Experts are Equal: Efficient Expert Pruning and Skipping for Mixture-of-Experts Large Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.14800</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Ma, X.; Zhang, J.; Guo, S.; and Xu, W. 2022.

</span>
<span class="ltx_bibblock">Layer-wised model aggregation for personalized federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 10092–10101.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mei et al. (2021)</span>
<span class="ltx_bibblock">
Mei, Y.; Guo, B.; Xiao, D.; and Wu, W. 2021.

</span>
<span class="ltx_bibblock">Fedvf: Personalized federated learning based on layer-wise parameter updates with variable frequency.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">2021 IEEE International Performance, Computing, and Communications Conference (IPCCC)</em>, 1–9. IEEE.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayan, Cohen, and Lapata (2018)</span>
<span class="ltx_bibblock">
Narayan, S.; Cohen, S. B.; and Lapata, M. 2018.

</span>
<span class="ltx_bibblock">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1808.08745</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni, Shen, and Zhao (2022)</span>
<span class="ltx_bibblock">
Ni, X.; Shen, X.; and Zhao, H. 2022.

</span>
<span class="ltx_bibblock">Federated optimization via knowledge codistillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Expert Systems with Applications</em>, 191: 116310.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozkara et al. (2021)</span>
<span class="ltx_bibblock">
Ozkara, K.; Singh, N.; Data, D.; and Diggavi, S. 2021.

</span>
<span class="ltx_bibblock">Quped: Quantized personalization via distillation with applications to federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34: 3622–3634.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et al. (2022)</span>
<span class="ltx_bibblock">
Rajbhandari, S.; Li, C.; Yao, Z.; Zhang, M.; Aminabadi, R. Y.; Awan, A. A.; Rasley, J.; and He, Y. 2022.

</span>
<span class="ltx_bibblock">Deepspeed-moe: Advancing mixture-of-experts inference and training to power next-generation ai scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 18332–18346. PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajpurkar et al. (2016)</span>
<span class="ltx_bibblock">
Rajpurkar, P.; Zhang, J.; Lopyrev, K.; and Liang, P. 2016.

</span>
<span class="ltx_bibblock">Squad: 100,000+ questions for machine comprehension of text.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.05250</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sabah et al. (2023)</span>
<span class="ltx_bibblock">
Sabah, F.; Chen, Y.; Yang, Z.; Azam, M.; Ahmad, N.; and Sarwar, R. 2023.

</span>
<span class="ltx_bibblock">Model optimization techniques in personalized federated learning: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Expert Systems with Applications</em>, 122874.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et al. (2017)</span>
<span class="ltx_bibblock">
Shazeer, N.; Mirhoseini, A.; Maziarz, K.; Davis, A.; Le, Q.; Hinton, G.; and Dean, J. 2017.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1701.06538</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Sun, Z.; Yang, H.; Liu, K.; Yin, Z.; Li, Z.; and Xu, W. 2022.

</span>
<span class="ltx_bibblock">Recent advances in LoRa: A comprehensive survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Sensor Networks</em>, 18(4): 1–44.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Tan, A. Z.; Yu, H.; Cui, L.; and Yang, Q. 2022.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 34(12): 9587–9603.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vanhaesebrouck, Bellet, and Tommasi (2017)</span>
<span class="ltx_bibblock">
Vanhaesebrouck, P.; Bellet, A.; and Tommasi, M. 2017.

</span>
<span class="ltx_bibblock">Decentralized collaborative learning of personalized models over networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 509–517. PMLR.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villalobos et al. (2022)</span>
<span class="ltx_bibblock">
Villalobos, P.; Sevilla, J.; Heim, L.; Besiroglu, T.; Hobbhahn, M.; and Ho, A. 2022.

</span>
<span class="ltx_bibblock">Will we run out of data? an analysis of the limits of scaling datasets in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.04325</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Wang, J.; Yang, X.; Cui, S.; Che, L.; Lyu, L.; Xu, D. D.; and Ma, F. 2024.

</span>
<span class="ltx_bibblock">Towards personalized federated learning via heterogeneous model reassembly.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Wang, K.; He, Q.; Chen, F.; Chen, C.; Huang, F.; Jin, H.; and Yang, Y. 2023.

</span>
<span class="ltx_bibblock">Flexifed: Personalized federated learning for edge clients with heterogeneous model architectures.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM Web Conference 2023</em>, 2979–2990.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wikipedia (2024)</span>
<span class="ltx_bibblock">
Wikipedia. 2024.

</span>
<span class="ltx_bibblock">General Data Protection Regulation — Wikipedia, The Free Encyclopedia.

</span>
<span class="ltx_bibblock">[Online; accessed 27-June-2024].

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wikipedia contributors (2024)</span>
<span class="ltx_bibblock">
Wikipedia contributors. 2024.

</span>
<span class="ltx_bibblock">California Consumer Privacy Act — Wikipedia, The Free Encyclopedia.

</span>
<span class="ltx_bibblock">[Online; accessed 27-June-2024].

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2019)</span>
<span class="ltx_bibblock">
Wolf, T.; Debut, L.; Sanh, V.; Chaumond, J.; Delangue, C.; Moi, A.; Cistac, P.; Rault, T.; Louf, R.; Funtowicz, M.; et al. 2019.

</span>
<span class="ltx_bibblock">Huggingface’s transformers: State-of-the-art natural language processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03771</em>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Wu, J.; Liu, Q.; Huang, Z.; Ning, Y.; Wang, H.; Chen, E.; Yi, J.; and Zhou, B. 2021.

</span>
<span class="ltx_bibblock">Hierarchical personalized federated learning for user modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Web Conference 2021</em>, 957–968.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Wu, T.; He, S.; Liu, J.; Sun, S.; Liu, K.; Han, Q.-L.; and Tang, Y. 2023.

</span>
<span class="ltx_bibblock">A brief overview of ChatGPT: The history, status quo and potential future development.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">IEEE/CAA Journal of Automatica Sinica</em>, 10(5): 1122–1136.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Xu, M.; Cai, D.; Wu, Y.; Li, X.; and Wang, S. 2024.

</span>
<span class="ltx_bibblock"><math id="bib.bib45.1.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib45.1.m1.1a"><mo stretchy="false" id="bib.bib45.1.m1.1.1" xref="bib.bib45.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib45.1.m1.1b"><ci id="bib.bib45.1.m1.1.1.cmml" xref="bib.bib45.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib45.1.m1.1c">\{</annotation></semantics></math>FwdLLM<math id="bib.bib45.2.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib45.2.m2.1a"><mo stretchy="false" id="bib.bib45.2.m2.1.1" xref="bib.bib45.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib45.2.m2.1b"><ci id="bib.bib45.2.m2.1.1.cmml" xref="bib.bib45.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib45.2.m2.1c">\}</annotation></semantics></math>: Efficient Federated Finetuning of Large Language Models with Perturbed Inferences.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.3.1" class="ltx_emph ltx_font_italic">2024 USENIX Annual Technical Conference (USENIX ATC 24)</em>, 579–596.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2022)</span>
<span class="ltx_bibblock">
Yao, L.; Gao, D.; Wang, Z.; Xie, Y.; Kuang, W.; Chen, D.; Wang, H.; Dong, C.; Ding, B.; and Li, Y. 2022.

</span>
<span class="ltx_bibblock">A benchmark for federated hetero-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.03436</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao and Sun (2020)</span>
<span class="ltx_bibblock">
Yao, X.; and Sun, L. 2020.

</span>
<span class="ltx_bibblock">Continual local training for better initialization of federated models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">2020 IEEE International Conference on Image Processing (ICIP)</em>, 1736–1740. IEEE.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2023)</span>
<span class="ltx_bibblock">
Yi, R.; Guo, L.; Wei, S.; Zhou, A.; Wang, S.; and Xu, M. 2023.

</span>
<span class="ltx_bibblock">Edgemoe: Fast on-device inference of moe-based large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.14352</em>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zec et al. (2020)</span>
<span class="ltx_bibblock">
Zec, E. L.; Mogren, O.; Martinsson, J.; Sütfeld, L. R.; and Gillblad, D. 2020.

</span>
<span class="ltx_bibblock">Specialized federated learning using a mixture of experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.02056</em>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Zhang, C.; Meng, X.; Liu, Q.; Wu, S.; Wang, L.; and Ning, H. 2023.

</span>
<span class="ltx_bibblock">FedBrain: A robust multi-site brain network analysis framework based on federated learning for brain disease diagnosis.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, 559: 126791.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang, Zhao, and LeCun (2015)</span>
<span class="ltx_bibblock">
Zhang, X.; Zhao, J.; and LeCun, Y. 2015.

</span>
<span class="ltx_bibblock">Character-level convolutional networks for text classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 28.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhang, Z.; Liu, S.; Yu, J.; Cai, Q.; Zhao, X.; Zhang, C.; Liu, Z.; Liu, Q.; Zhao, H.; Hu, L.; et al. 2024.

</span>
<span class="ltx_bibblock">M3oE: Multi-Domain Multi-Task Mixture-of Experts Recommendation Framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2404.18465</em>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, H.; Xu, J.; Liu, S.; and Jin, Y. 2021.

</span>
<span class="ltx_bibblock">Federated learning on non-IID data: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, 465: 371–390.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2022)</span>
<span class="ltx_bibblock">
Zhu, Z.; Hong, J.; Drew, S.; and Zhou, J. 2022.

</span>
<span class="ltx_bibblock">Resilient and communication efficient learning for heterogeneous federated systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of machine learning research</em>, 162: 27504.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al. (2022)</span>
<span class="ltx_bibblock">
Zou, X.; Hu, Z.; Zhao, Y.; Ding, X.; Liu, Z.; Li, C.; and Sun, A. 2022.

</span>
<span class="ltx_bibblock">Automatic expert selection for multi-scenario and multi-task search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 1535–1544.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.11303" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.11304" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.11304">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.11304" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.11305" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 17:57:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
