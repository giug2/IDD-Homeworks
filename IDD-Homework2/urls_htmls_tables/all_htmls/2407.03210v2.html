<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Combining AI control systems and human decision support via robustness and criticality</title>
<!--Generated on Wed Oct  9 02:12:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.03210v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S1" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.SS1" title="In 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Building a Flexible Agent Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.SS2" title="In 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Finding Relevant Decision Boundaries with Adversarial Explanations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.SS3" title="In 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Identifying Critical Data with Strategically Similar Autoencoders</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.SS4" title="In 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Flagging Long-Term Consequences with Criticality and Safety Margins</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS1" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model Criticality</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS2" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Scenario 1: Obstacle Approaching from Left</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS3" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Scenario 2: Obstacle Approaching from Right</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS4" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Scenario 3: No Immediate Action Required</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS5" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Scenario 4: Non-Gridline-Aligned Obstacle</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.SS6" title="In 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Model Robustness</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S4" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Discussion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S5" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S6" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>RL Agent Differences from MuZero</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS1" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Balancing Pre-LayerNorm Activations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS2" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Gaussian Mixture Models for Distributional RL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS3" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Loss Segment Scaling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS4" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Complex Action Spaces via a Pairwise Policy Update</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS5" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Directly Controlling the Exploration/Exploitation Trade-Off via a Pairwise Policy Update</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS6" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Particle Swarm Tree Search</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS7" title="In Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.7 </span>Modified MuZero Value Representation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additions to Adversarial Explanations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS1" title="In Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Gradient Scale Correction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS2" title="In Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Optimizer Scale Correction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS3" title="In Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Controlling Regularization Strength</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS4" title="In Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Sparsity-Promoting Gradient-Minimization Function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A3" title="In Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Figures</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Combining AI control systems and human decision support via robustness and criticality</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Walt Woods
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Independent Scholar, USA <span class="ltx_text ltx_font_typewriter" id="id1.1.id1">woodswalben@gmail.com</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alexander Grushin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Galois, Inc., USA <span class="ltx_text ltx_font_typewriter" id="id2.1.id1">agrushin@galois.com</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simon Khan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Air Force Research Laboratory, USA <span class="ltx_text ltx_font_typewriter" id="id3.1.id1">simon.khan@us.af.mil</span>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alvaro Velasquez
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">University of Colorado Boulder, USA <span class="ltx_text ltx_font_typewriter" id="id4.1.id1">alvaro.velasquez@colorado.edu</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">AI-enabled capabilities are reaching the requisite level of maturity to be deployed in the real world. Yet, the ability of these systems to always make correct or safe decisions is a constant source of criticism and reluctance to use them. One way of addressing these concerns is to leverage AI control systems alongside and in support of human decisions, relying on the AI control system in safe situations while calling on a human co-decider for critical situations. Additionally, by leveraging an AI control system built specifically to assist in joint human/machine decisions, the opportunity naturally arises to then use human interactions to continuously improve the AI control system’s accuracy and robustness.</p>
<p class="ltx_p" id="id6.id2">We extend a methodology for adversarial explanations (AE) to state-of-the-art reinforcement learning frameworks, including MuZero. Multiple improvements to the base agent architecture are proposed. We demonstrate how this technology has two applications: for intelligent decision tools and to enhance training / learning frameworks. In a decision support context, adversarial explanations help a user make the correct decision by highlighting those contextual factors that would need to change for a different AI-recommended decision. As another benefit of adversarial explanations, we show that the learned AI control system demonstrates robustness against adversarial tampering. Additionally, we supplement AE by introducing strategically similar autoencoders (SSAs) to help users identify and understand all salient factors being considered by the AI system. In a training / learning framework, this technology can improve both the AI’s decisions and explanations through human interaction. Finally, to identify when AI decisions would most benefit from human oversight, we tie this combined system to our prior art on statistically verified analyses of the criticality of decisions at any point in time.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>adversarial explanations, adversarial robustness, autonomy, explainable machine learning, human machine teaming, intelligent decision tool, reinforcement learning, safety margins
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<span class="ltx_ERROR undefined" id="S1.p1.2">\AddToShipoutPictureFG</span>
<p class="ltx_p" id="S1.p1.1"><svg height="1578.05" overflow="visible" version="1.1" width="41.51"><g transform="translate(0,1578.05) scale(1,-1)"><g transform="translate(0,0)"><g transform="translate(0,221.253632212536) scale(1, -1)"><foreignobject height="0" overflow="visible" width="1.383700013837">
<div class="ltx_block ltx_align_top" id="S1.p1.1.pic1.1.1">
<p class="ltx_p" id="S1.p1.1.pic1.1.1.1"></p>
<p class="ltx_p" id="S1.p1.1.pic1.1.1.2"><span class="ltx_text ltx_inline-block" id="S1.p1.1.pic1.1.1.2.1" style="font-size:90%;width:0.0pt;">Published as:</span></p>
</div></foreignobject></g></g><g transform="translate(0,1578.05) scale(1, -1)"><foreignobject height="1578.05" overflow="visible" width="41.51"><span class="ltx_ERROR undefined" id="S1.p1.1.pic1.2">\AddToShipoutPictureFG</span></foreignobject></g><g transform="translate(0,0)"><g transform="translate(0,1051.47364051474) scale(1, -1)"><foreignobject height="0" overflow="visible" width="1.383700013837">
<div class="ltx_block ltx_align_top" id="S1.p1.1.pic1.3.1">
<p class="ltx_p" id="S1.p1.1.pic1.3.1.1"></p>
<p class="ltx_p" id="S1.p1.1.pic1.3.1.2"><span class="ltx_text ltx_inline-block" id="S1.p1.1.pic1.3.1.2.1" style="font-size:90%;width:0.0pt;">Walt Woods, Alexander Grushin, Simon Khan, and Alvaro Velasquez</span></p>
</div></foreignobject></g></g><g transform="translate(0,1578.05) scale(1, -1)"><foreignobject height="1578.05" overflow="visible" width="41.51"><span class="ltx_ERROR undefined" id="S1.p1.1.pic1.4">\AddToShipoutPictureFG</span></foreignobject></g><g transform="translate(0,0)"><g transform="translate(0,1503.11332503113) scale(1, -1)"><foreignobject height="0" overflow="visible" width="1.383700013837">
<div class="ltx_block ltx_align_top" id="S1.p1.1.pic1.5.1">
<p class="ltx_p" id="S1.p1.1.pic1.5.1.1"></p>
<p class="ltx_p" id="S1.p1.1.pic1.5.1.2"><span class="ltx_text ltx_inline-block" id="S1.p1.1.pic1.5.1.2.1" style="font-size:90%;width:0.0pt;">“Combining AI control systems and human decision support via robustness and criticality”</span></p>
</div></foreignobject></g></g><g transform="translate(0,1578.05) scale(1, -1)"><foreignobject height="1578.05" overflow="visible" width="41.51"><span class="ltx_ERROR undefined" id="S1.p1.1.pic1.6">\AddToShipoutPictureFG</span></foreignobject></g><g transform="translate(0,0)"><g transform="translate(0,1568.56233568562) scale(1, -1)"><foreignobject height="0" overflow="visible" width="1.383700013837">
<div class="ltx_block ltx_align_top" id="S1.p1.1.pic1.7.1">
<p class="ltx_p" id="S1.p1.1.pic1.7.1.1"></p>
<p class="ltx_p" id="S1.p1.1.pic1.7.1.2"><span class="ltx_text ltx_inline-block" id="S1.p1.1.pic1.7.1.2.1" style="font-size:90%;width:0.0pt;">Proc. SPIE 13058, Disruptive Technologies in Information Sciences VIII, 130580J (6 June 2024);</span></p>
</div></foreignobject></g></g><g transform="translate(0,1578.05) scale(1, -1)"><foreignobject height="1578.05" overflow="visible" width="41.51"><span class="ltx_ERROR undefined" id="S1.p1.1.pic1.8">\AddToShipoutPictureFG</span></foreignobject></g><g transform="translate(0,0)"><g transform="translate(0,29.057700290577) scale(1, -1)"><foreignobject height="0" overflow="visible" width="1.383700013837">
<div class="ltx_block ltx_align_top" id="S1.p1.1.pic1.9.1">
<p class="ltx_p" id="S1.p1.1.pic1.9.1.1"></p>
<p class="ltx_p" id="S1.p1.1.pic1.9.1.2"><span class="ltx_text ltx_inline-block" id="S1.p1.1.pic1.9.1.2.1" style="width:0.0pt;"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1117/12.3016311" style="font-size:90%;" title="">https://doi.org/10.1117/12.3016311</a></span></p>
</div></foreignobject></g></g></g></svg></p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1"><span class="ltx_glossaryref" title="">Reinforcement learning (RL)</span> can now produce <span class="ltx_glossaryref" title="">artificial intelligence (AI)</span> agents capable of superhuman performance in a wide range of tasks, as evidenced by the recently developed MuZero <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib1" title="">1</a>]</cite> and its more sample-efficient successor EfficientZero <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib2" title="">2</a>]</cite>. Despite these advances, current state-of-the-art <span class="ltx_glossaryref" title="">AI</span> agents can make very costly mistakes in real-world scenarios. For example, an <span class="ltx_glossaryref" title="">AI</span>-controlled car might misinterpret its environment for a few seconds, a mistake that has directly caused loss of life <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib3" title="">3</a>]</cite>. While these technologies are constantly improving, it is not clear when or if they will ever reach a level of autonomy where they can no longer benefit from collaborating with human decision makers, particularly in environments with decisions on a time scale of hours or days. Effectively, we posit that there will always be critical situations where human/machine teaming will result in more effective decisions than decisions made solely by human or <span class="ltx_glossaryref" title="">AI</span> elements.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">A traditional take on human/machine teaming for decision making considers a spectrum of automation, from zero machine involvement to zero human involvement. The automotive industry has codified this idea for autonomous automobiles, where levels are defined as increasing sets of capability that require less human attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib4" title="">4</a>]</cite>.
We instead look at providing a spectrum of <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">support</span> for human decisions, from minimal decision assistance to maximal decision assistance. This new framing focuses on using <span class="ltx_glossaryref" title="">AI</span> techniques in support of the best overall decisions, regardless of the autonomy capabilities of the <span class="ltx_glossaryref" title="">AI</span> system in isolation; the underlying goal is to maximally empower human decision making, rather than to automate the system as much as possible.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="318" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of our intelligent decision tool (IDT) effort. By combining base reinforcement learning (RL) improvements with the developments of adversarial explanations (AEs), strategically similar autoencoders (SSAs), and safety margins, users are shown detailed visual descriptions of key decision components, and provided tools to understand the long-term consequences of potential decisions. Since this information is guided by possible decisions as considered by the AI system, users have the opportunity to explore phenomena that would otherwise be unknown to the user.</figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Making good decisions relies, in part, on a good understanding of all available data. This is sometimes called “evidence-based” decision making. <span class="ltx_glossaryref" title="">Decision support tools (DSTs)</span> are an existing class of tool where a user can work on justifying any particular decision by asking specific queries of available data. The answers to those queries can in turn provoke additional questions from the user, and the user can repeat this data interaction loop indefinitely, until they are satisfied that they understand the situation enough to make a well-informed decision. This approach constitutes a relatively minimal level of decision assistance – it is purely driven by the user, meaning that the user can only explore questions that they know to ask. Colloquially, this means that <span class="ltx_glossaryref" title="">DSTs</span> help with known knowns and known unknowns, rather than unknown known/unknown factors. Such an approach has clear limitations when it comes to impactful decision making; notably, there are limitations to the idea of “evidence-based” decisions that result from complex environment interactions and unforeseeable events <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib5" title="">5</a>]</cite>. Still, with increasing computing power and availability of high-fidelity simulations, new possibilities arise for providing decision makers with tools that offer much more comprehensive decision assistance.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We propose a new class of tools leveraging <span class="ltx_glossaryref" title="">RL</span> agents that have been trained to make decisions based on available data, and then explaining them through <span class="ltx_glossaryref" title="">explainable artificial intelligence (XAI)</span> and related techniques. This approach results in tools that can consider complex environment interactions that might result from decisions made, as opposed to purely data-centric tools like <span class="ltx_glossaryref" title="">DSTs</span>.
The proposed tools can function as a fully autonomous decision system if desired, but importantly, focus on using those decision capabilities to quickly inform human decision-making partners about a situation’s full context. This results in a framework that supports both urgent and slow decisions, and can even identify when a human’s input in a decision is likely to make a significant difference in mission outcomes.
We call this new class of tools <span class="ltx_glossaryref" title="">intelligent decision tools (IDTs)</span>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In this work, we describe methods and techniques for building <span class="ltx_glossaryref" title="">IDTs</span> by leveraging prior work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite> and developing new techniques to produce highly detailed and accurate <span class="ltx_glossaryref" title="">XAI</span> for state-of-the-art, MuZero-style <span class="ltx_glossaryref" title="">RL</span> agents. An agent training and analysis framework was developed, providing a suite of tools to assist human decision makers in rapidly understanding a scenario and making decisions that fully leverage available data, while also supporting full automation. A brief illustration of the capabilities provided by this system is shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S1.F1" title="In 1 Introduction ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, with additional supporting examples in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3" title="3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">To assemble our <span class="ltx_glossaryref" title="">IDT</span> prototype, we developed and combined the methods described below. These techniques were designed specifically to produce a general purpose <span class="ltx_glossaryref" title="">IDT</span> for helping human decision makers fully leverage the decision-specific knowledge captured by the <span class="ltx_glossaryref" title="">RL</span> agent. To accomplish this, there were four main thrusts to our work:</p>
</div>
<div class="ltx_para" id="S2.p2">
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1">General <span class="ltx_glossaryref" title="">RL</span> extensions for building a flexible agent architecture that could be applied to any kind of reinforcement learning problem, while both retaining good learning performance and revealing as much information about the environment as possible.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1">Extending <span class="ltx_glossaryref" title="">adversarial explanation (AE)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite> to the <span class="ltx_glossaryref" title="">RL</span> domain to help users better understand different interpretations of available sensor data that would lead to different decision recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1">The creation of <span class="ltx_glossaryref" title="">strategically similar autoencoders (SSAs)</span> to help users identify which data is critical to understanding the strategic scenario observed by the <span class="ltx_glossaryref" title="">IDT</span>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1">Helping users understand the long-term consequences of a decision through criticality (which is defined informally as the reward that an agent can be expected to lose if it makes a certain number of mistakes in a particular situation), and safety margins (the number of mistakes that an agent can afford to make before the expected reward loss is significant)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Combining all of these methods resulted in an <span class="ltx_glossaryref" title="">IDT</span> that could help human users better understand key decision factors and the possible consequences of different decisions in any given situation.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Due to the number of techniques developed as part of this work, many of the techniques will only be briefly described. Much of the presented work is exploratory; further research would be required to fully determine the empirical advantages of our approaches. Relevant citations are provided that will help the reader better understand those parts of the system that are of interest to them.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Building a Flexible Agent Architecture</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">MuZero is a high-performing <span class="ltx_glossaryref" title="">RL</span> agent that holds many superhuman performance records <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib1" title="">1</a>]</cite>. While promising, that particular agent posed problems for some real-world applications for which, even through simulation, it would be prohibitively expensive to gather the needed 200 million or more data points to train the agent. Fortunately, an agent called EfficientZero presented a few improvements and was also able to surpass human capabilities, using only 100,000 data points <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib2" title="">2</a>]</cite>. While this is still a significant amount of required data, it made MuZero-style agents feasible for helping to make decisions in many more real-world environments.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.5">At its core, MuZero and EfficientZero both implement explicit <span class="ltx_glossaryref" title="">world models (WMs)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib9" title="">9</a>]</cite>. Unlike the original <span class="ltx_glossaryref" title="">WM</span> work, which used game state data at time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_t</annotation></semantics></math> to predict the game state at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS1.p2.2.m2.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><plus id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1"></plus><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑡</ci><cn id="S2.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_t + 1</annotation></semantics></math>, MuZero-style agents use information at time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_t</annotation></semantics></math> to predict only the agent’s <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.5.1">latent representation</span> of that game state at time <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">t</mi><mo id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><plus id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"></plus><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝑡</ci><cn id="S2.SS1.p2.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_t + 1</annotation></semantics></math>. This prediction is done implicitly, by optimizing the difference in expected immediate and future rewards from such a rollout. This means that the model can simulate future states, but only through its own strategic, latent interpretation of the world. These latent states are also parameterized by the action selected by the model at each time step, <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><msub id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">a</mi><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">𝑎</ci><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. By combining this <span class="ltx_glossaryref" title="">WM</span> simulation capability with <span class="ltx_glossaryref" title="">Monte-Carlo tree search (MCTS)</span>, a MuZero-style model can explore the consequences of different sequences of actions across multiple steps in time <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib1" title="">1</a>]</cite>. While not perfect, the performance of these agents speaks to the method’s utility.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">While MuZero performs very well, it has a number of limitations.
The limitations that we thought were most important to address in pursuit of our <span class="ltx_glossaryref" title="">IDT</span>, and our explorations into addressing those limitations, are discussed in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1" title="Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>. Briefly, the resulting improvements include: a new method for balancing pre-LayerNorm activations; a ranked Gaussian method for distributional <span class="ltx_glossaryref" title="">RL</span>; loss segment scaling for less sensitive hyperparameters in different environments; the handling of complex action spaces via a pairwise policy update; direct control of the exploration/exploitation trade-off via a pairwise policy update; a particle swarm tree search alternative to <span class="ltx_glossaryref" title="">MCTS</span>; and a modified MuZero value representation for easier model learning.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">With these enhancements in hand, the <span class="ltx_glossaryref" title="">IDT</span>’s agents successfully learned to execute tasks in a variety of environments.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Finding Relevant Decision Boundaries with Adversarial Explanations</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1"><span class="ltx_glossaryref" title="">AEs</span> are a technique for exploring a large number of counterfactuals to help better understand any given decision from an <span class="ltx_glossaryref" title="">AI</span> system. This is accomplished by conditioning <span class="ltx_glossaryref" title="">neural networks (NNs)</span> to be queried for decision boundaries that are close to a given input. For a full description of <span class="ltx_glossaryref" title="">AE</span>, see the work which established the technique <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>, and applied it to neural networks that were trained in a supervised way.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.2">In this work, we extended <span class="ltx_glossaryref" title="">AE</span> to <span class="ltx_glossaryref" title="">RL</span>. As discussed in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.SS1" title="2.1 Building a Flexible Agent Architecture ‣ 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">2.1</span></a>, this was done in the context of a MuZero-style agent, meaning that we also wanted explanations to work in the context of the dynamics function. Adapting the conditioning step of <span class="ltx_glossaryref" title="">AE</span> worked as follows: as in prior work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>, one parameter was chosen for each example in the training batch, using a random rollout time <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_τ</annotation></semantics></math>, and a random choice from the available <math alttext="Q" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_Q</annotation></semantics></math> and policy network outputs. The gradient of this parameter with respect to the inputs was computed, and some function of that gradient was added to the overall loss function, as in previous approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Multiple additions to the basic approach helped optimize performance in an <span class="ltx_glossaryref" title="">RL</span> setting. These were gradient scale correction, optimizer scale correction, a different approach for controlling the strength of the regularization, and a sparsity-promoting gradient-minimization function. Details of these methods may be found in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2" title="Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">Together, these improvements successfully allowed <span class="ltx_glossaryref" title="">AE</span> to be applied to <span class="ltx_glossaryref" title="">RL</span>. Highlights of <span class="ltx_glossaryref" title="">AE</span> in an <span class="ltx_glossaryref" title="">RL</span> context are shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.F2" title="In 2.2 Finding Relevant Decision Boundaries with Adversarial Explanations ‣ 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="198" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Adversarial explanations (AEs) provide a methodology for hardening <span class="ltx_glossaryref" title="">AI</span> systems against subtle manipulations and then using the hardened systems to find accurate, nearby decision boundaries that are semantically meaningful to human observers. The leftmost frame represents the original, unperturbed input; the agent chooses to move to the right, in order to avoid the obstacle to its left. The middle frame shows a perturbation to the input, made such that the agent chooses to move to the left instead; here, the obstacle has shifted to the right, as illustrated via red circles. The rightmost frame shows a perturbation made in order for the agent to keep moving forward (rather than left or right); here, the obstacle disappears altogether. These perturbations suggest that the agent’s decision is influenced directly by the obstacle.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Identifying Critical Data with Strategically Similar Autoencoders</h3>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="284" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Strategically similar autoencoders (SSAs) differ from standard autoencoders – rather than reconstructing the input, they reconstruct a family of inputs which the AI interprets as the same (reconstructing the same latent code). Through this process, data patterns that define the current strategy can be identified. These patterns are complementary to the patterns identified through <span class="ltx_glossaryref" title="">AEs</span>. As for <span class="ltx_glossaryref" title="">AEs</span>, the leftmost frame represents the original input, while the middle and right frames represent two different reconstructions of the input. Note that the obstacle and two enemy ships persist in both reconstructions, suggesting that they are important to the agent.</figcaption>
</figure>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In the original paper on <span class="ltx_glossaryref" title="">WMs</span>, Ha and Schmidhuber used autoencoders to compress the agent’s sensors into a latent representation that could be re-expanded to the original sensor representation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib9" title="">9</a>]</cite>. This classic use of autoencoders is a great way for identifying the most visually significant varying factors in sensory space, and compressing them. However, qualities of the input are retained based on visual similarity instead of their use in the task being handled by the <span class="ltx_glossaryref" title="">AI</span> system.
We note that MuZero’s adaptation of the <span class="ltx_glossaryref" title="">WM</span> work stopped propagating this explicitly reconstructable representation, instead focusing on propagating enough state to predict action probabilities and corresponding reward values <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib1" title="">1</a>]</cite>. From an agent efficacy point of view, this is advantageous, as exactly reconstructing the sensor inputs is irrelevant to task performance.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">For an <span class="ltx_glossaryref" title="">IDT</span> whose goal is to help human/machine teams make good decisions, reconstructing some version of the sensor input might be very useful. Specifically, reconstructing the parts of the input that the <span class="ltx_glossaryref" title="">AI</span> considers strategically important to any potential decisions would allow for a human to better understand which environmental factors the <span class="ltx_glossaryref" title="">AI</span> considers salient, and which ones it ignores. To address this, we developed <span class="ltx_glossaryref" title="">SSAs</span>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.4">The core insight for <span class="ltx_glossaryref" title="">SSAs</span> is that an autoencoder does not necessarily need to reconstruct the input. Instead, the same architecture may be used to reconstruct the latent decision space that MuZero uses to make decisions. That is, rather than using the classic autoencoder setup of inputs <math alttext="\to" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><mo id="S2.SS3.p3.1.m1.1.1" stretchy="false" xref="S2.SS3.p3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">→</annotation></semantics></math> latent <math alttext="\to" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><mo id="S2.SS3.p3.2.m2.1.1" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><ci id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">→</annotation></semantics></math> inputs, we instead follow latent <math alttext="\to" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><mo id="S2.SS3.p3.3.m3.1.1" stretchy="false" xref="S2.SS3.p3.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">→</annotation></semantics></math> inputs <math alttext="\to" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><mo id="S2.SS3.p3.4.m4.1.1" stretchy="false" xref="S2.SS3.p3.4.m4.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><ci id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">→</annotation></semantics></math> latent. This problem is fundamentally underconstrained; that is, by design, multiple inputs often map to a single latent code, as the differences between those inputs are not relevant to the <span class="ltx_glossaryref" title="">RL</span> agent’s task. Importantly, this function can be completely detached from the main <span class="ltx_glossaryref" title="">RL</span> agent’s learning process, giving us insight into the model without the need to affect the model’s learning.</p>
</div>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.2">To implement this, we combined ideas from StarGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib10" title="">10</a>]</cite>, WassersteinGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib11" title="">11</a>]</cite>, and VEEGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib12" title="">12</a>]</cite>. Briefly, the standard generator/discriminator relationship is trained as normal. However, using VEEGAN, we concatenate additional values to the latent code specifically for capturing variances not represented by the latent code. These variances are trained to not be useful in real/fake determination by making real examples look fake (similar to VEEGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib12" title="">12</a>]</cite>, but we found it easier to optimize this objective when using predicted variance for both real and fake examples). To ensure that these variances capture significant visual variety within the input, the style diversification loss from StarGAN is included <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib10" title="">10</a>]</cite>. With the latent code being included as input to VEEGAN, we noticed that VEEGAN could have a difficult time learning useful variances with the variance vector, mostly relying on the latent code. While the style diversification loss helps with this, we also introduced a version of L2 loss that supports Brownian motion of L2-style predictions (by default, L2 predicts the mean, which for the variance vector would be all zeros). We used a simple bias term to translate between L1- and L2-style loss, as <math alttext="\frac{\beta(a-b)^{2}}{\beta^{2}+d(a-b)^{2}}" class="ltx_Math" display="inline" id="S2.SS3.p4.1.m1.2"><semantics id="S2.SS3.p4.1.m1.2a"><mfrac id="S2.SS3.p4.1.m1.2.2" xref="S2.SS3.p4.1.m1.2.2.cmml"><mrow id="S2.SS3.p4.1.m1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.1.3.cmml">β</mi><mo id="S2.SS3.p4.1.m1.1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.1.2.cmml">⁢</mo><msup id="S2.SS3.p4.1.m1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.cmml"><mrow id="S2.SS3.p4.1.m1.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS3.p4.1.m1.1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.1.1.3.cmml">2</mn></msup></mrow><mrow id="S2.SS3.p4.1.m1.2.2.2" xref="S2.SS3.p4.1.m1.2.2.2.cmml"><msup id="S2.SS3.p4.1.m1.2.2.2.3" xref="S2.SS3.p4.1.m1.2.2.2.3.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.3.2" xref="S2.SS3.p4.1.m1.2.2.2.3.2.cmml">β</mi><mn id="S2.SS3.p4.1.m1.2.2.2.3.3" xref="S2.SS3.p4.1.m1.2.2.2.3.3.cmml">2</mn></msup><mo id="S2.SS3.p4.1.m1.2.2.2.2" xref="S2.SS3.p4.1.m1.2.2.2.2.cmml">+</mo><mrow id="S2.SS3.p4.1.m1.2.2.2.1" xref="S2.SS3.p4.1.m1.2.2.2.1.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.1.3" xref="S2.SS3.p4.1.m1.2.2.2.1.3.cmml">d</mi><mo id="S2.SS3.p4.1.m1.2.2.2.1.2" xref="S2.SS3.p4.1.m1.2.2.2.1.2.cmml">⁢</mo><msup id="S2.SS3.p4.1.m1.2.2.2.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.cmml"><mrow id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.2" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.2.cmml">a</mi><mo id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.3" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS3.p4.1.m1.2.2.2.1.1.3" xref="S2.SS3.p4.1.m1.2.2.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.2b"><apply id="S2.SS3.p4.1.m1.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2"><divide id="S2.SS3.p4.1.m1.2.2.3.cmml" xref="S2.SS3.p4.1.m1.2.2"></divide><apply id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1"><times id="S2.SS3.p4.1.m1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.2"></times><ci id="S2.SS3.p4.1.m1.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.3">𝛽</ci><apply id="S2.SS3.p4.1.m1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1">superscript</csymbol><apply id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1"><minus id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.3">𝑏</ci></apply><cn id="S2.SS3.p4.1.m1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p4.1.m1.1.1.1.1.3">2</cn></apply></apply><apply id="S2.SS3.p4.1.m1.2.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2"><plus id="S2.SS3.p4.1.m1.2.2.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.2"></plus><apply id="S2.SS3.p4.1.m1.2.2.2.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.3.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3">superscript</csymbol><ci id="S2.SS3.p4.1.m1.2.2.2.3.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.2">𝛽</ci><cn id="S2.SS3.p4.1.m1.2.2.2.3.3.cmml" type="integer" xref="S2.SS3.p4.1.m1.2.2.2.3.3">2</cn></apply><apply id="S2.SS3.p4.1.m1.2.2.2.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1"><times id="S2.SS3.p4.1.m1.2.2.2.1.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.2"></times><ci id="S2.SS3.p4.1.m1.2.2.2.1.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.3">𝑑</ci><apply id="S2.SS3.p4.1.m1.2.2.2.1.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.1.1.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1">superscript</csymbol><apply id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1"><minus id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.1"></minus><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.1.3">𝑏</ci></apply><cn id="S2.SS3.p4.1.m1.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS3.p4.1.m1.2.2.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.2c">\frac{\beta(a-b)^{2}}{\beta^{2}+d(a-b)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.2d">divide start_ARG italic_β ( italic_a - italic_b ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_β start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_d ( italic_a - italic_b ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>, with <math alttext="d" class="ltx_Math" display="inline" id="S2.SS3.p4.2.m2.1"><semantics id="S2.SS3.p4.2.m2.1a"><mi id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><ci id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.1d">italic_d</annotation></semantics></math> being the detachment operator. Finally, this loss was divided at each point by the likelihood of the sampled fake variance, allowing for the definition of each variance number to drift when those variances cannot effectively be predicted, but also allowing the network to learn to reconstruct specific variance numbers once they can be predicted.</p>
</div>
<div class="ltx_para" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.1">The result is that the strategic scenario – and variations of that scenario – can be reconstructed for the user within the <span class="ltx_glossaryref" title="">IDT</span>. These reconstructions allow the user to explicitly see which environmental factors are recognized as potentially strategically significant by the <span class="ltx_glossaryref" title="">RL</span> agent. This is illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.F3" title="In 2.3 Identifying Critical Data with Strategically Similar Autoencoders ‣ 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Flagging Long-Term Consequences with Criticality and Safety Margins</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">From an <span class="ltx_glossaryref" title="">IDT</span> point of view, <span class="ltx_glossaryref" title="">WM</span>-style simulation provides the ability to explore the potential long-term effects of different decisions. The <span class="ltx_glossaryref" title="">SSA</span> allows these simulated counterfactuals to be cast back into a sensory space, allowing for easier understanding of which strategic elements are being tracked. <span class="ltx_glossaryref" title="">AEs</span> allow for such sensory space interpretations to be modified, to better understand how minor initial differences in the scenario might lead to wildly different long-term outcomes. However, while these tools allow for the investigation of long-term consequences through the agent’s <span class="ltx_glossaryref" title="">WM</span>, such an investigation is often expensive in terms of the human decision partner’s time.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">To help focus human decision maker time on only those decisions that are truly critical, we propose using criticality and safety margins, which we derive using recently published techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>. These approaches use statistics to derive bounds for any decision the agent must make. Essentially, safety margin bounds say that an agent might make up to <math alttext="N_{safety}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><msub id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">N</mi><mrow id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.3.2.cmml">s</mi><mo id="S2.SS4.p2.1.m1.1.1.3.1" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.1.m1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.3.3.cmml">a</mi><mo id="S2.SS4.p2.1.m1.1.1.3.1a" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.1.m1.1.1.3.4" xref="S2.SS4.p2.1.m1.1.1.3.4.cmml">f</mi><mo id="S2.SS4.p2.1.m1.1.1.3.1b" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.1.m1.1.1.3.5" xref="S2.SS4.p2.1.m1.1.1.3.5.cmml">e</mi><mo id="S2.SS4.p2.1.m1.1.1.3.1c" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.1.m1.1.1.3.6" xref="S2.SS4.p2.1.m1.1.1.3.6.cmml">t</mi><mo id="S2.SS4.p2.1.m1.1.1.3.1d" xref="S2.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.1.m1.1.1.3.7" xref="S2.SS4.p2.1.m1.1.1.3.7.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">𝑁</ci><apply id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3"><times id="S2.SS4.p2.1.m1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.3.1"></times><ci id="S2.SS4.p2.1.m1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.3.2">𝑠</ci><ci id="S2.SS4.p2.1.m1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3.3">𝑎</ci><ci id="S2.SS4.p2.1.m1.1.1.3.4.cmml" xref="S2.SS4.p2.1.m1.1.1.3.4">𝑓</ci><ci id="S2.SS4.p2.1.m1.1.1.3.5.cmml" xref="S2.SS4.p2.1.m1.1.1.3.5">𝑒</ci><ci id="S2.SS4.p2.1.m1.1.1.3.6.cmml" xref="S2.SS4.p2.1.m1.1.1.3.6">𝑡</ci><ci id="S2.SS4.p2.1.m1.1.1.3.7.cmml" xref="S2.SS4.p2.1.m1.1.1.3.7">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">N_{safety}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_s italic_a italic_f italic_e italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math> random (potentially erroneous) actions before there is a reasonable chance that task performance might be negatively affected beyond some user-defined threshold.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.2">Prior work shows that, in the Atari game Beamrider for example, <math alttext="47\%" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><mrow id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mn id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml">47</mn><mo id="S2.SS4.p3.1.m1.1.1.1" xref="S2.SS4.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="latexml" id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1.1">percent</csymbol><cn id="S2.SS4.p3.1.m1.1.1.2.cmml" type="integer" xref="S2.SS4.p3.1.m1.1.1.2">47</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">47\%</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">47 %</annotation></semantics></math> of agent losses could potentially be prevented by looking at only the lowest <math alttext="5\%" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><mrow id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml"><mn id="S2.SS4.p3.2.m2.1.1.2" xref="S2.SS4.p3.2.m2.1.1.2.cmml">5</mn><mo id="S2.SS4.p3.2.m2.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><apply id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS4.p3.2.m2.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1">percent</csymbol><cn id="S2.SS4.p3.2.m2.1.1.2.cmml" type="integer" xref="S2.SS4.p3.2.m2.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">5\%</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">5 %</annotation></semantics></math> of safety margins <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>. In other words, when a human decision maker’s time is limited, safety margins allow them to spend more time looking at a smaller number of critical decisions. An illustration of safety margins and criticality is shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S2.F4" title="In 2.4 Flagging Long-Term Consequences with Criticality and Safety Margins ‣ 2 Methods ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="318" id="S2.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Safety margins (shown in the bottom right corner of the figure) capture the relationship between the number of consecutive mistakes (more formally, random actions) that an agent might hypothetically make and the resulting expected loss of reward (note that higher reward losses appear lower along the vertical axis). To derive this relationship at some time <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.10.m1.1"><semantics id="S2.F4.10.m1.1b"><mi id="S2.F4.10.m1.1.1" xref="S2.F4.10.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.10.m1.1c"><ci id="S2.F4.10.m1.1.1.cmml" xref="S2.F4.10.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.10.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.10.m1.1e">italic_t</annotation></semantics></math>, we first run a simulation beginning at <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.11.m2.1"><semantics id="S2.F4.11.m2.1b"><mi id="S2.F4.11.m2.1.1" xref="S2.F4.11.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.11.m2.1c"><ci id="S2.F4.11.m2.1.1.cmml" xref="S2.F4.11.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.11.m2.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.11.m2.1e">italic_t</annotation></semantics></math>, and measure the total discounted reward collected. We then repeat the simulation multiple times, but for some number of time steps <math alttext="n" class="ltx_Math" display="inline" id="S2.F4.12.m3.1"><semantics id="S2.F4.12.m3.1b"><mi id="S2.F4.12.m3.1.1" xref="S2.F4.12.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.F4.12.m3.1c"><ci id="S2.F4.12.m3.1.1.cmml" xref="S2.F4.12.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.12.m3.1d">n</annotation><annotation encoding="application/x-llamapun" id="S2.F4.12.m3.1e">italic_n</annotation></semantics></math> beginning with time step <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.13.m4.1"><semantics id="S2.F4.13.m4.1b"><mi id="S2.F4.13.m4.1.1" xref="S2.F4.13.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.13.m4.1c"><ci id="S2.F4.13.m4.1.1.cmml" xref="S2.F4.13.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.13.m4.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.13.m4.1e">italic_t</annotation></semantics></math>, replace the actions output by the agent’s policy with randomly-chosen actions, and measure the mean loss (reduction) in reward as a result of these random actions; this is the true criticality at time <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.14.m5.1"><semantics id="S2.F4.14.m5.1b"><mi id="S2.F4.14.m5.1.1" xref="S2.F4.14.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.14.m5.1c"><ci id="S2.F4.14.m5.1.1.cmml" xref="S2.F4.14.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.14.m5.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.14.m5.1e">italic_t</annotation></semantics></math>. We also use a much faster, but typically much less accurate approach called a proxy criticality metric to compute the proxy (approximate) criticality at time <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.15.m6.1"><semantics id="S2.F4.15.m6.1b"><mi id="S2.F4.15.m6.1.1" xref="S2.F4.15.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.15.m6.1c"><ci id="S2.F4.15.m6.1.1.cmml" xref="S2.F4.15.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.15.m6.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.15.m6.1e">italic_t</annotation></semantics></math> without running any simulations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib13" title="">13</a>]</cite>. This aforementioned process is repeated offline for many episodes, at different time steps, in order to collect a dataset containing proxy and true criticality values. From this dataset, kernel density estimation is performed to capture the statistical relationship between proxy and true criticality for each value <math alttext="n" class="ltx_Math" display="inline" id="S2.F4.16.m7.1"><semantics id="S2.F4.16.m7.1b"><mi id="S2.F4.16.m7.1.1" xref="S2.F4.16.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.F4.16.m7.1c"><ci id="S2.F4.16.m7.1.1.cmml" xref="S2.F4.16.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.16.m7.1d">n</annotation><annotation encoding="application/x-llamapun" id="S2.F4.16.m7.1e">italic_n</annotation></semantics></math>. Finally, the kernel density estimates are used to compute a table of safety margins. When the agent is deployed, only proxy criticality needs to be computed at any given time <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.17.m8.1"><semantics id="S2.F4.17.m8.1b"><mi id="S2.F4.17.m8.1.1" xref="S2.F4.17.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.17.m8.1c"><ci id="S2.F4.17.m8.1.1.cmml" xref="S2.F4.17.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.17.m8.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.17.m8.1e">italic_t</annotation></semantics></math>; it is then used to efficiently look up the safety margins for <math alttext="t" class="ltx_Math" display="inline" id="S2.F4.18.m9.1"><semantics id="S2.F4.18.m9.1b"><mi id="S2.F4.18.m9.1.1" xref="S2.F4.18.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F4.18.m9.1c"><ci id="S2.F4.18.m9.1.1.cmml" xref="S2.F4.18.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.18.m9.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F4.18.m9.1e">italic_t</annotation></semantics></math> within the table, without the need to run additional simulations.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We focus on qualitative results, walking through a limited number of examples from the Atari game Beamrider. Additional non-public examples exist that apply these ideas to, e.g., scenarios in the AFSIM simulation framework. We encourage prospective partners who are interested in using <span class="ltx_glossaryref" title="">IDTs</span> for human/machine decision teaming to contact us.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model Criticality</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Criticality requires one measurement that is dependent on the model: proxy criticality <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>. For our modified MuZero-style agents, we use <math alttext="E[\text{reward}|\text{policy}]-E[\text{worst reward}|\text{1 wrong step}]" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.3.cmml">E</mi><mo id="S3.SS1.p1.1.m1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mtext id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2a.cmml">reward</mtext><mo fence="false" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mtext id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3a.cmml">policy</mtext></mrow><mo id="S3.SS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.SS1.p1.1.m1.2.2.3" xref="S3.SS1.p1.1.m1.2.2.3.cmml">−</mo><mrow id="S3.SS1.p1.1.m1.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">E</mi><mo id="S3.SS1.p1.1.m1.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p1.1.m1.2.2.2.1.1" xref="S3.SS1.p1.1.m1.2.2.2.1.2.cmml"><mo id="S3.SS1.p1.1.m1.2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.1.m1.2.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.cmml"><mtext id="S3.SS1.p1.1.m1.2.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.2a.cmml">worst reward</mtext><mo fence="false" id="S3.SS1.p1.1.m1.2.2.2.1.1.1.1" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.1.cmml">|</mo><mtext id="S3.SS1.p1.1.m1.2.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.3a.cmml">1 wrong step</mtext></mrow><mo id="S3.SS1.p1.1.m1.2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2"><minus id="S3.SS1.p1.1.m1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.3"></minus><apply id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"><times id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.2"></times><ci id="S3.SS1.p1.1.m1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3">𝐸</ci><apply id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2"><mtext id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2">reward</mtext></ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3a.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3"><mtext id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3">policy</mtext></ci></apply></apply></apply><apply id="S3.SS1.p1.1.m1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2"><times id="S3.SS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2"></times><ci id="S3.SS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.3">𝐸</ci><apply id="S3.SS1.p1.1.m1.2.2.2.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.2.2.2.1.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.1.m1.2.2.2.1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.2"><mtext id="S3.SS1.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.2">worst reward</mtext></ci><ci id="S3.SS1.p1.1.m1.2.2.2.1.1.1.3a.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.3"><mtext id="S3.SS1.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.1.1.1.3">1 wrong step</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">E[\text{reward}|\text{policy}]-E[\text{worst reward}|\text{1 wrong step}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">italic_E [ reward | policy ] - italic_E [ worst reward | 1 wrong step ]</annotation></semantics></math>, i.e., the difference between the anticipated reward if the best action (i.e., the action prescribed by the policy) is taken and the anticipated reward if the worst action is taken <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib13" title="">13</a>]</cite>. While there are likely better proxy criticality formulas <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>, especially when considering safety margins of greater than one step, this was sufficient for initial results.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">For an agent trained on Beamrider, the resulting safety margin plot is shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F5" title="In 3.1 Model Criticality ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, with supporting kernel density estimates from the collected data shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A3.F12" title="In Appendix C Additional Figures ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a>. For an example of how the safety margin plot is applied and shown to the user in various scenarios, see <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F6" title="In 3.1 Model Criticality ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="349" id="S3.F5.g1" src="extracted/5912081/img/model_sm.jpeg" width="349"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Safety margins (color) given a specified acceptable loss in mission outcome (y-axis) and proxy criticality (x-axis).</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="120" id="S3.F6.g1" src="extracted/5912081/img/sm-applied-2.15-input.png" width="109"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="S3.F6.g2" src="extracted/5912081/img/sm-applied-2.15.png" width="483"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F6.2">(A) 
<br class="ltx_break"/><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="120" id="S3.F6.1.g1" src="extracted/5912081/img/sm-applied-152.65-input.png" width="109"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="120" id="S3.F6.2.g2" src="extracted/5912081/img/sm-applied-152.65.png" width="483"/>
<br class="ltx_break"/>(B) 
<br class="ltx_break"/></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>To present the safety margins from <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F5" title="In 3.1 Model Criticality ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> to the user, the proxy criticality at the current time step <math alttext="t" class="ltx_Math" display="inline" id="S3.F6.4.m1.1"><semantics id="S3.F6.4.m1.1b"><mi id="S3.F6.4.m1.1.1" xref="S3.F6.4.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.F6.4.m1.1c"><ci id="S3.F6.4.m1.1.1.cmml" xref="S3.F6.4.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.4.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S3.F6.4.m1.1e">italic_t</annotation></semantics></math> is looked up on the horizontal axis, and a vertical slice is shown. (A) shows a situation with proxy criticality 2.15, and (B) shows a situation with proxy criticality 152.65. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Scenario 1: Obstacle Approaching from Left</h3>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="114" id="S3.F7.g1" src="extracted/5912081/img/s1/s1_image.jpeg" width="87"/></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F7.1" style="width:43.4pt;">
<p class="ltx_p ltx_align_center" id="S3.F7.1.1"><math alttext="\to" class="ltx_Math" display="inline" id="S3.F7.1.1.m1.1"><semantics id="S3.F7.1.1.m1.1a"><mo id="S3.F7.1.1.m1.1.1" stretchy="false" xref="S3.F7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F7.1.1.m1.1b"><ci id="S3.F7.1.1.m1.1.1.cmml" xref="S3.F7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.1.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F7.1.1.m1.1d">→</annotation></semantics></math></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="114" id="S3.F7.g2" src="extracted/5912081/img/s1/s1_nn_input.png" width="112"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F7.2">Visual input to a human <math alttext="\to" class="ltx_Math" display="inline" id="S3.F7.2.m1.1"><semantics id="S3.F7.2.m1.1a"><mo id="S3.F7.2.m1.1.1" stretchy="false" xref="S3.F7.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F7.2.m1.1b"><ci id="S3.F7.2.m1.1.1.cmml" xref="S3.F7.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.2.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F7.2.m1.1d">→</annotation></semantics></math> Input to <span class="ltx_glossaryref" title="">AI</span>
<br class="ltx_break"/>(23.4 proxy criticality) Left 3% vs Right 97%.
Safety margin 4 at 220, 16 at 440 
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="120" id="S3.F7.g3" src="extracted/5912081/img/s1/s1_ssa.png" width="353"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F7.11"><span class="ltx_glossaryref" title="">SSA</span> frames

<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S3.F7.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.F7.6.4">
<td class="ltx_td ltx_align_center" id="S3.F7.4.2.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.3.1.1.g1" src="extracted/5912081/img/s1/s1_adv_left_pert.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.4.2.2.g2" src="extracted/5912081/img/s1/s1_adv_left_input.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F7.6.4.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.5.3.3.g1" src="extracted/5912081/img/s1/s1_adv_right_pert.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.6.4.4.g2" src="extracted/5912081/img/s1/s1_adv_right_input.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F7.10.9.1">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F7.10.9.1.1">Adversarial explanations for “Left” and “Right” actions, original <span class="ltx_glossaryref" title="">AE</span> evaluation.</td>
</tr>
<tr class="ltx_tr" id="S3.F7.10.8">
<td class="ltx_td ltx_align_center" id="S3.F7.8.6.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.7.5.1.g1" src="extracted/5912081/img/s1/s1_clean_adv_left_pert.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.8.6.2.g2" src="extracted/5912081/img/s1/s1_clean_adv_left_input.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F7.10.8.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.9.7.3.g1" src="extracted/5912081/img/s1/s1_clean_adv_right_pert.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="116" id="S3.F7.10.8.4.g2" src="extracted/5912081/img/s1/s1_clean_adv_right_input.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F7.10.10.2">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F7.10.10.2.1">Adversarial explanations for “Left” and “Right” actions, sparsity-promoting evaluation (<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS4" title="B.4 Sparsity-Promoting Gradient-Minimization Function ‣ Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">B.4</span></a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Case study of analyzing decisions with an obstacle approaching from the left. The SSA shows a surprising reliance of this particular model on the specific gridline positions (note that these positions are similar across the three reconstructions) – this could be due to the proximity of the observed obstacle and one of the gridlines; see <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F9" title="In 3.4 Scenario 3: No Immediate Action Required ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F10" title="In 3.5 Scenario 4: Non-Gridline-Aligned Obstacle ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a> for examples where the gridline locations were not strategically significant. This reliance on gridline positions can be viewed as an unknown unknown factor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib5" title="">5</a>]</cite>. For adversarial explanations, on the left side of the figure, we show an adversarial perturbation that encourages the model to decide to move “Left”; the leftmost frame is the difference between the original perturbed input (the second frame from the left) and the unperturbed input (shown at the top right of the figure, above “Input to AI”). The model correctly identifies the removal of the obstacle (note the dark patch in the leftmost image) as justification for going “Left”. Similarly, on the right side of the figure, the perturbation creates additional obstacles (shown as light patches in the difference between the perturbed and unperturbed input) in front of the player to further encourage a decision to move “Right”.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">This scenario is demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F7" title="In 3.2 Scenario 1: Obstacle Approaching from Left ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Scenario 2: Obstacle Approaching from Right</h3>
<figure class="ltx_figure" id="S3.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="114" id="S3.F8.g1" src="extracted/5912081/img/s2/image.jpeg" width="87"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F8.1.1" style="width:43.4pt;"><math alttext="\to" class="ltx_Math" display="inline" id="S3.F8.1.1.m1.1"><semantics id="S3.F8.1.1.m1.1a"><mo id="S3.F8.1.1.m1.1.1" stretchy="false" xref="S3.F8.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F8.1.1.m1.1b"><ci id="S3.F8.1.1.m1.1.1.cmml" xref="S3.F8.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F8.1.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F8.1.1.m1.1d">→</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="114" id="S3.F8.g2" src="extracted/5912081/img/s2/nn_input.png" width="120"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F8.2">Visual input to a human <math alttext="\to" class="ltx_Math" display="inline" id="S3.F8.2.m1.1"><semantics id="S3.F8.2.m1.1a"><mo id="S3.F8.2.m1.1.1" stretchy="false" xref="S3.F8.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F8.2.m1.1b"><ci id="S3.F8.2.m1.1.1.cmml" xref="S3.F8.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F8.2.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F8.2.m1.1d">→</annotation></semantics></math> Input to <span class="ltx_glossaryref" title="">AI</span>
<br class="ltx_break"/>(28.7 proxy criticality) Left 99.9% vs Right 0.1%.
Safety margin 4 at 326, 16 at 504 
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="110" id="S3.F8.g3" src="extracted/5912081/img/s2/ssa.png" width="353"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F8.11"><span class="ltx_glossaryref" title="">SSA</span> frames

<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S3.F8.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.F8.6.4">
<td class="ltx_td ltx_align_center" id="S3.F8.4.2.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.3.1.1.g1" src="extracted/5912081/img/s2/adv_left_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F8.4.2.2.g2" src="extracted/5912081/img/s2/adv_left_input.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F8.6.4.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.5.3.3.g1" src="extracted/5912081/img/s2/adv_right_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.6.4.4.g2" src="extracted/5912081/img/s2/adv_right_input.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F8.10.9.1">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F8.10.9.1.1">Adversarial explanations for “Left” and “Right” actions, original <span class="ltx_glossaryref" title="">AE</span> evaluation.</td>
</tr>
<tr class="ltx_tr" id="S3.F8.10.8">
<td class="ltx_td ltx_align_center" id="S3.F8.8.6.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.7.5.1.g1" src="extracted/5912081/img/s2/adv_left_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.8.6.2.g2" src="extracted/5912081/img/s2/adv_left_input_clean.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F8.10.8.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.9.7.3.g1" src="extracted/5912081/img/s2/adv_right_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="106" id="S3.F8.10.8.4.g2" src="extracted/5912081/img/s2/adv_right_input_clean.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F8.10.10.2">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F8.10.10.2.1">Adversarial explanations for “Left” and “Right” actions, sparsity-promoting evaluation (<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS4" title="B.4 Sparsity-Promoting Gradient-Minimization Function ‣ Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">B.4</span></a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Case study of analyzing decisions with an obstacle approaching from the right (with the obstacle on the left no longer posing a threat). Similar to <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F7" title="In 3.2 Scenario 1: Obstacle Approaching from Left ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, the <span class="ltx_glossaryref" title="">SSA</span> reconstructions indicate a reliance on gridline positions. Surprisingly, <span class="ltx_glossaryref" title="">AE</span> alters the “Sector” number of the game information to further encourage a “Left” action; this can be viewed as another unknown unknown factor that was uncovered. We note that this might be a result of the already saturated action distribution: the agent already favors a “Left” action, but the action might be even more favored in a different sector. The sparsity-promoting evaluation method shows that a “Right” action would make sense if the object to the right was not dangerous and there was an obstacle on the left.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">This scenario is demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F8" title="In 3.3 Scenario 2: Obstacle Approaching from Right ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Scenario 3: No Immediate Action Required</h3>
<figure class="ltx_figure" id="S3.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="114" id="S3.F9.g1" src="extracted/5912081/img/s3/image.jpeg" width="87"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F9.1.1" style="width:43.4pt;"><math alttext="\to" class="ltx_Math" display="inline" id="S3.F9.1.1.m1.1"><semantics id="S3.F9.1.1.m1.1a"><mo id="S3.F9.1.1.m1.1.1" stretchy="false" xref="S3.F9.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F9.1.1.m1.1b"><ci id="S3.F9.1.1.m1.1.1.cmml" xref="S3.F9.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F9.1.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F9.1.1.m1.1d">→</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="114" id="S3.F9.g2" src="extracted/5912081/img/s3/nn_input.png" width="119"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F9.2">Visual input to a human <math alttext="\to" class="ltx_Math" display="inline" id="S3.F9.2.m1.1"><semantics id="S3.F9.2.m1.1a"><mo id="S3.F9.2.m1.1.1" stretchy="false" xref="S3.F9.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F9.2.m1.1b"><ci id="S3.F9.2.m1.1.1.cmml" xref="S3.F9.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F9.2.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F9.2.m1.1d">→</annotation></semantics></math> Input to <span class="ltx_glossaryref" title="">AI</span>
<br class="ltx_break"/>(2.95 proxy criticality) Left 52% vs Right 48%.
Safety margin 4 at 101, 16 at 184 
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="111" id="S3.F9.g3" src="extracted/5912081/img/s3/ssa.png" width="353"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F9.11"><span class="ltx_glossaryref" title="">SSA</span> frames

<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S3.F9.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.F9.6.4">
<td class="ltx_td ltx_align_center" id="S3.F9.4.2.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.3.1.1.g1" src="extracted/5912081/img/s3/adv_left_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.4.2.2.g2" src="extracted/5912081/img/s3/adv_left_input.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F9.6.4.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.5.3.3.g1" src="extracted/5912081/img/s3/adv_right_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.6.4.4.g2" src="extracted/5912081/img/s3/adv_right_input.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F9.10.9.1">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F9.10.9.1.1">Adversarial explanations for “Left” and “Right” actions, original <span class="ltx_glossaryref" title="">AE</span> evaluation.</td>
</tr>
<tr class="ltx_tr" id="S3.F9.10.8">
<td class="ltx_td ltx_align_center" id="S3.F9.8.6.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.7.5.1.g1" src="extracted/5912081/img/s3/adv_left_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.8.6.2.g2" src="extracted/5912081/img/s3/adv_left_input_clean.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F9.10.8.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.9.7.3.g1" src="extracted/5912081/img/s3/adv_right_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="108" id="S3.F9.10.8.4.g2" src="extracted/5912081/img/s3/adv_right_input_clean.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F9.10.10.2">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F9.10.10.2.1">Adversarial explanations for “Left” and “Right” actions, sparsity-promoting evaluation (<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS4" title="B.4 Sparsity-Promoting Gradient-Minimization Function ‣ Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">B.4</span></a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Case study of analyzing decisions with no immediate concerns. Here, the <span class="ltx_glossaryref" title="">SSA</span> reconstructions show non-reliance on the gridlines, with significant variations in their positions across the three reconstructions. <span class="ltx_glossaryref" title="">AEs</span> for “Left” and “Right” show a reliance on sector information (for the “Left” action in particular) and different potential targets and obstacles being observed.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">This scenario is demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F9" title="In 3.4 Scenario 3: No Immediate Action Required ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Scenario 4: Non-Gridline-Aligned Obstacle</h3>
<figure class="ltx_figure" id="S3.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="114" id="S3.F10.g1" src="extracted/5912081/img/s4/image.jpeg" width="87"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F10.1.1" style="width:43.4pt;"><math alttext="\to" class="ltx_Math" display="inline" id="S3.F10.1.1.m1.1"><semantics id="S3.F10.1.1.m1.1a"><mo id="S3.F10.1.1.m1.1.1" stretchy="false" xref="S3.F10.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F10.1.1.m1.1b"><ci id="S3.F10.1.1.m1.1.1.cmml" xref="S3.F10.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F10.1.1.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F10.1.1.m1.1d">→</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="114" id="S3.F10.g2" src="extracted/5912081/img/s4/nn_input.png" width="121"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F10.2">Visual input to a human <math alttext="\to" class="ltx_Math" display="inline" id="S3.F10.2.m1.1"><semantics id="S3.F10.2.m1.1a"><mo id="S3.F10.2.m1.1.1" stretchy="false" xref="S3.F10.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.F10.2.m1.1b"><ci id="S3.F10.2.m1.1.1.cmml" xref="S3.F10.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F10.2.m1.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S3.F10.2.m1.1d">→</annotation></semantics></math> Input to <span class="ltx_glossaryref" title="">AI</span>
<br class="ltx_break"/>(20.87 proxy criticality) Left 98% vs Right 2%.
Safety margin 4 at 172, 16 at 374 
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="111" id="S3.F10.g3" src="extracted/5912081/img/s4/ssa.png" width="353"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F10.11"><span class="ltx_glossaryref" title="">SSA</span> frames

<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S3.F10.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.F10.6.4">
<td class="ltx_td ltx_align_center" id="S3.F10.4.2.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.3.1.1.g1" src="extracted/5912081/img/s4/adv_left_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.4.2.2.g2" src="extracted/5912081/img/s4/adv_left_input.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F10.6.4.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.5.3.3.g1" src="extracted/5912081/img/s4/adv_right_diff.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.6.4.4.g2" src="extracted/5912081/img/s4/adv_right_input.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F10.10.9.1">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F10.10.9.1.1">Adversarial explanations for “Left” and “Right” actions, original <span class="ltx_glossaryref" title="">AE</span> evaluation.</td>
</tr>
<tr class="ltx_tr" id="S3.F10.10.8">
<td class="ltx_td ltx_align_center" id="S3.F10.8.6.2">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.7.5.1.g1" src="extracted/5912081/img/s4/adv_left_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.8.6.2.g2" src="extracted/5912081/img/s4/adv_left_input_clean.png" width="114"/>
</td>
<td class="ltx_td ltx_align_center" id="S3.F10.10.8.4">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.9.7.3.g1" src="extracted/5912081/img/s4/adv_right_diff_clean.png" width="114"/>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="107" id="S3.F10.10.8.4.g2" src="extracted/5912081/img/s4/adv_right_input_clean.png" width="114"/>
</td>
</tr>
<tr class="ltx_tr" id="S3.F10.10.10.2">
<td class="ltx_td ltx_align_center" colspan="2" id="S3.F10.10.10.2.1">Adversarial explanations for “Left” and “Right” actions, sparsity-promoting evaluation (<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A2.SS4" title="B.4 Sparsity-Promoting Gradient-Minimization Function ‣ Appendix B Additions to Adversarial Explanations ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">B.4</span></a>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Case study of analyzing a decision with an obstacle not aligned with gridlines. Here, the <span class="ltx_glossaryref" title="">SSA</span> reconstructions clearly indicate non-reliance on specific gridline positions.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">This scenario is demonstrated in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F10" title="In 3.5 Scenario 4: Non-Gridline-Aligned Obstacle ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Model Robustness</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.3">As with traditional <span class="ltx_glossaryref" title="">AEs</span>, the <span class="ltx_glossaryref" title="">RL</span>-enabled <span class="ltx_glossaryref" title="">AEs</span> presented in this work provide protection against adversarial input manipulations. To get reasonable <span class="ltx_glossaryref" title="">RL</span> agent performance, we used lower regularization strength than in the original <span class="ltx_glossaryref" title="">AE</span> paper. While we have not yet measured quantities comparable to the original work’s <span class="ltx_glossaryref" title="">accuracy-robustness area (ARA)</span> metric <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>, we did measure the <span class="ltx_glossaryref" title="">root-mean-squared error (RMSE)</span> of the perturbation (the difference between the perturbed input and the original input) to achieve a given change in policy for both a plain network and one treated with <span class="ltx_glossaryref" title="">AE</span> methodology. In our experiments, the modified network had roughly identical performance to the original network (<math alttext="9135" class="ltx_Math" display="inline" id="S3.SS6.p1.1.m1.1"><semantics id="S3.SS6.p1.1.m1.1a"><mn id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">9135</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><cn id="S3.SS6.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS6.p1.1.m1.1.1">9135</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">9135</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">9135</annotation></semantics></math> vs <math alttext="9274" class="ltx_Math" display="inline" id="S3.SS6.p1.2.m2.1"><semantics id="S3.SS6.p1.2.m2.1a"><mn id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">9274</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><cn id="S3.SS6.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS6.p1.2.m2.1.1">9274</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">9274</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.1d">9274</annotation></semantics></math> average episode performance, respectively), while the required <span class="ltx_glossaryref" title="">RMSE</span> was <math alttext="1.81\times" class="ltx_math_unparsed" display="inline" id="S3.SS6.p1.3.m3.1"><semantics id="S3.SS6.p1.3.m3.1a"><mrow id="S3.SS6.p1.3.m3.1b"><mn id="S3.SS6.p1.3.m3.1.1">1.81</mn><mo id="S3.SS6.p1.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S3.SS6.p1.3.m3.1c">1.81\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.3.m3.1d">1.81 ×</annotation></semantics></math> higher for the modified network. This shows that the modified network should be significantly more resistant to adversarial tampering, also implying that the <span class="ltx_glossaryref" title="">ARA</span> would be significantly higher, an exercise we leave for future work.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion and Future Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The provided capabilities should be a significant aid for humans trying to debug the <span class="ltx_glossaryref" title="">AI</span> system’s decisions or understand them in the context of a human/machine teaming scenario. We note that this work covered qualitative, case-study results only; specific human trials for quantitative results are left for future work.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">As with classification-based <span class="ltx_glossaryref" title="">AE</span>, the resulting explanations could also be passed to human subject matter experts for labeling, which in turn could improve the <span class="ltx_glossaryref" title="">AI</span> model’s robustness and decision making capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>. This is a promising future direction for this work, which would allow human feedback to improve the <span class="ltx_glossaryref" title="">AI</span>’s decisions and explanations.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Outside of <span class="ltx_glossaryref" title="">RL</span>, a comparison of <span class="ltx_glossaryref" title="">AE</span> to other state-of-the-art explanation methods has been presented in previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>. For context within the field of <span class="ltx_glossaryref" title="">explainable reinforcement learning (XRL)</span>, we refer to a few more recent studies. For example, Milani <span class="ltx_text ltx_font_italic" id="S5.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib14" title="">14</a>]</cite> suggested a taxonomy for <span class="ltx_glossaryref" title="">XRL</span> that includes three scopes of explanation: Feature Importance, Policy-Level, and Learning Process. Within this framework, <span class="ltx_glossaryref" title="">AEs</span> and <span class="ltx_glossaryref" title="">SSAs</span> provide Feature Importance-level explanations, while safety margins and criticality provide Policy-Level explanations.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">One limitation of the <span class="ltx_glossaryref" title="">RL</span> methods discussed in this work is that any given trained model only performs tasks in a single environment. That is, the methods do not provide foundation models in the sense that has been popularized by ChatGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib15" title="">15</a>]</cite>. However, there are efforts to build foundation-style models for <span class="ltx_glossaryref" title="">RL</span> agents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib16" title="">16</a>]</cite>. We note that the methodologies proposed in our work are deliberately general; that is, we imagine that when methods for successful foundational <span class="ltx_glossaryref" title="">RL</span> agents are developed, the techniques provided would also help with integrating them into combined human/<span class="ltx_glossaryref" title="">AI</span> decision workflows and subsequent agent improvement.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">As both the quantity of data available to decision makers and the complexity of decision environments increases, tools are needed to help humans meaningfully understand those environments and make effective decisions. Traditional decision assistance tools – <span class="ltx_glossaryref" title="">DSTs</span>– have focused on using data to help users answer questions they already know to ask. Instead, we proposed <span class="ltx_glossaryref" title="">IDTs</span> that use <span class="ltx_glossaryref" title="">AI</span> methods to help users find the answer to a much broader set of questions, relying less on user knowledge and giving a broader perspective on the available data. These capabilities were provided through: <span class="ltx_glossaryref" title="">RL</span> extensions for a MuZero-style agent for better learning and to reveal information about the environment to users; the extension of <span class="ltx_glossaryref" title="">AE</span> to <span class="ltx_glossaryref" title="">RL</span> to help users better understand different interpretations of available sensor data that would lead to different decisions; <span class="ltx_glossaryref" title="">SSAs</span> to help users identify which data the <span class="ltx_glossaryref" title="">AI</span> considers critical to understanding the current strategic scenario; and criticality and safety margins to help users understand the long-term consequences of different decisions. By combining all of these innovations, <span class="ltx_glossaryref" title="">IDTs</span> become a viable approach for joint human/machine decision making, and in particular, help to uncover unknown known/unknown factors. By focusing on not just <span class="ltx_glossaryref" title="">AI</span> methods that autonomously make good decisions, but also in using those methods to expose available information to human decision makers, a platform is provided for making better decisions for critical missions.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>This material is based upon work supported by the Air Force Research Laboratory (AFRL) under Contract No. FA8750-22-C-1002. This paper was PA approved under case number AFRL-2024-1725.

</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">SBIR DATA RIGHTS</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Contract No.: FA8750-22-C-1002
<br class="ltx_break"/>Contractor Name: Galois, Inc.
<br class="ltx_break"/>Address: 421 SW Sixth Ave., Suite 300, Portland, OR 97204
<br class="ltx_break"/>Expiration of SBIR Data Rights Period: 01/18/2042
<br class="ltx_break"/>The Government’s rights to use, modify, reproduce, release, perform, display, or disclose technical data or computer software marked with this legend are restricted during the period shown as provided in paragraph (b)(4) of the Rights in Other Than Commercial Technical Data and Computer Software - Small Business Innovation Research (SBIR) Program clause contained in the above identified contract. No restrictions apply after the expiration date shown above. Any reproduction of technical data, computer software, or portions thereof marked with this legend must also reproduce the markings.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Schrittwieser, J., Antonoglou, I., Hubert, T., Simonyan, K., Sifre, L., Schmitt, S., Guez, A., Lockhart, E., Hassabis, D., Graepel, T., et al., “Mastering atari, go, chess and shogi by planning with a learned model,” <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Nature</span> <span class="ltx_text ltx_font_bold" id="bib.bib1.2.2">588</span>(7839), 604–609 (2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Ye, W., Liu, S., Kurutach, T., Abbeel, P., and Gao, Y., “Mastering atari games with limited data,” <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Advances in Neural Information Processing Systems</span> <span class="ltx_text ltx_font_bold" id="bib.bib2.2.2">34</span>, 25476–25488 (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Boudette, N. E., “’It happened so fast’: inside a fatal Tesla autopilot accident.,” <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">New York Times</span> (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
SAE Standard, “Taxonomy and definitions for terms related to driving automation systems for on-road motor vehicles,” <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">J3016_201806</span> (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Pawson, R., Wong, G., and Owen, L., “Known knowns, known unknowns, unknown unknowns: the predicament of evidence-based policy,” <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">American Journal of Evaluation</span> <span class="ltx_text ltx_font_bold" id="bib.bib5.2.2">32</span>(4), 518–546 (2011).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Woods, W., Chen, J., and Teuscher, C., “Adversarial explanations for understanding image classification decisions and improved neural network robustness,” <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Nature Machine Intelligence</span> <span class="ltx_text ltx_font_bold" id="bib.bib6.2.2">1</span>(11), 508–516 (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Grushin, A., Woods, W., Velasquez, A., and Khan, S., “Safety margins for reinforcement learning,” in [<span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">2023 IEEE Conference on Artificial Intelligence (CAI)</span> ], 42–43, IEEE (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Grushin, A., Woods, W., Khan, S., and Velasquez, A., “Criticality and safety margins for reinforcement learning,” <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">submitted to IEEE Transactions on Artificial Intelligence (TAI)</span> (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Ha, D. and Schmidhuber, J., “World models,” <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">arXiv e-prints</span> , arXiv:1803.10122 (Mar. 2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Choi, Y., Uh, Y., Yoo, J., and Ha, J.-W., “Stargan v2: diverse image synthesis for multiple domains,” in [<span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span> ], 8188–8197 (2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Arjovsky, M., Chintala, S., and Bottou, L., “Wasserstein generative adversarial networks,” in [<span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">International Conference on Machine Learning</span> ], <span class="ltx_text ltx_font_bold" id="bib.bib11.2.2">70</span>, 214–223, PMLR (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Srivastava, A., Valkov, L., Russell, C., Gutmann, M. U., and Sutton, C., “Veegan: reducing mode collapse in gans using implicit variational learning,” <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</span> <span class="ltx_text ltx_font_bold" id="bib.bib12.2.2">30</span>, 3310–3320 (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Lin, Y.-C., Hong, Z.-W., Liao, Y.-H., Shih, M.-L., Liu, M.-Y., and Sun, M., “Tactics of adversarial attack on deep reinforcement learning agents,” <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">arXiv e-prints</span> , arXiv:1703.06748 (Mar. 2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Milani, S., Topin, N., Veloso, M., and Fang, F., “Explainable reinforcement learning: A survey and comparative review,” <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">ACM Computing Surveys</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
OpenAI, “ChatGPT.” <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://chat.openai.com/" title="">https://chat.openai.com/</a> (2023).

</span>
<span class="ltx_bibblock">Accessed: 2024-03-08.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Reed, S., Zolna, K., Parisotto, E., Gomez Colmenarejo, S., Novikov, A., Barth-Maron, G., Gimenez, M., Sulsky, Y., Kay, J., Springenberg, J. T., Eccles, T., Bruce, J., Razavi, A., Edwards, A., Heess, N., Chen, Y., Hadsell, R., Vinyals, O., Bordbar, M., and de Freitas, N., “A generalist agent,” <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">arXiv e-prints</span> , arXiv:2205.06175 (May 2022).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Lei Ba, J., Kiros, J. R., and Hinton, G. E., “Layer normalization,” <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">arXiv e-prints</span> , arXiv:1607.06450 (July 2016).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Ioffe, S. and Szegedy, C., “Batch normalization: Accelerating deep network training by reducing internal covariate shift,” in [<span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">International Conference on Machine Learning</span> ], 448–456, PMLR (2015).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Joo, T., Kang, D., and Kim, B., “Regularizing activations in neural networks via distribution matching with the wasserstein metric,” in [<span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">International Conference on Learning Representations</span> ], (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Bellemare, M. G., Dabney, W., and Munos, R., “A distributional perspective on reinforcement learning,” in [<span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">International Conference on Machine Learning</span> ], 449–458, PMLR (2017).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Dabney, W., Ostrovski, G., Silver, D., and Munos, R., “Implicit quantile networks for distributional reinforcement learning,” in [<span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">International Conference on Machine Learning</span> ], 1096–1105, PMLR (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Choi, Y., Lee, K., and Oh, S., “Distributional deep reinforcement learning with a mixture of gaussians,” in [<span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">2019 International Conference on Robotics and Automation (ICRA)</span> ], 9791–9797 (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Nam, D. W., Kim, Y., and Park, C. Y., “Gmac: A distributional perspective on actor-critic framework,” in [<span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">International Conference on Machine Learning</span> ], 7927–7936, PMLR (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Hubert, T., Schrittwieser, J., Antonoglou, I., Barekatain, M., Schmitt, S., and Silver, D., “Learning and planning in complex action spaces,” in [<span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">International Conference on Machine Learning</span> ], 4476–4486, PMLR (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Kloek, T. and van Dijk, H. K., “Bayesian estimates of equation system parameters: an application of integration by Monte Carlo,” <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Econometrica</span> <span class="ltx_text ltx_font_bold" id="bib.bib25.2.2">46</span>, 1–19 (January 1978).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Woods, W., “RL-GRIT: Reinforcement learning for grammar inference,” in [<span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">2021 IEEE Security and Privacy Workshops (SPW)</span> ], 171–183, IEEE (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Hessel, M., Modayil, J., Van Hasselt, H., Schaul, T., Ostrovski, G., Dabney, W., Horgan, D., Piot, B., Azar, M., and Silver, D., “Rainbow: Combining improvements in deep reinforcement learning,” in [<span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</span> ], <span class="ltx_text ltx_font_bold" id="bib.bib27.2.2">32</span>(1) (2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Fan, J. and Xiao, C., “Generalized data distribution iteration,” in [<span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">International Conference on Machine Learning</span> ], 6103–6184, PMLR (2022).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Burda, Y., Edwards, H., Storkey, A., and Klimov, O., “Exploration by random network distillation,” <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">arXiv e-prints</span> , arXiv:1810.12894 (Oct. 2018).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Carpenter, J., Clifford, P., and Fearnhead, P., “Improved particle filter for nonlinear problems,” <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">IEE Proceedings-Radar, Sonar and Navigation</span> <span class="ltx_text ltx_font_bold" id="bib.bib30.2.2">146</span>(1), 2–7 (1999).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Kennedy, J. and Eberhart, R., “Particle swarm optimization,” in [<span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Proceedings of ICNN’95 - International Conference on Neural Networks</span> ], <span class="ltx_text ltx_font_bold" id="bib.bib31.2.2">4</span>, 1942–1948, IEEE (1995).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J., “Adam: a method for stochastic optimization,” <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">arXiv e-prints</span> , arXiv:1412.6980 (Dec. 2014).

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>RL Agent Differences from MuZero</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this section are the modifications to MuZero that were implemented and explored as part of this work.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Balancing Pre-LayerNorm Activations</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Layer normalization, or LayerNorm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib17" title="">17</a>]</cite>, is a way of normalizing the activity of different neurons, to ensure that any resulting activations are well-conditioned for learning. LayerNorm has a number of benefits, including similar training and test time behavior. However, in some contexts, LayerNorm does not perform as well as batch normalization (or BatchNorm) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib18" title="">18</a>]</cite>. One theory for this that we explored is that there is no function forcing each data channel to actually be used. That is, LayerNorm enforces statistics over all data channels, whereas BatchNorm enforces statistics over each data channel independently. Other work has explored forcing the pre-LayerNorm activations of a <span class="ltx_glossaryref" title="">NN</span> to ensure that each channel gets used via Wasserstein normalization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib19" title="">19</a>]</cite>. However, we found that constraint to be too restrictive and difficult to balance; other optimization objectives were negatively impacted by the condition.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.3">Instead, we take the idea of using gradients to condition the pre-LayerNorm activations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib19" title="">19</a>]</cite> and use that idea to implement a variant of BatchNorm. To implement this, the forward pass is identical to LayerNorm, but during the backward pass, gradients pre-LayerNorm are modified. This is accomplished by swapping the channels (features) dimension with the batch dimension (assuming batch, channel, height, width ordering for images) and then computing statistics across the newly located batch dimension and all subsequent dimensions. Notably, at this step, we compute <math alttext="\delta_{sd}" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><msub id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">δ</mi><mrow id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml"><mi id="A1.SS1.p2.1.m1.1.1.3.2" xref="A1.SS1.p2.1.m1.1.1.3.2.cmml">s</mi><mo id="A1.SS1.p2.1.m1.1.1.3.1" xref="A1.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.1.1.3.3" xref="A1.SS1.p2.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝛿</ci><apply id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3"><times id="A1.SS1.p2.1.m1.1.1.3.1.cmml" xref="A1.SS1.p2.1.m1.1.1.3.1"></times><ci id="A1.SS1.p2.1.m1.1.1.3.2.cmml" xref="A1.SS1.p2.1.m1.1.1.3.2">𝑠</ci><ci id="A1.SS1.p2.1.m1.1.1.3.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">\delta_{sd}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">italic_δ start_POSTSUBSCRIPT italic_s italic_d end_POSTSUBSCRIPT</annotation></semantics></math> as the standard deviation of each channel, and then multiply all of these by a scalar such that the new variance across all channels would be <math alttext="1" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.1"><semantics id="A1.SS1.p2.2.m2.1a"><mn id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><cn id="A1.SS1.p2.2.m2.1.1.cmml" type="integer" xref="A1.SS1.p2.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">1</annotation></semantics></math>. We found this <math alttext="\delta_{sd}" class="ltx_Math" display="inline" id="A1.SS1.p2.3.m3.1"><semantics id="A1.SS1.p2.3.m3.1a"><msub id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml"><mi id="A1.SS1.p2.3.m3.1.1.2" xref="A1.SS1.p2.3.m3.1.1.2.cmml">δ</mi><mrow id="A1.SS1.p2.3.m3.1.1.3" xref="A1.SS1.p2.3.m3.1.1.3.cmml"><mi id="A1.SS1.p2.3.m3.1.1.3.2" xref="A1.SS1.p2.3.m3.1.1.3.2.cmml">s</mi><mo id="A1.SS1.p2.3.m3.1.1.3.1" xref="A1.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.3.m3.1.1.3.3" xref="A1.SS1.p2.3.m3.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><apply id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.3.m3.1.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p2.3.m3.1.1.2.cmml" xref="A1.SS1.p2.3.m3.1.1.2">𝛿</ci><apply id="A1.SS1.p2.3.m3.1.1.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3"><times id="A1.SS1.p2.3.m3.1.1.3.1.cmml" xref="A1.SS1.p2.3.m3.1.1.3.1"></times><ci id="A1.SS1.p2.3.m3.1.1.3.2.cmml" xref="A1.SS1.p2.3.m3.1.1.3.2">𝑠</ci><ci id="A1.SS1.p2.3.m3.1.1.3.3.cmml" xref="A1.SS1.p2.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">\delta_{sd}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m3.1d">italic_δ start_POSTSUBSCRIPT italic_s italic_d end_POSTSUBSCRIPT</annotation></semantics></math> normalization to be important, as otherwise, the use of this method in, e.g., transformers, resulted in saturation of the attention layers. Finally, the rank of each value is computed within its statistics group (along the batch and spatial dimensions), and these ranks are converted to locations on a Gaussian via the inverse error function:</p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="target=\delta_{sd}\sqrt{2}erf^{-1}\left[\frac{2R}{1+N}-1\right]," class="ltx_Math" display="block" id="A1.Ex1.m1.1"><semantics id="A1.Ex1.m1.1a"><mrow id="A1.Ex1.m1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.3.2.cmml">t</mi><mo id="A1.Ex1.m1.1.1.1.1.3.1" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.3.3.cmml">a</mi><mo id="A1.Ex1.m1.1.1.1.1.3.1a" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.3.4" xref="A1.Ex1.m1.1.1.1.1.3.4.cmml">r</mi><mo id="A1.Ex1.m1.1.1.1.1.3.1b" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.3.5" xref="A1.Ex1.m1.1.1.1.1.3.5.cmml">g</mi><mo id="A1.Ex1.m1.1.1.1.1.3.1c" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.3.6" xref="A1.Ex1.m1.1.1.1.1.3.6.cmml">e</mi><mo id="A1.Ex1.m1.1.1.1.1.3.1d" xref="A1.Ex1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.3.7" xref="A1.Ex1.m1.1.1.1.1.3.7.cmml">t</mi></mrow><mo id="A1.Ex1.m1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.Ex1.m1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.cmml"><msub id="A1.Ex1.m1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.1.3.2.cmml">δ</mi><mrow id="A1.Ex1.m1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.3.3.2" xref="A1.Ex1.m1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="A1.Ex1.m1.1.1.1.1.1.3.3.1" xref="A1.Ex1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.1.3.3.3" xref="A1.Ex1.m1.1.1.1.1.1.3.3.3.cmml">d</mi></mrow></msub><mo id="A1.Ex1.m1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><msqrt id="A1.Ex1.m1.1.1.1.1.1.4" xref="A1.Ex1.m1.1.1.1.1.1.4.cmml"><mn id="A1.Ex1.m1.1.1.1.1.1.4.2" xref="A1.Ex1.m1.1.1.1.1.1.4.2.cmml">2</mn></msqrt><mo id="A1.Ex1.m1.1.1.1.1.1.2a" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.1.5" xref="A1.Ex1.m1.1.1.1.1.1.5.cmml">e</mi><mo id="A1.Ex1.m1.1.1.1.1.1.2b" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.1.6" xref="A1.Ex1.m1.1.1.1.1.1.6.cmml">r</mi><mo id="A1.Ex1.m1.1.1.1.1.1.2c" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><msup id="A1.Ex1.m1.1.1.1.1.1.7" xref="A1.Ex1.m1.1.1.1.1.1.7.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.7.2" xref="A1.Ex1.m1.1.1.1.1.1.7.2.cmml">f</mi><mrow id="A1.Ex1.m1.1.1.1.1.1.7.3" xref="A1.Ex1.m1.1.1.1.1.1.7.3.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.7.3a" xref="A1.Ex1.m1.1.1.1.1.1.7.3.cmml">−</mo><mn id="A1.Ex1.m1.1.1.1.1.1.7.3.2" xref="A1.Ex1.m1.1.1.1.1.1.7.3.2.cmml">1</mn></mrow></msup><mo id="A1.Ex1.m1.1.1.1.1.1.2d" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex1.m1.1.1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mfrac id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">2</mn><mo id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.1" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">R</mi></mrow><mrow id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mi id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">N</mi></mrow></mfrac><mo id="A1.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A1.Ex1.m1.1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.Ex1.m1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.1b"><apply id="A1.Ex1.m1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1"><eq id="A1.Ex1.m1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.2"></eq><apply id="A1.Ex1.m1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3"><times id="A1.Ex1.m1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.3.1"></times><ci id="A1.Ex1.m1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.3.2">𝑡</ci><ci id="A1.Ex1.m1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.3.3">𝑎</ci><ci id="A1.Ex1.m1.1.1.1.1.3.4.cmml" xref="A1.Ex1.m1.1.1.1.1.3.4">𝑟</ci><ci id="A1.Ex1.m1.1.1.1.1.3.5.cmml" xref="A1.Ex1.m1.1.1.1.1.3.5">𝑔</ci><ci id="A1.Ex1.m1.1.1.1.1.3.6.cmml" xref="A1.Ex1.m1.1.1.1.1.3.6">𝑒</ci><ci id="A1.Ex1.m1.1.1.1.1.3.7.cmml" xref="A1.Ex1.m1.1.1.1.1.3.7">𝑡</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1"><times id="A1.Ex1.m1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.2"></times><apply id="A1.Ex1.m1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.2">𝛿</ci><apply id="A1.Ex1.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.3"><times id="A1.Ex1.m1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.3.1"></times><ci id="A1.Ex1.m1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="A1.Ex1.m1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3.3.3">𝑑</ci></apply></apply><apply id="A1.Ex1.m1.1.1.1.1.1.4.cmml" xref="A1.Ex1.m1.1.1.1.1.1.4"><root id="A1.Ex1.m1.1.1.1.1.1.4a.cmml" xref="A1.Ex1.m1.1.1.1.1.1.4"></root><cn id="A1.Ex1.m1.1.1.1.1.1.4.2.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.4.2">2</cn></apply><ci id="A1.Ex1.m1.1.1.1.1.1.5.cmml" xref="A1.Ex1.m1.1.1.1.1.1.5">𝑒</ci><ci id="A1.Ex1.m1.1.1.1.1.1.6.cmml" xref="A1.Ex1.m1.1.1.1.1.1.6">𝑟</ci><apply id="A1.Ex1.m1.1.1.1.1.1.7.cmml" xref="A1.Ex1.m1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.7.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.7">superscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.7.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.7.2">𝑓</ci><apply id="A1.Ex1.m1.1.1.1.1.1.7.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.7.3"><minus id="A1.Ex1.m1.1.1.1.1.1.7.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.7.3"></minus><cn id="A1.Ex1.m1.1.1.1.1.1.7.3.2.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.7.3.2">1</cn></apply></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1"><minus id="A1.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2"><divide id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2"></divide><apply id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2"><times id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.1"></times><cn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2">2</cn><ci id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑅</ci></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3"><plus id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.1"></plus><cn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑁</ci></apply></apply><cn id="A1.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.1c">target=\delta_{sd}\sqrt{2}erf^{-1}\left[\frac{2R}{1+N}-1\right],</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.1d">italic_t italic_a italic_r italic_g italic_e italic_t = italic_δ start_POSTSUBSCRIPT italic_s italic_d end_POSTSUBSCRIPT square-root start_ARG 2 end_ARG italic_e italic_r italic_f start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT [ divide start_ARG 2 italic_R end_ARG start_ARG 1 + italic_N end_ARG - 1 ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.5">where <math alttext="R" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.1"><semantics id="A1.SS1.p4.1.m1.1a"><mi id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><ci id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.1d">italic_R</annotation></semantics></math> is the rank and <math alttext="N" class="ltx_Math" display="inline" id="A1.SS1.p4.2.m2.1"><semantics id="A1.SS1.p4.2.m2.1a"><mi id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><ci id="A1.SS1.p4.2.m2.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.2.m2.1d">italic_N</annotation></semantics></math> is the number of samples in the statistics group. Finally, the gradient is modified such that all values are pulled toward their corresponding <math alttext="target" class="ltx_Math" display="inline" id="A1.SS1.p4.3.m3.1"><semantics id="A1.SS1.p4.3.m3.1a"><mrow id="A1.SS1.p4.3.m3.1.1" xref="A1.SS1.p4.3.m3.1.1.cmml"><mi id="A1.SS1.p4.3.m3.1.1.2" xref="A1.SS1.p4.3.m3.1.1.2.cmml">t</mi><mo id="A1.SS1.p4.3.m3.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.3.m3.1.1.3" xref="A1.SS1.p4.3.m3.1.1.3.cmml">a</mi><mo id="A1.SS1.p4.3.m3.1.1.1a" xref="A1.SS1.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.3.m3.1.1.4" xref="A1.SS1.p4.3.m3.1.1.4.cmml">r</mi><mo id="A1.SS1.p4.3.m3.1.1.1b" xref="A1.SS1.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.3.m3.1.1.5" xref="A1.SS1.p4.3.m3.1.1.5.cmml">g</mi><mo id="A1.SS1.p4.3.m3.1.1.1c" xref="A1.SS1.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.3.m3.1.1.6" xref="A1.SS1.p4.3.m3.1.1.6.cmml">e</mi><mo id="A1.SS1.p4.3.m3.1.1.1d" xref="A1.SS1.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.3.m3.1.1.7" xref="A1.SS1.p4.3.m3.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.3.m3.1b"><apply id="A1.SS1.p4.3.m3.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1"><times id="A1.SS1.p4.3.m3.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1"></times><ci id="A1.SS1.p4.3.m3.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.2">𝑡</ci><ci id="A1.SS1.p4.3.m3.1.1.3.cmml" xref="A1.SS1.p4.3.m3.1.1.3">𝑎</ci><ci id="A1.SS1.p4.3.m3.1.1.4.cmml" xref="A1.SS1.p4.3.m3.1.1.4">𝑟</ci><ci id="A1.SS1.p4.3.m3.1.1.5.cmml" xref="A1.SS1.p4.3.m3.1.1.5">𝑔</ci><ci id="A1.SS1.p4.3.m3.1.1.6.cmml" xref="A1.SS1.p4.3.m3.1.1.6">𝑒</ci><ci id="A1.SS1.p4.3.m3.1.1.7.cmml" xref="A1.SS1.p4.3.m3.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.3.m3.1c">target</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.3.m3.1d">italic_t italic_a italic_r italic_g italic_e italic_t</annotation></semantics></math> by a constant (we used <math alttext="1e-2" class="ltx_Math" display="inline" id="A1.SS1.p4.4.m4.1"><semantics id="A1.SS1.p4.4.m4.1a"><mrow id="A1.SS1.p4.4.m4.1.1" xref="A1.SS1.p4.4.m4.1.1.cmml"><mrow id="A1.SS1.p4.4.m4.1.1.2" xref="A1.SS1.p4.4.m4.1.1.2.cmml"><mn id="A1.SS1.p4.4.m4.1.1.2.2" xref="A1.SS1.p4.4.m4.1.1.2.2.cmml">1</mn><mo id="A1.SS1.p4.4.m4.1.1.2.1" xref="A1.SS1.p4.4.m4.1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.p4.4.m4.1.1.2.3" xref="A1.SS1.p4.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="A1.SS1.p4.4.m4.1.1.1" xref="A1.SS1.p4.4.m4.1.1.1.cmml">−</mo><mn id="A1.SS1.p4.4.m4.1.1.3" xref="A1.SS1.p4.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.4.m4.1b"><apply id="A1.SS1.p4.4.m4.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1"><minus id="A1.SS1.p4.4.m4.1.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1.1"></minus><apply id="A1.SS1.p4.4.m4.1.1.2.cmml" xref="A1.SS1.p4.4.m4.1.1.2"><times id="A1.SS1.p4.4.m4.1.1.2.1.cmml" xref="A1.SS1.p4.4.m4.1.1.2.1"></times><cn id="A1.SS1.p4.4.m4.1.1.2.2.cmml" type="integer" xref="A1.SS1.p4.4.m4.1.1.2.2">1</cn><ci id="A1.SS1.p4.4.m4.1.1.2.3.cmml" xref="A1.SS1.p4.4.m4.1.1.2.3">𝑒</ci></apply><cn id="A1.SS1.p4.4.m4.1.1.3.cmml" type="integer" xref="A1.SS1.p4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.4.m4.1c">1e-2</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.4.m4.1d">1 italic_e - 2</annotation></semantics></math>) times the distance to <math alttext="target" class="ltx_Math" display="inline" id="A1.SS1.p4.5.m5.1"><semantics id="A1.SS1.p4.5.m5.1a"><mrow id="A1.SS1.p4.5.m5.1.1" xref="A1.SS1.p4.5.m5.1.1.cmml"><mi id="A1.SS1.p4.5.m5.1.1.2" xref="A1.SS1.p4.5.m5.1.1.2.cmml">t</mi><mo id="A1.SS1.p4.5.m5.1.1.1" xref="A1.SS1.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.5.m5.1.1.3" xref="A1.SS1.p4.5.m5.1.1.3.cmml">a</mi><mo id="A1.SS1.p4.5.m5.1.1.1a" xref="A1.SS1.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.5.m5.1.1.4" xref="A1.SS1.p4.5.m5.1.1.4.cmml">r</mi><mo id="A1.SS1.p4.5.m5.1.1.1b" xref="A1.SS1.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.5.m5.1.1.5" xref="A1.SS1.p4.5.m5.1.1.5.cmml">g</mi><mo id="A1.SS1.p4.5.m5.1.1.1c" xref="A1.SS1.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.5.m5.1.1.6" xref="A1.SS1.p4.5.m5.1.1.6.cmml">e</mi><mo id="A1.SS1.p4.5.m5.1.1.1d" xref="A1.SS1.p4.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS1.p4.5.m5.1.1.7" xref="A1.SS1.p4.5.m5.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.5.m5.1b"><apply id="A1.SS1.p4.5.m5.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1"><times id="A1.SS1.p4.5.m5.1.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1.1"></times><ci id="A1.SS1.p4.5.m5.1.1.2.cmml" xref="A1.SS1.p4.5.m5.1.1.2">𝑡</ci><ci id="A1.SS1.p4.5.m5.1.1.3.cmml" xref="A1.SS1.p4.5.m5.1.1.3">𝑎</ci><ci id="A1.SS1.p4.5.m5.1.1.4.cmml" xref="A1.SS1.p4.5.m5.1.1.4">𝑟</ci><ci id="A1.SS1.p4.5.m5.1.1.5.cmml" xref="A1.SS1.p4.5.m5.1.1.5">𝑔</ci><ci id="A1.SS1.p4.5.m5.1.1.6.cmml" xref="A1.SS1.p4.5.m5.1.1.6">𝑒</ci><ci id="A1.SS1.p4.5.m5.1.1.7.cmml" xref="A1.SS1.p4.5.m5.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.5.m5.1c">target</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.5.m5.1d">italic_t italic_a italic_r italic_g italic_e italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS1.p5">
<p class="ltx_p" id="A1.SS1.p5.1">The result, loosely named LayerNormRebalanced, ensures that each feature channel is fully used across different inputs, while also retaining train/test computational similarity and not saturating attention layers affected by the change in gradient.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Gaussian Mixture Models for Distributional RL</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">MuZero only tracked expectations of rewards. For environments with multiple distinct reward states (e.g., a player ship destroying a target, merely surviving, or itself being destroyed), it can be helpful for a human co-decider to understand the risks of these different reward states. To capture this information, we turn to distributional <span class="ltx_glossaryref" title="">RL</span> methods.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">Briefly, distributional <span class="ltx_glossaryref" title="">RL</span> involves capturing the entire reward distribution, instead of just an expectation. The original implementation that the authors are aware of was by Bellemare <span class="ltx_text ltx_font_italic" id="A1.SS2.p2.1.1">et al.</span>, and used point masses to approximate the distribution over a fixed range <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib20" title="">20</a>]</cite>. That technique has since been expanded with Implicit Quantile Networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib21" title="">21</a>]</cite> and <span class="ltx_glossaryref" title="">Gaussian mixture model (GMM)</span> approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib23" title="">23</a>]</cite>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.2">We appreciated the computational simplicity and representational power of the <span class="ltx_glossaryref" title="">GMM</span> approaches, but found difficulties with the optimization of those representations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib23" title="">23</a>]</cite>. This tended to manifest in environments with large reward values – e.g., a reasonably skilled Beamrider agent might have an expected total discounted reward range of <math alttext="[0,800]" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.2"><semantics id="A1.SS2.p3.1.m1.2a"><mrow id="A1.SS2.p3.1.m1.2.3.2" xref="A1.SS2.p3.1.m1.2.3.1.cmml"><mo id="A1.SS2.p3.1.m1.2.3.2.1" stretchy="false" xref="A1.SS2.p3.1.m1.2.3.1.cmml">[</mo><mn id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="A1.SS2.p3.1.m1.2.3.2.2" xref="A1.SS2.p3.1.m1.2.3.1.cmml">,</mo><mn id="A1.SS2.p3.1.m1.2.2" xref="A1.SS2.p3.1.m1.2.2.cmml">800</mn><mo id="A1.SS2.p3.1.m1.2.3.2.3" stretchy="false" xref="A1.SS2.p3.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.2b"><interval closure="closed" id="A1.SS2.p3.1.m1.2.3.1.cmml" xref="A1.SS2.p3.1.m1.2.3.2"><cn id="A1.SS2.p3.1.m1.1.1.cmml" type="integer" xref="A1.SS2.p3.1.m1.1.1">0</cn><cn id="A1.SS2.p3.1.m1.2.2.cmml" type="integer" xref="A1.SS2.p3.1.m1.2.2">800</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.2c">[0,800]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.2d">[ 0 , 800 ]</annotation></semantics></math>, whereas a Pong agent might only have a range of <math alttext="[-2,2]" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.2"><semantics id="A1.SS2.p3.2.m2.2a"><mrow id="A1.SS2.p3.2.m2.2.2.1" xref="A1.SS2.p3.2.m2.2.2.2.cmml"><mo id="A1.SS2.p3.2.m2.2.2.1.2" stretchy="false" xref="A1.SS2.p3.2.m2.2.2.2.cmml">[</mo><mrow id="A1.SS2.p3.2.m2.2.2.1.1" xref="A1.SS2.p3.2.m2.2.2.1.1.cmml"><mo id="A1.SS2.p3.2.m2.2.2.1.1a" xref="A1.SS2.p3.2.m2.2.2.1.1.cmml">−</mo><mn id="A1.SS2.p3.2.m2.2.2.1.1.2" xref="A1.SS2.p3.2.m2.2.2.1.1.2.cmml">2</mn></mrow><mo id="A1.SS2.p3.2.m2.2.2.1.3" xref="A1.SS2.p3.2.m2.2.2.2.cmml">,</mo><mn id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">2</mn><mo id="A1.SS2.p3.2.m2.2.2.1.4" stretchy="false" xref="A1.SS2.p3.2.m2.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.2b"><interval closure="closed" id="A1.SS2.p3.2.m2.2.2.2.cmml" xref="A1.SS2.p3.2.m2.2.2.1"><apply id="A1.SS2.p3.2.m2.2.2.1.1.cmml" xref="A1.SS2.p3.2.m2.2.2.1.1"><minus id="A1.SS2.p3.2.m2.2.2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.2.2.1.1"></minus><cn id="A1.SS2.p3.2.m2.2.2.1.1.2.cmml" type="integer" xref="A1.SS2.p3.2.m2.2.2.1.1.2">2</cn></apply><cn id="A1.SS2.p3.2.m2.1.1.cmml" type="integer" xref="A1.SS2.p3.2.m2.1.1">2</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.2c">[-2,2]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.2d">[ - 2 , 2 ]</annotation></semantics></math>. Instead, we found success with a novel, rank-based <span class="ltx_glossaryref" title="">GMM</span> update rule. Briefly, our representation and update rules are as follows.</p>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.4">For each distribution to be captured, decide a fixed number <math alttext="N_{gaussian}" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><msub id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">N</mi><mrow id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml"><mi id="A1.SS2.p4.1.m1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.1.3.2.cmml">g</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.3.3.cmml">a</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1a" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.4" xref="A1.SS2.p4.1.m1.1.1.3.4.cmml">u</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1b" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.5" xref="A1.SS2.p4.1.m1.1.1.3.5.cmml">s</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1c" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.6" xref="A1.SS2.p4.1.m1.1.1.3.6.cmml">s</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1d" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.7" xref="A1.SS2.p4.1.m1.1.1.3.7.cmml">i</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1e" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.8" xref="A1.SS2.p4.1.m1.1.1.3.8.cmml">a</mi><mo id="A1.SS2.p4.1.m1.1.1.3.1f" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.1.m1.1.1.3.9" xref="A1.SS2.p4.1.m1.1.1.3.9.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝑁</ci><apply id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3"><times id="A1.SS2.p4.1.m1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3.1"></times><ci id="A1.SS2.p4.1.m1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2">𝑔</ci><ci id="A1.SS2.p4.1.m1.1.1.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.3">𝑎</ci><ci id="A1.SS2.p4.1.m1.1.1.3.4.cmml" xref="A1.SS2.p4.1.m1.1.1.3.4">𝑢</ci><ci id="A1.SS2.p4.1.m1.1.1.3.5.cmml" xref="A1.SS2.p4.1.m1.1.1.3.5">𝑠</ci><ci id="A1.SS2.p4.1.m1.1.1.3.6.cmml" xref="A1.SS2.p4.1.m1.1.1.3.6">𝑠</ci><ci id="A1.SS2.p4.1.m1.1.1.3.7.cmml" xref="A1.SS2.p4.1.m1.1.1.3.7">𝑖</ci><ci id="A1.SS2.p4.1.m1.1.1.3.8.cmml" xref="A1.SS2.p4.1.m1.1.1.3.8">𝑎</ci><ci id="A1.SS2.p4.1.m1.1.1.3.9.cmml" xref="A1.SS2.p4.1.m1.1.1.3.9">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">N_{gaussian}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_g italic_a italic_u italic_s italic_s italic_i italic_a italic_n end_POSTSUBSCRIPT</annotation></semantics></math> of Gaussians to track, and output <math alttext="3N_{gaussian}" class="ltx_Math" display="inline" id="A1.SS2.p4.2.m2.1"><semantics id="A1.SS2.p4.2.m2.1a"><mrow id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml"><mn id="A1.SS2.p4.2.m2.1.1.2" xref="A1.SS2.p4.2.m2.1.1.2.cmml">3</mn><mo id="A1.SS2.p4.2.m2.1.1.1" xref="A1.SS2.p4.2.m2.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p4.2.m2.1.1.3" xref="A1.SS2.p4.2.m2.1.1.3.cmml"><mi id="A1.SS2.p4.2.m2.1.1.3.2" xref="A1.SS2.p4.2.m2.1.1.3.2.cmml">N</mi><mrow id="A1.SS2.p4.2.m2.1.1.3.3" xref="A1.SS2.p4.2.m2.1.1.3.3.cmml"><mi id="A1.SS2.p4.2.m2.1.1.3.3.2" xref="A1.SS2.p4.2.m2.1.1.3.3.2.cmml">g</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.3" xref="A1.SS2.p4.2.m2.1.1.3.3.3.cmml">a</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1a" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.4" xref="A1.SS2.p4.2.m2.1.1.3.3.4.cmml">u</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1b" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.5" xref="A1.SS2.p4.2.m2.1.1.3.3.5.cmml">s</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1c" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.6" xref="A1.SS2.p4.2.m2.1.1.3.3.6.cmml">s</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1d" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.7" xref="A1.SS2.p4.2.m2.1.1.3.3.7.cmml">i</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1e" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.8" xref="A1.SS2.p4.2.m2.1.1.3.3.8.cmml">a</mi><mo id="A1.SS2.p4.2.m2.1.1.3.3.1f" xref="A1.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p4.2.m2.1.1.3.3.9" xref="A1.SS2.p4.2.m2.1.1.3.3.9.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><apply id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1"><times id="A1.SS2.p4.2.m2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1.1"></times><cn id="A1.SS2.p4.2.m2.1.1.2.cmml" type="integer" xref="A1.SS2.p4.2.m2.1.1.2">3</cn><apply id="A1.SS2.p4.2.m2.1.1.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.p4.2.m2.1.1.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2">𝑁</ci><apply id="A1.SS2.p4.2.m2.1.1.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3"><times id="A1.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.1"></times><ci id="A1.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.2">𝑔</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.3">𝑎</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.4.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.4">𝑢</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.5.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.5">𝑠</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.6.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.6">𝑠</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.7.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.7">𝑖</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.8.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.8">𝑎</ci><ci id="A1.SS2.p4.2.m2.1.1.3.3.9.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3.9">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">3N_{gaussian}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.2.m2.1d">3 italic_N start_POSTSUBSCRIPT italic_g italic_a italic_u italic_s italic_s italic_i italic_a italic_n end_POSTSUBSCRIPT</annotation></semantics></math> parameters from the corresponding value/reward network for the mean, standard deviation, and log weight of each Gaussian component. To update the distribution with a new sampled value, rank the output Gaussian means according to absolute distance from the new value. Calculate update weight factors for each individual Gaussian as <math alttext="w_{rank=1}=1" class="ltx_Math" display="inline" id="A1.SS2.p4.3.m3.1"><semantics id="A1.SS2.p4.3.m3.1a"><mrow id="A1.SS2.p4.3.m3.1.1" xref="A1.SS2.p4.3.m3.1.1.cmml"><msub id="A1.SS2.p4.3.m3.1.1.2" xref="A1.SS2.p4.3.m3.1.1.2.cmml"><mi id="A1.SS2.p4.3.m3.1.1.2.2" xref="A1.SS2.p4.3.m3.1.1.2.2.cmml">w</mi><mrow id="A1.SS2.p4.3.m3.1.1.2.3" xref="A1.SS2.p4.3.m3.1.1.2.3.cmml"><mrow id="A1.SS2.p4.3.m3.1.1.2.3.2" xref="A1.SS2.p4.3.m3.1.1.2.3.2.cmml"><mi id="A1.SS2.p4.3.m3.1.1.2.3.2.2" xref="A1.SS2.p4.3.m3.1.1.2.3.2.2.cmml">r</mi><mo id="A1.SS2.p4.3.m3.1.1.2.3.2.1" xref="A1.SS2.p4.3.m3.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.3.m3.1.1.2.3.2.3" xref="A1.SS2.p4.3.m3.1.1.2.3.2.3.cmml">a</mi><mo id="A1.SS2.p4.3.m3.1.1.2.3.2.1a" xref="A1.SS2.p4.3.m3.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.3.m3.1.1.2.3.2.4" xref="A1.SS2.p4.3.m3.1.1.2.3.2.4.cmml">n</mi><mo id="A1.SS2.p4.3.m3.1.1.2.3.2.1b" xref="A1.SS2.p4.3.m3.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.3.m3.1.1.2.3.2.5" xref="A1.SS2.p4.3.m3.1.1.2.3.2.5.cmml">k</mi></mrow><mo id="A1.SS2.p4.3.m3.1.1.2.3.1" xref="A1.SS2.p4.3.m3.1.1.2.3.1.cmml">=</mo><mn id="A1.SS2.p4.3.m3.1.1.2.3.3" xref="A1.SS2.p4.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS2.p4.3.m3.1.1.1" xref="A1.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.p4.3.m3.1.1.3" xref="A1.SS2.p4.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m3.1b"><apply id="A1.SS2.p4.3.m3.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1"><eq id="A1.SS2.p4.3.m3.1.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1.1"></eq><apply id="A1.SS2.p4.3.m3.1.1.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m3.1.1.2.1.cmml" xref="A1.SS2.p4.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS2.p4.3.m3.1.1.2.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2.2">𝑤</ci><apply id="A1.SS2.p4.3.m3.1.1.2.3.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3"><eq id="A1.SS2.p4.3.m3.1.1.2.3.1.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.1"></eq><apply id="A1.SS2.p4.3.m3.1.1.2.3.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2"><times id="A1.SS2.p4.3.m3.1.1.2.3.2.1.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2.1"></times><ci id="A1.SS2.p4.3.m3.1.1.2.3.2.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2.2">𝑟</ci><ci id="A1.SS2.p4.3.m3.1.1.2.3.2.3.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2.3">𝑎</ci><ci id="A1.SS2.p4.3.m3.1.1.2.3.2.4.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2.4">𝑛</ci><ci id="A1.SS2.p4.3.m3.1.1.2.3.2.5.cmml" xref="A1.SS2.p4.3.m3.1.1.2.3.2.5">𝑘</ci></apply><cn id="A1.SS2.p4.3.m3.1.1.2.3.3.cmml" type="integer" xref="A1.SS2.p4.3.m3.1.1.2.3.3">1</cn></apply></apply><cn id="A1.SS2.p4.3.m3.1.1.3.cmml" type="integer" xref="A1.SS2.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m3.1c">w_{rank=1}=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_r italic_a italic_n italic_k = 1 end_POSTSUBSCRIPT = 1</annotation></semantics></math>, <math alttext="w_{rank\neq 1}=1e-3" class="ltx_Math" display="inline" id="A1.SS2.p4.4.m4.1"><semantics id="A1.SS2.p4.4.m4.1a"><mrow id="A1.SS2.p4.4.m4.1.1" xref="A1.SS2.p4.4.m4.1.1.cmml"><msub id="A1.SS2.p4.4.m4.1.1.2" xref="A1.SS2.p4.4.m4.1.1.2.cmml"><mi id="A1.SS2.p4.4.m4.1.1.2.2" xref="A1.SS2.p4.4.m4.1.1.2.2.cmml">w</mi><mrow id="A1.SS2.p4.4.m4.1.1.2.3" xref="A1.SS2.p4.4.m4.1.1.2.3.cmml"><mrow id="A1.SS2.p4.4.m4.1.1.2.3.2" xref="A1.SS2.p4.4.m4.1.1.2.3.2.cmml"><mi id="A1.SS2.p4.4.m4.1.1.2.3.2.2" xref="A1.SS2.p4.4.m4.1.1.2.3.2.2.cmml">r</mi><mo id="A1.SS2.p4.4.m4.1.1.2.3.2.1" xref="A1.SS2.p4.4.m4.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.4.m4.1.1.2.3.2.3" xref="A1.SS2.p4.4.m4.1.1.2.3.2.3.cmml">a</mi><mo id="A1.SS2.p4.4.m4.1.1.2.3.2.1a" xref="A1.SS2.p4.4.m4.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.4.m4.1.1.2.3.2.4" xref="A1.SS2.p4.4.m4.1.1.2.3.2.4.cmml">n</mi><mo id="A1.SS2.p4.4.m4.1.1.2.3.2.1b" xref="A1.SS2.p4.4.m4.1.1.2.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.4.m4.1.1.2.3.2.5" xref="A1.SS2.p4.4.m4.1.1.2.3.2.5.cmml">k</mi></mrow><mo id="A1.SS2.p4.4.m4.1.1.2.3.1" xref="A1.SS2.p4.4.m4.1.1.2.3.1.cmml">≠</mo><mn id="A1.SS2.p4.4.m4.1.1.2.3.3" xref="A1.SS2.p4.4.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS2.p4.4.m4.1.1.1" xref="A1.SS2.p4.4.m4.1.1.1.cmml">=</mo><mrow id="A1.SS2.p4.4.m4.1.1.3" xref="A1.SS2.p4.4.m4.1.1.3.cmml"><mrow id="A1.SS2.p4.4.m4.1.1.3.2" xref="A1.SS2.p4.4.m4.1.1.3.2.cmml"><mn id="A1.SS2.p4.4.m4.1.1.3.2.2" xref="A1.SS2.p4.4.m4.1.1.3.2.2.cmml">1</mn><mo id="A1.SS2.p4.4.m4.1.1.3.2.1" xref="A1.SS2.p4.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="A1.SS2.p4.4.m4.1.1.3.2.3" xref="A1.SS2.p4.4.m4.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.SS2.p4.4.m4.1.1.3.1" xref="A1.SS2.p4.4.m4.1.1.3.1.cmml">−</mo><mn id="A1.SS2.p4.4.m4.1.1.3.3" xref="A1.SS2.p4.4.m4.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m4.1b"><apply id="A1.SS2.p4.4.m4.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1"><eq id="A1.SS2.p4.4.m4.1.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1.1"></eq><apply id="A1.SS2.p4.4.m4.1.1.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p4.4.m4.1.1.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS2.p4.4.m4.1.1.2.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2.2">𝑤</ci><apply id="A1.SS2.p4.4.m4.1.1.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3"><neq id="A1.SS2.p4.4.m4.1.1.2.3.1.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.1"></neq><apply id="A1.SS2.p4.4.m4.1.1.2.3.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2"><times id="A1.SS2.p4.4.m4.1.1.2.3.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2.1"></times><ci id="A1.SS2.p4.4.m4.1.1.2.3.2.2.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2.2">𝑟</ci><ci id="A1.SS2.p4.4.m4.1.1.2.3.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2.3">𝑎</ci><ci id="A1.SS2.p4.4.m4.1.1.2.3.2.4.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2.4">𝑛</ci><ci id="A1.SS2.p4.4.m4.1.1.2.3.2.5.cmml" xref="A1.SS2.p4.4.m4.1.1.2.3.2.5">𝑘</ci></apply><cn id="A1.SS2.p4.4.m4.1.1.2.3.3.cmml" type="integer" xref="A1.SS2.p4.4.m4.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS2.p4.4.m4.1.1.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3"><minus id="A1.SS2.p4.4.m4.1.1.3.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3.1"></minus><apply id="A1.SS2.p4.4.m4.1.1.3.2.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2"><times id="A1.SS2.p4.4.m4.1.1.3.2.1.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.1"></times><cn id="A1.SS2.p4.4.m4.1.1.3.2.2.cmml" type="integer" xref="A1.SS2.p4.4.m4.1.1.3.2.2">1</cn><ci id="A1.SS2.p4.4.m4.1.1.3.2.3.cmml" xref="A1.SS2.p4.4.m4.1.1.3.2.3">𝑒</ci></apply><cn id="A1.SS2.p4.4.m4.1.1.3.3.cmml" type="integer" xref="A1.SS2.p4.4.m4.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m4.1c">w_{rank\neq 1}=1e-3</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_r italic_a italic_n italic_k ≠ 1 end_POSTSUBSCRIPT = 1 italic_e - 3</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.1">To update the means of all Gaussians, pull them all toward the new value using <span class="ltx_glossaryref" title="">mean-squared error (MSE)</span> weighted by the weight factor multiplied (via a cross product) with the weight of the Gaussians themselves.</p>
</div>
<div class="ltx_para" id="A1.SS2.p6">
<p class="ltx_p" id="A1.SS2.p6.1">To update the standard deviations of all Gaussians, use <span class="ltx_glossaryref" title="">MSE</span> to pull them all toward the newly predicted variance plus the variance between the predicted mean and the new value. As with the mean, weight this pull by the weight factor crossed with the weight of the Gaussians themselves, but divide by 10 as standard deviation provides utility only for the user, and not for the algorithm’s ability to make good decisions. Note that this does <span class="ltx_text ltx_font_italic" id="A1.SS2.p6.1.1">not</span> produce an exact estimate of standard deviation – however, what it does do is keep the <span class="ltx_text ltx_font_italic" id="A1.SS2.p6.1.2">scale</span> of the gradient update corresponding to standard deviation on the same scale as the mean update. We found this to be the main issue with, e.g., GMAC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib23" title="">23</a>]</cite>. Essentially, its updates were not well balanced with all of the other updates required for a complex system like MuZero to work well.</p>
</div>
<div class="ltx_para" id="A1.SS2.p7">
<p class="ltx_p" id="A1.SS2.p7.1">To update the log weight of each Gaussian, we also take steps to balance the scale of this update against the scale of the other updates. Before computing the log softmax of all Gaussian weights, we pass the raw values output from the <span class="ltx_glossaryref" title="">NN</span> through a hook that, on the backwards pass, weights each gradient by the absolute value of the difference between the overall expected mean value of the distribution and the expected value of the Gaussian being updated by that gradient. Since log softmax gradient updates range strictly on <math alttext="[-1,1]" class="ltx_Math" display="inline" id="A1.SS2.p7.1.m1.2"><semantics id="A1.SS2.p7.1.m1.2a"><mrow id="A1.SS2.p7.1.m1.2.2.1" xref="A1.SS2.p7.1.m1.2.2.2.cmml"><mo id="A1.SS2.p7.1.m1.2.2.1.2" stretchy="false" xref="A1.SS2.p7.1.m1.2.2.2.cmml">[</mo><mrow id="A1.SS2.p7.1.m1.2.2.1.1" xref="A1.SS2.p7.1.m1.2.2.1.1.cmml"><mo id="A1.SS2.p7.1.m1.2.2.1.1a" xref="A1.SS2.p7.1.m1.2.2.1.1.cmml">−</mo><mn id="A1.SS2.p7.1.m1.2.2.1.1.2" xref="A1.SS2.p7.1.m1.2.2.1.1.2.cmml">1</mn></mrow><mo id="A1.SS2.p7.1.m1.2.2.1.3" xref="A1.SS2.p7.1.m1.2.2.2.cmml">,</mo><mn id="A1.SS2.p7.1.m1.1.1" xref="A1.SS2.p7.1.m1.1.1.cmml">1</mn><mo id="A1.SS2.p7.1.m1.2.2.1.4" stretchy="false" xref="A1.SS2.p7.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p7.1.m1.2b"><interval closure="closed" id="A1.SS2.p7.1.m1.2.2.2.cmml" xref="A1.SS2.p7.1.m1.2.2.1"><apply id="A1.SS2.p7.1.m1.2.2.1.1.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1"><minus id="A1.SS2.p7.1.m1.2.2.1.1.1.cmml" xref="A1.SS2.p7.1.m1.2.2.1.1"></minus><cn id="A1.SS2.p7.1.m1.2.2.1.1.2.cmml" type="integer" xref="A1.SS2.p7.1.m1.2.2.1.1.2">1</cn></apply><cn id="A1.SS2.p7.1.m1.1.1.cmml" type="integer" xref="A1.SS2.p7.1.m1.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p7.1.m1.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p7.1.m1.2d">[ - 1 , 1 ]</annotation></semantics></math>, this multiplication brings them into the same scale as the mean and standard deviation updates. To prevent value drift, we also apply a mild centering effect such that the expected network output over the emitted Gaussian weight parameters is zero. In the forward pass, after this hook, the log softmax update is computed according to normal categorical cross entropy, where the log of each Gaussian’s weight is increased in proportion with its corresponding weight factor.</p>
</div>
<div class="ltx_para" id="A1.SS2.p8">
<p class="ltx_p" id="A1.SS2.p8.1">Put together, the magnitude of each component’s update gradient is proportional to the expected L2 difference between the closest Gaussian mean and the sampled data point. An example captured distribution is shown in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.F11" title="In A.2 Gaussian Mixture Models for Distributional RL ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<figure class="ltx_figure" id="A1.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="75" id="A1.F11.g1" src="extracted/5912081/img/RankGMM.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Screenshot of captured reward densities from Beamrider, in a situation where the user has a chance of losing the game (i.e., of zero reward).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Loss Segment Scaling</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">For maximum diversity in different environments, and to increase interpretability for the user, we opted to keep reward units in the environment’s scale (e.g., the number of points in a game), without clipping or other transformations. In a similar spirit as the gradient corrections from <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS2" title="A.2 Gaussian Mixture Models for Distributional RL ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>, we found that environments with large reward ranges needed additional loss tweaking from the standard MuZero format to support e.g. the SimSiam loss from EfficientZero <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib2" title="">2</a>]</cite>. This is a direct result of the gradients for the value/reward/action networks scaling with the observed reward magnitudes, while other gradients do not scale with those quantities. The best solution we found for this was to estimate the L1 or L2 distance between actions chosen uniformly at random. This essentially is a measure of how sensitive the reward space was to different action choices, a quantity that roughly scales with the loss magnitudes used by the core MuZero mechanics; by dividing any reward-space updates (such as value/reward network updates) by this quantity, we found that the other network hyperparameters generalized across multiple environments.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Complex Action Spaces via a Pairwise Policy Update</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">The original MuZero paper provided policy update and policy search methods that could only handle discrete action spaces. While an extension was developed for complex action spaces <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib24" title="">24</a>]</cite>, we felt that that approach had a number of potential deficiencies. First, their inner policy update still uses visit counts. What happens when very similar actions (due to, e.g., a continuous action space) are visited twice as a result of the outer random sampling? Then, each has its own visit count from the <span class="ltx_glossaryref" title="">MCTS</span> process, despite being virtually identical, biasing toward over-sampling (and thus preferring) those values. This can be corrected via techniques such as importance sampling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib25" title="">25</a>]</cite>, but we wondered if there is a more straightforward way to produce policy updates.</p>
</div>
<div class="ltx_para" id="A1.SS4.p2">
<p class="ltx_p" id="A1.SS4.p2.1">Drawing inspiration from prior work on <span class="ltx_glossaryref" title="">RL</span> for grammatical inference (RL-GRIT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib26" title="">26</a>]</cite>, we leveraged a pairwise policy update approach. This has a number of potential advantages: (1) as with <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS2" title="A.2 Gaussian Mixture Models for Distributional RL ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>, loss scales according to changes in expected reward, (2) it works the same for any kind of action space, and (3) as discussed in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS6" title="A.6 Particle Swarm Tree Search ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.6</span></a>, it lends itself very well to an alternative of <span class="ltx_glossaryref" title="">MCTS</span> that is faster to compute while conferring similar benefits.</p>
</div>
<div class="ltx_para" id="A1.SS4.p3">
<p class="ltx_p" id="A1.SS4.p3.5">Generally, the pairwise policy update works as follows: sample <math alttext="N_{update}" class="ltx_Math" display="inline" id="A1.SS4.p3.1.m1.1"><semantics id="A1.SS4.p3.1.m1.1a"><msub id="A1.SS4.p3.1.m1.1.1" xref="A1.SS4.p3.1.m1.1.1.cmml"><mi id="A1.SS4.p3.1.m1.1.1.2" xref="A1.SS4.p3.1.m1.1.1.2.cmml">N</mi><mrow id="A1.SS4.p3.1.m1.1.1.3" xref="A1.SS4.p3.1.m1.1.1.3.cmml"><mi id="A1.SS4.p3.1.m1.1.1.3.2" xref="A1.SS4.p3.1.m1.1.1.3.2.cmml">u</mi><mo id="A1.SS4.p3.1.m1.1.1.3.1" xref="A1.SS4.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.1.m1.1.1.3.3" xref="A1.SS4.p3.1.m1.1.1.3.3.cmml">p</mi><mo id="A1.SS4.p3.1.m1.1.1.3.1a" xref="A1.SS4.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.1.m1.1.1.3.4" xref="A1.SS4.p3.1.m1.1.1.3.4.cmml">d</mi><mo id="A1.SS4.p3.1.m1.1.1.3.1b" xref="A1.SS4.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.1.m1.1.1.3.5" xref="A1.SS4.p3.1.m1.1.1.3.5.cmml">a</mi><mo id="A1.SS4.p3.1.m1.1.1.3.1c" xref="A1.SS4.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.1.m1.1.1.3.6" xref="A1.SS4.p3.1.m1.1.1.3.6.cmml">t</mi><mo id="A1.SS4.p3.1.m1.1.1.3.1d" xref="A1.SS4.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.1.m1.1.1.3.7" xref="A1.SS4.p3.1.m1.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.1.m1.1b"><apply id="A1.SS4.p3.1.m1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS4.p3.1.m1.1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS4.p3.1.m1.1.1.2.cmml" xref="A1.SS4.p3.1.m1.1.1.2">𝑁</ci><apply id="A1.SS4.p3.1.m1.1.1.3.cmml" xref="A1.SS4.p3.1.m1.1.1.3"><times id="A1.SS4.p3.1.m1.1.1.3.1.cmml" xref="A1.SS4.p3.1.m1.1.1.3.1"></times><ci id="A1.SS4.p3.1.m1.1.1.3.2.cmml" xref="A1.SS4.p3.1.m1.1.1.3.2">𝑢</ci><ci id="A1.SS4.p3.1.m1.1.1.3.3.cmml" xref="A1.SS4.p3.1.m1.1.1.3.3">𝑝</ci><ci id="A1.SS4.p3.1.m1.1.1.3.4.cmml" xref="A1.SS4.p3.1.m1.1.1.3.4">𝑑</ci><ci id="A1.SS4.p3.1.m1.1.1.3.5.cmml" xref="A1.SS4.p3.1.m1.1.1.3.5">𝑎</ci><ci id="A1.SS4.p3.1.m1.1.1.3.6.cmml" xref="A1.SS4.p3.1.m1.1.1.3.6">𝑡</ci><ci id="A1.SS4.p3.1.m1.1.1.3.7.cmml" xref="A1.SS4.p3.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.1.m1.1c">N_{update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math> potential actions from the current action distribution, and for each <math alttext="i\in 1..N_{update}" class="ltx_math_unparsed" display="inline" id="A1.SS4.p3.2.m2.1"><semantics id="A1.SS4.p3.2.m2.1a"><mrow id="A1.SS4.p3.2.m2.1b"><mi id="A1.SS4.p3.2.m2.1.1">i</mi><mo id="A1.SS4.p3.2.m2.1.2">∈</mo><mn id="A1.SS4.p3.2.m2.1.3">1</mn><mo id="A1.SS4.p3.2.m2.1.4" lspace="0em" rspace="0.0835em">.</mo><mo id="A1.SS4.p3.2.m2.1.5" lspace="0.0835em" rspace="0.167em">.</mo><msub id="A1.SS4.p3.2.m2.1.6"><mi id="A1.SS4.p3.2.m2.1.6.2">N</mi><mrow id="A1.SS4.p3.2.m2.1.6.3"><mi id="A1.SS4.p3.2.m2.1.6.3.2">u</mi><mo id="A1.SS4.p3.2.m2.1.6.3.1">⁢</mo><mi id="A1.SS4.p3.2.m2.1.6.3.3">p</mi><mo id="A1.SS4.p3.2.m2.1.6.3.1a">⁢</mo><mi id="A1.SS4.p3.2.m2.1.6.3.4">d</mi><mo id="A1.SS4.p3.2.m2.1.6.3.1b">⁢</mo><mi id="A1.SS4.p3.2.m2.1.6.3.5">a</mi><mo id="A1.SS4.p3.2.m2.1.6.3.1c">⁢</mo><mi id="A1.SS4.p3.2.m2.1.6.3.6">t</mi><mo id="A1.SS4.p3.2.m2.1.6.3.1d">⁢</mo><mi id="A1.SS4.p3.2.m2.1.6.3.7">e</mi></mrow></msub></mrow><annotation encoding="application/x-tex" id="A1.SS4.p3.2.m2.1c">i\in 1..N_{update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.2.m2.1d">italic_i ∈ 1 . . italic_N start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math> compute both <math alttext="\log P_{i,update}" class="ltx_Math" display="inline" id="A1.SS4.p3.3.m3.2"><semantics id="A1.SS4.p3.3.m3.2a"><mrow id="A1.SS4.p3.3.m3.2.3" xref="A1.SS4.p3.3.m3.2.3.cmml"><mi id="A1.SS4.p3.3.m3.2.3.1" xref="A1.SS4.p3.3.m3.2.3.1.cmml">log</mi><mo id="A1.SS4.p3.3.m3.2.3a" lspace="0.167em" xref="A1.SS4.p3.3.m3.2.3.cmml">⁡</mo><msub id="A1.SS4.p3.3.m3.2.3.2" xref="A1.SS4.p3.3.m3.2.3.2.cmml"><mi id="A1.SS4.p3.3.m3.2.3.2.2" xref="A1.SS4.p3.3.m3.2.3.2.2.cmml">P</mi><mrow id="A1.SS4.p3.3.m3.2.2.2.2" xref="A1.SS4.p3.3.m3.2.2.2.3.cmml"><mi id="A1.SS4.p3.3.m3.1.1.1.1" xref="A1.SS4.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.2" xref="A1.SS4.p3.3.m3.2.2.2.3.cmml">,</mo><mrow id="A1.SS4.p3.3.m3.2.2.2.2.1" xref="A1.SS4.p3.3.m3.2.2.2.2.1.cmml"><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.2" xref="A1.SS4.p3.3.m3.2.2.2.2.1.2.cmml">u</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.1.1" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.3" xref="A1.SS4.p3.3.m3.2.2.2.2.1.3.cmml">p</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.1.1a" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.4" xref="A1.SS4.p3.3.m3.2.2.2.2.1.4.cmml">d</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.1.1b" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.5" xref="A1.SS4.p3.3.m3.2.2.2.2.1.5.cmml">a</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.1.1c" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.6" xref="A1.SS4.p3.3.m3.2.2.2.2.1.6.cmml">t</mi><mo id="A1.SS4.p3.3.m3.2.2.2.2.1.1d" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m3.2.2.2.2.1.7" xref="A1.SS4.p3.3.m3.2.2.2.2.1.7.cmml">e</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.3.m3.2b"><apply id="A1.SS4.p3.3.m3.2.3.cmml" xref="A1.SS4.p3.3.m3.2.3"><log id="A1.SS4.p3.3.m3.2.3.1.cmml" xref="A1.SS4.p3.3.m3.2.3.1"></log><apply id="A1.SS4.p3.3.m3.2.3.2.cmml" xref="A1.SS4.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m3.2.3.2.1.cmml" xref="A1.SS4.p3.3.m3.2.3.2">subscript</csymbol><ci id="A1.SS4.p3.3.m3.2.3.2.2.cmml" xref="A1.SS4.p3.3.m3.2.3.2.2">𝑃</ci><list id="A1.SS4.p3.3.m3.2.2.2.3.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2"><ci id="A1.SS4.p3.3.m3.1.1.1.1.cmml" xref="A1.SS4.p3.3.m3.1.1.1.1">𝑖</ci><apply id="A1.SS4.p3.3.m3.2.2.2.2.1.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1"><times id="A1.SS4.p3.3.m3.2.2.2.2.1.1.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.1"></times><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.2.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.2">𝑢</ci><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.3.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.3">𝑝</ci><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.4.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.4">𝑑</ci><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.5.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.5">𝑎</ci><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.6.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.6">𝑡</ci><ci id="A1.SS4.p3.3.m3.2.2.2.2.1.7.cmml" xref="A1.SS4.p3.3.m3.2.2.2.2.1.7">𝑒</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.3.m3.2c">\log P_{i,update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.3.m3.2d">roman_log italic_P start_POSTSUBSCRIPT italic_i , italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, the log probability of selecting that action, and <math alttext="Q_{i,update}" class="ltx_Math" display="inline" id="A1.SS4.p3.4.m4.2"><semantics id="A1.SS4.p3.4.m4.2a"><msub id="A1.SS4.p3.4.m4.2.3" xref="A1.SS4.p3.4.m4.2.3.cmml"><mi id="A1.SS4.p3.4.m4.2.3.2" xref="A1.SS4.p3.4.m4.2.3.2.cmml">Q</mi><mrow id="A1.SS4.p3.4.m4.2.2.2.2" xref="A1.SS4.p3.4.m4.2.2.2.3.cmml"><mi id="A1.SS4.p3.4.m4.1.1.1.1" xref="A1.SS4.p3.4.m4.1.1.1.1.cmml">i</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.2" xref="A1.SS4.p3.4.m4.2.2.2.3.cmml">,</mo><mrow id="A1.SS4.p3.4.m4.2.2.2.2.1" xref="A1.SS4.p3.4.m4.2.2.2.2.1.cmml"><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.2" xref="A1.SS4.p3.4.m4.2.2.2.2.1.2.cmml">u</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.1.1" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.3" xref="A1.SS4.p3.4.m4.2.2.2.2.1.3.cmml">p</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.1.1a" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.4" xref="A1.SS4.p3.4.m4.2.2.2.2.1.4.cmml">d</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.1.1b" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.5" xref="A1.SS4.p3.4.m4.2.2.2.2.1.5.cmml">a</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.1.1c" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.6" xref="A1.SS4.p3.4.m4.2.2.2.2.1.6.cmml">t</mi><mo id="A1.SS4.p3.4.m4.2.2.2.2.1.1d" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.4.m4.2.2.2.2.1.7" xref="A1.SS4.p3.4.m4.2.2.2.2.1.7.cmml">e</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.4.m4.2b"><apply id="A1.SS4.p3.4.m4.2.3.cmml" xref="A1.SS4.p3.4.m4.2.3"><csymbol cd="ambiguous" id="A1.SS4.p3.4.m4.2.3.1.cmml" xref="A1.SS4.p3.4.m4.2.3">subscript</csymbol><ci id="A1.SS4.p3.4.m4.2.3.2.cmml" xref="A1.SS4.p3.4.m4.2.3.2">𝑄</ci><list id="A1.SS4.p3.4.m4.2.2.2.3.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2"><ci id="A1.SS4.p3.4.m4.1.1.1.1.cmml" xref="A1.SS4.p3.4.m4.1.1.1.1">𝑖</ci><apply id="A1.SS4.p3.4.m4.2.2.2.2.1.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1"><times id="A1.SS4.p3.4.m4.2.2.2.2.1.1.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.1"></times><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.2.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.2">𝑢</ci><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.3.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.3">𝑝</ci><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.4.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.4">𝑑</ci><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.5.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.5">𝑎</ci><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.6.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.6">𝑡</ci><ci id="A1.SS4.p3.4.m4.2.2.2.2.1.7.cmml" xref="A1.SS4.p3.4.m4.2.2.2.2.1.7">𝑒</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.4.m4.2c">Q_{i,update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.4.m4.2d">italic_Q start_POSTSUBSCRIPT italic_i , italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, the expected Q value for taking that action. Then, compute <math alttext="\partial\log P_{i,update}=\frac{1}{N_{update}}\sum_{j=1}^{N_{update}}Q_{j,%
update}-Q_{i,update}" class="ltx_Math" display="inline" id="A1.SS4.p3.5.m5.6"><semantics id="A1.SS4.p3.5.m5.6a"><mrow id="A1.SS4.p3.5.m5.6.7" xref="A1.SS4.p3.5.m5.6.7.cmml"><mrow id="A1.SS4.p3.5.m5.6.7.2" xref="A1.SS4.p3.5.m5.6.7.2.cmml"><mo id="A1.SS4.p3.5.m5.6.7.2.1" rspace="0.167em" xref="A1.SS4.p3.5.m5.6.7.2.1.cmml">∂</mo><mrow id="A1.SS4.p3.5.m5.6.7.2.2" xref="A1.SS4.p3.5.m5.6.7.2.2.cmml"><mi id="A1.SS4.p3.5.m5.6.7.2.2.1" xref="A1.SS4.p3.5.m5.6.7.2.2.1.cmml">log</mi><mo id="A1.SS4.p3.5.m5.6.7.2.2a" lspace="0.167em" xref="A1.SS4.p3.5.m5.6.7.2.2.cmml">⁡</mo><msub id="A1.SS4.p3.5.m5.6.7.2.2.2" xref="A1.SS4.p3.5.m5.6.7.2.2.2.cmml"><mi id="A1.SS4.p3.5.m5.6.7.2.2.2.2" xref="A1.SS4.p3.5.m5.6.7.2.2.2.2.cmml">P</mi><mrow id="A1.SS4.p3.5.m5.2.2.2.2" xref="A1.SS4.p3.5.m5.2.2.2.3.cmml"><mi id="A1.SS4.p3.5.m5.1.1.1.1" xref="A1.SS4.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.2" xref="A1.SS4.p3.5.m5.2.2.2.3.cmml">,</mo><mrow id="A1.SS4.p3.5.m5.2.2.2.2.1" xref="A1.SS4.p3.5.m5.2.2.2.2.1.cmml"><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.2" xref="A1.SS4.p3.5.m5.2.2.2.2.1.2.cmml">u</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.1.1" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.3" xref="A1.SS4.p3.5.m5.2.2.2.2.1.3.cmml">p</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.1.1a" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.4" xref="A1.SS4.p3.5.m5.2.2.2.2.1.4.cmml">d</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.1.1b" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.5" xref="A1.SS4.p3.5.m5.2.2.2.2.1.5.cmml">a</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.1.1c" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.6" xref="A1.SS4.p3.5.m5.2.2.2.2.1.6.cmml">t</mi><mo id="A1.SS4.p3.5.m5.2.2.2.2.1.1d" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.2.2.2.2.1.7" xref="A1.SS4.p3.5.m5.2.2.2.2.1.7.cmml">e</mi></mrow></mrow></msub></mrow></mrow><mo id="A1.SS4.p3.5.m5.6.7.1" xref="A1.SS4.p3.5.m5.6.7.1.cmml">=</mo><mrow id="A1.SS4.p3.5.m5.6.7.3" xref="A1.SS4.p3.5.m5.6.7.3.cmml"><mrow id="A1.SS4.p3.5.m5.6.7.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.cmml"><mfrac id="A1.SS4.p3.5.m5.6.7.3.2.2" xref="A1.SS4.p3.5.m5.6.7.3.2.2.cmml"><mn id="A1.SS4.p3.5.m5.6.7.3.2.2.2" xref="A1.SS4.p3.5.m5.6.7.3.2.2.2.cmml">1</mn><msub id="A1.SS4.p3.5.m5.6.7.3.2.2.3" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.2.cmml">N</mi><mrow id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.2.cmml">u</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.3" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.3.cmml">p</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1a" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.4" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.4.cmml">d</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1b" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.5" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.5.cmml">a</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1c" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.6" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.6.cmml">t</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1d" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.7" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.7.cmml">e</mi></mrow></msub></mfrac><mo id="A1.SS4.p3.5.m5.6.7.3.2.1" xref="A1.SS4.p3.5.m5.6.7.3.2.1.cmml">⁢</mo><mrow id="A1.SS4.p3.5.m5.6.7.3.2.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.cmml"><msubsup id="A1.SS4.p3.5.m5.6.7.3.2.3.1" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.cmml"><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.2.cmml">∑</mo><mrow id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.2.cmml">j</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.1" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.1.cmml">=</mo><mn id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.2.cmml">N</mi><mrow id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.2.cmml">u</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.3" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.3.cmml">p</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1a" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.4" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.4.cmml">d</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1b" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.5" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.5.cmml">a</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1c" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.6" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.6.cmml">t</mi><mo id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1d" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.7" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.7.cmml">e</mi></mrow></msub></msubsup><msub id="A1.SS4.p3.5.m5.6.7.3.2.3.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.2.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.2.3.2.2" xref="A1.SS4.p3.5.m5.6.7.3.2.3.2.2.cmml">Q</mi><mrow id="A1.SS4.p3.5.m5.4.4.2.2" xref="A1.SS4.p3.5.m5.4.4.2.3.cmml"><mi id="A1.SS4.p3.5.m5.3.3.1.1" xref="A1.SS4.p3.5.m5.3.3.1.1.cmml">j</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.2" xref="A1.SS4.p3.5.m5.4.4.2.3.cmml">,</mo><mrow id="A1.SS4.p3.5.m5.4.4.2.2.1" xref="A1.SS4.p3.5.m5.4.4.2.2.1.cmml"><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.2" xref="A1.SS4.p3.5.m5.4.4.2.2.1.2.cmml">u</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.1.1" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.3" xref="A1.SS4.p3.5.m5.4.4.2.2.1.3.cmml">p</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.1.1a" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.4" xref="A1.SS4.p3.5.m5.4.4.2.2.1.4.cmml">d</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.1.1b" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.5" xref="A1.SS4.p3.5.m5.4.4.2.2.1.5.cmml">a</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.1.1c" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.6" xref="A1.SS4.p3.5.m5.4.4.2.2.1.6.cmml">t</mi><mo id="A1.SS4.p3.5.m5.4.4.2.2.1.1d" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.4.4.2.2.1.7" xref="A1.SS4.p3.5.m5.4.4.2.2.1.7.cmml">e</mi></mrow></mrow></msub></mrow></mrow><mo id="A1.SS4.p3.5.m5.6.7.3.1" xref="A1.SS4.p3.5.m5.6.7.3.1.cmml">−</mo><msub id="A1.SS4.p3.5.m5.6.7.3.3" xref="A1.SS4.p3.5.m5.6.7.3.3.cmml"><mi id="A1.SS4.p3.5.m5.6.7.3.3.2" xref="A1.SS4.p3.5.m5.6.7.3.3.2.cmml">Q</mi><mrow id="A1.SS4.p3.5.m5.6.6.2.2" xref="A1.SS4.p3.5.m5.6.6.2.3.cmml"><mi id="A1.SS4.p3.5.m5.5.5.1.1" xref="A1.SS4.p3.5.m5.5.5.1.1.cmml">i</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.2" xref="A1.SS4.p3.5.m5.6.6.2.3.cmml">,</mo><mrow id="A1.SS4.p3.5.m5.6.6.2.2.1" xref="A1.SS4.p3.5.m5.6.6.2.2.1.cmml"><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.2" xref="A1.SS4.p3.5.m5.6.6.2.2.1.2.cmml">u</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.1.1" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.3" xref="A1.SS4.p3.5.m5.6.6.2.2.1.3.cmml">p</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.1.1a" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.4" xref="A1.SS4.p3.5.m5.6.6.2.2.1.4.cmml">d</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.1.1b" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.5" xref="A1.SS4.p3.5.m5.6.6.2.2.1.5.cmml">a</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.1.1c" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.6" xref="A1.SS4.p3.5.m5.6.6.2.2.1.6.cmml">t</mi><mo id="A1.SS4.p3.5.m5.6.6.2.2.1.1d" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.5.m5.6.6.2.2.1.7" xref="A1.SS4.p3.5.m5.6.6.2.2.1.7.cmml">e</mi></mrow></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.5.m5.6b"><apply id="A1.SS4.p3.5.m5.6.7.cmml" xref="A1.SS4.p3.5.m5.6.7"><eq id="A1.SS4.p3.5.m5.6.7.1.cmml" xref="A1.SS4.p3.5.m5.6.7.1"></eq><apply id="A1.SS4.p3.5.m5.6.7.2.cmml" xref="A1.SS4.p3.5.m5.6.7.2"><partialdiff id="A1.SS4.p3.5.m5.6.7.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.2.1"></partialdiff><apply id="A1.SS4.p3.5.m5.6.7.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.2.2"><log id="A1.SS4.p3.5.m5.6.7.2.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.2.2.1"></log><apply id="A1.SS4.p3.5.m5.6.7.2.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.2.2.2"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.2.2.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.2.2.2">subscript</csymbol><ci id="A1.SS4.p3.5.m5.6.7.2.2.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.2.2.2.2">𝑃</ci><list id="A1.SS4.p3.5.m5.2.2.2.3.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2"><ci id="A1.SS4.p3.5.m5.1.1.1.1.cmml" xref="A1.SS4.p3.5.m5.1.1.1.1">𝑖</ci><apply id="A1.SS4.p3.5.m5.2.2.2.2.1.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1"><times id="A1.SS4.p3.5.m5.2.2.2.2.1.1.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.1"></times><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.2.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.2">𝑢</ci><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.3.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.3">𝑝</ci><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.4.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.4">𝑑</ci><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.5.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.5">𝑎</ci><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.6.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.6">𝑡</ci><ci id="A1.SS4.p3.5.m5.2.2.2.2.1.7.cmml" xref="A1.SS4.p3.5.m5.2.2.2.2.1.7">𝑒</ci></apply></list></apply></apply></apply><apply id="A1.SS4.p3.5.m5.6.7.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3"><minus id="A1.SS4.p3.5.m5.6.7.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.1"></minus><apply id="A1.SS4.p3.5.m5.6.7.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2"><times id="A1.SS4.p3.5.m5.6.7.3.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.1"></times><apply id="A1.SS4.p3.5.m5.6.7.3.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2"><divide id="A1.SS4.p3.5.m5.6.7.3.2.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2"></divide><cn id="A1.SS4.p3.5.m5.6.7.3.2.2.2.cmml" type="integer" xref="A1.SS4.p3.5.m5.6.7.3.2.2.2">1</cn><apply id="A1.SS4.p3.5.m5.6.7.3.2.2.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.2.2.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3">subscript</csymbol><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.2">𝑁</ci><apply id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3"><times id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.1"></times><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.2">𝑢</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.3">𝑝</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.4.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.4">𝑑</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.5.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.5">𝑎</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.6.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.6">𝑡</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.7.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.2.3.3.7">𝑒</ci></apply></apply></apply><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3"><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.2.3.1.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1">superscript</csymbol><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1">subscript</csymbol><sum id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.2"></sum><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3"><eq id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.1"></eq><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.2">𝑗</ci><cn id="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.3.cmml" type="integer" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.2.3.3">1</cn></apply></apply><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3">subscript</csymbol><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.2">𝑁</ci><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3"><times id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.1"></times><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.2">𝑢</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.3">𝑝</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.4.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.4">𝑑</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.5.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.5">𝑎</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.6.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.6">𝑡</ci><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.7.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.1.3.3.7">𝑒</ci></apply></apply></apply><apply id="A1.SS4.p3.5.m5.6.7.3.2.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.2"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.2.3.2.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.2">subscript</csymbol><ci id="A1.SS4.p3.5.m5.6.7.3.2.3.2.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.2.3.2.2">𝑄</ci><list id="A1.SS4.p3.5.m5.4.4.2.3.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2"><ci id="A1.SS4.p3.5.m5.3.3.1.1.cmml" xref="A1.SS4.p3.5.m5.3.3.1.1">𝑗</ci><apply id="A1.SS4.p3.5.m5.4.4.2.2.1.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1"><times id="A1.SS4.p3.5.m5.4.4.2.2.1.1.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.1"></times><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.2.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.2">𝑢</ci><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.3.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.3">𝑝</ci><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.4.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.4">𝑑</ci><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.5.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.5">𝑎</ci><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.6.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.6">𝑡</ci><ci id="A1.SS4.p3.5.m5.4.4.2.2.1.7.cmml" xref="A1.SS4.p3.5.m5.4.4.2.2.1.7">𝑒</ci></apply></list></apply></apply></apply><apply id="A1.SS4.p3.5.m5.6.7.3.3.cmml" xref="A1.SS4.p3.5.m5.6.7.3.3"><csymbol cd="ambiguous" id="A1.SS4.p3.5.m5.6.7.3.3.1.cmml" xref="A1.SS4.p3.5.m5.6.7.3.3">subscript</csymbol><ci id="A1.SS4.p3.5.m5.6.7.3.3.2.cmml" xref="A1.SS4.p3.5.m5.6.7.3.3.2">𝑄</ci><list id="A1.SS4.p3.5.m5.6.6.2.3.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2"><ci id="A1.SS4.p3.5.m5.5.5.1.1.cmml" xref="A1.SS4.p3.5.m5.5.5.1.1">𝑖</ci><apply id="A1.SS4.p3.5.m5.6.6.2.2.1.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1"><times id="A1.SS4.p3.5.m5.6.6.2.2.1.1.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.1"></times><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.2.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.2">𝑢</ci><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.3.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.3">𝑝</ci><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.4.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.4">𝑑</ci><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.5.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.5">𝑎</ci><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.6.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.6">𝑡</ci><ci id="A1.SS4.p3.5.m5.6.6.2.2.1.7.cmml" xref="A1.SS4.p3.5.m5.6.6.2.2.1.7">𝑒</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.5.m5.6c">\partial\log P_{i,update}=\frac{1}{N_{update}}\sum_{j=1}^{N_{update}}Q_{j,%
update}-Q_{i,update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.5.m5.6d">∂ roman_log italic_P start_POSTSUBSCRIPT italic_i , italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_Q start_POSTSUBSCRIPT italic_j , italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT - italic_Q start_POSTSUBSCRIPT italic_i , italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS4.p4">
<p class="ltx_p" id="A1.SS4.p4.2">This formulation of the pairwise policy update has a few interesting properties. Gradients added to each log probability scale with <math alttext="P(1-P)|\Delta Q|" class="ltx_Math" display="inline" id="A1.SS4.p4.1.m1.2"><semantics id="A1.SS4.p4.1.m1.2a"><mrow id="A1.SS4.p4.1.m1.2.2" xref="A1.SS4.p4.1.m1.2.2.cmml"><mi id="A1.SS4.p4.1.m1.2.2.4" xref="A1.SS4.p4.1.m1.2.2.4.cmml">P</mi><mo id="A1.SS4.p4.1.m1.2.2.3" xref="A1.SS4.p4.1.m1.2.2.3.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS4.p4.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS4.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p4.1.m1.1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.cmml"><mn id="A1.SS4.p4.1.m1.1.1.1.1.1.2" xref="A1.SS4.p4.1.m1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.SS4.p4.1.m1.1.1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.SS4.p4.1.m1.1.1.1.1.1.3" xref="A1.SS4.p4.1.m1.1.1.1.1.1.3.cmml">P</mi></mrow><mo id="A1.SS4.p4.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS4.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS4.p4.1.m1.2.2.3a" xref="A1.SS4.p4.1.m1.2.2.3.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.2.2.2.1" xref="A1.SS4.p4.1.m1.2.2.2.2.cmml"><mo id="A1.SS4.p4.1.m1.2.2.2.1.2" stretchy="false" xref="A1.SS4.p4.1.m1.2.2.2.2.1.cmml">|</mo><mrow id="A1.SS4.p4.1.m1.2.2.2.1.1" xref="A1.SS4.p4.1.m1.2.2.2.1.1.cmml"><mi id="A1.SS4.p4.1.m1.2.2.2.1.1.2" mathvariant="normal" xref="A1.SS4.p4.1.m1.2.2.2.1.1.2.cmml">Δ</mi><mo id="A1.SS4.p4.1.m1.2.2.2.1.1.1" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml">⁢</mo><mi id="A1.SS4.p4.1.m1.2.2.2.1.1.3" xref="A1.SS4.p4.1.m1.2.2.2.1.1.3.cmml">Q</mi></mrow><mo id="A1.SS4.p4.1.m1.2.2.2.1.3" stretchy="false" xref="A1.SS4.p4.1.m1.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.1.m1.2b"><apply id="A1.SS4.p4.1.m1.2.2.cmml" xref="A1.SS4.p4.1.m1.2.2"><times id="A1.SS4.p4.1.m1.2.2.3.cmml" xref="A1.SS4.p4.1.m1.2.2.3"></times><ci id="A1.SS4.p4.1.m1.2.2.4.cmml" xref="A1.SS4.p4.1.m1.2.2.4">𝑃</ci><apply id="A1.SS4.p4.1.m1.1.1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1"><minus id="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1"></minus><cn id="A1.SS4.p4.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="A1.SS4.p4.1.m1.1.1.1.1.1.2">1</cn><ci id="A1.SS4.p4.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1.3">𝑃</ci></apply><apply id="A1.SS4.p4.1.m1.2.2.2.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1"><abs id="A1.SS4.p4.1.m1.2.2.2.2.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.2"></abs><apply id="A1.SS4.p4.1.m1.2.2.2.1.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1"><times id="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1"></times><ci id="A1.SS4.p4.1.m1.2.2.2.1.1.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.2">Δ</ci><ci id="A1.SS4.p4.1.m1.2.2.2.1.1.3.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.1.m1.2c">P(1-P)|\Delta Q|</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.1.m1.2d">italic_P ( 1 - italic_P ) | roman_Δ italic_Q |</annotation></semantics></math>, meaning both that updates are rare for saturated actions, and that the scale of these updates is proportional to the expected difference in reward for making such a policy update. Additionally, because this is a symmetric loss, two actions with stochastic <math alttext="Q_{update}" class="ltx_Math" display="inline" id="A1.SS4.p4.2.m2.1"><semantics id="A1.SS4.p4.2.m2.1a"><msub id="A1.SS4.p4.2.m2.1.1" xref="A1.SS4.p4.2.m2.1.1.cmml"><mi id="A1.SS4.p4.2.m2.1.1.2" xref="A1.SS4.p4.2.m2.1.1.2.cmml">Q</mi><mrow id="A1.SS4.p4.2.m2.1.1.3" xref="A1.SS4.p4.2.m2.1.1.3.cmml"><mi id="A1.SS4.p4.2.m2.1.1.3.2" xref="A1.SS4.p4.2.m2.1.1.3.2.cmml">u</mi><mo id="A1.SS4.p4.2.m2.1.1.3.1" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p4.2.m2.1.1.3.3" xref="A1.SS4.p4.2.m2.1.1.3.3.cmml">p</mi><mo id="A1.SS4.p4.2.m2.1.1.3.1a" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p4.2.m2.1.1.3.4" xref="A1.SS4.p4.2.m2.1.1.3.4.cmml">d</mi><mo id="A1.SS4.p4.2.m2.1.1.3.1b" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p4.2.m2.1.1.3.5" xref="A1.SS4.p4.2.m2.1.1.3.5.cmml">a</mi><mo id="A1.SS4.p4.2.m2.1.1.3.1c" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p4.2.m2.1.1.3.6" xref="A1.SS4.p4.2.m2.1.1.3.6.cmml">t</mi><mo id="A1.SS4.p4.2.m2.1.1.3.1d" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS4.p4.2.m2.1.1.3.7" xref="A1.SS4.p4.2.m2.1.1.3.7.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.2.m2.1b"><apply id="A1.SS4.p4.2.m2.1.1.cmml" xref="A1.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.1.cmml" xref="A1.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="A1.SS4.p4.2.m2.1.1.2.cmml" xref="A1.SS4.p4.2.m2.1.1.2">𝑄</ci><apply id="A1.SS4.p4.2.m2.1.1.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3"><times id="A1.SS4.p4.2.m2.1.1.3.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.1"></times><ci id="A1.SS4.p4.2.m2.1.1.3.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2">𝑢</ci><ci id="A1.SS4.p4.2.m2.1.1.3.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3">𝑝</ci><ci id="A1.SS4.p4.2.m2.1.1.3.4.cmml" xref="A1.SS4.p4.2.m2.1.1.3.4">𝑑</ci><ci id="A1.SS4.p4.2.m2.1.1.3.5.cmml" xref="A1.SS4.p4.2.m2.1.1.3.5">𝑎</ci><ci id="A1.SS4.p4.2.m2.1.1.3.6.cmml" xref="A1.SS4.p4.2.m2.1.1.3.6">𝑡</ci><ci id="A1.SS4.p4.2.m2.1.1.3.7.cmml" xref="A1.SS4.p4.2.m2.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.2.m2.1c">Q_{update}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e end_POSTSUBSCRIPT</annotation></semantics></math> values that have the same expectation will stay at exactly the same relative probability to one another. Since we expect the reward and value networks of a MuZero-style agent to be noisy (via optimization, not explicitly as in RainbowDQN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib27" title="">27</a>]</cite>), we find this property to be advantageous.</p>
</div>
<div class="ltx_para" id="A1.SS4.p5">
<p class="ltx_p" id="A1.SS4.p5.1">The downside to this update rule is that it gives probability mass to actions that already have probability mass, and thus does not do a great job on its own with the exploration/exploitation trade-off. We address this below.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Directly Controlling the Exploration/Exploitation Trade-Off via a Pairwise Policy Update</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">The exploration/exploitation trade-off is a classic concern with <span class="ltx_glossaryref" title="">RL</span> agents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib28" title="">28</a>]</cite>. Essentially, the agent does not begin its learning process understanding the world, and thus a certain amount of exploration is required. However, as the agent learns those world dynamics, it must shift to exploitation to achieve a high score. Often, in doing so, it reaches increasingly complex world states, which again necessitates some level of exploration until those new states are more fully learned. This teeter-totter is difficult to balance, with a number of successful approaches like Random Network Distillation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib29" title="">29</a>]</cite> and the more recent Generalized Data Distribution Iteration (GDI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib28" title="">28</a>]</cite> tackling this through novelty rewards and/or bandit optimization.</p>
</div>
<div class="ltx_para" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.5">Due to our pairwise policy update, we explored methods of handling this trade-off while also preventing excessive saturation of log probabilities. The final approach works as follows: <math alttext="N_{update,uniform}" class="ltx_Math" display="inline" id="A1.SS5.p2.1.m1.2"><semantics id="A1.SS5.p2.1.m1.2a"><msub id="A1.SS5.p2.1.m1.2.3" xref="A1.SS5.p2.1.m1.2.3.cmml"><mi id="A1.SS5.p2.1.m1.2.3.2" xref="A1.SS5.p2.1.m1.2.3.2.cmml">N</mi><mrow id="A1.SS5.p2.1.m1.2.2.2.2" xref="A1.SS5.p2.1.m1.2.2.2.3.cmml"><mrow id="A1.SS5.p2.1.m1.1.1.1.1.1" xref="A1.SS5.p2.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.2" xref="A1.SS5.p2.1.m1.1.1.1.1.1.2.cmml">u</mi><mo id="A1.SS5.p2.1.m1.1.1.1.1.1.1" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.3" xref="A1.SS5.p2.1.m1.1.1.1.1.1.3.cmml">p</mi><mo id="A1.SS5.p2.1.m1.1.1.1.1.1.1a" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.4" xref="A1.SS5.p2.1.m1.1.1.1.1.1.4.cmml">d</mi><mo id="A1.SS5.p2.1.m1.1.1.1.1.1.1b" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.5" xref="A1.SS5.p2.1.m1.1.1.1.1.1.5.cmml">a</mi><mo id="A1.SS5.p2.1.m1.1.1.1.1.1.1c" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.6" xref="A1.SS5.p2.1.m1.1.1.1.1.1.6.cmml">t</mi><mo id="A1.SS5.p2.1.m1.1.1.1.1.1.1d" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.1.1.1.1.1.7" xref="A1.SS5.p2.1.m1.1.1.1.1.1.7.cmml">e</mi></mrow><mo id="A1.SS5.p2.1.m1.2.2.2.2.3" xref="A1.SS5.p2.1.m1.2.2.2.3.cmml">,</mo><mrow id="A1.SS5.p2.1.m1.2.2.2.2.2" xref="A1.SS5.p2.1.m1.2.2.2.2.2.cmml"><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.2" xref="A1.SS5.p2.1.m1.2.2.2.2.2.2.cmml">u</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.3" xref="A1.SS5.p2.1.m1.2.2.2.2.2.3.cmml">n</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1a" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.4" xref="A1.SS5.p2.1.m1.2.2.2.2.2.4.cmml">i</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1b" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.5" xref="A1.SS5.p2.1.m1.2.2.2.2.2.5.cmml">f</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1c" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.6" xref="A1.SS5.p2.1.m1.2.2.2.2.2.6.cmml">o</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1d" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.7" xref="A1.SS5.p2.1.m1.2.2.2.2.2.7.cmml">r</mi><mo id="A1.SS5.p2.1.m1.2.2.2.2.2.1e" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.1.m1.2.2.2.2.2.8" xref="A1.SS5.p2.1.m1.2.2.2.2.2.8.cmml">m</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.1.m1.2b"><apply id="A1.SS5.p2.1.m1.2.3.cmml" xref="A1.SS5.p2.1.m1.2.3"><csymbol cd="ambiguous" id="A1.SS5.p2.1.m1.2.3.1.cmml" xref="A1.SS5.p2.1.m1.2.3">subscript</csymbol><ci id="A1.SS5.p2.1.m1.2.3.2.cmml" xref="A1.SS5.p2.1.m1.2.3.2">𝑁</ci><list id="A1.SS5.p2.1.m1.2.2.2.3.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2"><apply id="A1.SS5.p2.1.m1.1.1.1.1.1.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1"><times id="A1.SS5.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.1"></times><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.2">𝑢</ci><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.3">𝑝</ci><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.4.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.4">𝑑</ci><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.5.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.5">𝑎</ci><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.6.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.6">𝑡</ci><ci id="A1.SS5.p2.1.m1.1.1.1.1.1.7.cmml" xref="A1.SS5.p2.1.m1.1.1.1.1.1.7">𝑒</ci></apply><apply id="A1.SS5.p2.1.m1.2.2.2.2.2.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2"><times id="A1.SS5.p2.1.m1.2.2.2.2.2.1.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.1"></times><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.2">𝑢</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.3">𝑛</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.4.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.4">𝑖</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.5.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.5">𝑓</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.6.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.6">𝑜</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.7.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.7">𝑟</ci><ci id="A1.SS5.p2.1.m1.2.2.2.2.2.8.cmml" xref="A1.SS5.p2.1.m1.2.2.2.2.2.8">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.1.m1.2c">N_{update,uniform}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.1.m1.2d">italic_N start_POSTSUBSCRIPT italic_u italic_p italic_d italic_a italic_t italic_e , italic_u italic_n italic_i italic_f italic_o italic_r italic_m end_POSTSUBSCRIPT</annotation></semantics></math> actions are sampled uniformly at random from the entire action space, and corresponding <math alttext="\log P_{i,update,uniform}" class="ltx_Math" display="inline" id="A1.SS5.p2.2.m2.3"><semantics id="A1.SS5.p2.2.m2.3a"><mrow id="A1.SS5.p2.2.m2.3.4" xref="A1.SS5.p2.2.m2.3.4.cmml"><mi id="A1.SS5.p2.2.m2.3.4.1" xref="A1.SS5.p2.2.m2.3.4.1.cmml">log</mi><mo id="A1.SS5.p2.2.m2.3.4a" lspace="0.167em" xref="A1.SS5.p2.2.m2.3.4.cmml">⁡</mo><msub id="A1.SS5.p2.2.m2.3.4.2" xref="A1.SS5.p2.2.m2.3.4.2.cmml"><mi id="A1.SS5.p2.2.m2.3.4.2.2" xref="A1.SS5.p2.2.m2.3.4.2.2.cmml">P</mi><mrow id="A1.SS5.p2.2.m2.3.3.3.3" xref="A1.SS5.p2.2.m2.3.3.3.4.cmml"><mi id="A1.SS5.p2.2.m2.1.1.1.1" xref="A1.SS5.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.3" xref="A1.SS5.p2.2.m2.3.3.3.4.cmml">,</mo><mrow id="A1.SS5.p2.2.m2.2.2.2.2.1" xref="A1.SS5.p2.2.m2.2.2.2.2.1.cmml"><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.2" xref="A1.SS5.p2.2.m2.2.2.2.2.1.2.cmml">u</mi><mo id="A1.SS5.p2.2.m2.2.2.2.2.1.1" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.3" xref="A1.SS5.p2.2.m2.2.2.2.2.1.3.cmml">p</mi><mo id="A1.SS5.p2.2.m2.2.2.2.2.1.1a" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.4" xref="A1.SS5.p2.2.m2.2.2.2.2.1.4.cmml">d</mi><mo id="A1.SS5.p2.2.m2.2.2.2.2.1.1b" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.5" xref="A1.SS5.p2.2.m2.2.2.2.2.1.5.cmml">a</mi><mo id="A1.SS5.p2.2.m2.2.2.2.2.1.1c" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.6" xref="A1.SS5.p2.2.m2.2.2.2.2.1.6.cmml">t</mi><mo id="A1.SS5.p2.2.m2.2.2.2.2.1.1d" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.2.2.2.2.1.7" xref="A1.SS5.p2.2.m2.2.2.2.2.1.7.cmml">e</mi></mrow><mo id="A1.SS5.p2.2.m2.3.3.3.3.4" xref="A1.SS5.p2.2.m2.3.3.3.4.cmml">,</mo><mrow id="A1.SS5.p2.2.m2.3.3.3.3.2" xref="A1.SS5.p2.2.m2.3.3.3.3.2.cmml"><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.2" xref="A1.SS5.p2.2.m2.3.3.3.3.2.2.cmml">u</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.3" xref="A1.SS5.p2.2.m2.3.3.3.3.2.3.cmml">n</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1a" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.4" xref="A1.SS5.p2.2.m2.3.3.3.3.2.4.cmml">i</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1b" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.5" xref="A1.SS5.p2.2.m2.3.3.3.3.2.5.cmml">f</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1c" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.6" xref="A1.SS5.p2.2.m2.3.3.3.3.2.6.cmml">o</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1d" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.7" xref="A1.SS5.p2.2.m2.3.3.3.3.2.7.cmml">r</mi><mo id="A1.SS5.p2.2.m2.3.3.3.3.2.1e" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml">⁢</mo><mi id="A1.SS5.p2.2.m2.3.3.3.3.2.8" xref="A1.SS5.p2.2.m2.3.3.3.3.2.8.cmml">m</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.2.m2.3b"><apply id="A1.SS5.p2.2.m2.3.4.cmml" xref="A1.SS5.p2.2.m2.3.4"><log id="A1.SS5.p2.2.m2.3.4.1.cmml" xref="A1.SS5.p2.2.m2.3.4.1"></log><apply id="A1.SS5.p2.2.m2.3.4.2.cmml" xref="A1.SS5.p2.2.m2.3.4.2"><csymbol cd="ambiguous" id="A1.SS5.p2.2.m2.3.4.2.1.cmml" xref="A1.SS5.p2.2.m2.3.4.2">subscript</csymbol><ci id="A1.SS5.p2.2.m2.3.4.2.2.cmml" xref="A1.SS5.p2.2.m2.3.4.2.2">𝑃</ci><list id="A1.SS5.p2.2.m2.3.3.3.4.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3"><ci id="A1.SS5.p2.2.m2.1.1.1.1.cmml" xref="A1.SS5.p2.2.m2.1.1.1.1">𝑖</ci><apply id="A1.SS5.p2.2.m2.2.2.2.2.1.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1"><times id="A1.SS5.p2.2.m2.2.2.2.2.1.1.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.1"></times><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.2.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.2">𝑢</ci><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.3.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.3">𝑝</ci><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.4.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.4">𝑑</ci><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.5.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.5">𝑎</ci><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.6.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.6">𝑡</ci><ci id="A1.SS5.p2.2.m2.2.2.2.2.1.7.cmml" xref="A1.SS5.p2.2.m2.2.2.2.2.1.7">𝑒</ci></apply><apply id="A1.SS5.p2.2.m2.3.3.3.3.2.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2"><times id="A1.SS5.p2.2.m2.3.3.3.3.2.1.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.1"></times><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.2.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.2">𝑢</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.3.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.3">𝑛</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.4.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.4">𝑖</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.5.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.5">𝑓</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.6.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.6">𝑜</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.7.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.7">𝑟</ci><ci id="A1.SS5.p2.2.m2.3.3.3.3.2.8.cmml" xref="A1.SS5.p2.2.m2.3.3.3.3.2.8">𝑚</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.2.m2.3c">\log P_{i,update,uniform}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.2.m2.3d">roman_log italic_P start_POSTSUBSCRIPT italic_i , italic_u italic_p italic_d italic_a italic_t italic_e , italic_u italic_n italic_i italic_f italic_o italic_r italic_m end_POSTSUBSCRIPT</annotation></semantics></math> values are computed. Then, the probability mass is given from the policy samples to these uniform samples. Importantly, the magnitude of this transfer is controlled by an integrating controller such that the frequency of policy samples associated with a sampling probability that is less than that of a uniform sampling probability is equal to <math alttext="\rho_{target}=0.1" class="ltx_Math" display="inline" id="A1.SS5.p2.3.m3.1"><semantics id="A1.SS5.p2.3.m3.1a"><mrow id="A1.SS5.p2.3.m3.1.1" xref="A1.SS5.p2.3.m3.1.1.cmml"><msub id="A1.SS5.p2.3.m3.1.1.2" xref="A1.SS5.p2.3.m3.1.1.2.cmml"><mi id="A1.SS5.p2.3.m3.1.1.2.2" xref="A1.SS5.p2.3.m3.1.1.2.2.cmml">ρ</mi><mrow id="A1.SS5.p2.3.m3.1.1.2.3" xref="A1.SS5.p2.3.m3.1.1.2.3.cmml"><mi id="A1.SS5.p2.3.m3.1.1.2.3.2" xref="A1.SS5.p2.3.m3.1.1.2.3.2.cmml">t</mi><mo id="A1.SS5.p2.3.m3.1.1.2.3.1" xref="A1.SS5.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.3.m3.1.1.2.3.3" xref="A1.SS5.p2.3.m3.1.1.2.3.3.cmml">a</mi><mo id="A1.SS5.p2.3.m3.1.1.2.3.1a" xref="A1.SS5.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.3.m3.1.1.2.3.4" xref="A1.SS5.p2.3.m3.1.1.2.3.4.cmml">r</mi><mo id="A1.SS5.p2.3.m3.1.1.2.3.1b" xref="A1.SS5.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.3.m3.1.1.2.3.5" xref="A1.SS5.p2.3.m3.1.1.2.3.5.cmml">g</mi><mo id="A1.SS5.p2.3.m3.1.1.2.3.1c" xref="A1.SS5.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.3.m3.1.1.2.3.6" xref="A1.SS5.p2.3.m3.1.1.2.3.6.cmml">e</mi><mo id="A1.SS5.p2.3.m3.1.1.2.3.1d" xref="A1.SS5.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.3.m3.1.1.2.3.7" xref="A1.SS5.p2.3.m3.1.1.2.3.7.cmml">t</mi></mrow></msub><mo id="A1.SS5.p2.3.m3.1.1.1" xref="A1.SS5.p2.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS5.p2.3.m3.1.1.3" xref="A1.SS5.p2.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.3.m3.1b"><apply id="A1.SS5.p2.3.m3.1.1.cmml" xref="A1.SS5.p2.3.m3.1.1"><eq id="A1.SS5.p2.3.m3.1.1.1.cmml" xref="A1.SS5.p2.3.m3.1.1.1"></eq><apply id="A1.SS5.p2.3.m3.1.1.2.cmml" xref="A1.SS5.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS5.p2.3.m3.1.1.2.1.cmml" xref="A1.SS5.p2.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS5.p2.3.m3.1.1.2.2.cmml" xref="A1.SS5.p2.3.m3.1.1.2.2">𝜌</ci><apply id="A1.SS5.p2.3.m3.1.1.2.3.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3"><times id="A1.SS5.p2.3.m3.1.1.2.3.1.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.1"></times><ci id="A1.SS5.p2.3.m3.1.1.2.3.2.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.2">𝑡</ci><ci id="A1.SS5.p2.3.m3.1.1.2.3.3.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.3">𝑎</ci><ci id="A1.SS5.p2.3.m3.1.1.2.3.4.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.4">𝑟</ci><ci id="A1.SS5.p2.3.m3.1.1.2.3.5.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.5">𝑔</ci><ci id="A1.SS5.p2.3.m3.1.1.2.3.6.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.6">𝑒</ci><ci id="A1.SS5.p2.3.m3.1.1.2.3.7.cmml" xref="A1.SS5.p2.3.m3.1.1.2.3.7">𝑡</ci></apply></apply><cn id="A1.SS5.p2.3.m3.1.1.3.cmml" type="float" xref="A1.SS5.p2.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.3.m3.1c">\rho_{target}=0.1</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.3.m3.1d">italic_ρ start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT = 0.1</annotation></semantics></math>. For easily testing different <math alttext="\rho_{target}" class="ltx_Math" display="inline" id="A1.SS5.p2.4.m4.1"><semantics id="A1.SS5.p2.4.m4.1a"><msub id="A1.SS5.p2.4.m4.1.1" xref="A1.SS5.p2.4.m4.1.1.cmml"><mi id="A1.SS5.p2.4.m4.1.1.2" xref="A1.SS5.p2.4.m4.1.1.2.cmml">ρ</mi><mrow id="A1.SS5.p2.4.m4.1.1.3" xref="A1.SS5.p2.4.m4.1.1.3.cmml"><mi id="A1.SS5.p2.4.m4.1.1.3.2" xref="A1.SS5.p2.4.m4.1.1.3.2.cmml">t</mi><mo id="A1.SS5.p2.4.m4.1.1.3.1" xref="A1.SS5.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.4.m4.1.1.3.3" xref="A1.SS5.p2.4.m4.1.1.3.3.cmml">a</mi><mo id="A1.SS5.p2.4.m4.1.1.3.1a" xref="A1.SS5.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.4.m4.1.1.3.4" xref="A1.SS5.p2.4.m4.1.1.3.4.cmml">r</mi><mo id="A1.SS5.p2.4.m4.1.1.3.1b" xref="A1.SS5.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.4.m4.1.1.3.5" xref="A1.SS5.p2.4.m4.1.1.3.5.cmml">g</mi><mo id="A1.SS5.p2.4.m4.1.1.3.1c" xref="A1.SS5.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.4.m4.1.1.3.6" xref="A1.SS5.p2.4.m4.1.1.3.6.cmml">e</mi><mo id="A1.SS5.p2.4.m4.1.1.3.1d" xref="A1.SS5.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.4.m4.1.1.3.7" xref="A1.SS5.p2.4.m4.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.4.m4.1b"><apply id="A1.SS5.p2.4.m4.1.1.cmml" xref="A1.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS5.p2.4.m4.1.1.1.cmml" xref="A1.SS5.p2.4.m4.1.1">subscript</csymbol><ci id="A1.SS5.p2.4.m4.1.1.2.cmml" xref="A1.SS5.p2.4.m4.1.1.2">𝜌</ci><apply id="A1.SS5.p2.4.m4.1.1.3.cmml" xref="A1.SS5.p2.4.m4.1.1.3"><times id="A1.SS5.p2.4.m4.1.1.3.1.cmml" xref="A1.SS5.p2.4.m4.1.1.3.1"></times><ci id="A1.SS5.p2.4.m4.1.1.3.2.cmml" xref="A1.SS5.p2.4.m4.1.1.3.2">𝑡</ci><ci id="A1.SS5.p2.4.m4.1.1.3.3.cmml" xref="A1.SS5.p2.4.m4.1.1.3.3">𝑎</ci><ci id="A1.SS5.p2.4.m4.1.1.3.4.cmml" xref="A1.SS5.p2.4.m4.1.1.3.4">𝑟</ci><ci id="A1.SS5.p2.4.m4.1.1.3.5.cmml" xref="A1.SS5.p2.4.m4.1.1.3.5">𝑔</ci><ci id="A1.SS5.p2.4.m4.1.1.3.6.cmml" xref="A1.SS5.p2.4.m4.1.1.3.6">𝑒</ci><ci id="A1.SS5.p2.4.m4.1.1.3.7.cmml" xref="A1.SS5.p2.4.m4.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.4.m4.1c">\rho_{target}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.4.m4.1d">italic_ρ start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> values, we scale the speed of the integrator update by <math alttext="0.5/\rho_{target}" class="ltx_Math" display="inline" id="A1.SS5.p2.5.m5.1"><semantics id="A1.SS5.p2.5.m5.1a"><mrow id="A1.SS5.p2.5.m5.1.1" xref="A1.SS5.p2.5.m5.1.1.cmml"><mn id="A1.SS5.p2.5.m5.1.1.2" xref="A1.SS5.p2.5.m5.1.1.2.cmml">0.5</mn><mo id="A1.SS5.p2.5.m5.1.1.1" xref="A1.SS5.p2.5.m5.1.1.1.cmml">/</mo><msub id="A1.SS5.p2.5.m5.1.1.3" xref="A1.SS5.p2.5.m5.1.1.3.cmml"><mi id="A1.SS5.p2.5.m5.1.1.3.2" xref="A1.SS5.p2.5.m5.1.1.3.2.cmml">ρ</mi><mrow id="A1.SS5.p2.5.m5.1.1.3.3" xref="A1.SS5.p2.5.m5.1.1.3.3.cmml"><mi id="A1.SS5.p2.5.m5.1.1.3.3.2" xref="A1.SS5.p2.5.m5.1.1.3.3.2.cmml">t</mi><mo id="A1.SS5.p2.5.m5.1.1.3.3.1" xref="A1.SS5.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.5.m5.1.1.3.3.3" xref="A1.SS5.p2.5.m5.1.1.3.3.3.cmml">a</mi><mo id="A1.SS5.p2.5.m5.1.1.3.3.1a" xref="A1.SS5.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.5.m5.1.1.3.3.4" xref="A1.SS5.p2.5.m5.1.1.3.3.4.cmml">r</mi><mo id="A1.SS5.p2.5.m5.1.1.3.3.1b" xref="A1.SS5.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.5.m5.1.1.3.3.5" xref="A1.SS5.p2.5.m5.1.1.3.3.5.cmml">g</mi><mo id="A1.SS5.p2.5.m5.1.1.3.3.1c" xref="A1.SS5.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.5.m5.1.1.3.3.6" xref="A1.SS5.p2.5.m5.1.1.3.3.6.cmml">e</mi><mo id="A1.SS5.p2.5.m5.1.1.3.3.1d" xref="A1.SS5.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS5.p2.5.m5.1.1.3.3.7" xref="A1.SS5.p2.5.m5.1.1.3.3.7.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.5.m5.1b"><apply id="A1.SS5.p2.5.m5.1.1.cmml" xref="A1.SS5.p2.5.m5.1.1"><divide id="A1.SS5.p2.5.m5.1.1.1.cmml" xref="A1.SS5.p2.5.m5.1.1.1"></divide><cn id="A1.SS5.p2.5.m5.1.1.2.cmml" type="float" xref="A1.SS5.p2.5.m5.1.1.2">0.5</cn><apply id="A1.SS5.p2.5.m5.1.1.3.cmml" xref="A1.SS5.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p2.5.m5.1.1.3.1.cmml" xref="A1.SS5.p2.5.m5.1.1.3">subscript</csymbol><ci id="A1.SS5.p2.5.m5.1.1.3.2.cmml" xref="A1.SS5.p2.5.m5.1.1.3.2">𝜌</ci><apply id="A1.SS5.p2.5.m5.1.1.3.3.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3"><times id="A1.SS5.p2.5.m5.1.1.3.3.1.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.1"></times><ci id="A1.SS5.p2.5.m5.1.1.3.3.2.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.2">𝑡</ci><ci id="A1.SS5.p2.5.m5.1.1.3.3.3.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.3">𝑎</ci><ci id="A1.SS5.p2.5.m5.1.1.3.3.4.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.4">𝑟</ci><ci id="A1.SS5.p2.5.m5.1.1.3.3.5.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.5">𝑔</ci><ci id="A1.SS5.p2.5.m5.1.1.3.3.6.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.6">𝑒</ci><ci id="A1.SS5.p2.5.m5.1.1.3.3.7.cmml" xref="A1.SS5.p2.5.m5.1.1.3.3.7">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.5.m5.1c">0.5/\rho_{target}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.5.m5.1d">0.5 / italic_ρ start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS5.p3">
<p class="ltx_p" id="A1.SS5.p3.2">Intuitively, this pushes states with little difference in <math alttext="Q" class="ltx_Math" display="inline" id="A1.SS5.p3.1.m1.1"><semantics id="A1.SS5.p3.1.m1.1a"><mi id="A1.SS5.p3.1.m1.1.1" xref="A1.SS5.p3.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p3.1.m1.1b"><ci id="A1.SS5.p3.1.m1.1.1.cmml" xref="A1.SS5.p3.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p3.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p3.1.m1.1d">italic_Q</annotation></semantics></math> values between actions toward a uniform distribution, while allowing those states with significant <math alttext="Q" class="ltx_Math" display="inline" id="A1.SS5.p3.2.m2.1"><semantics id="A1.SS5.p3.2.m2.1a"><mi id="A1.SS5.p3.2.m2.1.1" xref="A1.SS5.p3.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p3.2.m2.1b"><ci id="A1.SS5.p3.2.m2.1.1.cmml" xref="A1.SS5.p3.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p3.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p3.2.m2.1d">italic_Q</annotation></semantics></math> value differences to saturate. We found that this setup is very flexible, with the same hyperparameters working well in multiple environments. While the exploration/exploitation trade-off would likely perform better by using additional techniques like GDI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib28" title="">28</a>]</cite>, we found its performance in isolation to be satisfactory for many use cases.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Particle Swarm Tree Search</h3>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1"><span class="ltx_glossaryref" title="">MCTS</span>, used by MuZero, works well but depends heavily on tracking visit counts. In complex action spaces, this presents issues, as noted in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS4" title="A.4 Complex Action Spaces via a Pairwise Policy Update ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.4</span></a>. Furthermore, <span class="ltx_glossaryref" title="">MCTS</span> is necessarily iterative in nature, and cannot benefit from the full parallelization offered by modern <span class="ltx_glossaryref" title="">graphics processing units (GPUs)</span>.</p>
</div>
<div class="ltx_para" id="A1.SS6.p2">
<p class="ltx_p" id="A1.SS6.p2.1">To work around this, we devised a novel approach inspired by particle filter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib30" title="">30</a>]</cite> and particle swarm optimization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib31" title="">31</a>]</cite> approaches.</p>
</div>
<div class="ltx_para" id="A1.SS6.p3">
<p class="ltx_p" id="A1.SS6.p3.2">To begin, <math alttext="N_{ps}" class="ltx_Math" display="inline" id="A1.SS6.p3.1.m1.1"><semantics id="A1.SS6.p3.1.m1.1a"><msub id="A1.SS6.p3.1.m1.1.1" xref="A1.SS6.p3.1.m1.1.1.cmml"><mi id="A1.SS6.p3.1.m1.1.1.2" xref="A1.SS6.p3.1.m1.1.1.2.cmml">N</mi><mrow id="A1.SS6.p3.1.m1.1.1.3" xref="A1.SS6.p3.1.m1.1.1.3.cmml"><mi id="A1.SS6.p3.1.m1.1.1.3.2" xref="A1.SS6.p3.1.m1.1.1.3.2.cmml">p</mi><mo id="A1.SS6.p3.1.m1.1.1.3.1" xref="A1.SS6.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p3.1.m1.1.1.3.3" xref="A1.SS6.p3.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.1.m1.1b"><apply id="A1.SS6.p3.1.m1.1.1.cmml" xref="A1.SS6.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p3.1.m1.1.1.1.cmml" xref="A1.SS6.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS6.p3.1.m1.1.1.2.cmml" xref="A1.SS6.p3.1.m1.1.1.2">𝑁</ci><apply id="A1.SS6.p3.1.m1.1.1.3.cmml" xref="A1.SS6.p3.1.m1.1.1.3"><times id="A1.SS6.p3.1.m1.1.1.3.1.cmml" xref="A1.SS6.p3.1.m1.1.1.3.1"></times><ci id="A1.SS6.p3.1.m1.1.1.3.2.cmml" xref="A1.SS6.p3.1.m1.1.1.3.2">𝑝</ci><ci id="A1.SS6.p3.1.m1.1.1.3.3.cmml" xref="A1.SS6.p3.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.1.m1.1c">N_{ps}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT</annotation></semantics></math> particles are sampled, with each particle following the agent’s learned policy. Each of these particles are simulated for <math alttext="T_{ps}" class="ltx_Math" display="inline" id="A1.SS6.p3.2.m2.1"><semantics id="A1.SS6.p3.2.m2.1a"><msub id="A1.SS6.p3.2.m2.1.1" xref="A1.SS6.p3.2.m2.1.1.cmml"><mi id="A1.SS6.p3.2.m2.1.1.2" xref="A1.SS6.p3.2.m2.1.1.2.cmml">T</mi><mrow id="A1.SS6.p3.2.m2.1.1.3" xref="A1.SS6.p3.2.m2.1.1.3.cmml"><mi id="A1.SS6.p3.2.m2.1.1.3.2" xref="A1.SS6.p3.2.m2.1.1.3.2.cmml">p</mi><mo id="A1.SS6.p3.2.m2.1.1.3.1" xref="A1.SS6.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p3.2.m2.1.1.3.3" xref="A1.SS6.p3.2.m2.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.2.m2.1b"><apply id="A1.SS6.p3.2.m2.1.1.cmml" xref="A1.SS6.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS6.p3.2.m2.1.1.1.cmml" xref="A1.SS6.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS6.p3.2.m2.1.1.2.cmml" xref="A1.SS6.p3.2.m2.1.1.2">𝑇</ci><apply id="A1.SS6.p3.2.m2.1.1.3.cmml" xref="A1.SS6.p3.2.m2.1.1.3"><times id="A1.SS6.p3.2.m2.1.1.3.1.cmml" xref="A1.SS6.p3.2.m2.1.1.3.1"></times><ci id="A1.SS6.p3.2.m2.1.1.3.2.cmml" xref="A1.SS6.p3.2.m2.1.1.3.2">𝑝</ci><ci id="A1.SS6.p3.2.m2.1.1.3.3.cmml" xref="A1.SS6.p3.2.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.2.m2.1c">T_{ps}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p3.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT</annotation></semantics></math> time steps, at each step again following the learned policy from the newly computed world state according to the dynamics function. Observed immediate rewards and future Q values are accumulated as in MuZero’s implementation of <span class="ltx_glossaryref" title="">MCTS</span>. This yields a set of particles which have both an action sequence and an expected Q value for following that action sequence from the current point in time.</p>
</div>
<div class="ltx_para" id="A1.SS6.p4">
<p class="ltx_p" id="A1.SS6.p4.5">Having collected <math alttext="N_{ps}" class="ltx_Math" display="inline" id="A1.SS6.p4.1.m1.1"><semantics id="A1.SS6.p4.1.m1.1a"><msub id="A1.SS6.p4.1.m1.1.1" xref="A1.SS6.p4.1.m1.1.1.cmml"><mi id="A1.SS6.p4.1.m1.1.1.2" xref="A1.SS6.p4.1.m1.1.1.2.cmml">N</mi><mrow id="A1.SS6.p4.1.m1.1.1.3" xref="A1.SS6.p4.1.m1.1.1.3.cmml"><mi id="A1.SS6.p4.1.m1.1.1.3.2" xref="A1.SS6.p4.1.m1.1.1.3.2.cmml">p</mi><mo id="A1.SS6.p4.1.m1.1.1.3.1" xref="A1.SS6.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.1.m1.1.1.3.3" xref="A1.SS6.p4.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.1.m1.1b"><apply id="A1.SS6.p4.1.m1.1.1.cmml" xref="A1.SS6.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p4.1.m1.1.1.1.cmml" xref="A1.SS6.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS6.p4.1.m1.1.1.2.cmml" xref="A1.SS6.p4.1.m1.1.1.2">𝑁</ci><apply id="A1.SS6.p4.1.m1.1.1.3.cmml" xref="A1.SS6.p4.1.m1.1.1.3"><times id="A1.SS6.p4.1.m1.1.1.3.1.cmml" xref="A1.SS6.p4.1.m1.1.1.3.1"></times><ci id="A1.SS6.p4.1.m1.1.1.3.2.cmml" xref="A1.SS6.p4.1.m1.1.1.3.2">𝑝</ci><ci id="A1.SS6.p4.1.m1.1.1.3.3.cmml" xref="A1.SS6.p4.1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.1.m1.1c">N_{ps}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT</annotation></semantics></math> particles, we have <math alttext="N_{ps}" class="ltx_Math" display="inline" id="A1.SS6.p4.2.m2.1"><semantics id="A1.SS6.p4.2.m2.1a"><msub id="A1.SS6.p4.2.m2.1.1" xref="A1.SS6.p4.2.m2.1.1.cmml"><mi id="A1.SS6.p4.2.m2.1.1.2" xref="A1.SS6.p4.2.m2.1.1.2.cmml">N</mi><mrow id="A1.SS6.p4.2.m2.1.1.3" xref="A1.SS6.p4.2.m2.1.1.3.cmml"><mi id="A1.SS6.p4.2.m2.1.1.3.2" xref="A1.SS6.p4.2.m2.1.1.3.2.cmml">p</mi><mo id="A1.SS6.p4.2.m2.1.1.3.1" xref="A1.SS6.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.2.m2.1.1.3.3" xref="A1.SS6.p4.2.m2.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.2.m2.1b"><apply id="A1.SS6.p4.2.m2.1.1.cmml" xref="A1.SS6.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS6.p4.2.m2.1.1.1.cmml" xref="A1.SS6.p4.2.m2.1.1">subscript</csymbol><ci id="A1.SS6.p4.2.m2.1.1.2.cmml" xref="A1.SS6.p4.2.m2.1.1.2">𝑁</ci><apply id="A1.SS6.p4.2.m2.1.1.3.cmml" xref="A1.SS6.p4.2.m2.1.1.3"><times id="A1.SS6.p4.2.m2.1.1.3.1.cmml" xref="A1.SS6.p4.2.m2.1.1.3.1"></times><ci id="A1.SS6.p4.2.m2.1.1.3.2.cmml" xref="A1.SS6.p4.2.m2.1.1.3.2">𝑝</ci><ci id="A1.SS6.p4.2.m2.1.1.3.3.cmml" xref="A1.SS6.p4.2.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.2.m2.1c">N_{ps}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT</annotation></semantics></math> potential action trajectories and Q values. Like the original <span class="ltx_glossaryref" title="">MCTS</span> implementation, we need a means of determining an action distribution that combines both the estimated Q value and the likelihood of each action into an upper confidence bound. Unfortunately, in a similar issue to that mentioned in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS4" title="A.4 Complex Action Spaces via a Pairwise Policy Update ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.4</span></a>, we do not have access to the frequencies of combined samples. That is, while we can use the log probabilities of each action sample, those samples will also come from that same distribution, meaning that direct use of the probability information has a sort of doubling effect. Instead, we can use a simple trick: if we add uniform noise, scaled by <math alttext="c_{1}(\max_{ps}{Q}-\min_{ps}{Q})" class="ltx_Math" display="inline" id="A1.SS6.p4.3.m3.1"><semantics id="A1.SS6.p4.3.m3.1a"><mrow id="A1.SS6.p4.3.m3.1.1" xref="A1.SS6.p4.3.m3.1.1.cmml"><msub id="A1.SS6.p4.3.m3.1.1.3" xref="A1.SS6.p4.3.m3.1.1.3.cmml"><mi id="A1.SS6.p4.3.m3.1.1.3.2" xref="A1.SS6.p4.3.m3.1.1.3.2.cmml">c</mi><mn id="A1.SS6.p4.3.m3.1.1.3.3" xref="A1.SS6.p4.3.m3.1.1.3.3.cmml">1</mn></msub><mo id="A1.SS6.p4.3.m3.1.1.2" xref="A1.SS6.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.p4.3.m3.1.1.1.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.cmml"><mo id="A1.SS6.p4.3.m3.1.1.1.1.2" stretchy="false" xref="A1.SS6.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.p4.3.m3.1.1.1.1.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.cmml"><mrow id="A1.SS6.p4.3.m3.1.1.1.1.1.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.cmml"><msub id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.cmml"><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.2.cmml">max</mi><mrow id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.cmml"><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.2.cmml">p</mi><mo id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.3" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS6.p4.3.m3.1.1.1.1.1.2a" lspace="0.167em" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.cmml">⁡</mo><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.2.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.2.cmml">Q</mi></mrow><mo id="A1.SS6.p4.3.m3.1.1.1.1.1.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.SS6.p4.3.m3.1.1.1.1.1.3" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.cmml"><msub id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.cmml"><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.2.cmml">min</mi><mrow id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.cmml"><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.2.cmml">p</mi><mo id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.1" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.3" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS6.p4.3.m3.1.1.1.1.1.3a" lspace="0.167em" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="A1.SS6.p4.3.m3.1.1.1.1.1.3.2" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.2.cmml">Q</mi></mrow></mrow><mo id="A1.SS6.p4.3.m3.1.1.1.1.3" stretchy="false" xref="A1.SS6.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.3.m3.1b"><apply id="A1.SS6.p4.3.m3.1.1.cmml" xref="A1.SS6.p4.3.m3.1.1"><times id="A1.SS6.p4.3.m3.1.1.2.cmml" xref="A1.SS6.p4.3.m3.1.1.2"></times><apply id="A1.SS6.p4.3.m3.1.1.3.cmml" xref="A1.SS6.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.p4.3.m3.1.1.3.1.cmml" xref="A1.SS6.p4.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS6.p4.3.m3.1.1.3.2.cmml" xref="A1.SS6.p4.3.m3.1.1.3.2">𝑐</ci><cn id="A1.SS6.p4.3.m3.1.1.3.3.cmml" type="integer" xref="A1.SS6.p4.3.m3.1.1.3.3">1</cn></apply><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1"><minus id="A1.SS6.p4.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.1"></minus><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2"><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1">subscript</csymbol><max id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.2"></max><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3"><times id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.1"></times><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.2">𝑝</ci><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.3.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.1.3.3">𝑠</ci></apply></apply><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.2.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.2.2">𝑄</ci></apply><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3"><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1">subscript</csymbol><min id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.2"></min><apply id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3"><times id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.1.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.1"></times><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.2">𝑝</ci><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.3.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.1.3.3">𝑠</ci></apply></apply><ci id="A1.SS6.p4.3.m3.1.1.1.1.1.3.2.cmml" xref="A1.SS6.p4.3.m3.1.1.1.1.1.3.2">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.3.m3.1c">c_{1}(\max_{ps}{Q}-\min_{ps}{Q})</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.3.m3.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( roman_max start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT italic_Q - roman_min start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT italic_Q )</annotation></semantics></math> over all particles, to each particle’s estimated Q value, and then take the top <math alttext="\hat{N}_{ps}&lt;&lt;N_{ps}" class="ltx_Math" display="inline" id="A1.SS6.p4.4.m4.1"><semantics id="A1.SS6.p4.4.m4.1a"><mrow id="A1.SS6.p4.4.m4.1.1" xref="A1.SS6.p4.4.m4.1.1.cmml"><msub id="A1.SS6.p4.4.m4.1.1.2" xref="A1.SS6.p4.4.m4.1.1.2.cmml"><mover accent="true" id="A1.SS6.p4.4.m4.1.1.2.2" xref="A1.SS6.p4.4.m4.1.1.2.2.cmml"><mi id="A1.SS6.p4.4.m4.1.1.2.2.2" xref="A1.SS6.p4.4.m4.1.1.2.2.2.cmml">N</mi><mo id="A1.SS6.p4.4.m4.1.1.2.2.1" xref="A1.SS6.p4.4.m4.1.1.2.2.1.cmml">^</mo></mover><mrow id="A1.SS6.p4.4.m4.1.1.2.3" xref="A1.SS6.p4.4.m4.1.1.2.3.cmml"><mi id="A1.SS6.p4.4.m4.1.1.2.3.2" xref="A1.SS6.p4.4.m4.1.1.2.3.2.cmml">p</mi><mo id="A1.SS6.p4.4.m4.1.1.2.3.1" xref="A1.SS6.p4.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.4.m4.1.1.2.3.3" xref="A1.SS6.p4.4.m4.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS6.p4.4.m4.1.1.1" xref="A1.SS6.p4.4.m4.1.1.1.cmml">&lt;&lt;</mo><msub id="A1.SS6.p4.4.m4.1.1.3" xref="A1.SS6.p4.4.m4.1.1.3.cmml"><mi id="A1.SS6.p4.4.m4.1.1.3.2" xref="A1.SS6.p4.4.m4.1.1.3.2.cmml">N</mi><mrow id="A1.SS6.p4.4.m4.1.1.3.3" xref="A1.SS6.p4.4.m4.1.1.3.3.cmml"><mi id="A1.SS6.p4.4.m4.1.1.3.3.2" xref="A1.SS6.p4.4.m4.1.1.3.3.2.cmml">p</mi><mo id="A1.SS6.p4.4.m4.1.1.3.3.1" xref="A1.SS6.p4.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS6.p4.4.m4.1.1.3.3.3" xref="A1.SS6.p4.4.m4.1.1.3.3.3.cmml">s</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.4.m4.1b"><apply id="A1.SS6.p4.4.m4.1.1.cmml" xref="A1.SS6.p4.4.m4.1.1"><csymbol cd="latexml" id="A1.SS6.p4.4.m4.1.1.1.cmml" xref="A1.SS6.p4.4.m4.1.1.1">much-less-than</csymbol><apply id="A1.SS6.p4.4.m4.1.1.2.cmml" xref="A1.SS6.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p4.4.m4.1.1.2.1.cmml" xref="A1.SS6.p4.4.m4.1.1.2">subscript</csymbol><apply id="A1.SS6.p4.4.m4.1.1.2.2.cmml" xref="A1.SS6.p4.4.m4.1.1.2.2"><ci id="A1.SS6.p4.4.m4.1.1.2.2.1.cmml" xref="A1.SS6.p4.4.m4.1.1.2.2.1">^</ci><ci id="A1.SS6.p4.4.m4.1.1.2.2.2.cmml" xref="A1.SS6.p4.4.m4.1.1.2.2.2">𝑁</ci></apply><apply id="A1.SS6.p4.4.m4.1.1.2.3.cmml" xref="A1.SS6.p4.4.m4.1.1.2.3"><times id="A1.SS6.p4.4.m4.1.1.2.3.1.cmml" xref="A1.SS6.p4.4.m4.1.1.2.3.1"></times><ci id="A1.SS6.p4.4.m4.1.1.2.3.2.cmml" xref="A1.SS6.p4.4.m4.1.1.2.3.2">𝑝</ci><ci id="A1.SS6.p4.4.m4.1.1.2.3.3.cmml" xref="A1.SS6.p4.4.m4.1.1.2.3.3">𝑠</ci></apply></apply><apply id="A1.SS6.p4.4.m4.1.1.3.cmml" xref="A1.SS6.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.p4.4.m4.1.1.3.1.cmml" xref="A1.SS6.p4.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS6.p4.4.m4.1.1.3.2.cmml" xref="A1.SS6.p4.4.m4.1.1.3.2">𝑁</ci><apply id="A1.SS6.p4.4.m4.1.1.3.3.cmml" xref="A1.SS6.p4.4.m4.1.1.3.3"><times id="A1.SS6.p4.4.m4.1.1.3.3.1.cmml" xref="A1.SS6.p4.4.m4.1.1.3.3.1"></times><ci id="A1.SS6.p4.4.m4.1.1.3.3.2.cmml" xref="A1.SS6.p4.4.m4.1.1.3.3.2">𝑝</ci><ci id="A1.SS6.p4.4.m4.1.1.3.3.3.cmml" xref="A1.SS6.p4.4.m4.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.4.m4.1c">\hat{N}_{ps}&lt;&lt;N_{ps}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.4.m4.1d">over^ start_ARG italic_N end_ARG start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT &lt; &lt; italic_N start_POSTSUBSCRIPT italic_p italic_s end_POSTSUBSCRIPT</annotation></semantics></math> of particles sorted by the modified Q values, then we have a distribution captured from the confidence bound. Here, <math alttext="c_{1}=0.2" class="ltx_Math" display="inline" id="A1.SS6.p4.5.m5.1"><semantics id="A1.SS6.p4.5.m5.1a"><mrow id="A1.SS6.p4.5.m5.1.1" xref="A1.SS6.p4.5.m5.1.1.cmml"><msub id="A1.SS6.p4.5.m5.1.1.2" xref="A1.SS6.p4.5.m5.1.1.2.cmml"><mi id="A1.SS6.p4.5.m5.1.1.2.2" xref="A1.SS6.p4.5.m5.1.1.2.2.cmml">c</mi><mn id="A1.SS6.p4.5.m5.1.1.2.3" xref="A1.SS6.p4.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS6.p4.5.m5.1.1.1" xref="A1.SS6.p4.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS6.p4.5.m5.1.1.3" xref="A1.SS6.p4.5.m5.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.5.m5.1b"><apply id="A1.SS6.p4.5.m5.1.1.cmml" xref="A1.SS6.p4.5.m5.1.1"><eq id="A1.SS6.p4.5.m5.1.1.1.cmml" xref="A1.SS6.p4.5.m5.1.1.1"></eq><apply id="A1.SS6.p4.5.m5.1.1.2.cmml" xref="A1.SS6.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p4.5.m5.1.1.2.1.cmml" xref="A1.SS6.p4.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS6.p4.5.m5.1.1.2.2.cmml" xref="A1.SS6.p4.5.m5.1.1.2.2">𝑐</ci><cn id="A1.SS6.p4.5.m5.1.1.2.3.cmml" type="integer" xref="A1.SS6.p4.5.m5.1.1.2.3">1</cn></apply><cn id="A1.SS6.p4.5.m5.1.1.3.cmml" type="float" xref="A1.SS6.p4.5.m5.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.5.m5.1c">c_{1}=0.2</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.5.m5.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.2</annotation></semantics></math> is a constant determining the size of this effect. By adding uniform random noise, action samples with a larger sample probability are also more likely to receive a larger random sample. Thus, the probability of each sample is implicitly rolled into the newly sampled distribution, creating an altered action distribution in the same style as the <span class="ltx_glossaryref" title="">MCTS</span> approach.</p>
</div>
<div class="ltx_para" id="A1.SS6.p5">
<p class="ltx_p" id="A1.SS6.p5.1">This approach is certainly faster than <span class="ltx_glossaryref" title="">MCTS</span> (with a speedup factor of approximately <math alttext="10" class="ltx_Math" display="inline" id="A1.SS6.p5.1.m1.1"><semantics id="A1.SS6.p5.1.m1.1a"><mn id="A1.SS6.p5.1.m1.1.1" xref="A1.SS6.p5.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.SS6.p5.1.m1.1b"><cn id="A1.SS6.p5.1.m1.1.1.cmml" type="integer" xref="A1.SS6.p5.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p5.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p5.1.m1.1d">10</annotation></semantics></math>), and in our limited trials, equally effective.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Modified MuZero Value Representation</h3>
<div class="ltx_para" id="A1.SS7.p1">
<p class="ltx_p" id="A1.SS7.p1.1">Our final modification to the MuZero family of <span class="ltx_glossaryref" title="">RL</span> agents is to always have the Q network’s result <span class="ltx_text ltx_font_italic" id="A1.SS7.p1.1.1">include</span> the reward network’s result for a single dynamics step. While our interpretation of MuZero is that it always has the Q network predict future rewards <span class="ltx_text ltx_font_italic" id="A1.SS7.p1.1.2">after</span> the dynamics step, we found this much more difficult to train. The most likely explanation for this is that the dynamics function begins as nonsense, and when learning the initial <span class="ltx_glossaryref" title="">WM</span>, it is easiest to learn a Q function that does not fully rely on an accurate dynamics model.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additions to Adversarial Explanations</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">As mentioned in the main text, several changes to <span class="ltx_glossaryref" title="">AE</span> were required to achieve satisfactory performance with <span class="ltx_glossaryref" title="">RL</span>. These are described below.</p>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Gradient Scale Correction</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">Gradient scale correction required two considerations: first, the massive difference in scale for outputs associated with rewards and action probabilities, and second, considerations for the magnitude of the second derivative required for <span class="ltx_glossaryref" title="">AE</span> conditioning.</p>
</div>
<div class="ltx_para" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">To handle the difference in output scales, we note that the input to any layer (including the final layer) has roughly standard normal statistics, as a result of the LayerNorms in the network. For large magnitude outputs, such as reward, this means that the final layer’s weights are rather large. However, as mentioned earlier, this means that any gradients propagated backwards from this final layer would also be magnified, conflating the importance of different factors within the network. To fix this, we divide the gradient propagated backward from these final output layers by the expected standard deviation from the layer’s weight matrix (the square root of the sum of squares). This expected standard deviation can be grouped over multiple output channels where they contribute to outputs in the same dimension; for example, with the <span class="ltx_glossaryref" title="">GMMs</span>, the means, standard deviations, and weights constitute three dimensions which are spread over a greater number of parameters.</p>
</div>
<div class="ltx_para" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.9">To handle the introduction of second derivatives into the loss function, it was crucial that this quantity be well-balanced amongst the different magnitudes of output from, e.g., the policy, Q, and reward networks from the MuZero agent. We found that anywhere a gradient was scaled within the network (e.g., during the dynamics update for MuZero or in the aforementioned output gradient scale correction), it was best to apply that gradient scaling only through a detached version of the original gradient. That is, for a gradient <math alttext="g" class="ltx_Math" display="inline" id="A2.SS1.p3.1.m1.1"><semantics id="A2.SS1.p3.1.m1.1a"><mi id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><ci id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.1.m1.1d">italic_g</annotation></semantics></math>, desired scale <math alttext="s" class="ltx_Math" display="inline" id="A2.SS1.p3.2.m2.1"><semantics id="A2.SS1.p3.2.m2.1a"><mi id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><ci id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.2.m2.1d">italic_s</annotation></semantics></math>, and assuming <math alttext="d(g)" class="ltx_Math" display="inline" id="A2.SS1.p3.3.m3.1"><semantics id="A2.SS1.p3.3.m3.1a"><mrow id="A2.SS1.p3.3.m3.1.2" xref="A2.SS1.p3.3.m3.1.2.cmml"><mi id="A2.SS1.p3.3.m3.1.2.2" xref="A2.SS1.p3.3.m3.1.2.2.cmml">d</mi><mo id="A2.SS1.p3.3.m3.1.2.1" xref="A2.SS1.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p3.3.m3.1.2.3.2" xref="A2.SS1.p3.3.m3.1.2.cmml"><mo id="A2.SS1.p3.3.m3.1.2.3.2.1" stretchy="false" xref="A2.SS1.p3.3.m3.1.2.cmml">(</mo><mi id="A2.SS1.p3.3.m3.1.1" xref="A2.SS1.p3.3.m3.1.1.cmml">g</mi><mo id="A2.SS1.p3.3.m3.1.2.3.2.2" stretchy="false" xref="A2.SS1.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.3.m3.1b"><apply id="A2.SS1.p3.3.m3.1.2.cmml" xref="A2.SS1.p3.3.m3.1.2"><times id="A2.SS1.p3.3.m3.1.2.1.cmml" xref="A2.SS1.p3.3.m3.1.2.1"></times><ci id="A2.SS1.p3.3.m3.1.2.2.cmml" xref="A2.SS1.p3.3.m3.1.2.2">𝑑</ci><ci id="A2.SS1.p3.3.m3.1.1.cmml" xref="A2.SS1.p3.3.m3.1.1">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.3.m3.1c">d(g)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.3.m3.1d">italic_d ( italic_g )</annotation></semantics></math> means a detached version of the gradient <math alttext="g" class="ltx_Math" display="inline" id="A2.SS1.p3.4.m4.1"><semantics id="A2.SS1.p3.4.m4.1a"><mi id="A2.SS1.p3.4.m4.1.1" xref="A2.SS1.p3.4.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.4.m4.1b"><ci id="A2.SS1.p3.4.m4.1.1.cmml" xref="A2.SS1.p3.4.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.4.m4.1c">g</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.4.m4.1d">italic_g</annotation></semantics></math>, we substituted the gradient <math alttext="\hat{g}=g+d(g)*(s-1)" class="ltx_Math" display="inline" id="A2.SS1.p3.5.m5.2"><semantics id="A2.SS1.p3.5.m5.2a"><mrow id="A2.SS1.p3.5.m5.2.2" xref="A2.SS1.p3.5.m5.2.2.cmml"><mover accent="true" id="A2.SS1.p3.5.m5.2.2.3" xref="A2.SS1.p3.5.m5.2.2.3.cmml"><mi id="A2.SS1.p3.5.m5.2.2.3.2" xref="A2.SS1.p3.5.m5.2.2.3.2.cmml">g</mi><mo id="A2.SS1.p3.5.m5.2.2.3.1" xref="A2.SS1.p3.5.m5.2.2.3.1.cmml">^</mo></mover><mo id="A2.SS1.p3.5.m5.2.2.2" xref="A2.SS1.p3.5.m5.2.2.2.cmml">=</mo><mrow id="A2.SS1.p3.5.m5.2.2.1" xref="A2.SS1.p3.5.m5.2.2.1.cmml"><mi id="A2.SS1.p3.5.m5.2.2.1.3" xref="A2.SS1.p3.5.m5.2.2.1.3.cmml">g</mi><mo id="A2.SS1.p3.5.m5.2.2.1.2" xref="A2.SS1.p3.5.m5.2.2.1.2.cmml">+</mo><mrow id="A2.SS1.p3.5.m5.2.2.1.1" xref="A2.SS1.p3.5.m5.2.2.1.1.cmml"><mrow id="A2.SS1.p3.5.m5.2.2.1.1.3" xref="A2.SS1.p3.5.m5.2.2.1.1.3.cmml"><mi id="A2.SS1.p3.5.m5.2.2.1.1.3.2" xref="A2.SS1.p3.5.m5.2.2.1.1.3.2.cmml">d</mi><mo id="A2.SS1.p3.5.m5.2.2.1.1.3.1" xref="A2.SS1.p3.5.m5.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.SS1.p3.5.m5.2.2.1.1.3.3.2" xref="A2.SS1.p3.5.m5.2.2.1.1.3.cmml"><mo id="A2.SS1.p3.5.m5.2.2.1.1.3.3.2.1" stretchy="false" xref="A2.SS1.p3.5.m5.2.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p3.5.m5.1.1" xref="A2.SS1.p3.5.m5.1.1.cmml">g</mi><mo id="A2.SS1.p3.5.m5.2.2.1.1.3.3.2.2" rspace="0.055em" stretchy="false" xref="A2.SS1.p3.5.m5.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="A2.SS1.p3.5.m5.2.2.1.1.2" rspace="0.222em" xref="A2.SS1.p3.5.m5.2.2.1.1.2.cmml">∗</mo><mrow id="A2.SS1.p3.5.m5.2.2.1.1.1.1" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.cmml"><mo id="A2.SS1.p3.5.m5.2.2.1.1.1.1.2" stretchy="false" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.cmml"><mi id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.2" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.2.cmml">s</mi><mo id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.1" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.3" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="A2.SS1.p3.5.m5.2.2.1.1.1.1.3" stretchy="false" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.5.m5.2b"><apply id="A2.SS1.p3.5.m5.2.2.cmml" xref="A2.SS1.p3.5.m5.2.2"><eq id="A2.SS1.p3.5.m5.2.2.2.cmml" xref="A2.SS1.p3.5.m5.2.2.2"></eq><apply id="A2.SS1.p3.5.m5.2.2.3.cmml" xref="A2.SS1.p3.5.m5.2.2.3"><ci id="A2.SS1.p3.5.m5.2.2.3.1.cmml" xref="A2.SS1.p3.5.m5.2.2.3.1">^</ci><ci id="A2.SS1.p3.5.m5.2.2.3.2.cmml" xref="A2.SS1.p3.5.m5.2.2.3.2">𝑔</ci></apply><apply id="A2.SS1.p3.5.m5.2.2.1.cmml" xref="A2.SS1.p3.5.m5.2.2.1"><plus id="A2.SS1.p3.5.m5.2.2.1.2.cmml" xref="A2.SS1.p3.5.m5.2.2.1.2"></plus><ci id="A2.SS1.p3.5.m5.2.2.1.3.cmml" xref="A2.SS1.p3.5.m5.2.2.1.3">𝑔</ci><apply id="A2.SS1.p3.5.m5.2.2.1.1.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1"><times id="A2.SS1.p3.5.m5.2.2.1.1.2.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.2"></times><apply id="A2.SS1.p3.5.m5.2.2.1.1.3.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.3"><times id="A2.SS1.p3.5.m5.2.2.1.1.3.1.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.3.1"></times><ci id="A2.SS1.p3.5.m5.2.2.1.1.3.2.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.3.2">𝑑</ci><ci id="A2.SS1.p3.5.m5.1.1.cmml" xref="A2.SS1.p3.5.m5.1.1">𝑔</ci></apply><apply id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1"><minus id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.1.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.1"></minus><ci id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.2.cmml" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.2">𝑠</ci><cn id="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.3.cmml" type="integer" xref="A2.SS1.p3.5.m5.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.5.m5.2c">\hat{g}=g+d(g)*(s-1)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.5.m5.2d">over^ start_ARG italic_g end_ARG = italic_g + italic_d ( italic_g ) ∗ ( italic_s - 1 )</annotation></semantics></math>. This detachment, coupled with pre-gradient scaling of the parameter by <math alttext="1/s" class="ltx_Math" display="inline" id="A2.SS1.p3.6.m6.1"><semantics id="A2.SS1.p3.6.m6.1a"><mrow id="A2.SS1.p3.6.m6.1.1" xref="A2.SS1.p3.6.m6.1.1.cmml"><mn id="A2.SS1.p3.6.m6.1.1.2" xref="A2.SS1.p3.6.m6.1.1.2.cmml">1</mn><mo id="A2.SS1.p3.6.m6.1.1.1" xref="A2.SS1.p3.6.m6.1.1.1.cmml">/</mo><mi id="A2.SS1.p3.6.m6.1.1.3" xref="A2.SS1.p3.6.m6.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.6.m6.1b"><apply id="A2.SS1.p3.6.m6.1.1.cmml" xref="A2.SS1.p3.6.m6.1.1"><divide id="A2.SS1.p3.6.m6.1.1.1.cmml" xref="A2.SS1.p3.6.m6.1.1.1"></divide><cn id="A2.SS1.p3.6.m6.1.1.2.cmml" type="integer" xref="A2.SS1.p3.6.m6.1.1.2">1</cn><ci id="A2.SS1.p3.6.m6.1.1.3.cmml" xref="A2.SS1.p3.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.6.m6.1c">1/s</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.6.m6.1d">1 / italic_s</annotation></semantics></math> before the gradient operation and <math alttext="s" class="ltx_Math" display="inline" id="A2.SS1.p3.7.m7.1"><semantics id="A2.SS1.p3.7.m7.1a"><mi id="A2.SS1.p3.7.m7.1.1" xref="A2.SS1.p3.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.7.m7.1b"><ci id="A2.SS1.p3.7.m7.1.1.cmml" xref="A2.SS1.p3.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.7.m7.1c">s</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.7.m7.1d">italic_s</annotation></semantics></math> before adding it to the final loss function, was able to balance all of the magnitudes involved. By balance, we mean that the magnitude of the second gradient’s effect gets scaled the same as the first gradient’s effect as it passes through these different scalars and multiples. For example, as MuZero scales each dynamics update’s gradients by <math alttext="0.5" class="ltx_Math" display="inline" id="A2.SS1.p3.8.m8.1"><semantics id="A2.SS1.p3.8.m8.1a"><mn id="A2.SS1.p3.8.m8.1.1" xref="A2.SS1.p3.8.m8.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.8.m8.1b"><cn id="A2.SS1.p3.8.m8.1.1.cmml" type="float" xref="A2.SS1.p3.8.m8.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.8.m8.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.8.m8.1d">0.5</annotation></semantics></math>, all output values (before the gradient for <span class="ltx_glossaryref" title="">AE</span> conditioning) were scaled by <math alttext="2^{\tau}" class="ltx_Math" display="inline" id="A2.SS1.p3.9.m9.1"><semantics id="A2.SS1.p3.9.m9.1a"><msup id="A2.SS1.p3.9.m9.1.1" xref="A2.SS1.p3.9.m9.1.1.cmml"><mn id="A2.SS1.p3.9.m9.1.1.2" xref="A2.SS1.p3.9.m9.1.1.2.cmml">2</mn><mi id="A2.SS1.p3.9.m9.1.1.3" xref="A2.SS1.p3.9.m9.1.1.3.cmml">τ</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.9.m9.1b"><apply id="A2.SS1.p3.9.m9.1.1.cmml" xref="A2.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="A2.SS1.p3.9.m9.1.1.1.cmml" xref="A2.SS1.p3.9.m9.1.1">superscript</csymbol><cn id="A2.SS1.p3.9.m9.1.1.2.cmml" type="integer" xref="A2.SS1.p3.9.m9.1.1.2">2</cn><ci id="A2.SS1.p3.9.m9.1.1.3.cmml" xref="A2.SS1.p3.9.m9.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.9.m9.1c">2^{\tau}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.9.m9.1d">2 start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>, and after the gradient loss was computed, this factor was divided out again.</p>
</div>
<div class="ltx_para" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">An additional correction was needed for the policy update, as the policy loss scales down as the action distribution becomes saturated. To account for this, the scale on smoothing for policy parameters was scaled by <math alttext="0.25\rho_{target}" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><mrow id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mn id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml">0.25</mn><mo id="A2.SS1.p4.1.m1.1.1.1" xref="A2.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><msub id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml"><mi id="A2.SS1.p4.1.m1.1.1.3.2" xref="A2.SS1.p4.1.m1.1.1.3.2.cmml">ρ</mi><mrow id="A2.SS1.p4.1.m1.1.1.3.3" xref="A2.SS1.p4.1.m1.1.1.3.3.cmml"><mi id="A2.SS1.p4.1.m1.1.1.3.3.2" xref="A2.SS1.p4.1.m1.1.1.3.3.2.cmml">t</mi><mo id="A2.SS1.p4.1.m1.1.1.3.3.1" xref="A2.SS1.p4.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p4.1.m1.1.1.3.3.3" xref="A2.SS1.p4.1.m1.1.1.3.3.3.cmml">a</mi><mo id="A2.SS1.p4.1.m1.1.1.3.3.1a" xref="A2.SS1.p4.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p4.1.m1.1.1.3.3.4" xref="A2.SS1.p4.1.m1.1.1.3.3.4.cmml">r</mi><mo id="A2.SS1.p4.1.m1.1.1.3.3.1b" xref="A2.SS1.p4.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p4.1.m1.1.1.3.3.5" xref="A2.SS1.p4.1.m1.1.1.3.3.5.cmml">g</mi><mo id="A2.SS1.p4.1.m1.1.1.3.3.1c" xref="A2.SS1.p4.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p4.1.m1.1.1.3.3.6" xref="A2.SS1.p4.1.m1.1.1.3.3.6.cmml">e</mi><mo id="A2.SS1.p4.1.m1.1.1.3.3.1d" xref="A2.SS1.p4.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="A2.SS1.p4.1.m1.1.1.3.3.7" xref="A2.SS1.p4.1.m1.1.1.3.3.7.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><times id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1"></times><cn id="A2.SS1.p4.1.m1.1.1.2.cmml" type="float" xref="A2.SS1.p4.1.m1.1.1.2">0.25</cn><apply id="A2.SS1.p4.1.m1.1.1.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p4.1.m1.1.1.3.1.cmml" xref="A2.SS1.p4.1.m1.1.1.3">subscript</csymbol><ci id="A2.SS1.p4.1.m1.1.1.3.2.cmml" xref="A2.SS1.p4.1.m1.1.1.3.2">𝜌</ci><apply id="A2.SS1.p4.1.m1.1.1.3.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3"><times id="A2.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.1"></times><ci id="A2.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.2">𝑡</ci><ci id="A2.SS1.p4.1.m1.1.1.3.3.3.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.3">𝑎</ci><ci id="A2.SS1.p4.1.m1.1.1.3.3.4.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.4">𝑟</ci><ci id="A2.SS1.p4.1.m1.1.1.3.3.5.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.5">𝑔</ci><ci id="A2.SS1.p4.1.m1.1.1.3.3.6.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.6">𝑒</ci><ci id="A2.SS1.p4.1.m1.1.1.3.3.7.cmml" xref="A2.SS1.p4.1.m1.1.1.3.3.7">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">0.25\rho_{target}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">0.25 italic_ρ start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#A1.SS5" title="A.5 Directly Controlling the Exploration/Exploitation Trade-Off via a Pairwise Policy Update ‣ Appendix A RL Agent Differences from MuZero ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag">A.5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Optimizer Scale Correction</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Our experiments exclusively use the Adam optimizer for its fast convergence properties <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib32" title="">32</a>]</cite>. However, when used in combination with <span class="ltx_glossaryref" title="">AE</span> for <span class="ltx_glossaryref" title="">RL</span>, we noticed that learning was often unstable, with the occasional massive exploding gradient. To fix this, we used a variant of Adam that was step-size aware; that is, in the “Update Parameters” step, if <math alttext="\left|\hat{m}_{t}/(\sqrt{\hat{v}_{t}}+\epsilon)\right|&gt;(c_{maxstep}=100)" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.2"><semantics id="A2.SS2.p1.1.m1.2a"><mrow id="A2.SS2.p1.1.m1.2.2" xref="A2.SS2.p1.1.m1.2.2.cmml"><mrow id="A2.SS2.p1.1.m1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.2.cmml"><mo id="A2.SS2.p1.1.m1.1.1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="A2.SS2.p1.1.m1.1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="A2.SS2.p1.1.m1.1.1.1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml"><mi id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.2.cmml">m</mi><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="A2.SS2.p1.1.m1.1.1.1.1.1.3.3" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.2.cmml">/</mo><mrow id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><msqrt id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub></msqrt><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.SS2.p1.1.m1.1.1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="A2.SS2.p1.1.m1.2.2.3" xref="A2.SS2.p1.1.m1.2.2.3.cmml">&gt;</mo><mrow id="A2.SS2.p1.1.m1.2.2.2.1" xref="A2.SS2.p1.1.m1.2.2.2.1.1.cmml"><mo id="A2.SS2.p1.1.m1.2.2.2.1.2" stretchy="false" xref="A2.SS2.p1.1.m1.2.2.2.1.1.cmml">(</mo><mrow id="A2.SS2.p1.1.m1.2.2.2.1.1" xref="A2.SS2.p1.1.m1.2.2.2.1.1.cmml"><msub id="A2.SS2.p1.1.m1.2.2.2.1.1.2" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.cmml"><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.2" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.2.cmml">c</mi><mrow id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.cmml"><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.2" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.2.cmml">m</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.3" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.3.cmml">a</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1a" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.4" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.4.cmml">x</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1b" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.5" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.5.cmml">s</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1c" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.6" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.6.cmml">t</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1d" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.7" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.7.cmml">e</mi><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1e" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.8" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.8.cmml">p</mi></mrow></msub><mo id="A2.SS2.p1.1.m1.2.2.2.1.1.1" xref="A2.SS2.p1.1.m1.2.2.2.1.1.1.cmml">=</mo><mn id="A2.SS2.p1.1.m1.2.2.2.1.1.3" xref="A2.SS2.p1.1.m1.2.2.2.1.1.3.cmml">100</mn></mrow><mo id="A2.SS2.p1.1.m1.2.2.2.1.3" stretchy="false" xref="A2.SS2.p1.1.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.2b"><apply id="A2.SS2.p1.1.m1.2.2.cmml" xref="A2.SS2.p1.1.m1.2.2"><gt id="A2.SS2.p1.1.m1.2.2.3.cmml" xref="A2.SS2.p1.1.m1.2.2.3"></gt><apply id="A2.SS2.p1.1.m1.1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1"><abs id="A2.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.2"></abs><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1"><divide id="A2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.2"></divide><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2"><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.1">^</ci><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.2.2">𝑚</ci></apply><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1"><plus id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2"><root id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2"></root><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2"><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝑣</ci></apply><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply></apply><ci id="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></apply><apply id="A2.SS2.p1.1.m1.2.2.2.1.1.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1"><eq id="A2.SS2.p1.1.m1.2.2.2.1.1.1.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.1"></eq><apply id="A2.SS2.p1.1.m1.2.2.2.1.1.2.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.2.2.2.1.1.2.1.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2">subscript</csymbol><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.2.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.2">𝑐</ci><apply id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3"><times id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.1"></times><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.2.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.2">𝑚</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.3.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.3">𝑎</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.4.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.4">𝑥</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.5.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.5">𝑠</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.6.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.6">𝑡</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.7.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.7">𝑒</ci><ci id="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.8.cmml" xref="A2.SS2.p1.1.m1.2.2.2.1.1.2.3.8">𝑝</ci></apply></apply><cn id="A2.SS2.p1.1.m1.2.2.2.1.1.3.cmml" type="integer" xref="A2.SS2.p1.1.m1.2.2.2.1.1.3">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.2c">\left|\hat{m}_{t}/(\sqrt{\hat{v}_{t}}+\epsilon)\right|&gt;(c_{maxstep}=100)</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.2d">| over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT / ( square-root start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG + italic_ϵ ) | &gt; ( italic_c start_POSTSUBSCRIPT italic_m italic_a italic_x italic_s italic_t italic_e italic_p end_POSTSUBSCRIPT = 100 )</annotation></semantics></math> for any parameter update, then all parameter updates were scaled down so that the max step size was 100 (which is then multiplied by the learning rate). This solved such instabilities, and retained good optimizer quality.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Controlling Regularization Strength</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">The original <span class="ltx_glossaryref" title="">AE</span> work controlled the <span class="ltx_glossaryref" title="">AE</span> regularization loss strength by targeting a given training loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>. We did not find this to be effective for <span class="ltx_glossaryref" title="">RL</span>, as training loss is unpredictable and varies significantly by environment. One approach would have been to target an average agent reward, but that is a complex function of both the environment and the agent regularization itself. Instead, we target an expected L1 magnitude of the gradient for the chosen action’s log probability with respect to the inputs. This effectively bounds the Lipschitz constraint from <span class="ltx_glossaryref" title="">AE</span> to enforce a given rate of change, which we found to be both easy to adjust and surprisingly consistent across environments.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Sparsity-Promoting Gradient-Minimization Function</h3>
<div class="ltx_para" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.2">We used <math alttext="z=1.25" class="ltx_Math" display="inline" id="A2.SS4.p1.1.m1.1"><semantics id="A2.SS4.p1.1.m1.1a"><mrow id="A2.SS4.p1.1.m1.1.1" xref="A2.SS4.p1.1.m1.1.1.cmml"><mi id="A2.SS4.p1.1.m1.1.1.2" xref="A2.SS4.p1.1.m1.1.1.2.cmml">z</mi><mo id="A2.SS4.p1.1.m1.1.1.1" xref="A2.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS4.p1.1.m1.1.1.3" xref="A2.SS4.p1.1.m1.1.1.3.cmml">1.25</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.1.m1.1b"><apply id="A2.SS4.p1.1.m1.1.1.cmml" xref="A2.SS4.p1.1.m1.1.1"><eq id="A2.SS4.p1.1.m1.1.1.1.cmml" xref="A2.SS4.p1.1.m1.1.1.1"></eq><ci id="A2.SS4.p1.1.m1.1.1.2.cmml" xref="A2.SS4.p1.1.m1.1.1.2">𝑧</ci><cn id="A2.SS4.p1.1.m1.1.1.3.cmml" type="float" xref="A2.SS4.p1.1.m1.1.1.3">1.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.1.m1.1c">z=1.25</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p1.1.m1.1d">italic_z = 1.25</annotation></semantics></math> for the <math alttext="L_{adv,z,q}" class="ltx_Math" display="inline" id="A2.SS4.p1.2.m2.3"><semantics id="A2.SS4.p1.2.m2.3a"><msub id="A2.SS4.p1.2.m2.3.4" xref="A2.SS4.p1.2.m2.3.4.cmml"><mi id="A2.SS4.p1.2.m2.3.4.2" xref="A2.SS4.p1.2.m2.3.4.2.cmml">L</mi><mrow id="A2.SS4.p1.2.m2.3.3.3.3" xref="A2.SS4.p1.2.m2.3.3.3.4.cmml"><mrow id="A2.SS4.p1.2.m2.3.3.3.3.1" xref="A2.SS4.p1.2.m2.3.3.3.3.1.cmml"><mi id="A2.SS4.p1.2.m2.3.3.3.3.1.2" xref="A2.SS4.p1.2.m2.3.3.3.3.1.2.cmml">a</mi><mo id="A2.SS4.p1.2.m2.3.3.3.3.1.1" xref="A2.SS4.p1.2.m2.3.3.3.3.1.1.cmml">⁢</mo><mi id="A2.SS4.p1.2.m2.3.3.3.3.1.3" xref="A2.SS4.p1.2.m2.3.3.3.3.1.3.cmml">d</mi><mo id="A2.SS4.p1.2.m2.3.3.3.3.1.1a" xref="A2.SS4.p1.2.m2.3.3.3.3.1.1.cmml">⁢</mo><mi id="A2.SS4.p1.2.m2.3.3.3.3.1.4" xref="A2.SS4.p1.2.m2.3.3.3.3.1.4.cmml">v</mi></mrow><mo id="A2.SS4.p1.2.m2.3.3.3.3.2" xref="A2.SS4.p1.2.m2.3.3.3.4.cmml">,</mo><mi id="A2.SS4.p1.2.m2.1.1.1.1" xref="A2.SS4.p1.2.m2.1.1.1.1.cmml">z</mi><mo id="A2.SS4.p1.2.m2.3.3.3.3.3" xref="A2.SS4.p1.2.m2.3.3.3.4.cmml">,</mo><mi id="A2.SS4.p1.2.m2.2.2.2.2" xref="A2.SS4.p1.2.m2.2.2.2.2.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.2.m2.3b"><apply id="A2.SS4.p1.2.m2.3.4.cmml" xref="A2.SS4.p1.2.m2.3.4"><csymbol cd="ambiguous" id="A2.SS4.p1.2.m2.3.4.1.cmml" xref="A2.SS4.p1.2.m2.3.4">subscript</csymbol><ci id="A2.SS4.p1.2.m2.3.4.2.cmml" xref="A2.SS4.p1.2.m2.3.4.2">𝐿</ci><list id="A2.SS4.p1.2.m2.3.3.3.4.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3"><apply id="A2.SS4.p1.2.m2.3.3.3.3.1.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3.1"><times id="A2.SS4.p1.2.m2.3.3.3.3.1.1.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3.1.1"></times><ci id="A2.SS4.p1.2.m2.3.3.3.3.1.2.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3.1.2">𝑎</ci><ci id="A2.SS4.p1.2.m2.3.3.3.3.1.3.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3.1.3">𝑑</ci><ci id="A2.SS4.p1.2.m2.3.3.3.3.1.4.cmml" xref="A2.SS4.p1.2.m2.3.3.3.3.1.4">𝑣</ci></apply><ci id="A2.SS4.p1.2.m2.1.1.1.1.cmml" xref="A2.SS4.p1.2.m2.1.1.1.1">𝑧</ci><ci id="A2.SS4.p1.2.m2.2.2.2.2.cmml" xref="A2.SS4.p1.2.m2.2.2.2.2">𝑞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.2.m2.3c">L_{adv,z,q}</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p1.2.m2.3d">italic_L start_POSTSUBSCRIPT italic_a italic_d italic_v , italic_z , italic_q end_POSTSUBSCRIPT</annotation></semantics></math> function from Section III-B of the original <span class="ltx_glossaryref" title="">AE</span> paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib6" title="">6</a>]</cite>. This encouraged sparser gradients, which was convenient for human interpretation in many of the environments we tried. During evaluation (not training), we also found it useful to adjust the manner in which <span class="ltx_glossaryref" title="">AEs</span> were generated. By adding an additional L1 loss term back toward the original image, the explanations were even sparser, allowing for easier interpretation.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Figures</h2>
<figure class="ltx_figure" id="A3.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="399" id="A3.F12.g1" src="extracted/5912081/img/model_kde.jpeg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Kernel density plots that capture the relationship between true criticality (y-axis) and proxy criticality (x-axis), for different numbers <math alttext="n" class="ltx_Math" display="inline" id="A3.F12.2.m1.1"><semantics id="A3.F12.2.m1.1b"><mi id="A3.F12.2.m1.1.1" xref="A3.F12.2.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A3.F12.2.m1.1c"><ci id="A3.F12.2.m1.1.1.cmml" xref="A3.F12.2.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F12.2.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="A3.F12.2.m1.1e">italic_n</annotation></semantics></math> of random actions. See Grushin <span class="ltx_text ltx_font_italic" id="A3.F12.4.1">et al.</span> for additional information on interpreting this figure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#bib.bib8" title="">8</a>]</cite>. In particular, note that the 95th percentile curves become the boundaries between the shaded regions in <a class="ltx_ref" href="https://arxiv.org/html/2407.03210v2#S3.F5" title="In 3.1 Model Criticality ‣ 3 Results ‣ Combining AI control systems and human decision support via robustness and criticality"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, though they are first adjusted such that they are monotonic with respect to proxy criticality.</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  9 02:12:21 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
