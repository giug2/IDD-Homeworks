<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2104.10283] GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering</title><meta property="og:description" content="Images are more than a collection of objects or attributes — they represent a web of relationships among interconnected objects. Scene Graph has emerged as a new modality for a structured graphical representation of im…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2104.10283">

<!--Generated on Sun Mar 17 04:49:47 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
GraphVQA: Language-Guided Graph Neural Networks 
<br class="ltx_break">for Scene Graph Question Answering
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weixin Liang<sup id="id4.4.id1" class="ltx_sup"><span id="id4.4.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Yanhao Jiang<sup id="id5.5.id2" class="ltx_sup"><span id="id5.5.id2.1" class="ltx_text ltx_font_italic">1</span></sup>, Zixuan Liu<sup id="id6.6.id3" class="ltx_sup"><span id="id6.6.id3.1" class="ltx_text ltx_font_italic">1</span></sup> 
<br class="ltx_break">Stanford University, Stanford, CA 94305 
<br class="ltx_break"><span id="id7.7.id4" class="ltx_text ltx_font_typewriter">{wxliang,jiangyh,zucks626}@stanford.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">Images are more than a collection of objects or attributes — they represent a web of relationships among interconnected objects. Scene Graph has emerged as a new modality for a structured graphical representation of images. Scene Graph encodes objects as nodes connected via pairwise relations as edges. To support question answering on scene graphs, we propose GraphVQA, a language-guided graph neural network framework that translates and executes a natural language question as multiple iterations of message passing among graph nodes. We explore the design space of GraphVQA framework, and discuss the trade-off of different design choices. Our experiments on GQA dataset show that GraphVQA outperforms the state-of-the-art model by a large margin (88.43% vs. 94.78%).
Our code is available at <a target="_blank" href="https://github.com/codexxxl/GraphVQA" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/codexxxl/GraphVQA</a></p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotetext: </span>Equal Contribution. Authors listed in alphabetical order.</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Images are more than a collection of objects or attributes. Each image represents a web of relationships among interconnected objects.
Towards formalizing a representation for images, Visual Genome <cite class="ltx_cite ltx_citemacro_cite">Krishna et al. (<a href="#bib.bib13" title="" class="ltx_ref">2017a</a>)</cite> defined scene graphs, a structured formal graphical representation of an image that is similar to the form widely used in knowledge base representations.
As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, scene graph encodes objects (e.g., girl, burger) as nodes connected via pairwise relationships (e.g., holding) as edges. Scene graphs have been introduced for image retrieval <cite class="ltx_cite ltx_citemacro_cite">Johnson et al. (<a href="#bib.bib11" title="" class="ltx_ref">2015</a>)</cite>, image generation <cite class="ltx_cite ltx_citemacro_cite">Johnson et al. (<a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>, image captioning <cite class="ltx_cite ltx_citemacro_cite">Anderson et al. (<a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>, understanding instructional videos <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>, and situational role classification <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2104.10283/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="253" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
<span id="S1.F1.3.1" class="ltx_text ltx_font_bold">Scene Graph:</span>
Scene graph encodes objects (e.g., girl, burger) as nodes connected via pairwise relationships (e.g., holding) as edges.
<span id="S1.F1.4.2" class="ltx_text ltx_font_bold">GraphVQA Framework: </span>
Our core insight is to translates and executes a natural language question as multiple iterations of message passing among graph nodes (e.g., hamburger -&gt; small girl -&gt; red tray).
The final state after message passing represents the answer (e.g., tray).
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.2" class="ltx_p">To support question answering on scene graphs, we propose GraphVQA, a language-guided graph neural network framework for Scene Graph Question Answering(Scene Graph QA). Our core insight is to translate a natural language question into multiple iterations of message passing among graph nodes. Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows an example question “What is the red object left of the girl that is holding a hamburger”.
This question can be naturally answered by the following iterations of message passing “hamburger <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S1.p2.1.m1.1a"><mo stretchy="false" id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\to</annotation></semantics></math> small girl <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="\to" display="inline"><semantics id="S1.p2.2.m2.1a"><mo stretchy="false" id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">\to</annotation></semantics></math> red tray”. The final state after message passing represents the answer (e.g., tray), and the intermediate states reflect the model’s reasoning.
Each message passing iteration is accomplished by a graph neural network (GNN) layer.
We explore various message passing designs in GraphVQA, and discuss the trade-off of different design choices.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Scene Graph QA is closely related to Visual Question Answering (VQA). Although there are many research efforts in scene graph generation, Scene Graph QA remains relatively under-explored. Sporadic attempts in scene graph based VQA <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>); Li et al. (<a href="#bib.bib15" title="" class="ltx_ref">2019</a>); Santoro et al. (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> mostly propose various attention mechanisms designed primarily for fully-connected graphs, thereby failing to model and capture the important structural information of the scene graphs.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We evaluate GraphVQA on GQA dataset <cite class="ltx_cite ltx_citemacro_cite">Hudson and Manning (<a href="#bib.bib8" title="" class="ltx_ref">2019a</a>)</cite>.
We found that GraphVQA with de facto GNNs can outperform the state-of-the-art model by a large margin (88.43% vs. 94.78%). We discuss additional related work in appendix <a href="#A1" title="Appendix A Related Work ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.
Our results suggest the importance of incorporating recent advances from graph machine learning into our community.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2104.10283/assets/figures/general.jpg" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="252" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
Semantics of the GraphVQA Framework.
(1) Question Parsing Module translates the question to <math id="S1.F2.4.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.F2.4.m1.1b"><mi id="S1.F2.4.m1.1.1" xref="S1.F2.4.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.F2.4.m1.1c"><ci id="S1.F2.4.m1.1.1.cmml" xref="S1.F2.4.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.4.m1.1d">M</annotation></semantics></math> instruction vectors.
(2) Scene Graph Encoding Module initializes node features <math id="S1.F2.5.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S1.F2.5.m2.1b"><mi id="S1.F2.5.m2.1.1" xref="S1.F2.5.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S1.F2.5.m2.1c"><ci id="S1.F2.5.m2.1.1.cmml" xref="S1.F2.5.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.5.m2.1d">X</annotation></semantics></math> and edge features <math id="S1.F2.6.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S1.F2.6.m3.1b"><mi id="S1.F2.6.m3.1.1" xref="S1.F2.6.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S1.F2.6.m3.1c"><ci id="S1.F2.6.m3.1.1.cmml" xref="S1.F2.6.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.m3.1d">E</annotation></semantics></math> with word embeddings.
(3) Graph Reasoning Module perform message passing with graph neural networks for each instruction vector.
(4) Answering Module summarizes the final state after message passing and predicts the answer.
</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Machine Learning with Graphs</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Modeling graphical data has historically been challenging for the machine learning community. Traditionally, methods have relied on Laplacian regularization through label propagation, manifold regularization or learning embeddings.
Today’s de facto choice is graph neural network (GNN), which is a operator on local neighborhoods of nodes.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.4" class="ltx_p">GNNs follow the message passing scheme.
The high level idea is to update each node’s feature using its local neighborhoods of nodes.
Specifically, node <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">i</annotation></semantics></math>’s representation at l-th layer <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{(l)}" display="inline"><semantics id="S2.p2.2.m2.1a"><msubsup id="S2.p2.2.m2.1.2" xref="S2.p2.2.m2.1.2.cmml"><mi id="S2.p2.2.m2.1.2.2.2" xref="S2.p2.2.m2.1.2.2.2.cmml">𝒉</mi><mi id="S2.p2.2.m2.1.2.2.3" xref="S2.p2.2.m2.1.2.2.3.cmml">i</mi><mrow id="S2.p2.2.m2.1.1.1.3" xref="S2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S2.p2.2.m2.1.1.1.3.1" xref="S2.p2.2.m2.1.2.cmml">(</mo><mi id="S2.p2.2.m2.1.1.1.1" xref="S2.p2.2.m2.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.p2.2.m2.1.1.1.3.2" xref="S2.p2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.2.cmml" xref="S2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.2.1.cmml" xref="S2.p2.2.m2.1.2">superscript</csymbol><apply id="S2.p2.2.m2.1.2.2.cmml" xref="S2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.2.2.1.cmml" xref="S2.p2.2.m2.1.2">subscript</csymbol><ci id="S2.p2.2.m2.1.2.2.2.cmml" xref="S2.p2.2.m2.1.2.2.2">𝒉</ci><ci id="S2.p2.2.m2.1.2.2.3.cmml" xref="S2.p2.2.m2.1.2.2.3">𝑖</ci></apply><ci id="S2.p2.2.m2.1.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\boldsymbol{h}_{i}^{(l)}</annotation></semantics></math> can be calculated using previous layer’s node representations <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{(l-1)}" display="inline"><semantics id="S2.p2.3.m3.1a"><msubsup id="S2.p2.3.m3.1.2" xref="S2.p2.3.m3.1.2.cmml"><mi id="S2.p2.3.m3.1.2.2.2" xref="S2.p2.3.m3.1.2.2.2.cmml">𝒉</mi><mi id="S2.p2.3.m3.1.2.2.3" xref="S2.p2.3.m3.1.2.2.3.cmml">i</mi><mrow id="S2.p2.3.m3.1.1.1.1" xref="S2.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.3.m3.1.1.1.1.2" xref="S2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.3.m3.1.1.1.1.1" xref="S2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S2.p2.3.m3.1.1.1.1.1.2" xref="S2.p2.3.m3.1.1.1.1.1.2.cmml">l</mi><mo id="S2.p2.3.m3.1.1.1.1.1.1" xref="S2.p2.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S2.p2.3.m3.1.1.1.1.1.3" xref="S2.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.p2.3.m3.1.1.1.1.3" xref="S2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.2.cmml" xref="S2.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.2.1.cmml" xref="S2.p2.3.m3.1.2">superscript</csymbol><apply id="S2.p2.3.m3.1.2.2.cmml" xref="S2.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.2.2.1.cmml" xref="S2.p2.3.m3.1.2">subscript</csymbol><ci id="S2.p2.3.m3.1.2.2.2.cmml" xref="S2.p2.3.m3.1.2.2.2">𝒉</ci><ci id="S2.p2.3.m3.1.2.2.3.cmml" xref="S2.p2.3.m3.1.2.2.3">𝑖</ci></apply><apply id="S2.p2.3.m3.1.1.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1.1"><minus id="S2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1.1.1.1"></minus><ci id="S2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.p2.3.m3.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.p2.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\boldsymbol{h}_{i}^{(l-1)}</annotation></semantics></math> and <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{h}_{j}^{(l-1)}" display="inline"><semantics id="S2.p2.4.m4.1a"><msubsup id="S2.p2.4.m4.1.2" xref="S2.p2.4.m4.1.2.cmml"><mi id="S2.p2.4.m4.1.2.2.2" xref="S2.p2.4.m4.1.2.2.2.cmml">𝒉</mi><mi id="S2.p2.4.m4.1.2.2.3" xref="S2.p2.4.m4.1.2.2.3.cmml">j</mi><mrow id="S2.p2.4.m4.1.1.1.1" xref="S2.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.4.m4.1.1.1.1.2" xref="S2.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.4.m4.1.1.1.1.1" xref="S2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S2.p2.4.m4.1.1.1.1.1.2" xref="S2.p2.4.m4.1.1.1.1.1.2.cmml">l</mi><mo id="S2.p2.4.m4.1.1.1.1.1.1" xref="S2.p2.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S2.p2.4.m4.1.1.1.1.1.3" xref="S2.p2.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.p2.4.m4.1.1.1.1.3" xref="S2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.2.cmml" xref="S2.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.2.1.cmml" xref="S2.p2.4.m4.1.2">superscript</csymbol><apply id="S2.p2.4.m4.1.2.2.cmml" xref="S2.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.2.2.1.cmml" xref="S2.p2.4.m4.1.2">subscript</csymbol><ci id="S2.p2.4.m4.1.2.2.2.cmml" xref="S2.p2.4.m4.1.2.2.2">𝒉</ci><ci id="S2.p2.4.m4.1.2.2.3.cmml" xref="S2.p2.4.m4.1.2.2.3">𝑗</ci></apply><apply id="S2.p2.4.m4.1.1.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1.1"><minus id="S2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1.1.1.1"></minus><ci id="S2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.p2.4.m4.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S2.p2.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\boldsymbol{h}_{j}^{(l-1)}</annotation></semantics></math> as:</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m1.7" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)}=\mbox{AGG}_{j\in\mathcal{N}_{i}}\phi^{(l)}(\boldsymbol{h}_{i}^{(l-1)},\boldsymbol{h}_{j}^{(l-1)},\boldsymbol{e}_{ji})" display="inline"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><msubsup id="S2.E1.m1.7.7.5" xref="S2.E1.m1.7.7.5.cmml"><mi id="S2.E1.m1.7.7.5.2.2" xref="S2.E1.m1.7.7.5.2.2.cmml">𝒉</mi><msub id="S2.E1.m1.7.7.5.2.3" xref="S2.E1.m1.7.7.5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.5.2.3.2" xref="S2.E1.m1.7.7.5.2.3.2.cmml">𝒩</mi><mi id="S2.E1.m1.7.7.5.2.3.3" xref="S2.E1.m1.7.7.5.2.3.3.cmml">i</mi></msub><mrow id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.7.7.5.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.3.1" xref="S2.E1.m1.7.7.5.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.7.7.5.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.7.7.4" xref="S2.E1.m1.7.7.4.cmml">=</mo><mrow id="S2.E1.m1.7.7.3" xref="S2.E1.m1.7.7.3.cmml"><msub id="S2.E1.m1.7.7.3.5" xref="S2.E1.m1.7.7.3.5.cmml"><mtext id="S2.E1.m1.7.7.3.5.2" xref="S2.E1.m1.7.7.3.5.2a.cmml">AGG</mtext><mrow id="S2.E1.m1.7.7.3.5.3" xref="S2.E1.m1.7.7.3.5.3.cmml"><mi id="S2.E1.m1.7.7.3.5.3.2" xref="S2.E1.m1.7.7.3.5.3.2.cmml">j</mi><mo id="S2.E1.m1.7.7.3.5.3.1" xref="S2.E1.m1.7.7.3.5.3.1.cmml">∈</mo><msub id="S2.E1.m1.7.7.3.5.3.3" xref="S2.E1.m1.7.7.3.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.3.5.3.3.2" xref="S2.E1.m1.7.7.3.5.3.3.2.cmml">𝒩</mi><mi id="S2.E1.m1.7.7.3.5.3.3.3" xref="S2.E1.m1.7.7.3.5.3.3.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.3.4" xref="S2.E1.m1.7.7.3.4.cmml">​</mo><msup id="S2.E1.m1.7.7.3.6" xref="S2.E1.m1.7.7.3.6.cmml"><mi id="S2.E1.m1.7.7.3.6.2" xref="S2.E1.m1.7.7.3.6.2.cmml">ϕ</mi><mrow id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.7.7.3.6.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.3.1" xref="S2.E1.m1.7.7.3.6.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.3.2" xref="S2.E1.m1.7.7.3.6.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.3.4a" xref="S2.E1.m1.7.7.3.4.cmml">​</mo><mrow id="S2.E1.m1.7.7.3.3.3" xref="S2.E1.m1.7.7.3.3.4.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.3.3.3.4" xref="S2.E1.m1.7.7.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.2.2" xref="S2.E1.m1.5.5.1.1.1.1.2.2.cmml">𝒉</mi><mi id="S2.E1.m1.5.5.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.7.7.3.3.3.5" xref="S2.E1.m1.7.7.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.6.6.2.2.2.2" xref="S2.E1.m1.6.6.2.2.2.2.cmml"><mi id="S2.E1.m1.6.6.2.2.2.2.2.2" xref="S2.E1.m1.6.6.2.2.2.2.2.2.cmml">𝒉</mi><mi id="S2.E1.m1.6.6.2.2.2.2.2.3" xref="S2.E1.m1.6.6.2.2.2.2.2.3.cmml">j</mi><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">l</mi><mo id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.7.7.3.3.3.6" xref="S2.E1.m1.7.7.3.3.4.cmml">,</mo><msub id="S2.E1.m1.7.7.3.3.3.3" xref="S2.E1.m1.7.7.3.3.3.3.cmml"><mi id="S2.E1.m1.7.7.3.3.3.3.2" xref="S2.E1.m1.7.7.3.3.3.3.2.cmml">𝒆</mi><mrow id="S2.E1.m1.7.7.3.3.3.3.3" xref="S2.E1.m1.7.7.3.3.3.3.3.cmml"><mi id="S2.E1.m1.7.7.3.3.3.3.3.2" xref="S2.E1.m1.7.7.3.3.3.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.3.3.3.3.3.1" xref="S2.E1.m1.7.7.3.3.3.3.3.1.cmml">​</mo><mi id="S2.E1.m1.7.7.3.3.3.3.3.3" xref="S2.E1.m1.7.7.3.3.3.3.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="S2.E1.m1.7.7.3.3.3.7" xref="S2.E1.m1.7.7.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><eq id="S2.E1.m1.7.7.4.cmml" xref="S2.E1.m1.7.7.4"></eq><apply id="S2.E1.m1.7.7.5.cmml" xref="S2.E1.m1.7.7.5"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.1.cmml" xref="S2.E1.m1.7.7.5">superscript</csymbol><apply id="S2.E1.m1.7.7.5.2.cmml" xref="S2.E1.m1.7.7.5"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.2.1.cmml" xref="S2.E1.m1.7.7.5">subscript</csymbol><ci id="S2.E1.m1.7.7.5.2.2.cmml" xref="S2.E1.m1.7.7.5.2.2">𝒉</ci><apply id="S2.E1.m1.7.7.5.2.3.cmml" xref="S2.E1.m1.7.7.5.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.5.2.3.1.cmml" xref="S2.E1.m1.7.7.5.2.3">subscript</csymbol><ci id="S2.E1.m1.7.7.5.2.3.2.cmml" xref="S2.E1.m1.7.7.5.2.3.2">𝒩</ci><ci id="S2.E1.m1.7.7.5.2.3.3.cmml" xref="S2.E1.m1.7.7.5.2.3.3">𝑖</ci></apply></apply><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E1.m1.7.7.3.cmml" xref="S2.E1.m1.7.7.3"><times id="S2.E1.m1.7.7.3.4.cmml" xref="S2.E1.m1.7.7.3.4"></times><apply id="S2.E1.m1.7.7.3.5.cmml" xref="S2.E1.m1.7.7.3.5"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.3.5.1.cmml" xref="S2.E1.m1.7.7.3.5">subscript</csymbol><ci id="S2.E1.m1.7.7.3.5.2a.cmml" xref="S2.E1.m1.7.7.3.5.2"><mtext id="S2.E1.m1.7.7.3.5.2.cmml" xref="S2.E1.m1.7.7.3.5.2">AGG</mtext></ci><apply id="S2.E1.m1.7.7.3.5.3.cmml" xref="S2.E1.m1.7.7.3.5.3"><in id="S2.E1.m1.7.7.3.5.3.1.cmml" xref="S2.E1.m1.7.7.3.5.3.1"></in><ci id="S2.E1.m1.7.7.3.5.3.2.cmml" xref="S2.E1.m1.7.7.3.5.3.2">𝑗</ci><apply id="S2.E1.m1.7.7.3.5.3.3.cmml" xref="S2.E1.m1.7.7.3.5.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.3.5.3.3.1.cmml" xref="S2.E1.m1.7.7.3.5.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.3.5.3.3.2.cmml" xref="S2.E1.m1.7.7.3.5.3.3.2">𝒩</ci><ci id="S2.E1.m1.7.7.3.5.3.3.3.cmml" xref="S2.E1.m1.7.7.3.5.3.3.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.7.7.3.6.cmml" xref="S2.E1.m1.7.7.3.6"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.3.6.1.cmml" xref="S2.E1.m1.7.7.3.6">superscript</csymbol><ci id="S2.E1.m1.7.7.3.6.2.cmml" xref="S2.E1.m1.7.7.3.6.2">italic-ϕ</ci><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑙</ci></apply><vector id="S2.E1.m1.7.7.3.3.4.cmml" xref="S2.E1.m1.7.7.3.3.3"><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.2">𝒉</ci><ci id="S2.E1.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1"><minus id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"></minus><ci id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S2.E1.m1.6.6.2.2.2.2.cmml" xref="S2.E1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.2.2.2.2.1.cmml" xref="S2.E1.m1.6.6.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.6.6.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.2.2.2.2.2.1.cmml" xref="S2.E1.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.6.6.2.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.2.2.2.2.2.2">𝒉</ci><ci id="S2.E1.m1.6.6.2.2.2.2.2.3.cmml" xref="S2.E1.m1.6.6.2.2.2.2.2.3">𝑗</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1"><minus id="S2.E1.m1.4.4.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1"></minus><ci id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3">1</cn></apply></apply><apply id="S2.E1.m1.7.7.3.3.3.3.cmml" xref="S2.E1.m1.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.3.3.3.3.1.cmml" xref="S2.E1.m1.7.7.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.3.3.3.3.2.cmml" xref="S2.E1.m1.7.7.3.3.3.3.2">𝒆</ci><apply id="S2.E1.m1.7.7.3.3.3.3.3.cmml" xref="S2.E1.m1.7.7.3.3.3.3.3"><times id="S2.E1.m1.7.7.3.3.3.3.3.1.cmml" xref="S2.E1.m1.7.7.3.3.3.3.3.1"></times><ci id="S2.E1.m1.7.7.3.3.3.3.3.2.cmml" xref="S2.E1.m1.7.7.3.3.3.3.3.2">𝑗</ci><ci id="S2.E1.m1.7.7.3.3.3.3.3.3.cmml" xref="S2.E1.m1.7.7.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">\displaystyle\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)}=\mbox{AGG}_{j\in\mathcal{N}_{i}}\phi^{(l)}(\boldsymbol{h}_{i}^{(l-1)},\boldsymbol{h}_{j}^{(l-1)},\boldsymbol{e}_{ji})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m1.6" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{(l)}=\gamma^{(l)}(\boldsymbol{h}_{i}^{(l-1)},\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)})" display="inline"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml"><msubsup id="S2.E2.m1.6.6.4" xref="S2.E2.m1.6.6.4.cmml"><mi id="S2.E2.m1.6.6.4.2.2" xref="S2.E2.m1.6.6.4.2.2.cmml">𝒉</mi><mi id="S2.E2.m1.6.6.4.2.3" xref="S2.E2.m1.6.6.4.2.3.cmml">i</mi><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.6.6.4.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.3.1" xref="S2.E2.m1.6.6.4.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.6.6.4.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.6.6.3" xref="S2.E2.m1.6.6.3.cmml">=</mo><mrow id="S2.E2.m1.6.6.2" xref="S2.E2.m1.6.6.2.cmml"><msup id="S2.E2.m1.6.6.2.4" xref="S2.E2.m1.6.6.2.4.cmml"><mi id="S2.E2.m1.6.6.2.4.2" xref="S2.E2.m1.6.6.2.4.2.cmml">γ</mi><mrow id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.6.6.2.4.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.3.1" xref="S2.E2.m1.6.6.2.4.cmml">(</mo><mi id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.E2.m1.2.2.1.3.2" xref="S2.E2.m1.6.6.2.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E2.m1.6.6.2.3" xref="S2.E2.m1.6.6.2.3.cmml">​</mo><mrow id="S2.E2.m1.6.6.2.2.2" xref="S2.E2.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.6.6.2.2.2.3" xref="S2.E2.m1.6.6.2.2.3.cmml">(</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.cmml">𝒉</mi><mi id="S2.E2.m1.5.5.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.6.6.2.2.2.4" xref="S2.E2.m1.6.6.2.2.3.cmml">,</mo><msubsup id="S2.E2.m1.6.6.2.2.2.2" xref="S2.E2.m1.6.6.2.2.2.2.cmml"><mi id="S2.E2.m1.6.6.2.2.2.2.2.2" xref="S2.E2.m1.6.6.2.2.2.2.2.2.cmml">𝒉</mi><msub id="S2.E2.m1.6.6.2.2.2.2.2.3" xref="S2.E2.m1.6.6.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.6.6.2.2.2.2.2.3.2" xref="S2.E2.m1.6.6.2.2.2.2.2.3.2.cmml">𝒩</mi><mi id="S2.E2.m1.6.6.2.2.2.2.2.3.3" xref="S2.E2.m1.6.6.2.2.2.2.2.3.3.cmml">i</mi></msub><mrow id="S2.E2.m1.4.4.1.3" xref="S2.E2.m1.6.6.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.3.1" xref="S2.E2.m1.6.6.2.2.2.2.cmml">(</mo><mi id="S2.E2.m1.4.4.1.1" xref="S2.E2.m1.4.4.1.1.cmml">l</mi><mo stretchy="false" id="S2.E2.m1.4.4.1.3.2" xref="S2.E2.m1.6.6.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.E2.m1.6.6.2.2.2.5" xref="S2.E2.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><apply id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6"><eq id="S2.E2.m1.6.6.3.cmml" xref="S2.E2.m1.6.6.3"></eq><apply id="S2.E2.m1.6.6.4.cmml" xref="S2.E2.m1.6.6.4"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.4.1.cmml" xref="S2.E2.m1.6.6.4">superscript</csymbol><apply id="S2.E2.m1.6.6.4.2.cmml" xref="S2.E2.m1.6.6.4"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.4.2.1.cmml" xref="S2.E2.m1.6.6.4">subscript</csymbol><ci id="S2.E2.m1.6.6.4.2.2.cmml" xref="S2.E2.m1.6.6.4.2.2">𝒉</ci><ci id="S2.E2.m1.6.6.4.2.3.cmml" xref="S2.E2.m1.6.6.4.2.3">𝑖</ci></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E2.m1.6.6.2.cmml" xref="S2.E2.m1.6.6.2"><times id="S2.E2.m1.6.6.2.3.cmml" xref="S2.E2.m1.6.6.2.3"></times><apply id="S2.E2.m1.6.6.2.4.cmml" xref="S2.E2.m1.6.6.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.2.4.1.cmml" xref="S2.E2.m1.6.6.2.4">superscript</csymbol><ci id="S2.E2.m1.6.6.2.4.2.cmml" xref="S2.E2.m1.6.6.2.4.2">𝛾</ci><ci id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1">𝑙</ci></apply><interval closure="open" id="S2.E2.m1.6.6.2.2.3.cmml" xref="S2.E2.m1.6.6.2.2.2"><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2">𝒉</ci><ci id="S2.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1"><minus id="S2.E2.m1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1"></minus><ci id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S2.E2.m1.6.6.2.2.2.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.2.2.2.2.1.cmml" xref="S2.E2.m1.6.6.2.2.2.2">superscript</csymbol><apply id="S2.E2.m1.6.6.2.2.2.2.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.2.2.2.2.2.1.cmml" xref="S2.E2.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.6.6.2.2.2.2.2.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2.2.2">𝒉</ci><apply id="S2.E2.m1.6.6.2.2.2.2.2.3.cmml" xref="S2.E2.m1.6.6.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.6.6.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.6.6.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2.2.3.2">𝒩</ci><ci id="S2.E2.m1.6.6.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.6.6.2.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="S2.E2.m1.4.4.1.1.cmml" xref="S2.E2.m1.4.4.1.1">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">\displaystyle\boldsymbol{h}_{i}^{(l)}=\gamma^{(l)}(\boldsymbol{h}_{i}^{(l-1)},\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.10" class="ltx_p">where <math id="S2.p2.5.m1.1" class="ltx_Math" alttext="\boldsymbol{e}_{ji}" display="inline"><semantics id="S2.p2.5.m1.1a"><msub id="S2.p2.5.m1.1.1" xref="S2.p2.5.m1.1.1.cmml"><mi id="S2.p2.5.m1.1.1.2" xref="S2.p2.5.m1.1.1.2.cmml">𝒆</mi><mrow id="S2.p2.5.m1.1.1.3" xref="S2.p2.5.m1.1.1.3.cmml"><mi id="S2.p2.5.m1.1.1.3.2" xref="S2.p2.5.m1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S2.p2.5.m1.1.1.3.1" xref="S2.p2.5.m1.1.1.3.1.cmml">​</mo><mi id="S2.p2.5.m1.1.1.3.3" xref="S2.p2.5.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m1.1b"><apply id="S2.p2.5.m1.1.1.cmml" xref="S2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m1.1.1.1.cmml" xref="S2.p2.5.m1.1.1">subscript</csymbol><ci id="S2.p2.5.m1.1.1.2.cmml" xref="S2.p2.5.m1.1.1.2">𝒆</ci><apply id="S2.p2.5.m1.1.1.3.cmml" xref="S2.p2.5.m1.1.1.3"><times id="S2.p2.5.m1.1.1.3.1.cmml" xref="S2.p2.5.m1.1.1.3.1"></times><ci id="S2.p2.5.m1.1.1.3.2.cmml" xref="S2.p2.5.m1.1.1.3.2">𝑗</ci><ci id="S2.p2.5.m1.1.1.3.3.cmml" xref="S2.p2.5.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m1.1c">\boldsymbol{e}_{ji}</annotation></semantics></math> denotes the feature of edge from node <math id="S2.p2.6.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.p2.6.m2.1a"><mi id="S2.p2.6.m2.1.1" xref="S2.p2.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m2.1b"><ci id="S2.p2.6.m2.1.1.cmml" xref="S2.p2.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m2.1c">j</annotation></semantics></math> to node <math id="S2.p2.7.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.7.m3.1a"><mi id="S2.p2.7.m3.1.1" xref="S2.p2.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m3.1b"><ci id="S2.p2.7.m3.1.1.cmml" xref="S2.p2.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m3.1c">i</annotation></semantics></math>, <math id="S2.p2.8.m4.1" class="ltx_Math" alttext="\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)}" display="inline"><semantics id="S2.p2.8.m4.1a"><msubsup id="S2.p2.8.m4.1.2" xref="S2.p2.8.m4.1.2.cmml"><mi id="S2.p2.8.m4.1.2.2.2" xref="S2.p2.8.m4.1.2.2.2.cmml">𝒉</mi><msub id="S2.p2.8.m4.1.2.2.3" xref="S2.p2.8.m4.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m4.1.2.2.3.2" xref="S2.p2.8.m4.1.2.2.3.2.cmml">𝒩</mi><mi id="S2.p2.8.m4.1.2.2.3.3" xref="S2.p2.8.m4.1.2.2.3.3.cmml">i</mi></msub><mrow id="S2.p2.8.m4.1.1.1.3" xref="S2.p2.8.m4.1.2.cmml"><mo stretchy="false" id="S2.p2.8.m4.1.1.1.3.1" xref="S2.p2.8.m4.1.2.cmml">(</mo><mi id="S2.p2.8.m4.1.1.1.1" xref="S2.p2.8.m4.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.p2.8.m4.1.1.1.3.2" xref="S2.p2.8.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.8.m4.1b"><apply id="S2.p2.8.m4.1.2.cmml" xref="S2.p2.8.m4.1.2"><csymbol cd="ambiguous" id="S2.p2.8.m4.1.2.1.cmml" xref="S2.p2.8.m4.1.2">superscript</csymbol><apply id="S2.p2.8.m4.1.2.2.cmml" xref="S2.p2.8.m4.1.2"><csymbol cd="ambiguous" id="S2.p2.8.m4.1.2.2.1.cmml" xref="S2.p2.8.m4.1.2">subscript</csymbol><ci id="S2.p2.8.m4.1.2.2.2.cmml" xref="S2.p2.8.m4.1.2.2.2">𝒉</ci><apply id="S2.p2.8.m4.1.2.2.3.cmml" xref="S2.p2.8.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.p2.8.m4.1.2.2.3.1.cmml" xref="S2.p2.8.m4.1.2.2.3">subscript</csymbol><ci id="S2.p2.8.m4.1.2.2.3.2.cmml" xref="S2.p2.8.m4.1.2.2.3.2">𝒩</ci><ci id="S2.p2.8.m4.1.2.2.3.3.cmml" xref="S2.p2.8.m4.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S2.p2.8.m4.1.1.1.1.cmml" xref="S2.p2.8.m4.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m4.1c">\boldsymbol{h}_{\mathcal{N}_{i}}^{(l)}</annotation></semantics></math> denotes aggregated neighborhood information, <math id="S2.p2.9.m5.1" class="ltx_Math" alttext="\gamma^{(l)}" display="inline"><semantics id="S2.p2.9.m5.1a"><msup id="S2.p2.9.m5.1.2" xref="S2.p2.9.m5.1.2.cmml"><mi id="S2.p2.9.m5.1.2.2" xref="S2.p2.9.m5.1.2.2.cmml">γ</mi><mrow id="S2.p2.9.m5.1.1.1.3" xref="S2.p2.9.m5.1.2.cmml"><mo stretchy="false" id="S2.p2.9.m5.1.1.1.3.1" xref="S2.p2.9.m5.1.2.cmml">(</mo><mi id="S2.p2.9.m5.1.1.1.1" xref="S2.p2.9.m5.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.p2.9.m5.1.1.1.3.2" xref="S2.p2.9.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p2.9.m5.1b"><apply id="S2.p2.9.m5.1.2.cmml" xref="S2.p2.9.m5.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m5.1.2.1.cmml" xref="S2.p2.9.m5.1.2">superscript</csymbol><ci id="S2.p2.9.m5.1.2.2.cmml" xref="S2.p2.9.m5.1.2.2">𝛾</ci><ci id="S2.p2.9.m5.1.1.1.1.cmml" xref="S2.p2.9.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m5.1c">\gamma^{(l)}</annotation></semantics></math> and <math id="S2.p2.10.m6.1" class="ltx_Math" alttext="\phi^{(l)}" display="inline"><semantics id="S2.p2.10.m6.1a"><msup id="S2.p2.10.m6.1.2" xref="S2.p2.10.m6.1.2.cmml"><mi id="S2.p2.10.m6.1.2.2" xref="S2.p2.10.m6.1.2.2.cmml">ϕ</mi><mrow id="S2.p2.10.m6.1.1.1.3" xref="S2.p2.10.m6.1.2.cmml"><mo stretchy="false" id="S2.p2.10.m6.1.1.1.3.1" xref="S2.p2.10.m6.1.2.cmml">(</mo><mi id="S2.p2.10.m6.1.1.1.1" xref="S2.p2.10.m6.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.p2.10.m6.1.1.1.3.2" xref="S2.p2.10.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.p2.10.m6.1b"><apply id="S2.p2.10.m6.1.2.cmml" xref="S2.p2.10.m6.1.2"><csymbol cd="ambiguous" id="S2.p2.10.m6.1.2.1.cmml" xref="S2.p2.10.m6.1.2">superscript</csymbol><ci id="S2.p2.10.m6.1.2.2.cmml" xref="S2.p2.10.m6.1.2.2">italic-ϕ</ci><ci id="S2.p2.10.m6.1.1.1.1.cmml" xref="S2.p2.10.m6.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m6.1c">\phi^{(l)}</annotation></semantics></math> denotes differentiable functions such as MLPs, and AGG denotes aggregation functions such as mean or sum pooling.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>GraphVQA Framework</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows an overview of four modules in GraphVQA: (1) Question Parsing Module translates the question to <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">M</annotation></semantics></math> instruction vectors.
(2) Scene Graph Encoding Module initializes node features <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">X</annotation></semantics></math> and edge features <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">E</annotation></semantics></math> with word embeddings.
(3) Graph Reasoning Module performs message passing with graph neural networks for each instruction vector.
(4) Answering Module summarizes the final state after message passing and predicts the answer.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Question Parsing Module</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">Question Parsing Module uses a sequence-to-sequence transformer architecture to translate the question <math id="S3.SS1.p1.1.m1.3" class="ltx_Math" alttext="[q_{1},\dots,q_{Q}]" display="inline"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3.2" xref="S3.SS1.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.2.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">[</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.2.cmml">q</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.4" xref="S3.SS1.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.3.3.2.5" xref="S3.SS1.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml">q</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.3.cmml">Q</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.3.3.2.6" xref="S3.SS1.p1.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><list id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.2">𝑞</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.3.3.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">𝑞</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.3">𝑄</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">[q_{1},\dots,q_{Q}]</annotation></semantics></math> into a sequence of instruction vectors <math id="S3.SS1.p1.2.m2.5" class="ltx_Math" alttext="[\boldsymbol{i}^{(1)},\dots,\boldsymbol{i}^{(M)}]" display="inline"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5.2" xref="S3.SS1.p1.2.m2.5.5.3.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.2.3" xref="S3.SS1.p1.2.m2.5.5.3.cmml">[</mo><msup id="S3.SS1.p1.2.m2.4.4.1.1" xref="S3.SS1.p1.2.m2.4.4.1.1.cmml"><mi id="S3.SS1.p1.2.m2.4.4.1.1.2" xref="S3.SS1.p1.2.m2.4.4.1.1.2.cmml">𝒊</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.3.1" xref="S3.SS1.p1.2.m2.4.4.1.1.cmml">(</mo><mn id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.3.2" xref="S3.SS1.p1.2.m2.4.4.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.2.m2.5.5.2.4" xref="S3.SS1.p1.2.m2.5.5.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.2.5" xref="S3.SS1.p1.2.m2.5.5.3.cmml">,</mo><msup id="S3.SS1.p1.2.m2.5.5.2.2" xref="S3.SS1.p1.2.m2.5.5.2.2.cmml"><mi id="S3.SS1.p1.2.m2.5.5.2.2.2" xref="S3.SS1.p1.2.m2.5.5.2.2.2.cmml">𝒊</mi><mrow id="S3.SS1.p1.2.m2.2.2.1.3" xref="S3.SS1.p1.2.m2.5.5.2.2.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.3.1" xref="S3.SS1.p1.2.m2.5.5.2.2.cmml">(</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml">M</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.3.2" xref="S3.SS1.p1.2.m2.5.5.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS1.p1.2.m2.5.5.2.6" xref="S3.SS1.p1.2.m2.5.5.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><list id="S3.SS1.p1.2.m2.5.5.3.cmml" xref="S3.SS1.p1.2.m2.5.5.2"><apply id="S3.SS1.p1.2.m2.4.4.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.1.1.1.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1">superscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.1.1.2.cmml" xref="S3.SS1.p1.2.m2.4.4.1.1.2">𝒊</ci><cn type="integer" id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">1</cn></apply><ci id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3">…</ci><apply id="S3.SS1.p1.2.m2.5.5.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.2.2.1.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.2.2.2.cmml" xref="S3.SS1.p1.2.m2.5.5.2.2.2">𝒊</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">[\boldsymbol{i}^{(1)},\dots,\boldsymbol{i}^{(M)}]</annotation></semantics></math> with a fixed <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">M</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.8" class="ltx_Math" alttext="[\boldsymbol{i}^{(1)},\dots,\boldsymbol{i}^{(M)}]=\mbox{Seq2Seq}(q_{1},\dots,q_{Q})" display="block"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml"><mrow id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.2.2.3" xref="S3.E3.m1.6.6.2.3.cmml">[</mo><msup id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml"><mi id="S3.E3.m1.5.5.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.2.cmml">𝒊</mi><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.3.1" xref="S3.E3.m1.5.5.1.1.1.cmml">(</mo><mn id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.6.6.2.2.4" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">…</mi><mo id="S3.E3.m1.6.6.2.2.5" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><msup id="S3.E3.m1.6.6.2.2.2" xref="S3.E3.m1.6.6.2.2.2.cmml"><mi id="S3.E3.m1.6.6.2.2.2.2" xref="S3.E3.m1.6.6.2.2.2.2.cmml">𝒊</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.6.6.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.3.1" xref="S3.E3.m1.6.6.2.2.2.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">M</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.6.6.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E3.m1.6.6.2.2.6" xref="S3.E3.m1.6.6.2.3.cmml">]</mo></mrow><mo id="S3.E3.m1.8.8.5" xref="S3.E3.m1.8.8.5.cmml">=</mo><mrow id="S3.E3.m1.8.8.4" xref="S3.E3.m1.8.8.4.cmml"><mtext id="S3.E3.m1.8.8.4.4" xref="S3.E3.m1.8.8.4.4a.cmml">Seq2Seq</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.4.3" xref="S3.E3.m1.8.8.4.3.cmml">​</mo><mrow id="S3.E3.m1.8.8.4.2.2" xref="S3.E3.m1.8.8.4.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.4.2.2.3" xref="S3.E3.m1.8.8.4.2.3.cmml">(</mo><msub id="S3.E3.m1.7.7.3.1.1.1" xref="S3.E3.m1.7.7.3.1.1.1.cmml"><mi id="S3.E3.m1.7.7.3.1.1.1.2" xref="S3.E3.m1.7.7.3.1.1.1.2.cmml">q</mi><mn id="S3.E3.m1.7.7.3.1.1.1.3" xref="S3.E3.m1.7.7.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3.m1.8.8.4.2.2.4" xref="S3.E3.m1.8.8.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">…</mi><mo id="S3.E3.m1.8.8.4.2.2.5" xref="S3.E3.m1.8.8.4.2.3.cmml">,</mo><msub id="S3.E3.m1.8.8.4.2.2.2" xref="S3.E3.m1.8.8.4.2.2.2.cmml"><mi id="S3.E3.m1.8.8.4.2.2.2.2" xref="S3.E3.m1.8.8.4.2.2.2.2.cmml">q</mi><mi id="S3.E3.m1.8.8.4.2.2.2.3" xref="S3.E3.m1.8.8.4.2.2.2.3.cmml">Q</mi></msub><mo stretchy="false" id="S3.E3.m1.8.8.4.2.2.6" xref="S3.E3.m1.8.8.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8"><eq id="S3.E3.m1.8.8.5.cmml" xref="S3.E3.m1.8.8.5"></eq><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.2"><apply id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2">𝒊</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">1</cn></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">…</ci><apply id="S3.E3.m1.6.6.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.2.1.cmml" xref="S3.E3.m1.6.6.2.2.2">superscript</csymbol><ci id="S3.E3.m1.6.6.2.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2.2">𝒊</ci><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑀</ci></apply></list><apply id="S3.E3.m1.8.8.4.cmml" xref="S3.E3.m1.8.8.4"><times id="S3.E3.m1.8.8.4.3.cmml" xref="S3.E3.m1.8.8.4.3"></times><ci id="S3.E3.m1.8.8.4.4a.cmml" xref="S3.E3.m1.8.8.4.4"><mtext id="S3.E3.m1.8.8.4.4.cmml" xref="S3.E3.m1.8.8.4.4">Seq2Seq</mtext></ci><vector id="S3.E3.m1.8.8.4.2.3.cmml" xref="S3.E3.m1.8.8.4.2.2"><apply id="S3.E3.m1.7.7.3.1.1.1.cmml" xref="S3.E3.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.3.1.1.1.1.cmml" xref="S3.E3.m1.7.7.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.7.7.3.1.1.1.2.cmml" xref="S3.E3.m1.7.7.3.1.1.1.2">𝑞</ci><cn type="integer" id="S3.E3.m1.7.7.3.1.1.1.3.cmml" xref="S3.E3.m1.7.7.3.1.1.1.3">1</cn></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">…</ci><apply id="S3.E3.m1.8.8.4.2.2.2.cmml" xref="S3.E3.m1.8.8.4.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.2.2.2.1.cmml" xref="S3.E3.m1.8.8.4.2.2.2">subscript</csymbol><ci id="S3.E3.m1.8.8.4.2.2.2.2.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2">𝑞</ci><ci id="S3.E3.m1.8.8.4.2.2.2.3.cmml" xref="S3.E3.m1.8.8.4.2.2.2.3">𝑄</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">[\boldsymbol{i}^{(1)},\dots,\boldsymbol{i}^{(M)}]=\mbox{Seq2Seq}(q_{1},\dots,q_{Q})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Scene Graph Encoding Module</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">Scene Graph Encoding Module first initializes node features
<math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="\hat{X}=[\hat{x}_{1},...,\hat{x}_{N}]" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.3.3.4" xref="S3.SS2.p1.1.m1.3.3.4.cmml"><mi id="S3.SS2.p1.1.m1.3.3.4.2" xref="S3.SS2.p1.1.m1.3.3.4.2.cmml">X</mi><mo id="S3.SS2.p1.1.m1.3.3.4.1" xref="S3.SS2.p1.1.m1.3.3.4.1.cmml">^</mo></mover><mo id="S3.SS2.p1.1.m1.3.3.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">[</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml">x</mi><mo id="S3.SS2.p1.1.m1.2.2.1.1.1.2.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml">^</mo></mover><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.3.3.2.2.4" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.3.3.2.2.5" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.3.3.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.2.cmml">x</mi><mo id="S3.SS2.p1.1.m1.3.3.2.2.2.2.1" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.2.6" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><apply id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3"><eq id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3"></eq><apply id="S3.SS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.4"><ci id="S3.SS2.p1.1.m1.3.3.4.1.cmml" xref="S3.SS2.p1.1.m1.3.3.4.1">^</ci><ci id="S3.SS2.p1.1.m1.3.3.4.2.cmml" xref="S3.SS2.p1.1.m1.3.3.4.2">𝑋</ci></apply><list id="S3.SS2.p1.1.m1.3.3.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2"><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.1">^</ci><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2">𝑥</ci></apply><cn type="integer" id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2"><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.1">^</ci><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.2">𝑥</ci></apply><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">\hat{X}=[\hat{x}_{1},...,\hat{x}_{N}]</annotation></semantics></math> with the word embeddings of the object name and attributes, and edge features <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">E</annotation></semantics></math> with the word embedding of edge type.
We then obtain contextualized node features <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">X</annotation></semantics></math> by:</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle\boldsymbol{x}_{i}=\sigma(\frac{1}{|\mathcal{N}_{i}|}\sum_{j\in\mathcal{N}_{i}}(W_{\mbox{enc}}\ [\boldsymbol{\hat{x}}_{j};\boldsymbol{e_{ij}}]))" display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><msub id="S3.E4.m1.2.2.3" xref="S3.E4.m1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.3.2" xref="S3.E4.m1.2.2.3.2.cmml">𝒙</mi><mi id="S3.E4.m1.2.2.3.3" xref="S3.E4.m1.2.2.3.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.cmml"><mi id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mfrac id="S3.E4.m1.1.1a" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">𝒩</mi><mi id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml"><munder id="S3.E4.m1.2.2.1.1.1.1.1.2a" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.2.2.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.2.3.1" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.2.cmml">𝒩</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.2.cmml">W</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3a.cmml">enc</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝒆</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">𝒊</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">𝒋</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><eq id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"></eq><apply id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.3.2">𝒙</ci><ci id="S3.E4.m1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.3.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.cmml" xref="S3.E4.m1.2.2.1"><times id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.2"></times><ci id="S3.E4.m1.2.2.1.3.cmml" xref="S3.E4.m1.2.2.1.3">𝜎</ci><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn type="integer" id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2"></abs><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝒩</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2"></sum><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3"><in id="S3.E4.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.1"></in><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.2">𝑗</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.2">𝒩</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.2">𝑊</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.4.3">enc</mtext></ci></apply><list id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1">bold-^</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci></apply><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2">𝒆</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.2">𝒊</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.3.3">𝒋</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle\boldsymbol{x}_{i}=\sigma(\frac{1}{|\mathcal{N}_{i}|}\sum_{j\in\mathcal{N}_{i}}(W_{\mbox{enc}}\ [\boldsymbol{\hat{x}}_{j};\boldsymbol{e_{ij}}]))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.8" class="ltx_p">where <math id="S3.SS2.p1.4.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p1.4.m1.1a"><mi id="S3.SS2.p1.4.m1.1.1" xref="S3.SS2.p1.4.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m1.1b"><ci id="S3.SS2.p1.4.m1.1.1.cmml" xref="S3.SS2.p1.4.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m1.1c">\sigma</annotation></semantics></math> denotes the activation function, <math id="S3.SS2.p1.5.m2.1" class="ltx_Math" alttext="\boldsymbol{e_{ij}}" display="inline"><semantics id="S3.SS2.p1.5.m2.1a"><msub id="S3.SS2.p1.5.m2.1.1" xref="S3.SS2.p1.5.m2.1.1.cmml"><mi id="S3.SS2.p1.5.m2.1.1.2" xref="S3.SS2.p1.5.m2.1.1.2.cmml">𝒆</mi><mrow id="S3.SS2.p1.5.m2.1.1.3" xref="S3.SS2.p1.5.m2.1.1.3.cmml"><mi id="S3.SS2.p1.5.m2.1.1.3.2" xref="S3.SS2.p1.5.m2.1.1.3.2.cmml">𝒊</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m2.1.1.3.1" xref="S3.SS2.p1.5.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m2.1.1.3.3" xref="S3.SS2.p1.5.m2.1.1.3.3.cmml">𝒋</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m2.1b"><apply id="S3.SS2.p1.5.m2.1.1.cmml" xref="S3.SS2.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m2.1.1.1.cmml" xref="S3.SS2.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m2.1.1.2.cmml" xref="S3.SS2.p1.5.m2.1.1.2">𝒆</ci><apply id="S3.SS2.p1.5.m2.1.1.3.cmml" xref="S3.SS2.p1.5.m2.1.1.3"><times id="S3.SS2.p1.5.m2.1.1.3.1.cmml" xref="S3.SS2.p1.5.m2.1.1.3.1"></times><ci id="S3.SS2.p1.5.m2.1.1.3.2.cmml" xref="S3.SS2.p1.5.m2.1.1.3.2">𝒊</ci><ci id="S3.SS2.p1.5.m2.1.1.3.3.cmml" xref="S3.SS2.p1.5.m2.1.1.3.3">𝒋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m2.1c">\boldsymbol{e_{ij}}</annotation></semantics></math> denotes the feature of the edge that connects node <math id="S3.SS2.p1.6.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.6.m3.1a"><mi id="S3.SS2.p1.6.m3.1.1" xref="S3.SS2.p1.6.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m3.1b"><ci id="S3.SS2.p1.6.m3.1.1.cmml" xref="S3.SS2.p1.6.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m3.1c">i</annotation></semantics></math> and node <math id="S3.SS2.p1.7.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.7.m4.1a"><mi id="S3.SS2.p1.7.m4.1.1" xref="S3.SS2.p1.7.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m4.1b"><ci id="S3.SS2.p1.7.m4.1.1.cmml" xref="S3.SS2.p1.7.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m4.1c">j</annotation></semantics></math>,
and <math id="S3.SS2.p1.8.m5.4" class="ltx_Math" alttext="X=[x_{1},x_{2},...,x_{N}]" display="inline"><semantics id="S3.SS2.p1.8.m5.4a"><mrow id="S3.SS2.p1.8.m5.4.4" xref="S3.SS2.p1.8.m5.4.4.cmml"><mi id="S3.SS2.p1.8.m5.4.4.5" xref="S3.SS2.p1.8.m5.4.4.5.cmml">X</mi><mo id="S3.SS2.p1.8.m5.4.4.4" xref="S3.SS2.p1.8.m5.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.8.m5.4.4.3.3" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m5.4.4.3.3.4" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml">[</mo><msub id="S3.SS2.p1.8.m5.2.2.1.1.1" xref="S3.SS2.p1.8.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.8.m5.2.2.1.1.1.2" xref="S3.SS2.p1.8.m5.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS2.p1.8.m5.2.2.1.1.1.3" xref="S3.SS2.p1.8.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.8.m5.4.4.3.3.5" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.8.m5.3.3.2.2.2" xref="S3.SS2.p1.8.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.8.m5.3.3.2.2.2.2" xref="S3.SS2.p1.8.m5.3.3.2.2.2.2.cmml">x</mi><mn id="S3.SS2.p1.8.m5.3.3.2.2.2.3" xref="S3.SS2.p1.8.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.8.m5.4.4.3.3.6" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.8.m5.1.1" xref="S3.SS2.p1.8.m5.1.1.cmml">…</mi><mo id="S3.SS2.p1.8.m5.4.4.3.3.7" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.8.m5.4.4.3.3.3" xref="S3.SS2.p1.8.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.8.m5.4.4.3.3.3.2" xref="S3.SS2.p1.8.m5.4.4.3.3.3.2.cmml">x</mi><mi id="S3.SS2.p1.8.m5.4.4.3.3.3.3" xref="S3.SS2.p1.8.m5.4.4.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.p1.8.m5.4.4.3.3.8" xref="S3.SS2.p1.8.m5.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m5.4b"><apply id="S3.SS2.p1.8.m5.4.4.cmml" xref="S3.SS2.p1.8.m5.4.4"><eq id="S3.SS2.p1.8.m5.4.4.4.cmml" xref="S3.SS2.p1.8.m5.4.4.4"></eq><ci id="S3.SS2.p1.8.m5.4.4.5.cmml" xref="S3.SS2.p1.8.m5.4.4.5">𝑋</ci><list id="S3.SS2.p1.8.m5.4.4.3.4.cmml" xref="S3.SS2.p1.8.m5.4.4.3.3"><apply id="S3.SS2.p1.8.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.8.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.8.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.8.m5.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S3.SS2.p1.8.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.8.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.8.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.8.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.8.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.8.m5.3.3.2.2.2.2">𝑥</ci><cn type="integer" id="S3.SS2.p1.8.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.8.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.8.m5.1.1.cmml" xref="S3.SS2.p1.8.m5.1.1">…</ci><apply id="S3.SS2.p1.8.m5.4.4.3.3.3.cmml" xref="S3.SS2.p1.8.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.8.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.8.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.8.m5.4.4.3.3.3.2">𝑥</ci><ci id="S3.SS2.p1.8.m5.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.8.m5.4.4.3.3.3.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m5.4c">X=[x_{1},x_{2},...,x_{N}]</annotation></semantics></math> denotes the contextualized node features.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Graph Reasoning Module</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.6" class="ltx_p">Graph Reasoning Module is the core of GraphVQA framework.
Graph Reasoning Module executes the <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">M</annotation></semantics></math> instruction vectors step-by-step, with <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N</annotation></semantics></math> graph neural network layers.
One major difference between our Graph Reasoning Module and standard GNN is that, we want the message passing in layer <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">L</annotation></semantics></math> conditioned on the <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">L</annotation></semantics></math><sup id="S3.SS3.p1.6.1" class="ltx_sup">th</sup> instruction vector. Inspired by language model type condition <cite class="ltx_cite ltx_citemacro_cite">Liang et al. (<a href="#bib.bib18" title="" class="ltx_ref">2020b</a>)</cite>, we adopt a general design that is compatible with <em id="S3.SS3.p1.6.2" class="ltx_emph ltx_font_italic">any</em> graph neural network design:
Before running the <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">L</annotation></semantics></math><sup id="S3.SS3.p1.6.3" class="ltx_sup">th</sup> GNN layer, we concatenate the <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">L</annotation></semantics></math><sup id="S3.SS3.p1.6.4" class="ltx_sup">th</sup> instruction vector to every node and edge feature from the previous layer. Specifically,</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{\hat{h}}_{i}^{(L-1)}=[\boldsymbol{h}_{i}^{(L-1)};\boldsymbol{i}^{(L)}]" display="inline"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml"><msubsup id="S3.E5.m1.5.5.4" xref="S3.E5.m1.5.5.4.cmml"><mover accent="true" id="S3.E5.m1.5.5.4.2.2" xref="S3.E5.m1.5.5.4.2.2.cmml"><mi id="S3.E5.m1.5.5.4.2.2.2" xref="S3.E5.m1.5.5.4.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E5.m1.5.5.4.2.2.1" xref="S3.E5.m1.5.5.4.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.5.5.4.2.3" xref="S3.E5.m1.5.5.4.2.3.cmml">i</mi><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.3" xref="S3.E5.m1.5.5.3.cmml">=</mo><mrow id="S3.E5.m1.5.5.2.2" xref="S3.E5.m1.5.5.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.2.2.3" xref="S3.E5.m1.5.5.2.3.cmml">[</mo><msubsup id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mi id="S3.E5.m1.4.4.1.1.1.2.2" xref="S3.E5.m1.4.4.1.1.1.2.2.cmml">𝒉</mi><mi id="S3.E5.m1.4.4.1.1.1.2.3" xref="S3.E5.m1.4.4.1.1.1.2.3.cmml">i</mi><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">L</mi><mo id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.2.2.4" xref="S3.E5.m1.5.5.2.3.cmml">;</mo><msup id="S3.E5.m1.5.5.2.2.2" xref="S3.E5.m1.5.5.2.2.2.cmml"><mi id="S3.E5.m1.5.5.2.2.2.2" xref="S3.E5.m1.5.5.2.2.2.2.cmml">𝒊</mi><mrow id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.5.5.2.2.2.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.3.1" xref="S3.E5.m1.5.5.2.2.2.cmml">(</mo><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S3.E5.m1.3.3.1.3.2" xref="S3.E5.m1.5.5.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E5.m1.5.5.2.2.5" xref="S3.E5.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5"><eq id="S3.E5.m1.5.5.3.cmml" xref="S3.E5.m1.5.5.3"></eq><apply id="S3.E5.m1.5.5.4.cmml" xref="S3.E5.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.4.1.cmml" xref="S3.E5.m1.5.5.4">superscript</csymbol><apply id="S3.E5.m1.5.5.4.2.cmml" xref="S3.E5.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.4.2.1.cmml" xref="S3.E5.m1.5.5.4">subscript</csymbol><apply id="S3.E5.m1.5.5.4.2.2.cmml" xref="S3.E5.m1.5.5.4.2.2"><ci id="S3.E5.m1.5.5.4.2.2.1.cmml" xref="S3.E5.m1.5.5.4.2.2.1">bold-^</ci><ci id="S3.E5.m1.5.5.4.2.2.2.cmml" xref="S3.E5.m1.5.5.4.2.2.2">𝒉</ci></apply><ci id="S3.E5.m1.5.5.4.2.3.cmml" xref="S3.E5.m1.5.5.4.2.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><minus id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"></minus><ci id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">1</cn></apply></apply><list id="S3.E5.m1.5.5.2.3.cmml" xref="S3.E5.m1.5.5.2.2"><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1">superscript</csymbol><apply id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2.2">𝒉</ci><ci id="S3.E5.m1.4.4.1.1.1.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.5.5.2.2.2.cmml" xref="S3.E5.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.2.2.1.cmml" xref="S3.E5.m1.5.5.2.2.2">superscript</csymbol><ci id="S3.E5.m1.5.5.2.2.2.2.cmml" xref="S3.E5.m1.5.5.2.2.2.2">𝒊</ci><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\displaystyle\boldsymbol{\hat{h}}_{i}^{(L-1)}=[\boldsymbol{h}_{i}^{(L-1)};\boldsymbol{i}^{(L)}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{\hat{e}}_{ij}^{(L-1)}=[\boldsymbol{e}_{ij}^{(L-1)};\boldsymbol{i}^{(L)}]" display="inline"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><msubsup id="S3.E6.m1.5.5.4" xref="S3.E6.m1.5.5.4.cmml"><mover accent="true" id="S3.E6.m1.5.5.4.2.2" xref="S3.E6.m1.5.5.4.2.2.cmml"><mi id="S3.E6.m1.5.5.4.2.2.2" xref="S3.E6.m1.5.5.4.2.2.2.cmml">𝒆</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E6.m1.5.5.4.2.2.1" xref="S3.E6.m1.5.5.4.2.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.5.5.4.2.3" xref="S3.E6.m1.5.5.4.2.3.cmml"><mi id="S3.E6.m1.5.5.4.2.3.2" xref="S3.E6.m1.5.5.4.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.4.2.3.1" xref="S3.E6.m1.5.5.4.2.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.4.2.3.3" xref="S3.E6.m1.5.5.4.2.3.3.cmml">j</mi></mrow><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml">=</mo><mrow id="S3.E6.m1.5.5.2.2" xref="S3.E6.m1.5.5.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.2.2.3" xref="S3.E6.m1.5.5.2.3.cmml">[</mo><msubsup id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.cmml"><mi id="S3.E6.m1.4.4.1.1.1.2.2" xref="S3.E6.m1.4.4.1.1.1.2.2.cmml">𝒆</mi><mrow id="S3.E6.m1.4.4.1.1.1.2.3" xref="S3.E6.m1.4.4.1.1.1.2.3.cmml"><mi id="S3.E6.m1.4.4.1.1.1.2.3.2" xref="S3.E6.m1.4.4.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.1.1.1.2.3.1" xref="S3.E6.m1.4.4.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.4.4.1.1.1.2.3.3" xref="S3.E6.m1.4.4.1.1.1.2.3.3.cmml">j</mi></mrow><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">L</mi><mo id="S3.E6.m1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.2.2.4" xref="S3.E6.m1.5.5.2.3.cmml">;</mo><msup id="S3.E6.m1.5.5.2.2.2" xref="S3.E6.m1.5.5.2.2.2.cmml"><mi id="S3.E6.m1.5.5.2.2.2.2" xref="S3.E6.m1.5.5.2.2.2.2.cmml">𝒊</mi><mrow id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.5.5.2.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.3.1" xref="S3.E6.m1.5.5.2.2.2.cmml">(</mo><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.3.2" xref="S3.E6.m1.5.5.2.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.E6.m1.5.5.2.2.5" xref="S3.E6.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><eq id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3"></eq><apply id="S3.E6.m1.5.5.4.cmml" xref="S3.E6.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.1.cmml" xref="S3.E6.m1.5.5.4">superscript</csymbol><apply id="S3.E6.m1.5.5.4.2.cmml" xref="S3.E6.m1.5.5.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.4.2.1.cmml" xref="S3.E6.m1.5.5.4">subscript</csymbol><apply id="S3.E6.m1.5.5.4.2.2.cmml" xref="S3.E6.m1.5.5.4.2.2"><ci id="S3.E6.m1.5.5.4.2.2.1.cmml" xref="S3.E6.m1.5.5.4.2.2.1">bold-^</ci><ci id="S3.E6.m1.5.5.4.2.2.2.cmml" xref="S3.E6.m1.5.5.4.2.2.2">𝒆</ci></apply><apply id="S3.E6.m1.5.5.4.2.3.cmml" xref="S3.E6.m1.5.5.4.2.3"><times id="S3.E6.m1.5.5.4.2.3.1.cmml" xref="S3.E6.m1.5.5.4.2.3.1"></times><ci id="S3.E6.m1.5.5.4.2.3.2.cmml" xref="S3.E6.m1.5.5.4.2.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.4.2.3.3.cmml" xref="S3.E6.m1.5.5.4.2.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"></minus><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">1</cn></apply></apply><list id="S3.E6.m1.5.5.2.3.cmml" xref="S3.E6.m1.5.5.2.2"><apply id="S3.E6.m1.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1">superscript</csymbol><apply id="S3.E6.m1.4.4.1.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2.2">𝒆</ci><apply id="S3.E6.m1.4.4.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.1.1.1.2.3"><times id="S3.E6.m1.4.4.1.1.1.2.3.1.cmml" xref="S3.E6.m1.4.4.1.1.1.2.3.1"></times><ci id="S3.E6.m1.4.4.1.1.1.2.3.2.cmml" xref="S3.E6.m1.4.4.1.1.1.2.3.2">𝑖</ci><ci id="S3.E6.m1.4.4.1.1.1.2.3.3.cmml" xref="S3.E6.m1.4.4.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1"><minus id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1"></minus><ci id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E6.m1.5.5.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.2.2.2.1.cmml" xref="S3.E6.m1.5.5.2.2.2">superscript</csymbol><ci id="S3.E6.m1.5.5.2.2.2.2.cmml" xref="S3.E6.m1.5.5.2.2.2.2">𝒊</ci><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\displaystyle\boldsymbol{\hat{e}}_{ij}^{(L-1)}=[\boldsymbol{e}_{ij}^{(L-1)};\boldsymbol{i}^{(L)}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.9" class="ltx_p">where <math id="S3.SS3.p1.7.m1.1" class="ltx_Math" alttext="\boldsymbol{\hat{h}}_{i}^{(L-1)}" display="inline"><semantics id="S3.SS3.p1.7.m1.1a"><msubsup id="S3.SS3.p1.7.m1.1.2" xref="S3.SS3.p1.7.m1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.7.m1.1.2.2.2" xref="S3.SS3.p1.7.m1.1.2.2.2.cmml"><mi id="S3.SS3.p1.7.m1.1.2.2.2.2" xref="S3.SS3.p1.7.m1.1.2.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS3.p1.7.m1.1.2.2.2.1" xref="S3.SS3.p1.7.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.7.m1.1.2.2.3" xref="S3.SS3.p1.7.m1.1.2.2.3.cmml">i</mi><mrow id="S3.SS3.p1.7.m1.1.1.1.1" xref="S3.SS3.p1.7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.7.m1.1.1.1.1.2" xref="S3.SS3.p1.7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.7.m1.1.1.1.1.1" xref="S3.SS3.p1.7.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.7.m1.1.1.1.1.1.2" xref="S3.SS3.p1.7.m1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.p1.7.m1.1.1.1.1.1.1" xref="S3.SS3.p1.7.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.p1.7.m1.1.1.1.1.1.3" xref="S3.SS3.p1.7.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p1.7.m1.1.1.1.1.3" xref="S3.SS3.p1.7.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m1.1b"><apply id="S3.SS3.p1.7.m1.1.2.cmml" xref="S3.SS3.p1.7.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m1.1.2.1.cmml" xref="S3.SS3.p1.7.m1.1.2">superscript</csymbol><apply id="S3.SS3.p1.7.m1.1.2.2.cmml" xref="S3.SS3.p1.7.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m1.1.2.2.1.cmml" xref="S3.SS3.p1.7.m1.1.2">subscript</csymbol><apply id="S3.SS3.p1.7.m1.1.2.2.2.cmml" xref="S3.SS3.p1.7.m1.1.2.2.2"><ci id="S3.SS3.p1.7.m1.1.2.2.2.1.cmml" xref="S3.SS3.p1.7.m1.1.2.2.2.1">bold-^</ci><ci id="S3.SS3.p1.7.m1.1.2.2.2.2.cmml" xref="S3.SS3.p1.7.m1.1.2.2.2.2">𝒉</ci></apply><ci id="S3.SS3.p1.7.m1.1.2.2.3.cmml" xref="S3.SS3.p1.7.m1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS3.p1.7.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m1.1.1.1.1"><minus id="S3.SS3.p1.7.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m1.1.1.1.1.1.1"></minus><ci id="S3.SS3.p1.7.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.7.m1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS3.p1.7.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.7.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m1.1c">\boldsymbol{\hat{h}}_{i}^{(L-1)}</annotation></semantics></math> and <math id="S3.SS3.p1.8.m2.1" class="ltx_Math" alttext="\boldsymbol{\hat{e}}_{ij}^{(L-1)}" display="inline"><semantics id="S3.SS3.p1.8.m2.1a"><msubsup id="S3.SS3.p1.8.m2.1.2" xref="S3.SS3.p1.8.m2.1.2.cmml"><mover accent="true" id="S3.SS3.p1.8.m2.1.2.2.2" xref="S3.SS3.p1.8.m2.1.2.2.2.cmml"><mi id="S3.SS3.p1.8.m2.1.2.2.2.2" xref="S3.SS3.p1.8.m2.1.2.2.2.2.cmml">𝒆</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.SS3.p1.8.m2.1.2.2.2.1" xref="S3.SS3.p1.8.m2.1.2.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p1.8.m2.1.2.2.3" xref="S3.SS3.p1.8.m2.1.2.2.3.cmml"><mi id="S3.SS3.p1.8.m2.1.2.2.3.2" xref="S3.SS3.p1.8.m2.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.8.m2.1.2.2.3.1" xref="S3.SS3.p1.8.m2.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.8.m2.1.2.2.3.3" xref="S3.SS3.p1.8.m2.1.2.2.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.p1.8.m2.1.1.1.1" xref="S3.SS3.p1.8.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.8.m2.1.1.1.1.2" xref="S3.SS3.p1.8.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.8.m2.1.1.1.1.1" xref="S3.SS3.p1.8.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.8.m2.1.1.1.1.1.2" xref="S3.SS3.p1.8.m2.1.1.1.1.1.2.cmml">L</mi><mo id="S3.SS3.p1.8.m2.1.1.1.1.1.1" xref="S3.SS3.p1.8.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.p1.8.m2.1.1.1.1.1.3" xref="S3.SS3.p1.8.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.p1.8.m2.1.1.1.1.3" xref="S3.SS3.p1.8.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m2.1b"><apply id="S3.SS3.p1.8.m2.1.2.cmml" xref="S3.SS3.p1.8.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m2.1.2.1.cmml" xref="S3.SS3.p1.8.m2.1.2">superscript</csymbol><apply id="S3.SS3.p1.8.m2.1.2.2.cmml" xref="S3.SS3.p1.8.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m2.1.2.2.1.cmml" xref="S3.SS3.p1.8.m2.1.2">subscript</csymbol><apply id="S3.SS3.p1.8.m2.1.2.2.2.cmml" xref="S3.SS3.p1.8.m2.1.2.2.2"><ci id="S3.SS3.p1.8.m2.1.2.2.2.1.cmml" xref="S3.SS3.p1.8.m2.1.2.2.2.1">bold-^</ci><ci id="S3.SS3.p1.8.m2.1.2.2.2.2.cmml" xref="S3.SS3.p1.8.m2.1.2.2.2.2">𝒆</ci></apply><apply id="S3.SS3.p1.8.m2.1.2.2.3.cmml" xref="S3.SS3.p1.8.m2.1.2.2.3"><times id="S3.SS3.p1.8.m2.1.2.2.3.1.cmml" xref="S3.SS3.p1.8.m2.1.2.2.3.1"></times><ci id="S3.SS3.p1.8.m2.1.2.2.3.2.cmml" xref="S3.SS3.p1.8.m2.1.2.2.3.2">𝑖</ci><ci id="S3.SS3.p1.8.m2.1.2.2.3.3.cmml" xref="S3.SS3.p1.8.m2.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p1.8.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m2.1.1.1.1"><minus id="S3.SS3.p1.8.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m2.1.1.1.1.1.1"></minus><ci id="S3.SS3.p1.8.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.8.m2.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS3.p1.8.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.8.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m2.1c">\boldsymbol{\hat{e}}_{ij}^{(L-1)}</annotation></semantics></math> denotes the node feature and edge feature as inputs to the <math id="S3.SS3.p1.9.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.p1.9.m3.1a"><mi id="S3.SS3.p1.9.m3.1.1" xref="S3.SS3.p1.9.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m3.1b"><ci id="S3.SS3.p1.9.m3.1.1.cmml" xref="S3.SS3.p1.9.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m3.1c">L</annotation></semantics></math><sup id="S3.SS3.p1.9.1" class="ltx_sup">th</sup> GNN layer.
Next, we introduce three standard GNNs that we have explored, starting from the simplest one.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Graph Convolution Networks (GCN)</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">GCN <cite class="ltx_cite ltx_citemacro_cite">Kipf and Welling (<a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite> treats neighborhood nodes as equally important sources of information, and simply averages the transformed features of neighborhood nodes.</p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{(L)}=\sigma(\frac{1}{|\mathcal{N}_{i}|}\sum_{j\in\mathcal{N}_{i}}(W_{\textrm{GCN}}^{(L)}\;\boldsymbol{\hat{h}}_{j}^{(L-1)}))" display="inline"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml"><msubsup id="S3.E7.m1.5.5.3" xref="S3.E7.m1.5.5.3.cmml"><mi id="S3.E7.m1.5.5.3.2.2" xref="S3.E7.m1.5.5.3.2.2.cmml">𝒉</mi><mi id="S3.E7.m1.5.5.3.2.3" xref="S3.E7.m1.5.5.3.2.3.cmml">i</mi><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.5.5.3.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.3.1" xref="S3.E7.m1.5.5.3.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.5.5.2" xref="S3.E7.m1.5.5.2.cmml">=</mo><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.cmml"><mi id="S3.E7.m1.5.5.1.3" xref="S3.E7.m1.5.5.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mfrac id="S3.E7.m1.2.2a" xref="S3.E7.m1.2.2.cmml"><mn id="S3.E7.m1.2.2.3" xref="S3.E7.m1.2.2.3.cmml">1</mn><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.2.cmml">𝒩</mi><mi id="S3.E7.m1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E7.m1.5.5.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml"><munder id="S3.E7.m1.5.5.1.1.1.1.1.2a" xref="S3.E7.m1.5.5.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E7.m1.5.5.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.2.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.2.3.1" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.2.cmml">𝒩</mi><mi id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.3" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mtext id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3a.cmml">GCN</mtext><mrow id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.3.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S3.E7.m1.3.3.1.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mrow id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.1.1.2" xref="S3.E7.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.1.1.1" xref="S3.E7.m1.4.4.1.1.1.cmml"><mi id="S3.E7.m1.4.4.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.2.cmml">L</mi><mo id="S3.E7.m1.4.4.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.E7.m1.4.4.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E7.m1.4.4.1.1.3" xref="S3.E7.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5"><eq id="S3.E7.m1.5.5.2.cmml" xref="S3.E7.m1.5.5.2"></eq><apply id="S3.E7.m1.5.5.3.cmml" xref="S3.E7.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.1.cmml" xref="S3.E7.m1.5.5.3">superscript</csymbol><apply id="S3.E7.m1.5.5.3.2.cmml" xref="S3.E7.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.2.1.cmml" xref="S3.E7.m1.5.5.3">subscript</csymbol><ci id="S3.E7.m1.5.5.3.2.2.cmml" xref="S3.E7.m1.5.5.3.2.2">𝒉</ci><ci id="S3.E7.m1.5.5.3.2.3.cmml" xref="S3.E7.m1.5.5.3.2.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝐿</ci></apply><apply id="S3.E7.m1.5.5.1.cmml" xref="S3.E7.m1.5.5.1"><times id="S3.E7.m1.5.5.1.2.cmml" xref="S3.E7.m1.5.5.1.2"></times><ci id="S3.E7.m1.5.5.1.3.cmml" xref="S3.E7.m1.5.5.1.3">𝜎</ci><apply id="S3.E7.m1.5.5.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.2"></times><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2"></divide><cn type="integer" id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.3">1</cn><apply id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.1"><abs id="S3.E7.m1.2.2.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.2"></abs><apply id="S3.E7.m1.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.2">𝒩</ci><ci id="S3.E7.m1.2.2.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1"><apply id="S3.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3"><in id="S3.E7.m1.5.5.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.1"></in><ci id="S3.E7.m1.5.5.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.2">𝑗</ci><apply id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.2">𝒩</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.2.3">GCN</mtext></ci></apply><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝐿</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2"><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.1">bold-^</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2">𝒉</ci></apply><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E7.m1.4.4.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1"><minus id="S3.E7.m1.4.4.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1"></minus><ci id="S3.E7.m1.4.4.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E7.m1.4.4.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\displaystyle\boldsymbol{h}_{i}^{(L)}=\sigma(\frac{1}{|\mathcal{N}_{i}|}\sum_{j\in\mathcal{N}_{i}}(W_{\textrm{GCN}}^{(L)}\;\boldsymbol{\hat{h}}_{j}^{(L-1)}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Graph Isomorphism Network (GINE)</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.3" class="ltx_p">GIN <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> is provably as powerful as the Weisfeiler-Lehman graph isomorphism test.
GINE <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> augments GIN by also considering edge features during the message passing:</p>
<table id="A3.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}^{(L)}_{i}=" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.2" xref="S3.Ex1.m1.1.2.cmml"><msubsup id="S3.Ex1.m1.1.2.2" xref="S3.Ex1.m1.1.2.2.cmml"><mi id="S3.Ex1.m1.1.2.2.2.2" xref="S3.Ex1.m1.1.2.2.2.2.cmml">𝒉</mi><mi id="S3.Ex1.m1.1.2.2.3" xref="S3.Ex1.m1.1.2.2.3.cmml">i</mi><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.3.1" xref="S3.Ex1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.Ex1.m1.1.1.1.3.2" xref="S3.Ex1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.1.2.1" xref="S3.Ex1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1.m1.1.2.3" xref="S3.Ex1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.2.cmml" xref="S3.Ex1.m1.1.2"><eq id="S3.Ex1.m1.1.2.1.cmml" xref="S3.Ex1.m1.1.2.1"></eq><apply id="S3.Ex1.m1.1.2.2.cmml" xref="S3.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2">subscript</csymbol><apply id="S3.Ex1.m1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.2.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2">superscript</csymbol><ci id="S3.Ex1.m1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2.2.2">𝒉</ci><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">𝐿</ci></apply><ci id="S3.Ex1.m1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.Ex1.m1.1.2.3.cmml" xref="S3.Ex1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\boldsymbol{h}^{(L)}_{i}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\boldsymbol{\Theta}((1+\epsilon)\boldsymbol{\hat{h}}^{(L-1)}_{i}+" display="inline"><semantics id="S3.Ex1.m2.1a"><mrow id="S3.Ex1.m2.1b"><mi id="S3.Ex1.m2.1.2">𝚯</mi><mrow id="S3.Ex1.m2.1.3"><mo stretchy="false" id="S3.Ex1.m2.1.3.1">(</mo><mrow id="S3.Ex1.m2.1.3.2"><mo stretchy="false" id="S3.Ex1.m2.1.3.2.1">(</mo><mn id="S3.Ex1.m2.1.3.2.2">1</mn><mo id="S3.Ex1.m2.1.3.2.3">+</mo><mi id="S3.Ex1.m2.1.3.2.4">ϵ</mi><mo stretchy="false" id="S3.Ex1.m2.1.3.2.5">)</mo></mrow><msubsup id="S3.Ex1.m2.1.3.3"><mover accent="true" id="S3.Ex1.m2.1.3.3.2.2"><mi id="S3.Ex1.m2.1.3.3.2.2.2">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.Ex1.m2.1.3.3.2.2.1">^</mo></mover><mi id="S3.Ex1.m2.1.3.3.3">i</mi><mrow id="S3.Ex1.m2.1.1.1.1"><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.2">(</mo><mrow id="S3.Ex1.m2.1.1.1.1.1"><mi id="S3.Ex1.m2.1.1.1.1.1.2">L</mi><mo id="S3.Ex1.m2.1.1.1.1.1.1">−</mo><mn id="S3.Ex1.m2.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex1.m2.1.3.4">+</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle\boldsymbol{\Theta}((1+\epsilon)\boldsymbol{\hat{h}}^{(L-1)}_{i}+</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m1.5" class="ltx_math_unparsed" alttext="\displaystyle\sum_{j\in\mathcal{N}(i)}\mathrm{\sigma}(\boldsymbol{\hat{h}}^{(L-1)}_{j}+\boldsymbol{\hat{e}}^{(L-1)}_{j,i}))" display="inline"><semantics id="S3.Ex2.m1.5a"><mrow id="S3.Ex2.m1.5b"><mstyle displaystyle="true" id="S3.Ex2.m1.5.6"><munder id="S3.Ex2.m1.5.6a"><mo movablelimits="false" id="S3.Ex2.m1.5.6.2">∑</mo><mrow id="S3.Ex2.m1.1.1.1"><mi id="S3.Ex2.m1.1.1.1.3">j</mi><mo id="S3.Ex2.m1.1.1.1.2">∈</mo><mrow id="S3.Ex2.m1.1.1.1.4"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.4.2">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.1.1.1.4.1">​</mo><mrow id="S3.Ex2.m1.1.1.1.4.3.2"><mo stretchy="false" id="S3.Ex2.m1.1.1.1.4.3.2.1">(</mo><mi id="S3.Ex2.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.Ex2.m1.1.1.1.4.3.2.2">)</mo></mrow></mrow></mrow></munder></mstyle><mi id="S3.Ex2.m1.5.7">σ</mi><mrow id="S3.Ex2.m1.5.8"><mo stretchy="false" id="S3.Ex2.m1.5.8.1">(</mo><msubsup id="S3.Ex2.m1.5.8.2"><mover accent="true" id="S3.Ex2.m1.5.8.2.2.2"><mi id="S3.Ex2.m1.5.8.2.2.2.2">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.Ex2.m1.5.8.2.2.2.1">^</mo></mover><mi id="S3.Ex2.m1.5.8.2.3">j</mi><mrow id="S3.Ex2.m1.2.2.1.1"><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.2">(</mo><mrow id="S3.Ex2.m1.2.2.1.1.1"><mi id="S3.Ex2.m1.2.2.1.1.1.2">L</mi><mo id="S3.Ex2.m1.2.2.1.1.1.1">−</mo><mn id="S3.Ex2.m1.2.2.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex2.m1.5.8.3">+</mo><msubsup id="S3.Ex2.m1.5.8.4"><mover accent="true" id="S3.Ex2.m1.5.8.4.2.2"><mi id="S3.Ex2.m1.5.8.4.2.2.2">𝒆</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.Ex2.m1.5.8.4.2.2.1">^</mo></mover><mrow id="S3.Ex2.m1.5.5.2.4"><mi id="S3.Ex2.m1.4.4.1.1">j</mi><mo id="S3.Ex2.m1.5.5.2.4.1">,</mo><mi id="S3.Ex2.m1.5.5.2.2">i</mi></mrow><mrow id="S3.Ex2.m1.3.3.1.1"><mo stretchy="false" id="S3.Ex2.m1.3.3.1.1.2">(</mo><mrow id="S3.Ex2.m1.3.3.1.1.1"><mi id="S3.Ex2.m1.3.3.1.1.1.2">L</mi><mo id="S3.Ex2.m1.3.3.1.1.1.1">−</mo><mn id="S3.Ex2.m1.3.3.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex2.m1.3.3.1.1.3">)</mo></mrow></msubsup><mo stretchy="false" id="S3.Ex2.m1.5.8.5">)</mo></mrow><mo stretchy="false" id="S3.Ex2.m1.5.9">)</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.5c">\displaystyle\sum_{j\in\mathcal{N}(i)}\mathrm{\sigma}(\boldsymbol{\hat{h}}^{(L-1)}_{j}+\boldsymbol{\hat{e}}^{(L-1)}_{j,i}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.2" class="ltx_p">where <math id="S3.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi mathvariant="normal" id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\Theta</annotation></semantics></math> denotes expressive functions such as MLPs, and <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\epsilon</annotation></semantics></math> is a scale factor for the emphasis of the central node.</p>
</div>
</section>
<section id="S3.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Graph Attention Network (GAT)</h4>

<div id="S3.SS3.SSS3.p1" class="ltx_para">
<p id="S3.SS3.SSS3.p1.4" class="ltx_p">Different from GIN and GINE, GAT <cite class="ltx_cite ltx_citemacro_cite">Veličković et al. (<a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite> learns to use attention mechanism to weight neighbour nodes differently.
Intuitively, GAT fits more naturally with our Scene Graph QA task, since we want to emphasis different neighbor nodes given different instruction vectors. Specifically, the attention score <math id="S3.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha^{(L)}_{ij}" display="inline"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msubsup id="S3.SS3.SSS3.p1.1.m1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.2.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.2.2.2" xref="S3.SS3.SSS3.p1.1.m1.1.2.2.2.cmml">α</mi><mrow id="S3.SS3.SSS3.p1.1.m1.1.2.3" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.2.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p1.1.m1.1.2.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS3.p1.1.m1.1.2.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p1.1.m1.1.1.1.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.SS3.SSS3.p1.1.m1.1.1.1.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2">subscript</csymbol><apply id="S3.SS3.SSS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2.2.2">𝛼</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1">𝐿</ci></apply><apply id="S3.SS3.SSS3.p1.1.m1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2.3"><times id="S3.SS3.SSS3.p1.1.m1.1.2.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.1"></times><ci id="S3.SS3.SSS3.p1.1.m1.1.2.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.2.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.2.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">\alpha^{(L)}_{ij}</annotation></semantics></math> for message passing from node <math id="S3.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><mi id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><ci id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">j</annotation></semantics></math> to node <math id="S3.SS3.SSS3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><mi id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><ci id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">i</annotation></semantics></math> at <math id="S3.SS3.SSS3.p1.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS3.SSS3.p1.4.m4.1a"><mi id="S3.SS3.SSS3.p1.4.m4.1.1" xref="S3.SS3.SSS3.p1.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m4.1b"><ci id="S3.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m4.1c">L</annotation></semantics></math><sup id="S3.SS3.SSS3.p1.4.1" class="ltx_sup">th</sup> layer is calculated as:</p>
<table id="A3.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{\alpha}^{(L)}_{ij}=" display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.2" xref="S3.E8.m1.1.2.cmml"><msubsup id="S3.E8.m1.1.2.2" xref="S3.E8.m1.1.2.2.cmml"><mi id="S3.E8.m1.1.2.2.2.2" xref="S3.E8.m1.1.2.2.2.2.cmml">𝜶</mi><mrow id="S3.E8.m1.1.2.2.3" xref="S3.E8.m1.1.2.2.3.cmml"><mi id="S3.E8.m1.1.2.2.3.2" xref="S3.E8.m1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.2.2.3.1" xref="S3.E8.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.2.2.3.3" xref="S3.E8.m1.1.2.2.3.3.cmml">j</mi></mrow><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.2.2.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.3.1" xref="S3.E8.m1.1.2.2.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m1.1.2.1" xref="S3.E8.m1.1.2.1.cmml">=</mo><mi id="S3.E8.m1.1.2.3" xref="S3.E8.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.2.cmml" xref="S3.E8.m1.1.2"><eq id="S3.E8.m1.1.2.1.cmml" xref="S3.E8.m1.1.2.1"></eq><apply id="S3.E8.m1.1.2.2.cmml" xref="S3.E8.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.2.2.1.cmml" xref="S3.E8.m1.1.2.2">subscript</csymbol><apply id="S3.E8.m1.1.2.2.2.cmml" xref="S3.E8.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.2.2.2.1.cmml" xref="S3.E8.m1.1.2.2">superscript</csymbol><ci id="S3.E8.m1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.2.2.2.2">𝜶</ci><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐿</ci></apply><apply id="S3.E8.m1.1.2.2.3.cmml" xref="S3.E8.m1.1.2.2.3"><times id="S3.E8.m1.1.2.2.3.1.cmml" xref="S3.E8.m1.1.2.2.3.1"></times><ci id="S3.E8.m1.1.2.2.3.2.cmml" xref="S3.E8.m1.1.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.1.2.2.3.3.cmml" xref="S3.E8.m1.1.2.2.3.3">𝑗</ci></apply></apply><csymbol cd="latexml" id="S3.E8.m1.1.2.3.cmml" xref="S3.E8.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\boldsymbol{\alpha}^{(L)}_{ij}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m2.4" class="ltx_Math" alttext="\displaystyle\mbox{Softmax}_{\mathcal{N}_{i}}(\mbox{MLP}(\boldsymbol{\hat{h}}^{(L-1)}_{i},\boldsymbol{\hat{h}}^{(L-1)}_{j},\boldsymbol{\hat{e}}^{(L-1)}_{ij}))" display="inline"><semantics id="S3.E8.m2.4a"><mrow id="S3.E8.m2.4.4" xref="S3.E8.m2.4.4.cmml"><msub id="S3.E8.m2.4.4.3" xref="S3.E8.m2.4.4.3.cmml"><mtext id="S3.E8.m2.4.4.3.2" xref="S3.E8.m2.4.4.3.2a.cmml">Softmax</mtext><msub id="S3.E8.m2.4.4.3.3" xref="S3.E8.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m2.4.4.3.3.2" xref="S3.E8.m2.4.4.3.3.2.cmml">𝒩</mi><mi id="S3.E8.m2.4.4.3.3.3" xref="S3.E8.m2.4.4.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E8.m2.4.4.2" xref="S3.E8.m2.4.4.2.cmml">​</mo><mrow id="S3.E8.m2.4.4.1.1" xref="S3.E8.m2.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m2.4.4.1.1.2" xref="S3.E8.m2.4.4.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.4.4.1.1.1" xref="S3.E8.m2.4.4.1.1.1.cmml"><mtext id="S3.E8.m2.4.4.1.1.1.5" xref="S3.E8.m2.4.4.1.1.1.5a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m2.4.4.1.1.1.4" xref="S3.E8.m2.4.4.1.1.1.4.cmml">​</mo><mrow id="S3.E8.m2.4.4.1.1.1.3.3" xref="S3.E8.m2.4.4.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E8.m2.4.4.1.1.1.3.3.4" xref="S3.E8.m2.4.4.1.1.1.3.4.cmml">(</mo><msubsup id="S3.E8.m2.4.4.1.1.1.1.1.1" xref="S3.E8.m2.4.4.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.1" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m2.4.4.1.1.1.1.1.1.3" xref="S3.E8.m2.4.4.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.2.cmml">L</mi><mo id="S3.E8.m2.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E8.m2.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m2.4.4.1.1.1.3.3.5" xref="S3.E8.m2.4.4.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E8.m2.4.4.1.1.1.2.2.2" xref="S3.E8.m2.4.4.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.2" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.1" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m2.4.4.1.1.1.2.2.2.3" xref="S3.E8.m2.4.4.1.1.1.2.2.2.3.cmml">j</mi><mrow id="S3.E8.m2.2.2.1.1" xref="S3.E8.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m2.2.2.1.1.2" xref="S3.E8.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.2.2.1.1.1" xref="S3.E8.m2.2.2.1.1.1.cmml"><mi id="S3.E8.m2.2.2.1.1.1.2" xref="S3.E8.m2.2.2.1.1.1.2.cmml">L</mi><mo id="S3.E8.m2.2.2.1.1.1.1" xref="S3.E8.m2.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E8.m2.2.2.1.1.1.3" xref="S3.E8.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m2.2.2.1.1.3" xref="S3.E8.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m2.4.4.1.1.1.3.3.6" xref="S3.E8.m2.4.4.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E8.m2.4.4.1.1.1.3.3.3" xref="S3.E8.m2.4.4.1.1.1.3.3.3.cmml"><mover accent="true" id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.cmml"><mi id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.2" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.2.cmml">𝒆</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.1" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E8.m2.4.4.1.1.1.3.3.3.3" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.cmml"><mi id="S3.E8.m2.4.4.1.1.1.3.3.3.3.2" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m2.4.4.1.1.1.3.3.3.3.1" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E8.m2.4.4.1.1.1.3.3.3.3.3" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.3.cmml">j</mi></mrow><mrow id="S3.E8.m2.3.3.1.1" xref="S3.E8.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m2.3.3.1.1.2" xref="S3.E8.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.3.3.1.1.1" xref="S3.E8.m2.3.3.1.1.1.cmml"><mi id="S3.E8.m2.3.3.1.1.1.2" xref="S3.E8.m2.3.3.1.1.1.2.cmml">L</mi><mo id="S3.E8.m2.3.3.1.1.1.1" xref="S3.E8.m2.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E8.m2.3.3.1.1.1.3" xref="S3.E8.m2.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m2.3.3.1.1.3" xref="S3.E8.m2.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E8.m2.4.4.1.1.1.3.3.7" xref="S3.E8.m2.4.4.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m2.4.4.1.1.3" xref="S3.E8.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.4b"><apply id="S3.E8.m2.4.4.cmml" xref="S3.E8.m2.4.4"><times id="S3.E8.m2.4.4.2.cmml" xref="S3.E8.m2.4.4.2"></times><apply id="S3.E8.m2.4.4.3.cmml" xref="S3.E8.m2.4.4.3"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.3.1.cmml" xref="S3.E8.m2.4.4.3">subscript</csymbol><ci id="S3.E8.m2.4.4.3.2a.cmml" xref="S3.E8.m2.4.4.3.2"><mtext id="S3.E8.m2.4.4.3.2.cmml" xref="S3.E8.m2.4.4.3.2">Softmax</mtext></ci><apply id="S3.E8.m2.4.4.3.3.cmml" xref="S3.E8.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.3.3.1.cmml" xref="S3.E8.m2.4.4.3.3">subscript</csymbol><ci id="S3.E8.m2.4.4.3.3.2.cmml" xref="S3.E8.m2.4.4.3.3.2">𝒩</ci><ci id="S3.E8.m2.4.4.3.3.3.cmml" xref="S3.E8.m2.4.4.3.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m2.4.4.1.1.1.cmml" xref="S3.E8.m2.4.4.1.1"><times id="S3.E8.m2.4.4.1.1.1.4.cmml" xref="S3.E8.m2.4.4.1.1.1.4"></times><ci id="S3.E8.m2.4.4.1.1.1.5a.cmml" xref="S3.E8.m2.4.4.1.1.1.5"><mtext id="S3.E8.m2.4.4.1.1.1.5.cmml" xref="S3.E8.m2.4.4.1.1.1.5">MLP</mtext></ci><vector id="S3.E8.m2.4.4.1.1.1.3.4.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3"><apply id="S3.E8.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2"><ci id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.1">bold-^</ci><ci id="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1.2.2.2">𝒉</ci></apply><apply id="S3.E8.m2.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1"><minus id="S3.E8.m2.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1"></minus><ci id="S3.E8.m2.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E8.m2.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.E8.m2.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E8.m2.4.4.1.1.1.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.2.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.2.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2"><ci id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.1">bold-^</ci><ci id="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2.2.2.2">𝒉</ci></apply><apply id="S3.E8.m2.2.2.1.1.1.cmml" xref="S3.E8.m2.2.2.1.1"><minus id="S3.E8.m2.2.2.1.1.1.1.cmml" xref="S3.E8.m2.2.2.1.1.1.1"></minus><ci id="S3.E8.m2.2.2.1.1.1.2.cmml" xref="S3.E8.m2.2.2.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E8.m2.2.2.1.1.1.3.cmml" xref="S3.E8.m2.2.2.1.1.1.3">1</cn></apply></apply><ci id="S3.E8.m2.4.4.1.1.1.2.2.2.3.cmml" xref="S3.E8.m2.4.4.1.1.1.2.2.2.3">𝑗</ci></apply><apply id="S3.E8.m2.4.4.1.1.1.3.3.3.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.3.3.3.1.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3">subscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.3.3.3.2.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.4.4.1.1.1.3.3.3.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3">superscript</csymbol><apply id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2"><ci id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.1">bold-^</ci><ci id="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.2.2.2">𝒆</ci></apply><apply id="S3.E8.m2.3.3.1.1.1.cmml" xref="S3.E8.m2.3.3.1.1"><minus id="S3.E8.m2.3.3.1.1.1.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1"></minus><ci id="S3.E8.m2.3.3.1.1.1.2.cmml" xref="S3.E8.m2.3.3.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E8.m2.3.3.1.1.1.3.cmml" xref="S3.E8.m2.3.3.1.1.1.3">1</cn></apply></apply><apply id="S3.E8.m2.4.4.1.1.1.3.3.3.3.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3"><times id="S3.E8.m2.4.4.1.1.1.3.3.3.3.1.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.1"></times><ci id="S3.E8.m2.4.4.1.1.1.3.3.3.3.2.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.E8.m2.4.4.1.1.1.3.3.3.3.3.cmml" xref="S3.E8.m2.4.4.1.1.1.3.3.3.3.3">𝑗</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.4c">\displaystyle\mbox{Softmax}_{\mathcal{N}_{i}}(\mbox{MLP}(\boldsymbol{\hat{h}}^{(L-1)}_{i},\boldsymbol{\hat{h}}^{(L-1)}_{j},\boldsymbol{\hat{e}}^{(L-1)}_{ij}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p1.6" class="ltx_p">where <math id="S3.SS3.SSS3.p1.5.m1.1" class="ltx_Math" alttext="\mbox{Softmax}_{\mathcal{N}_{i}}" display="inline"><semantics id="S3.SS3.SSS3.p1.5.m1.1a"><msub id="S3.SS3.SSS3.p1.5.m1.1.1" xref="S3.SS3.SSS3.p1.5.m1.1.1.cmml"><mtext id="S3.SS3.SSS3.p1.5.m1.1.1.2" xref="S3.SS3.SSS3.p1.5.m1.1.1.2a.cmml">Softmax</mtext><msub id="S3.SS3.SSS3.p1.5.m1.1.1.3" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.5.m1.1.1.3.2" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.2.cmml">𝒩</mi><mi id="S3.SS3.SSS3.p1.5.m1.1.1.3.3" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.5.m1.1b"><apply id="S3.SS3.SSS3.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.5.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.5.m1.1.1.2a.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.2"><mtext id="S3.SS3.SSS3.p1.5.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.2">Softmax</mtext></ci><apply id="S3.SS3.SSS3.p1.5.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.5.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.5.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.2">𝒩</ci><ci id="S3.SS3.SSS3.p1.5.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.5.m1.1c">\mbox{Softmax}_{\mathcal{N}_{i}}</annotation></semantics></math> is a normalization to ensure that the attention scores from one node to its neighbor nodes sum to <math id="S3.SS3.SSS3.p1.6.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS3.SSS3.p1.6.m2.1a"><mn id="S3.SS3.SSS3.p1.6.m2.1.1" xref="S3.SS3.SSS3.p1.6.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.6.m2.1b"><cn type="integer" id="S3.SS3.SSS3.p1.6.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.6.m2.1c">1</annotation></semantics></math>.
After calculating the attention scores, we calculate each node’s new representation as a weighted average from its neighbour nodes.</p>
<table id="A3.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{(L)}=\sigma(\sum_{j\in\mathcal{N}_{i}}\boldsymbol{\alpha}^{(L)}_{ij}\;\boldsymbol{W}_{\textrm{GAT}}^{(L)}\;\boldsymbol{\hat{h}}^{(L-1)}_{j})" display="inline"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><msubsup id="S3.E9.m1.5.5.3" xref="S3.E9.m1.5.5.3.cmml"><mi id="S3.E9.m1.5.5.3.2.2" xref="S3.E9.m1.5.5.3.2.2.cmml">𝒉</mi><mi id="S3.E9.m1.5.5.3.2.3" xref="S3.E9.m1.5.5.3.2.3.cmml">i</mi><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.5.5.3.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.3.1" xref="S3.E9.m1.5.5.3.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S3.E9.m1.1.1.1.3.2" xref="S3.E9.m1.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S3.E9.m1.5.5.2" xref="S3.E9.m1.5.5.2.cmml">=</mo><mrow id="S3.E9.m1.5.5.1" xref="S3.E9.m1.5.5.1.cmml"><mi id="S3.E9.m1.5.5.1.3" xref="S3.E9.m1.5.5.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.1.2" xref="S3.E9.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E9.m1.5.5.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.5.5.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E9.m1.5.5.1.1.1.1.1" xref="S3.E9.m1.5.5.1.1.1.1.1.cmml"><munder id="S3.E9.m1.5.5.1.1.1.1.1a" xref="S3.E9.m1.5.5.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.E9.m1.5.5.1.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.1.2.cmml">∑</mo><mrow id="S3.E9.m1.5.5.1.1.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E9.m1.5.5.1.1.1.1.1.3.1" xref="S3.E9.m1.5.5.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S3.E9.m1.5.5.1.1.1.1.1.3.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.5.5.1.1.1.1.1.3.3.2" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.2.cmml">𝒩</mi><mi id="S3.E9.m1.5.5.1.1.1.1.1.3.3.3" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S3.E9.m1.5.5.1.1.1.1.2" xref="S3.E9.m1.5.5.1.1.1.1.2.cmml"><msubsup id="S3.E9.m1.5.5.1.1.1.1.2.2" xref="S3.E9.m1.5.5.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E9.m1.5.5.1.1.1.1.2.2.2.2.cmml">𝜶</mi><mrow id="S3.E9.m1.5.5.1.1.1.1.2.2.3" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.2.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.1.1.1.1.2.2.3.1" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9.m1.5.5.1.1.1.1.2.2.3.3" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.3.cmml">j</mi></mrow><mrow id="S3.E9.m1.2.2.1.3" xref="S3.E9.m1.5.5.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.3.1" xref="S3.E9.m1.5.5.1.1.1.1.2.2.cmml">(</mo><mi id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.1.1.1.1.2.1" xref="S3.E9.m1.5.5.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E9.m1.5.5.1.1.1.1.2.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.3.2.2" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.2.cmml">𝑾</mi><mtext id="S3.E9.m1.5.5.1.1.1.1.2.3.2.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.3a.cmml">GAT</mtext><mrow id="S3.E9.m1.3.3.1.3" xref="S3.E9.m1.5.5.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.3.1" xref="S3.E9.m1.5.5.1.1.1.1.2.3.cmml">(</mo><mi id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S3.E9.m1.3.3.1.3.2" xref="S3.E9.m1.5.5.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.1.1.1.1.2.1a" xref="S3.E9.m1.5.5.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E9.m1.5.5.1.1.1.1.2.4" xref="S3.E9.m1.5.5.1.1.1.1.2.4.cmml"><mover accent="true" id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.cmml"><mi id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.2" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.2.cmml">𝒉</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.1" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.5.5.1.1.1.1.2.4.3" xref="S3.E9.m1.5.5.1.1.1.1.2.4.3.cmml">j</mi><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.1.1.2" xref="S3.E9.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.2.cmml">L</mi><mo id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9.m1.4.4.1.1.3" xref="S3.E9.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S3.E9.m1.5.5.1.1.1.3" xref="S3.E9.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.5b"><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><eq id="S3.E9.m1.5.5.2.cmml" xref="S3.E9.m1.5.5.2"></eq><apply id="S3.E9.m1.5.5.3.cmml" xref="S3.E9.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.3.1.cmml" xref="S3.E9.m1.5.5.3">superscript</csymbol><apply id="S3.E9.m1.5.5.3.2.cmml" xref="S3.E9.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.3.2.1.cmml" xref="S3.E9.m1.5.5.3">subscript</csymbol><ci id="S3.E9.m1.5.5.3.2.2.cmml" xref="S3.E9.m1.5.5.3.2.2">𝒉</ci><ci id="S3.E9.m1.5.5.3.2.3.cmml" xref="S3.E9.m1.5.5.3.2.3">𝑖</ci></apply><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝐿</ci></apply><apply id="S3.E9.m1.5.5.1.cmml" xref="S3.E9.m1.5.5.1"><times id="S3.E9.m1.5.5.1.2.cmml" xref="S3.E9.m1.5.5.1.2"></times><ci id="S3.E9.m1.5.5.1.3.cmml" xref="S3.E9.m1.5.5.1.3">𝜎</ci><apply id="S3.E9.m1.5.5.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1"><apply id="S3.E9.m1.5.5.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1">subscript</csymbol><sum id="S3.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.2"></sum><apply id="S3.E9.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3"><in id="S3.E9.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.1"></in><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.2">𝑗</ci><apply id="S3.E9.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.2">𝒩</ci><ci id="S3.E9.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E9.m1.5.5.1.1.1.1.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2"><times id="S3.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.1"></times><apply id="S3.E9.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.2.2">𝜶</ci><ci id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1.1">𝐿</ci></apply><apply id="S3.E9.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3"><times id="S3.E9.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.1"></times><ci id="S3.E9.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E9.m1.5.5.1.1.1.1.2.2.3.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.3.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.5.5.1.1.1.1.2.3.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.2">𝑾</ci><ci id="S3.E9.m1.5.5.1.1.1.1.2.3.2.3a.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.3"><mtext mathsize="70%" id="S3.E9.m1.5.5.1.1.1.1.2.3.2.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.3.2.3">GAT</mtext></ci></apply><ci id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1.1">𝐿</ci></apply><apply id="S3.E9.m1.5.5.1.1.1.1.2.4.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.4.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4">subscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.2.4.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.1.1.1.1.2.4.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2"><ci id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.1.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.1">bold-^</ci><ci id="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.2.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4.2.2.2">𝒉</ci></apply><apply id="S3.E9.m1.4.4.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1"><minus id="S3.E9.m1.4.4.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1"></minus><ci id="S3.E9.m1.4.4.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.2">𝐿</ci><cn type="integer" id="S3.E9.m1.4.4.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.3">1</cn></apply></apply><ci id="S3.E9.m1.5.5.1.1.1.1.2.4.3.cmml" xref="S3.E9.m1.5.5.1.1.1.1.2.4.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.5c">\displaystyle\boldsymbol{h}_{i}^{(L)}=\sigma(\sum_{j\in\mathcal{N}_{i}}\boldsymbol{\alpha}^{(L)}_{ij}\;\boldsymbol{W}_{\textrm{GAT}}^{(L)}\;\boldsymbol{\hat{h}}^{(L-1)}_{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p1.7" class="ltx_p">where <math id="S3.SS3.SSS3.p1.7.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS3.SSS3.p1.7.m1.1a"><mi id="S3.SS3.SSS3.p1.7.m1.1.1" xref="S3.SS3.SSS3.p1.7.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.7.m1.1b"><ci id="S3.SS3.SSS3.p1.7.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.7.m1.1c">\sigma</annotation></semantics></math> denotes the activation function.
Similar to transformer models, we use multiple attention heads in practice.
In addition, many modern deep learning tool-kits can be incorporated into GNNs, such as batch normalization, dropout, gating mechanism, and residual connections.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Answering Module</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.3" class="ltx_p">After executing the Graph Reasoning module, we obtain the final states of all graph nodes after <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">M</annotation></semantics></math> iterations of message passing <math id="S3.SS4.p1.2.m2.5" class="ltx_Math" alttext="[\boldsymbol{{h}}_{1}^{(M)},...,\boldsymbol{{h}}_{N}^{(M)}]" display="inline"><semantics id="S3.SS4.p1.2.m2.5a"><mrow id="S3.SS4.p1.2.m2.5.5.2" xref="S3.SS4.p1.2.m2.5.5.3.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.5.5.2.3" xref="S3.SS4.p1.2.m2.5.5.3.cmml">[</mo><msubsup id="S3.SS4.p1.2.m2.4.4.1.1" xref="S3.SS4.p1.2.m2.4.4.1.1.cmml"><mi id="S3.SS4.p1.2.m2.4.4.1.1.2.2" xref="S3.SS4.p1.2.m2.4.4.1.1.2.2.cmml">𝒉</mi><mn id="S3.SS4.p1.2.m2.4.4.1.1.2.3" xref="S3.SS4.p1.2.m2.4.4.1.1.2.3.cmml">1</mn><mrow id="S3.SS4.p1.2.m2.1.1.1.3" xref="S3.SS4.p1.2.m2.4.4.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.1.1.1.3.1" xref="S3.SS4.p1.2.m2.4.4.1.1.cmml">(</mo><mi id="S3.SS4.p1.2.m2.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.cmml">M</mi><mo stretchy="false" id="S3.SS4.p1.2.m2.1.1.1.3.2" xref="S3.SS4.p1.2.m2.4.4.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS4.p1.2.m2.5.5.2.4" xref="S3.SS4.p1.2.m2.5.5.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.2.m2.3.3" xref="S3.SS4.p1.2.m2.3.3.cmml">…</mi><mo id="S3.SS4.p1.2.m2.5.5.2.5" xref="S3.SS4.p1.2.m2.5.5.3.cmml">,</mo><msubsup id="S3.SS4.p1.2.m2.5.5.2.2" xref="S3.SS4.p1.2.m2.5.5.2.2.cmml"><mi id="S3.SS4.p1.2.m2.5.5.2.2.2.2" xref="S3.SS4.p1.2.m2.5.5.2.2.2.2.cmml">𝒉</mi><mi id="S3.SS4.p1.2.m2.5.5.2.2.2.3" xref="S3.SS4.p1.2.m2.5.5.2.2.2.3.cmml">N</mi><mrow id="S3.SS4.p1.2.m2.2.2.1.3" xref="S3.SS4.p1.2.m2.5.5.2.2.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.1.3.1" xref="S3.SS4.p1.2.m2.5.5.2.2.cmml">(</mo><mi id="S3.SS4.p1.2.m2.2.2.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.cmml">M</mi><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.1.3.2" xref="S3.SS4.p1.2.m2.5.5.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.SS4.p1.2.m2.5.5.2.6" xref="S3.SS4.p1.2.m2.5.5.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.5b"><list id="S3.SS4.p1.2.m2.5.5.3.cmml" xref="S3.SS4.p1.2.m2.5.5.2"><apply id="S3.SS4.p1.2.m2.4.4.1.1.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.4.4.1.1.1.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1">superscript</csymbol><apply id="S3.SS4.p1.2.m2.4.4.1.1.2.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.4.4.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.4.4.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1.2.2">𝒉</ci><cn type="integer" id="S3.SS4.p1.2.m2.4.4.1.1.2.3.cmml" xref="S3.SS4.p1.2.m2.4.4.1.1.2.3">1</cn></apply><ci id="S3.SS4.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1">𝑀</ci></apply><ci id="S3.SS4.p1.2.m2.3.3.cmml" xref="S3.SS4.p1.2.m2.3.3">…</ci><apply id="S3.SS4.p1.2.m2.5.5.2.2.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.5.5.2.2.1.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2">superscript</csymbol><apply id="S3.SS4.p1.2.m2.5.5.2.2.2.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.5.5.2.2.2.1.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.5.5.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2.2.2">𝒉</ci><ci id="S3.SS4.p1.2.m2.5.5.2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.5.5.2.2.2.3">𝑁</ci></apply><ci id="S3.SS4.p1.2.m2.2.2.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.5c">[\boldsymbol{{h}}_{1}^{(M)},...,\boldsymbol{{h}}_{N}^{(M)}]</annotation></semantics></math>.
We first summarize the final states after message passing, and then predict the answer token with the question summary vector <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">q</annotation></semantics></math>:</p>
<table id="A3.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}=\mbox{Aggregate}([\boldsymbol{{h}}_{1}^{(M)},\boldsymbol{{h}}_{2}^{(M)},...,\boldsymbol{{h}}_{N}^{(M)}])" display="inline"><semantics id="S3.E10.m1.5a"><mrow id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml"><mi id="S3.E10.m1.5.5.3" xref="S3.E10.m1.5.5.3.cmml">𝒉</mi><mo id="S3.E10.m1.5.5.2" xref="S3.E10.m1.5.5.2.cmml">=</mo><mrow id="S3.E10.m1.5.5.1" xref="S3.E10.m1.5.5.1.cmml"><mtext id="S3.E10.m1.5.5.1.3" xref="S3.E10.m1.5.5.1.3a.cmml">Aggregate</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m1.5.5.1.2" xref="S3.E10.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E10.m1.5.5.1.1.1" xref="S3.E10.m1.5.5.1.cmml"><mo stretchy="false" id="S3.E10.m1.5.5.1.1.1.2" xref="S3.E10.m1.5.5.1.cmml">(</mo><mrow id="S3.E10.m1.5.5.1.1.1.1.3" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E10.m1.5.5.1.1.1.1.3.4" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml">[</mo><msubsup id="S3.E10.m1.5.5.1.1.1.1.1.1" xref="S3.E10.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E10.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mn id="S3.E10.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E10.m1.5.5.1.1.1.1.1.1.2.3.cmml">1</mn><mrow id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.3.1" xref="S3.E10.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">M</mi><mo stretchy="false" id="S3.E10.m1.1.1.1.3.2" xref="S3.E10.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E10.m1.5.5.1.1.1.1.3.5" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml">,</mo><msubsup id="S3.E10.m1.5.5.1.1.1.1.2.2" xref="S3.E10.m1.5.5.1.1.1.1.2.2.cmml"><mi id="S3.E10.m1.5.5.1.1.1.1.2.2.2.2" xref="S3.E10.m1.5.5.1.1.1.1.2.2.2.2.cmml">𝒉</mi><mn id="S3.E10.m1.5.5.1.1.1.1.2.2.2.3" xref="S3.E10.m1.5.5.1.1.1.1.2.2.2.3.cmml">2</mn><mrow id="S3.E10.m1.2.2.1.3" xref="S3.E10.m1.5.5.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.3.1" xref="S3.E10.m1.5.5.1.1.1.1.2.2.cmml">(</mo><mi id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml">M</mi><mo stretchy="false" id="S3.E10.m1.2.2.1.3.2" xref="S3.E10.m1.5.5.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E10.m1.5.5.1.1.1.1.3.6" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml">,</mo><mi mathvariant="normal" id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml">…</mi><mo id="S3.E10.m1.5.5.1.1.1.1.3.7" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml">,</mo><msubsup id="S3.E10.m1.5.5.1.1.1.1.3.3" xref="S3.E10.m1.5.5.1.1.1.1.3.3.cmml"><mi id="S3.E10.m1.5.5.1.1.1.1.3.3.2.2" xref="S3.E10.m1.5.5.1.1.1.1.3.3.2.2.cmml">𝒉</mi><mi id="S3.E10.m1.5.5.1.1.1.1.3.3.2.3" xref="S3.E10.m1.5.5.1.1.1.1.3.3.2.3.cmml">N</mi><mrow id="S3.E10.m1.3.3.1.3" xref="S3.E10.m1.5.5.1.1.1.1.3.3.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.3.1" xref="S3.E10.m1.5.5.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml">M</mi><mo stretchy="false" id="S3.E10.m1.3.3.1.3.2" xref="S3.E10.m1.5.5.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E10.m1.5.5.1.1.1.1.3.8" xref="S3.E10.m1.5.5.1.1.1.1.4.cmml">]</mo></mrow><mo stretchy="false" id="S3.E10.m1.5.5.1.1.1.3" xref="S3.E10.m1.5.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.5b"><apply id="S3.E10.m1.5.5.cmml" xref="S3.E10.m1.5.5"><eq id="S3.E10.m1.5.5.2.cmml" xref="S3.E10.m1.5.5.2"></eq><ci id="S3.E10.m1.5.5.3.cmml" xref="S3.E10.m1.5.5.3">𝒉</ci><apply id="S3.E10.m1.5.5.1.cmml" xref="S3.E10.m1.5.5.1"><times id="S3.E10.m1.5.5.1.2.cmml" xref="S3.E10.m1.5.5.1.2"></times><ci id="S3.E10.m1.5.5.1.3a.cmml" xref="S3.E10.m1.5.5.1.3"><mtext id="S3.E10.m1.5.5.1.3.cmml" xref="S3.E10.m1.5.5.1.3">Aggregate</mtext></ci><list id="S3.E10.m1.5.5.1.1.1.1.4.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3"><apply id="S3.E10.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1.2.2">𝒉</ci><cn type="integer" id="S3.E10.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.5.5.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑀</ci></apply><apply id="S3.E10.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E10.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E10.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2.2.2">𝒉</ci><cn type="integer" id="S3.E10.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.5.5.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1.1">𝑀</ci></apply><ci id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.4.4">…</ci><apply id="S3.E10.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E10.m1.5.5.1.1.1.1.3.3.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.1.1.3.3.2.1.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E10.m1.5.5.1.1.1.1.3.3.2.2.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3.2.2">𝒉</ci><ci id="S3.E10.m1.5.5.1.1.1.1.3.3.2.3.cmml" xref="S3.E10.m1.5.5.1.1.1.1.3.3.2.3">𝑁</ci></apply><ci id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1.1">𝑀</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.5c">\displaystyle\boldsymbol{h}=\mbox{Aggregate}([\boldsymbol{{h}}_{1}^{(M)},\boldsymbol{{h}}_{2}^{(M)},...,\boldsymbol{{h}}_{N}^{(M)}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11.m1.3" class="ltx_Math" alttext="\displaystyle\boldsymbol{y}=\mbox{Softmax}(\mbox{MLP}(\boldsymbol{h},\boldsymbol{q}))" display="inline"><semantics id="S3.E11.m1.3a"><mrow id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml"><mi id="S3.E11.m1.3.3.3" xref="S3.E11.m1.3.3.3.cmml">𝒚</mi><mo id="S3.E11.m1.3.3.2" xref="S3.E11.m1.3.3.2.cmml">=</mo><mrow id="S3.E11.m1.3.3.1" xref="S3.E11.m1.3.3.1.cmml"><mtext id="S3.E11.m1.3.3.1.3" xref="S3.E11.m1.3.3.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.2" xref="S3.E11.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E11.m1.3.3.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.3.3.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.cmml"><mtext id="S3.E11.m1.3.3.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.2a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.3.2" xref="S3.E11.m1.3.3.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.1.3.2.1" xref="S3.E11.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝒉</mi><mo id="S3.E11.m1.3.3.1.1.1.1.3.2.2" xref="S3.E11.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">𝒒</mi><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.1.3.2.3" xref="S3.E11.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.3b"><apply id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3"><eq id="S3.E11.m1.3.3.2.cmml" xref="S3.E11.m1.3.3.2"></eq><ci id="S3.E11.m1.3.3.3.cmml" xref="S3.E11.m1.3.3.3">𝒚</ci><apply id="S3.E11.m1.3.3.1.cmml" xref="S3.E11.m1.3.3.1"><times id="S3.E11.m1.3.3.1.2.cmml" xref="S3.E11.m1.3.3.1.2"></times><ci id="S3.E11.m1.3.3.1.3a.cmml" xref="S3.E11.m1.3.3.1.3"><mtext id="S3.E11.m1.3.3.1.3.cmml" xref="S3.E11.m1.3.3.1.3">Softmax</mtext></ci><apply id="S3.E11.m1.3.3.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1"><times id="S3.E11.m1.3.3.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1"></times><ci id="S3.E11.m1.3.3.1.1.1.1.2a.cmml" xref="S3.E11.m1.3.3.1.1.1.1.2"><mtext id="S3.E11.m1.3.3.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.2">MLP</mtext></ci><interval closure="open" id="S3.E11.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝒉</ci><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝒒</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.3c">\displaystyle\boldsymbol{y}=\mbox{Softmax}(\mbox{MLP}(\boldsymbol{h},\boldsymbol{q}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.4" class="ltx_p">where <math id="S3.SS4.p1.4.m1.1" class="ltx_Math" alttext="\boldsymbol{y}" display="inline"><semantics id="S3.SS4.p1.4.m1.1a"><mi id="S3.SS4.p1.4.m1.1.1" xref="S3.SS4.p1.4.m1.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m1.1b"><ci id="S3.SS4.p1.4.m1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m1.1c">\boldsymbol{y}</annotation></semantics></math> is the predicted answer.
We note that GraphVQA does not require any explicit supervision on how to solve the question step-by-step, and we only supervise on the final answer prediction.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<div id="S3.T1.2" class="ltx_block ltx_pruned_first">
<div id="S3.T1.2.p2" class="ltx_para ltx_noindent ltx_align_center">
<div id="S3.T1.2.p2.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:141.7pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.1pt,1.6pt) scale(0.97713,0.97713) ;">
<p id="S3.T1.2.p2.1.1" class="ltx_p"><span id="S3.T1.2.p2.1.1.1" class="ltx_text">
<span id="S3.T1.2.p2.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:443.8pt;height:145pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S3.T1.2.p2.1.1.1.1.1" class="ltx_p"><span id="S3.T1.2.p2.1.1.1.1.1.1" class="ltx_text">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Binary</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Open</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Consistency</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Validity</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">Plausibility</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.8.1" class="ltx_text ltx_font_bold">Distribution</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.1.9.1" class="ltx_text ltx_font_bold">Accuracy</span></span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">Baseline1</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">GCN</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">86.84</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">84.63</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">90.21</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">95.51</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">94.44</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">0.13</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.2.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">85.70</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">Baseline2</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">LCGN</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">90.57</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">88.43</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">93.88</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">95.40</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">93.89</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">0.16</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.3.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">88.43</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">Ablation1</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">Only Questions</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">61.90</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">22.69</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">68.68</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">96.39</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">87.30</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">0.17</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.4.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">41.07</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" style="padding-left:1.7pt;padding-right:1.7pt;">Ablation2</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" style="padding-left:1.7pt;padding-right:1.7pt;">Only Scene Graphs</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">21.86</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">17.54</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">46.98</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">36.89</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">32.63</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">7.22</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.5.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">19.63</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">Proposed1</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">GraphVQA-GCN</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">92.11</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">88.37</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">95.44</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">95.5</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">94.4</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">0.12</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.6.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">90.18</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" style="padding-left:1.7pt;padding-right:1.7pt;">Proposed2</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right" style="padding-left:1.7pt;padding-right:1.7pt;">GraphVQA-GINE</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">92.36</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">88.56</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">94.79</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">95.44</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">94.39</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">0.13</span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.7.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.7pt;padding-right:1.7pt;">90.38</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8" class="ltx_tr">
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.1.1" class="ltx_text ltx_font_bold">Proposed3</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.2.1" class="ltx_text ltx_font_bold">GraphVQA-GAT</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.3.1" class="ltx_text ltx_font_bold">96.30</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.4.1" class="ltx_text ltx_font_bold">93.37</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.5.1" class="ltx_text ltx_font_bold">98.37</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.6.1" class="ltx_text ltx_font_bold">95.55</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.7.1" class="ltx_text ltx_font_bold">95.15</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.8.1" class="ltx_text ltx_font_bold">0.07</span></span>
<span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="S3.T1.2.p2.1.1.1.1.1.1.1.8.9.1" class="ltx_text ltx_font_bold">94.78</span></span></span>
</span></span></span>
</span></span></span></p>
</span></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_block">Table 1: </span>
Evaluation Results on GQA.
All numbers are in percentages.
The lower the better for distribution.
</figcaption>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Setup</h5>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">We evaluate our GraphVQA framework on the GQA dataset <cite class="ltx_cite ltx_citemacro_cite">Hudson and Manning (<a href="#bib.bib8" title="" class="ltx_ref">2019a</a>)</cite> which contains 110K scene graphs, 1.5M questions, and over 1000 different answer tokens.
We use the official train/validation split of GQA. Since the scene graphs of the test set are not publicly available, we use validation split as test set.
We set the number of instructions <math id="S4.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="M=5" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">M</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1"><eq id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑀</ci><cn type="integer" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">M=5</annotation></semantics></math>.
More dataset and training details are included in Appendix <a href="#A3" title="Appendix C Implementation Details ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Models and Metrics</h5>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px2.p1.1" class="ltx_p">We evaluate three instantiations of GraphVQA: GraphVQA-GCN, GraphVQA-GINE, GraphVQA-GAT. We compare with the state-of-the-art model LCGN <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>. We discuss LCGN in appendix <a href="#A2.SS3" title="B.3 Brief Introduction of LCGN ‣ Appendix B Additional Results ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.3</span></a>.
We also compare with a simple GCN without instruction vector concatenation discussed in <math id="S4.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\S" display="inline"><semantics id="S4.SS0.SSS0.Px2.p1.1.m1.1a"><mi mathvariant="normal" id="S4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.1.m1.1c">\S</annotation></semantics></math> <a href="#S3.SS3" title="3.3 Graph Reasoning Module ‣ 3 GraphVQA Framework ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> to study the importance of language guidance.
We report the standard evaluation metrics defined in <cite class="ltx_cite ltx_citemacro_citet">Hudson and Manning (<a href="#bib.bib8" title="" class="ltx_ref">2019a</a>)</cite> such as accuracy and consistency.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results</h5>

<div id="S4.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px3.p1.1" class="ltx_p">The first take-away message is that GraphVQA outperforms the state-of-the-art approach LCGN, even with the simplest GraphVQA-GCN. Besides, GraphVQA-GAT outperforms LCGN by a large margin (88.43% vs. 94.78% accuracy), highlighting the benefits of incorporating recent advances from graph machine learning.
The second take-away message is that conditioning on instruction vectors is important. Removing such conditioning drops performance (GCN vs. GraphVQA-GCN, 85.7% vs. 90.18%). The third take-away message is that attention mechanism is important for Scene Graph QA, as GraphVQA-GAT also outperforms both GraphVQA-GCN and GraphVQA-GINE by a large margin (94.78% vs. 90.38%),
even though GINE is provably more expressive than GAT <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2104.10283/assets/x2.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="220" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Accuracy breakdown on question semantic types.
GraphVQA-GAT achieves significantly higher accuracy in relationship questions (95.53%).
</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2104.10283/assets/figures/acc_step_new.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="293" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Accuracy breakdown on question word count. Num denotes the number of questions of each length. GraphVQA-GAT shows significant better performance for long question answering tasks.
</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Analysis</h5>

<div id="S4.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px4.p1.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ Results ‣ 4 Experiments ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the accuracy breakdown on question semantic types. We found that GraphVQA-GAT achieves significantly higher accuracy in relationship questions (95.53%). This shows the strength in the attention mechanism in modeling the relationships in scene graphs.</p>
</div>
<div id="S4.SS0.SSS0.Px4.p2" class="ltx_para">
<p id="S4.SS0.SSS0.Px4.p2.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ Results ‣ 4 Experiments ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the accuracy breakdown on question word count. As expected, longer questions are harder to answer by all models. In addition, we found that as questions become longer, the accuracy GraphVQA-GAT deteriorates drops than other methods, showing that GraphVQA-GAT is better at answering long questions.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we present GraphVQA to support question answering on scene graphs. GraphVQA translates and executes a natural language question as multiple iterations of message using graph neural networks.
We explore the design space of GraphVQA framework, and found that GraphVQA-GAT (Graph Attention Network) is the best design.
GraphVQA-GAT outperforms the state-of-the-art model by a large margin (88.43% vs. 94.78%).
Our results suggest the potential benefits of revisiting existed Vision   +  Language multimodal models from the perspective of graph machine learning.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to sincerely thank NAACL-HLT 2021 MAI-Workshop program committee for their review efforts and helpful feedback.
We would also like to extend our gratitude to Jingjing Tian and the teaching staff of Stanford CS 224W for their valuable feedback.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. (2016)</span>
<span class="ltx_bibblock">
Aishwarya Agrawal, Dhruv Batra, and Devi Parikh. 2016.

</span>
<span class="ltx_bibblock">Analyzing the behavior of visual question answering models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pages 1955–1960. The Association for
Computational Linguistics.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amizadeh et al. (2020)</span>
<span class="ltx_bibblock">
Saeed Amizadeh, Hamid Palangi, Alex Polozov, Yichen Huang, and Kazuhito
Koishida. 2020.

</span>
<span class="ltx_bibblock">Neuro-symbolic visual reasoning: Disentangling "visual" from
"reasoning".

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICML</em>, volume 119 of <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning
Research</em>, pages 279–290. PMLR.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2016)</span>
<span class="ltx_bibblock">
Peter Anderson, Basura Fernando, Mark Johnson, and Stephen Gould. 2016.

</span>
<span class="ltx_bibblock">SPICE: semantic propositional image caption evaluation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ECCV (5)</em>, volume 9909 of <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">Lecture Notes in
Computer Science</em>, pages 382–398. Springer.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al. (2016)</span>
<span class="ltx_bibblock">
Abhishek Das, Harsh Agrawal, Larry Zitnick, Devi Parikh, and Dhruv Batra. 2016.

</span>
<span class="ltx_bibblock">Human attention in visual question answering: Do humans and deep
networks look at the same regions?

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pages 932–937. The Association for Computational
Linguistics.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2019)</span>
<span class="ltx_bibblock">
Ronghang Hu, Anna Rohrbach, Trevor Darrell, and Kate Saenko. 2019.

</span>
<span class="ltx_bibblock">Language-conditioned graph networks for relational reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pages 10293–10302. IEEE.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2020)</span>
<span class="ltx_bibblock">
Weihua Hu, Bowen Liu, Joseph Gomes, Marinka Zitnik, Percy Liang, Vijay S.
Pande, and Jure Leskovec. 2020.

</span>
<span class="ltx_bibblock">Strategies for pre-training graph neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ICLR</em>. OpenReview.net.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2018)</span>
<span class="ltx_bibblock">
De-An Huang, Shyamal Buch, Lucio M. Dery, Animesh Garg, Li Fei-Fei, and
Juan Carlos Niebles. 2018.

</span>
<span class="ltx_bibblock">Finding "it": Weakly-supervised reference-aware visual grounding in
instructional videos.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 5948–5957. IEEE Computer Society.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019a)</span>
<span class="ltx_bibblock">
Drew A. Hudson and Christopher D. Manning. 2019a.

</span>
<span class="ltx_bibblock">GQA: A new dataset for real-world visual reasoning and
compositional question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 6700–6709. Computer Vision Foundation /
IEEE.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019b)</span>
<span class="ltx_bibblock">
Drew A. Hudson and Christopher D. Manning. 2019b.

</span>
<span class="ltx_bibblock">Learning by abstraction: The neural state machine.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, pages 5901–5914.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2018)</span>
<span class="ltx_bibblock">
Justin Johnson, Agrim Gupta, and Li Fei-Fei. 2018.

</span>
<span class="ltx_bibblock">Image generation from scene graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 1219–1228. IEEE Computer Society.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2015)</span>
<span class="ltx_bibblock">
Justin Johnson, Ranjay Krishna, Michael Stark, Li-Jia Li, David A. Shamma,
Michael S. Bernstein, and Fei-Fei Li. 2015.

</span>
<span class="ltx_bibblock">Image retrieval using scene graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 3668–3678. IEEE Computer Society.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kipf and Welling (2017)</span>
<span class="ltx_bibblock">
Thomas N. Kipf and Max Welling. 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1609.02907" title="" class="ltx_ref ltx_href">Semi-supervised
classification with graph convolutional networks</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krishna et al. (2017a)</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A. Shamma,
Michael S. Bernstein, and Li Fei-Fei. 2017a.

</span>
<span class="ltx_bibblock">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Int. J. Comput. Vis.</em>, 123(1):32–73.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krishna et al. (2017b)</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A. Shamma,
Michael S. Bernstein, and Li Fei-Fei. 2017b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1007/s11263-016-0981-7" title="" class="ltx_ref ltx_href">Visual genome:
Connecting language and vision using crowdsourced dense image annotations</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 123(1):32–73.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Linjie Li, Zhe Gan, Yu Cheng, and Jingjing Liu. 2019.

</span>
<span class="ltx_bibblock">Relation-aware graph attention network for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pages 10312–10321. IEEE.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Ruiyu Li, Makarand Tapaswi, Renjie Liao, Jiaya Jia, Raquel Urtasun, and Sanja
Fidler. 2017.

</span>
<span class="ltx_bibblock">Situation recognition with graph neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pages 4183–4192. IEEE Computer Society.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020a)</span>
<span class="ltx_bibblock">
Weixin Liang, Feiyang Niu, Aishwarya N. Reganti, Govind Thattai, and
Gökhan Tür. 2020a.

</span>
<span class="ltx_bibblock">LRTA: A transparent neural-symbolic reasoning framework with
modular supervision for visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2011.10731.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020b)</span>
<span class="ltx_bibblock">
Weixin Liang, Youzhi Tian, Chengcai Chen, and Zhou Yu. 2020b.

</span>
<span class="ltx_bibblock">MOSS: end-to-end dialog system framework with modular supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, pages 8327–8335. AAAI Press.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang and Zou (2020)</span>
<span class="ltx_bibblock">
Weixin Liang and James Zou. 2020.

</span>
<span class="ltx_bibblock">Neural group testing to accelerate deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2011.10704.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020c)</span>
<span class="ltx_bibblock">
Weixin Liang, James Zou, and Zhou Yu. 2020c.

</span>
<span class="ltx_bibblock">ALICE: active learning with contrastive natural language
explanations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">EMNLP (1)</em>, pages 4380–4391. Association for
Computational Linguistics.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020d)</span>
<span class="ltx_bibblock">
Weixin Liang, James Zou, and Zhou Yu. 2020d.

</span>
<span class="ltx_bibblock">Beyond user self-reported likert scale ratings: A comparison model
for automatic dialog evaluation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ACL</em>, pages 1363–1374. Association for Computational
Linguistics.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mudrakarta et al. (2018)</span>
<span class="ltx_bibblock">
Pramod Kaushik Mudrakarta, Ankur Taly, Mukund Sundararajan, and Kedar
Dhamdhere. 2018.

</span>
<span class="ltx_bibblock">Did the model understand the question?

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ACL (1)</em>, pages 1896–1906. Association for
Computational Linguistics.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington et al. (2014)</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher D. Manning. 2014.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pages 1532–1543. ACL.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Santoro et al. (2017)</span>
<span class="ltx_bibblock">
Adam Santoro, David Raposo, David G. T. Barrett, Mateusz Malinowski, Razvan
Pascanu, Peter W. Battaglia, and Tim Lillicrap. 2017.

</span>
<span class="ltx_bibblock">A simple neural network module for relational reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, pages 4967–4976.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković et al. (2018)</span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro
Liò, and Yoshua Bengio. 2018.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://arxiv.org/abs/1710.10903" title="" class="ltx_ref ltx_href">Graph attention networks</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Keyulu Xu, Weihua Hu, Jure Leskovec, and Stefanie Jegelka. 2019.

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ICLR</em>. OpenReview.net.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Visual Question Answering</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">VQA requires an interplay of visual perception with reasoning about the question semantics grounded in perception.
The predominant approach to visual question answering (VQA) relies on encoding the image and question with a “black-box” neural encoder, where each image is usually represented as a bag of object features, where each feature describes the local appearance within a bounding box detected by the object detection backbone.
However, representing images as collections of objects fails to capture relationships which are crucial for visual question answering.
Recent study has further demonstrated some unsettling behaviours of those models: they tend to ignore important question terms <cite class="ltx_cite ltx_citemacro_cite">Mudrakarta et al. (<a href="#bib.bib22" title="" class="ltx_ref">2018</a>)</cite>, look at wrong image regions <cite class="ltx_cite ltx_citemacro_cite">Das et al. (<a href="#bib.bib4" title="" class="ltx_ref">2016</a>)</cite>, or undesirably adhere to superficial or even potentially misleading statistical associations <cite class="ltx_cite ltx_citemacro_cite">Agrawal et al. (<a href="#bib.bib1" title="" class="ltx_ref">2016</a>)</cite>.
In addition, it has been shown that recent advances are primarily driven by perception improvements (e.g. object detection) rather than reasoning <cite class="ltx_cite ltx_citemacro_cite">Amizadeh et al. (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Scene Graph Question Answering</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">Although there are many research efforts in scene graph generation, using scene graphs for visual question answering remains relatively under-explored <cite class="ltx_cite ltx_citemacro_cite">Hudson and Manning (<a href="#bib.bib9" title="" class="ltx_ref">2019b</a>); Hu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>); Li et al. (<a href="#bib.bib15" title="" class="ltx_ref">2019</a>); Liang et al. (<a href="#bib.bib17" title="" class="ltx_ref">2020a</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citet">Hudson and Manning (<a href="#bib.bib9" title="" class="ltx_ref">2019b</a>)</cite> propose a task-specific graph traversal framework with neural networks. The framework requires specifying the detail ontology of the dataset (e.g., color: red, blue,…; material: wooden, metallic), and thus is not directly generalizable.
Other attempts in graph based VQA <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>); Li et al. (<a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>
mostly explore attention mechanism on fully-connected graphs, thereby failing to capture the important structural information of the scene graphs.</p>
</div>
<figure id="A1.F5" class="ltx_figure"><img src="/html/2104.10283/assets/figures/gnn.jpg" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="344" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
Structure of 2 Layer Graph Neural Network
</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Results</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Additional Performances Analysis</h3>

<figure id="A2.F6" class="ltx_figure"><img src="/html/2104.10283/assets/figures/structural.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="335" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
Accuracy breakdown on question structural types.
GraphVQA-GAT achieves significantly higher accuracy in all types except for verify.
</figcaption>
</figure>
<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">Figure <a href="#A2.F6" title="Figure 6 ‣ B.1 Additional Performances Analysis ‣ Appendix B Additional Results ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> provides another set of accuracy breakdown result on question structural types. We found that GraphVQA-GAT achieves the best for all types of questions except for the verify types.
Specifically, GraphVQA-GAT outperforms significantly than other methods on answering queries, comparing among objects and making choices. This intuitively matches the principle of attention mechanism and again shows its advantages in modeling structural information in scene graphs.</p>
</div>
<figure id="A2.T2" class="ltx_table">
<p id="A2.T2.1" class="ltx_p ltx_align_center"><span id="A2.T2.1.1" class="ltx_text">
<span id="A2.T2.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:370.2pt;height:162pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A2.T2.1.1.1.1" class="ltx_p"><span id="A2.T2.1.1.1.1.1" class="ltx_text">
<span id="A2.T2.1.1.1.1.1.1" class="ltx_tabular ltx_align_top">
<span id="A2.T2.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.1.1" class="ltx_td ltx_align_right ltx_border_t"><span id="A2.T2.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Scene Graphs Statistics</span></span>
<span id="A2.T2.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T2.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Validation data</span></span>
<span id="A2.T2.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T2.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Train data</span></span>
<span id="A2.T2.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T2.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">All</span></span></span>
<span id="A2.T2.1.1.1.1.1.1.2" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.2.1" class="ltx_td ltx_align_right ltx_border_t"><span id="A2.T2.1.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">Total Number of Graphs</span></span>
<span id="A2.T2.1.1.1.1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">10,696</span>
<span id="A2.T2.1.1.1.1.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">74,942</span>
<span id="A2.T2.1.1.1.1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">85,638</span></span>
<span id="A2.T2.1.1.1.1.1.1.3" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.3.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.3.1.1" class="ltx_text ltx_font_bold">Total Number of Nodes</span></span>
<span id="A2.T2.1.1.1.1.1.1.3.2" class="ltx_td ltx_align_center">174,331</span>
<span id="A2.T2.1.1.1.1.1.1.3.3" class="ltx_td ltx_align_center">1,231,134</span>
<span id="A2.T2.1.1.1.1.1.1.3.4" class="ltx_td ltx_align_center">1,405,465</span></span>
<span id="A2.T2.1.1.1.1.1.1.4" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.4.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.4.1.1" class="ltx_text ltx_font_bold">Total Number of Edges</span></span>
<span id="A2.T2.1.1.1.1.1.1.4.2" class="ltx_td ltx_align_center">534,889</span>
<span id="A2.T2.1.1.1.1.1.1.4.3" class="ltx_td ltx_align_center">3,795,907</span>
<span id="A2.T2.1.1.1.1.1.1.4.4" class="ltx_td ltx_align_center">4,330,796</span></span>
<span id="A2.T2.1.1.1.1.1.1.5" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.5.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.5.1.1" class="ltx_text ltx_font_bold">Average Number of Nodes per Graph</span></span>
<span id="A2.T2.1.1.1.1.1.1.5.2" class="ltx_td ltx_align_center">16</span>
<span id="A2.T2.1.1.1.1.1.1.5.3" class="ltx_td ltx_align_center">16</span>
<span id="A2.T2.1.1.1.1.1.1.5.4" class="ltx_td ltx_align_center">16</span></span>
<span id="A2.T2.1.1.1.1.1.1.6" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.6.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.6.1.1" class="ltx_text ltx_font_bold">Average Number of Edges per Graph</span></span>
<span id="A2.T2.1.1.1.1.1.1.6.2" class="ltx_td ltx_align_center">50</span>
<span id="A2.T2.1.1.1.1.1.1.6.3" class="ltx_td ltx_align_center">51</span>
<span id="A2.T2.1.1.1.1.1.1.6.4" class="ltx_td ltx_align_center">51</span></span>
<span id="A2.T2.1.1.1.1.1.1.7" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.7.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.7.1.1" class="ltx_text ltx_font_bold">Total Number of Node Types</span></span>
<span id="A2.T2.1.1.1.1.1.1.7.2" class="ltx_td ltx_align_center">1,536</span>
<span id="A2.T2.1.1.1.1.1.1.7.3" class="ltx_td ltx_align_center">1,702</span>
<span id="A2.T2.1.1.1.1.1.1.7.4" class="ltx_td ltx_align_center">1,703</span></span>
<span id="A2.T2.1.1.1.1.1.1.8" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.8.1" class="ltx_td ltx_align_right"><span id="A2.T2.1.1.1.1.1.1.8.1.1" class="ltx_text ltx_font_bold">Total Number of Edge Types</span></span>
<span id="A2.T2.1.1.1.1.1.1.8.2" class="ltx_td ltx_align_center">295</span>
<span id="A2.T2.1.1.1.1.1.1.8.3" class="ltx_td ltx_align_center">310</span>
<span id="A2.T2.1.1.1.1.1.1.8.4" class="ltx_td ltx_align_center">310</span></span>
<span id="A2.T2.1.1.1.1.1.1.9" class="ltx_tr">
<span id="A2.T2.1.1.1.1.1.1.9.1" class="ltx_td ltx_align_right ltx_border_b"><span id="A2.T2.1.1.1.1.1.1.9.1.1" class="ltx_text ltx_font_bold">Total Number of Attributes Types</span></span>
<span id="A2.T2.1.1.1.1.1.1.9.2" class="ltx_td ltx_align_center ltx_border_b">603</span>
<span id="A2.T2.1.1.1.1.1.1.9.3" class="ltx_td ltx_align_center ltx_border_b">617</span>
<span id="A2.T2.1.1.1.1.1.1.9.4" class="ltx_td ltx_align_center ltx_border_b">617</span></span>
</span></span></span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>
Scene Graphs Statistics of the GQA Dataset
</figcaption>
</figure>
<figure id="A2.T3" class="ltx_table">
<div id="A2.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:74.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-35.9pt,7.7pt) scale(0.82847,0.82847) ;">
<p id="A2.T3.1.1" class="ltx_p"><span id="A2.T3.1.1.1" class="ltx_text">
<span id="A2.T3.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:418.7pt;height:90pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A2.T3.1.1.1.1.1" class="ltx_p"><span id="A2.T3.1.1.1.1.1.1" class="ltx_text">
<span id="A2.T3.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_top">
<span id="A2.T3.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A2.T3.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_border_t"></span>
<span id="A2.T3.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="A2.T3.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Level of Classification</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="A2.T3.1.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Structural</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="A2.T3.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Semantic</span></span></span>
<span id="A2.T3.1.1.1.1.1.1.1.2" class="ltx_tr">
<span id="A2.T3.1.1.1.1.1.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="A2.T3.1.1.1.1.1.1.1.2.1.1" class="ltx_text ltx_font_bold">Is there apples in the picture?</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.2.2" class="ltx_td ltx_align_left ltx_border_t">node</span>
<span id="A2.T3.1.1.1.1.1.1.1.2.3" class="ltx_td ltx_align_left ltx_border_t">verify</span>
<span id="A2.T3.1.1.1.1.1.1.1.2.4" class="ltx_td ltx_align_left ltx_border_t">object</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.3" class="ltx_tr">
<span id="A2.T3.1.1.1.1.1.1.1.3.1" class="ltx_td ltx_align_left"><span id="A2.T3.1.1.1.1.1.1.1.3.1.1" class="ltx_text ltx_font_bold">What color is the apple?</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.3.2" class="ltx_td ltx_align_left">node</span>
<span id="A2.T3.1.1.1.1.1.1.1.3.3" class="ltx_td ltx_align_left">query</span>
<span id="A2.T3.1.1.1.1.1.1.1.3.4" class="ltx_td ltx_align_left">attribute</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.4" class="ltx_tr">
<span id="A2.T3.1.1.1.1.1.1.1.4.1" class="ltx_td ltx_align_left"><span id="A2.T3.1.1.1.1.1.1.1.4.1.1" class="ltx_text ltx_font_bold">Is the cat to the left or right of the flower?</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.4.2" class="ltx_td ltx_align_left">edge type</span>
<span id="A2.T3.1.1.1.1.1.1.1.4.3" class="ltx_td ltx_align_left">choose</span>
<span id="A2.T3.1.1.1.1.1.1.1.4.4" class="ltx_td ltx_align_left">relation</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.5" class="ltx_tr">
<span id="A2.T3.1.1.1.1.1.1.1.5.1" class="ltx_td ltx_align_left ltx_border_b"><span id="A2.T3.1.1.1.1.1.1.1.5.1.1" class="ltx_text ltx_font_bold">Is it sunny or cloudy?</span></span>
<span id="A2.T3.1.1.1.1.1.1.1.5.2" class="ltx_td ltx_align_left ltx_border_b">graph</span>
<span id="A2.T3.1.1.1.1.1.1.1.5.3" class="ltx_td ltx_align_left ltx_border_b">query</span>
<span id="A2.T3.1.1.1.1.1.1.1.5.4" class="ltx_td ltx_align_left ltx_border_b">global</span></span>
</span></span></span>
</span></span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Typical types of questions
</figcaption>
</figure>
<figure id="A2.T4" class="ltx_table">
<div id="A2.T4.2" class="ltx_block ltx_pruned_first">
<div id="A2.T4.2.p2" class="ltx_para ltx_noindent ltx_align_center">
<div id="A2.T4.2.p2.1" class="ltx_inline-block ltx_transformed_outer" style="width:346.9pt;height:31pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.7pt,2.5pt) scale(0.86228,0.86228) ;">
<p id="A2.T4.2.p2.1.1" class="ltx_p"><span id="A2.T4.2.p2.1.1.1" class="ltx_text">
<span id="A2.T4.2.p2.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:402.3pt;height:36pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="A2.T4.2.p2.1.1.1.1.1" class="ltx_p"><span id="A2.T4.2.p2.1.1.1.1.1.1" class="ltx_text">
<span id="A2.T4.2.p2.1.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1" class="ltx_tr">
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Binary</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Open</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">Consistency</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">Validity</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">Plausibility</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">Distribution</span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;"><span id="A2.T4.2.p2.1.1.1.1.1.1.1.1.8.1" class="ltx_text ltx_font_bold">Accuracy</span></span></span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2" class="ltx_tr">
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">GraphGQA-GINE-2</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">86.83</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">83.85</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">89.8</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">95.54</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">94.25</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">0.16</span>
<span id="A2.T4.2.p2.1.1.1.1.1.1.1.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" style="padding-left:1.7pt;padding-right:1.7pt;">85.04</span></span>
</span></span></span>
</span></span></span></p>
</span></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_block">Table 4: </span>
Ablation Study Results for 2 layer GraphVQA-GINE. All numbers are in percentages.
The lower the better for distribution.
</figcaption>
</div>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Expressive Ability Analysis of GraphVQA-GINE</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.6" class="ltx_p">As mentioned in Section <a href="#S3.SS3.SSS1" title="3.3.1 Graph Convolution Networks (GCN) ‣ 3.3 Graph Reasoning Module ‣ 3 GraphVQA Framework ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a> and Section <a href="#S3.SS3.SSS2" title="3.3.2 Graph Isomorphism Network (GINE) ‣ 3.3 Graph Reasoning Module ‣ 3 GraphVQA Framework ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>, a expressive function <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mi mathvariant="normal" id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><ci id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">\Theta</annotation></semantics></math> is used in GINE layer. When <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mi mathvariant="normal" id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><ci id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">\Theta</annotation></semantics></math> is just a single layer MLP, the corresponding GIN/GINE structure will be very similar to the GCN structure. Since in Section <a href="#S4" title="4 Experiments ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> we implemented <math id="A2.SS2.p1.3.m3.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.3.m3.1a"><mi mathvariant="normal" id="A2.SS2.p1.3.m3.1.1" xref="A2.SS2.p1.3.m3.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.1b"><ci id="A2.SS2.p1.3.m3.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.1c">\Theta</annotation></semantics></math> as a single layer MLP, the performance of GraphVQA-GCN and GraphVQA-GINE stays at very similar stage. As GIN and GINE are now very popular as basic components for large-scale graph neural network design, one may ask if using <math id="A2.SS2.p1.4.m4.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.4.m4.1a"><mi mathvariant="normal" id="A2.SS2.p1.4.m4.1.1" xref="A2.SS2.p1.4.m4.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.4.m4.1b"><ci id="A2.SS2.p1.4.m4.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.4.m4.1c">\Theta</annotation></semantics></math> with more powerful expression ability will help the performance. The short answer is no. We provide a simple ablation study on different choice of <math id="A2.SS2.p1.5.m5.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.5.m5.1a"><mi mathvariant="normal" id="A2.SS2.p1.5.m5.1.1" xref="A2.SS2.p1.5.m5.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.5.m5.1b"><ci id="A2.SS2.p1.5.m5.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.5.m5.1c">\Theta</annotation></semantics></math>, using a two layer MLP-style network with (FC, ReLU, FC, ReLU, BN) structure. Table <a href="#A2.T4" title="Table 4 ‣ B.1 Additional Performances Analysis ‣ Appendix B Additional Results ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that the result of GraphVQA-GINE-2 degrades to the worst. One possible reason is that the scale for each scen graph is generally small, therefore the expression ability might already be enough for a single layer MLP, and use a more complex <math id="A2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="A2.SS2.p1.6.m6.1a"><mi mathvariant="normal" id="A2.SS2.p1.6.m6.1.1" xref="A2.SS2.p1.6.m6.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.6.m6.1b"><ci id="A2.SS2.p1.6.m6.1.1.cmml" xref="A2.SS2.p1.6.m6.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.6.m6.1c">\Theta</annotation></semantics></math> may leads to harder optimization problems, and thus leads to a downgrade of the performance. Such guess could possibly be further investigated and evaluated in our future work.
In addition, the scene graph-based VQA as in this work might offer an opportunity for further accelerating the real world image-based applications <cite class="ltx_cite ltx_citemacro_cite">Liang and Zou (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>. Exploring such deployment benefits is another direction of future work.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Brief Introduction of LCGN</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.4" class="ltx_p">Language-Conditioned Graph Networks (LCGN) <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite> updates node representations recurrently using the same single layer graph neural network. Given a set of instruction vectors <math id="A2.SS3.p1.1.m1.3" class="ltx_Math" alttext="[\boldsymbol{i}_{1},\dots,\boldsymbol{i}_{M}]" display="inline"><semantics id="A2.SS3.p1.1.m1.3a"><mrow id="A2.SS3.p1.1.m1.3.3.2" xref="A2.SS3.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="A2.SS3.p1.1.m1.3.3.2.3" xref="A2.SS3.p1.1.m1.3.3.3.cmml">[</mo><msub id="A2.SS3.p1.1.m1.2.2.1.1" xref="A2.SS3.p1.1.m1.2.2.1.1.cmml"><mi id="A2.SS3.p1.1.m1.2.2.1.1.2" xref="A2.SS3.p1.1.m1.2.2.1.1.2.cmml">𝒊</mi><mn id="A2.SS3.p1.1.m1.2.2.1.1.3" xref="A2.SS3.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="A2.SS3.p1.1.m1.3.3.2.4" xref="A2.SS3.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="A2.SS3.p1.1.m1.3.3.2.5" xref="A2.SS3.p1.1.m1.3.3.3.cmml">,</mo><msub id="A2.SS3.p1.1.m1.3.3.2.2" xref="A2.SS3.p1.1.m1.3.3.2.2.cmml"><mi id="A2.SS3.p1.1.m1.3.3.2.2.2" xref="A2.SS3.p1.1.m1.3.3.2.2.2.cmml">𝒊</mi><mi id="A2.SS3.p1.1.m1.3.3.2.2.3" xref="A2.SS3.p1.1.m1.3.3.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="A2.SS3.p1.1.m1.3.3.2.6" xref="A2.SS3.p1.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.3b"><list id="A2.SS3.p1.1.m1.3.3.3.cmml" xref="A2.SS3.p1.1.m1.3.3.2"><apply id="A2.SS3.p1.1.m1.2.2.1.1.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="A2.SS3.p1.1.m1.2.2.1.1.2.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1.2">𝒊</ci><cn type="integer" id="A2.SS3.p1.1.m1.2.2.1.1.3.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1">…</ci><apply id="A2.SS3.p1.1.m1.3.3.2.2.cmml" xref="A2.SS3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A2.SS3.p1.1.m1.3.3.2.2.1.cmml" xref="A2.SS3.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="A2.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="A2.SS3.p1.1.m1.3.3.2.2.2">𝒊</ci><ci id="A2.SS3.p1.1.m1.3.3.2.2.3.cmml" xref="A2.SS3.p1.1.m1.3.3.2.2.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.3c">[\boldsymbol{i}_{1},\dots,\boldsymbol{i}_{M}]</annotation></semantics></math>, LCGN uses a single layer attention to convert them into context representations <math id="A2.SS3.p1.2.m2.3" class="ltx_Math" alttext="[\boldsymbol{c}_{1},\dots,\boldsymbol{c}_{M}]" display="inline"><semantics id="A2.SS3.p1.2.m2.3a"><mrow id="A2.SS3.p1.2.m2.3.3.2" xref="A2.SS3.p1.2.m2.3.3.3.cmml"><mo stretchy="false" id="A2.SS3.p1.2.m2.3.3.2.3" xref="A2.SS3.p1.2.m2.3.3.3.cmml">[</mo><msub id="A2.SS3.p1.2.m2.2.2.1.1" xref="A2.SS3.p1.2.m2.2.2.1.1.cmml"><mi id="A2.SS3.p1.2.m2.2.2.1.1.2" xref="A2.SS3.p1.2.m2.2.2.1.1.2.cmml">𝒄</mi><mn id="A2.SS3.p1.2.m2.2.2.1.1.3" xref="A2.SS3.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="A2.SS3.p1.2.m2.3.3.2.4" xref="A2.SS3.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS3.p1.2.m2.1.1" xref="A2.SS3.p1.2.m2.1.1.cmml">…</mi><mo id="A2.SS3.p1.2.m2.3.3.2.5" xref="A2.SS3.p1.2.m2.3.3.3.cmml">,</mo><msub id="A2.SS3.p1.2.m2.3.3.2.2" xref="A2.SS3.p1.2.m2.3.3.2.2.cmml"><mi id="A2.SS3.p1.2.m2.3.3.2.2.2" xref="A2.SS3.p1.2.m2.3.3.2.2.2.cmml">𝒄</mi><mi id="A2.SS3.p1.2.m2.3.3.2.2.3" xref="A2.SS3.p1.2.m2.3.3.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="A2.SS3.p1.2.m2.3.3.2.6" xref="A2.SS3.p1.2.m2.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.2.m2.3b"><list id="A2.SS3.p1.2.m2.3.3.3.cmml" xref="A2.SS3.p1.2.m2.3.3.2"><apply id="A2.SS3.p1.2.m2.2.2.1.1.cmml" xref="A2.SS3.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="A2.SS3.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="A2.SS3.p1.2.m2.2.2.1.1.2.cmml" xref="A2.SS3.p1.2.m2.2.2.1.1.2">𝒄</ci><cn type="integer" id="A2.SS3.p1.2.m2.2.2.1.1.3.cmml" xref="A2.SS3.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="A2.SS3.p1.2.m2.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1">…</ci><apply id="A2.SS3.p1.2.m2.3.3.2.2.cmml" xref="A2.SS3.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="A2.SS3.p1.2.m2.3.3.2.2.1.cmml" xref="A2.SS3.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="A2.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="A2.SS3.p1.2.m2.3.3.2.2.2">𝒄</ci><ci id="A2.SS3.p1.2.m2.3.3.2.2.3.cmml" xref="A2.SS3.p1.2.m2.3.3.2.2.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.2.m2.3c">[\boldsymbol{c}_{1},\dots,\boldsymbol{c}_{M}]</annotation></semantics></math>. Then,
given a set of node representations <math id="A2.SS3.p1.3.m3.7" class="ltx_Math" alttext="[\boldsymbol{x}_{loc,1},\dots,\boldsymbol{x}_{loc,n}]" display="inline"><semantics id="A2.SS3.p1.3.m3.7a"><mrow id="A2.SS3.p1.3.m3.7.7.2" xref="A2.SS3.p1.3.m3.7.7.3.cmml"><mo stretchy="false" id="A2.SS3.p1.3.m3.7.7.2.3" xref="A2.SS3.p1.3.m3.7.7.3.cmml">[</mo><msub id="A2.SS3.p1.3.m3.6.6.1.1" xref="A2.SS3.p1.3.m3.6.6.1.1.cmml"><mi id="A2.SS3.p1.3.m3.6.6.1.1.2" xref="A2.SS3.p1.3.m3.6.6.1.1.2.cmml">𝒙</mi><mrow id="A2.SS3.p1.3.m3.2.2.2.2" xref="A2.SS3.p1.3.m3.2.2.2.3.cmml"><mrow id="A2.SS3.p1.3.m3.2.2.2.2.1" xref="A2.SS3.p1.3.m3.2.2.2.2.1.cmml"><mi id="A2.SS3.p1.3.m3.2.2.2.2.1.2" xref="A2.SS3.p1.3.m3.2.2.2.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.3.m3.2.2.2.2.1.1" xref="A2.SS3.p1.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.3.m3.2.2.2.2.1.3" xref="A2.SS3.p1.3.m3.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.3.m3.2.2.2.2.1.1a" xref="A2.SS3.p1.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.3.m3.2.2.2.2.1.4" xref="A2.SS3.p1.3.m3.2.2.2.2.1.4.cmml">c</mi></mrow><mo id="A2.SS3.p1.3.m3.2.2.2.2.2" xref="A2.SS3.p1.3.m3.2.2.2.3.cmml">,</mo><mn id="A2.SS3.p1.3.m3.1.1.1.1" xref="A2.SS3.p1.3.m3.1.1.1.1.cmml">1</mn></mrow></msub><mo id="A2.SS3.p1.3.m3.7.7.2.4" xref="A2.SS3.p1.3.m3.7.7.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS3.p1.3.m3.5.5" xref="A2.SS3.p1.3.m3.5.5.cmml">…</mi><mo id="A2.SS3.p1.3.m3.7.7.2.5" xref="A2.SS3.p1.3.m3.7.7.3.cmml">,</mo><msub id="A2.SS3.p1.3.m3.7.7.2.2" xref="A2.SS3.p1.3.m3.7.7.2.2.cmml"><mi id="A2.SS3.p1.3.m3.7.7.2.2.2" xref="A2.SS3.p1.3.m3.7.7.2.2.2.cmml">𝒙</mi><mrow id="A2.SS3.p1.3.m3.4.4.2.2" xref="A2.SS3.p1.3.m3.4.4.2.3.cmml"><mrow id="A2.SS3.p1.3.m3.4.4.2.2.1" xref="A2.SS3.p1.3.m3.4.4.2.2.1.cmml"><mi id="A2.SS3.p1.3.m3.4.4.2.2.1.2" xref="A2.SS3.p1.3.m3.4.4.2.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.3.m3.4.4.2.2.1.1" xref="A2.SS3.p1.3.m3.4.4.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.3.m3.4.4.2.2.1.3" xref="A2.SS3.p1.3.m3.4.4.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.3.m3.4.4.2.2.1.1a" xref="A2.SS3.p1.3.m3.4.4.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.3.m3.4.4.2.2.1.4" xref="A2.SS3.p1.3.m3.4.4.2.2.1.4.cmml">c</mi></mrow><mo id="A2.SS3.p1.3.m3.4.4.2.2.2" xref="A2.SS3.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="A2.SS3.p1.3.m3.3.3.1.1" xref="A2.SS3.p1.3.m3.3.3.1.1.cmml">n</mi></mrow></msub><mo stretchy="false" id="A2.SS3.p1.3.m3.7.7.2.6" xref="A2.SS3.p1.3.m3.7.7.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.3.m3.7b"><list id="A2.SS3.p1.3.m3.7.7.3.cmml" xref="A2.SS3.p1.3.m3.7.7.2"><apply id="A2.SS3.p1.3.m3.6.6.1.1.cmml" xref="A2.SS3.p1.3.m3.6.6.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.3.m3.6.6.1.1.1.cmml" xref="A2.SS3.p1.3.m3.6.6.1.1">subscript</csymbol><ci id="A2.SS3.p1.3.m3.6.6.1.1.2.cmml" xref="A2.SS3.p1.3.m3.6.6.1.1.2">𝒙</ci><list id="A2.SS3.p1.3.m3.2.2.2.3.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2"><apply id="A2.SS3.p1.3.m3.2.2.2.2.1.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2.1"><times id="A2.SS3.p1.3.m3.2.2.2.2.1.1.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2.1.1"></times><ci id="A2.SS3.p1.3.m3.2.2.2.2.1.2.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2.1.2">𝑙</ci><ci id="A2.SS3.p1.3.m3.2.2.2.2.1.3.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2.1.3">𝑜</ci><ci id="A2.SS3.p1.3.m3.2.2.2.2.1.4.cmml" xref="A2.SS3.p1.3.m3.2.2.2.2.1.4">𝑐</ci></apply><cn type="integer" id="A2.SS3.p1.3.m3.1.1.1.1.cmml" xref="A2.SS3.p1.3.m3.1.1.1.1">1</cn></list></apply><ci id="A2.SS3.p1.3.m3.5.5.cmml" xref="A2.SS3.p1.3.m3.5.5">…</ci><apply id="A2.SS3.p1.3.m3.7.7.2.2.cmml" xref="A2.SS3.p1.3.m3.7.7.2.2"><csymbol cd="ambiguous" id="A2.SS3.p1.3.m3.7.7.2.2.1.cmml" xref="A2.SS3.p1.3.m3.7.7.2.2">subscript</csymbol><ci id="A2.SS3.p1.3.m3.7.7.2.2.2.cmml" xref="A2.SS3.p1.3.m3.7.7.2.2.2">𝒙</ci><list id="A2.SS3.p1.3.m3.4.4.2.3.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2"><apply id="A2.SS3.p1.3.m3.4.4.2.2.1.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2.1"><times id="A2.SS3.p1.3.m3.4.4.2.2.1.1.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2.1.1"></times><ci id="A2.SS3.p1.3.m3.4.4.2.2.1.2.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2.1.2">𝑙</ci><ci id="A2.SS3.p1.3.m3.4.4.2.2.1.3.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2.1.3">𝑜</ci><ci id="A2.SS3.p1.3.m3.4.4.2.2.1.4.cmml" xref="A2.SS3.p1.3.m3.4.4.2.2.1.4">𝑐</ci></apply><ci id="A2.SS3.p1.3.m3.3.3.1.1.cmml" xref="A2.SS3.p1.3.m3.3.3.1.1">𝑛</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.3.m3.7c">[\boldsymbol{x}_{loc,1},\dots,\boldsymbol{x}_{loc,n}]</annotation></semantics></math> , LCGN first randomly initialize another set of context representations <math id="A2.SS3.p1.4.m4.7" class="ltx_Math" alttext="[\boldsymbol{x}_{ctx,1},\dots,\boldsymbol{x}_{ctx,n}]" display="inline"><semantics id="A2.SS3.p1.4.m4.7a"><mrow id="A2.SS3.p1.4.m4.7.7.2" xref="A2.SS3.p1.4.m4.7.7.3.cmml"><mo stretchy="false" id="A2.SS3.p1.4.m4.7.7.2.3" xref="A2.SS3.p1.4.m4.7.7.3.cmml">[</mo><msub id="A2.SS3.p1.4.m4.6.6.1.1" xref="A2.SS3.p1.4.m4.6.6.1.1.cmml"><mi id="A2.SS3.p1.4.m4.6.6.1.1.2" xref="A2.SS3.p1.4.m4.6.6.1.1.2.cmml">𝒙</mi><mrow id="A2.SS3.p1.4.m4.2.2.2.2" xref="A2.SS3.p1.4.m4.2.2.2.3.cmml"><mrow id="A2.SS3.p1.4.m4.2.2.2.2.1" xref="A2.SS3.p1.4.m4.2.2.2.2.1.cmml"><mi id="A2.SS3.p1.4.m4.2.2.2.2.1.2" xref="A2.SS3.p1.4.m4.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.2.2.2.2.1.1" xref="A2.SS3.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.2.2.2.2.1.3" xref="A2.SS3.p1.4.m4.2.2.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.2.2.2.2.1.1a" xref="A2.SS3.p1.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.2.2.2.2.1.4" xref="A2.SS3.p1.4.m4.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="A2.SS3.p1.4.m4.2.2.2.2.2" xref="A2.SS3.p1.4.m4.2.2.2.3.cmml">,</mo><mn id="A2.SS3.p1.4.m4.1.1.1.1" xref="A2.SS3.p1.4.m4.1.1.1.1.cmml">1</mn></mrow></msub><mo id="A2.SS3.p1.4.m4.7.7.2.4" xref="A2.SS3.p1.4.m4.7.7.3.cmml">,</mo><mi mathvariant="normal" id="A2.SS3.p1.4.m4.5.5" xref="A2.SS3.p1.4.m4.5.5.cmml">…</mi><mo id="A2.SS3.p1.4.m4.7.7.2.5" xref="A2.SS3.p1.4.m4.7.7.3.cmml">,</mo><msub id="A2.SS3.p1.4.m4.7.7.2.2" xref="A2.SS3.p1.4.m4.7.7.2.2.cmml"><mi id="A2.SS3.p1.4.m4.7.7.2.2.2" xref="A2.SS3.p1.4.m4.7.7.2.2.2.cmml">𝒙</mi><mrow id="A2.SS3.p1.4.m4.4.4.2.2" xref="A2.SS3.p1.4.m4.4.4.2.3.cmml"><mrow id="A2.SS3.p1.4.m4.4.4.2.2.1" xref="A2.SS3.p1.4.m4.4.4.2.2.1.cmml"><mi id="A2.SS3.p1.4.m4.4.4.2.2.1.2" xref="A2.SS3.p1.4.m4.4.4.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.4.4.2.2.1.1" xref="A2.SS3.p1.4.m4.4.4.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.4.4.2.2.1.3" xref="A2.SS3.p1.4.m4.4.4.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.4.m4.4.4.2.2.1.1a" xref="A2.SS3.p1.4.m4.4.4.2.2.1.1.cmml">​</mo><mi id="A2.SS3.p1.4.m4.4.4.2.2.1.4" xref="A2.SS3.p1.4.m4.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="A2.SS3.p1.4.m4.4.4.2.2.2" xref="A2.SS3.p1.4.m4.4.4.2.3.cmml">,</mo><mi id="A2.SS3.p1.4.m4.3.3.1.1" xref="A2.SS3.p1.4.m4.3.3.1.1.cmml">n</mi></mrow></msub><mo stretchy="false" id="A2.SS3.p1.4.m4.7.7.2.6" xref="A2.SS3.p1.4.m4.7.7.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.4.m4.7b"><list id="A2.SS3.p1.4.m4.7.7.3.cmml" xref="A2.SS3.p1.4.m4.7.7.2"><apply id="A2.SS3.p1.4.m4.6.6.1.1.cmml" xref="A2.SS3.p1.4.m4.6.6.1.1"><csymbol cd="ambiguous" id="A2.SS3.p1.4.m4.6.6.1.1.1.cmml" xref="A2.SS3.p1.4.m4.6.6.1.1">subscript</csymbol><ci id="A2.SS3.p1.4.m4.6.6.1.1.2.cmml" xref="A2.SS3.p1.4.m4.6.6.1.1.2">𝒙</ci><list id="A2.SS3.p1.4.m4.2.2.2.3.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2"><apply id="A2.SS3.p1.4.m4.2.2.2.2.1.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2.1"><times id="A2.SS3.p1.4.m4.2.2.2.2.1.1.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2.1.1"></times><ci id="A2.SS3.p1.4.m4.2.2.2.2.1.2.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2.1.2">𝑐</ci><ci id="A2.SS3.p1.4.m4.2.2.2.2.1.3.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2.1.3">𝑡</ci><ci id="A2.SS3.p1.4.m4.2.2.2.2.1.4.cmml" xref="A2.SS3.p1.4.m4.2.2.2.2.1.4">𝑥</ci></apply><cn type="integer" id="A2.SS3.p1.4.m4.1.1.1.1.cmml" xref="A2.SS3.p1.4.m4.1.1.1.1">1</cn></list></apply><ci id="A2.SS3.p1.4.m4.5.5.cmml" xref="A2.SS3.p1.4.m4.5.5">…</ci><apply id="A2.SS3.p1.4.m4.7.7.2.2.cmml" xref="A2.SS3.p1.4.m4.7.7.2.2"><csymbol cd="ambiguous" id="A2.SS3.p1.4.m4.7.7.2.2.1.cmml" xref="A2.SS3.p1.4.m4.7.7.2.2">subscript</csymbol><ci id="A2.SS3.p1.4.m4.7.7.2.2.2.cmml" xref="A2.SS3.p1.4.m4.7.7.2.2.2">𝒙</ci><list id="A2.SS3.p1.4.m4.4.4.2.3.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2"><apply id="A2.SS3.p1.4.m4.4.4.2.2.1.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2.1"><times id="A2.SS3.p1.4.m4.4.4.2.2.1.1.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2.1.1"></times><ci id="A2.SS3.p1.4.m4.4.4.2.2.1.2.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2.1.2">𝑐</ci><ci id="A2.SS3.p1.4.m4.4.4.2.2.1.3.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2.1.3">𝑡</ci><ci id="A2.SS3.p1.4.m4.4.4.2.2.1.4.cmml" xref="A2.SS3.p1.4.m4.4.4.2.2.1.4">𝑥</ci></apply><ci id="A2.SS3.p1.4.m4.3.3.1.1.cmml" xref="A2.SS3.p1.4.m4.3.3.1.1">𝑛</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.4.m4.7c">[\boldsymbol{x}_{ctx,1},\dots,\boldsymbol{x}_{ctx,n}]</annotation></semantics></math>, and then use them to concatenate with node representations to form initial local features, i.e,</p>
<table id="A2.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E12.m1.15" class="ltx_Math" alttext="\tilde{\boldsymbol{x}}_{t,i}=[\boldsymbol{x}_{loc,i},\boldsymbol{x}_{ctx,i,t-1},W_{1}\boldsymbol{x}_{loc,i}\circ W_{2}\boldsymbol{x}_{ctx,i,t-1}]" display="block"><semantics id="A2.E12.m1.15a"><mrow id="A2.E12.m1.15.15" xref="A2.E12.m1.15.15.cmml"><msub id="A2.E12.m1.15.15.5" xref="A2.E12.m1.15.15.5.cmml"><mover accent="true" id="A2.E12.m1.15.15.5.2" xref="A2.E12.m1.15.15.5.2.cmml"><mi id="A2.E12.m1.15.15.5.2.2" xref="A2.E12.m1.15.15.5.2.2.cmml">𝒙</mi><mo id="A2.E12.m1.15.15.5.2.1" xref="A2.E12.m1.15.15.5.2.1.cmml">~</mo></mover><mrow id="A2.E12.m1.2.2.2.4" xref="A2.E12.m1.2.2.2.3.cmml"><mi id="A2.E12.m1.1.1.1.1" xref="A2.E12.m1.1.1.1.1.cmml">t</mi><mo id="A2.E12.m1.2.2.2.4.1" xref="A2.E12.m1.2.2.2.3.cmml">,</mo><mi id="A2.E12.m1.2.2.2.2" xref="A2.E12.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A2.E12.m1.15.15.4" xref="A2.E12.m1.15.15.4.cmml">=</mo><mrow id="A2.E12.m1.15.15.3.3" xref="A2.E12.m1.15.15.3.4.cmml"><mo stretchy="false" id="A2.E12.m1.15.15.3.3.4" xref="A2.E12.m1.15.15.3.4.cmml">[</mo><msub id="A2.E12.m1.13.13.1.1.1" xref="A2.E12.m1.13.13.1.1.1.cmml"><mi id="A2.E12.m1.13.13.1.1.1.2" xref="A2.E12.m1.13.13.1.1.1.2.cmml">𝒙</mi><mrow id="A2.E12.m1.4.4.2.2" xref="A2.E12.m1.4.4.2.3.cmml"><mrow id="A2.E12.m1.4.4.2.2.1" xref="A2.E12.m1.4.4.2.2.1.cmml"><mi id="A2.E12.m1.4.4.2.2.1.2" xref="A2.E12.m1.4.4.2.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.4.4.2.2.1.1" xref="A2.E12.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.4.4.2.2.1.3" xref="A2.E12.m1.4.4.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.4.4.2.2.1.1a" xref="A2.E12.m1.4.4.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.4.4.2.2.1.4" xref="A2.E12.m1.4.4.2.2.1.4.cmml">c</mi></mrow><mo id="A2.E12.m1.4.4.2.2.2" xref="A2.E12.m1.4.4.2.3.cmml">,</mo><mi id="A2.E12.m1.3.3.1.1" xref="A2.E12.m1.3.3.1.1.cmml">i</mi></mrow></msub><mo id="A2.E12.m1.15.15.3.3.5" xref="A2.E12.m1.15.15.3.4.cmml">,</mo><msub id="A2.E12.m1.14.14.2.2.2" xref="A2.E12.m1.14.14.2.2.2.cmml"><mi id="A2.E12.m1.14.14.2.2.2.2" xref="A2.E12.m1.14.14.2.2.2.2.cmml">𝒙</mi><mrow id="A2.E12.m1.7.7.3.3" xref="A2.E12.m1.7.7.3.4.cmml"><mrow id="A2.E12.m1.6.6.2.2.1" xref="A2.E12.m1.6.6.2.2.1.cmml"><mi id="A2.E12.m1.6.6.2.2.1.2" xref="A2.E12.m1.6.6.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.6.6.2.2.1.1" xref="A2.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.6.6.2.2.1.3" xref="A2.E12.m1.6.6.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.6.6.2.2.1.1a" xref="A2.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.6.6.2.2.1.4" xref="A2.E12.m1.6.6.2.2.1.4.cmml">x</mi></mrow><mo id="A2.E12.m1.7.7.3.3.3" xref="A2.E12.m1.7.7.3.4.cmml">,</mo><mi id="A2.E12.m1.5.5.1.1" xref="A2.E12.m1.5.5.1.1.cmml">i</mi><mo id="A2.E12.m1.7.7.3.3.4" xref="A2.E12.m1.7.7.3.4.cmml">,</mo><mrow id="A2.E12.m1.7.7.3.3.2" xref="A2.E12.m1.7.7.3.3.2.cmml"><mi id="A2.E12.m1.7.7.3.3.2.2" xref="A2.E12.m1.7.7.3.3.2.2.cmml">t</mi><mo id="A2.E12.m1.7.7.3.3.2.1" xref="A2.E12.m1.7.7.3.3.2.1.cmml">−</mo><mn id="A2.E12.m1.7.7.3.3.2.3" xref="A2.E12.m1.7.7.3.3.2.3.cmml">1</mn></mrow></mrow></msub><mo id="A2.E12.m1.15.15.3.3.6" xref="A2.E12.m1.15.15.3.4.cmml">,</mo><mrow id="A2.E12.m1.15.15.3.3.3" xref="A2.E12.m1.15.15.3.3.3.cmml"><mrow id="A2.E12.m1.15.15.3.3.3.2" xref="A2.E12.m1.15.15.3.3.3.2.cmml"><mrow id="A2.E12.m1.15.15.3.3.3.2.2" xref="A2.E12.m1.15.15.3.3.3.2.2.cmml"><msub id="A2.E12.m1.15.15.3.3.3.2.2.2" xref="A2.E12.m1.15.15.3.3.3.2.2.2.cmml"><mi id="A2.E12.m1.15.15.3.3.3.2.2.2.2" xref="A2.E12.m1.15.15.3.3.3.2.2.2.2.cmml">W</mi><mn id="A2.E12.m1.15.15.3.3.3.2.2.2.3" xref="A2.E12.m1.15.15.3.3.3.2.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="A2.E12.m1.15.15.3.3.3.2.2.1" xref="A2.E12.m1.15.15.3.3.3.2.2.1.cmml">​</mo><msub id="A2.E12.m1.15.15.3.3.3.2.2.3" xref="A2.E12.m1.15.15.3.3.3.2.2.3.cmml"><mi id="A2.E12.m1.15.15.3.3.3.2.2.3.2" xref="A2.E12.m1.15.15.3.3.3.2.2.3.2.cmml">𝒙</mi><mrow id="A2.E12.m1.9.9.2.2" xref="A2.E12.m1.9.9.2.3.cmml"><mrow id="A2.E12.m1.9.9.2.2.1" xref="A2.E12.m1.9.9.2.2.1.cmml"><mi id="A2.E12.m1.9.9.2.2.1.2" xref="A2.E12.m1.9.9.2.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.9.9.2.2.1.1" xref="A2.E12.m1.9.9.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.9.9.2.2.1.3" xref="A2.E12.m1.9.9.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.9.9.2.2.1.1a" xref="A2.E12.m1.9.9.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.9.9.2.2.1.4" xref="A2.E12.m1.9.9.2.2.1.4.cmml">c</mi></mrow><mo id="A2.E12.m1.9.9.2.2.2" xref="A2.E12.m1.9.9.2.3.cmml">,</mo><mi id="A2.E12.m1.8.8.1.1" xref="A2.E12.m1.8.8.1.1.cmml">i</mi></mrow></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="A2.E12.m1.15.15.3.3.3.2.1" xref="A2.E12.m1.15.15.3.3.3.2.1.cmml">∘</mo><msub id="A2.E12.m1.15.15.3.3.3.2.3" xref="A2.E12.m1.15.15.3.3.3.2.3.cmml"><mi id="A2.E12.m1.15.15.3.3.3.2.3.2" xref="A2.E12.m1.15.15.3.3.3.2.3.2.cmml">W</mi><mn id="A2.E12.m1.15.15.3.3.3.2.3.3" xref="A2.E12.m1.15.15.3.3.3.2.3.3.cmml">2</mn></msub></mrow><mo lspace="0em" rspace="0em" id="A2.E12.m1.15.15.3.3.3.1" xref="A2.E12.m1.15.15.3.3.3.1.cmml">​</mo><msub id="A2.E12.m1.15.15.3.3.3.3" xref="A2.E12.m1.15.15.3.3.3.3.cmml"><mi id="A2.E12.m1.15.15.3.3.3.3.2" xref="A2.E12.m1.15.15.3.3.3.3.2.cmml">𝒙</mi><mrow id="A2.E12.m1.12.12.3.3" xref="A2.E12.m1.12.12.3.4.cmml"><mrow id="A2.E12.m1.11.11.2.2.1" xref="A2.E12.m1.11.11.2.2.1.cmml"><mi id="A2.E12.m1.11.11.2.2.1.2" xref="A2.E12.m1.11.11.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.11.11.2.2.1.1" xref="A2.E12.m1.11.11.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.11.11.2.2.1.3" xref="A2.E12.m1.11.11.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E12.m1.11.11.2.2.1.1a" xref="A2.E12.m1.11.11.2.2.1.1.cmml">​</mo><mi id="A2.E12.m1.11.11.2.2.1.4" xref="A2.E12.m1.11.11.2.2.1.4.cmml">x</mi></mrow><mo id="A2.E12.m1.12.12.3.3.3" xref="A2.E12.m1.12.12.3.4.cmml">,</mo><mi id="A2.E12.m1.10.10.1.1" xref="A2.E12.m1.10.10.1.1.cmml">i</mi><mo id="A2.E12.m1.12.12.3.3.4" xref="A2.E12.m1.12.12.3.4.cmml">,</mo><mrow id="A2.E12.m1.12.12.3.3.2" xref="A2.E12.m1.12.12.3.3.2.cmml"><mi id="A2.E12.m1.12.12.3.3.2.2" xref="A2.E12.m1.12.12.3.3.2.2.cmml">t</mi><mo id="A2.E12.m1.12.12.3.3.2.1" xref="A2.E12.m1.12.12.3.3.2.1.cmml">−</mo><mn id="A2.E12.m1.12.12.3.3.2.3" xref="A2.E12.m1.12.12.3.3.2.3.cmml">1</mn></mrow></mrow></msub></mrow><mo stretchy="false" id="A2.E12.m1.15.15.3.3.7" xref="A2.E12.m1.15.15.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E12.m1.15b"><apply id="A2.E12.m1.15.15.cmml" xref="A2.E12.m1.15.15"><eq id="A2.E12.m1.15.15.4.cmml" xref="A2.E12.m1.15.15.4"></eq><apply id="A2.E12.m1.15.15.5.cmml" xref="A2.E12.m1.15.15.5"><csymbol cd="ambiguous" id="A2.E12.m1.15.15.5.1.cmml" xref="A2.E12.m1.15.15.5">subscript</csymbol><apply id="A2.E12.m1.15.15.5.2.cmml" xref="A2.E12.m1.15.15.5.2"><ci id="A2.E12.m1.15.15.5.2.1.cmml" xref="A2.E12.m1.15.15.5.2.1">~</ci><ci id="A2.E12.m1.15.15.5.2.2.cmml" xref="A2.E12.m1.15.15.5.2.2">𝒙</ci></apply><list id="A2.E12.m1.2.2.2.3.cmml" xref="A2.E12.m1.2.2.2.4"><ci id="A2.E12.m1.1.1.1.1.cmml" xref="A2.E12.m1.1.1.1.1">𝑡</ci><ci id="A2.E12.m1.2.2.2.2.cmml" xref="A2.E12.m1.2.2.2.2">𝑖</ci></list></apply><list id="A2.E12.m1.15.15.3.4.cmml" xref="A2.E12.m1.15.15.3.3"><apply id="A2.E12.m1.13.13.1.1.1.cmml" xref="A2.E12.m1.13.13.1.1.1"><csymbol cd="ambiguous" id="A2.E12.m1.13.13.1.1.1.1.cmml" xref="A2.E12.m1.13.13.1.1.1">subscript</csymbol><ci id="A2.E12.m1.13.13.1.1.1.2.cmml" xref="A2.E12.m1.13.13.1.1.1.2">𝒙</ci><list id="A2.E12.m1.4.4.2.3.cmml" xref="A2.E12.m1.4.4.2.2"><apply id="A2.E12.m1.4.4.2.2.1.cmml" xref="A2.E12.m1.4.4.2.2.1"><times id="A2.E12.m1.4.4.2.2.1.1.cmml" xref="A2.E12.m1.4.4.2.2.1.1"></times><ci id="A2.E12.m1.4.4.2.2.1.2.cmml" xref="A2.E12.m1.4.4.2.2.1.2">𝑙</ci><ci id="A2.E12.m1.4.4.2.2.1.3.cmml" xref="A2.E12.m1.4.4.2.2.1.3">𝑜</ci><ci id="A2.E12.m1.4.4.2.2.1.4.cmml" xref="A2.E12.m1.4.4.2.2.1.4">𝑐</ci></apply><ci id="A2.E12.m1.3.3.1.1.cmml" xref="A2.E12.m1.3.3.1.1">𝑖</ci></list></apply><apply id="A2.E12.m1.14.14.2.2.2.cmml" xref="A2.E12.m1.14.14.2.2.2"><csymbol cd="ambiguous" id="A2.E12.m1.14.14.2.2.2.1.cmml" xref="A2.E12.m1.14.14.2.2.2">subscript</csymbol><ci id="A2.E12.m1.14.14.2.2.2.2.cmml" xref="A2.E12.m1.14.14.2.2.2.2">𝒙</ci><list id="A2.E12.m1.7.7.3.4.cmml" xref="A2.E12.m1.7.7.3.3"><apply id="A2.E12.m1.6.6.2.2.1.cmml" xref="A2.E12.m1.6.6.2.2.1"><times id="A2.E12.m1.6.6.2.2.1.1.cmml" xref="A2.E12.m1.6.6.2.2.1.1"></times><ci id="A2.E12.m1.6.6.2.2.1.2.cmml" xref="A2.E12.m1.6.6.2.2.1.2">𝑐</ci><ci id="A2.E12.m1.6.6.2.2.1.3.cmml" xref="A2.E12.m1.6.6.2.2.1.3">𝑡</ci><ci id="A2.E12.m1.6.6.2.2.1.4.cmml" xref="A2.E12.m1.6.6.2.2.1.4">𝑥</ci></apply><ci id="A2.E12.m1.5.5.1.1.cmml" xref="A2.E12.m1.5.5.1.1">𝑖</ci><apply id="A2.E12.m1.7.7.3.3.2.cmml" xref="A2.E12.m1.7.7.3.3.2"><minus id="A2.E12.m1.7.7.3.3.2.1.cmml" xref="A2.E12.m1.7.7.3.3.2.1"></minus><ci id="A2.E12.m1.7.7.3.3.2.2.cmml" xref="A2.E12.m1.7.7.3.3.2.2">𝑡</ci><cn type="integer" id="A2.E12.m1.7.7.3.3.2.3.cmml" xref="A2.E12.m1.7.7.3.3.2.3">1</cn></apply></list></apply><apply id="A2.E12.m1.15.15.3.3.3.cmml" xref="A2.E12.m1.15.15.3.3.3"><times id="A2.E12.m1.15.15.3.3.3.1.cmml" xref="A2.E12.m1.15.15.3.3.3.1"></times><apply id="A2.E12.m1.15.15.3.3.3.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2"><compose id="A2.E12.m1.15.15.3.3.3.2.1.cmml" xref="A2.E12.m1.15.15.3.3.3.2.1"></compose><apply id="A2.E12.m1.15.15.3.3.3.2.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2"><times id="A2.E12.m1.15.15.3.3.3.2.2.1.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.1"></times><apply id="A2.E12.m1.15.15.3.3.3.2.2.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.E12.m1.15.15.3.3.3.2.2.2.1.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.2">subscript</csymbol><ci id="A2.E12.m1.15.15.3.3.3.2.2.2.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.2.2">𝑊</ci><cn type="integer" id="A2.E12.m1.15.15.3.3.3.2.2.2.3.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.2.3">1</cn></apply><apply id="A2.E12.m1.15.15.3.3.3.2.2.3.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.3"><csymbol cd="ambiguous" id="A2.E12.m1.15.15.3.3.3.2.2.3.1.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.3">subscript</csymbol><ci id="A2.E12.m1.15.15.3.3.3.2.2.3.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2.2.3.2">𝒙</ci><list id="A2.E12.m1.9.9.2.3.cmml" xref="A2.E12.m1.9.9.2.2"><apply id="A2.E12.m1.9.9.2.2.1.cmml" xref="A2.E12.m1.9.9.2.2.1"><times id="A2.E12.m1.9.9.2.2.1.1.cmml" xref="A2.E12.m1.9.9.2.2.1.1"></times><ci id="A2.E12.m1.9.9.2.2.1.2.cmml" xref="A2.E12.m1.9.9.2.2.1.2">𝑙</ci><ci id="A2.E12.m1.9.9.2.2.1.3.cmml" xref="A2.E12.m1.9.9.2.2.1.3">𝑜</ci><ci id="A2.E12.m1.9.9.2.2.1.4.cmml" xref="A2.E12.m1.9.9.2.2.1.4">𝑐</ci></apply><ci id="A2.E12.m1.8.8.1.1.cmml" xref="A2.E12.m1.8.8.1.1">𝑖</ci></list></apply></apply><apply id="A2.E12.m1.15.15.3.3.3.2.3.cmml" xref="A2.E12.m1.15.15.3.3.3.2.3"><csymbol cd="ambiguous" id="A2.E12.m1.15.15.3.3.3.2.3.1.cmml" xref="A2.E12.m1.15.15.3.3.3.2.3">subscript</csymbol><ci id="A2.E12.m1.15.15.3.3.3.2.3.2.cmml" xref="A2.E12.m1.15.15.3.3.3.2.3.2">𝑊</ci><cn type="integer" id="A2.E12.m1.15.15.3.3.3.2.3.3.cmml" xref="A2.E12.m1.15.15.3.3.3.2.3.3">2</cn></apply></apply><apply id="A2.E12.m1.15.15.3.3.3.3.cmml" xref="A2.E12.m1.15.15.3.3.3.3"><csymbol cd="ambiguous" id="A2.E12.m1.15.15.3.3.3.3.1.cmml" xref="A2.E12.m1.15.15.3.3.3.3">subscript</csymbol><ci id="A2.E12.m1.15.15.3.3.3.3.2.cmml" xref="A2.E12.m1.15.15.3.3.3.3.2">𝒙</ci><list id="A2.E12.m1.12.12.3.4.cmml" xref="A2.E12.m1.12.12.3.3"><apply id="A2.E12.m1.11.11.2.2.1.cmml" xref="A2.E12.m1.11.11.2.2.1"><times id="A2.E12.m1.11.11.2.2.1.1.cmml" xref="A2.E12.m1.11.11.2.2.1.1"></times><ci id="A2.E12.m1.11.11.2.2.1.2.cmml" xref="A2.E12.m1.11.11.2.2.1.2">𝑐</ci><ci id="A2.E12.m1.11.11.2.2.1.3.cmml" xref="A2.E12.m1.11.11.2.2.1.3">𝑡</ci><ci id="A2.E12.m1.11.11.2.2.1.4.cmml" xref="A2.E12.m1.11.11.2.2.1.4">𝑥</ci></apply><ci id="A2.E12.m1.10.10.1.1.cmml" xref="A2.E12.m1.10.10.1.1">𝑖</ci><apply id="A2.E12.m1.12.12.3.3.2.cmml" xref="A2.E12.m1.12.12.3.3.2"><minus id="A2.E12.m1.12.12.3.3.2.1.cmml" xref="A2.E12.m1.12.12.3.3.2.1"></minus><ci id="A2.E12.m1.12.12.3.3.2.2.cmml" xref="A2.E12.m1.12.12.3.3.2.2">𝑡</ci><cn type="integer" id="A2.E12.m1.12.12.3.3.2.3.cmml" xref="A2.E12.m1.12.12.3.3.2.3">1</cn></apply></list></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E12.m1.15c">\tilde{\boldsymbol{x}}_{t,i}=[\boldsymbol{x}_{loc,i},\boldsymbol{x}_{ctx,i,t-1},W_{1}\boldsymbol{x}_{loc,i}\circ W_{2}\boldsymbol{x}_{ctx,i,t-1}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="A2.SS3.p1.5" class="ltx_p">With the assumption that all nodes are connected, LCGN computes the edge weights <math id="A2.SS3.p1.5.m1.3" class="ltx_Math" alttext="w_{j,i}^{(t)}" display="inline"><semantics id="A2.SS3.p1.5.m1.3a"><msubsup id="A2.SS3.p1.5.m1.3.4" xref="A2.SS3.p1.5.m1.3.4.cmml"><mi id="A2.SS3.p1.5.m1.3.4.2.2" xref="A2.SS3.p1.5.m1.3.4.2.2.cmml">w</mi><mrow id="A2.SS3.p1.5.m1.2.2.2.4" xref="A2.SS3.p1.5.m1.2.2.2.3.cmml"><mi id="A2.SS3.p1.5.m1.1.1.1.1" xref="A2.SS3.p1.5.m1.1.1.1.1.cmml">j</mi><mo id="A2.SS3.p1.5.m1.2.2.2.4.1" xref="A2.SS3.p1.5.m1.2.2.2.3.cmml">,</mo><mi id="A2.SS3.p1.5.m1.2.2.2.2" xref="A2.SS3.p1.5.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="A2.SS3.p1.5.m1.3.3.1.3" xref="A2.SS3.p1.5.m1.3.4.cmml"><mo stretchy="false" id="A2.SS3.p1.5.m1.3.3.1.3.1" xref="A2.SS3.p1.5.m1.3.4.cmml">(</mo><mi id="A2.SS3.p1.5.m1.3.3.1.1" xref="A2.SS3.p1.5.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="A2.SS3.p1.5.m1.3.3.1.3.2" xref="A2.SS3.p1.5.m1.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.5.m1.3b"><apply id="A2.SS3.p1.5.m1.3.4.cmml" xref="A2.SS3.p1.5.m1.3.4"><csymbol cd="ambiguous" id="A2.SS3.p1.5.m1.3.4.1.cmml" xref="A2.SS3.p1.5.m1.3.4">superscript</csymbol><apply id="A2.SS3.p1.5.m1.3.4.2.cmml" xref="A2.SS3.p1.5.m1.3.4"><csymbol cd="ambiguous" id="A2.SS3.p1.5.m1.3.4.2.1.cmml" xref="A2.SS3.p1.5.m1.3.4">subscript</csymbol><ci id="A2.SS3.p1.5.m1.3.4.2.2.cmml" xref="A2.SS3.p1.5.m1.3.4.2.2">𝑤</ci><list id="A2.SS3.p1.5.m1.2.2.2.3.cmml" xref="A2.SS3.p1.5.m1.2.2.2.4"><ci id="A2.SS3.p1.5.m1.1.1.1.1.cmml" xref="A2.SS3.p1.5.m1.1.1.1.1">𝑗</ci><ci id="A2.SS3.p1.5.m1.2.2.2.2.cmml" xref="A2.SS3.p1.5.m1.2.2.2.2">𝑖</ci></list></apply><ci id="A2.SS3.p1.5.m1.3.3.1.1.cmml" xref="A2.SS3.p1.5.m1.3.3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.5.m1.3c">w_{j,i}^{(t)}</annotation></semantics></math>for each node pair (i,j), i.e,</p>
<table id="A2.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E13.m1.8" class="ltx_Math" alttext="\boldsymbol{w}_{j,i}^{(t)}=\mbox{Softmax}((W_{3}\tilde{\boldsymbol{x}}_{t,i})^{T}((W_{4}\tilde{\boldsymbol{x}}_{t,j})\circ(W_{5}c_{t})))" display="block"><semantics id="A2.E13.m1.8a"><mrow id="A2.E13.m1.8.8" xref="A2.E13.m1.8.8.cmml"><msubsup id="A2.E13.m1.8.8.3" xref="A2.E13.m1.8.8.3.cmml"><mi id="A2.E13.m1.8.8.3.2.2" xref="A2.E13.m1.8.8.3.2.2.cmml">𝒘</mi><mrow id="A2.E13.m1.2.2.2.4" xref="A2.E13.m1.2.2.2.3.cmml"><mi id="A2.E13.m1.1.1.1.1" xref="A2.E13.m1.1.1.1.1.cmml">j</mi><mo id="A2.E13.m1.2.2.2.4.1" xref="A2.E13.m1.2.2.2.3.cmml">,</mo><mi id="A2.E13.m1.2.2.2.2" xref="A2.E13.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="A2.E13.m1.3.3.1.3" xref="A2.E13.m1.8.8.3.cmml"><mo stretchy="false" id="A2.E13.m1.3.3.1.3.1" xref="A2.E13.m1.8.8.3.cmml">(</mo><mi id="A2.E13.m1.3.3.1.1" xref="A2.E13.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="A2.E13.m1.3.3.1.3.2" xref="A2.E13.m1.8.8.3.cmml">)</mo></mrow></msubsup><mo id="A2.E13.m1.8.8.2" xref="A2.E13.m1.8.8.2.cmml">=</mo><mrow id="A2.E13.m1.8.8.1" xref="A2.E13.m1.8.8.1.cmml"><mtext id="A2.E13.m1.8.8.1.3" xref="A2.E13.m1.8.8.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="A2.E13.m1.8.8.1.2" xref="A2.E13.m1.8.8.1.2.cmml">​</mo><mrow id="A2.E13.m1.8.8.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.cmml"><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.cmml"><msup id="A2.E13.m1.8.8.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.1.cmml"><mrow id="A2.E13.m1.8.8.1.1.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.cmml"><msub id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.3" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.2" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.1" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A2.E13.m1.5.5.2.4" xref="A2.E13.m1.5.5.2.3.cmml"><mi id="A2.E13.m1.4.4.1.1" xref="A2.E13.m1.4.4.1.1.cmml">t</mi><mo id="A2.E13.m1.5.5.2.4.1" xref="A2.E13.m1.5.5.2.3.cmml">,</mo><mi id="A2.E13.m1.5.5.2.2" xref="A2.E13.m1.5.5.2.2.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A2.E13.m1.8.8.1.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="A2.E13.m1.8.8.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.3.cmml">​</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.cmml"><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml"><msub id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.2.cmml">W</mi><mn id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.3.cmml">4</mn></msub><mo lspace="0em" rspace="0em" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml">​</mo><msub id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A2.E13.m1.7.7.2.4" xref="A2.E13.m1.7.7.2.3.cmml"><mi id="A2.E13.m1.6.6.1.1" xref="A2.E13.m1.6.6.1.1.cmml">t</mi><mo id="A2.E13.m1.7.7.2.4.1" xref="A2.E13.m1.7.7.2.3.cmml">,</mo><mi id="A2.E13.m1.7.7.2.2" xref="A2.E13.m1.7.7.2.2.cmml">j</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.3.cmml">∘</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.cmml"><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.cmml"><msub id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.2.cmml">W</mi><mn id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.3.cmml">5</mn></msub><mo lspace="0em" rspace="0em" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.1" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.1.cmml">​</mo><msub id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.cmml"><mi id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.2" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.2.cmml">c</mi><mi id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.1.2.1.3" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A2.E13.m1.8.8.1.1.1.3" xref="A2.E13.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E13.m1.8b"><apply id="A2.E13.m1.8.8.cmml" xref="A2.E13.m1.8.8"><eq id="A2.E13.m1.8.8.2.cmml" xref="A2.E13.m1.8.8.2"></eq><apply id="A2.E13.m1.8.8.3.cmml" xref="A2.E13.m1.8.8.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.3.1.cmml" xref="A2.E13.m1.8.8.3">superscript</csymbol><apply id="A2.E13.m1.8.8.3.2.cmml" xref="A2.E13.m1.8.8.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.3.2.1.cmml" xref="A2.E13.m1.8.8.3">subscript</csymbol><ci id="A2.E13.m1.8.8.3.2.2.cmml" xref="A2.E13.m1.8.8.3.2.2">𝒘</ci><list id="A2.E13.m1.2.2.2.3.cmml" xref="A2.E13.m1.2.2.2.4"><ci id="A2.E13.m1.1.1.1.1.cmml" xref="A2.E13.m1.1.1.1.1">𝑗</ci><ci id="A2.E13.m1.2.2.2.2.cmml" xref="A2.E13.m1.2.2.2.2">𝑖</ci></list></apply><ci id="A2.E13.m1.3.3.1.1.cmml" xref="A2.E13.m1.3.3.1.1">𝑡</ci></apply><apply id="A2.E13.m1.8.8.1.cmml" xref="A2.E13.m1.8.8.1"><times id="A2.E13.m1.8.8.1.2.cmml" xref="A2.E13.m1.8.8.1.2"></times><ci id="A2.E13.m1.8.8.1.3a.cmml" xref="A2.E13.m1.8.8.1.3"><mtext id="A2.E13.m1.8.8.1.3.cmml" xref="A2.E13.m1.8.8.1.3">Softmax</mtext></ci><apply id="A2.E13.m1.8.8.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1"><times id="A2.E13.m1.8.8.1.1.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.3"></times><apply id="A2.E13.m1.8.8.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.1.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1">superscript</csymbol><apply id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1"><times id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.1"></times><apply id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.2">𝑊</ci><cn type="integer" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.2.3">3</cn></apply><apply id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2"><ci id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.1.1.1.3.2.2">𝒙</ci></apply><list id="A2.E13.m1.5.5.2.3.cmml" xref="A2.E13.m1.5.5.2.4"><ci id="A2.E13.m1.4.4.1.1.cmml" xref="A2.E13.m1.4.4.1.1">𝑡</ci><ci id="A2.E13.m1.5.5.2.2.cmml" xref="A2.E13.m1.5.5.2.2">𝑖</ci></list></apply></apply><ci id="A2.E13.m1.8.8.1.1.1.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.1.3">𝑇</ci></apply><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1"><compose id="A2.E13.m1.8.8.1.1.1.1.2.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.3"></compose><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1"><times id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.1"></times><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.2">𝑊</ci><cn type="integer" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.2.3">4</cn></apply><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3">subscript</csymbol><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2"><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.1">~</ci><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.1.1.1.3.2.2">𝒙</ci></apply><list id="A2.E13.m1.7.7.2.3.cmml" xref="A2.E13.m1.7.7.2.4"><ci id="A2.E13.m1.6.6.1.1.cmml" xref="A2.E13.m1.6.6.1.1">𝑡</ci><ci id="A2.E13.m1.7.7.2.2.cmml" xref="A2.E13.m1.7.7.2.2">𝑗</ci></list></apply></apply><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1"><times id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.1"></times><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2">subscript</csymbol><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.2">𝑊</ci><cn type="integer" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.2.3">5</cn></apply><apply id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.1.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3">subscript</csymbol><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.2.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.2">𝑐</ci><ci id="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.3.cmml" xref="A2.E13.m1.8.8.1.1.1.1.2.1.1.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E13.m1.8c">\boldsymbol{w}_{j,i}^{(t)}=\mbox{Softmax}((W_{3}\tilde{\boldsymbol{x}}_{t,i})^{T}((W_{4}\tilde{\boldsymbol{x}}_{t,j})\circ(W_{5}c_{t})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="A2.SS3.p1.6" class="ltx_p">The messages <math id="A2.SS3.p1.6.m1.3" class="ltx_Math" alttext="m_{i,j}^{(t)}" display="inline"><semantics id="A2.SS3.p1.6.m1.3a"><msubsup id="A2.SS3.p1.6.m1.3.4" xref="A2.SS3.p1.6.m1.3.4.cmml"><mi id="A2.SS3.p1.6.m1.3.4.2.2" xref="A2.SS3.p1.6.m1.3.4.2.2.cmml">m</mi><mrow id="A2.SS3.p1.6.m1.2.2.2.4" xref="A2.SS3.p1.6.m1.2.2.2.3.cmml"><mi id="A2.SS3.p1.6.m1.1.1.1.1" xref="A2.SS3.p1.6.m1.1.1.1.1.cmml">i</mi><mo id="A2.SS3.p1.6.m1.2.2.2.4.1" xref="A2.SS3.p1.6.m1.2.2.2.3.cmml">,</mo><mi id="A2.SS3.p1.6.m1.2.2.2.2" xref="A2.SS3.p1.6.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="A2.SS3.p1.6.m1.3.3.1.3" xref="A2.SS3.p1.6.m1.3.4.cmml"><mo stretchy="false" id="A2.SS3.p1.6.m1.3.3.1.3.1" xref="A2.SS3.p1.6.m1.3.4.cmml">(</mo><mi id="A2.SS3.p1.6.m1.3.3.1.1" xref="A2.SS3.p1.6.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="A2.SS3.p1.6.m1.3.3.1.3.2" xref="A2.SS3.p1.6.m1.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.6.m1.3b"><apply id="A2.SS3.p1.6.m1.3.4.cmml" xref="A2.SS3.p1.6.m1.3.4"><csymbol cd="ambiguous" id="A2.SS3.p1.6.m1.3.4.1.cmml" xref="A2.SS3.p1.6.m1.3.4">superscript</csymbol><apply id="A2.SS3.p1.6.m1.3.4.2.cmml" xref="A2.SS3.p1.6.m1.3.4"><csymbol cd="ambiguous" id="A2.SS3.p1.6.m1.3.4.2.1.cmml" xref="A2.SS3.p1.6.m1.3.4">subscript</csymbol><ci id="A2.SS3.p1.6.m1.3.4.2.2.cmml" xref="A2.SS3.p1.6.m1.3.4.2.2">𝑚</ci><list id="A2.SS3.p1.6.m1.2.2.2.3.cmml" xref="A2.SS3.p1.6.m1.2.2.2.4"><ci id="A2.SS3.p1.6.m1.1.1.1.1.cmml" xref="A2.SS3.p1.6.m1.1.1.1.1">𝑖</ci><ci id="A2.SS3.p1.6.m1.2.2.2.2.cmml" xref="A2.SS3.p1.6.m1.2.2.2.2">𝑗</ci></list></apply><ci id="A2.SS3.p1.6.m1.3.3.1.1.cmml" xref="A2.SS3.p1.6.m1.3.3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.6.m1.3c">m_{i,j}^{(t)}</annotation></semantics></math>, are then computed as:</p>
<table id="A2.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E14.m1.9" class="ltx_Math" alttext="\boldsymbol{m}_{j,i}^{(t)}=\boldsymbol{w}_{j,i}^{(t)}((W_{6}\tilde{\boldsymbol{x}}_{t,j})\circ(W_{7}c_{t}))" display="block"><semantics id="A2.E14.m1.9a"><mrow id="A2.E14.m1.9.9" xref="A2.E14.m1.9.9.cmml"><msubsup id="A2.E14.m1.9.9.3" xref="A2.E14.m1.9.9.3.cmml"><mi id="A2.E14.m1.9.9.3.2.2" xref="A2.E14.m1.9.9.3.2.2.cmml">𝒎</mi><mrow id="A2.E14.m1.2.2.2.4" xref="A2.E14.m1.2.2.2.3.cmml"><mi id="A2.E14.m1.1.1.1.1" xref="A2.E14.m1.1.1.1.1.cmml">j</mi><mo id="A2.E14.m1.2.2.2.4.1" xref="A2.E14.m1.2.2.2.3.cmml">,</mo><mi id="A2.E14.m1.2.2.2.2" xref="A2.E14.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="A2.E14.m1.3.3.1.3" xref="A2.E14.m1.9.9.3.cmml"><mo stretchy="false" id="A2.E14.m1.3.3.1.3.1" xref="A2.E14.m1.9.9.3.cmml">(</mo><mi id="A2.E14.m1.3.3.1.1" xref="A2.E14.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="A2.E14.m1.3.3.1.3.2" xref="A2.E14.m1.9.9.3.cmml">)</mo></mrow></msubsup><mo id="A2.E14.m1.9.9.2" xref="A2.E14.m1.9.9.2.cmml">=</mo><mrow id="A2.E14.m1.9.9.1" xref="A2.E14.m1.9.9.1.cmml"><msubsup id="A2.E14.m1.9.9.1.3" xref="A2.E14.m1.9.9.1.3.cmml"><mi id="A2.E14.m1.9.9.1.3.2.2" xref="A2.E14.m1.9.9.1.3.2.2.cmml">𝒘</mi><mrow id="A2.E14.m1.5.5.2.4" xref="A2.E14.m1.5.5.2.3.cmml"><mi id="A2.E14.m1.4.4.1.1" xref="A2.E14.m1.4.4.1.1.cmml">j</mi><mo id="A2.E14.m1.5.5.2.4.1" xref="A2.E14.m1.5.5.2.3.cmml">,</mo><mi id="A2.E14.m1.5.5.2.2" xref="A2.E14.m1.5.5.2.2.cmml">i</mi></mrow><mrow id="A2.E14.m1.6.6.1.3" xref="A2.E14.m1.9.9.1.3.cmml"><mo stretchy="false" id="A2.E14.m1.6.6.1.3.1" xref="A2.E14.m1.9.9.1.3.cmml">(</mo><mi id="A2.E14.m1.6.6.1.1" xref="A2.E14.m1.6.6.1.1.cmml">t</mi><mo stretchy="false" id="A2.E14.m1.6.6.1.3.2" xref="A2.E14.m1.9.9.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A2.E14.m1.9.9.1.2" xref="A2.E14.m1.9.9.1.2.cmml">​</mo><mrow id="A2.E14.m1.9.9.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.cmml"><mo stretchy="false" id="A2.E14.m1.9.9.1.1.1.2" xref="A2.E14.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="A2.E14.m1.9.9.1.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.cmml"><mrow id="A2.E14.m1.9.9.1.1.1.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.E14.m1.9.9.1.1.1.1.1.1.2" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E14.m1.9.9.1.1.1.1.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mi id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.2" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.3" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">6</mn></msub><mo lspace="0em" rspace="0em" id="A2.E14.m1.9.9.1.1.1.1.1.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.cmml"><mi id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml">𝒙</mi><mo id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.1" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="A2.E14.m1.8.8.2.4" xref="A2.E14.m1.8.8.2.3.cmml"><mi id="A2.E14.m1.7.7.1.1" xref="A2.E14.m1.7.7.1.1.cmml">t</mi><mo id="A2.E14.m1.8.8.2.4.1" xref="A2.E14.m1.8.8.2.3.cmml">,</mo><mi id="A2.E14.m1.8.8.2.2" xref="A2.E14.m1.8.8.2.2.cmml">j</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="A2.E14.m1.9.9.1.1.1.1.1.1.3" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A2.E14.m1.9.9.1.1.1.1.3" xref="A2.E14.m1.9.9.1.1.1.1.3.cmml">∘</mo><mrow id="A2.E14.m1.9.9.1.1.1.1.2.1" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="A2.E14.m1.9.9.1.1.1.1.2.1.2" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.cmml">(</mo><mrow id="A2.E14.m1.9.9.1.1.1.1.2.1.1" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.cmml"><msub id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.cmml"><mi id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.2" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.2.cmml">W</mi><mn id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.3" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.3.cmml">7</mn></msub><mo lspace="0em" rspace="0em" id="A2.E14.m1.9.9.1.1.1.1.2.1.1.1" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.1.cmml">​</mo><msub id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.cmml"><mi id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.2" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.2.cmml">c</mi><mi id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.3" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="A2.E14.m1.9.9.1.1.1.1.2.1.3" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A2.E14.m1.9.9.1.1.1.3" xref="A2.E14.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E14.m1.9b"><apply id="A2.E14.m1.9.9.cmml" xref="A2.E14.m1.9.9"><eq id="A2.E14.m1.9.9.2.cmml" xref="A2.E14.m1.9.9.2"></eq><apply id="A2.E14.m1.9.9.3.cmml" xref="A2.E14.m1.9.9.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.3.1.cmml" xref="A2.E14.m1.9.9.3">superscript</csymbol><apply id="A2.E14.m1.9.9.3.2.cmml" xref="A2.E14.m1.9.9.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.3.2.1.cmml" xref="A2.E14.m1.9.9.3">subscript</csymbol><ci id="A2.E14.m1.9.9.3.2.2.cmml" xref="A2.E14.m1.9.9.3.2.2">𝒎</ci><list id="A2.E14.m1.2.2.2.3.cmml" xref="A2.E14.m1.2.2.2.4"><ci id="A2.E14.m1.1.1.1.1.cmml" xref="A2.E14.m1.1.1.1.1">𝑗</ci><ci id="A2.E14.m1.2.2.2.2.cmml" xref="A2.E14.m1.2.2.2.2">𝑖</ci></list></apply><ci id="A2.E14.m1.3.3.1.1.cmml" xref="A2.E14.m1.3.3.1.1">𝑡</ci></apply><apply id="A2.E14.m1.9.9.1.cmml" xref="A2.E14.m1.9.9.1"><times id="A2.E14.m1.9.9.1.2.cmml" xref="A2.E14.m1.9.9.1.2"></times><apply id="A2.E14.m1.9.9.1.3.cmml" xref="A2.E14.m1.9.9.1.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.3.1.cmml" xref="A2.E14.m1.9.9.1.3">superscript</csymbol><apply id="A2.E14.m1.9.9.1.3.2.cmml" xref="A2.E14.m1.9.9.1.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.3.2.1.cmml" xref="A2.E14.m1.9.9.1.3">subscript</csymbol><ci id="A2.E14.m1.9.9.1.3.2.2.cmml" xref="A2.E14.m1.9.9.1.3.2.2">𝒘</ci><list id="A2.E14.m1.5.5.2.3.cmml" xref="A2.E14.m1.5.5.2.4"><ci id="A2.E14.m1.4.4.1.1.cmml" xref="A2.E14.m1.4.4.1.1">𝑗</ci><ci id="A2.E14.m1.5.5.2.2.cmml" xref="A2.E14.m1.5.5.2.2">𝑖</ci></list></apply><ci id="A2.E14.m1.6.6.1.1.cmml" xref="A2.E14.m1.6.6.1.1">𝑡</ci></apply><apply id="A2.E14.m1.9.9.1.1.1.1.cmml" xref="A2.E14.m1.9.9.1.1.1"><compose id="A2.E14.m1.9.9.1.1.1.1.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.3"></compose><apply id="A2.E14.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1"><times id="A2.E14.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.1"></times><apply id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.2">𝑊</ci><cn type="integer" id="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.2.3">6</cn></apply><apply id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2"><ci id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.1.1.1.3.2.2">𝒙</ci></apply><list id="A2.E14.m1.8.8.2.3.cmml" xref="A2.E14.m1.8.8.2.4"><ci id="A2.E14.m1.7.7.1.1.cmml" xref="A2.E14.m1.7.7.1.1">𝑡</ci><ci id="A2.E14.m1.8.8.2.2.cmml" xref="A2.E14.m1.8.8.2.2">𝑗</ci></list></apply></apply><apply id="A2.E14.m1.9.9.1.1.1.1.2.1.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1"><times id="A2.E14.m1.9.9.1.1.1.1.2.1.1.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.1"></times><apply id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.2">𝑊</ci><cn type="integer" id="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.2.3">7</cn></apply><apply id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.1.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.2.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.2">𝑐</ci><ci id="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.3.cmml" xref="A2.E14.m1.9.9.1.1.1.1.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E14.m1.9c">\boldsymbol{m}_{j,i}^{(t)}=\boldsymbol{w}_{j,i}^{(t)}((W_{6}\tilde{\boldsymbol{x}}_{t,j})\circ(W_{7}c_{t}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A2.SS3.p1.7" class="ltx_p">Finally, LCGN aggregates the neighborhood message information to update the context local representation <math id="A2.SS3.p1.7.m1.3" class="ltx_Math" alttext="\boldsymbol{x}_{ctx,i,t}" display="inline"><semantics id="A2.SS3.p1.7.m1.3a"><msub id="A2.SS3.p1.7.m1.3.4" xref="A2.SS3.p1.7.m1.3.4.cmml"><mi id="A2.SS3.p1.7.m1.3.4.2" xref="A2.SS3.p1.7.m1.3.4.2.cmml">𝒙</mi><mrow id="A2.SS3.p1.7.m1.3.3.3.3" xref="A2.SS3.p1.7.m1.3.3.3.4.cmml"><mrow id="A2.SS3.p1.7.m1.3.3.3.3.1" xref="A2.SS3.p1.7.m1.3.3.3.3.1.cmml"><mi id="A2.SS3.p1.7.m1.3.3.3.3.1.2" xref="A2.SS3.p1.7.m1.3.3.3.3.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.7.m1.3.3.3.3.1.1" xref="A2.SS3.p1.7.m1.3.3.3.3.1.1.cmml">​</mo><mi id="A2.SS3.p1.7.m1.3.3.3.3.1.3" xref="A2.SS3.p1.7.m1.3.3.3.3.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.7.m1.3.3.3.3.1.1a" xref="A2.SS3.p1.7.m1.3.3.3.3.1.1.cmml">​</mo><mi id="A2.SS3.p1.7.m1.3.3.3.3.1.4" xref="A2.SS3.p1.7.m1.3.3.3.3.1.4.cmml">x</mi></mrow><mo id="A2.SS3.p1.7.m1.3.3.3.3.2" xref="A2.SS3.p1.7.m1.3.3.3.4.cmml">,</mo><mi id="A2.SS3.p1.7.m1.1.1.1.1" xref="A2.SS3.p1.7.m1.1.1.1.1.cmml">i</mi><mo id="A2.SS3.p1.7.m1.3.3.3.3.3" xref="A2.SS3.p1.7.m1.3.3.3.4.cmml">,</mo><mi id="A2.SS3.p1.7.m1.2.2.2.2" xref="A2.SS3.p1.7.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.7.m1.3b"><apply id="A2.SS3.p1.7.m1.3.4.cmml" xref="A2.SS3.p1.7.m1.3.4"><csymbol cd="ambiguous" id="A2.SS3.p1.7.m1.3.4.1.cmml" xref="A2.SS3.p1.7.m1.3.4">subscript</csymbol><ci id="A2.SS3.p1.7.m1.3.4.2.cmml" xref="A2.SS3.p1.7.m1.3.4.2">𝒙</ci><list id="A2.SS3.p1.7.m1.3.3.3.4.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3"><apply id="A2.SS3.p1.7.m1.3.3.3.3.1.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3.1"><times id="A2.SS3.p1.7.m1.3.3.3.3.1.1.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3.1.1"></times><ci id="A2.SS3.p1.7.m1.3.3.3.3.1.2.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3.1.2">𝑐</ci><ci id="A2.SS3.p1.7.m1.3.3.3.3.1.3.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3.1.3">𝑡</ci><ci id="A2.SS3.p1.7.m1.3.3.3.3.1.4.cmml" xref="A2.SS3.p1.7.m1.3.3.3.3.1.4">𝑥</ci></apply><ci id="A2.SS3.p1.7.m1.1.1.1.1.cmml" xref="A2.SS3.p1.7.m1.1.1.1.1">𝑖</ci><ci id="A2.SS3.p1.7.m1.2.2.2.2.cmml" xref="A2.SS3.p1.7.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.7.m1.3c">\boldsymbol{x}_{ctx,i,t}</annotation></semantics></math>.</p>
<table id="A2.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.E15.m1.11" class="ltx_Math" alttext="\boldsymbol{x}_{ctx,i,t}=W_{8}[x_{ctx,i,t-1};\sum_{j=1}^{N}m_{j,i}^{(t)}]" display="block"><semantics id="A2.E15.m1.11a"><mrow id="A2.E15.m1.11.11" xref="A2.E15.m1.11.11.cmml"><msub id="A2.E15.m1.11.11.4" xref="A2.E15.m1.11.11.4.cmml"><mi id="A2.E15.m1.11.11.4.2" xref="A2.E15.m1.11.11.4.2.cmml">𝒙</mi><mrow id="A2.E15.m1.3.3.3.3" xref="A2.E15.m1.3.3.3.4.cmml"><mrow id="A2.E15.m1.3.3.3.3.1" xref="A2.E15.m1.3.3.3.3.1.cmml"><mi id="A2.E15.m1.3.3.3.3.1.2" xref="A2.E15.m1.3.3.3.3.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E15.m1.3.3.3.3.1.1" xref="A2.E15.m1.3.3.3.3.1.1.cmml">​</mo><mi id="A2.E15.m1.3.3.3.3.1.3" xref="A2.E15.m1.3.3.3.3.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E15.m1.3.3.3.3.1.1a" xref="A2.E15.m1.3.3.3.3.1.1.cmml">​</mo><mi id="A2.E15.m1.3.3.3.3.1.4" xref="A2.E15.m1.3.3.3.3.1.4.cmml">x</mi></mrow><mo id="A2.E15.m1.3.3.3.3.2" xref="A2.E15.m1.3.3.3.4.cmml">,</mo><mi id="A2.E15.m1.1.1.1.1" xref="A2.E15.m1.1.1.1.1.cmml">i</mi><mo id="A2.E15.m1.3.3.3.3.3" xref="A2.E15.m1.3.3.3.4.cmml">,</mo><mi id="A2.E15.m1.2.2.2.2" xref="A2.E15.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="A2.E15.m1.11.11.3" xref="A2.E15.m1.11.11.3.cmml">=</mo><mrow id="A2.E15.m1.11.11.2" xref="A2.E15.m1.11.11.2.cmml"><msub id="A2.E15.m1.11.11.2.4" xref="A2.E15.m1.11.11.2.4.cmml"><mi id="A2.E15.m1.11.11.2.4.2" xref="A2.E15.m1.11.11.2.4.2.cmml">W</mi><mn id="A2.E15.m1.11.11.2.4.3" xref="A2.E15.m1.11.11.2.4.3.cmml">8</mn></msub><mo lspace="0em" rspace="0em" id="A2.E15.m1.11.11.2.3" xref="A2.E15.m1.11.11.2.3.cmml">​</mo><mrow id="A2.E15.m1.11.11.2.2.2" xref="A2.E15.m1.11.11.2.2.3.cmml"><mo stretchy="false" id="A2.E15.m1.11.11.2.2.2.3" xref="A2.E15.m1.11.11.2.2.3.cmml">[</mo><msub id="A2.E15.m1.10.10.1.1.1.1" xref="A2.E15.m1.10.10.1.1.1.1.cmml"><mi id="A2.E15.m1.10.10.1.1.1.1.2" xref="A2.E15.m1.10.10.1.1.1.1.2.cmml">x</mi><mrow id="A2.E15.m1.6.6.3.3" xref="A2.E15.m1.6.6.3.4.cmml"><mrow id="A2.E15.m1.5.5.2.2.1" xref="A2.E15.m1.5.5.2.2.1.cmml"><mi id="A2.E15.m1.5.5.2.2.1.2" xref="A2.E15.m1.5.5.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="A2.E15.m1.5.5.2.2.1.1" xref="A2.E15.m1.5.5.2.2.1.1.cmml">​</mo><mi id="A2.E15.m1.5.5.2.2.1.3" xref="A2.E15.m1.5.5.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="A2.E15.m1.5.5.2.2.1.1a" xref="A2.E15.m1.5.5.2.2.1.1.cmml">​</mo><mi id="A2.E15.m1.5.5.2.2.1.4" xref="A2.E15.m1.5.5.2.2.1.4.cmml">x</mi></mrow><mo id="A2.E15.m1.6.6.3.3.3" xref="A2.E15.m1.6.6.3.4.cmml">,</mo><mi id="A2.E15.m1.4.4.1.1" xref="A2.E15.m1.4.4.1.1.cmml">i</mi><mo id="A2.E15.m1.6.6.3.3.4" xref="A2.E15.m1.6.6.3.4.cmml">,</mo><mrow id="A2.E15.m1.6.6.3.3.2" xref="A2.E15.m1.6.6.3.3.2.cmml"><mi id="A2.E15.m1.6.6.3.3.2.2" xref="A2.E15.m1.6.6.3.3.2.2.cmml">t</mi><mo id="A2.E15.m1.6.6.3.3.2.1" xref="A2.E15.m1.6.6.3.3.2.1.cmml">−</mo><mn id="A2.E15.m1.6.6.3.3.2.3" xref="A2.E15.m1.6.6.3.3.2.3.cmml">1</mn></mrow></mrow></msub><mo rspace="0em" id="A2.E15.m1.11.11.2.2.2.4" xref="A2.E15.m1.11.11.2.2.3.cmml">;</mo><mrow id="A2.E15.m1.11.11.2.2.2.2" xref="A2.E15.m1.11.11.2.2.2.2.cmml"><munderover id="A2.E15.m1.11.11.2.2.2.2.1" xref="A2.E15.m1.11.11.2.2.2.2.1.cmml"><mo movablelimits="false" id="A2.E15.m1.11.11.2.2.2.2.1.2.2" xref="A2.E15.m1.11.11.2.2.2.2.1.2.2.cmml">∑</mo><mrow id="A2.E15.m1.11.11.2.2.2.2.1.2.3" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.cmml"><mi id="A2.E15.m1.11.11.2.2.2.2.1.2.3.2" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.2.cmml">j</mi><mo id="A2.E15.m1.11.11.2.2.2.2.1.2.3.1" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.1.cmml">=</mo><mn id="A2.E15.m1.11.11.2.2.2.2.1.2.3.3" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="A2.E15.m1.11.11.2.2.2.2.1.3" xref="A2.E15.m1.11.11.2.2.2.2.1.3.cmml">N</mi></munderover><msubsup id="A2.E15.m1.11.11.2.2.2.2.2" xref="A2.E15.m1.11.11.2.2.2.2.2.cmml"><mi id="A2.E15.m1.11.11.2.2.2.2.2.2.2" xref="A2.E15.m1.11.11.2.2.2.2.2.2.2.cmml">m</mi><mrow id="A2.E15.m1.8.8.2.4" xref="A2.E15.m1.8.8.2.3.cmml"><mi id="A2.E15.m1.7.7.1.1" xref="A2.E15.m1.7.7.1.1.cmml">j</mi><mo id="A2.E15.m1.8.8.2.4.1" xref="A2.E15.m1.8.8.2.3.cmml">,</mo><mi id="A2.E15.m1.8.8.2.2" xref="A2.E15.m1.8.8.2.2.cmml">i</mi></mrow><mrow id="A2.E15.m1.9.9.1.3" xref="A2.E15.m1.11.11.2.2.2.2.2.cmml"><mo stretchy="false" id="A2.E15.m1.9.9.1.3.1" xref="A2.E15.m1.11.11.2.2.2.2.2.cmml">(</mo><mi id="A2.E15.m1.9.9.1.1" xref="A2.E15.m1.9.9.1.1.cmml">t</mi><mo stretchy="false" id="A2.E15.m1.9.9.1.3.2" xref="A2.E15.m1.11.11.2.2.2.2.2.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="A2.E15.m1.11.11.2.2.2.5" xref="A2.E15.m1.11.11.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E15.m1.11b"><apply id="A2.E15.m1.11.11.cmml" xref="A2.E15.m1.11.11"><eq id="A2.E15.m1.11.11.3.cmml" xref="A2.E15.m1.11.11.3"></eq><apply id="A2.E15.m1.11.11.4.cmml" xref="A2.E15.m1.11.11.4"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.4.1.cmml" xref="A2.E15.m1.11.11.4">subscript</csymbol><ci id="A2.E15.m1.11.11.4.2.cmml" xref="A2.E15.m1.11.11.4.2">𝒙</ci><list id="A2.E15.m1.3.3.3.4.cmml" xref="A2.E15.m1.3.3.3.3"><apply id="A2.E15.m1.3.3.3.3.1.cmml" xref="A2.E15.m1.3.3.3.3.1"><times id="A2.E15.m1.3.3.3.3.1.1.cmml" xref="A2.E15.m1.3.3.3.3.1.1"></times><ci id="A2.E15.m1.3.3.3.3.1.2.cmml" xref="A2.E15.m1.3.3.3.3.1.2">𝑐</ci><ci id="A2.E15.m1.3.3.3.3.1.3.cmml" xref="A2.E15.m1.3.3.3.3.1.3">𝑡</ci><ci id="A2.E15.m1.3.3.3.3.1.4.cmml" xref="A2.E15.m1.3.3.3.3.1.4">𝑥</ci></apply><ci id="A2.E15.m1.1.1.1.1.cmml" xref="A2.E15.m1.1.1.1.1">𝑖</ci><ci id="A2.E15.m1.2.2.2.2.cmml" xref="A2.E15.m1.2.2.2.2">𝑡</ci></list></apply><apply id="A2.E15.m1.11.11.2.cmml" xref="A2.E15.m1.11.11.2"><times id="A2.E15.m1.11.11.2.3.cmml" xref="A2.E15.m1.11.11.2.3"></times><apply id="A2.E15.m1.11.11.2.4.cmml" xref="A2.E15.m1.11.11.2.4"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.2.4.1.cmml" xref="A2.E15.m1.11.11.2.4">subscript</csymbol><ci id="A2.E15.m1.11.11.2.4.2.cmml" xref="A2.E15.m1.11.11.2.4.2">𝑊</ci><cn type="integer" id="A2.E15.m1.11.11.2.4.3.cmml" xref="A2.E15.m1.11.11.2.4.3">8</cn></apply><list id="A2.E15.m1.11.11.2.2.3.cmml" xref="A2.E15.m1.11.11.2.2.2"><apply id="A2.E15.m1.10.10.1.1.1.1.cmml" xref="A2.E15.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="A2.E15.m1.10.10.1.1.1.1.1.cmml" xref="A2.E15.m1.10.10.1.1.1.1">subscript</csymbol><ci id="A2.E15.m1.10.10.1.1.1.1.2.cmml" xref="A2.E15.m1.10.10.1.1.1.1.2">𝑥</ci><list id="A2.E15.m1.6.6.3.4.cmml" xref="A2.E15.m1.6.6.3.3"><apply id="A2.E15.m1.5.5.2.2.1.cmml" xref="A2.E15.m1.5.5.2.2.1"><times id="A2.E15.m1.5.5.2.2.1.1.cmml" xref="A2.E15.m1.5.5.2.2.1.1"></times><ci id="A2.E15.m1.5.5.2.2.1.2.cmml" xref="A2.E15.m1.5.5.2.2.1.2">𝑐</ci><ci id="A2.E15.m1.5.5.2.2.1.3.cmml" xref="A2.E15.m1.5.5.2.2.1.3">𝑡</ci><ci id="A2.E15.m1.5.5.2.2.1.4.cmml" xref="A2.E15.m1.5.5.2.2.1.4">𝑥</ci></apply><ci id="A2.E15.m1.4.4.1.1.cmml" xref="A2.E15.m1.4.4.1.1">𝑖</ci><apply id="A2.E15.m1.6.6.3.3.2.cmml" xref="A2.E15.m1.6.6.3.3.2"><minus id="A2.E15.m1.6.6.3.3.2.1.cmml" xref="A2.E15.m1.6.6.3.3.2.1"></minus><ci id="A2.E15.m1.6.6.3.3.2.2.cmml" xref="A2.E15.m1.6.6.3.3.2.2">𝑡</ci><cn type="integer" id="A2.E15.m1.6.6.3.3.2.3.cmml" xref="A2.E15.m1.6.6.3.3.2.3">1</cn></apply></list></apply><apply id="A2.E15.m1.11.11.2.2.2.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2"><apply id="A2.E15.m1.11.11.2.2.2.2.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.2.2.2.2.1.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1">superscript</csymbol><apply id="A2.E15.m1.11.11.2.2.2.2.1.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.2.2.2.2.1.2.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1">subscript</csymbol><sum id="A2.E15.m1.11.11.2.2.2.2.1.2.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.2.2"></sum><apply id="A2.E15.m1.11.11.2.2.2.2.1.2.3.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3"><eq id="A2.E15.m1.11.11.2.2.2.2.1.2.3.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.1"></eq><ci id="A2.E15.m1.11.11.2.2.2.2.1.2.3.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.2">𝑗</ci><cn type="integer" id="A2.E15.m1.11.11.2.2.2.2.1.2.3.3.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.2.3.3">1</cn></apply></apply><ci id="A2.E15.m1.11.11.2.2.2.2.1.3.cmml" xref="A2.E15.m1.11.11.2.2.2.2.1.3">𝑁</ci></apply><apply id="A2.E15.m1.11.11.2.2.2.2.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.2.2.2.2.2.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.2">superscript</csymbol><apply id="A2.E15.m1.11.11.2.2.2.2.2.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E15.m1.11.11.2.2.2.2.2.2.1.cmml" xref="A2.E15.m1.11.11.2.2.2.2.2">subscript</csymbol><ci id="A2.E15.m1.11.11.2.2.2.2.2.2.2.cmml" xref="A2.E15.m1.11.11.2.2.2.2.2.2.2">𝑚</ci><list id="A2.E15.m1.8.8.2.3.cmml" xref="A2.E15.m1.8.8.2.4"><ci id="A2.E15.m1.7.7.1.1.cmml" xref="A2.E15.m1.7.7.1.1">𝑗</ci><ci id="A2.E15.m1.8.8.2.2.cmml" xref="A2.E15.m1.8.8.2.2">𝑖</ci></list></apply><ci id="A2.E15.m1.9.9.1.1.cmml" xref="A2.E15.m1.9.9.1.1">𝑡</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E15.m1.11c">\boldsymbol{x}_{ctx,i,t}=W_{8}[x_{ctx,i,t-1};\sum_{j=1}^{N}m_{j,i}^{(t)}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A2.SS3.p1.8" class="ltx_p">Note that the graph neural structure of LCGN can be regarded as a variant of recurrently-used single standard GAT layer, but with more self-designed learnable parameters. The main difference between LCGN’s and other proposed graph neural structure is that the output node and edge features will be recurrently fed into the same layer again for each reasoning step, leading to
a RNN-style network structure, instead of a sequential-style network. Moreover, our LCGN implementation is a variant of original LCGN, including a few improvements. Firstly, we use a transformer encoder and decoder to obtain instruction vectors instead of Bi-LSTM <cite class="ltx_cite ltx_citemacro_cite">Liang et al. (<a href="#bib.bib21" title="" class="ltx_ref">2020d</a>)</cite>. Secondly, we incorporate the true scene graph relations as edges instead of densely connected edges. Thirdly, edge attributes are also used in the generation of initial node features.</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Implementation Details</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Data Pre-processing</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">The edges in the original scene graphs are directed. This means in most of the cases where we only have one directed edge connecting two nodes in the graph, the messages can only flow through one direction. However, this does not make sense in the natural way of human reasoning. For example, an relation of "A is to the left of B" should obviously entail an opposite relation of "B is to the right of A". Therefore, in order to enhance the connectivity of our graphs, we introduce a synthetic symmetric edge for every non-paired edge, making it pointing reversely to the source node. And in order to encode this reversed relationship, we negate the original edge’s feature vector and use it as the representation of our synthetic symmetric edge.</p>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Additional Dataset Information</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p">These scene graphs are generated from 113k images on COCO and Flicker using the Visual Genome Scene Graph <cite class="ltx_cite ltx_citemacro_cite">Krishna et al. (<a href="#bib.bib14" title="" class="ltx_ref">2017b</a>)</cite> annotations.
Specifically, each node in the GQA scene graph is representing an object, such as a person, a window, or an apple. Along with the positional information of bounding box, each object is also annotated with 1-3 different attributes.
These attributes are the adjectives used to describe associated objects. For examples, there can be color attributes like "white", size attributes like "large", and action attributes like "standing". Attributes are important sources of information beyond the coarse-grained object classes <cite class="ltx_cite ltx_citemacro_cite">Liang et al. (<a href="#bib.bib20" title="" class="ltx_ref">2020c</a>)</cite>.
Each edge in the scene graph denotes relation between two connected objects. These relations can be action verbs, spatial prepositions, and comparatives, such as "wearing", "below", and "taller".</p>
</div>
<div id="A3.SS2.p2" class="ltx_para">
<p id="A3.SS2.p2.1" class="ltx_p">We use the official split of the GQA dataset.
We use two files "val_sceneGraphs.json" and "train_sceneGraphs.json" directly obtained on the GQA website as our raw dataset.
Since each image (graph) is independent, GQA splits the dataset by individual graphs with rough split percentages of <span id="A3.SS2.p2.1.1" class="ltx_text ltx_font_bold"> train/validation: 88%/12%</span>.
In the table <a href="#A2.T2" title="Table 2 ‣ B.1 Additional Performances Analysis ‣ Appendix B Additional Results ‣ GraphVQA: Language-Guided Graph Neural Networks for Scene Graph Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we summarize the statistics that we collected from the dataset.
We did not report the statistics of the test set since the scene graphs in the test set is not publicly available.</p>
</div>
</section>
<section id="A3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Training details</h3>

<div id="A3.SS3.p1" class="ltx_para">
<p id="A3.SS3.p1.2" class="ltx_p">We train the models using the Adam optimization method, with a learning rate of <math id="A3.SS3.p1.1.m1.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="A3.SS3.p1.1.m1.1a"><msup id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml"><mn id="A3.SS3.p1.1.m1.1.1.2" xref="A3.SS3.p1.1.m1.1.1.2.cmml">10</mn><mrow id="A3.SS3.p1.1.m1.1.1.3" xref="A3.SS3.p1.1.m1.1.1.3.cmml"><mo id="A3.SS3.p1.1.m1.1.1.3a" xref="A3.SS3.p1.1.m1.1.1.3.cmml">−</mo><mn id="A3.SS3.p1.1.m1.1.1.3.2" xref="A3.SS3.p1.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><apply id="A3.SS3.p1.1.m1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS3.p1.1.m1.1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="A3.SS3.p1.1.m1.1.1.2.cmml" xref="A3.SS3.p1.1.m1.1.1.2">10</cn><apply id="A3.SS3.p1.1.m1.1.1.3.cmml" xref="A3.SS3.p1.1.m1.1.1.3"><minus id="A3.SS3.p1.1.m1.1.1.3.1.cmml" xref="A3.SS3.p1.1.m1.1.1.3"></minus><cn type="integer" id="A3.SS3.p1.1.m1.1.1.3.2.cmml" xref="A3.SS3.p1.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">10^{-4}</annotation></semantics></math>, a batch size of 256, and a learning rate drop(divide by 10) each 90 epochs. We train all models for <math id="A3.SS3.p1.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A3.SS3.p1.2.m2.1a"><mn id="A3.SS3.p1.2.m2.1.1" xref="A3.SS3.p1.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.2.m2.1b"><cn type="integer" id="A3.SS3.p1.2.m2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.2.m2.1c">100</annotation></semantics></math> epochs.
Both hidden states and word embedding vectors have a dimension size of 300, the latter being initialized using GloVe <cite class="ltx_cite ltx_citemacro_cite">Pennington et al. (<a href="#bib.bib23" title="" class="ltx_ref">2014</a>)</cite>.The instruction vectors have a dimension size of 512. All results reported are for a single-model settings (i.e., without ensembling). We use cross validation for hyper-parameter tuning.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2104.10282" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2104.10283" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2104.10283">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2104.10283" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2104.10284" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar 17 04:49:47 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
