<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning</title>
<!--Generated on Fri Sep 20 06:10:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Image Segmentation Stain separation Multi-task learning." lang="en" name="keywords"/>
<base href="/html/2409.13246v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S1" title="In Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S1.SS0.SSS0.Px1" title="In 1 Introduction ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"></span> ‣ <span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2" title="In Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.SS1" title="In 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multi-task learning based on stain separation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.SS1.SSS0.Px1" title="In 2.1 Multi-task learning based on stain separation ‣ 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"></span> ‣ <span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multi-task learning based on stain separation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.SS2" title="In 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Mixture of stain augmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.SS3" title="In 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Training and inference configuration</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.SS3.SSS0.Px1" title="In 2.3 Training and inference configuration ‣ 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"></span> ‣ <span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Training and inference configuration</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S3" title="In Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S3.SS1" title="In 3 Results ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S4" title="In Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S5" title="In Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S5.SS0.SSS1" title="In 5 Conclusion ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.0.1 </span><span class="ltx_ERROR undefined">\discintname</span></span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>
AI Research Center, Seegene Medical Foundation, Seoul, South Korea 
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>
{hoheon0509, jeongwonchan53, noteasy, youngjpark}@mf.seegene.com
</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ho Heon Kim 
<br class="ltx_break"/>Won Chan Jeong 
<br class="ltx_break"/>Young Shin Ko 
<br class="ltx_break"/>Young Jin Park
</span><span class="ltx_author_notes">11
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-7260-7504" title="ORCID identifier">0000-0001-7260-7504</a></span>
11
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0008-1931-5957" title="ORCID identifier">0009-0008-1931-5957</a></span>
11
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0003-1319-4847" title="ORCID identifier">0000-0003-1319-4847</a></span>
11
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-0754-8103" title="ORCID identifier">0000-0002-0754-8103</a></span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Digital pathology has made significant advances in tumor diagnosis and segmentation, but image variability due to differences in organs, tissue preparation, and acquisition - known as domain shift - limits the effectiveness of current algorithms. The COSAS (Cross-Organ and Cross-Scanner Adenocarcinoma Segmentation) challenge addresses this issue by improving the resilience of segmentation algorithms to domain shift, with Task 2 focusing on adenocarcinoma segmentation using a diverse dataset from six scanners, pushing the boundaries of clinical diagnostics. Our approach employs unsupervised learning through stain separation within a multi-task learning framework using a multi-decoder autoencoder. This model isolates stain matrix and stain density, allowing it to handle color variation and improve generalization across scanners. We further enhanced the robustness of the model with a mixture of stain augmentation techniques and used a U-net architecture for segmentation. The novelty of our method lies in the use of stain separation within a multi-task learning framework, which effectively disentangles histological structures from color variations. This approach shows promise for improving segmentation accuracy and generalization across different histopathological stains, paving the way for more reliable diagnostic tools in digital pathology.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Image Segmentation Stain separation Multi-task learning.
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<section class="ltx_paragraph" id="S1.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph"></h5>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p1.1">The field of digital pathology has advanced significantly, especially in tumor diagnosis and segmentation. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib1" title="">1</a>]</cite> However, the effectiveness of current algorithms is often limited by the variability in digital pathology images, caused by differences in organs, tissue preparation, and image acquisition—a challenge known as domain-shift. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib2" title="">2</a>]</cite> Addressing domain-shift is crucial for ensuring consistent performance of segmentation algorithms across different domains.</p>
</div>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p2.1">The COSAS (Cross-Organ and Cross-Scanner Adenocarcinoma Segmentation) challenge aims to develop and test strategies that enhance the resilience of computer-aided semantic segmentation to domain-shift, promoting reliable performance across various organs and scanners <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib3" title="">3</a>]</cite>. This challenge is a significant step in advancing AI and ML for routine diagnostic use in clinical labs and is the first to provide a platform for evaluating domain adaptation methods on a multi-organ, multi-scanner dataset.
 Specifically, Task 2 of the COSAS challenge focuses on assessing the generalization capabilities of algorithms in adenocarcinoma segmentation. It uses a diverse dataset of whole slide image patches of invasive breast carcinoma tissue from six different scanners. This task aims to push the boundaries of model development and promote robust solutions for real-world diagnostic applications in digital pathology.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multi-task learning based on stain separation</h3>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph"></h5>
<div class="ltx_para" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.10">Motivated by unsupervised learning based on stain separation, our approach for joint multi-task learning leverages stain separation to isolate the stain matrix <math alttext="W" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.1.m1.1d">italic_W</annotation></semantics></math> (stain color appearance) and stain map density <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.2.m2.1d">italic_H</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib4" title="">4</a>]</cite>. Given Beer-Lambert transformed image <math alttext="I\in R^{m\times n}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S2.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">I</mi><mo id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">R</mi><mrow id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1"><in id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.1"></in><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.2">𝐼</ci><apply id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.2">𝑅</ci><apply id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3"><times id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.1"></times><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.2">𝑚</ci><ci id="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.3.m3.1c">I\in R^{m\times n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.3.m3.1d">italic_I ∈ italic_R start_POSTSUPERSCRIPT italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS1.SSS0.Px1.p1.4.m4.1a"><mi id="S2.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.4.m4.1b"><ci id="S2.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.4.m4.1d">italic_m</annotation></semantics></math> is the number of channels, and <math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S2.SS1.SSS0.Px1.p1.5.m5.1a"><mi id="S2.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.5.m5.1b"><ci id="S2.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.5.m5.1d">italic_n</annotation></semantics></math> is the number of pixels, the image, <math alttext="I" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="S2.SS1.SSS0.Px1.p1.6.m6.1a"><mi id="S2.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.6.m6.1b"><ci id="S2.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.6.m6.1d">italic_I</annotation></semantics></math>, can be decomposed into <math alttext="HW" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S2.SS1.SSS0.Px1.p1.7.m7.1a"><mrow id="S2.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml">H</mi><mo id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.1" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1"><times id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.1"></times><ci id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.2">𝐻</ci><ci id="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.7.m7.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.7.m7.1c">HW</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.7.m7.1d">italic_H italic_W</annotation></semantics></math>. In this decomposition, the stain matrix <math alttext="W\in R^{m\times r}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="S2.SS1.SSS0.Px1.p1.8.m8.1a"><mrow id="S2.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml">W</mi><mo id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.1" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.2.cmml">R</mi><mrow id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.8.m8.1b"><apply id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1"><in id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.1"></in><ci id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.2">𝑊</ci><apply id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.2">𝑅</ci><apply id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3"><times id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.1"></times><ci id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2">𝑚</ci><ci id="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.8.m8.1c">W\in R^{m\times r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.8.m8.1d">italic_W ∈ italic_R start_POSTSUPERSCRIPT italic_m × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> represents the basis colors for each stain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib5" title="">5</a>]</cite> with <math alttext="r" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S2.SS1.SSS0.Px1.p1.9.m9.1a"><mi id="S2.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S2.SS1.SSS0.Px1.p1.9.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.9.m9.1b"><ci id="S2.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.9.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.9.m9.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.9.m9.1d">italic_r</annotation></semantics></math> being the number of stains. The stain density <math alttext="H\in R^{r\times n}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="S2.SS1.SSS0.Px1.p1.10.m10.1a"><mrow id="S2.SS1.SSS0.Px1.p1.10.m10.1.1" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.2" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml">H</mi><mo id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.1" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.2" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.2.cmml">R</mi><mrow id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2.cmml">r</mi><mo id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p1.10.m10.1b"><apply id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1"><in id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.1"></in><ci id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.2">𝐻</ci><apply id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.2">𝑅</ci><apply id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3"><times id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.1"></times><ci id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2">𝑟</ci><ci id="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p1.10.m10.1c">H\in R^{r\times n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p1.10.m10.1d">italic_H ∈ italic_R start_POSTSUPERSCRIPT italic_r × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> represents the concentration of stains at each pixel.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p2.5">By learning to separate these stain components, our model is designed to effectively capture histological structures from stain density and manage variations from the stain matrix, despite differences in scanner color bases. We implemented a multi-decoder AutoEncoder within a multi-task learning framework, where each decoder serves a specific function: 1) the stain matrix decoder (<math alttext="f_{m}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p2.1.m1.1a"><msub id="S2.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml">f</mi><mi id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.2">𝑓</ci><ci id="S2.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p2.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.1.m1.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>) predicts the stain matrix (<math alttext="\hat{W}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="S2.SS1.SSS0.Px1.p2.2.m2.1a"><mover accent="true" id="S2.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml">W</mi><mo id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.1" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1"><ci id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p2.2.m2.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.2.m2.1c">\hat{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.2.m2.1d">over^ start_ARG italic_W end_ARG</annotation></semantics></math>) to understand various colour styles at a pixel-wise level (<math alttext="\hat{W}\in R^{n\times m\times r}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p2.3.m3.1a"><mrow id="S2.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.cmml"><mover accent="true" id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml"><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.2" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.2.cmml">W</mi><mo id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.1" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mo id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.1" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.2" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.2.cmml">R</mi><mrow id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.cmml"><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.2" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.2.cmml">n</mi><mo id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.3" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.3.cmml">m</mi><mo id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.4" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.4.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.3.m3.1b"><apply id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1"><in id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.1"></in><apply id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2"><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.1">^</ci><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.2.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.2.2">𝑊</ci></apply><apply id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.2">𝑅</ci><apply id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3"><times id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.1"></times><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.2">𝑛</ci><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.3">𝑚</ci><ci id="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.4.cmml" xref="S2.SS1.SSS0.Px1.p2.3.m3.1.1.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.3.m3.1c">\hat{W}\in R^{n\times m\times r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.3.m3.1d">over^ start_ARG italic_W end_ARG ∈ italic_R start_POSTSUPERSCRIPT italic_n × italic_m × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math>), addressing inter-stain variance among pixels <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib5" title="">5</a>]</cite>. 2) the stain density decoder estimates the predicted stain density (<math alttext="\hat{H}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.4.m4.1"><semantics id="S2.SS1.SSS0.Px1.p2.4.m4.1a"><mover accent="true" id="S2.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml">H</mi><mo id="S2.SS1.SSS0.Px1.p2.4.m4.1.1.1" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="S2.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1"><ci id="S2.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p2.4.m4.1.1.2">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.4.m4.1c">\hat{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.4.m4.1d">over^ start_ARG italic_H end_ARG</annotation></semantics></math>). A classification header (<math alttext="f_{c}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="S2.SS1.SSS0.Px1.p2.5.m5.1a"><msub id="S2.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">f</mi><mi id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.3" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1.2">𝑓</ci><ci id="S2.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p2.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p2.5.m5.1c">f_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>) is then attached to the model, leveraging feature maps from both decoders for segmentation (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#S2.F1" title="Figure 1 ‣ 2.1 Multi-task learning based on stain separation ‣ 2 Methodology ‣ Understanding Stain Separation Improves Cross-Scanner Adenocarcinoma Segmentation with Joint Multi-Task Learning"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS0.Px1.p3">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p3.4">We hypothesized that if the stain matrix header (<math alttext="f_{h}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p3.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p3.1.m1.1a"><msub id="S2.SS1.SSS0.Px1.p3.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml">f</mi><mi id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p3.1.m1.1b"><apply id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1.2">𝑓</ci><ci id="S2.SS1.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p3.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p3.1.m1.1c">f_{h}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>) and stain density header (<math alttext="f_{d}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p3.2.m2.1"><semantics id="S2.SS1.SSS0.Px1.p3.2.m2.1a"><msub id="S2.SS1.SSS0.Px1.p3.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1.2.cmml">f</mi><mi id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p3.2.m2.1b"><apply id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1.2">𝑓</ci><ci id="S2.SS1.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p3.2.m2.1c">f_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p3.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>) effectively learn histological information, their corresponding convolutional neural network (CNN) kernels would be well-trained. Consequently, these well-trained kernels would generate information feature maps, especially for H&amp;E stained images. To utilize these outputs, we concatenated the predicted stain density and stain matrix (<math alttext="\hat{H},\hat{W}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p3.3.m3.2"><semantics id="S2.SS1.SSS0.Px1.p3.3.m3.2a"><mrow id="S2.SS1.SSS0.Px1.p3.3.m3.2.3.2" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.3.1.cmml"><mover accent="true" id="S2.SS1.SSS0.Px1.p3.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p3.3.m3.1.1.2" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1.2.cmml">H</mi><mo id="S2.SS1.SSS0.Px1.p3.3.m3.1.1.1" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1.1.cmml">^</mo></mover><mo id="S2.SS1.SSS0.Px1.p3.3.m3.2.3.2.1" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.3.1.cmml">,</mo><mover accent="true" id="S2.SS1.SSS0.Px1.p3.3.m3.2.2" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2.cmml"><mi id="S2.SS1.SSS0.Px1.p3.3.m3.2.2.2" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2.2.cmml">W</mi><mo id="S2.SS1.SSS0.Px1.p3.3.m3.2.2.1" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p3.3.m3.2b"><list id="S2.SS1.SSS0.Px1.p3.3.m3.2.3.1.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.3.2"><apply id="S2.SS1.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1"><ci id="S2.SS1.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.1.1.2">𝐻</ci></apply><apply id="S2.SS1.SSS0.Px1.p3.3.m3.2.2.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2"><ci id="S2.SS1.SSS0.Px1.p3.3.m3.2.2.1.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2.1">^</ci><ci id="S2.SS1.SSS0.Px1.p3.3.m3.2.2.2.cmml" xref="S2.SS1.SSS0.Px1.p3.3.m3.2.2.2">𝑊</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p3.3.m3.2c">\hat{H},\hat{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p3.3.m3.2d">over^ start_ARG italic_H end_ARG , over^ start_ARG italic_W end_ARG</annotation></semantics></math>) and fed them into the classification header, yielding pixel-wise logits (<math alttext="\hat{y}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p3.4.m4.1"><semantics id="S2.SS1.SSS0.Px1.p3.4.m4.1a"><mover accent="true" id="S2.SS1.SSS0.Px1.p3.4.m4.1.1" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p3.4.m4.1.1.2" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS0.Px1.p3.4.m4.1.1.1" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p3.4.m4.1b"><apply id="S2.SS1.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1"><ci id="S2.SS1.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p3.4.m4.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p3.4.m4.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p3.4.m4.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math>) for segmentation:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=f_{c}(\hat{H}\oplus\hat{W})" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mover accent="true" id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml">y</mi><mo id="S2.E1.m1.1.1.3.1" xref="S2.E1.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.3.2.cmml">f</mi><mi id="S2.E1.m1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.3.3.cmml">c</mi></msub><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.2.2.cmml">H</mi><mo id="S2.E1.m1.1.1.1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">⊕</mo><mover accent="true" id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">W</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></eq><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><ci id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3.1">^</ci><ci id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2">𝑦</ci></apply><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.3.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.3.3">𝑐</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2"><ci id="S2.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2">𝐻</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><ci id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1">^</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑊</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\hat{y}=f_{c}(\hat{H}\oplus\hat{W})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">over^ start_ARG italic_y end_ARG = italic_f start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( over^ start_ARG italic_H end_ARG ⊕ over^ start_ARG italic_W end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="348" id="S2.F1.g1" src="extracted/5867472/architecture.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Multi-decoder Unet architecture for joint multi-task learning</figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.SSS0.Px1.p4">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p4.5">For joint multi-task learning, we formulated the objective function (<math alttext="\mathcal{L}_{total}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.1.m1.1"><semantics id="S2.SS1.SSS0.Px1.p4.1.m1.1a"><msub id="S2.SS1.SSS0.Px1.p4.1.m1.1.1" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.2" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.2" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.2.cmml">t</mi><mo id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.3" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1a" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.4" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.4.cmml">t</mi><mo id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1b" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.5" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.5.cmml">a</mi><mo id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1c" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.6" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.1.m1.1b"><apply id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.2">ℒ</ci><apply id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3"><times id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.2">𝑡</ci><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.4">𝑡</ci><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.5.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.5">𝑎</ci><ci id="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.6.cmml" xref="S2.SS1.SSS0.Px1.p4.1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.1.m1.1c">\mathcal{L}_{total}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>) as a weighted average of two loss functions: reconstruction error (<math alttext="\mathcal{L}_{recon}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.2.m2.1"><semantics id="S2.SS1.SSS0.Px1.p4.2.m2.1a"><msub id="S2.SS1.SSS0.Px1.p4.2.m2.1.1" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.2" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.2" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.2.cmml">r</mi><mo id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.3" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1a" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.4" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.4.cmml">c</mi><mo id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1b" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.5" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.5.cmml">o</mi><mo id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1c" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.6" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.2.m2.1b"><apply id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.2">ℒ</ci><apply id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3"><times id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.2">𝑟</ci><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.4.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.4">𝑐</ci><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.5.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.5">𝑜</ci><ci id="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.6.cmml" xref="S2.SS1.SSS0.Px1.p4.2.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.2.m2.1c">\mathcal{L}_{recon}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math>), calculated from elementwise multiplication of <math alttext="\hat{H}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.3.m3.1"><semantics id="S2.SS1.SSS0.Px1.p4.3.m3.1a"><mover accent="true" id="S2.SS1.SSS0.Px1.p4.3.m3.1.1" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p4.3.m3.1.1.2" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1.2.cmml">H</mi><mo id="S2.SS1.SSS0.Px1.p4.3.m3.1.1.1" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.3.m3.1b"><apply id="S2.SS1.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1"><ci id="S2.SS1.SSS0.Px1.p4.3.m3.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p4.3.m3.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p4.3.m3.1.1.2">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.3.m3.1c">\hat{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.3.m3.1d">over^ start_ARG italic_H end_ARG</annotation></semantics></math> and <math alttext="\hat{W}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.4.m4.1"><semantics id="S2.SS1.SSS0.Px1.p4.4.m4.1a"><mover accent="true" id="S2.SS1.SSS0.Px1.p4.4.m4.1.1" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1.cmml"><mi id="S2.SS1.SSS0.Px1.p4.4.m4.1.1.2" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1.2.cmml">W</mi><mo id="S2.SS1.SSS0.Px1.p4.4.m4.1.1.1" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.4.m4.1b"><apply id="S2.SS1.SSS0.Px1.p4.4.m4.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1"><ci id="S2.SS1.SSS0.Px1.p4.4.m4.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1.1">^</ci><ci id="S2.SS1.SSS0.Px1.p4.4.m4.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p4.4.m4.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.4.m4.1c">\hat{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.4.m4.1d">over^ start_ARG italic_W end_ARG</annotation></semantics></math>, and the pixel-wise classification error (<math alttext="\mathcal{L}_{seg}" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.5.m5.1"><semantics id="S2.SS1.SSS0.Px1.p4.5.m5.1a"><msub id="S2.SS1.SSS0.Px1.p4.5.m5.1.1" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.2" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.2.cmml">ℒ</mi><mrow id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.cmml"><mi id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.2" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.2.cmml">s</mi><mo id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.3" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1a" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.4" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.5.m5.1b"><apply id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.2.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.2">ℒ</ci><apply id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3"><times id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.1"></times><ci id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.2.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.2">𝑠</ci><ci id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.3.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.4.cmml" xref="S2.SS1.SSS0.Px1.p4.5.m5.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.5.m5.1c">\mathcal{L}_{seg}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math>) for segmentation:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{total}=\alpha\mathcal{L}_{recon}+\mathcal{L}_{seg}" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.2.3.2" xref="S2.E2.m1.1.1.2.3.2.cmml">t</mi><mo id="S2.E2.m1.1.1.2.3.1" xref="S2.E2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.3.3" xref="S2.E2.m1.1.1.2.3.3.cmml">o</mi><mo id="S2.E2.m1.1.1.2.3.1a" xref="S2.E2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.3.4" xref="S2.E2.m1.1.1.2.3.4.cmml">t</mi><mo id="S2.E2.m1.1.1.2.3.1b" xref="S2.E2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.3.5" xref="S2.E2.m1.1.1.2.3.5.cmml">a</mi><mo id="S2.E2.m1.1.1.2.3.1c" xref="S2.E2.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.2.3.6" xref="S2.E2.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mrow id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">α</mi><mo id="S2.E2.m1.1.1.3.2.1" xref="S2.E2.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml"><mi id="S2.E2.m1.1.1.3.2.3.3.2" xref="S2.E2.m1.1.1.3.2.3.3.2.cmml">r</mi><mo id="S2.E2.m1.1.1.3.2.3.3.1" xref="S2.E2.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3.3" xref="S2.E2.m1.1.1.3.2.3.3.3.cmml">e</mi><mo id="S2.E2.m1.1.1.3.2.3.3.1a" xref="S2.E2.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3.4" xref="S2.E2.m1.1.1.3.2.3.3.4.cmml">c</mi><mo id="S2.E2.m1.1.1.3.2.3.3.1b" xref="S2.E2.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3.5" xref="S2.E2.m1.1.1.3.2.3.3.5.cmml">o</mi><mo id="S2.E2.m1.1.1.3.2.3.3.1c" xref="S2.E2.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3.6" xref="S2.E2.m1.1.1.3.2.3.3.6.cmml">n</mi></mrow></msub></mrow><mo id="S2.E2.m1.1.1.3.1" xref="S2.E2.m1.1.1.3.1.cmml">+</mo><msub id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.3.3.2" xref="S2.E2.m1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.3.3.3" xref="S2.E2.m1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.1.1.3.3.3.2" xref="S2.E2.m1.1.1.3.3.3.2.cmml">s</mi><mo id="S2.E2.m1.1.1.3.3.3.1" xref="S2.E2.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.3.3.3.3.cmml">e</mi><mo id="S2.E2.m1.1.1.3.3.3.1a" xref="S2.E2.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.3.3.4" xref="S2.E2.m1.1.1.3.3.3.4.cmml">g</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"></eq><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">ℒ</ci><apply id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3"><times id="S2.E2.m1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.2.3.1"></times><ci id="S2.E2.m1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.2.3.2">𝑡</ci><ci id="S2.E2.m1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.2.3.3">𝑜</ci><ci id="S2.E2.m1.1.1.2.3.4.cmml" xref="S2.E2.m1.1.1.2.3.4">𝑡</ci><ci id="S2.E2.m1.1.1.2.3.5.cmml" xref="S2.E2.m1.1.1.2.3.5">𝑎</ci><ci id="S2.E2.m1.1.1.2.3.6.cmml" xref="S2.E2.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><plus id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3.1"></plus><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><times id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2.1"></times><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝛼</ci><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2">ℒ</ci><apply id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3"><times id="S2.E2.m1.1.1.3.2.3.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3.3.1"></times><ci id="S2.E2.m1.1.1.3.2.3.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.3.2">𝑟</ci><ci id="S2.E2.m1.1.1.3.2.3.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3.3">𝑒</ci><ci id="S2.E2.m1.1.1.3.2.3.3.4.cmml" xref="S2.E2.m1.1.1.3.2.3.3.4">𝑐</ci><ci id="S2.E2.m1.1.1.3.2.3.3.5.cmml" xref="S2.E2.m1.1.1.3.2.3.3.5">𝑜</ci><ci id="S2.E2.m1.1.1.3.2.3.3.6.cmml" xref="S2.E2.m1.1.1.3.2.3.3.6">𝑛</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.3.3.2">ℒ</ci><apply id="S2.E2.m1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.3.3.3"><times id="S2.E2.m1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.3.3.3.1"></times><ci id="S2.E2.m1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.3.3.3.2">𝑠</ci><ci id="S2.E2.m1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.3.3.3.3">𝑒</ci><ci id="S2.E2.m1.1.1.3.3.3.4.cmml" xref="S2.E2.m1.1.1.3.3.3.4">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\mathcal{L}_{total}=\alpha\mathcal{L}_{recon}+\mathcal{L}_{seg}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT = italic_α caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c italic_o italic_n end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p4.6">Here, <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS1.SSS0.Px1.p4.6.m1.1"><semantics id="S2.SS1.SSS0.Px1.p4.6.m1.1a"><mi id="S2.SS1.SSS0.Px1.p4.6.m1.1.1" xref="S2.SS1.SSS0.Px1.p4.6.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS0.Px1.p4.6.m1.1b"><ci id="S2.SS1.SSS0.Px1.p4.6.m1.1.1.cmml" xref="S2.SS1.SSS0.Px1.p4.6.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS0.Px1.p4.6.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS0.Px1.p4.6.m1.1d">italic_α</annotation></semantics></math> denotes the coefficient for the reconstruction error, balancing the contributions of the two loss functions. Code is available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/4pygmalion/cosas" title="">https://github.com/4pygmalion/cosas</a></p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Mixture of stain augmentation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">To train a domain-generalized deep learning model, we created the realistic histopathologic image by mixing two stain augmentation methods: 1) RandStainNA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib6" title="">6</a>]</cite> and 2) stain separation-based stain augmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib7" title="">7</a>]</cite>. We mixed the augmentation probabilities by giving 0.25 to RandStainNA, and Stain separation based stain augmentation respectively. The stain separation-based augmentation technique uses SPCN (Structure-Preserving Color Normalization) to extract stain vectors and stain densities, modifying the stain vector’s color basis through random distribution. This approach produces realistic H&amp;E stained images while preserving essential histological information, as SPCN only alters the stain matrix in terms of <math alttext="H" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_H</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Training and inference configuration</h3>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph"></h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px1.p1.1">For the segmentation of adenocarcinoma, we employed a U-Net architecture built on a pretrained EfficientNet-B7 backbone derived from ImageNet1K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.13246v1#bib.bib9" title="">9</a>]</cite>. The model training involved four-fold stratified cross-validation using data from three different scanners. In addition to stain augmentation, we applied random vertical and horizontal flips to enhance generalization. Furthermore, test-time augmentation was conducted by randomly rotating input images in 90° increments, creating four possible orientations (90°, 180°, 270°, and 360°). The COSAS score was calculated using the average of the Dice score and IoU (intersection over union).</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model performance</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Our model achieved an average COSAS metric of 0.846 in a 4-fold stratified cross-validation, with a Dice score of 0.887 and an IoU score of 0.805. In preliminary testing, the model achieved a COSAS score of 0.8775, but ultimately stabilized at 0.792 in the final evaluation. Sensitivity analysis on the weight coefficients of the loss function showed that a value of 0.3 for <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_α</annotation></semantics></math> provided the optimal balance as determined by grid search.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The novelty of our methodology lies in the use of unsupervised learning for stain separation within a multi-task learning framework, enabling the model to effectively disentangle histological structures from color variations. By implementing a multi-head autoencoder that individually predicts stain matrix and stain density, our approach facilitates a more accurate understanding of color styles and tissue structures in heterogeneous scanner images. This integration into the classification header improves segmentation accuracy by exploiting rich histological information. Future work will aim to further optimize the stain augmentation techniques to improve generalization across even more diverse datasets, and to extend our approach to additional histopathological stain types beyond H&amp;E stains.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Stain separation, by isolating stain matrix and stain density through a multi-head autoencoder, enhances cross-scanner adenocarcinoma segmentation. This approach not only increases segmentation accuracy but also provides a robust solution to address domain shift in digital pathology.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS0.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.0.1 </span><span class="ltx_ERROR undefined" id="S5.SS0.SSS1.1.1">\discintname</span>
</h4>
<div class="ltx_para" id="S5.SS0.SSS1.p1">
<span class="ltx_ERROR undefined" id="S5.SS0.SSS1.p1.1">{credits}</span>
<p class="ltx_p" id="S5.SS0.SSS1.p1.2">None.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Niazi, M. K. K., Parwani, A. V., &amp; Gurcan, M. N. (2019). Digital pathology and artificial intelligence. The Lancet Oncology, 20(5), e253–e261. https://doi.org/10.1016/S1470-2045(19)30154-8

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Tiard, A., Wong, A., Ho, D. J., Wu, Y., Nof, E., Goh, A. C., … &amp; Nadeem, S. (2022). Stain-invariant self supervised learning for histopathology image analysis. arXiv preprint arXiv:2211.07590.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Grand Challenge: Cross-Organ and Cross-Scanner Adenocarcinoma Segmentation. (n.d.). Grand Challenge. https://cosas.grand-challenge.org/

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Moyes, A., Zhang, K., Ji, M., Zhou, H., &amp; Crookes, D. (2020). Unsupervised deep learning for stain separation and artifact detection in histopathology images. In Medical Image Understanding and Analysis: 24th Annual Conference, MIUA 2020, Oxford, UK, July 15-17, 2020, Proceedings 24 (pp. 221-234). Springer International Publishing

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Vahadane, A., Peng, T., Sethi, A., Albarqouni, S., Wang, L., Baust, M., … &amp; Navab, N. (2016). Structure-preserving color normalization and sparse stain separation for histological images. IEEE transactions on medical imaging, 35(8), 1962-1971.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Shen, Y., Luo, Y., Shen, D., &amp; Ke, J. (2022, September). Randstainna: Learning stain-agnostic features from histology slides by bridging stain augmentation and normalization. In International Conference on Medical Image Computing and Computer-Assisted Intervention (pp. 212-221). Cham: Springer Nature Switzerland.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Kim, Ho Heon, et al. "Stain augmentation using stain separation improves classification performance in heterogenetic H&amp;E stained histopathology breast cancer dataset" medRxiv (2024): 2024-09.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P., &amp; Brox, T. (2015). U-net: Convolutional networks for biomedical image segmentation. In Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18 (pp. 234-241). Springer International Publishing.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tan, M. (2019). Efficientnet: Rethinking model scaling for convolutional neural networks. arXiv preprint arXiv:1905.11946.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep 20 06:10:24 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
