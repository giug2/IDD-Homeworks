<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Zonghan Yang
    <sup class="ltx_sup" id="id14.10.id1">
     <span class="ltx_text ltx_font_italic" id="id14.10.id1.1">
      1,2
     </span>
    </sup>
    , Peng Li
    <sup class="ltx_sup" id="id15.11.id2">
     <span class="ltx_text ltx_font_italic" id="id15.11.id2.1">
      2∗
     </span>
    </sup>
    , Ming Yan
    <sup class="ltx_sup" id="id16.12.id3">
     <span class="ltx_text ltx_font_italic" id="id16.12.id3.1">
      3
     </span>
    </sup>
    , Ji Zhang
    <sup class="ltx_sup" id="id17.13.id4">
     <span class="ltx_text ltx_font_italic" id="id17.13.id4.1">
      3
     </span>
    </sup>
    , Fei Huang
    <sup class="ltx_sup" id="id18.14.id5">
     <span class="ltx_text ltx_font_italic" id="id18.14.id5.1">
      3
     </span>
    </sup>
    , Yang Liu
    <sup class="ltx_sup" id="id19.15.id6">
     <span class="ltx_text ltx_font_italic" id="id19.15.id6.1">
      1,2
     </span>
    </sup>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id20.16.id7">
     1
    </sup>
    Department of Computer Science and Technology, Tsinghua University, Beijing, China
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id21.17.id8">
     2
    </sup>
    Institute for AI Industry Research (AIR), Tsinghua University, Beijing, China
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id22.18.id9">
     3
    </sup>
    Institute of Intelligent Computing, Alibaba Group
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id23.19.id10">
     yangzh20@mails.tsinghua.edu.cn
    </span>
   </span>
   <span class="ltx_author_notes">
    Corresponding authors: P.L. (lipeng@air.tsinghua.edu.cn) and Y.L. (liuyang2011@tsinghua.edu.cn)
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id13.4">
   Language agents have demonstrated autonomous decision-making abilities by reasoning with foundation models. Recently, efforts have been made to train language agents for performance improvement, with multi-step reasoning and action trajectories as the training data. However, collecting such trajectories still requires considerable human effort, by either artificial annotation or implementations of diverse prompting frameworks. In this work, we propose
   <span class="ltx_text ltx_font_bold" id="id10.1.1">
    A
    <sup class="ltx_sup" id="id10.1.1.1">
     3
    </sup>
    T
   </span>
   , a framework that enables the
   <span class="ltx_text ltx_font_bold" id="id13.4.2">
    A
   </span>
   utonomous
   <span class="ltx_text ltx_font_bold" id="id13.4.3">
    A
   </span>
   nnotation of
   <span class="ltx_text ltx_font_bold" id="id13.4.4">
    A
   </span>
   gent
   <span class="ltx_text ltx_font_bold" id="id13.4.5">
    T
   </span>
   rajectories in the style of ReAct. The central role is an ActRe prompting agent, which explains the reason for an arbitrary action. When randomly sampling an external action, the ReAct-style agent could query the ActRe agent with the action to obtain its textual rationales. Novel trajectories are then synthesized by prepending the posterior reasoning from ActRe to the sampled action. In this way, the ReAct-style agent executes multiple trajectories for the failed tasks, and selects the successful ones to supplement its failed trajectory for contrastive self-training. Realized by policy gradient methods with binarized rewards, the contrastive self-training with accumulated trajectories facilitates a closed loop for multiple rounds of language agent self-improvement. We conduct experiments using QLoRA fine-tuning with the open-sourced Mistral-7B-Instruct-v0.2. In AlfWorld, the agent trained with A
   <sup class="ltx_sup" id="id13.4.6">
    3
   </sup>
   T obtains a 1-shot success rate of 96%, and 100% success with 4 iterative rounds. In WebShop, the 1-shot performance of the A
   <sup class="ltx_sup" id="id13.4.7">
    3
   </sup>
   T agent matches human average, and 4 rounds of iterative refinement lead to the performance approaching human experts. A
   <sup class="ltx_sup" id="id13.4.8">
    3
   </sup>
   T agents significantly outperform existing techniques, including prompting with GPT-4, advanced agent frameworks, and fully fine-tuned LLMs.
  </p>
 </div>
 <figure class="ltx_figure" id="S0.F1">
  <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="267" id="S0.F1.g1" src="/html/2403.14589/assets/x1.png" width="422"/>
  <figcaption class="ltx_caption ltx_centering">
   <span class="ltx_tag ltx_tag_figure">
    Figure 1:
   </span>
   Upper: Two common paradigms to collect trajectories for language agents. (a) Trajectories are artificially annotated as human demonstrations. (b) Trajectories are gathered by deploying policy agents that reason and act in the language form. However, both paradigms require considerable human effort in either data annotation or different implementations of agent frameworks, thus lacking scalability in the data collection process. Lower: (c) Our
   <span class="ltx_text ltx_font_bold" id="S0.F1.3.1">
    A
    <sup class="ltx_sup" id="S0.F1.3.1.1">
     3
    </sup>
    T
   </span>
   framework.
   <span class="ltx_text ltx_font_bold" id="S0.F1.4.2">
    A
    <sup class="ltx_sup" id="S0.F1.4.2.1">
     3
    </sup>
    T
   </span>
   enables the
   <span class="ltx_text ltx_font_bold" id="S0.F1.9.3">
    A
   </span>
   utonomous
   <span class="ltx_text ltx_font_bold" id="S0.F1.10.4">
    A
   </span>
   nnotation of
   <span class="ltx_text ltx_font_bold" id="S0.F1.11.5">
    A
   </span>
   gent
   <span class="ltx_text ltx_font_bold" id="S0.F1.12.6">
    T
   </span>
   rajectories in ReAct style with an ActRe agent, facilitating the closed loop of contrastive self-training.
  </figcaption>
 </figure>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para ltx_noindent" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    The rapid development of Large Language Models (LLMs)
    <cite class="ltx_cite ltx_citemacro_citep">
     (OpenAI,
     <a class="ltx_ref" href="#bib.bib15" title="">
      2023
     </a>
     ; Touvron et al.,
     <a class="ltx_ref" href="#bib.bib24" title="">
      2023
     </a>
     ; Team et al.,
     <a class="ltx_ref" href="#bib.bib23" title="">
      2023
     </a>
     ; Jiang et al.,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2024
     </a>
     )
    </cite>
    has led to the prosperity of language agents. Leveraging the ability of LLMs, language agents have demonstrated impressive performances in diverse decision-making scenarios by interacting with the environments autonomously
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wang et al.,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023
     </a>
     ; Mirchandani et al.,
     <a class="ltx_ref" href="#bib.bib14" title="">
      2023
     </a>
     ; Zheng et al.,
     <a class="ltx_ref" href="#bib.bib36" title="">
      2024
     </a>
     ; Wu et al.,
     <a class="ltx_ref" href="#bib.bib28" title="">
      2024
     </a>
     )
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Recently, increasing efforts have been made to train language agents with open-sourced LLMs. The multi-step trajectories that describe the entire task-solving process of a language agent are used as training data, which consist of environmental observations, internal reasoning texts, and external actions. The collection of such trajectories is therefore essential, which are currently categorized into two paradigms in Fig.
    <a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (a) and (b). The first paradigm is to leverage expert demonstrations
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yao et al.,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2022
     </a>
     )
    </cite>
    . However, the expense of human labor hampers the scalability of the approach. Another paradigm is implementing different agent frameworks to gather diverse trajectories with proprietary LLMs
    <cite class="ltx_cite ltx_citemacro_citep">
     (Qin et al.,
     <a class="ltx_ref" href="#bib.bib17" title="">
      2023
     </a>
     ; Zeng et al.,
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     ; Chen et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2023
     </a>
     ; Aksitov et al.,
     <a class="ltx_ref" href="#bib.bib1" title="">
      2023
     </a>
     )
    </cite>
    . However, the exploration coverage in the training data is still upper-bounded by the full set of prompting techniques. Besides, implementing diverse agent frameworks requires considerable human efforts and proprietary LLM calls
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yang et al.,
     <a class="ltx_ref" href="#bib.bib29" title="">
      2024
     </a>
     )
    </cite>
    . To ease the data collection process in diverse scenarios,
    <cite class="ltx_cite ltx_citemacro_cite">
     Yin et al. (
     <a class="ltx_ref" href="#bib.bib32" title="">
      2023
     </a>
     )
    </cite>
    and
    <cite class="ltx_cite ltx_citemacro_cite">
     Zhang et al. (
     <a class="ltx_ref" href="#bib.bib35" title="">
      2024
     </a>
     )
    </cite>
    propose unified data formats by elucidating the comprising submodules in agent trajectories. However, as obtained by converting human-annotated data or one single defaulted prompting scheme, the agent trajectories are still limited in diversity and scalability. Considering that an environment automatically returns observations and rewards with action inputs, it should serve as an infinite data generator. While
    <cite class="ltx_cite ltx_citemacro_cite">
     Song et al. (
     <a class="ltx_ref" href="#bib.bib22" title="">
      2024
     </a>
     )
    </cite>
    propose an exploration-based agent framework for self-improvement, the gathered trajectories consist of only interleaved external actions and environmental observations, without textual rationales that could steer better behavior of language agents. We ask the following question:
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">
     Can a language agent autonomously gather high-quality trajectories, with textual annotations suitable for its further training?
    </span>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    In this work, we propose A
    <sup class="ltx_sup" id="S1.p3.1.1">
     3
    </sup>
    T, a framework that enables Autonomous Annotation of Agent Trajectories in the style of ReAct
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yao et al.,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2023
     </a>
     )
    </cite>
    for self-improvement with minimal human supervision. The central idea is to exploit both the in-context language ability and the decision-making ability of a language agent: To collect diverse trajectories, an agent could randomly sample external actions from the action space at arbitrary steps. However, the corresponding reason for the sampled action should be annotated for a ReAct-style agent. To facilitate this, we propose ActRe, an act-then-reason prompting agent that explains the reason for the sampled action. With ActRe, the ReAct-style agent composes extra reason-then-act trajectories for each failed task by inversely prepending the ActRe-prompted reason to the randomly sampled action. After the execution of each composed trajectory, the agent receives a terminal reward from the environment, which automatically annotates the quality of the trajectory.
The gathered successful trajectories are then supplemented with the failed trajectory by the ReAct-style agent alone for contrastive self-training, where we use policy gradient methods
    <cite class="ltx_cite ltx_citemacro_citep">
     (Williams,
     <a class="ltx_ref" href="#bib.bib27" title="">
      1992
     </a>
     )
    </cite>
    with binarized rewards for LLM fine-tuning. As new agents are trained, more trajectories can be gathered and accumulated, which forms a closed loop for the self-improvement of language agents as shown in Fig.
    <a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    -(c).
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p4">
   <p class="ltx_p" id="S1.p4.2">
    We validate our A
    <sup class="ltx_sup" id="S1.p4.2.1">
     3
    </sup>
    T framework in the textual embodied environment AlfWorld
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shridhar et al.,
     <a class="ltx_ref" href="#bib.bib20" title="">
      2021
     </a>
     )
    </cite>
    and the online shopping environment WebShop
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yao et al.,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2022
     </a>
     )
    </cite>
    . We use QLoRA
    <cite class="ltx_cite ltx_citemacro_citep">
     (Dettmers et al.,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2023
     </a>
     )
    </cite>
    to fine-tune Mistral-7B-Instruct-v0.2
    <cite class="ltx_cite ltx_citemacro_citep">
     (Jiang et al.,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023
     </a>
     )
    </cite>
    in the training experiments.
Experimental performances demonstrate significant improvement over state-of-the-art agent techniques: On AlfWorld, our trained agent achieves a 96% success rate in unseen scenarios with a single trial. On WebShop, the success rate of our agent reaches 49%, which matches the average human performance (50%). In the setting of iterative refinement, after four rounds of data collection and contrastive self-training, the accumulated success rate becomes 100% on AlfWorld and 54.8% on WebShop, narrowing the gap with human experts (59.6% on WebShop). A
    <sup class="ltx_sup" id="S1.p4.2.2">
     3
    </sup>
    T paves the way for agents with improved autonomy through the closed loop of self-annotation and contrastive self-training.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   <span class="ltx_text ltx_font_bold" id="S2.1.1">
    A
    <sup class="ltx_sup" id="S2.1.1.1">
     3
    </sup>
    T
   </span>
   for Closed-Loop Self-Improvement
  </h2>
  <div class="ltx_para ltx_noindent" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    In this section, we introduce the closed-loop self-improvement for agents facilitated by the A
    <sup class="ltx_sup" id="S2.p1.1.1">
     3
    </sup>
    T framework. The loop contains two parts: autonomous trajectory annotation with the ActRe agent (Sec.
    <a class="ltx_ref" href="#S2.SS1" title="2.1 Autonomous Trajectory Annotation with ActRe ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      2.1
     </span>
    </a>
    ), and the contrastive self-training process (Sec.
    <a class="ltx_ref" href="#S2.SS2" title="2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      2.2
     </span>
    </a>
    ).
   </p>
  </div>
  <section class="ltx_subsection" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    Autonomous Trajectory Annotation with ActRe
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.1">
     Agents are able to gather diverse trajectories by exploration. However, for language agents like ReAct, the actions are inferred by first reasoning with LLMs. When the agent randomly samples an action that differs from the self-inferred one, a modified reason is needed to compose a full reason-then-act trajectory.
     <cite class="ltx_cite ltx_citemacro_cite">
      Yao et al. (
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      )
     </cite>
     show that humans can modify the reasoning in the trajectory and prompt a ReAct-style agent for desirable actions. As humans can provide in-progress supervision, such a human-in-the-loop process still lacks scalability.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S2.SS1.p2">
    <p class="ltx_p" id="S2.SS1.p2.1">
     To automate the process, we propose a complementary ActRe prompting agent to synthesize the modified reasons by leveraging the in-context language ability of an LLM. ActRe inverts the causality of ReAct: while ReAct conditions the external action with a reason
     <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.1">
      a priori
     </span>
     , ActRe explains the reason
     <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.2">
      a posteriori
     </span>
     for an external action. The synergy of ActRe with ReAct facilitates the autonomous annotation of textual reasons: when the language agent randomly samples an external action, the reason for the sampled action is obtained by querying the ActRe prompting agent. The synthetic reason is then used as the condition of the sampled action for the ReAct-style agent. The progress of a trajectory is synchronized between the ReAct-style agent and the ActRe prompting agent, with the only difference in the order of intermediate reasoning and actions. The detailed workings are depicted below:
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S2.SS1.p3">
    <p class="ltx_p" id="S2.SS1.p3.4">
     Denote
     <math alttext="o_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1">
      <semantics id="S2.SS1.p3.1.m1.1a">
       <msub id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">
        <mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">
         o
        </mi>
        <mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b">
        <apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">
          𝑜
         </ci>
         <ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">
        o_{t}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="RS_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1">
      <semantics id="S2.SS1.p3.2.m2.1a">
       <mrow id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">
        <mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">
         R
        </mi>
        <mo id="S2.SS1.p3.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.2.m2.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">
         <mi id="S2.SS1.p3.2.m2.1.1.3.2" xref="S2.SS1.p3.2.m2.1.1.3.2.cmml">
          S
         </mi>
         <mi id="S2.SS1.p3.2.m2.1.1.3.3" xref="S2.SS1.p3.2.m2.1.1.3.3.cmml">
          t
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b">
        <apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">
         <times id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1">
         </times>
         <ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">
          𝑅
         </ci>
         <apply id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.3.1.cmml" xref="S2.SS1.p3.2.m2.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS1.p3.2.m2.1.1.3.2.cmml" xref="S2.SS1.p3.2.m2.1.1.3.2">
           𝑆
          </ci>
          <ci id="S2.SS1.p3.2.m2.1.1.3.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3.3">
           𝑡
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">
        RS_{t}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="EA_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1">
      <semantics id="S2.SS1.p3.3.m3.1a">
       <mrow id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">
        <mi id="S2.SS1.p3.3.m3.1.1.2" xref="S2.SS1.p3.3.m3.1.1.2.cmml">
         E
        </mi>
        <mo id="S2.SS1.p3.3.m3.1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.3.m3.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml">
         <mi id="S2.SS1.p3.3.m3.1.1.3.2" xref="S2.SS1.p3.3.m3.1.1.3.2.cmml">
          A
         </mi>
         <mi id="S2.SS1.p3.3.m3.1.1.3.3" xref="S2.SS1.p3.3.m3.1.1.3.3.cmml">
          t
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b">
        <apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">
         <times id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1">
         </times>
         <ci id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2">
          𝐸
         </ci>
         <apply id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.p3.3.m3.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS1.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.p3.3.m3.1.1.3.2">
           𝐴
          </ci>
          <ci id="S2.SS1.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3.3">
           𝑡
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">
        EA_{t}
       </annotation>
      </semantics>
     </math>
     as the environmental observation, internal reasoning, and external action at the
     <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.1">
      <semantics id="S2.SS1.p3.4.m4.1a">
       <mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b">
        <ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">
        t
       </annotation>
      </semantics>
     </math>
     -th step, respectively. The trajectory of a ReAct-style agent reads:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="...,\,o_{t},\,RS_{t},\,EA_{t},\,o_{t+1},\,RS_{t+1},\,EA_{t+1},\,..." class="ltx_math_unparsed" display="block" id="S2.Ex1.m1.1">
         <semantics id="S2.Ex1.m1.1a">
          <mrow id="S2.Ex1.m1.1b">
           <mo id="S2.Ex1.m1.1.1" rspace="0.0835em">
            .
           </mo>
           <mo id="S2.Ex1.m1.1.2" lspace="0.0835em" rspace="0.0835em">
            .
           </mo>
           <mo id="S2.Ex1.m1.1.3" lspace="0.0835em" rspace="0.167em">
            .
           </mo>
           <mo id="S2.Ex1.m1.1.4" rspace="0.337em">
            ,
           </mo>
           <msub id="S2.Ex1.m1.1.5">
            <mi id="S2.Ex1.m1.1.5.2">
             o
            </mi>
            <mi id="S2.Ex1.m1.1.5.3">
             t
            </mi>
           </msub>
           <mo id="S2.Ex1.m1.1.6" rspace="0.337em">
            ,
           </mo>
           <mi id="S2.Ex1.m1.1.7">
            R
           </mi>
           <msub id="S2.Ex1.m1.1.8">
            <mi id="S2.Ex1.m1.1.8.2">
             S
            </mi>
            <mi id="S2.Ex1.m1.1.8.3">
             t
            </mi>
           </msub>
           <mo id="S2.Ex1.m1.1.9" rspace="0.337em">
            ,
           </mo>
           <mi id="S2.Ex1.m1.1.10">
            E
           </mi>
           <msub id="S2.Ex1.m1.1.11">
            <mi id="S2.Ex1.m1.1.11.2">
             A
            </mi>
            <mi id="S2.Ex1.m1.1.11.3">
             t
            </mi>
           </msub>
           <mo id="S2.Ex1.m1.1.12" rspace="0.337em">
            ,
           </mo>
           <msub id="S2.Ex1.m1.1.13">
            <mi id="S2.Ex1.m1.1.13.2">
             o
            </mi>
            <mrow id="S2.Ex1.m1.1.13.3">
             <mi id="S2.Ex1.m1.1.13.3.2">
              t
             </mi>
             <mo id="S2.Ex1.m1.1.13.3.1">
              +
             </mo>
             <mn id="S2.Ex1.m1.1.13.3.3">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S2.Ex1.m1.1.14" rspace="0.337em">
            ,
           </mo>
           <mi id="S2.Ex1.m1.1.15">
            R
           </mi>
           <msub id="S2.Ex1.m1.1.16">
            <mi id="S2.Ex1.m1.1.16.2">
             S
            </mi>
            <mrow id="S2.Ex1.m1.1.16.3">
             <mi id="S2.Ex1.m1.1.16.3.2">
              t
             </mi>
             <mo id="S2.Ex1.m1.1.16.3.1">
              +
             </mo>
             <mn id="S2.Ex1.m1.1.16.3.3">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S2.Ex1.m1.1.17" rspace="0.337em">
            ,
           </mo>
           <mi id="S2.Ex1.m1.1.18">
            E
           </mi>
           <msub id="S2.Ex1.m1.1.19">
            <mi id="S2.Ex1.m1.1.19.2">
             A
            </mi>
            <mrow id="S2.Ex1.m1.1.19.3">
             <mi id="S2.Ex1.m1.1.19.3.2">
              t
             </mi>
             <mo id="S2.Ex1.m1.1.19.3.1">
              +
             </mo>
             <mn id="S2.Ex1.m1.1.19.3.3">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S2.Ex1.m1.1.20" rspace="0.337em">
            ,
           </mo>
           <mi id="S2.Ex1.m1.1.21" mathvariant="normal">
            …
           </mi>
          </mrow>
          <annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">
           ...,\,o_{t},\,RS_{t},\,EA_{t},\,o_{t+1},\,RS_{t+1},\,EA_{t+1},\,...
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS1.p3.13">
     The synchronized ActRe prompting agent has the following trajectory:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="...,\,o_{t},\,EA_{t},\,RS_{t},\,o_{t+1},\,EA_{t+1},\,RS_{t+1},\,..." class="ltx_Math" display="block" id="S2.Ex2.m1.8">
         <semantics id="S2.Ex2.m1.8a">
          <mrow id="S2.Ex2.m1.8.8.6" xref="S2.Ex2.m1.8.8.7.cmml">
           <mi id="S2.Ex2.m1.1.1" mathvariant="normal" xref="S2.Ex2.m1.1.1.cmml">
            …
           </mi>
           <mo id="S2.Ex2.m1.8.8.6.7" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <msub id="S2.Ex2.m1.3.3.1.1" xref="S2.Ex2.m1.3.3.1.1.cmml">
            <mi id="S2.Ex2.m1.3.3.1.1.2" xref="S2.Ex2.m1.3.3.1.1.2.cmml">
             o
            </mi>
            <mi id="S2.Ex2.m1.3.3.1.1.3" xref="S2.Ex2.m1.3.3.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="S2.Ex2.m1.8.8.6.8" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <mrow id="S2.Ex2.m1.4.4.2.2" xref="S2.Ex2.m1.4.4.2.2.cmml">
            <mi id="S2.Ex2.m1.4.4.2.2.2" xref="S2.Ex2.m1.4.4.2.2.2.cmml">
             E
            </mi>
            <mo id="S2.Ex2.m1.4.4.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex2.m1.4.4.2.2.1.cmml">
             ​
            </mo>
            <msub id="S2.Ex2.m1.4.4.2.2.3" xref="S2.Ex2.m1.4.4.2.2.3.cmml">
             <mi id="S2.Ex2.m1.4.4.2.2.3.2" xref="S2.Ex2.m1.4.4.2.2.3.2.cmml">
              A
             </mi>
             <mi id="S2.Ex2.m1.4.4.2.2.3.3" xref="S2.Ex2.m1.4.4.2.2.3.3.cmml">
              t
             </mi>
            </msub>
           </mrow>
           <mo id="S2.Ex2.m1.8.8.6.9" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <mrow id="S2.Ex2.m1.5.5.3.3" xref="S2.Ex2.m1.5.5.3.3.cmml">
            <mi id="S2.Ex2.m1.5.5.3.3.2" xref="S2.Ex2.m1.5.5.3.3.2.cmml">
             R
            </mi>
            <mo id="S2.Ex2.m1.5.5.3.3.1" lspace="0em" rspace="0em" xref="S2.Ex2.m1.5.5.3.3.1.cmml">
             ​
            </mo>
            <msub id="S2.Ex2.m1.5.5.3.3.3" xref="S2.Ex2.m1.5.5.3.3.3.cmml">
             <mi id="S2.Ex2.m1.5.5.3.3.3.2" xref="S2.Ex2.m1.5.5.3.3.3.2.cmml">
              S
             </mi>
             <mi id="S2.Ex2.m1.5.5.3.3.3.3" xref="S2.Ex2.m1.5.5.3.3.3.3.cmml">
              t
             </mi>
            </msub>
           </mrow>
           <mo id="S2.Ex2.m1.8.8.6.10" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <msub id="S2.Ex2.m1.6.6.4.4" xref="S2.Ex2.m1.6.6.4.4.cmml">
            <mi id="S2.Ex2.m1.6.6.4.4.2" xref="S2.Ex2.m1.6.6.4.4.2.cmml">
             o
            </mi>
            <mrow id="S2.Ex2.m1.6.6.4.4.3" xref="S2.Ex2.m1.6.6.4.4.3.cmml">
             <mi id="S2.Ex2.m1.6.6.4.4.3.2" xref="S2.Ex2.m1.6.6.4.4.3.2.cmml">
              t
             </mi>
             <mo id="S2.Ex2.m1.6.6.4.4.3.1" xref="S2.Ex2.m1.6.6.4.4.3.1.cmml">
              +
             </mo>
             <mn id="S2.Ex2.m1.6.6.4.4.3.3" xref="S2.Ex2.m1.6.6.4.4.3.3.cmml">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S2.Ex2.m1.8.8.6.11" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <mrow id="S2.Ex2.m1.7.7.5.5" xref="S2.Ex2.m1.7.7.5.5.cmml">
            <mi id="S2.Ex2.m1.7.7.5.5.2" xref="S2.Ex2.m1.7.7.5.5.2.cmml">
             E
            </mi>
            <mo id="S2.Ex2.m1.7.7.5.5.1" lspace="0em" rspace="0em" xref="S2.Ex2.m1.7.7.5.5.1.cmml">
             ​
            </mo>
            <msub id="S2.Ex2.m1.7.7.5.5.3" xref="S2.Ex2.m1.7.7.5.5.3.cmml">
             <mi id="S2.Ex2.m1.7.7.5.5.3.2" xref="S2.Ex2.m1.7.7.5.5.3.2.cmml">
              A
             </mi>
             <mrow id="S2.Ex2.m1.7.7.5.5.3.3" xref="S2.Ex2.m1.7.7.5.5.3.3.cmml">
              <mi id="S2.Ex2.m1.7.7.5.5.3.3.2" xref="S2.Ex2.m1.7.7.5.5.3.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex2.m1.7.7.5.5.3.3.1" xref="S2.Ex2.m1.7.7.5.5.3.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex2.m1.7.7.5.5.3.3.3" xref="S2.Ex2.m1.7.7.5.5.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mo id="S2.Ex2.m1.8.8.6.12" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <mrow id="S2.Ex2.m1.8.8.6.6" xref="S2.Ex2.m1.8.8.6.6.cmml">
            <mi id="S2.Ex2.m1.8.8.6.6.2" xref="S2.Ex2.m1.8.8.6.6.2.cmml">
             R
            </mi>
            <mo id="S2.Ex2.m1.8.8.6.6.1" lspace="0em" rspace="0em" xref="S2.Ex2.m1.8.8.6.6.1.cmml">
             ​
            </mo>
            <msub id="S2.Ex2.m1.8.8.6.6.3" xref="S2.Ex2.m1.8.8.6.6.3.cmml">
             <mi id="S2.Ex2.m1.8.8.6.6.3.2" xref="S2.Ex2.m1.8.8.6.6.3.2.cmml">
              S
             </mi>
             <mrow id="S2.Ex2.m1.8.8.6.6.3.3" xref="S2.Ex2.m1.8.8.6.6.3.3.cmml">
              <mi id="S2.Ex2.m1.8.8.6.6.3.3.2" xref="S2.Ex2.m1.8.8.6.6.3.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex2.m1.8.8.6.6.3.3.1" xref="S2.Ex2.m1.8.8.6.6.3.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex2.m1.8.8.6.6.3.3.3" xref="S2.Ex2.m1.8.8.6.6.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mo id="S2.Ex2.m1.8.8.6.13" rspace="0.337em" xref="S2.Ex2.m1.8.8.7.cmml">
            ,
           </mo>
           <mi id="S2.Ex2.m1.2.2" mathvariant="normal" xref="S2.Ex2.m1.2.2.cmml">
            …
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.8b">
           <list id="S2.Ex2.m1.8.8.7.cmml" xref="S2.Ex2.m1.8.8.6">
            <ci id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">
             …
            </ci>
            <apply id="S2.Ex2.m1.3.3.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1">
             <csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1">
              subscript
             </csymbol>
             <ci id="S2.Ex2.m1.3.3.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.2">
              𝑜
             </ci>
             <ci id="S2.Ex2.m1.3.3.1.1.3.cmml" xref="S2.Ex2.m1.3.3.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S2.Ex2.m1.4.4.2.2.cmml" xref="S2.Ex2.m1.4.4.2.2">
             <times id="S2.Ex2.m1.4.4.2.2.1.cmml" xref="S2.Ex2.m1.4.4.2.2.1">
             </times>
             <ci id="S2.Ex2.m1.4.4.2.2.2.cmml" xref="S2.Ex2.m1.4.4.2.2.2">
              𝐸
             </ci>
             <apply id="S2.Ex2.m1.4.4.2.2.3.cmml" xref="S2.Ex2.m1.4.4.2.2.3">
              <csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.2.2.3.1.cmml" xref="S2.Ex2.m1.4.4.2.2.3">
               subscript
              </csymbol>
              <ci id="S2.Ex2.m1.4.4.2.2.3.2.cmml" xref="S2.Ex2.m1.4.4.2.2.3.2">
               𝐴
              </ci>
              <ci id="S2.Ex2.m1.4.4.2.2.3.3.cmml" xref="S2.Ex2.m1.4.4.2.2.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <apply id="S2.Ex2.m1.5.5.3.3.cmml" xref="S2.Ex2.m1.5.5.3.3">
             <times id="S2.Ex2.m1.5.5.3.3.1.cmml" xref="S2.Ex2.m1.5.5.3.3.1">
             </times>
             <ci id="S2.Ex2.m1.5.5.3.3.2.cmml" xref="S2.Ex2.m1.5.5.3.3.2">
              𝑅
             </ci>
             <apply id="S2.Ex2.m1.5.5.3.3.3.cmml" xref="S2.Ex2.m1.5.5.3.3.3">
              <csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.3.3.3.1.cmml" xref="S2.Ex2.m1.5.5.3.3.3">
               subscript
              </csymbol>
              <ci id="S2.Ex2.m1.5.5.3.3.3.2.cmml" xref="S2.Ex2.m1.5.5.3.3.3.2">
               𝑆
              </ci>
              <ci id="S2.Ex2.m1.5.5.3.3.3.3.cmml" xref="S2.Ex2.m1.5.5.3.3.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <apply id="S2.Ex2.m1.6.6.4.4.cmml" xref="S2.Ex2.m1.6.6.4.4">
             <csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.4.4.1.cmml" xref="S2.Ex2.m1.6.6.4.4">
              subscript
             </csymbol>
             <ci id="S2.Ex2.m1.6.6.4.4.2.cmml" xref="S2.Ex2.m1.6.6.4.4.2">
              𝑜
             </ci>
             <apply id="S2.Ex2.m1.6.6.4.4.3.cmml" xref="S2.Ex2.m1.6.6.4.4.3">
              <plus id="S2.Ex2.m1.6.6.4.4.3.1.cmml" xref="S2.Ex2.m1.6.6.4.4.3.1">
              </plus>
              <ci id="S2.Ex2.m1.6.6.4.4.3.2.cmml" xref="S2.Ex2.m1.6.6.4.4.3.2">
               𝑡
              </ci>
              <cn id="S2.Ex2.m1.6.6.4.4.3.3.cmml" type="integer" xref="S2.Ex2.m1.6.6.4.4.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="S2.Ex2.m1.7.7.5.5.cmml" xref="S2.Ex2.m1.7.7.5.5">
             <times id="S2.Ex2.m1.7.7.5.5.1.cmml" xref="S2.Ex2.m1.7.7.5.5.1">
             </times>
             <ci id="S2.Ex2.m1.7.7.5.5.2.cmml" xref="S2.Ex2.m1.7.7.5.5.2">
              𝐸
             </ci>
             <apply id="S2.Ex2.m1.7.7.5.5.3.cmml" xref="S2.Ex2.m1.7.7.5.5.3">
              <csymbol cd="ambiguous" id="S2.Ex2.m1.7.7.5.5.3.1.cmml" xref="S2.Ex2.m1.7.7.5.5.3">
               subscript
              </csymbol>
              <ci id="S2.Ex2.m1.7.7.5.5.3.2.cmml" xref="S2.Ex2.m1.7.7.5.5.3.2">
               𝐴
              </ci>
              <apply id="S2.Ex2.m1.7.7.5.5.3.3.cmml" xref="S2.Ex2.m1.7.7.5.5.3.3">
               <plus id="S2.Ex2.m1.7.7.5.5.3.3.1.cmml" xref="S2.Ex2.m1.7.7.5.5.3.3.1">
               </plus>
               <ci id="S2.Ex2.m1.7.7.5.5.3.3.2.cmml" xref="S2.Ex2.m1.7.7.5.5.3.3.2">
                𝑡
               </ci>
               <cn id="S2.Ex2.m1.7.7.5.5.3.3.3.cmml" type="integer" xref="S2.Ex2.m1.7.7.5.5.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
            <apply id="S2.Ex2.m1.8.8.6.6.cmml" xref="S2.Ex2.m1.8.8.6.6">
             <times id="S2.Ex2.m1.8.8.6.6.1.cmml" xref="S2.Ex2.m1.8.8.6.6.1">
             </times>
             <ci id="S2.Ex2.m1.8.8.6.6.2.cmml" xref="S2.Ex2.m1.8.8.6.6.2">
              𝑅
             </ci>
             <apply id="S2.Ex2.m1.8.8.6.6.3.cmml" xref="S2.Ex2.m1.8.8.6.6.3">
              <csymbol cd="ambiguous" id="S2.Ex2.m1.8.8.6.6.3.1.cmml" xref="S2.Ex2.m1.8.8.6.6.3">
               subscript
              </csymbol>
              <ci id="S2.Ex2.m1.8.8.6.6.3.2.cmml" xref="S2.Ex2.m1.8.8.6.6.3.2">
               𝑆
              </ci>
              <apply id="S2.Ex2.m1.8.8.6.6.3.3.cmml" xref="S2.Ex2.m1.8.8.6.6.3.3">
               <plus id="S2.Ex2.m1.8.8.6.6.3.3.1.cmml" xref="S2.Ex2.m1.8.8.6.6.3.3.1">
               </plus>
               <ci id="S2.Ex2.m1.8.8.6.6.3.3.2.cmml" xref="S2.Ex2.m1.8.8.6.6.3.3.2">
                𝑡
               </ci>
               <cn id="S2.Ex2.m1.8.8.6.6.3.3.3.cmml" type="integer" xref="S2.Ex2.m1.8.8.6.6.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
            <ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">
             …
            </ci>
           </list>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.Ex2.m1.8c">
           ...,\,o_{t},\,EA_{t},\,RS_{t},\,o_{t+1},\,EA_{t+1},\,RS_{t+1},\,...
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS1.p3.8">
     Now when the ReAct-style agent explores for a different external action at
     <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m1.1">
      <semantics id="S2.SS1.p3.5.m1.1a">
       <mrow id="S2.SS1.p3.5.m1.1.1" xref="S2.SS1.p3.5.m1.1.1.cmml">
        <mi id="S2.SS1.p3.5.m1.1.1.2" xref="S2.SS1.p3.5.m1.1.1.2.cmml">
         t
        </mi>
        <mo id="S2.SS1.p3.5.m1.1.1.1" xref="S2.SS1.p3.5.m1.1.1.1.cmml">
         +
        </mo>
        <mn id="S2.SS1.p3.5.m1.1.1.3" xref="S2.SS1.p3.5.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m1.1b">
        <apply id="S2.SS1.p3.5.m1.1.1.cmml" xref="S2.SS1.p3.5.m1.1.1">
         <plus id="S2.SS1.p3.5.m1.1.1.1.cmml" xref="S2.SS1.p3.5.m1.1.1.1">
         </plus>
         <ci id="S2.SS1.p3.5.m1.1.1.2.cmml" xref="S2.SS1.p3.5.m1.1.1.2">
          𝑡
         </ci>
         <cn id="S2.SS1.p3.5.m1.1.1.3.cmml" type="integer" xref="S2.SS1.p3.5.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.5.m1.1c">
        t+1
       </annotation>
      </semantics>
     </math>
     step by changing
     <math alttext="EA_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m2.1">
      <semantics id="S2.SS1.p3.6.m2.1a">
       <mrow id="S2.SS1.p3.6.m2.1.1" xref="S2.SS1.p3.6.m2.1.1.cmml">
        <mi id="S2.SS1.p3.6.m2.1.1.2" xref="S2.SS1.p3.6.m2.1.1.2.cmml">
         E
        </mi>
        <mo id="S2.SS1.p3.6.m2.1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.6.m2.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS1.p3.6.m2.1.1.3" xref="S2.SS1.p3.6.m2.1.1.3.cmml">
         <mi id="S2.SS1.p3.6.m2.1.1.3.2" xref="S2.SS1.p3.6.m2.1.1.3.2.cmml">
          A
         </mi>
         <mrow id="S2.SS1.p3.6.m2.1.1.3.3" xref="S2.SS1.p3.6.m2.1.1.3.3.cmml">
          <mi id="S2.SS1.p3.6.m2.1.1.3.3.2" xref="S2.SS1.p3.6.m2.1.1.3.3.2.cmml">
           t
          </mi>
          <mo id="S2.SS1.p3.6.m2.1.1.3.3.1" xref="S2.SS1.p3.6.m2.1.1.3.3.1.cmml">
           +
          </mo>
          <mn id="S2.SS1.p3.6.m2.1.1.3.3.3" xref="S2.SS1.p3.6.m2.1.1.3.3.3.cmml">
           1
          </mn>
         </mrow>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m2.1b">
        <apply id="S2.SS1.p3.6.m2.1.1.cmml" xref="S2.SS1.p3.6.m2.1.1">
         <times id="S2.SS1.p3.6.m2.1.1.1.cmml" xref="S2.SS1.p3.6.m2.1.1.1">
         </times>
         <ci id="S2.SS1.p3.6.m2.1.1.2.cmml" xref="S2.SS1.p3.6.m2.1.1.2">
          𝐸
         </ci>
         <apply id="S2.SS1.p3.6.m2.1.1.3.cmml" xref="S2.SS1.p3.6.m2.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS1.p3.6.m2.1.1.3.1.cmml" xref="S2.SS1.p3.6.m2.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS1.p3.6.m2.1.1.3.2.cmml" xref="S2.SS1.p3.6.m2.1.1.3.2">
           𝐴
          </ci>
          <apply id="S2.SS1.p3.6.m2.1.1.3.3.cmml" xref="S2.SS1.p3.6.m2.1.1.3.3">
           <plus id="S2.SS1.p3.6.m2.1.1.3.3.1.cmml" xref="S2.SS1.p3.6.m2.1.1.3.3.1">
           </plus>
           <ci id="S2.SS1.p3.6.m2.1.1.3.3.2.cmml" xref="S2.SS1.p3.6.m2.1.1.3.3.2">
            𝑡
           </ci>
           <cn id="S2.SS1.p3.6.m2.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p3.6.m2.1.1.3.3.3">
            1
           </cn>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.6.m2.1c">
        EA_{t+1}
       </annotation>
      </semantics>
     </math>
     into
     <math alttext="\color[rgb]{0,0,1}\widetilde{EA}_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m3.1">
      <semantics id="S2.SS1.p3.7.m3.1a">
       <msub id="S2.SS1.p3.7.m3.1.1" xref="S2.SS1.p3.7.m3.1.1.cmml">
        <mover accent="true" id="S2.SS1.p3.7.m3.1.1.2" xref="S2.SS1.p3.7.m3.1.1.2.cmml">
         <mrow id="S2.SS1.p3.7.m3.1.1.2.2" xref="S2.SS1.p3.7.m3.1.1.2.2.cmml">
          <mi id="S2.SS1.p3.7.m3.1.1.2.2.2" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.2.2.2.cmml">
           E
          </mi>
          <mo id="S2.SS1.p3.7.m3.1.1.2.2.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.7.m3.1.1.2.2.1.cmml">
           ​
          </mo>
          <mi id="S2.SS1.p3.7.m3.1.1.2.2.3" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.2.2.3.cmml">
           A
          </mi>
         </mrow>
         <mo id="S2.SS1.p3.7.m3.1.1.2.1" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.2.1.cmml">
          ~
         </mo>
        </mover>
        <mrow id="S2.SS1.p3.7.m3.1.1.3" xref="S2.SS1.p3.7.m3.1.1.3.cmml">
         <mi id="S2.SS1.p3.7.m3.1.1.3.2" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S2.SS1.p3.7.m3.1.1.3.1" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S2.SS1.p3.7.m3.1.1.3.3" mathcolor="#0000FF" xref="S2.SS1.p3.7.m3.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m3.1b">
        <apply id="S2.SS1.p3.7.m3.1.1.cmml" xref="S2.SS1.p3.7.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p3.7.m3.1.1.1.cmml" xref="S2.SS1.p3.7.m3.1.1">
          subscript
         </csymbol>
         <apply id="S2.SS1.p3.7.m3.1.1.2.cmml" xref="S2.SS1.p3.7.m3.1.1.2">
          <ci id="S2.SS1.p3.7.m3.1.1.2.1.cmml" xref="S2.SS1.p3.7.m3.1.1.2.1">
           ~
          </ci>
          <apply id="S2.SS1.p3.7.m3.1.1.2.2.cmml" xref="S2.SS1.p3.7.m3.1.1.2.2">
           <times id="S2.SS1.p3.7.m3.1.1.2.2.1.cmml" xref="S2.SS1.p3.7.m3.1.1.2.2.1">
           </times>
           <ci id="S2.SS1.p3.7.m3.1.1.2.2.2.cmml" xref="S2.SS1.p3.7.m3.1.1.2.2.2">
            𝐸
           </ci>
           <ci id="S2.SS1.p3.7.m3.1.1.2.2.3.cmml" xref="S2.SS1.p3.7.m3.1.1.2.2.3">
            𝐴
           </ci>
          </apply>
         </apply>
         <apply id="S2.SS1.p3.7.m3.1.1.3.cmml" xref="S2.SS1.p3.7.m3.1.1.3">
          <plus id="S2.SS1.p3.7.m3.1.1.3.1.cmml" xref="S2.SS1.p3.7.m3.1.1.3.1">
          </plus>
          <ci id="S2.SS1.p3.7.m3.1.1.3.2.cmml" xref="S2.SS1.p3.7.m3.1.1.3.2">
           𝑡
          </ci>
          <cn id="S2.SS1.p3.7.m3.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.7.m3.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.7.m3.1c">
        \color[rgb]{0,0,1}\widetilde{EA}_{t+1}
       </annotation>
      </semantics>
     </math>
     , the corresponding internal reasoning
     <math alttext="RS_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p3.8.m4.1">
      <semantics id="S2.SS1.p3.8.m4.1a">
       <mrow id="S2.SS1.p3.8.m4.1.1" xref="S2.SS1.p3.8.m4.1.1.cmml">
        <mi id="S2.SS1.p3.8.m4.1.1.2" xref="S2.SS1.p3.8.m4.1.1.2.cmml">
         R
        </mi>
        <mo id="S2.SS1.p3.8.m4.1.1.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.8.m4.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS1.p3.8.m4.1.1.3" xref="S2.SS1.p3.8.m4.1.1.3.cmml">
         <mi id="S2.SS1.p3.8.m4.1.1.3.2" xref="S2.SS1.p3.8.m4.1.1.3.2.cmml">
          S
         </mi>
         <mrow id="S2.SS1.p3.8.m4.1.1.3.3" xref="S2.SS1.p3.8.m4.1.1.3.3.cmml">
          <mi id="S2.SS1.p3.8.m4.1.1.3.3.2" xref="S2.SS1.p3.8.m4.1.1.3.3.2.cmml">
           t
          </mi>
          <mo id="S2.SS1.p3.8.m4.1.1.3.3.1" xref="S2.SS1.p3.8.m4.1.1.3.3.1.cmml">
           +
          </mo>
          <mn id="S2.SS1.p3.8.m4.1.1.3.3.3" xref="S2.SS1.p3.8.m4.1.1.3.3.3.cmml">
           1
          </mn>
         </mrow>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m4.1b">
        <apply id="S2.SS1.p3.8.m4.1.1.cmml" xref="S2.SS1.p3.8.m4.1.1">
         <times id="S2.SS1.p3.8.m4.1.1.1.cmml" xref="S2.SS1.p3.8.m4.1.1.1">
         </times>
         <ci id="S2.SS1.p3.8.m4.1.1.2.cmml" xref="S2.SS1.p3.8.m4.1.1.2">
          𝑅
         </ci>
         <apply id="S2.SS1.p3.8.m4.1.1.3.cmml" xref="S2.SS1.p3.8.m4.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS1.p3.8.m4.1.1.3.1.cmml" xref="S2.SS1.p3.8.m4.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS1.p3.8.m4.1.1.3.2.cmml" xref="S2.SS1.p3.8.m4.1.1.3.2">
           𝑆
          </ci>
          <apply id="S2.SS1.p3.8.m4.1.1.3.3.cmml" xref="S2.SS1.p3.8.m4.1.1.3.3">
           <plus id="S2.SS1.p3.8.m4.1.1.3.3.1.cmml" xref="S2.SS1.p3.8.m4.1.1.3.3.1">
           </plus>
           <ci id="S2.SS1.p3.8.m4.1.1.3.3.2.cmml" xref="S2.SS1.p3.8.m4.1.1.3.3.2">
            𝑡
           </ci>
           <cn id="S2.SS1.p3.8.m4.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p3.8.m4.1.1.3.3.3">
            1
           </cn>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.8.m4.1c">
        RS_{t+1}
       </annotation>
      </semantics>
     </math>
     should be altered as well. This is achieved by querying the ActRe prompting agent:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="...,\,o_{t},\,EA_{t},\,RS_{t},\,o_{t+1},\,\color[rgb]{0,0,1}{\widetilde{EA}_{t+1}}\color[rgb]{0,0,0}\rightarrow\color[rgb]{1,0,0}\widetilde{RS}_{t+1}\color[rgb]{0,0,0}," class="ltx_Math" display="block" id="S2.Ex3.m1.2">
         <semantics id="S2.Ex3.m1.2a">
          <mrow id="S2.Ex3.m1.2.2.1" xref="S2.Ex3.m1.2.2.1.1.cmml">
           <mrow id="S2.Ex3.m1.2.2.1.1" xref="S2.Ex3.m1.2.2.1.1.cmml">
            <mrow id="S2.Ex3.m1.2.2.1.1.5.5" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
             <mi id="S2.Ex3.m1.1.1" mathcolor="#000000" mathvariant="normal" xref="S2.Ex3.m1.1.1.cmml">
              …
             </mi>
             <mo id="S2.Ex3.m1.2.2.1.1.5.5.6" mathcolor="#000000" rspace="0.337em" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
              ,
             </mo>
             <msub id="S2.Ex3.m1.2.2.1.1.1.1.1" xref="S2.Ex3.m1.2.2.1.1.1.1.1.cmml">
              <mi id="S2.Ex3.m1.2.2.1.1.1.1.1.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.1.1.1.2.cmml">
               o
              </mi>
              <mi id="S2.Ex3.m1.2.2.1.1.1.1.1.3" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S2.Ex3.m1.2.2.1.1.5.5.7" mathcolor="#000000" rspace="0.337em" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
              ,
             </mo>
             <mrow id="S2.Ex3.m1.2.2.1.1.2.2.2" xref="S2.Ex3.m1.2.2.1.1.2.2.2.cmml">
              <mi id="S2.Ex3.m1.2.2.1.1.2.2.2.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.2.2.2.2.cmml">
               E
              </mi>
              <mo id="S2.Ex3.m1.2.2.1.1.2.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex3.m1.2.2.1.1.2.2.2.1.cmml">
               ​
              </mo>
              <msub id="S2.Ex3.m1.2.2.1.1.2.2.2.3" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3.cmml">
               <mi id="S2.Ex3.m1.2.2.1.1.2.2.2.3.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3.2.cmml">
                A
               </mi>
               <mi id="S2.Ex3.m1.2.2.1.1.2.2.2.3.3" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="S2.Ex3.m1.2.2.1.1.5.5.8" mathcolor="#000000" rspace="0.337em" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
              ,
             </mo>
             <mrow id="S2.Ex3.m1.2.2.1.1.3.3.3" xref="S2.Ex3.m1.2.2.1.1.3.3.3.cmml">
              <mi id="S2.Ex3.m1.2.2.1.1.3.3.3.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.3.3.3.2.cmml">
               R
              </mi>
              <mo id="S2.Ex3.m1.2.2.1.1.3.3.3.1" lspace="0em" rspace="0em" xref="S2.Ex3.m1.2.2.1.1.3.3.3.1.cmml">
               ​
              </mo>
              <msub id="S2.Ex3.m1.2.2.1.1.3.3.3.3" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3.cmml">
               <mi id="S2.Ex3.m1.2.2.1.1.3.3.3.3.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3.2.cmml">
                S
               </mi>
               <mi id="S2.Ex3.m1.2.2.1.1.3.3.3.3.3" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="S2.Ex3.m1.2.2.1.1.5.5.9" mathcolor="#000000" rspace="0.337em" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
              ,
             </mo>
             <msub id="S2.Ex3.m1.2.2.1.1.4.4.4" xref="S2.Ex3.m1.2.2.1.1.4.4.4.cmml">
              <mi id="S2.Ex3.m1.2.2.1.1.4.4.4.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.4.4.4.2.cmml">
               o
              </mi>
              <mrow id="S2.Ex3.m1.2.2.1.1.4.4.4.3" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.cmml">
               <mi id="S2.Ex3.m1.2.2.1.1.4.4.4.3.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.2.cmml">
                t
               </mi>
               <mo id="S2.Ex3.m1.2.2.1.1.4.4.4.3.1" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.1.cmml">
                +
               </mo>
               <mn id="S2.Ex3.m1.2.2.1.1.4.4.4.3.3" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.3.cmml">
                1
               </mn>
              </mrow>
             </msub>
             <mo id="S2.Ex3.m1.2.2.1.1.5.5.10" mathcolor="#000000" rspace="0.337em" xref="S2.Ex3.m1.2.2.1.1.5.6.cmml">
              ,
             </mo>
             <msub id="S2.Ex3.m1.2.2.1.1.5.5.5" xref="S2.Ex3.m1.2.2.1.1.5.5.5.cmml">
              <mover accent="true" id="S2.Ex3.m1.2.2.1.1.5.5.5.2" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.cmml">
               <mrow id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.cmml">
                <mi id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.2" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.2.cmml">
                 E
                </mi>
                <mo id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.1.cmml">
                 ​
                </mo>
                <mi id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.3" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.3.cmml">
                 A
                </mi>
               </mrow>
               <mo id="S2.Ex3.m1.2.2.1.1.5.5.5.2.1" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.1.cmml">
                ~
               </mo>
              </mover>
              <mrow id="S2.Ex3.m1.2.2.1.1.5.5.5.3" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.cmml">
               <mi id="S2.Ex3.m1.2.2.1.1.5.5.5.3.2" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.2.cmml">
                t
               </mi>
               <mo id="S2.Ex3.m1.2.2.1.1.5.5.5.3.1" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.1.cmml">
                +
               </mo>
               <mn id="S2.Ex3.m1.2.2.1.1.5.5.5.3.3" mathcolor="#0000FF" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.3.cmml">
                1
               </mn>
              </mrow>
             </msub>
            </mrow>
            <mo id="S2.Ex3.m1.2.2.1.1.6" mathcolor="#000000" stretchy="false" xref="S2.Ex3.m1.2.2.1.1.6.cmml">
             →
            </mo>
            <msub id="S2.Ex3.m1.2.2.1.1.7" xref="S2.Ex3.m1.2.2.1.1.7.cmml">
             <mover accent="true" id="S2.Ex3.m1.2.2.1.1.7.2" xref="S2.Ex3.m1.2.2.1.1.7.2.cmml">
              <mrow id="S2.Ex3.m1.2.2.1.1.7.2.2" xref="S2.Ex3.m1.2.2.1.1.7.2.2.cmml">
               <mi id="S2.Ex3.m1.2.2.1.1.7.2.2.2" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.2.2.2.cmml">
                R
               </mi>
               <mo id="S2.Ex3.m1.2.2.1.1.7.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex3.m1.2.2.1.1.7.2.2.1.cmml">
                ​
               </mo>
               <mi id="S2.Ex3.m1.2.2.1.1.7.2.2.3" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.2.2.3.cmml">
                S
               </mi>
              </mrow>
              <mo id="S2.Ex3.m1.2.2.1.1.7.2.1" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.2.1.cmml">
               ~
              </mo>
             </mover>
             <mrow id="S2.Ex3.m1.2.2.1.1.7.3" xref="S2.Ex3.m1.2.2.1.1.7.3.cmml">
              <mi id="S2.Ex3.m1.2.2.1.1.7.3.2" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex3.m1.2.2.1.1.7.3.1" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex3.m1.2.2.1.1.7.3.3" mathcolor="#FF0000" xref="S2.Ex3.m1.2.2.1.1.7.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mo id="S2.Ex3.m1.2.2.1.2" mathcolor="#000000" xref="S2.Ex3.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.2b">
           <apply id="S2.Ex3.m1.2.2.1.1.cmml" xref="S2.Ex3.m1.2.2.1">
            <ci id="S2.Ex3.m1.2.2.1.1.6.cmml" xref="S2.Ex3.m1.2.2.1.1.6">
             →
            </ci>
            <list id="S2.Ex3.m1.2.2.1.1.5.6.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5">
             <ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">
              …
             </ci>
             <apply id="S2.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S2.Ex3.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.1.2">
               𝑜
              </ci>
              <ci id="S2.Ex3.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S2.Ex3.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2">
              <times id="S2.Ex3.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.1">
              </times>
              <ci id="S2.Ex3.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.2">
               𝐸
              </ci>
              <apply id="S2.Ex3.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3">
               <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3">
                subscript
               </csymbol>
               <ci id="S2.Ex3.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3.2">
                𝐴
               </ci>
               <ci id="S2.Ex3.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S2.Ex3.m1.2.2.1.1.2.2.2.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
             <apply id="S2.Ex3.m1.2.2.1.1.3.3.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3">
              <times id="S2.Ex3.m1.2.2.1.1.3.3.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.1">
              </times>
              <ci id="S2.Ex3.m1.2.2.1.1.3.3.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.2">
               𝑅
              </ci>
              <apply id="S2.Ex3.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3">
               <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3">
                subscript
               </csymbol>
               <ci id="S2.Ex3.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3.2">
                𝑆
               </ci>
               <ci id="S2.Ex3.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.Ex3.m1.2.2.1.1.3.3.3.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
             <apply id="S2.Ex3.m1.2.2.1.1.4.4.4.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4">
              <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.4.4.4.1.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4">
               subscript
              </csymbol>
              <ci id="S2.Ex3.m1.2.2.1.1.4.4.4.2.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4.2">
               𝑜
              </ci>
              <apply id="S2.Ex3.m1.2.2.1.1.4.4.4.3.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3">
               <plus id="S2.Ex3.m1.2.2.1.1.4.4.4.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.1">
               </plus>
               <ci id="S2.Ex3.m1.2.2.1.1.4.4.4.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.2">
                𝑡
               </ci>
               <cn id="S2.Ex3.m1.2.2.1.1.4.4.4.3.3.cmml" type="integer" xref="S2.Ex3.m1.2.2.1.1.4.4.4.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S2.Ex3.m1.2.2.1.1.5.5.5.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5">
              <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.5.5.5.1.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5">
               subscript
              </csymbol>
              <apply id="S2.Ex3.m1.2.2.1.1.5.5.5.2.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2">
               <ci id="S2.Ex3.m1.2.2.1.1.5.5.5.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.1">
                ~
               </ci>
               <apply id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2">
                <times id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.1">
                </times>
                <ci id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.2">
                 𝐸
                </ci>
                <ci id="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.2.2.3">
                 𝐴
                </ci>
               </apply>
              </apply>
              <apply id="S2.Ex3.m1.2.2.1.1.5.5.5.3.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3">
               <plus id="S2.Ex3.m1.2.2.1.1.5.5.5.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.1">
               </plus>
               <ci id="S2.Ex3.m1.2.2.1.1.5.5.5.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.2">
                𝑡
               </ci>
               <cn id="S2.Ex3.m1.2.2.1.1.5.5.5.3.3.cmml" type="integer" xref="S2.Ex3.m1.2.2.1.1.5.5.5.3.3">
                1
               </cn>
              </apply>
             </apply>
            </list>
            <apply id="S2.Ex3.m1.2.2.1.1.7.cmml" xref="S2.Ex3.m1.2.2.1.1.7">
             <csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.7.1.cmml" xref="S2.Ex3.m1.2.2.1.1.7">
              subscript
             </csymbol>
             <apply id="S2.Ex3.m1.2.2.1.1.7.2.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2">
              <ci id="S2.Ex3.m1.2.2.1.1.7.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2.1">
               ~
              </ci>
              <apply id="S2.Ex3.m1.2.2.1.1.7.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2.2">
               <times id="S2.Ex3.m1.2.2.1.1.7.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2.2.1">
               </times>
               <ci id="S2.Ex3.m1.2.2.1.1.7.2.2.2.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2.2.2">
                𝑅
               </ci>
               <ci id="S2.Ex3.m1.2.2.1.1.7.2.2.3.cmml" xref="S2.Ex3.m1.2.2.1.1.7.2.2.3">
                𝑆
               </ci>
              </apply>
             </apply>
             <apply id="S2.Ex3.m1.2.2.1.1.7.3.cmml" xref="S2.Ex3.m1.2.2.1.1.7.3">
              <plus id="S2.Ex3.m1.2.2.1.1.7.3.1.cmml" xref="S2.Ex3.m1.2.2.1.1.7.3.1">
              </plus>
              <ci id="S2.Ex3.m1.2.2.1.1.7.3.2.cmml" xref="S2.Ex3.m1.2.2.1.1.7.3.2">
               𝑡
              </ci>
              <cn id="S2.Ex3.m1.2.2.1.1.7.3.3.cmml" type="integer" xref="S2.Ex3.m1.2.2.1.1.7.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.Ex3.m1.2c">
           ...,\,o_{t},\,EA_{t},\,RS_{t},\,o_{t+1},\,\color[rgb]{0,0,1}{\widetilde{EA}_{t+1}}\color[rgb]{0,0,0}\rightarrow\color[rgb]{1,0,0}\widetilde{RS}_{t+1}\color[rgb]{0,0,0},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS1.p3.10">
     then the synthesized
     <math alttext="\color[rgb]{1,0,0}\widetilde{RS}_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p3.9.m1.1">
      <semantics id="S2.SS1.p3.9.m1.1a">
       <msub id="S2.SS1.p3.9.m1.1.1" xref="S2.SS1.p3.9.m1.1.1.cmml">
        <mover accent="true" id="S2.SS1.p3.9.m1.1.1.2" xref="S2.SS1.p3.9.m1.1.1.2.cmml">
         <mrow id="S2.SS1.p3.9.m1.1.1.2.2" xref="S2.SS1.p3.9.m1.1.1.2.2.cmml">
          <mi id="S2.SS1.p3.9.m1.1.1.2.2.2" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.2.2.2.cmml">
           R
          </mi>
          <mo id="S2.SS1.p3.9.m1.1.1.2.2.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.9.m1.1.1.2.2.1.cmml">
           ​
          </mo>
          <mi id="S2.SS1.p3.9.m1.1.1.2.2.3" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.2.2.3.cmml">
           S
          </mi>
         </mrow>
         <mo id="S2.SS1.p3.9.m1.1.1.2.1" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.2.1.cmml">
          ~
         </mo>
        </mover>
        <mrow id="S2.SS1.p3.9.m1.1.1.3" xref="S2.SS1.p3.9.m1.1.1.3.cmml">
         <mi id="S2.SS1.p3.9.m1.1.1.3.2" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S2.SS1.p3.9.m1.1.1.3.1" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S2.SS1.p3.9.m1.1.1.3.3" mathcolor="#FF0000" xref="S2.SS1.p3.9.m1.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m1.1b">
        <apply id="S2.SS1.p3.9.m1.1.1.cmml" xref="S2.SS1.p3.9.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p3.9.m1.1.1.1.cmml" xref="S2.SS1.p3.9.m1.1.1">
          subscript
         </csymbol>
         <apply id="S2.SS1.p3.9.m1.1.1.2.cmml" xref="S2.SS1.p3.9.m1.1.1.2">
          <ci id="S2.SS1.p3.9.m1.1.1.2.1.cmml" xref="S2.SS1.p3.9.m1.1.1.2.1">
           ~
          </ci>
          <apply id="S2.SS1.p3.9.m1.1.1.2.2.cmml" xref="S2.SS1.p3.9.m1.1.1.2.2">
           <times id="S2.SS1.p3.9.m1.1.1.2.2.1.cmml" xref="S2.SS1.p3.9.m1.1.1.2.2.1">
           </times>
           <ci id="S2.SS1.p3.9.m1.1.1.2.2.2.cmml" xref="S2.SS1.p3.9.m1.1.1.2.2.2">
            𝑅
           </ci>
           <ci id="S2.SS1.p3.9.m1.1.1.2.2.3.cmml" xref="S2.SS1.p3.9.m1.1.1.2.2.3">
            𝑆
           </ci>
          </apply>
         </apply>
         <apply id="S2.SS1.p3.9.m1.1.1.3.cmml" xref="S2.SS1.p3.9.m1.1.1.3">
          <plus id="S2.SS1.p3.9.m1.1.1.3.1.cmml" xref="S2.SS1.p3.9.m1.1.1.3.1">
          </plus>
          <ci id="S2.SS1.p3.9.m1.1.1.3.2.cmml" xref="S2.SS1.p3.9.m1.1.1.3.2">
           𝑡
          </ci>
          <cn id="S2.SS1.p3.9.m1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.9.m1.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.9.m1.1c">
        \color[rgb]{1,0,0}\widetilde{RS}_{t+1}
       </annotation>
      </semantics>
     </math>
     and the sampled
     <math alttext="\color[rgb]{0,0,1}\widetilde{EA}_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p3.10.m2.1">
      <semantics id="S2.SS1.p3.10.m2.1a">
       <msub id="S2.SS1.p3.10.m2.1.1" xref="S2.SS1.p3.10.m2.1.1.cmml">
        <mover accent="true" id="S2.SS1.p3.10.m2.1.1.2" xref="S2.SS1.p3.10.m2.1.1.2.cmml">
         <mrow id="S2.SS1.p3.10.m2.1.1.2.2" xref="S2.SS1.p3.10.m2.1.1.2.2.cmml">
          <mi id="S2.SS1.p3.10.m2.1.1.2.2.2" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.2.2.2.cmml">
           E
          </mi>
          <mo id="S2.SS1.p3.10.m2.1.1.2.2.1" lspace="0em" rspace="0em" xref="S2.SS1.p3.10.m2.1.1.2.2.1.cmml">
           ​
          </mo>
          <mi id="S2.SS1.p3.10.m2.1.1.2.2.3" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.2.2.3.cmml">
           A
          </mi>
         </mrow>
         <mo id="S2.SS1.p3.10.m2.1.1.2.1" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.2.1.cmml">
          ~
         </mo>
        </mover>
        <mrow id="S2.SS1.p3.10.m2.1.1.3" xref="S2.SS1.p3.10.m2.1.1.3.cmml">
         <mi id="S2.SS1.p3.10.m2.1.1.3.2" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S2.SS1.p3.10.m2.1.1.3.1" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S2.SS1.p3.10.m2.1.1.3.3" mathcolor="#0000FF" xref="S2.SS1.p3.10.m2.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m2.1b">
        <apply id="S2.SS1.p3.10.m2.1.1.cmml" xref="S2.SS1.p3.10.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p3.10.m2.1.1.1.cmml" xref="S2.SS1.p3.10.m2.1.1">
          subscript
         </csymbol>
         <apply id="S2.SS1.p3.10.m2.1.1.2.cmml" xref="S2.SS1.p3.10.m2.1.1.2">
          <ci id="S2.SS1.p3.10.m2.1.1.2.1.cmml" xref="S2.SS1.p3.10.m2.1.1.2.1">
           ~
          </ci>
          <apply id="S2.SS1.p3.10.m2.1.1.2.2.cmml" xref="S2.SS1.p3.10.m2.1.1.2.2">
           <times id="S2.SS1.p3.10.m2.1.1.2.2.1.cmml" xref="S2.SS1.p3.10.m2.1.1.2.2.1">
           </times>
           <ci id="S2.SS1.p3.10.m2.1.1.2.2.2.cmml" xref="S2.SS1.p3.10.m2.1.1.2.2.2">
            𝐸
           </ci>
           <ci id="S2.SS1.p3.10.m2.1.1.2.2.3.cmml" xref="S2.SS1.p3.10.m2.1.1.2.2.3">
            𝐴
           </ci>
          </apply>
         </apply>
         <apply id="S2.SS1.p3.10.m2.1.1.3.cmml" xref="S2.SS1.p3.10.m2.1.1.3">
          <plus id="S2.SS1.p3.10.m2.1.1.3.1.cmml" xref="S2.SS1.p3.10.m2.1.1.3.1">
          </plus>
          <ci id="S2.SS1.p3.10.m2.1.1.3.2.cmml" xref="S2.SS1.p3.10.m2.1.1.3.2">
           𝑡
          </ci>
          <cn id="S2.SS1.p3.10.m2.1.1.3.3.cmml" type="integer" xref="S2.SS1.p3.10.m2.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.10.m2.1c">
        \color[rgb]{0,0,1}\widetilde{EA}_{t+1}
       </annotation>
      </semantics>
     </math>
     compose a new ReAct trajectory:
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="...,\,o_{t},\,RS_{t},\,EA_{t},\,o_{t+1},\,\color[rgb]{1,0,0}\widetilde{RS}_{t+1}\color[rgb]{0,0,0},\,\color[rgb]{0,0,1}\widetilde{EA}_{t+1}\color[rgb]{0,0,0}.\quad" class="ltx_Math" display="block" id="S2.Ex4.m1.2">
         <semantics id="S2.Ex4.m1.2a">
          <mrow id="S2.Ex4.m1.2.2.1">
           <mrow id="S2.Ex4.m1.2.2.1.1.6" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
            <mi id="S2.Ex4.m1.1.1" mathvariant="normal" xref="S2.Ex4.m1.1.1.cmml">
             …
            </mi>
            <mo id="S2.Ex4.m1.2.2.1.1.6.7" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <msub id="S2.Ex4.m1.2.2.1.1.1.1" xref="S2.Ex4.m1.2.2.1.1.1.1.cmml">
             <mi id="S2.Ex4.m1.2.2.1.1.1.1.2" xref="S2.Ex4.m1.2.2.1.1.1.1.2.cmml">
              o
             </mi>
             <mi id="S2.Ex4.m1.2.2.1.1.1.1.3" xref="S2.Ex4.m1.2.2.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S2.Ex4.m1.2.2.1.1.6.8" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <mrow id="S2.Ex4.m1.2.2.1.1.2.2" xref="S2.Ex4.m1.2.2.1.1.2.2.cmml">
             <mi id="S2.Ex4.m1.2.2.1.1.2.2.2" xref="S2.Ex4.m1.2.2.1.1.2.2.2.cmml">
              R
             </mi>
             <mo id="S2.Ex4.m1.2.2.1.1.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex4.m1.2.2.1.1.2.2.1.cmml">
              ​
             </mo>
             <msub id="S2.Ex4.m1.2.2.1.1.2.2.3" xref="S2.Ex4.m1.2.2.1.1.2.2.3.cmml">
              <mi id="S2.Ex4.m1.2.2.1.1.2.2.3.2" xref="S2.Ex4.m1.2.2.1.1.2.2.3.2.cmml">
               S
              </mi>
              <mi id="S2.Ex4.m1.2.2.1.1.2.2.3.3" xref="S2.Ex4.m1.2.2.1.1.2.2.3.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
            <mo id="S2.Ex4.m1.2.2.1.1.6.9" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <mrow id="S2.Ex4.m1.2.2.1.1.3.3" xref="S2.Ex4.m1.2.2.1.1.3.3.cmml">
             <mi id="S2.Ex4.m1.2.2.1.1.3.3.2" xref="S2.Ex4.m1.2.2.1.1.3.3.2.cmml">
              E
             </mi>
             <mo id="S2.Ex4.m1.2.2.1.1.3.3.1" lspace="0em" rspace="0em" xref="S2.Ex4.m1.2.2.1.1.3.3.1.cmml">
              ​
             </mo>
             <msub id="S2.Ex4.m1.2.2.1.1.3.3.3" xref="S2.Ex4.m1.2.2.1.1.3.3.3.cmml">
              <mi id="S2.Ex4.m1.2.2.1.1.3.3.3.2" xref="S2.Ex4.m1.2.2.1.1.3.3.3.2.cmml">
               A
              </mi>
              <mi id="S2.Ex4.m1.2.2.1.1.3.3.3.3" xref="S2.Ex4.m1.2.2.1.1.3.3.3.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
            <mo id="S2.Ex4.m1.2.2.1.1.6.10" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <msub id="S2.Ex4.m1.2.2.1.1.4.4" xref="S2.Ex4.m1.2.2.1.1.4.4.cmml">
             <mi id="S2.Ex4.m1.2.2.1.1.4.4.2" xref="S2.Ex4.m1.2.2.1.1.4.4.2.cmml">
              o
             </mi>
             <mrow id="S2.Ex4.m1.2.2.1.1.4.4.3" xref="S2.Ex4.m1.2.2.1.1.4.4.3.cmml">
              <mi id="S2.Ex4.m1.2.2.1.1.4.4.3.2" xref="S2.Ex4.m1.2.2.1.1.4.4.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex4.m1.2.2.1.1.4.4.3.1" xref="S2.Ex4.m1.2.2.1.1.4.4.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex4.m1.2.2.1.1.4.4.3.3" xref="S2.Ex4.m1.2.2.1.1.4.4.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
            <mo id="S2.Ex4.m1.2.2.1.1.6.11" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <msub id="S2.Ex4.m1.2.2.1.1.5.5" xref="S2.Ex4.m1.2.2.1.1.5.5.cmml">
             <mover accent="true" id="S2.Ex4.m1.2.2.1.1.5.5.2" xref="S2.Ex4.m1.2.2.1.1.5.5.2.cmml">
              <mrow id="S2.Ex4.m1.2.2.1.1.5.5.2.2" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.cmml">
               <mi id="S2.Ex4.m1.2.2.1.1.5.5.2.2.2" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.2.cmml">
                R
               </mi>
               <mo id="S2.Ex4.m1.2.2.1.1.5.5.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.1.cmml">
                ​
               </mo>
               <mi id="S2.Ex4.m1.2.2.1.1.5.5.2.2.3" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.3.cmml">
                S
               </mi>
              </mrow>
              <mo id="S2.Ex4.m1.2.2.1.1.5.5.2.1" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.2.1.cmml">
               ~
              </mo>
             </mover>
             <mrow id="S2.Ex4.m1.2.2.1.1.5.5.3" xref="S2.Ex4.m1.2.2.1.1.5.5.3.cmml">
              <mi id="S2.Ex4.m1.2.2.1.1.5.5.3.2" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex4.m1.2.2.1.1.5.5.3.1" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex4.m1.2.2.1.1.5.5.3.3" mathcolor="#FF0000" xref="S2.Ex4.m1.2.2.1.1.5.5.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
            <mo id="S2.Ex4.m1.2.2.1.1.6.12" mathcolor="#000000" rspace="0.337em" xref="S2.Ex4.m1.2.2.1.1.7.cmml">
             ,
            </mo>
            <msub id="S2.Ex4.m1.2.2.1.1.6.6" xref="S2.Ex4.m1.2.2.1.1.6.6.cmml">
             <mover accent="true" id="S2.Ex4.m1.2.2.1.1.6.6.2" xref="S2.Ex4.m1.2.2.1.1.6.6.2.cmml">
              <mrow id="S2.Ex4.m1.2.2.1.1.6.6.2.2" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.cmml">
               <mi id="S2.Ex4.m1.2.2.1.1.6.6.2.2.2" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.2.cmml">
                E
               </mi>
               <mo id="S2.Ex4.m1.2.2.1.1.6.6.2.2.1" lspace="0em" rspace="0em" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.1.cmml">
                ​
               </mo>
               <mi id="S2.Ex4.m1.2.2.1.1.6.6.2.2.3" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.3.cmml">
                A
               </mi>
              </mrow>
              <mo id="S2.Ex4.m1.2.2.1.1.6.6.2.1" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.2.1.cmml">
               ~
              </mo>
             </mover>
             <mrow id="S2.Ex4.m1.2.2.1.1.6.6.3" xref="S2.Ex4.m1.2.2.1.1.6.6.3.cmml">
              <mi id="S2.Ex4.m1.2.2.1.1.6.6.3.2" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.3.2.cmml">
               t
              </mi>
              <mo id="S2.Ex4.m1.2.2.1.1.6.6.3.1" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.3.1.cmml">
               +
              </mo>
              <mn id="S2.Ex4.m1.2.2.1.1.6.6.3.3" mathcolor="#0000FF" xref="S2.Ex4.m1.2.2.1.1.6.6.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
           <mo id="S2.Ex4.m1.2.2.1.2" lspace="0em" mathcolor="#000000">
            .
           </mo>
           <mspace id="S2.Ex4.m1.2.2.1.3" width="1.167em">
           </mspace>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.2b">
           <list id="S2.Ex4.m1.2.2.1.1.7.cmml" xref="S2.Ex4.m1.2.2.1.1.6">
            <ci id="S2.Ex4.m1.1.1.cmml" xref="S2.Ex4.m1.1.1">
             …
            </ci>
            <apply id="S2.Ex4.m1.2.2.1.1.1.1.cmml" xref="S2.Ex4.m1.2.2.1.1.1.1">
             <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex4.m1.2.2.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S2.Ex4.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex4.m1.2.2.1.1.1.1.2">
              𝑜
             </ci>
             <ci id="S2.Ex4.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex4.m1.2.2.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S2.Ex4.m1.2.2.1.1.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2">
             <times id="S2.Ex4.m1.2.2.1.1.2.2.1.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.1">
             </times>
             <ci id="S2.Ex4.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.2">
              𝑅
             </ci>
             <apply id="S2.Ex4.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.3">
              <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.3">
               subscript
              </csymbol>
              <ci id="S2.Ex4.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.3.2">
               𝑆
              </ci>
              <ci id="S2.Ex4.m1.2.2.1.1.2.2.3.3.cmml" xref="S2.Ex4.m1.2.2.1.1.2.2.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <apply id="S2.Ex4.m1.2.2.1.1.3.3.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3">
             <times id="S2.Ex4.m1.2.2.1.1.3.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.1">
             </times>
             <ci id="S2.Ex4.m1.2.2.1.1.3.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.2">
              𝐸
             </ci>
             <apply id="S2.Ex4.m1.2.2.1.1.3.3.3.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.3">
              <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.3.3.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.3">
               subscript
              </csymbol>
              <ci id="S2.Ex4.m1.2.2.1.1.3.3.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.3.2">
               𝐴
              </ci>
              <ci id="S2.Ex4.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.Ex4.m1.2.2.1.1.3.3.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <apply id="S2.Ex4.m1.2.2.1.1.4.4.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4">
             <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.4.4.1.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4">
              subscript
             </csymbol>
             <ci id="S2.Ex4.m1.2.2.1.1.4.4.2.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4.2">
              𝑜
             </ci>
             <apply id="S2.Ex4.m1.2.2.1.1.4.4.3.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4.3">
              <plus id="S2.Ex4.m1.2.2.1.1.4.4.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4.3.1">
              </plus>
              <ci id="S2.Ex4.m1.2.2.1.1.4.4.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.4.4.3.2">
               𝑡
              </ci>
              <cn id="S2.Ex4.m1.2.2.1.1.4.4.3.3.cmml" type="integer" xref="S2.Ex4.m1.2.2.1.1.4.4.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="S2.Ex4.m1.2.2.1.1.5.5.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5">
             <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.5.5.1.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5">
              subscript
             </csymbol>
             <apply id="S2.Ex4.m1.2.2.1.1.5.5.2.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2">
              <ci id="S2.Ex4.m1.2.2.1.1.5.5.2.1.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2.1">
               ~
              </ci>
              <apply id="S2.Ex4.m1.2.2.1.1.5.5.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2">
               <times id="S2.Ex4.m1.2.2.1.1.5.5.2.2.1.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.1">
               </times>
               <ci id="S2.Ex4.m1.2.2.1.1.5.5.2.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.2">
                𝑅
               </ci>
               <ci id="S2.Ex4.m1.2.2.1.1.5.5.2.2.3.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.2.2.3">
                𝑆
               </ci>
              </apply>
             </apply>
             <apply id="S2.Ex4.m1.2.2.1.1.5.5.3.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.3">
              <plus id="S2.Ex4.m1.2.2.1.1.5.5.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.3.1">
              </plus>
              <ci id="S2.Ex4.m1.2.2.1.1.5.5.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.5.5.3.2">
               𝑡
              </ci>
              <cn id="S2.Ex4.m1.2.2.1.1.5.5.3.3.cmml" type="integer" xref="S2.Ex4.m1.2.2.1.1.5.5.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="S2.Ex4.m1.2.2.1.1.6.6.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6">
             <csymbol cd="ambiguous" id="S2.Ex4.m1.2.2.1.1.6.6.1.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6">
              subscript
             </csymbol>
             <apply id="S2.Ex4.m1.2.2.1.1.6.6.2.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2">
              <ci id="S2.Ex4.m1.2.2.1.1.6.6.2.1.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2.1">
               ~
              </ci>
              <apply id="S2.Ex4.m1.2.2.1.1.6.6.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2">
               <times id="S2.Ex4.m1.2.2.1.1.6.6.2.2.1.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.1">
               </times>
               <ci id="S2.Ex4.m1.2.2.1.1.6.6.2.2.2.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.2">
                𝐸
               </ci>
               <ci id="S2.Ex4.m1.2.2.1.1.6.6.2.2.3.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.2.2.3">
                𝐴
               </ci>
              </apply>
             </apply>
             <apply id="S2.Ex4.m1.2.2.1.1.6.6.3.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.3">
              <plus id="S2.Ex4.m1.2.2.1.1.6.6.3.1.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.3.1">
              </plus>
              <ci id="S2.Ex4.m1.2.2.1.1.6.6.3.2.cmml" xref="S2.Ex4.m1.2.2.1.1.6.6.3.2">
               𝑡
              </ci>
              <cn id="S2.Ex4.m1.2.2.1.1.6.6.3.3.cmml" type="integer" xref="S2.Ex4.m1.2.2.1.1.6.6.3.3">
               1
              </cn>
             </apply>
            </apply>
           </list>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.Ex4.m1.2c">
           ...,\,o_{t},\,RS_{t},\,EA_{t},\,o_{t+1},\,\color[rgb]{1,0,0}\widetilde{RS}_{t+1}\color[rgb]{0,0,0},\,\color[rgb]{0,0,1}\widetilde{EA}_{t+1}\color[rgb]{0,0,0}.\quad
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS1.p3.12">
     At the end of each trajectory, the environment provides a terminal reward
     <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p3.11.m1.1">
      <semantics id="S2.SS1.p3.11.m1.1a">
       <mi id="S2.SS1.p3.11.m1.1.1" xref="S2.SS1.p3.11.m1.1.1.cmml">
        R
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m1.1b">
        <ci id="S2.SS1.p3.11.m1.1.1.cmml" xref="S2.SS1.p3.11.m1.1.1">
         𝑅
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.11.m1.1c">
        R
       </annotation>
      </semantics>
     </math>
     to indicate whether the execution is successful. The reward
     <math alttext="R" class="ltx_Math" display="inline" id="S2.SS1.p3.12.m2.1">
      <semantics id="S2.SS1.p3.12.m2.1a">
       <mi id="S2.SS1.p3.12.m2.1.1" xref="S2.SS1.p3.12.m2.1.1.cmml">
        R
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p3.12.m2.1b">
        <ci id="S2.SS1.p3.12.m2.1.1.cmml" xref="S2.SS1.p3.12.m2.1.1">
         𝑅
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p3.12.m2.1c">
        R
       </annotation>
      </semantics>
     </math>
     automatically annotates the quality of the entire trajectory. In this way, the language agent autonomously composes diverse ReAct-style trajectories without human annotation effort, paving the way for self-training.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    Contrastive Self-Training
   </h3>
   <div class="ltx_para ltx_noindent" id="S2.SS2.p1">
    <p class="ltx_p" id="S2.SS2.p1.10">
     Language agents are trained by fine-tuning an LLM with the accumulated trajectories. While supervised fine-tuning (SFT) with high-quality data is widely adopted
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhou et al.,
      <a class="ltx_ref" href="#bib.bib38" title="">
       2023b
      </a>
      ; Singh et al.,
      <a class="ltx_ref" href="#bib.bib21" title="">
       2023
      </a>
      )
     </cite>
     , in this work, we improve the awareness of the agent about the contrast between failed and successful trajectories in the same task with policy gradient methods
     <cite class="ltx_cite ltx_citemacro_citep">
      (Williams,
      <a class="ltx_ref" href="#bib.bib27" title="">
       1992
      </a>
      )
     </cite>
     . In the context of ReAct-style language agents, a gathered trajectory
     <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1">
      <semantics id="S2.SS2.p1.1.m1.1a">
       <mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">
        τ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b">
        <ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">
         𝜏
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">
        \tau
       </annotation>
      </semantics>
     </math>
     with
     <math alttext="T" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1">
      <semantics id="S2.SS2.p1.2.m2.1a">
       <mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b">
        <ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">
        T
       </annotation>
      </semantics>
     </math>
     steps reads
     <math alttext="\tau=\{o_{1},a_{1},o_{2},a_{2},\cdots,o_{t},a_{T}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.7">
      <semantics id="S2.SS2.p1.3.m3.7a">
       <mrow id="S2.SS2.p1.3.m3.7.7" xref="S2.SS2.p1.3.m3.7.7.cmml">
        <mi id="S2.SS2.p1.3.m3.7.7.8" xref="S2.SS2.p1.3.m3.7.7.8.cmml">
         τ
        </mi>
        <mo id="S2.SS2.p1.3.m3.7.7.7" xref="S2.SS2.p1.3.m3.7.7.7.cmml">
         =
        </mo>
        <mrow id="S2.SS2.p1.3.m3.7.7.6.6" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.7" stretchy="false" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          {
         </mo>
         <msub id="S2.SS2.p1.3.m3.2.2.1.1.1" xref="S2.SS2.p1.3.m3.2.2.1.1.1.cmml">
          <mi id="S2.SS2.p1.3.m3.2.2.1.1.1.2" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml">
           o
          </mi>
          <mn id="S2.SS2.p1.3.m3.2.2.1.1.1.3" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.8" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <msub id="S2.SS2.p1.3.m3.3.3.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.cmml">
          <mi id="S2.SS2.p1.3.m3.3.3.2.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml">
           a
          </mi>
          <mn id="S2.SS2.p1.3.m3.3.3.2.2.2.3" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.9" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <msub id="S2.SS2.p1.3.m3.4.4.3.3.3" xref="S2.SS2.p1.3.m3.4.4.3.3.3.cmml">
          <mi id="S2.SS2.p1.3.m3.4.4.3.3.3.2" xref="S2.SS2.p1.3.m3.4.4.3.3.3.2.cmml">
           o
          </mi>
          <mn id="S2.SS2.p1.3.m3.4.4.3.3.3.3" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.10" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <msub id="S2.SS2.p1.3.m3.5.5.4.4.4" xref="S2.SS2.p1.3.m3.5.5.4.4.4.cmml">
          <mi id="S2.SS2.p1.3.m3.5.5.4.4.4.2" xref="S2.SS2.p1.3.m3.5.5.4.4.4.2.cmml">
           a
          </mi>
          <mn id="S2.SS2.p1.3.m3.5.5.4.4.4.3" xref="S2.SS2.p1.3.m3.5.5.4.4.4.3.cmml">
           2
          </mn>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.11" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <mi id="S2.SS2.p1.3.m3.1.1" mathvariant="normal" xref="S2.SS2.p1.3.m3.1.1.cmml">
          ⋯
         </mi>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.12" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <msub id="S2.SS2.p1.3.m3.6.6.5.5.5" xref="S2.SS2.p1.3.m3.6.6.5.5.5.cmml">
          <mi id="S2.SS2.p1.3.m3.6.6.5.5.5.2" xref="S2.SS2.p1.3.m3.6.6.5.5.5.2.cmml">
           o
          </mi>
          <mi id="S2.SS2.p1.3.m3.6.6.5.5.5.3" xref="S2.SS2.p1.3.m3.6.6.5.5.5.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.13" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          ,
         </mo>
         <msub id="S2.SS2.p1.3.m3.7.7.6.6.6" xref="S2.SS2.p1.3.m3.7.7.6.6.6.cmml">
          <mi id="S2.SS2.p1.3.m3.7.7.6.6.6.2" xref="S2.SS2.p1.3.m3.7.7.6.6.6.2.cmml">
           a
          </mi>
          <mi id="S2.SS2.p1.3.m3.7.7.6.6.6.3" xref="S2.SS2.p1.3.m3.7.7.6.6.6.3.cmml">
           T
          </mi>
         </msub>
         <mo id="S2.SS2.p1.3.m3.7.7.6.6.14" stretchy="false" xref="S2.SS2.p1.3.m3.7.7.6.7.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.7b">
        <apply id="S2.SS2.p1.3.m3.7.7.cmml" xref="S2.SS2.p1.3.m3.7.7">
         <eq id="S2.SS2.p1.3.m3.7.7.7.cmml" xref="S2.SS2.p1.3.m3.7.7.7">
         </eq>
         <ci id="S2.SS2.p1.3.m3.7.7.8.cmml" xref="S2.SS2.p1.3.m3.7.7.8">
          𝜏
         </ci>
         <set id="S2.SS2.p1.3.m3.7.7.6.7.cmml" xref="S2.SS2.p1.3.m3.7.7.6.6">
          <apply id="S2.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2">
            𝑜
           </ci>
           <cn id="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <apply id="S2.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2">
            𝑎
           </ci>
           <cn id="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3">
            1
           </cn>
          </apply>
          <apply id="S2.SS2.p1.3.m3.4.4.3.3.3.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.4.4.3.3.3.1.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.4.4.3.3.3.2.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.2">
            𝑜
           </ci>
           <cn id="S2.SS2.p1.3.m3.4.4.3.3.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3">
            2
           </cn>
          </apply>
          <apply id="S2.SS2.p1.3.m3.5.5.4.4.4.cmml" xref="S2.SS2.p1.3.m3.5.5.4.4.4">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.5.5.4.4.4.1.cmml" xref="S2.SS2.p1.3.m3.5.5.4.4.4">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.5.5.4.4.4.2.cmml" xref="S2.SS2.p1.3.m3.5.5.4.4.4.2">
            𝑎
           </ci>
           <cn id="S2.SS2.p1.3.m3.5.5.4.4.4.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.5.5.4.4.4.3">
            2
           </cn>
          </apply>
          <ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">
           ⋯
          </ci>
          <apply id="S2.SS2.p1.3.m3.6.6.5.5.5.cmml" xref="S2.SS2.p1.3.m3.6.6.5.5.5">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.6.6.5.5.5.1.cmml" xref="S2.SS2.p1.3.m3.6.6.5.5.5">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.6.6.5.5.5.2.cmml" xref="S2.SS2.p1.3.m3.6.6.5.5.5.2">
            𝑜
           </ci>
           <ci id="S2.SS2.p1.3.m3.6.6.5.5.5.3.cmml" xref="S2.SS2.p1.3.m3.6.6.5.5.5.3">
            𝑡
           </ci>
          </apply>
          <apply id="S2.SS2.p1.3.m3.7.7.6.6.6.cmml" xref="S2.SS2.p1.3.m3.7.7.6.6.6">
           <csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.7.7.6.6.6.1.cmml" xref="S2.SS2.p1.3.m3.7.7.6.6.6">
            subscript
           </csymbol>
           <ci id="S2.SS2.p1.3.m3.7.7.6.6.6.2.cmml" xref="S2.SS2.p1.3.m3.7.7.6.6.6.2">
            𝑎
           </ci>
           <ci id="S2.SS2.p1.3.m3.7.7.6.6.6.3.cmml" xref="S2.SS2.p1.3.m3.7.7.6.6.6.3">
            𝑇
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.7c">
        \tau=\{o_{1},a_{1},o_{2},a_{2},\cdots,o_{t},a_{T}\}
       </annotation>
      </semantics>
     </math>
     , with
     <math alttext="o_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1">
      <semantics id="S2.SS2.p1.4.m4.1a">
       <msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">
        <mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">
         o
        </mi>
        <mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b">
        <apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">
          𝑜
         </ci>
         <ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">
        o_{t}
       </annotation>
      </semantics>
     </math>
     in token strings representing the
     <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1">
      <semantics id="S2.SS2.p1.5.m5.1a">
       <mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b">
        <ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">
        t
       </annotation>
      </semantics>
     </math>
     -step environmental observation, and
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1">
      <semantics id="S2.SS2.p1.6.m6.1a">
       <msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">
        <mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">
         a
        </mi>
        <mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b">
        <apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">
          𝑎
         </ci>
         <ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     representing the textual action of the agent being either the internal reasoning
     <math alttext="RS_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1">
      <semantics id="S2.SS2.p1.7.m7.1a">
       <mrow id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">
        <mi id="S2.SS2.p1.7.m7.1.1.2" xref="S2.SS2.p1.7.m7.1.1.2.cmml">
         R
        </mi>
        <mo id="S2.SS2.p1.7.m7.1.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.7.m7.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml">
         <mi id="S2.SS2.p1.7.m7.1.1.3.2" xref="S2.SS2.p1.7.m7.1.1.3.2.cmml">
          S
         </mi>
         <mi id="S2.SS2.p1.7.m7.1.1.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.cmml">
          t
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b">
        <apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">
         <times id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1">
         </times>
         <ci id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2">
          𝑅
         </ci>
         <apply id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS2.p1.7.m7.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2">
           𝑆
          </ci>
          <ci id="S2.SS2.p1.7.m7.1.1.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3">
           𝑡
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">
        RS_{t}
       </annotation>
      </semantics>
     </math>
     or the external action
     <math alttext="EA_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1">
      <semantics id="S2.SS2.p1.8.m8.1a">
       <mrow id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">
        <mi id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">
         E
        </mi>
        <mo id="S2.SS2.p1.8.m8.1.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p1.8.m8.1.1.1.cmml">
         ​
        </mo>
        <msub id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">
         <mi id="S2.SS2.p1.8.m8.1.1.3.2" xref="S2.SS2.p1.8.m8.1.1.3.2.cmml">
          A
         </mi>
         <mi id="S2.SS2.p1.8.m8.1.1.3.3" xref="S2.SS2.p1.8.m8.1.1.3.3.cmml">
          t
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b">
        <apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">
         <times id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1">
         </times>
         <ci id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2">
          𝐸
         </ci>
         <apply id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.3.1.cmml" xref="S2.SS2.p1.8.m8.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS2.p1.8.m8.1.1.3.2.cmml" xref="S2.SS2.p1.8.m8.1.1.3.2">
           𝐴
          </ci>
          <ci id="S2.SS2.p1.8.m8.1.1.3.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3.3">
           𝑡
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">
        EA_{t}
       </annotation>
      </semantics>
     </math>
     . Given a total of
     <math alttext="M" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1">
      <semantics id="S2.SS2.p1.9.m9.1a">
       <mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b">
        <ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">
        M
       </annotation>
      </semantics>
     </math>
     trajectories
     <math alttext="\{\tau^{m}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1">
      <semantics id="S2.SS2.p1.10.m10.1a">
       <mrow id="S2.SS2.p1.10.m10.1.1.1" xref="S2.SS2.p1.10.m10.1.1.2.cmml">
        <mo id="S2.SS2.p1.10.m10.1.1.1.2" stretchy="false" xref="S2.SS2.p1.10.m10.1.1.2.cmml">
         {
        </mo>
        <msup id="S2.SS2.p1.10.m10.1.1.1.1" xref="S2.SS2.p1.10.m10.1.1.1.1.cmml">
         <mi id="S2.SS2.p1.10.m10.1.1.1.1.2" xref="S2.SS2.p1.10.m10.1.1.1.1.2.cmml">
          τ
         </mi>
         <mi id="S2.SS2.p1.10.m10.1.1.1.1.3" xref="S2.SS2.p1.10.m10.1.1.1.1.3.cmml">
          m
         </mi>
        </msup>
        <mo id="S2.SS2.p1.10.m10.1.1.1.3" stretchy="false" xref="S2.SS2.p1.10.m10.1.1.2.cmml">
         }
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b">
        <set id="S2.SS2.p1.10.m10.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.1">
         <apply id="S2.SS2.p1.10.m10.1.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1">
          <csymbol cd="ambiguous" id="S2.SS2.p1.10.m10.1.1.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1">
           superscript
          </csymbol>
          <ci id="S2.SS2.p1.10.m10.1.1.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1.2">
           𝜏
          </ci>
          <ci id="S2.SS2.p1.10.m10.1.1.1.1.3.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1.3">
           𝑚
          </ci>
         </apply>
        </set>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">
        \{\tau^{m}\}
       </annotation>
      </semantics>
     </math>
     , we maximize the following objective as the estimation of policy gradient:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S2.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\nabla_{\theta}J(\theta)" class="ltx_Math" display="inline" id="S2.E1X.2.1.1.m1.1">
         <semantics id="S2.E1X.2.1.1.m1.1a">
          <mrow id="S2.E1X.2.1.1.m1.1.2" xref="S2.E1X.2.1.1.m1.1.2.cmml">
           <mrow id="S2.E1X.2.1.1.m1.1.2.2" xref="S2.E1X.2.1.1.m1.1.2.2.cmml">
            <msub id="S2.E1X.2.1.1.m1.1.2.2.1" xref="S2.E1X.2.1.1.m1.1.2.2.1.cmml">
             <mo id="S2.E1X.2.1.1.m1.1.2.2.1.2" xref="S2.E1X.2.1.1.m1.1.2.2.1.2.cmml">
              ∇
             </mo>
             <mi id="S2.E1X.2.1.1.m1.1.2.2.1.3" xref="S2.E1X.2.1.1.m1.1.2.2.1.3.cmml">
              θ
             </mi>
            </msub>
            <mi id="S2.E1X.2.1.1.m1.1.2.2.2" xref="S2.E1X.2.1.1.m1.1.2.2.2.cmml">
             J
            </mi>
           </mrow>
           <mo id="S2.E1X.2.1.1.m1.1.2.1" lspace="0em" rspace="0em" xref="S2.E1X.2.1.1.m1.1.2.1.cmml">
            ​
           </mo>
           <mrow id="S2.E1X.2.1.1.m1.1.2.3.2" xref="S2.E1X.2.1.1.m1.1.2.cmml">
            <mo id="S2.E1X.2.1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.E1X.2.1.1.m1.1.2.cmml">
             (
            </mo>
            <mi id="S2.E1X.2.1.1.m1.1.1" xref="S2.E1X.2.1.1.m1.1.1.cmml">
             θ
            </mi>
            <mo id="S2.E1X.2.1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.E1X.2.1.1.m1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E1X.2.1.1.m1.1b">
           <apply id="S2.E1X.2.1.1.m1.1.2.cmml" xref="S2.E1X.2.1.1.m1.1.2">
            <times id="S2.E1X.2.1.1.m1.1.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.2.1">
            </times>
            <apply id="S2.E1X.2.1.1.m1.1.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.2.2">
             <apply id="S2.E1X.2.1.1.m1.1.2.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.1">
              <csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.2.2.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.1">
               subscript
              </csymbol>
              <ci id="S2.E1X.2.1.1.m1.1.2.2.1.2.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.1.2">
               ∇
              </ci>
              <ci id="S2.E1X.2.1.1.m1.1.2.2.1.3.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.1.3">
               𝜃
              </ci>
             </apply>
             <ci id="S2.E1X.2.1.1.m1.1.2.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.2">
              𝐽
             </ci>
            </apply>
            <ci id="S2.E1X.2.1.1.m1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1">
             𝜃
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E1X.2.1.1.m1.1c">
           \displaystyle\nabla_{\theta}J(\theta)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\frac{1}{M}\sum_{m=1}^{M}R(\tau^{m})\nabla_{\theta}\log p_{\theta}(\tau^{m})" class="ltx_Math" display="inline" id="S2.E1X.3.2.2.m1.2">
         <semantics id="S2.E1X.3.2.2.m1.2a">
          <mrow id="S2.E1X.3.2.2.m1.2.2" xref="S2.E1X.3.2.2.m1.2.2.cmml">
           <mi id="S2.E1X.3.2.2.m1.2.2.4" xref="S2.E1X.3.2.2.m1.2.2.4.cmml">
           </mi>
           <mo id="S2.E1X.3.2.2.m1.2.2.3" xref="S2.E1X.3.2.2.m1.2.2.3.cmml">
            =
           </mo>
           <mrow id="S2.E1X.3.2.2.m1.2.2.2" xref="S2.E1X.3.2.2.m1.2.2.2.cmml">
            <mstyle displaystyle="true" id="S2.E1X.3.2.2.m1.2.2.2.4" xref="S2.E1X.3.2.2.m1.2.2.2.4.cmml">
             <mfrac id="S2.E1X.3.2.2.m1.2.2.2.4a" xref="S2.E1X.3.2.2.m1.2.2.2.4.cmml">
              <mn id="S2.E1X.3.2.2.m1.2.2.2.4.2" xref="S2.E1X.3.2.2.m1.2.2.2.4.2.cmml">
               1
              </mn>
              <mi id="S2.E1X.3.2.2.m1.2.2.2.4.3" xref="S2.E1X.3.2.2.m1.2.2.2.4.3.cmml">
               M
              </mi>
             </mfrac>
            </mstyle>
            <mo id="S2.E1X.3.2.2.m1.2.2.2.3" lspace="0em" rspace="0em" xref="S2.E1X.3.2.2.m1.2.2.2.3.cmml">
             ​
            </mo>
            <mrow id="S2.E1X.3.2.2.m1.2.2.2.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.cmml">
             <mstyle displaystyle="true" id="S2.E1X.3.2.2.m1.2.2.2.2.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.cmml">
              <munderover id="S2.E1X.3.2.2.m1.2.2.2.2.3a" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.cmml">
               <mo id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.2" movablelimits="false" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.2.cmml">
                ∑
               </mo>
               <mrow id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.cmml">
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.2.cmml">
                 m
                </mi>
                <mo id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.1" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.1.cmml">
                 =
                </mo>
                <mn id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S2.E1X.3.2.2.m1.2.2.2.2.3.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.3.cmml">
                M
               </mi>
              </munderover>
             </mstyle>
             <mrow id="S2.E1X.3.2.2.m1.2.2.2.2.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.cmml">
              <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.4" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.4.cmml">
               R
              </mi>
              <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.3" lspace="0em" rspace="0em" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">
               <mo id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <msup id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">
                <mi id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">
                 τ
                </mi>
                <mi id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">
                 m
                </mi>
               </msup>
               <mo id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
              <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.3a" lspace="0.167em" rspace="0em" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="S2.E1X.3.2.2.m1.2.2.2.2.2.5" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.cmml">
               <mrow id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.cmml">
                <msub id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.cmml">
                 <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.2" rspace="0.167em" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.2.cmml">
                  ∇
                 </mo>
                 <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.3.cmml">
                  θ
                 </mi>
                </msub>
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.2.cmml">
                 log
                </mi>
               </mrow>
               <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.5a" lspace="0.167em" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.cmml">
                ⁡
               </mo>
               <msub id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.cmml">
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.2.cmml">
                 p
                </mi>
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.3.cmml">
                 θ
                </mi>
               </msub>
              </mrow>
              <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.3b" lspace="0em" rspace="0em" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml">
               <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml">
                (
               </mo>
               <msup id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml">
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.2.cmml">
                 τ
                </mi>
                <mi id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.3" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.3.cmml">
                 m
                </mi>
               </msup>
               <mo id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.3" stretchy="false" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E1X.3.2.2.m1.2b">
           <apply id="S2.E1X.3.2.2.m1.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2">
            <eq id="S2.E1X.3.2.2.m1.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.3">
            </eq>
            <csymbol cd="latexml" id="S2.E1X.3.2.2.m1.2.2.4.cmml" xref="S2.E1X.3.2.2.m1.2.2.4">
             absent
            </csymbol>
            <apply id="S2.E1X.3.2.2.m1.2.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2">
             <times id="S2.E1X.3.2.2.m1.2.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.3">
             </times>
             <apply id="S2.E1X.3.2.2.m1.2.2.2.4.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.4">
              <divide id="S2.E1X.3.2.2.m1.2.2.2.4.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.4">
              </divide>
              <cn id="S2.E1X.3.2.2.m1.2.2.2.4.2.cmml" type="integer" xref="S2.E1X.3.2.2.m1.2.2.2.4.2">
               1
              </cn>
              <ci id="S2.E1X.3.2.2.m1.2.2.2.4.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.4.3">
               𝑀
              </ci>
             </apply>
             <apply id="S2.E1X.3.2.2.m1.2.2.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2">
              <apply id="S2.E1X.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3">
               <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.2.2.2.2.3.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3">
                superscript
               </csymbol>
               <apply id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3">
                <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3">
                 subscript
                </csymbol>
                <sum id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.2">
                </sum>
                <apply id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3">
                 <eq id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.1">
                 </eq>
                 <ci id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.2">
                  𝑚
                 </ci>
                 <cn id="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <ci id="S2.E1X.3.2.2.m1.2.2.2.2.3.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.3.3">
                𝑀
               </ci>
              </apply>
              <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2">
               <times id="S2.E1X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.3">
               </times>
               <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.4.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.4">
                𝑅
               </ci>
               <apply id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1">
                 superscript
                </csymbol>
                <ci id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.2">
                 𝜏
                </ci>
                <ci id="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1.1.1.1.1.3">
                 𝑚
                </ci>
               </apply>
               <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5">
                <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1">
                 <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1">
                  <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1">
                   subscript
                  </csymbol>
                  <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.2">
                   ∇
                  </ci>
                  <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.1.3">
                   𝜃
                  </ci>
                 </apply>
                 <log id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.1.2">
                 </log>
                </apply>
                <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2">
                 <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2">
                  subscript
                 </csymbol>
                 <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.2">
                  𝑝
                 </ci>
                 <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.5.2.3">
                  𝜃
                 </ci>
                </apply>
               </apply>
               <apply id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1">
                <csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1">
                 superscript
                </csymbol>
                <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.2">
                 𝜏
                </ci>
                <ci id="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2.2.2.1.1.3">
                 𝑚
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E1X.3.2.2.m1.2c">
           \displaystyle=\frac{1}{M}\sum_{m=1}^{M}R(\tau^{m})\nabla_{\theta}\log p_{\theta}(\tau^{m})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E1Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\frac{1}{M}\sum_{m=1}^{M}R(\tau^{m})\sum_{t=1}^{T}\nabla_{\theta}\log p_{\theta}(o_{t}^{m}|a_{&lt;t}^{m},o_{&lt;t}^{m})+\nabla_{\theta}\log p_{\theta}(a_{t}^{m}|o_{\leq t}^{m},a_{&lt;t}^{m})," class="ltx_Math" display="inline" id="S2.E1Xa.2.1.1.m1.1">
         <semantics id="S2.E1Xa.2.1.1.m1.1a">
          <mrow id="S2.E1Xa.2.1.1.m1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.cmml">
           <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.cmml">
            <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.5" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.5.cmml">
            </mi>
            <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.4.cmml">
             =
            </mo>
            <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.cmml">
             <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.cmml">
              <mstyle displaystyle="true" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.cmml">
               <mfrac id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4a" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.cmml">
                <mn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.2.cmml">
                 1
                </mn>
                <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.3.cmml">
                 M
                </mi>
               </mfrac>
              </mstyle>
              <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.3" lspace="0em" rspace="0em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml">
               ​
              </mo>
              <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml">
               <mstyle displaystyle="true" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">
                <munderover id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3a" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">
                 <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.2" movablelimits="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml">
                  ∑
                 </mo>
                 <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml">
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml">
                   m
                  </mi>
                  <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml">
                   =
                  </mo>
                  <mn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml">
                   1
                  </mn>
                 </mrow>
                 <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml">
                  M
                 </mi>
                </munderover>
               </mstyle>
               <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml">
                <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml">
                 R
                </mi>
                <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3" lspace="0em" rspace="0em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">
                 ​
                </mo>
                <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  (
                 </mo>
                 <msup id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   τ
                  </mi>
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   m
                  </mi>
                 </msup>
                 <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
                <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3a" lspace="0em" rspace="0em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml">
                 ​
                </mo>
                <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml">
                 <mstyle displaystyle="true" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml">
                  <munderover id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2a" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml">
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2" movablelimits="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">
                    ∑
                   </mo>
                   <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">
                    <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml">
                     t
                    </mi>
                    <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.1.cmml">
                     =
                    </mo>
                    <mn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml">
                     1
                    </mn>
                   </mrow>
                   <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">
                    T
                   </mi>
                  </munderover>
                 </mstyle>
                 <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml">
                  <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.cmml">
                   <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.cmml">
                    <msub id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.cmml">
                     <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.2" lspace="0.167em" rspace="0.167em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.2.cmml">
                      ∇
                     </mo>
                     <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.3.cmml">
                      θ
                     </mi>
                    </msub>
                    <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.2.cmml">
                     log
                    </mi>
                   </mrow>
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3a" lspace="0.167em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.cmml">
                    ⁡
                   </mo>
                   <msub id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.cmml">
                    <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.2.cmml">
                     p
                    </mi>
                    <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.3.cmml">
                     θ
                    </mi>
                   </msub>
                  </mrow>
                  <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.2" lspace="0em" rspace="0em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.2.cmml">
                   ​
                  </mo>
                  <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">
                    (
                   </mo>
                   <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">
                    <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.cmml">
                     <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.2.cmml">
                      o
                     </mi>
                     <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.3.cmml">
                      t
                     </mi>
                     <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.3.cmml">
                      m
                     </mi>
                    </msubsup>
                    <mo fence="false" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml">
                     |
                    </mo>
                    <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.3.cmml">
                     <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">
                      <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml">
                       a
                      </mi>
                      <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">
                       <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">
                       </mi>
                       <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">
                        &lt;
                       </mo>
                       <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">
                        t
                       </mi>
                      </mrow>
                      <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml">
                       m
                      </mi>
                     </msubsup>
                     <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.3.cmml">
                      ,
                     </mo>
                     <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.cmml">
                      <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml">
                       o
                      </mi>
                      <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml">
                       <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml">
                       </mi>
                       <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml">
                        &lt;
                       </mo>
                       <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml">
                        t
                       </mi>
                      </mrow>
                      <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.3.cmml">
                       m
                      </mi>
                     </msubsup>
                    </mrow>
                   </mrow>
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.4.cmml">
              +
             </mo>
             <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.cmml">
              <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml">
               <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml">
                <msub id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml">
                 <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2" rspace="0.167em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml">
                  ∇
                 </mo>
                 <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml">
                  θ
                 </mi>
                </msub>
                <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml">
                 log
                </mi>
               </mrow>
               <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3a" lspace="0.167em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml">
                ⁡
               </mo>
               <msub id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml">
                <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml">
                 p
                </mi>
                <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml">
                 θ
                </mi>
               </msub>
              </mrow>
              <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.2" lspace="0em" rspace="0em" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml">
               ​
              </mo>
              <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">
               <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.2" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">
                (
               </mo>
               <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">
                <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.cmml">
                 <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.2.cmml">
                  a
                 </mi>
                 <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.3.cmml">
                  t
                 </mi>
                 <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.3.cmml">
                  m
                 </mi>
                </msubsup>
                <mo fence="false" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml">
                 |
                </mo>
                <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.3.cmml">
                 <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.cmml">
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.2.cmml">
                   o
                  </mi>
                  <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.cmml">
                   <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.2.cmml">
                   </mi>
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.1.cmml">
                    ≤
                   </mo>
                   <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.3.cmml">
                    t
                   </mi>
                  </mrow>
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.3.cmml">
                   m
                  </mi>
                 </msubsup>
                 <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.3.cmml">
                  ,
                 </mo>
                 <msubsup id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.cmml">
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.2.cmml">
                   a
                  </mi>
                  <mrow id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.cmml">
                   <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.2.cmml">
                   </mi>
                   <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.1" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.1.cmml">
                    &lt;
                   </mo>
                   <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.3.cmml">
                    t
                   </mi>
                  </mrow>
                  <mi id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.3" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.3.cmml">
                   m
                  </mi>
                 </msubsup>
                </mrow>
               </mrow>
               <mo id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.3" stretchy="false" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S2.E1Xa.2.1.1.m1.1.1.1.2" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E1Xa.2.1.1.m1.1b">
           <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1">
            <eq id="S2.E1Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.4">
            </eq>
            <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.5.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.5">
             absent
            </csymbol>
            <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3">
             <plus id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.4">
             </plus>
             <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2">
              <times id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.3">
              </times>
              <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4">
               <divide id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4">
               </divide>
               <cn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.2.cmml" type="integer" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.2">
                1
               </cn>
               <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.4.3">
                𝑀
               </ci>
              </apply>
              <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2">
               <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3">
                <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3">
                 superscript
                </csymbol>
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3">
                  subscript
                 </csymbol>
                 <sum id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.2">
                 </sum>
                 <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3">
                  <eq id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.1">
                  </eq>
                  <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.2">
                   𝑚
                  </ci>
                  <cn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.2.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.3.3">
                 𝑀
                </ci>
               </apply>
               <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2">
                <times id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.3">
                </times>
                <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.4">
                 𝑅
                </ci>
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">
                  superscript
                 </csymbol>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">
                  𝜏
                 </ci>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">
                  𝑚
                 </ci>
                </apply>
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2">
                 <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2">
                  <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2">
                   superscript
                  </csymbol>
                  <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2">
                   <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2">
                    subscript
                   </csymbol>
                   <sum id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.2">
                   </sum>
                   <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3">
                    <eq id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.1">
                    </eq>
                    <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.2">
                     𝑡
                    </ci>
                    <cn id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.2.3.3">
                     1
                    </cn>
                   </apply>
                  </apply>
                  <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.2.3">
                   𝑇
                  </ci>
                 </apply>
                 <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1">
                  <times id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.2">
                  </times>
                  <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3">
                   <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1">
                    <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1">
                     <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1">
                      subscript
                     </csymbol>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.2">
                      ∇
                     </ci>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.1.3">
                      𝜃
                     </ci>
                    </apply>
                    <log id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.1.2">
                    </log>
                   </apply>
                   <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2">
                    <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2">
                     subscript
                    </csymbol>
                    <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.2">
                     𝑝
                    </ci>
                    <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.3.2.3">
                     𝜃
                    </ci>
                   </apply>
                  </apply>
                  <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1">
                   <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.3">
                    conditional
                   </csymbol>
                   <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4">
                    <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4">
                     superscript
                    </csymbol>
                    <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4">
                     <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4">
                      subscript
                     </csymbol>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.2">
                      𝑜
                     </ci>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.2.3">
                      𝑡
                     </ci>
                    </apply>
                    <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.4.3">
                     𝑚
                    </ci>
                   </apply>
                   <list id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2">
                    <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1">
                     <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1">
                      superscript
                     </csymbol>
                     <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1">
                      <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1">
                       subscript
                      </csymbol>
                      <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.2">
                       𝑎
                      </ci>
                      <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3">
                       <lt id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.1">
                       </lt>
                       <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.2">
                        absent
                       </csymbol>
                       <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.2.3.3">
                        𝑡
                       </ci>
                      </apply>
                     </apply>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.3">
                      𝑚
                     </ci>
                    </apply>
                    <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2">
                     <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2">
                      superscript
                     </csymbol>
                     <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2">
                      <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2">
                       subscript
                      </csymbol>
                      <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.2">
                       𝑜
                      </ci>
                      <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3">
                       <lt id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.1">
                       </lt>
                       <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.2">
                        absent
                       </csymbol>
                       <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.2.3.3">
                        𝑡
                       </ci>
                      </apply>
                     </apply>
                     <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.2.2.2.2.2.1.1.1.1.2.2.2.3">
                      𝑚
                     </ci>
                    </apply>
                   </list>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3">
              <times id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.2">
              </times>
              <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3">
               <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1">
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1">
                  subscript
                 </csymbol>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.2">
                  ∇
                 </ci>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.1.3">
                  𝜃
                 </ci>
                </apply>
                <log id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.1.2">
                </log>
               </apply>
               <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2">
                <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2">
                 subscript
                </csymbol>
                <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.2">
                 𝑝
                </ci>
                <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.3.2.3">
                 𝜃
                </ci>
               </apply>
              </apply>
              <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1">
               <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.3">
                conditional
               </csymbol>
               <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4">
                <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4">
                 superscript
                </csymbol>
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4">
                  subscript
                 </csymbol>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.2">
                  𝑎
                 </ci>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.4.3">
                 𝑚
                </ci>
               </apply>
               <list id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2">
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1">
                  superscript
                 </csymbol>
                 <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.2">
                   𝑜
                  </ci>
                  <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3">
                   <leq id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.1">
                   </leq>
                   <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.2">
                    absent
                   </csymbol>
                   <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.2.3.3">
                    𝑡
                   </ci>
                  </apply>
                 </apply>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.1.1.1.3">
                  𝑚
                 </ci>
                </apply>
                <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2">
                 <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2">
                  superscript
                 </csymbol>
                 <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2">
                  <csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2">
                   subscript
                  </csymbol>
                  <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.2">
                   𝑎
                  </ci>
                  <apply id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3">
                   <lt id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.1">
                   </lt>
                   <csymbol cd="latexml" id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.2">
                    absent
                   </csymbol>
                   <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.2.3.3">
                    𝑡
                   </ci>
                  </apply>
                 </apply>
                 <ci id="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.1.1.3.3.1.1.1.2.2.2.3">
                  𝑚
                 </ci>
                </apply>
               </list>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E1Xa.2.1.1.m1.1c">
           \displaystyle=\frac{1}{M}\sum_{m=1}^{M}R(\tau^{m})\sum_{t=1}^{T}\nabla_{\theta}\log p_{\theta}(o_{t}^{m}|a_{&lt;t}^{m},o_{&lt;t}^{m})+\nabla_{\theta}\log p_{\theta}(a_{t}^{m}|o_{\leq t}^{m},a_{&lt;t}^{m}),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS2.p1.16">
     with
     <math alttext="R(\tau^{m})\leq 1" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m1.1">
      <semantics id="S2.SS2.p1.11.m1.1a">
       <mrow id="S2.SS2.p1.11.m1.1.1" xref="S2.SS2.p1.11.m1.1.1.cmml">
        <mrow id="S2.SS2.p1.11.m1.1.1.1" xref="S2.SS2.p1.11.m1.1.1.1.cmml">
         <mi id="S2.SS2.p1.11.m1.1.1.1.3" xref="S2.SS2.p1.11.m1.1.1.1.3.cmml">
          R
         </mi>
         <mo id="S2.SS2.p1.11.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.SS2.p1.11.m1.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S2.SS2.p1.11.m1.1.1.1.1.1" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.cmml">
          <mo id="S2.SS2.p1.11.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msup id="S2.SS2.p1.11.m1.1.1.1.1.1.1" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.cmml">
           <mi id="S2.SS2.p1.11.m1.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.2.cmml">
            τ
           </mi>
           <mi id="S2.SS2.p1.11.m1.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.3.cmml">
            m
           </mi>
          </msup>
          <mo id="S2.SS2.p1.11.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S2.SS2.p1.11.m1.1.1.2" xref="S2.SS2.p1.11.m1.1.1.2.cmml">
         ≤
        </mo>
        <mn id="S2.SS2.p1.11.m1.1.1.3" xref="S2.SS2.p1.11.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m1.1b">
        <apply id="S2.SS2.p1.11.m1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1">
         <leq id="S2.SS2.p1.11.m1.1.1.2.cmml" xref="S2.SS2.p1.11.m1.1.1.2">
         </leq>
         <apply id="S2.SS2.p1.11.m1.1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1.1">
          <times id="S2.SS2.p1.11.m1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m1.1.1.1.2">
          </times>
          <ci id="S2.SS2.p1.11.m1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m1.1.1.1.3">
           𝑅
          </ci>
          <apply id="S2.SS2.p1.11.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S2.SS2.p1.11.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1.1.1.1">
            superscript
           </csymbol>
           <ci id="S2.SS2.p1.11.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.2">
            𝜏
           </ci>
           <ci id="S2.SS2.p1.11.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m1.1.1.1.1.1.1.3">
            𝑚
           </ci>
          </apply>
         </apply>
         <cn id="S2.SS2.p1.11.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.11.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.11.m1.1c">
        R(\tau^{m})\leq 1
       </annotation>
      </semantics>
     </math>
     as the score of the trajectory
     <math alttext="\tau^{m}" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m2.1">
      <semantics id="S2.SS2.p1.12.m2.1a">
       <msup id="S2.SS2.p1.12.m2.1.1" xref="S2.SS2.p1.12.m2.1.1.cmml">
        <mi id="S2.SS2.p1.12.m2.1.1.2" xref="S2.SS2.p1.12.m2.1.1.2.cmml">
         τ
        </mi>
        <mi id="S2.SS2.p1.12.m2.1.1.3" xref="S2.SS2.p1.12.m2.1.1.3.cmml">
         m
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m2.1b">
        <apply id="S2.SS2.p1.12.m2.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.1.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1">
          superscript
         </csymbol>
         <ci id="S2.SS2.p1.12.m2.1.1.2.cmml" xref="S2.SS2.p1.12.m2.1.1.2">
          𝜏
         </ci>
         <ci id="S2.SS2.p1.12.m2.1.1.3.cmml" xref="S2.SS2.p1.12.m2.1.1.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.12.m2.1c">
        \tau^{m}
       </annotation>
      </semantics>
     </math>
     , and
     <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m3.1">
      <semantics id="S2.SS2.p1.13.m3.1a">
       <msub id="S2.SS2.p1.13.m3.1.1" xref="S2.SS2.p1.13.m3.1.1.cmml">
        <mi id="S2.SS2.p1.13.m3.1.1.2" xref="S2.SS2.p1.13.m3.1.1.2.cmml">
         p
        </mi>
        <mi id="S2.SS2.p1.13.m3.1.1.3" xref="S2.SS2.p1.13.m3.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m3.1b">
        <apply id="S2.SS2.p1.13.m3.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.13.m3.1.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.13.m3.1.1.2.cmml" xref="S2.SS2.p1.13.m3.1.1.2">
          𝑝
         </ci>
         <ci id="S2.SS2.p1.13.m3.1.1.3.cmml" xref="S2.SS2.p1.13.m3.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.13.m3.1c">
        p_{\theta}
       </annotation>
      </semantics>
     </math>
     as the LLM with parameters
     <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m4.1">
      <semantics id="S2.SS2.p1.14.m4.1a">
       <mi id="S2.SS2.p1.14.m4.1.1" xref="S2.SS2.p1.14.m4.1.1.cmml">
        θ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m4.1b">
        <ci id="S2.SS2.p1.14.m4.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1">
         𝜃
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.14.m4.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     to be fine-tuned. While traditional policy gradient methods omit the
     <math alttext="p_{\theta}(o_{t}^{m}|a_{&lt;t}^{m},o_{&lt;t}^{m})" class="ltx_Math" display="inline" id="S2.SS2.p1.15.m5.1">
      <semantics id="S2.SS2.p1.15.m5.1a">
       <mrow id="S2.SS2.p1.15.m5.1.1" xref="S2.SS2.p1.15.m5.1.1.cmml">
        <msub id="S2.SS2.p1.15.m5.1.1.3" xref="S2.SS2.p1.15.m5.1.1.3.cmml">
         <mi id="S2.SS2.p1.15.m5.1.1.3.2" xref="S2.SS2.p1.15.m5.1.1.3.2.cmml">
          p
         </mi>
         <mi id="S2.SS2.p1.15.m5.1.1.3.3" xref="S2.SS2.p1.15.m5.1.1.3.3.cmml">
          θ
         </mi>
        </msub>
        <mo id="S2.SS2.p1.15.m5.1.1.2" lspace="0em" rspace="0em" xref="S2.SS2.p1.15.m5.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S2.SS2.p1.15.m5.1.1.1.1" xref="S2.SS2.p1.15.m5.1.1.1.1.1.cmml">
         <mo id="S2.SS2.p1.15.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.15.m5.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S2.SS2.p1.15.m5.1.1.1.1.1" xref="S2.SS2.p1.15.m5.1.1.1.1.1.cmml">
          <msubsup id="S2.SS2.p1.15.m5.1.1.1.1.1.4" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.cmml">
           <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.2.cmml">
            o
           </mi>
           <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.3.cmml">
            t
           </mi>
           <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.4.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.3.cmml">
            m
           </mi>
          </msubsup>
          <mo fence="false" id="S2.SS2.p1.15.m5.1.1.1.1.1.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.3.cmml">
           |
          </mo>
          <mrow id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.3.cmml">
           <msubsup id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.cmml">
            <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.2.cmml">
             a
            </mi>
            <mrow id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.cmml">
             <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.2.cmml">
             </mi>
             <mo id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.1" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.1.cmml">
              &lt;
             </mo>
             <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.3.cmml">
              t
             </mi>
            </mrow>
            <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.3.cmml">
             m
            </mi>
           </msubsup>
           <mo id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.3.cmml">
            ,
           </mo>
           <msubsup id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.cmml">
            <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.2.cmml">
             o
            </mi>
            <mrow id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.cmml">
             <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.2" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.2.cmml">
             </mi>
             <mo id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.1" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.1.cmml">
              &lt;
             </mo>
             <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.3.cmml">
              t
             </mi>
            </mrow>
            <mi id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.3.cmml">
             m
            </mi>
           </msubsup>
          </mrow>
         </mrow>
         <mo id="S2.SS2.p1.15.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.15.m5.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m5.1b">
        <apply id="S2.SS2.p1.15.m5.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1">
         <times id="S2.SS2.p1.15.m5.1.1.2.cmml" xref="S2.SS2.p1.15.m5.1.1.2">
         </times>
         <apply id="S2.SS2.p1.15.m5.1.1.3.cmml" xref="S2.SS2.p1.15.m5.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.3.1.cmml" xref="S2.SS2.p1.15.m5.1.1.3">
           subscript
          </csymbol>
          <ci id="S2.SS2.p1.15.m5.1.1.3.2.cmml" xref="S2.SS2.p1.15.m5.1.1.3.2">
           𝑝
          </ci>
          <ci id="S2.SS2.p1.15.m5.1.1.3.3.cmml" xref="S2.SS2.p1.15.m5.1.1.3.3">
           𝜃
          </ci>
         </apply>
         <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1">
          <csymbol cd="latexml" id="S2.SS2.p1.15.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.3">
           conditional
          </csymbol>
          <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4">
           <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4">
            superscript
           </csymbol>
           <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4">
            <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4">
             subscript
            </csymbol>
            <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.2">
             𝑜
            </ci>
            <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.4.3">
            𝑚
           </ci>
          </apply>
          <list id="S2.SS2.p1.15.m5.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2">
           <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1">
             superscript
            </csymbol>
            <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.2">
              𝑎
             </ci>
             <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3">
              <lt id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.1">
              </lt>
              <csymbol cd="latexml" id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.2">
               absent
              </csymbol>
              <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.2.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.1.1.1.3">
             𝑚
            </ci>
           </apply>
           <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2">
            <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2">
             superscript
            </csymbol>
            <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2">
              subscript
             </csymbol>
             <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.2">
              𝑜
             </ci>
             <apply id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3">
              <lt id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.1">
              </lt>
              <csymbol cd="latexml" id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.2">
               absent
              </csymbol>
              <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.2.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
            <ci id="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p1.15.m5.1.1.1.1.1.2.2.2.3">
             𝑚
            </ci>
           </apply>
          </list>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.15.m5.1c">
        p_{\theta}(o_{t}^{m}|a_{&lt;t}^{m},o_{&lt;t}^{m})
       </annotation>
      </semantics>
     </math>
     world modeling part, in our work, we keep the term and tune
     <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="S2.SS2.p1.16.m6.1">
      <semantics id="S2.SS2.p1.16.m6.1a">
       <msub id="S2.SS2.p1.16.m6.1.1" xref="S2.SS2.p1.16.m6.1.1.cmml">
        <mi id="S2.SS2.p1.16.m6.1.1.2" xref="S2.SS2.p1.16.m6.1.1.2.cmml">
         p
        </mi>
        <mi id="S2.SS2.p1.16.m6.1.1.3" xref="S2.SS2.p1.16.m6.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m6.1b">
        <apply id="S2.SS2.p1.16.m6.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.16.m6.1.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.16.m6.1.1.2.cmml" xref="S2.SS2.p1.16.m6.1.1.2">
          𝑝
         </ci>
         <ci id="S2.SS2.p1.16.m6.1.1.3.cmml" xref="S2.SS2.p1.16.m6.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.16.m6.1c">
        p_{\theta}
       </annotation>
      </semantics>
     </math>
     to learn a joint model of action and world modeling. This instructs the LLM to better align with the tasks and the environment.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS2.p2">
    <p class="ltx_p" id="S2.SS2.p2.6">
     For the gathered trajectories in each task, we filter the composed ones that result in unsuccessful task completion. This ensures that all the failed trajectories generated solely by the agent are paired with successful trajectories in the same task, and all the successful trajectories are retained in the set. Assume that in the same task, we have
     <math alttext="K\geq 1" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1">
      <semantics id="S2.SS2.p2.1.m1.1a">
       <mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">
        <mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">
         K
        </mi>
        <mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">
         ≥
        </mo>
        <mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b">
        <apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">
         <geq id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1">
         </geq>
         <ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">
          𝐾
         </ci>
         <cn id="S2.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">
        K\geq 1
       </annotation>
      </semantics>
     </math>
     successful trajectories
     <math alttext="\tau_{s}^{1}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1">
      <semantics id="S2.SS2.p2.2.m2.1a">
       <msubsup id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">
        <mi id="S2.SS2.p2.2.m2.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.cmml">
         τ
        </mi>
        <mi id="S2.SS2.p2.2.m2.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.2.3.cmml">
         s
        </mi>
        <mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">
         1
        </mn>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b">
        <apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">
          superscript
         </csymbol>
         <apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1">
          <csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1">
           subscript
          </csymbol>
          <ci id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2">
           𝜏
          </ci>
          <ci id="S2.SS2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3">
           𝑠
          </ci>
         </apply>
         <cn id="S2.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">
        \tau_{s}^{1}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\tau_{s}^{2}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1">
      <semantics id="S2.SS2.p2.3.m3.1a">
       <msubsup id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">
        <mi id="S2.SS2.p2.3.m3.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.2.2.cmml">
         τ
        </mi>
        <mi id="S2.SS2.p2.3.m3.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.2.3.cmml">
         s
        </mi>
        <mn id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">
         2
        </mn>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b">
        <apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">
          superscript
         </csymbol>
         <apply id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1">
          <csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1">
           subscript
          </csymbol>
          <ci id="S2.SS2.p2.3.m3.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2">
           𝜏
          </ci>
          <ci id="S2.SS2.p2.3.m3.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3">
           𝑠
          </ci>
         </apply>
         <cn id="S2.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S2.SS2.p2.3.m3.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">
        \tau_{s}^{2}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\cdots\tau_{s}^{K}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1">
      <semantics id="S2.SS2.p2.4.m4.1a">
       <mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">
        <mi id="S2.SS2.p2.4.m4.1.1.2" mathvariant="normal" xref="S2.SS2.p2.4.m4.1.1.2.cmml">
         ⋯
        </mi>
        <mo id="S2.SS2.p2.4.m4.1.1.1" lspace="0em" rspace="0em" xref="S2.SS2.p2.4.m4.1.1.1.cmml">
         ​
        </mo>
        <msubsup id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">
         <mi id="S2.SS2.p2.4.m4.1.1.3.2.2" xref="S2.SS2.p2.4.m4.1.1.3.2.2.cmml">
          τ
         </mi>
         <mi id="S2.SS2.p2.4.m4.1.1.3.2.3" xref="S2.SS2.p2.4.m4.1.1.3.2.3.cmml">
          s
         </mi>
         <mi id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml">
          K
         </mi>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b">
        <apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">
         <times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1">
         </times>
         <ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">
          ⋯
         </ci>
         <apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3">
           superscript
          </csymbol>
          <apply id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3">
           <csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3">
            subscript
           </csymbol>
           <ci id="S2.SS2.p2.4.m4.1.1.3.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2">
            𝜏
           </ci>
           <ci id="S2.SS2.p2.4.m4.1.1.3.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3">
            𝑠
           </ci>
          </apply>
          <ci id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">
        \cdots\tau_{s}^{K}
       </annotation>
      </semantics>
     </math>
     and a failed trajectory
     <math alttext="\tau_{f}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1">
      <semantics id="S2.SS2.p2.5.m5.1a">
       <msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">
        <mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">
         τ
        </mi>
        <mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">
         f
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b">
        <apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">
          𝜏
         </ci>
         <ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">
          𝑓
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">
        \tau_{f}
       </annotation>
      </semantics>
     </math>
     . Then Eq.(
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ) for the
     <math alttext="K\!+\!1" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1">
      <semantics id="S2.SS2.p2.6.m6.1a">
       <mrow id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">
        <mi id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">
         K
        </mi>
        <mo id="S2.SS2.p2.6.m6.1.1.1" lspace="0.052em" rspace="0.052em" xref="S2.SS2.p2.6.m6.1.1.1.cmml">
         +
        </mo>
        <mn id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b">
        <apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">
         <plus id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1">
         </plus>
         <ci id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">
          𝐾
         </ci>
         <cn id="S2.SS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S2.SS2.p2.6.m6.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">
        K\!+\!1
       </annotation>
      </semantics>
     </math>
     trajectories can be structured as
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S2.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\sum_{k=1}^{K}\nabla\log p_{\theta}(\tau_{s}^{k})+R(\tau_{f})\nabla\log p_{\theta}(\tau_{f})" class="ltx_Math" display="inline" id="S2.E2X.2.1.1.m1.3">
         <semantics id="S2.E2X.2.1.1.m1.3a">
          <mrow id="S2.E2X.2.1.1.m1.3.3" xref="S2.E2X.2.1.1.m1.3.3.cmml">
           <mrow id="S2.E2X.2.1.1.m1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.cmml">
            <mstyle displaystyle="true" id="S2.E2X.2.1.1.m1.1.1.1.2" xref="S2.E2X.2.1.1.m1.1.1.1.2.cmml">
             <munderover id="S2.E2X.2.1.1.m1.1.1.1.2a" xref="S2.E2X.2.1.1.m1.1.1.1.2.cmml">
              <mo id="S2.E2X.2.1.1.m1.1.1.1.2.2.2" movablelimits="false" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.2.cmml">
               ∑
              </mo>
              <mrow id="S2.E2X.2.1.1.m1.1.1.1.2.2.3" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.cmml">
               <mi id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.2" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.2.cmml">
                k
               </mi>
               <mo id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.1" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.1.cmml">
                =
               </mo>
               <mn id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.3" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.3.cmml">
                1
               </mn>
              </mrow>
              <mi id="S2.E2X.2.1.1.m1.1.1.1.2.3" xref="S2.E2X.2.1.1.m1.1.1.1.2.3.cmml">
               K
              </mi>
             </munderover>
            </mstyle>
            <mrow id="S2.E2X.2.1.1.m1.1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.1.cmml">
             <mrow id="S2.E2X.2.1.1.m1.1.1.1.1.3" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.cmml">
              <mrow id="S2.E2X.2.1.1.m1.1.1.1.1.3.1" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1.cmml">
               <mo id="S2.E2X.2.1.1.m1.1.1.1.1.3.1.1" lspace="0.167em" rspace="0.167em" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1.1.cmml">
                ∇
               </mo>
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.3.1.2" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1.2.cmml">
                log
               </mi>
              </mrow>
              <mo id="S2.E2X.2.1.1.m1.1.1.1.1.3a" lspace="0.167em" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.cmml">
               ⁡
              </mo>
              <msub id="S2.E2X.2.1.1.m1.1.1.1.1.3.2" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2.cmml">
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.2" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2.2.cmml">
                p
               </mi>
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.3" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2.3.cmml">
                θ
               </mi>
              </msub>
             </mrow>
             <mo id="S2.E2X.2.1.1.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2X.2.1.1.m1.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S2.E2X.2.1.1.m1.1.1.1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
              <mo id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <msubsup id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">
                τ
               </mi>
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">
                s
               </mi>
               <mi id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">
                k
               </mi>
              </msubsup>
              <mo id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S2.E2X.2.1.1.m1.3.3.4" xref="S2.E2X.2.1.1.m1.3.3.4.cmml">
            +
           </mo>
           <mrow id="S2.E2X.2.1.1.m1.3.3.3" xref="S2.E2X.2.1.1.m1.3.3.3.cmml">
            <mi id="S2.E2X.2.1.1.m1.3.3.3.4" xref="S2.E2X.2.1.1.m1.3.3.3.4.cmml">
             R
            </mi>
            <mo id="S2.E2X.2.1.1.m1.3.3.3.3" lspace="0em" rspace="0em" xref="S2.E2X.2.1.1.m1.3.3.3.3.cmml">
             ​
            </mo>
            <mrow id="S2.E2X.2.1.1.m1.2.2.2.1.1" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.cmml">
             <mo id="S2.E2X.2.1.1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.cmml">
              (
             </mo>
             <msub id="S2.E2X.2.1.1.m1.2.2.2.1.1.1" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.cmml">
              <mi id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.2" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.2.cmml">
               τ
              </mi>
              <mi id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.3" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.3.cmml">
               f
              </mi>
             </msub>
             <mo id="S2.E2X.2.1.1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.cmml">
              )
             </mo>
            </mrow>
            <mo id="S2.E2X.2.1.1.m1.3.3.3.3a" lspace="0.167em" rspace="0em" xref="S2.E2X.2.1.1.m1.3.3.3.3.cmml">
             ​
            </mo>
            <mrow id="S2.E2X.2.1.1.m1.3.3.3.5" xref="S2.E2X.2.1.1.m1.3.3.3.5.cmml">
             <mrow id="S2.E2X.2.1.1.m1.3.3.3.5.1" xref="S2.E2X.2.1.1.m1.3.3.3.5.1.cmml">
              <mo id="S2.E2X.2.1.1.m1.3.3.3.5.1.1" rspace="0.167em" xref="S2.E2X.2.1.1.m1.3.3.3.5.1.1.cmml">
               ∇
              </mo>
              <mi id="S2.E2X.2.1.1.m1.3.3.3.5.1.2" xref="S2.E2X.2.1.1.m1.3.3.3.5.1.2.cmml">
               log
              </mi>
             </mrow>
             <mo id="S2.E2X.2.1.1.m1.3.3.3.5a" lspace="0.167em" xref="S2.E2X.2.1.1.m1.3.3.3.5.cmml">
              ⁡
             </mo>
             <msub id="S2.E2X.2.1.1.m1.3.3.3.5.2" xref="S2.E2X.2.1.1.m1.3.3.3.5.2.cmml">
              <mi id="S2.E2X.2.1.1.m1.3.3.3.5.2.2" xref="S2.E2X.2.1.1.m1.3.3.3.5.2.2.cmml">
               p
              </mi>
              <mi id="S2.E2X.2.1.1.m1.3.3.3.5.2.3" xref="S2.E2X.2.1.1.m1.3.3.3.5.2.3.cmml">
               θ
              </mi>
             </msub>
            </mrow>
            <mo id="S2.E2X.2.1.1.m1.3.3.3.3b" lspace="0em" rspace="0em" xref="S2.E2X.2.1.1.m1.3.3.3.3.cmml">
             ​
            </mo>
            <mrow id="S2.E2X.2.1.1.m1.3.3.3.2.1" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.cmml">
             <mo id="S2.E2X.2.1.1.m1.3.3.3.2.1.2" stretchy="false" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.cmml">
              (
             </mo>
             <msub id="S2.E2X.2.1.1.m1.3.3.3.2.1.1" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.cmml">
              <mi id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.2" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.2.cmml">
               τ
              </mi>
              <mi id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.3" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.3.cmml">
               f
              </mi>
             </msub>
             <mo id="S2.E2X.2.1.1.m1.3.3.3.2.1.3" stretchy="false" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.3b">
           <apply id="S2.E2X.2.1.1.m1.3.3.cmml" xref="S2.E2X.2.1.1.m1.3.3">
            <plus id="S2.E2X.2.1.1.m1.3.3.4.cmml" xref="S2.E2X.2.1.1.m1.3.3.4">
            </plus>
            <apply id="S2.E2X.2.1.1.m1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1">
             <apply id="S2.E2X.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2">
              <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2">
               superscript
              </csymbol>
              <apply id="S2.E2X.2.1.1.m1.1.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2">
               <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.2.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2">
                subscript
               </csymbol>
               <sum id="S2.E2X.2.1.1.m1.1.1.1.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.2">
               </sum>
               <apply id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3">
                <eq id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.1">
                </eq>
                <ci id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.2">
                 𝑘
                </ci>
                <cn id="S2.E2X.2.1.1.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.1.1.1.2.2.3.3">
                 1
                </cn>
               </apply>
              </apply>
              <ci id="S2.E2X.2.1.1.m1.1.1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.2.3">
               𝐾
              </ci>
             </apply>
             <apply id="S2.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1">
              <times id="S2.E2X.2.1.1.m1.1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.2">
              </times>
              <apply id="S2.E2X.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3">
               <apply id="S2.E2X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1">
                <ci id="S2.E2X.2.1.1.m1.1.1.1.1.3.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1.1">
                 ∇
                </ci>
                <log id="S2.E2X.2.1.1.m1.1.1.1.1.3.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.1.2">
                </log>
               </apply>
               <apply id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2">
                <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2">
                 subscript
                </csymbol>
                <ci id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2.2">
                 𝑝
                </ci>
                <ci id="S2.E2X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.3.2.3">
                 𝜃
                </ci>
               </apply>
              </apply>
              <apply id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1">
                superscript
               </csymbol>
               <apply id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.2">
                 𝜏
                </ci>
                <ci id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.3">
                 𝑠
                </ci>
               </apply>
               <ci id="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1.1.1.1.3">
                𝑘
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="S2.E2X.2.1.1.m1.3.3.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.3">
             <times id="S2.E2X.2.1.1.m1.3.3.3.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.3">
             </times>
             <ci id="S2.E2X.2.1.1.m1.3.3.3.4.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.4">
              𝑅
             </ci>
             <apply id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.2.2.2.1.1">
              <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.2.2.2.1.1">
               subscript
              </csymbol>
              <ci id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.2">
               𝜏
              </ci>
              <ci id="S2.E2X.2.1.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.2.2.2.1.1.1.3">
               𝑓
              </ci>
             </apply>
             <apply id="S2.E2X.2.1.1.m1.3.3.3.5.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5">
              <apply id="S2.E2X.2.1.1.m1.3.3.3.5.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.1">
               <ci id="S2.E2X.2.1.1.m1.3.3.3.5.1.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.1.1">
                ∇
               </ci>
               <log id="S2.E2X.2.1.1.m1.3.3.3.5.1.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.1.2">
               </log>
              </apply>
              <apply id="S2.E2X.2.1.1.m1.3.3.3.5.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.2">
               <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.3.5.2.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.2">
                subscript
               </csymbol>
               <ci id="S2.E2X.2.1.1.m1.3.3.3.5.2.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.2.2">
                𝑝
               </ci>
               <ci id="S2.E2X.2.1.1.m1.3.3.3.5.2.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5.2.3">
                𝜃
               </ci>
              </apply>
             </apply>
             <apply id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.2.1">
              <csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.2.1">
               subscript
              </csymbol>
              <ci id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.2">
               𝜏
              </ci>
              <ci id="S2.E2X.2.1.1.m1.3.3.3.2.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.2.1.1.3">
               𝑓
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.3c">
           \displaystyle\sum_{k=1}^{K}\nabla\log p_{\theta}(\tau_{s}^{k})+R(\tau_{f})\nabla\log p_{\theta}(\tau_{f})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S2.E2Xa.2.1.1.m1.1">
         <semantics id="S2.E2Xa.2.1.1.m1.1a">
          <mo id="S2.E2Xa.2.1.1.m1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.cmml">
           =
          </mo>
          <annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.1b">
           <eq id="S2.E2Xa.2.1.1.m1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1">
           </eq>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.1c">
           \displaystyle=
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\left(1-\frac{1-R(\tau_{f})}{2K}\right)\sum_{k=1}^{K}\nabla\log p_{\theta}(\tau_{s}^{k})+\frac{1+R(\tau_{f})}{2}\nabla\log p_{\theta}(\tau_{f})" class="ltx_Math" display="inline" id="S2.E2Xa.3.2.2.m1.5">
         <semantics id="S2.E2Xa.3.2.2.m1.5a">
          <mrow id="S2.E2Xa.3.2.2.m1.5.5" xref="S2.E2Xa.3.2.2.m1.5.5.cmml">
           <mrow id="S2.E2Xa.3.2.2.m1.4.4.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.cmml">
            <mrow id="S2.E2Xa.3.2.2.m1.3.3.1.1.1" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.cmml">
             <mo id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.cmml">
              <mn id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.2.cmml">
               1
              </mn>
              <mo id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml">
               −
              </mo>
              <mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.cmml">
               <mfrac id="S2.E2Xa.3.2.2.m1.1.1a" xref="S2.E2Xa.3.2.2.m1.1.1.cmml">
                <mrow id="S2.E2Xa.3.2.2.m1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.cmml">
                 <mn id="S2.E2Xa.3.2.2.m1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.3.cmml">
                  1
                 </mn>
                 <mo id="S2.E2Xa.3.2.2.m1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.cmml">
                  −
                 </mo>
                 <mrow id="S2.E2Xa.3.2.2.m1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml">
                  <mi id="S2.E2Xa.3.2.2.m1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.cmml">
                   R
                  </mi>
                  <mo id="S2.E2Xa.3.2.2.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.2.cmml">
                   ​
                  </mo>
                  <mrow id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">
                   <mo id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">
                    (
                   </mo>
                   <msub id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">
                    <mi id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">
                     τ
                    </mi>
                    <mi id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">
                     f
                    </mi>
                   </msub>
                   <mo id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
                <mrow id="S2.E2Xa.3.2.2.m1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.3.cmml">
                 <mn id="S2.E2Xa.3.2.2.m1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.1.1.3.2.cmml">
                  2
                 </mn>
                 <mo id="S2.E2Xa.3.2.2.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.1.1.3.1.cmml">
                  ​
                 </mo>
                 <mi id="S2.E2Xa.3.2.2.m1.1.1.3.3" xref="S2.E2Xa.3.2.2.m1.1.1.3.3.cmml">
                  K
                 </mi>
                </mrow>
               </mfrac>
              </mstyle>
             </mrow>
             <mo id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
            <mo id="S2.E2Xa.3.2.2.m1.4.4.2.3" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml">
             ​
            </mo>
            <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml">
             <mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.4.4.2.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.cmml">
              <munderover id="S2.E2Xa.3.2.2.m1.4.4.2.2.2a" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.cmml">
               <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.2" movablelimits="false" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.2.cmml">
                ∑
               </mo>
               <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.cmml">
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.2.cmml">
                 k
                </mi>
                <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.1.cmml">
                 =
                </mo>
                <mn id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.3.cmml">
                K
               </mi>
              </munderover>
             </mstyle>
             <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.cmml">
              <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.cmml">
               <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.cmml">
                <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.1" lspace="0.167em" rspace="0.167em" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.1.cmml">
                 ∇
                </mo>
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.2.cmml">
                 log
                </mi>
               </mrow>
               <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3a" lspace="0.167em" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.cmml">
                ⁡
               </mo>
               <msub id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.cmml">
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.2.cmml">
                 p
                </mi>
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.3.cmml">
                 θ
                </mi>
               </msub>
              </mrow>
              <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.2" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.2.cmml">
               ​
              </mo>
              <mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml">
               <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.2" stretchy="false" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml">
                (
               </mo>
               <msubsup id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml">
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.2.cmml">
                 τ
                </mi>
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.3.cmml">
                 s
                </mi>
                <mi id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3.cmml">
                 k
                </mi>
               </msubsup>
               <mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3" stretchy="false" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S2.E2Xa.3.2.2.m1.5.5.4" xref="S2.E2Xa.3.2.2.m1.5.5.4.cmml">
            +
           </mo>
           <mrow id="S2.E2Xa.3.2.2.m1.5.5.3" xref="S2.E2Xa.3.2.2.m1.5.5.3.cmml">
            <mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.cmml">
             <mfrac id="S2.E2Xa.3.2.2.m1.2.2a" xref="S2.E2Xa.3.2.2.m1.2.2.cmml">
              <mrow id="S2.E2Xa.3.2.2.m1.2.2.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.cmml">
               <mn id="S2.E2Xa.3.2.2.m1.2.2.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.3.cmml">
                1
               </mn>
               <mo id="S2.E2Xa.3.2.2.m1.2.2.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml">
                +
               </mo>
               <mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.cmml">
                <mi id="S2.E2Xa.3.2.2.m1.2.2.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.3.cmml">
                 R
                </mi>
                <mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.2" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.cmml">
                 ​
                </mo>
                <mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">
                 <mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2" stretchy="false" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">
                  (
                 </mo>
                 <msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">
                  <mi id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">
                   τ
                  </mi>
                  <mi id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">
                   f
                  </mi>
                 </msub>
                 <mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.3" stretchy="false" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
              <mn id="S2.E2Xa.3.2.2.m1.2.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.3.cmml">
               2
              </mn>
             </mfrac>
            </mstyle>
            <mo id="S2.E2Xa.3.2.2.m1.5.5.3.2" lspace="0.167em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.5.5.3.2.cmml">
             ​
            </mo>
            <mrow id="S2.E2Xa.3.2.2.m1.5.5.3.3" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.cmml">
             <mrow id="S2.E2Xa.3.2.2.m1.5.5.3.3.1" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1.cmml">
              <mo id="S2.E2Xa.3.2.2.m1.5.5.3.3.1.1" rspace="0.167em" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1.1.cmml">
               ∇
              </mo>
              <mi id="S2.E2Xa.3.2.2.m1.5.5.3.3.1.2" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1.2.cmml">
               log
              </mi>
             </mrow>
             <mo id="S2.E2Xa.3.2.2.m1.5.5.3.3a" lspace="0.167em" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.cmml">
              ⁡
             </mo>
             <msub id="S2.E2Xa.3.2.2.m1.5.5.3.3.2" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2.cmml">
              <mi id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.2" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2.2.cmml">
               p
              </mi>
              <mi id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.3" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2.3.cmml">
               θ
              </mi>
             </msub>
            </mrow>
            <mo id="S2.E2Xa.3.2.2.m1.5.5.3.2a" lspace="0em" rspace="0em" xref="S2.E2Xa.3.2.2.m1.5.5.3.2.cmml">
             ​
            </mo>
            <mrow id="S2.E2Xa.3.2.2.m1.5.5.3.1.1" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.cmml">
             <mo id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.2" stretchy="false" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.cmml">
              (
             </mo>
             <msub id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.cmml">
              <mi id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.2.cmml">
               τ
              </mi>
              <mi id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.3.cmml">
               f
              </mi>
             </msub>
             <mo id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.3" stretchy="false" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E2Xa.3.2.2.m1.5b">
           <apply id="S2.E2Xa.3.2.2.m1.5.5.cmml" xref="S2.E2Xa.3.2.2.m1.5.5">
            <plus id="S2.E2Xa.3.2.2.m1.5.5.4.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.4">
            </plus>
            <apply id="S2.E2Xa.3.2.2.m1.4.4.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2">
             <times id="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3">
             </times>
             <apply id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1">
              <minus id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.1">
              </minus>
              <cn id="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.2.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.1.1.2">
               1
              </cn>
              <apply id="S2.E2Xa.3.2.2.m1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1">
               <divide id="S2.E2Xa.3.2.2.m1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1">
               </divide>
               <apply id="S2.E2Xa.3.2.2.m1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1">
                <minus id="S2.E2Xa.3.2.2.m1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2">
                </minus>
                <cn id="S2.E2Xa.3.2.2.m1.1.1.1.3.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.1.1.1.3">
                 1
                </cn>
                <apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1">
                 <times id="S2.E2Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.2">
                 </times>
                 <ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3">
                  𝑅
                 </ci>
                 <apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2">
                   𝜏
                  </ci>
                  <ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3">
                   𝑓
                  </ci>
                 </apply>
                </apply>
               </apply>
               <apply id="S2.E2Xa.3.2.2.m1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.3">
                <times id="S2.E2Xa.3.2.2.m1.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.3.1">
                </times>
                <cn id="S2.E2Xa.3.2.2.m1.1.1.3.2.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.1.1.3.2">
                 2
                </cn>
                <ci id="S2.E2Xa.3.2.2.m1.1.1.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.3.3">
                 𝐾
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2">
              <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2">
               <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2">
                superscript
               </csymbol>
               <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2">
                <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2">
                 subscript
                </csymbol>
                <sum id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.2">
                </sum>
                <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3">
                 <eq id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.1">
                 </eq>
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.2">
                  𝑘
                 </ci>
                 <cn id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.3.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.3">
                𝐾
               </ci>
              </apply>
              <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1">
               <times id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.2">
               </times>
               <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3">
                <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1">
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.1">
                  ∇
                 </ci>
                 <log id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.1.2">
                 </log>
                </apply>
                <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2">
                 <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2">
                  subscript
                 </csymbol>
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.2">
                  𝑝
                 </ci>
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.3.2.3">
                  𝜃
                 </ci>
                </apply>
               </apply>
               <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1">
                <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1">
                 superscript
                </csymbol>
                <apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.2">
                  𝜏
                 </ci>
                 <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.3">
                  𝑠
                 </ci>
                </apply>
                <ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3">
                 𝑘
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="S2.E2Xa.3.2.2.m1.5.5.3.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3">
             <times id="S2.E2Xa.3.2.2.m1.5.5.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.2">
             </times>
             <apply id="S2.E2Xa.3.2.2.m1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2">
              <divide id="S2.E2Xa.3.2.2.m1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2">
              </divide>
              <apply id="S2.E2Xa.3.2.2.m1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1">
               <plus id="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2">
               </plus>
               <cn id="S2.E2Xa.3.2.2.m1.2.2.1.3.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.2.2.1.3">
                1
               </cn>
               <apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1">
                <times id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2">
                </times>
                <ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.3">
                 𝑅
                </ci>
                <apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2">
                  𝜏
                 </ci>
                 <ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3">
                  𝑓
                 </ci>
                </apply>
               </apply>
              </apply>
              <cn id="S2.E2Xa.3.2.2.m1.2.2.3.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.2.2.3">
               2
              </cn>
             </apply>
             <apply id="S2.E2Xa.3.2.2.m1.5.5.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3">
              <apply id="S2.E2Xa.3.2.2.m1.5.5.3.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1">
               <ci id="S2.E2Xa.3.2.2.m1.5.5.3.3.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1.1">
                ∇
               </ci>
               <log id="S2.E2Xa.3.2.2.m1.5.5.3.3.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.1.2">
               </log>
              </apply>
              <apply id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2">
               <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2">
                subscript
               </csymbol>
               <ci id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2.2">
                𝑝
               </ci>
               <ci id="S2.E2Xa.3.2.2.m1.5.5.3.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.3.2.3">
                𝜃
               </ci>
              </apply>
             </apply>
             <apply id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1">
              <csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1">
               subscript
              </csymbol>
              <ci id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.2">
               𝜏
              </ci>
              <ci id="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.3.1.1.1.3">
               𝑓
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E2Xa.3.2.2.m1.5c">
           \displaystyle\left(1-\frac{1-R(\tau_{f})}{2K}\right)\sum_{k=1}^{K}\nabla\log p_{\theta}(\tau_{s}^{k})+\frac{1+R(\tau_{f})}{2}\nabla\log p_{\theta}(\tau_{f})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2Xb">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\quad\quad+\frac{1-R(\tau_{f})}{2K}\sum_{k=1}^{K}(\nabla\log p_{\theta}(\tau_{s}^{k})-\nabla\log p_{\theta}(\tau_{f}))," class="ltx_Math" display="inline" id="S2.E2Xb.2.1.1.m1.2">
         <semantics id="S2.E2Xb.2.1.1.m1.2a">
          <mrow id="S2.E2Xb.2.1.1.m1.2.2.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.cmml">
           <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.cmml">
            <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1a" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.cmml">
             +
            </mo>
            <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.cmml">
             <mstyle displaystyle="true" id="S2.E2Xb.2.1.1.m1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.cmml">
              <mfrac id="S2.E2Xb.2.1.1.m1.1.1a" xref="S2.E2Xb.2.1.1.m1.1.1.cmml">
               <mrow id="S2.E2Xb.2.1.1.m1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.cmml">
                <mn id="S2.E2Xb.2.1.1.m1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.1.3.cmml">
                 1
                </mn>
                <mo id="S2.E2Xb.2.1.1.m1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.1.1.1.2.cmml">
                 −
                </mo>
                <mrow id="S2.E2Xb.2.1.1.m1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.cmml">
                 <mi id="S2.E2Xb.2.1.1.m1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.3.cmml">
                  R
                 </mi>
                 <mo id="S2.E2Xb.2.1.1.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                  <mo id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <msub id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                   <mi id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">
                    τ
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">
                    f
                   </mi>
                  </msub>
                  <mo id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mrow id="S2.E2Xb.2.1.1.m1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.3.cmml">
                <mn id="S2.E2Xb.2.1.1.m1.1.1.3.2" xref="S2.E2Xb.2.1.1.m1.1.1.3.2.cmml">
                 2
                </mn>
                <mo id="S2.E2Xb.2.1.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S2.E2Xb.2.1.1.m1.1.1.3.1.cmml">
                 ​
                </mo>
                <mi id="S2.E2Xb.2.1.1.m1.1.1.3.3" xref="S2.E2Xb.2.1.1.m1.1.1.3.3.cmml">
                 K
                </mi>
               </mrow>
              </mfrac>
             </mstyle>
             <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.cmml">
              <mstyle displaystyle="true" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml">
               <munderover id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2a" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml">
                <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.2.cmml">
                 ∑
                </mo>
                <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.cmml">
                 <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.2.cmml">
                  k
                 </mi>
                 <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.1.cmml">
                  =
                 </mo>
                 <mn id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.3.cmml">
                  1
                 </mn>
                </mrow>
                <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.3.cmml">
                 K
                </mi>
               </munderover>
              </mstyle>
              <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">
               <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">
                <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">
                 <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">
                  <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">
                   <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1" rspace="0.167em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.cmml">
                    ∇
                   </mo>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2.cmml">
                    log
                   </mi>
                  </mrow>
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">
                   ⁡
                  </mo>
                  <msub id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">
                    p
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">
                    θ
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <msubsup id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                    τ
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                    s
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    k
                   </mi>
                  </msubsup>
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">
                 −
                </mo>
                <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">
                 <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">
                  <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml">
                   <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.1" rspace="0.167em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.1.cmml">
                    ∇
                   </mo>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.2.cmml">
                    log
                   </mi>
                  </mrow>
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">
                   ⁡
                  </mo>
                  <msub id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml">
                    p
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml">
                    θ
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2" lspace="0em" rspace="0em" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">
                  ​
                 </mo>
                 <mrow id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   (
                  </mo>
                  <msub id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">
                    τ
                   </mi>
                   <mi id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">
                    f
                   </mi>
                  </msub>
                  <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mo id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S2.E2Xb.2.1.1.m1.2.2.1.2" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E2Xb.2.1.1.m1.2b">
           <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1">
            <plus id="S2.E2Xb.2.1.1.m1.2.2.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1">
            </plus>
            <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1">
             <times id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.2">
             </times>
             <apply id="S2.E2Xb.2.1.1.m1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1">
              <divide id="S2.E2Xb.2.1.1.m1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1">
              </divide>
              <apply id="S2.E2Xb.2.1.1.m1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1">
               <minus id="S2.E2Xb.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.2">
               </minus>
               <cn id="S2.E2Xb.2.1.1.m1.1.1.1.3.cmml" type="integer" xref="S2.E2Xb.2.1.1.m1.1.1.1.3">
                1
               </cn>
               <apply id="S2.E2Xb.2.1.1.m1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1">
                <times id="S2.E2Xb.2.1.1.m1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.2">
                </times>
                <ci id="S2.E2Xb.2.1.1.m1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.3">
                 𝑅
                </ci>
                <apply id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.2">
                  𝜏
                 </ci>
                 <ci id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.1.3">
                  𝑓
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="S2.E2Xb.2.1.1.m1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.3">
               <times id="S2.E2Xb.2.1.1.m1.1.1.3.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.3.1">
               </times>
               <cn id="S2.E2Xb.2.1.1.m1.1.1.3.2.cmml" type="integer" xref="S2.E2Xb.2.1.1.m1.1.1.3.2">
                2
               </cn>
               <ci id="S2.E2Xb.2.1.1.m1.1.1.3.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.3.3">
                𝐾
               </ci>
              </apply>
             </apply>
             <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1">
              <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2">
                superscript
               </csymbol>
               <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2">
                <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2">
                 subscript
                </csymbol>
                <sum id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.2">
                </sum>
                <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3">
                 <eq id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.1">
                 </eq>
                 <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.2">
                  𝑘
                 </ci>
                 <cn id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.2.3">
                𝐾
               </ci>
              </apply>
              <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1">
               <minus id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.3">
               </minus>
               <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1">
                <times id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2">
                </times>
                <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3">
                 <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1">
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.1">
                   ∇
                  </ci>
                  <log id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.2">
                  </log>
                 </apply>
                 <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">
                  <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">
                   subscript
                  </csymbol>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">
                   𝑝
                  </ci>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3">
                   𝜃
                  </ci>
                 </apply>
                </apply>
                <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                  superscript
                 </csymbol>
                 <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">
                   𝜏
                  </ci>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">
                   𝑠
                  </ci>
                 </apply>
                 <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">
                  𝑘
                 </ci>
                </apply>
               </apply>
               <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2">
                <times id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2">
                </times>
                <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3">
                 <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1">
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.1">
                   ∇
                  </ci>
                  <log id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.2">
                  </log>
                 </apply>
                 <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2">
                  <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2">
                   subscript
                  </csymbol>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.2">
                   𝑝
                  </ci>
                  <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.3">
                   𝜃
                  </ci>
                 </apply>
                </apply>
                <apply id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1">
                 <csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1">
                  subscript
                 </csymbol>
                 <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.2">
                  𝜏
                 </ci>
                 <ci id="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.1.1.3">
                  𝑓
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E2Xb.2.1.1.m1.2c">
           \displaystyle\quad\quad+\frac{1-R(\tau_{f})}{2K}\sum_{k=1}^{K}(\nabla\log p_{\theta}(\tau_{s}^{k})-\nabla\log p_{\theta}(\tau_{f})),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS2.p2.8">
     where we use the fact that
     <math alttext="R(\tau_{s}^{k})=1" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m1.1">
      <semantics id="S2.SS2.p2.7.m1.1a">
       <mrow id="S2.SS2.p2.7.m1.1.1" xref="S2.SS2.p2.7.m1.1.1.cmml">
        <mrow id="S2.SS2.p2.7.m1.1.1.1" xref="S2.SS2.p2.7.m1.1.1.1.cmml">
         <mi id="S2.SS2.p2.7.m1.1.1.1.3" xref="S2.SS2.p2.7.m1.1.1.1.3.cmml">
          R
         </mi>
         <mo id="S2.SS2.p2.7.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.SS2.p2.7.m1.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S2.SS2.p2.7.m1.1.1.1.1.1" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.cmml">
          <mo id="S2.SS2.p2.7.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msubsup id="S2.SS2.p2.7.m1.1.1.1.1.1.1" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.cmml">
           <mi id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.2" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.2.cmml">
            τ
           </mi>
           <mi id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.3" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.3.cmml">
            s
           </mi>
           <mi id="S2.SS2.p2.7.m1.1.1.1.1.1.1.3" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.3.cmml">
            k
           </mi>
          </msubsup>
          <mo id="S2.SS2.p2.7.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S2.SS2.p2.7.m1.1.1.2" xref="S2.SS2.p2.7.m1.1.1.2.cmml">
         =
        </mo>
        <mn id="S2.SS2.p2.7.m1.1.1.3" xref="S2.SS2.p2.7.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m1.1b">
        <apply id="S2.SS2.p2.7.m1.1.1.cmml" xref="S2.SS2.p2.7.m1.1.1">
         <eq id="S2.SS2.p2.7.m1.1.1.2.cmml" xref="S2.SS2.p2.7.m1.1.1.2">
         </eq>
         <apply id="S2.SS2.p2.7.m1.1.1.1.cmml" xref="S2.SS2.p2.7.m1.1.1.1">
          <times id="S2.SS2.p2.7.m1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m1.1.1.1.2">
          </times>
          <ci id="S2.SS2.p2.7.m1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m1.1.1.1.3">
           𝑅
          </ci>
          <apply id="S2.SS2.p2.7.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S2.SS2.p2.7.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1">
            superscript
           </csymbol>
           <apply id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.2">
             𝜏
            </ci>
            <ci id="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.2.3">
             𝑠
            </ci>
           </apply>
           <ci id="S2.SS2.p2.7.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m1.1.1.1.1.1.1.3">
            𝑘
           </ci>
          </apply>
         </apply>
         <cn id="S2.SS2.p2.7.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.7.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.7.m1.1c">
        R(\tau_{s}^{k})=1
       </annotation>
      </semantics>
     </math>
     for all
     <math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m2.1">
      <semantics id="S2.SS2.p2.8.m2.1a">
       <mi id="S2.SS2.p2.8.m2.1.1" xref="S2.SS2.p2.8.m2.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m2.1b">
        <ci id="S2.SS2.p2.8.m2.1.1.cmml" xref="S2.SS2.p2.8.m2.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p2.8.m2.1c">
        k
       </annotation>
      </semantics>
     </math>
     as they are successful trajectories. According to Eq. (
     <a class="ltx_ref" href="#S2.E2" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ), we have the following remarks about shaping the reward of the failed trajectory:
    </p>
   </div>
   <div class="ltx_theorem ltx_theorem_remark" id="Thmremark1">
    <h6 class="ltx_title ltx_runin ltx_title_theorem">
     <span class="ltx_tag ltx_tag_theorem">
      <span class="ltx_text ltx_font_bold" id="Thmremark1.1.1.1">
       Remark 1
      </span>
     </span>
     <span class="ltx_text ltx_font_bold" id="Thmremark1.2.2">
      .
     </span>
    </h6>
    <div class="ltx_para" id="Thmremark1.p1">
     <p class="ltx_p" id="Thmremark1.p1.1">
      <span class="ltx_text ltx_font_italic" id="Thmremark1.p1.1.1">
       When
       <math alttext="R(\tau_{f})=0" class="ltx_Math" display="inline" id="Thmremark1.p1.1.1.m1.1">
        <semantics id="Thmremark1.p1.1.1.m1.1a">
         <mrow id="Thmremark1.p1.1.1.m1.1.1" xref="Thmremark1.p1.1.1.m1.1.1.cmml">
          <mrow id="Thmremark1.p1.1.1.m1.1.1.1" xref="Thmremark1.p1.1.1.m1.1.1.1.cmml">
           <mi id="Thmremark1.p1.1.1.m1.1.1.1.3" xref="Thmremark1.p1.1.1.m1.1.1.1.3.cmml">
            R
           </mi>
           <mo id="Thmremark1.p1.1.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="Thmremark1.p1.1.1.m1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="Thmremark1.p1.1.1.m1.1.1.1.1.1" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.cmml">
            <mo id="Thmremark1.p1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.cmml">
             (
            </mo>
            <msub id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.cmml">
             <mi id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.2.cmml">
              τ
             </mi>
             <mi id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.3" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">
              f
             </mi>
            </msub>
            <mo id="Thmremark1.p1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="Thmremark1.p1.1.1.m1.1.1.2" xref="Thmremark1.p1.1.1.m1.1.1.2.cmml">
           =
          </mo>
          <mn id="Thmremark1.p1.1.1.m1.1.1.3" xref="Thmremark1.p1.1.1.m1.1.1.3.cmml">
           0
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="Thmremark1.p1.1.1.m1.1b">
          <apply id="Thmremark1.p1.1.1.m1.1.1.cmml" xref="Thmremark1.p1.1.1.m1.1.1">
           <eq id="Thmremark1.p1.1.1.m1.1.1.2.cmml" xref="Thmremark1.p1.1.1.m1.1.1.2">
           </eq>
           <apply id="Thmremark1.p1.1.1.m1.1.1.1.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1">
            <times id="Thmremark1.p1.1.1.m1.1.1.1.2.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.2">
            </times>
            <ci id="Thmremark1.p1.1.1.m1.1.1.1.3.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.3">
             𝑅
            </ci>
            <apply id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.2">
              𝜏
             </ci>
             <ci id="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmremark1.p1.1.1.m1.1.1.1.1.1.1.3">
              𝑓
             </ci>
            </apply>
           </apply>
           <cn id="Thmremark1.p1.1.1.m1.1.1.3.cmml" type="integer" xref="Thmremark1.p1.1.1.m1.1.1.3">
            0
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="Thmremark1.p1.1.1.m1.1c">
          R(\tau_{f})=0
         </annotation>
        </semantics>
       </math>
       , Eq. (
       <a class="ltx_ref" href="#S2.E2" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
        <span class="ltx_text ltx_ref_tag">
         2
        </span>
       </a>
       ) is reduced to the objective of supervised fine-tuning with only the successful trajectories, which is equivalent to
       <cite class="ltx_cite ltx_citemacro_cite">
        Zhou et al. (
        <a class="ltx_ref" href="#bib.bib38" title="">
         2023b
        </a>
        )
       </cite>
       and
       <cite class="ltx_cite ltx_citemacro_cite">
        Singh et al. (
        <a class="ltx_ref" href="#bib.bib21" title="">
         2023
        </a>
        )
       </cite>
       .
      </span>
     </p>
    </div>
   </div>
   <div class="ltx_theorem ltx_theorem_remark" id="Thmremark2">
    <h6 class="ltx_title ltx_runin ltx_title_theorem">
     <span class="ltx_tag ltx_tag_theorem">
      <span class="ltx_text ltx_font_bold" id="Thmremark2.1.1.1">
       Remark 2
      </span>
     </span>
     <span class="ltx_text ltx_font_bold" id="Thmremark2.2.2">
      .
     </span>
    </h6>
    <div class="ltx_para" id="Thmremark2.p1">
     <p class="ltx_p" id="Thmremark2.p1.2">
      <span class="ltx_text ltx_font_italic" id="Thmremark2.p1.2.2">
       When
       <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="Thmremark2.p1.1.1.m1.1">
        <semantics id="Thmremark2.p1.1.1.m1.1a">
         <mrow id="Thmremark2.p1.1.1.m1.1.1" xref="Thmremark2.p1.1.1.m1.1.1.cmml">
          <mrow id="Thmremark2.p1.1.1.m1.1.1.1" xref="Thmremark2.p1.1.1.m1.1.1.1.cmml">
           <mi id="Thmremark2.p1.1.1.m1.1.1.1.3" xref="Thmremark2.p1.1.1.m1.1.1.1.3.cmml">
            R
           </mi>
           <mo id="Thmremark2.p1.1.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="Thmremark2.p1.1.1.m1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="Thmremark2.p1.1.1.m1.1.1.1.1.1" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.cmml">
            <mo id="Thmremark2.p1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.cmml">
             (
            </mo>
            <msub id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.cmml">
             <mi id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.2.cmml">
              τ
             </mi>
             <mi id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.3" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.3.cmml">
              f
             </mi>
            </msub>
            <mo id="Thmremark2.p1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="Thmremark2.p1.1.1.m1.1.1.2" xref="Thmremark2.p1.1.1.m1.1.1.2.cmml">
           =
          </mo>
          <mrow id="Thmremark2.p1.1.1.m1.1.1.3" xref="Thmremark2.p1.1.1.m1.1.1.3.cmml">
           <mo id="Thmremark2.p1.1.1.m1.1.1.3a" xref="Thmremark2.p1.1.1.m1.1.1.3.cmml">
            −
           </mo>
           <mn id="Thmremark2.p1.1.1.m1.1.1.3.2" xref="Thmremark2.p1.1.1.m1.1.1.3.2.cmml">
            1
           </mn>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="Thmremark2.p1.1.1.m1.1b">
          <apply id="Thmremark2.p1.1.1.m1.1.1.cmml" xref="Thmremark2.p1.1.1.m1.1.1">
           <eq id="Thmremark2.p1.1.1.m1.1.1.2.cmml" xref="Thmremark2.p1.1.1.m1.1.1.2">
           </eq>
           <apply id="Thmremark2.p1.1.1.m1.1.1.1.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1">
            <times id="Thmremark2.p1.1.1.m1.1.1.1.2.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.2">
            </times>
            <ci id="Thmremark2.p1.1.1.m1.1.1.1.3.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.3">
             𝑅
            </ci>
            <apply id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.2">
              𝜏
             </ci>
             <ci id="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmremark2.p1.1.1.m1.1.1.1.1.1.1.3">
              𝑓
             </ci>
            </apply>
           </apply>
           <apply id="Thmremark2.p1.1.1.m1.1.1.3.cmml" xref="Thmremark2.p1.1.1.m1.1.1.3">
            <minus id="Thmremark2.p1.1.1.m1.1.1.3.1.cmml" xref="Thmremark2.p1.1.1.m1.1.1.3">
            </minus>
            <cn id="Thmremark2.p1.1.1.m1.1.1.3.2.cmml" type="integer" xref="Thmremark2.p1.1.1.m1.1.1.3.2">
             1
            </cn>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="Thmremark2.p1.1.1.m1.1c">
          R(\tau_{f})=-1
         </annotation>
        </semantics>
       </math>
       , the coefficient of the second part (supervised fine-tuning on the failed trajectory)
       <math alttext="\nabla\log p_{\theta}(\tau_{f})" class="ltx_Math" display="inline" id="Thmremark2.p1.2.2.m2.1">
        <semantics id="Thmremark2.p1.2.2.m2.1a">
         <mrow id="Thmremark2.p1.2.2.m2.1.1" xref="Thmremark2.p1.2.2.m2.1.1.cmml">
          <mrow id="Thmremark2.p1.2.2.m2.1.1.3" xref="Thmremark2.p1.2.2.m2.1.1.3.cmml">
           <mrow id="Thmremark2.p1.2.2.m2.1.1.3.1" xref="Thmremark2.p1.2.2.m2.1.1.3.1.cmml">
            <mo id="Thmremark2.p1.2.2.m2.1.1.3.1.1" rspace="0.167em" xref="Thmremark2.p1.2.2.m2.1.1.3.1.1.cmml">
             ∇
            </mo>
            <mi id="Thmremark2.p1.2.2.m2.1.1.3.1.2" xref="Thmremark2.p1.2.2.m2.1.1.3.1.2.cmml">
             log
            </mi>
           </mrow>
           <mo id="Thmremark2.p1.2.2.m2.1.1.3a" lspace="0.167em" xref="Thmremark2.p1.2.2.m2.1.1.3.cmml">
            ⁡
           </mo>
           <msub id="Thmremark2.p1.2.2.m2.1.1.3.2" xref="Thmremark2.p1.2.2.m2.1.1.3.2.cmml">
            <mi id="Thmremark2.p1.2.2.m2.1.1.3.2.2" xref="Thmremark2.p1.2.2.m2.1.1.3.2.2.cmml">
             p
            </mi>
            <mi id="Thmremark2.p1.2.2.m2.1.1.3.2.3" xref="Thmremark2.p1.2.2.m2.1.1.3.2.3.cmml">
             θ
            </mi>
           </msub>
          </mrow>
          <mo id="Thmremark2.p1.2.2.m2.1.1.2" lspace="0em" rspace="0em" xref="Thmremark2.p1.2.2.m2.1.1.2.cmml">
           ​
          </mo>
          <mrow id="Thmremark2.p1.2.2.m2.1.1.1.1" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.cmml">
           <mo id="Thmremark2.p1.2.2.m2.1.1.1.1.2" stretchy="false" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.cmml">
            (
           </mo>
           <msub id="Thmremark2.p1.2.2.m2.1.1.1.1.1" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.cmml">
            <mi id="Thmremark2.p1.2.2.m2.1.1.1.1.1.2" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.2.cmml">
             τ
            </mi>
            <mi id="Thmremark2.p1.2.2.m2.1.1.1.1.1.3" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.3.cmml">
             f
            </mi>
           </msub>
           <mo id="Thmremark2.p1.2.2.m2.1.1.1.1.3" stretchy="false" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="Thmremark2.p1.2.2.m2.1b">
          <apply id="Thmremark2.p1.2.2.m2.1.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1">
           <times id="Thmremark2.p1.2.2.m2.1.1.2.cmml" xref="Thmremark2.p1.2.2.m2.1.1.2">
           </times>
           <apply id="Thmremark2.p1.2.2.m2.1.1.3.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3">
            <apply id="Thmremark2.p1.2.2.m2.1.1.3.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.1">
             <ci id="Thmremark2.p1.2.2.m2.1.1.3.1.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.1.1">
              ∇
             </ci>
             <log id="Thmremark2.p1.2.2.m2.1.1.3.1.2.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.1.2">
             </log>
            </apply>
            <apply id="Thmremark2.p1.2.2.m2.1.1.3.2.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.2">
             <csymbol cd="ambiguous" id="Thmremark2.p1.2.2.m2.1.1.3.2.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.2">
              subscript
             </csymbol>
             <ci id="Thmremark2.p1.2.2.m2.1.1.3.2.2.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.2.2">
              𝑝
             </ci>
             <ci id="Thmremark2.p1.2.2.m2.1.1.3.2.3.cmml" xref="Thmremark2.p1.2.2.m2.1.1.3.2.3">
              𝜃
             </ci>
            </apply>
           </apply>
           <apply id="Thmremark2.p1.2.2.m2.1.1.1.1.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1.1.1">
            <csymbol cd="ambiguous" id="Thmremark2.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmremark2.p1.2.2.m2.1.1.1.1">
             subscript
            </csymbol>
            <ci id="Thmremark2.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.2">
             𝜏
            </ci>
            <ci id="Thmremark2.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="Thmremark2.p1.2.2.m2.1.1.1.1.1.3">
             𝑓
            </ci>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="Thmremark2.p1.2.2.m2.1c">
          \nabla\log p_{\theta}(\tau_{f})
         </annotation>
        </semantics>
       </math>
       is zeroed. The objective becomes a weighted average of supervised fine-tuning on successful trajectories (the first part), and likelihood contrast between each pair of successful/failed trajectories (the third part).
      </span>
     </p>
    </div>
   </div>
   <div class="ltx_theorem ltx_theorem_remark" id="Thmremark3">
    <h6 class="ltx_title ltx_runin ltx_title_theorem">
     <span class="ltx_tag ltx_tag_theorem">
      <span class="ltx_text ltx_font_bold" id="Thmremark3.1.1.1">
       Remark 3
      </span>
     </span>
     <span class="ltx_text ltx_font_bold" id="Thmremark3.2.2">
      .
     </span>
    </h6>
    <div class="ltx_para" id="Thmremark3.p1">
     <p class="ltx_p" id="Thmremark3.p1.2">
      <span class="ltx_text ltx_font_italic" id="Thmremark3.p1.2.2">
       When
       <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="Thmremark3.p1.1.1.m1.1">
        <semantics id="Thmremark3.p1.1.1.m1.1a">
         <mrow id="Thmremark3.p1.1.1.m1.1.1" xref="Thmremark3.p1.1.1.m1.1.1.cmml">
          <mrow id="Thmremark3.p1.1.1.m1.1.1.1" xref="Thmremark3.p1.1.1.m1.1.1.1.cmml">
           <mi id="Thmremark3.p1.1.1.m1.1.1.1.3" xref="Thmremark3.p1.1.1.m1.1.1.1.3.cmml">
            R
           </mi>
           <mo id="Thmremark3.p1.1.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="Thmremark3.p1.1.1.m1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="Thmremark3.p1.1.1.m1.1.1.1.1.1" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.cmml">
            <mo id="Thmremark3.p1.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.cmml">
             (
            </mo>
            <msub id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.cmml">
             <mi id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.2.cmml">
              τ
             </mi>
             <mi id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.3" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.3.cmml">
              f
             </mi>
            </msub>
            <mo id="Thmremark3.p1.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="Thmremark3.p1.1.1.m1.1.1.2" xref="Thmremark3.p1.1.1.m1.1.1.2.cmml">
           =
          </mo>
          <mrow id="Thmremark3.p1.1.1.m1.1.1.3" xref="Thmremark3.p1.1.1.m1.1.1.3.cmml">
           <mo id="Thmremark3.p1.1.1.m1.1.1.3a" xref="Thmremark3.p1.1.1.m1.1.1.3.cmml">
            −
           </mo>
           <mn id="Thmremark3.p1.1.1.m1.1.1.3.2" xref="Thmremark3.p1.1.1.m1.1.1.3.2.cmml">
            1
           </mn>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="Thmremark3.p1.1.1.m1.1b">
          <apply id="Thmremark3.p1.1.1.m1.1.1.cmml" xref="Thmremark3.p1.1.1.m1.1.1">
           <eq id="Thmremark3.p1.1.1.m1.1.1.2.cmml" xref="Thmremark3.p1.1.1.m1.1.1.2">
           </eq>
           <apply id="Thmremark3.p1.1.1.m1.1.1.1.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1">
            <times id="Thmremark3.p1.1.1.m1.1.1.1.2.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.2">
            </times>
            <ci id="Thmremark3.p1.1.1.m1.1.1.1.3.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.3">
             𝑅
            </ci>
            <apply id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.2">
              𝜏
             </ci>
             <ci id="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmremark3.p1.1.1.m1.1.1.1.1.1.1.3">
              𝑓
             </ci>
            </apply>
           </apply>
           <apply id="Thmremark3.p1.1.1.m1.1.1.3.cmml" xref="Thmremark3.p1.1.1.m1.1.1.3">
            <minus id="Thmremark3.p1.1.1.m1.1.1.3.1.cmml" xref="Thmremark3.p1.1.1.m1.1.1.3">
            </minus>
            <cn id="Thmremark3.p1.1.1.m1.1.1.3.2.cmml" type="integer" xref="Thmremark3.p1.1.1.m1.1.1.3.2">
             1
            </cn>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="Thmremark3.p1.1.1.m1.1c">
          R(\tau_{f})=-1
         </annotation>
        </semantics>
       </math>
       and
       <math alttext="K=1" class="ltx_Math" display="inline" id="Thmremark3.p1.2.2.m2.1">
        <semantics id="Thmremark3.p1.2.2.m2.1a">
         <mrow id="Thmremark3.p1.2.2.m2.1.1" xref="Thmremark3.p1.2.2.m2.1.1.cmml">
          <mi id="Thmremark3.p1.2.2.m2.1.1.2" xref="Thmremark3.p1.2.2.m2.1.1.2.cmml">
           K
          </mi>
          <mo id="Thmremark3.p1.2.2.m2.1.1.1" xref="Thmremark3.p1.2.2.m2.1.1.1.cmml">
           =
          </mo>
          <mn id="Thmremark3.p1.2.2.m2.1.1.3" xref="Thmremark3.p1.2.2.m2.1.1.3.cmml">
           1
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="Thmremark3.p1.2.2.m2.1b">
          <apply id="Thmremark3.p1.2.2.m2.1.1.cmml" xref="Thmremark3.p1.2.2.m2.1.1">
           <eq id="Thmremark3.p1.2.2.m2.1.1.1.cmml" xref="Thmremark3.p1.2.2.m2.1.1.1">
           </eq>
           <ci id="Thmremark3.p1.2.2.m2.1.1.2.cmml" xref="Thmremark3.p1.2.2.m2.1.1.2">
            𝐾
           </ci>
           <cn id="Thmremark3.p1.2.2.m2.1.1.3.cmml" type="integer" xref="Thmremark3.p1.2.2.m2.1.1.3">
            1
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="Thmremark3.p1.2.2.m2.1c">
          K=1
         </annotation>
        </semantics>
       </math>
       , the coefficient of the first part (supervised fine-tuning on the successful trajectories) is zeroed out as well, leaving the objective into a single likelihood contrast (the third part) between trajectory pairs. According to
       <cite class="ltx_cite ltx_citemacro_cite">
        Rafailov et al. (
        <a class="ltx_ref" href="#bib.bib18" title="">
         2023
        </a>
        )
       </cite>
       , this leads to poor performance because of training instability.
      </span>
     </p>
    </div>
   </div>
   <div class="ltx_para ltx_noindent" id="S2.SS2.p3">
    <p class="ltx_p" id="S2.SS2.p3.2">
     In implementation, we binarize the reward of the failed trajectories with
     <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1">
      <semantics id="S2.SS2.p3.1.m1.1a">
       <mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">
        <mrow id="S2.SS2.p3.1.m1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.cmml">
         <mi id="S2.SS2.p3.1.m1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.3.cmml">
          R
         </mi>
         <mo id="S2.SS2.p3.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.SS2.p3.1.m1.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S2.SS2.p3.1.m1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">
          <mo id="S2.SS2.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msub id="S2.SS2.p3.1.m1.1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">
           <mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml">
            τ
           </mi>
           <mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml">
            f
           </mi>
          </msub>
          <mo id="S2.SS2.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">
         =
        </mo>
        <mrow id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">
         <mo id="S2.SS2.p3.1.m1.1.1.3a" xref="S2.SS2.p3.1.m1.1.1.3.cmml">
          −
         </mo>
         <mn id="S2.SS2.p3.1.m1.1.1.3.2" xref="S2.SS2.p3.1.m1.1.1.3.2.cmml">
          1
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b">
        <apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">
         <eq id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">
         </eq>
         <apply id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1">
          <times id="S2.SS2.p3.1.m1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.2">
          </times>
          <ci id="S2.SS2.p3.1.m1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.3">
           𝑅
          </ci>
          <apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2">
            𝜏
           </ci>
           <ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3">
            𝑓
           </ci>
          </apply>
         </apply>
         <apply id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">
          <minus id="S2.SS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.3">
          </minus>
          <cn id="S2.SS2.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S2.SS2.p3.1.m1.1.1.3.2">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">
        R(\tau_{f})=-1
       </annotation>
      </semantics>
     </math>
     . To address Remark 3, we let the agent collect multiple successful trajectories via diverse exploration to satisfy
     <math alttext="K&gt;1" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1">
      <semantics id="S2.SS2.p3.2.m2.1a">
       <mrow id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">
        <mi id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml">
         K
        </mi>
        <mo id="S2.SS2.p3.2.m2.1.1.1" xref="S2.SS2.p3.2.m2.1.1.1.cmml">
         &gt;
        </mo>
        <mn id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b">
        <apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">
         <gt id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1.1">
         </gt>
         <ci id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2">
          𝐾
         </ci>
         <cn id="S2.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p3.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">
        K&gt;1
       </annotation>
      </semantics>
     </math>
     . After training, the new agent would follow Sec.
     <a class="ltx_ref" href="#S2.SS1" title="2.1 Autonomous Trajectory Annotation with ActRe ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2.1
      </span>
     </a>
     to gather more annotated trajectories. The trajectory set then continually grows as looping more rounds of data collection and agent training. For the training in each round, we use the accumulated trajectory set to fine-tune an LLM with Eq. (
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ). Another implementation detail is that in the initial round, we use 1-shot ReAct prompting to gather the training trajectories instead of exploration and annotation for bootstrapping. The failed trajectory for each task is directly excluded as it is not paired with sampled successful trajectories. Eq. (
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ) is therefore reduced to ReAct supervised fine-tuning in
     <cite class="ltx_cite ltx_citemacro_cite">
      Yao et al. (
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      )
     </cite>
     for the training in Round 0. The latter rounds leverage explored trajectories via autonomous annotation, and self-training by Eq. (
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ) with binarized rewards. Other details are covered in Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Experiments
  </h2>
  <div class="ltx_para ltx_noindent" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    We conduct experiments on two benchmarks to valid the effectiveness of A
    <sup class="ltx_sup" id="S3.p1.1.1">
     3
    </sup>
    T: the textual embodied environment AlfWorld
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shridhar et al.,
     <a class="ltx_ref" href="#bib.bib20" title="">
      2021
     </a>
     )
    </cite>
    , and the online shopping environment WebShop
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yao et al.,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2022
     </a>
     )
    </cite>
    . The two benchmarks require a language agent to perform multi-step decision-making to accomplish a certain goal introduced in each task.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S3.p2">
   <p class="ltx_p" id="S3.p2.2">
    In A
    <sup class="ltx_sup" id="S3.p2.2.1">
     3
    </sup>
    T, we loop for 4 rounds of trajectory collection and agent training, with the initial round using ReAct prompting as the bootstrap of training data. No trajectories are gathered from testing tasks for training. We use gpt-3.5-turbo-instruct-0914 to implement the initial ReAct prompting, as well as the ActRe prompting agent that helps the trajectory composition in the latter
    <math alttext="3" class="ltx_Math" display="inline" id="S3.p2.2.m2.1">
     <semantics id="S3.p2.2.m2.1a">
      <mn id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">
       3
      </mn>
      <annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b">
       <cn id="S3.p2.2.m2.1.1.cmml" type="integer" xref="S3.p2.2.m2.1.1">
        3
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">
       3
      </annotation>
     </semantics>
    </math>
    rounds. We use the open-sourced Mistral-7B-Instruct-v0.2
    <cite class="ltx_cite ltx_citemacro_citep">
     (Jiang et al.,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023
     </a>
     )
    </cite>
    with QLoRA
    <cite class="ltx_cite ltx_citemacro_citep">
     (Dettmers et al.,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2023
     </a>
     )
    </cite>
    finetuning for the training experiments.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S3.p3">
   <p class="ltx_p" id="S3.p3.1">
    We compare our A
    <sup class="ltx_sup" id="S3.p3.1.1">
     3
    </sup>
    T framework with multiple strong baselines, including methods like advanced prompting frameworks using GPT-4, specialized LLMs by full fine-tuning, and gpt-3.5-turbo-1106 fine-tuning. The results are reported in the following sections.
   </p>
  </div>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    AlfWorld
   </h3>
   <figure class="ltx_table" id="S3.T1">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.8" style="width:397.5pt;height:131.1pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-74.2pt,24.5pt) scale(0.728246537466825,0.728246537466825) ;">
      <table class="ltx_tabular ltx_align_middle" id="S3.T1.8.8">
       <tr class="ltx_tr" id="S3.T1.8.8.9">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T1.8.8.9.1">
         Method
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.2">
         Pick
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.3">
         Clean
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.4">
         Heat
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.5">
         Cool
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.6">
         Examine
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.8.8.9.7">
         PickTwo
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.8.8.9.8">
         Total
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.1.1.1">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1">
         BUTLER
         <sub class="ltx_sub" id="S3.T1.1.1.1.1.1">
          8
         </sub>
         <cite class="ltx_cite ltx_citemacro_citep">
          (Shridhar et al.,
          <a class="ltx_ref" href="#bib.bib20" title="">
           2021
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.2">
         46
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.3">
         39
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.4">
         74
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.5">
         <span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.6">
         22
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1.7">
         24
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.8">
         37
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.2.2.2">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.2.2.2.1">
         AgentLM
         <sup class="ltx_sup" id="S3.T1.2.2.2.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T1.2.2.2.1.1.1">
           ∗
          </span>
         </sup>
         <cite class="ltx_cite ltx_citemacro_citep">
          (Zeng et al.,
          <a class="ltx_ref" href="#bib.bib34" title="">
           2023
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.2">
         -
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.3">
         -
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.4">
         -
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.5">
         -
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.6">
         -
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.2.2.7">
         -
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.2.2.2.8">
         86
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.8.8.10">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.8.8.10.1">
         LM-BUTLER
         <cite class="ltx_cite ltx_citemacro_citep">
          (Micheli &amp; Fleuret,
          <a class="ltx_ref" href="#bib.bib13" title="">
           2021
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.2">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.3">
         97
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.4">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.5">
         90
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.6">
         100
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.8.8.10.7">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.10.7.1">
          94
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.8.8.10.8">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.10.8.1">
          96
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.3.3.3">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.3.3.3.1">
         ReAct
         <sub class="ltx_sub" id="S3.T1.3.3.3.1.1">
          6
         </sub>
         <cite class="ltx_cite ltx_citemacro_citep">
          (Yao et al.,
          <a class="ltx_ref" href="#bib.bib31" title="">
           2023
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.2">
         92
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.3">
         58
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.4">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.5">
         86
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.6">
         78
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.3.3.7">
         41
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3.8">
         71
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.4.4.4">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.4.4.4.1">
         ReAct
         <sub class="ltx_sub" id="S3.T1.4.4.4.1.1">
          6
         </sub>
         (Our rerun)
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.2">
         66
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.3">
         87
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.4">
         86
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.5">
         <span class="ltx_text ltx_font_bold" id="S3.T1.4.4.4.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.6">
         88
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.4.4.4.7">
         64
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.4.4.4.8">
         83
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.5.5.5">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.5.5.5.1">
         A
         <sup class="ltx_sup" id="S3.T1.5.5.5.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T1.5.5.5.1.1.1">
           3
          </span>
         </sup>
         T (Round=0)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.2">
         96
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.3">
         77
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.4">
         100
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.5">
         95
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.6">
         94
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.5.5.7">
         47
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.5.5.8">
         86
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.6.6.6">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.6.6.6.1">
         A
         <sup class="ltx_sup" id="S3.T1.6.6.6.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T1.6.6.6.1.1.1">
           3
          </span>
         </sup>
         T (Round=1)
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.2">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.3">
         94
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.4">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.5">
         95
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.6">
         89
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.6.6.6.7">
         <span class="ltx_text ltx_font_bold" id="S3.T1.6.6.6.7.1">
          94
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.6.6.6.8">
         94
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.7.7.7">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.7.7.7.1">
         A
         <sup class="ltx_sup" id="S3.T1.7.7.7.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T1.7.7.7.1.1.1">
           3
          </span>
         </sup>
         T (Round=2)
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.2">
         <span class="ltx_text ltx_font_bold" id="S3.T1.7.7.7.2.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.3">
         <span class="ltx_text ltx_font_bold" id="S3.T1.7.7.7.3.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.4">
         <span class="ltx_text ltx_font_bold" id="S3.T1.7.7.7.4.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.5">
         95
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.6">
         89
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.7.7.7.7">
         82
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T1.7.7.7.8">
         <span class="ltx_text ltx_font_bold" id="S3.T1.7.7.7.8.1">
          96
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T1.8.8.8">
        <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T1.8.8.8.1">
         A
         <sup class="ltx_sup" id="S3.T1.8.8.8.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T1.8.8.8.1.1.1">
           3
          </span>
         </sup>
         T (Round=3)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.2">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.8.2.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.3">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.8.3.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.4">
         91
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.5">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.8.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.6">
         <span class="ltx_text ltx_font_bold" id="S3.T1.8.8.8.6.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.8.8.8.7">
         71
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.8.8.8.8">
         95
        </td>
       </tr>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 1:
     </span>
     Success rate (
     <math alttext="\%" class="ltx_Math" display="inline" id="S3.T1.16.m1.1">
      <semantics id="S3.T1.16.m1.1b">
       <mo id="S3.T1.16.m1.1.1" xref="S3.T1.16.m1.1.1.cmml">
        %
       </mo>
       <annotation-xml encoding="MathML-Content" id="S3.T1.16.m1.1c">
        <csymbol cd="latexml" id="S3.T1.16.m1.1.1.cmml" xref="S3.T1.16.m1.1.1">
         percent
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T1.16.m1.1d">
        \%
       </annotation>
      </semantics>
     </math>
     ) on each task type of AlfWorld, with a single trial on each of the 134 unseen evaluation scenarios. “BUTLER
     <sub class="ltx_sub" id="S3.T1.27.1">
      8
     </sub>
     ” and “ReAct
     <sub class="ltx_sub" id="S3.T1.28.2">
      6
     </sub>
     ” denotes the best performance of
     <math alttext="8" class="ltx_Math" display="inline" id="S3.T1.19.m4.1">
      <semantics id="S3.T1.19.m4.1b">
       <mn id="S3.T1.19.m4.1.1" xref="S3.T1.19.m4.1.1.cmml">
        8
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T1.19.m4.1c">
        <cn id="S3.T1.19.m4.1.1.cmml" type="integer" xref="S3.T1.19.m4.1.1">
         8
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T1.19.m4.1d">
        8
       </annotation>
      </semantics>
     </math>
     /
     <math alttext="6" class="ltx_Math" display="inline" id="S3.T1.20.m5.1">
      <semantics id="S3.T1.20.m5.1b">
       <mn id="S3.T1.20.m5.1.1" xref="S3.T1.20.m5.1.1.cmml">
        6
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T1.20.m5.1c">
        <cn id="S3.T1.20.m5.1.1.cmml" type="integer" xref="S3.T1.20.m5.1.1">
         6
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T1.20.m5.1d">
        6
       </annotation>
      </semantics>
     </math>
     trials following prior work. The A
     <sup class="ltx_sup" id="S3.T1.29.3">
      <span class="ltx_text ltx_font_italic" id="S3.T1.29.3.1">
       3
      </span>
     </sup>
     T agents are trained with 600 out of the total 3,553 training tasks in AlfWorld.
     <sup class="ltx_sup" id="S3.T1.30.4">
      <span class="ltx_text ltx_font_italic" id="S3.T1.30.4.1">
       ∗
      </span>
     </sup>
     : The best result reported in
     <cite class="ltx_cite ltx_citemacro_cite">
      Zeng et al. (
      <a class="ltx_ref" href="#bib.bib34" title="">
       2023
      </a>
      )
     </cite>
     .
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S3.T2">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.4" style="width:397.5pt;height:88.7pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-83.7pt,18.7pt) scale(0.703654690683085,0.703654690683085) ;">
      <table class="ltx_tabular ltx_align_middle" id="S3.T2.4.4">
       <tr class="ltx_tr" id="S3.T2.4.4.5">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T2.4.4.5.1">
         Method
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.4.4.5.2">
         Iters.
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.3">
         Pick
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.4">
         Clean
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.5">
         Heat
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.6">
         Cool
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.7">
         Examine
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.4.4.5.8">
         PickTwo
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.4.4.5.9">
         Total
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.4.4.6">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.4.4.6.1">
         Reflexion
         <cite class="ltx_cite ltx_citemacro_citep">
          (Shinn et al.,
          <a class="ltx_ref" href="#bib.bib19" title="">
           2023
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.4.4.6.2">
         11
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.3">
         96
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.4">
         94
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.6.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.6">
         95
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.7">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.6.7.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.4.4.6.8">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.6.8.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.6.9">
         97
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.4.4.7">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.4.4.7.1">
         RAFA
         <cite class="ltx_cite ltx_citemacro_citep">
          (Liu et al.,
          <a class="ltx_ref" href="#bib.bib10" title="">
           2023
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.4.4.7.2">
         8
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.3">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.7.3.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.4">
         97
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.7.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.6">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.7.6.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.7">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.7.7.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.4.4.7.8">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.7.8.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.4.4.7.9">
         99
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.1.1.1">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.1.1.1">
         A
         <sup class="ltx_sup" id="S3.T2.1.1.1.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T2.1.1.1.1.1.1">
           3
          </span>
         </sup>
         T (Round=0)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.1.2">
         1
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.3">
         96
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.4">
         77
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.6">
         95
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.7">
         94
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.1.8">
         47
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1.9">
         86
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.2.2.2">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.2.2.2.1">
         A
         <sup class="ltx_sup" id="S3.T2.2.2.2.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T2.2.2.2.1.1.1">
           3
          </span>
         </sup>
         T (Round=1, accum.)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.2.2.2">
         2
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.3">
         96
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.4">
         94
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.6">
         95
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.7">
         <span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.7.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.2.2.8">
         <span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.8.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.2.2.2.9">
         97
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.3.3.3">
        <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.3.3.3.1">
         A
         <sup class="ltx_sup" id="S3.T2.3.3.3.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T2.3.3.3.1.1.1">
           3
          </span>
         </sup>
         T (Round=2, accum.)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.3.3.3.2">
         3
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.3">
         <span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.3.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.4">
         <span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.4.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.6">
         95
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.7">
         <span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.7.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.3.3.3.8">
         <span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.8.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="S3.T2.3.3.3.9">
         99
        </td>
       </tr>
       <tr class="ltx_tr" id="S3.T2.4.4.4">
        <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T2.4.4.4.1">
         A
         <sup class="ltx_sup" id="S3.T2.4.4.4.1.1">
          <span class="ltx_text ltx_font_italic" id="S3.T2.4.4.4.1.1.1">
           3
          </span>
         </sup>
         T (Round=3, accum.)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T2.4.4.4.2">
         4
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.3">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.3.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.4">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.4.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.5">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.5.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.6">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.6.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.7">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.7.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T2.4.4.4.8">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.8.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.4.4.4.9">
         <span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.9.1">
          100
         </span>
        </td>
       </tr>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     Success rate (
     <math alttext="\%" class="ltx_Math" display="inline" id="S3.T2.8.m1.1">
      <semantics id="S3.T2.8.m1.1b">
       <mo id="S3.T2.8.m1.1.1" xref="S3.T2.8.m1.1.1.cmml">
        %
       </mo>
       <annotation-xml encoding="MathML-Content" id="S3.T2.8.m1.1c">
        <csymbol cd="latexml" id="S3.T2.8.m1.1.1.cmml" xref="S3.T2.8.m1.1.1">
         percent
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T2.8.m1.1d">
        \%
       </annotation>
      </semantics>
     </math>
     ) on each task type of AlfWorld, with iterative refinement on each of the 134 unseen evaluation scenarios. “Iters” denotes the minimum iterations of test-time refinement required to achieve the reported results
     <span class="ltx_note ltx_role_footnote" id="footnote2">
      <sup class="ltx_note_mark">
       2
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         2
        </sup>
        <span class="ltx_tag ltx_tag_note">
         2
        </span>
        The refinement iterations of Reflexion and RAFA are measured in their publicized logs:
        <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/noahshinn/reflexion/blob/main/alfworld_runs/root/reflexion_run_logs/env_results_trial_10.json" target="_blank" title="">
         https://github.com/noahshinn/reflexion/blob/main/alfworld_runs/root/reflexion_run_logs/env_results_trial_10.json
        </a>
        and
        <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/agentification/RAFA_code/blob/main/ALFWorld/run_logs/env_results_trial_7.json" target="_blank" title="">
         https://github.com/agentification/RAFA_code/blob/main/ALFWorld/run_logs/env_results_trial_7.json
        </a>
        .
       </span>
      </span>
     </span>
     , and “accum.” means the best reward of the trajectories accumulated since the
     <math alttext="0" class="ltx_Math" display="inline" id="S3.T2.9.m2.1">
      <semantics id="S3.T2.9.m2.1b">
       <mn id="S3.T2.9.m2.1.1" xref="S3.T2.9.m2.1.1.cmml">
        0
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T2.9.m2.1c">
        <cn id="S3.T2.9.m2.1.1.cmml" type="integer" xref="S3.T2.9.m2.1.1">
         0
        </cn>
       </annotation-xml>
      </semantics>
     </math>
     -th Round for each task. After the self-training process in Round 3, the success rate of the 4-shot A
     <sup class="ltx_sup" id="S3.T2.12.1">
      <span class="ltx_text ltx_font_italic" id="S3.T2.12.1.1">
       3
      </span>
     </sup>
     T agent already reaches 100%.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S3.T3">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.3">
     <tr class="ltx_tr" id="S3.T3.3.1">
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.1">
       Round
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.2">
       Pick
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.3">
       Clean
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.4">
       Heat
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.5">
       Cool
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.6">
       Examine
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.7">
       PickTwo
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.8">
       Total
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T3.3.2">
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.1">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.2">
       76
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.3">
       85
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.4">
       92
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.5">
       85
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.6">
       86
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.7">
       77
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.8">
       82
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T3.3.3">
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.1">
       1
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.2">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.3">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.4">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.5">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.6">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.7">
       99
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.3.8">
       99
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T3.3.4">
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.1">
       2
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.2">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.3">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.4">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.5">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.6">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.7">
       100
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T3.3.4.8">
       100
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T3.3.5">
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.1">
       3
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.2">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.3">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.4">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.5">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.6">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.7">
       100
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.5.8">
       100
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     The success rate (
     <math alttext="\%" class="ltx_Math" display="inline" id="S3.T3.2.m1.1">
      <semantics id="S3.T3.2.m1.1b">
       <mo id="S3.T3.2.m1.1.1" xref="S3.T3.2.m1.1.1.cmml">
        %
       </mo>
       <annotation-xml encoding="MathML-Content" id="S3.T3.2.m1.1c">
        <csymbol cd="latexml" id="S3.T3.2.m1.1.1.cmml" xref="S3.T3.2.m1.1.1">
         percent
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T3.2.m1.1d">
        \%
       </annotation>
      </semantics>
     </math>
     ) of the accumulated trajectory set in terms of each task type in the training scenarios of AlfWorld. With the agent autonomously annotating diverse trajectories, the data quality for contrastive self-training is progressively improving.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.1">
     Alfworld is a textual embodied environment where an agent needs to accomplish a high-level goal by reasoning about its situation and performing sequential low-level actuation. Covering 6 task types, the benchmark provides 3,553 tasks for training and 134 held-out tasks for unseen scenarios evaluation. We use 660 out of the 3,553 tasks for our experiments: 600 for training and 60 for validation. In each round,
     <math alttext="40" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        40
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <cn id="S3.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1">
         40
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        40
       </annotation>
      </semantics>
     </math>
     trajectories are composed for each training task failed by the policy agent. See Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     for other implementation details.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     Baseline methods are divided into two categories: the methods that make only a single trial in each test task, and the methods that perform iterative refinement in a test task. In the former category, we select BUTLER
     <cite class="ltx_cite ltx_citemacro_citep">
      (Shridhar et al.,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2021
      </a>
      )
     </cite>
     with supervised training over
     <math alttext="10^{5}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1">
      <semantics id="S3.SS1.p2.1.m1.1a">
       <msup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
        <mn id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">
         10
        </mn>
        <mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">
         5
        </mn>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b">
        <apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
          superscript
         </csymbol>
         <cn id="S3.SS1.p2.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.2">
          10
         </cn>
         <cn id="S3.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.3">
          5
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">
        10^{5}
       </annotation>
      </semantics>
     </math>
     expert trajectories on each task type. We also select LM-BUTLER
     <cite class="ltx_cite ltx_citemacro_citep">
      (Micheli &amp; Fleuret,
      <a class="ltx_ref" href="#bib.bib13" title="">
       2021
      </a>
      )
     </cite>
     that fine-tunes a full GPT2-medium by collecting expert demonstrations with the interactions from all the 3,553 tasks (with interleaved observations and external actions in each trajectory). We also compare with the best version of the fully fine-tuned AgentLM
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zeng et al.,
      <a class="ltx_ref" href="#bib.bib34" title="">
       2023
      </a>
      )
     </cite>
     in the AlfWorld task (AgentLM-70B), which leverages trajectories from all 3,553 training tasks in AlfWorld and other tasks in different benchmarks. The ReAct prompting
     <cite class="ltx_cite ltx_citemacro_citep">
      (Yao et al.,
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      )
     </cite>
     is also categorized into this category, and we also rerun the method with gpt-3.5-turbo-instruct-0914, following their setting to use 6 distinct prompts and report the best performance. In the latter category, we select Reflexion
     <cite class="ltx_cite ltx_citemacro_citep">
      (Shinn et al.,
      <a class="ltx_ref" href="#bib.bib19" title="">
       2023
      </a>
      )
     </cite>
     that prompts GPT-3.5 to self-reflect with failed trials. We also compare with RAFA
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al.,
      <a class="ltx_ref" href="#bib.bib10" title="">
       2023
      </a>
      )
     </cite>
     , a principled iterative planning framework using GPT-4 as the critic.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p3">
    <p class="ltx_p" id="S3.SS1.p3.4">
     Tables
     <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3.1 AlfWorld ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.T2" title="Table 2 ‣ 3.1 AlfWorld ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     show the performance comparison of our framework. For the single trial setting, the overall success rate of our agent reaches
     <math alttext="96\%" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1">
      <semantics id="S3.SS1.p3.1.m1.1a">
       <mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">
        <mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">
         96
        </mn>
        <mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">
         %
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b">
        <apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">
         <csymbol cd="latexml" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1">
          percent
         </csymbol>
         <cn id="S3.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2">
          96
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">
        96\%
       </annotation>
      </semantics>
     </math>
     at
     <math alttext="2" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1">
      <semantics id="S3.SS1.p3.2.m2.1a">
       <mn id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">
        2
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b">
        <cn id="S3.SS1.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1">
         2
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">
        2
       </annotation>
      </semantics>
     </math>
     -nd round and matches the prior SoTA (LM-BUTLER). However, our agent is trained with a QLoRA of 26M parameters and 600 training tasks, while LM-BUTLER is fine-tuned from a full GPT2-medium of 355M parameters and all 3,553 training tasks. Besides, our agent demonstrates constant performance improvements with the
     <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1">
      <semantics id="S3.SS1.p3.3.m3.1a">
       <mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b">
        <cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">
        4
       </annotation>
      </semantics>
     </math>
     rounds in the held-out seen evaluation scenarios and outperforms LM-BUTLER (Table
     <a class="ltx_ref" href="#A3.T14" title="Table 14 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       14
      </span>
     </a>
     in Appendix
     <a class="ltx_ref" href="#A3.SS1" title="C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       C.1
      </span>
     </a>
     ). For the iterative refinement setting, our agent obtains 100% success by accumulating the decision-making trials of all the
     <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1">
      <semantics id="S3.SS1.p3.4.m4.1a">
       <mn id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b">
        <cn id="S3.SS1.p3.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">
        4
       </annotation>
      </semantics>
     </math>
     trained agents from each round. The accumulated trajectory set accounts for the significance of the performance. Table
     <a class="ltx_ref" href="#S3.T3" title="Table 3 ‣ 3.1 AlfWorld ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     shows that the success rate of the trajectories composed by the agent on the training tasks improves continually. More details are covered in Appendix
     <a class="ltx_ref" href="#A3.SS1" title="C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       C.1
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    WebShop
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.3">
     WebShop is an online shopping environment where an agent needs to purchase the most suitable item according to a provided instruction. The agent should navigate through a sequence of query searches and button clicks on the website to accomplish the task. WebShop provides a real-valued reward
     <math alttext="R\in[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2">
      <semantics id="S3.SS2.p1.1.m1.2a">
       <mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml">
        <mi id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml">
         R
        </mi>
        <mo id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">
         <mo id="S3.SS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">
          [
         </mo>
         <mn id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
          0
         </mn>
         <mo id="S3.SS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">
          1
         </mn>
         <mo id="S3.SS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b">
        <apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3">
         <in id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1">
         </in>
         <ci id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2">
          𝑅
         </ci>
         <interval closure="closed" id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2">
          <cn id="S3.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1">
           0
          </cn>
          <cn id="S3.SS2.p1.1.m1.2.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">
        R\in[0,1]
       </annotation>
      </semantics>
     </math>
     , with
     <math alttext="R=1" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1">
      <semantics id="S3.SS2.p1.2.m2.1a">
       <mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">
        <mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">
         R
        </mi>
        <mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b">
        <apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">
         <eq id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">
          𝑅
         </ci>
         <cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">
        R=1
       </annotation>
      </semantics>
     </math>
     as success. The benchmark provides 11,587 tasks for training and validation, and 500 held-out tasks as testing scenarios. We use 2,700 out of the 11,587 tasks for our experiments, with 2,300 for training and 400 for validation.
     <math alttext="20" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1">
      <semantics id="S3.SS2.p1.3.m3.1a">
       <mn id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">
        20
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b">
        <cn id="S3.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1">
         20
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">
        20
       </annotation>
      </semantics>
     </math>
     trajectories are composed for each training task failed by our trained agent in each round. Other training details are listed in Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.1">
     Baseline methods are still divided by whether or not to perform test-time iterative refinement. For the setting of a single test trial, we compare with ReAct prompting and WebGUM
     <cite class="ltx_cite ltx_citemacro_citep">
      (Furuta et al.,
      <a class="ltx_ref" href="#bib.bib5" title="">
       2024
      </a>
      )
     </cite>
     by jointly fine-tuning a ViT visual encoder and a Flan-T5-XL. Recently, AgentBoard
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ma et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2024
      </a>
      )
     </cite>
     offers an easy/hard split of the first
     <math alttext="251" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1">
      <semantics id="S3.SS2.p2.1.m1.1a">
       <mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">
        251
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b">
        <cn id="S3.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1">
         251
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">
        251
       </annotation>
      </semantics>
     </math>
     test tasks in WebShop for better evaluation, and
     <cite class="ltx_cite ltx_citemacro_cite">
      Liu et al. (
      <a class="ltx_ref" href="#bib.bib11" title="">
       2024
      </a>
      )
     </cite>
     report the benchmarked results of xLAM-v0.1
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhang et al.,
      <a class="ltx_ref" href="#bib.bib35" title="">
       2024
      </a>
      )
     </cite>
     with multi-task full finetuning of Mixtral-8x7B-Instruct-v0.1
     <cite class="ltx_cite ltx_citemacro_citep">
      (Jiang et al.,
      <a class="ltx_ref" href="#bib.bib8" title="">
       2024
      </a>
      )
     </cite>
     . We also include xLAM-v0.1
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhang et al.,
      <a class="ltx_ref" href="#bib.bib35" title="">
       2024
      </a>
      )
     </cite>
     as a single-shot baseline and report the performance comparison on AgentBoard. While LUMOS
     <cite class="ltx_cite ltx_citemacro_citep">
      (Yin et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2023
      </a>
      )
     </cite>
     shares a similar spirit with xLAM-v0.1, the WebShop task is treated as an unseen scenario in their setting. To conduct a fair comparison, we do not compare ours with LUMOS. For the setting that allows test-time iterative refinement, Reflexion has been claimed to be ineffective in
     <cite class="ltx_cite ltx_citemacro_cite">
      Shinn et al. (
      <a class="ltx_ref" href="#bib.bib19" title="">
       2023
      </a>
      )
     </cite>
     . We compare ours with LATS
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhou et al.,
      <a class="ltx_ref" href="#bib.bib37" title="">
       2023a
      </a>
      )
     </cite>
     , a prompting-based language agent with multiple rounds of self-reflection and tree search.
    </p>
   </div>
   <figure class="ltx_table" id="S3.T4">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T4.12">
     <tr class="ltx_tr" id="S3.T4.12.13">
      <td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T4.12.13.1">
       Test Trial
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T4.12.13.2">
       Method
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T4.12.13.3">
       Valid.
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.12.13.4">
       Test.
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.14">
      <td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.12.14.1" rowspan="7">
       <span class="ltx_text" id="S3.T4.12.14.1.1">
        Single
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.12.14.2">
       ReAct
       <cite class="ltx_cite ltx_citemacro_citep">
        (Yao et al.,
        <a class="ltx_ref" href="#bib.bib31" title="">
         2023
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.12.14.3">
       -
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.12.14.4">
       66.6/40.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.15">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.12.15.1">
       ReAct (Our rerun)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.12.15.2">
       63.7/34.7
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.12.15.3">
       68.5/40.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.16">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.12.16.1">
       WebGUM
       <cite class="ltx_cite ltx_citemacro_citep">
        (Furuta et al.,
        <a class="ltx_ref" href="#bib.bib5" title="">
         2024
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.12.16.2">
       -
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.12.16.3">
       67.5/45.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.1.1">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.1.1.1">
       AgentLM
       <sup class="ltx_sup" id="S3.T4.1.1.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.1.1.1.1.1">
         ∗
        </span>
       </sup>
       <cite class="ltx_cite ltx_citemacro_citep">
        (Zeng et al.,
        <a class="ltx_ref" href="#bib.bib34" title="">
         2023
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.2">
       -
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.1.1.3">
       70.8/  -
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.2.2">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.2.2.1">
       A
       <sup class="ltx_sup" id="S3.T4.2.2.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.2.2.1.1.1">
         3
        </span>
       </sup>
       T (Round=0)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.2.2.2">
       <span class="ltx_text ltx_font_bold" id="S3.T4.2.2.2.1">
        70.1
       </span>
       /41.0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.2.2.3">
       72.4/45.4
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.3.3.1">
       A
       <sup class="ltx_sup" id="S3.T4.3.3.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.3.3.1.1.1">
         3
        </span>
       </sup>
       T (Round=1)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.3.3.2">
       69.7/43.0
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.3.3.3">
       73.1/
       <span class="ltx_text ltx_font_bold" id="S3.T4.3.3.3.1">
        49.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.4.4">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.4.4.1">
       A
       <sup class="ltx_sup" id="S3.T4.4.4.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.4.4.1.1.1">
         3
        </span>
       </sup>
       T (Round=2)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.4.4.2">
       69.0/
       <span class="ltx_text ltx_font_bold" id="S3.T4.4.4.2.1">
        43.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.4.4.3">
       73.0/48.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.5.5">
      <td class="ltx_td" id="S3.T4.5.5.2">
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.5.5.1">
       A
       <sup class="ltx_sup" id="S3.T4.5.5.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.5.5.1.1.1">
         3
        </span>
       </sup>
       T (Round=3)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.5.5.3">
       69.1/42.8
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.5.5.4">
       <span class="ltx_text ltx_font_bold" id="S3.T4.5.5.4.1">
        73.9
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T4.5.5.4.2">
        49.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.6.6">
      <td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.6.6.2" rowspan="4">
       <span class="ltx_text" id="S3.T4.6.6.2.1">
        Iterative
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.6.6.1">
       LATS
       <sub class="ltx_sub" id="S3.T4.6.6.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.6.6.1.1.1">
         30
        </span>
       </sub>
       <cite class="ltx_cite ltx_citemacro_citep">
        (Zhou et al.,
        <a class="ltx_ref" href="#bib.bib37" title="">
         2023a
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.6.6.3">
       -
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.6.6.4">
       75.9/38.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.8.8">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.8.8.2">
       A
       <sup class="ltx_sup" id="S3.T4.8.8.2.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.8.8.2.1.1">
         3
        </span>
       </sup>
       T
       <sub class="ltx_sub" id="S3.T4.8.8.2.2">
        <span class="ltx_text ltx_font_italic" id="S3.T4.8.8.2.2.1">
         2
        </span>
       </sub>
       (Round=1, accum.)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.8.8.3">
       74.0/47.3
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.8.8.4">
       76.6/51.6
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.10.10">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.10.10.2">
       A
       <sup class="ltx_sup" id="S3.T4.10.10.2.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.10.10.2.1.1">
         3
        </span>
       </sup>
       T
       <sub class="ltx_sub" id="S3.T4.10.10.2.2">
        <span class="ltx_text ltx_font_italic" id="S3.T4.10.10.2.2.1">
         3
        </span>
       </sub>
       (Round=2, accum.)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.10.10.3">
       75.1/49.5
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.10.10.4">
       77.8/53.4
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.12">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T4.12.12.2">
       A
       <sup class="ltx_sup" id="S3.T4.12.12.2.1">
        <span class="ltx_text ltx_font_italic" id="S3.T4.12.12.2.1.1">
         3
        </span>
       </sup>
       T
       <sub class="ltx_sub" id="S3.T4.12.12.2.2">
        <span class="ltx_text ltx_font_italic" id="S3.T4.12.12.2.2.1">
         4
        </span>
       </sub>
       (Round=3, accum.)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.12.12.3">
       <span class="ltx_text ltx_font_bold" id="S3.T4.12.12.3.1">
        75.9
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T4.12.12.3.2">
        51.3
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T4.12.12.4">
       <span class="ltx_text ltx_font_bold" id="S3.T4.12.12.4.1">
        78.2
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T4.12.12.4.2">
        54.8
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.17">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S3.T4.12.17.1" rowspan="2">
       <span class="ltx_text" id="S3.T4.12.17.1.1">
        -
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T4.12.17.2">
       Human (average)
       <cite class="ltx_cite ltx_citemacro_citep">
        (Yao et al.,
        <a class="ltx_ref" href="#bib.bib30" title="">
         2022
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.12.17.3">
       -
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.12.17.4">
       75.5/50.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T4.12.18">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T4.12.18.1">
       Human (expert)
       <cite class="ltx_cite ltx_citemacro_citep">
        (Yao et al.,
        <a class="ltx_ref" href="#bib.bib30" title="">
         2022
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T4.12.18.2">
       -
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.12.18.3">
       82.1/59.6
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     Reward (
     <math alttext="\times 100" class="ltx_Math" display="inline" id="S3.T4.24.m1.1">
      <semantics id="S3.T4.24.m1.1b">
       <mrow id="S3.T4.24.m1.1.1" xref="S3.T4.24.m1.1.1.cmml">
        <mi id="S3.T4.24.m1.1.1.2" xref="S3.T4.24.m1.1.1.2.cmml">
        </mi>
        <mo id="S3.T4.24.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T4.24.m1.1.1.1.cmml">
         ×
        </mo>
        <mn id="S3.T4.24.m1.1.1.3" xref="S3.T4.24.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T4.24.m1.1c">
        <apply id="S3.T4.24.m1.1.1.cmml" xref="S3.T4.24.m1.1.1">
         <times id="S3.T4.24.m1.1.1.1.cmml" xref="S3.T4.24.m1.1.1.1">
         </times>
         <csymbol cd="latexml" id="S3.T4.24.m1.1.1.2.cmml" xref="S3.T4.24.m1.1.1.2">
          absent
         </csymbol>
         <cn id="S3.T4.24.m1.1.1.3.cmml" type="integer" xref="S3.T4.24.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T4.24.m1.1d">
        \times 100
       </annotation>
      </semantics>
     </math>
     ) and success rate (
     <math alttext="\times 100\%" class="ltx_Math" display="inline" id="S3.T4.25.m2.1">
      <semantics id="S3.T4.25.m2.1b">
       <mrow id="S3.T4.25.m2.1.1" xref="S3.T4.25.m2.1.1.cmml">
        <mi id="S3.T4.25.m2.1.1.2" xref="S3.T4.25.m2.1.1.2.cmml">
        </mi>
        <mo id="S3.T4.25.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T4.25.m2.1.1.1.cmml">
         ×
        </mo>
        <mrow id="S3.T4.25.m2.1.1.3" xref="S3.T4.25.m2.1.1.3.cmml">
         <mn id="S3.T4.25.m2.1.1.3.2" xref="S3.T4.25.m2.1.1.3.2.cmml">
          100
         </mn>
         <mo id="S3.T4.25.m2.1.1.3.1" xref="S3.T4.25.m2.1.1.3.1.cmml">
          %
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T4.25.m2.1c">
        <apply id="S3.T4.25.m2.1.1.cmml" xref="S3.T4.25.m2.1.1">
         <times id="S3.T4.25.m2.1.1.1.cmml" xref="S3.T4.25.m2.1.1.1">
         </times>
         <csymbol cd="latexml" id="S3.T4.25.m2.1.1.2.cmml" xref="S3.T4.25.m2.1.1.2">
          absent
         </csymbol>
         <apply id="S3.T4.25.m2.1.1.3.cmml" xref="S3.T4.25.m2.1.1.3">
          <csymbol cd="latexml" id="S3.T4.25.m2.1.1.3.1.cmml" xref="S3.T4.25.m2.1.1.3.1">
           percent
          </csymbol>
          <cn id="S3.T4.25.m2.1.1.3.2.cmml" type="integer" xref="S3.T4.25.m2.1.1.3.2">
           100
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T4.25.m2.1d">
        \times 100\%
       </annotation>
      </semantics>
     </math>
     ) on the validation and the test sets in WebShop.
     <sup class="ltx_sup" id="S3.T4.42.1">
      <span class="ltx_text ltx_font_italic" id="S3.T4.42.1.1">
       ∗
      </span>
     </sup>
     : The best result reported in
     <cite class="ltx_cite ltx_citemacro_cite">
      Zeng et al. (
      <a class="ltx_ref" href="#bib.bib34" title="">
       2023
      </a>
      )
     </cite>
     . “LATS
     <sub class="ltx_sub" id="S3.T4.43.2">
      <span class="ltx_text ltx_font_italic" id="S3.T4.43.2.1">
       30
      </span>
     </sub>
     ” or “A
     <sup class="ltx_sup" id="S3.T4.44.3">
      <span class="ltx_text ltx_font_italic" id="S3.T4.44.3.1">
       3
      </span>
     </sup>
     T
     <sub class="ltx_sub" id="S3.T4.45.4">
      <span class="ltx_text ltx_font_italic" id="S3.T4.45.4.1">
       4
      </span>
     </sub>
     ” denotes using
     <math alttext="30" class="ltx_Math" display="inline" id="S3.T4.30.m7.1">
      <semantics id="S3.T4.30.m7.1b">
       <mn id="S3.T4.30.m7.1.1" xref="S3.T4.30.m7.1.1.cmml">
        30
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T4.30.m7.1c">
        <cn id="S3.T4.30.m7.1.1.cmml" type="integer" xref="S3.T4.30.m7.1.1">
         30
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T4.30.m7.1d">
        30
       </annotation>
      </semantics>
     </math>
     or
     <math alttext="4" class="ltx_Math" display="inline" id="S3.T4.31.m8.1">
      <semantics id="S3.T4.31.m8.1b">
       <mn id="S3.T4.31.m8.1.1" xref="S3.T4.31.m8.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T4.31.m8.1c">
        <cn id="S3.T4.31.m8.1.1.cmml" type="integer" xref="S3.T4.31.m8.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T4.31.m8.1d">
        4
       </annotation>
      </semantics>
     </math>
     test trials. The A
     <sup class="ltx_sup" id="S3.T4.46.5">
      <span class="ltx_text ltx_font_italic" id="S3.T4.46.5.1">
       3
      </span>
     </sup>
     T agents are trained with 2,300 out of the total 11,587 training and validation tasks in WebShop. The single-shot A
     <sup class="ltx_sup" id="S3.T4.47.6">
      3
     </sup>
     T matches averaged human performance, while the multi-shot A
     <sup class="ltx_sup" id="S3.T4.48.7">
      3
     </sup>
     T closes the performance gap with human experts.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S3.T5">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T5.8">
     <tr class="ltx_tr" id="S3.T5.8.9">
      <td class="ltx_td ltx_border_r ltx_border_tt" id="S3.T5.8.9.1">
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T5.8.9.2">
       LLM
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.8.9.3">
       easy
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.8.9.4">
       hard
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T5.8.9.5">
       all
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.1.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T5.1.1.2" rowspan="3">
       <span class="ltx_text" id="S3.T5.1.1.2.1">
        Prompting
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T5.1.1.1">
       GPT-3.5-Turbo-16k-0613
       <sup class="ltx_sup" id="S3.T5.1.1.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T5.1.1.1.1.1">
         ∗
        </span>
       </sup>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.3">
       52.8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.4">
       50.6
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.5">
       52.2
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.2.2">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T5.2.2.1">
       GPT-4-Turbo-0613
       <sup class="ltx_sup" id="S3.T5.2.2.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T5.2.2.1.1.1">
         ∗
        </span>
       </sup>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.2.2.2">
       67.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.2.2.3">
       67.4
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.2.2.4">
       67.6
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T5.3.3.1">
       GPT-4-32k-0613
       <sup class="ltx_sup" id="S3.T5.3.3.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T5.3.3.1.1.1">
         ∗
        </span>
       </sup>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.3.3.2">
       67.5
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.3.3.3">
       69.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.3.3.4">
       68.1
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.4.4">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S3.T5.4.4.2" rowspan="5">
       <span class="ltx_text" id="S3.T5.4.4.2.1">
        Training
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T5.4.4.1">
       xLAM-v0.1
       <sup class="ltx_sup" id="S3.T5.4.4.1.1">
        <span class="ltx_text ltx_font_italic" id="S3.T5.4.4.1.1.1">
         ∗
        </span>
       </sup>
       <cite class="ltx_cite ltx_citemacro_citep">
        (Zhang et al.,
        <a class="ltx_ref" href="#bib.bib35" title="">
         2024
        </a>
        )
       </cite>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.4.4.3">
       53.2
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.4.4.4">
       51.2
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.4.4.5">
       52.4
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.5.5">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T5.5.5.1">
       A
       <sup class="ltx_sup" id="S3.T5.5.5.1.1">
        3
       </sup>
       T (Round=0)
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.5.5.2">
       <span class="ltx_text ltx_font_bold" id="S3.T5.5.5.2.1">
        74.1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.5.5.3">
       66.5
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.5.5.4">
       72.0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.6.6">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T5.6.6.1">
       A
       <sup class="ltx_sup" id="S3.T5.6.6.1.1">
        3
       </sup>
       T (Round=1)
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.6.6.2">
       73.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.6.6.3">
       73.2
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.6.6.4">
       <span class="ltx_text ltx_font_bold" id="S3.T5.6.6.4.1">
        73.5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.7.7">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T5.7.7.1">
       A
       <sup class="ltx_sup" id="S3.T5.7.7.1.1">
        3
       </sup>
       T (Round=2)
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.7.7.2">
       71.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.7.7.3">
       <span class="ltx_text ltx_font_bold" id="S3.T5.7.7.3.1">
        74.2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T5.7.7.4">
       72.3
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T5.8.8">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T5.8.8.1">
       A
       <sup class="ltx_sup" id="S3.T5.8.8.1.1">
        3
       </sup>
       T (Round=3)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.8.8.2">
       72.5
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.8.8.3">
       73.9
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.8.8.4">
       72.9
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 5:
     </span>
     The average reward (
     <math alttext="\times 100" class="ltx_Math" display="inline" id="S3.T5.12.m1.1">
      <semantics id="S3.T5.12.m1.1b">
       <mrow id="S3.T5.12.m1.1.1" xref="S3.T5.12.m1.1.1.cmml">
        <mi id="S3.T5.12.m1.1.1.2" xref="S3.T5.12.m1.1.1.2.cmml">
        </mi>
        <mo id="S3.T5.12.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T5.12.m1.1.1.1.cmml">
         ×
        </mo>
        <mn id="S3.T5.12.m1.1.1.3" xref="S3.T5.12.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T5.12.m1.1c">
        <apply id="S3.T5.12.m1.1.1.cmml" xref="S3.T5.12.m1.1.1">
         <times id="S3.T5.12.m1.1.1.1.cmml" xref="S3.T5.12.m1.1.1.1">
         </times>
         <csymbol cd="latexml" id="S3.T5.12.m1.1.1.2.cmml" xref="S3.T5.12.m1.1.1.2">
          absent
         </csymbol>
         <cn id="S3.T5.12.m1.1.1.3.cmml" type="integer" xref="S3.T5.12.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T5.12.m1.1d">
        \times 100
       </annotation>
      </semantics>
     </math>
     ) in the easy/hard split for WebShop by AgentBoard
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ma et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2024
      </a>
      )
     </cite>
     .
     <sup class="ltx_sup" id="S3.T5.17.1">
      <span class="ltx_text ltx_font_italic" id="S3.T5.17.1.1">
       ∗
      </span>
     </sup>
     : Results reported in
     <cite class="ltx_cite ltx_citemacro_cite">
      Liu et al. (
      <a class="ltx_ref" href="#bib.bib11" title="">
       2024
      </a>
      )
     </cite>
     . The single-shot A
     <sup class="ltx_sup" id="S3.T5.18.2">
      3
     </sup>
     T model significantly surpasses prompting methods with the most capable LLMs like GPT-4.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S3.T6">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T6.3">
     <tr class="ltx_tr" id="S3.T6.3.3">
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.3.3.4">
       Round
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.1.1.1">
       Reward R (
       <math alttext="\times 100" class="ltx_Math" display="inline" id="S3.T6.1.1.1.m1.1">
        <semantics id="S3.T6.1.1.1.m1.1a">
         <mrow id="S3.T6.1.1.1.m1.1.1" xref="S3.T6.1.1.1.m1.1.1.cmml">
          <mi id="S3.T6.1.1.1.m1.1.1.2" xref="S3.T6.1.1.1.m1.1.1.2.cmml">
          </mi>
          <mo id="S3.T6.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.T6.1.1.1.m1.1.1.1.cmml">
           ×
          </mo>
          <mn id="S3.T6.1.1.1.m1.1.1.3" xref="S3.T6.1.1.1.m1.1.1.3.cmml">
           100
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T6.1.1.1.m1.1b">
          <apply id="S3.T6.1.1.1.m1.1.1.cmml" xref="S3.T6.1.1.1.m1.1.1">
           <times id="S3.T6.1.1.1.m1.1.1.1.cmml" xref="S3.T6.1.1.1.m1.1.1.1">
           </times>
           <csymbol cd="latexml" id="S3.T6.1.1.1.m1.1.1.2.cmml" xref="S3.T6.1.1.1.m1.1.1.2">
            absent
           </csymbol>
           <cn id="S3.T6.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T6.1.1.1.m1.1.1.3">
            100
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T6.1.1.1.m1.1c">
          \times 100
         </annotation>
        </semantics>
       </math>
       )
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.3.3.5">
       Success Rate (%)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.2.2.2">
       %
       <math alttext="\left\{\mathrm{R}\geq 0.75\right\}" class="ltx_Math" display="inline" id="S3.T6.2.2.2.m1.1">
        <semantics id="S3.T6.2.2.2.m1.1a">
         <mrow id="S3.T6.2.2.2.m1.1.1.1" xref="S3.T6.2.2.2.m1.1.1.2.cmml">
          <mo id="S3.T6.2.2.2.m1.1.1.1.2" xref="S3.T6.2.2.2.m1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S3.T6.2.2.2.m1.1.1.1.1" xref="S3.T6.2.2.2.m1.1.1.1.1.cmml">
           <mi id="S3.T6.2.2.2.m1.1.1.1.1.2" mathvariant="normal" xref="S3.T6.2.2.2.m1.1.1.1.1.2.cmml">
            R
           </mi>
           <mo id="S3.T6.2.2.2.m1.1.1.1.1.1" xref="S3.T6.2.2.2.m1.1.1.1.1.1.cmml">
            ≥
           </mo>
           <mn id="S3.T6.2.2.2.m1.1.1.1.1.3" xref="S3.T6.2.2.2.m1.1.1.1.1.3.cmml">
            0.75
           </mn>
          </mrow>
          <mo id="S3.T6.2.2.2.m1.1.1.1.3" xref="S3.T6.2.2.2.m1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T6.2.2.2.m1.1b">
          <set id="S3.T6.2.2.2.m1.1.1.2.cmml" xref="S3.T6.2.2.2.m1.1.1.1">
           <apply id="S3.T6.2.2.2.m1.1.1.1.1.cmml" xref="S3.T6.2.2.2.m1.1.1.1.1">
            <geq id="S3.T6.2.2.2.m1.1.1.1.1.1.cmml" xref="S3.T6.2.2.2.m1.1.1.1.1.1">
            </geq>
            <ci id="S3.T6.2.2.2.m1.1.1.1.1.2.cmml" xref="S3.T6.2.2.2.m1.1.1.1.1.2">
             R
            </ci>
            <cn id="S3.T6.2.2.2.m1.1.1.1.1.3.cmml" type="float" xref="S3.T6.2.2.2.m1.1.1.1.1.3">
             0.75
            </cn>
           </apply>
          </set>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T6.2.2.2.m1.1c">
          \left\{\mathrm{R}\geq 0.75\right\}
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T6.3.3.3">
       %
       <math alttext="\left\{\mathrm{R}\geq 0.5\right\}" class="ltx_Math" display="inline" id="S3.T6.3.3.3.m1.1">
        <semantics id="S3.T6.3.3.3.m1.1a">
         <mrow id="S3.T6.3.3.3.m1.1.1.1" xref="S3.T6.3.3.3.m1.1.1.2.cmml">
          <mo id="S3.T6.3.3.3.m1.1.1.1.2" xref="S3.T6.3.3.3.m1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S3.T6.3.3.3.m1.1.1.1.1" xref="S3.T6.3.3.3.m1.1.1.1.1.cmml">
           <mi id="S3.T6.3.3.3.m1.1.1.1.1.2" mathvariant="normal" xref="S3.T6.3.3.3.m1.1.1.1.1.2.cmml">
            R
           </mi>
           <mo id="S3.T6.3.3.3.m1.1.1.1.1.1" xref="S3.T6.3.3.3.m1.1.1.1.1.1.cmml">
            ≥
           </mo>
           <mn id="S3.T6.3.3.3.m1.1.1.1.1.3" xref="S3.T6.3.3.3.m1.1.1.1.1.3.cmml">
            0.5
           </mn>
          </mrow>
          <mo id="S3.T6.3.3.3.m1.1.1.1.3" xref="S3.T6.3.3.3.m1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T6.3.3.3.m1.1b">
          <set id="S3.T6.3.3.3.m1.1.1.2.cmml" xref="S3.T6.3.3.3.m1.1.1.1">
           <apply id="S3.T6.3.3.3.m1.1.1.1.1.cmml" xref="S3.T6.3.3.3.m1.1.1.1.1">
            <geq id="S3.T6.3.3.3.m1.1.1.1.1.1.cmml" xref="S3.T6.3.3.3.m1.1.1.1.1.1">
            </geq>
            <ci id="S3.T6.3.3.3.m1.1.1.1.1.2.cmml" xref="S3.T6.3.3.3.m1.1.1.1.1.2">
             R
            </ci>
            <cn id="S3.T6.3.3.3.m1.1.1.1.1.3.cmml" type="float" xref="S3.T6.3.3.3.m1.1.1.1.1.3">
             0.5
            </cn>
           </apply>
          </set>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T6.3.3.3.m1.1c">
          \left\{\mathrm{R}\geq 0.5\right\}
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T6.3.4">
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.4.1">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.4.2">
       68.5
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.4.3">
       40.0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.4.4">
       51.6
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.4.5">
       77.5
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T6.3.5">
      <td class="ltx_td ltx_align_center" id="S3.T6.3.5.1">
       1
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.5.2">
       85.2
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.5.3">
       61.1
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.5.4">
       75.8
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.5.5">
       94.3
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T6.3.6">
      <td class="ltx_td ltx_align_center" id="S3.T6.3.6.1">
       2
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.6.2">
       88.9
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.6.3">
       69.4
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.6.4">
       82.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T6.3.6.5">
       96.3
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T6.3.7">
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.7.1">
       3
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.7.2">
       90.6
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.7.3">
       73.9
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.7.4">
       85.0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.7.5">
       96.8
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 6:
     </span>
     The reward, success rate, and percentages of reward above thresholds
     <math alttext="0.75" class="ltx_Math" display="inline" id="S3.T6.6.m1.1">
      <semantics id="S3.T6.6.m1.1b">
       <mn id="S3.T6.6.m1.1.1" xref="S3.T6.6.m1.1.1.cmml">
        0.75
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T6.6.m1.1c">
        <cn id="S3.T6.6.m1.1.1.cmml" type="float" xref="S3.T6.6.m1.1.1">
         0.75
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T6.6.m1.1d">
        0.75
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="0.5" class="ltx_Math" display="inline" id="S3.T6.7.m2.1">
      <semantics id="S3.T6.7.m2.1b">
       <mn id="S3.T6.7.m2.1.1" xref="S3.T6.7.m2.1.1.cmml">
        0.5
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.T6.7.m2.1c">
        <cn id="S3.T6.7.m2.1.1.cmml" type="float" xref="S3.T6.7.m2.1.1">
         0.5
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T6.7.m2.1d">
        0.5
       </annotation>
      </semantics>
     </math>
     of the accumulated trajectory set in the training tasks of WebShop. With the agent autonomously composing diverse trajectories, the data quality is continually increasing.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.5">
     Tables
     <a class="ltx_ref" href="#S3.T4" title="Table 4 ‣ 3.2 WebShop ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.T5" title="Table 5 ‣ 3.2 WebShop ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     demonstrate the significance of A
     <sup class="ltx_sup" id="S3.SS2.p3.5.1">
      3
     </sup>
     T agents. With a single test trial, the A
     <sup class="ltx_sup" id="S3.SS2.p3.5.2">
      3
     </sup>
     T agent matches averaged human performance (reward: 73.9 v.s. 75.5; success rate: 49.0% v.s. 50.0%). With 4 shots of test trials, A
     <sup class="ltx_sup" id="S3.SS2.p3.5.3">
      3
     </sup>
     T achieves a 54.8% success rate, closing the gap with human expert performance (59.6%). The 1-shot A
     <sup class="ltx_sup" id="S3.SS2.p3.5.4">
      3
     </sup>
     T agent also outperforms prompting with GPT-4-32k-0613 in both the easy and the hard split of WebShop from AgentBoard. Table
     <a class="ltx_ref" href="#S3.T6" title="Table 6 ‣ 3.2 WebShop ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     further shows the quality improvement of the accumulated trajectories across multiple rounds of A
     <sup class="ltx_sup" id="S3.SS2.p3.5.5">
      3
     </sup>
     T. Case studies for annotated trajectories, as well as the dataset statistics for each round of training are reported in Appendices
     <a class="ltx_ref" href="#A2" title="Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       B
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A3.SS2" title="C.2 WebShop ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       C.2
      </span>
     </a>
     , respectively.
    </p>
   </div>
   <figure class="ltx_table" id="S3.T7">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T7.10">
     <tr class="ltx_tr" id="S3.T7.10.11">
      <td class="ltx_td ltx_border_r ltx_border_tt ltx_border_tt" id="S3.T7.10.11.1">
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt ltx_border_tt" id="S3.T7.10.11.2">
       Training Scheme
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_tt" id="S3.T7.10.11.3">
       Valid.
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt ltx_border_tt" id="S3.T7.10.11.4">
       Test.
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.2.2">
      <td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T7.1.1.1">
       A
       <sup class="ltx_sup" id="S3.T7.1.1.1.1">
        3
       </sup>
       T (Round=0)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.2.2.2">
       Supervised with
       <math alttext="R=1.0" class="ltx_Math" display="inline" id="S3.T7.2.2.2.m1.1">
        <semantics id="S3.T7.2.2.2.m1.1a">
         <mrow id="S3.T7.2.2.2.m1.1.1" xref="S3.T7.2.2.2.m1.1.1.cmml">
          <mi id="S3.T7.2.2.2.m1.1.1.2" xref="S3.T7.2.2.2.m1.1.1.2.cmml">
           R
          </mi>
          <mo id="S3.T7.2.2.2.m1.1.1.1" xref="S3.T7.2.2.2.m1.1.1.1.cmml">
           =
          </mo>
          <mn id="S3.T7.2.2.2.m1.1.1.3" xref="S3.T7.2.2.2.m1.1.1.3.cmml">
           1.0
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.2.2.2.m1.1b">
          <apply id="S3.T7.2.2.2.m1.1.1.cmml" xref="S3.T7.2.2.2.m1.1.1">
           <eq id="S3.T7.2.2.2.m1.1.1.1.cmml" xref="S3.T7.2.2.2.m1.1.1.1">
           </eq>
           <ci id="S3.T7.2.2.2.m1.1.1.2.cmml" xref="S3.T7.2.2.2.m1.1.1.2">
            𝑅
           </ci>
           <cn id="S3.T7.2.2.2.m1.1.1.3.cmml" type="float" xref="S3.T7.2.2.2.m1.1.1.3">
            1.0
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.2.2.2.m1.1c">
          R=1.0
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.2.2.3">
       <span class="ltx_text ltx_font_bold" id="S3.T7.2.2.3.1">
        70.1
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T7.2.2.3.2">
        41.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.2.2.4">
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.2.2.4.1">
        72.4
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T7.2.2.4.2">
        45.4
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.3.3">
      <td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T7.3.3.2">
       Ablated (Round=0)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.3.3.1">
       Supervised with
       <math alttext="R\geq 0.75" class="ltx_Math" display="inline" id="S3.T7.3.3.1.m1.1">
        <semantics id="S3.T7.3.3.1.m1.1a">
         <mrow id="S3.T7.3.3.1.m1.1.1" xref="S3.T7.3.3.1.m1.1.1.cmml">
          <mi id="S3.T7.3.3.1.m1.1.1.2" xref="S3.T7.3.3.1.m1.1.1.2.cmml">
           R
          </mi>
          <mo id="S3.T7.3.3.1.m1.1.1.1" xref="S3.T7.3.3.1.m1.1.1.1.cmml">
           ≥
          </mo>
          <mn id="S3.T7.3.3.1.m1.1.1.3" xref="S3.T7.3.3.1.m1.1.1.3.cmml">
           0.75
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.3.3.1.m1.1b">
          <apply id="S3.T7.3.3.1.m1.1.1.cmml" xref="S3.T7.3.3.1.m1.1.1">
           <geq id="S3.T7.3.3.1.m1.1.1.1.cmml" xref="S3.T7.3.3.1.m1.1.1.1">
           </geq>
           <ci id="S3.T7.3.3.1.m1.1.1.2.cmml" xref="S3.T7.3.3.1.m1.1.1.2">
            𝑅
           </ci>
           <cn id="S3.T7.3.3.1.m1.1.1.3.cmml" type="float" xref="S3.T7.3.3.1.m1.1.1.3">
            0.75
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.3.3.1.m1.1c">
          R\geq 0.75
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.3.3.3">
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.3.3.3.1">
        68.2
       </span>
       /37.5
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.3.3.4">
       71.5/43.2
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.4.4">
      <td class="ltx_td ltx_align_right ltx_border_r" id="S3.T7.4.4.2">
       Ablated (Round=0)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.4.4.1">
       Supervised with
       <math alttext="R\geq 0.5" class="ltx_Math" display="inline" id="S3.T7.4.4.1.m1.1">
        <semantics id="S3.T7.4.4.1.m1.1a">
         <mrow id="S3.T7.4.4.1.m1.1.1" xref="S3.T7.4.4.1.m1.1.1.cmml">
          <mi id="S3.T7.4.4.1.m1.1.1.2" xref="S3.T7.4.4.1.m1.1.1.2.cmml">
           R
          </mi>
          <mo id="S3.T7.4.4.1.m1.1.1.1" xref="S3.T7.4.4.1.m1.1.1.1.cmml">
           ≥
          </mo>
          <mn id="S3.T7.4.4.1.m1.1.1.3" xref="S3.T7.4.4.1.m1.1.1.3.cmml">
           0.5
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.4.4.1.m1.1b">
          <apply id="S3.T7.4.4.1.m1.1.1.cmml" xref="S3.T7.4.4.1.m1.1.1">
           <geq id="S3.T7.4.4.1.m1.1.1.1.cmml" xref="S3.T7.4.4.1.m1.1.1.1">
           </geq>
           <ci id="S3.T7.4.4.1.m1.1.1.2.cmml" xref="S3.T7.4.4.1.m1.1.1.2">
            𝑅
           </ci>
           <cn id="S3.T7.4.4.1.m1.1.1.3.cmml" type="float" xref="S3.T7.4.4.1.m1.1.1.3">
            0.5
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.4.4.1.m1.1c">
          R\geq 0.5
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.4.4.3">
       68.1/
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.4.4.3.1">
        37.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T7.4.4.4">
       <span class="ltx_text ltx_font_bold" id="S3.T7.4.4.4.1">
        72.5
       </span>
       /44.6
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.6.6">
      <td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S3.T7.5.5.1">
       A
       <sup class="ltx_sup" id="S3.T7.5.5.1.1">
        3
       </sup>
       T (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T7.6.6.2">
       PG with binarized rewards
       <math alttext="(=1;-1)" class="ltx_Math" display="inline" id="S3.T7.6.6.2.m1.2">
        <semantics id="S3.T7.6.6.2.m1.2a">
         <mrow id="S3.T7.6.6.2.m1.2.2.1" xref="S3.T7.6.6.2.m1.2.2.1.1.cmml">
          <mo id="S3.T7.6.6.2.m1.2.2.1.2" stretchy="false" xref="S3.T7.6.6.2.m1.2.2.1.1.cmml">
           (
          </mo>
          <mrow id="S3.T7.6.6.2.m1.2.2.1.1" xref="S3.T7.6.6.2.m1.2.2.1.1.cmml">
           <mi id="S3.T7.6.6.2.m1.2.2.1.1.3" xref="S3.T7.6.6.2.m1.2.2.1.1.3.cmml">
           </mi>
           <mo id="S3.T7.6.6.2.m1.2.2.1.1.2" xref="S3.T7.6.6.2.m1.2.2.1.1.2.cmml">
            =
           </mo>
           <mrow id="S3.T7.6.6.2.m1.2.2.1.1.1.1" xref="S3.T7.6.6.2.m1.2.2.1.1.1.2.cmml">
            <mn id="S3.T7.6.6.2.m1.1.1" xref="S3.T7.6.6.2.m1.1.1.cmml">
             1
            </mn>
            <mo id="S3.T7.6.6.2.m1.2.2.1.1.1.1.2" xref="S3.T7.6.6.2.m1.2.2.1.1.1.2.cmml">
             ;
            </mo>
            <mrow id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.cmml">
             <mo id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1a" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.cmml">
              −
             </mo>
             <mn id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.2" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.2.cmml">
              1
             </mn>
            </mrow>
           </mrow>
          </mrow>
          <mo id="S3.T7.6.6.2.m1.2.2.1.3" stretchy="false" xref="S3.T7.6.6.2.m1.2.2.1.1.cmml">
           )
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.6.6.2.m1.2b">
          <apply id="S3.T7.6.6.2.m1.2.2.1.1.cmml" xref="S3.T7.6.6.2.m1.2.2.1">
           <eq id="S3.T7.6.6.2.m1.2.2.1.1.2.cmml" xref="S3.T7.6.6.2.m1.2.2.1.1.2">
           </eq>
           <csymbol cd="latexml" id="S3.T7.6.6.2.m1.2.2.1.1.3.cmml" xref="S3.T7.6.6.2.m1.2.2.1.1.3">
            absent
           </csymbol>
           <list id="S3.T7.6.6.2.m1.2.2.1.1.1.2.cmml" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1">
            <cn id="S3.T7.6.6.2.m1.1.1.cmml" type="integer" xref="S3.T7.6.6.2.m1.1.1">
             1
            </cn>
            <apply id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1">
             <minus id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1">
             </minus>
             <cn id="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.2.cmml" type="integer" xref="S3.T7.6.6.2.m1.2.2.1.1.1.1.1.2">
              1
             </cn>
            </apply>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.6.6.2.m1.2c">
          (=1;-1)
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T7.6.6.3">
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.6.6.3.1">
        69.7
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S3.T7.6.6.3.2">
        43.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T7.6.6.4">
       73.1/
       <span class="ltx_text ltx_font_bold" id="S3.T7.6.6.4.1">
        49.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.7.7">
      <td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S3.T7.7.7.2">
       Ablated (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T7.7.7.1">
       Supervised with
       <math alttext="R=1.0" class="ltx_Math" display="inline" id="S3.T7.7.7.1.m1.1">
        <semantics id="S3.T7.7.7.1.m1.1a">
         <mrow id="S3.T7.7.7.1.m1.1.1" xref="S3.T7.7.7.1.m1.1.1.cmml">
          <mi id="S3.T7.7.7.1.m1.1.1.2" xref="S3.T7.7.7.1.m1.1.1.2.cmml">
           R
          </mi>
          <mo id="S3.T7.7.7.1.m1.1.1.1" xref="S3.T7.7.7.1.m1.1.1.1.cmml">
           =
          </mo>
          <mn id="S3.T7.7.7.1.m1.1.1.3" xref="S3.T7.7.7.1.m1.1.1.3.cmml">
           1.0
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.7.7.1.m1.1b">
          <apply id="S3.T7.7.7.1.m1.1.1.cmml" xref="S3.T7.7.7.1.m1.1.1">
           <eq id="S3.T7.7.7.1.m1.1.1.1.cmml" xref="S3.T7.7.7.1.m1.1.1.1">
           </eq>
           <ci id="S3.T7.7.7.1.m1.1.1.2.cmml" xref="S3.T7.7.7.1.m1.1.1.2">
            𝑅
           </ci>
           <cn id="S3.T7.7.7.1.m1.1.1.3.cmml" type="float" xref="S3.T7.7.7.1.m1.1.1.3">
            1.0
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.7.7.1.m1.1c">
          R=1.0
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T7.7.7.3">
       69.4/42.5
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T7.7.7.4">
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.7.7.4.1">
        73.2
       </span>
       /45.6
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.10.12">
      <td class="ltx_td ltx_align_right ltx_border_r" id="S3.T7.10.12.1">
       Ablated (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.10.12.2">
       Supervised with label conditions
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.10.12.3">
       69.5/41.3
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T7.10.12.4">
       72.4/45.4
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.8.8">
      <td class="ltx_td ltx_align_right ltx_border_r" id="S3.T7.8.8.2">
       Ablated (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.8.8.1">
       PG with original rewards
       <math alttext="(=1;{\rm ori})" class="ltx_Math" display="inline" id="S3.T7.8.8.1.m1.3">
        <semantics id="S3.T7.8.8.1.m1.3a">
         <mrow id="S3.T7.8.8.1.m1.3.3.1" xref="S3.T7.8.8.1.m1.3.3.1.1.cmml">
          <mo id="S3.T7.8.8.1.m1.3.3.1.2" stretchy="false" xref="S3.T7.8.8.1.m1.3.3.1.1.cmml">
           (
          </mo>
          <mrow id="S3.T7.8.8.1.m1.3.3.1.1" xref="S3.T7.8.8.1.m1.3.3.1.1.cmml">
           <mi id="S3.T7.8.8.1.m1.3.3.1.1.2" xref="S3.T7.8.8.1.m1.3.3.1.1.2.cmml">
           </mi>
           <mo id="S3.T7.8.8.1.m1.3.3.1.1.1" xref="S3.T7.8.8.1.m1.3.3.1.1.1.cmml">
            =
           </mo>
           <mrow id="S3.T7.8.8.1.m1.3.3.1.1.3.2" xref="S3.T7.8.8.1.m1.3.3.1.1.3.1.cmml">
            <mn id="S3.T7.8.8.1.m1.1.1" xref="S3.T7.8.8.1.m1.1.1.cmml">
             1
            </mn>
            <mo id="S3.T7.8.8.1.m1.3.3.1.1.3.2.1" xref="S3.T7.8.8.1.m1.3.3.1.1.3.1.cmml">
             ;
            </mo>
            <mi id="S3.T7.8.8.1.m1.2.2" xref="S3.T7.8.8.1.m1.2.2.cmml">
             ori
            </mi>
           </mrow>
          </mrow>
          <mo id="S3.T7.8.8.1.m1.3.3.1.3" stretchy="false" xref="S3.T7.8.8.1.m1.3.3.1.1.cmml">
           )
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.8.8.1.m1.3b">
          <apply id="S3.T7.8.8.1.m1.3.3.1.1.cmml" xref="S3.T7.8.8.1.m1.3.3.1">
           <eq id="S3.T7.8.8.1.m1.3.3.1.1.1.cmml" xref="S3.T7.8.8.1.m1.3.3.1.1.1">
           </eq>
           <csymbol cd="latexml" id="S3.T7.8.8.1.m1.3.3.1.1.2.cmml" xref="S3.T7.8.8.1.m1.3.3.1.1.2">
            absent
           </csymbol>
           <list id="S3.T7.8.8.1.m1.3.3.1.1.3.1.cmml" xref="S3.T7.8.8.1.m1.3.3.1.1.3.2">
            <cn id="S3.T7.8.8.1.m1.1.1.cmml" type="integer" xref="S3.T7.8.8.1.m1.1.1">
             1
            </cn>
            <ci id="S3.T7.8.8.1.m1.2.2.cmml" xref="S3.T7.8.8.1.m1.2.2">
             ori
            </ci>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.8.8.1.m1.3c">
          (=1;{\rm ori})
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.8.8.3">
       69.5/41.3
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T7.8.8.4">
       <span class="ltx_text ltx_font_bold" id="S3.T7.8.8.4.1">
        73.4
       </span>
       /
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.8.8.4.2">
        47.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.9.9">
      <td class="ltx_td ltx_align_right ltx_border_r" id="S3.T7.9.9.2">
       Ablated (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T7.9.9.1">
       PG with original rewards
       <math alttext="(\geq 0.75;{\rm ori})" class="ltx_Math" display="inline" id="S3.T7.9.9.1.m1.3">
        <semantics id="S3.T7.9.9.1.m1.3a">
         <mrow id="S3.T7.9.9.1.m1.3.3.1" xref="S3.T7.9.9.1.m1.3.3.1.1.cmml">
          <mo id="S3.T7.9.9.1.m1.3.3.1.2" stretchy="false" xref="S3.T7.9.9.1.m1.3.3.1.1.cmml">
           (
          </mo>
          <mrow id="S3.T7.9.9.1.m1.3.3.1.1" xref="S3.T7.9.9.1.m1.3.3.1.1.cmml">
           <mi id="S3.T7.9.9.1.m1.3.3.1.1.2" xref="S3.T7.9.9.1.m1.3.3.1.1.2.cmml">
           </mi>
           <mo id="S3.T7.9.9.1.m1.3.3.1.1.1" xref="S3.T7.9.9.1.m1.3.3.1.1.1.cmml">
            ≥
           </mo>
           <mrow id="S3.T7.9.9.1.m1.3.3.1.1.3.2" xref="S3.T7.9.9.1.m1.3.3.1.1.3.1.cmml">
            <mn id="S3.T7.9.9.1.m1.1.1" xref="S3.T7.9.9.1.m1.1.1.cmml">
             0.75
            </mn>
            <mo id="S3.T7.9.9.1.m1.3.3.1.1.3.2.1" xref="S3.T7.9.9.1.m1.3.3.1.1.3.1.cmml">
             ;
            </mo>
            <mi id="S3.T7.9.9.1.m1.2.2" xref="S3.T7.9.9.1.m1.2.2.cmml">
             ori
            </mi>
           </mrow>
          </mrow>
          <mo id="S3.T7.9.9.1.m1.3.3.1.3" stretchy="false" xref="S3.T7.9.9.1.m1.3.3.1.1.cmml">
           )
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.9.9.1.m1.3b">
          <apply id="S3.T7.9.9.1.m1.3.3.1.1.cmml" xref="S3.T7.9.9.1.m1.3.3.1">
           <geq id="S3.T7.9.9.1.m1.3.3.1.1.1.cmml" xref="S3.T7.9.9.1.m1.3.3.1.1.1">
           </geq>
           <csymbol cd="latexml" id="S3.T7.9.9.1.m1.3.3.1.1.2.cmml" xref="S3.T7.9.9.1.m1.3.3.1.1.2">
            absent
           </csymbol>
           <list id="S3.T7.9.9.1.m1.3.3.1.1.3.1.cmml" xref="S3.T7.9.9.1.m1.3.3.1.1.3.2">
            <cn id="S3.T7.9.9.1.m1.1.1.cmml" type="float" xref="S3.T7.9.9.1.m1.1.1">
             0.75
            </cn>
            <ci id="S3.T7.9.9.1.m1.2.2.cmml" xref="S3.T7.9.9.1.m1.2.2">
             ori
            </ci>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.9.9.1.m1.3c">
          (\geq 0.75;{\rm ori})
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T7.9.9.3">
       69.3/42.3
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T7.9.9.4">
       72.2/46.6
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T7.10.10">
      <td class="ltx_td ltx_align_right ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T7.10.10.2">
       Ablated (Round=1)
      </td>
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T7.10.10.1">
       PG with binarized rewards
       <math alttext="(=1;0.1)" class="ltx_Math" display="inline" id="S3.T7.10.10.1.m1.3">
        <semantics id="S3.T7.10.10.1.m1.3a">
         <mrow id="S3.T7.10.10.1.m1.3.3.1" xref="S3.T7.10.10.1.m1.3.3.1.1.cmml">
          <mo id="S3.T7.10.10.1.m1.3.3.1.2" stretchy="false" xref="S3.T7.10.10.1.m1.3.3.1.1.cmml">
           (
          </mo>
          <mrow id="S3.T7.10.10.1.m1.3.3.1.1" xref="S3.T7.10.10.1.m1.3.3.1.1.cmml">
           <mi id="S3.T7.10.10.1.m1.3.3.1.1.2" xref="S3.T7.10.10.1.m1.3.3.1.1.2.cmml">
           </mi>
           <mo id="S3.T7.10.10.1.m1.3.3.1.1.1" xref="S3.T7.10.10.1.m1.3.3.1.1.1.cmml">
            =
           </mo>
           <mrow id="S3.T7.10.10.1.m1.3.3.1.1.3.2" xref="S3.T7.10.10.1.m1.3.3.1.1.3.1.cmml">
            <mn id="S3.T7.10.10.1.m1.1.1" xref="S3.T7.10.10.1.m1.1.1.cmml">
             1
            </mn>
            <mo id="S3.T7.10.10.1.m1.3.3.1.1.3.2.1" xref="S3.T7.10.10.1.m1.3.3.1.1.3.1.cmml">
             ;
            </mo>
            <mn id="S3.T7.10.10.1.m1.2.2" xref="S3.T7.10.10.1.m1.2.2.cmml">
             0.1
            </mn>
           </mrow>
          </mrow>
          <mo id="S3.T7.10.10.1.m1.3.3.1.3" stretchy="false" xref="S3.T7.10.10.1.m1.3.3.1.1.cmml">
           )
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S3.T7.10.10.1.m1.3b">
          <apply id="S3.T7.10.10.1.m1.3.3.1.1.cmml" xref="S3.T7.10.10.1.m1.3.3.1">
           <eq id="S3.T7.10.10.1.m1.3.3.1.1.1.cmml" xref="S3.T7.10.10.1.m1.3.3.1.1.1">
           </eq>
           <csymbol cd="latexml" id="S3.T7.10.10.1.m1.3.3.1.1.2.cmml" xref="S3.T7.10.10.1.m1.3.3.1.1.2">
            absent
           </csymbol>
           <list id="S3.T7.10.10.1.m1.3.3.1.1.3.1.cmml" xref="S3.T7.10.10.1.m1.3.3.1.1.3.2">
            <cn id="S3.T7.10.10.1.m1.1.1.cmml" type="integer" xref="S3.T7.10.10.1.m1.1.1">
             1
            </cn>
            <cn id="S3.T7.10.10.1.m1.2.2.cmml" type="float" xref="S3.T7.10.10.1.m1.2.2">
             0.1
            </cn>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T7.10.10.1.m1.3c">
          (=1;0.1)
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb ltx_border_r" id="S3.T7.10.10.3">
       <span class="ltx_text ltx_font_bold" id="S3.T7.10.10.3.1">
        70.2
       </span>
       /
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T7.10.10.3.2">
        42.8
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_bb" id="S3.T7.10.10.4">
       73.0/46.6
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 7:
     </span>
     Ablated experiments of the self-training techniques in A
     <sup class="ltx_sup" id="S3.T7.22.1">
      3
     </sup>
     T on WebShop. “PG” stands for the policy gradient technique in Eq. (
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ). The parenthesized suffixes represent the reward configuration for the trajectories in Eq. (
     <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ). For example, “
     <math alttext="(=1;-1)" class="ltx_Math" display="inline" id="S3.T7.17.m2.2">
      <semantics id="S3.T7.17.m2.2b">
       <mrow id="S3.T7.17.m2.2.2.1" xref="S3.T7.17.m2.2.2.1.1.cmml">
        <mo id="S3.T7.17.m2.2.2.1.2" stretchy="false" xref="S3.T7.17.m2.2.2.1.1.cmml">
         (
        </mo>
        <mrow id="S3.T7.17.m2.2.2.1.1" xref="S3.T7.17.m2.2.2.1.1.cmml">
         <mi id="S3.T7.17.m2.2.2.1.1.3" xref="S3.T7.17.m2.2.2.1.1.3.cmml">
         </mi>
         <mo id="S3.T7.17.m2.2.2.1.1.2" xref="S3.T7.17.m2.2.2.1.1.2.cmml">
          =
         </mo>
         <mrow id="S3.T7.17.m2.2.2.1.1.1.1" xref="S3.T7.17.m2.2.2.1.1.1.2.cmml">
          <mn id="S3.T7.17.m2.1.1" xref="S3.T7.17.m2.1.1.cmml">
           1
          </mn>
          <mo id="S3.T7.17.m2.2.2.1.1.1.1.2" xref="S3.T7.17.m2.2.2.1.1.1.2.cmml">
           ;
          </mo>
          <mrow id="S3.T7.17.m2.2.2.1.1.1.1.1" xref="S3.T7.17.m2.2.2.1.1.1.1.1.cmml">
           <mo id="S3.T7.17.m2.2.2.1.1.1.1.1b" xref="S3.T7.17.m2.2.2.1.1.1.1.1.cmml">
            −
           </mo>
           <mn id="S3.T7.17.m2.2.2.1.1.1.1.1.2" xref="S3.T7.17.m2.2.2.1.1.1.1.1.2.cmml">
            1
           </mn>
          </mrow>
         </mrow>
        </mrow>
        <mo id="S3.T7.17.m2.2.2.1.3" stretchy="false" xref="S3.T7.17.m2.2.2.1.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T7.17.m2.2c">
        <apply id="S3.T7.17.m2.2.2.1.1.cmml" xref="S3.T7.17.m2.2.2.1">
         <eq id="S3.T7.17.m2.2.2.1.1.2.cmml" xref="S3.T7.17.m2.2.2.1.1.2">
         </eq>
         <csymbol cd="latexml" id="S3.T7.17.m2.2.2.1.1.3.cmml" xref="S3.T7.17.m2.2.2.1.1.3">
          absent
         </csymbol>
         <list id="S3.T7.17.m2.2.2.1.1.1.2.cmml" xref="S3.T7.17.m2.2.2.1.1.1.1">
          <cn id="S3.T7.17.m2.1.1.cmml" type="integer" xref="S3.T7.17.m2.1.1">
           1
          </cn>
          <apply id="S3.T7.17.m2.2.2.1.1.1.1.1.cmml" xref="S3.T7.17.m2.2.2.1.1.1.1.1">
           <minus id="S3.T7.17.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.T7.17.m2.2.2.1.1.1.1.1">
           </minus>
           <cn id="S3.T7.17.m2.2.2.1.1.1.1.1.2.cmml" type="integer" xref="S3.T7.17.m2.2.2.1.1.1.1.1.2">
            1
           </cn>
          </apply>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T7.17.m2.2d">
        (=1;-1)
       </annotation>
      </semantics>
     </math>
     ” means keeping the
     <math alttext="R=1" class="ltx_Math" display="inline" id="S3.T7.18.m3.1">
      <semantics id="S3.T7.18.m3.1b">
       <mrow id="S3.T7.18.m3.1.1" xref="S3.T7.18.m3.1.1.cmml">
        <mi id="S3.T7.18.m3.1.1.2" xref="S3.T7.18.m3.1.1.2.cmml">
         R
        </mi>
        <mo id="S3.T7.18.m3.1.1.1" xref="S3.T7.18.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.T7.18.m3.1.1.3" xref="S3.T7.18.m3.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T7.18.m3.1c">
        <apply id="S3.T7.18.m3.1.1.cmml" xref="S3.T7.18.m3.1.1">
         <eq id="S3.T7.18.m3.1.1.1.cmml" xref="S3.T7.18.m3.1.1.1">
         </eq>
         <ci id="S3.T7.18.m3.1.1.2.cmml" xref="S3.T7.18.m3.1.1.2">
          𝑅
         </ci>
         <cn id="S3.T7.18.m3.1.1.3.cmml" type="integer" xref="S3.T7.18.m3.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T7.18.m3.1d">
        R=1
       </annotation>
      </semantics>
     </math>
     trajectories, and assign the failed non-composed trajectories with
     <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="S3.T7.19.m4.1">
      <semantics id="S3.T7.19.m4.1b">
       <mrow id="S3.T7.19.m4.1.1" xref="S3.T7.19.m4.1.1.cmml">
        <mrow id="S3.T7.19.m4.1.1.1" xref="S3.T7.19.m4.1.1.1.cmml">
         <mi id="S3.T7.19.m4.1.1.1.3" xref="S3.T7.19.m4.1.1.1.3.cmml">
          R
         </mi>
         <mo id="S3.T7.19.m4.1.1.1.2" lspace="0em" rspace="0em" xref="S3.T7.19.m4.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.T7.19.m4.1.1.1.1.1" xref="S3.T7.19.m4.1.1.1.1.1.1.cmml">
          <mo id="S3.T7.19.m4.1.1.1.1.1.2" stretchy="false" xref="S3.T7.19.m4.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msub id="S3.T7.19.m4.1.1.1.1.1.1" xref="S3.T7.19.m4.1.1.1.1.1.1.cmml">
           <mi id="S3.T7.19.m4.1.1.1.1.1.1.2" xref="S3.T7.19.m4.1.1.1.1.1.1.2.cmml">
            τ
           </mi>
           <mi id="S3.T7.19.m4.1.1.1.1.1.1.3" xref="S3.T7.19.m4.1.1.1.1.1.1.3.cmml">
            f
           </mi>
          </msub>
          <mo id="S3.T7.19.m4.1.1.1.1.1.3" stretchy="false" xref="S3.T7.19.m4.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.T7.19.m4.1.1.2" xref="S3.T7.19.m4.1.1.2.cmml">
         =
        </mo>
        <mrow id="S3.T7.19.m4.1.1.3" xref="S3.T7.19.m4.1.1.3.cmml">
         <mo id="S3.T7.19.m4.1.1.3b" xref="S3.T7.19.m4.1.1.3.cmml">
          −
         </mo>
         <mn id="S3.T7.19.m4.1.1.3.2" xref="S3.T7.19.m4.1.1.3.2.cmml">
          1
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T7.19.m4.1c">
        <apply id="S3.T7.19.m4.1.1.cmml" xref="S3.T7.19.m4.1.1">
         <eq id="S3.T7.19.m4.1.1.2.cmml" xref="S3.T7.19.m4.1.1.2">
         </eq>
         <apply id="S3.T7.19.m4.1.1.1.cmml" xref="S3.T7.19.m4.1.1.1">
          <times id="S3.T7.19.m4.1.1.1.2.cmml" xref="S3.T7.19.m4.1.1.1.2">
          </times>
          <ci id="S3.T7.19.m4.1.1.1.3.cmml" xref="S3.T7.19.m4.1.1.1.3">
           𝑅
          </ci>
          <apply id="S3.T7.19.m4.1.1.1.1.1.1.cmml" xref="S3.T7.19.m4.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S3.T7.19.m4.1.1.1.1.1.1.1.cmml" xref="S3.T7.19.m4.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.T7.19.m4.1.1.1.1.1.1.2.cmml" xref="S3.T7.19.m4.1.1.1.1.1.1.2">
            𝜏
           </ci>
           <ci id="S3.T7.19.m4.1.1.1.1.1.1.3.cmml" xref="S3.T7.19.m4.1.1.1.1.1.1.3">
            𝑓
           </ci>
          </apply>
         </apply>
         <apply id="S3.T7.19.m4.1.1.3.cmml" xref="S3.T7.19.m4.1.1.3">
          <minus id="S3.T7.19.m4.1.1.3.1.cmml" xref="S3.T7.19.m4.1.1.3">
          </minus>
          <cn id="S3.T7.19.m4.1.1.3.2.cmml" type="integer" xref="S3.T7.19.m4.1.1.3.2">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T7.19.m4.1d">
        R(\tau_{f})=-1
       </annotation>
      </semantics>
     </math>
     . The training trajectory set is shared among different runs in the same round, except for reward threshold constraints other than
     <math alttext="R=1" class="ltx_Math" display="inline" id="S3.T7.20.m5.1">
      <semantics id="S3.T7.20.m5.1b">
       <mrow id="S3.T7.20.m5.1.1" xref="S3.T7.20.m5.1.1.cmml">
        <mi id="S3.T7.20.m5.1.1.2" xref="S3.T7.20.m5.1.1.2.cmml">
         R
        </mi>
        <mo id="S3.T7.20.m5.1.1.1" xref="S3.T7.20.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.T7.20.m5.1.1.3" xref="S3.T7.20.m5.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.T7.20.m5.1c">
        <apply id="S3.T7.20.m5.1.1.cmml" xref="S3.T7.20.m5.1.1">
         <eq id="S3.T7.20.m5.1.1.1.cmml" xref="S3.T7.20.m5.1.1.1">
         </eq>
         <ci id="S3.T7.20.m5.1.1.2.cmml" xref="S3.T7.20.m5.1.1.2">
          𝑅
         </ci>
         <cn id="S3.T7.20.m5.1.1.3.cmml" type="integer" xref="S3.T7.20.m5.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.T7.20.m5.1d">
        R=1
       </annotation>
      </semantics>
     </math>
     .
    </figcaption>
   </figure>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Ablation Studies
  </h2>
  <div class="ltx_para ltx_noindent" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    In this section, we conduct ablation studies for the self-training techniques proposed in Section
    <a class="ltx_ref" href="#S2.SS2" title="2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      2.2
     </span>
    </a>
    , and fine-tune the proprietary gpt-3.5-turbo-1106 for further comparisons.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Variants of the Self-Training Techniques
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.5">
     We conduct ablated experiments on WebShop, as it provides a real-valued reward ranging from 0 to 1. We first study the effect of different reward thresholds for training trajectory filtering. In A
     <sup class="ltx_sup" id="S4.SS1.p1.5.1">
      3
     </sup>
     T, only the trajectories with reward
     <math alttext="R=1" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1">
      <semantics id="S4.SS1.p1.2.m2.1a">
       <mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">
        <mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b">
        <apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
         <eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">
         </eq>
         <ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">
          𝑅
         </ci>
         <cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">
        R=1
       </annotation>
      </semantics>
     </math>
     are used in training. We change the constraint into
     <math alttext="R\geq 0.75" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1">
      <semantics id="S4.SS1.p1.3.m3.1a">
       <mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">
        <mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">
         ≥
        </mo>
        <mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">
         0.75
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b">
        <apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
         <geq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1">
         </geq>
         <ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">
          𝑅
         </ci>
         <cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.p1.3.m3.1.1.3">
          0.75
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">
        R\geq 0.75
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="R\geq 0.5" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1">
      <semantics id="S4.SS1.p1.4.m4.1a">
       <mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">
        <mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">
         ≥
        </mo>
        <mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">
         0.5
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b">
        <apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
         <geq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1">
         </geq>
         <ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">
          𝑅
         </ci>
         <cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="float" xref="S4.SS1.p1.4.m4.1.1.3">
          0.5
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">
        R\geq 0.5
       </annotation>
      </semantics>
     </math>
     and compare the performance of the initial round with supervised ReAct fine-tuning. According to Table
     <a class="ltx_ref" href="#S3.T7" title="Table 7 ‣ 3.2 WebShop ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     , the best performance is still obtained with
     <math alttext="R=1" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1">
      <semantics id="S4.SS1.p1.5.m5.1a">
       <mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">
        <mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b">
        <apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">
         <eq id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1">
         </eq>
         <ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">
          𝑅
         </ci>
         <cn id="S4.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">
        R=1
       </annotation>
      </semantics>
     </math>
     , which agrees with the findings of
     <cite class="ltx_cite ltx_citemacro_cite">
      Zhou et al. (
      <a class="ltx_ref" href="#bib.bib38" title="">
       2023b
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.7">
     We proceed to ablate the policy gradient technique with binarized rewards and conduct experiments for training in Round 1. The first type to be compared with is supervised fine-tuning. We implement supervised training with the successful trajectories only (namely
     <math alttext="R(\tau_{f})=0" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1">
      <semantics id="S4.SS1.p2.1.m1.1a">
       <mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">
        <mrow id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">
         <mi id="S4.SS1.p2.1.m1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.3.cmml">
          R
         </mi>
         <mo id="S4.SS1.p2.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p2.1.m1.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">
          <mo id="S4.SS1.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msub id="S4.SS1.p2.1.m1.1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">
           <mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml">
            τ
           </mi>
           <mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml">
            f
           </mi>
          </msub>
          <mo id="S4.SS1.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">
         =
        </mo>
        <mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">
         0
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b">
        <apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">
         <eq id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">
         </eq>
         <apply id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1">
          <times id="S4.SS1.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.2">
          </times>
          <ci id="S4.SS1.p2.1.m1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.3">
           𝑅
          </ci>
          <apply id="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.2">
            𝜏
           </ci>
           <ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.3">
            𝑓
           </ci>
          </apply>
         </apply>
         <cn id="S4.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">
        R(\tau_{f})=0
       </annotation>
      </semantics>
     </math>
     in Eq. (
     <a class="ltx_ref" href="#S2.E2" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     )). This echoes the practice adopted by
     <cite class="ltx_cite ltx_citemacro_cite">
      Singh et al. (
      <a class="ltx_ref" href="#bib.bib21" title="">
       2023
      </a>
      )
     </cite>
     . We also prepend the trajectories with the label conditions “Success” / “Fail” in the training data and conduct Round-1 supervised training. For the comparisons with policy gradient Eq. (
     <a class="ltx_ref" href="#S2.E2" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ), we alternatively set
     <math alttext="R(\tau_{f})" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1">
      <semantics id="S4.SS1.p2.2.m2.1a">
       <mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">
        <mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">
         R
        </mi>
        <mo id="S4.SS1.p2.2.m2.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p2.2.m2.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p2.2.m2.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">
         <mo id="S4.SS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">
          (
         </mo>
         <msub id="S4.SS1.p2.2.m2.1.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p2.2.m2.1.1.1.1.1.2" xref="S4.SS1.p2.2.m2.1.1.1.1.1.2.cmml">
           τ
          </mi>
          <mi id="S4.SS1.p2.2.m2.1.1.1.1.1.3" xref="S4.SS1.p2.2.m2.1.1.1.1.1.3.cmml">
           f
          </mi>
         </msub>
         <mo id="S4.SS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.2.m2.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b">
        <apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">
         <times id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">
         </times>
         <ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">
          𝑅
         </ci>
         <apply id="S4.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.1.2">
           𝜏
          </ci>
          <ci id="S4.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1.1.3">
           𝑓
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">
        R(\tau_{f})
       </annotation>
      </semantics>
     </math>
     to be the original reward provided by WebShop, or to be
     <math alttext="0.1" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1">
      <semantics id="S4.SS1.p2.3.m3.1a">
       <mn id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">
        0.1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b">
        <cn id="S4.SS1.p2.3.m3.1.1.cmml" type="float" xref="S4.SS1.p2.3.m3.1.1">
         0.1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">
        0.1
       </annotation>
      </semantics>
     </math>
     following the practice of
     <cite class="ltx_cite ltx_citemacro_cite">
      Wang et al. (
      <a class="ltx_ref" href="#bib.bib25" title="">
       2024
      </a>
      )
     </cite>
     . When using the original reward, we also include another setting by relaxing the reward threshold constraint to be
     <math alttext="R\geq 0.75" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1">
      <semantics id="S4.SS1.p2.4.m4.1a">
       <mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">
        <mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">
         ≥
        </mo>
        <mn id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">
         0.75
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b">
        <apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">
         <geq id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1">
         </geq>
         <ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">
          𝑅
         </ci>
         <cn id="S4.SS1.p2.4.m4.1.1.3.cmml" type="float" xref="S4.SS1.p2.4.m4.1.1.3">
          0.75
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">
        R\geq 0.75
       </annotation>
      </semantics>
     </math>
     . The comparisons are shown in Table
     <a class="ltx_ref" href="#S3.T7" title="Table 7 ‣ 3.2 WebShop ‣ 3 Experiments ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     . Conclusions can be drawn that: (1) Policy gradient methods lead to higher promotion in task performance than supervised training methods. This resembles the effectiveness of RLHF
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ouyang et al.,
      <a class="ltx_ref" href="#bib.bib16" title="">
       2022
      </a>
      )
     </cite>
     on top of supervised fine-tuning. (2) The binarized rewards (
     <math alttext="\pm 1" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1">
      <semantics id="S4.SS1.p2.5.m5.1a">
       <mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">
        <mo id="S4.SS1.p2.5.m5.1.1a" xref="S4.SS1.p2.5.m5.1.1.cmml">
         ±
        </mo>
        <mn id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b">
        <apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">
         <csymbol cd="latexml" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">
          plus-or-minus
         </csymbol>
         <cn id="S4.SS1.p2.5.m5.1.1.2.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.2">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">
        \pm 1
       </annotation>
      </semantics>
     </math>
     ) used in A
     <sup class="ltx_sup" id="S4.SS1.p2.7.1">
      3
     </sup>
     T lead to a significant improvement of success rate. We leave the incorporation of advanced RL
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhou et al.,
      <a class="ltx_ref" href="#bib.bib39" title="">
       2024
      </a>
      )
     </cite>
     and RLAIF
     <cite class="ltx_cite ltx_citemacro_citep">
      (Lee et al.,
      <a class="ltx_ref" href="#bib.bib9" title="">
       2023
      </a>
      ; Chen et al.,
      <a class="ltx_ref" href="#bib.bib3" title="">
       2024
      </a>
      ; Hosseini et al.,
      <a class="ltx_ref" href="#bib.bib6" title="">
       2024
      </a>
      ; Yuan et al.,
      <a class="ltx_ref" href="#bib.bib33" title="">
       2024
      </a>
      )
     </cite>
     algorithms into A
     <sup class="ltx_sup" id="S4.SS1.p2.7.2">
      3
     </sup>
     T as future work.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Experiments with gpt-3.5-turbo-1106 fintuning
   </h3>
   <figure class="ltx_table" id="S4.T8">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T8.3">
     <tr class="ltx_tr" id="S4.T8.3.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T8.3.1.1">
       Base LLM
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.2">
       Pick
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.3">
       Clean
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.4">
       Heat
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.5">
       Cool
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.6">
       Examine
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T8.3.1.7">
       PickTwo
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.3.1.8">
       Total
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T8.3.2">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T8.3.2.1">
       Mistral-7B-Instruct-v0.2
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.2">
       96
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.3">
       77
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.4">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.2.4.1">
        100
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.5">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.2.5.1">
        95
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.6">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.2.6.1">
        94
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.3.2.7">
       47
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.3.2.8">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.2.8.1">
        86
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T8.3.3">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T8.3.3.1">
       gpt-3.5-turbo-1106
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.2">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.3.2.1">
        100
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.3">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.3.3.1">
        81
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.4">
       96
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.5">
       86
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.6">
       78
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T8.3.3.7">
       <span class="ltx_text ltx_font_bold" id="S4.T8.3.3.7.1">
        53
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.3.3.8">
       84
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 8:
     </span>
     Success rate (
     <math alttext="\%" class="ltx_Math" display="inline" id="S4.T8.2.m1.1">
      <semantics id="S4.T8.2.m1.1b">
       <mo id="S4.T8.2.m1.1.1" xref="S4.T8.2.m1.1.1.cmml">
        %
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.T8.2.m1.1c">
        <csymbol cd="latexml" id="S4.T8.2.m1.1.1.cmml" xref="S4.T8.2.m1.1.1">
         percent
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T8.2.m1.1d">
        \%
       </annotation>
      </semantics>
     </math>
     ) on each task type of AlfWorld after the Round-0 (supervised) training with both of the base LLMs.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S4.T9">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T9.7">
     <tr class="ltx_tr" id="S4.T9.7.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T9.7.1.1">
       Base LLM
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T9.7.1.2">
       Setting
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T9.7.1.3">
       Valid.
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T9.7.1.4">
       Test.
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T9.7.2">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T9.7.2.1" rowspan="2">
       <span class="ltx_text" id="S4.T9.7.2.1.1">
        Mistral-7B-Instruct-v0.2
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T9.7.2.2">
       Round=0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T9.7.2.3">
       <span class="ltx_text ltx_font_bold" id="S4.T9.7.2.3.1">
        70.1
       </span>
       /41.0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.7.2.4">
       72.4/45.4
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T9.7.3">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S4.T9.7.3.1">
       Round=1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T9.7.3.2">
       69.7/
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T9.7.3.2.1">
        43.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T9.7.3.3">
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T9.7.3.3.1">
        73.1
       </span>
       /
       <span class="ltx_text ltx_font_bold" id="S4.T9.7.3.3.2">
        49.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T9.7.4">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T9.7.4.1" rowspan="2">
       <span class="ltx_text" id="S4.T9.7.4.1.1">
        gpt-3.5-turbo-1106
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T9.7.4.2">
       Round=0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T9.7.4.3">
       69.4/42.0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.7.4.4">
       <span class="ltx_text ltx_font_bold" id="S4.T9.7.4.4.1">
        73.6
       </span>
       /
       <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T9.7.4.4.2">
        48.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T9.7.5">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T9.7.5.1">
       Round=1 (supervised)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T9.7.5.2">
       69.7/
       <span class="ltx_text ltx_font_bold" id="S4.T9.7.5.2.1">
        44.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T9.7.5.3">
       72.7/46.8
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 9:
     </span>
     Reward (
     <math alttext="\times 100" class="ltx_Math" display="inline" id="S4.T9.4.m1.1">
      <semantics id="S4.T9.4.m1.1b">
       <mrow id="S4.T9.4.m1.1.1" xref="S4.T9.4.m1.1.1.cmml">
        <mi id="S4.T9.4.m1.1.1.2" xref="S4.T9.4.m1.1.1.2.cmml">
        </mi>
        <mo id="S4.T9.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T9.4.m1.1.1.1.cmml">
         ×
        </mo>
        <mn id="S4.T9.4.m1.1.1.3" xref="S4.T9.4.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.T9.4.m1.1c">
        <apply id="S4.T9.4.m1.1.1.cmml" xref="S4.T9.4.m1.1.1">
         <times id="S4.T9.4.m1.1.1.1.cmml" xref="S4.T9.4.m1.1.1.1">
         </times>
         <csymbol cd="latexml" id="S4.T9.4.m1.1.1.2.cmml" xref="S4.T9.4.m1.1.1.2">
          absent
         </csymbol>
         <cn id="S4.T9.4.m1.1.1.3.cmml" type="integer" xref="S4.T9.4.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T9.4.m1.1d">
        \times 100
       </annotation>
      </semantics>
     </math>
     ) / success rate (
     <math alttext="\times 100\%" class="ltx_Math" display="inline" id="S4.T9.5.m2.1">
      <semantics id="S4.T9.5.m2.1b">
       <mrow id="S4.T9.5.m2.1.1" xref="S4.T9.5.m2.1.1.cmml">
        <mi id="S4.T9.5.m2.1.1.2" xref="S4.T9.5.m2.1.1.2.cmml">
        </mi>
        <mo id="S4.T9.5.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T9.5.m2.1.1.1.cmml">
         ×
        </mo>
        <mrow id="S4.T9.5.m2.1.1.3" xref="S4.T9.5.m2.1.1.3.cmml">
         <mn id="S4.T9.5.m2.1.1.3.2" xref="S4.T9.5.m2.1.1.3.2.cmml">
          100
         </mn>
         <mo id="S4.T9.5.m2.1.1.3.1" xref="S4.T9.5.m2.1.1.3.1.cmml">
          %
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.T9.5.m2.1c">
        <apply id="S4.T9.5.m2.1.1.cmml" xref="S4.T9.5.m2.1.1">
         <times id="S4.T9.5.m2.1.1.1.cmml" xref="S4.T9.5.m2.1.1.1">
         </times>
         <csymbol cd="latexml" id="S4.T9.5.m2.1.1.2.cmml" xref="S4.T9.5.m2.1.1.2">
          absent
         </csymbol>
         <apply id="S4.T9.5.m2.1.1.3.cmml" xref="S4.T9.5.m2.1.1.3">
          <csymbol cd="latexml" id="S4.T9.5.m2.1.1.3.1.cmml" xref="S4.T9.5.m2.1.1.3.1">
           percent
          </csymbol>
          <cn id="S4.T9.5.m2.1.1.3.2.cmml" type="integer" xref="S4.T9.5.m2.1.1.3.2">
           100
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T9.5.m2.1d">
        \times 100\%
       </annotation>
      </semantics>
     </math>
     ) on validation and test sets of WebShop using different base LLMs. For Round-1 training with gpt-3.5-turbo-1106, we conduct supervised training with
     <math alttext="R=1" class="ltx_Math" display="inline" id="S4.T9.6.m3.1">
      <semantics id="S4.T9.6.m3.1b">
       <mrow id="S4.T9.6.m3.1.1" xref="S4.T9.6.m3.1.1.cmml">
        <mi id="S4.T9.6.m3.1.1.2" xref="S4.T9.6.m3.1.1.2.cmml">
         R
        </mi>
        <mo id="S4.T9.6.m3.1.1.1" xref="S4.T9.6.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.T9.6.m3.1.1.3" xref="S4.T9.6.m3.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.T9.6.m3.1c">
        <apply id="S4.T9.6.m3.1.1.cmml" xref="S4.T9.6.m3.1.1">
         <eq id="S4.T9.6.m3.1.1.1.cmml" xref="S4.T9.6.m3.1.1.1">
         </eq>
         <ci id="S4.T9.6.m3.1.1.2.cmml" xref="S4.T9.6.m3.1.1.2">
          𝑅
         </ci>
         <cn id="S4.T9.6.m3.1.1.3.cmml" type="integer" xref="S4.T9.6.m3.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T9.6.m3.1d">
        R=1
       </annotation>
      </semantics>
     </math>
     filtering, as only supervised fine-tuning is offered in the service.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S4.T10">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T10.3">
     <tr class="ltx_tr" id="S4.T10.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T10.3.3.4">
       Base LLM
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T10.1.1.1">
       Reward R (
       <math alttext="\times 100" class="ltx_Math" display="inline" id="S4.T10.1.1.1.m1.1">
        <semantics id="S4.T10.1.1.1.m1.1a">
         <mrow id="S4.T10.1.1.1.m1.1.1" xref="S4.T10.1.1.1.m1.1.1.cmml">
          <mi id="S4.T10.1.1.1.m1.1.1.2" xref="S4.T10.1.1.1.m1.1.1.2.cmml">
          </mi>
          <mo id="S4.T10.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T10.1.1.1.m1.1.1.1.cmml">
           ×
          </mo>
          <mn id="S4.T10.1.1.1.m1.1.1.3" xref="S4.T10.1.1.1.m1.1.1.3.cmml">
           100
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S4.T10.1.1.1.m1.1b">
          <apply id="S4.T10.1.1.1.m1.1.1.cmml" xref="S4.T10.1.1.1.m1.1.1">
           <times id="S4.T10.1.1.1.m1.1.1.1.cmml" xref="S4.T10.1.1.1.m1.1.1.1">
           </times>
           <csymbol cd="latexml" id="S4.T10.1.1.1.m1.1.1.2.cmml" xref="S4.T10.1.1.1.m1.1.1.2">
            absent
           </csymbol>
           <cn id="S4.T10.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T10.1.1.1.m1.1.1.3">
            100
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S4.T10.1.1.1.m1.1c">
          \times 100
         </annotation>
        </semantics>
       </math>
       )
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T10.3.3.5">
       Success Rate (%)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T10.2.2.2">
       %
       <math alttext="\left\{\mathrm{R}\geq 0.75\right\}" class="ltx_Math" display="inline" id="S4.T10.2.2.2.m1.1">
        <semantics id="S4.T10.2.2.2.m1.1a">
         <mrow id="S4.T10.2.2.2.m1.1.1.1" xref="S4.T10.2.2.2.m1.1.1.2.cmml">
          <mo id="S4.T10.2.2.2.m1.1.1.1.2" xref="S4.T10.2.2.2.m1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S4.T10.2.2.2.m1.1.1.1.1" xref="S4.T10.2.2.2.m1.1.1.1.1.cmml">
           <mi id="S4.T10.2.2.2.m1.1.1.1.1.2" mathvariant="normal" xref="S4.T10.2.2.2.m1.1.1.1.1.2.cmml">
            R
           </mi>
           <mo id="S4.T10.2.2.2.m1.1.1.1.1.1" xref="S4.T10.2.2.2.m1.1.1.1.1.1.cmml">
            ≥
           </mo>
           <mn id="S4.T10.2.2.2.m1.1.1.1.1.3" xref="S4.T10.2.2.2.m1.1.1.1.1.3.cmml">
            0.75
           </mn>
          </mrow>
          <mo id="S4.T10.2.2.2.m1.1.1.1.3" xref="S4.T10.2.2.2.m1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S4.T10.2.2.2.m1.1b">
          <set id="S4.T10.2.2.2.m1.1.1.2.cmml" xref="S4.T10.2.2.2.m1.1.1.1">
           <apply id="S4.T10.2.2.2.m1.1.1.1.1.cmml" xref="S4.T10.2.2.2.m1.1.1.1.1">
            <geq id="S4.T10.2.2.2.m1.1.1.1.1.1.cmml" xref="S4.T10.2.2.2.m1.1.1.1.1.1">
            </geq>
            <ci id="S4.T10.2.2.2.m1.1.1.1.1.2.cmml" xref="S4.T10.2.2.2.m1.1.1.1.1.2">
             R
            </ci>
            <cn id="S4.T10.2.2.2.m1.1.1.1.1.3.cmml" type="float" xref="S4.T10.2.2.2.m1.1.1.1.1.3">
             0.75
            </cn>
           </apply>
          </set>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S4.T10.2.2.2.m1.1c">
          \left\{\mathrm{R}\geq 0.75\right\}
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T10.3.3.3">
       %
       <math alttext="\left\{\mathrm{R}\geq 0.5\right\}" class="ltx_Math" display="inline" id="S4.T10.3.3.3.m1.1">
        <semantics id="S4.T10.3.3.3.m1.1a">
         <mrow id="S4.T10.3.3.3.m1.1.1.1" xref="S4.T10.3.3.3.m1.1.1.2.cmml">
          <mo id="S4.T10.3.3.3.m1.1.1.1.2" xref="S4.T10.3.3.3.m1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S4.T10.3.3.3.m1.1.1.1.1" xref="S4.T10.3.3.3.m1.1.1.1.1.cmml">
           <mi id="S4.T10.3.3.3.m1.1.1.1.1.2" mathvariant="normal" xref="S4.T10.3.3.3.m1.1.1.1.1.2.cmml">
            R
           </mi>
           <mo id="S4.T10.3.3.3.m1.1.1.1.1.1" xref="S4.T10.3.3.3.m1.1.1.1.1.1.cmml">
            ≥
           </mo>
           <mn id="S4.T10.3.3.3.m1.1.1.1.1.3" xref="S4.T10.3.3.3.m1.1.1.1.1.3.cmml">
            0.5
           </mn>
          </mrow>
          <mo id="S4.T10.3.3.3.m1.1.1.1.3" xref="S4.T10.3.3.3.m1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S4.T10.3.3.3.m1.1b">
          <set id="S4.T10.3.3.3.m1.1.1.2.cmml" xref="S4.T10.3.3.3.m1.1.1.1">
           <apply id="S4.T10.3.3.3.m1.1.1.1.1.cmml" xref="S4.T10.3.3.3.m1.1.1.1.1">
            <geq id="S4.T10.3.3.3.m1.1.1.1.1.1.cmml" xref="S4.T10.3.3.3.m1.1.1.1.1.1">
            </geq>
            <ci id="S4.T10.3.3.3.m1.1.1.1.1.2.cmml" xref="S4.T10.3.3.3.m1.1.1.1.1.2">
             R
            </ci>
            <cn id="S4.T10.3.3.3.m1.1.1.1.1.3.cmml" type="float" xref="S4.T10.3.3.3.m1.1.1.1.1.3">
             0.5
            </cn>
           </apply>
          </set>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S4.T10.3.3.3.m1.1c">
          \left\{\mathrm{R}\geq 0.5\right\}
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T10.3.4">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T10.3.4.1">
       Mistral-7B-Instruct-v0.2
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.3.4.2">
       85.2
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.3.4.3">
       61.1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.3.4.4">
       75.8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.3.4.5">
       94.3
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T10.3.5">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T10.3.5.1">
       gpt-3.5-turbo-1106
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T10.3.5.2">
       85.4
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T10.3.5.3">
       62.5
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T10.3.5.4">
       76.1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T10.3.5.5">
       94.3
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 10:
     </span>
     Quality comparison of the accumulated trajectory set in Round 1 for WebShop, which is composed by the policy agent with the open-sourced or the proprietary LLM.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.2">
     While all of the experiments we previously reported are conducted with Mistral-7B-Instruct-v0.2 and QLoRA finetuning, in this section, we also validate A
     <sup class="ltx_sup" id="S4.SS2.p1.2.1">
      3
     </sup>
     T with gpt-3.5-turbo-1106 finetuning, the proprietary service provided by OpenAI. As the initial trajectory set for Round-0 training in A
     <sup class="ltx_sup" id="S4.SS2.p1.2.2">
      3
     </sup>
     T is obtained by ReAct prompting with gpt-3.5-turbo-instruct-0914, the starting point for the two base LLMs is the same.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.3">
     Tables
     <a class="ltx_ref" href="#S4.T8" title="Table 8 ‣ 4.2 Experiments with gpt-3.5-turbo-1106 fintuning ‣ 4 Ablation Studies ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S4.T9" title="Table 9 ‣ 4.2 Experiments with gpt-3.5-turbo-1106 fintuning ‣ 4 Ablation Studies ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     report the performance comparison of Round-0 supervised training between the open-sourced and the proprietary LLMs. In AlfWorld, the performance of the QLoRA fine-tuned Mistral-7B-Instruct-v0.2 even surpasses that of the proprietary gpt-3.5-turbo-1106 fine-tuning service. In WebShop, the proprietary gpt-3.5-turbo-1106 finetuning performs better in Round-0 supervised training. We then let the two models separately compose diverse trajectories for their self-training. Because of the expense of inferring with the finetuned gpt-3.5-turbo-1106 model
     <span class="ltx_note ltx_role_footnote" id="footnote3">
      <sup class="ltx_note_mark">
       3
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         3
        </sup>
        <span class="ltx_tag ltx_tag_note">
         3
        </span>
        The pricing is listed in
        <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/pricing" target="_blank" title="">
         https://openai.com/pricing
        </a>
       </span>
      </span>
     </span>
     , we compose
     <math alttext="10" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1">
      <semantics id="S4.SS2.p2.1.m1.1a">
       <mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">
        10
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b">
        <cn id="S4.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1">
         10
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">
        10
       </annotation>
      </semantics>
     </math>
     trajectories for each failed training task (
     <math alttext="20" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1">
      <semantics id="S4.SS2.p2.2.m2.1a">
       <mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">
        20
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b">
        <cn id="S4.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1">
         20
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">
        20
       </annotation>
      </semantics>
     </math>
     with the open-sourced LLM). Shown in Table
     <a class="ltx_ref" href="#S4.T10" title="Table 10 ‣ 4.2 Experiments with gpt-3.5-turbo-1106 fintuning ‣ 4 Ablation Studies ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       10
      </span>
     </a>
     , the quality of the accumulated trajectories composed by the proprietary LLM is on par with those composed by the open-sourced LLM. After Round-1 self-training, the open-sourced model achieves an even higher test success rate. This is attributed to the proprietary service providing only the supervised fine-tuning option, while also indicating the importance of contrastive fine-tuning in A
     <sup class="ltx_sup" id="S4.SS2.p2.3.1">
      3
     </sup>
     T.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Conclusion
  </h2>
  <div class="ltx_para ltx_noindent" id="S5.p1">
   <p class="ltx_p" id="S5.p1.2">
    In this work, we propose A
    <sup class="ltx_sup" id="S5.p1.2.1">
     3
    </sup>
    T, a framework that enables the autonomous annotation of agent trajectories in the style of ReAct for contrastive self-training. The key factor in the trajectory annotation process is the ActRe prompting agent, which produces the textual rationales given arbitrary external actions. Together with ActRe and environmental feedback, the ReAct-style agent autonomously synthesizes trajectories for self-training. In the contrastive self-training process, we leverage the policy gradient methods with binarized rewards to boost the task success rate. Extensive experiments on AlfWorld and WebShop have demonstrated the superiority of A
    <sup class="ltx_sup" id="S5.p1.2.2">
     3
    </sup>
    T over multiple strong baselines.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Aksitov et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Renat Aksitov, Sobhan Miryoosefi, Zonglin Li, Daliang Li, Sheila Babayan, Kavya Kopparapu, Zachary Fisher, Ruiqi Guo, Sushant Prakash, Pranesh Srinivasan, et al.
    </span>
    <span class="ltx_bibblock">
     Rest meets react: Self-improvement for multi-step reasoning llm agent.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      arXiv preprint arXiv:2312.10003
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Baian Chen, Chang Shu, Ehsan Shareghi, Nigel Collier, Karthik Narasimhan, and Shunyu Yao.
    </span>
    <span class="ltx_bibblock">
     Fireact: Toward language agent fine-tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      arXiv preprint arXiv:2310.05915
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Zixiang Chen, Yihe Deng, Huizhuo Yuan, Kaixuan Ji, and Quanquan Gu.
    </span>
    <span class="ltx_bibblock">
     Self-play fine-tuning converts weak language models to strong language models, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Dettmers et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer.
    </span>
    <span class="ltx_bibblock">
     Qlora: Efficient finetuning of quantized llms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv preprint arXiv:2305.14314
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Furuta et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Hiroki Furuta, Kuang-Huei Lee, Ofir Nachum, Yutaka Matsuo, Aleksandra Faust, Shixiang Shane Gu, and Izzeddin Gur.
    </span>
    <span class="ltx_bibblock">
     Multimodal web navigation with instruction-finetuned foundation models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      The Twelfth International Conference on Learning Representations
     </em>
     , 2024.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=efFmBWioSc" target="_blank" title="">
      https://openreview.net/forum?id=efFmBWioSc
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hosseini et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Arian Hosseini, Xingdi Yuan, Nikolay Malkin, Aaron Courville, Alessandro Sordoni, and Rishabh Agarwal.
    </span>
    <span class="ltx_bibblock">
     V-star: Training verifiers for self-taught reasoners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      arXiv preprint arXiv:2402.06457
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et al.
    </span>
    <span class="ltx_bibblock">
     Mistral 7b.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      arXiv preprint arXiv:2310.06825
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Albert Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou Hanna, Florian Bressand, et al.
    </span>
    <span class="ltx_bibblock">
     Mixtral of experts.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      arXiv preprint arXiv:2401.04088
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lee et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Harrison Lee, Samrat Phatale, Hassan Mansoor, Kellie Lu, Thomas Mesnard, Colton Bishop, Victor Carbune, and Abhinav Rastogi.
    </span>
    <span class="ltx_bibblock">
     Rlaif: Scaling reinforcement learning from human feedback with ai feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      arXiv preprint arXiv:2309.00267
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Zhihan Liu, Hao Hu, Shenao Zhang, Hongyi Guo, Shuqi Ke, Boyi Liu, and Zhaoran Wang.
    </span>
    <span class="ltx_bibblock">
     Reason for future, act for now: A principled framework for autonomous llm agents with provable sample efficiency.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      arXiv preprint arXiv:2309.17382
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Zhiwei Liu, Weiran Yao, Jianguo Zhang, Liangwei Yang, Zuxin Liu, Juntao Tan, Prafulla K Choubey, Tian Lan, Jason Wu, Huan Wang, et al.
    </span>
    <span class="ltx_bibblock">
     Agentlite: A lightweight library for building and advancing task-oriented llm agent system.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      arXiv preprint arXiv:2402.15538
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ma et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Chang Ma, Junlei Zhang, Zhihao Zhu, Cheng Yang, Yujiu Yang, Yaohui Jin, Zhenzhong Lan, Lingpeng Kong, and Junxian He.
    </span>
    <span class="ltx_bibblock">
     Agentboard: An analytical evaluation board of multi-turn llm agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      arXiv preprint arXiv:2401.13178
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Micheli &amp; Fleuret (2021)
    </span>
    <span class="ltx_bibblock">
     Vincent Micheli and Francois Fleuret.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot butlers.
    </span>
    <span class="ltx_bibblock">
     In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and Scott Wen-tau Yih (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing
     </em>
     , pp.  9312–9318, Online and Punta Cana, Dominican Republic, November 2021. Association for Computational Linguistics.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.18653/v1/2021.emnlp-main.734
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.emnlp-main.734" target="_blank" title="">
      https://aclanthology.org/2021.emnlp-main.734
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mirchandani et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Suvir Mirchandani, Fei Xia, Pete Florence, Brian Ichter, Danny Driess, Montserrat Gonzalez Arenas, Kanishka Rao, Dorsa Sadigh, and Andy Zeng.
    </span>
    <span class="ltx_bibblock">
     Large language models as general pattern machines.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      Proceedings of the 7th Conference on Robot Learning (CoRL)
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI (2023)
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     GPT-4 technical report.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      CoRR
     </em>
     , abs/2303.08774, 2023.
    </span>
    <span class="ltx_bibblock">
     doi:
     <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">
      10.48550/ARXIV.2303.08774
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2303.08774" target="_blank" title="">
      https://doi.org/10.48550/arXiv.2303.08774
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:27730–27744, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yujia Qin, Shihao Liang, Yining Ye, Kunlun Zhu, Lan Yan, Yaxi Lu, Yankai Lin, Xin Cong, Xiangru Tang, Bill Qian, et al.
    </span>
    <span class="ltx_bibblock">
     Toolllm: Facilitating large language models to master 16000+ real-world apis.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      arXiv preprint arXiv:2307.16789
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Rafailov et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D Manning, Stefano Ermon, and Chelsea Finn.
    </span>
    <span class="ltx_bibblock">
     Direct preference optimization: Your language model is secretly a reward model.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Federico Cassano, Ashwin Gopinath, Karthik R Narasimhan, and Shunyu Yao.
    </span>
    <span class="ltx_bibblock">
     Reflexion: language agents with verbal reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      Thirty-seventh Conference on Neural Information Processing Systems
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=vAElhFcKW6" target="_blank" title="">
      https://openreview.net/forum?id=vAElhFcKW6
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shridhar et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Mohit Shridhar, Xingdi Yuan, Marc-Alexandre Côté, Yonatan Bisk, Adam Trischler, and Matthew Hausknecht.
    </span>
    <span class="ltx_bibblock">
     ALFWorld: Aligning Text and Embodied Environments for Interactive Learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      Proceedings of the International Conference on Learning Representations (ICLR)
     </em>
     , 2021.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2010.03768" target="_blank" title="">
      https://arxiv.org/abs/2010.03768
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Singh et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Avi Singh, John D Co-Reyes, Rishabh Agarwal, Ankesh Anand, Piyush Patil, Peter J Liu, James Harrison, Jaehoon Lee, Kelvin Xu, Aaron Parisi, et al.
    </span>
    <span class="ltx_bibblock">
     Beyond human data: Scaling self-training for problem-solving with language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      arXiv preprint arXiv:2312.06585
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Song et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Yifan Song, Da Yin, Xiang Yue, Jie Huang, Sujian Li, and Bill Yuchen Lin.
    </span>
    <span class="ltx_bibblock">
     Trial and error: Exploration-based trajectory optimization for llm agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      arXiv preprint arXiv:2403.02502
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Team et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Gemini Team, Rohan Anil, Sebastian Borgeaud, Yonghui Wu, Jean-Baptiste Alayrac, Jiahui Yu, Radu Soricut, Johan Schalkwyk, Andrew M Dai, Anja Hauth, et al.
    </span>
    <span class="ltx_bibblock">
     Gemini: a family of highly capable multimodal models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      arXiv preprint arXiv:2312.11805
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.
    </span>
    <span class="ltx_bibblock">
     Llama 2: Open foundation and fine-tuned chat models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      arXiv preprint arXiv:2307.09288
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Guan Wang, Sijie Cheng, Xianyuan Zhan, Xiangang Li, Sen Song, and Yang Liu.
    </span>
    <span class="ltx_bibblock">
     Openchat: Advancing open-source language models with mixed-quality data.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      The Twelfth International Conference on Learning Representations
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu, Linxi Fan, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     Voyager: An open-ended embodied agent with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      arXiv preprint arXiv: Arxiv-2305.16291
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Williams (1992)
    </span>
    <span class="ltx_bibblock">
     Ronald J Williams.
    </span>
    <span class="ltx_bibblock">
     Simple statistical gradient-following algorithms for connectionist reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      Machine learning
     </em>
     , 8:229–256, 1992.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Zhiyong Wu, Chengcheng Han, Zichen Ding, Zhenmin Weng, Zhoumianze Liu, Shunyu Yao, Tao Yu, and Lingpeng Kong.
    </span>
    <span class="ltx_bibblock">
     Os-copilot: Towards generalist computer agents with self-improvement, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Zonghan Yang, An Liu, Zijun Liu, Kaiming Liu, Fangzhou Xiong, Yile Wang, Zeyuan Yang, Qingyuan Hu, Xinrui Chen, Zhenhe Zhang, Fuwen Luo, Zhicheng Guo, Peng Li, and Yang Liu.
    </span>
    <span class="ltx_bibblock">
     Towards unified alignment between agents, humans, and environment.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      arXiv preprint arXiv:2402.07744
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Howard Chen, John Yang, and Karthik Narasimhan.
    </span>
    <span class="ltx_bibblock">
     Webshop: Towards scalable real-world web interaction with grounded language agents.
    </span>
    <span class="ltx_bibblock">
     In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh (eds.),
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , volume 35, pp.  20744–20757. Curran Associates, Inc., 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R Narasimhan, and Yuan Cao.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">
      The Eleventh International Conference on Learning Representations
     </em>
     , 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=WE_vluYUL-X" target="_blank" title="">
      https://openreview.net/forum?id=WE_vluYUL-X
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Da Yin, Faeze Brahman, Abhilasha Ravichander, Khyathi Chandu, Kai-Wei Chang, Yejin Choi, and Bill Yuchen Lin.
    </span>
    <span class="ltx_bibblock">
     Agent lumos: Unified and modular training for open-source language agents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      arXiv preprint arXiv:2311.05657
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yuan et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Weizhe Yuan, Richard Yuanzhe Pang, Kyunghyun Cho, Sainbayar Sukhbaatar, Jing Xu, and Jason Weston.
    </span>
    <span class="ltx_bibblock">
     Self-rewarding language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv preprint arXiv:2401.10020
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zeng et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Aohan Zeng, Mingdao Liu, Rui Lu, Bowen Wang, Xiao Liu, Yuxiao Dong, and Jie Tang.
    </span>
    <span class="ltx_bibblock">
     Agenttuning: Enabling generalized agent abilities for llms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      arXiv preprint arXiv:2310.12823
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Jianguo Zhang, Tian Lan, Rithesh Murthy, Zhiwei Liu, Weiran Yao, Juntao Tan, Thai Hoang, Liangwei Yang, Yihao Feng, Zuxin Liu, et al.
    </span>
    <span class="ltx_bibblock">
     Agentohana: Design unified data and training pipeline for effective agent learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      arXiv preprint arXiv:2402.15506
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zheng et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Boyuan Zheng, Boyu Gou, Jihyung Kil, Huan Sun, and Yu Su.
    </span>
    <span class="ltx_bibblock">
     Gpt-4v(ision) is a generalist web agent, if grounded.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      arXiv preprint arXiv:2401.01614
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhou et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Andy Zhou, Kai Yan, Michal Shlapentokh-Rothman, Haohan Wang, and Yu-Xiong Wang.
    </span>
    <span class="ltx_bibblock">
     Language agent tree search unifies reasoning acting and planning in language models, 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhou et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Chunting Zhou, Pengfei Liu, Puxin Xu, Srinivasan Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et al.
    </span>
    <span class="ltx_bibblock">
     Lima: Less is more for alignment.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 36, 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhou et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Yifei Zhou, Andrea Zanette, Jiayi Pan, Sergey Levine, and Aviral Kumar.
    </span>
    <span class="ltx_bibblock">
     Archer: Training language model agents via hierarchical multi-turn rl.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      arXiv preprint arXiv:2402.19446
     </em>
     , 2024.
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Implementation Details
  </h2>
  <div class="ltx_para ltx_noindent" id="A1.p1">
   <p class="ltx_p" id="A1.p1.2">
    We implement autonomous trajectory composition in Rounds 1-3, with Round 0 as the ReAct fine-tuning bootstrapping process. The trained agent for Rounds 1-3 also follows the style of ReAct. Shown in
    <cite class="ltx_cite ltx_citemacro_cite">
     Yao et al. (
     <a class="ltx_ref" href="#bib.bib31" title="">
      2023
     </a>
     )
    </cite>
    , humans can modify the mistaken internal reasoning to correct the action behavior of a ReAct agent. In our work, the ActRe prompting agent replaces the human role as a rationale annotator for the ReAct policy agent. The ReAct agent decides whether to sample a novel action with probability
    <math alttext="p" class="ltx_Math" display="inline" id="A1.p1.1.m1.1">
     <semantics id="A1.p1.1.m1.1a">
      <mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">
       p
      </mi>
      <annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b">
       <ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">
        𝑝
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">
       p
      </annotation>
     </semantics>
    </math>
    . If the action is not to be sampled, then the ReAct policy agent takes the action conditioned on internal reasoning. Otherwise, the sampled action is sent to the ActRe agent as a query for posterior explanations. In the implementation, we select
    <math alttext="p=0.5" class="ltx_Math" display="inline" id="A1.p1.2.m2.1">
     <semantics id="A1.p1.2.m2.1a">
      <mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">
       <mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">
        p
       </mi>
       <mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">
        =
       </mo>
       <mn id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">
        0.5
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b">
       <apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">
        <eq id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1">
        </eq>
        <ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">
         𝑝
        </ci>
        <cn id="A1.p1.2.m2.1.1.3.cmml" type="float" xref="A1.p1.2.m2.1.1.3">
         0.5
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">
       p=0.5
      </annotation>
     </semantics>
    </math>
    . If consecutive 3 actions taken by the policy agent itself are invalid, the external action is sampled one more time with the query of ActRe for reason synthesis. In AlfWorld, we let the agent gather 40 trajectories to improve the possibility of attaining at least one successful trajectory for each failed task. In WebShop experiments, due to budgetary limits, we adopt another strategy by first forcing the policy agent to collect 3 trajectories, and then terminate when a successful trajectory is gathered, or the total number of annotated trajectories reaches 20 for a single task. The prompts for ActRe in AlfWorld and WebShop are shown in Tables
    <a class="ltx_ref" href="#A1.T11" title="Table 11 ‣ Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      11
     </span>
    </a>
    and
    <a class="ltx_ref" href="#A1.T12" title="Table 12 ‣ Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      12
     </span>
    </a>
    , respectively.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="A1.p2">
   <p class="ltx_p" id="A1.p2.2">
    As for self-training, we use QLoRA finetuning with the open-sourced Mistral-7B-Instruct-v0.2 throughout the main experiments. We set the rank to be 16 and
    <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.p2.1.m1.1">
     <semantics id="A1.p2.1.m1.1a">
      <mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">
       α
      </mi>
      <annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b">
       <ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">
        𝛼
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">
       \alpha
      </annotation>
     </semantics>
    </math>
    to be 32 in the QLoRA configurations. The tuned modules are
    <span class="ltx_text ltx_font_typewriter" id="A1.p2.2.1">
     q_proj
    </span>
    and
    <span class="ltx_text ltx_font_typewriter" id="A1.p2.2.2">
     v_proj
    </span>
    only. We use the
    <span class="ltx_text ltx_font_typewriter" id="A1.p2.2.3">
     nf4
    </span>
    quantization without double quantization in our experiments with QLoRA. The optimizer is set to be the 32-bit paged AdamW. This allows the experiments to be conducted on 2-4 NVIDIA 3090 GPUs with 24GB memory or 2 NVIDIA A100 GPUs with 40GB memory. We set the learning rate as 1e-4, and train 10 epochs for the initial Round 0 (ReAct supervised fine-tuning with successful trajectories). In Rounds 1-3, we fine-tune the LLM for 6 epochs with Eq.
    <a class="ltx_ref" href="#S2.E1" title="In 2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (
    <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="A1.p2.2.m2.1">
     <semantics id="A1.p2.2.m2.1a">
      <mrow id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">
       <mrow id="A1.p2.2.m2.1.1.1" xref="A1.p2.2.m2.1.1.1.cmml">
        <mi id="A1.p2.2.m2.1.1.1.3" xref="A1.p2.2.m2.1.1.1.3.cmml">
         R
        </mi>
        <mo id="A1.p2.2.m2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.p2.2.m2.1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="A1.p2.2.m2.1.1.1.1.1" xref="A1.p2.2.m2.1.1.1.1.1.1.cmml">
         <mo id="A1.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="A1.p2.2.m2.1.1.1.1.1.1.cmml">
          (
         </mo>
         <msub id="A1.p2.2.m2.1.1.1.1.1.1" xref="A1.p2.2.m2.1.1.1.1.1.1.cmml">
          <mi id="A1.p2.2.m2.1.1.1.1.1.1.2" xref="A1.p2.2.m2.1.1.1.1.1.1.2.cmml">
           τ
          </mi>
          <mi id="A1.p2.2.m2.1.1.1.1.1.1.3" xref="A1.p2.2.m2.1.1.1.1.1.1.3.cmml">
           f
          </mi>
         </msub>
         <mo id="A1.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="A1.p2.2.m2.1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <mo id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml">
        =
       </mo>
       <mrow id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml">
        <mo id="A1.p2.2.m2.1.1.3a" xref="A1.p2.2.m2.1.1.3.cmml">
         −
        </mo>
        <mn id="A1.p2.2.m2.1.1.3.2" xref="A1.p2.2.m2.1.1.3.2.cmml">
         1
        </mn>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b">
       <apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">
        <eq id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2">
        </eq>
        <apply id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1">
         <times id="A1.p2.2.m2.1.1.1.2.cmml" xref="A1.p2.2.m2.1.1.1.2">
         </times>
         <ci id="A1.p2.2.m2.1.1.1.3.cmml" xref="A1.p2.2.m2.1.1.1.3">
          𝑅
         </ci>
         <apply id="A1.p2.2.m2.1.1.1.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1.1.1">
          <csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1.1.1">
           subscript
          </csymbol>
          <ci id="A1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.p2.2.m2.1.1.1.1.1.1.2">
           𝜏
          </ci>
          <ci id="A1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.p2.2.m2.1.1.1.1.1.1.3">
           𝑓
          </ci>
         </apply>
        </apply>
        <apply id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3">
         <minus id="A1.p2.2.m2.1.1.3.1.cmml" xref="A1.p2.2.m2.1.1.3">
         </minus>
         <cn id="A1.p2.2.m2.1.1.3.2.cmml" type="integer" xref="A1.p2.2.m2.1.1.3.2">
          1
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">
       R(\tau_{f})=-1
      </annotation>
     </semantics>
    </math>
    ) and conduct checkpoint averaging over the entire training process.
   </p>
  </div>
  <figure class="ltx_table" id="A1.T11">
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T11.1">
    <tr class="ltx_tr" id="A1.T11.1.1">
     <td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T11.1.1.1">
      <span class="ltx_text ltx_font_bold" id="A1.T11.1.1.1.1">
       The ActRe in-context prompt for AlfWorld
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.2">
     <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T11.1.2.1">
      Observation: Your task is to: put some spraybottle on toilet. You are in the middle
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.3">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.3.1">
      of a room. Looking quickly around you, you see a cabinet 4, a cabinet 3, a cabinet 2,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.4">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.4.1">
      a cabinet 1, a countertop 1, a garbagecan 1, a handtowelholder 2, a handtowelholder
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.5">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.5.1">
      1, a sinkbasin 2, a sinkbasin 1, a toilet 1, a toiletpaperhanger 1, and a towelholder 1.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.6">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.6.1">
      Action: think[To solve the task, I need to find and take a sparybottle, then put it on toilet.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.7">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.7.1">
      Observation: OK.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.8">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.8.1">
      Action: act[go to cabinet 1]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.9">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.9.1">
      Reason for the action: [First I need to find a spraybottle. A spraybottle is more
likely to
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.10">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.10.1">
      appear in cabinet (1-4), countertop (1), toilet (1), sinkbasin (1-2), garbagecan (1). I can
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.11">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.11.1">
      check one by one, starting with cabinet 1.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.12">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.12.1">
      Observation: On the cabinet 1, you see a cloth 1, a soapbar 1, a soapbottle 1.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.13">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.13.1">
      Action: act[go to cabinet 2]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.14">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.14.1">
      Observation: The cabinet 2 is closed.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.15">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.15.1">
      Action: act[open cabinet 2]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.16">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.16.1">
      Observation: You open the cabinet 2. The cabinet 2 is open. In it, you see a candle 1,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.17">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.17.1">
      and a spraybottle 2.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.18">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.18.1">
      Action: act[take spraybottle 2 from cabinet 2]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.19">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.19.1">
      Reason for the action: [Now I find a spraybottle (2). Next, I need to take it.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.20">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.20.1">
      Observation: You pick up the spraybottle 2 from the cabinet 2.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.21">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.21.1">
      Action: act[go to toilet 1]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.22">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.22.1">
      Reason for the action: [Now I take a spraybottle (2). Next, I need to put it in/on toilet 1.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.23">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.23.1">
      Observation: On the toilet 1, you see a soapbottle 2.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.24">
     <td class="ltx_td ltx_align_left" id="A1.T11.1.24.1">
      Action: act[put spraybottle 2 in/on toilet 1]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T11.1.25">
     <td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T11.1.25.1">
      Observation: You put the spraybottle 2 in/on the toilet 1.
     </td>
    </tr>
   </table>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 11:
    </span>
    The ActRe prompt for the AlfWorld tasks. ActRe inverts the causality of ReAct, and provides the posterior reason for the external action.
   </figcaption>
  </figure>
  <figure class="ltx_table" id="A1.T12">
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T12.1">
    <tr class="ltx_tr" id="A1.T12.1.1">
     <td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T12.1.1.1">
      <span class="ltx_text ltx_font_bold" id="A1.T12.1.1.1.1">
       The ActRe in-context prompt for WebShop
      </span>
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.2">
     <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T12.1.2.1">
      Webshop
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.3">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.3.1">
      Instruction:
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.4">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.4.1">
      i would like a 3 ounce bottle of bright citrus deodorant for sensitive skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.5">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.5.1">
      and price lower than 50.00 dollars
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.6">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.6.1">
      [Search]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.7">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.7.1">
      Action: search[3 ounce bright citrus deodorant sensitive skin]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.8">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.8.1">
      Observation:
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.9">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.9.1">
      [Back to Search]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.10">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.10.1">
      Page 1 (Total results: 50)
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.11">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.11.1">
      [Next &gt;]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.12">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.12.1">
      [B078GWRC1J]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.13">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.13.1">
      Bright Citrus Deodorant by Earth Mama | Natural and Safe for Sensitive Skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.14">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.14.1">
      Pregnancy and Breastfeeding, Contains Organic Calendula 3-Ounce
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.15">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.15.1">
      $10.99
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.16">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.16.1">
      [B078GTKVXY]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.17">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.17.1">
      Ginger Fresh Deodorant by Earth Mama | Natural and Safe for Sensitive Skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.18">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.18.1">
      Pregnancy and Breastfeeding, Contains Organic Calendula 3-Ounce
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.19">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.19.1">
      $10.99
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.20">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.20.1">
      [B08KBVJ4XN]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.21">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.21.1">
      Barrel and Oak - Aluminum-Free Deodorant, Deodorant for Men, Essential
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.22">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.22.1">
      Oil-Based Scent, 24-Hour Odor Protection, Cedar &amp; Patchouli Blend, Gentle on
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.23">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.23.1">
      Sensitive Skin (Mountain Sage, 2.7 oz, 2-Pack)
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.24">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.24.1">
      $15.95
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.25">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.25.1">
      Action: click[B078GWRC1J]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.26">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.26.1">
      Reason for the action: [B078GWRC1J and B078GTKVXY are bright citrus deodorant
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.27">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.27.1">
      less then 50 dollars. I can check B078GWRC1J first.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.28">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.28.1">
      Observation:
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.29">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.29.1">
      [Back to Search]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.30">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.30.1">
      [&lt; Prev]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.31">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.31.1">
      scent [assorted scents][bright citrus][calming lavender][ginger fresh][simply non-scents]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.32">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.32.1">
      size [travel set (4-pack)][3 ounce (pack of 1)][3-ounce (2-pack)]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.33">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.33.1">
      Bright Citrus Deodorant by Earth Mama | Natural and Safe for Sensitive Skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.34">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.34.1">
      Pregnancy and Breastfeeding, Contains Organic Calendula 3-Ounce
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.35">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.35.1">
      Price: $10.99
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.36">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.36.1">
      Rating: N.A.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.37">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.37.1">
      [Description]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.38">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.38.1">
      [Features]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.39">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.39.1">
      [Reviews]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.40">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.40.1">
      [Buy Now]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.41">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.41.1">
      Action: click[bright citrus]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.42">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.42.1">
      Reason for the action: [For 3 ounce bottle of bright citrus deodorant for sensitive skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.43">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.43.1">
      the item has options ’bright citrus’ and ’3 ounce (pack of 1)’ and seems good to buy.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.44">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.44.1">
      Observation: You have clicked bright citrus.
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.45">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.45.1">
      Action: click[3 ounce (pack of 1)]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.46">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.46.1">
      Reason for the action: [For 3 ounce bottle of bright citrus deodorant for sensitive skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.47">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.47.1">
      the item has options ’bright citrus’ and ’3 ounce (pack of 1)’ and seems good to buy.]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.48">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.48.1">
      Observation: You have clicked 3 ounce (pack of 1).
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.49">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.49.1">
      Action: click[Buy Now]
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.50">
     <td class="ltx_td ltx_align_left" id="A1.T12.1.50.1">
      Reason for the action: [For 3 ounce bottle of bright citrus deodorant for sensitive skin,
     </td>
    </tr>
    <tr class="ltx_tr" id="A1.T12.1.51">
     <td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T12.1.51.1">
      the item has options ’bright citrus’ and ’3 ounce (pack of 1)’ and seems good to buy.]
     </td>
    </tr>
   </table>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 12:
    </span>
    The ActRe prompt for the WebShop tasks. ActRe inverts the causality of ReAct, and provides the posterior reason for the external action.
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Case Studies of the Composed Trajectories
  </h2>
  <div class="ltx_para" id="A2.p1">
   <p class="ltx_p" id="A2.p1.1">
    Figs.
    <a class="ltx_ref" href="#A2.F2" title="Figure 2 ‣ Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    ,
    <a class="ltx_ref" href="#A2.F3" title="Figure 3 ‣ Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    ,
    <a class="ltx_ref" href="#A2.F4" title="Figure 4 ‣ Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    , and
    <a class="ltx_ref" href="#A2.F5" title="Figure 5 ‣ Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    show several cases of trajectories composed with ActRe on WebShop.
   </p>
  </div>
  <figure class="ltx_figure" id="A2.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="437" id="A2.F2.g1" src="/html/2403.14589/assets/x2.png" width="422"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    Trajectory comparison on the 518-th task of WebShop. (a) the failed trajectory by the trained agent at the 0-th Round; (b) the composed trajectory assisted with ActRe. The trained policy agent fails to choose the correct option in the item content page. Success is obtained by clicking “[white | primary]”, and ActRe annotates for the sampled action.
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <figure class="ltx_figure" id="A2.F3">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="674" id="A2.F3.g1" src="/html/2403.14589/assets/x3.png" width="380"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 3:
    </span>
    Trajectory comparison on the 512-th task of WebShop. (a) the failed trajectory by the trained agent at the 0-th Round; (b) the annotated trajectory assisted with ActRe. The action of clicking the 7-th item “[B09QCYNF9R]” is explored in the new trajectory, and the reason highlighted in green is generated by ActRe.
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <figure class="ltx_figure" id="A2.F4">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="686" id="A2.F4.g1" src="/html/2403.14589/assets/x4.png" width="422"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 4:
    </span>
    Trajectory comparison on the 754-th task of WebShop. (a) the failed trajectory by the trained agent at the 0-th Round; (b) the annotated trajectory assisted with ActRe. The trajectory (b) is continued in Fig.
    <a class="ltx_ref" href="#A2.F5" title="Figure 5 ‣ Appendix B Case Studies of the Composed Trajectories ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    .
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <figure class="ltx_figure" id="A2.F5">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="499" id="A2.F5.g1" src="/html/2403.14589/assets/x5.png" width="422"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 5:
    </span>
    The second part of the composed trajectory on the 754-th task of WebShop. This case demonstrates some sophisticated behavior achieved by the synergy of the ReAct-style policy agent and the ActRe prompting agent. The policy agent alone terminates the trajectory by directing purchasing the first item ([B00QB6TW9C]) on the first page, obtaining an imperfect reward of 0.6667. By the randomly sampling actions and querying the ActRe agent to synthesize the reasons, the annotated trajectory shows that the policy agent initially clicks the first item on Page 1 as well, but then goes back to seek for other options (the reason in Act 3 highlighted in green is the first synthetic reason by ActRe). Then the agent clicks the 9-th item ([B07CYD69J9]) on Page 1, but then goes back and clicks the 1-st item, and returns to the search results of Page 1 once again. After that, the agent chooses to go to the next page, and then selects the 4-th item ([B07JCHPH1H]) and finally makes a purchase. This item results in a perfect match with the provided instruction.
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Additional Experimental Results
  </h2>
  <section class="ltx_subsection" id="A3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.1
    </span>
    AlfWorld
   </h3>
   <div class="ltx_para ltx_noindent" id="A3.SS1.p1">
    <p class="ltx_p" id="A3.SS1.p1.1">
     Table
     <a class="ltx_ref" href="#A3.T13" title="Table 13 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       13
      </span>
     </a>
     covers the detailed task statistics in each split for our experiments.
    </p>
   </div>
   <figure class="ltx_table" id="A3.T13">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T13.1">
     <tr class="ltx_tr" id="A3.T13.1.2">
      <td class="ltx_td ltx_border_r ltx_border_tt" id="A3.T13.1.2.1">
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.2">
       Pick
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.3">
       Clean
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.4">
       Heat
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.5">
       Cool
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.6">
       Examine
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T13.1.2.7">
       PickTwo
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T13.1.2.8">
       Total
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T13.1.3">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T13.1.3.1">
       Train
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.2">
       135
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.3">
       98
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.4">
       74
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.5">
       92
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.6">
       59
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T13.1.3.7">
       142
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T13.1.3.8">
       600
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T13.1.4">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T13.1.4.1">
       Valid.
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.2">
       12
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.3">
       10
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.4">
       7
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.5">
       14
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.6">
       8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T13.1.4.7">
       9
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.4.8">
       60
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T13.1.1">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T13.1.1.1">
       Test
       <sup class="ltx_sup" id="A3.T13.1.1.1.1">
        <span class="ltx_text ltx_font_italic" id="A3.T13.1.1.1.1.1">
         ∗
        </span>
       </sup>
       (held out, seen)
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.2">
       35
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.3">
       27
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.4">
       16
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.5">
       25
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.6">
       13
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T13.1.1.7">
       24
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T13.1.1.8">
       140
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T13.1.5">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A3.T13.1.5.1">
       Test (held out, unseen)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.2">
       24
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.3">
       31
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.4">
       23
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.5">
       21
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.6">
       18
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T13.1.5.7">
       17
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T13.1.5.8">
       134
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 13:
     </span>
     The statistics of tasks used in training, validation, and testing.
     <sup class="ltx_sup" id="A3.T13.5.1">
      <span class="ltx_text ltx_font_italic" id="A3.T13.5.1.1">
       ∗
      </span>
     </sup>
     : For all experimental results except for Table
     <a class="ltx_ref" href="#A3.T14" title="Table 14 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       14
      </span>
     </a>
     , we report the success rate on the 134 held-out unseen test scenarios following the settings in previous work.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="A3.SS1.p2">
    <p class="ltx_p" id="A3.SS1.p2.1">
     Tables
     <a class="ltx_ref" href="#A3.T14" title="Table 14 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       14
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A3.T15" title="Table 15 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       15
      </span>
     </a>
     exhibit more experimental results on the 140 held-out seen testing tasks (official split) and the 60 validation tasks (our use).
    </p>
   </div>
   <figure class="ltx_table" id="A3.T14">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T14.4" style="width:397.5pt;height:84.1pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(-56.5pt,12.0pt) scale(0.778580550729324,0.778580550729324) ;">
      <table class="ltx_tabular ltx_align_middle" id="A3.T14.4.4">
       <tr class="ltx_tr" id="A3.T14.4.4.5">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A3.T14.4.4.5.1">
         Method
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.2">
         Pick
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.3">
         Clean
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.4">
         Heat
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.5">
         Cool
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.6">
         Examine
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T14.4.4.5.7">
         PickTwo
        </td>
        <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T14.4.4.5.8">
         Total
        </td>
       </tr>
       <tr class="ltx_tr" id="A3.T14.4.4.6">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T14.4.4.6.1">
         LM-BUTLER
         <cite class="ltx_cite ltx_citemacro_citep">
          (Micheli &amp; Fleuret,
          <a class="ltx_ref" href="#bib.bib13" title="">
           2021
          </a>
          )
         </cite>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.2">
         97
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.3">
         89
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.4">
         100
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.5">
         80
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.6">
         77
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T14.4.4.6.7">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.6.7.1">
          92
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.4.4.6.8">
         90
        </td>
       </tr>
       <tr class="ltx_tr" id="A3.T14.1.1.1">
        <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T14.1.1.1.1">
         A
         <sup class="ltx_sup" id="A3.T14.1.1.1.1.1">
          3
         </sup>
         T (Round=0)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.2">
         86
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.3">
         67
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.4">
         94
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.5">
         80
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.6">
         85
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T14.1.1.1.7">
         75
        </td>
        <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T14.1.1.1.8">
         80
        </td>
       </tr>
       <tr class="ltx_tr" id="A3.T14.2.2.2">
        <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T14.2.2.2.1">
         A
         <sup class="ltx_sup" id="A3.T14.2.2.2.1.1">
          3
         </sup>
         T (Round=1)
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.2">
         91
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.3">
         89
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.4">
         88
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.5">
         <span class="ltx_text ltx_font_bold" id="A3.T14.2.2.2.5.1">
          96
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.6">
         <span class="ltx_text ltx_font_bold" id="A3.T14.2.2.2.6.1">
          92
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T14.2.2.2.7">
         67
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.2.2.2.8">
         87
        </td>
       </tr>
       <tr class="ltx_tr" id="A3.T14.3.3.3">
        <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T14.3.3.3.1">
         A
         <sup class="ltx_sup" id="A3.T14.3.3.3.1.1">
          3
         </sup>
         T (Round=2)
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.2">
         97
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.3">
         89
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.4">
         <span class="ltx_text ltx_font_bold" id="A3.T14.3.3.3.4.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.5">
         88
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.6">
         <span class="ltx_text ltx_font_bold" id="A3.T14.3.3.3.6.1">
          92
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T14.3.3.3.7">
         79
        </td>
        <td class="ltx_td ltx_align_center" id="A3.T14.3.3.3.8">
         91
        </td>
       </tr>
       <tr class="ltx_tr" id="A3.T14.4.4.4">
        <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A3.T14.4.4.4.1">
         A
         <sup class="ltx_sup" id="A3.T14.4.4.4.1.1">
          3
         </sup>
         T (Round=3)
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.2">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.4.2.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.3">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.4.3.1">
          96
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.4">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.4.4.1">
          100
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.5">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.4.5.1">
          96
         </span>
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.6">
         77
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T14.4.4.4.7">
         79
        </td>
        <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T14.4.4.4.8">
         <span class="ltx_text ltx_font_bold" id="A3.T14.4.4.4.8.1">
          93
         </span>
        </td>
       </tr>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 14:
     </span>
     Success rate (
     <math alttext="\%" class="ltx_Math" display="inline" id="A3.T14.6.m1.1">
      <semantics id="A3.T14.6.m1.1b">
       <mo id="A3.T14.6.m1.1.1" xref="A3.T14.6.m1.1.1.cmml">
        %
       </mo>
       <annotation-xml encoding="MathML-Content" id="A3.T14.6.m1.1c">
        <csymbol cd="latexml" id="A3.T14.6.m1.1.1.cmml" xref="A3.T14.6.m1.1.1">
         percent
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.T14.6.m1.1d">
        \%
       </annotation>
      </semantics>
     </math>
     ) on each task type of AlfWorld, with a single trial on each of the 140 in-distribution test scenarios. Our agents outperform LM-BUTLER on this test split.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="A3.T15">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T15.4">
     <tr class="ltx_tr" id="A3.T15.4.5">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A3.T15.4.5.1">
       Method
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.2">
       Pick
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.3">
       Clean
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.4">
       Heat
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.5">
       Cool
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.6">
       Examine
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T15.4.5.7">
       PickTwo
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T15.4.5.8">
       Total
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T15.1.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T15.1.1.1">
       A
       <sup class="ltx_sup" id="A3.T15.1.1.1.1">
        3
       </sup>
       T (Round=0)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.2">
       11/12
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.3">
       9/10
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.4">
       5/7
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.5">
       11/14
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.6">
       7/8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T15.1.1.7">
       9/9
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T15.1.1.8">
       52/60
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T15.2.2">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T15.2.2.1">
       A
       <sup class="ltx_sup" id="A3.T15.2.2.1.1">
        3
       </sup>
       T (Round=1)
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.2">
       11/12
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.3">
       10/10
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.4">
       6/7
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.5">
       13/14
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.6">
       7/8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T15.2.2.7">
       8/9
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.2.2.8">
       55/60
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T15.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A3.T15.3.3.1">
       A
       <sup class="ltx_sup" id="A3.T15.3.3.1.1">
        3
       </sup>
       T (Round=2)
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.2">
       12/12
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.3">
       10/10
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.4">
       7/7
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.5">
       13/14
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.6">
       8/8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T15.3.3.7">
       8/9
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T15.3.3.8">
       58/60
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T15.4.4">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A3.T15.4.4.1">
       A
       <sup class="ltx_sup" id="A3.T15.4.4.1.1">
        3
       </sup>
       T (Round=3)
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.2">
       12/12
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.3">
       10/10
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.4">
       7/7
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.5">
       12/14
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.6">
       8/8
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T15.4.4.7">
       7/9
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T15.4.4.8">
       56/60
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 15:
     </span>
     The number of our 1-shot successful / all tasks of each type in our validation split on AlfWorld.
    </figcaption>
   </figure>
   <div class="ltx_para ltx_noindent" id="A3.SS1.p3">
    <p class="ltx_p" id="A3.SS1.p3.2">
     Table
     <a class="ltx_ref" href="#A3.T16" title="Table 16 ‣ C.1 AlfWorld ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       16
      </span>
     </a>
     shows the sentence statistics of the training datasets for each round of LLM finetuning on AlfWorld. The low percentage of the “failed” sentences (which are assigned with
     <math alttext="R(\tau_{f})=-1" class="ltx_Math" display="inline" id="A3.SS1.p3.1.m1.1">
      <semantics id="A3.SS1.p3.1.m1.1a">
       <mrow id="A3.SS1.p3.1.m1.1.1" xref="A3.SS1.p3.1.m1.1.1.cmml">
        <mrow id="A3.SS1.p3.1.m1.1.1.1" xref="A3.SS1.p3.1.m1.1.1.1.cmml">
         <mi id="A3.SS1.p3.1.m1.1.1.1.3" xref="A3.SS1.p3.1.m1.1.1.1.3.cmml">
          R
         </mi>
         <mo id="A3.SS1.p3.1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="A3.SS1.p3.1.m1.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="A3.SS1.p3.1.m1.1.1.1.1.1" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.cmml">
          <mo id="A3.SS1.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msub id="A3.SS1.p3.1.m1.1.1.1.1.1.1" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.cmml">
           <mi id="A3.SS1.p3.1.m1.1.1.1.1.1.1.2" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.2.cmml">
            τ
           </mi>
           <mi id="A3.SS1.p3.1.m1.1.1.1.1.1.1.3" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.3.cmml">
            f
           </mi>
          </msub>
          <mo id="A3.SS1.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="A3.SS1.p3.1.m1.1.1.2" xref="A3.SS1.p3.1.m1.1.1.2.cmml">
         =
        </mo>
        <mrow id="A3.SS1.p3.1.m1.1.1.3" xref="A3.SS1.p3.1.m1.1.1.3.cmml">
         <mo id="A3.SS1.p3.1.m1.1.1.3a" xref="A3.SS1.p3.1.m1.1.1.3.cmml">
          −
         </mo>
         <mn id="A3.SS1.p3.1.m1.1.1.3.2" xref="A3.SS1.p3.1.m1.1.1.3.2.cmml">
          1
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS1.p3.1.m1.1b">
        <apply id="A3.SS1.p3.1.m1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1">
         <eq id="A3.SS1.p3.1.m1.1.1.2.cmml" xref="A3.SS1.p3.1.m1.1.1.2">
         </eq>
         <apply id="A3.SS1.p3.1.m1.1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1.1">
          <times id="A3.SS1.p3.1.m1.1.1.1.2.cmml" xref="A3.SS1.p3.1.m1.1.1.1.2">
          </times>
          <ci id="A3.SS1.p3.1.m1.1.1.1.3.cmml" xref="A3.SS1.p3.1.m1.1.1.1.3">
           𝑅
          </ci>
          <apply id="A3.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="A3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="A3.SS1.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.2">
            𝜏
           </ci>
           <ci id="A3.SS1.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.p3.1.m1.1.1.1.1.1.1.3">
            𝑓
           </ci>
          </apply>
         </apply>
         <apply id="A3.SS1.p3.1.m1.1.1.3.cmml" xref="A3.SS1.p3.1.m1.1.1.3">
          <minus id="A3.SS1.p3.1.m1.1.1.3.1.cmml" xref="A3.SS1.p3.1.m1.1.1.3">
          </minus>
          <cn id="A3.SS1.p3.1.m1.1.1.3.2.cmml" type="integer" xref="A3.SS1.p3.1.m1.1.1.3.2">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS1.p3.1.m1.1c">
        R(\tau_{f})=-1
       </annotation>
      </semantics>
     </math>
     ) in the total training set empirically satisfies the constraint of
     <math alttext="K&gt;1" class="ltx_Math" display="inline" id="A3.SS1.p3.2.m2.1">
      <semantics id="A3.SS1.p3.2.m2.1a">
       <mrow id="A3.SS1.p3.2.m2.1.1" xref="A3.SS1.p3.2.m2.1.1.cmml">
        <mi id="A3.SS1.p3.2.m2.1.1.2" xref="A3.SS1.p3.2.m2.1.1.2.cmml">
         K
        </mi>
        <mo id="A3.SS1.p3.2.m2.1.1.1" xref="A3.SS1.p3.2.m2.1.1.1.cmml">
         &gt;
        </mo>
        <mn id="A3.SS1.p3.2.m2.1.1.3" xref="A3.SS1.p3.2.m2.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS1.p3.2.m2.1b">
        <apply id="A3.SS1.p3.2.m2.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1">
         <gt id="A3.SS1.p3.2.m2.1.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1">
         </gt>
         <ci id="A3.SS1.p3.2.m2.1.1.2.cmml" xref="A3.SS1.p3.2.m2.1.1.2">
          𝐾
         </ci>
         <cn id="A3.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="A3.SS1.p3.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS1.p3.2.m2.1c">
        K&gt;1
       </annotation>
      </semantics>
     </math>
     in Remark 3 of Section
     <a class="ltx_ref" href="#S2.SS2" title="2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2.2
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_table" id="A3.T16">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T16.3">
     <tr class="ltx_tr" id="A3.T16.3.1">
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T16.3.1.1">
       Round
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T16.3.1.2">
       #Total
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T16.3.1.3">
       #Failed
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T16.3.1.4">
       #Failed/#Total (%)
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T16.3.2">
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T16.3.2.1">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T16.3.2.2">
       2,130
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T16.3.2.3">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T16.3.2.4">
       0.0
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T16.3.3">
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T16.3.3.1">
       1
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.3.2">
       2,669
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.3.3">
       99
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.3.4">
       3.7
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T16.3.4">
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T16.3.4.1">
       2
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.4.2">
       4,066
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.4.3">
       177
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T16.3.4.4">
       4.4
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T16.3.5">
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T16.3.5.1">
       3
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T16.3.5.2">
       4,995
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T16.3.5.3">
       219
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T16.3.5.4">
       4.3
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 16:
     </span>
     The sentence statistics of the training datasets for LLM finetuning in each round of our trajectory collection and self-training on AlfWorld. The training set contains 0 sentences with
     <math alttext="-1" class="ltx_Math" display="inline" id="A3.T16.2.m1.1">
      <semantics id="A3.T16.2.m1.1b">
       <mrow id="A3.T16.2.m1.1.1" xref="A3.T16.2.m1.1.1.cmml">
        <mo id="A3.T16.2.m1.1.1b" xref="A3.T16.2.m1.1.1.cmml">
         −
        </mo>
        <mn id="A3.T16.2.m1.1.1.2" xref="A3.T16.2.m1.1.1.2.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.T16.2.m1.1c">
        <apply id="A3.T16.2.m1.1.1.cmml" xref="A3.T16.2.m1.1.1">
         <minus id="A3.T16.2.m1.1.1.1.cmml" xref="A3.T16.2.m1.1.1">
         </minus>
         <cn id="A3.T16.2.m1.1.1.2.cmml" type="integer" xref="A3.T16.2.m1.1.1.2">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.T16.2.m1.1d">
        -1
       </annotation>
      </semantics>
     </math>
     weights for Round 0, as Round 0 performs supervised fine-tuning with ReAct prompting trajectories as bootstrapping. The details of trajectory collection are covered in Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     .
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.2
    </span>
    WebShop
   </h3>
   <div class="ltx_para ltx_noindent" id="A3.SS2.p1">
    <p class="ltx_p" id="A3.SS2.p1.1">
     Table
     <a class="ltx_ref" href="#A3.T17" title="Table 17 ‣ C.2 WebShop ‣ Appendix C Additional Experimental Results ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       17
      </span>
     </a>
     shows the sentence statistics of the training datasets for each round of LLM finetuning on WebShop. The percentage of the “failed” sentences is about 10%, which still satisfies the constraint of
     <math alttext="K&gt;1" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.1">
      <semantics id="A3.SS2.p1.1.m1.1a">
       <mrow id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml">
        <mi id="A3.SS2.p1.1.m1.1.1.2" xref="A3.SS2.p1.1.m1.1.1.2.cmml">
         K
        </mi>
        <mo id="A3.SS2.p1.1.m1.1.1.1" xref="A3.SS2.p1.1.m1.1.1.1.cmml">
         &gt;
        </mo>
        <mn id="A3.SS2.p1.1.m1.1.1.3" xref="A3.SS2.p1.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b">
        <apply id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1">
         <gt id="A3.SS2.p1.1.m1.1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1.1">
         </gt>
         <ci id="A3.SS2.p1.1.m1.1.1.2.cmml" xref="A3.SS2.p1.1.m1.1.1.2">
          𝐾
         </ci>
         <cn id="A3.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A3.SS2.p1.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">
        K&gt;1
       </annotation>
      </semantics>
     </math>
     in Remark 3 of Section
     <a class="ltx_ref" href="#S2.SS2" title="2.2 Contrastive Self-Training ‣ 2 A3T for Closed-Loop Self-Improvement ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       2.2
      </span>
     </a>
     empirically with stable training.
    </p>
   </div>
   <figure class="ltx_table" id="A3.T17">
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T17.1">
     <tr class="ltx_tr" id="A3.T17.1.1">
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A3.T17.1.1.1">
       Round
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T17.1.1.2">
       #Total
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T17.1.1.3">
       #Failed
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T17.1.1.4">
       #Failed/#Total (%)
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T17.1.2">
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T17.1.2.1">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T17.1.2.2">
       981
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T17.1.2.3">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T17.1.2.4">
       0.0
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T17.1.3">
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T17.1.3.1">
       1
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.3.2">
       3,431
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.3.3">
       336
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.3.4">
       9.8
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T17.1.4">
      <td class="ltx_td ltx_align_center ltx_border_r" id="A3.T17.1.4.1">
       2
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.4.2">
       5,719
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.4.3">
       694
      </td>
      <td class="ltx_td ltx_align_center" id="A3.T17.1.4.4">
       12.1
      </td>
     </tr>
     <tr class="ltx_tr" id="A3.T17.1.5">
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T17.1.5.1">
       3
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T17.1.5.2">
       8,550
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T17.1.5.3">
       1,122
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T17.1.5.4">
       13.1
      </td>
     </tr>
    </table>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      Table 17:
     </span>
     The sentence statistics of the training datasets for Mistral-7B-Instruct-v0.2 finetuning in each round of our trajectory collection and self-training on WebShop. Round 0 corresponds with supervised fine-tuning with ReAct trajectories, and thus uses no failed sentences. The details of trajectory collection are covered in Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ ReAct Meets ActRe: When Language Agents Enjoy Training Data Autonomy">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     .
    </figcaption>
   </figure>
  </section>
 </section>
</article>
