<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2203.02985] Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering</title><meta property="og:description" content="Knowledge-based visual question answering (VQA) is a vision-language task that requires an agent to correctly answer image-related questions using knowledge that is not presented in the given image. It is not only a mo…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2203.02985">

<!--Generated on Thu Feb 29 04:28:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Mingxiao Li<sup id="id1.1.id1" class="ltx_sup">1</sup>,
Marie-Francine Moens<sup id="id2.2.id2" class="ltx_sup">1</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Knowledge-based visual question answering (VQA) is a vision-language task that requires an agent to correctly answer image-related questions using knowledge that is not presented in the given image. It is not only a more challenging task than regular VQA but also a vital step towards building a general VQA system. Most existing knowledge-based VQA systems process knowledge and image information similarly and ignore the fact that the knowledge base (KB) contains complete information about a triplet, while the extracted image information might be incomplete as the relations between two objects are missing or wrongly detected. In this paper, we propose a novel model named dynamic knowledge memory enhanced multi-step graph reasoning (DMMGR), which performs explicit and implicit reasoning over a key-value knowledge memory module and a spatial-aware image graph, respectively. Specifically, the memory module learns a dynamic knowledge representation and generates a knowledge-aware question representation at each reasoning step. Then, this representation is used to guide a graph attention operator over the spatial-aware image graph. Our model achieves new state-of-the-art accuracy on the KRVQR and FVQA datasets. We also conduct ablation experiments to prove the effectiveness of each component of the proposed model.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The code is released on: https://github.com/Mingxiao-Li/DMMGR</span></span></span></p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Over the past few years, the domain of visual question answering (VQA) <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib3" title="" class="ltx_ref">2015</a>)</cite> has attracted great attention and witnessed significant progress <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib3" title="" class="ltx_ref">2015</a>; Lu et al. <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Hudson and Manning <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. However, most VQA models cannot answer questions that require external knowledge beyond what is provided in the image. Considering the top example in Figure 1, the question is ”What is the relation between the object that belongs to the category of eukaryotes and the fork in the image?”. To correctly answer this question, it is necessary to both understand the visible content in the image and incorporate the external knowledge that a cucumber belongs to the biological category of eukaryotes. When facing such challenging questions, we humans can easily combine the image content with general knowledge that is required for answering this question, while many current VQA models fail due to their incapability to utilize external knowledge.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">To bridge this gap between human behavior and current VQA models, several knowledge-based VQA datasets have been proposed. <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> introduced the ”fact-based VQA (FVQA)” task and developed the first KVQA dataset containing images, questions with answers and a knowledge base (KB) of fact triplets extracted from different sources including ConceptNET <cite class="ltx_cite ltx_citemacro_citep">(Speer, Chin, and Havasi <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite>, WebChild <cite class="ltx_cite ltx_citemacro_citep">(Tandon et al. <a href="#bib.bib28" title="" class="ltx_ref">2014</a>)</cite> and DBPedia <cite class="ltx_cite ltx_citemacro_citep">(Auer et al. <a href="#bib.bib4" title="" class="ltx_ref">2007</a>)</cite>. Recently, <cite class="ltx_cite ltx_citemacro_citet">Cao et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> introduced the first large-scale knowledge-based VQA dataset: Knowledge-routed VQA (KRVQR) that contains a KB for answering the questions. In this work, we mainly focus on the KRVQR dataset and also test our model on the FVQA dataset. Other VQA datasets that require external knowledge exist <cite class="ltx_cite ltx_citemacro_citep">(Marino et al. <a href="#bib.bib16" title="" class="ltx_ref">2019</a>; Jain et al. <a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> but here the task is to search for external knowledge, which is not the scope of this work.</p>
</div>
<figure id="Sx1.F1" class="ltx_figure"><img src="/html/2203.02985/assets/img/example2.png" id="Sx1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="314" height="189" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Two examples taken from the KRVQR dataset. To correctly answer the question in the image, the model should be able to utilize supporting facts which cannot be seen in the image.
</figcaption>
</figure>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Graph-based approaches <cite class="ltx_cite ltx_citemacro_citep">(Narasimhan, Lazebnik, and Schwing <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite> have achieved successes in the field of knowledge VQA. They use one or several graphs to represent the information sources and conduct cross-graph learning or different fusion methods to infer the answer to the given question. However, they either suffer from the drawbacks of ignoring the dynamics of multi-step reasoning, or from performing an identical reasoning procedure for both the knowledge facts and the image. Such approaches neglect that the knowledge facts provide the explicit information of a triplet, while the image graph contains only implicit information about the image.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">In this work, we propose the DMMGR or <span id="Sx1.p4.1.1" class="ltx_text ltx_font_bold">D</span>ynamic knowledge <span id="Sx1.p4.1.2" class="ltx_text ltx_font_bold">M</span>emory enhanced <span id="Sx1.p4.1.3" class="ltx_text ltx_font_bold">M</span>ulti-step <span id="Sx1.p4.1.4" class="ltx_text ltx_font_bold">G</span>raph <span id="Sx1.p4.1.5" class="ltx_text ltx_font_bold">R</span>easoning model, which performs explicit and implicit reasoning over a KB and a spatial-aware image graph, respectively. Specifically, we see the reasoning over the knowledge base as a problem of performing key addressing and value reading over a key-value memory and propose a novel dynamic key-value knowledge memory module to learn a question-aware knowledge representation at each reasoning step. This is different from previous key-value memory networks <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>; Xu et al. <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite> whose key is the subject and relation of a triplet and value is the object.Our proposed module dynamically learns a question representation that can reason about the subject, relation and object of a knowledge triplet. We depict the image as a spatial-aware image graph where the nodes are the embeddings of the objects detected using Faster-RCNN <cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib25" title="" class="ltx_ref">2015</a>)</cite> and the edges are embeddings of their relative positions. Inspired by <cite class="ltx_cite ltx_citemacro_citep">(Gu et al. <a href="#bib.bib9" title="" class="ltx_ref">2019</a>; Zareian, Karaman, and Chang <a href="#bib.bib39" title="" class="ltx_ref">2020</a>)</cite> who leveraged common sense knowledge for scene graph generation, we use a knowledge-aware question representation, which is learned by applying explicit reasoning over the knowledge memory. This question representation performs implicit reasoning over the spatial-aware image graph. DMMGR thus implements multi-step reasoning by iteratively performing explicit reasoning over the dynamic knowledge memory and implicit reasoning over the spatial-aware image graph.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">In summary, the main contributions of this paper are as follows, (1) We propose a novel dynamic knowledge memory module that learns a representation of knowledge triplets and generates a knowledge-aware question representation. (2) We introduce a question and knowledge guided graph reasoning module, where we use the representation of related knowledge triplets to guide the reasoning over a sparse spatial-aware image graph. (3) We perform an ablation study to verify the contribution of each model component, and attention visualization shows that our model has good interpretability.</p>
</div>
<figure id="Sx1.F2" class="ltx_figure"><img src="/html/2203.02985/assets/img/model.png" id="Sx1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1196" height="477" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The architecture of our proposed DMMGR model. The module specialized in iterative reasoning consists of two components: Dynamic memory reading aimed at reading question related knowledge from the retrieved knowledge facts and resulting in a knowledge-aware question representation, and the spatial-aware image graph reasoning which performs a question and knowledge guided graph attention operation to infer the image information that is required to answer the question.</figcaption>
</figure>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Visual Question Answering</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">The VQA task, where a VQA agent is expected to correctly answer a question related to an image, was proposed by <cite class="ltx_cite ltx_citemacro_citet">Antol et al. (<a href="#bib.bib3" title="" class="ltx_ref">2015</a>)</cite>. Most of the early VQA models <cite class="ltx_cite ltx_citemacro_citep">(Antol et al. <a href="#bib.bib3" title="" class="ltx_ref">2015</a>; Andreas et al. <a href="#bib.bib2" title="" class="ltx_ref">2016</a>; Ben-younes et al. <a href="#bib.bib5" title="" class="ltx_ref">2017</a>; Fukui et al. <a href="#bib.bib8" title="" class="ltx_ref">2016</a>; Lu et al. <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Ma, Lu, and Li <a href="#bib.bib15" title="" class="ltx_ref">2016</a>)</cite> integrate a CNN-RNN based architecture that fuses the RNN encoding of the question and the CNN encoding of the image to predict the answer, possibly improved by attention mechanisms to highlight the visual objects that are related to the question <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib35" title="" class="ltx_ref">2016</a>; Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>; Lu et al. <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>. Recently, graph neural networks that represent the image as a scene graph, where nodes are objects and edges are relations between two connected objects, has attracted attention in many vision-language tasks including VQA. <cite class="ltx_cite ltx_citemacro_citet">Teney, Liu, and van den Hengel (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite> represented both a language question and an image as two graphs and applied graph attention and an aggregation operator to infer the corresponding answer. <cite class="ltx_cite ltx_citemacro_citet">Hu et al. (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite> used question guided image graph attention to generate a question-aware image graph representation. Different from the aforementioned graph models, <cite class="ltx_cite ltx_citemacro_citet">Norcliffe-Brown, Vafeias, and Parisot (<a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite> proposed a graph learner, where a fully connected image graph whose nodes are region features, and edges represent position information was constructed based on the given question, and this model performs graph convolution and max pooling to predict the answer.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Knowledge-Based VQA</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">Knowledge-based VQA (KVQA) requires the model to use knowledge outside the image to answer questions correctly. Compared to the original VQA task, KVQA is relatively less explored (e.g. <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib32" title="" class="ltx_ref">2017</a>); Marino et al. (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>)
<cite class="ltx_cite ltx_citemacro_citet">Narasimhan, Lazebnik, and Schwing (<a href="#bib.bib18" title="" class="ltx_ref">2018</a>)</cite> have first introduced a graph based approach to KVQA and apply a graph convolution to the fact graph to infer the answer, while <cite class="ltx_cite ltx_citemacro_citet">Ziaeefard and Lécué (<a href="#bib.bib41" title="" class="ltx_ref">2020</a>)</cite> use graph attention and multimodal fusion to reason over both the image graph and fact graph. Another work <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite> depicts an image as three graphs: a semantic graph built on the results of dense captioning of image regions, a fact graph representing relevant knowledge triplets, and a fully connected image graph where nodes represent region features, and iteratively perform question guided inter- and intra-graph attention to answer the question. In contrast, we use a dynamic key-value memory to represent the triplets and use a sparse spatial-aware image graph whose nodes are the object category embeddings, and edges are the relative position embeddings of two objects. As an extension of our proposed model, we have evaluated the integration of a semantic graph based on dense captioning of the image regions.</p>
</div>
</section>
<section id="Sx2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Key-value Memory Networks</h3>

<div id="Sx2.SSx3.p1" class="ltx_para">
<p id="Sx2.SSx3.p1.1" class="ltx_p">A key-value memory network <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite> is seen as an extension of a memory network, <cite class="ltx_cite ltx_citemacro_citep">(Weston, Chopra, and Bordes <a href="#bib.bib33" title="" class="ltx_ref">2014</a>; Sukhbaatar et al. <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite>. However, different from memory networks, key-value memory networks save context as key-value pairs and split the reasoning process into key addressing and value reading. Key-value memory networks have been widely used in knowledge triplet-based question answering <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>; Xu et al. <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite>. For a knowledge triplet <math id="Sx2.SSx3.p1.1.m1.1" class="ltx_math_unparsed" alttext="&lt;subject,relation,object&gt;" display="inline"><semantics id="Sx2.SSx3.p1.1.m1.1a"><mrow id="Sx2.SSx3.p1.1.m1.1b"><mo id="Sx2.SSx3.p1.1.m1.1.1">&lt;</mo><mi id="Sx2.SSx3.p1.1.m1.1.2">s</mi><mi id="Sx2.SSx3.p1.1.m1.1.3">u</mi><mi id="Sx2.SSx3.p1.1.m1.1.4">b</mi><mi id="Sx2.SSx3.p1.1.m1.1.5">j</mi><mi id="Sx2.SSx3.p1.1.m1.1.6">e</mi><mi id="Sx2.SSx3.p1.1.m1.1.7">c</mi><mi id="Sx2.SSx3.p1.1.m1.1.8">t</mi><mo id="Sx2.SSx3.p1.1.m1.1.9">,</mo><mi id="Sx2.SSx3.p1.1.m1.1.10">r</mi><mi id="Sx2.SSx3.p1.1.m1.1.11">e</mi><mi id="Sx2.SSx3.p1.1.m1.1.12">l</mi><mi id="Sx2.SSx3.p1.1.m1.1.13">a</mi><mi id="Sx2.SSx3.p1.1.m1.1.14">t</mi><mi id="Sx2.SSx3.p1.1.m1.1.15">i</mi><mi id="Sx2.SSx3.p1.1.m1.1.16">o</mi><mi id="Sx2.SSx3.p1.1.m1.1.17">n</mi><mo id="Sx2.SSx3.p1.1.m1.1.18">,</mo><mi id="Sx2.SSx3.p1.1.m1.1.19">o</mi><mi id="Sx2.SSx3.p1.1.m1.1.20">b</mi><mi id="Sx2.SSx3.p1.1.m1.1.21">j</mi><mi id="Sx2.SSx3.p1.1.m1.1.22">e</mi><mi id="Sx2.SSx3.p1.1.m1.1.23">c</mi><mi id="Sx2.SSx3.p1.1.m1.1.24">t</mi><mo id="Sx2.SSx3.p1.1.m1.1.25">&gt;</mo></mrow><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.1.m1.1c">&lt;subject,relation,object&gt;</annotation></semantics></math>, a key-value memory network saves the subject and relation as a key and the object as a value, which restricts its usage. In this paper, we introduce a dynamic key-value memory module whose key is composed of all the information of a triplet and whose value is a question-aware triplet representation. Such a memory structure is flexible enough so that it can reason about not only the object but also the subject and relation of a knowledge triplet.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Methodology</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.12" class="ltx_p">Given a question <math id="Sx3.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.p1.1.m1.1a"><mi id="Sx3.p1.1.m1.1.1" xref="Sx3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.1.m1.1b"><ci id="Sx3.p1.1.m1.1.1.cmml" xref="Sx3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.1.m1.1c">Q</annotation></semantics></math>, an image <math id="Sx3.p1.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.p1.2.m2.1a"><mi id="Sx3.p1.2.m2.1.1" xref="Sx3.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.2.m2.1b"><ci id="Sx3.p1.2.m2.1.1.cmml" xref="Sx3.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.2.m2.1c">I</annotation></semantics></math> and a KB <math id="Sx3.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx3.p1.3.m3.1a"><mi id="Sx3.p1.3.m3.1.1" xref="Sx3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.3.m3.1b"><ci id="Sx3.p1.3.m3.1.1.cmml" xref="Sx3.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.3.m3.1c">K</annotation></semantics></math> that consists of a set of facts <math id="Sx3.p1.4.m4.4" class="ltx_Math" alttext="{f_{1},f_{2},...,f_{n}}" display="inline"><semantics id="Sx3.p1.4.m4.4a"><mrow id="Sx3.p1.4.m4.4.4.3" xref="Sx3.p1.4.m4.4.4.4.cmml"><msub id="Sx3.p1.4.m4.2.2.1.1" xref="Sx3.p1.4.m4.2.2.1.1.cmml"><mi id="Sx3.p1.4.m4.2.2.1.1.2" xref="Sx3.p1.4.m4.2.2.1.1.2.cmml">f</mi><mn id="Sx3.p1.4.m4.2.2.1.1.3" xref="Sx3.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="Sx3.p1.4.m4.4.4.3.4" xref="Sx3.p1.4.m4.4.4.4.cmml">,</mo><msub id="Sx3.p1.4.m4.3.3.2.2" xref="Sx3.p1.4.m4.3.3.2.2.cmml"><mi id="Sx3.p1.4.m4.3.3.2.2.2" xref="Sx3.p1.4.m4.3.3.2.2.2.cmml">f</mi><mn id="Sx3.p1.4.m4.3.3.2.2.3" xref="Sx3.p1.4.m4.3.3.2.2.3.cmml">2</mn></msub><mo id="Sx3.p1.4.m4.4.4.3.5" xref="Sx3.p1.4.m4.4.4.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.p1.4.m4.1.1" xref="Sx3.p1.4.m4.1.1.cmml">…</mi><mo id="Sx3.p1.4.m4.4.4.3.6" xref="Sx3.p1.4.m4.4.4.4.cmml">,</mo><msub id="Sx3.p1.4.m4.4.4.3.3" xref="Sx3.p1.4.m4.4.4.3.3.cmml"><mi id="Sx3.p1.4.m4.4.4.3.3.2" xref="Sx3.p1.4.m4.4.4.3.3.2.cmml">f</mi><mi id="Sx3.p1.4.m4.4.4.3.3.3" xref="Sx3.p1.4.m4.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p1.4.m4.4b"><list id="Sx3.p1.4.m4.4.4.4.cmml" xref="Sx3.p1.4.m4.4.4.3"><apply id="Sx3.p1.4.m4.2.2.1.1.cmml" xref="Sx3.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.p1.4.m4.2.2.1.1.1.cmml" xref="Sx3.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="Sx3.p1.4.m4.2.2.1.1.2.cmml" xref="Sx3.p1.4.m4.2.2.1.1.2">𝑓</ci><cn type="integer" id="Sx3.p1.4.m4.2.2.1.1.3.cmml" xref="Sx3.p1.4.m4.2.2.1.1.3">1</cn></apply><apply id="Sx3.p1.4.m4.3.3.2.2.cmml" xref="Sx3.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="Sx3.p1.4.m4.3.3.2.2.1.cmml" xref="Sx3.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="Sx3.p1.4.m4.3.3.2.2.2.cmml" xref="Sx3.p1.4.m4.3.3.2.2.2">𝑓</ci><cn type="integer" id="Sx3.p1.4.m4.3.3.2.2.3.cmml" xref="Sx3.p1.4.m4.3.3.2.2.3">2</cn></apply><ci id="Sx3.p1.4.m4.1.1.cmml" xref="Sx3.p1.4.m4.1.1">…</ci><apply id="Sx3.p1.4.m4.4.4.3.3.cmml" xref="Sx3.p1.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="Sx3.p1.4.m4.4.4.3.3.1.cmml" xref="Sx3.p1.4.m4.4.4.3.3">subscript</csymbol><ci id="Sx3.p1.4.m4.4.4.3.3.2.cmml" xref="Sx3.p1.4.m4.4.4.3.3.2">𝑓</ci><ci id="Sx3.p1.4.m4.4.4.3.3.3.cmml" xref="Sx3.p1.4.m4.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.4.m4.4c">{f_{1},f_{2},...,f_{n}}</annotation></semantics></math>, a KVQA model aims to predict the answer <math id="Sx3.p1.5.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="Sx3.p1.5.m5.1a"><mi id="Sx3.p1.5.m5.1.1" xref="Sx3.p1.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.5.m5.1b"><ci id="Sx3.p1.5.m5.1.1.cmml" xref="Sx3.p1.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.5.m5.1c">A</annotation></semantics></math> to <math id="Sx3.p1.6.m6.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.p1.6.m6.1a"><mi id="Sx3.p1.6.m6.1.1" xref="Sx3.p1.6.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.6.m6.1b"><ci id="Sx3.p1.6.m6.1.1.cmml" xref="Sx3.p1.6.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.6.m6.1c">Q</annotation></semantics></math> by reasoning over the image and the KB. Each fact is represented as a resource description framework (RDF) triplet of the form <math id="Sx3.p1.7.m7.3" class="ltx_Math" alttext="f_{i}=(e_{1},r,e_{2})" display="inline"><semantics id="Sx3.p1.7.m7.3a"><mrow id="Sx3.p1.7.m7.3.3" xref="Sx3.p1.7.m7.3.3.cmml"><msub id="Sx3.p1.7.m7.3.3.4" xref="Sx3.p1.7.m7.3.3.4.cmml"><mi id="Sx3.p1.7.m7.3.3.4.2" xref="Sx3.p1.7.m7.3.3.4.2.cmml">f</mi><mi id="Sx3.p1.7.m7.3.3.4.3" xref="Sx3.p1.7.m7.3.3.4.3.cmml">i</mi></msub><mo id="Sx3.p1.7.m7.3.3.3" xref="Sx3.p1.7.m7.3.3.3.cmml">=</mo><mrow id="Sx3.p1.7.m7.3.3.2.2" xref="Sx3.p1.7.m7.3.3.2.3.cmml"><mo stretchy="false" id="Sx3.p1.7.m7.3.3.2.2.3" xref="Sx3.p1.7.m7.3.3.2.3.cmml">(</mo><msub id="Sx3.p1.7.m7.2.2.1.1.1" xref="Sx3.p1.7.m7.2.2.1.1.1.cmml"><mi id="Sx3.p1.7.m7.2.2.1.1.1.2" xref="Sx3.p1.7.m7.2.2.1.1.1.2.cmml">e</mi><mn id="Sx3.p1.7.m7.2.2.1.1.1.3" xref="Sx3.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.p1.7.m7.3.3.2.2.4" xref="Sx3.p1.7.m7.3.3.2.3.cmml">,</mo><mi id="Sx3.p1.7.m7.1.1" xref="Sx3.p1.7.m7.1.1.cmml">r</mi><mo id="Sx3.p1.7.m7.3.3.2.2.5" xref="Sx3.p1.7.m7.3.3.2.3.cmml">,</mo><msub id="Sx3.p1.7.m7.3.3.2.2.2" xref="Sx3.p1.7.m7.3.3.2.2.2.cmml"><mi id="Sx3.p1.7.m7.3.3.2.2.2.2" xref="Sx3.p1.7.m7.3.3.2.2.2.2.cmml">e</mi><mn id="Sx3.p1.7.m7.3.3.2.2.2.3" xref="Sx3.p1.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="Sx3.p1.7.m7.3.3.2.2.6" xref="Sx3.p1.7.m7.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p1.7.m7.3b"><apply id="Sx3.p1.7.m7.3.3.cmml" xref="Sx3.p1.7.m7.3.3"><eq id="Sx3.p1.7.m7.3.3.3.cmml" xref="Sx3.p1.7.m7.3.3.3"></eq><apply id="Sx3.p1.7.m7.3.3.4.cmml" xref="Sx3.p1.7.m7.3.3.4"><csymbol cd="ambiguous" id="Sx3.p1.7.m7.3.3.4.1.cmml" xref="Sx3.p1.7.m7.3.3.4">subscript</csymbol><ci id="Sx3.p1.7.m7.3.3.4.2.cmml" xref="Sx3.p1.7.m7.3.3.4.2">𝑓</ci><ci id="Sx3.p1.7.m7.3.3.4.3.cmml" xref="Sx3.p1.7.m7.3.3.4.3">𝑖</ci></apply><vector id="Sx3.p1.7.m7.3.3.2.3.cmml" xref="Sx3.p1.7.m7.3.3.2.2"><apply id="Sx3.p1.7.m7.2.2.1.1.1.cmml" xref="Sx3.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.p1.7.m7.2.2.1.1.1.1.cmml" xref="Sx3.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="Sx3.p1.7.m7.2.2.1.1.1.2.cmml" xref="Sx3.p1.7.m7.2.2.1.1.1.2">𝑒</ci><cn type="integer" id="Sx3.p1.7.m7.2.2.1.1.1.3.cmml" xref="Sx3.p1.7.m7.2.2.1.1.1.3">1</cn></apply><ci id="Sx3.p1.7.m7.1.1.cmml" xref="Sx3.p1.7.m7.1.1">𝑟</ci><apply id="Sx3.p1.7.m7.3.3.2.2.2.cmml" xref="Sx3.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.p1.7.m7.3.3.2.2.2.1.cmml" xref="Sx3.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="Sx3.p1.7.m7.3.3.2.2.2.2.cmml" xref="Sx3.p1.7.m7.3.3.2.2.2.2">𝑒</ci><cn type="integer" id="Sx3.p1.7.m7.3.3.2.2.2.3.cmml" xref="Sx3.p1.7.m7.3.3.2.2.2.3">2</cn></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.7.m7.3c">f_{i}=(e_{1},r,e_{2})</annotation></semantics></math>, where <math id="Sx3.p1.8.m8.1" class="ltx_Math" alttext="e_{1}" display="inline"><semantics id="Sx3.p1.8.m8.1a"><msub id="Sx3.p1.8.m8.1.1" xref="Sx3.p1.8.m8.1.1.cmml"><mi id="Sx3.p1.8.m8.1.1.2" xref="Sx3.p1.8.m8.1.1.2.cmml">e</mi><mn id="Sx3.p1.8.m8.1.1.3" xref="Sx3.p1.8.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.p1.8.m8.1b"><apply id="Sx3.p1.8.m8.1.1.cmml" xref="Sx3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.p1.8.m8.1.1.1.cmml" xref="Sx3.p1.8.m8.1.1">subscript</csymbol><ci id="Sx3.p1.8.m8.1.1.2.cmml" xref="Sx3.p1.8.m8.1.1.2">𝑒</ci><cn type="integer" id="Sx3.p1.8.m8.1.1.3.cmml" xref="Sx3.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.8.m8.1c">e_{1}</annotation></semantics></math>, <math id="Sx3.p1.9.m9.1" class="ltx_Math" alttext="e_{2}" display="inline"><semantics id="Sx3.p1.9.m9.1a"><msub id="Sx3.p1.9.m9.1.1" xref="Sx3.p1.9.m9.1.1.cmml"><mi id="Sx3.p1.9.m9.1.1.2" xref="Sx3.p1.9.m9.1.1.2.cmml">e</mi><mn id="Sx3.p1.9.m9.1.1.3" xref="Sx3.p1.9.m9.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.p1.9.m9.1b"><apply id="Sx3.p1.9.m9.1.1.cmml" xref="Sx3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="Sx3.p1.9.m9.1.1.1.cmml" xref="Sx3.p1.9.m9.1.1">subscript</csymbol><ci id="Sx3.p1.9.m9.1.1.2.cmml" xref="Sx3.p1.9.m9.1.1.2">𝑒</ci><cn type="integer" id="Sx3.p1.9.m9.1.1.3.cmml" xref="Sx3.p1.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.9.m9.1c">e_{2}</annotation></semantics></math> are entities and <math id="Sx3.p1.10.m10.1" class="ltx_Math" alttext="r" display="inline"><semantics id="Sx3.p1.10.m10.1a"><mi id="Sx3.p1.10.m10.1.1" xref="Sx3.p1.10.m10.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="Sx3.p1.10.m10.1b"><ci id="Sx3.p1.10.m10.1.1.cmml" xref="Sx3.p1.10.m10.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.10.m10.1c">r</annotation></semantics></math> is the relation between <math id="Sx3.p1.11.m11.1" class="ltx_Math" alttext="e_{1}" display="inline"><semantics id="Sx3.p1.11.m11.1a"><msub id="Sx3.p1.11.m11.1.1" xref="Sx3.p1.11.m11.1.1.cmml"><mi id="Sx3.p1.11.m11.1.1.2" xref="Sx3.p1.11.m11.1.1.2.cmml">e</mi><mn id="Sx3.p1.11.m11.1.1.3" xref="Sx3.p1.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.p1.11.m11.1b"><apply id="Sx3.p1.11.m11.1.1.cmml" xref="Sx3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="Sx3.p1.11.m11.1.1.1.cmml" xref="Sx3.p1.11.m11.1.1">subscript</csymbol><ci id="Sx3.p1.11.m11.1.1.2.cmml" xref="Sx3.p1.11.m11.1.1.2">𝑒</ci><cn type="integer" id="Sx3.p1.11.m11.1.1.3.cmml" xref="Sx3.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.11.m11.1c">e_{1}</annotation></semantics></math> and <math id="Sx3.p1.12.m12.1" class="ltx_Math" alttext="e_{2}" display="inline"><semantics id="Sx3.p1.12.m12.1a"><msub id="Sx3.p1.12.m12.1.1" xref="Sx3.p1.12.m12.1.1.cmml"><mi id="Sx3.p1.12.m12.1.1.2" xref="Sx3.p1.12.m12.1.1.2.cmml">e</mi><mn id="Sx3.p1.12.m12.1.1.3" xref="Sx3.p1.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.p1.12.m12.1b"><apply id="Sx3.p1.12.m12.1.1.cmml" xref="Sx3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="Sx3.p1.12.m12.1.1.1.cmml" xref="Sx3.p1.12.m12.1.1">subscript</csymbol><ci id="Sx3.p1.12.m12.1.1.2.cmml" xref="Sx3.p1.12.m12.1.1.2">𝑒</ci><cn type="integer" id="Sx3.p1.12.m12.1.1.3.cmml" xref="Sx3.p1.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p1.12.m12.1c">e_{2}</annotation></semantics></math>. In our model, we first conduct explicit reasoning over the dynamic key-value memory module to extract question related knowledge information. Then we use both extracted knowledge information and the question representation to perform implicit reasoning over the spatial-aware image graph. The complete model is constructed by stacking both the explicit key-value memory reading module and the implicit spatial-aware image graph reasoning module. Figure 2 shows the details of our proposed model.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Key-Value Memory Construction</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.2" class="ltx_p"><span id="Sx3.SSx1.p1.2.1" class="ltx_text ltx_font_bold">Fact Retrieval.</span> To retrieve the relevant facts <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="f_{rel}" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><msub id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.p1.1.m1.1.1.2" xref="Sx3.SSx1.p1.1.m1.1.1.2.cmml">f</mi><mrow id="Sx3.SSx1.p1.1.m1.1.1.3" xref="Sx3.SSx1.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx1.p1.1.m1.1.1.3.2" xref="Sx3.SSx1.p1.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.1.m1.1.1.3.1" xref="Sx3.SSx1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.1.m1.1.1.3.3" xref="Sx3.SSx1.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.1.m1.1.1.3.1a" xref="Sx3.SSx1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.1.m1.1.1.3.4" xref="Sx3.SSx1.p1.1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><apply id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.2">𝑓</ci><apply id="Sx3.SSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3"><times id="Sx3.SSx1.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3.1"></times><ci id="Sx3.SSx1.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3.2">𝑟</ci><ci id="Sx3.SSx1.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="Sx3.SSx1.p1.1.m1.1.1.3.4.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">f_{rel}</annotation></semantics></math> from the KB, we detect the nouns mentioned in the question and the objects in the image using the Stanza natural language processing (NLP) tool <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> and the pretrained Faster-RCNN with RestNet-101 backbone
<cite class="ltx_cite ltx_citemacro_citep">(Ren et al. <a href="#bib.bib25" title="" class="ltx_ref">2015</a>)</cite>, respectively. We then use a pretrained GloVe
word embedding <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib22" title="" class="ltx_ref">2014</a>)</cite> to represent each entity and relation in the knowledge triplet, the nouns in the question and the detected image objects, and sort the triplets based on the average cosine similarity between every word in a triplet and the nouns in the question and detected image objects ignoring pairs with zero average similarity. Finally, the top <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="k=5" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mrow id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p1.2.m2.1.1.2" xref="Sx3.SSx1.p1.2.m2.1.1.2.cmml">k</mi><mo id="Sx3.SSx1.p1.2.m2.1.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.1.cmml">=</mo><mn id="Sx3.SSx1.p1.2.m2.1.1.3" xref="Sx3.SSx1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><apply id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1"><eq id="Sx3.SSx1.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.1"></eq><ci id="Sx3.SSx1.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.2">𝑘</ci><cn type="integer" id="Sx3.SSx1.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">k=5</annotation></semantics></math> facts with the highest average cosine similarity values are retained for predicting the answer to the question.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para ltx_noindent">
<p id="Sx3.SSx1.p2.9" class="ltx_p"><span id="Sx3.SSx1.p2.9.1" class="ltx_text ltx_font_bold">Memory Construction.</span> A factual triplet consists of <math id="Sx3.SSx1.p2.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="Sx3.SSx1.p2.1.m1.1a"><mo id="Sx3.SSx1.p2.1.m1.1.1" xref="Sx3.SSx1.p2.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.m1.1b"><lt id="Sx3.SSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.m1.1c">&lt;</annotation></semantics></math> subject, relation, object <math id="Sx3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx3.SSx1.p2.2.m2.1a"><mo id="Sx3.SSx1.p2.2.m2.1.1" xref="Sx3.SSx1.p2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m2.1b"><gt id="Sx3.SSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m2.1c">&gt;</annotation></semantics></math>, such as <math id="Sx3.SSx1.p2.3.m3.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="Sx3.SSx1.p2.3.m3.1a"><mo id="Sx3.SSx1.p2.3.m3.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m3.1b"><lt id="Sx3.SSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m3.1c">&lt;</annotation></semantics></math> mouse, related to, keyboard <math id="Sx3.SSx1.p2.4.m4.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx3.SSx1.p2.4.m4.1a"><mo id="Sx3.SSx1.p2.4.m4.1.1" xref="Sx3.SSx1.p2.4.m4.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m4.1b"><gt id="Sx3.SSx1.p2.4.m4.1.1.cmml" xref="Sx3.SSx1.p2.4.m4.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m4.1c">&gt;</annotation></semantics></math>. We store the extracted triplets in a key-value memory structure. This is different from previous works <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>; Xu et al. <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite> that take the subject and relation as a key and the object as a value, which strongly limits their usage in reasoning. We use the average embedding of subject, relation and object as key, and the value contains each element of a triplet: <math id="Sx3.SSx1.p2.5.m5.2" class="ltx_Math" alttext="\{F_{f}:[F_{s},F_{r},F_{o}]\}" display="inline"><semantics id="Sx3.SSx1.p2.5.m5.2a"><mrow id="Sx3.SSx1.p2.5.m5.2.2.2" xref="Sx3.SSx1.p2.5.m5.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.2.2.2.3" xref="Sx3.SSx1.p2.5.m5.2.2.3.1.cmml">{</mo><msub id="Sx3.SSx1.p2.5.m5.1.1.1.1" xref="Sx3.SSx1.p2.5.m5.1.1.1.1.cmml"><mi id="Sx3.SSx1.p2.5.m5.1.1.1.1.2" xref="Sx3.SSx1.p2.5.m5.1.1.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.5.m5.1.1.1.1.3" xref="Sx3.SSx1.p2.5.m5.1.1.1.1.3.cmml">f</mi></msub><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p2.5.m5.2.2.2.4" xref="Sx3.SSx1.p2.5.m5.2.2.3.1.cmml">:</mo><mrow id="Sx3.SSx1.p2.5.m5.2.2.2.2.3" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.4" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml">[</mo><msub id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.cmml"><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.2" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.3" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.3.cmml">s</mi></msub><mo id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.5" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml">,</mo><msub id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.cmml"><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.2" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.2.cmml">F</mi><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.3" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.3.cmml">r</mi></msub><mo id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.6" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml">,</mo><msub id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.cmml"><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.2" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.2.cmml">F</mi><mi id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.3" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.3.cmml">o</mi></msub><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.7" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml">]</mo></mrow><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.2.2.2.5" xref="Sx3.SSx1.p2.5.m5.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.5.m5.2b"><apply id="Sx3.SSx1.p2.5.m5.2.2.3.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2"><csymbol cd="latexml" id="Sx3.SSx1.p2.5.m5.2.2.3.1.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.3">conditional-set</csymbol><apply id="Sx3.SSx1.p2.5.m5.1.1.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.1.1.1.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.1.1.1.1.2.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.5.m5.1.1.1.1.3.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.1.1.3">𝑓</ci></apply><list id="Sx3.SSx1.p2.5.m5.2.2.2.2.4.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3"><apply id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.2.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.3.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.1.1.3">𝑠</ci></apply><apply id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.1.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.2">𝐹</ci><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.3.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.2.2.3">𝑟</ci></apply><apply id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.1.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.2.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.2">𝐹</ci><ci id="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.3.cmml" xref="Sx3.SSx1.p2.5.m5.2.2.2.2.3.3.3">𝑜</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.5.m5.2c">\{F_{f}:[F_{s},F_{r},F_{o}]\}</annotation></semantics></math>, where <math id="Sx3.SSx1.p2.6.m6.1" class="ltx_Math" alttext="F_{f}" display="inline"><semantics id="Sx3.SSx1.p2.6.m6.1a"><msub id="Sx3.SSx1.p2.6.m6.1.1" xref="Sx3.SSx1.p2.6.m6.1.1.cmml"><mi id="Sx3.SSx1.p2.6.m6.1.1.2" xref="Sx3.SSx1.p2.6.m6.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.6.m6.1.1.3" xref="Sx3.SSx1.p2.6.m6.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.6.m6.1b"><apply id="Sx3.SSx1.p2.6.m6.1.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.6.m6.1.1.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.6.m6.1.1.2.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.6.m6.1.1.3.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.6.m6.1c">F_{f}</annotation></semantics></math> is the mean GloVe embedding of the words that form an element of the triplet, and <math id="Sx3.SSx1.p2.7.m7.1" class="ltx_Math" alttext="F_{s}" display="inline"><semantics id="Sx3.SSx1.p2.7.m7.1a"><msub id="Sx3.SSx1.p2.7.m7.1.1" xref="Sx3.SSx1.p2.7.m7.1.1.cmml"><mi id="Sx3.SSx1.p2.7.m7.1.1.2" xref="Sx3.SSx1.p2.7.m7.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.7.m7.1.1.3" xref="Sx3.SSx1.p2.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.7.m7.1b"><apply id="Sx3.SSx1.p2.7.m7.1.1.cmml" xref="Sx3.SSx1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.7.m7.1.1.1.cmml" xref="Sx3.SSx1.p2.7.m7.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.7.m7.1.1.2.cmml" xref="Sx3.SSx1.p2.7.m7.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.7.m7.1.1.3.cmml" xref="Sx3.SSx1.p2.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.7.m7.1c">F_{s}</annotation></semantics></math>, <math id="Sx3.SSx1.p2.8.m8.1" class="ltx_Math" alttext="F_{r}" display="inline"><semantics id="Sx3.SSx1.p2.8.m8.1a"><msub id="Sx3.SSx1.p2.8.m8.1.1" xref="Sx3.SSx1.p2.8.m8.1.1.cmml"><mi id="Sx3.SSx1.p2.8.m8.1.1.2" xref="Sx3.SSx1.p2.8.m8.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.8.m8.1.1.3" xref="Sx3.SSx1.p2.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.8.m8.1b"><apply id="Sx3.SSx1.p2.8.m8.1.1.cmml" xref="Sx3.SSx1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.8.m8.1.1.1.cmml" xref="Sx3.SSx1.p2.8.m8.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.8.m8.1.1.2.cmml" xref="Sx3.SSx1.p2.8.m8.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.8.m8.1.1.3.cmml" xref="Sx3.SSx1.p2.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.8.m8.1c">F_{r}</annotation></semantics></math>, <math id="Sx3.SSx1.p2.9.m9.1" class="ltx_Math" alttext="F_{o}" display="inline"><semantics id="Sx3.SSx1.p2.9.m9.1a"><msub id="Sx3.SSx1.p2.9.m9.1.1" xref="Sx3.SSx1.p2.9.m9.1.1.cmml"><mi id="Sx3.SSx1.p2.9.m9.1.1.2" xref="Sx3.SSx1.p2.9.m9.1.1.2.cmml">F</mi><mi id="Sx3.SSx1.p2.9.m9.1.1.3" xref="Sx3.SSx1.p2.9.m9.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.9.m9.1b"><apply id="Sx3.SSx1.p2.9.m9.1.1.cmml" xref="Sx3.SSx1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.9.m9.1.1.1.cmml" xref="Sx3.SSx1.p2.9.m9.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.9.m9.1.1.2.cmml" xref="Sx3.SSx1.p2.9.m9.1.1.2">𝐹</ci><ci id="Sx3.SSx1.p2.9.m9.1.1.3.cmml" xref="Sx3.SSx1.p2.9.m9.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.9.m9.1c">F_{o}</annotation></semantics></math> are the embeddings of the subject, relation and object, respectively. Our proposed key-value structure is capable of providing all information including subject, relation and object of a triplet.</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Visual Spatial-aware Graph Construction</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.16" class="ltx_p">Given an image <math id="Sx3.SSx2.p1.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="Sx3.SSx2.p1.1.m1.1a"><mi id="Sx3.SSx2.p1.1.m1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.1.m1.1b"><ci id="Sx3.SSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.1.m1.1c">I</annotation></semantics></math>, we detect objects in the image and keep the top <math id="Sx3.SSx2.p1.2.m2.1" class="ltx_Math" alttext="r=36" display="inline"><semantics id="Sx3.SSx2.p1.2.m2.1a"><mrow id="Sx3.SSx2.p1.2.m2.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx2.p1.2.m2.1.1.2" xref="Sx3.SSx2.p1.2.m2.1.1.2.cmml">r</mi><mo id="Sx3.SSx2.p1.2.m2.1.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.1.cmml">=</mo><mn id="Sx3.SSx2.p1.2.m2.1.1.3" xref="Sx3.SSx2.p1.2.m2.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.2.m2.1b"><apply id="Sx3.SSx2.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1"><eq id="Sx3.SSx2.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1"></eq><ci id="Sx3.SSx2.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.2">𝑟</ci><cn type="integer" id="Sx3.SSx2.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.2.m2.1c">r=36</annotation></semantics></math> detected objects <math id="Sx3.SSx2.p1.3.m3.1" class="ltx_Math" alttext="O=\{o_{i}\}_{i=1}^{r}" display="inline"><semantics id="Sx3.SSx2.p1.3.m3.1a"><mrow id="Sx3.SSx2.p1.3.m3.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx2.p1.3.m3.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.3.cmml">O</mi><mo id="Sx3.SSx2.p1.3.m3.1.1.2" xref="Sx3.SSx2.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="Sx3.SSx2.p1.3.m3.1.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.1.cmml"><mrow id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Sx3.SSx2.p1.3.m3.1.1.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.cmml"><mi id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.2" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.1" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.3" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx2.p1.3.m3.1.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.1.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.3.m3.1b"><apply id="Sx3.SSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1"><eq id="Sx3.SSx2.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.2"></eq><ci id="Sx3.SSx2.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3">𝑂</ci><apply id="Sx3.SSx2.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.3.m3.1.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1">superscript</csymbol><apply id="Sx3.SSx2.p1.3.m3.1.1.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.3.m3.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1">subscript</csymbol><set id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1"><apply id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.2">𝑜</ci><ci id="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3"><eq id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.1"></eq><ci id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx2.p1.3.m3.1.1.1.1.3.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="Sx3.SSx2.p1.3.m3.1.1.1.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.3.m3.1c">O=\{o_{i}\}_{i=1}^{r}</annotation></semantics></math>. Each object is associated with a label representation <math id="Sx3.SSx2.p1.4.m4.1" class="ltx_Math" alttext="v_{i}\in R^{d_{v}}(d_{v}=300)" display="inline"><semantics id="Sx3.SSx2.p1.4.m4.1a"><mrow id="Sx3.SSx2.p1.4.m4.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.cmml"><msub id="Sx3.SSx2.p1.4.m4.1.1.3" xref="Sx3.SSx2.p1.4.m4.1.1.3.cmml"><mi id="Sx3.SSx2.p1.4.m4.1.1.3.2" xref="Sx3.SSx2.p1.4.m4.1.1.3.2.cmml">v</mi><mi id="Sx3.SSx2.p1.4.m4.1.1.3.3" xref="Sx3.SSx2.p1.4.m4.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.SSx2.p1.4.m4.1.1.2" xref="Sx3.SSx2.p1.4.m4.1.1.2.cmml">∈</mo><mrow id="Sx3.SSx2.p1.4.m4.1.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.1.cmml"><msup id="Sx3.SSx2.p1.4.m4.1.1.1.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.cmml"><mi id="Sx3.SSx2.p1.4.m4.1.1.1.3.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.2.cmml">R</mi><msub id="Sx3.SSx2.p1.4.m4.1.1.1.3.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3.cmml"><mi id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3.2.cmml">d</mi><mi id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3.3.cmml">v</mi></msub></msup><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.4.m4.1.1.1.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.p1.4.m4.1.1.1.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.cmml"><msub id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.cmml"><mi id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.2" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.3.cmml">v</mi></msub><mo id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mn id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.3.cmml">300</mn></mrow><mo stretchy="false" id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.3" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.4.m4.1b"><apply id="Sx3.SSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1"><in id="Sx3.SSx2.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.2"></in><apply id="Sx3.SSx2.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.4.m4.1.1.3.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.3">subscript</csymbol><ci id="Sx3.SSx2.p1.4.m4.1.1.3.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.3.2">𝑣</ci><ci id="Sx3.SSx2.p1.4.m4.1.1.3.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.3.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1"><times id="Sx3.SSx2.p1.4.m4.1.1.1.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.2"></times><apply id="Sx3.SSx2.p1.4.m4.1.1.1.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.4.m4.1.1.1.3.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.p1.4.m4.1.1.1.3.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.2">𝑅</ci><apply id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx2.p1.4.m4.1.1.1.3.3.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.3.3.3">𝑣</ci></apply></apply><apply id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1"><eq id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.1"></eq><apply id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.2">𝑑</ci><ci id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.2.3">𝑣</ci></apply><cn type="integer" id="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1.1.1.1.3">300</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.4.m4.1c">v_{i}\in R^{d_{v}}(d_{v}=300)</annotation></semantics></math> which is the average GloVe embedding <cite class="ltx_cite ltx_citemacro_citep">(Pennington, Socher, and Manning <a href="#bib.bib22" title="" class="ltx_ref">2014</a>)</cite> of the predicted object category, and a spatial vector <math id="Sx3.SSx2.p1.5.m5.1" class="ltx_Math" alttext="b_{i}\in R^{d_{b}}(d_{b}=4)" display="inline"><semantics id="Sx3.SSx2.p1.5.m5.1a"><mrow id="Sx3.SSx2.p1.5.m5.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.cmml"><msub id="Sx3.SSx2.p1.5.m5.1.1.3" xref="Sx3.SSx2.p1.5.m5.1.1.3.cmml"><mi id="Sx3.SSx2.p1.5.m5.1.1.3.2" xref="Sx3.SSx2.p1.5.m5.1.1.3.2.cmml">b</mi><mi id="Sx3.SSx2.p1.5.m5.1.1.3.3" xref="Sx3.SSx2.p1.5.m5.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.SSx2.p1.5.m5.1.1.2" xref="Sx3.SSx2.p1.5.m5.1.1.2.cmml">∈</mo><mrow id="Sx3.SSx2.p1.5.m5.1.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.1.cmml"><msup id="Sx3.SSx2.p1.5.m5.1.1.1.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.cmml"><mi id="Sx3.SSx2.p1.5.m5.1.1.1.3.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.2.cmml">R</mi><msub id="Sx3.SSx2.p1.5.m5.1.1.1.3.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3.cmml"><mi id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3.2.cmml">d</mi><mi id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3.3.cmml">b</mi></msub></msup><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.5.m5.1.1.1.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx2.p1.5.m5.1.1.1.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.cmml"><msub id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.cmml"><mi id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.2" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.1.cmml">=</mo><mn id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.3" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.5.m5.1b"><apply id="Sx3.SSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1"><in id="Sx3.SSx2.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.2"></in><apply id="Sx3.SSx2.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.5.m5.1.1.3.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.3">subscript</csymbol><ci id="Sx3.SSx2.p1.5.m5.1.1.3.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.3.2">𝑏</ci><ci id="Sx3.SSx2.p1.5.m5.1.1.3.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.3.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1"><times id="Sx3.SSx2.p1.5.m5.1.1.1.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.2"></times><apply id="Sx3.SSx2.p1.5.m5.1.1.1.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.5.m5.1.1.1.3.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.p1.5.m5.1.1.1.3.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.2">𝑅</ci><apply id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3.2">𝑑</ci><ci id="Sx3.SSx2.p1.5.m5.1.1.1.3.3.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.3.3.3">𝑏</ci></apply></apply><apply id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1"><eq id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.1"></eq><apply id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.2">𝑑</ci><ci id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.2.3">𝑏</ci></apply><cn type="integer" id="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.5.m5.1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.5.m5.1c">b_{i}\in R^{d_{b}}(d_{b}=4)</annotation></semantics></math> consisting of the coordinates of the top-left and bottom-right corners of the bounding box. The previous work <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>; Hu et al. <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite> use a fully connected spatial-aware image graph, which not only increases the computational cost but also introduces noisy relations between objects, we construct a sparse and <math id="Sx3.SSx2.p1.6.m6.1" class="ltx_Math" alttext="spatial-aware" display="inline"><semantics id="Sx3.SSx2.p1.6.m6.1a"><mrow id="Sx3.SSx2.p1.6.m6.1.1" xref="Sx3.SSx2.p1.6.m6.1.1.cmml"><mrow id="Sx3.SSx2.p1.6.m6.1.1.2" xref="Sx3.SSx2.p1.6.m6.1.1.2.cmml"><mi id="Sx3.SSx2.p1.6.m6.1.1.2.2" xref="Sx3.SSx2.p1.6.m6.1.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.3" xref="Sx3.SSx2.p1.6.m6.1.1.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1a" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.4" xref="Sx3.SSx2.p1.6.m6.1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1b" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.5" xref="Sx3.SSx2.p1.6.m6.1.1.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1c" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.6" xref="Sx3.SSx2.p1.6.m6.1.1.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1d" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.7" xref="Sx3.SSx2.p1.6.m6.1.1.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.2.1e" xref="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.2.8" xref="Sx3.SSx2.p1.6.m6.1.1.2.8.cmml">l</mi></mrow><mo id="Sx3.SSx2.p1.6.m6.1.1.1" xref="Sx3.SSx2.p1.6.m6.1.1.1.cmml">−</mo><mrow id="Sx3.SSx2.p1.6.m6.1.1.3" xref="Sx3.SSx2.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx2.p1.6.m6.1.1.3.2" xref="Sx3.SSx2.p1.6.m6.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.3.1" xref="Sx3.SSx2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.3.3" xref="Sx3.SSx2.p1.6.m6.1.1.3.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.3.1a" xref="Sx3.SSx2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.3.4" xref="Sx3.SSx2.p1.6.m6.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.3.1b" xref="Sx3.SSx2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.3.5" xref="Sx3.SSx2.p1.6.m6.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.6.m6.1.1.3.1c" xref="Sx3.SSx2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.6.m6.1.1.3.6" xref="Sx3.SSx2.p1.6.m6.1.1.3.6.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.6.m6.1b"><apply id="Sx3.SSx2.p1.6.m6.1.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1"><minus id="Sx3.SSx2.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.1"></minus><apply id="Sx3.SSx2.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2"><times id="Sx3.SSx2.p1.6.m6.1.1.2.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.1"></times><ci id="Sx3.SSx2.p1.6.m6.1.1.2.2.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.2">𝑠</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.3.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.3">𝑝</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.4.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.4">𝑎</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.5.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.5">𝑡</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.6.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.6">𝑖</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.7.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.7">𝑎</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.2.8.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.2.8">𝑙</ci></apply><apply id="Sx3.SSx2.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3"><times id="Sx3.SSx2.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.1"></times><ci id="Sx3.SSx2.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.2">𝑎</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.3.3.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.3">𝑤</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.3.4.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.4">𝑎</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.3.5.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.5">𝑟</ci><ci id="Sx3.SSx2.p1.6.m6.1.1.3.6.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.6.m6.1c">spatial-aware</annotation></semantics></math> image graph <math id="Sx3.SSx2.p1.7.m7.2" class="ltx_Math" alttext="G^{V}=\{V^{V},E^{V}\}" display="inline"><semantics id="Sx3.SSx2.p1.7.m7.2a"><mrow id="Sx3.SSx2.p1.7.m7.2.2" xref="Sx3.SSx2.p1.7.m7.2.2.cmml"><msup id="Sx3.SSx2.p1.7.m7.2.2.4" xref="Sx3.SSx2.p1.7.m7.2.2.4.cmml"><mi id="Sx3.SSx2.p1.7.m7.2.2.4.2" xref="Sx3.SSx2.p1.7.m7.2.2.4.2.cmml">G</mi><mi id="Sx3.SSx2.p1.7.m7.2.2.4.3" xref="Sx3.SSx2.p1.7.m7.2.2.4.3.cmml">V</mi></msup><mo id="Sx3.SSx2.p1.7.m7.2.2.3" xref="Sx3.SSx2.p1.7.m7.2.2.3.cmml">=</mo><mrow id="Sx3.SSx2.p1.7.m7.2.2.2.2" xref="Sx3.SSx2.p1.7.m7.2.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.7.m7.2.2.2.2.3" xref="Sx3.SSx2.p1.7.m7.2.2.2.3.cmml">{</mo><msup id="Sx3.SSx2.p1.7.m7.1.1.1.1.1" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.2" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1.2.cmml">V</mi><mi id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.3" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1.3.cmml">V</mi></msup><mo id="Sx3.SSx2.p1.7.m7.2.2.2.2.4" xref="Sx3.SSx2.p1.7.m7.2.2.2.3.cmml">,</mo><msup id="Sx3.SSx2.p1.7.m7.2.2.2.2.2" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2.cmml"><mi id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.2" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2.2.cmml">E</mi><mi id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.3" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2.3.cmml">V</mi></msup><mo stretchy="false" id="Sx3.SSx2.p1.7.m7.2.2.2.2.5" xref="Sx3.SSx2.p1.7.m7.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.7.m7.2b"><apply id="Sx3.SSx2.p1.7.m7.2.2.cmml" xref="Sx3.SSx2.p1.7.m7.2.2"><eq id="Sx3.SSx2.p1.7.m7.2.2.3.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.3"></eq><apply id="Sx3.SSx2.p1.7.m7.2.2.4.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.4"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.7.m7.2.2.4.1.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.4">superscript</csymbol><ci id="Sx3.SSx2.p1.7.m7.2.2.4.2.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.4.2">𝐺</ci><ci id="Sx3.SSx2.p1.7.m7.2.2.4.3.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.4.3">𝑉</ci></apply><set id="Sx3.SSx2.p1.7.m7.2.2.2.3.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.2.2"><apply id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1">superscript</csymbol><ci id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1.2">𝑉</ci><ci id="Sx3.SSx2.p1.7.m7.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.7.m7.1.1.1.1.1.3">𝑉</ci></apply><apply id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2">superscript</csymbol><ci id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2.2">𝐸</ci><ci id="Sx3.SSx2.p1.7.m7.2.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.7.m7.2.2.2.2.2.3">𝑉</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.7.m7.2c">G^{V}=\{V^{V},E^{V}\}</annotation></semantics></math> over the objects <math id="Sx3.SSx2.p1.8.m8.1" class="ltx_Math" alttext="O" display="inline"><semantics id="Sx3.SSx2.p1.8.m8.1a"><mi id="Sx3.SSx2.p1.8.m8.1.1" xref="Sx3.SSx2.p1.8.m8.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.8.m8.1b"><ci id="Sx3.SSx2.p1.8.m8.1.1.cmml" xref="Sx3.SSx2.p1.8.m8.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.8.m8.1c">O</annotation></semantics></math> by connecting only one object with its top-<math id="Sx3.SSx2.p1.9.m9.1" class="ltx_Math" alttext="5" display="inline"><semantics id="Sx3.SSx2.p1.9.m9.1a"><mn id="Sx3.SSx2.p1.9.m9.1.1" xref="Sx3.SSx2.p1.9.m9.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.9.m9.1b"><cn type="integer" id="Sx3.SSx2.p1.9.m9.1.1.cmml" xref="Sx3.SSx2.p1.9.m9.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.9.m9.1c">5</annotation></semantics></math> nearest neighbors. The distance between two objects is the squared distance between the centers of their two bounding boxes. Figure 3 shows an example of how we create this spatial-aware image graph. Each node in the node set <math id="Sx3.SSx2.p1.10.m10.1" class="ltx_Math" alttext="V^{V}=\{v_{i}^{V}\}_{i=1}^{M}" display="inline"><semantics id="Sx3.SSx2.p1.10.m10.1a"><mrow id="Sx3.SSx2.p1.10.m10.1.1" xref="Sx3.SSx2.p1.10.m10.1.1.cmml"><msup id="Sx3.SSx2.p1.10.m10.1.1.3" xref="Sx3.SSx2.p1.10.m10.1.1.3.cmml"><mi id="Sx3.SSx2.p1.10.m10.1.1.3.2" xref="Sx3.SSx2.p1.10.m10.1.1.3.2.cmml">V</mi><mi id="Sx3.SSx2.p1.10.m10.1.1.3.3" xref="Sx3.SSx2.p1.10.m10.1.1.3.3.cmml">V</mi></msup><mo id="Sx3.SSx2.p1.10.m10.1.1.2" xref="Sx3.SSx2.p1.10.m10.1.1.2.cmml">=</mo><msubsup id="Sx3.SSx2.p1.10.m10.1.1.1" xref="Sx3.SSx2.p1.10.m10.1.1.1.cmml"><mrow id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.2" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.2.cmml">{</mo><msubsup id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.2" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.3.cmml">V</mi></msubsup><mo stretchy="false" id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Sx3.SSx2.p1.10.m10.1.1.1.1.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.cmml"><mi id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.2" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.2.cmml">i</mi><mo id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.1" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.1.cmml">=</mo><mn id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx2.p1.10.m10.1.1.1.3" xref="Sx3.SSx2.p1.10.m10.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.10.m10.1b"><apply id="Sx3.SSx2.p1.10.m10.1.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1"><eq id="Sx3.SSx2.p1.10.m10.1.1.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.2"></eq><apply id="Sx3.SSx2.p1.10.m10.1.1.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.10.m10.1.1.3.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.p1.10.m10.1.1.3.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.3.2">𝑉</ci><ci id="Sx3.SSx2.p1.10.m10.1.1.3.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.3.3">𝑉</ci></apply><apply id="Sx3.SSx2.p1.10.m10.1.1.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.10.m10.1.1.1.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1">superscript</csymbol><apply id="Sx3.SSx2.p1.10.m10.1.1.1.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.10.m10.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1">subscript</csymbol><set id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1"><apply id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.1.1.1.3">𝑉</ci></apply></set><apply id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3"><eq id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.1.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.1"></eq><ci id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.2.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx2.p1.10.m10.1.1.1.1.3.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.1.3.3">1</cn></apply></apply><ci id="Sx3.SSx2.p1.10.m10.1.1.1.3.cmml" xref="Sx3.SSx2.p1.10.m10.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.10.m10.1c">V^{V}=\{v_{i}^{V}\}_{i=1}^{M}</annotation></semantics></math> corresponds to a detected object <math id="Sx3.SSx2.p1.11.m11.1" class="ltx_Math" alttext="o_{i}" display="inline"><semantics id="Sx3.SSx2.p1.11.m11.1a"><msub id="Sx3.SSx2.p1.11.m11.1.1" xref="Sx3.SSx2.p1.11.m11.1.1.cmml"><mi id="Sx3.SSx2.p1.11.m11.1.1.2" xref="Sx3.SSx2.p1.11.m11.1.1.2.cmml">o</mi><mi id="Sx3.SSx2.p1.11.m11.1.1.3" xref="Sx3.SSx2.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.11.m11.1b"><apply id="Sx3.SSx2.p1.11.m11.1.1.cmml" xref="Sx3.SSx2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.11.m11.1.1.1.cmml" xref="Sx3.SSx2.p1.11.m11.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.11.m11.1.1.2.cmml" xref="Sx3.SSx2.p1.11.m11.1.1.2">𝑜</ci><ci id="Sx3.SSx2.p1.11.m11.1.1.3.cmml" xref="Sx3.SSx2.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.11.m11.1c">o_{i}</annotation></semantics></math> represented by its label representation, and the edges <math id="Sx3.SSx2.p1.12.m12.1" class="ltx_Math" alttext="e_{ij}^{V}\in E^{V}" display="inline"><semantics id="Sx3.SSx2.p1.12.m12.1a"><mrow id="Sx3.SSx2.p1.12.m12.1.1" xref="Sx3.SSx2.p1.12.m12.1.1.cmml"><msubsup id="Sx3.SSx2.p1.12.m12.1.1.2" xref="Sx3.SSx2.p1.12.m12.1.1.2.cmml"><mi id="Sx3.SSx2.p1.12.m12.1.1.2.2.2" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.2.cmml">e</mi><mrow id="Sx3.SSx2.p1.12.m12.1.1.2.2.3" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.cmml"><mi id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.2" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.1" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.3" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.3.cmml">j</mi></mrow><mi id="Sx3.SSx2.p1.12.m12.1.1.2.3" xref="Sx3.SSx2.p1.12.m12.1.1.2.3.cmml">V</mi></msubsup><mo id="Sx3.SSx2.p1.12.m12.1.1.1" xref="Sx3.SSx2.p1.12.m12.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.p1.12.m12.1.1.3" xref="Sx3.SSx2.p1.12.m12.1.1.3.cmml"><mi id="Sx3.SSx2.p1.12.m12.1.1.3.2" xref="Sx3.SSx2.p1.12.m12.1.1.3.2.cmml">E</mi><mi id="Sx3.SSx2.p1.12.m12.1.1.3.3" xref="Sx3.SSx2.p1.12.m12.1.1.3.3.cmml">V</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.12.m12.1b"><apply id="Sx3.SSx2.p1.12.m12.1.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1"><in id="Sx3.SSx2.p1.12.m12.1.1.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.1"></in><apply id="Sx3.SSx2.p1.12.m12.1.1.2.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.12.m12.1.1.2.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2">superscript</csymbol><apply id="Sx3.SSx2.p1.12.m12.1.1.2.2.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.12.m12.1.1.2.2.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2">subscript</csymbol><ci id="Sx3.SSx2.p1.12.m12.1.1.2.2.2.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.2">𝑒</ci><apply id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3"><times id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.1"></times><ci id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.2.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.2">𝑖</ci><ci id="Sx3.SSx2.p1.12.m12.1.1.2.2.3.3.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.2.3.3">𝑗</ci></apply></apply><ci id="Sx3.SSx2.p1.12.m12.1.1.2.3.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.2.3">𝑉</ci></apply><apply id="Sx3.SSx2.p1.12.m12.1.1.3.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.12.m12.1.1.3.1.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.p1.12.m12.1.1.3.2.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.3.2">𝐸</ci><ci id="Sx3.SSx2.p1.12.m12.1.1.3.3.cmml" xref="Sx3.SSx2.p1.12.m12.1.1.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.12.m12.1c">e_{ij}^{V}\in E^{V}</annotation></semantics></math> denote the relations between pairs of objects. We use a 5-dimensional relative spatial vector <math id="Sx3.SSx2.p1.13.m13.5" class="ltx_Math" alttext="r_{ij}^{V}=[\frac{x_{i}^{c}-x_{j}^{c}}{\sqrt{w_{i}h_{i}}},\frac{y_{i}^{c}-y_{j}^{c}}{\sqrt{w_{i}h_{i}}},\frac{w_{j}}{w_{i}},\frac{h_{j}}{h_{i}},\frac{w_{j}h_{j}}{w_{i}h_{i}}]" display="inline"><semantics id="Sx3.SSx2.p1.13.m13.5a"><mrow id="Sx3.SSx2.p1.13.m13.5.6" xref="Sx3.SSx2.p1.13.m13.5.6.cmml"><msubsup id="Sx3.SSx2.p1.13.m13.5.6.2" xref="Sx3.SSx2.p1.13.m13.5.6.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.6.2.2.2" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.2.cmml">r</mi><mrow id="Sx3.SSx2.p1.13.m13.5.6.2.2.3" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.2" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.1" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.1.cmml">​</mo><mi id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.3" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.3.cmml">j</mi></mrow><mi id="Sx3.SSx2.p1.13.m13.5.6.2.3" xref="Sx3.SSx2.p1.13.m13.5.6.2.3.cmml">V</mi></msubsup><mo id="Sx3.SSx2.p1.13.m13.5.6.1" xref="Sx3.SSx2.p1.13.m13.5.6.1.cmml">=</mo><mrow id="Sx3.SSx2.p1.13.m13.5.6.3.2" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.13.m13.5.6.3.2.1" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">[</mo><mfrac id="Sx3.SSx2.p1.13.m13.1.1" xref="Sx3.SSx2.p1.13.m13.1.1.cmml"><mrow id="Sx3.SSx2.p1.13.m13.1.1.2" xref="Sx3.SSx2.p1.13.m13.1.1.2.cmml"><msubsup id="Sx3.SSx2.p1.13.m13.1.1.2.2" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.2" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.2.2.cmml">x</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.2.3.cmml">i</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.2.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.3.cmml">c</mi></msubsup><mo id="Sx3.SSx2.p1.13.m13.1.1.2.1" xref="Sx3.SSx2.p1.13.m13.1.1.2.1.cmml">−</mo><msubsup id="Sx3.SSx2.p1.13.m13.1.1.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.2" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.2.2.cmml">x</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.2.3.cmml">j</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.2.3.3" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.3.cmml">c</mi></msubsup></mrow><msqrt id="Sx3.SSx2.p1.13.m13.1.1.3" xref="Sx3.SSx2.p1.13.m13.1.1.3.cmml"><mrow id="Sx3.SSx2.p1.13.m13.1.1.3.2" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.cmml"><msub id="Sx3.SSx2.p1.13.m13.1.1.3.2.2" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.2" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.13.m13.1.1.3.2.1" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.1.cmml">​</mo><msub id="Sx3.SSx2.p1.13.m13.1.1.3.2.3" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.2" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.3" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3.3.cmml">i</mi></msub></mrow></msqrt></mfrac><mo id="Sx3.SSx2.p1.13.m13.5.6.3.2.2" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">,</mo><mfrac id="Sx3.SSx2.p1.13.m13.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.cmml"><mrow id="Sx3.SSx2.p1.13.m13.2.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.2.cmml"><msubsup id="Sx3.SSx2.p1.13.m13.2.2.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.2.3.cmml">i</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.2.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.3.cmml">c</mi></msubsup><mo id="Sx3.SSx2.p1.13.m13.2.2.2.1" xref="Sx3.SSx2.p1.13.m13.2.2.2.1.cmml">−</mo><msubsup id="Sx3.SSx2.p1.13.m13.2.2.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.2.2.cmml">y</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.2.3.cmml">j</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.2.3.3" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.3.cmml">c</mi></msubsup></mrow><msqrt id="Sx3.SSx2.p1.13.m13.2.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.3.cmml"><mrow id="Sx3.SSx2.p1.13.m13.2.2.3.2" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.cmml"><msub id="Sx3.SSx2.p1.13.m13.2.2.3.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.2" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.13.m13.2.2.3.2.1" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.1.cmml">​</mo><msub id="Sx3.SSx2.p1.13.m13.2.2.3.2.3" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.2" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.3" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3.3.cmml">i</mi></msub></mrow></msqrt></mfrac><mo id="Sx3.SSx2.p1.13.m13.5.6.3.2.3" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">,</mo><mfrac id="Sx3.SSx2.p1.13.m13.3.3" xref="Sx3.SSx2.p1.13.m13.3.3.cmml"><msub id="Sx3.SSx2.p1.13.m13.3.3.2" xref="Sx3.SSx2.p1.13.m13.3.3.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.3.3.2.2" xref="Sx3.SSx2.p1.13.m13.3.3.2.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.3.3.2.3" xref="Sx3.SSx2.p1.13.m13.3.3.2.3.cmml">j</mi></msub><msub id="Sx3.SSx2.p1.13.m13.3.3.3" xref="Sx3.SSx2.p1.13.m13.3.3.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.3.3.3.2" xref="Sx3.SSx2.p1.13.m13.3.3.3.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.3.3.3.3" xref="Sx3.SSx2.p1.13.m13.3.3.3.3.cmml">i</mi></msub></mfrac><mo id="Sx3.SSx2.p1.13.m13.5.6.3.2.4" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">,</mo><mfrac id="Sx3.SSx2.p1.13.m13.4.4" xref="Sx3.SSx2.p1.13.m13.4.4.cmml"><msub id="Sx3.SSx2.p1.13.m13.4.4.2" xref="Sx3.SSx2.p1.13.m13.4.4.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.4.4.2.2" xref="Sx3.SSx2.p1.13.m13.4.4.2.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.4.4.2.3" xref="Sx3.SSx2.p1.13.m13.4.4.2.3.cmml">j</mi></msub><msub id="Sx3.SSx2.p1.13.m13.4.4.3" xref="Sx3.SSx2.p1.13.m13.4.4.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.4.4.3.2" xref="Sx3.SSx2.p1.13.m13.4.4.3.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.4.4.3.3" xref="Sx3.SSx2.p1.13.m13.4.4.3.3.cmml">i</mi></msub></mfrac><mo id="Sx3.SSx2.p1.13.m13.5.6.3.2.5" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">,</mo><mfrac id="Sx3.SSx2.p1.13.m13.5.5" xref="Sx3.SSx2.p1.13.m13.5.5.cmml"><mrow id="Sx3.SSx2.p1.13.m13.5.5.2" xref="Sx3.SSx2.p1.13.m13.5.5.2.cmml"><msub id="Sx3.SSx2.p1.13.m13.5.5.2.2" xref="Sx3.SSx2.p1.13.m13.5.5.2.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.5.2.2.2" xref="Sx3.SSx2.p1.13.m13.5.5.2.2.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.5.5.2.2.3" xref="Sx3.SSx2.p1.13.m13.5.5.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.13.m13.5.5.2.1" xref="Sx3.SSx2.p1.13.m13.5.5.2.1.cmml">​</mo><msub id="Sx3.SSx2.p1.13.m13.5.5.2.3" xref="Sx3.SSx2.p1.13.m13.5.5.2.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.5.2.3.2" xref="Sx3.SSx2.p1.13.m13.5.5.2.3.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.5.5.2.3.3" xref="Sx3.SSx2.p1.13.m13.5.5.2.3.3.cmml">j</mi></msub></mrow><mrow id="Sx3.SSx2.p1.13.m13.5.5.3" xref="Sx3.SSx2.p1.13.m13.5.5.3.cmml"><msub id="Sx3.SSx2.p1.13.m13.5.5.3.2" xref="Sx3.SSx2.p1.13.m13.5.5.3.2.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.5.3.2.2" xref="Sx3.SSx2.p1.13.m13.5.5.3.2.2.cmml">w</mi><mi id="Sx3.SSx2.p1.13.m13.5.5.3.2.3" xref="Sx3.SSx2.p1.13.m13.5.5.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx2.p1.13.m13.5.5.3.1" xref="Sx3.SSx2.p1.13.m13.5.5.3.1.cmml">​</mo><msub id="Sx3.SSx2.p1.13.m13.5.5.3.3" xref="Sx3.SSx2.p1.13.m13.5.5.3.3.cmml"><mi id="Sx3.SSx2.p1.13.m13.5.5.3.3.2" xref="Sx3.SSx2.p1.13.m13.5.5.3.3.2.cmml">h</mi><mi id="Sx3.SSx2.p1.13.m13.5.5.3.3.3" xref="Sx3.SSx2.p1.13.m13.5.5.3.3.3.cmml">i</mi></msub></mrow></mfrac><mo stretchy="false" id="Sx3.SSx2.p1.13.m13.5.6.3.2.6" xref="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.13.m13.5b"><apply id="Sx3.SSx2.p1.13.m13.5.6.cmml" xref="Sx3.SSx2.p1.13.m13.5.6"><eq id="Sx3.SSx2.p1.13.m13.5.6.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.1"></eq><apply id="Sx3.SSx2.p1.13.m13.5.6.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.6.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2">superscript</csymbol><apply id="Sx3.SSx2.p1.13.m13.5.6.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.6.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.5.6.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.2">𝑟</ci><apply id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3"><times id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.1"></times><ci id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.2">𝑖</ci><ci id="Sx3.SSx2.p1.13.m13.5.6.2.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.2.3.3">𝑗</ci></apply></apply><ci id="Sx3.SSx2.p1.13.m13.5.6.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.2.3">𝑉</ci></apply><list id="Sx3.SSx2.p1.13.m13.5.6.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.6.3.2"><apply id="Sx3.SSx2.p1.13.m13.1.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1"><divide id="Sx3.SSx2.p1.13.m13.1.1.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1"></divide><apply id="Sx3.SSx2.p1.13.m13.1.1.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2"><minus id="Sx3.SSx2.p1.13.m13.1.1.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.1"></minus><apply id="Sx3.SSx2.p1.13.m13.1.1.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2">superscript</csymbol><apply id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.2.2">𝑥</ci><ci id="Sx3.SSx2.p1.13.m13.1.1.2.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx2.p1.13.m13.1.1.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.2.3">𝑐</ci></apply><apply id="Sx3.SSx2.p1.13.m13.1.1.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3">superscript</csymbol><apply id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.2.2">𝑥</ci><ci id="Sx3.SSx2.p1.13.m13.1.1.2.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.2.3">𝑗</ci></apply><ci id="Sx3.SSx2.p1.13.m13.1.1.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.2.3.3">𝑐</ci></apply></apply><apply id="Sx3.SSx2.p1.13.m13.1.1.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3"><root id="Sx3.SSx2.p1.13.m13.1.1.3a.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3"></root><apply id="Sx3.SSx2.p1.13.m13.1.1.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2"><times id="Sx3.SSx2.p1.13.m13.1.1.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.1"></times><apply id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.1.1.3.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.2.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.1.1.3.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="Sx3.SSx2.p1.13.m13.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2"><divide id="Sx3.SSx2.p1.13.m13.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2"></divide><apply id="Sx3.SSx2.p1.13.m13.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2"><minus id="Sx3.SSx2.p1.13.m13.2.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.1"></minus><apply id="Sx3.SSx2.p1.13.m13.2.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2">superscript</csymbol><apply id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.2.2">𝑦</ci><ci id="Sx3.SSx2.p1.13.m13.2.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx2.p1.13.m13.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.2.3">𝑐</ci></apply><apply id="Sx3.SSx2.p1.13.m13.2.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3">superscript</csymbol><apply id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.2.2">𝑦</ci><ci id="Sx3.SSx2.p1.13.m13.2.2.2.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.2.3">𝑗</ci></apply><ci id="Sx3.SSx2.p1.13.m13.2.2.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.2.3.3">𝑐</ci></apply></apply><apply id="Sx3.SSx2.p1.13.m13.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3"><root id="Sx3.SSx2.p1.13.m13.2.2.3a.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3"></root><apply id="Sx3.SSx2.p1.13.m13.2.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2"><times id="Sx3.SSx2.p1.13.m13.2.2.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.1"></times><apply id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.2.2.3.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.2.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.2.2.3.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="Sx3.SSx2.p1.13.m13.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.3.3"><divide id="Sx3.SSx2.p1.13.m13.3.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.3.3"></divide><apply id="Sx3.SSx2.p1.13.m13.3.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.3.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.3.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.2.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.3.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.2.3">𝑗</ci></apply><apply id="Sx3.SSx2.p1.13.m13.3.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.3.3.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.3.3.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.3.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.3.3.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.3.3.3.3">𝑖</ci></apply></apply><apply id="Sx3.SSx2.p1.13.m13.4.4.cmml" xref="Sx3.SSx2.p1.13.m13.4.4"><divide id="Sx3.SSx2.p1.13.m13.4.4.1.cmml" xref="Sx3.SSx2.p1.13.m13.4.4"></divide><apply id="Sx3.SSx2.p1.13.m13.4.4.2.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.4.4.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.4.4.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.2.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.4.4.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.2.3">𝑗</ci></apply><apply id="Sx3.SSx2.p1.13.m13.4.4.3.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.4.4.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.4.4.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.3.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.4.4.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.4.4.3.3">𝑖</ci></apply></apply><apply id="Sx3.SSx2.p1.13.m13.5.5.cmml" xref="Sx3.SSx2.p1.13.m13.5.5"><divide id="Sx3.SSx2.p1.13.m13.5.5.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5"></divide><apply id="Sx3.SSx2.p1.13.m13.5.5.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2"><times id="Sx3.SSx2.p1.13.m13.5.5.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.1"></times><apply id="Sx3.SSx2.p1.13.m13.5.5.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.5.2.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.5.5.2.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.2.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.5.5.2.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.2.3">𝑗</ci></apply><apply id="Sx3.SSx2.p1.13.m13.5.5.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.5.2.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.5.5.2.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.3.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.5.5.2.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.2.3.3">𝑗</ci></apply></apply><apply id="Sx3.SSx2.p1.13.m13.5.5.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3"><times id="Sx3.SSx2.p1.13.m13.5.5.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.1"></times><apply id="Sx3.SSx2.p1.13.m13.5.5.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.5.3.2.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.2">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.5.5.3.2.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.2.2">𝑤</ci><ci id="Sx3.SSx2.p1.13.m13.5.5.3.2.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.2.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.13.m13.5.5.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.13.m13.5.5.3.3.1.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.13.m13.5.5.3.3.2.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.3.2">ℎ</ci><ci id="Sx3.SSx2.p1.13.m13.5.5.3.3.3.cmml" xref="Sx3.SSx2.p1.13.m13.5.5.3.3.3">𝑖</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.13.m13.5c">r_{ij}^{V}=[\frac{x_{i}^{c}-x_{j}^{c}}{\sqrt{w_{i}h_{i}}},\frac{y_{i}^{c}-y_{j}^{c}}{\sqrt{w_{i}h_{i}}},\frac{w_{j}}{w_{i}},\frac{h_{j}}{h_{i}},\frac{w_{j}h_{j}}{w_{i}h_{i}}]</annotation></semantics></math>, where <math id="Sx3.SSx2.p1.14.m14.2" class="ltx_Math" alttext="x_{i}^{c},y_{i}^{c}" display="inline"><semantics id="Sx3.SSx2.p1.14.m14.2a"><mrow id="Sx3.SSx2.p1.14.m14.2.2.2" xref="Sx3.SSx2.p1.14.m14.2.2.3.cmml"><msubsup id="Sx3.SSx2.p1.14.m14.1.1.1.1" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.2" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.3" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.SSx2.p1.14.m14.1.1.1.1.3" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.3.cmml">c</mi></msubsup><mo id="Sx3.SSx2.p1.14.m14.2.2.2.3" xref="Sx3.SSx2.p1.14.m14.2.2.3.cmml">,</mo><msubsup id="Sx3.SSx2.p1.14.m14.2.2.2.2" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.cmml"><mi id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.2" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.2.2.cmml">y</mi><mi id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.3" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.2.3.cmml">i</mi><mi id="Sx3.SSx2.p1.14.m14.2.2.2.2.3" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.3.cmml">c</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.14.m14.2b"><list id="Sx3.SSx2.p1.14.m14.2.2.3.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2"><apply id="Sx3.SSx2.p1.14.m14.1.1.1.1.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.14.m14.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.1.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.2.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.2.2">𝑥</ci><ci id="Sx3.SSx2.p1.14.m14.1.1.1.1.2.3.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.SSx2.p1.14.m14.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.14.m14.1.1.1.1.3">𝑐</ci></apply><apply id="Sx3.SSx2.p1.14.m14.2.2.2.2.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.14.m14.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2">superscript</csymbol><apply id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.2.2">𝑦</ci><ci id="Sx3.SSx2.p1.14.m14.2.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx2.p1.14.m14.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.14.m14.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.14.m14.2c">x_{i}^{c},y_{i}^{c}</annotation></semantics></math> are the center coordinates and <math id="Sx3.SSx2.p1.15.m15.2" class="ltx_Math" alttext="w_{i},h_{i}" display="inline"><semantics id="Sx3.SSx2.p1.15.m15.2a"><mrow id="Sx3.SSx2.p1.15.m15.2.2.2" xref="Sx3.SSx2.p1.15.m15.2.2.3.cmml"><msub id="Sx3.SSx2.p1.15.m15.1.1.1.1" xref="Sx3.SSx2.p1.15.m15.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.15.m15.1.1.1.1.2" xref="Sx3.SSx2.p1.15.m15.1.1.1.1.2.cmml">w</mi><mi id="Sx3.SSx2.p1.15.m15.1.1.1.1.3" xref="Sx3.SSx2.p1.15.m15.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.SSx2.p1.15.m15.2.2.2.3" xref="Sx3.SSx2.p1.15.m15.2.2.3.cmml">,</mo><msub id="Sx3.SSx2.p1.15.m15.2.2.2.2" xref="Sx3.SSx2.p1.15.m15.2.2.2.2.cmml"><mi id="Sx3.SSx2.p1.15.m15.2.2.2.2.2" xref="Sx3.SSx2.p1.15.m15.2.2.2.2.2.cmml">h</mi><mi id="Sx3.SSx2.p1.15.m15.2.2.2.2.3" xref="Sx3.SSx2.p1.15.m15.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.15.m15.2b"><list id="Sx3.SSx2.p1.15.m15.2.2.3.cmml" xref="Sx3.SSx2.p1.15.m15.2.2.2"><apply id="Sx3.SSx2.p1.15.m15.1.1.1.1.cmml" xref="Sx3.SSx2.p1.15.m15.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.15.m15.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.15.m15.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.15.m15.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.15.m15.1.1.1.1.2">𝑤</ci><ci id="Sx3.SSx2.p1.15.m15.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.15.m15.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.SSx2.p1.15.m15.2.2.2.2.cmml" xref="Sx3.SSx2.p1.15.m15.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.15.m15.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.15.m15.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.15.m15.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.15.m15.2.2.2.2.2">ℎ</ci><ci id="Sx3.SSx2.p1.15.m15.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.15.m15.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.15.m15.2c">w_{i},h_{i}</annotation></semantics></math> are the width and height of the bounding box of object <math id="Sx3.SSx2.p1.16.m16.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx2.p1.16.m16.1a"><mi id="Sx3.SSx2.p1.16.m16.1.1" xref="Sx3.SSx2.p1.16.m16.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.16.m16.1b"><ci id="Sx3.SSx2.p1.16.m16.1.1.cmml" xref="Sx3.SSx2.p1.16.m16.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.16.m16.1c">i</annotation></semantics></math>, respectively, to encode edge features in the graph.</p>
</div>
<figure id="Sx3.F3" class="ltx_figure"><img src="/html/2203.02985/assets/img/graph.png" id="Sx3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="314" height="211" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>An example of a spatial-aware image graph. We only show the connections between person and its neighbours. There is no connection between person and car as the car is far from the person.</figcaption>
</figure>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Iterative Reasoning Module</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.2" class="ltx_p">Algorithm 1 illustrates the flow of our proposed iterative reasoning module.
The <span id="Sx3.SSx3.p1.2.1" class="ltx_text ltx_markedasmath">;</span> in algorithm 1 denotes the concatenation operation, and <math id="Sx3.SSx3.p1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.1a"><mi id="Sx3.SSx3.p1.2.m2.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><ci id="Sx3.SSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">T</annotation></semantics></math> is the total number of reasoning steps. The details of each module are introduced below.</p>
</div>
<div id="Sx3.SSx3.p2" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p2.4" class="ltx_p"><span id="Sx3.SSx3.p2.4.1" class="ltx_text ltx_font_bold">Question Processing. </span> To enhance the model’s ability to perform multi-step reasoning, we generate a question vector for each reasoning step <math id="Sx3.SSx3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p2.1.m1.1a"><mi id="Sx3.SSx3.p2.1.m1.1.1" xref="Sx3.SSx3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.1.m1.1b"><ci id="Sx3.SSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.1.m1.1c">t</annotation></semantics></math> (where <math id="Sx3.SSx3.p2.2.m2.3" class="ltx_Math" alttext="t=1,\cdots,T" display="inline"><semantics id="Sx3.SSx3.p2.2.m2.3a"><mrow id="Sx3.SSx3.p2.2.m2.3.4" xref="Sx3.SSx3.p2.2.m2.3.4.cmml"><mi id="Sx3.SSx3.p2.2.m2.3.4.2" xref="Sx3.SSx3.p2.2.m2.3.4.2.cmml">t</mi><mo id="Sx3.SSx3.p2.2.m2.3.4.1" xref="Sx3.SSx3.p2.2.m2.3.4.1.cmml">=</mo><mrow id="Sx3.SSx3.p2.2.m2.3.4.3.2" xref="Sx3.SSx3.p2.2.m2.3.4.3.1.cmml"><mn id="Sx3.SSx3.p2.2.m2.1.1" xref="Sx3.SSx3.p2.2.m2.1.1.cmml">1</mn><mo id="Sx3.SSx3.p2.2.m2.3.4.3.2.1" xref="Sx3.SSx3.p2.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx3.p2.2.m2.2.2" xref="Sx3.SSx3.p2.2.m2.2.2.cmml">⋯</mi><mo id="Sx3.SSx3.p2.2.m2.3.4.3.2.2" xref="Sx3.SSx3.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="Sx3.SSx3.p2.2.m2.3.3" xref="Sx3.SSx3.p2.2.m2.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.2.m2.3b"><apply id="Sx3.SSx3.p2.2.m2.3.4.cmml" xref="Sx3.SSx3.p2.2.m2.3.4"><eq id="Sx3.SSx3.p2.2.m2.3.4.1.cmml" xref="Sx3.SSx3.p2.2.m2.3.4.1"></eq><ci id="Sx3.SSx3.p2.2.m2.3.4.2.cmml" xref="Sx3.SSx3.p2.2.m2.3.4.2">𝑡</ci><list id="Sx3.SSx3.p2.2.m2.3.4.3.1.cmml" xref="Sx3.SSx3.p2.2.m2.3.4.3.2"><cn type="integer" id="Sx3.SSx3.p2.2.m2.1.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1">1</cn><ci id="Sx3.SSx3.p2.2.m2.2.2.cmml" xref="Sx3.SSx3.p2.2.m2.2.2">⋯</ci><ci id="Sx3.SSx3.p2.2.m2.3.3.cmml" xref="Sx3.SSx3.p2.2.m2.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.2.m2.3c">t=1,\cdots,T</annotation></semantics></math>). Specifically, the given question <math id="Sx3.SSx3.p2.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="Sx3.SSx3.p2.3.m3.1a"><mi id="Sx3.SSx3.p2.3.m3.1.1" xref="Sx3.SSx3.p2.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.3.m3.1b"><ci id="Sx3.SSx3.p2.3.m3.1.1.cmml" xref="Sx3.SSx3.p2.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.3.m3.1c">Q</annotation></semantics></math> of length <math id="Sx3.SSx3.p2.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx3.SSx3.p2.4.m4.1a"><mi id="Sx3.SSx3.p2.4.m4.1.1" xref="Sx3.SSx3.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.4.m4.1b"><ci id="Sx3.SSx3.p2.4.m4.1.1.cmml" xref="Sx3.SSx3.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.4.m4.1c">S</annotation></semantics></math>
is converted into a sequence of GloVe word embeddings that are further processed by a 2-layer bi-directional long short-term memory (LSTM) module to generate a sequence of contextually aware word representations:</p>
<table id="Sx3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Sx3.Ex1.m1.5" class="ltx_Math" alttext="[h_{1},h_{2},\cdots,h_{S}]=BiLSTM(Q)" display="block"><semantics id="Sx3.Ex1.m1.5a"><mrow id="Sx3.Ex1.m1.5.5" xref="Sx3.Ex1.m1.5.5.cmml"><mrow id="Sx3.Ex1.m1.5.5.3.3" xref="Sx3.Ex1.m1.5.5.3.4.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.5.5.3.3.4" xref="Sx3.Ex1.m1.5.5.3.4.cmml">[</mo><msub id="Sx3.Ex1.m1.3.3.1.1.1" xref="Sx3.Ex1.m1.3.3.1.1.1.cmml"><mi id="Sx3.Ex1.m1.3.3.1.1.1.2" xref="Sx3.Ex1.m1.3.3.1.1.1.2.cmml">h</mi><mn id="Sx3.Ex1.m1.3.3.1.1.1.3" xref="Sx3.Ex1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.Ex1.m1.5.5.3.3.5" xref="Sx3.Ex1.m1.5.5.3.4.cmml">,</mo><msub id="Sx3.Ex1.m1.4.4.2.2.2" xref="Sx3.Ex1.m1.4.4.2.2.2.cmml"><mi id="Sx3.Ex1.m1.4.4.2.2.2.2" xref="Sx3.Ex1.m1.4.4.2.2.2.2.cmml">h</mi><mn id="Sx3.Ex1.m1.4.4.2.2.2.3" xref="Sx3.Ex1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.Ex1.m1.5.5.3.3.6" xref="Sx3.Ex1.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.Ex1.m1.1.1" xref="Sx3.Ex1.m1.1.1.cmml">⋯</mi><mo id="Sx3.Ex1.m1.5.5.3.3.7" xref="Sx3.Ex1.m1.5.5.3.4.cmml">,</mo><msub id="Sx3.Ex1.m1.5.5.3.3.3" xref="Sx3.Ex1.m1.5.5.3.3.3.cmml"><mi id="Sx3.Ex1.m1.5.5.3.3.3.2" xref="Sx3.Ex1.m1.5.5.3.3.3.2.cmml">h</mi><mi id="Sx3.Ex1.m1.5.5.3.3.3.3" xref="Sx3.Ex1.m1.5.5.3.3.3.3.cmml">S</mi></msub><mo stretchy="false" id="Sx3.Ex1.m1.5.5.3.3.8" xref="Sx3.Ex1.m1.5.5.3.4.cmml">]</mo></mrow><mo id="Sx3.Ex1.m1.5.5.4" xref="Sx3.Ex1.m1.5.5.4.cmml">=</mo><mrow id="Sx3.Ex1.m1.5.5.5" xref="Sx3.Ex1.m1.5.5.5.cmml"><mi id="Sx3.Ex1.m1.5.5.5.2" xref="Sx3.Ex1.m1.5.5.5.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.5.3" xref="Sx3.Ex1.m1.5.5.5.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1a" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.5.4" xref="Sx3.Ex1.m1.5.5.5.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1b" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.5.5" xref="Sx3.Ex1.m1.5.5.5.5.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1c" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.5.6" xref="Sx3.Ex1.m1.5.5.5.6.cmml">T</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1d" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mi id="Sx3.Ex1.m1.5.5.5.7" xref="Sx3.Ex1.m1.5.5.5.7.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex1.m1.5.5.5.1e" xref="Sx3.Ex1.m1.5.5.5.1.cmml">​</mo><mrow id="Sx3.Ex1.m1.5.5.5.8.2" xref="Sx3.Ex1.m1.5.5.5.cmml"><mo stretchy="false" id="Sx3.Ex1.m1.5.5.5.8.2.1" xref="Sx3.Ex1.m1.5.5.5.cmml">(</mo><mi id="Sx3.Ex1.m1.2.2" xref="Sx3.Ex1.m1.2.2.cmml">Q</mi><mo stretchy="false" id="Sx3.Ex1.m1.5.5.5.8.2.2" xref="Sx3.Ex1.m1.5.5.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex1.m1.5b"><apply id="Sx3.Ex1.m1.5.5.cmml" xref="Sx3.Ex1.m1.5.5"><eq id="Sx3.Ex1.m1.5.5.4.cmml" xref="Sx3.Ex1.m1.5.5.4"></eq><list id="Sx3.Ex1.m1.5.5.3.4.cmml" xref="Sx3.Ex1.m1.5.5.3.3"><apply id="Sx3.Ex1.m1.3.3.1.1.1.cmml" xref="Sx3.Ex1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.3.3.1.1.1.1.cmml" xref="Sx3.Ex1.m1.3.3.1.1.1">subscript</csymbol><ci id="Sx3.Ex1.m1.3.3.1.1.1.2.cmml" xref="Sx3.Ex1.m1.3.3.1.1.1.2">ℎ</ci><cn type="integer" id="Sx3.Ex1.m1.3.3.1.1.1.3.cmml" xref="Sx3.Ex1.m1.3.3.1.1.1.3">1</cn></apply><apply id="Sx3.Ex1.m1.4.4.2.2.2.cmml" xref="Sx3.Ex1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.4.4.2.2.2.1.cmml" xref="Sx3.Ex1.m1.4.4.2.2.2">subscript</csymbol><ci id="Sx3.Ex1.m1.4.4.2.2.2.2.cmml" xref="Sx3.Ex1.m1.4.4.2.2.2.2">ℎ</ci><cn type="integer" id="Sx3.Ex1.m1.4.4.2.2.2.3.cmml" xref="Sx3.Ex1.m1.4.4.2.2.2.3">2</cn></apply><ci id="Sx3.Ex1.m1.1.1.cmml" xref="Sx3.Ex1.m1.1.1">⋯</ci><apply id="Sx3.Ex1.m1.5.5.3.3.3.cmml" xref="Sx3.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.3.3.1.cmml" xref="Sx3.Ex1.m1.5.5.3.3.3">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.3.3.3.2.cmml" xref="Sx3.Ex1.m1.5.5.3.3.3.2">ℎ</ci><ci id="Sx3.Ex1.m1.5.5.3.3.3.3.cmml" xref="Sx3.Ex1.m1.5.5.3.3.3.3">𝑆</ci></apply></list><apply id="Sx3.Ex1.m1.5.5.5.cmml" xref="Sx3.Ex1.m1.5.5.5"><times id="Sx3.Ex1.m1.5.5.5.1.cmml" xref="Sx3.Ex1.m1.5.5.5.1"></times><ci id="Sx3.Ex1.m1.5.5.5.2.cmml" xref="Sx3.Ex1.m1.5.5.5.2">𝐵</ci><ci id="Sx3.Ex1.m1.5.5.5.3.cmml" xref="Sx3.Ex1.m1.5.5.5.3">𝑖</ci><ci id="Sx3.Ex1.m1.5.5.5.4.cmml" xref="Sx3.Ex1.m1.5.5.5.4">𝐿</ci><ci id="Sx3.Ex1.m1.5.5.5.5.cmml" xref="Sx3.Ex1.m1.5.5.5.5">𝑆</ci><ci id="Sx3.Ex1.m1.5.5.5.6.cmml" xref="Sx3.Ex1.m1.5.5.5.6">𝑇</ci><ci id="Sx3.Ex1.m1.5.5.5.7.cmml" xref="Sx3.Ex1.m1.5.5.5.7">𝑀</ci><ci id="Sx3.Ex1.m1.2.2.cmml" xref="Sx3.Ex1.m1.2.2">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex1.m1.5c">[h_{1},h_{2},\cdots,h_{S}]=BiLSTM(Q)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p2.9" class="ltx_p">where <math id="Sx3.SSx3.p2.5.m1.2" class="ltx_Math" alttext="h_{s}=[\overrightarrow{h_{s}};\overleftarrow{h_{s}}]" display="inline"><semantics id="Sx3.SSx3.p2.5.m1.2a"><mrow id="Sx3.SSx3.p2.5.m1.2.3" xref="Sx3.SSx3.p2.5.m1.2.3.cmml"><msub id="Sx3.SSx3.p2.5.m1.2.3.2" xref="Sx3.SSx3.p2.5.m1.2.3.2.cmml"><mi id="Sx3.SSx3.p2.5.m1.2.3.2.2" xref="Sx3.SSx3.p2.5.m1.2.3.2.2.cmml">h</mi><mi id="Sx3.SSx3.p2.5.m1.2.3.2.3" xref="Sx3.SSx3.p2.5.m1.2.3.2.3.cmml">s</mi></msub><mo id="Sx3.SSx3.p2.5.m1.2.3.1" xref="Sx3.SSx3.p2.5.m1.2.3.1.cmml">=</mo><mrow id="Sx3.SSx3.p2.5.m1.2.3.3.2" xref="Sx3.SSx3.p2.5.m1.2.3.3.1.cmml"><mo stretchy="false" id="Sx3.SSx3.p2.5.m1.2.3.3.2.1" xref="Sx3.SSx3.p2.5.m1.2.3.3.1.cmml">[</mo><mover accent="true" id="Sx3.SSx3.p2.5.m1.1.1" xref="Sx3.SSx3.p2.5.m1.1.1.cmml"><msub id="Sx3.SSx3.p2.5.m1.1.1.2" xref="Sx3.SSx3.p2.5.m1.1.1.2.cmml"><mi id="Sx3.SSx3.p2.5.m1.1.1.2.2" xref="Sx3.SSx3.p2.5.m1.1.1.2.2.cmml">h</mi><mi id="Sx3.SSx3.p2.5.m1.1.1.2.3" xref="Sx3.SSx3.p2.5.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="Sx3.SSx3.p2.5.m1.1.1.1" xref="Sx3.SSx3.p2.5.m1.1.1.1.cmml">→</mo></mover><mo id="Sx3.SSx3.p2.5.m1.2.3.3.2.2" xref="Sx3.SSx3.p2.5.m1.2.3.3.1.cmml">;</mo><mover accent="true" id="Sx3.SSx3.p2.5.m1.2.2" xref="Sx3.SSx3.p2.5.m1.2.2.cmml"><msub id="Sx3.SSx3.p2.5.m1.2.2.2" xref="Sx3.SSx3.p2.5.m1.2.2.2.cmml"><mi id="Sx3.SSx3.p2.5.m1.2.2.2.2" xref="Sx3.SSx3.p2.5.m1.2.2.2.2.cmml">h</mi><mi id="Sx3.SSx3.p2.5.m1.2.2.2.3" xref="Sx3.SSx3.p2.5.m1.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="Sx3.SSx3.p2.5.m1.2.2.1" xref="Sx3.SSx3.p2.5.m1.2.2.1.cmml">←</mo></mover><mo stretchy="false" id="Sx3.SSx3.p2.5.m1.2.3.3.2.3" xref="Sx3.SSx3.p2.5.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.5.m1.2b"><apply id="Sx3.SSx3.p2.5.m1.2.3.cmml" xref="Sx3.SSx3.p2.5.m1.2.3"><eq id="Sx3.SSx3.p2.5.m1.2.3.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.1"></eq><apply id="Sx3.SSx3.p2.5.m1.2.3.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.5.m1.2.3.2.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.2">subscript</csymbol><ci id="Sx3.SSx3.p2.5.m1.2.3.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.2.2">ℎ</ci><ci id="Sx3.SSx3.p2.5.m1.2.3.2.3.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.2.3">𝑠</ci></apply><list id="Sx3.SSx3.p2.5.m1.2.3.3.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.3.3.2"><apply id="Sx3.SSx3.p2.5.m1.1.1.cmml" xref="Sx3.SSx3.p2.5.m1.1.1"><ci id="Sx3.SSx3.p2.5.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.5.m1.1.1.1">→</ci><apply id="Sx3.SSx3.p2.5.m1.1.1.2.cmml" xref="Sx3.SSx3.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.5.m1.1.1.2.1.cmml" xref="Sx3.SSx3.p2.5.m1.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.p2.5.m1.1.1.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.1.1.2.2">ℎ</ci><ci id="Sx3.SSx3.p2.5.m1.1.1.2.3.cmml" xref="Sx3.SSx3.p2.5.m1.1.1.2.3">𝑠</ci></apply></apply><apply id="Sx3.SSx3.p2.5.m1.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.2"><ci id="Sx3.SSx3.p2.5.m1.2.2.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.2.1">←</ci><apply id="Sx3.SSx3.p2.5.m1.2.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.5.m1.2.2.2.1.cmml" xref="Sx3.SSx3.p2.5.m1.2.2.2">subscript</csymbol><ci id="Sx3.SSx3.p2.5.m1.2.2.2.2.cmml" xref="Sx3.SSx3.p2.5.m1.2.2.2.2">ℎ</ci><ci id="Sx3.SSx3.p2.5.m1.2.2.2.3.cmml" xref="Sx3.SSx3.p2.5.m1.2.2.2.3">𝑠</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.5.m1.2c">h_{s}=[\overrightarrow{h_{s}};\overleftarrow{h_{s}}]</annotation></semantics></math> is the concatenation of the forward and backward hidden state of words at position <math id="Sx3.SSx3.p2.6.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="Sx3.SSx3.p2.6.m2.1a"><mi id="Sx3.SSx3.p2.6.m2.1.1" xref="Sx3.SSx3.p2.6.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.6.m2.1b"><ci id="Sx3.SSx3.p2.6.m2.1.1.cmml" xref="Sx3.SSx3.p2.6.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.6.m2.1c">s</annotation></semantics></math> from the last layer of the bi-directional LSTM output. At each reasoning step <math id="Sx3.SSx3.p2.7.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p2.7.m3.1a"><mi id="Sx3.SSx3.p2.7.m3.1.1" xref="Sx3.SSx3.p2.7.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.7.m3.1b"><ci id="Sx3.SSx3.p2.7.m3.1.1.cmml" xref="Sx3.SSx3.p2.7.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.7.m3.1c">t</annotation></semantics></math>, context vector <math id="Sx3.SSx3.p2.8.m4.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="Sx3.SSx3.p2.8.m4.1a"><msup id="Sx3.SSx3.p2.8.m4.1.1" xref="Sx3.SSx3.p2.8.m4.1.1.cmml"><mi id="Sx3.SSx3.p2.8.m4.1.1.2" xref="Sx3.SSx3.p2.8.m4.1.1.2.cmml">c</mi><mi id="Sx3.SSx3.p2.8.m4.1.1.3" xref="Sx3.SSx3.p2.8.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.8.m4.1b"><apply id="Sx3.SSx3.p2.8.m4.1.1.cmml" xref="Sx3.SSx3.p2.8.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.8.m4.1.1.1.cmml" xref="Sx3.SSx3.p2.8.m4.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.8.m4.1.1.2.cmml" xref="Sx3.SSx3.p2.8.m4.1.1.2">𝑐</ci><ci id="Sx3.SSx3.p2.8.m4.1.1.3.cmml" xref="Sx3.SSx3.p2.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.8.m4.1c">c^{t}</annotation></semantics></math> attends over the sequence of question words, and the question representation <math id="Sx3.SSx3.p2.9.m5.1" class="ltx_Math" alttext="q^{t}" display="inline"><semantics id="Sx3.SSx3.p2.9.m5.1a"><msup id="Sx3.SSx3.p2.9.m5.1.1" xref="Sx3.SSx3.p2.9.m5.1.1.cmml"><mi id="Sx3.SSx3.p2.9.m5.1.1.2" xref="Sx3.SSx3.p2.9.m5.1.1.2.cmml">q</mi><mi id="Sx3.SSx3.p2.9.m5.1.1.3" xref="Sx3.SSx3.p2.9.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.9.m5.1b"><apply id="Sx3.SSx3.p2.9.m5.1.1.cmml" xref="Sx3.SSx3.p2.9.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.9.m5.1.1.1.cmml" xref="Sx3.SSx3.p2.9.m5.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.9.m5.1.1.2.cmml" xref="Sx3.SSx3.p2.9.m5.1.1.2">𝑞</ci><ci id="Sx3.SSx3.p2.9.m5.1.1.3.cmml" xref="Sx3.SSx3.p2.9.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.9.m5.1c">q^{t}</annotation></semantics></math> is obtained as follows:</p>
<table id="A0.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle\alpha_{s}^{t}" display="inline"><semantics id="Sx3.Ex2.m1.1a"><msubsup id="Sx3.Ex2.m1.1.1" xref="Sx3.Ex2.m1.1.1.cmml"><mi id="Sx3.Ex2.m1.1.1.2.2" xref="Sx3.Ex2.m1.1.1.2.2.cmml">α</mi><mi id="Sx3.Ex2.m1.1.1.2.3" xref="Sx3.Ex2.m1.1.1.2.3.cmml">s</mi><mi id="Sx3.Ex2.m1.1.1.3" xref="Sx3.Ex2.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.Ex2.m1.1b"><apply id="Sx3.Ex2.m1.1.1.cmml" xref="Sx3.Ex2.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.1.1.1.cmml" xref="Sx3.Ex2.m1.1.1">superscript</csymbol><apply id="Sx3.Ex2.m1.1.1.2.cmml" xref="Sx3.Ex2.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.1.1.2.1.cmml" xref="Sx3.Ex2.m1.1.1">subscript</csymbol><ci id="Sx3.Ex2.m1.1.1.2.2.cmml" xref="Sx3.Ex2.m1.1.1.2.2">𝛼</ci><ci id="Sx3.Ex2.m1.1.1.2.3.cmml" xref="Sx3.Ex2.m1.1.1.2.3">𝑠</ci></apply><ci id="Sx3.Ex2.m1.1.1.3.cmml" xref="Sx3.Ex2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex2.m1.1c">\displaystyle\alpha_{s}^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex2.m2.1" class="ltx_math_unparsed" alttext="\displaystyle=softmax(W_{1}(h_{s}\odot(W_{2}^{t}ReLU(W_{3}c^{t})))" display="inline"><semantics id="Sx3.Ex2.m2.1a"><mrow id="Sx3.Ex2.m2.1b"><mo id="Sx3.Ex2.m2.1.1">=</mo><mi id="Sx3.Ex2.m2.1.2">s</mi><mi id="Sx3.Ex2.m2.1.3">o</mi><mi id="Sx3.Ex2.m2.1.4">f</mi><mi id="Sx3.Ex2.m2.1.5">t</mi><mi id="Sx3.Ex2.m2.1.6">m</mi><mi id="Sx3.Ex2.m2.1.7">a</mi><mi id="Sx3.Ex2.m2.1.8">x</mi><mrow id="Sx3.Ex2.m2.1.9"><mo stretchy="false" id="Sx3.Ex2.m2.1.9.1">(</mo><msub id="Sx3.Ex2.m2.1.9.2"><mi id="Sx3.Ex2.m2.1.9.2.2">W</mi><mn id="Sx3.Ex2.m2.1.9.2.3">1</mn></msub><mrow id="Sx3.Ex2.m2.1.9.3"><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.1">(</mo><msub id="Sx3.Ex2.m2.1.9.3.2"><mi id="Sx3.Ex2.m2.1.9.3.2.2">h</mi><mi id="Sx3.Ex2.m2.1.9.3.2.3">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Sx3.Ex2.m2.1.9.3.3">⊙</mo><mrow id="Sx3.Ex2.m2.1.9.3.4"><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.4.1">(</mo><msubsup id="Sx3.Ex2.m2.1.9.3.4.2"><mi id="Sx3.Ex2.m2.1.9.3.4.2.2.2">W</mi><mn id="Sx3.Ex2.m2.1.9.3.4.2.2.3">2</mn><mi id="Sx3.Ex2.m2.1.9.3.4.2.3">t</mi></msubsup><mi id="Sx3.Ex2.m2.1.9.3.4.3">R</mi><mi id="Sx3.Ex2.m2.1.9.3.4.4">e</mi><mi id="Sx3.Ex2.m2.1.9.3.4.5">L</mi><mi id="Sx3.Ex2.m2.1.9.3.4.6">U</mi><mrow id="Sx3.Ex2.m2.1.9.3.4.7"><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.4.7.1">(</mo><msub id="Sx3.Ex2.m2.1.9.3.4.7.2"><mi id="Sx3.Ex2.m2.1.9.3.4.7.2.2">W</mi><mn id="Sx3.Ex2.m2.1.9.3.4.7.2.3">3</mn></msub><msup id="Sx3.Ex2.m2.1.9.3.4.7.3"><mi id="Sx3.Ex2.m2.1.9.3.4.7.3.2">c</mi><mi id="Sx3.Ex2.m2.1.9.3.4.7.3.3">t</mi></msup><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.4.7.4">)</mo></mrow><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.4.8">)</mo></mrow><mo stretchy="false" id="Sx3.Ex2.m2.1.9.3.5">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.Ex2.m2.1c">\displaystyle=softmax(W_{1}(h_{s}\odot(W_{2}^{t}ReLU(W_{3}c^{t})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle q^{t}" display="inline"><semantics id="Sx3.Ex3.m1.1a"><msup id="Sx3.Ex3.m1.1.1" xref="Sx3.Ex3.m1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.2" xref="Sx3.Ex3.m1.1.1.2.cmml">q</mi><mi id="Sx3.Ex3.m1.1.1.3" xref="Sx3.Ex3.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.Ex3.m1.1b"><apply id="Sx3.Ex3.m1.1.1.cmml" xref="Sx3.Ex3.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1">superscript</csymbol><ci id="Sx3.Ex3.m1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.2">𝑞</ci><ci id="Sx3.Ex3.m1.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex3.m1.1c">\displaystyle q^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex3.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{s=1}^{S}\alpha_{s}^{t}h_{s}" display="inline"><semantics id="Sx3.Ex3.m2.1a"><mrow id="Sx3.Ex3.m2.1.1" xref="Sx3.Ex3.m2.1.1.cmml"><mi id="Sx3.Ex3.m2.1.1.2" xref="Sx3.Ex3.m2.1.1.2.cmml"></mi><mo id="Sx3.Ex3.m2.1.1.1" xref="Sx3.Ex3.m2.1.1.1.cmml">=</mo><mrow id="Sx3.Ex3.m2.1.1.3" xref="Sx3.Ex3.m2.1.1.3.cmml"><mstyle displaystyle="true" id="Sx3.Ex3.m2.1.1.3.1" xref="Sx3.Ex3.m2.1.1.3.1.cmml"><munderover id="Sx3.Ex3.m2.1.1.3.1a" xref="Sx3.Ex3.m2.1.1.3.1.cmml"><mo movablelimits="false" id="Sx3.Ex3.m2.1.1.3.1.2.2" xref="Sx3.Ex3.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx3.Ex3.m2.1.1.3.1.2.3" xref="Sx3.Ex3.m2.1.1.3.1.2.3.cmml"><mi id="Sx3.Ex3.m2.1.1.3.1.2.3.2" xref="Sx3.Ex3.m2.1.1.3.1.2.3.2.cmml">s</mi><mo id="Sx3.Ex3.m2.1.1.3.1.2.3.1" xref="Sx3.Ex3.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="Sx3.Ex3.m2.1.1.3.1.2.3.3" xref="Sx3.Ex3.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex3.m2.1.1.3.1.3" xref="Sx3.Ex3.m2.1.1.3.1.3.cmml">S</mi></munderover></mstyle><mrow id="Sx3.Ex3.m2.1.1.3.2" xref="Sx3.Ex3.m2.1.1.3.2.cmml"><msubsup id="Sx3.Ex3.m2.1.1.3.2.2" xref="Sx3.Ex3.m2.1.1.3.2.2.cmml"><mi id="Sx3.Ex3.m2.1.1.3.2.2.2.2" xref="Sx3.Ex3.m2.1.1.3.2.2.2.2.cmml">α</mi><mi id="Sx3.Ex3.m2.1.1.3.2.2.2.3" xref="Sx3.Ex3.m2.1.1.3.2.2.2.3.cmml">s</mi><mi id="Sx3.Ex3.m2.1.1.3.2.2.3" xref="Sx3.Ex3.m2.1.1.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.Ex3.m2.1.1.3.2.1" xref="Sx3.Ex3.m2.1.1.3.2.1.cmml">​</mo><msub id="Sx3.Ex3.m2.1.1.3.2.3" xref="Sx3.Ex3.m2.1.1.3.2.3.cmml"><mi id="Sx3.Ex3.m2.1.1.3.2.3.2" xref="Sx3.Ex3.m2.1.1.3.2.3.2.cmml">h</mi><mi id="Sx3.Ex3.m2.1.1.3.2.3.3" xref="Sx3.Ex3.m2.1.1.3.2.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex3.m2.1b"><apply id="Sx3.Ex3.m2.1.1.cmml" xref="Sx3.Ex3.m2.1.1"><eq id="Sx3.Ex3.m2.1.1.1.cmml" xref="Sx3.Ex3.m2.1.1.1"></eq><csymbol cd="latexml" id="Sx3.Ex3.m2.1.1.2.cmml" xref="Sx3.Ex3.m2.1.1.2">absent</csymbol><apply id="Sx3.Ex3.m2.1.1.3.cmml" xref="Sx3.Ex3.m2.1.1.3"><apply id="Sx3.Ex3.m2.1.1.3.1.cmml" xref="Sx3.Ex3.m2.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m2.1.1.3.1.1.cmml" xref="Sx3.Ex3.m2.1.1.3.1">superscript</csymbol><apply id="Sx3.Ex3.m2.1.1.3.1.2.cmml" xref="Sx3.Ex3.m2.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m2.1.1.3.1.2.1.cmml" xref="Sx3.Ex3.m2.1.1.3.1">subscript</csymbol><sum id="Sx3.Ex3.m2.1.1.3.1.2.2.cmml" xref="Sx3.Ex3.m2.1.1.3.1.2.2"></sum><apply id="Sx3.Ex3.m2.1.1.3.1.2.3.cmml" xref="Sx3.Ex3.m2.1.1.3.1.2.3"><eq id="Sx3.Ex3.m2.1.1.3.1.2.3.1.cmml" xref="Sx3.Ex3.m2.1.1.3.1.2.3.1"></eq><ci id="Sx3.Ex3.m2.1.1.3.1.2.3.2.cmml" xref="Sx3.Ex3.m2.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="Sx3.Ex3.m2.1.1.3.1.2.3.3.cmml" xref="Sx3.Ex3.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex3.m2.1.1.3.1.3.cmml" xref="Sx3.Ex3.m2.1.1.3.1.3">𝑆</ci></apply><apply id="Sx3.Ex3.m2.1.1.3.2.cmml" xref="Sx3.Ex3.m2.1.1.3.2"><times id="Sx3.Ex3.m2.1.1.3.2.1.cmml" xref="Sx3.Ex3.m2.1.1.3.2.1"></times><apply id="Sx3.Ex3.m2.1.1.3.2.2.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m2.1.1.3.2.2.1.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2">superscript</csymbol><apply id="Sx3.Ex3.m2.1.1.3.2.2.2.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m2.1.1.3.2.2.2.1.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2">subscript</csymbol><ci id="Sx3.Ex3.m2.1.1.3.2.2.2.2.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2.2.2">𝛼</ci><ci id="Sx3.Ex3.m2.1.1.3.2.2.2.3.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2.2.3">𝑠</ci></apply><ci id="Sx3.Ex3.m2.1.1.3.2.2.3.cmml" xref="Sx3.Ex3.m2.1.1.3.2.2.3">𝑡</ci></apply><apply id="Sx3.Ex3.m2.1.1.3.2.3.cmml" xref="Sx3.Ex3.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m2.1.1.3.2.3.1.cmml" xref="Sx3.Ex3.m2.1.1.3.2.3">subscript</csymbol><ci id="Sx3.Ex3.m2.1.1.3.2.3.2.cmml" xref="Sx3.Ex3.m2.1.1.3.2.3.2">ℎ</ci><ci id="Sx3.Ex3.m2.1.1.3.2.3.3.cmml" xref="Sx3.Ex3.m2.1.1.3.2.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex3.m2.1c">\displaystyle=\sum_{s=1}^{S}\alpha_{s}^{t}h_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p2.23" class="ltx_p">where <math id="Sx3.SSx3.p2.10.m1.1" class="ltx_Math" alttext="W_{1}" display="inline"><semantics id="Sx3.SSx3.p2.10.m1.1a"><msub id="Sx3.SSx3.p2.10.m1.1.1" xref="Sx3.SSx3.p2.10.m1.1.1.cmml"><mi id="Sx3.SSx3.p2.10.m1.1.1.2" xref="Sx3.SSx3.p2.10.m1.1.1.2.cmml">W</mi><mn id="Sx3.SSx3.p2.10.m1.1.1.3" xref="Sx3.SSx3.p2.10.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.10.m1.1b"><apply id="Sx3.SSx3.p2.10.m1.1.1.cmml" xref="Sx3.SSx3.p2.10.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.10.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.10.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.10.m1.1.1.2.cmml" xref="Sx3.SSx3.p2.10.m1.1.1.2">𝑊</ci><cn type="integer" id="Sx3.SSx3.p2.10.m1.1.1.3.cmml" xref="Sx3.SSx3.p2.10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.10.m1.1c">W_{1}</annotation></semantics></math>, <math id="Sx3.SSx3.p2.11.m2.1" class="ltx_Math" alttext="W_{2}^{t}" display="inline"><semantics id="Sx3.SSx3.p2.11.m2.1a"><msubsup id="Sx3.SSx3.p2.11.m2.1.1" xref="Sx3.SSx3.p2.11.m2.1.1.cmml"><mi id="Sx3.SSx3.p2.11.m2.1.1.2.2" xref="Sx3.SSx3.p2.11.m2.1.1.2.2.cmml">W</mi><mn id="Sx3.SSx3.p2.11.m2.1.1.2.3" xref="Sx3.SSx3.p2.11.m2.1.1.2.3.cmml">2</mn><mi id="Sx3.SSx3.p2.11.m2.1.1.3" xref="Sx3.SSx3.p2.11.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.11.m2.1b"><apply id="Sx3.SSx3.p2.11.m2.1.1.cmml" xref="Sx3.SSx3.p2.11.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.11.m2.1.1.1.cmml" xref="Sx3.SSx3.p2.11.m2.1.1">superscript</csymbol><apply id="Sx3.SSx3.p2.11.m2.1.1.2.cmml" xref="Sx3.SSx3.p2.11.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.11.m2.1.1.2.1.cmml" xref="Sx3.SSx3.p2.11.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.11.m2.1.1.2.2.cmml" xref="Sx3.SSx3.p2.11.m2.1.1.2.2">𝑊</ci><cn type="integer" id="Sx3.SSx3.p2.11.m2.1.1.2.3.cmml" xref="Sx3.SSx3.p2.11.m2.1.1.2.3">2</cn></apply><ci id="Sx3.SSx3.p2.11.m2.1.1.3.cmml" xref="Sx3.SSx3.p2.11.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.11.m2.1c">W_{2}^{t}</annotation></semantics></math> (as well as <math id="Sx3.SSx3.p2.12.m3.1" class="ltx_Math" alttext="W_{3}" display="inline"><semantics id="Sx3.SSx3.p2.12.m3.1a"><msub id="Sx3.SSx3.p2.12.m3.1.1" xref="Sx3.SSx3.p2.12.m3.1.1.cmml"><mi id="Sx3.SSx3.p2.12.m3.1.1.2" xref="Sx3.SSx3.p2.12.m3.1.1.2.cmml">W</mi><mn id="Sx3.SSx3.p2.12.m3.1.1.3" xref="Sx3.SSx3.p2.12.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.12.m3.1b"><apply id="Sx3.SSx3.p2.12.m3.1.1.cmml" xref="Sx3.SSx3.p2.12.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.12.m3.1.1.1.cmml" xref="Sx3.SSx3.p2.12.m3.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.12.m3.1.1.2.cmml" xref="Sx3.SSx3.p2.12.m3.1.1.2">𝑊</ci><cn type="integer" id="Sx3.SSx3.p2.12.m3.1.1.3.cmml" xref="Sx3.SSx3.p2.12.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.12.m3.1c">W_{3}</annotation></semantics></math>,<math id="Sx3.SSx3.p2.13.m4.1" class="ltx_Math" alttext="\cdots" display="inline"><semantics id="Sx3.SSx3.p2.13.m4.1a"><mi mathvariant="normal" id="Sx3.SSx3.p2.13.m4.1.1" xref="Sx3.SSx3.p2.13.m4.1.1.cmml">⋯</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.13.m4.1b"><ci id="Sx3.SSx3.p2.13.m4.1.1.cmml" xref="Sx3.SSx3.p2.13.m4.1.1">⋯</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.13.m4.1c">\cdots</annotation></semantics></math>, <math id="Sx3.SSx3.p2.14.m5.1" class="ltx_Math" alttext="\omega_{v}^{t}" display="inline"><semantics id="Sx3.SSx3.p2.14.m5.1a"><msubsup id="Sx3.SSx3.p2.14.m5.1.1" xref="Sx3.SSx3.p2.14.m5.1.1.cmml"><mi id="Sx3.SSx3.p2.14.m5.1.1.2.2" xref="Sx3.SSx3.p2.14.m5.1.1.2.2.cmml">ω</mi><mi id="Sx3.SSx3.p2.14.m5.1.1.2.3" xref="Sx3.SSx3.p2.14.m5.1.1.2.3.cmml">v</mi><mi id="Sx3.SSx3.p2.14.m5.1.1.3" xref="Sx3.SSx3.p2.14.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.14.m5.1b"><apply id="Sx3.SSx3.p2.14.m5.1.1.cmml" xref="Sx3.SSx3.p2.14.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.14.m5.1.1.1.cmml" xref="Sx3.SSx3.p2.14.m5.1.1">superscript</csymbol><apply id="Sx3.SSx3.p2.14.m5.1.1.2.cmml" xref="Sx3.SSx3.p2.14.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.14.m5.1.1.2.1.cmml" xref="Sx3.SSx3.p2.14.m5.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.14.m5.1.1.2.2.cmml" xref="Sx3.SSx3.p2.14.m5.1.1.2.2">𝜔</ci><ci id="Sx3.SSx3.p2.14.m5.1.1.2.3.cmml" xref="Sx3.SSx3.p2.14.m5.1.1.2.3">𝑣</ci></apply><ci id="Sx3.SSx3.p2.14.m5.1.1.3.cmml" xref="Sx3.SSx3.p2.14.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.14.m5.1c">\omega_{v}^{t}</annotation></semantics></math>, <math id="Sx3.SSx3.p2.15.m6.1" class="ltx_Math" alttext="\omega_{e}^{t}" display="inline"><semantics id="Sx3.SSx3.p2.15.m6.1a"><msubsup id="Sx3.SSx3.p2.15.m6.1.1" xref="Sx3.SSx3.p2.15.m6.1.1.cmml"><mi id="Sx3.SSx3.p2.15.m6.1.1.2.2" xref="Sx3.SSx3.p2.15.m6.1.1.2.2.cmml">ω</mi><mi id="Sx3.SSx3.p2.15.m6.1.1.2.3" xref="Sx3.SSx3.p2.15.m6.1.1.2.3.cmml">e</mi><mi id="Sx3.SSx3.p2.15.m6.1.1.3" xref="Sx3.SSx3.p2.15.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.15.m6.1b"><apply id="Sx3.SSx3.p2.15.m6.1.1.cmml" xref="Sx3.SSx3.p2.15.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.15.m6.1.1.1.cmml" xref="Sx3.SSx3.p2.15.m6.1.1">superscript</csymbol><apply id="Sx3.SSx3.p2.15.m6.1.1.2.cmml" xref="Sx3.SSx3.p2.15.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.15.m6.1.1.2.1.cmml" xref="Sx3.SSx3.p2.15.m6.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.15.m6.1.1.2.2.cmml" xref="Sx3.SSx3.p2.15.m6.1.1.2.2">𝜔</ci><ci id="Sx3.SSx3.p2.15.m6.1.1.2.3.cmml" xref="Sx3.SSx3.p2.15.m6.1.1.2.3">𝑒</ci></apply><ci id="Sx3.SSx3.p2.15.m6.1.1.3.cmml" xref="Sx3.SSx3.p2.15.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.15.m6.1c">\omega_{e}^{t}</annotation></semantics></math> mentioned below) are learned parameters, and <math id="Sx3.SSx3.p2.16.m7.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="Sx3.SSx3.p2.16.m7.1a"><mo id="Sx3.SSx3.p2.16.m7.1.1" xref="Sx3.SSx3.p2.16.m7.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.16.m7.1b"><csymbol cd="latexml" id="Sx3.SSx3.p2.16.m7.1.1.cmml" xref="Sx3.SSx3.p2.16.m7.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.16.m7.1c">\odot</annotation></semantics></math> denotes element-wise multiplication. Parameters with <math id="Sx3.SSx3.p2.17.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p2.17.m8.1a"><mi id="Sx3.SSx3.p2.17.m8.1.1" xref="Sx3.SSx3.p2.17.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.17.m8.1b"><ci id="Sx3.SSx3.p2.17.m8.1.1.cmml" xref="Sx3.SSx3.p2.17.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.17.m8.1c">t</annotation></semantics></math> superscript are learned separately for each iteration, while those without <math id="Sx3.SSx3.p2.18.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p2.18.m9.1a"><mi id="Sx3.SSx3.p2.18.m9.1.1" xref="Sx3.SSx3.p2.18.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.18.m9.1b"><ci id="Sx3.SSx3.p2.18.m9.1.1.cmml" xref="Sx3.SSx3.p2.18.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.18.m9.1c">t</annotation></semantics></math> superscript are shared across iterations. The <math id="Sx3.SSx3.p2.19.m10.1" class="ltx_Math" alttext="q^{t}" display="inline"><semantics id="Sx3.SSx3.p2.19.m10.1a"><msup id="Sx3.SSx3.p2.19.m10.1.1" xref="Sx3.SSx3.p2.19.m10.1.1.cmml"><mi id="Sx3.SSx3.p2.19.m10.1.1.2" xref="Sx3.SSx3.p2.19.m10.1.1.2.cmml">q</mi><mi id="Sx3.SSx3.p2.19.m10.1.1.3" xref="Sx3.SSx3.p2.19.m10.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.19.m10.1b"><apply id="Sx3.SSx3.p2.19.m10.1.1.cmml" xref="Sx3.SSx3.p2.19.m10.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.19.m10.1.1.1.cmml" xref="Sx3.SSx3.p2.19.m10.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.19.m10.1.1.2.cmml" xref="Sx3.SSx3.p2.19.m10.1.1.2">𝑞</ci><ci id="Sx3.SSx3.p2.19.m10.1.1.3.cmml" xref="Sx3.SSx3.p2.19.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.19.m10.1c">q^{t}</annotation></semantics></math> can be seen as the reasoning step-aware question representation at step <math id="Sx3.SSx3.p2.20.m11.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p2.20.m11.1a"><mi id="Sx3.SSx3.p2.20.m11.1.1" xref="Sx3.SSx3.p2.20.m11.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.20.m11.1b"><ci id="Sx3.SSx3.p2.20.m11.1.1.cmml" xref="Sx3.SSx3.p2.20.m11.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.20.m11.1c">t</annotation></semantics></math>. In the first step, the reasoning step-aware vector: <math id="Sx3.SSx3.p2.21.m12.2" class="ltx_Math" alttext="c^{1}=[\overrightarrow{h}_{S};\overleftarrow{h}_{1}]" display="inline"><semantics id="Sx3.SSx3.p2.21.m12.2a"><mrow id="Sx3.SSx3.p2.21.m12.2.2" xref="Sx3.SSx3.p2.21.m12.2.2.cmml"><msup id="Sx3.SSx3.p2.21.m12.2.2.4" xref="Sx3.SSx3.p2.21.m12.2.2.4.cmml"><mi id="Sx3.SSx3.p2.21.m12.2.2.4.2" xref="Sx3.SSx3.p2.21.m12.2.2.4.2.cmml">c</mi><mn id="Sx3.SSx3.p2.21.m12.2.2.4.3" xref="Sx3.SSx3.p2.21.m12.2.2.4.3.cmml">1</mn></msup><mo id="Sx3.SSx3.p2.21.m12.2.2.3" xref="Sx3.SSx3.p2.21.m12.2.2.3.cmml">=</mo><mrow id="Sx3.SSx3.p2.21.m12.2.2.2.2" xref="Sx3.SSx3.p2.21.m12.2.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx3.p2.21.m12.2.2.2.2.3" xref="Sx3.SSx3.p2.21.m12.2.2.2.3.cmml">[</mo><msub id="Sx3.SSx3.p2.21.m12.1.1.1.1.1" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.cmml"><mi id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.2" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.2.cmml">h</mi><mo stretchy="false" id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.1" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.3" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.3.cmml">S</mi></msub><mo id="Sx3.SSx3.p2.21.m12.2.2.2.2.4" xref="Sx3.SSx3.p2.21.m12.2.2.2.3.cmml">;</mo><msub id="Sx3.SSx3.p2.21.m12.2.2.2.2.2" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.cmml"><mover accent="true" id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.cmml"><mi id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.2" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.2.cmml">h</mi><mo stretchy="false" id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.1" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.1.cmml">←</mo></mover><mn id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.3" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="Sx3.SSx3.p2.21.m12.2.2.2.2.5" xref="Sx3.SSx3.p2.21.m12.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.21.m12.2b"><apply id="Sx3.SSx3.p2.21.m12.2.2.cmml" xref="Sx3.SSx3.p2.21.m12.2.2"><eq id="Sx3.SSx3.p2.21.m12.2.2.3.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.3"></eq><apply id="Sx3.SSx3.p2.21.m12.2.2.4.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.4"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.21.m12.2.2.4.1.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.4">superscript</csymbol><ci id="Sx3.SSx3.p2.21.m12.2.2.4.2.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.4.2">𝑐</ci><cn type="integer" id="Sx3.SSx3.p2.21.m12.2.2.4.3.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.4.3">1</cn></apply><list id="Sx3.SSx3.p2.21.m12.2.2.2.3.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2"><apply id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.1.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2"><ci id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.1">→</ci><ci id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.2.2">ℎ</ci></apply><ci id="Sx3.SSx3.p2.21.m12.1.1.1.1.1.3.cmml" xref="Sx3.SSx3.p2.21.m12.1.1.1.1.1.3">𝑆</ci></apply><apply id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.1.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2">subscript</csymbol><apply id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2"><ci id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.1.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.1">←</ci><ci id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.2.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.2.2">ℎ</ci></apply><cn type="integer" id="Sx3.SSx3.p2.21.m12.2.2.2.2.2.3.cmml" xref="Sx3.SSx3.p2.21.m12.2.2.2.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.21.m12.2c">c^{1}=[\overrightarrow{h}_{S};\overleftarrow{h}_{1}]</annotation></semantics></math>, which is the concatenation of the final hidden states obtained from the forward and backward LSTM passes. From the second step to the <math id="Sx3.SSx3.p2.22.m13.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx3.p2.22.m13.1a"><mi id="Sx3.SSx3.p2.22.m13.1.1" xref="Sx3.SSx3.p2.22.m13.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.22.m13.1b"><ci id="Sx3.SSx3.p2.22.m13.1.1.cmml" xref="Sx3.SSx3.p2.22.m13.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.22.m13.1c">T</annotation></semantics></math>th step, <math id="Sx3.SSx3.p2.23.m14.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="Sx3.SSx3.p2.23.m14.1a"><msup id="Sx3.SSx3.p2.23.m14.1.1" xref="Sx3.SSx3.p2.23.m14.1.1.cmml"><mi id="Sx3.SSx3.p2.23.m14.1.1.2" xref="Sx3.SSx3.p2.23.m14.1.1.2.cmml">c</mi><mi id="Sx3.SSx3.p2.23.m14.1.1.3" xref="Sx3.SSx3.p2.23.m14.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.23.m14.1b"><apply id="Sx3.SSx3.p2.23.m14.1.1.cmml" xref="Sx3.SSx3.p2.23.m14.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.23.m14.1.1.1.cmml" xref="Sx3.SSx3.p2.23.m14.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.23.m14.1.1.2.cmml" xref="Sx3.SSx3.p2.23.m14.1.1.2">𝑐</ci><ci id="Sx3.SSx3.p2.23.m14.1.1.3.cmml" xref="Sx3.SSx3.p2.23.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.23.m14.1c">c^{t}</annotation></semantics></math> is evaluated as:</p>
<table id="A0.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle c^{t}=W_{4}^{t}(ReLU(W_{5}[R^{t-1};I^{t-1}]))" display="inline"><semantics id="Sx3.Ex4.m1.1a"><mrow id="Sx3.Ex4.m1.1.1" xref="Sx3.Ex4.m1.1.1.cmml"><msup id="Sx3.Ex4.m1.1.1.3" xref="Sx3.Ex4.m1.1.1.3.cmml"><mi id="Sx3.Ex4.m1.1.1.3.2" xref="Sx3.Ex4.m1.1.1.3.2.cmml">c</mi><mi id="Sx3.Ex4.m1.1.1.3.3" xref="Sx3.Ex4.m1.1.1.3.3.cmml">t</mi></msup><mo id="Sx3.Ex4.m1.1.1.2" xref="Sx3.Ex4.m1.1.1.2.cmml">=</mo><mrow id="Sx3.Ex4.m1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.cmml"><msubsup id="Sx3.Ex4.m1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.3.cmml"><mi id="Sx3.Ex4.m1.1.1.1.3.2.2" xref="Sx3.Ex4.m1.1.1.1.3.2.2.cmml">W</mi><mn id="Sx3.Ex4.m1.1.1.1.3.2.3" xref="Sx3.Ex4.m1.1.1.1.3.2.3.cmml">4</mn><mi id="Sx3.Ex4.m1.1.1.1.3.3" xref="Sx3.Ex4.m1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.2" xref="Sx3.Ex4.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex4.m1.1.1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.1.1.1.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.4" xref="Sx3.Ex4.m1.1.1.1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.1.1.1.2a" xref="Sx3.Ex4.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.5" xref="Sx3.Ex4.m1.1.1.1.1.1.1.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.1.1.1.2b" xref="Sx3.Ex4.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.6" xref="Sx3.Ex4.m1.1.1.1.1.1.1.6.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.1.1.1.2c" xref="Sx3.Ex4.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">W</mi><mn id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">5</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">[</mo><msup id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.4" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">I</mi><mrow id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.5" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex4.m1.1.1.1.1.1.3" xref="Sx3.Ex4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex4.m1.1b"><apply id="Sx3.Ex4.m1.1.1.cmml" xref="Sx3.Ex4.m1.1.1"><eq id="Sx3.Ex4.m1.1.1.2.cmml" xref="Sx3.Ex4.m1.1.1.2"></eq><apply id="Sx3.Ex4.m1.1.1.3.cmml" xref="Sx3.Ex4.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.3.1.cmml" xref="Sx3.Ex4.m1.1.1.3">superscript</csymbol><ci id="Sx3.Ex4.m1.1.1.3.2.cmml" xref="Sx3.Ex4.m1.1.1.3.2">𝑐</ci><ci id="Sx3.Ex4.m1.1.1.3.3.cmml" xref="Sx3.Ex4.m1.1.1.3.3">𝑡</ci></apply><apply id="Sx3.Ex4.m1.1.1.1.cmml" xref="Sx3.Ex4.m1.1.1.1"><times id="Sx3.Ex4.m1.1.1.1.2.cmml" xref="Sx3.Ex4.m1.1.1.1.2"></times><apply id="Sx3.Ex4.m1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.1.3.1.cmml" xref="Sx3.Ex4.m1.1.1.1.3">superscript</csymbol><apply id="Sx3.Ex4.m1.1.1.1.3.2.cmml" xref="Sx3.Ex4.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.1.3.2.1.cmml" xref="Sx3.Ex4.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex4.m1.1.1.1.3.2.2.cmml" xref="Sx3.Ex4.m1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="Sx3.Ex4.m1.1.1.1.3.2.3.cmml" xref="Sx3.Ex4.m1.1.1.1.3.2.3">4</cn></apply><ci id="Sx3.Ex4.m1.1.1.1.3.3.cmml" xref="Sx3.Ex4.m1.1.1.1.3.3">𝑡</ci></apply><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1"><times id="Sx3.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.3">𝑅</ci><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.4">𝑒</ci><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.5">𝐿</ci><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.6.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.6">𝑈</ci><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1"><times id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.3"></times><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2">𝑊</ci><cn type="integer" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3">5</cn></apply><list id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐼</ci><apply id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3"><minus id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="Sx3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex4.m1.1c">\displaystyle c^{t}=W_{4}^{t}(ReLU(W_{5}[R^{t-1};I^{t-1}]))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p2.26" class="ltx_p">where <math id="Sx3.SSx3.p2.24.m1.1" class="ltx_Math" alttext="R^{t-1}" display="inline"><semantics id="Sx3.SSx3.p2.24.m1.1a"><msup id="Sx3.SSx3.p2.24.m1.1.1" xref="Sx3.SSx3.p2.24.m1.1.1.cmml"><mi id="Sx3.SSx3.p2.24.m1.1.1.2" xref="Sx3.SSx3.p2.24.m1.1.1.2.cmml">R</mi><mrow id="Sx3.SSx3.p2.24.m1.1.1.3" xref="Sx3.SSx3.p2.24.m1.1.1.3.cmml"><mi id="Sx3.SSx3.p2.24.m1.1.1.3.2" xref="Sx3.SSx3.p2.24.m1.1.1.3.2.cmml">t</mi><mo id="Sx3.SSx3.p2.24.m1.1.1.3.1" xref="Sx3.SSx3.p2.24.m1.1.1.3.1.cmml">−</mo><mn id="Sx3.SSx3.p2.24.m1.1.1.3.3" xref="Sx3.SSx3.p2.24.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.24.m1.1b"><apply id="Sx3.SSx3.p2.24.m1.1.1.cmml" xref="Sx3.SSx3.p2.24.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.24.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.24.m1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.24.m1.1.1.2.cmml" xref="Sx3.SSx3.p2.24.m1.1.1.2">𝑅</ci><apply id="Sx3.SSx3.p2.24.m1.1.1.3.cmml" xref="Sx3.SSx3.p2.24.m1.1.1.3"><minus id="Sx3.SSx3.p2.24.m1.1.1.3.1.cmml" xref="Sx3.SSx3.p2.24.m1.1.1.3.1"></minus><ci id="Sx3.SSx3.p2.24.m1.1.1.3.2.cmml" xref="Sx3.SSx3.p2.24.m1.1.1.3.2">𝑡</ci><cn type="integer" id="Sx3.SSx3.p2.24.m1.1.1.3.3.cmml" xref="Sx3.SSx3.p2.24.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.24.m1.1c">R^{t-1}</annotation></semantics></math>, <math id="Sx3.SSx3.p2.25.m2.1" class="ltx_Math" alttext="I^{t-1}" display="inline"><semantics id="Sx3.SSx3.p2.25.m2.1a"><msup id="Sx3.SSx3.p2.25.m2.1.1" xref="Sx3.SSx3.p2.25.m2.1.1.cmml"><mi id="Sx3.SSx3.p2.25.m2.1.1.2" xref="Sx3.SSx3.p2.25.m2.1.1.2.cmml">I</mi><mrow id="Sx3.SSx3.p2.25.m2.1.1.3" xref="Sx3.SSx3.p2.25.m2.1.1.3.cmml"><mi id="Sx3.SSx3.p2.25.m2.1.1.3.2" xref="Sx3.SSx3.p2.25.m2.1.1.3.2.cmml">t</mi><mo id="Sx3.SSx3.p2.25.m2.1.1.3.1" xref="Sx3.SSx3.p2.25.m2.1.1.3.1.cmml">−</mo><mn id="Sx3.SSx3.p2.25.m2.1.1.3.3" xref="Sx3.SSx3.p2.25.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.25.m2.1b"><apply id="Sx3.SSx3.p2.25.m2.1.1.cmml" xref="Sx3.SSx3.p2.25.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.25.m2.1.1.1.cmml" xref="Sx3.SSx3.p2.25.m2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p2.25.m2.1.1.2.cmml" xref="Sx3.SSx3.p2.25.m2.1.1.2">𝐼</ci><apply id="Sx3.SSx3.p2.25.m2.1.1.3.cmml" xref="Sx3.SSx3.p2.25.m2.1.1.3"><minus id="Sx3.SSx3.p2.25.m2.1.1.3.1.cmml" xref="Sx3.SSx3.p2.25.m2.1.1.3.1"></minus><ci id="Sx3.SSx3.p2.25.m2.1.1.3.2.cmml" xref="Sx3.SSx3.p2.25.m2.1.1.3.2">𝑡</ci><cn type="integer" id="Sx3.SSx3.p2.25.m2.1.1.3.3.cmml" xref="Sx3.SSx3.p2.25.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.25.m2.1c">I^{t-1}</annotation></semantics></math> are the knowledge-aware question representation and visual representation at step <math id="Sx3.SSx3.p2.26.m3.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="Sx3.SSx3.p2.26.m3.1a"><mrow id="Sx3.SSx3.p2.26.m3.1.1" xref="Sx3.SSx3.p2.26.m3.1.1.cmml"><mi id="Sx3.SSx3.p2.26.m3.1.1.2" xref="Sx3.SSx3.p2.26.m3.1.1.2.cmml">t</mi><mo id="Sx3.SSx3.p2.26.m3.1.1.1" xref="Sx3.SSx3.p2.26.m3.1.1.1.cmml">−</mo><mn id="Sx3.SSx3.p2.26.m3.1.1.3" xref="Sx3.SSx3.p2.26.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.26.m3.1b"><apply id="Sx3.SSx3.p2.26.m3.1.1.cmml" xref="Sx3.SSx3.p2.26.m3.1.1"><minus id="Sx3.SSx3.p2.26.m3.1.1.1.cmml" xref="Sx3.SSx3.p2.26.m3.1.1.1"></minus><ci id="Sx3.SSx3.p2.26.m3.1.1.2.cmml" xref="Sx3.SSx3.p2.26.m3.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx3.p2.26.m3.1.1.3.cmml" xref="Sx3.SSx3.p2.26.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.26.m3.1c">t-1</annotation></semantics></math>, respectively, which are explained in details below.</p>
</div>
<div id="Sx3.SSx3.p3" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p3.3" class="ltx_p"><span id="Sx3.SSx3.p3.3.1" class="ltx_text ltx_font_bold">Key Addressing and Value Reading.</span> Key addressing is a process that involves finding the most relevant knowledge triplet for a given question. Following previous work <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite>, we compute the relevance probability <math id="Sx3.SSx3.p3.1.m1.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="Sx3.SSx3.p3.1.m1.1a"><msub id="Sx3.SSx3.p3.1.m1.1.1" xref="Sx3.SSx3.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p3.1.m1.1.1.2" xref="Sx3.SSx3.p3.1.m1.1.1.2.cmml">p</mi><mi id="Sx3.SSx3.p3.1.m1.1.1.3" xref="Sx3.SSx3.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.1.m1.1b"><apply id="Sx3.SSx3.p3.1.m1.1.1.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p3.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p3.1.m1.1.1.2">𝑝</ci><ci id="Sx3.SSx3.p3.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.1.m1.1c">p_{i}</annotation></semantics></math> between the question representation <math id="Sx3.SSx3.p3.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="Sx3.SSx3.p3.2.m2.1a"><mi id="Sx3.SSx3.p3.2.m2.1.1" xref="Sx3.SSx3.p3.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.2.m2.1b"><ci id="Sx3.SSx3.p3.2.m2.1.1.cmml" xref="Sx3.SSx3.p3.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.2.m2.1c">q</annotation></semantics></math> and each key representation <math id="Sx3.SSx3.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx3.SSx3.p3.3.m3.1a"><mi id="Sx3.SSx3.p3.3.m3.1.1" xref="Sx3.SSx3.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.3.m3.1b"><ci id="Sx3.SSx3.p3.3.m3.1.1.cmml" xref="Sx3.SSx3.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.3.m3.1c">k</annotation></semantics></math> as:</p>
<table id="A0.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle\hat{q}" display="inline"><semantics id="Sx3.Ex5.m1.1a"><mover accent="true" id="Sx3.Ex5.m1.1.1" xref="Sx3.Ex5.m1.1.1.cmml"><mi id="Sx3.Ex5.m1.1.1.2" xref="Sx3.Ex5.m1.1.1.2.cmml">q</mi><mo id="Sx3.Ex5.m1.1.1.1" xref="Sx3.Ex5.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.Ex5.m1.1b"><apply id="Sx3.Ex5.m1.1.1.cmml" xref="Sx3.Ex5.m1.1.1"><ci id="Sx3.Ex5.m1.1.1.1.cmml" xref="Sx3.Ex5.m1.1.1.1">^</ci><ci id="Sx3.Ex5.m1.1.1.2.cmml" xref="Sx3.Ex5.m1.1.1.2">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex5.m1.1c">\displaystyle\hat{q}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex5.m2.1" class="ltx_math_unparsed" alttext="\displaystyle=ReLU(W_{6}(ReLU(W_{7}q)" display="inline"><semantics id="Sx3.Ex5.m2.1a"><mrow id="Sx3.Ex5.m2.1b"><mo id="Sx3.Ex5.m2.1.1">=</mo><mi id="Sx3.Ex5.m2.1.2">R</mi><mi id="Sx3.Ex5.m2.1.3">e</mi><mi id="Sx3.Ex5.m2.1.4">L</mi><mi id="Sx3.Ex5.m2.1.5">U</mi><mrow id="Sx3.Ex5.m2.1.6"><mo stretchy="false" id="Sx3.Ex5.m2.1.6.1">(</mo><msub id="Sx3.Ex5.m2.1.6.2"><mi id="Sx3.Ex5.m2.1.6.2.2">W</mi><mn id="Sx3.Ex5.m2.1.6.2.3">6</mn></msub><mrow id="Sx3.Ex5.m2.1.6.3"><mo stretchy="false" id="Sx3.Ex5.m2.1.6.3.1">(</mo><mi id="Sx3.Ex5.m2.1.6.3.2">R</mi><mi id="Sx3.Ex5.m2.1.6.3.3">e</mi><mi id="Sx3.Ex5.m2.1.6.3.4">L</mi><mi id="Sx3.Ex5.m2.1.6.3.5">U</mi><mrow id="Sx3.Ex5.m2.1.6.3.6"><mo stretchy="false" id="Sx3.Ex5.m2.1.6.3.6.1">(</mo><msub id="Sx3.Ex5.m2.1.6.3.6.2"><mi id="Sx3.Ex5.m2.1.6.3.6.2.2">W</mi><mn id="Sx3.Ex5.m2.1.6.3.6.2.3">7</mn></msub><mi id="Sx3.Ex5.m2.1.6.3.6.3">q</mi><mo stretchy="false" id="Sx3.Ex5.m2.1.6.3.6.4">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.Ex5.m2.1c">\displaystyle=ReLU(W_{6}(ReLU(W_{7}q)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle\hat{k}_{i}" display="inline"><semantics id="Sx3.Ex6.m1.1a"><msub id="Sx3.Ex6.m1.1.1" xref="Sx3.Ex6.m1.1.1.cmml"><mover accent="true" id="Sx3.Ex6.m1.1.1.2" xref="Sx3.Ex6.m1.1.1.2.cmml"><mi id="Sx3.Ex6.m1.1.1.2.2" xref="Sx3.Ex6.m1.1.1.2.2.cmml">k</mi><mo id="Sx3.Ex6.m1.1.1.2.1" xref="Sx3.Ex6.m1.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.Ex6.m1.1.1.3" xref="Sx3.Ex6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.Ex6.m1.1b"><apply id="Sx3.Ex6.m1.1.1.cmml" xref="Sx3.Ex6.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex6.m1.1.1.1.cmml" xref="Sx3.Ex6.m1.1.1">subscript</csymbol><apply id="Sx3.Ex6.m1.1.1.2.cmml" xref="Sx3.Ex6.m1.1.1.2"><ci id="Sx3.Ex6.m1.1.1.2.1.cmml" xref="Sx3.Ex6.m1.1.1.2.1">^</ci><ci id="Sx3.Ex6.m1.1.1.2.2.cmml" xref="Sx3.Ex6.m1.1.1.2.2">𝑘</ci></apply><ci id="Sx3.Ex6.m1.1.1.3.cmml" xref="Sx3.Ex6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex6.m1.1c">\displaystyle\hat{k}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex6.m2.1" class="ltx_math_unparsed" alttext="\displaystyle=ReLU(W_{8}(ReLU(W_{9}k_{i})" display="inline"><semantics id="Sx3.Ex6.m2.1a"><mrow id="Sx3.Ex6.m2.1b"><mo id="Sx3.Ex6.m2.1.1">=</mo><mi id="Sx3.Ex6.m2.1.2">R</mi><mi id="Sx3.Ex6.m2.1.3">e</mi><mi id="Sx3.Ex6.m2.1.4">L</mi><mi id="Sx3.Ex6.m2.1.5">U</mi><mrow id="Sx3.Ex6.m2.1.6"><mo stretchy="false" id="Sx3.Ex6.m2.1.6.1">(</mo><msub id="Sx3.Ex6.m2.1.6.2"><mi id="Sx3.Ex6.m2.1.6.2.2">W</mi><mn id="Sx3.Ex6.m2.1.6.2.3">8</mn></msub><mrow id="Sx3.Ex6.m2.1.6.3"><mo stretchy="false" id="Sx3.Ex6.m2.1.6.3.1">(</mo><mi id="Sx3.Ex6.m2.1.6.3.2">R</mi><mi id="Sx3.Ex6.m2.1.6.3.3">e</mi><mi id="Sx3.Ex6.m2.1.6.3.4">L</mi><mi id="Sx3.Ex6.m2.1.6.3.5">U</mi><mrow id="Sx3.Ex6.m2.1.6.3.6"><mo stretchy="false" id="Sx3.Ex6.m2.1.6.3.6.1">(</mo><msub id="Sx3.Ex6.m2.1.6.3.6.2"><mi id="Sx3.Ex6.m2.1.6.3.6.2.2">W</mi><mn id="Sx3.Ex6.m2.1.6.3.6.2.3">9</mn></msub><msub id="Sx3.Ex6.m2.1.6.3.6.3"><mi id="Sx3.Ex6.m2.1.6.3.6.3.2">k</mi><mi id="Sx3.Ex6.m2.1.6.3.6.3.3">i</mi></msub><mo stretchy="false" id="Sx3.Ex6.m2.1.6.3.6.4">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.Ex6.m2.1c">\displaystyle=ReLU(W_{8}(ReLU(W_{9}k_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex7.m1.1" class="ltx_Math" alttext="\displaystyle p_{i}" display="inline"><semantics id="Sx3.Ex7.m1.1a"><msub id="Sx3.Ex7.m1.1.1" xref="Sx3.Ex7.m1.1.1.cmml"><mi id="Sx3.Ex7.m1.1.1.2" xref="Sx3.Ex7.m1.1.1.2.cmml">p</mi><mi id="Sx3.Ex7.m1.1.1.3" xref="Sx3.Ex7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.Ex7.m1.1b"><apply id="Sx3.Ex7.m1.1.1.cmml" xref="Sx3.Ex7.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex7.m1.1.1.1.cmml" xref="Sx3.Ex7.m1.1.1">subscript</csymbol><ci id="Sx3.Ex7.m1.1.1.2.cmml" xref="Sx3.Ex7.m1.1.1.2">𝑝</ci><ci id="Sx3.Ex7.m1.1.1.3.cmml" xref="Sx3.Ex7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex7.m1.1c">\displaystyle p_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex7.m2.1" class="ltx_Math" alttext="\displaystyle=softmax(\hat{q}\cdot\hat{k}_{i}^{T})" display="inline"><semantics id="Sx3.Ex7.m2.1a"><mrow id="Sx3.Ex7.m2.1.1" xref="Sx3.Ex7.m2.1.1.cmml"><mi id="Sx3.Ex7.m2.1.1.3" xref="Sx3.Ex7.m2.1.1.3.cmml"></mi><mo id="Sx3.Ex7.m2.1.1.2" xref="Sx3.Ex7.m2.1.1.2.cmml">=</mo><mrow id="Sx3.Ex7.m2.1.1.1" xref="Sx3.Ex7.m2.1.1.1.cmml"><mi id="Sx3.Ex7.m2.1.1.1.3" xref="Sx3.Ex7.m2.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.4" xref="Sx3.Ex7.m2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2a" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.5" xref="Sx3.Ex7.m2.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2b" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.6" xref="Sx3.Ex7.m2.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2c" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.7" xref="Sx3.Ex7.m2.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2d" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.8" xref="Sx3.Ex7.m2.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2e" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex7.m2.1.1.1.9" xref="Sx3.Ex7.m2.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex7.m2.1.1.1.2f" xref="Sx3.Ex7.m2.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex7.m2.1.1.1.1.1" xref="Sx3.Ex7.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex7.m2.1.1.1.1.1.2" xref="Sx3.Ex7.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex7.m2.1.1.1.1.1.1" xref="Sx3.Ex7.m2.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.Ex7.m2.1.1.1.1.1.1.2" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex7.m2.1.1.1.1.1.1.2.2" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2.2.cmml">q</mi><mo id="Sx3.Ex7.m2.1.1.1.1.1.1.2.1" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo lspace="0.222em" rspace="0.222em" id="Sx3.Ex7.m2.1.1.1.1.1.1.1" xref="Sx3.Ex7.m2.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="Sx3.Ex7.m2.1.1.1.1.1.1.3" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.2" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.2.cmml">k</mi><mo id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.1" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.3" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="Sx3.Ex7.m2.1.1.1.1.1.1.3.3" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup></mrow><mo stretchy="false" id="Sx3.Ex7.m2.1.1.1.1.1.3" xref="Sx3.Ex7.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex7.m2.1b"><apply id="Sx3.Ex7.m2.1.1.cmml" xref="Sx3.Ex7.m2.1.1"><eq id="Sx3.Ex7.m2.1.1.2.cmml" xref="Sx3.Ex7.m2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.Ex7.m2.1.1.3.cmml" xref="Sx3.Ex7.m2.1.1.3">absent</csymbol><apply id="Sx3.Ex7.m2.1.1.1.cmml" xref="Sx3.Ex7.m2.1.1.1"><times id="Sx3.Ex7.m2.1.1.1.2.cmml" xref="Sx3.Ex7.m2.1.1.1.2"></times><ci id="Sx3.Ex7.m2.1.1.1.3.cmml" xref="Sx3.Ex7.m2.1.1.1.3">𝑠</ci><ci id="Sx3.Ex7.m2.1.1.1.4.cmml" xref="Sx3.Ex7.m2.1.1.1.4">𝑜</ci><ci id="Sx3.Ex7.m2.1.1.1.5.cmml" xref="Sx3.Ex7.m2.1.1.1.5">𝑓</ci><ci id="Sx3.Ex7.m2.1.1.1.6.cmml" xref="Sx3.Ex7.m2.1.1.1.6">𝑡</ci><ci id="Sx3.Ex7.m2.1.1.1.7.cmml" xref="Sx3.Ex7.m2.1.1.1.7">𝑚</ci><ci id="Sx3.Ex7.m2.1.1.1.8.cmml" xref="Sx3.Ex7.m2.1.1.1.8">𝑎</ci><ci id="Sx3.Ex7.m2.1.1.1.9.cmml" xref="Sx3.Ex7.m2.1.1.1.9">𝑥</ci><apply id="Sx3.Ex7.m2.1.1.1.1.1.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1"><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.1">⋅</ci><apply id="Sx3.Ex7.m2.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2"><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.2.2">𝑞</ci></apply><apply id="Sx3.Ex7.m2.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex7.m2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2"><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.2.2">𝑘</ci></apply><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx3.Ex7.m2.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex7.m2.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex7.m2.1c">\displaystyle=softmax(\hat{q}\cdot\hat{k}_{i}^{T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p3.4" class="ltx_p">As each value of our key-value memory module contains all three elements (subject, relation and object) of a triplet, we further apply an attention mechanism to compute the question-guided value embedding <math id="Sx3.SSx3.p3.4.m1.1" class="ltx_Math" alttext="\hat{t}_{i}" display="inline"><semantics id="Sx3.SSx3.p3.4.m1.1a"><msub id="Sx3.SSx3.p3.4.m1.1.1" xref="Sx3.SSx3.p3.4.m1.1.1.cmml"><mover accent="true" id="Sx3.SSx3.p3.4.m1.1.1.2" xref="Sx3.SSx3.p3.4.m1.1.1.2.cmml"><mi id="Sx3.SSx3.p3.4.m1.1.1.2.2" xref="Sx3.SSx3.p3.4.m1.1.1.2.2.cmml">t</mi><mo id="Sx3.SSx3.p3.4.m1.1.1.2.1" xref="Sx3.SSx3.p3.4.m1.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx3.p3.4.m1.1.1.3" xref="Sx3.SSx3.p3.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.4.m1.1b"><apply id="Sx3.SSx3.p3.4.m1.1.1.cmml" xref="Sx3.SSx3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.4.m1.1.1.1.cmml" xref="Sx3.SSx3.p3.4.m1.1.1">subscript</csymbol><apply id="Sx3.SSx3.p3.4.m1.1.1.2.cmml" xref="Sx3.SSx3.p3.4.m1.1.1.2"><ci id="Sx3.SSx3.p3.4.m1.1.1.2.1.cmml" xref="Sx3.SSx3.p3.4.m1.1.1.2.1">^</ci><ci id="Sx3.SSx3.p3.4.m1.1.1.2.2.cmml" xref="Sx3.SSx3.p3.4.m1.1.1.2.2">𝑡</ci></apply><ci id="Sx3.SSx3.p3.4.m1.1.1.3.cmml" xref="Sx3.SSx3.p3.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.4.m1.1c">\hat{t}_{i}</annotation></semantics></math> for each value:</p>
<table id="A0.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex8.m1.1" class="ltx_Math" alttext="\displaystyle\hat{t}_{ij}" display="inline"><semantics id="Sx3.Ex8.m1.1a"><msub id="Sx3.Ex8.m1.1.1" xref="Sx3.Ex8.m1.1.1.cmml"><mover accent="true" id="Sx3.Ex8.m1.1.1.2" xref="Sx3.Ex8.m1.1.1.2.cmml"><mi id="Sx3.Ex8.m1.1.1.2.2" xref="Sx3.Ex8.m1.1.1.2.2.cmml">t</mi><mo id="Sx3.Ex8.m1.1.1.2.1" xref="Sx3.Ex8.m1.1.1.2.1.cmml">^</mo></mover><mrow id="Sx3.Ex8.m1.1.1.3" xref="Sx3.Ex8.m1.1.1.3.cmml"><mi id="Sx3.Ex8.m1.1.1.3.2" xref="Sx3.Ex8.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex8.m1.1.1.3.1" xref="Sx3.Ex8.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.Ex8.m1.1.1.3.3" xref="Sx3.Ex8.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.Ex8.m1.1b"><apply id="Sx3.Ex8.m1.1.1.cmml" xref="Sx3.Ex8.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex8.m1.1.1.1.cmml" xref="Sx3.Ex8.m1.1.1">subscript</csymbol><apply id="Sx3.Ex8.m1.1.1.2.cmml" xref="Sx3.Ex8.m1.1.1.2"><ci id="Sx3.Ex8.m1.1.1.2.1.cmml" xref="Sx3.Ex8.m1.1.1.2.1">^</ci><ci id="Sx3.Ex8.m1.1.1.2.2.cmml" xref="Sx3.Ex8.m1.1.1.2.2">𝑡</ci></apply><apply id="Sx3.Ex8.m1.1.1.3.cmml" xref="Sx3.Ex8.m1.1.1.3"><times id="Sx3.Ex8.m1.1.1.3.1.cmml" xref="Sx3.Ex8.m1.1.1.3.1"></times><ci id="Sx3.Ex8.m1.1.1.3.2.cmml" xref="Sx3.Ex8.m1.1.1.3.2">𝑖</ci><ci id="Sx3.Ex8.m1.1.1.3.3.cmml" xref="Sx3.Ex8.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex8.m1.1c">\displaystyle\hat{t}_{ij}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex8.m2.1" class="ltx_math_unparsed" alttext="\displaystyle=ReLU(W_{10}(ReLU(W_{11}t_{ij}))" display="inline"><semantics id="Sx3.Ex8.m2.1a"><mrow id="Sx3.Ex8.m2.1b"><mo id="Sx3.Ex8.m2.1.1">=</mo><mi id="Sx3.Ex8.m2.1.2">R</mi><mi id="Sx3.Ex8.m2.1.3">e</mi><mi id="Sx3.Ex8.m2.1.4">L</mi><mi id="Sx3.Ex8.m2.1.5">U</mi><mrow id="Sx3.Ex8.m2.1.6"><mo stretchy="false" id="Sx3.Ex8.m2.1.6.1">(</mo><msub id="Sx3.Ex8.m2.1.6.2"><mi id="Sx3.Ex8.m2.1.6.2.2">W</mi><mn id="Sx3.Ex8.m2.1.6.2.3">10</mn></msub><mrow id="Sx3.Ex8.m2.1.6.3"><mo stretchy="false" id="Sx3.Ex8.m2.1.6.3.1">(</mo><mi id="Sx3.Ex8.m2.1.6.3.2">R</mi><mi id="Sx3.Ex8.m2.1.6.3.3">e</mi><mi id="Sx3.Ex8.m2.1.6.3.4">L</mi><mi id="Sx3.Ex8.m2.1.6.3.5">U</mi><mrow id="Sx3.Ex8.m2.1.6.3.6"><mo stretchy="false" id="Sx3.Ex8.m2.1.6.3.6.1">(</mo><msub id="Sx3.Ex8.m2.1.6.3.6.2"><mi id="Sx3.Ex8.m2.1.6.3.6.2.2">W</mi><mn id="Sx3.Ex8.m2.1.6.3.6.2.3">11</mn></msub><msub id="Sx3.Ex8.m2.1.6.3.6.3"><mi id="Sx3.Ex8.m2.1.6.3.6.3.2">t</mi><mrow id="Sx3.Ex8.m2.1.6.3.6.3.3"><mi id="Sx3.Ex8.m2.1.6.3.6.3.3.2">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex8.m2.1.6.3.6.3.3.1">​</mo><mi id="Sx3.Ex8.m2.1.6.3.6.3.3.3">j</mi></mrow></msub><mo stretchy="false" id="Sx3.Ex8.m2.1.6.3.6.4">)</mo></mrow><mo stretchy="false" id="Sx3.Ex8.m2.1.6.3.7">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.Ex8.m2.1c">\displaystyle=ReLU(W_{10}(ReLU(W_{11}t_{ij}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex9.m1.1" class="ltx_Math" alttext="\displaystyle s_{ij}" display="inline"><semantics id="Sx3.Ex9.m1.1a"><msub id="Sx3.Ex9.m1.1.1" xref="Sx3.Ex9.m1.1.1.cmml"><mi id="Sx3.Ex9.m1.1.1.2" xref="Sx3.Ex9.m1.1.1.2.cmml">s</mi><mrow id="Sx3.Ex9.m1.1.1.3" xref="Sx3.Ex9.m1.1.1.3.cmml"><mi id="Sx3.Ex9.m1.1.1.3.2" xref="Sx3.Ex9.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m1.1.1.3.1" xref="Sx3.Ex9.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.Ex9.m1.1.1.3.3" xref="Sx3.Ex9.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.Ex9.m1.1b"><apply id="Sx3.Ex9.m1.1.1.cmml" xref="Sx3.Ex9.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex9.m1.1.1.1.cmml" xref="Sx3.Ex9.m1.1.1">subscript</csymbol><ci id="Sx3.Ex9.m1.1.1.2.cmml" xref="Sx3.Ex9.m1.1.1.2">𝑠</ci><apply id="Sx3.Ex9.m1.1.1.3.cmml" xref="Sx3.Ex9.m1.1.1.3"><times id="Sx3.Ex9.m1.1.1.3.1.cmml" xref="Sx3.Ex9.m1.1.1.3.1"></times><ci id="Sx3.Ex9.m1.1.1.3.2.cmml" xref="Sx3.Ex9.m1.1.1.3.2">𝑖</ci><ci id="Sx3.Ex9.m1.1.1.3.3.cmml" xref="Sx3.Ex9.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex9.m1.1c">\displaystyle s_{ij}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex9.m2.1" class="ltx_Math" alttext="\displaystyle=(1-softmax(\hat{q}\cdot\hat{t}_{ij}^{T}))/2.0" display="inline"><semantics id="Sx3.Ex9.m2.1a"><mrow id="Sx3.Ex9.m2.1.1" xref="Sx3.Ex9.m2.1.1.cmml"><mi id="Sx3.Ex9.m2.1.1.3" xref="Sx3.Ex9.m2.1.1.3.cmml"></mi><mo id="Sx3.Ex9.m2.1.1.2" xref="Sx3.Ex9.m2.1.1.2.cmml">=</mo><mrow id="Sx3.Ex9.m2.1.1.1" xref="Sx3.Ex9.m2.1.1.1.cmml"><mrow id="Sx3.Ex9.m2.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex9.m2.1.1.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex9.m2.1.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.cmml"><mn id="Sx3.Ex9.m2.1.1.1.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.3.cmml">1</mn><mo id="Sx3.Ex9.m2.1.1.1.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="Sx3.Ex9.m2.1.1.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.4" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2a" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.5" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2b" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.6" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2c" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.7" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2d" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.8" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2e" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.9" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2f" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mo id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo lspace="0.222em" rspace="0.222em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">t</mi><mo id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">j</mi></mrow><mi id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup></mrow><mo stretchy="false" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.Ex9.m2.1.1.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx3.Ex9.m2.1.1.1.2" xref="Sx3.Ex9.m2.1.1.1.2.cmml">/</mo><mn id="Sx3.Ex9.m2.1.1.1.3" xref="Sx3.Ex9.m2.1.1.1.3.cmml">2.0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex9.m2.1b"><apply id="Sx3.Ex9.m2.1.1.cmml" xref="Sx3.Ex9.m2.1.1"><eq id="Sx3.Ex9.m2.1.1.2.cmml" xref="Sx3.Ex9.m2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.Ex9.m2.1.1.3.cmml" xref="Sx3.Ex9.m2.1.1.3">absent</csymbol><apply id="Sx3.Ex9.m2.1.1.1.cmml" xref="Sx3.Ex9.m2.1.1.1"><divide id="Sx3.Ex9.m2.1.1.1.2.cmml" xref="Sx3.Ex9.m2.1.1.1.2"></divide><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1"><minus id="Sx3.Ex9.m2.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.2"></minus><cn type="integer" id="Sx3.Ex9.m2.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.3">1</cn><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1"><times id="Sx3.Ex9.m2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.2"></times><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.3">𝑠</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.4">𝑜</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.5">𝑓</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.6.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.6">𝑡</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.7.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.7">𝑚</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.8.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.8">𝑎</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.9.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.9">𝑥</ci><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1"><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2"><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝑞</ci></apply><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑡</ci></apply><apply id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex9.m2.1.1.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply><cn type="float" id="Sx3.Ex9.m2.1.1.1.3.cmml" xref="Sx3.Ex9.m2.1.1.1.3">2.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex9.m2.1c">\displaystyle=(1-softmax(\hat{q}\cdot\hat{t}_{ij}^{T}))/2.0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex10.m1.1" class="ltx_Math" alttext="\displaystyle\hat{t_{i}}" display="inline"><semantics id="Sx3.Ex10.m1.1a"><mover accent="true" id="Sx3.Ex10.m1.1.1" xref="Sx3.Ex10.m1.1.1.cmml"><msub id="Sx3.Ex10.m1.1.1.2" xref="Sx3.Ex10.m1.1.1.2.cmml"><mi id="Sx3.Ex10.m1.1.1.2.2" xref="Sx3.Ex10.m1.1.1.2.2.cmml">t</mi><mi id="Sx3.Ex10.m1.1.1.2.3" xref="Sx3.Ex10.m1.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.Ex10.m1.1.1.1" xref="Sx3.Ex10.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx3.Ex10.m1.1b"><apply id="Sx3.Ex10.m1.1.1.cmml" xref="Sx3.Ex10.m1.1.1"><ci id="Sx3.Ex10.m1.1.1.1.cmml" xref="Sx3.Ex10.m1.1.1.1">^</ci><apply id="Sx3.Ex10.m1.1.1.2.cmml" xref="Sx3.Ex10.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex10.m1.1.1.2.1.cmml" xref="Sx3.Ex10.m1.1.1.2">subscript</csymbol><ci id="Sx3.Ex10.m1.1.1.2.2.cmml" xref="Sx3.Ex10.m1.1.1.2.2">𝑡</ci><ci id="Sx3.Ex10.m1.1.1.2.3.cmml" xref="Sx3.Ex10.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex10.m1.1c">\displaystyle\hat{t_{i}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex10.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{j=1}^{J}s_{ij}\hat{t}_{ij}" display="inline"><semantics id="Sx3.Ex10.m2.1a"><mrow id="Sx3.Ex10.m2.1.1" xref="Sx3.Ex10.m2.1.1.cmml"><mi id="Sx3.Ex10.m2.1.1.2" xref="Sx3.Ex10.m2.1.1.2.cmml"></mi><mo id="Sx3.Ex10.m2.1.1.1" xref="Sx3.Ex10.m2.1.1.1.cmml">=</mo><mrow id="Sx3.Ex10.m2.1.1.3" xref="Sx3.Ex10.m2.1.1.3.cmml"><mstyle displaystyle="true" id="Sx3.Ex10.m2.1.1.3.1" xref="Sx3.Ex10.m2.1.1.3.1.cmml"><munderover id="Sx3.Ex10.m2.1.1.3.1a" xref="Sx3.Ex10.m2.1.1.3.1.cmml"><mo movablelimits="false" id="Sx3.Ex10.m2.1.1.3.1.2.2" xref="Sx3.Ex10.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx3.Ex10.m2.1.1.3.1.2.3" xref="Sx3.Ex10.m2.1.1.3.1.2.3.cmml"><mi id="Sx3.Ex10.m2.1.1.3.1.2.3.2" xref="Sx3.Ex10.m2.1.1.3.1.2.3.2.cmml">j</mi><mo id="Sx3.Ex10.m2.1.1.3.1.2.3.1" xref="Sx3.Ex10.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="Sx3.Ex10.m2.1.1.3.1.2.3.3" xref="Sx3.Ex10.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex10.m2.1.1.3.1.3" xref="Sx3.Ex10.m2.1.1.3.1.3.cmml">J</mi></munderover></mstyle><mrow id="Sx3.Ex10.m2.1.1.3.2" xref="Sx3.Ex10.m2.1.1.3.2.cmml"><msub id="Sx3.Ex10.m2.1.1.3.2.2" xref="Sx3.Ex10.m2.1.1.3.2.2.cmml"><mi id="Sx3.Ex10.m2.1.1.3.2.2.2" xref="Sx3.Ex10.m2.1.1.3.2.2.2.cmml">s</mi><mrow id="Sx3.Ex10.m2.1.1.3.2.2.3" xref="Sx3.Ex10.m2.1.1.3.2.2.3.cmml"><mi id="Sx3.Ex10.m2.1.1.3.2.2.3.2" xref="Sx3.Ex10.m2.1.1.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex10.m2.1.1.3.2.2.3.1" xref="Sx3.Ex10.m2.1.1.3.2.2.3.1.cmml">​</mo><mi id="Sx3.Ex10.m2.1.1.3.2.2.3.3" xref="Sx3.Ex10.m2.1.1.3.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex10.m2.1.1.3.2.1" xref="Sx3.Ex10.m2.1.1.3.2.1.cmml">​</mo><msub id="Sx3.Ex10.m2.1.1.3.2.3" xref="Sx3.Ex10.m2.1.1.3.2.3.cmml"><mover accent="true" id="Sx3.Ex10.m2.1.1.3.2.3.2" xref="Sx3.Ex10.m2.1.1.3.2.3.2.cmml"><mi id="Sx3.Ex10.m2.1.1.3.2.3.2.2" xref="Sx3.Ex10.m2.1.1.3.2.3.2.2.cmml">t</mi><mo id="Sx3.Ex10.m2.1.1.3.2.3.2.1" xref="Sx3.Ex10.m2.1.1.3.2.3.2.1.cmml">^</mo></mover><mrow id="Sx3.Ex10.m2.1.1.3.2.3.3" xref="Sx3.Ex10.m2.1.1.3.2.3.3.cmml"><mi id="Sx3.Ex10.m2.1.1.3.2.3.3.2" xref="Sx3.Ex10.m2.1.1.3.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex10.m2.1.1.3.2.3.3.1" xref="Sx3.Ex10.m2.1.1.3.2.3.3.1.cmml">​</mo><mi id="Sx3.Ex10.m2.1.1.3.2.3.3.3" xref="Sx3.Ex10.m2.1.1.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex10.m2.1b"><apply id="Sx3.Ex10.m2.1.1.cmml" xref="Sx3.Ex10.m2.1.1"><eq id="Sx3.Ex10.m2.1.1.1.cmml" xref="Sx3.Ex10.m2.1.1.1"></eq><csymbol cd="latexml" id="Sx3.Ex10.m2.1.1.2.cmml" xref="Sx3.Ex10.m2.1.1.2">absent</csymbol><apply id="Sx3.Ex10.m2.1.1.3.cmml" xref="Sx3.Ex10.m2.1.1.3"><apply id="Sx3.Ex10.m2.1.1.3.1.cmml" xref="Sx3.Ex10.m2.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex10.m2.1.1.3.1.1.cmml" xref="Sx3.Ex10.m2.1.1.3.1">superscript</csymbol><apply id="Sx3.Ex10.m2.1.1.3.1.2.cmml" xref="Sx3.Ex10.m2.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex10.m2.1.1.3.1.2.1.cmml" xref="Sx3.Ex10.m2.1.1.3.1">subscript</csymbol><sum id="Sx3.Ex10.m2.1.1.3.1.2.2.cmml" xref="Sx3.Ex10.m2.1.1.3.1.2.2"></sum><apply id="Sx3.Ex10.m2.1.1.3.1.2.3.cmml" xref="Sx3.Ex10.m2.1.1.3.1.2.3"><eq id="Sx3.Ex10.m2.1.1.3.1.2.3.1.cmml" xref="Sx3.Ex10.m2.1.1.3.1.2.3.1"></eq><ci id="Sx3.Ex10.m2.1.1.3.1.2.3.2.cmml" xref="Sx3.Ex10.m2.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="Sx3.Ex10.m2.1.1.3.1.2.3.3.cmml" xref="Sx3.Ex10.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex10.m2.1.1.3.1.3.cmml" xref="Sx3.Ex10.m2.1.1.3.1.3">𝐽</ci></apply><apply id="Sx3.Ex10.m2.1.1.3.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2"><times id="Sx3.Ex10.m2.1.1.3.2.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.1"></times><apply id="Sx3.Ex10.m2.1.1.3.2.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex10.m2.1.1.3.2.2.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2">subscript</csymbol><ci id="Sx3.Ex10.m2.1.1.3.2.2.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2.2">𝑠</ci><apply id="Sx3.Ex10.m2.1.1.3.2.2.3.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2.3"><times id="Sx3.Ex10.m2.1.1.3.2.2.3.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2.3.1"></times><ci id="Sx3.Ex10.m2.1.1.3.2.2.3.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2.3.2">𝑖</ci><ci id="Sx3.Ex10.m2.1.1.3.2.2.3.3.cmml" xref="Sx3.Ex10.m2.1.1.3.2.2.3.3">𝑗</ci></apply></apply><apply id="Sx3.Ex10.m2.1.1.3.2.3.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx3.Ex10.m2.1.1.3.2.3.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3">subscript</csymbol><apply id="Sx3.Ex10.m2.1.1.3.2.3.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.2"><ci id="Sx3.Ex10.m2.1.1.3.2.3.2.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.2.1">^</ci><ci id="Sx3.Ex10.m2.1.1.3.2.3.2.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.2.2">𝑡</ci></apply><apply id="Sx3.Ex10.m2.1.1.3.2.3.3.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.3"><times id="Sx3.Ex10.m2.1.1.3.2.3.3.1.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.3.1"></times><ci id="Sx3.Ex10.m2.1.1.3.2.3.3.2.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.3.2">𝑖</ci><ci id="Sx3.Ex10.m2.1.1.3.2.3.3.3.cmml" xref="Sx3.Ex10.m2.1.1.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex10.m2.1c">\displaystyle=\sum_{j=1}^{J}s_{ij}\hat{t}_{ij}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p3.9" class="ltx_p">where <math id="Sx3.SSx3.p3.5.m1.1" class="ltx_Math" alttext="J=3" display="inline"><semantics id="Sx3.SSx3.p3.5.m1.1a"><mrow id="Sx3.SSx3.p3.5.m1.1.1" xref="Sx3.SSx3.p3.5.m1.1.1.cmml"><mi id="Sx3.SSx3.p3.5.m1.1.1.2" xref="Sx3.SSx3.p3.5.m1.1.1.2.cmml">J</mi><mo id="Sx3.SSx3.p3.5.m1.1.1.1" xref="Sx3.SSx3.p3.5.m1.1.1.1.cmml">=</mo><mn id="Sx3.SSx3.p3.5.m1.1.1.3" xref="Sx3.SSx3.p3.5.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.5.m1.1b"><apply id="Sx3.SSx3.p3.5.m1.1.1.cmml" xref="Sx3.SSx3.p3.5.m1.1.1"><eq id="Sx3.SSx3.p3.5.m1.1.1.1.cmml" xref="Sx3.SSx3.p3.5.m1.1.1.1"></eq><ci id="Sx3.SSx3.p3.5.m1.1.1.2.cmml" xref="Sx3.SSx3.p3.5.m1.1.1.2">𝐽</ci><cn type="integer" id="Sx3.SSx3.p3.5.m1.1.1.3.cmml" xref="Sx3.SSx3.p3.5.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.5.m1.1c">J=3</annotation></semantics></math> is the number of elements of a triplet; <math id="Sx3.SSx3.p3.6.m2.1" class="ltx_Math" alttext="s_{ij}" display="inline"><semantics id="Sx3.SSx3.p3.6.m2.1a"><msub id="Sx3.SSx3.p3.6.m2.1.1" xref="Sx3.SSx3.p3.6.m2.1.1.cmml"><mi id="Sx3.SSx3.p3.6.m2.1.1.2" xref="Sx3.SSx3.p3.6.m2.1.1.2.cmml">s</mi><mrow id="Sx3.SSx3.p3.6.m2.1.1.3" xref="Sx3.SSx3.p3.6.m2.1.1.3.cmml"><mi id="Sx3.SSx3.p3.6.m2.1.1.3.2" xref="Sx3.SSx3.p3.6.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p3.6.m2.1.1.3.1" xref="Sx3.SSx3.p3.6.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p3.6.m2.1.1.3.3" xref="Sx3.SSx3.p3.6.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.6.m2.1b"><apply id="Sx3.SSx3.p3.6.m2.1.1.cmml" xref="Sx3.SSx3.p3.6.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.6.m2.1.1.1.cmml" xref="Sx3.SSx3.p3.6.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p3.6.m2.1.1.2.cmml" xref="Sx3.SSx3.p3.6.m2.1.1.2">𝑠</ci><apply id="Sx3.SSx3.p3.6.m2.1.1.3.cmml" xref="Sx3.SSx3.p3.6.m2.1.1.3"><times id="Sx3.SSx3.p3.6.m2.1.1.3.1.cmml" xref="Sx3.SSx3.p3.6.m2.1.1.3.1"></times><ci id="Sx3.SSx3.p3.6.m2.1.1.3.2.cmml" xref="Sx3.SSx3.p3.6.m2.1.1.3.2">𝑖</ci><ci id="Sx3.SSx3.p3.6.m2.1.1.3.3.cmml" xref="Sx3.SSx3.p3.6.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.6.m2.1c">s_{ij}</annotation></semantics></math> is the attention probability of each component in a knowledge triplet, and the divisor <math id="Sx3.SSx3.p3.7.m3.1" class="ltx_Math" alttext="2.0" display="inline"><semantics id="Sx3.SSx3.p3.7.m3.1a"><mn id="Sx3.SSx3.p3.7.m3.1.1" xref="Sx3.SSx3.p3.7.m3.1.1.cmml">2.0</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.7.m3.1b"><cn type="float" id="Sx3.SSx3.p3.7.m3.1.1.cmml" xref="Sx3.SSx3.p3.7.m3.1.1">2.0</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.7.m3.1c">2.0</annotation></semantics></math> is a normalization factor (normalize the sum of <math id="Sx3.SSx3.p3.8.m4.1" class="ltx_Math" alttext="s_{ij}" display="inline"><semantics id="Sx3.SSx3.p3.8.m4.1a"><msub id="Sx3.SSx3.p3.8.m4.1.1" xref="Sx3.SSx3.p3.8.m4.1.1.cmml"><mi id="Sx3.SSx3.p3.8.m4.1.1.2" xref="Sx3.SSx3.p3.8.m4.1.1.2.cmml">s</mi><mrow id="Sx3.SSx3.p3.8.m4.1.1.3" xref="Sx3.SSx3.p3.8.m4.1.1.3.cmml"><mi id="Sx3.SSx3.p3.8.m4.1.1.3.2" xref="Sx3.SSx3.p3.8.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p3.8.m4.1.1.3.1" xref="Sx3.SSx3.p3.8.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p3.8.m4.1.1.3.3" xref="Sx3.SSx3.p3.8.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.8.m4.1b"><apply id="Sx3.SSx3.p3.8.m4.1.1.cmml" xref="Sx3.SSx3.p3.8.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.8.m4.1.1.1.cmml" xref="Sx3.SSx3.p3.8.m4.1.1">subscript</csymbol><ci id="Sx3.SSx3.p3.8.m4.1.1.2.cmml" xref="Sx3.SSx3.p3.8.m4.1.1.2">𝑠</ci><apply id="Sx3.SSx3.p3.8.m4.1.1.3.cmml" xref="Sx3.SSx3.p3.8.m4.1.1.3"><times id="Sx3.SSx3.p3.8.m4.1.1.3.1.cmml" xref="Sx3.SSx3.p3.8.m4.1.1.3.1"></times><ci id="Sx3.SSx3.p3.8.m4.1.1.3.2.cmml" xref="Sx3.SSx3.p3.8.m4.1.1.3.2">𝑖</ci><ci id="Sx3.SSx3.p3.8.m4.1.1.3.3.cmml" xref="Sx3.SSx3.p3.8.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.8.m4.1c">s_{ij}</annotation></semantics></math> to one)<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>
<math id="footnote2.m1.4" class="ltx_Math" alttext="\sum_{j=1}^{3}(1-s_{i,j})=3-\sum_{j}(z_{ij})=2" display="inline"><semantics id="footnote2.m1.4b"><mrow id="footnote2.m1.4.4" xref="footnote2.m1.4.4.cmml"><mrow id="footnote2.m1.3.3.1" xref="footnote2.m1.3.3.1.cmml"><msubsup id="footnote2.m1.3.3.1.2" xref="footnote2.m1.3.3.1.2.cmml"><mo id="footnote2.m1.3.3.1.2.2.2" xref="footnote2.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="footnote2.m1.3.3.1.2.2.3" xref="footnote2.m1.3.3.1.2.2.3.cmml"><mi id="footnote2.m1.3.3.1.2.2.3.2" xref="footnote2.m1.3.3.1.2.2.3.2.cmml">j</mi><mo id="footnote2.m1.3.3.1.2.2.3.1" xref="footnote2.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="footnote2.m1.3.3.1.2.2.3.3" xref="footnote2.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mn id="footnote2.m1.3.3.1.2.3" xref="footnote2.m1.3.3.1.2.3.cmml">3</mn></msubsup><mrow id="footnote2.m1.3.3.1.1.1" xref="footnote2.m1.3.3.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="footnote2.m1.3.3.1.1.1.2" xref="footnote2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="footnote2.m1.3.3.1.1.1.1" xref="footnote2.m1.3.3.1.1.1.1.cmml"><mn id="footnote2.m1.3.3.1.1.1.1.2" xref="footnote2.m1.3.3.1.1.1.1.2.cmml">1</mn><mo id="footnote2.m1.3.3.1.1.1.1.1" xref="footnote2.m1.3.3.1.1.1.1.1.cmml">−</mo><msub id="footnote2.m1.3.3.1.1.1.1.3" xref="footnote2.m1.3.3.1.1.1.1.3.cmml"><mi id="footnote2.m1.3.3.1.1.1.1.3.2" xref="footnote2.m1.3.3.1.1.1.1.3.2.cmml">s</mi><mrow id="footnote2.m1.2.2.2.4" xref="footnote2.m1.2.2.2.3.cmml"><mi id="footnote2.m1.1.1.1.1" xref="footnote2.m1.1.1.1.1.cmml">i</mi><mo id="footnote2.m1.2.2.2.4.1" xref="footnote2.m1.2.2.2.3.cmml">,</mo><mi id="footnote2.m1.2.2.2.2" xref="footnote2.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="footnote2.m1.3.3.1.1.1.3" xref="footnote2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="footnote2.m1.4.4.4" xref="footnote2.m1.4.4.4.cmml">=</mo><mrow id="footnote2.m1.4.4.2" xref="footnote2.m1.4.4.2.cmml"><mn id="footnote2.m1.4.4.2.3" xref="footnote2.m1.4.4.2.3.cmml">3</mn><mo rspace="0.055em" id="footnote2.m1.4.4.2.2" xref="footnote2.m1.4.4.2.2.cmml">−</mo><mrow id="footnote2.m1.4.4.2.1" xref="footnote2.m1.4.4.2.1.cmml"><msub id="footnote2.m1.4.4.2.1.2" xref="footnote2.m1.4.4.2.1.2.cmml"><mo rspace="0em" id="footnote2.m1.4.4.2.1.2.2" xref="footnote2.m1.4.4.2.1.2.2.cmml">∑</mo><mi id="footnote2.m1.4.4.2.1.2.3" xref="footnote2.m1.4.4.2.1.2.3.cmml">j</mi></msub><mrow id="footnote2.m1.4.4.2.1.1.1" xref="footnote2.m1.4.4.2.1.1.1.1.cmml"><mo stretchy="false" id="footnote2.m1.4.4.2.1.1.1.2" xref="footnote2.m1.4.4.2.1.1.1.1.cmml">(</mo><msub id="footnote2.m1.4.4.2.1.1.1.1" xref="footnote2.m1.4.4.2.1.1.1.1.cmml"><mi id="footnote2.m1.4.4.2.1.1.1.1.2" xref="footnote2.m1.4.4.2.1.1.1.1.2.cmml">z</mi><mrow id="footnote2.m1.4.4.2.1.1.1.1.3" xref="footnote2.m1.4.4.2.1.1.1.1.3.cmml"><mi id="footnote2.m1.4.4.2.1.1.1.1.3.2" xref="footnote2.m1.4.4.2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="footnote2.m1.4.4.2.1.1.1.1.3.1" xref="footnote2.m1.4.4.2.1.1.1.1.3.1.cmml">​</mo><mi id="footnote2.m1.4.4.2.1.1.1.1.3.3" xref="footnote2.m1.4.4.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="footnote2.m1.4.4.2.1.1.1.3" xref="footnote2.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="footnote2.m1.4.4.5" xref="footnote2.m1.4.4.5.cmml">=</mo><mn id="footnote2.m1.4.4.6" xref="footnote2.m1.4.4.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.4c"><apply id="footnote2.m1.4.4.cmml" xref="footnote2.m1.4.4"><and id="footnote2.m1.4.4a.cmml" xref="footnote2.m1.4.4"></and><apply id="footnote2.m1.4.4b.cmml" xref="footnote2.m1.4.4"><eq id="footnote2.m1.4.4.4.cmml" xref="footnote2.m1.4.4.4"></eq><apply id="footnote2.m1.3.3.1.cmml" xref="footnote2.m1.3.3.1"><apply id="footnote2.m1.3.3.1.2.cmml" xref="footnote2.m1.3.3.1.2"><csymbol cd="ambiguous" id="footnote2.m1.3.3.1.2.1.cmml" xref="footnote2.m1.3.3.1.2">superscript</csymbol><apply id="footnote2.m1.3.3.1.2.2.cmml" xref="footnote2.m1.3.3.1.2"><csymbol cd="ambiguous" id="footnote2.m1.3.3.1.2.2.1.cmml" xref="footnote2.m1.3.3.1.2">subscript</csymbol><sum id="footnote2.m1.3.3.1.2.2.2.cmml" xref="footnote2.m1.3.3.1.2.2.2"></sum><apply id="footnote2.m1.3.3.1.2.2.3.cmml" xref="footnote2.m1.3.3.1.2.2.3"><eq id="footnote2.m1.3.3.1.2.2.3.1.cmml" xref="footnote2.m1.3.3.1.2.2.3.1"></eq><ci id="footnote2.m1.3.3.1.2.2.3.2.cmml" xref="footnote2.m1.3.3.1.2.2.3.2">𝑗</ci><cn type="integer" id="footnote2.m1.3.3.1.2.2.3.3.cmml" xref="footnote2.m1.3.3.1.2.2.3.3">1</cn></apply></apply><cn type="integer" id="footnote2.m1.3.3.1.2.3.cmml" xref="footnote2.m1.3.3.1.2.3">3</cn></apply><apply id="footnote2.m1.3.3.1.1.1.1.cmml" xref="footnote2.m1.3.3.1.1.1"><minus id="footnote2.m1.3.3.1.1.1.1.1.cmml" xref="footnote2.m1.3.3.1.1.1.1.1"></minus><cn type="integer" id="footnote2.m1.3.3.1.1.1.1.2.cmml" xref="footnote2.m1.3.3.1.1.1.1.2">1</cn><apply id="footnote2.m1.3.3.1.1.1.1.3.cmml" xref="footnote2.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="footnote2.m1.3.3.1.1.1.1.3.1.cmml" xref="footnote2.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="footnote2.m1.3.3.1.1.1.1.3.2.cmml" xref="footnote2.m1.3.3.1.1.1.1.3.2">𝑠</ci><list id="footnote2.m1.2.2.2.3.cmml" xref="footnote2.m1.2.2.2.4"><ci id="footnote2.m1.1.1.1.1.cmml" xref="footnote2.m1.1.1.1.1">𝑖</ci><ci id="footnote2.m1.2.2.2.2.cmml" xref="footnote2.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="footnote2.m1.4.4.2.cmml" xref="footnote2.m1.4.4.2"><minus id="footnote2.m1.4.4.2.2.cmml" xref="footnote2.m1.4.4.2.2"></minus><cn type="integer" id="footnote2.m1.4.4.2.3.cmml" xref="footnote2.m1.4.4.2.3">3</cn><apply id="footnote2.m1.4.4.2.1.cmml" xref="footnote2.m1.4.4.2.1"><apply id="footnote2.m1.4.4.2.1.2.cmml" xref="footnote2.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="footnote2.m1.4.4.2.1.2.1.cmml" xref="footnote2.m1.4.4.2.1.2">subscript</csymbol><sum id="footnote2.m1.4.4.2.1.2.2.cmml" xref="footnote2.m1.4.4.2.1.2.2"></sum><ci id="footnote2.m1.4.4.2.1.2.3.cmml" xref="footnote2.m1.4.4.2.1.2.3">𝑗</ci></apply><apply id="footnote2.m1.4.4.2.1.1.1.1.cmml" xref="footnote2.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="footnote2.m1.4.4.2.1.1.1.1.1.cmml" xref="footnote2.m1.4.4.2.1.1.1">subscript</csymbol><ci id="footnote2.m1.4.4.2.1.1.1.1.2.cmml" xref="footnote2.m1.4.4.2.1.1.1.1.2">𝑧</ci><apply id="footnote2.m1.4.4.2.1.1.1.1.3.cmml" xref="footnote2.m1.4.4.2.1.1.1.1.3"><times id="footnote2.m1.4.4.2.1.1.1.1.3.1.cmml" xref="footnote2.m1.4.4.2.1.1.1.1.3.1"></times><ci id="footnote2.m1.4.4.2.1.1.1.1.3.2.cmml" xref="footnote2.m1.4.4.2.1.1.1.1.3.2">𝑖</ci><ci id="footnote2.m1.4.4.2.1.1.1.1.3.3.cmml" xref="footnote2.m1.4.4.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="footnote2.m1.4.4c.cmml" xref="footnote2.m1.4.4"><eq id="footnote2.m1.4.4.5.cmml" xref="footnote2.m1.4.4.5"></eq><share href="#footnote2.m1.4.4.2.cmml" id="footnote2.m1.4.4d.cmml" xref="footnote2.m1.4.4"></share><cn type="integer" id="footnote2.m1.4.4.6.cmml" xref="footnote2.m1.4.4.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.4d">\sum_{j=1}^{3}(1-s_{i,j})=3-\sum_{j}(z_{ij})=2</annotation></semantics></math> where <math id="footnote2.m2.1" class="ltx_Math" alttext="z_{i}=softmax(\hat{q}\hat{t}^{T}_{i})" display="inline"><semantics id="footnote2.m2.1b"><mrow id="footnote2.m2.1.1" xref="footnote2.m2.1.1.cmml"><msub id="footnote2.m2.1.1.3" xref="footnote2.m2.1.1.3.cmml"><mi id="footnote2.m2.1.1.3.2" xref="footnote2.m2.1.1.3.2.cmml">z</mi><mi id="footnote2.m2.1.1.3.3" xref="footnote2.m2.1.1.3.3.cmml">i</mi></msub><mo id="footnote2.m2.1.1.2" xref="footnote2.m2.1.1.2.cmml">=</mo><mrow id="footnote2.m2.1.1.1" xref="footnote2.m2.1.1.1.cmml"><mi id="footnote2.m2.1.1.1.3" xref="footnote2.m2.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.4" xref="footnote2.m2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2b" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.5" xref="footnote2.m2.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2c" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.6" xref="footnote2.m2.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2d" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.7" xref="footnote2.m2.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2e" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.8" xref="footnote2.m2.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2f" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mi id="footnote2.m2.1.1.1.9" xref="footnote2.m2.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.2g" xref="footnote2.m2.1.1.1.2.cmml">​</mo><mrow id="footnote2.m2.1.1.1.1.1" xref="footnote2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="footnote2.m2.1.1.1.1.1.2" xref="footnote2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="footnote2.m2.1.1.1.1.1.1" xref="footnote2.m2.1.1.1.1.1.1.cmml"><mover accent="true" id="footnote2.m2.1.1.1.1.1.1.2" xref="footnote2.m2.1.1.1.1.1.1.2.cmml"><mi id="footnote2.m2.1.1.1.1.1.1.2.2" xref="footnote2.m2.1.1.1.1.1.1.2.2.cmml">q</mi><mo id="footnote2.m2.1.1.1.1.1.1.2.1" xref="footnote2.m2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="footnote2.m2.1.1.1.1.1.1.1" xref="footnote2.m2.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="footnote2.m2.1.1.1.1.1.1.3" xref="footnote2.m2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="footnote2.m2.1.1.1.1.1.1.3.2.2" xref="footnote2.m2.1.1.1.1.1.1.3.2.2.cmml"><mi id="footnote2.m2.1.1.1.1.1.1.3.2.2.2" xref="footnote2.m2.1.1.1.1.1.1.3.2.2.2.cmml">t</mi><mo id="footnote2.m2.1.1.1.1.1.1.3.2.2.1" xref="footnote2.m2.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="footnote2.m2.1.1.1.1.1.1.3.3" xref="footnote2.m2.1.1.1.1.1.1.3.3.cmml">i</mi><mi id="footnote2.m2.1.1.1.1.1.1.3.2.3" xref="footnote2.m2.1.1.1.1.1.1.3.2.3.cmml">T</mi></msubsup></mrow><mo stretchy="false" id="footnote2.m2.1.1.1.1.1.3" xref="footnote2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m2.1c"><apply id="footnote2.m2.1.1.cmml" xref="footnote2.m2.1.1"><eq id="footnote2.m2.1.1.2.cmml" xref="footnote2.m2.1.1.2"></eq><apply id="footnote2.m2.1.1.3.cmml" xref="footnote2.m2.1.1.3"><csymbol cd="ambiguous" id="footnote2.m2.1.1.3.1.cmml" xref="footnote2.m2.1.1.3">subscript</csymbol><ci id="footnote2.m2.1.1.3.2.cmml" xref="footnote2.m2.1.1.3.2">𝑧</ci><ci id="footnote2.m2.1.1.3.3.cmml" xref="footnote2.m2.1.1.3.3">𝑖</ci></apply><apply id="footnote2.m2.1.1.1.cmml" xref="footnote2.m2.1.1.1"><times id="footnote2.m2.1.1.1.2.cmml" xref="footnote2.m2.1.1.1.2"></times><ci id="footnote2.m2.1.1.1.3.cmml" xref="footnote2.m2.1.1.1.3">𝑠</ci><ci id="footnote2.m2.1.1.1.4.cmml" xref="footnote2.m2.1.1.1.4">𝑜</ci><ci id="footnote2.m2.1.1.1.5.cmml" xref="footnote2.m2.1.1.1.5">𝑓</ci><ci id="footnote2.m2.1.1.1.6.cmml" xref="footnote2.m2.1.1.1.6">𝑡</ci><ci id="footnote2.m2.1.1.1.7.cmml" xref="footnote2.m2.1.1.1.7">𝑚</ci><ci id="footnote2.m2.1.1.1.8.cmml" xref="footnote2.m2.1.1.1.8">𝑎</ci><ci id="footnote2.m2.1.1.1.9.cmml" xref="footnote2.m2.1.1.1.9">𝑥</ci><apply id="footnote2.m2.1.1.1.1.1.1.cmml" xref="footnote2.m2.1.1.1.1.1"><times id="footnote2.m2.1.1.1.1.1.1.1.cmml" xref="footnote2.m2.1.1.1.1.1.1.1"></times><apply id="footnote2.m2.1.1.1.1.1.1.2.cmml" xref="footnote2.m2.1.1.1.1.1.1.2"><ci id="footnote2.m2.1.1.1.1.1.1.2.1.cmml" xref="footnote2.m2.1.1.1.1.1.1.2.1">^</ci><ci id="footnote2.m2.1.1.1.1.1.1.2.2.cmml" xref="footnote2.m2.1.1.1.1.1.1.2.2">𝑞</ci></apply><apply id="footnote2.m2.1.1.1.1.1.1.3.cmml" xref="footnote2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="footnote2.m2.1.1.1.1.1.1.3.1.cmml" xref="footnote2.m2.1.1.1.1.1.1.3">subscript</csymbol><apply id="footnote2.m2.1.1.1.1.1.1.3.2.cmml" xref="footnote2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="footnote2.m2.1.1.1.1.1.1.3.2.1.cmml" xref="footnote2.m2.1.1.1.1.1.1.3">superscript</csymbol><apply id="footnote2.m2.1.1.1.1.1.1.3.2.2.cmml" xref="footnote2.m2.1.1.1.1.1.1.3.2.2"><ci id="footnote2.m2.1.1.1.1.1.1.3.2.2.1.cmml" xref="footnote2.m2.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="footnote2.m2.1.1.1.1.1.1.3.2.2.2.cmml" xref="footnote2.m2.1.1.1.1.1.1.3.2.2.2">𝑡</ci></apply><ci id="footnote2.m2.1.1.1.1.1.1.3.2.3.cmml" xref="footnote2.m2.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><ci id="footnote2.m2.1.1.1.1.1.1.3.3.cmml" xref="footnote2.m2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m2.1d">z_{i}=softmax(\hat{q}\hat{t}^{T}_{i})</annotation></semantics></math>.</span></span></span>
The value of memory <math id="Sx3.SSx3.p3.9.m5.1" class="ltx_Math" alttext="m^{t}" display="inline"><semantics id="Sx3.SSx3.p3.9.m5.1a"><msup id="Sx3.SSx3.p3.9.m5.1.1" xref="Sx3.SSx3.p3.9.m5.1.1.cmml"><mi id="Sx3.SSx3.p3.9.m5.1.1.2" xref="Sx3.SSx3.p3.9.m5.1.1.2.cmml">m</mi><mi id="Sx3.SSx3.p3.9.m5.1.1.3" xref="Sx3.SSx3.p3.9.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.9.m5.1b"><apply id="Sx3.SSx3.p3.9.m5.1.1.cmml" xref="Sx3.SSx3.p3.9.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p3.9.m5.1.1.1.cmml" xref="Sx3.SSx3.p3.9.m5.1.1">superscript</csymbol><ci id="Sx3.SSx3.p3.9.m5.1.1.2.cmml" xref="Sx3.SSx3.p3.9.m5.1.1.2">𝑚</ci><ci id="Sx3.SSx3.p3.9.m5.1.1.3.cmml" xref="Sx3.SSx3.p3.9.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.9.m5.1c">m^{t}</annotation></semantics></math> is then computed by taking the weighted sum over the question-guided value embeddings using the relevance probabilities; this value is further used to reason over the spatial-aware image graph.</p>
<table id="A0.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex11.m1.1" class="ltx_Math" alttext="\displaystyle m^{t}=\sum_{i=1}^{K}p_{i}\hat{t}_{i}" display="inline"><semantics id="Sx3.Ex11.m1.1a"><mrow id="Sx3.Ex11.m1.1.1" xref="Sx3.Ex11.m1.1.1.cmml"><msup id="Sx3.Ex11.m1.1.1.2" xref="Sx3.Ex11.m1.1.1.2.cmml"><mi id="Sx3.Ex11.m1.1.1.2.2" xref="Sx3.Ex11.m1.1.1.2.2.cmml">m</mi><mi id="Sx3.Ex11.m1.1.1.2.3" xref="Sx3.Ex11.m1.1.1.2.3.cmml">t</mi></msup><mo id="Sx3.Ex11.m1.1.1.1" xref="Sx3.Ex11.m1.1.1.1.cmml">=</mo><mrow id="Sx3.Ex11.m1.1.1.3" xref="Sx3.Ex11.m1.1.1.3.cmml"><mstyle displaystyle="true" id="Sx3.Ex11.m1.1.1.3.1" xref="Sx3.Ex11.m1.1.1.3.1.cmml"><munderover id="Sx3.Ex11.m1.1.1.3.1a" xref="Sx3.Ex11.m1.1.1.3.1.cmml"><mo movablelimits="false" id="Sx3.Ex11.m1.1.1.3.1.2.2" xref="Sx3.Ex11.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx3.Ex11.m1.1.1.3.1.2.3" xref="Sx3.Ex11.m1.1.1.3.1.2.3.cmml"><mi id="Sx3.Ex11.m1.1.1.3.1.2.3.2" xref="Sx3.Ex11.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="Sx3.Ex11.m1.1.1.3.1.2.3.1" xref="Sx3.Ex11.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="Sx3.Ex11.m1.1.1.3.1.2.3.3" xref="Sx3.Ex11.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex11.m1.1.1.3.1.3" xref="Sx3.Ex11.m1.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="Sx3.Ex11.m1.1.1.3.2" xref="Sx3.Ex11.m1.1.1.3.2.cmml"><msub id="Sx3.Ex11.m1.1.1.3.2.2" xref="Sx3.Ex11.m1.1.1.3.2.2.cmml"><mi id="Sx3.Ex11.m1.1.1.3.2.2.2" xref="Sx3.Ex11.m1.1.1.3.2.2.2.cmml">p</mi><mi id="Sx3.Ex11.m1.1.1.3.2.2.3" xref="Sx3.Ex11.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex11.m1.1.1.3.2.1" xref="Sx3.Ex11.m1.1.1.3.2.1.cmml">​</mo><msub id="Sx3.Ex11.m1.1.1.3.2.3" xref="Sx3.Ex11.m1.1.1.3.2.3.cmml"><mover accent="true" id="Sx3.Ex11.m1.1.1.3.2.3.2" xref="Sx3.Ex11.m1.1.1.3.2.3.2.cmml"><mi id="Sx3.Ex11.m1.1.1.3.2.3.2.2" xref="Sx3.Ex11.m1.1.1.3.2.3.2.2.cmml">t</mi><mo id="Sx3.Ex11.m1.1.1.3.2.3.2.1" xref="Sx3.Ex11.m1.1.1.3.2.3.2.1.cmml">^</mo></mover><mi id="Sx3.Ex11.m1.1.1.3.2.3.3" xref="Sx3.Ex11.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex11.m1.1b"><apply id="Sx3.Ex11.m1.1.1.cmml" xref="Sx3.Ex11.m1.1.1"><eq id="Sx3.Ex11.m1.1.1.1.cmml" xref="Sx3.Ex11.m1.1.1.1"></eq><apply id="Sx3.Ex11.m1.1.1.2.cmml" xref="Sx3.Ex11.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex11.m1.1.1.2.1.cmml" xref="Sx3.Ex11.m1.1.1.2">superscript</csymbol><ci id="Sx3.Ex11.m1.1.1.2.2.cmml" xref="Sx3.Ex11.m1.1.1.2.2">𝑚</ci><ci id="Sx3.Ex11.m1.1.1.2.3.cmml" xref="Sx3.Ex11.m1.1.1.2.3">𝑡</ci></apply><apply id="Sx3.Ex11.m1.1.1.3.cmml" xref="Sx3.Ex11.m1.1.1.3"><apply id="Sx3.Ex11.m1.1.1.3.1.cmml" xref="Sx3.Ex11.m1.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex11.m1.1.1.3.1.1.cmml" xref="Sx3.Ex11.m1.1.1.3.1">superscript</csymbol><apply id="Sx3.Ex11.m1.1.1.3.1.2.cmml" xref="Sx3.Ex11.m1.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex11.m1.1.1.3.1.2.1.cmml" xref="Sx3.Ex11.m1.1.1.3.1">subscript</csymbol><sum id="Sx3.Ex11.m1.1.1.3.1.2.2.cmml" xref="Sx3.Ex11.m1.1.1.3.1.2.2"></sum><apply id="Sx3.Ex11.m1.1.1.3.1.2.3.cmml" xref="Sx3.Ex11.m1.1.1.3.1.2.3"><eq id="Sx3.Ex11.m1.1.1.3.1.2.3.1.cmml" xref="Sx3.Ex11.m1.1.1.3.1.2.3.1"></eq><ci id="Sx3.Ex11.m1.1.1.3.1.2.3.2.cmml" xref="Sx3.Ex11.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.Ex11.m1.1.1.3.1.2.3.3.cmml" xref="Sx3.Ex11.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex11.m1.1.1.3.1.3.cmml" xref="Sx3.Ex11.m1.1.1.3.1.3">𝐾</ci></apply><apply id="Sx3.Ex11.m1.1.1.3.2.cmml" xref="Sx3.Ex11.m1.1.1.3.2"><times id="Sx3.Ex11.m1.1.1.3.2.1.cmml" xref="Sx3.Ex11.m1.1.1.3.2.1"></times><apply id="Sx3.Ex11.m1.1.1.3.2.2.cmml" xref="Sx3.Ex11.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex11.m1.1.1.3.2.2.1.cmml" xref="Sx3.Ex11.m1.1.1.3.2.2">subscript</csymbol><ci id="Sx3.Ex11.m1.1.1.3.2.2.2.cmml" xref="Sx3.Ex11.m1.1.1.3.2.2.2">𝑝</ci><ci id="Sx3.Ex11.m1.1.1.3.2.2.3.cmml" xref="Sx3.Ex11.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="Sx3.Ex11.m1.1.1.3.2.3.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx3.Ex11.m1.1.1.3.2.3.1.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3">subscript</csymbol><apply id="Sx3.Ex11.m1.1.1.3.2.3.2.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3.2"><ci id="Sx3.Ex11.m1.1.1.3.2.3.2.1.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3.2.1">^</ci><ci id="Sx3.Ex11.m1.1.1.3.2.3.2.2.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3.2.2">𝑡</ci></apply><ci id="Sx3.Ex11.m1.1.1.3.2.3.3.cmml" xref="Sx3.Ex11.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex11.m1.1c">\displaystyle m^{t}=\sum_{i=1}^{K}p_{i}\hat{t}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p3.10" class="ltx_p">where <math id="Sx3.SSx3.p3.10.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx3.SSx3.p3.10.m1.1a"><mi id="Sx3.SSx3.p3.10.m1.1.1" xref="Sx3.SSx3.p3.10.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.10.m1.1b"><ci id="Sx3.SSx3.p3.10.m1.1.1.cmml" xref="Sx3.SSx3.p3.10.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.10.m1.1c">K</annotation></semantics></math> is the number of knowledge triplets stored in the key-value memory module.</p>
</div>
<div id="Sx3.SSx3.p4" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p4.6" class="ltx_p"><span id="Sx3.SSx3.p4.6.1" class="ltx_text ltx_font_bold">Question and Knowledge Guided Node Attention.</span> We first merge the question information and the output of the key-value memory module to generate a knowledge-aware question representation.</p>
<table id="A0.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex12.m1.1" class="ltx_Math" alttext="\displaystyle R^{t}=W_{11}^{t}(ELU(W_{12}[q^{t};m^{t}]))" display="inline"><semantics id="Sx3.Ex12.m1.1a"><mrow id="Sx3.Ex12.m1.1.1" xref="Sx3.Ex12.m1.1.1.cmml"><msup id="Sx3.Ex12.m1.1.1.3" xref="Sx3.Ex12.m1.1.1.3.cmml"><mi id="Sx3.Ex12.m1.1.1.3.2" xref="Sx3.Ex12.m1.1.1.3.2.cmml">R</mi><mi id="Sx3.Ex12.m1.1.1.3.3" xref="Sx3.Ex12.m1.1.1.3.3.cmml">t</mi></msup><mo id="Sx3.Ex12.m1.1.1.2" xref="Sx3.Ex12.m1.1.1.2.cmml">=</mo><mrow id="Sx3.Ex12.m1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.cmml"><msubsup id="Sx3.Ex12.m1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.3.cmml"><mi id="Sx3.Ex12.m1.1.1.1.3.2.2" xref="Sx3.Ex12.m1.1.1.1.3.2.2.cmml">W</mi><mn id="Sx3.Ex12.m1.1.1.1.3.2.3" xref="Sx3.Ex12.m1.1.1.1.3.2.3.cmml">11</mn><mi id="Sx3.Ex12.m1.1.1.1.3.3" xref="Sx3.Ex12.m1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.Ex12.m1.1.1.1.2" xref="Sx3.Ex12.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex12.m1.1.1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex12.m1.1.1.1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex12.m1.1.1.1.1.1.1.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.4" xref="Sx3.Ex12.m1.1.1.1.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex12.m1.1.1.1.1.1.1.2a" xref="Sx3.Ex12.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.5" xref="Sx3.Ex12.m1.1.1.1.1.1.1.5.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex12.m1.1.1.1.1.1.1.2b" xref="Sx3.Ex12.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">W</mi><mn id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">12</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">[</mo><msup id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.4" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">m</mi><mi id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.5" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex12.m1.1.1.1.1.1.3" xref="Sx3.Ex12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex12.m1.1b"><apply id="Sx3.Ex12.m1.1.1.cmml" xref="Sx3.Ex12.m1.1.1"><eq id="Sx3.Ex12.m1.1.1.2.cmml" xref="Sx3.Ex12.m1.1.1.2"></eq><apply id="Sx3.Ex12.m1.1.1.3.cmml" xref="Sx3.Ex12.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.3.1.cmml" xref="Sx3.Ex12.m1.1.1.3">superscript</csymbol><ci id="Sx3.Ex12.m1.1.1.3.2.cmml" xref="Sx3.Ex12.m1.1.1.3.2">𝑅</ci><ci id="Sx3.Ex12.m1.1.1.3.3.cmml" xref="Sx3.Ex12.m1.1.1.3.3">𝑡</ci></apply><apply id="Sx3.Ex12.m1.1.1.1.cmml" xref="Sx3.Ex12.m1.1.1.1"><times id="Sx3.Ex12.m1.1.1.1.2.cmml" xref="Sx3.Ex12.m1.1.1.1.2"></times><apply id="Sx3.Ex12.m1.1.1.1.3.cmml" xref="Sx3.Ex12.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.1.3.1.cmml" xref="Sx3.Ex12.m1.1.1.1.3">superscript</csymbol><apply id="Sx3.Ex12.m1.1.1.1.3.2.cmml" xref="Sx3.Ex12.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.1.3.2.1.cmml" xref="Sx3.Ex12.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex12.m1.1.1.1.3.2.2.cmml" xref="Sx3.Ex12.m1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="Sx3.Ex12.m1.1.1.1.3.2.3.cmml" xref="Sx3.Ex12.m1.1.1.1.3.2.3">11</cn></apply><ci id="Sx3.Ex12.m1.1.1.1.3.3.cmml" xref="Sx3.Ex12.m1.1.1.1.3.3">𝑡</ci></apply><apply id="Sx3.Ex12.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1"><times id="Sx3.Ex12.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.2"></times><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.3">𝐸</ci><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.4">𝐿</ci><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.5">𝑈</ci><apply id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1"><times id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.3"></times><apply id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.2">𝑊</ci><cn type="integer" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.4.3">12</cn></apply><list id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2"><apply id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑚</ci><ci id="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.Ex12.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex12.m1.1c">\displaystyle R^{t}=W_{11}^{t}(ELU(W_{12}[q^{t};m^{t}]))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p4.4" class="ltx_p">where <math id="Sx3.SSx3.p4.1.m1.1" class="ltx_Math" alttext="q^{t}" display="inline"><semantics id="Sx3.SSx3.p4.1.m1.1a"><msup id="Sx3.SSx3.p4.1.m1.1.1" xref="Sx3.SSx3.p4.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p4.1.m1.1.1.2" xref="Sx3.SSx3.p4.1.m1.1.1.2.cmml">q</mi><mi id="Sx3.SSx3.p4.1.m1.1.1.3" xref="Sx3.SSx3.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.1.m1.1b"><apply id="Sx3.SSx3.p4.1.m1.1.1.cmml" xref="Sx3.SSx3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p4.1.m1.1.1">superscript</csymbol><ci id="Sx3.SSx3.p4.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p4.1.m1.1.1.2">𝑞</ci><ci id="Sx3.SSx3.p4.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.1.m1.1c">q^{t}</annotation></semantics></math> and <math id="Sx3.SSx3.p4.2.m2.1" class="ltx_Math" alttext="m^{t}" display="inline"><semantics id="Sx3.SSx3.p4.2.m2.1a"><msup id="Sx3.SSx3.p4.2.m2.1.1" xref="Sx3.SSx3.p4.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p4.2.m2.1.1.2" xref="Sx3.SSx3.p4.2.m2.1.1.2.cmml">m</mi><mi id="Sx3.SSx3.p4.2.m2.1.1.3" xref="Sx3.SSx3.p4.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.2.m2.1b"><apply id="Sx3.SSx3.p4.2.m2.1.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p4.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p4.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.2">𝑚</ci><ci id="Sx3.SSx3.p4.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.2.m2.1c">m^{t}</annotation></semantics></math> are the question and memory embeddings generated during the <math id="Sx3.SSx3.p4.3.m3.1" class="ltx_Math" alttext="t-th" display="inline"><semantics id="Sx3.SSx3.p4.3.m3.1a"><mrow id="Sx3.SSx3.p4.3.m3.1.1" xref="Sx3.SSx3.p4.3.m3.1.1.cmml"><mi id="Sx3.SSx3.p4.3.m3.1.1.2" xref="Sx3.SSx3.p4.3.m3.1.1.2.cmml">t</mi><mo id="Sx3.SSx3.p4.3.m3.1.1.1" xref="Sx3.SSx3.p4.3.m3.1.1.1.cmml">−</mo><mrow id="Sx3.SSx3.p4.3.m3.1.1.3" xref="Sx3.SSx3.p4.3.m3.1.1.3.cmml"><mi id="Sx3.SSx3.p4.3.m3.1.1.3.2" xref="Sx3.SSx3.p4.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p4.3.m3.1.1.3.1" xref="Sx3.SSx3.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p4.3.m3.1.1.3.3" xref="Sx3.SSx3.p4.3.m3.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.3.m3.1b"><apply id="Sx3.SSx3.p4.3.m3.1.1.cmml" xref="Sx3.SSx3.p4.3.m3.1.1"><minus id="Sx3.SSx3.p4.3.m3.1.1.1.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.1"></minus><ci id="Sx3.SSx3.p4.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.2">𝑡</ci><apply id="Sx3.SSx3.p4.3.m3.1.1.3.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.3"><times id="Sx3.SSx3.p4.3.m3.1.1.3.1.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.3.1"></times><ci id="Sx3.SSx3.p4.3.m3.1.1.3.2.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.3.2">𝑡</ci><ci id="Sx3.SSx3.p4.3.m3.1.1.3.3.cmml" xref="Sx3.SSx3.p4.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.3.m3.1c">t-th</annotation></semantics></math> reasoning iteration, respectively, and <math id="Sx3.SSx3.p4.4.m4.1" class="ltx_Math" alttext="ELU" display="inline"><semantics id="Sx3.SSx3.p4.4.m4.1a"><mrow id="Sx3.SSx3.p4.4.m4.1.1" xref="Sx3.SSx3.p4.4.m4.1.1.cmml"><mi id="Sx3.SSx3.p4.4.m4.1.1.2" xref="Sx3.SSx3.p4.4.m4.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p4.4.m4.1.1.1" xref="Sx3.SSx3.p4.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p4.4.m4.1.1.3" xref="Sx3.SSx3.p4.4.m4.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p4.4.m4.1.1.1a" xref="Sx3.SSx3.p4.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p4.4.m4.1.1.4" xref="Sx3.SSx3.p4.4.m4.1.1.4.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.4.m4.1b"><apply id="Sx3.SSx3.p4.4.m4.1.1.cmml" xref="Sx3.SSx3.p4.4.m4.1.1"><times id="Sx3.SSx3.p4.4.m4.1.1.1.cmml" xref="Sx3.SSx3.p4.4.m4.1.1.1"></times><ci id="Sx3.SSx3.p4.4.m4.1.1.2.cmml" xref="Sx3.SSx3.p4.4.m4.1.1.2">𝐸</ci><ci id="Sx3.SSx3.p4.4.m4.1.1.3.cmml" xref="Sx3.SSx3.p4.4.m4.1.1.3">𝐿</ci><ci id="Sx3.SSx3.p4.4.m4.1.1.4.cmml" xref="Sx3.SSx3.p4.4.m4.1.1.4">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.4.m4.1c">ELU</annotation></semantics></math> is the exponential linear unit activation function used here to avoid the dead neuron problem. We then use an attention mechanism to compute the relevance of each node of the spatial-aware image graph corresponding to the knowledge-aware question representation. The relevance scores are evaluated as:</p>
<table id="A0.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex13.m1.1" class="ltx_Math" alttext="\displaystyle\alpha_{i}=softmax(\omega_{v}tanh(W_{13}v_{i}+W_{14}R^{t}))" display="inline"><semantics id="Sx3.Ex13.m1.1a"><mrow id="Sx3.Ex13.m1.1.1" xref="Sx3.Ex13.m1.1.1.cmml"><msub id="Sx3.Ex13.m1.1.1.3" xref="Sx3.Ex13.m1.1.1.3.cmml"><mi id="Sx3.Ex13.m1.1.1.3.2" xref="Sx3.Ex13.m1.1.1.3.2.cmml">α</mi><mi id="Sx3.Ex13.m1.1.1.3.3" xref="Sx3.Ex13.m1.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.Ex13.m1.1.1.2" xref="Sx3.Ex13.m1.1.1.2.cmml">=</mo><mrow id="Sx3.Ex13.m1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.cmml"><mi id="Sx3.Ex13.m1.1.1.1.3" xref="Sx3.Ex13.m1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.4" xref="Sx3.Ex13.m1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2a" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.5" xref="Sx3.Ex13.m1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2b" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.6" xref="Sx3.Ex13.m1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2c" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.7" xref="Sx3.Ex13.m1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2d" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.8" xref="Sx3.Ex13.m1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2e" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.9" xref="Sx3.Ex13.m1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.2f" xref="Sx3.Ex13.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex13.m1.1.1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex13.m1.1.1.1.1.1.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex13.m1.1.1.1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex13.m1.1.1.1.1.1.1.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.3.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3.2.cmml">ω</mi><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.3.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.4" xref="Sx3.Ex13.m1.1.1.1.1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.2a" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.5" xref="Sx3.Ex13.m1.1.1.1.1.1.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.2b" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.6" xref="Sx3.Ex13.m1.1.1.1.1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.2c" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.7" xref="Sx3.Ex13.m1.1.1.1.1.1.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.2d" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">13</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">v</mi><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mn id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">14</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msup id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">R</mi><mi id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><mo stretchy="false" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex13.m1.1.1.1.1.1.3" xref="Sx3.Ex13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex13.m1.1b"><apply id="Sx3.Ex13.m1.1.1.cmml" xref="Sx3.Ex13.m1.1.1"><eq id="Sx3.Ex13.m1.1.1.2.cmml" xref="Sx3.Ex13.m1.1.1.2"></eq><apply id="Sx3.Ex13.m1.1.1.3.cmml" xref="Sx3.Ex13.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.3.1.cmml" xref="Sx3.Ex13.m1.1.1.3">subscript</csymbol><ci id="Sx3.Ex13.m1.1.1.3.2.cmml" xref="Sx3.Ex13.m1.1.1.3.2">𝛼</ci><ci id="Sx3.Ex13.m1.1.1.3.3.cmml" xref="Sx3.Ex13.m1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.Ex13.m1.1.1.1.cmml" xref="Sx3.Ex13.m1.1.1.1"><times id="Sx3.Ex13.m1.1.1.1.2.cmml" xref="Sx3.Ex13.m1.1.1.1.2"></times><ci id="Sx3.Ex13.m1.1.1.1.3.cmml" xref="Sx3.Ex13.m1.1.1.1.3">𝑠</ci><ci id="Sx3.Ex13.m1.1.1.1.4.cmml" xref="Sx3.Ex13.m1.1.1.1.4">𝑜</ci><ci id="Sx3.Ex13.m1.1.1.1.5.cmml" xref="Sx3.Ex13.m1.1.1.1.5">𝑓</ci><ci id="Sx3.Ex13.m1.1.1.1.6.cmml" xref="Sx3.Ex13.m1.1.1.1.6">𝑡</ci><ci id="Sx3.Ex13.m1.1.1.1.7.cmml" xref="Sx3.Ex13.m1.1.1.1.7">𝑚</ci><ci id="Sx3.Ex13.m1.1.1.1.8.cmml" xref="Sx3.Ex13.m1.1.1.1.8">𝑎</ci><ci id="Sx3.Ex13.m1.1.1.1.9.cmml" xref="Sx3.Ex13.m1.1.1.1.9">𝑥</ci><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1"><times id="Sx3.Ex13.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.2"></times><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3.2">𝜔</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.3.3">𝑣</ci></apply><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.4">𝑡</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.5">𝑎</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.6.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.6">𝑛</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.7.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.7">ℎ</ci><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1"><plus id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2"><times id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><cn type="integer" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.2.3">13</cn></apply><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑣</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3"><times id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.2.3">14</cn></apply><apply id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑅</ci><ci id="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.Ex13.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex13.m1.1c">\displaystyle\alpha_{i}=softmax(\omega_{v}tanh(W_{13}v_{i}+W_{14}R^{t}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p4.5" class="ltx_p">where <math id="Sx3.SSx3.p4.5.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="Sx3.SSx3.p4.5.m1.1a"><msub id="Sx3.SSx3.p4.5.m1.1.1" xref="Sx3.SSx3.p4.5.m1.1.1.cmml"><mi id="Sx3.SSx3.p4.5.m1.1.1.2" xref="Sx3.SSx3.p4.5.m1.1.1.2.cmml">v</mi><mi id="Sx3.SSx3.p4.5.m1.1.1.3" xref="Sx3.SSx3.p4.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p4.5.m1.1b"><apply id="Sx3.SSx3.p4.5.m1.1.1.cmml" xref="Sx3.SSx3.p4.5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p4.5.m1.1.1.1.cmml" xref="Sx3.SSx3.p4.5.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p4.5.m1.1.1.2.cmml" xref="Sx3.SSx3.p4.5.m1.1.1.2">𝑣</ci><ci id="Sx3.SSx3.p4.5.m1.1.1.3.cmml" xref="Sx3.SSx3.p4.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p4.5.m1.1c">v_{i}</annotation></semantics></math> is the node representation of the spatial-aware image graph.</p>
</div>
<div id="Sx3.SSx3.p5" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p5.2" class="ltx_p"><span id="Sx3.SSx3.p5.2.1" class="ltx_text ltx_font_bold">Question and Knowledge Guided Edge Attention</span> We apply the same attention mechanism to compute the importance between edge <math id="Sx3.SSx3.p5.1.m1.1" class="ltx_Math" alttext="e_{ij}" display="inline"><semantics id="Sx3.SSx3.p5.1.m1.1a"><msub id="Sx3.SSx3.p5.1.m1.1.1" xref="Sx3.SSx3.p5.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p5.1.m1.1.1.2" xref="Sx3.SSx3.p5.1.m1.1.1.2.cmml">e</mi><mrow id="Sx3.SSx3.p5.1.m1.1.1.3" xref="Sx3.SSx3.p5.1.m1.1.1.3.cmml"><mi id="Sx3.SSx3.p5.1.m1.1.1.3.2" xref="Sx3.SSx3.p5.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p5.1.m1.1.1.3.1" xref="Sx3.SSx3.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p5.1.m1.1.1.3.3" xref="Sx3.SSx3.p5.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p5.1.m1.1b"><apply id="Sx3.SSx3.p5.1.m1.1.1.cmml" xref="Sx3.SSx3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p5.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p5.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p5.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p5.1.m1.1.1.2">𝑒</ci><apply id="Sx3.SSx3.p5.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p5.1.m1.1.1.3"><times id="Sx3.SSx3.p5.1.m1.1.1.3.1.cmml" xref="Sx3.SSx3.p5.1.m1.1.1.3.1"></times><ci id="Sx3.SSx3.p5.1.m1.1.1.3.2.cmml" xref="Sx3.SSx3.p5.1.m1.1.1.3.2">𝑖</ci><ci id="Sx3.SSx3.p5.1.m1.1.1.3.3.cmml" xref="Sx3.SSx3.p5.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p5.1.m1.1c">e_{ij}</annotation></semantics></math> and the knowledge-aware question representation <math id="Sx3.SSx3.p5.2.m2.1" class="ltx_Math" alttext="R^{t}" display="inline"><semantics id="Sx3.SSx3.p5.2.m2.1a"><msup id="Sx3.SSx3.p5.2.m2.1.1" xref="Sx3.SSx3.p5.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p5.2.m2.1.1.2" xref="Sx3.SSx3.p5.2.m2.1.1.2.cmml">R</mi><mi id="Sx3.SSx3.p5.2.m2.1.1.3" xref="Sx3.SSx3.p5.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p5.2.m2.1b"><apply id="Sx3.SSx3.p5.2.m2.1.1.cmml" xref="Sx3.SSx3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p5.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p5.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx3.p5.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p5.2.m2.1.1.2">𝑅</ci><ci id="Sx3.SSx3.p5.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p5.2.m2.1c">R^{t}</annotation></semantics></math>, which is evaluated as:</p>
<table id="A0.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex14.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\beta_{ij}=softmax(\omega_{e}tanh(W_{15}e_{ij}+W_{16}R^{t})" display="inline"><semantics id="Sx3.Ex14.m1.1a"><mrow id="Sx3.Ex14.m1.1b"><msub id="Sx3.Ex14.m1.1.1"><mi id="Sx3.Ex14.m1.1.1.2">β</mi><mrow id="Sx3.Ex14.m1.1.1.3"><mi id="Sx3.Ex14.m1.1.1.3.2">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex14.m1.1.1.3.1">​</mo><mi id="Sx3.Ex14.m1.1.1.3.3">j</mi></mrow></msub><mo id="Sx3.Ex14.m1.1.2">=</mo><mi id="Sx3.Ex14.m1.1.3">s</mi><mi id="Sx3.Ex14.m1.1.4">o</mi><mi id="Sx3.Ex14.m1.1.5">f</mi><mi id="Sx3.Ex14.m1.1.6">t</mi><mi id="Sx3.Ex14.m1.1.7">m</mi><mi id="Sx3.Ex14.m1.1.8">a</mi><mi id="Sx3.Ex14.m1.1.9">x</mi><mrow id="Sx3.Ex14.m1.1.10"><mo stretchy="false" id="Sx3.Ex14.m1.1.10.1">(</mo><msub id="Sx3.Ex14.m1.1.10.2"><mi id="Sx3.Ex14.m1.1.10.2.2">ω</mi><mi id="Sx3.Ex14.m1.1.10.2.3">e</mi></msub><mi id="Sx3.Ex14.m1.1.10.3">t</mi><mi id="Sx3.Ex14.m1.1.10.4">a</mi><mi id="Sx3.Ex14.m1.1.10.5">n</mi><mi id="Sx3.Ex14.m1.1.10.6">h</mi><mrow id="Sx3.Ex14.m1.1.10.7"><mo stretchy="false" id="Sx3.Ex14.m1.1.10.7.1">(</mo><msub id="Sx3.Ex14.m1.1.10.7.2"><mi id="Sx3.Ex14.m1.1.10.7.2.2">W</mi><mn id="Sx3.Ex14.m1.1.10.7.2.3">15</mn></msub><msub id="Sx3.Ex14.m1.1.10.7.3"><mi id="Sx3.Ex14.m1.1.10.7.3.2">e</mi><mrow id="Sx3.Ex14.m1.1.10.7.3.3"><mi id="Sx3.Ex14.m1.1.10.7.3.3.2">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex14.m1.1.10.7.3.3.1">​</mo><mi id="Sx3.Ex14.m1.1.10.7.3.3.3">j</mi></mrow></msub><mo id="Sx3.Ex14.m1.1.10.7.4">+</mo><msub id="Sx3.Ex14.m1.1.10.7.5"><mi id="Sx3.Ex14.m1.1.10.7.5.2">W</mi><mn id="Sx3.Ex14.m1.1.10.7.5.3">16</mn></msub><msup id="Sx3.Ex14.m1.1.10.7.6"><mi id="Sx3.Ex14.m1.1.10.7.6.2">R</mi><mi id="Sx3.Ex14.m1.1.10.7.6.3">t</mi></msup><mo stretchy="false" id="Sx3.Ex14.m1.1.10.7.7">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.Ex14.m1.1c">\displaystyle\beta_{ij}=softmax(\omega_{e}tanh(W_{15}e_{ij}+W_{16}R^{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.SSx3.p6" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p6.5" class="ltx_p"><span id="Sx3.SSx3.p6.5.1" class="ltx_text ltx_font_bold">Multi-head Spatial-aware Image Graph Attention.</span> Based on the node and edge attention weights computed in Eq. <a href="#Sx3.Ex13" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> and Eq. <a href="#Sx3.Ex14" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>, respectively, the node representations of the spatial-aware image graph are updated with multi-head graph attention <cite class="ltx_cite ltx_citemacro_citep">(Veličković et al. <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite>.</p>
<table id="A0.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex15.m1.1" class="ltx_Math" alttext="\displaystyle m_{i}^{k}" display="inline"><semantics id="Sx3.Ex15.m1.1a"><msubsup id="Sx3.Ex15.m1.1.1" xref="Sx3.Ex15.m1.1.1.cmml"><mi id="Sx3.Ex15.m1.1.1.2.2" xref="Sx3.Ex15.m1.1.1.2.2.cmml">m</mi><mi id="Sx3.Ex15.m1.1.1.2.3" xref="Sx3.Ex15.m1.1.1.2.3.cmml">i</mi><mi id="Sx3.Ex15.m1.1.1.3" xref="Sx3.Ex15.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.Ex15.m1.1b"><apply id="Sx3.Ex15.m1.1.1.cmml" xref="Sx3.Ex15.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex15.m1.1.1.1.cmml" xref="Sx3.Ex15.m1.1.1">superscript</csymbol><apply id="Sx3.Ex15.m1.1.1.2.cmml" xref="Sx3.Ex15.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex15.m1.1.1.2.1.cmml" xref="Sx3.Ex15.m1.1.1">subscript</csymbol><ci id="Sx3.Ex15.m1.1.1.2.2.cmml" xref="Sx3.Ex15.m1.1.1.2.2">𝑚</ci><ci id="Sx3.Ex15.m1.1.1.2.3.cmml" xref="Sx3.Ex15.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.Ex15.m1.1.1.3.cmml" xref="Sx3.Ex15.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex15.m1.1c">\displaystyle m_{i}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex15.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{j\in\mathcal{N}_{i}}([\alpha_{j}W_{17}v_{j};\beta_{ij}W_{18}e_{ij}])" display="inline"><semantics id="Sx3.Ex15.m2.1a"><mrow id="Sx3.Ex15.m2.1.1" xref="Sx3.Ex15.m2.1.1.cmml"><mi id="Sx3.Ex15.m2.1.1.3" xref="Sx3.Ex15.m2.1.1.3.cmml"></mi><mo id="Sx3.Ex15.m2.1.1.2" xref="Sx3.Ex15.m2.1.1.2.cmml">=</mo><mrow id="Sx3.Ex15.m2.1.1.1" xref="Sx3.Ex15.m2.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.Ex15.m2.1.1.1.2" xref="Sx3.Ex15.m2.1.1.1.2.cmml"><munder id="Sx3.Ex15.m2.1.1.1.2a" xref="Sx3.Ex15.m2.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.Ex15.m2.1.1.1.2.2" xref="Sx3.Ex15.m2.1.1.1.2.2.cmml">∑</mo><mrow id="Sx3.Ex15.m2.1.1.1.2.3" xref="Sx3.Ex15.m2.1.1.1.2.3.cmml"><mi id="Sx3.Ex15.m2.1.1.1.2.3.2" xref="Sx3.Ex15.m2.1.1.1.2.3.2.cmml">j</mi><mo id="Sx3.Ex15.m2.1.1.1.2.3.1" xref="Sx3.Ex15.m2.1.1.1.2.3.1.cmml">∈</mo><msub id="Sx3.Ex15.m2.1.1.1.2.3.3" xref="Sx3.Ex15.m2.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex15.m2.1.1.1.2.3.3.2" xref="Sx3.Ex15.m2.1.1.1.2.3.3.2.cmml">𝒩</mi><mi id="Sx3.Ex15.m2.1.1.1.2.3.3.3" xref="Sx3.Ex15.m2.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="Sx3.Ex15.m2.1.1.1.1.1" xref="Sx3.Ex15.m2.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex15.m2.1.1.1.1.1.2" xref="Sx3.Ex15.m2.1.1.1.cmml">(</mo><mrow id="Sx3.Ex15.m2.1.1.1.1.1.1.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.3.cmml">[</mo><mrow id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.3.cmml">17</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1a" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.2.cmml">v</mi><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.3.cmml">j</mi></msub></mrow><mo id="Sx3.Ex15.m2.1.1.1.1.1.1.2.4" xref="Sx3.Ex15.m2.1.1.1.1.1.1.3.cmml">;</mo><mrow id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.cmml"><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.2.cmml">β</mi><mrow id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.1" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.2.cmml">W</mi><mn id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.3.cmml">18</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1a" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.2.cmml">e</mi><mrow id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.cmml"><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.2" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.1" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.1.cmml">​</mo><mi id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.3" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.5" xref="Sx3.Ex15.m2.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="Sx3.Ex15.m2.1.1.1.1.1.3" xref="Sx3.Ex15.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex15.m2.1b"><apply id="Sx3.Ex15.m2.1.1.cmml" xref="Sx3.Ex15.m2.1.1"><eq id="Sx3.Ex15.m2.1.1.2.cmml" xref="Sx3.Ex15.m2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.Ex15.m2.1.1.3.cmml" xref="Sx3.Ex15.m2.1.1.3">absent</csymbol><apply id="Sx3.Ex15.m2.1.1.1.cmml" xref="Sx3.Ex15.m2.1.1.1"><apply id="Sx3.Ex15.m2.1.1.1.2.cmml" xref="Sx3.Ex15.m2.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.2.1.cmml" xref="Sx3.Ex15.m2.1.1.1.2">subscript</csymbol><sum id="Sx3.Ex15.m2.1.1.1.2.2.cmml" xref="Sx3.Ex15.m2.1.1.1.2.2"></sum><apply id="Sx3.Ex15.m2.1.1.1.2.3.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3"><in id="Sx3.Ex15.m2.1.1.1.2.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.1"></in><ci id="Sx3.Ex15.m2.1.1.1.2.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.2">𝑗</ci><apply id="Sx3.Ex15.m2.1.1.1.2.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.2.3.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.3">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.2.3.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.3.2">𝒩</ci><ci id="Sx3.Ex15.m2.1.1.1.2.3.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><list id="Sx3.Ex15.m2.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2"><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1"><times id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.1"></times><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.3.3">17</cn></apply><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.2">𝑣</ci><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.1.1.4.3">𝑗</ci></apply></apply><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2"><times id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.1"></times><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.2">𝛽</ci><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3"><times id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.2">𝑊</ci><cn type="integer" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.3.3">18</cn></apply><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.2">𝑒</ci><apply id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3"><times id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.1.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.1"></times><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.2.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.2">𝑖</ci><ci id="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.3.cmml" xref="Sx3.Ex15.m2.1.1.1.1.1.1.2.2.4.3.3">𝑗</ci></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex15.m2.1c">\displaystyle=\sum_{j\in\mathcal{N}_{i}}([\alpha_{j}W_{17}v_{j};\beta_{ij}W_{18}e_{ij}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex16.m1.1" class="ltx_Math" alttext="\displaystyle h_{i}^{k}" display="inline"><semantics id="Sx3.Ex16.m1.1a"><msubsup id="Sx3.Ex16.m1.1.1" xref="Sx3.Ex16.m1.1.1.cmml"><mi id="Sx3.Ex16.m1.1.1.2.2" xref="Sx3.Ex16.m1.1.1.2.2.cmml">h</mi><mi id="Sx3.Ex16.m1.1.1.2.3" xref="Sx3.Ex16.m1.1.1.2.3.cmml">i</mi><mi id="Sx3.Ex16.m1.1.1.3" xref="Sx3.Ex16.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.Ex16.m1.1b"><apply id="Sx3.Ex16.m1.1.1.cmml" xref="Sx3.Ex16.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex16.m1.1.1.1.cmml" xref="Sx3.Ex16.m1.1.1">superscript</csymbol><apply id="Sx3.Ex16.m1.1.1.2.cmml" xref="Sx3.Ex16.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex16.m1.1.1.2.1.cmml" xref="Sx3.Ex16.m1.1.1">subscript</csymbol><ci id="Sx3.Ex16.m1.1.1.2.2.cmml" xref="Sx3.Ex16.m1.1.1.2.2">ℎ</ci><ci id="Sx3.Ex16.m1.1.1.2.3.cmml" xref="Sx3.Ex16.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.Ex16.m1.1.1.3.cmml" xref="Sx3.Ex16.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex16.m1.1c">\displaystyle h_{i}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex16.m2.1" class="ltx_Math" alttext="\displaystyle=\alpha_{i}ReLU(W_{19}[m_{i}^{h};W_{20}v_{i}])" display="inline"><semantics id="Sx3.Ex16.m2.1a"><mrow id="Sx3.Ex16.m2.1.1" xref="Sx3.Ex16.m2.1.1.cmml"><mi id="Sx3.Ex16.m2.1.1.3" xref="Sx3.Ex16.m2.1.1.3.cmml"></mi><mo id="Sx3.Ex16.m2.1.1.2" xref="Sx3.Ex16.m2.1.1.2.cmml">=</mo><mrow id="Sx3.Ex16.m2.1.1.1" xref="Sx3.Ex16.m2.1.1.1.cmml"><msub id="Sx3.Ex16.m2.1.1.1.3" xref="Sx3.Ex16.m2.1.1.1.3.cmml"><mi id="Sx3.Ex16.m2.1.1.1.3.2" xref="Sx3.Ex16.m2.1.1.1.3.2.cmml">α</mi><mi id="Sx3.Ex16.m2.1.1.1.3.3" xref="Sx3.Ex16.m2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.2" xref="Sx3.Ex16.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex16.m2.1.1.1.4" xref="Sx3.Ex16.m2.1.1.1.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.2a" xref="Sx3.Ex16.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex16.m2.1.1.1.5" xref="Sx3.Ex16.m2.1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.2b" xref="Sx3.Ex16.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex16.m2.1.1.1.6" xref="Sx3.Ex16.m2.1.1.1.6.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.2c" xref="Sx3.Ex16.m2.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex16.m2.1.1.1.7" xref="Sx3.Ex16.m2.1.1.1.7.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.2d" xref="Sx3.Ex16.m2.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex16.m2.1.1.1.1.1" xref="Sx3.Ex16.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex16.m2.1.1.1.1.1.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex16.m2.1.1.1.1.1.1" xref="Sx3.Ex16.m2.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex16.m2.1.1.1.1.1.1.4" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4.cmml"><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.4.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4.2.cmml">W</mi><mn id="Sx3.Ex16.m2.1.1.1.1.1.1.4.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4.3.cmml">19</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.1.1.1.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.3.cmml">[</mo><msubsup id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.3.cmml">h</mi></msubsup><mo id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.4" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.3.cmml">;</mo><mrow id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.cmml"><msub id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.2.cmml">W</mi><mn id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">20</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.1" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.1.cmml">​</mo><msub id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.2" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">v</mi><mi id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.5" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex16.m2.1.1.1.1.1.3" xref="Sx3.Ex16.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex16.m2.1b"><apply id="Sx3.Ex16.m2.1.1.cmml" xref="Sx3.Ex16.m2.1.1"><eq id="Sx3.Ex16.m2.1.1.2.cmml" xref="Sx3.Ex16.m2.1.1.2"></eq><csymbol cd="latexml" id="Sx3.Ex16.m2.1.1.3.cmml" xref="Sx3.Ex16.m2.1.1.3">absent</csymbol><apply id="Sx3.Ex16.m2.1.1.1.cmml" xref="Sx3.Ex16.m2.1.1.1"><times id="Sx3.Ex16.m2.1.1.1.2.cmml" xref="Sx3.Ex16.m2.1.1.1.2"></times><apply id="Sx3.Ex16.m2.1.1.1.3.cmml" xref="Sx3.Ex16.m2.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.3.1.cmml" xref="Sx3.Ex16.m2.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex16.m2.1.1.1.3.2.cmml" xref="Sx3.Ex16.m2.1.1.1.3.2">𝛼</ci><ci id="Sx3.Ex16.m2.1.1.1.3.3.cmml" xref="Sx3.Ex16.m2.1.1.1.3.3">𝑖</ci></apply><ci id="Sx3.Ex16.m2.1.1.1.4.cmml" xref="Sx3.Ex16.m2.1.1.1.4">𝑅</ci><ci id="Sx3.Ex16.m2.1.1.1.5.cmml" xref="Sx3.Ex16.m2.1.1.1.5">𝑒</ci><ci id="Sx3.Ex16.m2.1.1.1.6.cmml" xref="Sx3.Ex16.m2.1.1.1.6">𝐿</ci><ci id="Sx3.Ex16.m2.1.1.1.7.cmml" xref="Sx3.Ex16.m2.1.1.1.7">𝑈</ci><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1"><times id="Sx3.Ex16.m2.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.3"></times><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.1.1.1.4.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.4.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4.2">𝑊</ci><cn type="integer" id="Sx3.Ex16.m2.1.1.1.1.1.1.4.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.4.3">19</cn></apply><list id="Sx3.Ex16.m2.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2"><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2"><times id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.1"></times><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.2">𝑊</ci><cn type="integer" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.2.3">20</cn></apply><apply id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.2">𝑣</ci><ci id="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="Sx3.Ex16.m2.1.1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex16.m2.1c">\displaystyle=\alpha_{i}ReLU(W_{19}[m_{i}^{h};W_{20}v_{i}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="Sx3.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex17.m1.1" class="ltx_Math" alttext="\displaystyle\hat{v}_{i}" display="inline"><semantics id="Sx3.Ex17.m1.1a"><msub id="Sx3.Ex17.m1.1.1" xref="Sx3.Ex17.m1.1.1.cmml"><mover accent="true" id="Sx3.Ex17.m1.1.1.2" xref="Sx3.Ex17.m1.1.1.2.cmml"><mi id="Sx3.Ex17.m1.1.1.2.2" xref="Sx3.Ex17.m1.1.1.2.2.cmml">v</mi><mo id="Sx3.Ex17.m1.1.1.2.1" xref="Sx3.Ex17.m1.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.Ex17.m1.1.1.3" xref="Sx3.Ex17.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.Ex17.m1.1b"><apply id="Sx3.Ex17.m1.1.1.cmml" xref="Sx3.Ex17.m1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex17.m1.1.1.1.cmml" xref="Sx3.Ex17.m1.1.1">subscript</csymbol><apply id="Sx3.Ex17.m1.1.1.2.cmml" xref="Sx3.Ex17.m1.1.1.2"><ci id="Sx3.Ex17.m1.1.1.2.1.cmml" xref="Sx3.Ex17.m1.1.1.2.1">^</ci><ci id="Sx3.Ex17.m1.1.1.2.2.cmml" xref="Sx3.Ex17.m1.1.1.2.2">𝑣</ci></apply><ci id="Sx3.Ex17.m1.1.1.3.cmml" xref="Sx3.Ex17.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex17.m1.1c">\displaystyle\hat{v}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.Ex17.m2.2" class="ltx_Math" alttext="\displaystyle=LayerNorm(ELU(W_{21}[h_{i}^{1};h_{i}^{2};\cdots;h_{i}^{H}]))" display="inline"><semantics id="Sx3.Ex17.m2.2a"><mrow id="Sx3.Ex17.m2.2.2" xref="Sx3.Ex17.m2.2.2.cmml"><mi id="Sx3.Ex17.m2.2.2.3" xref="Sx3.Ex17.m2.2.2.3.cmml"></mi><mo id="Sx3.Ex17.m2.2.2.2" xref="Sx3.Ex17.m2.2.2.2.cmml">=</mo><mrow id="Sx3.Ex17.m2.2.2.1" xref="Sx3.Ex17.m2.2.2.1.cmml"><mi id="Sx3.Ex17.m2.2.2.1.3" xref="Sx3.Ex17.m2.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.4" xref="Sx3.Ex17.m2.2.2.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2a" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.5" xref="Sx3.Ex17.m2.2.2.1.5.cmml">y</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2b" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.6" xref="Sx3.Ex17.m2.2.2.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2c" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.7" xref="Sx3.Ex17.m2.2.2.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2d" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.8" xref="Sx3.Ex17.m2.2.2.1.8.cmml">N</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2e" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.9" xref="Sx3.Ex17.m2.2.2.1.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2f" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.10" xref="Sx3.Ex17.m2.2.2.1.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2g" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.11" xref="Sx3.Ex17.m2.2.2.1.11.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.2h" xref="Sx3.Ex17.m2.2.2.1.2.cmml">​</mo><mrow id="Sx3.Ex17.m2.2.2.1.1.1" xref="Sx3.Ex17.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex17.m2.2.2.1.1.1.1" xref="Sx3.Ex17.m2.2.2.1.1.1.1.cmml"><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.1.1.1.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.4" xref="Sx3.Ex17.m2.2.2.1.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.1.1.1.2a" xref="Sx3.Ex17.m2.2.2.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.5" xref="Sx3.Ex17.m2.2.2.1.1.1.1.5.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.1.1.1.2b" xref="Sx3.Ex17.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.cmml"><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.2.cmml">W</mi><mn id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.3.cmml">21</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.4" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.4.cmml">​</mo><mrow id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml"><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.4" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml">[</mo><msubsup id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.5" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml">;</mo><msubsup id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mn id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup><mo id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.6" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml">;</mo><mi mathvariant="normal" id="Sx3.Ex17.m2.1.1" xref="Sx3.Ex17.m2.1.1.cmml">⋯</mi><mo id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.7" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml">;</mo><msubsup id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.2" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.2.cmml">h</mi><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.3.cmml">i</mi><mi id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.3.cmml">H</mi></msubsup><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.8" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.Ex17.m2.2.2.1.1.1.3" xref="Sx3.Ex17.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex17.m2.2b"><apply id="Sx3.Ex17.m2.2.2.cmml" xref="Sx3.Ex17.m2.2.2"><eq id="Sx3.Ex17.m2.2.2.2.cmml" xref="Sx3.Ex17.m2.2.2.2"></eq><csymbol cd="latexml" id="Sx3.Ex17.m2.2.2.3.cmml" xref="Sx3.Ex17.m2.2.2.3">absent</csymbol><apply id="Sx3.Ex17.m2.2.2.1.cmml" xref="Sx3.Ex17.m2.2.2.1"><times id="Sx3.Ex17.m2.2.2.1.2.cmml" xref="Sx3.Ex17.m2.2.2.1.2"></times><ci id="Sx3.Ex17.m2.2.2.1.3.cmml" xref="Sx3.Ex17.m2.2.2.1.3">𝐿</ci><ci id="Sx3.Ex17.m2.2.2.1.4.cmml" xref="Sx3.Ex17.m2.2.2.1.4">𝑎</ci><ci id="Sx3.Ex17.m2.2.2.1.5.cmml" xref="Sx3.Ex17.m2.2.2.1.5">𝑦</ci><ci id="Sx3.Ex17.m2.2.2.1.6.cmml" xref="Sx3.Ex17.m2.2.2.1.6">𝑒</ci><ci id="Sx3.Ex17.m2.2.2.1.7.cmml" xref="Sx3.Ex17.m2.2.2.1.7">𝑟</ci><ci id="Sx3.Ex17.m2.2.2.1.8.cmml" xref="Sx3.Ex17.m2.2.2.1.8">𝑁</ci><ci id="Sx3.Ex17.m2.2.2.1.9.cmml" xref="Sx3.Ex17.m2.2.2.1.9">𝑜</ci><ci id="Sx3.Ex17.m2.2.2.1.10.cmml" xref="Sx3.Ex17.m2.2.2.1.10">𝑟</ci><ci id="Sx3.Ex17.m2.2.2.1.11.cmml" xref="Sx3.Ex17.m2.2.2.1.11">𝑚</ci><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1"><times id="Sx3.Ex17.m2.2.2.1.1.1.1.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.2"></times><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.3">𝐸</ci><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.4.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.4">𝐿</ci><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.5.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.5">𝑈</ci><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1"><times id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.4"></times><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.2">𝑊</ci><cn type="integer" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.5.3">21</cn></apply><list id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3"><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="Sx3.Ex17.m2.1.1.cmml" xref="Sx3.Ex17.m2.1.1">⋯</ci><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.2">ℎ</ci><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.2.3">𝑖</ci></apply><ci id="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.Ex17.m2.2.2.1.1.1.1.1.1.1.3.3.3.3">𝐻</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex17.m2.2c">\displaystyle=LayerNorm(ELU(W_{21}[h_{i}^{1};h_{i}^{2};\cdots;h_{i}^{H}]))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p6.4" class="ltx_p">where <math id="Sx3.SSx3.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{N}_{i}" display="inline"><semantics id="Sx3.SSx3.p6.1.m1.1a"><msub id="Sx3.SSx3.p6.1.m1.1.1" xref="Sx3.SSx3.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p6.1.m1.1.1.2" xref="Sx3.SSx3.p6.1.m1.1.1.2.cmml">𝒩</mi><mi id="Sx3.SSx3.p6.1.m1.1.1.3" xref="Sx3.SSx3.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p6.1.m1.1b"><apply id="Sx3.SSx3.p6.1.m1.1.1.cmml" xref="Sx3.SSx3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p6.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p6.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p6.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p6.1.m1.1.1.2">𝒩</ci><ci id="Sx3.SSx3.p6.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p6.1.m1.1c">\mathcal{N}_{i}</annotation></semantics></math> is the neighborhood set of node <math id="Sx3.SSx3.p6.2.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="Sx3.SSx3.p6.2.m2.1a"><msub id="Sx3.SSx3.p6.2.m2.1.1" xref="Sx3.SSx3.p6.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p6.2.m2.1.1.2" xref="Sx3.SSx3.p6.2.m2.1.1.2.cmml">v</mi><mi id="Sx3.SSx3.p6.2.m2.1.1.3" xref="Sx3.SSx3.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p6.2.m2.1b"><apply id="Sx3.SSx3.p6.2.m2.1.1.cmml" xref="Sx3.SSx3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p6.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p6.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p6.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p6.2.m2.1.1.2">𝑣</ci><ci id="Sx3.SSx3.p6.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p6.2.m2.1c">v_{i}</annotation></semantics></math> and <math id="Sx3.SSx3.p6.3.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="Sx3.SSx3.p6.3.m3.1a"><mi id="Sx3.SSx3.p6.3.m3.1.1" xref="Sx3.SSx3.p6.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p6.3.m3.1b"><ci id="Sx3.SSx3.p6.3.m3.1.1.cmml" xref="Sx3.SSx3.p6.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p6.3.m3.1c">H</annotation></semantics></math> is the number of heads. Once all nodes are updated, the max pooling operation is conducted over all nodes to obtain the visual representation at reasoning step <math id="Sx3.SSx3.p6.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.SSx3.p6.4.m4.1a"><mi id="Sx3.SSx3.p6.4.m4.1.1" xref="Sx3.SSx3.p6.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p6.4.m4.1b"><ci id="Sx3.SSx3.p6.4.m4.1.1.cmml" xref="Sx3.SSx3.p6.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p6.4.m4.1c">t</annotation></semantics></math>:</p>
<table id="A0.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex18.m1.1" class="ltx_Math" alttext="\displaystyle I^{t}=MaxPooling(\{v_{i}\}_{i_{=}1}^{M})" display="inline"><semantics id="Sx3.Ex18.m1.1a"><mrow id="Sx3.Ex18.m1.1.1" xref="Sx3.Ex18.m1.1.1.cmml"><msup id="Sx3.Ex18.m1.1.1.3" xref="Sx3.Ex18.m1.1.1.3.cmml"><mi id="Sx3.Ex18.m1.1.1.3.2" xref="Sx3.Ex18.m1.1.1.3.2.cmml">I</mi><mi id="Sx3.Ex18.m1.1.1.3.3" xref="Sx3.Ex18.m1.1.1.3.3.cmml">t</mi></msup><mo id="Sx3.Ex18.m1.1.1.2" xref="Sx3.Ex18.m1.1.1.2.cmml">=</mo><mrow id="Sx3.Ex18.m1.1.1.1" xref="Sx3.Ex18.m1.1.1.1.cmml"><mi id="Sx3.Ex18.m1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.4" xref="Sx3.Ex18.m1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2a" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.5" xref="Sx3.Ex18.m1.1.1.1.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2b" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.6" xref="Sx3.Ex18.m1.1.1.1.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2c" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.7" xref="Sx3.Ex18.m1.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2d" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.8" xref="Sx3.Ex18.m1.1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2e" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.9" xref="Sx3.Ex18.m1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2f" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.10" xref="Sx3.Ex18.m1.1.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2g" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.11" xref="Sx3.Ex18.m1.1.1.1.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2h" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex18.m1.1.1.1.12" xref="Sx3.Ex18.m1.1.1.1.12.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.2i" xref="Sx3.Ex18.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex18.m1.1.1.1.1.1" xref="Sx3.Ex18.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex18.m1.1.1.1.1.1.2" xref="Sx3.Ex18.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.Ex18.m1.1.1.1.1.1.1" xref="Sx3.Ex18.m1.1.1.1.1.1.1.cmml"><mrow id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.cmml"><msub id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.2.cmml">i</mi><mo id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.3.cmml">=</mo></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.1" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mn id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex18.m1.1.1.1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.3.cmml">M</mi></msubsup><mo stretchy="false" id="Sx3.Ex18.m1.1.1.1.1.1.3" xref="Sx3.Ex18.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex18.m1.1b"><apply id="Sx3.Ex18.m1.1.1.cmml" xref="Sx3.Ex18.m1.1.1"><eq id="Sx3.Ex18.m1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.2"></eq><apply id="Sx3.Ex18.m1.1.1.3.cmml" xref="Sx3.Ex18.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex18.m1.1.1.3.1.cmml" xref="Sx3.Ex18.m1.1.1.3">superscript</csymbol><ci id="Sx3.Ex18.m1.1.1.3.2.cmml" xref="Sx3.Ex18.m1.1.1.3.2">𝐼</ci><ci id="Sx3.Ex18.m1.1.1.3.3.cmml" xref="Sx3.Ex18.m1.1.1.3.3">𝑡</ci></apply><apply id="Sx3.Ex18.m1.1.1.1.cmml" xref="Sx3.Ex18.m1.1.1.1"><times id="Sx3.Ex18.m1.1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.1.2"></times><ci id="Sx3.Ex18.m1.1.1.1.3.cmml" xref="Sx3.Ex18.m1.1.1.1.3">𝑀</ci><ci id="Sx3.Ex18.m1.1.1.1.4.cmml" xref="Sx3.Ex18.m1.1.1.1.4">𝑎</ci><ci id="Sx3.Ex18.m1.1.1.1.5.cmml" xref="Sx3.Ex18.m1.1.1.1.5">𝑥</ci><ci id="Sx3.Ex18.m1.1.1.1.6.cmml" xref="Sx3.Ex18.m1.1.1.1.6">𝑃</ci><ci id="Sx3.Ex18.m1.1.1.1.7.cmml" xref="Sx3.Ex18.m1.1.1.1.7">𝑜</ci><ci id="Sx3.Ex18.m1.1.1.1.8.cmml" xref="Sx3.Ex18.m1.1.1.1.8">𝑜</ci><ci id="Sx3.Ex18.m1.1.1.1.9.cmml" xref="Sx3.Ex18.m1.1.1.1.9">𝑙</ci><ci id="Sx3.Ex18.m1.1.1.1.10.cmml" xref="Sx3.Ex18.m1.1.1.1.10">𝑖</ci><ci id="Sx3.Ex18.m1.1.1.1.11.cmml" xref="Sx3.Ex18.m1.1.1.1.11">𝑛</ci><ci id="Sx3.Ex18.m1.1.1.1.12.cmml" xref="Sx3.Ex18.m1.1.1.1.12">𝑔</ci><apply id="Sx3.Ex18.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex18.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.Ex18.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1">subscript</csymbol><set id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1"><apply id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3"><times id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.1"></times><apply id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.2">𝑖</ci><eq id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.2.3"></eq></apply><cn type="integer" id="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="Sx3.Ex18.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex18.m1.1.1.1.1.1.1.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex18.m1.1c">\displaystyle I^{t}=MaxPooling(\{v_{i}\}_{i_{=}1}^{M})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.SSx3.p7" class="ltx_para ltx_noindent">
<p id="Sx3.SSx3.p7.4" class="ltx_p"><span id="Sx3.SSx3.p7.4.1" class="ltx_text ltx_font_bold">Final Prediction.</span> We iteratively perform knowledge key addressing, value reading and spatial-aware image graph attention reasoning for <math id="Sx3.SSx3.p7.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx3.p7.1.m1.1a"><mi id="Sx3.SSx3.p7.1.m1.1.1" xref="Sx3.SSx3.p7.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.1.m1.1b"><ci id="Sx3.SSx3.p7.1.m1.1.1.cmml" xref="Sx3.SSx3.p7.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.1.m1.1c">T</annotation></semantics></math> steps. At step <math id="Sx3.SSx3.p7.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx3.SSx3.p7.2.m2.1a"><mi id="Sx3.SSx3.p7.2.m2.1.1" xref="Sx3.SSx3.p7.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.2.m2.1b"><ci id="Sx3.SSx3.p7.2.m2.1.1.cmml" xref="Sx3.SSx3.p7.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.2.m2.1c">T</annotation></semantics></math> the given knowledge-aware question representation <math id="Sx3.SSx3.p7.3.m3.1" class="ltx_Math" alttext="R^{T}" display="inline"><semantics id="Sx3.SSx3.p7.3.m3.1a"><msup id="Sx3.SSx3.p7.3.m3.1.1" xref="Sx3.SSx3.p7.3.m3.1.1.cmml"><mi id="Sx3.SSx3.p7.3.m3.1.1.2" xref="Sx3.SSx3.p7.3.m3.1.1.2.cmml">R</mi><mi id="Sx3.SSx3.p7.3.m3.1.1.3" xref="Sx3.SSx3.p7.3.m3.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.3.m3.1b"><apply id="Sx3.SSx3.p7.3.m3.1.1.cmml" xref="Sx3.SSx3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p7.3.m3.1.1.1.cmml" xref="Sx3.SSx3.p7.3.m3.1.1">superscript</csymbol><ci id="Sx3.SSx3.p7.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p7.3.m3.1.1.2">𝑅</ci><ci id="Sx3.SSx3.p7.3.m3.1.1.3.cmml" xref="Sx3.SSx3.p7.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.3.m3.1c">R^{T}</annotation></semantics></math> and visual representation <math id="Sx3.SSx3.p7.4.m4.1" class="ltx_Math" alttext="I^{T}" display="inline"><semantics id="Sx3.SSx3.p7.4.m4.1a"><msup id="Sx3.SSx3.p7.4.m4.1.1" xref="Sx3.SSx3.p7.4.m4.1.1.cmml"><mi id="Sx3.SSx3.p7.4.m4.1.1.2" xref="Sx3.SSx3.p7.4.m4.1.1.2.cmml">I</mi><mi id="Sx3.SSx3.p7.4.m4.1.1.3" xref="Sx3.SSx3.p7.4.m4.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.4.m4.1b"><apply id="Sx3.SSx3.p7.4.m4.1.1.cmml" xref="Sx3.SSx3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p7.4.m4.1.1.1.cmml" xref="Sx3.SSx3.p7.4.m4.1.1">superscript</csymbol><ci id="Sx3.SSx3.p7.4.m4.1.1.2.cmml" xref="Sx3.SSx3.p7.4.m4.1.1.2">𝐼</ci><ci id="Sx3.SSx3.p7.4.m4.1.1.3.cmml" xref="Sx3.SSx3.p7.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.4.m4.1c">I^{T}</annotation></semantics></math> are concatenated and processed by a 2-layer linear transformation to predict the answer to the question. During training, we simply use the cross-entropy loss function (see equation below), to optimize the differences between the predicted answer and ground truth answer.</p>
<table id="A0.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.Ex19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.Ex19.m1.1" class="ltx_Math" alttext="\displaystyle L=-\frac{1}{N}\sum_{i=1}^{N}\sum_{c=1}^{L}y_{c}log(\hat{y}_{c})" display="inline"><semantics id="Sx3.Ex19.m1.1a"><mrow id="Sx3.Ex19.m1.1.1" xref="Sx3.Ex19.m1.1.1.cmml"><mi id="Sx3.Ex19.m1.1.1.3" xref="Sx3.Ex19.m1.1.1.3.cmml">L</mi><mo id="Sx3.Ex19.m1.1.1.2" xref="Sx3.Ex19.m1.1.1.2.cmml">=</mo><mrow id="Sx3.Ex19.m1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.cmml"><mo id="Sx3.Ex19.m1.1.1.1a" xref="Sx3.Ex19.m1.1.1.1.cmml">−</mo><mrow id="Sx3.Ex19.m1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.Ex19.m1.1.1.1.1.3" xref="Sx3.Ex19.m1.1.1.1.1.3.cmml"><mfrac id="Sx3.Ex19.m1.1.1.1.1.3a" xref="Sx3.Ex19.m1.1.1.1.1.3.cmml"><mn id="Sx3.Ex19.m1.1.1.1.1.3.2" xref="Sx3.Ex19.m1.1.1.1.1.3.2.cmml">1</mn><mi id="Sx3.Ex19.m1.1.1.1.1.3.3" xref="Sx3.Ex19.m1.1.1.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx3.Ex19.m1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex19.m1.1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.Ex19.m1.1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.1.2.cmml"><munderover id="Sx3.Ex19.m1.1.1.1.1.1.2a" xref="Sx3.Ex19.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.Ex19.m1.1.1.1.1.1.2.2.2" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.2" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.1" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.3" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex19.m1.1.1.1.1.1.2.3" xref="Sx3.Ex19.m1.1.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="Sx3.Ex19.m1.1.1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.Ex19.m1.1.1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.cmml"><munderover id="Sx3.Ex19.m1.1.1.1.1.1.1.2a" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.2.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><mrow id="Sx3.Ex19.m1.1.1.1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.4" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.2a" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.5" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.2b" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.6" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.2c" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex19.m1.1b"><apply id="Sx3.Ex19.m1.1.1.cmml" xref="Sx3.Ex19.m1.1.1"><eq id="Sx3.Ex19.m1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.2"></eq><ci id="Sx3.Ex19.m1.1.1.3.cmml" xref="Sx3.Ex19.m1.1.1.3">𝐿</ci><apply id="Sx3.Ex19.m1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1"><minus id="Sx3.Ex19.m1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1"></minus><apply id="Sx3.Ex19.m1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1"><times id="Sx3.Ex19.m1.1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.2"></times><apply id="Sx3.Ex19.m1.1.1.1.1.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.3"><divide id="Sx3.Ex19.m1.1.1.1.1.3.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.3"></divide><cn type="integer" id="Sx3.Ex19.m1.1.1.1.1.3.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.3.2">1</cn><ci id="Sx3.Ex19.m1.1.1.1.1.3.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.3.3">𝑁</ci></apply><apply id="Sx3.Ex19.m1.1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1"><apply id="Sx3.Ex19.m1.1.1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.Ex19.m1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.Ex19.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.2"></sum><apply id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3"><eq id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex19.m1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1"><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3"><eq id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1"><times id="Sx3.Ex19.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.4.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.4">𝑙</ci><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.5">𝑜</ci><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.6.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.6">𝑔</ci><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2"><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex19.m1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex19.m1.1c">\displaystyle L=-\frac{1}{N}\sum_{i=1}^{N}\sum_{c=1}^{L}y_{c}log(\hat{y}_{c})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p7.8" class="ltx_p">where <math id="Sx3.SSx3.p7.5.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx3.SSx3.p7.5.m1.1a"><mi id="Sx3.SSx3.p7.5.m1.1.1" xref="Sx3.SSx3.p7.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.5.m1.1b"><ci id="Sx3.SSx3.p7.5.m1.1.1.cmml" xref="Sx3.SSx3.p7.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.5.m1.1c">N</annotation></semantics></math> and <math id="Sx3.SSx3.p7.6.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="Sx3.SSx3.p7.6.m2.1a"><mi id="Sx3.SSx3.p7.6.m2.1.1" xref="Sx3.SSx3.p7.6.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.6.m2.1b"><ci id="Sx3.SSx3.p7.6.m2.1.1.cmml" xref="Sx3.SSx3.p7.6.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.6.m2.1c">L</annotation></semantics></math> are the number of training samples and candidate answers, respectively. <math id="Sx3.SSx3.p7.7.m3.1" class="ltx_Math" alttext="y_{c}" display="inline"><semantics id="Sx3.SSx3.p7.7.m3.1a"><msub id="Sx3.SSx3.p7.7.m3.1.1" xref="Sx3.SSx3.p7.7.m3.1.1.cmml"><mi id="Sx3.SSx3.p7.7.m3.1.1.2" xref="Sx3.SSx3.p7.7.m3.1.1.2.cmml">y</mi><mi id="Sx3.SSx3.p7.7.m3.1.1.3" xref="Sx3.SSx3.p7.7.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.7.m3.1b"><apply id="Sx3.SSx3.p7.7.m3.1.1.cmml" xref="Sx3.SSx3.p7.7.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p7.7.m3.1.1.1.cmml" xref="Sx3.SSx3.p7.7.m3.1.1">subscript</csymbol><ci id="Sx3.SSx3.p7.7.m3.1.1.2.cmml" xref="Sx3.SSx3.p7.7.m3.1.1.2">𝑦</ci><ci id="Sx3.SSx3.p7.7.m3.1.1.3.cmml" xref="Sx3.SSx3.p7.7.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.7.m3.1c">y_{c}</annotation></semantics></math> is the ground truth answer, and <math id="Sx3.SSx3.p7.8.m4.1" class="ltx_Math" alttext="\hat{y}_{c}" display="inline"><semantics id="Sx3.SSx3.p7.8.m4.1a"><msub id="Sx3.SSx3.p7.8.m4.1.1" xref="Sx3.SSx3.p7.8.m4.1.1.cmml"><mover accent="true" id="Sx3.SSx3.p7.8.m4.1.1.2" xref="Sx3.SSx3.p7.8.m4.1.1.2.cmml"><mi id="Sx3.SSx3.p7.8.m4.1.1.2.2" xref="Sx3.SSx3.p7.8.m4.1.1.2.2.cmml">y</mi><mo id="Sx3.SSx3.p7.8.m4.1.1.2.1" xref="Sx3.SSx3.p7.8.m4.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx3.p7.8.m4.1.1.3" xref="Sx3.SSx3.p7.8.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p7.8.m4.1b"><apply id="Sx3.SSx3.p7.8.m4.1.1.cmml" xref="Sx3.SSx3.p7.8.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p7.8.m4.1.1.1.cmml" xref="Sx3.SSx3.p7.8.m4.1.1">subscript</csymbol><apply id="Sx3.SSx3.p7.8.m4.1.1.2.cmml" xref="Sx3.SSx3.p7.8.m4.1.1.2"><ci id="Sx3.SSx3.p7.8.m4.1.1.2.1.cmml" xref="Sx3.SSx3.p7.8.m4.1.1.2.1">^</ci><ci id="Sx3.SSx3.p7.8.m4.1.1.2.2.cmml" xref="Sx3.SSx3.p7.8.m4.1.1.2.2">𝑦</ci></apply><ci id="Sx3.SSx3.p7.8.m4.1.1.3.cmml" xref="Sx3.SSx3.p7.8.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p7.8.m4.1c">\hat{y}_{c}</annotation></semantics></math> is the predicted answer.</p>
</div>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<div id="Sx4.p1" class="ltx_para">
<p id="Sx4.p1.9" class="ltx_p"><span id="Sx4.p1.9.1" class="ltx_text ltx_font_bold">Datasets</span>. In this paper we mainly focus on the KRVQR <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> dataset and also test our model on the FVQA <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> dataset, as these are the only two knowledge VQA datasets that provide the knowledge base for answering the questions. The KRVQR dataset consists of 32910 images and 157201 question answer pairs, divided into training, validation and test sets with proportions of <math id="Sx4.p1.1.m1.1" class="ltx_Math" alttext="60\%" display="inline"><semantics id="Sx4.p1.1.m1.1a"><mrow id="Sx4.p1.1.m1.1.1" xref="Sx4.p1.1.m1.1.1.cmml"><mn id="Sx4.p1.1.m1.1.1.2" xref="Sx4.p1.1.m1.1.1.2.cmml">60</mn><mo id="Sx4.p1.1.m1.1.1.1" xref="Sx4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p1.1.m1.1b"><apply id="Sx4.p1.1.m1.1.1.cmml" xref="Sx4.p1.1.m1.1.1"><csymbol cd="latexml" id="Sx4.p1.1.m1.1.1.1.cmml" xref="Sx4.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="Sx4.p1.1.m1.1.1.2.cmml" xref="Sx4.p1.1.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.1.m1.1c">60\%</annotation></semantics></math>, <math id="Sx4.p1.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="Sx4.p1.2.m2.1a"><mrow id="Sx4.p1.2.m2.1.1" xref="Sx4.p1.2.m2.1.1.cmml"><mn id="Sx4.p1.2.m2.1.1.2" xref="Sx4.p1.2.m2.1.1.2.cmml">20</mn><mo id="Sx4.p1.2.m2.1.1.1" xref="Sx4.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p1.2.m2.1b"><apply id="Sx4.p1.2.m2.1.1.cmml" xref="Sx4.p1.2.m2.1.1"><csymbol cd="latexml" id="Sx4.p1.2.m2.1.1.1.cmml" xref="Sx4.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="Sx4.p1.2.m2.1.1.2.cmml" xref="Sx4.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.2.m2.1c">20\%</annotation></semantics></math> and <math id="Sx4.p1.3.m3.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="Sx4.p1.3.m3.1a"><mrow id="Sx4.p1.3.m3.1.1" xref="Sx4.p1.3.m3.1.1.cmml"><mn id="Sx4.p1.3.m3.1.1.2" xref="Sx4.p1.3.m3.1.1.2.cmml">20</mn><mo id="Sx4.p1.3.m3.1.1.1" xref="Sx4.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p1.3.m3.1b"><apply id="Sx4.p1.3.m3.1.1.cmml" xref="Sx4.p1.3.m3.1.1"><csymbol cd="latexml" id="Sx4.p1.3.m3.1.1.1.cmml" xref="Sx4.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="Sx4.p1.3.m3.1.1.2.cmml" xref="Sx4.p1.3.m3.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.3.m3.1c">20\%</annotation></semantics></math>, respectively. The FVQA dataset contains <math id="Sx4.p1.4.m4.1" class="ltx_Math" alttext="2190" display="inline"><semantics id="Sx4.p1.4.m4.1a"><mn id="Sx4.p1.4.m4.1.1" xref="Sx4.p1.4.m4.1.1.cmml">2190</mn><annotation-xml encoding="MathML-Content" id="Sx4.p1.4.m4.1b"><cn type="integer" id="Sx4.p1.4.m4.1.1.cmml" xref="Sx4.p1.4.m4.1.1">2190</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.4.m4.1c">2190</annotation></semantics></math> images and <math id="Sx4.p1.5.m5.1" class="ltx_Math" alttext="5826" display="inline"><semantics id="Sx4.p1.5.m5.1a"><mn id="Sx4.p1.5.m5.1.1" xref="Sx4.p1.5.m5.1.1.cmml">5826</mn><annotation-xml encoding="MathML-Content" id="Sx4.p1.5.m5.1b"><cn type="integer" id="Sx4.p1.5.m5.1.1.cmml" xref="Sx4.p1.5.m5.1.1">5826</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.5.m5.1c">5826</annotation></semantics></math> questions, which are further split into training (<math id="Sx4.p1.6.m6.1" class="ltx_Math" alttext="2927" display="inline"><semantics id="Sx4.p1.6.m6.1a"><mn id="Sx4.p1.6.m6.1.1" xref="Sx4.p1.6.m6.1.1.cmml">2927</mn><annotation-xml encoding="MathML-Content" id="Sx4.p1.6.m6.1b"><cn type="integer" id="Sx4.p1.6.m6.1.1.cmml" xref="Sx4.p1.6.m6.1.1">2927</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.6.m6.1c">2927</annotation></semantics></math>) and test (<math id="Sx4.p1.7.m7.1" class="ltx_Math" alttext="2899" display="inline"><semantics id="Sx4.p1.7.m7.1a"><mn id="Sx4.p1.7.m7.1.1" xref="Sx4.p1.7.m7.1.1.cmml">2899</mn><annotation-xml encoding="MathML-Content" id="Sx4.p1.7.m7.1b"><cn type="integer" id="Sx4.p1.7.m7.1.1.cmml" xref="Sx4.p1.7.m7.1.1">2899</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.7.m7.1c">2899</annotation></semantics></math>) sets. The KRVQR dataset contains <math id="Sx4.p1.8.m8.1" class="ltx_Math" alttext="43.5\%" display="inline"><semantics id="Sx4.p1.8.m8.1a"><mrow id="Sx4.p1.8.m8.1.1" xref="Sx4.p1.8.m8.1.1.cmml"><mn id="Sx4.p1.8.m8.1.1.2" xref="Sx4.p1.8.m8.1.1.2.cmml">43.5</mn><mo id="Sx4.p1.8.m8.1.1.1" xref="Sx4.p1.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p1.8.m8.1b"><apply id="Sx4.p1.8.m8.1.1.cmml" xref="Sx4.p1.8.m8.1.1"><csymbol cd="latexml" id="Sx4.p1.8.m8.1.1.1.cmml" xref="Sx4.p1.8.m8.1.1.1">percent</csymbol><cn type="float" id="Sx4.p1.8.m8.1.1.2.cmml" xref="Sx4.p1.8.m8.1.1.2">43.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.8.m8.1c">43.5\%</annotation></semantics></math> one-step reasoning and <math id="Sx4.p1.9.m9.1" class="ltx_Math" alttext="56.5\%" display="inline"><semantics id="Sx4.p1.9.m9.1a"><mrow id="Sx4.p1.9.m9.1.1" xref="Sx4.p1.9.m9.1.1.cmml"><mn id="Sx4.p1.9.m9.1.1.2" xref="Sx4.p1.9.m9.1.1.2.cmml">56.5</mn><mo id="Sx4.p1.9.m9.1.1.1" xref="Sx4.p1.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p1.9.m9.1b"><apply id="Sx4.p1.9.m9.1.1.cmml" xref="Sx4.p1.9.m9.1.1"><csymbol cd="latexml" id="Sx4.p1.9.m9.1.1.1.cmml" xref="Sx4.p1.9.m9.1.1.1">percent</csymbol><cn type="float" id="Sx4.p1.9.m9.1.1.2.cmml" xref="Sx4.p1.9.m9.1.1.2">56.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p1.9.m9.1c">56.5\%</annotation></semantics></math> two-step reasoning questions, and the FVQA dataset contains only one-step reasoning questions <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>. Two-step reasoning questions need to reason over two relations to infer the answer, while one-step reasoning questions need only one relation, where relations can be found in the KB and/or image. An example of a two-step and an example of a one-step reasoning question are presented on the top and bottom of Figure 1, respectively.</p>
</div>
<div id="Sx4.p2" class="ltx_para">
<p id="Sx4.p2.1" class="ltx_p"><span id="Sx4.p2.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics</span>. Following the literature <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>; Wang et al. <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>, we evaluate our model using top-1 accuracy (KRVQR and FVQA datasets) and top-3 accuracy (FVQA dataset).</p>
</div>
<div id="Sx4.p3" class="ltx_para">
<p id="Sx4.p3.2" class="ltx_p"><span id="Sx4.p3.2.1" class="ltx_text ltx_font_bold">Implementation Details</span>.
We implement our model using the PyTorch framework <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al. <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>. The hidden size of the LSTM encoder is set to 512, and the dropout rate is 0.1. We set the sizes of the dynamic key-value memory embeddings and graph node and edge embeddings to 300 and 1024, respectively. The number of reasoning steps<a href="#Sx3.SSx3" title="Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_title">Iterative Reasoning Module</span></a> is set to <math id="Sx4.p3.1.m1.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Sx4.p3.1.m1.1a"><mn id="Sx4.p3.1.m1.1.1" xref="Sx4.p3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="Sx4.p3.1.m1.1b"><cn type="integer" id="Sx4.p3.1.m1.1.1.cmml" xref="Sx4.p3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p3.1.m1.1c">2</annotation></semantics></math> as the questions in the dataset require maximum 2 reasoning steps. All these parameters are selected based on the validation results. The model is trained using the Adam algorithm <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba <a href="#bib.bib13" title="" class="ltx_ref">2014</a>)</cite> with a base learning rate of <math id="Sx4.p3.2.m2.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="Sx4.p3.2.m2.1a"><mrow id="Sx4.p3.2.m2.1.1" xref="Sx4.p3.2.m2.1.1.cmml"><mn id="Sx4.p3.2.m2.1.1.2" xref="Sx4.p3.2.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="Sx4.p3.2.m2.1.1.1" xref="Sx4.p3.2.m2.1.1.1.cmml">​</mo><msup id="Sx4.p3.2.m2.1.1.3" xref="Sx4.p3.2.m2.1.1.3.cmml"><mi id="Sx4.p3.2.m2.1.1.3.2" xref="Sx4.p3.2.m2.1.1.3.2.cmml">e</mi><mrow id="Sx4.p3.2.m2.1.1.3.3" xref="Sx4.p3.2.m2.1.1.3.3.cmml"><mo id="Sx4.p3.2.m2.1.1.3.3a" xref="Sx4.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="Sx4.p3.2.m2.1.1.3.3.2" xref="Sx4.p3.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx4.p3.2.m2.1b"><apply id="Sx4.p3.2.m2.1.1.cmml" xref="Sx4.p3.2.m2.1.1"><times id="Sx4.p3.2.m2.1.1.1.cmml" xref="Sx4.p3.2.m2.1.1.1"></times><cn type="integer" id="Sx4.p3.2.m2.1.1.2.cmml" xref="Sx4.p3.2.m2.1.1.2">1</cn><apply id="Sx4.p3.2.m2.1.1.3.cmml" xref="Sx4.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx4.p3.2.m2.1.1.3.1.cmml" xref="Sx4.p3.2.m2.1.1.3">superscript</csymbol><ci id="Sx4.p3.2.m2.1.1.3.2.cmml" xref="Sx4.p3.2.m2.1.1.3.2">𝑒</ci><apply id="Sx4.p3.2.m2.1.1.3.3.cmml" xref="Sx4.p3.2.m2.1.1.3.3"><minus id="Sx4.p3.2.m2.1.1.3.3.1.cmml" xref="Sx4.p3.2.m2.1.1.3.3"></minus><cn type="integer" id="Sx4.p3.2.m2.1.1.3.3.2.cmml" xref="Sx4.p3.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.p3.2.m2.1c">1e^{-4}</annotation></semantics></math>. We gradually increase the learning rate over the first two epochs and start decaying the learning rate at epoch 20. The best model is trained for approximately 40 epochs with a batch size of 128.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Iterative Reasoning Module</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>    Question <math id="alg1.l0.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">Q</annotation></semantics></math>, key-value memory <math id="alg1.l0.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">M</annotation></semantics></math>, spatial-aware image graph <math id="alg1.l0.m3.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">G</annotation></semantics></math>

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>    Answer prediction <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l0a.m1.1a"><mi id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">P</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Process <math id="alg1.l1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">Q</annotation></semantics></math> based on Equation <a href="#Sx3.Ex1" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  Initialize <math id="alg1.l2.m1.2" class="ltx_Math" alttext="c^{1}=[\overrightarrow{h_{S}};\overleftarrow{h}_{1}]" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml"><msup id="alg1.l2.m1.2.2.3" xref="alg1.l2.m1.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.3.2" xref="alg1.l2.m1.2.2.3.2.cmml">c</mi><mn id="alg1.l2.m1.2.2.3.3" xref="alg1.l2.m1.2.2.3.3.cmml">1</mn></msup><mo id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml">=</mo><mrow id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.2.cmml">[</mo><mover accent="true" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">h</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">S</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">→</mo></mover><mo id="alg1.l2.m1.2.2.1.1.3" xref="alg1.l2.m1.2.2.1.2.cmml">;</mo><msub id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml"><mover accent="true" id="alg1.l2.m1.2.2.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.2.cmml"><mi id="alg1.l2.m1.2.2.1.1.1.2.2" xref="alg1.l2.m1.2.2.1.1.1.2.2.cmml">h</mi><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.1.2.1" xref="alg1.l2.m1.2.2.1.1.1.2.1.cmml">←</mo></mover><mn id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.4" xref="alg1.l2.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2"><eq id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"></eq><apply id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.3">superscript</csymbol><ci id="alg1.l2.m1.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.3.2">𝑐</ci><cn type="integer" id="alg1.l2.m1.2.2.3.3.cmml" xref="alg1.l2.m1.2.2.3.3">1</cn></apply><list id="alg1.l2.m1.2.2.1.2.cmml" xref="alg1.l2.m1.2.2.1.1"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">→</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">ℎ</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑆</ci></apply></apply><apply id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.l2.m1.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2"><ci id="alg1.l2.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.2.1">←</ci><ci id="alg1.l2.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2.2">ℎ</ci></apply><cn type="integer" id="alg1.l2.m1.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">c^{1}=[\overrightarrow{h_{S}};\overleftarrow{h}_{1}]</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">t</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t=1</annotation></semantics></math> to <math id="alg1.l3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">T</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Obtain <math id="alg1.l4.m1.1" class="ltx_Math" alttext="q^{t}" display="inline"><semantics id="alg1.l4.m1.1a"><msup id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">q</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑞</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">q^{t}</annotation></semantics></math> based on Equations <a href="#Sx3.Ex2" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#Sx3.Ex3" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     Perform key addressing and value reading to obtain the representation of the knowledge triplets <math id="alg1.l5.m1.1" class="ltx_Math" alttext="m^{t}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">m</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑚</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">m^{t}</annotation></semantics></math> based on Equations <a href="#Sx3.Ex5" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><math id="alg1.l5.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="alg1.l5.m2.1a"><mo id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><csymbol cd="latexml" id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\sim</annotation></semantics></math><a href="#Sx3.Ex11" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Obtain the knowledge-aware question representation <math id="alg1.l6.m1.1" class="ltx_Math" alttext="R^{t}" display="inline"><semantics id="alg1.l6.m1.1a"><msup id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">R</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑅</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">R^{t}</annotation></semantics></math> based on Equation <a href="#Sx3.Ex12" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     Compute the question knowledge-guided visual node and edge attention based on Equations <a href="#Sx3.Ex13" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> and <a href="#Sx3.Ex14" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     Update the visual node representation <math id="alg1.l8.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">v</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑣</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">v_{i}</annotation></semantics></math> based on Equations <a href="#Sx3.Ex15" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a><math id="alg1.l8.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="alg1.l8.m2.1a"><mo id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><csymbol cd="latexml" id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\sim</annotation></semantics></math><a href="#Sx3.Ex17" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Obtain the spatial-aware image graph output <math id="alg1.l9.m1.1" class="ltx_Math" alttext="I^{t}" display="inline"><semantics id="alg1.l9.m1.1a"><msup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">I</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝐼</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">I^{t}</annotation></semantics></math> based on Equation <a href="#Sx3.Ex18" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></a>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l10.m1.1" class="ltx_Math" alttext="t&lt;T-1" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">&lt;</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">T</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><lt id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></lt><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑡</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><minus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></minus><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑇</ci><cn type="integer" id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">t&lt;T-1</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>        Update context representation <math id="alg1.l11.m1.1" class="ltx_Math" alttext="c^{t}" display="inline"><semantics id="alg1.l11.m1.1a"><msup id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">c</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑐</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">c^{t}</annotation></semantics></math> based on Equation <a href="#Sx3.Ex4" title="In Iterative Reasoning Module ‣ Methodology ‣ Dynamic Key-value Memory Enhanced Multi-step Graph Reasoning for Knowledge-based Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span id="alg1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>  <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>  <math id="alg1.l14.m1.1" class="ltx_Math" alttext="P=Linear(Linear([R^{T};I^{T}]))" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">P</mi><mo id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">=</mo><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.4" xref="alg1.l14.m1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.5" xref="alg1.l14.m1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2b" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.6" xref="alg1.l14.m1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2c" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.7" xref="alg1.l14.m1.1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2d" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.8" xref="alg1.l14.m1.1.1.1.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.2e" xref="alg1.l14.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.4" xref="alg1.l14.m1.1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.5" xref="alg1.l14.m1.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2b" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.6" xref="alg1.l14.m1.1.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2c" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.7" xref="alg1.l14.m1.1.1.1.1.1.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2d" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.8" xref="alg1.l14.m1.1.1.1.1.1.1.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.1.2e" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.3.cmml">[</mo><msup id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.4" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.3.cmml">;</mo><msup id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">I</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msup><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.5" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"></eq><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑃</ci><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><times id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></times><ci id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3">𝐿</ci><ci id="alg1.l14.m1.1.1.1.4.cmml" xref="alg1.l14.m1.1.1.1.4">𝑖</ci><ci id="alg1.l14.m1.1.1.1.5.cmml" xref="alg1.l14.m1.1.1.1.5">𝑛</ci><ci id="alg1.l14.m1.1.1.1.6.cmml" xref="alg1.l14.m1.1.1.1.6">𝑒</ci><ci id="alg1.l14.m1.1.1.1.7.cmml" xref="alg1.l14.m1.1.1.1.7">𝑎</ci><ci id="alg1.l14.m1.1.1.1.8.cmml" xref="alg1.l14.m1.1.1.1.8">𝑟</ci><apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><times id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3">𝐿</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.5">𝑛</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.6">𝑒</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.7.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.7">𝑎</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.8.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.8">𝑟</ci><list id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2"><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝐼</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">P=Linear(Linear([R^{T};I^{T}]))</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>  <span id="alg1.l15.1" class="ltx_text ltx_font_bold">return</span>  <math id="alg1.l15.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">P</annotation></semantics></math>

</div>
</div>
</figure>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Results</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.6" class="ltx_p">Table 1 illustrates the accuracy comparison between our DMMGR model with other models including the state-of-the-art VQA and knowledge based VQA models. The Q-type <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, LSTM <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, FiLM <cite class="ltx_cite ltx_citemacro_citep">(Perez et al. <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite>, MFH <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>, UpDown <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, and state-of-the-art VQA model MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite> were reimplemented and tested on the KRVQR dataset in the work of <cite class="ltx_cite ltx_citemacro_citet">Cao et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, and we copy the obtained results here. As running software is not publicly available, we reimplement the Mucko model and test it on the KRVQR dataset. All our results are average over <math id="Sx5.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="Sx5.p1.1.m1.1a"><mn id="Sx5.p1.1.m1.1.1" xref="Sx5.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="Sx5.p1.1.m1.1b"><cn type="integer" id="Sx5.p1.1.m1.1.1.cmml" xref="Sx5.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.p1.1.m1.1c">5</annotation></semantics></math> runs. As presented in Table 1, our DMMGR model significantly outperforms all the other models and surpasses the current state-of-the-art model (KM-net) by approxiFmately <span id="Sx5.p1.6.1" class="ltx_text ltx_markedasmath ltx_font_bold">6%</span> in terms of accuracy. We also present the results of DMMGR extended with a semantic graph based on dense captioning of image regions that aims at including attributes of the image regions (DMMGR + Dense Captioning) following the method described in <cite class="ltx_cite ltx_citemacro_citet">Yu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite>. We see a slight accuracy improvement when including the dense captioning information in the DMMGR model, however, statistical significance testing (t-test <math id="Sx5.p1.3.m3.1" class="ltx_Math" alttext="p=0.051" display="inline"><semantics id="Sx5.p1.3.m3.1a"><mrow id="Sx5.p1.3.m3.1.1" xref="Sx5.p1.3.m3.1.1.cmml"><mi id="Sx5.p1.3.m3.1.1.2" xref="Sx5.p1.3.m3.1.1.2.cmml">p</mi><mo id="Sx5.p1.3.m3.1.1.1" xref="Sx5.p1.3.m3.1.1.1.cmml">=</mo><mn id="Sx5.p1.3.m3.1.1.3" xref="Sx5.p1.3.m3.1.1.3.cmml">0.051</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx5.p1.3.m3.1b"><apply id="Sx5.p1.3.m3.1.1.cmml" xref="Sx5.p1.3.m3.1.1"><eq id="Sx5.p1.3.m3.1.1.1.cmml" xref="Sx5.p1.3.m3.1.1.1"></eq><ci id="Sx5.p1.3.m3.1.1.2.cmml" xref="Sx5.p1.3.m3.1.1.2">𝑝</ci><cn type="float" id="Sx5.p1.3.m3.1.1.3.cmml" xref="Sx5.p1.3.m3.1.1.3">0.051</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.p1.3.m3.1c">p=0.051</annotation></semantics></math>) shows that no significant differences can be observed. We report the results on the FVQA dataset in Table 2. GRUC <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite> is the current state-of-the-art model for the FVQA dataset. The complete GRUC model also integrates information from a pretrained image dense caption generation model.
The table shows that both the DMMGR and DMMGR + Dense Captioning models outperform GRUC, thus obtaining new state-of-the-art performance for the FVQA dataset. Integrating the dense captioning information in the DMMGR model could significantly improve its accuracy on the FVQA dataset by around <math id="Sx5.p1.4.m4.1" class="ltx_Math" alttext="2.6\%" display="inline"><semantics id="Sx5.p1.4.m4.1a"><mrow id="Sx5.p1.4.m4.1.1" xref="Sx5.p1.4.m4.1.1.cmml"><mn id="Sx5.p1.4.m4.1.1.2" xref="Sx5.p1.4.m4.1.1.2.cmml">2.6</mn><mo id="Sx5.p1.4.m4.1.1.1" xref="Sx5.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx5.p1.4.m4.1b"><apply id="Sx5.p1.4.m4.1.1.cmml" xref="Sx5.p1.4.m4.1.1"><csymbol cd="latexml" id="Sx5.p1.4.m4.1.1.1.cmml" xref="Sx5.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="Sx5.p1.4.m4.1.1.2.cmml" xref="Sx5.p1.4.m4.1.1.2">2.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.p1.4.m4.1c">2.6\%</annotation></semantics></math> (t-test <math id="Sx5.p1.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="Sx5.p1.5.m5.1a"><mi id="Sx5.p1.5.m5.1.1" xref="Sx5.p1.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Sx5.p1.5.m5.1b"><ci id="Sx5.p1.5.m5.1.1.cmml" xref="Sx5.p1.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.p1.5.m5.1c">p</annotation></semantics></math> = <math id="Sx5.p1.6.m6.1" class="ltx_Math" alttext="0.02" display="inline"><semantics id="Sx5.p1.6.m6.1a"><mn id="Sx5.p1.6.m6.1.1" xref="Sx5.p1.6.m6.1.1.cmml">0.02</mn><annotation-xml encoding="MathML-Content" id="Sx5.p1.6.m6.1b"><cn type="float" id="Sx5.p1.6.m6.1.1.cmml" xref="Sx5.p1.6.m6.1.1">0.02</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.p1.6.m6.1c">0.02</annotation></semantics></math>), which is different from what we observe in the KRVQR dataset. This difference might come from the difference of data distribution and types of questions in the two datasets.</p>
</div>
<figure id="Sx5.T1" class="ltx_table">
<table id="Sx5.T1.10" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx5.T1.10.11.1" class="ltx_tr">
<th id="Sx5.T1.10.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Model</th>
<th id="Sx5.T1.10.11.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx5.T1.1.1" class="ltx_tr">
<th id="Sx5.T1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Q-type <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="Sx5.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx5.T1.1.1.1.m1.1" class="ltx_Math" alttext="8.12" display="inline"><semantics id="Sx5.T1.1.1.1.m1.1a"><mn id="Sx5.T1.1.1.1.m1.1.1" xref="Sx5.T1.1.1.1.m1.1.1.cmml">8.12</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.1.1.1.m1.1b"><cn type="float" id="Sx5.T1.1.1.1.m1.1.1.cmml" xref="Sx5.T1.1.1.1.m1.1.1">8.12</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.1.1.1.m1.1c">8.12</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.2.2" class="ltx_tr">
<th id="Sx5.T1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">LSTM <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="Sx5.T1.2.2.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.2.2.1.m1.1" class="ltx_Math" alttext="8.81" display="inline"><semantics id="Sx5.T1.2.2.1.m1.1a"><mn id="Sx5.T1.2.2.1.m1.1.1" xref="Sx5.T1.2.2.1.m1.1.1.cmml">8.81</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.2.2.1.m1.1b"><cn type="float" id="Sx5.T1.2.2.1.m1.1.1.cmml" xref="Sx5.T1.2.2.1.m1.1.1">8.81</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.2.2.1.m1.1c">8.81</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.3.3" class="ltx_tr">
<th id="Sx5.T1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FiLM <cite class="ltx_cite ltx_citemacro_citep">(Perez et al. <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite>
</th>
<td id="Sx5.T1.3.3.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.3.3.1.m1.1" class="ltx_Math" alttext="16.89" display="inline"><semantics id="Sx5.T1.3.3.1.m1.1a"><mn id="Sx5.T1.3.3.1.m1.1.1" xref="Sx5.T1.3.3.1.m1.1.1.cmml">16.89</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.3.3.1.m1.1b"><cn type="float" id="Sx5.T1.3.3.1.m1.1.1.cmml" xref="Sx5.T1.3.3.1.m1.1.1">16.89</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.3.3.1.m1.1c">16.89</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.4.4" class="ltx_tr">
<th id="Sx5.T1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MFH <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>
</th>
<td id="Sx5.T1.4.4.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.4.4.1.m1.1" class="ltx_Math" alttext="19.55" display="inline"><semantics id="Sx5.T1.4.4.1.m1.1a"><mn id="Sx5.T1.4.4.1.m1.1.1" xref="Sx5.T1.4.4.1.m1.1.1.cmml">19.55</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.4.4.1.m1.1b"><cn type="float" id="Sx5.T1.4.4.1.m1.1.1.cmml" xref="Sx5.T1.4.4.1.m1.1.1">19.55</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.4.4.1.m1.1c">19.55</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.5.5" class="ltx_tr">
<th id="Sx5.T1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">UpDown <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al. <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>
</th>
<td id="Sx5.T1.5.5.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.5.5.1.m1.1" class="ltx_Math" alttext="21.85" display="inline"><semantics id="Sx5.T1.5.5.1.m1.1a"><mn id="Sx5.T1.5.5.1.m1.1.1" xref="Sx5.T1.5.5.1.m1.1.1.cmml">21.85</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.5.5.1.m1.1b"><cn type="float" id="Sx5.T1.5.5.1.m1.1.1.cmml" xref="Sx5.T1.5.5.1.m1.1.1">21.85</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.5.5.1.m1.1c">21.85</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.6.6" class="ltx_tr">
<th id="Sx5.T1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">MCAN <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="Sx5.T1.6.6.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.6.6.1.m1.1" class="ltx_Math" alttext="22.23" display="inline"><semantics id="Sx5.T1.6.6.1.m1.1a"><mn id="Sx5.T1.6.6.1.m1.1.1" xref="Sx5.T1.6.6.1.m1.1.1.cmml">22.23</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.6.6.1.m1.1b"><cn type="float" id="Sx5.T1.6.6.1.m1.1.1.cmml" xref="Sx5.T1.6.6.1.m1.1.1">22.23</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.6.6.1.m1.1c">22.23</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.7.7" class="ltx_tr">
<th id="Sx5.T1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Mucko <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="Sx5.T1.7.7.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.7.7.1.m1.1" class="ltx_Math" alttext="24.00" display="inline"><semantics id="Sx5.T1.7.7.1.m1.1a"><mn id="Sx5.T1.7.7.1.m1.1.1" xref="Sx5.T1.7.7.1.m1.1.1.cmml">24.00</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.7.7.1.m1.1b"><cn type="float" id="Sx5.T1.7.7.1.m1.1.1.cmml" xref="Sx5.T1.7.7.1.m1.1.1">24.00</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.7.7.1.m1.1c">24.00</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.8.8" class="ltx_tr">
<th id="Sx5.T1.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">KM-net <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="Sx5.T1.8.8.1" class="ltx_td ltx_align_center"><math id="Sx5.T1.8.8.1.m1.1" class="ltx_Math" alttext="25.19" display="inline"><semantics id="Sx5.T1.8.8.1.m1.1a"><mn id="Sx5.T1.8.8.1.m1.1.1" xref="Sx5.T1.8.8.1.m1.1.1.cmml">25.19</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.8.8.1.m1.1b"><cn type="float" id="Sx5.T1.8.8.1.m1.1.1.cmml" xref="Sx5.T1.8.8.1.m1.1.1">25.19</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.8.8.1.m1.1c">25.19</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.9.9" class="ltx_tr">
<th id="Sx5.T1.9.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="Sx5.T1.9.9.2.1" class="ltx_text ltx_font_bold">DMMGR</span> (2-steps)</th>
<td id="Sx5.T1.9.9.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx5.T1.9.9.1.m1.1" class="ltx_Math" alttext="31.4" display="inline"><semantics id="Sx5.T1.9.9.1.m1.1a"><mn id="Sx5.T1.9.9.1.m1.1.1" xref="Sx5.T1.9.9.1.m1.1.1.cmml">31.4</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.9.9.1.m1.1b"><cn type="float" id="Sx5.T1.9.9.1.m1.1.1.cmml" xref="Sx5.T1.9.9.1.m1.1.1">31.4</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.9.9.1.m1.1c">31.4</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T1.10.10" class="ltx_tr">
<th id="Sx5.T1.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="Sx5.T1.10.10.2.1" class="ltx_text ltx_font_bold">DMMGR + Dense Captioning (2-steps)</span></th>
<td id="Sx5.T1.10.10.1" class="ltx_td ltx_align_center ltx_border_b"><math id="Sx5.T1.10.10.1.m1.1" class="ltx_Math" alttext="31.8" display="inline"><semantics id="Sx5.T1.10.10.1.m1.1a"><mn id="Sx5.T1.10.10.1.m1.1.1" xref="Sx5.T1.10.10.1.m1.1.1.cmml">31.8</mn><annotation-xml encoding="MathML-Content" id="Sx5.T1.10.10.1.m1.1b"><cn type="float" id="Sx5.T1.10.10.1.m1.1.1.cmml" xref="Sx5.T1.10.10.1.m1.1.1">31.8</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T1.10.10.1.m1.1c">31.8</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Top-1 accuracy comparisons among different models on the KRVQR dataset.</figcaption>
</figure>
<figure id="Sx5.T2" class="ltx_table">
<table id="Sx5.T2.17" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx5.T2.17.18.1" class="ltx_tr">
<th id="Sx5.T2.17.18.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="Sx5.T2.17.18.1.1.1" class="ltx_text">Model</span></th>
<td id="Sx5.T2.17.18.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Accuracy</td>
</tr>
<tr id="Sx5.T2.17.19.2" class="ltx_tr">
<td id="Sx5.T2.17.19.2.1" class="ltx_td ltx_align_center">top-1</td>
<td id="Sx5.T2.17.19.2.2" class="ltx_td ltx_align_center">top-3</td>
</tr>
<tr id="Sx5.T2.1.1" class="ltx_tr">
<th id="Sx5.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FVQA (Ensemble) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>
</th>
<td id="Sx5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx5.T2.1.1.1.m1.1" class="ltx_Math" alttext="58.76" display="inline"><semantics id="Sx5.T2.1.1.1.m1.1a"><mn id="Sx5.T2.1.1.1.m1.1.1" xref="Sx5.T2.1.1.1.m1.1.1.cmml">58.76</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.1.1.1.m1.1b"><cn type="float" id="Sx5.T2.1.1.1.m1.1.1.cmml" xref="Sx5.T2.1.1.1.m1.1.1">58.76</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.1.1.1.m1.1c">58.76</annotation></semantics></math></td>
<td id="Sx5.T2.1.1.3" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="Sx5.T2.4.4" class="ltx_tr">
<th id="Sx5.T2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="Sx5.T2.2.2.1.m1.1" class="ltx_Math" alttext="STTF^{1}" display="inline"><semantics id="Sx5.T2.2.2.1.m1.1a"><mrow id="Sx5.T2.2.2.1.m1.1.1" xref="Sx5.T2.2.2.1.m1.1.1.cmml"><mi id="Sx5.T2.2.2.1.m1.1.1.2" xref="Sx5.T2.2.2.1.m1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx5.T2.2.2.1.m1.1.1.1" xref="Sx5.T2.2.2.1.m1.1.1.1.cmml">​</mo><mi id="Sx5.T2.2.2.1.m1.1.1.3" xref="Sx5.T2.2.2.1.m1.1.1.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="Sx5.T2.2.2.1.m1.1.1.1a" xref="Sx5.T2.2.2.1.m1.1.1.1.cmml">​</mo><mi id="Sx5.T2.2.2.1.m1.1.1.4" xref="Sx5.T2.2.2.1.m1.1.1.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="Sx5.T2.2.2.1.m1.1.1.1b" xref="Sx5.T2.2.2.1.m1.1.1.1.cmml">​</mo><msup id="Sx5.T2.2.2.1.m1.1.1.5" xref="Sx5.T2.2.2.1.m1.1.1.5.cmml"><mi id="Sx5.T2.2.2.1.m1.1.1.5.2" xref="Sx5.T2.2.2.1.m1.1.1.5.2.cmml">F</mi><mn id="Sx5.T2.2.2.1.m1.1.1.5.3" xref="Sx5.T2.2.2.1.m1.1.1.5.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx5.T2.2.2.1.m1.1b"><apply id="Sx5.T2.2.2.1.m1.1.1.cmml" xref="Sx5.T2.2.2.1.m1.1.1"><times id="Sx5.T2.2.2.1.m1.1.1.1.cmml" xref="Sx5.T2.2.2.1.m1.1.1.1"></times><ci id="Sx5.T2.2.2.1.m1.1.1.2.cmml" xref="Sx5.T2.2.2.1.m1.1.1.2">𝑆</ci><ci id="Sx5.T2.2.2.1.m1.1.1.3.cmml" xref="Sx5.T2.2.2.1.m1.1.1.3">𝑇</ci><ci id="Sx5.T2.2.2.1.m1.1.1.4.cmml" xref="Sx5.T2.2.2.1.m1.1.1.4">𝑇</ci><apply id="Sx5.T2.2.2.1.m1.1.1.5.cmml" xref="Sx5.T2.2.2.1.m1.1.1.5"><csymbol cd="ambiguous" id="Sx5.T2.2.2.1.m1.1.1.5.1.cmml" xref="Sx5.T2.2.2.1.m1.1.1.5">superscript</csymbol><ci id="Sx5.T2.2.2.1.m1.1.1.5.2.cmml" xref="Sx5.T2.2.2.1.m1.1.1.5.2">𝐹</ci><cn type="integer" id="Sx5.T2.2.2.1.m1.1.1.5.3.cmml" xref="Sx5.T2.2.2.1.m1.1.1.5.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.2.2.1.m1.1c">STTF^{1}</annotation></semantics></math></th>
<td id="Sx5.T2.3.3.2" class="ltx_td ltx_align_center"><math id="Sx5.T2.3.3.2.m1.1" class="ltx_Math" alttext="62.20" display="inline"><semantics id="Sx5.T2.3.3.2.m1.1a"><mn id="Sx5.T2.3.3.2.m1.1.1" xref="Sx5.T2.3.3.2.m1.1.1.cmml">62.20</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.3.3.2.m1.1b"><cn type="float" id="Sx5.T2.3.3.2.m1.1.1.cmml" xref="Sx5.T2.3.3.2.m1.1.1">62.20</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.3.3.2.m1.1c">62.20</annotation></semantics></math></td>
<td id="Sx5.T2.4.4.3" class="ltx_td ltx_align_center"><math id="Sx5.T2.4.4.3.m1.1" class="ltx_Math" alttext="75.60" display="inline"><semantics id="Sx5.T2.4.4.3.m1.1a"><mn id="Sx5.T2.4.4.3.m1.1.1" xref="Sx5.T2.4.4.3.m1.1.1.cmml">75.60</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.4.4.3.m1.1b"><cn type="float" id="Sx5.T2.4.4.3.m1.1.1.cmml" xref="Sx5.T2.4.4.3.m1.1.1">75.60</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.4.4.3.m1.1c">75.60</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.7.7" class="ltx_tr">
<th id="Sx5.T2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><math id="Sx5.T2.5.5.1.m1.1" class="ltx_Math" alttext="OB^{2}" display="inline"><semantics id="Sx5.T2.5.5.1.m1.1a"><mrow id="Sx5.T2.5.5.1.m1.1.1" xref="Sx5.T2.5.5.1.m1.1.1.cmml"><mi id="Sx5.T2.5.5.1.m1.1.1.2" xref="Sx5.T2.5.5.1.m1.1.1.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="Sx5.T2.5.5.1.m1.1.1.1" xref="Sx5.T2.5.5.1.m1.1.1.1.cmml">​</mo><msup id="Sx5.T2.5.5.1.m1.1.1.3" xref="Sx5.T2.5.5.1.m1.1.1.3.cmml"><mi id="Sx5.T2.5.5.1.m1.1.1.3.2" xref="Sx5.T2.5.5.1.m1.1.1.3.2.cmml">B</mi><mn id="Sx5.T2.5.5.1.m1.1.1.3.3" xref="Sx5.T2.5.5.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx5.T2.5.5.1.m1.1b"><apply id="Sx5.T2.5.5.1.m1.1.1.cmml" xref="Sx5.T2.5.5.1.m1.1.1"><times id="Sx5.T2.5.5.1.m1.1.1.1.cmml" xref="Sx5.T2.5.5.1.m1.1.1.1"></times><ci id="Sx5.T2.5.5.1.m1.1.1.2.cmml" xref="Sx5.T2.5.5.1.m1.1.1.2">𝑂</ci><apply id="Sx5.T2.5.5.1.m1.1.1.3.cmml" xref="Sx5.T2.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx5.T2.5.5.1.m1.1.1.3.1.cmml" xref="Sx5.T2.5.5.1.m1.1.1.3">superscript</csymbol><ci id="Sx5.T2.5.5.1.m1.1.1.3.2.cmml" xref="Sx5.T2.5.5.1.m1.1.1.3.2">𝐵</ci><cn type="integer" id="Sx5.T2.5.5.1.m1.1.1.3.3.cmml" xref="Sx5.T2.5.5.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.5.5.1.m1.1c">OB^{2}</annotation></semantics></math></th>
<td id="Sx5.T2.6.6.2" class="ltx_td ltx_align_center"><math id="Sx5.T2.6.6.2.m1.1" class="ltx_Math" alttext="69.35" display="inline"><semantics id="Sx5.T2.6.6.2.m1.1a"><mn id="Sx5.T2.6.6.2.m1.1.1" xref="Sx5.T2.6.6.2.m1.1.1.cmml">69.35</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.6.6.2.m1.1b"><cn type="float" id="Sx5.T2.6.6.2.m1.1.1.cmml" xref="Sx5.T2.6.6.2.m1.1.1">69.35</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.6.6.2.m1.1c">69.35</annotation></semantics></math></td>
<td id="Sx5.T2.7.7.3" class="ltx_td ltx_align_center"><math id="Sx5.T2.7.7.3.m1.1" class="ltx_Math" alttext="80.25" display="inline"><semantics id="Sx5.T2.7.7.3.m1.1a"><mn id="Sx5.T2.7.7.3.m1.1.1" xref="Sx5.T2.7.7.3.m1.1.1.cmml">80.25</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.7.7.3.m1.1b"><cn type="float" id="Sx5.T2.7.7.3.m1.1.1.cmml" xref="Sx5.T2.7.7.3.m1.1.1">80.25</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.7.7.3.m1.1c">80.25</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.9.9" class="ltx_tr">
<th id="Sx5.T2.9.9.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Mucko <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="Sx5.T2.8.8.1" class="ltx_td ltx_align_center"><math id="Sx5.T2.8.8.1.m1.1" class="ltx_Math" alttext="73.06" display="inline"><semantics id="Sx5.T2.8.8.1.m1.1a"><mn id="Sx5.T2.8.8.1.m1.1.1" xref="Sx5.T2.8.8.1.m1.1.1.cmml">73.06</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.8.8.1.m1.1b"><cn type="float" id="Sx5.T2.8.8.1.m1.1.1.cmml" xref="Sx5.T2.8.8.1.m1.1.1">73.06</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.8.8.1.m1.1c">73.06</annotation></semantics></math></td>
<td id="Sx5.T2.9.9.2" class="ltx_td ltx_align_center"><math id="Sx5.T2.9.9.2.m1.1" class="ltx_Math" alttext="85.94" display="inline"><semantics id="Sx5.T2.9.9.2.m1.1a"><mn id="Sx5.T2.9.9.2.m1.1.1" xref="Sx5.T2.9.9.2.m1.1.1.cmml">85.94</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.9.9.2.m1.1b"><cn type="float" id="Sx5.T2.9.9.2.m1.1.1.cmml" xref="Sx5.T2.9.9.2.m1.1.1">85.94</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.9.9.2.m1.1c">85.94</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.11.11" class="ltx_tr">
<th id="Sx5.T2.11.11.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">GRUC <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="Sx5.T2.10.10.1" class="ltx_td ltx_align_center"><math id="Sx5.T2.10.10.1.m1.1" class="ltx_Math" alttext="79.63" display="inline"><semantics id="Sx5.T2.10.10.1.m1.1a"><mn id="Sx5.T2.10.10.1.m1.1.1" xref="Sx5.T2.10.10.1.m1.1.1.cmml">79.63</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.10.10.1.m1.1b"><cn type="float" id="Sx5.T2.10.10.1.m1.1.1.cmml" xref="Sx5.T2.10.10.1.m1.1.1">79.63</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.10.10.1.m1.1c">79.63</annotation></semantics></math></td>
<td id="Sx5.T2.11.11.2" class="ltx_td ltx_align_center"><math id="Sx5.T2.11.11.2.m1.1" class="ltx_Math" alttext="91.20" display="inline"><semantics id="Sx5.T2.11.11.2.m1.1a"><mn id="Sx5.T2.11.11.2.m1.1.1" xref="Sx5.T2.11.11.2.m1.1.1.cmml">91.20</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.11.11.2.m1.1b"><cn type="float" id="Sx5.T2.11.11.2.m1.1.1.cmml" xref="Sx5.T2.11.11.2.m1.1.1">91.20</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.11.11.2.m1.1c">91.20</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.13.13" class="ltx_tr">
<th id="Sx5.T2.13.13.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">GRUC (without Semantic graph)</th>
<td id="Sx5.T2.12.12.1" class="ltx_td ltx_align_center"><math id="Sx5.T2.12.12.1.m1.1" class="ltx_Math" alttext="78.05" display="inline"><semantics id="Sx5.T2.12.12.1.m1.1a"><mn id="Sx5.T2.12.12.1.m1.1.1" xref="Sx5.T2.12.12.1.m1.1.1.cmml">78.05</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.12.12.1.m1.1b"><cn type="float" id="Sx5.T2.12.12.1.m1.1.1.cmml" xref="Sx5.T2.12.12.1.m1.1.1">78.05</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.12.12.1.m1.1c">78.05</annotation></semantics></math></td>
<td id="Sx5.T2.13.13.2" class="ltx_td ltx_align_center"><math id="Sx5.T2.13.13.2.m1.1" class="ltx_Math" alttext="87.70" display="inline"><semantics id="Sx5.T2.13.13.2.m1.1a"><mn id="Sx5.T2.13.13.2.m1.1.1" xref="Sx5.T2.13.13.2.m1.1.1.cmml">87.70</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.13.13.2.m1.1b"><cn type="float" id="Sx5.T2.13.13.2.m1.1.1.cmml" xref="Sx5.T2.13.13.2.m1.1.1">87.70</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.13.13.2.m1.1c">87.70</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.15.15" class="ltx_tr">
<th id="Sx5.T2.15.15.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="Sx5.T2.15.15.3.1" class="ltx_text ltx_font_bold">DMMGR (1-step)</span></th>
<td id="Sx5.T2.14.14.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx5.T2.14.14.1.m1.1" class="ltx_Math" alttext="78.6" display="inline"><semantics id="Sx5.T2.14.14.1.m1.1a"><mn id="Sx5.T2.14.14.1.m1.1.1" xref="Sx5.T2.14.14.1.m1.1.1.cmml">78.6</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.14.14.1.m1.1b"><cn type="float" id="Sx5.T2.14.14.1.m1.1.1.cmml" xref="Sx5.T2.14.14.1.m1.1.1">78.6</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.14.14.1.m1.1c">78.6</annotation></semantics></math></td>
<td id="Sx5.T2.15.15.2" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx5.T2.15.15.2.m1.1" class="ltx_Math" alttext="90.6" display="inline"><semantics id="Sx5.T2.15.15.2.m1.1a"><mn id="Sx5.T2.15.15.2.m1.1.1" xref="Sx5.T2.15.15.2.m1.1.1.cmml">90.6</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.15.15.2.m1.1b"><cn type="float" id="Sx5.T2.15.15.2.m1.1.1.cmml" xref="Sx5.T2.15.15.2.m1.1.1">90.6</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.15.15.2.m1.1c">90.6</annotation></semantics></math></td>
</tr>
<tr id="Sx5.T2.17.17" class="ltx_tr">
<th id="Sx5.T2.17.17.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="Sx5.T2.17.17.3.1" class="ltx_text ltx_font_bold">DMMGR + Dense Captioning (1-step)</span></th>
<td id="Sx5.T2.16.16.1" class="ltx_td ltx_align_center ltx_border_b"><math id="Sx5.T2.16.16.1.m1.1" class="ltx_Math" alttext="81.20" display="inline"><semantics id="Sx5.T2.16.16.1.m1.1a"><mn id="Sx5.T2.16.16.1.m1.1.1" xref="Sx5.T2.16.16.1.m1.1.1.cmml">81.20</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.16.16.1.m1.1b"><cn type="float" id="Sx5.T2.16.16.1.m1.1.1.cmml" xref="Sx5.T2.16.16.1.m1.1.1">81.20</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.16.16.1.m1.1c">81.20</annotation></semantics></math></td>
<td id="Sx5.T2.17.17.2" class="ltx_td ltx_align_center ltx_border_b"><math id="Sx5.T2.17.17.2.m1.1" class="ltx_Math" alttext="95.38" display="inline"><semantics id="Sx5.T2.17.17.2.m1.1a"><mn id="Sx5.T2.17.17.2.m1.1.1" xref="Sx5.T2.17.17.2.m1.1.1.cmml">95.38</mn><annotation-xml encoding="MathML-Content" id="Sx5.T2.17.17.2.m1.1b"><cn type="float" id="Sx5.T2.17.17.2.m1.1.1.cmml" xref="Sx5.T2.17.17.2.m1.1.1">95.38</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx5.T2.17.17.2.m1.1c">95.38</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Top-1 and top-3 accuracy of the different models obtained on the FVQA dataset.(1:<cite class="ltx_cite ltx_citemacro_citet">Narasimhan and Schwing (<a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>,2:<cite class="ltx_cite ltx_citemacro_citet">Narasimhan, Lazebnik, and Schwing (<a href="#bib.bib18" title="" class="ltx_ref">2018</a>)</cite>)</figcaption>
</figure>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Ablation Study</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">To verify the effectiveness of each component of our model, we conduct an extensive ablation study of the results obtained on the KRVQR dataset, which is the most challenging dataset (Table 3, 4 and 5). They reveal the impact of the iterative reasoning module, the dynamic key-value memory module and the knowledge-guided graph reasoning.</p>
</div>
<section id="Sx6.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Does the number of reasoning steps matter?</h3>

<div id="Sx6.SSx1.p1" class="ltx_para">
<p id="Sx6.SSx1.p1.3" class="ltx_p">We first verify the contribution of the iterative reasoning module by performing experiments using the DMMGR model with different numbers of reasoning steps. From Table 3, we can observe that the DMMGR model with two reasoning steps has the best performance, which is slightly higher than that of the DMMGR model with only one reasoning step. However, having more than two reasoning steps, such as three and four, dramatically decreases the accuracy by more than <math id="Sx6.SSx1.p1.1.m1.1" class="ltx_Math" alttext="4\%" display="inline"><semantics id="Sx6.SSx1.p1.1.m1.1a"><mrow id="Sx6.SSx1.p1.1.m1.1.1" xref="Sx6.SSx1.p1.1.m1.1.1.cmml"><mn id="Sx6.SSx1.p1.1.m1.1.1.2" xref="Sx6.SSx1.p1.1.m1.1.1.2.cmml">4</mn><mo id="Sx6.SSx1.p1.1.m1.1.1.1" xref="Sx6.SSx1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx6.SSx1.p1.1.m1.1b"><apply id="Sx6.SSx1.p1.1.m1.1.1.cmml" xref="Sx6.SSx1.p1.1.m1.1.1"><csymbol cd="latexml" id="Sx6.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx6.SSx1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="Sx6.SSx1.p1.1.m1.1.1.2.cmml" xref="Sx6.SSx1.p1.1.m1.1.1.2">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx6.SSx1.p1.1.m1.1c">4\%</annotation></semantics></math>. This is not surprising, as the KRVQR dataset only contains one-step reasoning <math id="Sx6.SSx1.p1.2.m2.1" class="ltx_Math" alttext="(43.5\%)" display="inline"><semantics id="Sx6.SSx1.p1.2.m2.1a"><mrow id="Sx6.SSx1.p1.2.m2.1.1.1" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="Sx6.SSx1.p1.2.m2.1.1.1.2" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="Sx6.SSx1.p1.2.m2.1.1.1.1" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.cmml"><mn id="Sx6.SSx1.p1.2.m2.1.1.1.1.2" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.2.cmml">43.5</mn><mo id="Sx6.SSx1.p1.2.m2.1.1.1.1.1" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.1.cmml">%</mo></mrow><mo stretchy="false" id="Sx6.SSx1.p1.2.m2.1.1.1.3" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx6.SSx1.p1.2.m2.1b"><apply id="Sx6.SSx1.p1.2.m2.1.1.1.1.cmml" xref="Sx6.SSx1.p1.2.m2.1.1.1"><csymbol cd="latexml" id="Sx6.SSx1.p1.2.m2.1.1.1.1.1.cmml" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.1">percent</csymbol><cn type="float" id="Sx6.SSx1.p1.2.m2.1.1.1.1.2.cmml" xref="Sx6.SSx1.p1.2.m2.1.1.1.1.2">43.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx6.SSx1.p1.2.m2.1c">(43.5\%)</annotation></semantics></math> and two-step <math id="Sx6.SSx1.p1.3.m3.1" class="ltx_Math" alttext="(56.5\%)" display="inline"><semantics id="Sx6.SSx1.p1.3.m3.1a"><mrow id="Sx6.SSx1.p1.3.m3.1.1.1" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="Sx6.SSx1.p1.3.m3.1.1.1.2" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.cmml">(</mo><mrow id="Sx6.SSx1.p1.3.m3.1.1.1.1" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.cmml"><mn id="Sx6.SSx1.p1.3.m3.1.1.1.1.2" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.2.cmml">56.5</mn><mo id="Sx6.SSx1.p1.3.m3.1.1.1.1.1" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.1.cmml">%</mo></mrow><mo stretchy="false" id="Sx6.SSx1.p1.3.m3.1.1.1.3" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx6.SSx1.p1.3.m3.1b"><apply id="Sx6.SSx1.p1.3.m3.1.1.1.1.cmml" xref="Sx6.SSx1.p1.3.m3.1.1.1"><csymbol cd="latexml" id="Sx6.SSx1.p1.3.m3.1.1.1.1.1.cmml" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.1">percent</csymbol><cn type="float" id="Sx6.SSx1.p1.3.m3.1.1.1.1.2.cmml" xref="Sx6.SSx1.p1.3.m3.1.1.1.1.2">56.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx6.SSx1.p1.3.m3.1c">(56.5\%)</annotation></semantics></math> reasoning questions.</p>
</div>
<figure id="Sx6.T3" class="ltx_table">
<table id="Sx6.T3.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx6.T3.8.9.1" class="ltx_tr">
<th id="Sx6.T3.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Model (DMMGR)</th>
<th id="Sx6.T3.8.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx6.T3.2.2" class="ltx_tr">
<th id="Sx6.T3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<math id="Sx6.T3.1.1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="Sx6.T3.1.1.1.m1.1a"><mn id="Sx6.T3.1.1.1.m1.1.1" xref="Sx6.T3.1.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.1.1.1.m1.1b"><cn type="integer" id="Sx6.T3.1.1.1.m1.1.1.cmml" xref="Sx6.T3.1.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.1.1.1.m1.1c">1</annotation></semantics></math> step</th>
<td id="Sx6.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx6.T3.2.2.2.m1.1" class="ltx_Math" alttext="30.5" display="inline"><semantics id="Sx6.T3.2.2.2.m1.1a"><mn id="Sx6.T3.2.2.2.m1.1.1" xref="Sx6.T3.2.2.2.m1.1.1.cmml">30.5</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.2.2.2.m1.1b"><cn type="float" id="Sx6.T3.2.2.2.m1.1.1.cmml" xref="Sx6.T3.2.2.2.m1.1.1">30.5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.2.2.2.m1.1c">30.5</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T3.4.4" class="ltx_tr">
<th id="Sx6.T3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<math id="Sx6.T3.3.3.1.m1.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Sx6.T3.3.3.1.m1.1a"><mn id="Sx6.T3.3.3.1.m1.1.1" xref="Sx6.T3.3.3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.3.3.1.m1.1b"><cn type="integer" id="Sx6.T3.3.3.1.m1.1.1.cmml" xref="Sx6.T3.3.3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.3.3.1.m1.1c">2</annotation></semantics></math> steps</th>
<td id="Sx6.T3.4.4.2" class="ltx_td ltx_align_center"><math id="Sx6.T3.4.4.2.m1.1" class="ltx_Math" alttext="31.4" display="inline"><semantics id="Sx6.T3.4.4.2.m1.1a"><mn id="Sx6.T3.4.4.2.m1.1.1" xref="Sx6.T3.4.4.2.m1.1.1.cmml">31.4</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.4.4.2.m1.1b"><cn type="float" id="Sx6.T3.4.4.2.m1.1.1.cmml" xref="Sx6.T3.4.4.2.m1.1.1">31.4</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.4.4.2.m1.1c">31.4</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T3.6.6" class="ltx_tr">
<th id="Sx6.T3.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<math id="Sx6.T3.5.5.1.m1.1" class="ltx_Math" alttext="3" display="inline"><semantics id="Sx6.T3.5.5.1.m1.1a"><mn id="Sx6.T3.5.5.1.m1.1.1" xref="Sx6.T3.5.5.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.5.5.1.m1.1b"><cn type="integer" id="Sx6.T3.5.5.1.m1.1.1.cmml" xref="Sx6.T3.5.5.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.5.5.1.m1.1c">3</annotation></semantics></math> steps</th>
<td id="Sx6.T3.6.6.2" class="ltx_td ltx_align_center"><math id="Sx6.T3.6.6.2.m1.1" class="ltx_Math" alttext="27.1" display="inline"><semantics id="Sx6.T3.6.6.2.m1.1a"><mn id="Sx6.T3.6.6.2.m1.1.1" xref="Sx6.T3.6.6.2.m1.1.1.cmml">27.1</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.6.6.2.m1.1b"><cn type="float" id="Sx6.T3.6.6.2.m1.1.1.cmml" xref="Sx6.T3.6.6.2.m1.1.1">27.1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.6.6.2.m1.1c">27.1</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T3.8.8" class="ltx_tr">
<th id="Sx6.T3.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">
<math id="Sx6.T3.7.7.1.m1.1" class="ltx_Math" alttext="4" display="inline"><semantics id="Sx6.T3.7.7.1.m1.1a"><mn id="Sx6.T3.7.7.1.m1.1.1" xref="Sx6.T3.7.7.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.7.7.1.m1.1b"><cn type="integer" id="Sx6.T3.7.7.1.m1.1.1.cmml" xref="Sx6.T3.7.7.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.7.7.1.m1.1c">4</annotation></semantics></math> steps</th>
<td id="Sx6.T3.8.8.2" class="ltx_td ltx_align_center ltx_border_b"><math id="Sx6.T3.8.8.2.m1.1" class="ltx_Math" alttext="26.2" display="inline"><semantics id="Sx6.T3.8.8.2.m1.1a"><mn id="Sx6.T3.8.8.2.m1.1.1" xref="Sx6.T3.8.8.2.m1.1.1.cmml">26.2</mn><annotation-xml encoding="MathML-Content" id="Sx6.T3.8.8.2.m1.1b"><cn type="float" id="Sx6.T3.8.8.2.m1.1.1.cmml" xref="Sx6.T3.8.8.2.m1.1.1">26.2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T3.8.8.2.m1.1c">26.2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results in terms of top-1 accuracy of the DMMGR model obtained on the KRVQR dataset considering different numbers of reasoning steps.</figcaption>
</figure>
<figure id="Sx6.F4" class="ltx_figure"><img src="/html/2203.02985/assets/img/att1.png" id="Sx6.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1017" height="560" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Attention visualization of the DMMGR model. The top and bottom maps are the attention weights of randomly selected samples from the test set that are correctly and incorrectly answered by the model, respectively. Different colors are used to represent the attention weights in the spatial-aware image graph and knowledge memory module, where deeper colors denote higher attention weights.” Answer” represents the true answer and ”Prediction” stands for the output of the model.(More examples can be found in Figure 5)</figcaption>
</figure>
<figure id="Sx6.F5" class="ltx_figure"><img src="/html/2203.02985/assets/img/att2.png" id="Sx6.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="1076" height="1103" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Attention visualization of the DMMGR model. All the samples are randomly selected from the test set of the KRVQR dataset. Different colors are used to represent the attention weights in the spatial-aware image graph and knowledge memory module, where deeper colors denotes higher attention weights.” Answer” represents the true answer and ”Prediction” stands for the output of the model.</figcaption>
</figure>
</section>
<section id="Sx6.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Does the Proposed Key-value Memory Really Help?</h3>

<div id="Sx6.SSx2.p1" class="ltx_para">
<p id="Sx6.SSx2.p1.1" class="ltx_p">We next study the advantage of using a dynamic key-value memory module (Table 4). The experiments are conducted by replacing the memory module of the DMMGR model with different types of memory modules and testing the new models on the KRVQR dataset. The first model in Table 4 integrates a simple memory module where each slot is the average embedding of a knowledge triplet. The second model in Table 4 has the regular key-value memory module whose keys are the representation of subject and relation, and values are the object representation of a knowledge triplet <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite>. The third model is the dynamic key-value memory module proposed in this paper. The results show that the accuracy of our proposed memory model surpasses the other two models by approximately <math id="Sx6.SSx2.p1.1.m1.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="Sx6.SSx2.p1.1.m1.1a"><mrow id="Sx6.SSx2.p1.1.m1.1.1" xref="Sx6.SSx2.p1.1.m1.1.1.cmml"><mn id="Sx6.SSx2.p1.1.m1.1.1.2" xref="Sx6.SSx2.p1.1.m1.1.1.2.cmml">5</mn><mo id="Sx6.SSx2.p1.1.m1.1.1.1" xref="Sx6.SSx2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx6.SSx2.p1.1.m1.1b"><apply id="Sx6.SSx2.p1.1.m1.1.1.cmml" xref="Sx6.SSx2.p1.1.m1.1.1"><csymbol cd="latexml" id="Sx6.SSx2.p1.1.m1.1.1.1.cmml" xref="Sx6.SSx2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="Sx6.SSx2.p1.1.m1.1.1.2.cmml" xref="Sx6.SSx2.p1.1.m1.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx6.SSx2.p1.1.m1.1c">5\%</annotation></semantics></math>, which indicates that the dynamic key-value memory module has a beneficial effect on knowledge triplet reasoning. It is also rational to observe that a simple memory module slightly performs better than the common key-value memory module <cite class="ltx_cite ltx_citemacro_citep">(Miller et al. <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite>, since the latter can only infer the object of a triplet while questions in the KRVQR dataset could be related to the subject or relation of a triplet.</p>
</div>
<figure id="Sx6.T4" class="ltx_table">
<table id="Sx6.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx6.T4.3.4.1" class="ltx_tr">
<th id="Sx6.T4.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Memory model</th>
<th id="Sx6.T4.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Top-1 accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx6.T4.1.1" class="ltx_tr">
<th id="Sx6.T4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Average embedding memory module</th>
<td id="Sx6.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx6.T4.1.1.1.m1.1" class="ltx_Math" alttext="27.3" display="inline"><semantics id="Sx6.T4.1.1.1.m1.1a"><mn id="Sx6.T4.1.1.1.m1.1.1" xref="Sx6.T4.1.1.1.m1.1.1.cmml">27.3</mn><annotation-xml encoding="MathML-Content" id="Sx6.T4.1.1.1.m1.1b"><cn type="float" id="Sx6.T4.1.1.1.m1.1.1.cmml" xref="Sx6.T4.1.1.1.m1.1.1">27.3</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T4.1.1.1.m1.1c">27.3</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T4.2.2" class="ltx_tr">
<th id="Sx6.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Key-value memory module</th>
<td id="Sx6.T4.2.2.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx6.T4.2.2.1.m1.1" class="ltx_Math" alttext="26.5" display="inline"><semantics id="Sx6.T4.2.2.1.m1.1a"><mn id="Sx6.T4.2.2.1.m1.1.1" xref="Sx6.T4.2.2.1.m1.1.1.cmml">26.5</mn><annotation-xml encoding="MathML-Content" id="Sx6.T4.2.2.1.m1.1b"><cn type="float" id="Sx6.T4.2.2.1.m1.1.1.cmml" xref="Sx6.T4.2.2.1.m1.1.1">26.5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T4.2.2.1.m1.1c">26.5</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T4.3.3" class="ltx_tr">
<th id="Sx6.T4.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Proposed memory model</th>
<td id="Sx6.T4.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><math id="Sx6.T4.3.3.1.m1.1" class="ltx_Math" alttext="31.4" display="inline"><semantics id="Sx6.T4.3.3.1.m1.1a"><mn id="Sx6.T4.3.3.1.m1.1.1" xref="Sx6.T4.3.3.1.m1.1.1.cmml">31.4</mn><annotation-xml encoding="MathML-Content" id="Sx6.T4.3.3.1.m1.1b"><cn type="float" id="Sx6.T4.3.3.1.m1.1.1.cmml" xref="Sx6.T4.3.3.1.m1.1.1">31.4</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T4.3.3.1.m1.1c">31.4</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results in terms of top-1 accuracy of the DMMGR model obtained on the KRVQR dataset considering
different types of memory modules.
</figcaption>
</figure>
</section>
<section id="Sx6.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Can External Knowledge Help the Model to Understand the Image Better?</h3>

<div id="Sx6.SSx3.p1" class="ltx_para">
<p id="Sx6.SSx3.p1.1" class="ltx_p">Finally, we explore whether the retrieved knowledge triplets can help the model to better understand the image. In Table 5, we compare the performance of the models with and without the use of the knowledge triplets in the reasoning module operating on the spatial-aware image graph. One can observe that the accuracy decreases by approximately <math id="Sx6.SSx3.p1.1.m1.1" class="ltx_Math" alttext="2\%" display="inline"><semantics id="Sx6.SSx3.p1.1.m1.1a"><mrow id="Sx6.SSx3.p1.1.m1.1.1" xref="Sx6.SSx3.p1.1.m1.1.1.cmml"><mn id="Sx6.SSx3.p1.1.m1.1.1.2" xref="Sx6.SSx3.p1.1.m1.1.1.2.cmml">2</mn><mo id="Sx6.SSx3.p1.1.m1.1.1.1" xref="Sx6.SSx3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx6.SSx3.p1.1.m1.1b"><apply id="Sx6.SSx3.p1.1.m1.1.1.cmml" xref="Sx6.SSx3.p1.1.m1.1.1"><csymbol cd="latexml" id="Sx6.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx6.SSx3.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="Sx6.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx6.SSx3.p1.1.m1.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx6.SSx3.p1.1.m1.1c">2\%</annotation></semantics></math> when the reasoning module has no access to the knowledge triplets, which supports our proposed knowledge-guided image graph reasoning module.</p>
</div>
<figure id="Sx6.T5" class="ltx_table">
<table id="Sx6.T5.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx6.T5.2.3.1" class="ltx_tr">
<th id="Sx6.T5.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Model (DMMGR)</th>
<th id="Sx6.T5.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx6.T5.1.1" class="ltx_tr">
<th id="Sx6.T5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">w/o knowledge-guided reasoning</th>
<td id="Sx6.T5.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="Sx6.T5.1.1.1.m1.1" class="ltx_Math" alttext="29.9" display="inline"><semantics id="Sx6.T5.1.1.1.m1.1a"><mn id="Sx6.T5.1.1.1.m1.1.1" xref="Sx6.T5.1.1.1.m1.1.1.cmml">29.9</mn><annotation-xml encoding="MathML-Content" id="Sx6.T5.1.1.1.m1.1b"><cn type="float" id="Sx6.T5.1.1.1.m1.1.1.cmml" xref="Sx6.T5.1.1.1.m1.1.1">29.9</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T5.1.1.1.m1.1c">29.9</annotation></semantics></math></td>
</tr>
<tr id="Sx6.T5.2.2" class="ltx_tr">
<th id="Sx6.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">full model</th>
<td id="Sx6.T5.2.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><math id="Sx6.T5.2.2.1.m1.1" class="ltx_Math" alttext="31.4" display="inline"><semantics id="Sx6.T5.2.2.1.m1.1a"><mn id="Sx6.T5.2.2.1.m1.1.1" xref="Sx6.T5.2.2.1.m1.1.1.cmml">31.4</mn><annotation-xml encoding="MathML-Content" id="Sx6.T5.2.2.1.m1.1b"><cn type="float" id="Sx6.T5.2.2.1.m1.1.1.cmml" xref="Sx6.T5.2.2.1.m1.1.1">31.4</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx6.T5.2.2.1.m1.1c">31.4</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>The accuracy values obtained with and without the us of the knowledge triplets in the image graph reasoning module obtained on the KRVQR dataset.</figcaption>
</figure>
</section>
</section>
<section id="Sx7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Qualitative Analysis</h2>

<div id="Sx7.p1" class="ltx_para">
<p id="Sx7.p1.1" class="ltx_p">To further study the working mechanism of the DMMGR model, we randomly select two samples from the test set that are correctly answered by our model, and present the corresponding attention weights on top of Figure 4 (more examples are found in Figure 5).
Note, that to obtain a clear visualization map, we plot only the attention weights of some highly relevant knowledge triplets and objects in the image. The attention weights show that DMMGR not only correctly selects the most relevant knowledge triplets and addresses the correct elements, but also focuses on the related objects in the image. The bottom attention weight maps of Figure 4 are examples where the DMMGR model fails. We observe that DMMGR here fails when there is ambiguity present in the image. For example, there are more than two persons in the scene, although the model could find the most relevant information from the knowledge base, it focuses on the wrong person, which leads to an incorrect answer. Improving the model’s ability of handling such confusion could be an interesting future work.</p>
</div>
</section>
<section id="Sx8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx8.p1" class="ltx_para">
<p id="Sx8.p1.1" class="ltx_p">We have proposed a multi-step graph reasoning model that is enhanced by a novel dynamic memory, which iteratively performs explicit and implicit reasoning over a key-value triplet memory and a spatial-aware image graph, respectively, to infer the answer in a KVQA task. Our model achieves new state-of-the-art performance on both the KRVQR and FVQA datasets.</p>
</div>
</section>
<section id="Sx9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx9.p1" class="ltx_para">
<p id="Sx9.p1.1" class="ltx_p">This research received funding from the Flanders AI Impuls Programme - FLAIR and from the European Research Council Advanced Grant 788506.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2018)</span>
<span class="ltx_bibblock">
Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and
Zhang, L. 2018.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 6077–6086.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2016)</span>
<span class="ltx_bibblock">
Andreas, J.; Rohrbach, M.; Darrell, T.; and Klein, D. 2016.

</span>
<span class="ltx_bibblock">Neural module networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 39–48.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol et al. (2015)</span>
<span class="ltx_bibblock">
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Zitnick, C. L.; and
Parikh, D. 2015.

</span>
<span class="ltx_bibblock">VQA: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</em>, 2425–2433.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Auer et al. (2007)</span>
<span class="ltx_bibblock">
Auer, S.; Bizer, C.; Kobilarov, G.; Lehmann, J.; Cyganiak, R.; and Ives, Z.
2007.

</span>
<span class="ltx_bibblock">DBpedia: A nucleus for a web of open data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">The Semantic Web</em>, 722–735. Springer.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ben-younes et al. (2017)</span>
<span class="ltx_bibblock">
Ben-younes, H.; Cadene, R.; Cord, M.; and Thome, N. 2017.

</span>
<span class="ltx_bibblock">MUTAN: Multimodal tucker fusion for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2019)</span>
<span class="ltx_bibblock">
Cao, Q.; Li, B.; Liang, X.; and Lin, L. 2019.

</span>
<span class="ltx_bibblock">Explainable high-order visual question reasoning: A new benchmark and
knowledge-routed network.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.10128</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2021)</span>
<span class="ltx_bibblock">
Cao, Q.; Li, B.; Liang, X.; Wang, K.; and Lin, L. 2021.

</span>
<span class="ltx_bibblock">Knowledge-routed visual question reasoning: Challenges for deep
representation embedding.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fukui et al. (2016)</span>
<span class="ltx_bibblock">
Fukui, A.; Park, D. H.; Yang, D.; Rohrbach, A.; Darrell, T.; and Rohrbach, M.
2016.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.01847</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2019)</span>
<span class="ltx_bibblock">
Gu, J.; Zhao, H.; Lin, Z.; Li, S.; Cai, J.; and Ling, M. 2019.

</span>
<span class="ltx_bibblock">Scene graph generation with external knowledge and image
reconstruction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 1969–1978.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2019)</span>
<span class="ltx_bibblock">
Hu, R.; Rohrbach, A.; Darrell, T.; and Saenko, K. 2019.

</span>
<span class="ltx_bibblock">Language-conditioned graph networks for relational reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</em>, 10294–10303.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019)</span>
<span class="ltx_bibblock">
Hudson, D. A.; and Manning, C. D. 2019.

</span>
<span class="ltx_bibblock">GQA: a new dataset for compositional question answering over
real-world images.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1902.09506</em>, 3(8).

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jain et al. (2021)</span>
<span class="ltx_bibblock">
Jain, A.; Kothyari, M.; Kumar, V.; Jyothi, P.; Ramakrishnan, G.; and
Chakrabarti, S. 2021.

</span>
<span class="ltx_bibblock">Select, substitute, search: A new benchmark for knowledge-augmented
visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 44th International ACM SIGIR Conference on
Research and Development in Information Retrieval</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P.; and Ba, J. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2016)</span>
<span class="ltx_bibblock">
Lu, J.; Yang, J.; Batra, D.; and Parikh, D. 2016.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 29:
289–297.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma, Lu, and Li (2016)</span>
<span class="ltx_bibblock">
Ma, L.; Lu, Z.; and Li, H. 2016.

</span>
<span class="ltx_bibblock">Learning to answer questions from image using convolutional neural
network.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirtieth AAAI Conference on Artificial
Intelligence</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marino et al. (2019)</span>
<span class="ltx_bibblock">
Marino, K.; Rastegari, M.; Farhadi, A.; and Mottaghi, R. 2019.

</span>
<span class="ltx_bibblock">OK-VQA: A visual question answering benchmark requiring external
knowledge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 3195–3204.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miller et al. (2016)</span>
<span class="ltx_bibblock">
Miller, A.; Fisch, A.; Dodge, J.; Karimi, A.-H.; Bordes, A.; and Weston, J.
2016.

</span>
<span class="ltx_bibblock">Key-value memory networks for directly reading documents.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.03126</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narasimhan, Lazebnik, and Schwing (2018)</span>
<span class="ltx_bibblock">
Narasimhan, M.; Lazebnik, S.; and Schwing, A. G. 2018.

</span>
<span class="ltx_bibblock">Out of the box: Reasoning with graph convolution nets for factual
visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.00538</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narasimhan and Schwing (2018)</span>
<span class="ltx_bibblock">
Narasimhan, M.; and Schwing, A. G. 2018.

</span>
<span class="ltx_bibblock">Straight to the facts: Learning knowledge base retrieval for factual
visual question answering.

</span>
<span class="ltx_bibblock">451–468.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Norcliffe-Brown, Vafeias, and Parisot (2018)</span>
<span class="ltx_bibblock">
Norcliffe-Brown, W.; Vafeias, E.; and Parisot, S. 2018.

</span>
<span class="ltx_bibblock">Learning conditioned graph structures for interpretable visual
question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.07243</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Paszke, A.; Gross, S.; Massa, F.; Lerer, A.; Bradbury, J.; Chanan, G.; Killeen,
T.; Lin, Z.; Gimelshein, N.; Antiga, L.; et al. 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32:
8026–8037.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington, Socher, and Manning (2014)</span>
<span class="ltx_bibblock">
Pennington, J.; Socher, R.; and Manning, C. D. 2014.

</span>
<span class="ltx_bibblock">GloVe: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2014 Conference on Empirical Methods in
Natural Language Processing (EMNLP)</em>, 1532–1543.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez et al. (2018)</span>
<span class="ltx_bibblock">
Perez, E.; Strub, F.; De Vries, H.; Dumoulin, V.; and Courville, A. 2018.

</span>
<span class="ltx_bibblock">Film: Visual reasoning with a general conditioning layer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 32.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2020)</span>
<span class="ltx_bibblock">
Qi, P.; Zhang, Y.; Zhang, Y.; Bolton, J.; and Manning, C. D. 2020.

</span>
<span class="ltx_bibblock">Stanza: A Python natural language processing toolkit for many human
languages.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics: System Demonstrations</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2015)</span>
<span class="ltx_bibblock">
Ren, S.; He, K.; Girshick, R.; and Sun, J. 2015.

</span>
<span class="ltx_bibblock">Faster R-CNN: Towards real-time object detection with region
proposal networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 28: 91–99.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Speer, Chin, and Havasi (2017)</span>
<span class="ltx_bibblock">
Speer, R.; Chin, J.; and Havasi, C. 2017.

</span>
<span class="ltx_bibblock">Conceptnet 5.5: An open multilingual graph of general knowledge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirty-first AAAI Conference on
Artificial Intelligence</em>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et al. (2015)</span>
<span class="ltx_bibblock">
Sukhbaatar, S.; Szlam, A.; Weston, J.; and Fergus, R. 2015.

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.08895</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tandon et al. (2014)</span>
<span class="ltx_bibblock">
Tandon, N.; De Melo, G.; Suchanek, F.; and Weikum, G. 2014.

</span>
<span class="ltx_bibblock">Webchild: Harvesting and organizing commonsense knowledge from the
Web.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 7th ACM International Conference on Web
Search and Data Mining</em>, 523–532.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney, Liu, and van den Hengel (2017)</span>
<span class="ltx_bibblock">
Teney, D.; Liu, L.; and van den Hengel, A. 2017.

</span>
<span class="ltx_bibblock">Graph-structured representations for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 1–9.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković et al. (2017)</span>
<span class="ltx_bibblock">
Veličković, P.; Cucurull, G.; Casanova, A.; Romero, A.; Liò, P.; and Bengio,
Y. 2017.

</span>
<span class="ltx_bibblock">Graph attention networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">6th International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, P.; Wu, Q.; Cao, J.; Shen, C.; Gao, L.; and van den Hengel, A. 2019.

</span>
<span class="ltx_bibblock">Neighbourhood watch: Referring expression comprehension via
language-guided graph attention networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 1960–1968.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2017)</span>
<span class="ltx_bibblock">
Wang, P.; Wu, Q.; Shen, C.; Dick, A.; and van den Hengel, A. 2017.

</span>
<span class="ltx_bibblock">FVQA: Fact-based visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine
Intelligence</em>, 40(10): 2413–2427.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weston, Chopra, and Bordes (2014)</span>
<span class="ltx_bibblock">
Weston, J.; Chopra, S.; and Bordes, A. 2014.

</span>
<span class="ltx_bibblock">Memory networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1410.3916</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Xu, K.; Lai, Y.; Feng, Y.; and Wang, Z. 2019.

</span>
<span class="ltx_bibblock">Enhancing key-value memory neural networks for knowledge based
question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, 2937–2947.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2016)</span>
<span class="ltx_bibblock">
Yang, Z.; He, X.; Gao, J.; Deng, L.; and Smola, A. 2016.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</em>, 21–29.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2020)</span>
<span class="ltx_bibblock">
Yu, J.; Zhu, Z.; Wang, Y.; Zhang, W.; Hu, Y.; and Tan, J. 2020.

</span>
<span class="ltx_bibblock">Cross-modal knowledge reasoning for knowledge-based visual question
answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>, 108: 107563.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Cui, Y.; Tao, D.; and Tian, Q. 2019.

</span>
<span class="ltx_bibblock">Deep modular co-attention networks for visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, 6281–6290.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2018)</span>
<span class="ltx_bibblock">
Yu, Z.; Yu, J.; Xiang, C.; Fan, J.; and Tao, D. 2018.

</span>
<span class="ltx_bibblock">Beyond bilinear: Generalized multimodal factorized high-order pooling
for visual question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
29(12): 5947–5959.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zareian, Karaman, and Chang (2020)</span>
<span class="ltx_bibblock">
Zareian, A.; Karaman, S.; and Chang, S.-F. 2020.

</span>
<span class="ltx_bibblock">Bridging knowledge graphs to generate scene graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision</em>,
606–623. Springer.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2020)</span>
<span class="ltx_bibblock">
Zhu, Z.; Yu, J.; Wang, Y.; Sun, Y.; Hu, Y.; and Wu, Q. 2020.

</span>
<span class="ltx_bibblock">Mucko: Multi-Layer Cross-Modal Knowledge Reasoning for Fact-based
Visual Question Answering.

</span>
<span class="ltx_bibblock">In Bessiere, C., ed., <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twenty-Ninth
International Joint Conference on Artificial Intelligence, IJCAI-20</em>,
1097–1103. International Joint Conferences on Artificial Intelligence
Organization.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziaeefard and Lécué (2020)</span>
<span class="ltx_bibblock">
Ziaeefard, M.; and Lécué, F. 2020.

</span>
<span class="ltx_bibblock">Towards knowledge-augmented visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th International Conference on
Computational Linguistics</em>, 1863–1873.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2203.02984" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2203.02985" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2203.02985">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2203.02985" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2203.02986" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 04:28:57 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
