<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models</title>
<!--Generated on Wed Sep 25 06:51:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Digital Forensics,  Incident Response,  DFIR,  Timeline Analysis,  Cyber Incident,  Generative AI,  LLM,  Rule-Based AI,  RAG Agent,  Cybersecurity.
" lang="en" name="keywords"/>
<base href="/html/2409.02572v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S1" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S1.SS1" title="In I Introduction ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">I-A</span> </span><span class="ltx_text ltx_font_italic">Contribution and Novelty</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S1.SS2" title="In I Introduction ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">I-B</span> </span><span class="ltx_text ltx_font_italic">Research Question</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Background</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Literature Review and Related Works</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.SS1" title="In III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Timeline Analysis</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.SS2" title="In III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Large Language Models for Cybersecurity and Digital Forensics tasks</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.SS3" title="In III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">The use of Retrieval-Augmented Generation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">GenDFIR Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS1" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Forensics Data Pre-processing</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS2" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Rule-Based AI for Anomaly Detection</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS3" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Incident Events Chunking</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS4" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">Incident Events Embedding</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS5" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span> </span><span class="ltx_text ltx_font_italic">DFIR Retrieval-Augmented Generation (RAG) Agent</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.SS6" title="In IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-F</span> </span><span class="ltx_text ltx_font_italic">LLMs for an efficient Timeline Analysis (TA)</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">GenDFIR Implementation</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS1" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Variability in DFIR Practices and GenDFIR</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS2" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Large Language Models in GenDFIR</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS3" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span> </span><span class="ltx_text ltx_font_italic">Multimodal Approach in GenDFIR</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS4" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-D</span> </span><span class="ltx_text ltx_font_italic">Data in GenDFIR</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS5" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-E</span> </span><span class="ltx_text ltx_font_italic">Experiment Environment</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.SS6" title="In V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-F</span> </span><span class="ltx_text ltx_font_italic">Case Study</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Results Evaluation and Discussion</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS1" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-A</span> </span><span class="ltx_text ltx_font_italic">Accuracy</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS2" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-B</span> </span><span class="ltx_text ltx_font_italic">Relevance</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS3" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-C</span> </span><span class="ltx_text ltx_font_italic">Exact Match (EM)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS4" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-D</span> </span><span class="ltx_text ltx_font_italic">Evidence (Top K)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS5" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-E</span> </span><span class="ltx_text ltx_font_italic">Overall Performance</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.SS6" title="In VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-F</span> </span><span class="ltx_text ltx_font_italic">Discussion</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S7" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span><span class="ltx_text ltx_font_smallcaps">Limitations and Ethical Issues</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S7.SS1" title="In VII Limitations and Ethical Issues ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VII-A</span> </span><span class="ltx_text ltx_font_italic">GenDFIR Limitations</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S7.SS2" title="In VII Limitations and Ethical Issues ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VII-B</span> </span><span class="ltx_text ltx_font_italic">Ethical Issues</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S8" title="In Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VIII </span><span class="ltx_text ltx_font_smallcaps">Conclusion and Future Works</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fatma Yasmine LOUMACHI and Mohamed Chahine GHANEM
</span><span class="ltx_author_notes">* Mohamed Chahine Ghanem is the corresponding author.F. Y. Loumachi is with Cyber Security Research Centre, London Metropolitan University, London, UK e-mail:fal0167@my.londonmet.ac.ukM. C. Ghanem is with the Department of Computer Science, University of Liverpool and Cyber Security Research Centre, London Metropolitan University, UK e-mail: mcghanem@liverpool.ac.uk</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">Timeline Analysis (TA) plays a crucial role in Timeline Forensics (TF) within the field of Digital Forensics (DF). It focuses on examining and analyzing time-based digital artifacts, such as timestamps derived from event logs, file metadata, and other relevant data, to correlate events linked to cyber incidents and reconstruct their chronological sequence. Traditional tools often struggle to efficiently handle the large volume and variety of data generated during DF investigations and Incident Response (IR) processes. This paper introduces a novel framework, GenDFIR, which combines Rule-Based Artificial Intelligence (R-BAI) algorithms with Large Language Models (LLMs) to enhance and automate the TA process. The proposed approach consists of two key stages: (1) R-BAI is used to identify and select anomalous digital artifacts based on predefined rules. (2) The selected artifacts are then transformed into embeddings for processing by an LLM with the assistance of a Retrieval-Augmented Generation (RAG) agent. The LLM uses its capabilities to perform automated TA on the artifacts and predict potential incident outcomes. To validate the framework, we evaluated its performance, efficiency, and reliability. Several metrics were applied to simulated cyber incident scenarios, which were presented as forensic case documents. Our findings demonstrate the significant potential of integrating R-BAI and LLMs for TA. This innovative approach underscores the power of Generative AI (GenAI), particularly LLMs, and opens up new possibilities for advanced threat detection and incident reconstruction, marking a significant advancement in the field.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Digital Forensics, Incident Response, DFIR, Timeline Analysis, Cyber Incident, Generative AI, LLM, Rule-Based AI, RAG Agent, Cybersecurity.

</div>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">Advancing Cyber Incident Timeline Analysis
Through Rule-Based AI and Large Language
Models</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, there has been a significant increase in cyber incidents due to exposed vulnerabilities, impacting a wide range of digital devices, including computers, IoT devices, network hardware (such as routers, switches, and IDS), and embedded systems. Data and artefacts resulting from these incidents are consistently considered and identified as evidence during the Digital Forensics (DF) investigation process <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib1" title="">1</a>]</cite>.
Digital Forensics (DF), including Threat Forensics (TF), is crucial for uncovering evidence and reconstructing the sequence of events <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib2" title="">2</a>]</cite>. DF works closely with the Incident Response (IR) process, serving as a primary defense mechanism. Following a cyber incident, IR teams act immediately to identify, detect, and contain the threat. Subsequently, DF analysts and experts are tasked with collecting data and digital artefacts from the incident for in-depth investigations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib3" title="">3</a>]</cite>. However, the large volume and variety of data present significant challenges during Timeline Analysis (TA), necessitating rapid automated solutions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib4" title="">4</a>]</cite>. Unfortunately, few tools can perform this task accurately, promptly, and effectively.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In response to this need, integrating Artificial Intelligence (AI) into the DF process, particularly into TA, has become essential. AI represents a significant advancement in the field, offering new tools and methodologies for investigation and analysis
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib5" title="">5</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib6" title="">6</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib7" title="">7</a>]</cite> .</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The AI landscape is broad and diverse, with each branch suited to specific tasks. For greater precision in DFIR, particularly within this research’s scope, Generative AI (GenAI) Large Language Models (LLMs) and Rule-Based AI (R-BAI) algorithms are considered optimal due to their unique characteristics and functionalities.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">LLMs surpass mere human-like creativity, playing a transformative role across various domains by enhancing productivity and automating complex tasks traditionally requiring human ingenuity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib8" title="">8</a>]</cite>. Multimodal LLMs, which can process diverse data types such as images, audio files, and documents, are particularly noteworthy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib9" title="">9</a>]</cite>. Both multimodal and single-modal LLMs are applicable to tasks such as sentiment analysis, predictive text generation, pattern recognition, and natural language understanding and generation. While LLMs excel in semantic understanding, they lack true memory and genuine comprehension <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib10" title="">10</a>]</cite>. To address these limitations, techniques like Retrieval-Augmented Generation (RAG) are employed to enhance context and performance by indexing external knowledge <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In contrast, R-BAI algorithms are simpler and utilize straightforward if-then statements, making them suitable for rule-based tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib12" title="">12</a>]</cite>. Given the substantial data volume during DF data acquisition, R-BAI algorithms are effective for filtering and reducing data to manageable amounts. By applying predefined rules set by field professionals, we can focus on collecting only relevant digital artefacts and data.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Combining these two AI technologies and techniques for TF analysis presents promising opportunities to improve the efficiency, accuracy, depth, and speed of digital investigations. However, it is crucial to ensure responsible deployment and address ethical considerations, including potential biases, privacy concerns, and the limitations inherent in AI-powered forensic practices <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib13" title="">13</a>]</cite>.</p>
</div>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S1.SS1.5.1.1">I-A</span> </span><span class="ltx_text ltx_font_italic" id="S1.SS1.6.2">Contribution and Novelty</span>
</h3>
<div class="ltx_para" id="S1.SS1.p1">
<p class="ltx_p" id="S1.SS1.p1.1">This research presents an innovative approach to the DFIR process by directly integrating R-BAI and LLMs for TA. The objective is to bridge the gap between theoretical methods and practical applications.</p>
</div>
<div class="ltx_para" id="S1.SS1.p2">
<p class="ltx_p" id="S1.SS1.p2.1">Our key contributions include:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Utilizing R-BAI to filter and reduce the volume of collected data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Leveraging pre-trained LLMs with a Retrieval-Augmented Generation (RAG) agent for context-based query handling and question answering. While RAG agents with LLMs are an existing technology, our innovation lies in tailoring this solution to advance TA.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Prompting the LLM to perform automated TA, correlate events, and generate a narrative forensic TA report to provide insights into the incident, including additional information and details such as mitigation solutions.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.SS1.p3">
<p class="ltx_p" id="S1.SS1.p3.1">This practical approach can be adopted and further developed by forensic professionals, enabling faster and more accurate responses to cyber incidents. Additionally, its impact has the potential to extend beyond academia, influencing digital security practices and benefiting various stakeholders, such as law enforcement agencies, cybersecurity firms, and other organizations involved in DFIR. Ultimately, this work aims to contribute to a more secure digital environment.</p>
</div>
</section>
<section class="ltx_subsection" id="S1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S1.SS2.5.1.1">I-B</span> </span><span class="ltx_text ltx_font_italic" id="S1.SS2.6.2">Research Question</span>
</h3>
<div class="ltx_para" id="S1.SS2.p1">
<p class="ltx_p" id="S1.SS2.p1.1">This paper introduces the use of two AI solutions to advance TA. Our study is guided by the following main question:</p>
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">How can we build a system that is both efficient and relevant, where R-BAI and LLM are integrated to work together?</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.SS2.p2">
<p class="ltx_p" id="S1.SS2.p2.1">However, sub-questions can stem from the previous question:</p>
<ul class="ltx_itemize" id="S1.I3">
<li class="ltx_item" id="S1.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i1.p1">
<p class="ltx_p" id="S1.I3.i1.p1.1">What is the deep significance of forensic TA, and which specific aspects within it need automation?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i2.p1">
<p class="ltx_p" id="S1.I3.i2.p1.1">What are the strengths and limitations of R-BAI?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i3.p1">
<p class="ltx_p" id="S1.I3.i3.p1.1">How will LLMs collaborate with R-BAI?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i4.p1">
<p class="ltx_p" id="S1.I3.i4.p1.1">How can LLMs effectively handle the concept of multimodality in forensic TA?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i5.p1">
<p class="ltx_p" id="S1.I3.i5.p1.1">What are the limitations of LLMs, and how can these be addressed?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i6.p1">
<p class="ltx_p" id="S1.I3.i6.p1.1">How can we effectively evaluate GenDFIR?</p>
</div>
</li>
<li class="ltx_item" id="S1.I3.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I3.i7.p1">
<p class="ltx_p" id="S1.I3.i7.p1.1">Is Forensic Timeline Analysis Truly Ready for Generative AI?</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S1.SS2.p3">
<p class="ltx_p" id="S1.SS2.p3.1">The paper is structured as follows to address the research questions: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S1" title="I Introduction ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">I</span></a> provides an introduction to the field of DFIR, establishing a foundational understanding of its key aspects. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2" title="II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">II</span></a> further elaborates on these details to offer deeper insights. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3" title="III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">III</span></a>, we review related works and literature to build a robust foundation and gather additional perspectives. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4" title="IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">IV</span></a> details the development of our framework, including its primary algorithms. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5" title="V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">V</span></a> covers the implementation and testing of the system using simulated scenarios to assess its effectiveness. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6" title="VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VI</span></a> evaluates the system’s reliability, functionality, and effectiveness, while also discussing the limitations of the research. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S7" title="VII Limitations and Ethical Issues ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VII</span></a>, we address the limitations and ethical considerations associated with developing and deploying this framework. Finally, Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S8" title="VIII Conclusion and Future Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VIII</span></a> concludes the paper with recommendations for refinement and suggestions for future research.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Background</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">TA within DFIR, and Rule-Based (R-B) and LLMs within AI, represent two distinct areas of research. It is important to remember that this approach aims to automate tasks or processes using AI. Therefore, understanding and defining key concepts is crucial.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Below are definitions aligned with the scope of this research:</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Digital Artifact:</span> There is no formal and precise definition of this term in the literature <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib2" title="">2</a>]</cite>. However, within the field of digital forensics (DF), artefacts are referred to as processed and relevant data retrieved from digital devices. For example, in operating system (OS) forensics, these artefacts include the file system, OS executables, network activity, internet history, cache, and more.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Digital Data:</span> Data refers to raw and unprocessed facts that could potentially become information after processing, analysis, and examination. For instance, raw text files, log entries, and network packet capture can be analyzed and processed to transform into information that serves as evidence <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1"><span class="ltx_text ltx_font_bold" id="S2.p5.1.1">Chronological or Temporal Digital Artifact:</span> These are secondary artifacts derived from primary artifacts (source). For instance, a log file is a primary artifact that contains timeline data (date, time, sequential order, etc.), which are considered temporal artifacts. In DF, these temporal artifacts, once processed and analyzed, provide valuable information for reconstructing and correlating events <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1"><span class="ltx_text ltx_font_bold" id="S2.p6.1.1">Timeline Analysis:</span> LLMs can reconstruct a timeline of events by identifying temporal patterns and correlations within the data. They can automatically generate a detailed timeline that chronicles the sequence of actions performed on the device.</p>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.1"><span class="ltx_text ltx_font_bold" id="S2.p7.1.1">Anomaly Detection:</span> R-BAI algorithms can be effectively employed for anomaly detection in DF and cybersecurity contexts. These algorithms operate on a set of predefined rules manually designed by domain experts. By comparing observed behavior against expected norms or baselines established through these rules, R-BAI can flag unusual events or deviations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib15" title="">15</a>]</cite>. This capability allows for the identification of potential unauthorized access, data tampering, or other malicious activities.</p>
</div>
<div class="ltx_para" id="S2.p8">
<p class="ltx_p" id="S2.p8.1"><span class="ltx_text ltx_font_bold" id="S2.p8.1.1">Large Language Models (LLMs):</span> Powered by NLP, LLMs are computational models of GenAI that possess the ability to understand and generate human language. They have the capability to predict the probability of word sequences or produce new text based on provided inputs. LLMs are distinguished by their vast training datasets and sophisticated architectures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib8" title="">8</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p9">
<p class="ltx_p" id="S2.p9.1"><span class="ltx_text ltx_font_bold" id="S2.p9.1.1">Multimodal Data Fusion:</span> With Multimodal Large Language Models (MLLMs) capable of processing diverse data types, including text, images, and audio <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib9" title="">9</a>]</cite>, we can integrate various digital artifacts into the investigation process. This integration contextually enriches the representation of events, aiding in the reconstruction of a comprehensive timeline.</p>
</div>
<div class="ltx_para" id="S2.p10">
<p class="ltx_p" id="S2.p10.1"><span class="ltx_text ltx_font_bold" id="S2.p10.1.1">Natural Language Processing (NLP):</span> An AI-powered technique that can analyze textual data extracted from digital artifacts, such as chat logs, emails, or document metadata, to enrich investigative timelines with contextual information. By interpreting the linguistic content and sentiment of communications, NLP can provide insights into the motives, intentions, and relationships of individuals involved in the events timeline <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib16" title="">16</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p11">
<p class="ltx_p" id="S2.p11.1"><span class="ltx_text ltx_font_bold" id="S2.p11.1.1">Prompt Engineering:</span> This is the art and science of skillfully crafting and designing prompts to maximize the capabilities of the model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib16" title="">16</a>]</cite>. In the context of DFIR and TA, this involves strategically framing inputs, specifying technical details, and establishing the investigative context to refine the model’s output. This method ensures that the LLM understands context, adheres to specific forensic and legal constraints, and achieves the intended goals of the investigation or analysis.</p>
</div>
<div class="ltx_para" id="S2.p12">
<p class="ltx_p" id="S2.p12.1"><span class="ltx_text ltx_font_bold" id="S2.p12.1.1">Predictive Analytics:</span> LLMs trained on historical forensic and cybersecurity data can predict future events or anticipate potential outcomes based on observed patterns and trends in the timeline. By leveraging predictive analytics capabilities, they can assist investigators in forecasting the evolution of ongoing incidents, identifying emerging threats, and proactively mitigating risks.</p>
</div>
<div class="ltx_para" id="S2.p13">
<p class="ltx_p" id="S2.p13.1">In addition to these definitions, the cycles of DF and IR processes, along with the AI taxonomy, are presented as follows:</p>
</div>
<div class="ltx_para" id="S2.p14">
<p class="ltx_p" id="S2.p14.1"><span class="ltx_text ltx_font_bold" id="S2.p14.1.1">Digital Forensics (DF) Investigation Process:</span>
There are several available representations of the DF investigation process. However, in this research, we used the process shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2.F1" title="Figure 1 ‣ II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="132" id="S2.F1.g1" src="extracted/5878186/img/df.png" width="150"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Digital Forensics Process</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p15">
<p class="ltx_p" id="S2.p15.1"><span class="ltx_text ltx_font_bold" id="S2.p15.1.1">1) Identification:</span> Identify and recognize all relevant digital artifacts and data that need to be collected. This involves determining which devices, systems, and data sources are pertinent to the investigation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p16">
<p class="ltx_p" id="S2.p16.1"><span class="ltx_text ltx_font_bold" id="S2.p16.1.1">2) Collection:</span> Collect and acquire all digital artifacts and data with proper legal authorization, such as consent, subpoena, or search warrant. Additionally, use forensic imaging techniques to create and store an exact copy of the originally acquired data and artifacts to preserve their integrity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p17">
<p class="ltx_p" id="S2.p17.1"><span class="ltx_text ltx_font_bold" id="S2.p17.1.1">3) Analysis:</span> Analyze and examine all collected digital artifacts and data. Identify anomalies and threats related to the incident, and extract potential evidence from them. Reconstruct a timeline from temporal artifacts and correlate events to establish a comprehensive understanding of the incident.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p18">
<p class="ltx_p" id="S2.p18.1"><span class="ltx_text ltx_font_bold" id="S2.p18.1.1">4) Reporting:</span> Produce a detailed report documenting all steps, methods, findings, and conclusions. The report must adhere to strict guidelines, standards, and requirements set by relevant third parties, such as courts or regulatory bodies. Maintain objectivity throughout the report, avoiding any biases or alterations to the findings.</p>
</div>
<div class="ltx_para" id="S2.p19">
<p class="ltx_p" id="S2.p19.1"><span class="ltx_text ltx_font_bold" id="S2.p19.1.1">Incident Response (IR) Process:</span> For more accurate practice, we follow the framework proposed by the National Institute of Standards and Technology (NIST):</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="129" id="S2.F2.g1" src="extracted/5878186/img/ir.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>NIST-Based IR Process</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p20">
<p class="ltx_p" id="S2.p20.1"><span class="ltx_text ltx_font_bold" id="S2.p20.1.1">1) Preparation:</span> Develop and implement an Incident Response (IR) plan, assign roles to trained personnel and the IR team, define rules and policies, and ensure overall readiness. Additionally, acquire and integrate forensic hardware and software into the IR process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p21">
<p class="ltx_p" id="S2.p21.1"><span class="ltx_text ltx_font_bold" id="S2.p21.1.1">2) Detection and Analysis:</span> Detect cyber incidents and malicious activities using security control tools. Once an incident is identified, IR team members and trusted third parties will analyze the situation. They will collect all relevant digital artifacts and data, analyze and examine them to determine potential evidence, identify the root cause of the incident, and reconstruct the actions of threat perpetrators and the sequence of events.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p22">
<p class="ltx_p" id="S2.p22.1"><span class="ltx_text ltx_font_bold" id="S2.p22.1.1">3) Containment, Eradication, and Recovery:</span> Containment involves blocking and limiting the threat actor’s actions to minimize risk. For instance, in the event of a DDoS attack, IR personnel will mitigate the impact by closing all network ports. Following this, they will eradicate all traces of threats and malicious activities using specific tools and techniques, including anti-malware and antivirus software, as well as account deletions. Once threats have been successfully eliminated, the IR team will recover data, restore backups, and conduct other recovery activities to ensure business continuity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p23">
<p class="ltx_p" id="S2.p23.1"><span class="ltx_text ltx_font_bold" id="S2.p23.1.1">4) Post-Incident Activity:</span> In this final phase, review all steps taken and actions performed in response to the incident. The focus is on creating a detailed report and documentation that includes a clear chronology of events and highlights the root cause of the incident.</p>
</div>
<div class="ltx_para" id="S2.p24">
<p class="ltx_p" id="S2.p24.1"><span class="ltx_text ltx_font_bold" id="S2.p24.1.1">DFIR:</span> The entire concept can be illustrated in one comprehensive diagram:</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="349" id="S2.F3.g1" src="extracted/5878186/img/DFIR.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>DFIR Process</figcaption>
</figure>
<div class="ltx_para" id="S2.p25">
<p class="ltx_p" id="S2.p25.1"><span class="ltx_text ltx_font_bold" id="S2.p25.1.1">AI Taxonomy:</span> The AI field is vast and broad. For a quick overview, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2.F4" title="Figure 4 ‣ II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates the positioning of both R-BAI and GenAI LLMs:</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="154" id="S2.F4.g1" src="extracted/5878186/img/llm.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>AI Taxonomy and Generative Pre-Trained Transformers</figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Literature Review and Related Works</span>
</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section reviews literature and various works related to TA, LLMs for DF and cybersecurity, and RAG.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">For TA, the focus is on the most relevant works, along with existing automated tools. Regarding LLMs for DF and cybersecurity and RAG, it is important to note that they represent a rapidly evolving field, with new research being published daily. Some studies are sourced from the arXiv repository, reflecting their status as early-stage research.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">Regarding R-BAI algorithms, their use here is limited to anomaly detection by filtering collected digital artifacts. Detection is typically performed by comparing event attributes with the norm rule attributes. Although R-B algorithms are AI-based, their level of intelligence is relatively low, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2.F4" title="Figure 4 ‣ II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Detection is primarily achieved through string-to-string matching or integer-to-integer comparisons, rather than more advanced methods. These algorithms lack learning capabilities due to their inability to learn from new data. Thus, they remain dependent on human intervention to modify the rules and update data.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">Due to their simplicity and architecture, a comprehensive exploration exceeds the scope of this work. Interested readers can refer to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Timeline Analysis</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The TA process is both thorough and sensitive in DFIR. Unfortunately, due to this complexity, there is limited detailed research, in-depth work, analysis, and interest in this field.
During a cyber incident, massive amounts of data are generated. Some of this data can be considered potential evidence at an early stage of the DF collection phase. However, to determine if the collected artifacts will be considered evidence, support the investigation, maintain the chain of custody, and be admissible in court, they need to undergo meticulous examination and analysis. This is where FT analysis plays a crucial role in enhancing evidence identification and detection related to the incident.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">TA is also resource-intensive, consuming time, money, and requiring expertise. Many DF analysts, in an effort to speed up the process, rely on existing tools namely Exterro Forensic Toolkit (FTK) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib18" title="">18</a>]</cite>, Autopsy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib19" title="">19</a>]</cite>, EnCase <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib20" title="">20</a>]</cite>, and Magnet AXIOM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib21" title="">21</a>]</cite>. While these tools are robust for analysis, they often struggle with timeline reconstruction and event correlation. These tools typically offer analysis on an artifact-by-artifact basis, meaning they do not consider all artifacts and data simultaneously and do not fully automate the process.
As a result, numerous researchers have developed and established more automated tools and frameworks to advance this process.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T1" title="TABLE I ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">I</span></a> summarises some interesting works done in this area.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.1">
<tr class="ltx_tr" id="S3.T1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.1.1.1">
<span class="ltx_p" id="S3.T1.1.1.1.1.1" style="width:43.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Study</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.1.2.1">
<span class="ltx_p" id="S3.T1.1.1.2.1.1" style="width:86.7pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.1.1">Technique</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.1.3.1">
<span class="ltx_p" id="S3.T1.1.1.3.1.1" style="width:260.2pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.1.1.1">Overview</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.2.1.1">
<span class="ltx_p" id="S3.T1.1.2.1.1.1" style="width:43.4pt;">Christopher et al. 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib22" title="">22</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.2.2.1">
<span class="ltx_p" id="S3.T1.1.2.2.1.1" style="width:86.7pt;">Analyzer Plugins - Modular (standalone) Python scripts / Bayesian networks</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.2.3.1">
<span class="ltx_p" id="S3.T1.1.2.3.1.1" style="width:260.2pt;">To automate TA, a systematic technique was employed. First, the researchers used analyzer plugins to conduct detailed analysis on raw, low-level events. These plugins extracted relevant data and aggregated it into high-level events. They then used Bayesian Networks to correlate and link these high-level events by performing probabilistic inference.
The key advantage of this approach is its ability to handle and process large volumes of data successfully.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.3.1.1">
<span class="ltx_p" id="S3.T1.1.3.1.1.1" style="width:43.4pt;">Studiawan et al. 2022 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib23" title="">23</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.3.2.1">
<span class="ltx_p" id="S3.T1.1.3.2.1.1" style="width:86.7pt;">Log2timeline / Customised Plist Parser Plugins - Automation Script</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.3.3.1">
<span class="ltx_p" id="S3.T1.1.3.3.1.1" style="width:260.2pt;">Mainly for iOS devices, the paper proposed using different tools to automate TA. The tool log2timeline automatically extracts time-based data from forensic images and generates an initial timeline. Subsequently, a custom parser was used to include missed data into the initial timeline.</span>
<span class="ltx_p" id="S3.T1.1.3.3.1.2">To summarize, the benefit of this technique lies in its enhancement of the timeline generation process. By incorporating new data after additional analysis in an automated way, using log2timeline and an automated script with Plist parsing plugins, the timeline is seamlessly updated. However, artifact analysis is still done manually.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.4.1.1">
<span class="ltx_p" id="S3.T1.1.4.1.1.1" style="width:43.4pt;">Chabot et al. 2014 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib24" title="">24</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.4.2.1">
<span class="ltx_p" id="S3.T1.1.4.2.1.1" style="width:86.7pt;">Semantic-Based Approach (SADFC)</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.4.3.1">
<span class="ltx_p" id="S3.T1.1.4.3.1.1" style="width:260.2pt;">Discuss the challenges posed in TA by crafting a systematic, multilayered approach named the Semantic-Based Approach (SADFC). This approach consists of three layers, each with its own characteristics and criteria.</span>
<span class="ltx_p" id="S3.T1.1.4.3.1.2">The research suggests that by following the proposed approach, it is possible to build a technically-based solution that addresses all the disclosed problems and challenges. These challenges primarily involve the amount and type of data available after an incident, as well as the time required for accurate TA.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.5.1.1">
<span class="ltx_p" id="S3.T1.1.5.1.1.1" style="width:43.4pt;">Chabot et al. 2014 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib4" title="">4</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.5.2.1">
<span class="ltx_p" id="S3.T1.1.5.2.1.1" style="width:86.7pt;">SADFC / Zeitline / Log2timeline / FORE</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T1.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.5.3.1">
<span class="ltx_p" id="S3.T1.1.5.3.1.1" style="width:260.2pt;">To bring SADCF to life, researchers employed several tools. Initially, they used Zeitline to examine digital artifacts. They then introduced log2timeline to automate the extraction of events from these artifacts. All extracted heterogeneous events were handled by the FORE system. They designed specific algorithms to correlate events by identifying and computing common subjects and objects involved in events, and analyzing the temporal proximity of these events to establish relationships and patterns. To conclude, they utilized graphical representation, making it easier to visualize and interpret the sequence of events and their correlations.</span>
<span class="ltx_p" id="S3.T1.1.5.3.1.2">This technique indeed automates TA, but a key disadvantage is the use of multiple standalone tools.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.6.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.6.1.1">
<span class="ltx_p" id="S3.T1.1.6.1.1.1" style="width:43.4pt;">Bhandari et al.2020 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib25" title="">25</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.1.6.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.6.2.1">
<span class="ltx_p" id="S3.T1.1.6.2.1.1" style="width:86.7pt;">Log2timeline / Psort</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.1.6.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T1.1.6.3.1">
<span class="ltx_p" id="S3.T1.1.6.3.1.1" style="width:260.2pt;">The paper offers a methodology for enhancing TA. The methodology addresses the complexities and challenges in understanding generated temporal artifacts by using abstraction techniques. These techniques mainly involve managing, organizing, and structuring temporal artifacts into a more comprehensible timeline.</span>
<span class="ltx_p" id="S3.T1.1.6.3.1.2">Log2timeline is used to extract timestamps from a disk image file, and Psort processes the output to further handle the temporal artifacts and generate a final timeline. The basis of this research is structuring data for better management, and swift timeline reconstruction.</span>
<span class="ltx_p" id="S3.T1.1.6.3.1.3">It is important to note that in here as well, artifact analysis is done manually.</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Forensics Timeline Analysis Related Works</figcaption>
</figure>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tr class="ltx_tr" id="S3.T2.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.1.1.1">
<span class="ltx_p" id="S3.T2.1.1.1.1.1" style="width:43.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1">Study</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.1.2.1">
<span class="ltx_p" id="S3.T2.1.1.2.1.1" style="width:86.7pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.1.1.1">Model</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.1.3.1">
<span class="ltx_p" id="S3.T2.1.1.3.1.1" style="width:260.2pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.3.1.1.1">Overview</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.2.1.1">
<span class="ltx_p" id="S3.T2.1.2.1.1.1" style="width:43.4pt;">Ferrag et al. 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib26" title="">26</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.2.2.1">
<span class="ltx_p" id="S3.T2.1.2.2.1.1" style="width:86.7pt;">BERT , XLNet , RoBERTa , Llama-3-8B , GPT 4o , GPT-4-turbo , Mixtral-8x7B-I , Falcon-180B-Chat , GEMINI-pro 1.0 Google 137B , GPT-3.5-turbo , Qwen1.5-4B Qwen 4B , Llama-2-13b-hf , etc.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.2.3.1">
<span class="ltx_p" id="S3.T2.1.2.3.1.1" style="width:260.2pt;">This article is a comprehensive literature review on cybersecurity LLMs. It encompasses research, studies, published articles, and journals addressing the integration of GenAI and LLMs into cybersecurity. Additionally, the paper covers features, findings, insights, and theoretical approaches from datasets relevant to cybersecurity, including training methods, to architectures and relevant mathematical equations.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.1">
<span class="ltx_p" id="S3.T2.1.3.1.1.1" style="width:43.4pt;">Wickramasekara et al. 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib27" title="">27</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.2.1">
<span class="ltx_p" id="S3.T2.1.3.2.1.1" style="width:86.7pt;">GILL , VisionLLM GPT-4 , LLaVa , Visual ChatGPT , Flamingo , VidIL, etc.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.3.1">
<span class="ltx_p" id="S3.T2.1.3.3.1.1" style="width:260.2pt;">The paper provides an extensive literature review on the integration of LLMs to advance the process of DF. Additionally, it explains how LLMs can be used in each phase of a DF investigation, as well as how specific models can serve particular tasks. For instance, a single model like GPT-3.5 can generate textual reports at the end of investigations, while multimodal LLMs such as GPT-4 and LLaVA, with vision assistance, can analyze images and videos, providing contextual DF outputs.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.1.1">
<span class="ltx_p" id="S3.T2.1.4.1.1.1" style="width:43.4pt;">Scanlon et al. 2023 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib28" title="">28</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.1">
<span class="ltx_p" id="S3.T2.1.4.2.1.1" style="width:86.7pt;">ChatGPT powered by GPT-4 , GPT-3.5 .</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T2.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.3.1">
<span class="ltx_p" id="S3.T2.1.4.3.1.1" style="width:260.2pt;">The article provides a comprehensive study on how ChatGPT can assist during DF investigations, addressing this idea from various aspects. ChatGPT can be used to assist in different tasks, for instance: artifact analysis, generating regular expressions and keyword lists, generating scripts for file carving RAID disk acquisition and password cracking, IR source identification and anomaly detection, and creating detailed forensic scenarios. The paper also acknowledges the limitations, good, and bad of ChatGPT. It clearly states that even though the model further advances the DF process, at this stage of technological advancement, it is still vulnerable to biases and non-deterministic nature. Therefore, it must always be managed by humans.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.1.1">
<span class="ltx_p" id="S3.T2.1.5.1.1.1" style="width:43.4pt;">E K et al. 2023 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib29" title="">29</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.2.1">
<span class="ltx_p" id="S3.T2.1.5.2.1.1" style="width:86.7pt;">ChatGPT powered by GPT-4 , GPT-3.5 .</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.1">
<span class="ltx_p" id="S3.T2.1.5.3.1.1" style="width:260.2pt;">The paper proposes using ChatGPT to enhance digital investigations by identifying evidence during the DF process. ChatGPT, powered by GPT-4 and GPT-3.5 models, can potentially be used and leveraged to analyze artifacts (input data) and extract relevant evidence such as conversations, images, and any other pertinent information related to the investigations. The paper clearly states that although this method is efficient, its output must always be verified and monitored by humans.</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Cybersecurity and Digital Forensics LLMs Related Works</figcaption>
</figure>
<figure class="ltx_table" id="S3.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.1">
<tr class="ltx_tr" id="S3.T3.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.1.1.1">
<span class="ltx_p" id="S3.T3.1.1.1.1.1" style="width:43.4pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.1.1">Study</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.1.2.1">
<span class="ltx_p" id="S3.T3.1.1.2.1.1" style="width:86.7pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.1.1.1">Approach</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.1.3.1">
<span class="ltx_p" id="S3.T3.1.1.3.1.1" style="width:260.2pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.3.1.1.1">Overview</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.2.1.1">
<span class="ltx_p" id="S3.T3.1.2.1.1.1" style="width:43.4pt;">Tihanyi et al. 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib30" title="">30</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.2.2.1">
<span class="ltx_p" id="S3.T3.1.2.2.1.1" style="width:86.7pt;">RAG to enhance creating a contextual dataset - CyberMetric -</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.2.3.1">
<span class="ltx_p" id="S3.T3.1.2.3.1.1" style="width:260.2pt;">The idea presented in the paper involves RAG to advance the process of creating a cybersecurity-based dataset (CyberMetric), where high-quality and context-based questions were generated.
Later then, CyberMetric was used to benchmark the general cybersecurity knowledge of cybersecurity-oriented LLMs.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.3.1.1">
<span class="ltx_p" id="S3.T3.1.3.1.1.1" style="width:43.4pt;">Lála et al. 2023 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib31" title="">31</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.3.2.1">
<span class="ltx_p" id="S3.T3.1.3.2.1.1" style="width:86.7pt;">RAG agents to embed documents and generate context-based answers</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.3.3.1">
<span class="ltx_p" id="S3.T3.1.3.3.1.1" style="width:260.2pt;">The paper explains and showcases the power of RAG agents to tackle some limitations of traditional LLMs, such as hallucinations and lack of interpretability. RAG agents were used to answer questions based on embedded scientific literature.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.1.1">
<span class="ltx_p" id="S3.T3.1.4.1.1.1" style="width:43.4pt;">Yu et. 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib32" title="">32</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.2.1">
<span class="ltx_p" id="S3.T3.1.4.2.1.1" style="width:86.7pt;">RAG to improve accuracy and relevance of responses generated by LLMs by incorporating external knowledge sources.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S3.T3.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.3.1">
<span class="ltx_p" id="S3.T3.1.4.3.1.1" style="width:260.2pt;">The study provides detailed insights and recommendations for using RAGs. It suggests a systematic approach to follow, for instance, query classification, retrieval, reranking where documents are re-ranked to be ordered based on relevance to the context, summarization by extracting key information only and embedding using embedding models where textual data are converted into numerical representations in a vector.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T3.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.1.1">
<span class="ltx_p" id="S3.T3.1.5.1.1.1" style="width:43.4pt;">Yu et. 2024 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib33" title="">33</a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.2.1">
<span class="ltx_p" id="S3.T3.1.5.2.1.1" style="width:86.7pt;">Optimise RAG performance using chunking.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.3.1">
<span class="ltx_p" id="S3.T3.1.5.3.1.1" style="width:260.2pt;">The study proposes a novel framework to enhance the performance of RAG in single LLMs for both contextual ranking and answer generation. The extraction is optimized using chunks and tokens. Chunks are used for text segmentation, and tokens are units, words, or subwords within a chunk. The goal is to ensure that each chunk has sufficient context to answer questions and queries accurately.</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Retrieval-Augmented Generation Related Works</figcaption>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Embedding Models for Forensics Timeline Analysis</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T4.1">
<tr class="ltx_tr" id="S3.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T4.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1">Embedding</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T4.1.2.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.2.2.1">Dimension</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.2.3.1">Max Tokens</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.2.4.1">Proprietary</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.2.5.1">License</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.1.3.1">text-embedding-3-large</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.2">3072</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.3">8191</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.4">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.3.5">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.4">
<td class="ltx_td ltx_align_left" id="S3.T4.1.4.1">text-embedding-3-small</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.2">1536</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.3">4096</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4">Yes</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.5">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.5">
<td class="ltx_td ltx_align_left" id="S3.T4.1.5.1">mxbai-embed-large</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.2">1024</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.3">512</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.4">No</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5">Mixedbread AI</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.6">
<td class="ltx_td ltx_align_left" id="S3.T4.1.6.1">nomic-embed-text</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.2">768</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.3">8192</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.4">No</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.6.5">Nomic</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.7">
<td class="ltx_td ltx_align_left" id="S3.T4.1.7.1">google-gecko.text-embedding</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.2">768</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.3">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.4">Yes</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.7.5">Google</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.1.8.1">google-gecko-256.text-embedding</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.8.2">256</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.8.3">2048</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.8.4">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.8.5">Google</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Large Language Models for Cybersecurity and Digital Forensics tasks</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">LLMs, which are GenAI models, have been a leading trend in recent years. In the early stages, the emergence of language models like ChatGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib34" title="">34</a>]</cite>, Claude <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib35" title="">35</a>]</cite>, and Llama <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib36" title="">36</a>]</cite>, powered by LLMs such as LLaMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib37" title="">37</a>]</cite> by Meta <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib38" title="">38</a>]</cite>, the GPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib39" title="">39</a>]</cite> family by OpenAI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib40" title="">40</a>]</cite>, and Claude by Anthropic <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib41" title="">41</a>]</cite>, among others, were initially used primarily for conversation and generating text due to their strong NLP capabilities. However, recent technological advancements have introduced multimodality capabilities, enabling LLM-powered solutions to process diverse modalities including text, audio, images, and videos <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib9" title="">9</a>]</cite>. This evolution progressed from using LLMs for simple conversational tasks to automating complex processes and transforming entire fields.
For an LLM to generate results, whether in a single modality (text) or multimodality (images, audio, video), its architecture requires extensive knowledge during training and fine-tuning. This training knowledge can span different topics, contexts, areas, and fields <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib8" title="">8</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib9" title="">9</a>]</cite>.
Another detail in LLM architecture is the use of transformers, which is extensively explained in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib42" title="">42</a>]</cite>. Each word for an LLM, whether learned from the dataset during training or fine-tuning or as user input during a query, is transformed into a numerical representation and embedded into a high-dimensional vector.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">One must bear in mind that there are different types of LLMs. Each type is designed for specific tasks; some excel in report generation, others in classification, and some in predictive analytics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib26" title="">26</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">When it comes to automating TA, the operation involves comprehensive data handling, processing, and analysis of digital artefacts, both textually and contextually. This process can be significantly enhanced by employing an LLM trained with cybersecurity, DF, and IR datasets. These datasets consist of reports, journal and conference papers, previous DFIR cases, standards, frameworks, guidelines, and conversations related to the field. Examples include IEEE articles, Wikipedia entries, CTDD, IDS2017 and IDS2018 datasets, ADFA (Australian Defence Force Academy) datasets, OpenTitan System-on-Chip (SoC) data, Hack@dac 2021 SoC data, CVE reports, and more <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib26" title="">26</a>]</cite>. Additionally, LLMs capable of generating reports and understanding the nuances of cyber threats, digital artefact analysis, temporal artefact analysis, event correlation, timeline reconstruction, identifying incident root causes, incident scenario simulation, sentiment analysis, and predicting future actions and scenarios are the optimal choice for us.
Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T2" title="TABLE II ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">II</span></a> summarizes all groundbreaking research. Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T5" title="TABLE V ‣ III-B Large Language Models for Cybersecurity and Digital Forensics tasks ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">V</span></a> lists the trained LLMs that are benchmarked and suitable for cybersecurity and DFIR tasks.</p>
</div>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>LLMs for Forensics Timeline Analysis</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T5.1">
<tr class="ltx_tr" id="S3.T5.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S3.T5.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1">LLM</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.2.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.2"><span class="ltx_text ltx_font_bold" id="S3.T5.1.2.2.1">Training Data</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.3"><span class="ltx_text ltx_font_bold" id="S3.T5.1.2.3.1">Proprietary</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.4"><span class="ltx_text ltx_font_bold" id="S3.T5.1.2.4.1">License</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.1.3.1">GPT-4o</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.2">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.3">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.3.4">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.4">
<td class="ltx_td ltx_align_left" id="S3.T5.1.4.1">GPT-4turbo</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.2">N/A</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3">Yes</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.4">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.5">
<td class="ltx_td ltx_align_left" id="S3.T5.1.5.1">GPT-4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.2">N/A</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.3">Yes</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.5.4">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.6">
<td class="ltx_td ltx_align_left" id="S3.T5.1.6.1">GPT-3.5turbo</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.2">175B</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.3">Yes</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.6.4">OpenAI</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.7">
<td class="ltx_td ltx_align_left" id="S3.T5.1.7.1">Llama-3.1</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.2">405B / 70B / 8B</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.3">No</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.7.4">Meta</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.8">
<td class="ltx_td ltx_align_left" id="S3.T5.1.8.1">Llava-llama3</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.2">8B</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.3">No</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.8.4">Microsoft Research</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.9">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T5.1.9.1">Mistral 2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.9.2">123B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.9.3">No</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.9.4">Mistral</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">The use of Retrieval-Augmented Generation</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Understanding RAG, how it works, and the process of its integration can be somewhat confusing and complex. This complexity largely depends on the scope and objectives of its application. In our approach, we narrow its use down to the contexts of TA, DF, and IR.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">RAG primarily aims to optimize and enhance the performance of LLMs. It utilizes an external knowledge base beyond the LLM’s pre-existing knowledge and training datasets to provide additional information during inference. This process is not exactly like fine-tuning or training an LLM but rather involves dynamically retrieving, generating, and integrating relevant external textual information from databases (external storage), local files (as a vault file), or through cloud pipelines <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib43" title="">43</a>]</cite>. It is crucial to acknowledge that while an LLM alone is very powerful, its knowledge may not encompass specific contexts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib11" title="">11</a>]</cite>. For instance, organizations may possess sensitive and confidential data, as well as their contextual interpretations of rules, concepts, or topic-related information, which they wish to keep private <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib15" title="">15</a>]</cite>. Data for training LLMs are typically gathered from various sources such as cookies, third-party datasets, publicly available online content, and other means. An LLM cannot access or recognize information that was not included in its training data. This is where RAG is particularly useful, as it addresses these limitations by integrating relevant external information. Due to privacy and security concerns, this process is generally conducted within secure, context-specific, and private task environments.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">To maintain good cybersecurity practices in TA, it is essential to consider the level of risk, privacy, and confidentiality of data, as well as compliance with rules, guidelines, and policies during the data and digital artifacts collection phase <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib15" title="">15</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">Additionally, a RAG agent, which is an essential component in certain AI systems powered by an LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib44" title="">44</a>]</cite>, serves as an intermediary between the LLM and the user. The agent is responsible for conducting the search when a user sends a query or input, retrieving all context-based information, and providing it to the LLM, which then generates a context-based answer for the user. Complementing this, RAG agents have the capability of refining and modifying prompts crafted by humans. During inference, the RAG agent receives the input, processes it, and modifies it according to the role it is tasked with and designed to do <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib47" title="">47</a>]</cite>. A core aspect to consider is that the role of a RAG agent is assigned by a human. For instance, in an LLM-powered system with a RAG agent, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.F5" title="Figure 5 ‣ III-C The use of Retrieval-Augmented Generation ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, the agent can take on the role of a cybersecurity assistant. In TA, the agent could be a <span class="ltx_text ltx_font_italic" id="S3.SS3.p4.1.1">"Digital Forensics and Cybersecurity AI Analyst tasked with performing timeline analysis, correlating events, and reconstructing timelines"</span>.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="176" id="S3.F5.g1" src="extracted/5878186/img/process.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>AI System Powered by LLM and RAG Agent</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Another consideration in RAG is the chunking process. Chunking is a method where text is split and structured into smaller segments based on the number of tokens. A token might be a word, number, or punctuation in a sentence. To embed text in chunks, an embedding model is needed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib48" title="">48</a>]</cite>. Several models exist; Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T4" title="TABLE IV ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">IV</span></a> represents some optimized models that potentially serve the context of TA. Each model has its own characteristics, such as dimension and maximum number of tokens.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1">In TA, involving temporal digital artefact analysis, every single character counts. A second or minute (a number -token) can make a huge difference during event correlation. This points to the fact that meticulous calculation of tokens and careful consideration of the embedding model are imperative. All details are required to be embedded and stored accurately for precise and accurate TA.</p>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T3" title="TABLE III ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">III</span></a> contains valuable research on the use of RAG, including their implementation and architecture.</p>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">The insights gained from our literature review and related works form the foundation for developing our framework.</p>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<p class="ltx_p" id="S3.SS3.p9.1">To begin, LLMs in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T3" title="TABLE III ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">III</span></a> are the best to adopt for this scope of study. However, some of these models are not open-source, which is a disadvantage for us. This limitation restricts our ability to modify and explore the model to align it with our goals. Therefore, we opt for open-source models such as "Llama-3.1." For embedding models, we apply the same principle as with LLM models, using open-source alternatives like "mxbai-embed-large."</p>
</div>
<div class="ltx_para" id="S3.SS3.p10">
<p class="ltx_p" id="S3.SS3.p10.1">Regarding the tables of relevant works, it is clear that there has been limited advancement in TA, despite progress in the field of AI. Most studies have relied on standalone tools like log2timeline.</p>
</div>
<div class="ltx_para" id="S3.SS3.p11">
<p class="ltx_p" id="S3.SS3.p11.1">Concerning LLMs in DF and cybersecurity, they still face many limitations as research and development are ongoing.</p>
</div>
<div class="ltx_para" id="S3.SS3.p12">
<p class="ltx_p" id="S3.SS3.p12.1">Finally, all the mentioned information about using RAG with an external knowledge base is primarily applied in research and various tasks to enhance the LLM’s knowledge, memory, and context. In our proposed approach, our aim is to exploit it differently. Instead of using the external knowledge base to broadly enhance the LLM’s knowledge, we will directly upload forensic reports (containing events of cyber incidents) into the AI system. This will allow the system to answer questions and generate forensic-based TA reports directly from these documents.</p>
</div>
<div class="ltx_para" id="S3.SS3.p13">
<p class="ltx_p" id="S3.SS3.p13.1">It’s important to note that LLMs can process inputs in the form of documents or text. However, this introduces additional considerations, such as the number of tokens that the LLM can accept as input, the internal embedding model and its characteristics, and the level of attention mechanism used by the LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib16" title="">16</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib42" title="">42</a>]</cite>. For example, LLMs like GPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib39" title="">39</a>]</cite> use a context window to process inputs. When inputting forensic reports containing incident events, the LLM’s attention mechanism may sometimes overlook details, focusing more on the overall context and semantics of the input.</p>
</div>
<div class="ltx_para" id="S3.SS3.p14">
<p class="ltx_p" id="S3.SS3.p14.1">This work combines multiple findings and techniques to offer an advanced automation of TA for DFIR.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">GenDFIR Methodology</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The methodology chosen for designing and building the framework is complex and influenced by various factors. While using LLMs for artefact analysis is not new and has been employed to automate many tasks, a key challenge in DFIR remains the sheer volume of artefacts that require analysis. As discussed earlier, relying on LLMs to process large volumes of artefacts or incident events simultaneously in one input is suboptimal. Another critical issue is the correlation between events, which must be considered. In traditional methods, artefacts are often input multiple times (basic LLM input process), with each new input needing to reference earlier ones, resulting in a time-consuming process.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">A common example of this limitation can be observed in models like ChatGPT. Although it is powerful, its input capacity is limited, and when prompted excessively, it can lose context, semantic accuracy, and may even hallucinate <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib34" title="">34</a>]</cite>. Despite its memory capabilities—considering previous interactions when generating responses (Previous Conversation)—extensive prompting can cause it to lose track of earlier inputs.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">RAG is proposed as an alternative to address the challenges in GenDFIR, particularly the need to capture all events during TA and their details. While RAG is typically used to extend the memory of LLMs by retrieving external information, it consists of two key functions: Retrieval and Generation. The Retrieval function, a core aspect of Information Retrieval, uses techniques like cosine similarity to extract specific pieces of information or entire documents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib45" title="">45</a>]</cite>. Information Retrieval has been well-established for decades and is widely used by companies like Google, Mozilla Firefox, and Amazon to retrieve data from their storage systems, as exemplified by their search engine functionalities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib46" title="">46</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">The same principle applies to integrating LLMs and RAG in GenDFIR. The knowledge base serves as the information storage, housing all incident events, while the RAG agent, powered by the LLM with NLP capabilities, retrieves relevant evidence of the incident based on user queries.</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">This section details the methodology and approach used to build the GenDFIR framework, including the algorithms and their interpretation:</p>
</div>
<div class="ltx_para" id="S4.p6">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">LLM Model</span>: Llama-3.1 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib36" title="">36</a>]</cite>, a powerful model by Meta <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib38" title="">38</a>]</cite>, evaluated on over 150 standard benchmarks and human evaluations. The rationale behind selecting this model is its open-source nature and its training on publicly validated data, including cybersecurity-related content. An important consideration is the benchmarking over the new CYBERSECEVAL 3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib49" title="">49</a>]</cite> suite to measure cybersecurity risks and capabilities. The model can recognize and identify cyber threats with high accuracy. This is a great advantage for GenDFIR, as it indicates that the LLM can effectively analyze, and recognize anomalous events, and provide insights into a cyber incident. The model is available in three versions: 405B, 70B, and 8B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib36" title="">36</a>]</cite>. At an early stage, we adopt the 8B model to minimize hallucinations and for system prototyping and solely rely on the pretraining knowledge of the base LLM.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.p7">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">Multimodal LLM</span>: Llava-Llama3 is a model fine-tuned from Llama3 and validated by official benchmarks, achieving a Llava core accuracy of 92.53%. It is capable of analyzing and processing images due to its vision encoder and generating textual outputs through its LLM connector. The model is available only in the 8B version <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib50" title="">50</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Embedding Model</span>: mxbai-embed-large, a Mixedbread release, with a maximum token limit of 512 and a maximum dimension of 1024. The model performed highly on the Massive Text Embedding Benchmark (MTEB). The reason for opting for this model is its capabilities in retrieval and semantic textual similarities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib51" title="">51</a>]</cite>. Additionally, it is effective for scoring methods during the retrieval process, such as cosine similarity, adopted in GenDFIR.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">RAG Agent</span>: Autonomous Context-Augmented Agent, powered by Llama-3.1. Employed in GenDFIR for the purpose of context-based retrieval and output generation. Operating autonomously as an expert in Cybersecurity and DF, specializing in TA and tasked with identifying events and information related to cyber incidents from our knowledge base.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Forensics Data Pre-processing</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">1) Data Collection:</span> The first step is where raw data and digital artefacts are collected using forensic tools. They will then be stored in datasets (e.g., CSV files) or normal files (e.g., TXT format) while preserving their integrity. This phase is typically part of the DFIR process, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2.F3" title="Figure 3 ‣ II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">2) Multimodal Processing:</span> Images incident from the raw data and incident digital artefacts. However, As research is ongoing to make RAG work with multimodal concepts and interpret figures, tables, and other illustrations in documents, we have chosen an alternative technique for processing:</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1">We employ LlaVa as the MLLM.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1">LLaVA answers forensic questions and queries about images related to the incident and provides textual output.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS1.p2.2">Given the vast variety of data generated from cyber incidents, our framework focuses specifically on the multimodal processing of images and text.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">3) Single Modality Preprocessing:</span> Due to the NLP background of our main LLM model, all relevant textual data and events extracted from digital artefacts are stored in a textual document.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">4) Modality Fusion:</span> We merge the textual outputs generated by the MLLM with those extracted from single-modality documents to create an initial forensic report containing incident events. Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg1" title="Algorithm 1 ‣ IV-A Forensics Data Pre-processing ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>
summarizes the process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">5) Manual Verification:</span> Manually verify and, if needed, restructure the data within the document. This ensures that:</p>
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1">Data is relevant and structured in an understandable way.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1">The document is prepared for easier processing in the following steps.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Images Forensic Processing</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>Images <math alttext="images" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">i</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">m</mi><mo id="alg1.l1.m1.1.1.1a" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.4" xref="alg1.l1.m1.1.1.4.cmml">a</mi><mo id="alg1.l1.m1.1.1.1b" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.5" xref="alg1.l1.m1.1.1.5.cmml">g</mi><mo id="alg1.l1.m1.1.1.1c" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.6" xref="alg1.l1.m1.1.1.6.cmml">e</mi><mo id="alg1.l1.m1.1.1.1d" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.7" xref="alg1.l1.m1.1.1.7.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><times id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></times><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑖</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑚</ci><ci id="alg1.l1.m1.1.1.4.cmml" xref="alg1.l1.m1.1.1.4">𝑎</ci><ci id="alg1.l1.m1.1.1.5.cmml" xref="alg1.l1.m1.1.1.5">𝑔</ci><ci id="alg1.l1.m1.1.1.6.cmml" xref="alg1.l1.m1.1.1.6">𝑒</ci><ci id="alg1.l1.m1.1.1.7.cmml" xref="alg1.l1.m1.1.1.7">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">images</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_i italic_m italic_a italic_g italic_e italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>Contexts and Metadata stored in a textual file <math alttext="File" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">F</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">i</mi><mo id="alg1.l2.m1.1.1.1a" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.4" xref="alg1.l2.m1.1.1.4.cmml">l</mi><mo id="alg1.l2.m1.1.1.1b" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.5" xref="alg1.l2.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><times id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></times><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐹</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑖</ci><ci id="alg1.l2.m1.1.1.4.cmml" xref="alg1.l2.m1.1.1.4">𝑙</ci><ci id="alg1.l2.m1.1.1.5.cmml" xref="alg1.l2.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">File</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_F italic_i italic_l italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg1.l3.3">ProcessImage</span>( )

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l4.2">for</span> image <math alttext="img" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">m</mi><mo id="alg1.l4.m1.1.1.1a" xref="alg1.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.4" xref="alg1.l4.m1.1.1.4.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><times id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></times><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑚</ci><ci id="alg1.l4.m1.1.1.4.cmml" xref="alg1.l4.m1.1.1.4">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">img</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_i italic_m italic_g</annotation></semantics></math> in <math alttext="images" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">i</mi><mo id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">m</mi><mo id="alg1.l4.m2.1.1.1a" xref="alg1.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.4" xref="alg1.l4.m2.1.1.4.cmml">a</mi><mo id="alg1.l4.m2.1.1.1b" xref="alg1.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.5" xref="alg1.l4.m2.1.1.5.cmml">g</mi><mo id="alg1.l4.m2.1.1.1c" xref="alg1.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.6" xref="alg1.l4.m2.1.1.6.cmml">e</mi><mo id="alg1.l4.m2.1.1.1d" xref="alg1.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.7" xref="alg1.l4.m2.1.1.7.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><times id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1"></times><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝑖</ci><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑚</ci><ci id="alg1.l4.m2.1.1.4.cmml" xref="alg1.l4.m2.1.1.4">𝑎</ci><ci id="alg1.l4.m2.1.1.5.cmml" xref="alg1.l4.m2.1.1.5">𝑔</ci><ci id="alg1.l4.m2.1.1.6.cmml" xref="alg1.l4.m2.1.1.6">𝑒</ci><ci id="alg1.l4.m2.1.1.7.cmml" xref="alg1.l4.m2.1.1.7">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">images</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_i italic_m italic_a italic_g italic_e italic_s</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>         <math alttext="MLLM" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">M</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">L</mi><mo id="alg1.l5.m1.1.1.1a" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.4" xref="alg1.l5.m1.1.1.4.cmml">L</mi><mo id="alg1.l5.m1.1.1.1b" xref="alg1.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.5" xref="alg1.l5.m1.1.1.5.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><times id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></times><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑀</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝐿</ci><ci id="alg1.l5.m1.1.1.4.cmml" xref="alg1.l5.m1.1.1.4">𝐿</ci><ci id="alg1.l5.m1.1.1.5.cmml" xref="alg1.l5.m1.1.1.5">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">MLLM</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_M italic_L italic_L italic_M</annotation></semantics></math> = load(model=’llava-llama3’,messages=[{

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>         role: user

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>         content: "Conduct a forensic analysis of the image and summarise the results in one sentence."

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>         image : <math alttext="img" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">m</mi><mo id="alg1.l8.m1.1.1.1a" xref="alg1.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.4" xref="alg1.l8.m1.1.1.4.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><times id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></times><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑚</ci><ci id="alg1.l8.m1.1.1.4.cmml" xref="alg1.l8.m1.1.1.4">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">img</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_i italic_m italic_g</annotation></semantics></math>[i]

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>         }])

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>         <math alttext="context" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">c</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">o</mi><mo id="alg1.l10.m1.1.1.1a" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.4" xref="alg1.l10.m1.1.1.4.cmml">n</mi><mo id="alg1.l10.m1.1.1.1b" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.5" xref="alg1.l10.m1.1.1.5.cmml">t</mi><mo id="alg1.l10.m1.1.1.1c" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.6" xref="alg1.l10.m1.1.1.6.cmml">e</mi><mo id="alg1.l10.m1.1.1.1d" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.7" xref="alg1.l10.m1.1.1.7.cmml">x</mi><mo id="alg1.l10.m1.1.1.1e" xref="alg1.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.8" xref="alg1.l10.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><times id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></times><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑐</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑜</ci><ci id="alg1.l10.m1.1.1.4.cmml" xref="alg1.l10.m1.1.1.4">𝑛</ci><ci id="alg1.l10.m1.1.1.5.cmml" xref="alg1.l10.m1.1.1.5">𝑡</ci><ci id="alg1.l10.m1.1.1.6.cmml" xref="alg1.l10.m1.1.1.6">𝑒</ci><ci id="alg1.l10.m1.1.1.7.cmml" xref="alg1.l10.m1.1.1.7">𝑥</ci><ci id="alg1.l10.m1.1.1.8.cmml" xref="alg1.l10.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">context</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_c italic_o italic_n italic_t italic_e italic_x italic_t</annotation></semantics></math> = MLLM [message][content]

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>         <math alttext="metadata" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">m</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">e</mi><mo id="alg1.l11.m1.1.1.1a" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.4" xref="alg1.l11.m1.1.1.4.cmml">t</mi><mo id="alg1.l11.m1.1.1.1b" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.5" xref="alg1.l11.m1.1.1.5.cmml">a</mi><mo id="alg1.l11.m1.1.1.1c" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.6" xref="alg1.l11.m1.1.1.6.cmml">d</mi><mo id="alg1.l11.m1.1.1.1d" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.7" xref="alg1.l11.m1.1.1.7.cmml">a</mi><mo id="alg1.l11.m1.1.1.1e" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.8" xref="alg1.l11.m1.1.1.8.cmml">t</mi><mo id="alg1.l11.m1.1.1.1f" xref="alg1.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.9" xref="alg1.l11.m1.1.1.9.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><times id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></times><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑚</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑒</ci><ci id="alg1.l11.m1.1.1.4.cmml" xref="alg1.l11.m1.1.1.4">𝑡</ci><ci id="alg1.l11.m1.1.1.5.cmml" xref="alg1.l11.m1.1.1.5">𝑎</ci><ci id="alg1.l11.m1.1.1.6.cmml" xref="alg1.l11.m1.1.1.6">𝑑</ci><ci id="alg1.l11.m1.1.1.7.cmml" xref="alg1.l11.m1.1.1.7">𝑎</ci><ci id="alg1.l11.m1.1.1.8.cmml" xref="alg1.l11.m1.1.1.8">𝑡</ci><ci id="alg1.l11.m1.1.1.9.cmml" xref="alg1.l11.m1.1.1.9">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">metadata</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_m italic_e italic_t italic_a italic_d italic_a italic_t italic_a</annotation></semantics></math> = <math alttext="metaminer" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">m</mi><mo id="alg1.l11.m2.1.1.1" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">e</mi><mo id="alg1.l11.m2.1.1.1a" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.4" xref="alg1.l11.m2.1.1.4.cmml">t</mi><mo id="alg1.l11.m2.1.1.1b" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.5" xref="alg1.l11.m2.1.1.5.cmml">a</mi><mo id="alg1.l11.m2.1.1.1c" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.6" xref="alg1.l11.m2.1.1.6.cmml">m</mi><mo id="alg1.l11.m2.1.1.1d" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.7" xref="alg1.l11.m2.1.1.7.cmml">i</mi><mo id="alg1.l11.m2.1.1.1e" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.8" xref="alg1.l11.m2.1.1.8.cmml">n</mi><mo id="alg1.l11.m2.1.1.1f" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.9" xref="alg1.l11.m2.1.1.9.cmml">e</mi><mo id="alg1.l11.m2.1.1.1g" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.10" xref="alg1.l11.m2.1.1.10.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><times id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1"></times><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑚</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑒</ci><ci id="alg1.l11.m2.1.1.4.cmml" xref="alg1.l11.m2.1.1.4">𝑡</ci><ci id="alg1.l11.m2.1.1.5.cmml" xref="alg1.l11.m2.1.1.5">𝑎</ci><ci id="alg1.l11.m2.1.1.6.cmml" xref="alg1.l11.m2.1.1.6">𝑚</ci><ci id="alg1.l11.m2.1.1.7.cmml" xref="alg1.l11.m2.1.1.7">𝑖</ci><ci id="alg1.l11.m2.1.1.8.cmml" xref="alg1.l11.m2.1.1.8">𝑛</ci><ci id="alg1.l11.m2.1.1.9.cmml" xref="alg1.l11.m2.1.1.9">𝑒</ci><ci id="alg1.l11.m2.1.1.10.cmml" xref="alg1.l11.m2.1.1.10">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">metaminer</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_m italic_e italic_t italic_a italic_m italic_i italic_n italic_e italic_r</annotation></semantics></math>(<math alttext="img" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><mrow id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml">i</mi><mo id="alg1.l11.m3.1.1.1" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">m</mi><mo id="alg1.l11.m3.1.1.1a" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.4" xref="alg1.l11.m3.1.1.4.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><times id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1.1"></times><ci id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2">𝑖</ci><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">𝑚</ci><ci id="alg1.l11.m3.1.1.4.cmml" xref="alg1.l11.m3.1.1.4">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">img</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">italic_i italic_m italic_g</annotation></semantics></math>[i])

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>         <math alttext="File" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">F</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">i</mi><mo id="alg1.l12.m1.1.1.1a" xref="alg1.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.4" xref="alg1.l12.m1.1.1.4.cmml">l</mi><mo id="alg1.l12.m1.1.1.1b" xref="alg1.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.5" xref="alg1.l12.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><times id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></times><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝐹</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑖</ci><ci id="alg1.l12.m1.1.1.4.cmml" xref="alg1.l12.m1.1.1.4">𝑙</ci><ci id="alg1.l12.m1.1.1.5.cmml" xref="alg1.l12.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">File</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_F italic_i italic_l italic_e</annotation></semantics></math>.append(Context: + <math alttext="context" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml">c</mi><mo id="alg1.l12.m2.1.1.1" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">o</mi><mo id="alg1.l12.m2.1.1.1a" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.4" xref="alg1.l12.m2.1.1.4.cmml">n</mi><mo id="alg1.l12.m2.1.1.1b" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.5" xref="alg1.l12.m2.1.1.5.cmml">t</mi><mo id="alg1.l12.m2.1.1.1c" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.6" xref="alg1.l12.m2.1.1.6.cmml">e</mi><mo id="alg1.l12.m2.1.1.1d" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.7" xref="alg1.l12.m2.1.1.7.cmml">x</mi><mo id="alg1.l12.m2.1.1.1e" xref="alg1.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.8" xref="alg1.l12.m2.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><times id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1"></times><ci id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2">𝑐</ci><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑜</ci><ci id="alg1.l12.m2.1.1.4.cmml" xref="alg1.l12.m2.1.1.4">𝑛</ci><ci id="alg1.l12.m2.1.1.5.cmml" xref="alg1.l12.m2.1.1.5">𝑡</ci><ci id="alg1.l12.m2.1.1.6.cmml" xref="alg1.l12.m2.1.1.6">𝑒</ci><ci id="alg1.l12.m2.1.1.7.cmml" xref="alg1.l12.m2.1.1.7">𝑥</ci><ci id="alg1.l12.m2.1.1.8.cmml" xref="alg1.l12.m2.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">context</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_c italic_o italic_n italic_t italic_e italic_x italic_t</annotation></semantics></math> + Metadata: + <math alttext="metadata" class="ltx_Math" display="inline" id="alg1.l12.m3.1"><semantics id="alg1.l12.m3.1a"><mrow id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml"><mi id="alg1.l12.m3.1.1.2" xref="alg1.l12.m3.1.1.2.cmml">m</mi><mo id="alg1.l12.m3.1.1.1" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.3" xref="alg1.l12.m3.1.1.3.cmml">e</mi><mo id="alg1.l12.m3.1.1.1a" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.4" xref="alg1.l12.m3.1.1.4.cmml">t</mi><mo id="alg1.l12.m3.1.1.1b" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.5" xref="alg1.l12.m3.1.1.5.cmml">a</mi><mo id="alg1.l12.m3.1.1.1c" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.6" xref="alg1.l12.m3.1.1.6.cmml">d</mi><mo id="alg1.l12.m3.1.1.1d" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.7" xref="alg1.l12.m3.1.1.7.cmml">a</mi><mo id="alg1.l12.m3.1.1.1e" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.8" xref="alg1.l12.m3.1.1.8.cmml">t</mi><mo id="alg1.l12.m3.1.1.1f" xref="alg1.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l12.m3.1.1.9" xref="alg1.l12.m3.1.1.9.cmml">a</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><apply id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1"><times id="alg1.l12.m3.1.1.1.cmml" xref="alg1.l12.m3.1.1.1"></times><ci id="alg1.l12.m3.1.1.2.cmml" xref="alg1.l12.m3.1.1.2">𝑚</ci><ci id="alg1.l12.m3.1.1.3.cmml" xref="alg1.l12.m3.1.1.3">𝑒</ci><ci id="alg1.l12.m3.1.1.4.cmml" xref="alg1.l12.m3.1.1.4">𝑡</ci><ci id="alg1.l12.m3.1.1.5.cmml" xref="alg1.l12.m3.1.1.5">𝑎</ci><ci id="alg1.l12.m3.1.1.6.cmml" xref="alg1.l12.m3.1.1.6">𝑑</ci><ci id="alg1.l12.m3.1.1.7.cmml" xref="alg1.l12.m3.1.1.7">𝑎</ci><ci id="alg1.l12.m3.1.1.8.cmml" xref="alg1.l12.m3.1.1.8">𝑡</ci><ci id="alg1.l12.m3.1.1.9.cmml" xref="alg1.l12.m3.1.1.9">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">metadata</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m3.1d">italic_m italic_e italic_t italic_a italic_d italic_a italic_t italic_a</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l14.2">return</span> <math alttext="{File}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">F</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">i</mi><mo id="alg1.l14.m1.1.1.1a" xref="alg1.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.4" xref="alg1.l14.m1.1.1.4.cmml">l</mi><mo id="alg1.l14.m1.1.1.1b" xref="alg1.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.5" xref="alg1.l14.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><times id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></times><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝐹</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑖</ci><ci id="alg1.l14.m1.1.1.4.cmml" xref="alg1.l14.m1.1.1.4">𝑙</ci><ci id="alg1.l14.m1.1.1.5.cmml" xref="alg1.l14.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">{File}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_F italic_i italic_l italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l15.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l15.3">function</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Rule-Based AI for Anomaly Detection</span>
</h3>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Rule-Based AI</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>Dataset of events to select <math alttext="DataSet" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">D</mi><mo id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">a</mi><mo id="alg2.l1.m1.1.1.1a" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.4" xref="alg2.l1.m1.1.1.4.cmml">t</mi><mo id="alg2.l1.m1.1.1.1b" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.5" xref="alg2.l1.m1.1.1.5.cmml">a</mi><mo id="alg2.l1.m1.1.1.1c" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.6" xref="alg2.l1.m1.1.1.6.cmml">S</mi><mo id="alg2.l1.m1.1.1.1d" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.7" xref="alg2.l1.m1.1.1.7.cmml">e</mi><mo id="alg2.l1.m1.1.1.1e" xref="alg2.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.8" xref="alg2.l1.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><times id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1"></times><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝐷</ci><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑎</ci><ci id="alg2.l1.m1.1.1.4.cmml" xref="alg2.l1.m1.1.1.4">𝑡</ci><ci id="alg2.l1.m1.1.1.5.cmml" xref="alg2.l1.m1.1.1.5">𝑎</ci><ci id="alg2.l1.m1.1.1.6.cmml" xref="alg2.l1.m1.1.1.6">𝑆</ci><ci id="alg2.l1.m1.1.1.7.cmml" xref="alg2.l1.m1.1.1.7">𝑒</ci><ci id="alg2.l1.m1.1.1.8.cmml" xref="alg2.l1.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">DataSet</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_D italic_a italic_t italic_a italic_S italic_e italic_t</annotation></semantics></math>, and a Set of Predefine Rules <math alttext="rules" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">r</mi><mo id="alg2.l1.m2.1.1.1" xref="alg2.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">u</mi><mo id="alg2.l1.m2.1.1.1a" xref="alg2.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.1.1.4" xref="alg2.l1.m2.1.1.4.cmml">l</mi><mo id="alg2.l1.m2.1.1.1b" xref="alg2.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.1.1.5" xref="alg2.l1.m2.1.1.5.cmml">e</mi><mo id="alg2.l1.m2.1.1.1c" xref="alg2.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.1.1.6" xref="alg2.l1.m2.1.1.6.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><times id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1"></times><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝑟</ci><ci id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">𝑢</ci><ci id="alg2.l1.m2.1.1.4.cmml" xref="alg2.l1.m2.1.1.4">𝑙</ci><ci id="alg2.l1.m2.1.1.5.cmml" xref="alg2.l1.m2.1.1.5">𝑒</ci><ci id="alg2.l1.m2.1.1.6.cmml" xref="alg2.l1.m2.1.1.6">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">rules</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_r italic_u italic_l italic_e italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>All infected events (with anomalies) are selected and put in one document <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l3.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg2.l3.3">AnomalyDetection</span>( )

</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>     <math alttext="File" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">F</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">i</mi><mo id="alg2.l4.m1.1.1.1a" xref="alg2.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.4" xref="alg2.l4.m1.1.1.4.cmml">l</mi><mo id="alg2.l4.m1.1.1.1b" xref="alg2.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.5" xref="alg2.l4.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><times id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></times><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝐹</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑖</ci><ci id="alg2.l4.m1.1.1.4.cmml" xref="alg2.l4.m1.1.1.4">𝑙</ci><ci id="alg2.l4.m1.1.1.5.cmml" xref="alg2.l4.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">File</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_F italic_i italic_l italic_e</annotation></semantics></math> = <math alttext="ConvertDataSetToFile" class="ltx_Math" display="inline" id="alg2.l4.m2.1"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml">C</mi><mo id="alg2.l4.m2.1.1.1" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">o</mi><mo id="alg2.l4.m2.1.1.1a" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.4" xref="alg2.l4.m2.1.1.4.cmml">n</mi><mo id="alg2.l4.m2.1.1.1b" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.5" xref="alg2.l4.m2.1.1.5.cmml">v</mi><mo id="alg2.l4.m2.1.1.1c" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.6" xref="alg2.l4.m2.1.1.6.cmml">e</mi><mo id="alg2.l4.m2.1.1.1d" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.7" xref="alg2.l4.m2.1.1.7.cmml">r</mi><mo id="alg2.l4.m2.1.1.1e" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.8" xref="alg2.l4.m2.1.1.8.cmml">t</mi><mo id="alg2.l4.m2.1.1.1f" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.9" xref="alg2.l4.m2.1.1.9.cmml">D</mi><mo id="alg2.l4.m2.1.1.1g" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.10" xref="alg2.l4.m2.1.1.10.cmml">a</mi><mo id="alg2.l4.m2.1.1.1h" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.11" xref="alg2.l4.m2.1.1.11.cmml">t</mi><mo id="alg2.l4.m2.1.1.1i" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.12" xref="alg2.l4.m2.1.1.12.cmml">a</mi><mo id="alg2.l4.m2.1.1.1j" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.13" xref="alg2.l4.m2.1.1.13.cmml">S</mi><mo id="alg2.l4.m2.1.1.1k" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.14" xref="alg2.l4.m2.1.1.14.cmml">e</mi><mo id="alg2.l4.m2.1.1.1l" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.15" xref="alg2.l4.m2.1.1.15.cmml">t</mi><mo id="alg2.l4.m2.1.1.1m" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.16" xref="alg2.l4.m2.1.1.16.cmml">T</mi><mo id="alg2.l4.m2.1.1.1n" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.17" xref="alg2.l4.m2.1.1.17.cmml">o</mi><mo id="alg2.l4.m2.1.1.1o" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.18" xref="alg2.l4.m2.1.1.18.cmml">F</mi><mo id="alg2.l4.m2.1.1.1p" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.19" xref="alg2.l4.m2.1.1.19.cmml">i</mi><mo id="alg2.l4.m2.1.1.1q" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.20" xref="alg2.l4.m2.1.1.20.cmml">l</mi><mo id="alg2.l4.m2.1.1.1r" xref="alg2.l4.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m2.1.1.21" xref="alg2.l4.m2.1.1.21.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><times id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1.1"></times><ci id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2">𝐶</ci><ci id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3">𝑜</ci><ci id="alg2.l4.m2.1.1.4.cmml" xref="alg2.l4.m2.1.1.4">𝑛</ci><ci id="alg2.l4.m2.1.1.5.cmml" xref="alg2.l4.m2.1.1.5">𝑣</ci><ci id="alg2.l4.m2.1.1.6.cmml" xref="alg2.l4.m2.1.1.6">𝑒</ci><ci id="alg2.l4.m2.1.1.7.cmml" xref="alg2.l4.m2.1.1.7">𝑟</ci><ci id="alg2.l4.m2.1.1.8.cmml" xref="alg2.l4.m2.1.1.8">𝑡</ci><ci id="alg2.l4.m2.1.1.9.cmml" xref="alg2.l4.m2.1.1.9">𝐷</ci><ci id="alg2.l4.m2.1.1.10.cmml" xref="alg2.l4.m2.1.1.10">𝑎</ci><ci id="alg2.l4.m2.1.1.11.cmml" xref="alg2.l4.m2.1.1.11">𝑡</ci><ci id="alg2.l4.m2.1.1.12.cmml" xref="alg2.l4.m2.1.1.12">𝑎</ci><ci id="alg2.l4.m2.1.1.13.cmml" xref="alg2.l4.m2.1.1.13">𝑆</ci><ci id="alg2.l4.m2.1.1.14.cmml" xref="alg2.l4.m2.1.1.14">𝑒</ci><ci id="alg2.l4.m2.1.1.15.cmml" xref="alg2.l4.m2.1.1.15">𝑡</ci><ci id="alg2.l4.m2.1.1.16.cmml" xref="alg2.l4.m2.1.1.16">𝑇</ci><ci id="alg2.l4.m2.1.1.17.cmml" xref="alg2.l4.m2.1.1.17">𝑜</ci><ci id="alg2.l4.m2.1.1.18.cmml" xref="alg2.l4.m2.1.1.18">𝐹</ci><ci id="alg2.l4.m2.1.1.19.cmml" xref="alg2.l4.m2.1.1.19">𝑖</ci><ci id="alg2.l4.m2.1.1.20.cmml" xref="alg2.l4.m2.1.1.20">𝑙</ci><ci id="alg2.l4.m2.1.1.21.cmml" xref="alg2.l4.m2.1.1.21">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">ConvertDataSetToFile</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.1d">italic_C italic_o italic_n italic_v italic_e italic_r italic_t italic_D italic_a italic_t italic_a italic_S italic_e italic_t italic_T italic_o italic_F italic_i italic_l italic_e</annotation></semantics></math>(<math alttext="DataSet" class="ltx_Math" display="inline" id="alg2.l4.m3.1"><semantics id="alg2.l4.m3.1a"><mrow id="alg2.l4.m3.1.1" xref="alg2.l4.m3.1.1.cmml"><mi id="alg2.l4.m3.1.1.2" xref="alg2.l4.m3.1.1.2.cmml">D</mi><mo id="alg2.l4.m3.1.1.1" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.3" xref="alg2.l4.m3.1.1.3.cmml">a</mi><mo id="alg2.l4.m3.1.1.1a" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.4" xref="alg2.l4.m3.1.1.4.cmml">t</mi><mo id="alg2.l4.m3.1.1.1b" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.5" xref="alg2.l4.m3.1.1.5.cmml">a</mi><mo id="alg2.l4.m3.1.1.1c" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.6" xref="alg2.l4.m3.1.1.6.cmml">S</mi><mo id="alg2.l4.m3.1.1.1d" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.7" xref="alg2.l4.m3.1.1.7.cmml">e</mi><mo id="alg2.l4.m3.1.1.1e" xref="alg2.l4.m3.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m3.1.1.8" xref="alg2.l4.m3.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m3.1b"><apply id="alg2.l4.m3.1.1.cmml" xref="alg2.l4.m3.1.1"><times id="alg2.l4.m3.1.1.1.cmml" xref="alg2.l4.m3.1.1.1"></times><ci id="alg2.l4.m3.1.1.2.cmml" xref="alg2.l4.m3.1.1.2">𝐷</ci><ci id="alg2.l4.m3.1.1.3.cmml" xref="alg2.l4.m3.1.1.3">𝑎</ci><ci id="alg2.l4.m3.1.1.4.cmml" xref="alg2.l4.m3.1.1.4">𝑡</ci><ci id="alg2.l4.m3.1.1.5.cmml" xref="alg2.l4.m3.1.1.5">𝑎</ci><ci id="alg2.l4.m3.1.1.6.cmml" xref="alg2.l4.m3.1.1.6">𝑆</ci><ci id="alg2.l4.m3.1.1.7.cmml" xref="alg2.l4.m3.1.1.7">𝑒</ci><ci id="alg2.l4.m3.1.1.8.cmml" xref="alg2.l4.m3.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m3.1c">DataSet</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m3.1d">italic_D italic_a italic_t italic_a italic_S italic_e italic_t</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">caligraphic_D</annotation></semantics></math> [ ]

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="anomalies" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">a</mi><mo id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">n</mi><mo id="alg2.l6.m1.1.1.1a" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.4" xref="alg2.l6.m1.1.1.4.cmml">o</mi><mo id="alg2.l6.m1.1.1.1b" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.5" xref="alg2.l6.m1.1.1.5.cmml">m</mi><mo id="alg2.l6.m1.1.1.1c" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.6" xref="alg2.l6.m1.1.1.6.cmml">a</mi><mo id="alg2.l6.m1.1.1.1d" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.7" xref="alg2.l6.m1.1.1.7.cmml">l</mi><mo id="alg2.l6.m1.1.1.1e" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.8" xref="alg2.l6.m1.1.1.8.cmml">i</mi><mo id="alg2.l6.m1.1.1.1f" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.9" xref="alg2.l6.m1.1.1.9.cmml">e</mi><mo id="alg2.l6.m1.1.1.1g" xref="alg2.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.10" xref="alg2.l6.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><times id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1"></times><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝑎</ci><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">𝑛</ci><ci id="alg2.l6.m1.1.1.4.cmml" xref="alg2.l6.m1.1.1.4">𝑜</ci><ci id="alg2.l6.m1.1.1.5.cmml" xref="alg2.l6.m1.1.1.5">𝑚</ci><ci id="alg2.l6.m1.1.1.6.cmml" xref="alg2.l6.m1.1.1.6">𝑎</ci><ci id="alg2.l6.m1.1.1.7.cmml" xref="alg2.l6.m1.1.1.7">𝑙</ci><ci id="alg2.l6.m1.1.1.8.cmml" xref="alg2.l6.m1.1.1.8">𝑖</ci><ci id="alg2.l6.m1.1.1.9.cmml" xref="alg2.l6.m1.1.1.9">𝑒</ci><ci id="alg2.l6.m1.1.1.10.cmml" xref="alg2.l6.m1.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">anomalies</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_i italic_e italic_s</annotation></semantics></math> [ ]

</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>     <math alttext="anomaly" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">a</mi><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">n</mi><mo id="alg2.l7.m1.1.1.1a" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.4" xref="alg2.l7.m1.1.1.4.cmml">o</mi><mo id="alg2.l7.m1.1.1.1b" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.5" xref="alg2.l7.m1.1.1.5.cmml">m</mi><mo id="alg2.l7.m1.1.1.1c" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.6" xref="alg2.l7.m1.1.1.6.cmml">a</mi><mo id="alg2.l7.m1.1.1.1d" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.7" xref="alg2.l7.m1.1.1.7.cmml">l</mi><mo id="alg2.l7.m1.1.1.1e" xref="alg2.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l7.m1.1.1.8" xref="alg2.l7.m1.1.1.8.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><times id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></times><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">𝑎</ci><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝑛</ci><ci id="alg2.l7.m1.1.1.4.cmml" xref="alg2.l7.m1.1.1.4">𝑜</ci><ci id="alg2.l7.m1.1.1.5.cmml" xref="alg2.l7.m1.1.1.5">𝑚</ci><ci id="alg2.l7.m1.1.1.6.cmml" xref="alg2.l7.m1.1.1.6">𝑎</ci><ci id="alg2.l7.m1.1.1.7.cmml" xref="alg2.l7.m1.1.1.7">𝑙</ci><ci id="alg2.l7.m1.1.1.8.cmml" xref="alg2.l7.m1.1.1.8">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">anomaly</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_y</annotation></semantics></math> == False

</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>     <math alttext="rules" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">r</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">u</mi><mo id="alg2.l8.m1.1.1.1a" xref="alg2.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l8.m1.1.1.4" xref="alg2.l8.m1.1.1.4.cmml">l</mi><mo id="alg2.l8.m1.1.1.1b" xref="alg2.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l8.m1.1.1.5" xref="alg2.l8.m1.1.1.5.cmml">e</mi><mo id="alg2.l8.m1.1.1.1c" xref="alg2.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l8.m1.1.1.6" xref="alg2.l8.m1.1.1.6.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><times id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></times><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑟</ci><ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">𝑢</ci><ci id="alg2.l8.m1.1.1.4.cmml" xref="alg2.l8.m1.1.1.4">𝑙</ci><ci id="alg2.l8.m1.1.1.5.cmml" xref="alg2.l8.m1.1.1.5">𝑒</ci><ci id="alg2.l8.m1.1.1.6.cmml" xref="alg2.l8.m1.1.1.6">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">rules</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_r italic_u italic_l italic_e italic_s</annotation></semantics></math> = [
"type": "Set", "field": "Set", "value": "Set",
"type": "Set", "field": "Set", "value": "Set",
]

</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l9.2">for</span> <math alttext="event" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">e</mi><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">v</mi><mo id="alg2.l9.m1.1.1.1a" xref="alg2.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m1.1.1.4" xref="alg2.l9.m1.1.1.4.cmml">e</mi><mo id="alg2.l9.m1.1.1.1b" xref="alg2.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m1.1.1.5" xref="alg2.l9.m1.1.1.5.cmml">n</mi><mo id="alg2.l9.m1.1.1.1c" xref="alg2.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m1.1.1.6" xref="alg2.l9.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><times id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></times><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑒</ci><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑣</ci><ci id="alg2.l9.m1.1.1.4.cmml" xref="alg2.l9.m1.1.1.4">𝑒</ci><ci id="alg2.l9.m1.1.1.5.cmml" xref="alg2.l9.m1.1.1.5">𝑛</ci><ci id="alg2.l9.m1.1.1.6.cmml" xref="alg2.l9.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">event</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_e italic_v italic_e italic_n italic_t</annotation></semantics></math> in <math alttext="file" class="ltx_Math" display="inline" id="alg2.l9.m2.1"><semantics id="alg2.l9.m2.1a"><mrow id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mi id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2.cmml">f</mi><mo id="alg2.l9.m2.1.1.1" xref="alg2.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml">i</mi><mo id="alg2.l9.m2.1.1.1a" xref="alg2.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m2.1.1.4" xref="alg2.l9.m2.1.1.4.cmml">l</mi><mo id="alg2.l9.m2.1.1.1b" xref="alg2.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l9.m2.1.1.5" xref="alg2.l9.m2.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><times id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1.1"></times><ci id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2">𝑓</ci><ci id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3">𝑖</ci><ci id="alg2.l9.m2.1.1.4.cmml" xref="alg2.l9.m2.1.1.4">𝑙</ci><ci id="alg2.l9.m2.1.1.5.cmml" xref="alg2.l9.m2.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">file</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.1d">italic_f italic_i italic_l italic_e</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l9.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>         <span class="ltx_text ltx_font_bold" id="alg2.l10.2">for</span> <math alttext="rule" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">r</mi><mo id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">u</mi><mo id="alg2.l10.m1.1.1.1a" xref="alg2.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.1.1.4" xref="alg2.l10.m1.1.1.4.cmml">l</mi><mo id="alg2.l10.m1.1.1.1b" xref="alg2.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.1.1.5" xref="alg2.l10.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><times id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"></times><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝑟</ci><ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">𝑢</ci><ci id="alg2.l10.m1.1.1.4.cmml" xref="alg2.l10.m1.1.1.4">𝑙</ci><ci id="alg2.l10.m1.1.1.5.cmml" xref="alg2.l10.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">rule</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_r italic_u italic_l italic_e</annotation></semantics></math> in <math alttext="rules" class="ltx_Math" display="inline" id="alg2.l10.m2.1"><semantics id="alg2.l10.m2.1a"><mrow id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mi id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml">r</mi><mo id="alg2.l10.m2.1.1.1" xref="alg2.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m2.1.1.3" xref="alg2.l10.m2.1.1.3.cmml">u</mi><mo id="alg2.l10.m2.1.1.1a" xref="alg2.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m2.1.1.4" xref="alg2.l10.m2.1.1.4.cmml">l</mi><mo id="alg2.l10.m2.1.1.1b" xref="alg2.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m2.1.1.5" xref="alg2.l10.m2.1.1.5.cmml">e</mi><mo id="alg2.l10.m2.1.1.1c" xref="alg2.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m2.1.1.6" xref="alg2.l10.m2.1.1.6.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><times id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1.1"></times><ci id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2">𝑟</ci><ci id="alg2.l10.m2.1.1.3.cmml" xref="alg2.l10.m2.1.1.3">𝑢</ci><ci id="alg2.l10.m2.1.1.4.cmml" xref="alg2.l10.m2.1.1.4">𝑙</ci><ci id="alg2.l10.m2.1.1.5.cmml" xref="alg2.l10.m2.1.1.5">𝑒</ci><ci id="alg2.l10.m2.1.1.6.cmml" xref="alg2.l10.m2.1.1.6">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">rules</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m2.1d">italic_r italic_u italic_l italic_e italic_s</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l10.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>              <span class="ltx_text ltx_font_bold" id="alg2.l11.2">if</span>  <math alttext="rule" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">r</mi><mo id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml">u</mi><mo id="alg2.l11.m1.1.1.1a" xref="alg2.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.4" xref="alg2.l11.m1.1.1.4.cmml">l</mi><mo id="alg2.l11.m1.1.1.1b" xref="alg2.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.5" xref="alg2.l11.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><times id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1"></times><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">𝑟</ci><ci id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">𝑢</ci><ci id="alg2.l11.m1.1.1.4.cmml" xref="alg2.l11.m1.1.1.4">𝑙</ci><ci id="alg2.l11.m1.1.1.5.cmml" xref="alg2.l11.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">rule</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_r italic_u italic_l italic_e</annotation></semantics></math>[attribute] == <math alttext="event" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><mrow id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml">e</mi><mo id="alg2.l11.m2.1.1.1" xref="alg2.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m2.1.1.3" xref="alg2.l11.m2.1.1.3.cmml">v</mi><mo id="alg2.l11.m2.1.1.1a" xref="alg2.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m2.1.1.4" xref="alg2.l11.m2.1.1.4.cmml">e</mi><mo id="alg2.l11.m2.1.1.1b" xref="alg2.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m2.1.1.5" xref="alg2.l11.m2.1.1.5.cmml">n</mi><mo id="alg2.l11.m2.1.1.1c" xref="alg2.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l11.m2.1.1.6" xref="alg2.l11.m2.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><times id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1.1"></times><ci id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">𝑒</ci><ci id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3">𝑣</ci><ci id="alg2.l11.m2.1.1.4.cmml" xref="alg2.l11.m2.1.1.4">𝑒</ci><ci id="alg2.l11.m2.1.1.5.cmml" xref="alg2.l11.m2.1.1.5">𝑛</ci><ci id="alg2.l11.m2.1.1.6.cmml" xref="alg2.l11.m2.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">event</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">italic_e italic_v italic_e italic_n italic_t</annotation></semantics></math>[attribute] <span class="ltx_text ltx_font_bold" id="alg2.l11.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">12:</span></span>                  <math alttext="anomaly" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">a</mi><mo id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">n</mi><mo id="alg2.l12.m1.1.1.1a" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.4" xref="alg2.l12.m1.1.1.4.cmml">o</mi><mo id="alg2.l12.m1.1.1.1b" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.5" xref="alg2.l12.m1.1.1.5.cmml">m</mi><mo id="alg2.l12.m1.1.1.1c" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.6" xref="alg2.l12.m1.1.1.6.cmml">a</mi><mo id="alg2.l12.m1.1.1.1d" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.7" xref="alg2.l12.m1.1.1.7.cmml">l</mi><mo id="alg2.l12.m1.1.1.1e" xref="alg2.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.8" xref="alg2.l12.m1.1.1.8.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><times id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"></times><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">𝑎</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝑛</ci><ci id="alg2.l12.m1.1.1.4.cmml" xref="alg2.l12.m1.1.1.4">𝑜</ci><ci id="alg2.l12.m1.1.1.5.cmml" xref="alg2.l12.m1.1.1.5">𝑚</ci><ci id="alg2.l12.m1.1.1.6.cmml" xref="alg2.l12.m1.1.1.6">𝑎</ci><ci id="alg2.l12.m1.1.1.7.cmml" xref="alg2.l12.m1.1.1.7">𝑙</ci><ci id="alg2.l12.m1.1.1.8.cmml" xref="alg2.l12.m1.1.1.8">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">anomaly</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_y</annotation></semantics></math> == True

</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span>                  <math alttext="anomalies" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">a</mi><mo id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml">n</mi><mo id="alg2.l13.m1.1.1.1a" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.4" xref="alg2.l13.m1.1.1.4.cmml">o</mi><mo id="alg2.l13.m1.1.1.1b" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.5" xref="alg2.l13.m1.1.1.5.cmml">m</mi><mo id="alg2.l13.m1.1.1.1c" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.6" xref="alg2.l13.m1.1.1.6.cmml">a</mi><mo id="alg2.l13.m1.1.1.1d" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.7" xref="alg2.l13.m1.1.1.7.cmml">l</mi><mo id="alg2.l13.m1.1.1.1e" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.8" xref="alg2.l13.m1.1.1.8.cmml">i</mi><mo id="alg2.l13.m1.1.1.1f" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.9" xref="alg2.l13.m1.1.1.9.cmml">e</mi><mo id="alg2.l13.m1.1.1.1g" xref="alg2.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.1.10" xref="alg2.l13.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><times id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"></times><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">𝑎</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝑛</ci><ci id="alg2.l13.m1.1.1.4.cmml" xref="alg2.l13.m1.1.1.4">𝑜</ci><ci id="alg2.l13.m1.1.1.5.cmml" xref="alg2.l13.m1.1.1.5">𝑚</ci><ci id="alg2.l13.m1.1.1.6.cmml" xref="alg2.l13.m1.1.1.6">𝑎</ci><ci id="alg2.l13.m1.1.1.7.cmml" xref="alg2.l13.m1.1.1.7">𝑙</ci><ci id="alg2.l13.m1.1.1.8.cmml" xref="alg2.l13.m1.1.1.8">𝑖</ci><ci id="alg2.l13.m1.1.1.9.cmml" xref="alg2.l13.m1.1.1.9">𝑒</ci><ci id="alg2.l13.m1.1.1.10.cmml" xref="alg2.l13.m1.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">anomalies</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_i italic_e italic_s</annotation></semantics></math>.append(<math alttext="event" class="ltx_Math" display="inline" id="alg2.l13.m2.1"><semantics id="alg2.l13.m2.1a"><mrow id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><mi id="alg2.l13.m2.1.1.2" xref="alg2.l13.m2.1.1.2.cmml">e</mi><mo id="alg2.l13.m2.1.1.1" xref="alg2.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3.cmml">v</mi><mo id="alg2.l13.m2.1.1.1a" xref="alg2.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m2.1.1.4" xref="alg2.l13.m2.1.1.4.cmml">e</mi><mo id="alg2.l13.m2.1.1.1b" xref="alg2.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m2.1.1.5" xref="alg2.l13.m2.1.1.5.cmml">n</mi><mo id="alg2.l13.m2.1.1.1c" xref="alg2.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l13.m2.1.1.6" xref="alg2.l13.m2.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><times id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1.1"></times><ci id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1.2">𝑒</ci><ci id="alg2.l13.m2.1.1.3.cmml" xref="alg2.l13.m2.1.1.3">𝑣</ci><ci id="alg2.l13.m2.1.1.4.cmml" xref="alg2.l13.m2.1.1.4">𝑒</ci><ci id="alg2.l13.m2.1.1.5.cmml" xref="alg2.l13.m2.1.1.5">𝑛</ci><ci id="alg2.l13.m2.1.1.6.cmml" xref="alg2.l13.m2.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">event</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m2.1d">italic_e italic_v italic_e italic_n italic_t</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span>              <span class="ltx_text ltx_font_bold" id="alg2.l14.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l14.3">if</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">15:</span></span>         <span class="ltx_text ltx_font_bold" id="alg2.l15.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l15.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l16.1.1.1" style="font-size:80%;">16:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l16.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l16.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l17.1.1.1" style="font-size:80%;">17:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l17.2">for</span>  <math alttext="anomaly" class="ltx_Math" display="inline" id="alg2.l17.m1.1"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><mi id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml">a</mi><mo id="alg2.l17.m1.1.1.1" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml">n</mi><mo id="alg2.l17.m1.1.1.1a" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.4" xref="alg2.l17.m1.1.1.4.cmml">o</mi><mo id="alg2.l17.m1.1.1.1b" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.5" xref="alg2.l17.m1.1.1.5.cmml">m</mi><mo id="alg2.l17.m1.1.1.1c" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.6" xref="alg2.l17.m1.1.1.6.cmml">a</mi><mo id="alg2.l17.m1.1.1.1d" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.7" xref="alg2.l17.m1.1.1.7.cmml">l</mi><mo id="alg2.l17.m1.1.1.1e" xref="alg2.l17.m1.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m1.1.1.8" xref="alg2.l17.m1.1.1.8.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><times id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1"></times><ci id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2">𝑎</ci><ci id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3">𝑛</ci><ci id="alg2.l17.m1.1.1.4.cmml" xref="alg2.l17.m1.1.1.4">𝑜</ci><ci id="alg2.l17.m1.1.1.5.cmml" xref="alg2.l17.m1.1.1.5">𝑚</ci><ci id="alg2.l17.m1.1.1.6.cmml" xref="alg2.l17.m1.1.1.6">𝑎</ci><ci id="alg2.l17.m1.1.1.7.cmml" xref="alg2.l17.m1.1.1.7">𝑙</ci><ci id="alg2.l17.m1.1.1.8.cmml" xref="alg2.l17.m1.1.1.8">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">anomaly</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m1.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_y</annotation></semantics></math> in <math alttext="anomalies" class="ltx_Math" display="inline" id="alg2.l17.m2.1"><semantics id="alg2.l17.m2.1a"><mrow id="alg2.l17.m2.1.1" xref="alg2.l17.m2.1.1.cmml"><mi id="alg2.l17.m2.1.1.2" xref="alg2.l17.m2.1.1.2.cmml">a</mi><mo id="alg2.l17.m2.1.1.1" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.3" xref="alg2.l17.m2.1.1.3.cmml">n</mi><mo id="alg2.l17.m2.1.1.1a" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.4" xref="alg2.l17.m2.1.1.4.cmml">o</mi><mo id="alg2.l17.m2.1.1.1b" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.5" xref="alg2.l17.m2.1.1.5.cmml">m</mi><mo id="alg2.l17.m2.1.1.1c" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.6" xref="alg2.l17.m2.1.1.6.cmml">a</mi><mo id="alg2.l17.m2.1.1.1d" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.7" xref="alg2.l17.m2.1.1.7.cmml">l</mi><mo id="alg2.l17.m2.1.1.1e" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.8" xref="alg2.l17.m2.1.1.8.cmml">i</mi><mo id="alg2.l17.m2.1.1.1f" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.9" xref="alg2.l17.m2.1.1.9.cmml">e</mi><mo id="alg2.l17.m2.1.1.1g" xref="alg2.l17.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l17.m2.1.1.10" xref="alg2.l17.m2.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m2.1b"><apply id="alg2.l17.m2.1.1.cmml" xref="alg2.l17.m2.1.1"><times id="alg2.l17.m2.1.1.1.cmml" xref="alg2.l17.m2.1.1.1"></times><ci id="alg2.l17.m2.1.1.2.cmml" xref="alg2.l17.m2.1.1.2">𝑎</ci><ci id="alg2.l17.m2.1.1.3.cmml" xref="alg2.l17.m2.1.1.3">𝑛</ci><ci id="alg2.l17.m2.1.1.4.cmml" xref="alg2.l17.m2.1.1.4">𝑜</ci><ci id="alg2.l17.m2.1.1.5.cmml" xref="alg2.l17.m2.1.1.5">𝑚</ci><ci id="alg2.l17.m2.1.1.6.cmml" xref="alg2.l17.m2.1.1.6">𝑎</ci><ci id="alg2.l17.m2.1.1.7.cmml" xref="alg2.l17.m2.1.1.7">𝑙</ci><ci id="alg2.l17.m2.1.1.8.cmml" xref="alg2.l17.m2.1.1.8">𝑖</ci><ci id="alg2.l17.m2.1.1.9.cmml" xref="alg2.l17.m2.1.1.9">𝑒</ci><ci id="alg2.l17.m2.1.1.10.cmml" xref="alg2.l17.m2.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m2.1c">anomalies</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m2.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_i italic_e italic_s</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l17.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l18.1.1.1" style="font-size:80%;">18:</span></span>         <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l18.m1.1"><semantics id="alg2.l18.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><ci id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.1d">caligraphic_D</annotation></semantics></math>.append(<math alttext="anomaly" class="ltx_Math" display="inline" id="alg2.l18.m2.1"><semantics id="alg2.l18.m2.1a"><mrow id="alg2.l18.m2.1.1" xref="alg2.l18.m2.1.1.cmml"><mi id="alg2.l18.m2.1.1.2" xref="alg2.l18.m2.1.1.2.cmml">a</mi><mo id="alg2.l18.m2.1.1.1" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.3" xref="alg2.l18.m2.1.1.3.cmml">n</mi><mo id="alg2.l18.m2.1.1.1a" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.4" xref="alg2.l18.m2.1.1.4.cmml">o</mi><mo id="alg2.l18.m2.1.1.1b" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.5" xref="alg2.l18.m2.1.1.5.cmml">m</mi><mo id="alg2.l18.m2.1.1.1c" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.6" xref="alg2.l18.m2.1.1.6.cmml">a</mi><mo id="alg2.l18.m2.1.1.1d" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.7" xref="alg2.l18.m2.1.1.7.cmml">l</mi><mo id="alg2.l18.m2.1.1.1e" xref="alg2.l18.m2.1.1.1.cmml">⁢</mo><mi id="alg2.l18.m2.1.1.8" xref="alg2.l18.m2.1.1.8.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m2.1b"><apply id="alg2.l18.m2.1.1.cmml" xref="alg2.l18.m2.1.1"><times id="alg2.l18.m2.1.1.1.cmml" xref="alg2.l18.m2.1.1.1"></times><ci id="alg2.l18.m2.1.1.2.cmml" xref="alg2.l18.m2.1.1.2">𝑎</ci><ci id="alg2.l18.m2.1.1.3.cmml" xref="alg2.l18.m2.1.1.3">𝑛</ci><ci id="alg2.l18.m2.1.1.4.cmml" xref="alg2.l18.m2.1.1.4">𝑜</ci><ci id="alg2.l18.m2.1.1.5.cmml" xref="alg2.l18.m2.1.1.5">𝑚</ci><ci id="alg2.l18.m2.1.1.6.cmml" xref="alg2.l18.m2.1.1.6">𝑎</ci><ci id="alg2.l18.m2.1.1.7.cmml" xref="alg2.l18.m2.1.1.7">𝑙</ci><ci id="alg2.l18.m2.1.1.8.cmml" xref="alg2.l18.m2.1.1.8">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m2.1c">anomaly</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m2.1d">italic_a italic_n italic_o italic_m italic_a italic_l italic_y</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l19.1.1.1" style="font-size:80%;">19:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l19.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l19.3">for</span>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l20.1.1.1" style="font-size:80%;">20:</span></span>     <span class="ltx_text ltx_font_bold" id="alg2.l20.2">return</span> <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l20.m1.1"><semantics id="alg2.l20.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><ci id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l20.m1.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l21.1.1.1" style="font-size:80%;">21:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l21.2">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l21.3">function</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">One of the primary functions of GenDFIR is anomaly detection. To filter and select only relevant data and minimize the amount collected, we use Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg2" title="Algorithm 2 ‣ IV-B Rule-Based AI for Anomaly Detection ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>. As illustrated in the process, it is crucial to establish precise and stringent rules tailored to the specific incident context. These rules are designed to counteract standard policies, guidelines, norms, or any regulations that deviate from legal and usual practices. From the initial textual <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.1">File</span> (raw DF report), these rules are applied to the events contained within it. If an anomaly is detected, the event is selected and recorded in a new, separate, final textual forensic document <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.2">D</span>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">However, according to the definition of R-BAI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib12" title="">12</a>]</cite>, this algorithm cannot perform contextual filtering of the data, necessitating further filtering and anomaly detection by the LLM.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Incident Events Chunking</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Chunking is the process of segmenting large texts into smaller, manageable parts. When using RAG in conjunction with LLMs, chunking is crucial for effective information retrieval from an external knowledge base. The precision and effectiveness of this process largely depend on the chosen segmentation method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib53" title="">53</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Several approaches have proven reliable for chunking:</p>
<ul class="ltx_itemize" id="S4.I5">
<li class="ltx_item" id="S4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i1.p1">
<p class="ltx_p" id="S4.I5.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i1.p1.1.1">Token-Based:</span> Divides text based on a fixed number of tokens.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i2.p1">
<p class="ltx_p" id="S4.I5.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i2.p1.1.1">Paragraph-Based:</span> Segments text by paragraphs to maintain context.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i3.p1">
<p class="ltx_p" id="S4.I5.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i3.p1.1.1">Semantic:</span> Groups text based on meaning or topics.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i4.p1">
<p class="ltx_p" id="S4.I5.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i4.p1.1.1">Sentence-Based:</span> Segments text into sentences, each of which may have unique semantics.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.4">For our framework and within the scope of DFIR, we employ multiple approaches to achieve high precision and accuracy:</p>
<ul class="ltx_itemize" id="S4.I6">
<li class="ltx_item" id="S4.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i1.p1">
<p class="ltx_p" id="S4.I6.i1.p1.1">We structure the final textual forensic document <math alttext="D" class="ltx_Math" display="inline" id="S4.I6.i1.p1.1.m1.1"><semantics id="S4.I6.i1.p1.1.m1.1a"><mi id="S4.I6.i1.p1.1.m1.1.1" xref="S4.I6.i1.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.I6.i1.p1.1.m1.1b"><ci id="S4.I6.i1.p1.1.m1.1.1.cmml" xref="S4.I6.i1.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I6.i1.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.I6.i1.p1.1.m1.1d">italic_D</annotation></semantics></math> (containing filtered events) by splitting it into event-based segments.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i2.p1">
<p class="ltx_p" id="S4.I6.i2.p1.1">Events are dynamically grouped into chunks without exceeding the maximum allowed chunk length.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i3.p1">
<p class="ltx_p" id="S4.I6.i3.p1.1">We define the "Maximum Length of a Chunk" as the maximum number of characters, words, or tokens allowed per chunk.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS3.p3.5">An approximate calculation of chunks can be presented as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{CTM}\approx 512\text{ TM}\times 4\text{ C}\approx 2000" class="ltx_Math" display="block" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mtext id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2a.cmml">CTM</mtext><mo id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml">≈</mo><mrow id="S4.E1.m1.1.1.4" xref="S4.E1.m1.1.1.4.cmml"><mrow id="S4.E1.m1.1.1.4.2" xref="S4.E1.m1.1.1.4.2.cmml"><mrow id="S4.E1.m1.1.1.4.2.2" xref="S4.E1.m1.1.1.4.2.2.cmml"><mn id="S4.E1.m1.1.1.4.2.2.2" xref="S4.E1.m1.1.1.4.2.2.2.cmml">512</mn><mo id="S4.E1.m1.1.1.4.2.2.1" xref="S4.E1.m1.1.1.4.2.2.1.cmml">⁢</mo><mtext id="S4.E1.m1.1.1.4.2.2.3" xref="S4.E1.m1.1.1.4.2.2.3a.cmml"> TM</mtext></mrow><mo id="S4.E1.m1.1.1.4.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.1.1.4.2.1.cmml">×</mo><mn id="S4.E1.m1.1.1.4.2.3" xref="S4.E1.m1.1.1.4.2.3.cmml">4</mn></mrow><mo id="S4.E1.m1.1.1.4.1" xref="S4.E1.m1.1.1.4.1.cmml">⁢</mo><mtext id="S4.E1.m1.1.1.4.3" xref="S4.E1.m1.1.1.4.3a.cmml"> C</mtext></mrow><mo id="S4.E1.m1.1.1.5" xref="S4.E1.m1.1.1.5.cmml">≈</mo><mn id="S4.E1.m1.1.1.6" xref="S4.E1.m1.1.1.6.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><and id="S4.E1.m1.1.1a.cmml" xref="S4.E1.m1.1.1"></and><apply id="S4.E1.m1.1.1b.cmml" xref="S4.E1.m1.1.1"><approx id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"></approx><ci id="S4.E1.m1.1.1.2a.cmml" xref="S4.E1.m1.1.1.2"><mtext id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2">CTM</mtext></ci><apply id="S4.E1.m1.1.1.4.cmml" xref="S4.E1.m1.1.1.4"><times id="S4.E1.m1.1.1.4.1.cmml" xref="S4.E1.m1.1.1.4.1"></times><apply id="S4.E1.m1.1.1.4.2.cmml" xref="S4.E1.m1.1.1.4.2"><times id="S4.E1.m1.1.1.4.2.1.cmml" xref="S4.E1.m1.1.1.4.2.1"></times><apply id="S4.E1.m1.1.1.4.2.2.cmml" xref="S4.E1.m1.1.1.4.2.2"><times id="S4.E1.m1.1.1.4.2.2.1.cmml" xref="S4.E1.m1.1.1.4.2.2.1"></times><cn id="S4.E1.m1.1.1.4.2.2.2.cmml" type="integer" xref="S4.E1.m1.1.1.4.2.2.2">512</cn><ci id="S4.E1.m1.1.1.4.2.2.3a.cmml" xref="S4.E1.m1.1.1.4.2.2.3"><mtext id="S4.E1.m1.1.1.4.2.2.3.cmml" xref="S4.E1.m1.1.1.4.2.2.3"> TM</mtext></ci></apply><cn id="S4.E1.m1.1.1.4.2.3.cmml" type="integer" xref="S4.E1.m1.1.1.4.2.3">4</cn></apply><ci id="S4.E1.m1.1.1.4.3a.cmml" xref="S4.E1.m1.1.1.4.3"><mtext id="S4.E1.m1.1.1.4.3.cmml" xref="S4.E1.m1.1.1.4.3"> C</mtext></ci></apply></apply><apply id="S4.E1.m1.1.1c.cmml" xref="S4.E1.m1.1.1"><approx id="S4.E1.m1.1.1.5.cmml" xref="S4.E1.m1.1.1.5"></approx><share href="https://arxiv.org/html/2409.02572v3#S4.E1.m1.1.1.4.cmml" id="S4.E1.m1.1.1d.cmml" xref="S4.E1.m1.1.1"></share><cn id="S4.E1.m1.1.1.6.cmml" type="integer" xref="S4.E1.m1.1.1.6">2000</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\text{CTM}\approx 512\text{ TM}\times 4\text{ C}\approx 2000</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">CTM ≈ 512 TM × 4 C ≈ 2000</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p3.3">Assuming that each English word is approximately 4 to 6 characters (<math alttext="C" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_C</annotation></semantics></math>) long. By taking 4 characters as the average length for each word and considering the model’s maximum tokens (<math alttext="TM" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><times id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></times><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑇</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">TM</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_T italic_M</annotation></semantics></math>) of 512, the maximum number of characters the model can accurately embed per chunk is about 2000 characters (<math alttext="CTM" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">C</mi><mo id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">T</mi><mo id="S4.SS3.p3.3.m3.1.1.1a" xref="S4.SS3.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p3.3.m3.1.1.4" xref="S4.SS3.p3.3.m3.1.1.4.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><times id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"></times><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝐶</ci><ci id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3">𝑇</ci><ci id="S4.SS3.p3.3.m3.1.1.4.cmml" xref="S4.SS3.p3.3.m3.1.1.4">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">CTM</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_C italic_T italic_M</annotation></semantics></math>) (<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E1" title="In IV-C Incident Events Chunking ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">Additionally, in the context of TA, which requires embedding every single character for more precise semantics, we adopt the following chunking method:</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST1">
<div class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="LST1.1" style="background-color:#F2F2EB;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ICBldmVudHMgPSBQVC5zcGxpdCgnLycpICAjIChvciAoJy4nKSkgU3BsaXQgdGhlIGRvY3VtZW50IGludG8gZXZlbnRzCiAgY2h1bmtzID0gW10KICBDdXJyZW50Q2h1bmsgPSAiIgogIE1heExlbmd0aCA9IDIwOCAgIyBTZXQgdGhlIG1heGltdW0gbGVuZ3RoIG1hbnVhbGx5CgogZm9yIGFuIGV2ZW50IGluIGV2ZW50czoKICAgICMgQ2hlY2sgaWYgYWRkaW5nIHRoZSBldmVudCB3b3VsZCBleGNlZWQgdGhlIG1heGltdW0gbGVuZ3RoCiAgICBpZiBsZW4oQ3VycmVudENodW5rKSArIGxlbihldmVudCkgPD0gTWF4TGVuZ3RoOgogICAgICAgIEN1cnJlbnRDaHVuayA9IChDdXJyZW50Q2h1bmsgKyAiICIgKyBldmVudCkgICMgQWRkIGV2ZW50IHRvIGN1cnJlbnQgY2h1bmsKICAgIGVsc2U6CiAgICAgICAgIyBJZiB0aGUgY2h1bmsgZG9lc24ndCByZWFjaCBNYXhMZW5ndGgsIHBhZCBhbmQgc3RvcmUgaXQKICAgICAgICBjaHVua3MuYXBwZW5kKEN1cnJlbnRDaHVuay5sanVzdChNYXhMZW5ndGgpKSAgIyBQYWRzIHdpdGggc3BhY2VzIHRvIE1heExlbmd0aAogICAgICAgIEN1cnJlbnRDaHVuayA9IGV2ZW50ICAjIFN0YXJ0IGEgbmV3IGNodW5rIHdpdGggdGhlIGN1cnJlbnQgZXZlbnQ=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.2" style="font-size:80%;">events</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.6" style="font-size:80%;">PT</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.8" style="font-size:80%;">split</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx1.10" style="font-size:80%;color:#9400D1;">’/’</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.11" style="font-size:80%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.12" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx1.13" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.1"> </span>(or<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.2"> </span>(’.’))<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.3"> </span>Split<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.4"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.5"> </span>document<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.6"> </span>into<span class="ltx_text ltx_lst_space" id="lstnumberx1.13.7"> </span>events</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.2" style="font-size:80%;">chunks</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.6" style="font-size:80%;">[]</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.2" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx3.6" style="font-size:80%;color:#9400D1;">""</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.2" style="font-size:80%;">MaxLength</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.6" style="font-size:80%;">208</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx4.8" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx4.8.1"> </span>Set<span class="ltx_text ltx_lst_space" id="lstnumberx4.8.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx4.8.3"> </span>maximum<span class="ltx_text ltx_lst_space" id="lstnumberx4.8.4"> </span>length<span class="ltx_text ltx_lst_space" id="lstnumberx4.8.5"> </span>manually</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx6.2" style="font-size:80%;color:#FF00FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.4" style="font-size:80%;">an</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.6" style="font-size:80%;">event</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx6.8" style="font-size:80%;color:#FF00FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.10" style="font-size:80%;">events</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.11" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx7.2" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.1"> </span>Check<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.2"> </span>if<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.3"> </span>adding<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.4"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.5"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.6"> </span>would<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.7"> </span>exceed<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.8"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.9"> </span>maximum<span class="ltx_text ltx_lst_space" id="lstnumberx7.2.10"> </span>length</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx8.2" style="font-size:80%;color:#FF00FF;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx8.4" style="font-size:80%;color:#FF00FF;">len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.5" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.6" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.7" style="font-size:80%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.9" style="font-size:80%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter" id="lstnumberx8.11" style="font-size:80%;color:#FF00FF;">len</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.12" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.13" style="font-size:80%;">event</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.14" style="font-size:80%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.15" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.16" style="font-size:80%;">&lt;=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.17" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.18" style="font-size:80%;">MaxLength</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.19" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.2" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.7" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.9" style="font-size:80%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx9.11" style="font-size:80%;color:#9400D1;">"<span class="ltx_text ltx_lst_space" id="lstnumberx9.11.1"> </span>"</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.12" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.13" style="font-size:80%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.14" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.15" style="font-size:80%;">event</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.16" style="font-size:80%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.17" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx9.18" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx9.18.1"> </span>Add<span class="ltx_text ltx_lst_space" id="lstnumberx9.18.2"> </span>event<span class="ltx_text ltx_lst_space" id="lstnumberx9.18.3"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx9.18.4"> </span>current<span class="ltx_text ltx_lst_space" id="lstnumberx9.18.5"> </span>chunk</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter" id="lstnumberx10.2" style="font-size:80%;color:#FF00FF;">else</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.3" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx11.2" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.1"> </span>If<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.2"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.3"> </span>chunk<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.4"> </span>doesn’t<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.5"> </span>reach<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.6"> </span>MaxLength,<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.7"> </span>pad<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.8"> </span>and<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.9"> </span>store<span class="ltx_text ltx_lst_space" id="lstnumberx11.2.10"> </span>it</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2" style="font-size:80%;">chunks</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.3" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.4" style="font-size:80%;">append</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.5" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.8" style="font-size:80%;">ljust</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.10" style="font-size:80%;">MaxLength</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.11" style="font-size:80%;">))</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.12" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx12.13" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx12.13.1"> </span>Pads<span class="ltx_text ltx_lst_space" id="lstnumberx12.13.2"> </span>with<span class="ltx_text ltx_lst_space" id="lstnumberx12.13.3"> </span>spaces<span class="ltx_text ltx_lst_space" id="lstnumberx12.13.4"> </span>to<span class="ltx_text ltx_lst_space" id="lstnumberx12.13.5"> </span>MaxLength</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2" style="font-size:80%;">CurrentChunk</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6" style="font-size:80%;">event</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter" id="lstnumberx13.8" style="font-size:80%;color:#009900;">#<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.1"> </span>Start<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.2"> </span>a<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.3"> </span>new<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.4"> </span>chunk<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.5"> </span>with<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.6"> </span>the<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.7"> </span>current<span class="ltx_text ltx_lst_space" id="lstnumberx13.8.8"> </span>event</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#F2F2EB;"><span class="ltx_tag ltx_tag_float">Listing 1: </span>Chunking code snippet</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p5">
<ul class="ltx_itemize" id="S4.I7">
<li class="ltx_item" id="S4.I7.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I7.i1.p1">
<p class="ltx_p" id="S4.I7.i1.p1.2">Each event is treated as a chunk, with a maximum defined length of characters <math alttext="M" class="ltx_Math" display="inline" id="S4.I7.i1.p1.1.m1.1"><semantics id="S4.I7.i1.p1.1.m1.1a"><mi id="S4.I7.i1.p1.1.m1.1.1" xref="S4.I7.i1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.I7.i1.p1.1.m1.1b"><ci id="S4.I7.i1.p1.1.m1.1.1.cmml" xref="S4.I7.i1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i1.p1.1.m1.1d">italic_M</annotation></semantics></math>. An event includes all its attributes, such as ID, Description, Content, Level, Time, Date, etc. The maximum number of characters in an event can be increased up to <math alttext="CTM" class="ltx_Math" display="inline" id="S4.I7.i1.p1.2.m2.1"><semantics id="S4.I7.i1.p1.2.m2.1a"><mrow id="S4.I7.i1.p1.2.m2.1.1" xref="S4.I7.i1.p1.2.m2.1.1.cmml"><mi id="S4.I7.i1.p1.2.m2.1.1.2" xref="S4.I7.i1.p1.2.m2.1.1.2.cmml">C</mi><mo id="S4.I7.i1.p1.2.m2.1.1.1" xref="S4.I7.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I7.i1.p1.2.m2.1.1.3" xref="S4.I7.i1.p1.2.m2.1.1.3.cmml">T</mi><mo id="S4.I7.i1.p1.2.m2.1.1.1a" xref="S4.I7.i1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I7.i1.p1.2.m2.1.1.4" xref="S4.I7.i1.p1.2.m2.1.1.4.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I7.i1.p1.2.m2.1b"><apply id="S4.I7.i1.p1.2.m2.1.1.cmml" xref="S4.I7.i1.p1.2.m2.1.1"><times id="S4.I7.i1.p1.2.m2.1.1.1.cmml" xref="S4.I7.i1.p1.2.m2.1.1.1"></times><ci id="S4.I7.i1.p1.2.m2.1.1.2.cmml" xref="S4.I7.i1.p1.2.m2.1.1.2">𝐶</ci><ci id="S4.I7.i1.p1.2.m2.1.1.3.cmml" xref="S4.I7.i1.p1.2.m2.1.1.3">𝑇</ci><ci id="S4.I7.i1.p1.2.m2.1.1.4.cmml" xref="S4.I7.i1.p1.2.m2.1.1.4">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i1.p1.2.m2.1c">CTM</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i1.p1.2.m2.1d">italic_C italic_T italic_M</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I7.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I7.i2.p1">
<p class="ltx_p" id="S4.I7.i2.p1.1">An event should contain only one (".") or ("/") to ensure more accurate semantic understanding and to avoid mixing events.</p>
</div>
</li>
<li class="ltx_item" id="S4.I7.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I7.i3.p1">
<p class="ltx_p" id="S4.I7.i3.p1.1">If an event does not meet the required maximum number of characters, padding is applied to reach the desired length.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.1">Based on the above considerations:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Incident Document}=\left\{\begin{aligned} &amp;\sum_{i=1}^{n}\text{Chunk}_{i%
},\\
&amp;\text{where}\quad\text{Chunk}_{i}=\text{Event}_{i},\\
&amp;\text{and}\quad\text{Event}_{i}=\sum_{j=1}^{m_{i}}\text{Character}_{ij},\\
&amp;\text{with}\quad m_{i}=M_{i}\end{aligned}\right." class="ltx_math_unparsed" display="block" id="S4.E2.m1.7"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7b"><mtext id="S4.E2.m1.7.8">Incident Document</mtext><mo id="S4.E2.m1.7.9">=</mo><mrow id="S4.E2.m1.7.10"><mo id="S4.E2.m1.7.10.1">{</mo><mtable columnspacing="0pt" displaystyle="true" id="S4.E2.m1.7.7" rowspacing="0pt"><mtr id="S4.E2.m1.7.7a"><mtd id="S4.E2.m1.7.7b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.7.7c"><mrow id="S4.E2.m1.1.1.1.1.1.1"><mrow id="S4.E2.m1.1.1.1.1.1.1.1"><munderover id="S4.E2.m1.1.1.1.1.1.1.1.1"><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2" movablelimits="false">∑</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2">i</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1">=</mo><mn id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3">1</mn></mrow><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3">n</mi></munderover><msub id="S4.E2.m1.1.1.1.1.1.1.1.2"><mtext id="S4.E2.m1.1.1.1.1.1.1.1.2.2">Chunk</mtext><mi id="S4.E2.m1.1.1.1.1.1.1.1.2.3">i</mi></msub></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.2">,</mo></mrow></mtd></mtr><mtr id="S4.E2.m1.7.7d"><mtd id="S4.E2.m1.7.7e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.7.7f"><mrow id="S4.E2.m1.3.3.3.2.2.2"><mrow id="S4.E2.m1.3.3.3.2.2.2.1"><mrow id="S4.E2.m1.3.3.3.2.2.2.1.1.1"><mtext id="S4.E2.m1.2.2.2.1.1.1">where</mtext><mspace id="S4.E2.m1.3.3.3.2.2.2.1.1.1.2" width="1em"></mspace><msub id="S4.E2.m1.3.3.3.2.2.2.1.1.1.1"><mtext id="S4.E2.m1.3.3.3.2.2.2.1.1.1.1.2">Chunk</mtext><mi id="S4.E2.m1.3.3.3.2.2.2.1.1.1.1.3">i</mi></msub></mrow><mo id="S4.E2.m1.3.3.3.2.2.2.1.2">=</mo><msub id="S4.E2.m1.3.3.3.2.2.2.1.3"><mtext id="S4.E2.m1.3.3.3.2.2.2.1.3.2">Event</mtext><mi id="S4.E2.m1.3.3.3.2.2.2.1.3.3">i</mi></msub></mrow><mo id="S4.E2.m1.3.3.3.2.2.2.2">,</mo></mrow></mtd></mtr><mtr id="S4.E2.m1.7.7g"><mtd id="S4.E2.m1.7.7h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.7.7i"><mrow id="S4.E2.m1.5.5.5.2.2.2"><mrow id="S4.E2.m1.5.5.5.2.2.2.1"><mrow id="S4.E2.m1.5.5.5.2.2.2.1.1.1"><mtext id="S4.E2.m1.4.4.4.1.1.1">and</mtext><mspace id="S4.E2.m1.5.5.5.2.2.2.1.1.1.2" width="1em"></mspace><msub id="S4.E2.m1.5.5.5.2.2.2.1.1.1.1"><mtext id="S4.E2.m1.5.5.5.2.2.2.1.1.1.1.2">Event</mtext><mi id="S4.E2.m1.5.5.5.2.2.2.1.1.1.1.3">i</mi></msub></mrow><mo id="S4.E2.m1.5.5.5.2.2.2.1.2" rspace="0.111em">=</mo><mrow id="S4.E2.m1.5.5.5.2.2.2.1.3"><munderover id="S4.E2.m1.5.5.5.2.2.2.1.3.1"><mo id="S4.E2.m1.5.5.5.2.2.2.1.3.1.2.2" movablelimits="false">∑</mo><mrow id="S4.E2.m1.5.5.5.2.2.2.1.3.1.2.3"><mi id="S4.E2.m1.5.5.5.2.2.2.1.3.1.2.3.2">j</mi><mo id="S4.E2.m1.5.5.5.2.2.2.1.3.1.2.3.1">=</mo><mn id="S4.E2.m1.5.5.5.2.2.2.1.3.1.2.3.3">1</mn></mrow><msub id="S4.E2.m1.5.5.5.2.2.2.1.3.1.3"><mi id="S4.E2.m1.5.5.5.2.2.2.1.3.1.3.2">m</mi><mi id="S4.E2.m1.5.5.5.2.2.2.1.3.1.3.3">i</mi></msub></munderover><msub id="S4.E2.m1.5.5.5.2.2.2.1.3.2"><mtext id="S4.E2.m1.5.5.5.2.2.2.1.3.2.2">Character</mtext><mrow id="S4.E2.m1.5.5.5.2.2.2.1.3.2.3"><mi id="S4.E2.m1.5.5.5.2.2.2.1.3.2.3.2">i</mi><mo id="S4.E2.m1.5.5.5.2.2.2.1.3.2.3.1">⁢</mo><mi id="S4.E2.m1.5.5.5.2.2.2.1.3.2.3.3">j</mi></mrow></msub></mrow></mrow><mo id="S4.E2.m1.5.5.5.2.2.2.2">,</mo></mrow></mtd></mtr><mtr id="S4.E2.m1.7.7j"><mtd id="S4.E2.m1.7.7k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.7.7l"><mrow id="S4.E2.m1.7.7.7.2.2"><mrow id="S4.E2.m1.7.7.7.2.2.2.1"><mtext id="S4.E2.m1.6.6.6.1.1.1">with</mtext><mspace id="S4.E2.m1.7.7.7.2.2.2.1.2" width="1em"></mspace><msub id="S4.E2.m1.7.7.7.2.2.2.1.1"><mi id="S4.E2.m1.7.7.7.2.2.2.1.1.2">m</mi><mi id="S4.E2.m1.7.7.7.2.2.2.1.1.3">i</mi></msub></mrow><mo id="S4.E2.m1.7.7.7.2.2.3">=</mo><msub id="S4.E2.m1.7.7.7.2.2.4"><mi id="S4.E2.m1.7.7.7.2.2.4.2">M</mi><mi id="S4.E2.m1.7.7.7.2.2.4.3">i</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\text{Incident Document}=\left\{\begin{aligned} &amp;\sum_{i=1}^{n}\text{Chunk}_{i%
},\\
&amp;\text{where}\quad\text{Chunk}_{i}=\text{Event}_{i},\\
&amp;\text{and}\quad\text{Event}_{i}=\sum_{j=1}^{m_{i}}\text{Character}_{ij},\\
&amp;\text{with}\quad m_{i}=M_{i}\end{aligned}\right.</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.7d">Incident Document = { start_ROW start_CELL end_CELL start_CELL ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT Chunk start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL where Chunk start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Event start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL and Event start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT Character start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL with italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<ul class="ltx_itemize" id="S4.I8">
<li class="ltx_item" id="S4.I8.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I8.i1.p1">
<p class="ltx_p" id="S4.I8.i1.p1.2">Where <math alttext="i" class="ltx_Math" display="inline" id="S4.I8.i1.p1.1.m1.1"><semantics id="S4.I8.i1.p1.1.m1.1a"><mi id="S4.I8.i1.p1.1.m1.1.1" xref="S4.I8.i1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i1.p1.1.m1.1b"><ci id="S4.I8.i1.p1.1.m1.1.1.cmml" xref="S4.I8.i1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i1.p1.1.m1.1d">italic_i</annotation></semantics></math> ranging from 1 to <math alttext="n" class="ltx_Math" display="inline" id="S4.I8.i1.p1.2.m2.1"><semantics id="S4.I8.i1.p1.2.m2.1a"><mi id="S4.I8.i1.p1.2.m2.1.1" xref="S4.I8.i1.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i1.p1.2.m2.1b"><ci id="S4.I8.i1.p1.2.m2.1.1.cmml" xref="S4.I8.i1.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i1.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i1.p1.2.m2.1d">italic_n</annotation></semantics></math>, is the number of chunks.</p>
</div>
</li>
<li class="ltx_item" id="S4.I8.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I8.i2.p1">
<p class="ltx_p" id="S4.I8.i2.p1.3"><math alttext="j" class="ltx_Math" display="inline" id="S4.I8.i2.p1.1.m1.1"><semantics id="S4.I8.i2.p1.1.m1.1a"><mi id="S4.I8.i2.p1.1.m1.1.1" xref="S4.I8.i2.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i2.p1.1.m1.1b"><ci id="S4.I8.i2.p1.1.m1.1.1.cmml" xref="S4.I8.i2.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i2.p1.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i2.p1.1.m1.1d">italic_j</annotation></semantics></math> ranging from 1 to <math alttext="m_{i}" class="ltx_Math" display="inline" id="S4.I8.i2.p1.2.m2.1"><semantics id="S4.I8.i2.p1.2.m2.1a"><msub id="S4.I8.i2.p1.2.m2.1.1" xref="S4.I8.i2.p1.2.m2.1.1.cmml"><mi id="S4.I8.i2.p1.2.m2.1.1.2" xref="S4.I8.i2.p1.2.m2.1.1.2.cmml">m</mi><mi id="S4.I8.i2.p1.2.m2.1.1.3" xref="S4.I8.i2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I8.i2.p1.2.m2.1b"><apply id="S4.I8.i2.p1.2.m2.1.1.cmml" xref="S4.I8.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I8.i2.p1.2.m2.1.1.1.cmml" xref="S4.I8.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I8.i2.p1.2.m2.1.1.2.cmml" xref="S4.I8.i2.p1.2.m2.1.1.2">𝑚</ci><ci id="S4.I8.i2.p1.2.m2.1.1.3.cmml" xref="S4.I8.i2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i2.p1.2.m2.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i2.p1.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the number of characters in Event <math alttext="i" class="ltx_Math" display="inline" id="S4.I8.i2.p1.3.m3.1"><semantics id="S4.I8.i2.p1.3.m3.1a"><mi id="S4.I8.i2.p1.3.m3.1.1" xref="S4.I8.i2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.I8.i2.p1.3.m3.1b"><ci id="S4.I8.i2.p1.3.m3.1.1.cmml" xref="S4.I8.i2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I8.i2.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.I8.i2.p1.3.m3.1d">italic_i</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p7">
<p class="ltx_p" id="S4.SS3.p7.1">This method has the potential to achieve a high level of precision during TA. However, it is crucial to consider the computational hardware requirements, such as GPU and CPU capacities. Embedding a small number of events often results in a large number of tokens. Managing these tokens and performing the associated vector transformations can lead to increased processing times and higher energy consumption, particularly when handling large documents or datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">Incident Events Embedding</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">The purpose of processing text in chunks is to embed it using the mxbai-embed-large embedding model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">The embedding process is as follows:</p>
<ul class="ltx_itemize" id="S4.I9">
<li class="ltx_item" id="S4.I9.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I9.i1.p1">
<p class="ltx_p" id="S4.I9.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I9.i1.p1.1.1">Tokenization:</span> Words within an event (chunk) of incident-processed text <span class="ltx_text ltx_font_italic" id="S4.I9.i1.p1.1.2">PT</span> is first tokenized, meaning each word or character is converted into a token (unit).</p>
</div>
</li>
<li class="ltx_item" id="S4.I9.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I9.i2.p1">
<p class="ltx_p" id="S4.I9.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I9.i2.p1.1.1">Mapping to Numerical Representations:</span> These tokens are then mapped to numerical representations, with each token being assigned a unique numerical value that encapsulates its semantic meaning.</p>
</div>
</li>
<li class="ltx_item" id="S4.I9.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I9.i3.p1">
<p class="ltx_p" id="S4.I9.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I9.i3.p1.1.1">Further Processing:</span> Additional layer transformations and processing are applied to the resulting vectors to capture the semantics of the tokens.</p>
</div>
</li>
<li class="ltx_item" id="S4.I9.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I9.i4.p1">
<p class="ltx_p" id="S4.I9.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I9.i4.p1.1.1">Output:</span> A dense vector <span class="ltx_text ltx_font_italic" id="S4.I9.i4.p1.1.2">ED</span> is produced, consisting of a list of numbers where each number represents a feature of the chunked text <span class="ltx_text ltx_font_italic" id="S4.I9.i4.p1.1.3">PT</span>.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.2.1.1">Algorithm 3</span> </span> Embed Preprocessed Text</figcaption>
<div class="ltx_listing ltx_listing" id="alg3.3">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l1.1.1.1" style="font-size:80%;">1:</span></span>Preprocessed Text <math alttext="PT" class="ltx_Math" display="inline" id="alg3.l1.m1.1"><semantics id="alg3.l1.m1.1a"><mrow id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><mi id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">P</mi><mo id="alg3.l1.m1.1.1.1" xref="alg3.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><times id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1"></times><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">𝑃</ci><ci id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.1d">italic_P italic_T</annotation></semantics></math> , Embedding Model <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg3.l1.m2.1"><semantics id="alg3.l1.m2.1a"><mrow id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml"><mi id="alg3.l1.m2.1.1.2" xref="alg3.l1.m2.1.1.2.cmml">E</mi><mo id="alg3.l1.m2.1.1.1" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.3" xref="alg3.l1.m2.1.1.3.cmml">m</mi><mo id="alg3.l1.m2.1.1.1a" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.4" xref="alg3.l1.m2.1.1.4.cmml">b</mi><mo id="alg3.l1.m2.1.1.1b" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.5" xref="alg3.l1.m2.1.1.5.cmml">e</mi><mo id="alg3.l1.m2.1.1.1c" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.6" xref="alg3.l1.m2.1.1.6.cmml">d</mi><mo id="alg3.l1.m2.1.1.1d" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.7" xref="alg3.l1.m2.1.1.7.cmml">M</mi><mo id="alg3.l1.m2.1.1.1e" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.8" xref="alg3.l1.m2.1.1.8.cmml">o</mi><mo id="alg3.l1.m2.1.1.1f" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.9" xref="alg3.l1.m2.1.1.9.cmml">d</mi><mo id="alg3.l1.m2.1.1.1g" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.10" xref="alg3.l1.m2.1.1.10.cmml">e</mi><mo id="alg3.l1.m2.1.1.1h" xref="alg3.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l1.m2.1.1.11" xref="alg3.l1.m2.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1"><times id="alg3.l1.m2.1.1.1.cmml" xref="alg3.l1.m2.1.1.1"></times><ci id="alg3.l1.m2.1.1.2.cmml" xref="alg3.l1.m2.1.1.2">𝐸</ci><ci id="alg3.l1.m2.1.1.3.cmml" xref="alg3.l1.m2.1.1.3">𝑚</ci><ci id="alg3.l1.m2.1.1.4.cmml" xref="alg3.l1.m2.1.1.4">𝑏</ci><ci id="alg3.l1.m2.1.1.5.cmml" xref="alg3.l1.m2.1.1.5">𝑒</ci><ci id="alg3.l1.m2.1.1.6.cmml" xref="alg3.l1.m2.1.1.6">𝑑</ci><ci id="alg3.l1.m2.1.1.7.cmml" xref="alg3.l1.m2.1.1.7">𝑀</ci><ci id="alg3.l1.m2.1.1.8.cmml" xref="alg3.l1.m2.1.1.8">𝑜</ci><ci id="alg3.l1.m2.1.1.9.cmml" xref="alg3.l1.m2.1.1.9">𝑑</ci><ci id="alg3.l1.m2.1.1.10.cmml" xref="alg3.l1.m2.1.1.10">𝑒</ci><ci id="alg3.l1.m2.1.1.11.cmml" xref="alg3.l1.m2.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m2.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l2.1.1.1" style="font-size:80%;">2:</span></span>Embed Preprocessed Text <math alttext="ED" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mi id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml">E</mi><mo id="alg3.l2.m1.1.1.1" xref="alg3.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><times id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1"></times><ci id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2">𝐸</ci><ci id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">italic_E italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l3.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg3.l3.3">Embed</span>( <math alttext="{PT}" class="ltx_Math" display="inline" id="alg3.l3.m1.1"><semantics id="alg3.l3.m1.1a"><mrow id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml"><mi id="alg3.l3.m1.1.1.2" xref="alg3.l3.m1.1.1.2.cmml">P</mi><mo id="alg3.l3.m1.1.1.1" xref="alg3.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.3" xref="alg3.l3.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><apply id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1"><times id="alg3.l3.m1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1"></times><ci id="alg3.l3.m1.1.1.2.cmml" xref="alg3.l3.m1.1.1.2">𝑃</ci><ci id="alg3.l3.m1.1.1.3.cmml" xref="alg3.l3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">{PT}</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.1d">italic_P italic_T</annotation></semantics></math>, <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg3.l3.m2.1"><semantics id="alg3.l3.m2.1a"><mrow id="alg3.l3.m2.1.1" xref="alg3.l3.m2.1.1.cmml"><mi id="alg3.l3.m2.1.1.2" xref="alg3.l3.m2.1.1.2.cmml">E</mi><mo id="alg3.l3.m2.1.1.1" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.3" xref="alg3.l3.m2.1.1.3.cmml">m</mi><mo id="alg3.l3.m2.1.1.1a" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.4" xref="alg3.l3.m2.1.1.4.cmml">b</mi><mo id="alg3.l3.m2.1.1.1b" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.5" xref="alg3.l3.m2.1.1.5.cmml">e</mi><mo id="alg3.l3.m2.1.1.1c" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.6" xref="alg3.l3.m2.1.1.6.cmml">d</mi><mo id="alg3.l3.m2.1.1.1d" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.7" xref="alg3.l3.m2.1.1.7.cmml">M</mi><mo id="alg3.l3.m2.1.1.1e" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.8" xref="alg3.l3.m2.1.1.8.cmml">o</mi><mo id="alg3.l3.m2.1.1.1f" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.9" xref="alg3.l3.m2.1.1.9.cmml">d</mi><mo id="alg3.l3.m2.1.1.1g" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.10" xref="alg3.l3.m2.1.1.10.cmml">e</mi><mo id="alg3.l3.m2.1.1.1h" xref="alg3.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l3.m2.1.1.11" xref="alg3.l3.m2.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m2.1b"><apply id="alg3.l3.m2.1.1.cmml" xref="alg3.l3.m2.1.1"><times id="alg3.l3.m2.1.1.1.cmml" xref="alg3.l3.m2.1.1.1"></times><ci id="alg3.l3.m2.1.1.2.cmml" xref="alg3.l3.m2.1.1.2">𝐸</ci><ci id="alg3.l3.m2.1.1.3.cmml" xref="alg3.l3.m2.1.1.3">𝑚</ci><ci id="alg3.l3.m2.1.1.4.cmml" xref="alg3.l3.m2.1.1.4">𝑏</ci><ci id="alg3.l3.m2.1.1.5.cmml" xref="alg3.l3.m2.1.1.5">𝑒</ci><ci id="alg3.l3.m2.1.1.6.cmml" xref="alg3.l3.m2.1.1.6">𝑑</ci><ci id="alg3.l3.m2.1.1.7.cmml" xref="alg3.l3.m2.1.1.7">𝑀</ci><ci id="alg3.l3.m2.1.1.8.cmml" xref="alg3.l3.m2.1.1.8">𝑜</ci><ci id="alg3.l3.m2.1.1.9.cmml" xref="alg3.l3.m2.1.1.9">𝑑</ci><ci id="alg3.l3.m2.1.1.10.cmml" xref="alg3.l3.m2.1.1.10">𝑒</ci><ci id="alg3.l3.m2.1.1.11.cmml" xref="alg3.l3.m2.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m2.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m2.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l4.1.1.1" style="font-size:80%;">4:</span></span>     Load Preprocessed Text <math alttext="{PT}" class="ltx_Math" display="inline" id="alg3.l4.m1.1"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><mi id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml">P</mi><mo id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><times id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1"></times><ci id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2">𝑃</ci><ci id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">{PT}</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.1d">italic_P italic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg3.l5.m1.1"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><mi id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml">E</mi><mo id="alg3.l5.m1.1.1.1" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml">m</mi><mo id="alg3.l5.m1.1.1.1a" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.4" xref="alg3.l5.m1.1.1.4.cmml">b</mi><mo id="alg3.l5.m1.1.1.1b" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.5" xref="alg3.l5.m1.1.1.5.cmml">e</mi><mo id="alg3.l5.m1.1.1.1c" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.6" xref="alg3.l5.m1.1.1.6.cmml">d</mi><mo id="alg3.l5.m1.1.1.1d" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.7" xref="alg3.l5.m1.1.1.7.cmml">M</mi><mo id="alg3.l5.m1.1.1.1e" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.8" xref="alg3.l5.m1.1.1.8.cmml">o</mi><mo id="alg3.l5.m1.1.1.1f" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.9" xref="alg3.l5.m1.1.1.9.cmml">d</mi><mo id="alg3.l5.m1.1.1.1g" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.10" xref="alg3.l5.m1.1.1.10.cmml">e</mi><mo id="alg3.l5.m1.1.1.1h" xref="alg3.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.11" xref="alg3.l5.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><times id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1"></times><ci id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2">𝐸</ci><ci id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3">𝑚</ci><ci id="alg3.l5.m1.1.1.4.cmml" xref="alg3.l5.m1.1.1.4">𝑏</ci><ci id="alg3.l5.m1.1.1.5.cmml" xref="alg3.l5.m1.1.1.5">𝑒</ci><ci id="alg3.l5.m1.1.1.6.cmml" xref="alg3.l5.m1.1.1.6">𝑑</ci><ci id="alg3.l5.m1.1.1.7.cmml" xref="alg3.l5.m1.1.1.7">𝑀</ci><ci id="alg3.l5.m1.1.1.8.cmml" xref="alg3.l5.m1.1.1.8">𝑜</ci><ci id="alg3.l5.m1.1.1.9.cmml" xref="alg3.l5.m1.1.1.9">𝑑</ci><ci id="alg3.l5.m1.1.1.10.cmml" xref="alg3.l5.m1.1.1.10">𝑒</ci><ci id="alg3.l5.m1.1.1.11.cmml" xref="alg3.l5.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math> = ’mxbai-embed-large’

</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l6.1.1.1" style="font-size:80%;">6:</span></span>     <span class="ltx_text ltx_font_bold" id="alg3.l6.2">for</span>  <math alttext="content" class="ltx_Math" display="inline" id="alg3.l6.m1.1"><semantics id="alg3.l6.m1.1a"><mrow id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><mi id="alg3.l6.m1.1.1.2" xref="alg3.l6.m1.1.1.2.cmml">c</mi><mo id="alg3.l6.m1.1.1.1" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.3" xref="alg3.l6.m1.1.1.3.cmml">o</mi><mo id="alg3.l6.m1.1.1.1a" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.4" xref="alg3.l6.m1.1.1.4.cmml">n</mi><mo id="alg3.l6.m1.1.1.1b" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.5" xref="alg3.l6.m1.1.1.5.cmml">t</mi><mo id="alg3.l6.m1.1.1.1c" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.6" xref="alg3.l6.m1.1.1.6.cmml">e</mi><mo id="alg3.l6.m1.1.1.1d" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.7" xref="alg3.l6.m1.1.1.7.cmml">n</mi><mo id="alg3.l6.m1.1.1.1e" xref="alg3.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m1.1.1.8" xref="alg3.l6.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><times id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1"></times><ci id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1.2">𝑐</ci><ci id="alg3.l6.m1.1.1.3.cmml" xref="alg3.l6.m1.1.1.3">𝑜</ci><ci id="alg3.l6.m1.1.1.4.cmml" xref="alg3.l6.m1.1.1.4">𝑛</ci><ci id="alg3.l6.m1.1.1.5.cmml" xref="alg3.l6.m1.1.1.5">𝑡</ci><ci id="alg3.l6.m1.1.1.6.cmml" xref="alg3.l6.m1.1.1.6">𝑒</ci><ci id="alg3.l6.m1.1.1.7.cmml" xref="alg3.l6.m1.1.1.7">𝑛</ci><ci id="alg3.l6.m1.1.1.8.cmml" xref="alg3.l6.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">content</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m1.1d">italic_c italic_o italic_n italic_t italic_e italic_n italic_t</annotation></semantics></math> in <math alttext="PT" class="ltx_Math" display="inline" id="alg3.l6.m2.1"><semantics id="alg3.l6.m2.1a"><mrow id="alg3.l6.m2.1.1" xref="alg3.l6.m2.1.1.cmml"><mi id="alg3.l6.m2.1.1.2" xref="alg3.l6.m2.1.1.2.cmml">P</mi><mo id="alg3.l6.m2.1.1.1" xref="alg3.l6.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l6.m2.1.1.3" xref="alg3.l6.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m2.1b"><apply id="alg3.l6.m2.1.1.cmml" xref="alg3.l6.m2.1.1"><times id="alg3.l6.m2.1.1.1.cmml" xref="alg3.l6.m2.1.1.1"></times><ci id="alg3.l6.m2.1.1.2.cmml" xref="alg3.l6.m2.1.1.2">𝑃</ci><ci id="alg3.l6.m2.1.1.3.cmml" xref="alg3.l6.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m2.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m2.1d">italic_P italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l6.3">do</span>
</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l7.1.1.1" style="font-size:80%;">7:</span></span>         <math alttext="ED" class="ltx_Math" display="inline" id="alg3.l7.m1.1"><semantics id="alg3.l7.m1.1a"><mrow id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml"><mi id="alg3.l7.m1.1.1.2" xref="alg3.l7.m1.1.1.2.cmml">E</mi><mo id="alg3.l7.m1.1.1.1" xref="alg3.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.3" xref="alg3.l7.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><apply id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1"><times id="alg3.l7.m1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1"></times><ci id="alg3.l7.m1.1.1.2.cmml" xref="alg3.l7.m1.1.1.2">𝐸</ci><ci id="alg3.l7.m1.1.1.3.cmml" xref="alg3.l7.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m1.1d">italic_E italic_D</annotation></semantics></math> = embeddings (<math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg3.l7.m2.1"><semantics id="alg3.l7.m2.1a"><mrow id="alg3.l7.m2.1.1" xref="alg3.l7.m2.1.1.cmml"><mi id="alg3.l7.m2.1.1.2" xref="alg3.l7.m2.1.1.2.cmml">E</mi><mo id="alg3.l7.m2.1.1.1" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.3" xref="alg3.l7.m2.1.1.3.cmml">m</mi><mo id="alg3.l7.m2.1.1.1a" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.4" xref="alg3.l7.m2.1.1.4.cmml">b</mi><mo id="alg3.l7.m2.1.1.1b" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.5" xref="alg3.l7.m2.1.1.5.cmml">e</mi><mo id="alg3.l7.m2.1.1.1c" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.6" xref="alg3.l7.m2.1.1.6.cmml">d</mi><mo id="alg3.l7.m2.1.1.1d" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.7" xref="alg3.l7.m2.1.1.7.cmml">M</mi><mo id="alg3.l7.m2.1.1.1e" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.8" xref="alg3.l7.m2.1.1.8.cmml">o</mi><mo id="alg3.l7.m2.1.1.1f" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.9" xref="alg3.l7.m2.1.1.9.cmml">d</mi><mo id="alg3.l7.m2.1.1.1g" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.10" xref="alg3.l7.m2.1.1.10.cmml">e</mi><mo id="alg3.l7.m2.1.1.1h" xref="alg3.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m2.1.1.11" xref="alg3.l7.m2.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m2.1b"><apply id="alg3.l7.m2.1.1.cmml" xref="alg3.l7.m2.1.1"><times id="alg3.l7.m2.1.1.1.cmml" xref="alg3.l7.m2.1.1.1"></times><ci id="alg3.l7.m2.1.1.2.cmml" xref="alg3.l7.m2.1.1.2">𝐸</ci><ci id="alg3.l7.m2.1.1.3.cmml" xref="alg3.l7.m2.1.1.3">𝑚</ci><ci id="alg3.l7.m2.1.1.4.cmml" xref="alg3.l7.m2.1.1.4">𝑏</ci><ci id="alg3.l7.m2.1.1.5.cmml" xref="alg3.l7.m2.1.1.5">𝑒</ci><ci id="alg3.l7.m2.1.1.6.cmml" xref="alg3.l7.m2.1.1.6">𝑑</ci><ci id="alg3.l7.m2.1.1.7.cmml" xref="alg3.l7.m2.1.1.7">𝑀</ci><ci id="alg3.l7.m2.1.1.8.cmml" xref="alg3.l7.m2.1.1.8">𝑜</ci><ci id="alg3.l7.m2.1.1.9.cmml" xref="alg3.l7.m2.1.1.9">𝑑</ci><ci id="alg3.l7.m2.1.1.10.cmml" xref="alg3.l7.m2.1.1.10">𝑒</ci><ci id="alg3.l7.m2.1.1.11.cmml" xref="alg3.l7.m2.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m2.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m2.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math> , <math alttext="content" class="ltx_Math" display="inline" id="alg3.l7.m3.1"><semantics id="alg3.l7.m3.1a"><mrow id="alg3.l7.m3.1.1" xref="alg3.l7.m3.1.1.cmml"><mi id="alg3.l7.m3.1.1.2" xref="alg3.l7.m3.1.1.2.cmml">c</mi><mo id="alg3.l7.m3.1.1.1" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.3" xref="alg3.l7.m3.1.1.3.cmml">o</mi><mo id="alg3.l7.m3.1.1.1a" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.4" xref="alg3.l7.m3.1.1.4.cmml">n</mi><mo id="alg3.l7.m3.1.1.1b" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.5" xref="alg3.l7.m3.1.1.5.cmml">t</mi><mo id="alg3.l7.m3.1.1.1c" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.6" xref="alg3.l7.m3.1.1.6.cmml">e</mi><mo id="alg3.l7.m3.1.1.1d" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.7" xref="alg3.l7.m3.1.1.7.cmml">n</mi><mo id="alg3.l7.m3.1.1.1e" xref="alg3.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg3.l7.m3.1.1.8" xref="alg3.l7.m3.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m3.1b"><apply id="alg3.l7.m3.1.1.cmml" xref="alg3.l7.m3.1.1"><times id="alg3.l7.m3.1.1.1.cmml" xref="alg3.l7.m3.1.1.1"></times><ci id="alg3.l7.m3.1.1.2.cmml" xref="alg3.l7.m3.1.1.2">𝑐</ci><ci id="alg3.l7.m3.1.1.3.cmml" xref="alg3.l7.m3.1.1.3">𝑜</ci><ci id="alg3.l7.m3.1.1.4.cmml" xref="alg3.l7.m3.1.1.4">𝑛</ci><ci id="alg3.l7.m3.1.1.5.cmml" xref="alg3.l7.m3.1.1.5">𝑡</ci><ci id="alg3.l7.m3.1.1.6.cmml" xref="alg3.l7.m3.1.1.6">𝑒</ci><ci id="alg3.l7.m3.1.1.7.cmml" xref="alg3.l7.m3.1.1.7">𝑛</ci><ci id="alg3.l7.m3.1.1.8.cmml" xref="alg3.l7.m3.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m3.1c">content</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m3.1d">italic_c italic_o italic_n italic_t italic_e italic_n italic_t</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l8.1.1.1" style="font-size:80%;">8:</span></span>     <span class="ltx_text ltx_font_bold" id="alg3.l8.2">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l8.3">for</span>
</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l9.1.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg3.l9.2">return</span> <math alttext="ED" class="ltx_Math" display="inline" id="alg3.l9.m1.1"><semantics id="alg3.l9.m1.1a"><mrow id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml"><mi id="alg3.l9.m1.1.1.2" xref="alg3.l9.m1.1.1.2.cmml">E</mi><mo id="alg3.l9.m1.1.1.1" xref="alg3.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.3" xref="alg3.l9.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><apply id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1"><times id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1"></times><ci id="alg3.l9.m1.1.1.2.cmml" xref="alg3.l9.m1.1.1.2">𝐸</ci><ci id="alg3.l9.m1.1.1.3.cmml" xref="alg3.l9.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.m1.1d">italic_E italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text ltx_font_bold" id="alg3.l10.2">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l10.3">function</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS5.5.1.1">IV-E</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS5.6.2">DFIR Retrieval-Augmented Generation (RAG) Agent</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">This phase operates in two subphases: Retrieval and Generation.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">Our DFIR RAG agent is powered by the Llama-3.1 LLM, initialized with a prompt that defines its task, role, and content.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.7"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.7.1">Generation:</span> In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg4" title="Algorithm 4 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, refining the query <math alttext="UI" class="ltx_Math" display="inline" id="S4.SS5.p3.1.m1.1"><semantics id="S4.SS5.p3.1.m1.1a"><mrow id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml"><mi id="S4.SS5.p3.1.m1.1.1.2" xref="S4.SS5.p3.1.m1.1.1.2.cmml">U</mi><mo id="S4.SS5.p3.1.m1.1.1.1" xref="S4.SS5.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.1.m1.1.1.3" xref="S4.SS5.p3.1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1"><times id="S4.SS5.p3.1.m1.1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1.1"></times><ci id="S4.SS5.p3.1.m1.1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2">𝑈</ci><ci id="S4.SS5.p3.1.m1.1.1.3.cmml" xref="S4.SS5.p3.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">UI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.1.m1.1d">italic_U italic_I</annotation></semantics></math> or modifying it into a more context-based <math alttext="RI" class="ltx_Math" display="inline" id="S4.SS5.p3.2.m2.1"><semantics id="S4.SS5.p3.2.m2.1a"><mrow id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml"><mi id="S4.SS5.p3.2.m2.1.1.2" xref="S4.SS5.p3.2.m2.1.1.2.cmml">R</mi><mo id="S4.SS5.p3.2.m2.1.1.1" xref="S4.SS5.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.2.m2.1.1.3" xref="S4.SS5.p3.2.m2.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><apply id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1"><times id="S4.SS5.p3.2.m2.1.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1.1"></times><ci id="S4.SS5.p3.2.m2.1.1.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2">𝑅</ci><ci id="S4.SS5.p3.2.m2.1.1.3.cmml" xref="S4.SS5.p3.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">RI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.2.m2.1d">italic_R italic_I</annotation></semantics></math> is performed by the <math alttext="Agent" class="ltx_Math" display="inline" id="S4.SS5.p3.3.m3.1"><semantics id="S4.SS5.p3.3.m3.1a"><mrow id="S4.SS5.p3.3.m3.1.1" xref="S4.SS5.p3.3.m3.1.1.cmml"><mi id="S4.SS5.p3.3.m3.1.1.2" xref="S4.SS5.p3.3.m3.1.1.2.cmml">A</mi><mo id="S4.SS5.p3.3.m3.1.1.1" xref="S4.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.3.m3.1.1.3" xref="S4.SS5.p3.3.m3.1.1.3.cmml">g</mi><mo id="S4.SS5.p3.3.m3.1.1.1a" xref="S4.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.3.m3.1.1.4" xref="S4.SS5.p3.3.m3.1.1.4.cmml">e</mi><mo id="S4.SS5.p3.3.m3.1.1.1b" xref="S4.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.3.m3.1.1.5" xref="S4.SS5.p3.3.m3.1.1.5.cmml">n</mi><mo id="S4.SS5.p3.3.m3.1.1.1c" xref="S4.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.3.m3.1.1.6" xref="S4.SS5.p3.3.m3.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.3.m3.1b"><apply id="S4.SS5.p3.3.m3.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1"><times id="S4.SS5.p3.3.m3.1.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1.1"></times><ci id="S4.SS5.p3.3.m3.1.1.2.cmml" xref="S4.SS5.p3.3.m3.1.1.2">𝐴</ci><ci id="S4.SS5.p3.3.m3.1.1.3.cmml" xref="S4.SS5.p3.3.m3.1.1.3">𝑔</ci><ci id="S4.SS5.p3.3.m3.1.1.4.cmml" xref="S4.SS5.p3.3.m3.1.1.4">𝑒</ci><ci id="S4.SS5.p3.3.m3.1.1.5.cmml" xref="S4.SS5.p3.3.m3.1.1.5">𝑛</ci><ci id="S4.SS5.p3.3.m3.1.1.6.cmml" xref="S4.SS5.p3.3.m3.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.3.m3.1c">Agent</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.3.m3.1d">italic_A italic_g italic_e italic_n italic_t</annotation></semantics></math> according to the crafted prompt <math alttext="AgentPrompt" class="ltx_Math" display="inline" id="S4.SS5.p3.4.m4.1"><semantics id="S4.SS5.p3.4.m4.1a"><mrow id="S4.SS5.p3.4.m4.1.1" xref="S4.SS5.p3.4.m4.1.1.cmml"><mi id="S4.SS5.p3.4.m4.1.1.2" xref="S4.SS5.p3.4.m4.1.1.2.cmml">A</mi><mo id="S4.SS5.p3.4.m4.1.1.1" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.3" xref="S4.SS5.p3.4.m4.1.1.3.cmml">g</mi><mo id="S4.SS5.p3.4.m4.1.1.1a" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.4" xref="S4.SS5.p3.4.m4.1.1.4.cmml">e</mi><mo id="S4.SS5.p3.4.m4.1.1.1b" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.5" xref="S4.SS5.p3.4.m4.1.1.5.cmml">n</mi><mo id="S4.SS5.p3.4.m4.1.1.1c" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.6" xref="S4.SS5.p3.4.m4.1.1.6.cmml">t</mi><mo id="S4.SS5.p3.4.m4.1.1.1d" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.7" xref="S4.SS5.p3.4.m4.1.1.7.cmml">P</mi><mo id="S4.SS5.p3.4.m4.1.1.1e" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.8" xref="S4.SS5.p3.4.m4.1.1.8.cmml">r</mi><mo id="S4.SS5.p3.4.m4.1.1.1f" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.9" xref="S4.SS5.p3.4.m4.1.1.9.cmml">o</mi><mo id="S4.SS5.p3.4.m4.1.1.1g" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.10" xref="S4.SS5.p3.4.m4.1.1.10.cmml">m</mi><mo id="S4.SS5.p3.4.m4.1.1.1h" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.11" xref="S4.SS5.p3.4.m4.1.1.11.cmml">p</mi><mo id="S4.SS5.p3.4.m4.1.1.1i" xref="S4.SS5.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.4.m4.1.1.12" xref="S4.SS5.p3.4.m4.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.4.m4.1b"><apply id="S4.SS5.p3.4.m4.1.1.cmml" xref="S4.SS5.p3.4.m4.1.1"><times id="S4.SS5.p3.4.m4.1.1.1.cmml" xref="S4.SS5.p3.4.m4.1.1.1"></times><ci id="S4.SS5.p3.4.m4.1.1.2.cmml" xref="S4.SS5.p3.4.m4.1.1.2">𝐴</ci><ci id="S4.SS5.p3.4.m4.1.1.3.cmml" xref="S4.SS5.p3.4.m4.1.1.3">𝑔</ci><ci id="S4.SS5.p3.4.m4.1.1.4.cmml" xref="S4.SS5.p3.4.m4.1.1.4">𝑒</ci><ci id="S4.SS5.p3.4.m4.1.1.5.cmml" xref="S4.SS5.p3.4.m4.1.1.5">𝑛</ci><ci id="S4.SS5.p3.4.m4.1.1.6.cmml" xref="S4.SS5.p3.4.m4.1.1.6">𝑡</ci><ci id="S4.SS5.p3.4.m4.1.1.7.cmml" xref="S4.SS5.p3.4.m4.1.1.7">𝑃</ci><ci id="S4.SS5.p3.4.m4.1.1.8.cmml" xref="S4.SS5.p3.4.m4.1.1.8">𝑟</ci><ci id="S4.SS5.p3.4.m4.1.1.9.cmml" xref="S4.SS5.p3.4.m4.1.1.9">𝑜</ci><ci id="S4.SS5.p3.4.m4.1.1.10.cmml" xref="S4.SS5.p3.4.m4.1.1.10">𝑚</ci><ci id="S4.SS5.p3.4.m4.1.1.11.cmml" xref="S4.SS5.p3.4.m4.1.1.11">𝑝</ci><ci id="S4.SS5.p3.4.m4.1.1.12.cmml" xref="S4.SS5.p3.4.m4.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.4.m4.1c">AgentPrompt</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.4.m4.1d">italic_A italic_g italic_e italic_n italic_t italic_P italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math>. The generation process in GenDFIR occurs twice. First, in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg4" title="Algorithm 4 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, before the retrieval process, the <math alttext="Agent" class="ltx_Math" display="inline" id="S4.SS5.p3.5.m5.1"><semantics id="S4.SS5.p3.5.m5.1a"><mrow id="S4.SS5.p3.5.m5.1.1" xref="S4.SS5.p3.5.m5.1.1.cmml"><mi id="S4.SS5.p3.5.m5.1.1.2" xref="S4.SS5.p3.5.m5.1.1.2.cmml">A</mi><mo id="S4.SS5.p3.5.m5.1.1.1" xref="S4.SS5.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.5.m5.1.1.3" xref="S4.SS5.p3.5.m5.1.1.3.cmml">g</mi><mo id="S4.SS5.p3.5.m5.1.1.1a" xref="S4.SS5.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.5.m5.1.1.4" xref="S4.SS5.p3.5.m5.1.1.4.cmml">e</mi><mo id="S4.SS5.p3.5.m5.1.1.1b" xref="S4.SS5.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.5.m5.1.1.5" xref="S4.SS5.p3.5.m5.1.1.5.cmml">n</mi><mo id="S4.SS5.p3.5.m5.1.1.1c" xref="S4.SS5.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.5.m5.1.1.6" xref="S4.SS5.p3.5.m5.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.5.m5.1b"><apply id="S4.SS5.p3.5.m5.1.1.cmml" xref="S4.SS5.p3.5.m5.1.1"><times id="S4.SS5.p3.5.m5.1.1.1.cmml" xref="S4.SS5.p3.5.m5.1.1.1"></times><ci id="S4.SS5.p3.5.m5.1.1.2.cmml" xref="S4.SS5.p3.5.m5.1.1.2">𝐴</ci><ci id="S4.SS5.p3.5.m5.1.1.3.cmml" xref="S4.SS5.p3.5.m5.1.1.3">𝑔</ci><ci id="S4.SS5.p3.5.m5.1.1.4.cmml" xref="S4.SS5.p3.5.m5.1.1.4">𝑒</ci><ci id="S4.SS5.p3.5.m5.1.1.5.cmml" xref="S4.SS5.p3.5.m5.1.1.5">𝑛</ci><ci id="S4.SS5.p3.5.m5.1.1.6.cmml" xref="S4.SS5.p3.5.m5.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.5.m5.1c">Agent</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.5.m5.1d">italic_A italic_g italic_e italic_n italic_t</annotation></semantics></math> (or DFIR AI assistant) takes the <math alttext="UI" class="ltx_Math" display="inline" id="S4.SS5.p3.6.m6.1"><semantics id="S4.SS5.p3.6.m6.1a"><mrow id="S4.SS5.p3.6.m6.1.1" xref="S4.SS5.p3.6.m6.1.1.cmml"><mi id="S4.SS5.p3.6.m6.1.1.2" xref="S4.SS5.p3.6.m6.1.1.2.cmml">U</mi><mo id="S4.SS5.p3.6.m6.1.1.1" xref="S4.SS5.p3.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.6.m6.1.1.3" xref="S4.SS5.p3.6.m6.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.6.m6.1b"><apply id="S4.SS5.p3.6.m6.1.1.cmml" xref="S4.SS5.p3.6.m6.1.1"><times id="S4.SS5.p3.6.m6.1.1.1.cmml" xref="S4.SS5.p3.6.m6.1.1.1"></times><ci id="S4.SS5.p3.6.m6.1.1.2.cmml" xref="S4.SS5.p3.6.m6.1.1.2">𝑈</ci><ci id="S4.SS5.p3.6.m6.1.1.3.cmml" xref="S4.SS5.p3.6.m6.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.6.m6.1c">UI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.6.m6.1d">italic_U italic_I</annotation></semantics></math> and modifies it to generate a new contextualized query <math alttext="RI" class="ltx_Math" display="inline" id="S4.SS5.p3.7.m7.1"><semantics id="S4.SS5.p3.7.m7.1a"><mrow id="S4.SS5.p3.7.m7.1.1" xref="S4.SS5.p3.7.m7.1.1.cmml"><mi id="S4.SS5.p3.7.m7.1.1.2" xref="S4.SS5.p3.7.m7.1.1.2.cmml">R</mi><mo id="S4.SS5.p3.7.m7.1.1.1" xref="S4.SS5.p3.7.m7.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p3.7.m7.1.1.3" xref="S4.SS5.p3.7.m7.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.7.m7.1b"><apply id="S4.SS5.p3.7.m7.1.1.cmml" xref="S4.SS5.p3.7.m7.1.1"><times id="S4.SS5.p3.7.m7.1.1.1.cmml" xref="S4.SS5.p3.7.m7.1.1.1"></times><ci id="S4.SS5.p3.7.m7.1.1.2.cmml" xref="S4.SS5.p3.7.m7.1.1.2">𝑅</ci><ci id="S4.SS5.p3.7.m7.1.1.3.cmml" xref="S4.SS5.p3.7.m7.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.7.m7.1c">RI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.7.m7.1d">italic_R italic_I</annotation></semantics></math>. The second generation, which is a typical augmented generation, occurs in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg6" title="Algorithm 6 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p4">
<p class="ltx_p" id="S4.SS5.p4.4"><span class="ltx_text ltx_font_bold" id="S4.SS5.p4.4.1">Retrieval:</span>
Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg5" title="Algorithm 5 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, the retrieval process works with vectors only. It considers <math alttext="ED" class="ltx_Math" display="inline" id="S4.SS5.p4.1.m1.1"><semantics id="S4.SS5.p4.1.m1.1a"><mrow id="S4.SS5.p4.1.m1.1.1" xref="S4.SS5.p4.1.m1.1.1.cmml"><mi id="S4.SS5.p4.1.m1.1.1.2" xref="S4.SS5.p4.1.m1.1.1.2.cmml">E</mi><mo id="S4.SS5.p4.1.m1.1.1.1" xref="S4.SS5.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p4.1.m1.1.1.3" xref="S4.SS5.p4.1.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.1.m1.1b"><apply id="S4.SS5.p4.1.m1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1"><times id="S4.SS5.p4.1.m1.1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1.1"></times><ci id="S4.SS5.p4.1.m1.1.1.2.cmml" xref="S4.SS5.p4.1.m1.1.1.2">𝐸</ci><ci id="S4.SS5.p4.1.m1.1.1.3.cmml" xref="S4.SS5.p4.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.1.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p4.1.m1.1d">italic_E italic_D</annotation></semantics></math> and the vectorized initial input <math alttext="VRI" class="ltx_Math" display="inline" id="S4.SS5.p4.2.m2.1"><semantics id="S4.SS5.p4.2.m2.1a"><mrow id="S4.SS5.p4.2.m2.1.1" xref="S4.SS5.p4.2.m2.1.1.cmml"><mi id="S4.SS5.p4.2.m2.1.1.2" xref="S4.SS5.p4.2.m2.1.1.2.cmml">V</mi><mo id="S4.SS5.p4.2.m2.1.1.1" xref="S4.SS5.p4.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p4.2.m2.1.1.3" xref="S4.SS5.p4.2.m2.1.1.3.cmml">R</mi><mo id="S4.SS5.p4.2.m2.1.1.1a" xref="S4.SS5.p4.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p4.2.m2.1.1.4" xref="S4.SS5.p4.2.m2.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.2.m2.1b"><apply id="S4.SS5.p4.2.m2.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1"><times id="S4.SS5.p4.2.m2.1.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1.1"></times><ci id="S4.SS5.p4.2.m2.1.1.2.cmml" xref="S4.SS5.p4.2.m2.1.1.2">𝑉</ci><ci id="S4.SS5.p4.2.m2.1.1.3.cmml" xref="S4.SS5.p4.2.m2.1.1.3">𝑅</ci><ci id="S4.SS5.p4.2.m2.1.1.4.cmml" xref="S4.SS5.p4.2.m2.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.2.m2.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p4.2.m2.1d">italic_V italic_R italic_I</annotation></semantics></math>. The cosine similarity (<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E3" title="In IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>) between <math alttext="ED" class="ltx_Math" display="inline" id="S4.SS5.p4.3.m3.1"><semantics id="S4.SS5.p4.3.m3.1a"><mrow id="S4.SS5.p4.3.m3.1.1" xref="S4.SS5.p4.3.m3.1.1.cmml"><mi id="S4.SS5.p4.3.m3.1.1.2" xref="S4.SS5.p4.3.m3.1.1.2.cmml">E</mi><mo id="S4.SS5.p4.3.m3.1.1.1" xref="S4.SS5.p4.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p4.3.m3.1.1.3" xref="S4.SS5.p4.3.m3.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.3.m3.1b"><apply id="S4.SS5.p4.3.m3.1.1.cmml" xref="S4.SS5.p4.3.m3.1.1"><times id="S4.SS5.p4.3.m3.1.1.1.cmml" xref="S4.SS5.p4.3.m3.1.1.1"></times><ci id="S4.SS5.p4.3.m3.1.1.2.cmml" xref="S4.SS5.p4.3.m3.1.1.2">𝐸</ci><ci id="S4.SS5.p4.3.m3.1.1.3.cmml" xref="S4.SS5.p4.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.3.m3.1c">ED</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p4.3.m3.1d">italic_E italic_D</annotation></semantics></math> and <math alttext="UI" class="ltx_Math" display="inline" id="S4.SS5.p4.4.m4.1"><semantics id="S4.SS5.p4.4.m4.1a"><mrow id="S4.SS5.p4.4.m4.1.1" xref="S4.SS5.p4.4.m4.1.1.cmml"><mi id="S4.SS5.p4.4.m4.1.1.2" xref="S4.SS5.p4.4.m4.1.1.2.cmml">U</mi><mo id="S4.SS5.p4.4.m4.1.1.1" xref="S4.SS5.p4.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p4.4.m4.1.1.3" xref="S4.SS5.p4.4.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.4.m4.1b"><apply id="S4.SS5.p4.4.m4.1.1.cmml" xref="S4.SS5.p4.4.m4.1.1"><times id="S4.SS5.p4.4.m4.1.1.1.cmml" xref="S4.SS5.p4.4.m4.1.1.1"></times><ci id="S4.SS5.p4.4.m4.1.1.2.cmml" xref="S4.SS5.p4.4.m4.1.1.2">𝑈</ci><ci id="S4.SS5.p4.4.m4.1.1.3.cmml" xref="S4.SS5.p4.4.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.4.m4.1c">UI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p4.4.m4.1d">italic_U italic_I</annotation></semantics></math> is then calculated as follows:</p>
</div>
<div class="ltx_para" id="S4.SS5.p5">
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{cosine\_similarity}(q,t)=\frac{q\cdot t}{\|q\|\cdot\|t\|}" class="ltx_Math" display="block" id="S4.E3.m1.4"><semantics id="S4.E3.m1.4a"><mrow id="S4.E3.m1.4.5" xref="S4.E3.m1.4.5.cmml"><mrow id="S4.E3.m1.4.5.2" xref="S4.E3.m1.4.5.2.cmml"><mtext id="S4.E3.m1.4.5.2.2" xref="S4.E3.m1.4.5.2.2a.cmml">cosine_similarity</mtext><mo id="S4.E3.m1.4.5.2.1" xref="S4.E3.m1.4.5.2.1.cmml">⁢</mo><mrow id="S4.E3.m1.4.5.2.3.2" xref="S4.E3.m1.4.5.2.3.1.cmml"><mo id="S4.E3.m1.4.5.2.3.2.1" stretchy="false" xref="S4.E3.m1.4.5.2.3.1.cmml">(</mo><mi id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml">q</mi><mo id="S4.E3.m1.4.5.2.3.2.2" xref="S4.E3.m1.4.5.2.3.1.cmml">,</mo><mi id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml">t</mi><mo id="S4.E3.m1.4.5.2.3.2.3" stretchy="false" xref="S4.E3.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.5.1" xref="S4.E3.m1.4.5.1.cmml">=</mo><mfrac id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><mrow id="S4.E3.m1.2.2.4" xref="S4.E3.m1.2.2.4.cmml"><mi id="S4.E3.m1.2.2.4.2" xref="S4.E3.m1.2.2.4.2.cmml">q</mi><mo id="S4.E3.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E3.m1.2.2.4.1.cmml">⋅</mo><mi id="S4.E3.m1.2.2.4.3" xref="S4.E3.m1.2.2.4.3.cmml">t</mi></mrow><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><mrow id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.1.cmml"><mo id="S4.E3.m1.2.2.2.4.2.1" stretchy="false" xref="S4.E3.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">q</mi><mo id="S4.E3.m1.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S4.E3.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="S4.E3.m1.2.2.2.3" rspace="0.222em" xref="S4.E3.m1.2.2.2.3.cmml">⋅</mo><mrow id="S4.E3.m1.2.2.2.5.2" xref="S4.E3.m1.2.2.2.5.1.cmml"><mo id="S4.E3.m1.2.2.2.5.2.1" stretchy="false" xref="S4.E3.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">t</mi><mo id="S4.E3.m1.2.2.2.5.2.2" stretchy="false" xref="S4.E3.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.4b"><apply id="S4.E3.m1.4.5.cmml" xref="S4.E3.m1.4.5"><eq id="S4.E3.m1.4.5.1.cmml" xref="S4.E3.m1.4.5.1"></eq><apply id="S4.E3.m1.4.5.2.cmml" xref="S4.E3.m1.4.5.2"><times id="S4.E3.m1.4.5.2.1.cmml" xref="S4.E3.m1.4.5.2.1"></times><ci id="S4.E3.m1.4.5.2.2a.cmml" xref="S4.E3.m1.4.5.2.2"><mtext id="S4.E3.m1.4.5.2.2.cmml" xref="S4.E3.m1.4.5.2.2">cosine_similarity</mtext></ci><interval closure="open" id="S4.E3.m1.4.5.2.3.1.cmml" xref="S4.E3.m1.4.5.2.3.2"><ci id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3">𝑞</ci><ci id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4">𝑡</ci></interval></apply><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><divide id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2"></divide><apply id="S4.E3.m1.2.2.4.cmml" xref="S4.E3.m1.2.2.4"><ci id="S4.E3.m1.2.2.4.1.cmml" xref="S4.E3.m1.2.2.4.1">⋅</ci><ci id="S4.E3.m1.2.2.4.2.cmml" xref="S4.E3.m1.2.2.4.2">𝑞</ci><ci id="S4.E3.m1.2.2.4.3.cmml" xref="S4.E3.m1.2.2.4.3">𝑡</ci></apply><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><ci id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3">⋅</ci><apply id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2.4.2"><csymbol cd="latexml" id="S4.E3.m1.2.2.2.4.1.1.cmml" xref="S4.E3.m1.2.2.2.4.2.1">norm</csymbol><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑞</ci></apply><apply id="S4.E3.m1.2.2.2.5.1.cmml" xref="S4.E3.m1.2.2.2.5.2"><csymbol cd="latexml" id="S4.E3.m1.2.2.2.5.1.1.cmml" xref="S4.E3.m1.2.2.2.5.2.1">norm</csymbol><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.4c">\text{cosine\_similarity}(q,t)=\frac{q\cdot t}{\|q\|\cdot\|t\|}</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.4d">cosine_similarity ( italic_q , italic_t ) = divide start_ARG italic_q ⋅ italic_t end_ARG start_ARG ∥ italic_q ∥ ⋅ ∥ italic_t ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta=\arccos\left(\frac{q\cdot t}{\|q\|\cdot\|t\|}\right)" class="ltx_Math" display="block" id="S4.E4.m1.3"><semantics id="S4.E4.m1.3a"><mrow id="S4.E4.m1.3.4" xref="S4.E4.m1.3.4.cmml"><mi id="S4.E4.m1.3.4.2" xref="S4.E4.m1.3.4.2.cmml">θ</mi><mo id="S4.E4.m1.3.4.1" xref="S4.E4.m1.3.4.1.cmml">=</mo><mrow id="S4.E4.m1.3.4.3.2" xref="S4.E4.m1.3.4.3.1.cmml"><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">arccos</mi><mo id="S4.E4.m1.3.4.3.2a" xref="S4.E4.m1.3.4.3.1.cmml">⁡</mo><mrow id="S4.E4.m1.3.4.3.2.1" xref="S4.E4.m1.3.4.3.1.cmml"><mo id="S4.E4.m1.3.4.3.2.1.1" xref="S4.E4.m1.3.4.3.1.cmml">(</mo><mfrac id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml"><mrow id="S4.E4.m1.2.2.4" xref="S4.E4.m1.2.2.4.cmml"><mi id="S4.E4.m1.2.2.4.2" xref="S4.E4.m1.2.2.4.2.cmml">q</mi><mo id="S4.E4.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E4.m1.2.2.4.1.cmml">⋅</mo><mi id="S4.E4.m1.2.2.4.3" xref="S4.E4.m1.2.2.4.3.cmml">t</mi></mrow><mrow id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.2.cmml"><mrow id="S4.E4.m1.2.2.2.4.2" xref="S4.E4.m1.2.2.2.4.1.cmml"><mo id="S4.E4.m1.2.2.2.4.2.1" stretchy="false" xref="S4.E4.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">q</mi><mo id="S4.E4.m1.2.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="S4.E4.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="S4.E4.m1.2.2.2.3" rspace="0.222em" xref="S4.E4.m1.2.2.2.3.cmml">⋅</mo><mrow id="S4.E4.m1.2.2.2.5.2" xref="S4.E4.m1.2.2.2.5.1.cmml"><mo id="S4.E4.m1.2.2.2.5.2.1" stretchy="false" xref="S4.E4.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">t</mi><mo id="S4.E4.m1.2.2.2.5.2.2" stretchy="false" xref="S4.E4.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac><mo id="S4.E4.m1.3.4.3.2.1.2" xref="S4.E4.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.3b"><apply id="S4.E4.m1.3.4.cmml" xref="S4.E4.m1.3.4"><eq id="S4.E4.m1.3.4.1.cmml" xref="S4.E4.m1.3.4.1"></eq><ci id="S4.E4.m1.3.4.2.cmml" xref="S4.E4.m1.3.4.2">𝜃</ci><apply id="S4.E4.m1.3.4.3.1.cmml" xref="S4.E4.m1.3.4.3.2"><arccos id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3"></arccos><apply id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"><divide id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2"></divide><apply id="S4.E4.m1.2.2.4.cmml" xref="S4.E4.m1.2.2.4"><ci id="S4.E4.m1.2.2.4.1.cmml" xref="S4.E4.m1.2.2.4.1">⋅</ci><ci id="S4.E4.m1.2.2.4.2.cmml" xref="S4.E4.m1.2.2.4.2">𝑞</ci><ci id="S4.E4.m1.2.2.4.3.cmml" xref="S4.E4.m1.2.2.4.3">𝑡</ci></apply><apply id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2.2"><ci id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.3">⋅</ci><apply id="S4.E4.m1.2.2.2.4.1.cmml" xref="S4.E4.m1.2.2.2.4.2"><csymbol cd="latexml" id="S4.E4.m1.2.2.2.4.1.1.cmml" xref="S4.E4.m1.2.2.2.4.2.1">norm</csymbol><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑞</ci></apply><apply id="S4.E4.m1.2.2.2.5.1.cmml" xref="S4.E4.m1.2.2.2.5.2"><csymbol cd="latexml" id="S4.E4.m1.2.2.2.5.1.1.cmml" xref="S4.E4.m1.2.2.2.5.2.1">norm</csymbol><ci id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.3c">\theta=\arccos\left(\frac{q\cdot t}{\|q\|\cdot\|t\|}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.3d">italic_θ = roman_arccos ( divide start_ARG italic_q ⋅ italic_t end_ARG start_ARG ∥ italic_q ∥ ⋅ ∥ italic_t ∥ end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS5.p5.6">(<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E6" title="In IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>) is the Euclidean length of the vector <math alttext="q" class="ltx_Math" display="inline" id="S4.SS5.p5.1.m1.1"><semantics id="S4.SS5.p5.1.m1.1a"><mi id="S4.SS5.p5.1.m1.1.1" xref="S4.SS5.p5.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.1.m1.1b"><ci id="S4.SS5.p5.1.m1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.1.m1.1d">italic_q</annotation></semantics></math>, and (<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E7" title="In IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>) is the Euclidean length of the vector <math alttext="t" class="ltx_Math" display="inline" id="S4.SS5.p5.2.m2.1"><semantics id="S4.SS5.p5.2.m2.1a"><mi id="S4.SS5.p5.2.m2.1.1" xref="S4.SS5.p5.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.2.m2.1b"><ci id="S4.SS5.p5.2.m2.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.2.m2.1d">italic_t</annotation></semantics></math>. In (<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E5" title="In IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>), the dot product (scalar product) of <math alttext="q" class="ltx_Math" display="inline" id="S4.SS5.p5.3.m3.1"><semantics id="S4.SS5.p5.3.m3.1a"><mi id="S4.SS5.p5.3.m3.1.1" xref="S4.SS5.p5.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.3.m3.1b"><ci id="S4.SS5.p5.3.m3.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.3.m3.1d">italic_q</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S4.SS5.p5.4.m4.1"><semantics id="S4.SS5.p5.4.m4.1a"><mi id="S4.SS5.p5.4.m4.1.1" xref="S4.SS5.p5.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.4.m4.1b"><ci id="S4.SS5.p5.4.m4.1.1.cmml" xref="S4.SS5.p5.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.4.m4.1d">italic_t</annotation></semantics></math> is calculated to measure their similarity. This product is higher if the vectors point in the same direction, indicating they share more common features. The final equation, (<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.E4" title="In IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>), calculates the angle <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p5.5.m5.1"><semantics id="S4.SS5.p5.5.m5.1a"><mi id="S4.SS5.p5.5.m5.1.1" xref="S4.SS5.p5.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.5.m5.1b"><ci id="S4.SS5.p5.5.m5.1.1.cmml" xref="S4.SS5.p5.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.5.m5.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.5.m5.1d">italic_θ</annotation></semantics></math> between the two vectors. The smaller <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p5.6.m6.1"><semantics id="S4.SS5.p5.6.m6.1a"><mi id="S4.SS5.p5.6.m6.1.1" xref="S4.SS5.p5.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.6.m6.1b"><ci id="S4.SS5.p5.6.m6.1.1.cmml" xref="S4.SS5.p5.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.6.m6.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.6.m6.1d">italic_θ</annotation></semantics></math> is, the higher the similarity.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="195" id="S4.F6.g1" src="extracted/5878186/img/myplot.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>A sample cosine similarity representation between vectors <math alttext="q" class="ltx_Math" display="inline" id="S4.F6.6.m1.1"><semantics id="S4.F6.6.m1.1b"><mi id="S4.F6.6.m1.1.1" xref="S4.F6.6.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.F6.6.m1.1c"><ci id="S4.F6.6.m1.1.1.cmml" xref="S4.F6.6.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.m1.1d">q</annotation><annotation encoding="application/x-llamapun" id="S4.F6.6.m1.1e">italic_q</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S4.F6.7.m2.1"><semantics id="S4.F6.7.m2.1b"><mi id="S4.F6.7.m2.1.1" xref="S4.F6.7.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.F6.7.m2.1c"><ci id="S4.F6.7.m2.1.1.cmml" xref="S4.F6.7.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.7.m2.1d">t</annotation><annotation encoding="application/x-llamapun" id="S4.F6.7.m2.1e">italic_t</annotation></semantics></math>, where the <math alttext="x" class="ltx_Math" display="inline" id="S4.F6.8.m3.1"><semantics id="S4.F6.8.m3.1b"><mi id="S4.F6.8.m3.1.1" xref="S4.F6.8.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.F6.8.m3.1c"><ci id="S4.F6.8.m3.1.1.cmml" xref="S4.F6.8.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.8.m3.1d">x</annotation><annotation encoding="application/x-llamapun" id="S4.F6.8.m3.1e">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S4.F6.9.m4.1"><semantics id="S4.F6.9.m4.1b"><mi id="S4.F6.9.m4.1.1" xref="S4.F6.9.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.F6.9.m4.1c"><ci id="S4.F6.9.m4.1.1.cmml" xref="S4.F6.9.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.9.m4.1d">y</annotation><annotation encoding="application/x-llamapun" id="S4.F6.9.m4.1e">italic_y</annotation></semantics></math> axes represent the features of the query and the knowledge base, respectively. Similarity <math alttext="\approx 95\%" class="ltx_Math" display="inline" id="S4.F6.10.m5.1"><semantics id="S4.F6.10.m5.1b"><mrow id="S4.F6.10.m5.1.1" xref="S4.F6.10.m5.1.1.cmml"><mi id="S4.F6.10.m5.1.1.2" xref="S4.F6.10.m5.1.1.2.cmml"></mi><mo id="S4.F6.10.m5.1.1.1" xref="S4.F6.10.m5.1.1.1.cmml">≈</mo><mrow id="S4.F6.10.m5.1.1.3" xref="S4.F6.10.m5.1.1.3.cmml"><mn id="S4.F6.10.m5.1.1.3.2" xref="S4.F6.10.m5.1.1.3.2.cmml">95</mn><mo id="S4.F6.10.m5.1.1.3.1" xref="S4.F6.10.m5.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.10.m5.1c"><apply id="S4.F6.10.m5.1.1.cmml" xref="S4.F6.10.m5.1.1"><approx id="S4.F6.10.m5.1.1.1.cmml" xref="S4.F6.10.m5.1.1.1"></approx><csymbol cd="latexml" id="S4.F6.10.m5.1.1.2.cmml" xref="S4.F6.10.m5.1.1.2">absent</csymbol><apply id="S4.F6.10.m5.1.1.3.cmml" xref="S4.F6.10.m5.1.1.3"><csymbol cd="latexml" id="S4.F6.10.m5.1.1.3.1.cmml" xref="S4.F6.10.m5.1.1.3.1">percent</csymbol><cn id="S4.F6.10.m5.1.1.3.2.cmml" type="integer" xref="S4.F6.10.m5.1.1.3.2">95</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.10.m5.1d">\approx 95\%</annotation><annotation encoding="application/x-llamapun" id="S4.F6.10.m5.1e">≈ 95 %</annotation></semantics></math>.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS5.p6">
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q\cdot t=\sum_{i=1}^{n}q_{i}t_{i}" class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mrow id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.2.2" xref="S4.E5.m1.1.1.2.2.cmml">q</mi><mo id="S4.E5.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.1.1.2.1.cmml">⋅</mo><mi id="S4.E5.m1.1.1.2.3" xref="S4.E5.m1.1.1.2.3.cmml">t</mi></mrow><mo id="S4.E5.m1.1.1.1" rspace="0.111em" xref="S4.E5.m1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml"><munderover id="S4.E5.m1.1.1.3.1" xref="S4.E5.m1.1.1.3.1.cmml"><mo id="S4.E5.m1.1.1.3.1.2.2" movablelimits="false" xref="S4.E5.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.3.1.2.3" xref="S4.E5.m1.1.1.3.1.2.3.cmml"><mi id="S4.E5.m1.1.1.3.1.2.3.2" xref="S4.E5.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E5.m1.1.1.3.1.2.3.1" xref="S4.E5.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.1.3.1.2.3.3" xref="S4.E5.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.1.1.3.1.3" xref="S4.E5.m1.1.1.3.1.3.cmml">n</mi></munderover><mrow id="S4.E5.m1.1.1.3.2" xref="S4.E5.m1.1.1.3.2.cmml"><msub id="S4.E5.m1.1.1.3.2.2" xref="S4.E5.m1.1.1.3.2.2.cmml"><mi id="S4.E5.m1.1.1.3.2.2.2" xref="S4.E5.m1.1.1.3.2.2.2.cmml">q</mi><mi id="S4.E5.m1.1.1.3.2.2.3" xref="S4.E5.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.1.1.3.2.1" xref="S4.E5.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S4.E5.m1.1.1.3.2.3" xref="S4.E5.m1.1.1.3.2.3.cmml"><mi id="S4.E5.m1.1.1.3.2.3.2" xref="S4.E5.m1.1.1.3.2.3.2.cmml">t</mi><mi id="S4.E5.m1.1.1.3.2.3.3" xref="S4.E5.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><eq id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"></eq><apply id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2"><ci id="S4.E5.m1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.2.1">⋅</ci><ci id="S4.E5.m1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.2.2">𝑞</ci><ci id="S4.E5.m1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.2.3">𝑡</ci></apply><apply id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3"><apply id="S4.E5.m1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.1.1.cmml" xref="S4.E5.m1.1.1.3.1">superscript</csymbol><apply id="S4.E5.m1.1.1.3.1.2.cmml" xref="S4.E5.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.1.2.1.cmml" xref="S4.E5.m1.1.1.3.1">subscript</csymbol><sum id="S4.E5.m1.1.1.3.1.2.2.cmml" xref="S4.E5.m1.1.1.3.1.2.2"></sum><apply id="S4.E5.m1.1.1.3.1.2.3.cmml" xref="S4.E5.m1.1.1.3.1.2.3"><eq id="S4.E5.m1.1.1.3.1.2.3.1.cmml" xref="S4.E5.m1.1.1.3.1.2.3.1"></eq><ci id="S4.E5.m1.1.1.3.1.2.3.2.cmml" xref="S4.E5.m1.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E5.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E5.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.1.1.3.1.3.cmml" xref="S4.E5.m1.1.1.3.1.3">𝑛</ci></apply><apply id="S4.E5.m1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.3.2"><times id="S4.E5.m1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.3.2.1"></times><apply id="S4.E5.m1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.2.2.1.cmml" xref="S4.E5.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.3.2.2.2.cmml" xref="S4.E5.m1.1.1.3.2.2.2">𝑞</ci><ci id="S4.E5.m1.1.1.3.2.2.3.cmml" xref="S4.E5.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.2.3.1.cmml" xref="S4.E5.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.3.2.3.2.cmml" xref="S4.E5.m1.1.1.3.2.3.2">𝑡</ci><ci id="S4.E5.m1.1.1.3.2.3.3.cmml" xref="S4.E5.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">q\cdot t=\sum_{i=1}^{n}q_{i}t_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">italic_q ⋅ italic_t = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="||q||=\sqrt{\sum_{i=1}^{n}q_{i}^{2}}" class="ltx_Math" display="block" id="S4.E6.m1.1"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.2" xref="S4.E6.m1.1.2.cmml"><mrow id="S4.E6.m1.1.2.2.2" xref="S4.E6.m1.1.2.2.1.cmml"><mo id="S4.E6.m1.1.2.2.2.1" stretchy="false" xref="S4.E6.m1.1.2.2.1.1.cmml">‖</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">q</mi><mo id="S4.E6.m1.1.2.2.2.2" stretchy="false" xref="S4.E6.m1.1.2.2.1.1.cmml">‖</mo></mrow><mo id="S4.E6.m1.1.2.1" xref="S4.E6.m1.1.2.1.cmml">=</mo><msqrt id="S4.E6.m1.1.2.3" xref="S4.E6.m1.1.2.3.cmml"><mrow id="S4.E6.m1.1.2.3.2" xref="S4.E6.m1.1.2.3.2.cmml"><munderover id="S4.E6.m1.1.2.3.2.1" xref="S4.E6.m1.1.2.3.2.1.cmml"><mo id="S4.E6.m1.1.2.3.2.1.2.2" movablelimits="false" xref="S4.E6.m1.1.2.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.1.2.3.2.1.2.3" xref="S4.E6.m1.1.2.3.2.1.2.3.cmml"><mi id="S4.E6.m1.1.2.3.2.1.2.3.2" xref="S4.E6.m1.1.2.3.2.1.2.3.2.cmml">i</mi><mo id="S4.E6.m1.1.2.3.2.1.2.3.1" xref="S4.E6.m1.1.2.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E6.m1.1.2.3.2.1.2.3.3" xref="S4.E6.m1.1.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.1.2.3.2.1.3" xref="S4.E6.m1.1.2.3.2.1.3.cmml">n</mi></munderover><msubsup id="S4.E6.m1.1.2.3.2.2" xref="S4.E6.m1.1.2.3.2.2.cmml"><mi id="S4.E6.m1.1.2.3.2.2.2.2" xref="S4.E6.m1.1.2.3.2.2.2.2.cmml">q</mi><mi id="S4.E6.m1.1.2.3.2.2.2.3" xref="S4.E6.m1.1.2.3.2.2.2.3.cmml">i</mi><mn id="S4.E6.m1.1.2.3.2.2.3" xref="S4.E6.m1.1.2.3.2.2.3.cmml">2</mn></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.2.cmml" xref="S4.E6.m1.1.2"><eq id="S4.E6.m1.1.2.1.cmml" xref="S4.E6.m1.1.2.1"></eq><apply id="S4.E6.m1.1.2.2.1.cmml" xref="S4.E6.m1.1.2.2.2"><csymbol cd="latexml" id="S4.E6.m1.1.2.2.1.1.cmml" xref="S4.E6.m1.1.2.2.2.1">norm</csymbol><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝑞</ci></apply><apply id="S4.E6.m1.1.2.3.cmml" xref="S4.E6.m1.1.2.3"><root id="S4.E6.m1.1.2.3a.cmml" xref="S4.E6.m1.1.2.3"></root><apply id="S4.E6.m1.1.2.3.2.cmml" xref="S4.E6.m1.1.2.3.2"><apply id="S4.E6.m1.1.2.3.2.1.cmml" xref="S4.E6.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.2.3.2.1.1.cmml" xref="S4.E6.m1.1.2.3.2.1">superscript</csymbol><apply id="S4.E6.m1.1.2.3.2.1.2.cmml" xref="S4.E6.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.2.3.2.1.2.1.cmml" xref="S4.E6.m1.1.2.3.2.1">subscript</csymbol><sum id="S4.E6.m1.1.2.3.2.1.2.2.cmml" xref="S4.E6.m1.1.2.3.2.1.2.2"></sum><apply id="S4.E6.m1.1.2.3.2.1.2.3.cmml" xref="S4.E6.m1.1.2.3.2.1.2.3"><eq id="S4.E6.m1.1.2.3.2.1.2.3.1.cmml" xref="S4.E6.m1.1.2.3.2.1.2.3.1"></eq><ci id="S4.E6.m1.1.2.3.2.1.2.3.2.cmml" xref="S4.E6.m1.1.2.3.2.1.2.3.2">𝑖</ci><cn id="S4.E6.m1.1.2.3.2.1.2.3.3.cmml" type="integer" xref="S4.E6.m1.1.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.1.2.3.2.1.3.cmml" xref="S4.E6.m1.1.2.3.2.1.3">𝑛</ci></apply><apply id="S4.E6.m1.1.2.3.2.2.cmml" xref="S4.E6.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.2.3.2.2.1.cmml" xref="S4.E6.m1.1.2.3.2.2">superscript</csymbol><apply id="S4.E6.m1.1.2.3.2.2.2.cmml" xref="S4.E6.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.2.3.2.2.2.1.cmml" xref="S4.E6.m1.1.2.3.2.2">subscript</csymbol><ci id="S4.E6.m1.1.2.3.2.2.2.2.cmml" xref="S4.E6.m1.1.2.3.2.2.2.2">𝑞</ci><ci id="S4.E6.m1.1.2.3.2.2.2.3.cmml" xref="S4.E6.m1.1.2.3.2.2.2.3">𝑖</ci></apply><cn id="S4.E6.m1.1.2.3.2.2.3.cmml" type="integer" xref="S4.E6.m1.1.2.3.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">||q||=\sqrt{\sum_{i=1}^{n}q_{i}^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">| | italic_q | | = square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS5.p7">
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="||t||=\sqrt{\sum_{i=1}^{n}t_{i}^{2}}" class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.2" xref="S4.E7.m1.1.2.cmml"><mrow id="S4.E7.m1.1.2.2.2" xref="S4.E7.m1.1.2.2.1.cmml"><mo id="S4.E7.m1.1.2.2.2.1" stretchy="false" xref="S4.E7.m1.1.2.2.1.1.cmml">‖</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">t</mi><mo id="S4.E7.m1.1.2.2.2.2" stretchy="false" xref="S4.E7.m1.1.2.2.1.1.cmml">‖</mo></mrow><mo id="S4.E7.m1.1.2.1" xref="S4.E7.m1.1.2.1.cmml">=</mo><msqrt id="S4.E7.m1.1.2.3" xref="S4.E7.m1.1.2.3.cmml"><mrow id="S4.E7.m1.1.2.3.2" xref="S4.E7.m1.1.2.3.2.cmml"><munderover id="S4.E7.m1.1.2.3.2.1" xref="S4.E7.m1.1.2.3.2.1.cmml"><mo id="S4.E7.m1.1.2.3.2.1.2.2" movablelimits="false" xref="S4.E7.m1.1.2.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.1.2.3.2.1.2.3" xref="S4.E7.m1.1.2.3.2.1.2.3.cmml"><mi id="S4.E7.m1.1.2.3.2.1.2.3.2" xref="S4.E7.m1.1.2.3.2.1.2.3.2.cmml">i</mi><mo id="S4.E7.m1.1.2.3.2.1.2.3.1" xref="S4.E7.m1.1.2.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E7.m1.1.2.3.2.1.2.3.3" xref="S4.E7.m1.1.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.1.2.3.2.1.3" xref="S4.E7.m1.1.2.3.2.1.3.cmml">n</mi></munderover><msubsup id="S4.E7.m1.1.2.3.2.2" xref="S4.E7.m1.1.2.3.2.2.cmml"><mi id="S4.E7.m1.1.2.3.2.2.2.2" xref="S4.E7.m1.1.2.3.2.2.2.2.cmml">t</mi><mi id="S4.E7.m1.1.2.3.2.2.2.3" xref="S4.E7.m1.1.2.3.2.2.2.3.cmml">i</mi><mn id="S4.E7.m1.1.2.3.2.2.3" xref="S4.E7.m1.1.2.3.2.2.3.cmml">2</mn></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.2.cmml" xref="S4.E7.m1.1.2"><eq id="S4.E7.m1.1.2.1.cmml" xref="S4.E7.m1.1.2.1"></eq><apply id="S4.E7.m1.1.2.2.1.cmml" xref="S4.E7.m1.1.2.2.2"><csymbol cd="latexml" id="S4.E7.m1.1.2.2.1.1.cmml" xref="S4.E7.m1.1.2.2.2.1">norm</csymbol><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑡</ci></apply><apply id="S4.E7.m1.1.2.3.cmml" xref="S4.E7.m1.1.2.3"><root id="S4.E7.m1.1.2.3a.cmml" xref="S4.E7.m1.1.2.3"></root><apply id="S4.E7.m1.1.2.3.2.cmml" xref="S4.E7.m1.1.2.3.2"><apply id="S4.E7.m1.1.2.3.2.1.cmml" xref="S4.E7.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.2.3.2.1.1.cmml" xref="S4.E7.m1.1.2.3.2.1">superscript</csymbol><apply id="S4.E7.m1.1.2.3.2.1.2.cmml" xref="S4.E7.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.2.3.2.1.2.1.cmml" xref="S4.E7.m1.1.2.3.2.1">subscript</csymbol><sum id="S4.E7.m1.1.2.3.2.1.2.2.cmml" xref="S4.E7.m1.1.2.3.2.1.2.2"></sum><apply id="S4.E7.m1.1.2.3.2.1.2.3.cmml" xref="S4.E7.m1.1.2.3.2.1.2.3"><eq id="S4.E7.m1.1.2.3.2.1.2.3.1.cmml" xref="S4.E7.m1.1.2.3.2.1.2.3.1"></eq><ci id="S4.E7.m1.1.2.3.2.1.2.3.2.cmml" xref="S4.E7.m1.1.2.3.2.1.2.3.2">𝑖</ci><cn id="S4.E7.m1.1.2.3.2.1.2.3.3.cmml" type="integer" xref="S4.E7.m1.1.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.1.2.3.2.1.3.cmml" xref="S4.E7.m1.1.2.3.2.1.3">𝑛</ci></apply><apply id="S4.E7.m1.1.2.3.2.2.cmml" xref="S4.E7.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.2.3.2.2.1.cmml" xref="S4.E7.m1.1.2.3.2.2">superscript</csymbol><apply id="S4.E7.m1.1.2.3.2.2.2.cmml" xref="S4.E7.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.2.3.2.2.2.1.cmml" xref="S4.E7.m1.1.2.3.2.2">subscript</csymbol><ci id="S4.E7.m1.1.2.3.2.2.2.2.cmml" xref="S4.E7.m1.1.2.3.2.2.2.2">𝑡</ci><ci id="S4.E7.m1.1.2.3.2.2.2.3.cmml" xref="S4.E7.m1.1.2.3.2.2.2.3">𝑖</ci></apply><cn id="S4.E7.m1.1.2.3.2.2.3.cmml" type="integer" xref="S4.E7.m1.1.2.3.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">||t||=\sqrt{\sum_{i=1}^{n}t_{i}^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">| | italic_t | | = square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<ul class="ltx_itemize" id="S4.I10">
<li class="ltx_item" id="S4.I10.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I10.i1.p1">
<p class="ltx_p" id="S4.I10.i1.p1.3"><math alttext="q_{i}" class="ltx_Math" display="inline" id="S4.I10.i1.p1.1.m1.1"><semantics id="S4.I10.i1.p1.1.m1.1a"><msub id="S4.I10.i1.p1.1.m1.1.1" xref="S4.I10.i1.p1.1.m1.1.1.cmml"><mi id="S4.I10.i1.p1.1.m1.1.1.2" xref="S4.I10.i1.p1.1.m1.1.1.2.cmml">q</mi><mi id="S4.I10.i1.p1.1.m1.1.1.3" xref="S4.I10.i1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I10.i1.p1.1.m1.1b"><apply id="S4.I10.i1.p1.1.m1.1.1.cmml" xref="S4.I10.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I10.i1.p1.1.m1.1.1.1.cmml" xref="S4.I10.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I10.i1.p1.1.m1.1.1.2.cmml" xref="S4.I10.i1.p1.1.m1.1.1.2">𝑞</ci><ci id="S4.I10.i1.p1.1.m1.1.1.3.cmml" xref="S4.I10.i1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i1.p1.1.m1.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i1.p1.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S4.I10.i1.p1.2.m2.1"><semantics id="S4.I10.i1.p1.2.m2.1a"><mi id="S4.I10.i1.p1.2.m2.1.1" xref="S4.I10.i1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.I10.i1.p1.2.m2.1b"><ci id="S4.I10.i1.p1.2.m2.1.1.cmml" xref="S4.I10.i1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i1.p1.2.m2.1d">italic_i</annotation></semantics></math>-th component of vector <math alttext="q" class="ltx_Math" display="inline" id="S4.I10.i1.p1.3.m3.1"><semantics id="S4.I10.i1.p1.3.m3.1a"><mi id="S4.I10.i1.p1.3.m3.1.1" xref="S4.I10.i1.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.I10.i1.p1.3.m3.1b"><ci id="S4.I10.i1.p1.3.m3.1.1.cmml" xref="S4.I10.i1.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i1.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i1.p1.3.m3.1d">italic_q</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I10.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I10.i2.p1">
<p class="ltx_p" id="S4.I10.i2.p1.3"><math alttext="t_{i}" class="ltx_Math" display="inline" id="S4.I10.i2.p1.1.m1.1"><semantics id="S4.I10.i2.p1.1.m1.1a"><msub id="S4.I10.i2.p1.1.m1.1.1" xref="S4.I10.i2.p1.1.m1.1.1.cmml"><mi id="S4.I10.i2.p1.1.m1.1.1.2" xref="S4.I10.i2.p1.1.m1.1.1.2.cmml">t</mi><mi id="S4.I10.i2.p1.1.m1.1.1.3" xref="S4.I10.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I10.i2.p1.1.m1.1b"><apply id="S4.I10.i2.p1.1.m1.1.1.cmml" xref="S4.I10.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I10.i2.p1.1.m1.1.1.1.cmml" xref="S4.I10.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I10.i2.p1.1.m1.1.1.2.cmml" xref="S4.I10.i2.p1.1.m1.1.1.2">𝑡</ci><ci id="S4.I10.i2.p1.1.m1.1.1.3.cmml" xref="S4.I10.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i2.p1.1.m1.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i2.p1.1.m1.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S4.I10.i2.p1.2.m2.1"><semantics id="S4.I10.i2.p1.2.m2.1a"><mi id="S4.I10.i2.p1.2.m2.1.1" xref="S4.I10.i2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.I10.i2.p1.2.m2.1b"><ci id="S4.I10.i2.p1.2.m2.1.1.cmml" xref="S4.I10.i2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i2.p1.2.m2.1d">italic_i</annotation></semantics></math>-th component of vector <math alttext="t" class="ltx_Math" display="inline" id="S4.I10.i2.p1.3.m3.1"><semantics id="S4.I10.i2.p1.3.m3.1a"><mi id="S4.I10.i2.p1.3.m3.1.1" xref="S4.I10.i2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.I10.i2.p1.3.m3.1b"><ci id="S4.I10.i2.p1.3.m3.1.1.cmml" xref="S4.I10.i2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I10.i2.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.I10.i2.p1.3.m3.1d">italic_t</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS5.p7.7"><math alttext="q" class="ltx_Math" display="inline" id="S4.SS5.p7.1.m1.1"><semantics id="S4.SS5.p7.1.m1.1a"><mi id="S4.SS5.p7.1.m1.1.1" xref="S4.SS5.p7.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.1.m1.1b"><ci id="S4.SS5.p7.1.m1.1.1.cmml" xref="S4.SS5.p7.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.1.m1.1d">italic_q</annotation></semantics></math> is the new query vector <math alttext="VRI" class="ltx_Math" display="inline" id="S4.SS5.p7.2.m2.1"><semantics id="S4.SS5.p7.2.m2.1a"><mrow id="S4.SS5.p7.2.m2.1.1" xref="S4.SS5.p7.2.m2.1.1.cmml"><mi id="S4.SS5.p7.2.m2.1.1.2" xref="S4.SS5.p7.2.m2.1.1.2.cmml">V</mi><mo id="S4.SS5.p7.2.m2.1.1.1" xref="S4.SS5.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p7.2.m2.1.1.3" xref="S4.SS5.p7.2.m2.1.1.3.cmml">R</mi><mo id="S4.SS5.p7.2.m2.1.1.1a" xref="S4.SS5.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p7.2.m2.1.1.4" xref="S4.SS5.p7.2.m2.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.2.m2.1b"><apply id="S4.SS5.p7.2.m2.1.1.cmml" xref="S4.SS5.p7.2.m2.1.1"><times id="S4.SS5.p7.2.m2.1.1.1.cmml" xref="S4.SS5.p7.2.m2.1.1.1"></times><ci id="S4.SS5.p7.2.m2.1.1.2.cmml" xref="S4.SS5.p7.2.m2.1.1.2">𝑉</ci><ci id="S4.SS5.p7.2.m2.1.1.3.cmml" xref="S4.SS5.p7.2.m2.1.1.3">𝑅</ci><ci id="S4.SS5.p7.2.m2.1.1.4.cmml" xref="S4.SS5.p7.2.m2.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.2.m2.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.2.m2.1d">italic_V italic_R italic_I</annotation></semantics></math>, and <math alttext="t" class="ltx_Math" display="inline" id="S4.SS5.p7.3.m3.1"><semantics id="S4.SS5.p7.3.m3.1a"><mi id="S4.SS5.p7.3.m3.1.1" xref="S4.SS5.p7.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.3.m3.1b"><ci id="S4.SS5.p7.3.m3.1.1.cmml" xref="S4.SS5.p7.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.3.m3.1d">italic_t</annotation></semantics></math> is the ED vector. Within an axis of <math alttext="x" class="ltx_Math" display="inline" id="S4.SS5.p7.4.m4.1"><semantics id="S4.SS5.p7.4.m4.1a"><mi id="S4.SS5.p7.4.m4.1.1" xref="S4.SS5.p7.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.4.m4.1b"><ci id="S4.SS5.p7.4.m4.1.1.cmml" xref="S4.SS5.p7.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.4.m4.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S4.SS5.p7.5.m5.1"><semantics id="S4.SS5.p7.5.m5.1a"><mi id="S4.SS5.p7.5.m5.1.1" xref="S4.SS5.p7.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.5.m5.1b"><ci id="S4.SS5.p7.5.m5.1.1.cmml" xref="S4.SS5.p7.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.5.m5.1d">italic_y</annotation></semantics></math>, <math alttext="q" class="ltx_Math" display="inline" id="S4.SS5.p7.6.m6.1"><semantics id="S4.SS5.p7.6.m6.1a"><mi id="S4.SS5.p7.6.m6.1.1" xref="S4.SS5.p7.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.6.m6.1b"><ci id="S4.SS5.p7.6.m6.1.1.cmml" xref="S4.SS5.p7.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.6.m6.1d">italic_q</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S4.SS5.p7.7.m7.1"><semantics id="S4.SS5.p7.7.m7.1a"><mi id="S4.SS5.p7.7.m7.1.1" xref="S4.SS5.p7.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p7.7.m7.1b"><ci id="S4.SS5.p7.7.m7.1.1.cmml" xref="S4.SS5.p7.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p7.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p7.7.m7.1d">italic_t</annotation></semantics></math> are represented as in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F6" title="Figure 6 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="203" id="S4.F7.g1" src="extracted/5878186/img/anomaly.png" width="210"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>A Sample Representation of Evidence from Anomalous Events within the Knowledge Base.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="201" id="S4.F8.g1" src="extracted/5878186/img/evidence.png" width="210"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>A Sample Representation of Anomalous Events where all are Evidence.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS5.p8">
<p class="ltx_p" id="S4.SS5.p8.7">The agent will be looking for a high rate of similarities (<math alttext="SimilarityScores" class="ltx_Math" display="inline" id="S4.SS5.p8.1.m1.1"><semantics id="S4.SS5.p8.1.m1.1a"><mrow id="S4.SS5.p8.1.m1.1.1" xref="S4.SS5.p8.1.m1.1.1.cmml"><mi id="S4.SS5.p8.1.m1.1.1.2" xref="S4.SS5.p8.1.m1.1.1.2.cmml">S</mi><mo id="S4.SS5.p8.1.m1.1.1.1" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.3" xref="S4.SS5.p8.1.m1.1.1.3.cmml">i</mi><mo id="S4.SS5.p8.1.m1.1.1.1a" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.4" xref="S4.SS5.p8.1.m1.1.1.4.cmml">m</mi><mo id="S4.SS5.p8.1.m1.1.1.1b" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.5" xref="S4.SS5.p8.1.m1.1.1.5.cmml">i</mi><mo id="S4.SS5.p8.1.m1.1.1.1c" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.6" xref="S4.SS5.p8.1.m1.1.1.6.cmml">l</mi><mo id="S4.SS5.p8.1.m1.1.1.1d" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.7" xref="S4.SS5.p8.1.m1.1.1.7.cmml">a</mi><mo id="S4.SS5.p8.1.m1.1.1.1e" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.8" xref="S4.SS5.p8.1.m1.1.1.8.cmml">r</mi><mo id="S4.SS5.p8.1.m1.1.1.1f" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.9" xref="S4.SS5.p8.1.m1.1.1.9.cmml">i</mi><mo id="S4.SS5.p8.1.m1.1.1.1g" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.10" xref="S4.SS5.p8.1.m1.1.1.10.cmml">t</mi><mo id="S4.SS5.p8.1.m1.1.1.1h" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.11" xref="S4.SS5.p8.1.m1.1.1.11.cmml">y</mi><mo id="S4.SS5.p8.1.m1.1.1.1i" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.12" xref="S4.SS5.p8.1.m1.1.1.12.cmml">S</mi><mo id="S4.SS5.p8.1.m1.1.1.1j" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.13" xref="S4.SS5.p8.1.m1.1.1.13.cmml">c</mi><mo id="S4.SS5.p8.1.m1.1.1.1k" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.14" xref="S4.SS5.p8.1.m1.1.1.14.cmml">o</mi><mo id="S4.SS5.p8.1.m1.1.1.1l" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.15" xref="S4.SS5.p8.1.m1.1.1.15.cmml">r</mi><mo id="S4.SS5.p8.1.m1.1.1.1m" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.16" xref="S4.SS5.p8.1.m1.1.1.16.cmml">e</mi><mo id="S4.SS5.p8.1.m1.1.1.1n" xref="S4.SS5.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.1.m1.1.1.17" xref="S4.SS5.p8.1.m1.1.1.17.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.1.m1.1b"><apply id="S4.SS5.p8.1.m1.1.1.cmml" xref="S4.SS5.p8.1.m1.1.1"><times id="S4.SS5.p8.1.m1.1.1.1.cmml" xref="S4.SS5.p8.1.m1.1.1.1"></times><ci id="S4.SS5.p8.1.m1.1.1.2.cmml" xref="S4.SS5.p8.1.m1.1.1.2">𝑆</ci><ci id="S4.SS5.p8.1.m1.1.1.3.cmml" xref="S4.SS5.p8.1.m1.1.1.3">𝑖</ci><ci id="S4.SS5.p8.1.m1.1.1.4.cmml" xref="S4.SS5.p8.1.m1.1.1.4">𝑚</ci><ci id="S4.SS5.p8.1.m1.1.1.5.cmml" xref="S4.SS5.p8.1.m1.1.1.5">𝑖</ci><ci id="S4.SS5.p8.1.m1.1.1.6.cmml" xref="S4.SS5.p8.1.m1.1.1.6">𝑙</ci><ci id="S4.SS5.p8.1.m1.1.1.7.cmml" xref="S4.SS5.p8.1.m1.1.1.7">𝑎</ci><ci id="S4.SS5.p8.1.m1.1.1.8.cmml" xref="S4.SS5.p8.1.m1.1.1.8">𝑟</ci><ci id="S4.SS5.p8.1.m1.1.1.9.cmml" xref="S4.SS5.p8.1.m1.1.1.9">𝑖</ci><ci id="S4.SS5.p8.1.m1.1.1.10.cmml" xref="S4.SS5.p8.1.m1.1.1.10">𝑡</ci><ci id="S4.SS5.p8.1.m1.1.1.11.cmml" xref="S4.SS5.p8.1.m1.1.1.11">𝑦</ci><ci id="S4.SS5.p8.1.m1.1.1.12.cmml" xref="S4.SS5.p8.1.m1.1.1.12">𝑆</ci><ci id="S4.SS5.p8.1.m1.1.1.13.cmml" xref="S4.SS5.p8.1.m1.1.1.13">𝑐</ci><ci id="S4.SS5.p8.1.m1.1.1.14.cmml" xref="S4.SS5.p8.1.m1.1.1.14">𝑜</ci><ci id="S4.SS5.p8.1.m1.1.1.15.cmml" xref="S4.SS5.p8.1.m1.1.1.15">𝑟</ci><ci id="S4.SS5.p8.1.m1.1.1.16.cmml" xref="S4.SS5.p8.1.m1.1.1.16">𝑒</ci><ci id="S4.SS5.p8.1.m1.1.1.17.cmml" xref="S4.SS5.p8.1.m1.1.1.17">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.1.m1.1c">SimilarityScores</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.1.m1.1d">italic_S italic_i italic_m italic_i italic_l italic_a italic_r italic_i italic_t italic_y italic_S italic_c italic_o italic_r italic_e italic_s</annotation></semantics></math>) within <math alttext="ED" class="ltx_Math" display="inline" id="S4.SS5.p8.2.m2.1"><semantics id="S4.SS5.p8.2.m2.1a"><mrow id="S4.SS5.p8.2.m2.1.1" xref="S4.SS5.p8.2.m2.1.1.cmml"><mi id="S4.SS5.p8.2.m2.1.1.2" xref="S4.SS5.p8.2.m2.1.1.2.cmml">E</mi><mo id="S4.SS5.p8.2.m2.1.1.1" xref="S4.SS5.p8.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.2.m2.1.1.3" xref="S4.SS5.p8.2.m2.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.2.m2.1b"><apply id="S4.SS5.p8.2.m2.1.1.cmml" xref="S4.SS5.p8.2.m2.1.1"><times id="S4.SS5.p8.2.m2.1.1.1.cmml" xref="S4.SS5.p8.2.m2.1.1.1"></times><ci id="S4.SS5.p8.2.m2.1.1.2.cmml" xref="S4.SS5.p8.2.m2.1.1.2">𝐸</ci><ci id="S4.SS5.p8.2.m2.1.1.3.cmml" xref="S4.SS5.p8.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.2.m2.1c">ED</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.2.m2.1d">italic_E italic_D</annotation></semantics></math> for the <math alttext="VRI" class="ltx_Math" display="inline" id="S4.SS5.p8.3.m3.1"><semantics id="S4.SS5.p8.3.m3.1a"><mrow id="S4.SS5.p8.3.m3.1.1" xref="S4.SS5.p8.3.m3.1.1.cmml"><mi id="S4.SS5.p8.3.m3.1.1.2" xref="S4.SS5.p8.3.m3.1.1.2.cmml">V</mi><mo id="S4.SS5.p8.3.m3.1.1.1" xref="S4.SS5.p8.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.3.m3.1.1.3" xref="S4.SS5.p8.3.m3.1.1.3.cmml">R</mi><mo id="S4.SS5.p8.3.m3.1.1.1a" xref="S4.SS5.p8.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.3.m3.1.1.4" xref="S4.SS5.p8.3.m3.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.3.m3.1b"><apply id="S4.SS5.p8.3.m3.1.1.cmml" xref="S4.SS5.p8.3.m3.1.1"><times id="S4.SS5.p8.3.m3.1.1.1.cmml" xref="S4.SS5.p8.3.m3.1.1.1"></times><ci id="S4.SS5.p8.3.m3.1.1.2.cmml" xref="S4.SS5.p8.3.m3.1.1.2">𝑉</ci><ci id="S4.SS5.p8.3.m3.1.1.3.cmml" xref="S4.SS5.p8.3.m3.1.1.3">𝑅</ci><ci id="S4.SS5.p8.3.m3.1.1.4.cmml" xref="S4.SS5.p8.3.m3.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.3.m3.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.3.m3.1d">italic_V italic_R italic_I</annotation></semantics></math>. The higher the score, the more concise and accurate the answers we get. Due to the possibility of having many relevant pieces of information, we select only the top <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p8.4.m4.1"><semantics id="S4.SS5.p8.4.m4.1a"><mrow id="S4.SS5.p8.4.m4.1.1" xref="S4.SS5.p8.4.m4.1.1.cmml"><mi id="S4.SS5.p8.4.m4.1.1.2" xref="S4.SS5.p8.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS5.p8.4.m4.1.1.1" xref="S4.SS5.p8.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.4.m4.1.1.3" xref="S4.SS5.p8.4.m4.1.1.3.cmml">o</mi><mo id="S4.SS5.p8.4.m4.1.1.1a" xref="S4.SS5.p8.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.4.m4.1.1.4" xref="S4.SS5.p8.4.m4.1.1.4.cmml">p</mi><mo id="S4.SS5.p8.4.m4.1.1.1b" xref="S4.SS5.p8.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.4.m4.1.1.5" xref="S4.SS5.p8.4.m4.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.4.m4.1b"><apply id="S4.SS5.p8.4.m4.1.1.cmml" xref="S4.SS5.p8.4.m4.1.1"><times id="S4.SS5.p8.4.m4.1.1.1.cmml" xref="S4.SS5.p8.4.m4.1.1.1"></times><ci id="S4.SS5.p8.4.m4.1.1.2.cmml" xref="S4.SS5.p8.4.m4.1.1.2">𝑡</ci><ci id="S4.SS5.p8.4.m4.1.1.3.cmml" xref="S4.SS5.p8.4.m4.1.1.3">𝑜</ci><ci id="S4.SS5.p8.4.m4.1.1.4.cmml" xref="S4.SS5.p8.4.m4.1.1.4">𝑝</ci><ci id="S4.SS5.p8.4.m4.1.1.5.cmml" xref="S4.SS5.p8.4.m4.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.4.m4.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.4.m4.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> (value to be defined manually) and take the most accurate by calculating the minimum distance between the <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p8.5.m5.1"><semantics id="S4.SS5.p8.5.m5.1a"><mrow id="S4.SS5.p8.5.m5.1.1" xref="S4.SS5.p8.5.m5.1.1.cmml"><mi id="S4.SS5.p8.5.m5.1.1.2" xref="S4.SS5.p8.5.m5.1.1.2.cmml">t</mi><mo id="S4.SS5.p8.5.m5.1.1.1" xref="S4.SS5.p8.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.5.m5.1.1.3" xref="S4.SS5.p8.5.m5.1.1.3.cmml">o</mi><mo id="S4.SS5.p8.5.m5.1.1.1a" xref="S4.SS5.p8.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.5.m5.1.1.4" xref="S4.SS5.p8.5.m5.1.1.4.cmml">p</mi><mo id="S4.SS5.p8.5.m5.1.1.1b" xref="S4.SS5.p8.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.5.m5.1.1.5" xref="S4.SS5.p8.5.m5.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.5.m5.1b"><apply id="S4.SS5.p8.5.m5.1.1.cmml" xref="S4.SS5.p8.5.m5.1.1"><times id="S4.SS5.p8.5.m5.1.1.1.cmml" xref="S4.SS5.p8.5.m5.1.1.1"></times><ci id="S4.SS5.p8.5.m5.1.1.2.cmml" xref="S4.SS5.p8.5.m5.1.1.2">𝑡</ci><ci id="S4.SS5.p8.5.m5.1.1.3.cmml" xref="S4.SS5.p8.5.m5.1.1.3">𝑜</ci><ci id="S4.SS5.p8.5.m5.1.1.4.cmml" xref="S4.SS5.p8.5.m5.1.1.4">𝑝</ci><ci id="S4.SS5.p8.5.m5.1.1.5.cmml" xref="S4.SS5.p8.5.m5.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.5.m5.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.5.m5.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> set and the length of <math alttext="SimilarityScores" class="ltx_Math" display="inline" id="S4.SS5.p8.6.m6.1"><semantics id="S4.SS5.p8.6.m6.1a"><mrow id="S4.SS5.p8.6.m6.1.1" xref="S4.SS5.p8.6.m6.1.1.cmml"><mi id="S4.SS5.p8.6.m6.1.1.2" xref="S4.SS5.p8.6.m6.1.1.2.cmml">S</mi><mo id="S4.SS5.p8.6.m6.1.1.1" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.3" xref="S4.SS5.p8.6.m6.1.1.3.cmml">i</mi><mo id="S4.SS5.p8.6.m6.1.1.1a" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.4" xref="S4.SS5.p8.6.m6.1.1.4.cmml">m</mi><mo id="S4.SS5.p8.6.m6.1.1.1b" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.5" xref="S4.SS5.p8.6.m6.1.1.5.cmml">i</mi><mo id="S4.SS5.p8.6.m6.1.1.1c" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.6" xref="S4.SS5.p8.6.m6.1.1.6.cmml">l</mi><mo id="S4.SS5.p8.6.m6.1.1.1d" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.7" xref="S4.SS5.p8.6.m6.1.1.7.cmml">a</mi><mo id="S4.SS5.p8.6.m6.1.1.1e" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.8" xref="S4.SS5.p8.6.m6.1.1.8.cmml">r</mi><mo id="S4.SS5.p8.6.m6.1.1.1f" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.9" xref="S4.SS5.p8.6.m6.1.1.9.cmml">i</mi><mo id="S4.SS5.p8.6.m6.1.1.1g" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.10" xref="S4.SS5.p8.6.m6.1.1.10.cmml">t</mi><mo id="S4.SS5.p8.6.m6.1.1.1h" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.11" xref="S4.SS5.p8.6.m6.1.1.11.cmml">y</mi><mo id="S4.SS5.p8.6.m6.1.1.1i" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.12" xref="S4.SS5.p8.6.m6.1.1.12.cmml">S</mi><mo id="S4.SS5.p8.6.m6.1.1.1j" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.13" xref="S4.SS5.p8.6.m6.1.1.13.cmml">c</mi><mo id="S4.SS5.p8.6.m6.1.1.1k" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.14" xref="S4.SS5.p8.6.m6.1.1.14.cmml">o</mi><mo id="S4.SS5.p8.6.m6.1.1.1l" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.15" xref="S4.SS5.p8.6.m6.1.1.15.cmml">r</mi><mo id="S4.SS5.p8.6.m6.1.1.1m" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.16" xref="S4.SS5.p8.6.m6.1.1.16.cmml">e</mi><mo id="S4.SS5.p8.6.m6.1.1.1n" xref="S4.SS5.p8.6.m6.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p8.6.m6.1.1.17" xref="S4.SS5.p8.6.m6.1.1.17.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.6.m6.1b"><apply id="S4.SS5.p8.6.m6.1.1.cmml" xref="S4.SS5.p8.6.m6.1.1"><times id="S4.SS5.p8.6.m6.1.1.1.cmml" xref="S4.SS5.p8.6.m6.1.1.1"></times><ci id="S4.SS5.p8.6.m6.1.1.2.cmml" xref="S4.SS5.p8.6.m6.1.1.2">𝑆</ci><ci id="S4.SS5.p8.6.m6.1.1.3.cmml" xref="S4.SS5.p8.6.m6.1.1.3">𝑖</ci><ci id="S4.SS5.p8.6.m6.1.1.4.cmml" xref="S4.SS5.p8.6.m6.1.1.4">𝑚</ci><ci id="S4.SS5.p8.6.m6.1.1.5.cmml" xref="S4.SS5.p8.6.m6.1.1.5">𝑖</ci><ci id="S4.SS5.p8.6.m6.1.1.6.cmml" xref="S4.SS5.p8.6.m6.1.1.6">𝑙</ci><ci id="S4.SS5.p8.6.m6.1.1.7.cmml" xref="S4.SS5.p8.6.m6.1.1.7">𝑎</ci><ci id="S4.SS5.p8.6.m6.1.1.8.cmml" xref="S4.SS5.p8.6.m6.1.1.8">𝑟</ci><ci id="S4.SS5.p8.6.m6.1.1.9.cmml" xref="S4.SS5.p8.6.m6.1.1.9">𝑖</ci><ci id="S4.SS5.p8.6.m6.1.1.10.cmml" xref="S4.SS5.p8.6.m6.1.1.10">𝑡</ci><ci id="S4.SS5.p8.6.m6.1.1.11.cmml" xref="S4.SS5.p8.6.m6.1.1.11">𝑦</ci><ci id="S4.SS5.p8.6.m6.1.1.12.cmml" xref="S4.SS5.p8.6.m6.1.1.12">𝑆</ci><ci id="S4.SS5.p8.6.m6.1.1.13.cmml" xref="S4.SS5.p8.6.m6.1.1.13">𝑐</ci><ci id="S4.SS5.p8.6.m6.1.1.14.cmml" xref="S4.SS5.p8.6.m6.1.1.14">𝑜</ci><ci id="S4.SS5.p8.6.m6.1.1.15.cmml" xref="S4.SS5.p8.6.m6.1.1.15">𝑟</ci><ci id="S4.SS5.p8.6.m6.1.1.16.cmml" xref="S4.SS5.p8.6.m6.1.1.16">𝑒</ci><ci id="S4.SS5.p8.6.m6.1.1.17.cmml" xref="S4.SS5.p8.6.m6.1.1.17">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.6.m6.1c">SimilarityScores</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.6.m6.1d">italic_S italic_i italic_m italic_i italic_l italic_a italic_r italic_i italic_t italic_y italic_S italic_c italic_o italic_r italic_e italic_s</annotation></semantics></math>. <math alttext="I" class="ltx_Math" display="inline" id="S4.SS5.p8.7.m7.1"><semantics id="S4.SS5.p8.7.m7.1a"><mi id="S4.SS5.p8.7.m7.1.1" xref="S4.SS5.p8.7.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p8.7.m7.1b"><ci id="S4.SS5.p8.7.m7.1.1.cmml" xref="S4.SS5.p8.7.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p8.7.m7.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p8.7.m7.1d">italic_I</annotation></semantics></math> is the final retrieved textual information.</p>
</div>
<div class="ltx_para" id="S4.SS5.p9">
<p class="ltx_p" id="S4.SS5.p9.1">Regarding <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p9.1.m1.1"><semantics id="S4.SS5.p9.1.m1.1a"><mrow id="S4.SS5.p9.1.m1.1.1" xref="S4.SS5.p9.1.m1.1.1.cmml"><mi id="S4.SS5.p9.1.m1.1.1.2" xref="S4.SS5.p9.1.m1.1.1.2.cmml">t</mi><mo id="S4.SS5.p9.1.m1.1.1.1" xref="S4.SS5.p9.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p9.1.m1.1.1.3" xref="S4.SS5.p9.1.m1.1.1.3.cmml">o</mi><mo id="S4.SS5.p9.1.m1.1.1.1a" xref="S4.SS5.p9.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p9.1.m1.1.1.4" xref="S4.SS5.p9.1.m1.1.1.4.cmml">p</mi><mo id="S4.SS5.p9.1.m1.1.1.1b" xref="S4.SS5.p9.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p9.1.m1.1.1.5" xref="S4.SS5.p9.1.m1.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p9.1.m1.1b"><apply id="S4.SS5.p9.1.m1.1.1.cmml" xref="S4.SS5.p9.1.m1.1.1"><times id="S4.SS5.p9.1.m1.1.1.1.cmml" xref="S4.SS5.p9.1.m1.1.1.1"></times><ci id="S4.SS5.p9.1.m1.1.1.2.cmml" xref="S4.SS5.p9.1.m1.1.1.2">𝑡</ci><ci id="S4.SS5.p9.1.m1.1.1.3.cmml" xref="S4.SS5.p9.1.m1.1.1.3">𝑜</ci><ci id="S4.SS5.p9.1.m1.1.1.4.cmml" xref="S4.SS5.p9.1.m1.1.1.4">𝑝</ci><ci id="S4.SS5.p9.1.m1.1.1.5.cmml" xref="S4.SS5.p9.1.m1.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p9.1.m1.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p9.1.m1.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> information in TA, the following aspects are taken into account:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p10">
<p class="ltx_p" id="S4.SS5.p10.2"><span class="ltx_text ltx_font_bold" id="S4.SS5.p10.2.1">1)</span> Our knowledge base <math alttext="K" class="ltx_Math" display="inline" id="S4.SS5.p10.1.m1.1"><semantics id="S4.SS5.p10.1.m1.1a"><mi id="S4.SS5.p10.1.m1.1.1" xref="S4.SS5.p10.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.1.m1.1b"><ci id="S4.SS5.p10.1.m1.1.1.cmml" xref="S4.SS5.p10.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p10.1.m1.1d">italic_K</annotation></semantics></math> contains all anomalous events <math alttext="A" class="ltx_Math" display="inline" id="S4.SS5.p10.2.m2.1"><semantics id="S4.SS5.p10.2.m2.1a"><mi id="S4.SS5.p10.2.m2.1.1" xref="S4.SS5.p10.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.2.m2.1b"><ci id="S4.SS5.p10.2.m2.1.1.cmml" xref="S4.SS5.p10.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p10.2.m2.1d">italic_A</annotation></semantics></math> filtered by the R-BAI algorithm.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K=A" class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mi id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">K</mi><mo id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml">=</mo><mi id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"></eq><ci id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2">𝐾</ci><ci id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">K=A</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">italic_K = italic_A</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="E=\{a\in A\mid a\text{ is not disqualified as evidence}\}" class="ltx_Math" display="block" id="S4.E9.m1.2"><semantics id="S4.E9.m1.2a"><mrow id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml"><mi id="S4.E9.m1.2.2.4" xref="S4.E9.m1.2.2.4.cmml">E</mi><mo id="S4.E9.m1.2.2.3" xref="S4.E9.m1.2.2.3.cmml">=</mo><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.2.2.2.3.1.cmml">{</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml">a</mi><mo id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml">∈</mo><mi id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml">A</mi></mrow><mo fence="true" id="S4.E9.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="S4.E9.m1.2.2.2.3.1.cmml">∣</mo><mrow id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.cmml">a</mi><mo id="S4.E9.m1.2.2.2.2.2.1" xref="S4.E9.m1.2.2.2.2.2.1.cmml">⁢</mo><mtext id="S4.E9.m1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3a.cmml"> is not disqualified as evidence</mtext></mrow><mo id="S4.E9.m1.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.2b"><apply id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2"><eq id="S4.E9.m1.2.2.3.cmml" xref="S4.E9.m1.2.2.3"></eq><ci id="S4.E9.m1.2.2.4.cmml" xref="S4.E9.m1.2.2.4">𝐸</ci><apply id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2"><csymbol cd="latexml" id="S4.E9.m1.2.2.2.3.1.cmml" xref="S4.E9.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><in id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"></in><ci id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2">𝑎</ci><ci id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3">𝐴</ci></apply><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2"><times id="S4.E9.m1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.1"></times><ci id="S4.E9.m1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2">𝑎</ci><ci id="S4.E9.m1.2.2.2.2.2.3a.cmml" xref="S4.E9.m1.2.2.2.2.2.3"><mtext id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.3"> is not disqualified as evidence</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.2c">E=\{a\in A\mid a\text{ is not disqualified as evidence}\}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.2d">italic_E = { italic_a ∈ italic_A ∣ italic_a is not disqualified as evidence }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS5.p10.3">Some of these events, after further context analysis by the LLM, may not be considered anomalous, which will disqualify them as evidence <math alttext="E" class="ltx_Math" display="inline" id="S4.SS5.p10.3.m1.1"><semantics id="S4.SS5.p10.3.m1.1a"><mi id="S4.SS5.p10.3.m1.1.1" xref="S4.SS5.p10.3.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p10.3.m1.1b"><ci id="S4.SS5.p10.3.m1.1.1.cmml" xref="S4.SS5.p10.3.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p10.3.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p10.3.m1.1d">italic_E</annotation></semantics></math> and will not be included in TA.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p11">
<p class="ltx_p" id="S4.SS5.p11.5"><span class="ltx_text ltx_font_bold" id="S4.SS5.p11.5.1">2)</span> In retrieval, the value of <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p11.1.m1.1"><semantics id="S4.SS5.p11.1.m1.1a"><mrow id="S4.SS5.p11.1.m1.1.1" xref="S4.SS5.p11.1.m1.1.1.cmml"><mi id="S4.SS5.p11.1.m1.1.1.2" xref="S4.SS5.p11.1.m1.1.1.2.cmml">t</mi><mo id="S4.SS5.p11.1.m1.1.1.1" xref="S4.SS5.p11.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.1.m1.1.1.3" xref="S4.SS5.p11.1.m1.1.1.3.cmml">o</mi><mo id="S4.SS5.p11.1.m1.1.1.1a" xref="S4.SS5.p11.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.1.m1.1.1.4" xref="S4.SS5.p11.1.m1.1.1.4.cmml">p</mi><mo id="S4.SS5.p11.1.m1.1.1.1b" xref="S4.SS5.p11.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.1.m1.1.1.5" xref="S4.SS5.p11.1.m1.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.1.m1.1b"><apply id="S4.SS5.p11.1.m1.1.1.cmml" xref="S4.SS5.p11.1.m1.1.1"><times id="S4.SS5.p11.1.m1.1.1.1.cmml" xref="S4.SS5.p11.1.m1.1.1.1"></times><ci id="S4.SS5.p11.1.m1.1.1.2.cmml" xref="S4.SS5.p11.1.m1.1.1.2">𝑡</ci><ci id="S4.SS5.p11.1.m1.1.1.3.cmml" xref="S4.SS5.p11.1.m1.1.1.3">𝑜</ci><ci id="S4.SS5.p11.1.m1.1.1.4.cmml" xref="S4.SS5.p11.1.m1.1.1.4">𝑝</ci><ci id="S4.SS5.p11.1.m1.1.1.5.cmml" xref="S4.SS5.p11.1.m1.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.1.m1.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p11.1.m1.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> is set to retrieve the most pertinent information from our <math alttext="K" class="ltx_Math" display="inline" id="S4.SS5.p11.2.m2.1"><semantics id="S4.SS5.p11.2.m2.1a"><mi id="S4.SS5.p11.2.m2.1.1" xref="S4.SS5.p11.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.2.m2.1b"><ci id="S4.SS5.p11.2.m2.1.1.cmml" xref="S4.SS5.p11.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p11.2.m2.1d">italic_K</annotation></semantics></math>. If all events are qualified, <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p11.3.m3.1"><semantics id="S4.SS5.p11.3.m3.1a"><mrow id="S4.SS5.p11.3.m3.1.1" xref="S4.SS5.p11.3.m3.1.1.cmml"><mi id="S4.SS5.p11.3.m3.1.1.2" xref="S4.SS5.p11.3.m3.1.1.2.cmml">t</mi><mo id="S4.SS5.p11.3.m3.1.1.1" xref="S4.SS5.p11.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.3.m3.1.1.3" xref="S4.SS5.p11.3.m3.1.1.3.cmml">o</mi><mo id="S4.SS5.p11.3.m3.1.1.1a" xref="S4.SS5.p11.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.3.m3.1.1.4" xref="S4.SS5.p11.3.m3.1.1.4.cmml">p</mi><mo id="S4.SS5.p11.3.m3.1.1.1b" xref="S4.SS5.p11.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.3.m3.1.1.5" xref="S4.SS5.p11.3.m3.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.3.m3.1b"><apply id="S4.SS5.p11.3.m3.1.1.cmml" xref="S4.SS5.p11.3.m3.1.1"><times id="S4.SS5.p11.3.m3.1.1.1.cmml" xref="S4.SS5.p11.3.m3.1.1.1"></times><ci id="S4.SS5.p11.3.m3.1.1.2.cmml" xref="S4.SS5.p11.3.m3.1.1.2">𝑡</ci><ci id="S4.SS5.p11.3.m3.1.1.3.cmml" xref="S4.SS5.p11.3.m3.1.1.3">𝑜</ci><ci id="S4.SS5.p11.3.m3.1.1.4.cmml" xref="S4.SS5.p11.3.m3.1.1.4">𝑝</ci><ci id="S4.SS5.p11.3.m3.1.1.5.cmml" xref="S4.SS5.p11.3.m3.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.3.m3.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p11.3.m3.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> will be equal to <math alttext="E" class="ltx_Math" display="inline" id="S4.SS5.p11.4.m4.1"><semantics id="S4.SS5.p11.4.m4.1a"><mi id="S4.SS5.p11.4.m4.1.1" xref="S4.SS5.p11.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.4.m4.1b"><ci id="S4.SS5.p11.4.m4.1.1.cmml" xref="S4.SS5.p11.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p11.4.m4.1d">italic_E</annotation></semantics></math>. <math alttext="TA" class="ltx_Math" display="inline" id="S4.SS5.p11.5.m5.1"><semantics id="S4.SS5.p11.5.m5.1a"><mrow id="S4.SS5.p11.5.m5.1.1" xref="S4.SS5.p11.5.m5.1.1.cmml"><mi id="S4.SS5.p11.5.m5.1.1.2" xref="S4.SS5.p11.5.m5.1.1.2.cmml">T</mi><mo id="S4.SS5.p11.5.m5.1.1.1" xref="S4.SS5.p11.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p11.5.m5.1.1.3" xref="S4.SS5.p11.5.m5.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p11.5.m5.1b"><apply id="S4.SS5.p11.5.m5.1.1.cmml" xref="S4.SS5.p11.5.m5.1.1"><times id="S4.SS5.p11.5.m5.1.1.1.cmml" xref="S4.SS5.p11.5.m5.1.1.1"></times><ci id="S4.SS5.p11.5.m5.1.1.2.cmml" xref="S4.SS5.p11.5.m5.1.1.2">𝑇</ci><ci id="S4.SS5.p11.5.m5.1.1.3.cmml" xref="S4.SS5.p11.5.m5.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p11.5.m5.1c">TA</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p11.5.m5.1d">italic_T italic_A</annotation></semantics></math> represents the set of qualified events for TA.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="TA=E" class="ltx_Math" display="block" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><mrow id="S4.E10.m1.1.1.2" xref="S4.E10.m1.1.1.2.cmml"><mi id="S4.E10.m1.1.1.2.2" xref="S4.E10.m1.1.1.2.2.cmml">T</mi><mo id="S4.E10.m1.1.1.2.1" xref="S4.E10.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.E10.m1.1.1.2.3" xref="S4.E10.m1.1.1.2.3.cmml">A</mi></mrow><mo id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml">=</mo><mi id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><eq id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"></eq><apply id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1.2"><times id="S4.E10.m1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.2.1"></times><ci id="S4.E10.m1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.2.2">𝑇</ci><ci id="S4.E10.m1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.2.3">𝐴</ci></apply><ci id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">TA=E</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">italic_T italic_A = italic_E</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS5.p12">
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="topk=|E|" class="ltx_Math" display="block" id="S4.E11.m1.1"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.2" xref="S4.E11.m1.1.2.cmml"><mrow id="S4.E11.m1.1.2.2" xref="S4.E11.m1.1.2.2.cmml"><mi id="S4.E11.m1.1.2.2.2" xref="S4.E11.m1.1.2.2.2.cmml">t</mi><mo id="S4.E11.m1.1.2.2.1" xref="S4.E11.m1.1.2.2.1.cmml">⁢</mo><mi id="S4.E11.m1.1.2.2.3" xref="S4.E11.m1.1.2.2.3.cmml">o</mi><mo id="S4.E11.m1.1.2.2.1a" xref="S4.E11.m1.1.2.2.1.cmml">⁢</mo><mi id="S4.E11.m1.1.2.2.4" xref="S4.E11.m1.1.2.2.4.cmml">p</mi><mo id="S4.E11.m1.1.2.2.1b" xref="S4.E11.m1.1.2.2.1.cmml">⁢</mo><mi id="S4.E11.m1.1.2.2.5" xref="S4.E11.m1.1.2.2.5.cmml">k</mi></mrow><mo id="S4.E11.m1.1.2.1" xref="S4.E11.m1.1.2.1.cmml">=</mo><mrow id="S4.E11.m1.1.2.3.2" xref="S4.E11.m1.1.2.3.1.cmml"><mo id="S4.E11.m1.1.2.3.2.1" stretchy="false" xref="S4.E11.m1.1.2.3.1.1.cmml">|</mo><mi id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">E</mi><mo id="S4.E11.m1.1.2.3.2.2" stretchy="false" xref="S4.E11.m1.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.2.cmml" xref="S4.E11.m1.1.2"><eq id="S4.E11.m1.1.2.1.cmml" xref="S4.E11.m1.1.2.1"></eq><apply id="S4.E11.m1.1.2.2.cmml" xref="S4.E11.m1.1.2.2"><times id="S4.E11.m1.1.2.2.1.cmml" xref="S4.E11.m1.1.2.2.1"></times><ci id="S4.E11.m1.1.2.2.2.cmml" xref="S4.E11.m1.1.2.2.2">𝑡</ci><ci id="S4.E11.m1.1.2.2.3.cmml" xref="S4.E11.m1.1.2.2.3">𝑜</ci><ci id="S4.E11.m1.1.2.2.4.cmml" xref="S4.E11.m1.1.2.2.4">𝑝</ci><ci id="S4.E11.m1.1.2.2.5.cmml" xref="S4.E11.m1.1.2.2.5">𝑘</ci></apply><apply id="S4.E11.m1.1.2.3.1.cmml" xref="S4.E11.m1.1.2.3.2"><abs id="S4.E11.m1.1.2.3.1.1.cmml" xref="S4.E11.m1.1.2.3.2.1"></abs><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">topk=|E|</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.1d">italic_t italic_o italic_p italic_k = | italic_E |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p13">
<p class="ltx_p" id="S4.SS5.p13.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p13.1.1">3)</span> The larger value we assign to <math alttext="topk" class="ltx_Math" display="inline" id="S4.SS5.p13.1.m1.1"><semantics id="S4.SS5.p13.1.m1.1a"><mrow id="S4.SS5.p13.1.m1.1.1" xref="S4.SS5.p13.1.m1.1.1.cmml"><mi id="S4.SS5.p13.1.m1.1.1.2" xref="S4.SS5.p13.1.m1.1.1.2.cmml">t</mi><mo id="S4.SS5.p13.1.m1.1.1.1" xref="S4.SS5.p13.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p13.1.m1.1.1.3" xref="S4.SS5.p13.1.m1.1.1.3.cmml">o</mi><mo id="S4.SS5.p13.1.m1.1.1.1a" xref="S4.SS5.p13.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p13.1.m1.1.1.4" xref="S4.SS5.p13.1.m1.1.1.4.cmml">p</mi><mo id="S4.SS5.p13.1.m1.1.1.1b" xref="S4.SS5.p13.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p13.1.m1.1.1.5" xref="S4.SS5.p13.1.m1.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p13.1.m1.1b"><apply id="S4.SS5.p13.1.m1.1.1.cmml" xref="S4.SS5.p13.1.m1.1.1"><times id="S4.SS5.p13.1.m1.1.1.1.cmml" xref="S4.SS5.p13.1.m1.1.1.1"></times><ci id="S4.SS5.p13.1.m1.1.1.2.cmml" xref="S4.SS5.p13.1.m1.1.1.2">𝑡</ci><ci id="S4.SS5.p13.1.m1.1.1.3.cmml" xref="S4.SS5.p13.1.m1.1.1.3">𝑜</ci><ci id="S4.SS5.p13.1.m1.1.1.4.cmml" xref="S4.SS5.p13.1.m1.1.1.4">𝑝</ci><ci id="S4.SS5.p13.1.m1.1.1.5.cmml" xref="S4.SS5.p13.1.m1.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p13.1.m1.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p13.1.m1.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>, the more precise the retrieval and detailed consideration we get in the output.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p14">
<p class="ltx_p" id="S4.SS5.p14.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F7" title="Figure 7 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F8" title="Figure 8 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a> illustrate two cases of incident investigation using a 3D representation where the x, y, and z axes correspond to context features from LLM embedding vectors.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg4.2.1.1">Algorithm 4</span> </span> Refine Query</figcaption>
<div class="ltx_listing ltx_listing" id="alg4.3">
<div class="ltx_listingline" id="alg4.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l1.1.1.1" style="font-size:80%;">1:</span></span>User Input (Query) <math alttext="UI" class="ltx_Math" display="inline" id="alg4.l1.m1.1"><semantics id="alg4.l1.m1.1a"><mrow id="alg4.l1.m1.1.1" xref="alg4.l1.m1.1.1.cmml"><mi id="alg4.l1.m1.1.1.2" xref="alg4.l1.m1.1.1.2.cmml">U</mi><mo id="alg4.l1.m1.1.1.1" xref="alg4.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.3" xref="alg4.l1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><apply id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1"><times id="alg4.l1.m1.1.1.1.cmml" xref="alg4.l1.m1.1.1.1"></times><ci id="alg4.l1.m1.1.1.2.cmml" xref="alg4.l1.m1.1.1.2">𝑈</ci><ci id="alg4.l1.m1.1.1.3.cmml" xref="alg4.l1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.1d">italic_U italic_I</annotation></semantics></math>, Previous Conversation <math alttext="PC" class="ltx_Math" display="inline" id="alg4.l1.m2.1"><semantics id="alg4.l1.m2.1a"><mrow id="alg4.l1.m2.1.1" xref="alg4.l1.m2.1.1.cmml"><mi id="alg4.l1.m2.1.1.2" xref="alg4.l1.m2.1.1.2.cmml">P</mi><mo id="alg4.l1.m2.1.1.1" xref="alg4.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m2.1.1.3" xref="alg4.l1.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m2.1b"><apply id="alg4.l1.m2.1.1.cmml" xref="alg4.l1.m2.1.1"><times id="alg4.l1.m2.1.1.1.cmml" xref="alg4.l1.m2.1.1.1"></times><ci id="alg4.l1.m2.1.1.2.cmml" xref="alg4.l1.m2.1.1.2">𝑃</ci><ci id="alg4.l1.m2.1.1.3.cmml" xref="alg4.l1.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m2.1c">PC</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m2.1d">italic_P italic_C</annotation></semantics></math>, LLM Model <math alttext="LLMModel" class="ltx_Math" display="inline" id="alg4.l1.m3.1"><semantics id="alg4.l1.m3.1a"><mrow id="alg4.l1.m3.1.1" xref="alg4.l1.m3.1.1.cmml"><mi id="alg4.l1.m3.1.1.2" xref="alg4.l1.m3.1.1.2.cmml">L</mi><mo id="alg4.l1.m3.1.1.1" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.3" xref="alg4.l1.m3.1.1.3.cmml">L</mi><mo id="alg4.l1.m3.1.1.1a" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.4" xref="alg4.l1.m3.1.1.4.cmml">M</mi><mo id="alg4.l1.m3.1.1.1b" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.5" xref="alg4.l1.m3.1.1.5.cmml">M</mi><mo id="alg4.l1.m3.1.1.1c" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.6" xref="alg4.l1.m3.1.1.6.cmml">o</mi><mo id="alg4.l1.m3.1.1.1d" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.7" xref="alg4.l1.m3.1.1.7.cmml">d</mi><mo id="alg4.l1.m3.1.1.1e" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.8" xref="alg4.l1.m3.1.1.8.cmml">e</mi><mo id="alg4.l1.m3.1.1.1f" xref="alg4.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m3.1.1.9" xref="alg4.l1.m3.1.1.9.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m3.1b"><apply id="alg4.l1.m3.1.1.cmml" xref="alg4.l1.m3.1.1"><times id="alg4.l1.m3.1.1.1.cmml" xref="alg4.l1.m3.1.1.1"></times><ci id="alg4.l1.m3.1.1.2.cmml" xref="alg4.l1.m3.1.1.2">𝐿</ci><ci id="alg4.l1.m3.1.1.3.cmml" xref="alg4.l1.m3.1.1.3">𝐿</ci><ci id="alg4.l1.m3.1.1.4.cmml" xref="alg4.l1.m3.1.1.4">𝑀</ci><ci id="alg4.l1.m3.1.1.5.cmml" xref="alg4.l1.m3.1.1.5">𝑀</ci><ci id="alg4.l1.m3.1.1.6.cmml" xref="alg4.l1.m3.1.1.6">𝑜</ci><ci id="alg4.l1.m3.1.1.7.cmml" xref="alg4.l1.m3.1.1.7">𝑑</ci><ci id="alg4.l1.m3.1.1.8.cmml" xref="alg4.l1.m3.1.1.8">𝑒</ci><ci id="alg4.l1.m3.1.1.9.cmml" xref="alg4.l1.m3.1.1.9">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m3.1c">LLMModel</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m3.1d">italic_L italic_L italic_M italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>, AI System Message <math alttext="SysMsg" class="ltx_Math" display="inline" id="alg4.l1.m4.1"><semantics id="alg4.l1.m4.1a"><mrow id="alg4.l1.m4.1.1" xref="alg4.l1.m4.1.1.cmml"><mi id="alg4.l1.m4.1.1.2" xref="alg4.l1.m4.1.1.2.cmml">S</mi><mo id="alg4.l1.m4.1.1.1" xref="alg4.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m4.1.1.3" xref="alg4.l1.m4.1.1.3.cmml">y</mi><mo id="alg4.l1.m4.1.1.1a" xref="alg4.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m4.1.1.4" xref="alg4.l1.m4.1.1.4.cmml">s</mi><mo id="alg4.l1.m4.1.1.1b" xref="alg4.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m4.1.1.5" xref="alg4.l1.m4.1.1.5.cmml">M</mi><mo id="alg4.l1.m4.1.1.1c" xref="alg4.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m4.1.1.6" xref="alg4.l1.m4.1.1.6.cmml">s</mi><mo id="alg4.l1.m4.1.1.1d" xref="alg4.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m4.1.1.7" xref="alg4.l1.m4.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m4.1b"><apply id="alg4.l1.m4.1.1.cmml" xref="alg4.l1.m4.1.1"><times id="alg4.l1.m4.1.1.1.cmml" xref="alg4.l1.m4.1.1.1"></times><ci id="alg4.l1.m4.1.1.2.cmml" xref="alg4.l1.m4.1.1.2">𝑆</ci><ci id="alg4.l1.m4.1.1.3.cmml" xref="alg4.l1.m4.1.1.3">𝑦</ci><ci id="alg4.l1.m4.1.1.4.cmml" xref="alg4.l1.m4.1.1.4">𝑠</ci><ci id="alg4.l1.m4.1.1.5.cmml" xref="alg4.l1.m4.1.1.5">𝑀</ci><ci id="alg4.l1.m4.1.1.6.cmml" xref="alg4.l1.m4.1.1.6">𝑠</ci><ci id="alg4.l1.m4.1.1.7.cmml" xref="alg4.l1.m4.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m4.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m4.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l2.1.1.1" style="font-size:80%;">2:</span></span>A successfully manipulated query (New Query - RAG Agent Rewritten Input) tailored to the desired context <math alttext="RI" class="ltx_Math" display="inline" id="alg4.l2.m1.1"><semantics id="alg4.l2.m1.1a"><mrow id="alg4.l2.m1.1.1" xref="alg4.l2.m1.1.1.cmml"><mi id="alg4.l2.m1.1.1.2" xref="alg4.l2.m1.1.1.2.cmml">R</mi><mo id="alg4.l2.m1.1.1.1" xref="alg4.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l2.m1.1.1.3" xref="alg4.l2.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l2.m1.1b"><apply id="alg4.l2.m1.1.1.cmml" xref="alg4.l2.m1.1.1"><times id="alg4.l2.m1.1.1.1.cmml" xref="alg4.l2.m1.1.1.1"></times><ci id="alg4.l2.m1.1.1.2.cmml" xref="alg4.l2.m1.1.1.2">𝑅</ci><ci id="alg4.l2.m1.1.1.3.cmml" xref="alg4.l2.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg4.l2.m1.1d">italic_R italic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg4.l3.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg4.l3.3">RefineQuery</span>(<math alttext="UI" class="ltx_Math" display="inline" id="alg4.l3.m1.1"><semantics id="alg4.l3.m1.1a"><mrow id="alg4.l3.m1.1.1" xref="alg4.l3.m1.1.1.cmml"><mi id="alg4.l3.m1.1.1.2" xref="alg4.l3.m1.1.1.2.cmml">U</mi><mo id="alg4.l3.m1.1.1.1" xref="alg4.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m1.1.1.3" xref="alg4.l3.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.1b"><apply id="alg4.l3.m1.1.1.cmml" xref="alg4.l3.m1.1.1"><times id="alg4.l3.m1.1.1.1.cmml" xref="alg4.l3.m1.1.1.1"></times><ci id="alg4.l3.m1.1.1.2.cmml" xref="alg4.l3.m1.1.1.2">𝑈</ci><ci id="alg4.l3.m1.1.1.3.cmml" xref="alg4.l3.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m1.1d">italic_U italic_I</annotation></semantics></math>, <math alttext="PC" class="ltx_Math" display="inline" id="alg4.l3.m2.1"><semantics id="alg4.l3.m2.1a"><mrow id="alg4.l3.m2.1.1" xref="alg4.l3.m2.1.1.cmml"><mi id="alg4.l3.m2.1.1.2" xref="alg4.l3.m2.1.1.2.cmml">P</mi><mo id="alg4.l3.m2.1.1.1" xref="alg4.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m2.1.1.3" xref="alg4.l3.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m2.1b"><apply id="alg4.l3.m2.1.1.cmml" xref="alg4.l3.m2.1.1"><times id="alg4.l3.m2.1.1.1.cmml" xref="alg4.l3.m2.1.1.1"></times><ci id="alg4.l3.m2.1.1.2.cmml" xref="alg4.l3.m2.1.1.2">𝑃</ci><ci id="alg4.l3.m2.1.1.3.cmml" xref="alg4.l3.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m2.1c">PC</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m2.1d">italic_P italic_C</annotation></semantics></math>, <math alttext="LLMModel" class="ltx_Math" display="inline" id="alg4.l3.m3.1"><semantics id="alg4.l3.m3.1a"><mrow id="alg4.l3.m3.1.1" xref="alg4.l3.m3.1.1.cmml"><mi id="alg4.l3.m3.1.1.2" xref="alg4.l3.m3.1.1.2.cmml">L</mi><mo id="alg4.l3.m3.1.1.1" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.3" xref="alg4.l3.m3.1.1.3.cmml">L</mi><mo id="alg4.l3.m3.1.1.1a" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.4" xref="alg4.l3.m3.1.1.4.cmml">M</mi><mo id="alg4.l3.m3.1.1.1b" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.5" xref="alg4.l3.m3.1.1.5.cmml">M</mi><mo id="alg4.l3.m3.1.1.1c" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.6" xref="alg4.l3.m3.1.1.6.cmml">o</mi><mo id="alg4.l3.m3.1.1.1d" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.7" xref="alg4.l3.m3.1.1.7.cmml">d</mi><mo id="alg4.l3.m3.1.1.1e" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.8" xref="alg4.l3.m3.1.1.8.cmml">e</mi><mo id="alg4.l3.m3.1.1.1f" xref="alg4.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m3.1.1.9" xref="alg4.l3.m3.1.1.9.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m3.1b"><apply id="alg4.l3.m3.1.1.cmml" xref="alg4.l3.m3.1.1"><times id="alg4.l3.m3.1.1.1.cmml" xref="alg4.l3.m3.1.1.1"></times><ci id="alg4.l3.m3.1.1.2.cmml" xref="alg4.l3.m3.1.1.2">𝐿</ci><ci id="alg4.l3.m3.1.1.3.cmml" xref="alg4.l3.m3.1.1.3">𝐿</ci><ci id="alg4.l3.m3.1.1.4.cmml" xref="alg4.l3.m3.1.1.4">𝑀</ci><ci id="alg4.l3.m3.1.1.5.cmml" xref="alg4.l3.m3.1.1.5">𝑀</ci><ci id="alg4.l3.m3.1.1.6.cmml" xref="alg4.l3.m3.1.1.6">𝑜</ci><ci id="alg4.l3.m3.1.1.7.cmml" xref="alg4.l3.m3.1.1.7">𝑑</ci><ci id="alg4.l3.m3.1.1.8.cmml" xref="alg4.l3.m3.1.1.8">𝑒</ci><ci id="alg4.l3.m3.1.1.9.cmml" xref="alg4.l3.m3.1.1.9">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m3.1c">LLMModel</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m3.1d">italic_L italic_L italic_M italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>, <math alttext="SysMsg" class="ltx_Math" display="inline" id="alg4.l3.m4.1"><semantics id="alg4.l3.m4.1a"><mrow id="alg4.l3.m4.1.1" xref="alg4.l3.m4.1.1.cmml"><mi id="alg4.l3.m4.1.1.2" xref="alg4.l3.m4.1.1.2.cmml">S</mi><mo id="alg4.l3.m4.1.1.1" xref="alg4.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m4.1.1.3" xref="alg4.l3.m4.1.1.3.cmml">y</mi><mo id="alg4.l3.m4.1.1.1a" xref="alg4.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m4.1.1.4" xref="alg4.l3.m4.1.1.4.cmml">s</mi><mo id="alg4.l3.m4.1.1.1b" xref="alg4.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m4.1.1.5" xref="alg4.l3.m4.1.1.5.cmml">M</mi><mo id="alg4.l3.m4.1.1.1c" xref="alg4.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m4.1.1.6" xref="alg4.l3.m4.1.1.6.cmml">s</mi><mo id="alg4.l3.m4.1.1.1d" xref="alg4.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l3.m4.1.1.7" xref="alg4.l3.m4.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l3.m4.1b"><apply id="alg4.l3.m4.1.1.cmml" xref="alg4.l3.m4.1.1"><times id="alg4.l3.m4.1.1.1.cmml" xref="alg4.l3.m4.1.1.1"></times><ci id="alg4.l3.m4.1.1.2.cmml" xref="alg4.l3.m4.1.1.2">𝑆</ci><ci id="alg4.l3.m4.1.1.3.cmml" xref="alg4.l3.m4.1.1.3">𝑦</ci><ci id="alg4.l3.m4.1.1.4.cmml" xref="alg4.l3.m4.1.1.4">𝑠</ci><ci id="alg4.l3.m4.1.1.5.cmml" xref="alg4.l3.m4.1.1.5">𝑀</ci><ci id="alg4.l3.m4.1.1.6.cmml" xref="alg4.l3.m4.1.1.6">𝑠</ci><ci id="alg4.l3.m4.1.1.7.cmml" xref="alg4.l3.m4.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m4.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m4.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg4.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l4.1.1.1" style="font-size:80%;">4:</span></span>     Load Llama-3.1 Agent, <math alttext="Agent" class="ltx_Math" display="inline" id="alg4.l4.m1.1"><semantics id="alg4.l4.m1.1a"><mrow id="alg4.l4.m1.1.1" xref="alg4.l4.m1.1.1.cmml"><mi id="alg4.l4.m1.1.1.2" xref="alg4.l4.m1.1.1.2.cmml">A</mi><mo id="alg4.l4.m1.1.1.1" xref="alg4.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l4.m1.1.1.3" xref="alg4.l4.m1.1.1.3.cmml">g</mi><mo id="alg4.l4.m1.1.1.1a" xref="alg4.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l4.m1.1.1.4" xref="alg4.l4.m1.1.1.4.cmml">e</mi><mo id="alg4.l4.m1.1.1.1b" xref="alg4.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l4.m1.1.1.5" xref="alg4.l4.m1.1.1.5.cmml">n</mi><mo id="alg4.l4.m1.1.1.1c" xref="alg4.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l4.m1.1.1.6" xref="alg4.l4.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.1b"><apply id="alg4.l4.m1.1.1.cmml" xref="alg4.l4.m1.1.1"><times id="alg4.l4.m1.1.1.1.cmml" xref="alg4.l4.m1.1.1.1"></times><ci id="alg4.l4.m1.1.1.2.cmml" xref="alg4.l4.m1.1.1.2">𝐴</ci><ci id="alg4.l4.m1.1.1.3.cmml" xref="alg4.l4.m1.1.1.3">𝑔</ci><ci id="alg4.l4.m1.1.1.4.cmml" xref="alg4.l4.m1.1.1.4">𝑒</ci><ci id="alg4.l4.m1.1.1.5.cmml" xref="alg4.l4.m1.1.1.5">𝑛</ci><ci id="alg4.l4.m1.1.1.6.cmml" xref="alg4.l4.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.1c">Agent</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m1.1d">italic_A italic_g italic_e italic_n italic_t</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l5.1.1.1" style="font-size:80%;">5:</span></span>     Load Embedding Model <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg4.l5.m1.1"><semantics id="alg4.l5.m1.1a"><mrow id="alg4.l5.m1.1.1" xref="alg4.l5.m1.1.1.cmml"><mi id="alg4.l5.m1.1.1.2" xref="alg4.l5.m1.1.1.2.cmml">E</mi><mo id="alg4.l5.m1.1.1.1" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.3" xref="alg4.l5.m1.1.1.3.cmml">m</mi><mo id="alg4.l5.m1.1.1.1a" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.4" xref="alg4.l5.m1.1.1.4.cmml">b</mi><mo id="alg4.l5.m1.1.1.1b" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.5" xref="alg4.l5.m1.1.1.5.cmml">e</mi><mo id="alg4.l5.m1.1.1.1c" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.6" xref="alg4.l5.m1.1.1.6.cmml">d</mi><mo id="alg4.l5.m1.1.1.1d" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.7" xref="alg4.l5.m1.1.1.7.cmml">M</mi><mo id="alg4.l5.m1.1.1.1e" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.8" xref="alg4.l5.m1.1.1.8.cmml">o</mi><mo id="alg4.l5.m1.1.1.1f" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.9" xref="alg4.l5.m1.1.1.9.cmml">d</mi><mo id="alg4.l5.m1.1.1.1g" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.10" xref="alg4.l5.m1.1.1.10.cmml">e</mi><mo id="alg4.l5.m1.1.1.1h" xref="alg4.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.11" xref="alg4.l5.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.m1.1b"><apply id="alg4.l5.m1.1.1.cmml" xref="alg4.l5.m1.1.1"><times id="alg4.l5.m1.1.1.1.cmml" xref="alg4.l5.m1.1.1.1"></times><ci id="alg4.l5.m1.1.1.2.cmml" xref="alg4.l5.m1.1.1.2">𝐸</ci><ci id="alg4.l5.m1.1.1.3.cmml" xref="alg4.l5.m1.1.1.3">𝑚</ci><ci id="alg4.l5.m1.1.1.4.cmml" xref="alg4.l5.m1.1.1.4">𝑏</ci><ci id="alg4.l5.m1.1.1.5.cmml" xref="alg4.l5.m1.1.1.5">𝑒</ci><ci id="alg4.l5.m1.1.1.6.cmml" xref="alg4.l5.m1.1.1.6">𝑑</ci><ci id="alg4.l5.m1.1.1.7.cmml" xref="alg4.l5.m1.1.1.7">𝑀</ci><ci id="alg4.l5.m1.1.1.8.cmml" xref="alg4.l5.m1.1.1.8">𝑜</ci><ci id="alg4.l5.m1.1.1.9.cmml" xref="alg4.l5.m1.1.1.9">𝑑</ci><ci id="alg4.l5.m1.1.1.10.cmml" xref="alg4.l5.m1.1.1.10">𝑒</ci><ci id="alg4.l5.m1.1.1.11.cmml" xref="alg4.l5.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg4.l6.m1.1"><semantics id="alg4.l6.m1.1a"><mrow id="alg4.l6.m1.1.1" xref="alg4.l6.m1.1.1.cmml"><mi id="alg4.l6.m1.1.1.2" xref="alg4.l6.m1.1.1.2.cmml">E</mi><mo id="alg4.l6.m1.1.1.1" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.3" xref="alg4.l6.m1.1.1.3.cmml">m</mi><mo id="alg4.l6.m1.1.1.1a" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.4" xref="alg4.l6.m1.1.1.4.cmml">b</mi><mo id="alg4.l6.m1.1.1.1b" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.5" xref="alg4.l6.m1.1.1.5.cmml">e</mi><mo id="alg4.l6.m1.1.1.1c" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.6" xref="alg4.l6.m1.1.1.6.cmml">d</mi><mo id="alg4.l6.m1.1.1.1d" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.7" xref="alg4.l6.m1.1.1.7.cmml">M</mi><mo id="alg4.l6.m1.1.1.1e" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.8" xref="alg4.l6.m1.1.1.8.cmml">o</mi><mo id="alg4.l6.m1.1.1.1f" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.9" xref="alg4.l6.m1.1.1.9.cmml">d</mi><mo id="alg4.l6.m1.1.1.1g" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.10" xref="alg4.l6.m1.1.1.10.cmml">e</mi><mo id="alg4.l6.m1.1.1.1h" xref="alg4.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l6.m1.1.1.11" xref="alg4.l6.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.m1.1b"><apply id="alg4.l6.m1.1.1.cmml" xref="alg4.l6.m1.1.1"><times id="alg4.l6.m1.1.1.1.cmml" xref="alg4.l6.m1.1.1.1"></times><ci id="alg4.l6.m1.1.1.2.cmml" xref="alg4.l6.m1.1.1.2">𝐸</ci><ci id="alg4.l6.m1.1.1.3.cmml" xref="alg4.l6.m1.1.1.3">𝑚</ci><ci id="alg4.l6.m1.1.1.4.cmml" xref="alg4.l6.m1.1.1.4">𝑏</ci><ci id="alg4.l6.m1.1.1.5.cmml" xref="alg4.l6.m1.1.1.5">𝑒</ci><ci id="alg4.l6.m1.1.1.6.cmml" xref="alg4.l6.m1.1.1.6">𝑑</ci><ci id="alg4.l6.m1.1.1.7.cmml" xref="alg4.l6.m1.1.1.7">𝑀</ci><ci id="alg4.l6.m1.1.1.8.cmml" xref="alg4.l6.m1.1.1.8">𝑜</ci><ci id="alg4.l6.m1.1.1.9.cmml" xref="alg4.l6.m1.1.1.9">𝑑</ci><ci id="alg4.l6.m1.1.1.10.cmml" xref="alg4.l6.m1.1.1.10">𝑒</ci><ci id="alg4.l6.m1.1.1.11.cmml" xref="alg4.l6.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>=’mxbai-embed-large’

</div>
<div class="ltx_listingline" id="alg4.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l7.1.1.1" style="font-size:80%;">7:</span></span>     <math alttext="AgentPrompt" class="ltx_Math" display="inline" id="alg4.l7.m1.1"><semantics id="alg4.l7.m1.1a"><mrow id="alg4.l7.m1.1.1" xref="alg4.l7.m1.1.1.cmml"><mi id="alg4.l7.m1.1.1.2" xref="alg4.l7.m1.1.1.2.cmml">A</mi><mo id="alg4.l7.m1.1.1.1" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.3" xref="alg4.l7.m1.1.1.3.cmml">g</mi><mo id="alg4.l7.m1.1.1.1a" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.4" xref="alg4.l7.m1.1.1.4.cmml">e</mi><mo id="alg4.l7.m1.1.1.1b" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.5" xref="alg4.l7.m1.1.1.5.cmml">n</mi><mo id="alg4.l7.m1.1.1.1c" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.6" xref="alg4.l7.m1.1.1.6.cmml">t</mi><mo id="alg4.l7.m1.1.1.1d" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.7" xref="alg4.l7.m1.1.1.7.cmml">P</mi><mo id="alg4.l7.m1.1.1.1e" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.8" xref="alg4.l7.m1.1.1.8.cmml">r</mi><mo id="alg4.l7.m1.1.1.1f" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.9" xref="alg4.l7.m1.1.1.9.cmml">o</mi><mo id="alg4.l7.m1.1.1.1g" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.10" xref="alg4.l7.m1.1.1.10.cmml">m</mi><mo id="alg4.l7.m1.1.1.1h" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.11" xref="alg4.l7.m1.1.1.11.cmml">p</mi><mo id="alg4.l7.m1.1.1.1i" xref="alg4.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l7.m1.1.1.12" xref="alg4.l7.m1.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.m1.1b"><apply id="alg4.l7.m1.1.1.cmml" xref="alg4.l7.m1.1.1"><times id="alg4.l7.m1.1.1.1.cmml" xref="alg4.l7.m1.1.1.1"></times><ci id="alg4.l7.m1.1.1.2.cmml" xref="alg4.l7.m1.1.1.2">𝐴</ci><ci id="alg4.l7.m1.1.1.3.cmml" xref="alg4.l7.m1.1.1.3">𝑔</ci><ci id="alg4.l7.m1.1.1.4.cmml" xref="alg4.l7.m1.1.1.4">𝑒</ci><ci id="alg4.l7.m1.1.1.5.cmml" xref="alg4.l7.m1.1.1.5">𝑛</ci><ci id="alg4.l7.m1.1.1.6.cmml" xref="alg4.l7.m1.1.1.6">𝑡</ci><ci id="alg4.l7.m1.1.1.7.cmml" xref="alg4.l7.m1.1.1.7">𝑃</ci><ci id="alg4.l7.m1.1.1.8.cmml" xref="alg4.l7.m1.1.1.8">𝑟</ci><ci id="alg4.l7.m1.1.1.9.cmml" xref="alg4.l7.m1.1.1.9">𝑜</ci><ci id="alg4.l7.m1.1.1.10.cmml" xref="alg4.l7.m1.1.1.10">𝑚</ci><ci id="alg4.l7.m1.1.1.11.cmml" xref="alg4.l7.m1.1.1.11">𝑝</ci><ci id="alg4.l7.m1.1.1.12.cmml" xref="alg4.l7.m1.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.m1.1c">AgentPrompt</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.m1.1d">italic_A italic_g italic_e italic_n italic_t italic_P italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math> = "You are a Cybersecurity and Digital Forensics and Incident Response (DFIR) expert. Identify events and information related to the cyber incident, basing your responses solely on the provided context. Do not include details or knowledge beyond the given context."

</div>
<div class="ltx_listingline" id="alg4.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l8.1.1.1" style="font-size:80%;">8:</span></span>     <math alttext="Agent" class="ltx_Math" display="inline" id="alg4.l8.m1.1"><semantics id="alg4.l8.m1.1a"><mrow id="alg4.l8.m1.1.1" xref="alg4.l8.m1.1.1.cmml"><mi id="alg4.l8.m1.1.1.2" xref="alg4.l8.m1.1.1.2.cmml">A</mi><mo id="alg4.l8.m1.1.1.1" xref="alg4.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l8.m1.1.1.3" xref="alg4.l8.m1.1.1.3.cmml">g</mi><mo id="alg4.l8.m1.1.1.1a" xref="alg4.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l8.m1.1.1.4" xref="alg4.l8.m1.1.1.4.cmml">e</mi><mo id="alg4.l8.m1.1.1.1b" xref="alg4.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l8.m1.1.1.5" xref="alg4.l8.m1.1.1.5.cmml">n</mi><mo id="alg4.l8.m1.1.1.1c" xref="alg4.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l8.m1.1.1.6" xref="alg4.l8.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l8.m1.1b"><apply id="alg4.l8.m1.1.1.cmml" xref="alg4.l8.m1.1.1"><times id="alg4.l8.m1.1.1.1.cmml" xref="alg4.l8.m1.1.1.1"></times><ci id="alg4.l8.m1.1.1.2.cmml" xref="alg4.l8.m1.1.1.2">𝐴</ci><ci id="alg4.l8.m1.1.1.3.cmml" xref="alg4.l8.m1.1.1.3">𝑔</ci><ci id="alg4.l8.m1.1.1.4.cmml" xref="alg4.l8.m1.1.1.4">𝑒</ci><ci id="alg4.l8.m1.1.1.5.cmml" xref="alg4.l8.m1.1.1.5">𝑛</ci><ci id="alg4.l8.m1.1.1.6.cmml" xref="alg4.l8.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l8.m1.1c">Agent</annotation><annotation encoding="application/x-llamapun" id="alg4.l8.m1.1d">italic_A italic_g italic_e italic_n italic_t</annotation></semantics></math> {

</div>
<div class="ltx_listingline" id="alg4.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l9.1.1.1" style="font-size:80%;">9:</span></span>     <math alttext="role" class="ltx_Math" display="inline" id="alg4.l9.m1.1"><semantics id="alg4.l9.m1.1a"><mrow id="alg4.l9.m1.1.1" xref="alg4.l9.m1.1.1.cmml"><mi id="alg4.l9.m1.1.1.2" xref="alg4.l9.m1.1.1.2.cmml">r</mi><mo id="alg4.l9.m1.1.1.1" xref="alg4.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m1.1.1.3" xref="alg4.l9.m1.1.1.3.cmml">o</mi><mo id="alg4.l9.m1.1.1.1a" xref="alg4.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m1.1.1.4" xref="alg4.l9.m1.1.1.4.cmml">l</mi><mo id="alg4.l9.m1.1.1.1b" xref="alg4.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m1.1.1.5" xref="alg4.l9.m1.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l9.m1.1b"><apply id="alg4.l9.m1.1.1.cmml" xref="alg4.l9.m1.1.1"><times id="alg4.l9.m1.1.1.1.cmml" xref="alg4.l9.m1.1.1.1"></times><ci id="alg4.l9.m1.1.1.2.cmml" xref="alg4.l9.m1.1.1.2">𝑟</ci><ci id="alg4.l9.m1.1.1.3.cmml" xref="alg4.l9.m1.1.1.3">𝑜</ci><ci id="alg4.l9.m1.1.1.4.cmml" xref="alg4.l9.m1.1.1.4">𝑙</ci><ci id="alg4.l9.m1.1.1.5.cmml" xref="alg4.l9.m1.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.m1.1c">role</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.m1.1d">italic_r italic_o italic_l italic_e</annotation></semantics></math> = <math alttext="SysMsg" class="ltx_Math" display="inline" id="alg4.l9.m2.1"><semantics id="alg4.l9.m2.1a"><mrow id="alg4.l9.m2.1.1" xref="alg4.l9.m2.1.1.cmml"><mi id="alg4.l9.m2.1.1.2" xref="alg4.l9.m2.1.1.2.cmml">S</mi><mo id="alg4.l9.m2.1.1.1" xref="alg4.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m2.1.1.3" xref="alg4.l9.m2.1.1.3.cmml">y</mi><mo id="alg4.l9.m2.1.1.1a" xref="alg4.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m2.1.1.4" xref="alg4.l9.m2.1.1.4.cmml">s</mi><mo id="alg4.l9.m2.1.1.1b" xref="alg4.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m2.1.1.5" xref="alg4.l9.m2.1.1.5.cmml">M</mi><mo id="alg4.l9.m2.1.1.1c" xref="alg4.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m2.1.1.6" xref="alg4.l9.m2.1.1.6.cmml">s</mi><mo id="alg4.l9.m2.1.1.1d" xref="alg4.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l9.m2.1.1.7" xref="alg4.l9.m2.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l9.m2.1b"><apply id="alg4.l9.m2.1.1.cmml" xref="alg4.l9.m2.1.1"><times id="alg4.l9.m2.1.1.1.cmml" xref="alg4.l9.m2.1.1.1"></times><ci id="alg4.l9.m2.1.1.2.cmml" xref="alg4.l9.m2.1.1.2">𝑆</ci><ci id="alg4.l9.m2.1.1.3.cmml" xref="alg4.l9.m2.1.1.3">𝑦</ci><ci id="alg4.l9.m2.1.1.4.cmml" xref="alg4.l9.m2.1.1.4">𝑠</ci><ci id="alg4.l9.m2.1.1.5.cmml" xref="alg4.l9.m2.1.1.5">𝑀</ci><ci id="alg4.l9.m2.1.1.6.cmml" xref="alg4.l9.m2.1.1.6">𝑠</ci><ci id="alg4.l9.m2.1.1.7.cmml" xref="alg4.l9.m2.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.m2.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.m2.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l10.1.1.1" style="font-size:80%;">10:</span></span>     <math alttext="content" class="ltx_Math" display="inline" id="alg4.l10.m1.1"><semantics id="alg4.l10.m1.1a"><mrow id="alg4.l10.m1.1.1" xref="alg4.l10.m1.1.1.cmml"><mi id="alg4.l10.m1.1.1.2" xref="alg4.l10.m1.1.1.2.cmml">c</mi><mo id="alg4.l10.m1.1.1.1" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.3" xref="alg4.l10.m1.1.1.3.cmml">o</mi><mo id="alg4.l10.m1.1.1.1a" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.4" xref="alg4.l10.m1.1.1.4.cmml">n</mi><mo id="alg4.l10.m1.1.1.1b" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.5" xref="alg4.l10.m1.1.1.5.cmml">t</mi><mo id="alg4.l10.m1.1.1.1c" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.6" xref="alg4.l10.m1.1.1.6.cmml">e</mi><mo id="alg4.l10.m1.1.1.1d" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.7" xref="alg4.l10.m1.1.1.7.cmml">n</mi><mo id="alg4.l10.m1.1.1.1e" xref="alg4.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m1.1.1.8" xref="alg4.l10.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l10.m1.1b"><apply id="alg4.l10.m1.1.1.cmml" xref="alg4.l10.m1.1.1"><times id="alg4.l10.m1.1.1.1.cmml" xref="alg4.l10.m1.1.1.1"></times><ci id="alg4.l10.m1.1.1.2.cmml" xref="alg4.l10.m1.1.1.2">𝑐</ci><ci id="alg4.l10.m1.1.1.3.cmml" xref="alg4.l10.m1.1.1.3">𝑜</ci><ci id="alg4.l10.m1.1.1.4.cmml" xref="alg4.l10.m1.1.1.4">𝑛</ci><ci id="alg4.l10.m1.1.1.5.cmml" xref="alg4.l10.m1.1.1.5">𝑡</ci><ci id="alg4.l10.m1.1.1.6.cmml" xref="alg4.l10.m1.1.1.6">𝑒</ci><ci id="alg4.l10.m1.1.1.7.cmml" xref="alg4.l10.m1.1.1.7">𝑛</ci><ci id="alg4.l10.m1.1.1.8.cmml" xref="alg4.l10.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m1.1c">content</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.m1.1d">italic_c italic_o italic_n italic_t italic_e italic_n italic_t</annotation></semantics></math> = <math alttext="AgentPrompt" class="ltx_Math" display="inline" id="alg4.l10.m2.1"><semantics id="alg4.l10.m2.1a"><mrow id="alg4.l10.m2.1.1" xref="alg4.l10.m2.1.1.cmml"><mi id="alg4.l10.m2.1.1.2" xref="alg4.l10.m2.1.1.2.cmml">A</mi><mo id="alg4.l10.m2.1.1.1" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.3" xref="alg4.l10.m2.1.1.3.cmml">g</mi><mo id="alg4.l10.m2.1.1.1a" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.4" xref="alg4.l10.m2.1.1.4.cmml">e</mi><mo id="alg4.l10.m2.1.1.1b" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.5" xref="alg4.l10.m2.1.1.5.cmml">n</mi><mo id="alg4.l10.m2.1.1.1c" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.6" xref="alg4.l10.m2.1.1.6.cmml">t</mi><mo id="alg4.l10.m2.1.1.1d" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.7" xref="alg4.l10.m2.1.1.7.cmml">P</mi><mo id="alg4.l10.m2.1.1.1e" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.8" xref="alg4.l10.m2.1.1.8.cmml">r</mi><mo id="alg4.l10.m2.1.1.1f" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.9" xref="alg4.l10.m2.1.1.9.cmml">o</mi><mo id="alg4.l10.m2.1.1.1g" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.10" xref="alg4.l10.m2.1.1.10.cmml">m</mi><mo id="alg4.l10.m2.1.1.1h" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.11" xref="alg4.l10.m2.1.1.11.cmml">p</mi><mo id="alg4.l10.m2.1.1.1i" xref="alg4.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l10.m2.1.1.12" xref="alg4.l10.m2.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l10.m2.1b"><apply id="alg4.l10.m2.1.1.cmml" xref="alg4.l10.m2.1.1"><times id="alg4.l10.m2.1.1.1.cmml" xref="alg4.l10.m2.1.1.1"></times><ci id="alg4.l10.m2.1.1.2.cmml" xref="alg4.l10.m2.1.1.2">𝐴</ci><ci id="alg4.l10.m2.1.1.3.cmml" xref="alg4.l10.m2.1.1.3">𝑔</ci><ci id="alg4.l10.m2.1.1.4.cmml" xref="alg4.l10.m2.1.1.4">𝑒</ci><ci id="alg4.l10.m2.1.1.5.cmml" xref="alg4.l10.m2.1.1.5">𝑛</ci><ci id="alg4.l10.m2.1.1.6.cmml" xref="alg4.l10.m2.1.1.6">𝑡</ci><ci id="alg4.l10.m2.1.1.7.cmml" xref="alg4.l10.m2.1.1.7">𝑃</ci><ci id="alg4.l10.m2.1.1.8.cmml" xref="alg4.l10.m2.1.1.8">𝑟</ci><ci id="alg4.l10.m2.1.1.9.cmml" xref="alg4.l10.m2.1.1.9">𝑜</ci><ci id="alg4.l10.m2.1.1.10.cmml" xref="alg4.l10.m2.1.1.10">𝑚</ci><ci id="alg4.l10.m2.1.1.11.cmml" xref="alg4.l10.m2.1.1.11">𝑝</ci><ci id="alg4.l10.m2.1.1.12.cmml" xref="alg4.l10.m2.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m2.1c">AgentPrompt</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.m2.1d">italic_A italic_g italic_e italic_n italic_t italic_P italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l11.2.1.1" style="font-size:80%;">11:</span></span>     <math alttext="maxtokens" class="ltx_Math" display="inline" id="alg4.l11.m1.1"><semantics id="alg4.l11.m1.1a"><mrow id="alg4.l11.m1.1.1" xref="alg4.l11.m1.1.1.cmml"><mi id="alg4.l11.m1.1.1.2" xref="alg4.l11.m1.1.1.2.cmml">m</mi><mo id="alg4.l11.m1.1.1.1" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.3" xref="alg4.l11.m1.1.1.3.cmml">a</mi><mo id="alg4.l11.m1.1.1.1a" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.4" xref="alg4.l11.m1.1.1.4.cmml">x</mi><mo id="alg4.l11.m1.1.1.1b" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.5" xref="alg4.l11.m1.1.1.5.cmml">t</mi><mo id="alg4.l11.m1.1.1.1c" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.6" xref="alg4.l11.m1.1.1.6.cmml">o</mi><mo id="alg4.l11.m1.1.1.1d" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.7" xref="alg4.l11.m1.1.1.7.cmml">k</mi><mo id="alg4.l11.m1.1.1.1e" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.8" xref="alg4.l11.m1.1.1.8.cmml">e</mi><mo id="alg4.l11.m1.1.1.1f" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.9" xref="alg4.l11.m1.1.1.9.cmml">n</mi><mo id="alg4.l11.m1.1.1.1g" xref="alg4.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l11.m1.1.1.10" xref="alg4.l11.m1.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l11.m1.1b"><apply id="alg4.l11.m1.1.1.cmml" xref="alg4.l11.m1.1.1"><times id="alg4.l11.m1.1.1.1.cmml" xref="alg4.l11.m1.1.1.1"></times><ci id="alg4.l11.m1.1.1.2.cmml" xref="alg4.l11.m1.1.1.2">𝑚</ci><ci id="alg4.l11.m1.1.1.3.cmml" xref="alg4.l11.m1.1.1.3">𝑎</ci><ci id="alg4.l11.m1.1.1.4.cmml" xref="alg4.l11.m1.1.1.4">𝑥</ci><ci id="alg4.l11.m1.1.1.5.cmml" xref="alg4.l11.m1.1.1.5">𝑡</ci><ci id="alg4.l11.m1.1.1.6.cmml" xref="alg4.l11.m1.1.1.6">𝑜</ci><ci id="alg4.l11.m1.1.1.7.cmml" xref="alg4.l11.m1.1.1.7">𝑘</ci><ci id="alg4.l11.m1.1.1.8.cmml" xref="alg4.l11.m1.1.1.8">𝑒</ci><ci id="alg4.l11.m1.1.1.9.cmml" xref="alg4.l11.m1.1.1.9">𝑛</ci><ci id="alg4.l11.m1.1.1.10.cmml" xref="alg4.l11.m1.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.m1.1c">maxtokens</annotation><annotation encoding="application/x-llamapun" id="alg4.l11.m1.1d">italic_m italic_a italic_x italic_t italic_o italic_k italic_e italic_n italic_s</annotation></semantics></math> = "To define"
}<span class="ltx_text" id="alg4.l11.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l11.1.m1.1"><semantics id="alg4.l11.1.m1.1a"><mo id="alg4.l11.1.m1.1.1" xref="alg4.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l11.1.m1.1b"><ci id="alg4.l11.1.m1.1.1.cmml" xref="alg4.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l11.1.m1.1d">▷</annotation></semantics></math> System Requirement
</span>
</div>
<div class="ltx_listingline" id="alg4.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l12.2.1.1" style="font-size:80%;">12:</span></span>     <math alttext="input" class="ltx_Math" display="inline" id="alg4.l12.m1.1"><semantics id="alg4.l12.m1.1a"><mrow id="alg4.l12.m1.1.1" xref="alg4.l12.m1.1.1.cmml"><mi id="alg4.l12.m1.1.1.2" xref="alg4.l12.m1.1.1.2.cmml">i</mi><mo id="alg4.l12.m1.1.1.1" xref="alg4.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m1.1.1.3" xref="alg4.l12.m1.1.1.3.cmml">n</mi><mo id="alg4.l12.m1.1.1.1a" xref="alg4.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m1.1.1.4" xref="alg4.l12.m1.1.1.4.cmml">p</mi><mo id="alg4.l12.m1.1.1.1b" xref="alg4.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m1.1.1.5" xref="alg4.l12.m1.1.1.5.cmml">u</mi><mo id="alg4.l12.m1.1.1.1c" xref="alg4.l12.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m1.1.1.6" xref="alg4.l12.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m1.1b"><apply id="alg4.l12.m1.1.1.cmml" xref="alg4.l12.m1.1.1"><times id="alg4.l12.m1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1"></times><ci id="alg4.l12.m1.1.1.2.cmml" xref="alg4.l12.m1.1.1.2">𝑖</ci><ci id="alg4.l12.m1.1.1.3.cmml" xref="alg4.l12.m1.1.1.3">𝑛</ci><ci id="alg4.l12.m1.1.1.4.cmml" xref="alg4.l12.m1.1.1.4">𝑝</ci><ci id="alg4.l12.m1.1.1.5.cmml" xref="alg4.l12.m1.1.1.5">𝑢</ci><ci id="alg4.l12.m1.1.1.6.cmml" xref="alg4.l12.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m1.1c">input</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m1.1d">italic_i italic_n italic_p italic_u italic_t</annotation></semantics></math>= <math alttext="VectorisedInput" class="ltx_Math" display="inline" id="alg4.l12.m2.1"><semantics id="alg4.l12.m2.1a"><mrow id="alg4.l12.m2.1.1" xref="alg4.l12.m2.1.1.cmml"><mi id="alg4.l12.m2.1.1.2" xref="alg4.l12.m2.1.1.2.cmml">V</mi><mo id="alg4.l12.m2.1.1.1" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.3" xref="alg4.l12.m2.1.1.3.cmml">e</mi><mo id="alg4.l12.m2.1.1.1a" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.4" xref="alg4.l12.m2.1.1.4.cmml">c</mi><mo id="alg4.l12.m2.1.1.1b" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.5" xref="alg4.l12.m2.1.1.5.cmml">t</mi><mo id="alg4.l12.m2.1.1.1c" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.6" xref="alg4.l12.m2.1.1.6.cmml">o</mi><mo id="alg4.l12.m2.1.1.1d" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.7" xref="alg4.l12.m2.1.1.7.cmml">r</mi><mo id="alg4.l12.m2.1.1.1e" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.8" xref="alg4.l12.m2.1.1.8.cmml">i</mi><mo id="alg4.l12.m2.1.1.1f" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.9" xref="alg4.l12.m2.1.1.9.cmml">s</mi><mo id="alg4.l12.m2.1.1.1g" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.10" xref="alg4.l12.m2.1.1.10.cmml">e</mi><mo id="alg4.l12.m2.1.1.1h" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.11" xref="alg4.l12.m2.1.1.11.cmml">d</mi><mo id="alg4.l12.m2.1.1.1i" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.12" xref="alg4.l12.m2.1.1.12.cmml">I</mi><mo id="alg4.l12.m2.1.1.1j" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.13" xref="alg4.l12.m2.1.1.13.cmml">n</mi><mo id="alg4.l12.m2.1.1.1k" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.14" xref="alg4.l12.m2.1.1.14.cmml">p</mi><mo id="alg4.l12.m2.1.1.1l" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.15" xref="alg4.l12.m2.1.1.15.cmml">u</mi><mo id="alg4.l12.m2.1.1.1m" xref="alg4.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m2.1.1.16" xref="alg4.l12.m2.1.1.16.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m2.1b"><apply id="alg4.l12.m2.1.1.cmml" xref="alg4.l12.m2.1.1"><times id="alg4.l12.m2.1.1.1.cmml" xref="alg4.l12.m2.1.1.1"></times><ci id="alg4.l12.m2.1.1.2.cmml" xref="alg4.l12.m2.1.1.2">𝑉</ci><ci id="alg4.l12.m2.1.1.3.cmml" xref="alg4.l12.m2.1.1.3">𝑒</ci><ci id="alg4.l12.m2.1.1.4.cmml" xref="alg4.l12.m2.1.1.4">𝑐</ci><ci id="alg4.l12.m2.1.1.5.cmml" xref="alg4.l12.m2.1.1.5">𝑡</ci><ci id="alg4.l12.m2.1.1.6.cmml" xref="alg4.l12.m2.1.1.6">𝑜</ci><ci id="alg4.l12.m2.1.1.7.cmml" xref="alg4.l12.m2.1.1.7">𝑟</ci><ci id="alg4.l12.m2.1.1.8.cmml" xref="alg4.l12.m2.1.1.8">𝑖</ci><ci id="alg4.l12.m2.1.1.9.cmml" xref="alg4.l12.m2.1.1.9">𝑠</ci><ci id="alg4.l12.m2.1.1.10.cmml" xref="alg4.l12.m2.1.1.10">𝑒</ci><ci id="alg4.l12.m2.1.1.11.cmml" xref="alg4.l12.m2.1.1.11">𝑑</ci><ci id="alg4.l12.m2.1.1.12.cmml" xref="alg4.l12.m2.1.1.12">𝐼</ci><ci id="alg4.l12.m2.1.1.13.cmml" xref="alg4.l12.m2.1.1.13">𝑛</ci><ci id="alg4.l12.m2.1.1.14.cmml" xref="alg4.l12.m2.1.1.14">𝑝</ci><ci id="alg4.l12.m2.1.1.15.cmml" xref="alg4.l12.m2.1.1.15">𝑢</ci><ci id="alg4.l12.m2.1.1.16.cmml" xref="alg4.l12.m2.1.1.16">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m2.1c">VectorisedInput</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m2.1d">italic_V italic_e italic_c italic_t italic_o italic_r italic_i italic_s italic_e italic_d italic_I italic_n italic_p italic_u italic_t</annotation></semantics></math>(<math alttext="UI" class="ltx_Math" display="inline" id="alg4.l12.m3.1"><semantics id="alg4.l12.m3.1a"><mrow id="alg4.l12.m3.1.1" xref="alg4.l12.m3.1.1.cmml"><mi id="alg4.l12.m3.1.1.2" xref="alg4.l12.m3.1.1.2.cmml">U</mi><mo id="alg4.l12.m3.1.1.1" xref="alg4.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l12.m3.1.1.3" xref="alg4.l12.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m3.1b"><apply id="alg4.l12.m3.1.1.cmml" xref="alg4.l12.m3.1.1"><times id="alg4.l12.m3.1.1.1.cmml" xref="alg4.l12.m3.1.1.1"></times><ci id="alg4.l12.m3.1.1.2.cmml" xref="alg4.l12.m3.1.1.2">𝑈</ci><ci id="alg4.l12.m3.1.1.3.cmml" xref="alg4.l12.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m3.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m3.1d">italic_U italic_I</annotation></semantics></math>) <span class="ltx_text" id="alg4.l12.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l12.1.m1.1"><semantics id="alg4.l12.1.m1.1a"><mo id="alg4.l12.1.m1.1.1" xref="alg4.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l12.1.m1.1b"><ci id="alg4.l12.1.m1.1.1.cmml" xref="alg4.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.1.m1.1d">▷</annotation></semantics></math> System Requirement - Uses embeddings()
</span>
</div>
<div class="ltx_listingline" id="alg4.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l13.2.1.1" style="font-size:80%;">13:</span></span>     <math alttext="context" class="ltx_Math" display="inline" id="alg4.l13.m1.1"><semantics id="alg4.l13.m1.1a"><mrow id="alg4.l13.m1.1.1" xref="alg4.l13.m1.1.1.cmml"><mi id="alg4.l13.m1.1.1.2" xref="alg4.l13.m1.1.1.2.cmml">c</mi><mo id="alg4.l13.m1.1.1.1" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.3" xref="alg4.l13.m1.1.1.3.cmml">o</mi><mo id="alg4.l13.m1.1.1.1a" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.4" xref="alg4.l13.m1.1.1.4.cmml">n</mi><mo id="alg4.l13.m1.1.1.1b" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.5" xref="alg4.l13.m1.1.1.5.cmml">t</mi><mo id="alg4.l13.m1.1.1.1c" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.6" xref="alg4.l13.m1.1.1.6.cmml">e</mi><mo id="alg4.l13.m1.1.1.1d" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.7" xref="alg4.l13.m1.1.1.7.cmml">x</mi><mo id="alg4.l13.m1.1.1.1e" xref="alg4.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m1.1.1.8" xref="alg4.l13.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m1.1b"><apply id="alg4.l13.m1.1.1.cmml" xref="alg4.l13.m1.1.1"><times id="alg4.l13.m1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1"></times><ci id="alg4.l13.m1.1.1.2.cmml" xref="alg4.l13.m1.1.1.2">𝑐</ci><ci id="alg4.l13.m1.1.1.3.cmml" xref="alg4.l13.m1.1.1.3">𝑜</ci><ci id="alg4.l13.m1.1.1.4.cmml" xref="alg4.l13.m1.1.1.4">𝑛</ci><ci id="alg4.l13.m1.1.1.5.cmml" xref="alg4.l13.m1.1.1.5">𝑡</ci><ci id="alg4.l13.m1.1.1.6.cmml" xref="alg4.l13.m1.1.1.6">𝑒</ci><ci id="alg4.l13.m1.1.1.7.cmml" xref="alg4.l13.m1.1.1.7">𝑥</ci><ci id="alg4.l13.m1.1.1.8.cmml" xref="alg4.l13.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m1.1c">context</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m1.1d">italic_c italic_o italic_n italic_t italic_e italic_x italic_t</annotation></semantics></math> =join(<math alttext="Agent.role" class="ltx_Math" display="inline" id="alg4.l13.m2.2"><semantics id="alg4.l13.m2.2a"><mrow id="alg4.l13.m2.2.2.2" xref="alg4.l13.m2.2.2.3.cmml"><mrow id="alg4.l13.m2.1.1.1.1" xref="alg4.l13.m2.1.1.1.1.cmml"><mi id="alg4.l13.m2.1.1.1.1.2" xref="alg4.l13.m2.1.1.1.1.2.cmml">A</mi><mo id="alg4.l13.m2.1.1.1.1.1" xref="alg4.l13.m2.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m2.1.1.1.1.3" xref="alg4.l13.m2.1.1.1.1.3.cmml">g</mi><mo id="alg4.l13.m2.1.1.1.1.1a" xref="alg4.l13.m2.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m2.1.1.1.1.4" xref="alg4.l13.m2.1.1.1.1.4.cmml">e</mi><mo id="alg4.l13.m2.1.1.1.1.1b" xref="alg4.l13.m2.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m2.1.1.1.1.5" xref="alg4.l13.m2.1.1.1.1.5.cmml">n</mi><mo id="alg4.l13.m2.1.1.1.1.1c" xref="alg4.l13.m2.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m2.1.1.1.1.6" xref="alg4.l13.m2.1.1.1.1.6.cmml">t</mi></mrow><mo id="alg4.l13.m2.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg4.l13.m2.2.2.3a.cmml">.</mo><mrow id="alg4.l13.m2.2.2.2.2" xref="alg4.l13.m2.2.2.2.2.cmml"><mi id="alg4.l13.m2.2.2.2.2.2" xref="alg4.l13.m2.2.2.2.2.2.cmml">r</mi><mo id="alg4.l13.m2.2.2.2.2.1" xref="alg4.l13.m2.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m2.2.2.2.2.3" xref="alg4.l13.m2.2.2.2.2.3.cmml">o</mi><mo id="alg4.l13.m2.2.2.2.2.1a" xref="alg4.l13.m2.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m2.2.2.2.2.4" xref="alg4.l13.m2.2.2.2.2.4.cmml">l</mi><mo id="alg4.l13.m2.2.2.2.2.1b" xref="alg4.l13.m2.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m2.2.2.2.2.5" xref="alg4.l13.m2.2.2.2.2.5.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m2.2b"><apply id="alg4.l13.m2.2.2.3.cmml" xref="alg4.l13.m2.2.2.2"><csymbol cd="ambiguous" id="alg4.l13.m2.2.2.3a.cmml" xref="alg4.l13.m2.2.2.2.3">formulae-sequence</csymbol><apply id="alg4.l13.m2.1.1.1.1.cmml" xref="alg4.l13.m2.1.1.1.1"><times id="alg4.l13.m2.1.1.1.1.1.cmml" xref="alg4.l13.m2.1.1.1.1.1"></times><ci id="alg4.l13.m2.1.1.1.1.2.cmml" xref="alg4.l13.m2.1.1.1.1.2">𝐴</ci><ci id="alg4.l13.m2.1.1.1.1.3.cmml" xref="alg4.l13.m2.1.1.1.1.3">𝑔</ci><ci id="alg4.l13.m2.1.1.1.1.4.cmml" xref="alg4.l13.m2.1.1.1.1.4">𝑒</ci><ci id="alg4.l13.m2.1.1.1.1.5.cmml" xref="alg4.l13.m2.1.1.1.1.5">𝑛</ci><ci id="alg4.l13.m2.1.1.1.1.6.cmml" xref="alg4.l13.m2.1.1.1.1.6">𝑡</ci></apply><apply id="alg4.l13.m2.2.2.2.2.cmml" xref="alg4.l13.m2.2.2.2.2"><times id="alg4.l13.m2.2.2.2.2.1.cmml" xref="alg4.l13.m2.2.2.2.2.1"></times><ci id="alg4.l13.m2.2.2.2.2.2.cmml" xref="alg4.l13.m2.2.2.2.2.2">𝑟</ci><ci id="alg4.l13.m2.2.2.2.2.3.cmml" xref="alg4.l13.m2.2.2.2.2.3">𝑜</ci><ci id="alg4.l13.m2.2.2.2.2.4.cmml" xref="alg4.l13.m2.2.2.2.2.4">𝑙</ci><ci id="alg4.l13.m2.2.2.2.2.5.cmml" xref="alg4.l13.m2.2.2.2.2.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m2.2c">Agent.role</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m2.2d">italic_A italic_g italic_e italic_n italic_t . italic_r italic_o italic_l italic_e</annotation></semantics></math>, <math alttext="Agent.content" class="ltx_Math" display="inline" id="alg4.l13.m3.2"><semantics id="alg4.l13.m3.2a"><mrow id="alg4.l13.m3.2.2.2" xref="alg4.l13.m3.2.2.3.cmml"><mrow id="alg4.l13.m3.1.1.1.1" xref="alg4.l13.m3.1.1.1.1.cmml"><mi id="alg4.l13.m3.1.1.1.1.2" xref="alg4.l13.m3.1.1.1.1.2.cmml">A</mi><mo id="alg4.l13.m3.1.1.1.1.1" xref="alg4.l13.m3.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m3.1.1.1.1.3" xref="alg4.l13.m3.1.1.1.1.3.cmml">g</mi><mo id="alg4.l13.m3.1.1.1.1.1a" xref="alg4.l13.m3.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m3.1.1.1.1.4" xref="alg4.l13.m3.1.1.1.1.4.cmml">e</mi><mo id="alg4.l13.m3.1.1.1.1.1b" xref="alg4.l13.m3.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m3.1.1.1.1.5" xref="alg4.l13.m3.1.1.1.1.5.cmml">n</mi><mo id="alg4.l13.m3.1.1.1.1.1c" xref="alg4.l13.m3.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m3.1.1.1.1.6" xref="alg4.l13.m3.1.1.1.1.6.cmml">t</mi></mrow><mo id="alg4.l13.m3.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg4.l13.m3.2.2.3a.cmml">.</mo><mrow id="alg4.l13.m3.2.2.2.2" xref="alg4.l13.m3.2.2.2.2.cmml"><mi id="alg4.l13.m3.2.2.2.2.2" xref="alg4.l13.m3.2.2.2.2.2.cmml">c</mi><mo id="alg4.l13.m3.2.2.2.2.1" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.3" xref="alg4.l13.m3.2.2.2.2.3.cmml">o</mi><mo id="alg4.l13.m3.2.2.2.2.1a" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.4" xref="alg4.l13.m3.2.2.2.2.4.cmml">n</mi><mo id="alg4.l13.m3.2.2.2.2.1b" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.5" xref="alg4.l13.m3.2.2.2.2.5.cmml">t</mi><mo id="alg4.l13.m3.2.2.2.2.1c" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.6" xref="alg4.l13.m3.2.2.2.2.6.cmml">e</mi><mo id="alg4.l13.m3.2.2.2.2.1d" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.7" xref="alg4.l13.m3.2.2.2.2.7.cmml">n</mi><mo id="alg4.l13.m3.2.2.2.2.1e" xref="alg4.l13.m3.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l13.m3.2.2.2.2.8" xref="alg4.l13.m3.2.2.2.2.8.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m3.2b"><apply id="alg4.l13.m3.2.2.3.cmml" xref="alg4.l13.m3.2.2.2"><csymbol cd="ambiguous" id="alg4.l13.m3.2.2.3a.cmml" xref="alg4.l13.m3.2.2.2.3">formulae-sequence</csymbol><apply id="alg4.l13.m3.1.1.1.1.cmml" xref="alg4.l13.m3.1.1.1.1"><times id="alg4.l13.m3.1.1.1.1.1.cmml" xref="alg4.l13.m3.1.1.1.1.1"></times><ci id="alg4.l13.m3.1.1.1.1.2.cmml" xref="alg4.l13.m3.1.1.1.1.2">𝐴</ci><ci id="alg4.l13.m3.1.1.1.1.3.cmml" xref="alg4.l13.m3.1.1.1.1.3">𝑔</ci><ci id="alg4.l13.m3.1.1.1.1.4.cmml" xref="alg4.l13.m3.1.1.1.1.4">𝑒</ci><ci id="alg4.l13.m3.1.1.1.1.5.cmml" xref="alg4.l13.m3.1.1.1.1.5">𝑛</ci><ci id="alg4.l13.m3.1.1.1.1.6.cmml" xref="alg4.l13.m3.1.1.1.1.6">𝑡</ci></apply><apply id="alg4.l13.m3.2.2.2.2.cmml" xref="alg4.l13.m3.2.2.2.2"><times id="alg4.l13.m3.2.2.2.2.1.cmml" xref="alg4.l13.m3.2.2.2.2.1"></times><ci id="alg4.l13.m3.2.2.2.2.2.cmml" xref="alg4.l13.m3.2.2.2.2.2">𝑐</ci><ci id="alg4.l13.m3.2.2.2.2.3.cmml" xref="alg4.l13.m3.2.2.2.2.3">𝑜</ci><ci id="alg4.l13.m3.2.2.2.2.4.cmml" xref="alg4.l13.m3.2.2.2.2.4">𝑛</ci><ci id="alg4.l13.m3.2.2.2.2.5.cmml" xref="alg4.l13.m3.2.2.2.2.5">𝑡</ci><ci id="alg4.l13.m3.2.2.2.2.6.cmml" xref="alg4.l13.m3.2.2.2.2.6">𝑒</ci><ci id="alg4.l13.m3.2.2.2.2.7.cmml" xref="alg4.l13.m3.2.2.2.2.7">𝑛</ci><ci id="alg4.l13.m3.2.2.2.2.8.cmml" xref="alg4.l13.m3.2.2.2.2.8">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m3.2c">Agent.content</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m3.2d">italic_A italic_g italic_e italic_n italic_t . italic_c italic_o italic_n italic_t italic_e italic_n italic_t</annotation></semantics></math>, <math alttext="PC" class="ltx_Math" display="inline" id="alg4.l13.m4.1"><semantics id="alg4.l13.m4.1a"><mrow id="alg4.l13.m4.1.1" xref="alg4.l13.m4.1.1.cmml"><mi id="alg4.l13.m4.1.1.2" xref="alg4.l13.m4.1.1.2.cmml">P</mi><mo id="alg4.l13.m4.1.1.1" xref="alg4.l13.m4.1.1.1.cmml">⁢</mo><mi id="alg4.l13.m4.1.1.3" xref="alg4.l13.m4.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m4.1b"><apply id="alg4.l13.m4.1.1.cmml" xref="alg4.l13.m4.1.1"><times id="alg4.l13.m4.1.1.1.cmml" xref="alg4.l13.m4.1.1.1"></times><ci id="alg4.l13.m4.1.1.2.cmml" xref="alg4.l13.m4.1.1.2">𝑃</ci><ci id="alg4.l13.m4.1.1.3.cmml" xref="alg4.l13.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m4.1c">PC</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m4.1d">italic_P italic_C</annotation></semantics></math>[-1])
<span class="ltx_text" id="alg4.l13.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg4.l13.1.m1.1"><semantics id="alg4.l13.1.m1.1a"><mo id="alg4.l13.1.m1.1.1" xref="alg4.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg4.l13.1.m1.1b"><ci id="alg4.l13.1.m1.1.1.cmml" xref="alg4.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.1.m1.1d">▷</annotation></semantics></math> System Requirement
</span>
</div>
<div class="ltx_listingline" id="alg4.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l14.1.1.1" style="font-size:80%;">14:</span></span>     <math alttext="AgentResponse" class="ltx_Math" display="inline" id="alg4.l14.m1.1"><semantics id="alg4.l14.m1.1a"><mrow id="alg4.l14.m1.1.1" xref="alg4.l14.m1.1.1.cmml"><mi id="alg4.l14.m1.1.1.2" xref="alg4.l14.m1.1.1.2.cmml">A</mi><mo id="alg4.l14.m1.1.1.1" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.3" xref="alg4.l14.m1.1.1.3.cmml">g</mi><mo id="alg4.l14.m1.1.1.1a" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.4" xref="alg4.l14.m1.1.1.4.cmml">e</mi><mo id="alg4.l14.m1.1.1.1b" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.5" xref="alg4.l14.m1.1.1.5.cmml">n</mi><mo id="alg4.l14.m1.1.1.1c" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.6" xref="alg4.l14.m1.1.1.6.cmml">t</mi><mo id="alg4.l14.m1.1.1.1d" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.7" xref="alg4.l14.m1.1.1.7.cmml">R</mi><mo id="alg4.l14.m1.1.1.1e" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.8" xref="alg4.l14.m1.1.1.8.cmml">e</mi><mo id="alg4.l14.m1.1.1.1f" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.9" xref="alg4.l14.m1.1.1.9.cmml">s</mi><mo id="alg4.l14.m1.1.1.1g" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.10" xref="alg4.l14.m1.1.1.10.cmml">p</mi><mo id="alg4.l14.m1.1.1.1h" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.11" xref="alg4.l14.m1.1.1.11.cmml">o</mi><mo id="alg4.l14.m1.1.1.1i" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.12" xref="alg4.l14.m1.1.1.12.cmml">n</mi><mo id="alg4.l14.m1.1.1.1j" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.13" xref="alg4.l14.m1.1.1.13.cmml">s</mi><mo id="alg4.l14.m1.1.1.1k" xref="alg4.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m1.1.1.14" xref="alg4.l14.m1.1.1.14.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.m1.1b"><apply id="alg4.l14.m1.1.1.cmml" xref="alg4.l14.m1.1.1"><times id="alg4.l14.m1.1.1.1.cmml" xref="alg4.l14.m1.1.1.1"></times><ci id="alg4.l14.m1.1.1.2.cmml" xref="alg4.l14.m1.1.1.2">𝐴</ci><ci id="alg4.l14.m1.1.1.3.cmml" xref="alg4.l14.m1.1.1.3">𝑔</ci><ci id="alg4.l14.m1.1.1.4.cmml" xref="alg4.l14.m1.1.1.4">𝑒</ci><ci id="alg4.l14.m1.1.1.5.cmml" xref="alg4.l14.m1.1.1.5">𝑛</ci><ci id="alg4.l14.m1.1.1.6.cmml" xref="alg4.l14.m1.1.1.6">𝑡</ci><ci id="alg4.l14.m1.1.1.7.cmml" xref="alg4.l14.m1.1.1.7">𝑅</ci><ci id="alg4.l14.m1.1.1.8.cmml" xref="alg4.l14.m1.1.1.8">𝑒</ci><ci id="alg4.l14.m1.1.1.9.cmml" xref="alg4.l14.m1.1.1.9">𝑠</ci><ci id="alg4.l14.m1.1.1.10.cmml" xref="alg4.l14.m1.1.1.10">𝑝</ci><ci id="alg4.l14.m1.1.1.11.cmml" xref="alg4.l14.m1.1.1.11">𝑜</ci><ci id="alg4.l14.m1.1.1.12.cmml" xref="alg4.l14.m1.1.1.12">𝑛</ci><ci id="alg4.l14.m1.1.1.13.cmml" xref="alg4.l14.m1.1.1.13">𝑠</ci><ci id="alg4.l14.m1.1.1.14.cmml" xref="alg4.l14.m1.1.1.14">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.m1.1c">AgentResponse</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.m1.1d">italic_A italic_g italic_e italic_n italic_t italic_R italic_e italic_s italic_p italic_o italic_n italic_s italic_e</annotation></semantics></math> = system.chat(<math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg4.l14.m2.1"><semantics id="alg4.l14.m2.1a"><mrow id="alg4.l14.m2.1.1" xref="alg4.l14.m2.1.1.cmml"><mi id="alg4.l14.m2.1.1.2" xref="alg4.l14.m2.1.1.2.cmml">E</mi><mo id="alg4.l14.m2.1.1.1" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.3" xref="alg4.l14.m2.1.1.3.cmml">m</mi><mo id="alg4.l14.m2.1.1.1a" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.4" xref="alg4.l14.m2.1.1.4.cmml">b</mi><mo id="alg4.l14.m2.1.1.1b" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.5" xref="alg4.l14.m2.1.1.5.cmml">e</mi><mo id="alg4.l14.m2.1.1.1c" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.6" xref="alg4.l14.m2.1.1.6.cmml">d</mi><mo id="alg4.l14.m2.1.1.1d" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.7" xref="alg4.l14.m2.1.1.7.cmml">M</mi><mo id="alg4.l14.m2.1.1.1e" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.8" xref="alg4.l14.m2.1.1.8.cmml">o</mi><mo id="alg4.l14.m2.1.1.1f" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.9" xref="alg4.l14.m2.1.1.9.cmml">d</mi><mo id="alg4.l14.m2.1.1.1g" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.10" xref="alg4.l14.m2.1.1.10.cmml">e</mi><mo id="alg4.l14.m2.1.1.1h" xref="alg4.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m2.1.1.11" xref="alg4.l14.m2.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.m2.1b"><apply id="alg4.l14.m2.1.1.cmml" xref="alg4.l14.m2.1.1"><times id="alg4.l14.m2.1.1.1.cmml" xref="alg4.l14.m2.1.1.1"></times><ci id="alg4.l14.m2.1.1.2.cmml" xref="alg4.l14.m2.1.1.2">𝐸</ci><ci id="alg4.l14.m2.1.1.3.cmml" xref="alg4.l14.m2.1.1.3">𝑚</ci><ci id="alg4.l14.m2.1.1.4.cmml" xref="alg4.l14.m2.1.1.4">𝑏</ci><ci id="alg4.l14.m2.1.1.5.cmml" xref="alg4.l14.m2.1.1.5">𝑒</ci><ci id="alg4.l14.m2.1.1.6.cmml" xref="alg4.l14.m2.1.1.6">𝑑</ci><ci id="alg4.l14.m2.1.1.7.cmml" xref="alg4.l14.m2.1.1.7">𝑀</ci><ci id="alg4.l14.m2.1.1.8.cmml" xref="alg4.l14.m2.1.1.8">𝑜</ci><ci id="alg4.l14.m2.1.1.9.cmml" xref="alg4.l14.m2.1.1.9">𝑑</ci><ci id="alg4.l14.m2.1.1.10.cmml" xref="alg4.l14.m2.1.1.10">𝑒</ci><ci id="alg4.l14.m2.1.1.11.cmml" xref="alg4.l14.m2.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.m2.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.m2.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>, <math alttext="Agent" class="ltx_Math" display="inline" id="alg4.l14.m3.1"><semantics id="alg4.l14.m3.1a"><mrow id="alg4.l14.m3.1.1" xref="alg4.l14.m3.1.1.cmml"><mi id="alg4.l14.m3.1.1.2" xref="alg4.l14.m3.1.1.2.cmml">A</mi><mo id="alg4.l14.m3.1.1.1" xref="alg4.l14.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m3.1.1.3" xref="alg4.l14.m3.1.1.3.cmml">g</mi><mo id="alg4.l14.m3.1.1.1a" xref="alg4.l14.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m3.1.1.4" xref="alg4.l14.m3.1.1.4.cmml">e</mi><mo id="alg4.l14.m3.1.1.1b" xref="alg4.l14.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m3.1.1.5" xref="alg4.l14.m3.1.1.5.cmml">n</mi><mo id="alg4.l14.m3.1.1.1c" xref="alg4.l14.m3.1.1.1.cmml">⁢</mo><mi id="alg4.l14.m3.1.1.6" xref="alg4.l14.m3.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.m3.1b"><apply id="alg4.l14.m3.1.1.cmml" xref="alg4.l14.m3.1.1"><times id="alg4.l14.m3.1.1.1.cmml" xref="alg4.l14.m3.1.1.1"></times><ci id="alg4.l14.m3.1.1.2.cmml" xref="alg4.l14.m3.1.1.2">𝐴</ci><ci id="alg4.l14.m3.1.1.3.cmml" xref="alg4.l14.m3.1.1.3">𝑔</ci><ci id="alg4.l14.m3.1.1.4.cmml" xref="alg4.l14.m3.1.1.4">𝑒</ci><ci id="alg4.l14.m3.1.1.5.cmml" xref="alg4.l14.m3.1.1.5">𝑛</ci><ci id="alg4.l14.m3.1.1.6.cmml" xref="alg4.l14.m3.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.m3.1c">Agent</annotation><annotation encoding="application/x-llamapun" id="alg4.l14.m3.1d">italic_A italic_g italic_e italic_n italic_t</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg4.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l15.1.1.1" style="font-size:80%;">15:</span></span>     <math alttext="RI" class="ltx_Math" display="inline" id="alg4.l15.m1.1"><semantics id="alg4.l15.m1.1a"><mrow id="alg4.l15.m1.1.1" xref="alg4.l15.m1.1.1.cmml"><mi id="alg4.l15.m1.1.1.2" xref="alg4.l15.m1.1.1.2.cmml">R</mi><mo id="alg4.l15.m1.1.1.1" xref="alg4.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m1.1.1.3" xref="alg4.l15.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l15.m1.1b"><apply id="alg4.l15.m1.1.1.cmml" xref="alg4.l15.m1.1.1"><times id="alg4.l15.m1.1.1.1.cmml" xref="alg4.l15.m1.1.1.1"></times><ci id="alg4.l15.m1.1.1.2.cmml" xref="alg4.l15.m1.1.1.2">𝑅</ci><ci id="alg4.l15.m1.1.1.3.cmml" xref="alg4.l15.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l15.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg4.l15.m1.1d">italic_R italic_I</annotation></semantics></math> = <math alttext="AgentResponse" class="ltx_Math" display="inline" id="alg4.l15.m2.1"><semantics id="alg4.l15.m2.1a"><mrow id="alg4.l15.m2.1.1" xref="alg4.l15.m2.1.1.cmml"><mi id="alg4.l15.m2.1.1.2" xref="alg4.l15.m2.1.1.2.cmml">A</mi><mo id="alg4.l15.m2.1.1.1" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.3" xref="alg4.l15.m2.1.1.3.cmml">g</mi><mo id="alg4.l15.m2.1.1.1a" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.4" xref="alg4.l15.m2.1.1.4.cmml">e</mi><mo id="alg4.l15.m2.1.1.1b" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.5" xref="alg4.l15.m2.1.1.5.cmml">n</mi><mo id="alg4.l15.m2.1.1.1c" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.6" xref="alg4.l15.m2.1.1.6.cmml">t</mi><mo id="alg4.l15.m2.1.1.1d" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.7" xref="alg4.l15.m2.1.1.7.cmml">R</mi><mo id="alg4.l15.m2.1.1.1e" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.8" xref="alg4.l15.m2.1.1.8.cmml">e</mi><mo id="alg4.l15.m2.1.1.1f" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.9" xref="alg4.l15.m2.1.1.9.cmml">s</mi><mo id="alg4.l15.m2.1.1.1g" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.10" xref="alg4.l15.m2.1.1.10.cmml">p</mi><mo id="alg4.l15.m2.1.1.1h" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.11" xref="alg4.l15.m2.1.1.11.cmml">o</mi><mo id="alg4.l15.m2.1.1.1i" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.12" xref="alg4.l15.m2.1.1.12.cmml">n</mi><mo id="alg4.l15.m2.1.1.1j" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.13" xref="alg4.l15.m2.1.1.13.cmml">s</mi><mo id="alg4.l15.m2.1.1.1k" xref="alg4.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg4.l15.m2.1.1.14" xref="alg4.l15.m2.1.1.14.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l15.m2.1b"><apply id="alg4.l15.m2.1.1.cmml" xref="alg4.l15.m2.1.1"><times id="alg4.l15.m2.1.1.1.cmml" xref="alg4.l15.m2.1.1.1"></times><ci id="alg4.l15.m2.1.1.2.cmml" xref="alg4.l15.m2.1.1.2">𝐴</ci><ci id="alg4.l15.m2.1.1.3.cmml" xref="alg4.l15.m2.1.1.3">𝑔</ci><ci id="alg4.l15.m2.1.1.4.cmml" xref="alg4.l15.m2.1.1.4">𝑒</ci><ci id="alg4.l15.m2.1.1.5.cmml" xref="alg4.l15.m2.1.1.5">𝑛</ci><ci id="alg4.l15.m2.1.1.6.cmml" xref="alg4.l15.m2.1.1.6">𝑡</ci><ci id="alg4.l15.m2.1.1.7.cmml" xref="alg4.l15.m2.1.1.7">𝑅</ci><ci id="alg4.l15.m2.1.1.8.cmml" xref="alg4.l15.m2.1.1.8">𝑒</ci><ci id="alg4.l15.m2.1.1.9.cmml" xref="alg4.l15.m2.1.1.9">𝑠</ci><ci id="alg4.l15.m2.1.1.10.cmml" xref="alg4.l15.m2.1.1.10">𝑝</ci><ci id="alg4.l15.m2.1.1.11.cmml" xref="alg4.l15.m2.1.1.11">𝑜</ci><ci id="alg4.l15.m2.1.1.12.cmml" xref="alg4.l15.m2.1.1.12">𝑛</ci><ci id="alg4.l15.m2.1.1.13.cmml" xref="alg4.l15.m2.1.1.13">𝑠</ci><ci id="alg4.l15.m2.1.1.14.cmml" xref="alg4.l15.m2.1.1.14">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l15.m2.1c">AgentResponse</annotation><annotation encoding="application/x-llamapun" id="alg4.l15.m2.1d">italic_A italic_g italic_e italic_n italic_t italic_R italic_e italic_s italic_p italic_o italic_n italic_s italic_e</annotation></semantics></math>([message][content])

</div>
<div class="ltx_listingline" id="alg4.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l16.1.1.1" style="font-size:80%;">16:</span></span>     <span class="ltx_text ltx_font_bold" id="alg4.l16.2">return</span> <math alttext="RI" class="ltx_Math" display="inline" id="alg4.l16.m1.1"><semantics id="alg4.l16.m1.1a"><mrow id="alg4.l16.m1.1.1" xref="alg4.l16.m1.1.1.cmml"><mi id="alg4.l16.m1.1.1.2" xref="alg4.l16.m1.1.1.2.cmml">R</mi><mo id="alg4.l16.m1.1.1.1" xref="alg4.l16.m1.1.1.1.cmml">⁢</mo><mi id="alg4.l16.m1.1.1.3" xref="alg4.l16.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l16.m1.1b"><apply id="alg4.l16.m1.1.1.cmml" xref="alg4.l16.m1.1.1"><times id="alg4.l16.m1.1.1.1.cmml" xref="alg4.l16.m1.1.1.1"></times><ci id="alg4.l16.m1.1.1.2.cmml" xref="alg4.l16.m1.1.1.2">𝑅</ci><ci id="alg4.l16.m1.1.1.3.cmml" xref="alg4.l16.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l16.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg4.l16.m1.1d">italic_R italic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg4.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text ltx_font_bold" id="alg4.l17.2">end</span> <span class="ltx_text ltx_font_bold" id="alg4.l17.3">function</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg5.2.1.1">Algorithm 5</span> </span> Information Retrieval</figcaption>
<div class="ltx_listing ltx_listing" id="alg5.3">
<div class="ltx_listingline" id="alg5.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l1.1.1.1" style="font-size:80%;">1:</span></span>RAG Agent Rewritten Input (Query) <math alttext="RI" class="ltx_Math" display="inline" id="alg5.l1.m1.1"><semantics id="alg5.l1.m1.1a"><mrow id="alg5.l1.m1.1.1" xref="alg5.l1.m1.1.1.cmml"><mi id="alg5.l1.m1.1.1.2" xref="alg5.l1.m1.1.1.2.cmml">R</mi><mo id="alg5.l1.m1.1.1.1" xref="alg5.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m1.1.1.3" xref="alg5.l1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m1.1b"><apply id="alg5.l1.m1.1.1.cmml" xref="alg5.l1.m1.1.1"><times id="alg5.l1.m1.1.1.1.cmml" xref="alg5.l1.m1.1.1.1"></times><ci id="alg5.l1.m1.1.1.2.cmml" xref="alg5.l1.m1.1.1.2">𝑅</ci><ci id="alg5.l1.m1.1.1.3.cmml" xref="alg5.l1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m1.1d">italic_R italic_I</annotation></semantics></math>, Preprocessed Text <math alttext="PT" class="ltx_Math" display="inline" id="alg5.l1.m2.1"><semantics id="alg5.l1.m2.1a"><mrow id="alg5.l1.m2.1.1" xref="alg5.l1.m2.1.1.cmml"><mi id="alg5.l1.m2.1.1.2" xref="alg5.l1.m2.1.1.2.cmml">P</mi><mo id="alg5.l1.m2.1.1.1" xref="alg5.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m2.1.1.3" xref="alg5.l1.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m2.1b"><apply id="alg5.l1.m2.1.1.cmml" xref="alg5.l1.m2.1.1"><times id="alg5.l1.m2.1.1.1.cmml" xref="alg5.l1.m2.1.1.1"></times><ci id="alg5.l1.m2.1.1.2.cmml" xref="alg5.l1.m2.1.1.2">𝑃</ci><ci id="alg5.l1.m2.1.1.3.cmml" xref="alg5.l1.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m2.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m2.1d">italic_P italic_T</annotation></semantics></math>, Top K contexts <math alttext="topk" class="ltx_Math" display="inline" id="alg5.l1.m3.1"><semantics id="alg5.l1.m3.1a"><mrow id="alg5.l1.m3.1.1" xref="alg5.l1.m3.1.1.cmml"><mi id="alg5.l1.m3.1.1.2" xref="alg5.l1.m3.1.1.2.cmml">t</mi><mo id="alg5.l1.m3.1.1.1" xref="alg5.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m3.1.1.3" xref="alg5.l1.m3.1.1.3.cmml">o</mi><mo id="alg5.l1.m3.1.1.1a" xref="alg5.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m3.1.1.4" xref="alg5.l1.m3.1.1.4.cmml">p</mi><mo id="alg5.l1.m3.1.1.1b" xref="alg5.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m3.1.1.5" xref="alg5.l1.m3.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m3.1b"><apply id="alg5.l1.m3.1.1.cmml" xref="alg5.l1.m3.1.1"><times id="alg5.l1.m3.1.1.1.cmml" xref="alg5.l1.m3.1.1.1"></times><ci id="alg5.l1.m3.1.1.2.cmml" xref="alg5.l1.m3.1.1.2">𝑡</ci><ci id="alg5.l1.m3.1.1.3.cmml" xref="alg5.l1.m3.1.1.3">𝑜</ci><ci id="alg5.l1.m3.1.1.4.cmml" xref="alg5.l1.m3.1.1.4">𝑝</ci><ci id="alg5.l1.m3.1.1.5.cmml" xref="alg5.l1.m3.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m3.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m3.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>, Preprocessed Text <math alttext="PT" class="ltx_Math" display="inline" id="alg5.l1.m4.1"><semantics id="alg5.l1.m4.1a"><mrow id="alg5.l1.m4.1.1" xref="alg5.l1.m4.1.1.cmml"><mi id="alg5.l1.m4.1.1.2" xref="alg5.l1.m4.1.1.2.cmml">P</mi><mo id="alg5.l1.m4.1.1.1" xref="alg5.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m4.1.1.3" xref="alg5.l1.m4.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m4.1b"><apply id="alg5.l1.m4.1.1.cmml" xref="alg5.l1.m4.1.1"><times id="alg5.l1.m4.1.1.1.cmml" xref="alg5.l1.m4.1.1.1"></times><ci id="alg5.l1.m4.1.1.2.cmml" xref="alg5.l1.m4.1.1.2">𝑃</ci><ci id="alg5.l1.m4.1.1.3.cmml" xref="alg5.l1.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m4.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m4.1d">italic_P italic_T</annotation></semantics></math> and Embedded Data <math alttext="ED" class="ltx_Math" display="inline" id="alg5.l1.m5.1"><semantics id="alg5.l1.m5.1a"><mrow id="alg5.l1.m5.1.1" xref="alg5.l1.m5.1.1.cmml"><mi id="alg5.l1.m5.1.1.2" xref="alg5.l1.m5.1.1.2.cmml">E</mi><mo id="alg5.l1.m5.1.1.1" xref="alg5.l1.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m5.1.1.3" xref="alg5.l1.m5.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m5.1b"><apply id="alg5.l1.m5.1.1.cmml" xref="alg5.l1.m5.1.1"><times id="alg5.l1.m5.1.1.1.cmml" xref="alg5.l1.m5.1.1.1"></times><ci id="alg5.l1.m5.1.1.2.cmml" xref="alg5.l1.m5.1.1.2">𝐸</ci><ci id="alg5.l1.m5.1.1.3.cmml" xref="alg5.l1.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m5.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m5.1d">italic_E italic_D</annotation></semantics></math> and Embedding Model <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg5.l1.m6.1"><semantics id="alg5.l1.m6.1a"><mrow id="alg5.l1.m6.1.1" xref="alg5.l1.m6.1.1.cmml"><mi id="alg5.l1.m6.1.1.2" xref="alg5.l1.m6.1.1.2.cmml">E</mi><mo id="alg5.l1.m6.1.1.1" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.3" xref="alg5.l1.m6.1.1.3.cmml">m</mi><mo id="alg5.l1.m6.1.1.1a" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.4" xref="alg5.l1.m6.1.1.4.cmml">b</mi><mo id="alg5.l1.m6.1.1.1b" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.5" xref="alg5.l1.m6.1.1.5.cmml">e</mi><mo id="alg5.l1.m6.1.1.1c" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.6" xref="alg5.l1.m6.1.1.6.cmml">d</mi><mo id="alg5.l1.m6.1.1.1d" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.7" xref="alg5.l1.m6.1.1.7.cmml">M</mi><mo id="alg5.l1.m6.1.1.1e" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.8" xref="alg5.l1.m6.1.1.8.cmml">o</mi><mo id="alg5.l1.m6.1.1.1f" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.9" xref="alg5.l1.m6.1.1.9.cmml">d</mi><mo id="alg5.l1.m6.1.1.1g" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.10" xref="alg5.l1.m6.1.1.10.cmml">e</mi><mo id="alg5.l1.m6.1.1.1h" xref="alg5.l1.m6.1.1.1.cmml">⁢</mo><mi id="alg5.l1.m6.1.1.11" xref="alg5.l1.m6.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l1.m6.1b"><apply id="alg5.l1.m6.1.1.cmml" xref="alg5.l1.m6.1.1"><times id="alg5.l1.m6.1.1.1.cmml" xref="alg5.l1.m6.1.1.1"></times><ci id="alg5.l1.m6.1.1.2.cmml" xref="alg5.l1.m6.1.1.2">𝐸</ci><ci id="alg5.l1.m6.1.1.3.cmml" xref="alg5.l1.m6.1.1.3">𝑚</ci><ci id="alg5.l1.m6.1.1.4.cmml" xref="alg5.l1.m6.1.1.4">𝑏</ci><ci id="alg5.l1.m6.1.1.5.cmml" xref="alg5.l1.m6.1.1.5">𝑒</ci><ci id="alg5.l1.m6.1.1.6.cmml" xref="alg5.l1.m6.1.1.6">𝑑</ci><ci id="alg5.l1.m6.1.1.7.cmml" xref="alg5.l1.m6.1.1.7">𝑀</ci><ci id="alg5.l1.m6.1.1.8.cmml" xref="alg5.l1.m6.1.1.8">𝑜</ci><ci id="alg5.l1.m6.1.1.9.cmml" xref="alg5.l1.m6.1.1.9">𝑑</ci><ci id="alg5.l1.m6.1.1.10.cmml" xref="alg5.l1.m6.1.1.10">𝑒</ci><ci id="alg5.l1.m6.1.1.11.cmml" xref="alg5.l1.m6.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m6.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m6.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l2.1.1.1" style="font-size:80%;">2:</span></span>Retrieve Relevant Information <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg5.l2.m1.1"><semantics id="alg5.l2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg5.l2.m1.1.1" xref="alg5.l2.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg5.l2.m1.1b"><ci id="alg5.l2.m1.1.1.cmml" xref="alg5.l2.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l2.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg5.l2.m1.1d">caligraphic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg5.l3.2">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg5.l3.3">Retrieve</span>( <math alttext="RI" class="ltx_Math" display="inline" id="alg5.l3.m1.1"><semantics id="alg5.l3.m1.1a"><mrow id="alg5.l3.m1.1.1" xref="alg5.l3.m1.1.1.cmml"><mi id="alg5.l3.m1.1.1.2" xref="alg5.l3.m1.1.1.2.cmml">R</mi><mo id="alg5.l3.m1.1.1.1" xref="alg5.l3.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m1.1.1.3" xref="alg5.l3.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l3.m1.1b"><apply id="alg5.l3.m1.1.1.cmml" xref="alg5.l3.m1.1.1"><times id="alg5.l3.m1.1.1.1.cmml" xref="alg5.l3.m1.1.1.1"></times><ci id="alg5.l3.m1.1.1.2.cmml" xref="alg5.l3.m1.1.1.2">𝑅</ci><ci id="alg5.l3.m1.1.1.3.cmml" xref="alg5.l3.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m1.1d">italic_R italic_I</annotation></semantics></math>, <math alttext="PT" class="ltx_Math" display="inline" id="alg5.l3.m2.1"><semantics id="alg5.l3.m2.1a"><mrow id="alg5.l3.m2.1.1" xref="alg5.l3.m2.1.1.cmml"><mi id="alg5.l3.m2.1.1.2" xref="alg5.l3.m2.1.1.2.cmml">P</mi><mo id="alg5.l3.m2.1.1.1" xref="alg5.l3.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m2.1.1.3" xref="alg5.l3.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l3.m2.1b"><apply id="alg5.l3.m2.1.1.cmml" xref="alg5.l3.m2.1.1"><times id="alg5.l3.m2.1.1.1.cmml" xref="alg5.l3.m2.1.1.1"></times><ci id="alg5.l3.m2.1.1.2.cmml" xref="alg5.l3.m2.1.1.2">𝑃</ci><ci id="alg5.l3.m2.1.1.3.cmml" xref="alg5.l3.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m2.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m2.1d">italic_P italic_T</annotation></semantics></math>, <math alttext="ED" class="ltx_Math" display="inline" id="alg5.l3.m3.1"><semantics id="alg5.l3.m3.1a"><mrow id="alg5.l3.m3.1.1" xref="alg5.l3.m3.1.1.cmml"><mi id="alg5.l3.m3.1.1.2" xref="alg5.l3.m3.1.1.2.cmml">E</mi><mo id="alg5.l3.m3.1.1.1" xref="alg5.l3.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m3.1.1.3" xref="alg5.l3.m3.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l3.m3.1b"><apply id="alg5.l3.m3.1.1.cmml" xref="alg5.l3.m3.1.1"><times id="alg5.l3.m3.1.1.1.cmml" xref="alg5.l3.m3.1.1.1"></times><ci id="alg5.l3.m3.1.1.2.cmml" xref="alg5.l3.m3.1.1.2">𝐸</ci><ci id="alg5.l3.m3.1.1.3.cmml" xref="alg5.l3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m3.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m3.1d">italic_E italic_D</annotation></semantics></math>, <math alttext="topk" class="ltx_Math" display="inline" id="alg5.l3.m4.1"><semantics id="alg5.l3.m4.1a"><mrow id="alg5.l3.m4.1.1" xref="alg5.l3.m4.1.1.cmml"><mi id="alg5.l3.m4.1.1.2" xref="alg5.l3.m4.1.1.2.cmml">t</mi><mo id="alg5.l3.m4.1.1.1" xref="alg5.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m4.1.1.3" xref="alg5.l3.m4.1.1.3.cmml">o</mi><mo id="alg5.l3.m4.1.1.1a" xref="alg5.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m4.1.1.4" xref="alg5.l3.m4.1.1.4.cmml">p</mi><mo id="alg5.l3.m4.1.1.1b" xref="alg5.l3.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l3.m4.1.1.5" xref="alg5.l3.m4.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l3.m4.1b"><apply id="alg5.l3.m4.1.1.cmml" xref="alg5.l3.m4.1.1"><times id="alg5.l3.m4.1.1.1.cmml" xref="alg5.l3.m4.1.1.1"></times><ci id="alg5.l3.m4.1.1.2.cmml" xref="alg5.l3.m4.1.1.2">𝑡</ci><ci id="alg5.l3.m4.1.1.3.cmml" xref="alg5.l3.m4.1.1.3">𝑜</ci><ci id="alg5.l3.m4.1.1.4.cmml" xref="alg5.l3.m4.1.1.4">𝑝</ci><ci id="alg5.l3.m4.1.1.5.cmml" xref="alg5.l3.m4.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m4.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m4.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg5.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l4.1.1.1" style="font-size:80%;">4:</span></span>     Load Embedded Data Vector <math alttext="ED" class="ltx_Math" display="inline" id="alg5.l4.m1.1"><semantics id="alg5.l4.m1.1a"><mrow id="alg5.l4.m1.1.1" xref="alg5.l4.m1.1.1.cmml"><mi id="alg5.l4.m1.1.1.2" xref="alg5.l4.m1.1.1.2.cmml">E</mi><mo id="alg5.l4.m1.1.1.1" xref="alg5.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l4.m1.1.1.3" xref="alg5.l4.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l4.m1.1b"><apply id="alg5.l4.m1.1.1.cmml" xref="alg5.l4.m1.1.1"><times id="alg5.l4.m1.1.1.1.cmml" xref="alg5.l4.m1.1.1.1"></times><ci id="alg5.l4.m1.1.1.2.cmml" xref="alg5.l4.m1.1.1.2">𝐸</ci><ci id="alg5.l4.m1.1.1.3.cmml" xref="alg5.l4.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l4.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg5.l4.m1.1d">italic_E italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l5.1.1.1" style="font-size:80%;">5:</span></span>     Load Embedding Model <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg5.l5.m1.1"><semantics id="alg5.l5.m1.1a"><mrow id="alg5.l5.m1.1.1" xref="alg5.l5.m1.1.1.cmml"><mi id="alg5.l5.m1.1.1.2" xref="alg5.l5.m1.1.1.2.cmml">E</mi><mo id="alg5.l5.m1.1.1.1" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.3" xref="alg5.l5.m1.1.1.3.cmml">m</mi><mo id="alg5.l5.m1.1.1.1a" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.4" xref="alg5.l5.m1.1.1.4.cmml">b</mi><mo id="alg5.l5.m1.1.1.1b" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.5" xref="alg5.l5.m1.1.1.5.cmml">e</mi><mo id="alg5.l5.m1.1.1.1c" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.6" xref="alg5.l5.m1.1.1.6.cmml">d</mi><mo id="alg5.l5.m1.1.1.1d" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.7" xref="alg5.l5.m1.1.1.7.cmml">M</mi><mo id="alg5.l5.m1.1.1.1e" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.8" xref="alg5.l5.m1.1.1.8.cmml">o</mi><mo id="alg5.l5.m1.1.1.1f" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.9" xref="alg5.l5.m1.1.1.9.cmml">d</mi><mo id="alg5.l5.m1.1.1.1g" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.10" xref="alg5.l5.m1.1.1.10.cmml">e</mi><mo id="alg5.l5.m1.1.1.1h" xref="alg5.l5.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l5.m1.1.1.11" xref="alg5.l5.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l5.m1.1b"><apply id="alg5.l5.m1.1.1.cmml" xref="alg5.l5.m1.1.1"><times id="alg5.l5.m1.1.1.1.cmml" xref="alg5.l5.m1.1.1.1"></times><ci id="alg5.l5.m1.1.1.2.cmml" xref="alg5.l5.m1.1.1.2">𝐸</ci><ci id="alg5.l5.m1.1.1.3.cmml" xref="alg5.l5.m1.1.1.3">𝑚</ci><ci id="alg5.l5.m1.1.1.4.cmml" xref="alg5.l5.m1.1.1.4">𝑏</ci><ci id="alg5.l5.m1.1.1.5.cmml" xref="alg5.l5.m1.1.1.5">𝑒</ci><ci id="alg5.l5.m1.1.1.6.cmml" xref="alg5.l5.m1.1.1.6">𝑑</ci><ci id="alg5.l5.m1.1.1.7.cmml" xref="alg5.l5.m1.1.1.7">𝑀</ci><ci id="alg5.l5.m1.1.1.8.cmml" xref="alg5.l5.m1.1.1.8">𝑜</ci><ci id="alg5.l5.m1.1.1.9.cmml" xref="alg5.l5.m1.1.1.9">𝑑</ci><ci id="alg5.l5.m1.1.1.10.cmml" xref="alg5.l5.m1.1.1.10">𝑒</ci><ci id="alg5.l5.m1.1.1.11.cmml" xref="alg5.l5.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l5.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg5.l5.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg5.l6.m1.1"><semantics id="alg5.l6.m1.1a"><mrow id="alg5.l6.m1.1.1" xref="alg5.l6.m1.1.1.cmml"><mi id="alg5.l6.m1.1.1.2" xref="alg5.l6.m1.1.1.2.cmml">E</mi><mo id="alg5.l6.m1.1.1.1" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.3" xref="alg5.l6.m1.1.1.3.cmml">m</mi><mo id="alg5.l6.m1.1.1.1a" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.4" xref="alg5.l6.m1.1.1.4.cmml">b</mi><mo id="alg5.l6.m1.1.1.1b" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.5" xref="alg5.l6.m1.1.1.5.cmml">e</mi><mo id="alg5.l6.m1.1.1.1c" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.6" xref="alg5.l6.m1.1.1.6.cmml">d</mi><mo id="alg5.l6.m1.1.1.1d" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.7" xref="alg5.l6.m1.1.1.7.cmml">M</mi><mo id="alg5.l6.m1.1.1.1e" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.8" xref="alg5.l6.m1.1.1.8.cmml">o</mi><mo id="alg5.l6.m1.1.1.1f" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.9" xref="alg5.l6.m1.1.1.9.cmml">d</mi><mo id="alg5.l6.m1.1.1.1g" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.10" xref="alg5.l6.m1.1.1.10.cmml">e</mi><mo id="alg5.l6.m1.1.1.1h" xref="alg5.l6.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l6.m1.1.1.11" xref="alg5.l6.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l6.m1.1b"><apply id="alg5.l6.m1.1.1.cmml" xref="alg5.l6.m1.1.1"><times id="alg5.l6.m1.1.1.1.cmml" xref="alg5.l6.m1.1.1.1"></times><ci id="alg5.l6.m1.1.1.2.cmml" xref="alg5.l6.m1.1.1.2">𝐸</ci><ci id="alg5.l6.m1.1.1.3.cmml" xref="alg5.l6.m1.1.1.3">𝑚</ci><ci id="alg5.l6.m1.1.1.4.cmml" xref="alg5.l6.m1.1.1.4">𝑏</ci><ci id="alg5.l6.m1.1.1.5.cmml" xref="alg5.l6.m1.1.1.5">𝑒</ci><ci id="alg5.l6.m1.1.1.6.cmml" xref="alg5.l6.m1.1.1.6">𝑑</ci><ci id="alg5.l6.m1.1.1.7.cmml" xref="alg5.l6.m1.1.1.7">𝑀</ci><ci id="alg5.l6.m1.1.1.8.cmml" xref="alg5.l6.m1.1.1.8">𝑜</ci><ci id="alg5.l6.m1.1.1.9.cmml" xref="alg5.l6.m1.1.1.9">𝑑</ci><ci id="alg5.l6.m1.1.1.10.cmml" xref="alg5.l6.m1.1.1.10">𝑒</ci><ci id="alg5.l6.m1.1.1.11.cmml" xref="alg5.l6.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l6.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg5.l6.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>=’mxbai-embed-large’

</div>
<div class="ltx_listingline" id="alg5.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l7.1.1.1" style="font-size:80%;">7:</span></span>     <math alttext="VRI" class="ltx_Math" display="inline" id="alg5.l7.m1.1"><semantics id="alg5.l7.m1.1a"><mrow id="alg5.l7.m1.1.1" xref="alg5.l7.m1.1.1.cmml"><mi id="alg5.l7.m1.1.1.2" xref="alg5.l7.m1.1.1.2.cmml">V</mi><mo id="alg5.l7.m1.1.1.1" xref="alg5.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m1.1.1.3" xref="alg5.l7.m1.1.1.3.cmml">R</mi><mo id="alg5.l7.m1.1.1.1a" xref="alg5.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m1.1.1.4" xref="alg5.l7.m1.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m1.1b"><apply id="alg5.l7.m1.1.1.cmml" xref="alg5.l7.m1.1.1"><times id="alg5.l7.m1.1.1.1.cmml" xref="alg5.l7.m1.1.1.1"></times><ci id="alg5.l7.m1.1.1.2.cmml" xref="alg5.l7.m1.1.1.2">𝑉</ci><ci id="alg5.l7.m1.1.1.3.cmml" xref="alg5.l7.m1.1.1.3">𝑅</ci><ci id="alg5.l7.m1.1.1.4.cmml" xref="alg5.l7.m1.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m1.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m1.1d">italic_V italic_R italic_I</annotation></semantics></math>=<math alttext="embedding" class="ltx_Math" display="inline" id="alg5.l7.m2.1"><semantics id="alg5.l7.m2.1a"><mrow id="alg5.l7.m2.1.1" xref="alg5.l7.m2.1.1.cmml"><mi id="alg5.l7.m2.1.1.2" xref="alg5.l7.m2.1.1.2.cmml">e</mi><mo id="alg5.l7.m2.1.1.1" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.3" xref="alg5.l7.m2.1.1.3.cmml">m</mi><mo id="alg5.l7.m2.1.1.1a" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.4" xref="alg5.l7.m2.1.1.4.cmml">b</mi><mo id="alg5.l7.m2.1.1.1b" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.5" xref="alg5.l7.m2.1.1.5.cmml">e</mi><mo id="alg5.l7.m2.1.1.1c" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.6" xref="alg5.l7.m2.1.1.6.cmml">d</mi><mo id="alg5.l7.m2.1.1.1d" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.7" xref="alg5.l7.m2.1.1.7.cmml">d</mi><mo id="alg5.l7.m2.1.1.1e" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.8" xref="alg5.l7.m2.1.1.8.cmml">i</mi><mo id="alg5.l7.m2.1.1.1f" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.9" xref="alg5.l7.m2.1.1.9.cmml">n</mi><mo id="alg5.l7.m2.1.1.1g" xref="alg5.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m2.1.1.10" xref="alg5.l7.m2.1.1.10.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m2.1b"><apply id="alg5.l7.m2.1.1.cmml" xref="alg5.l7.m2.1.1"><times id="alg5.l7.m2.1.1.1.cmml" xref="alg5.l7.m2.1.1.1"></times><ci id="alg5.l7.m2.1.1.2.cmml" xref="alg5.l7.m2.1.1.2">𝑒</ci><ci id="alg5.l7.m2.1.1.3.cmml" xref="alg5.l7.m2.1.1.3">𝑚</ci><ci id="alg5.l7.m2.1.1.4.cmml" xref="alg5.l7.m2.1.1.4">𝑏</ci><ci id="alg5.l7.m2.1.1.5.cmml" xref="alg5.l7.m2.1.1.5">𝑒</ci><ci id="alg5.l7.m2.1.1.6.cmml" xref="alg5.l7.m2.1.1.6">𝑑</ci><ci id="alg5.l7.m2.1.1.7.cmml" xref="alg5.l7.m2.1.1.7">𝑑</ci><ci id="alg5.l7.m2.1.1.8.cmml" xref="alg5.l7.m2.1.1.8">𝑖</ci><ci id="alg5.l7.m2.1.1.9.cmml" xref="alg5.l7.m2.1.1.9">𝑛</ci><ci id="alg5.l7.m2.1.1.10.cmml" xref="alg5.l7.m2.1.1.10">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m2.1c">embedding</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m2.1d">italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g</annotation></semantics></math>(<math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg5.l7.m3.1"><semantics id="alg5.l7.m3.1a"><mrow id="alg5.l7.m3.1.1" xref="alg5.l7.m3.1.1.cmml"><mi id="alg5.l7.m3.1.1.2" xref="alg5.l7.m3.1.1.2.cmml">E</mi><mo id="alg5.l7.m3.1.1.1" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.3" xref="alg5.l7.m3.1.1.3.cmml">m</mi><mo id="alg5.l7.m3.1.1.1a" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.4" xref="alg5.l7.m3.1.1.4.cmml">b</mi><mo id="alg5.l7.m3.1.1.1b" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.5" xref="alg5.l7.m3.1.1.5.cmml">e</mi><mo id="alg5.l7.m3.1.1.1c" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.6" xref="alg5.l7.m3.1.1.6.cmml">d</mi><mo id="alg5.l7.m3.1.1.1d" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.7" xref="alg5.l7.m3.1.1.7.cmml">M</mi><mo id="alg5.l7.m3.1.1.1e" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.8" xref="alg5.l7.m3.1.1.8.cmml">o</mi><mo id="alg5.l7.m3.1.1.1f" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.9" xref="alg5.l7.m3.1.1.9.cmml">d</mi><mo id="alg5.l7.m3.1.1.1g" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.10" xref="alg5.l7.m3.1.1.10.cmml">e</mi><mo id="alg5.l7.m3.1.1.1h" xref="alg5.l7.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m3.1.1.11" xref="alg5.l7.m3.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m3.1b"><apply id="alg5.l7.m3.1.1.cmml" xref="alg5.l7.m3.1.1"><times id="alg5.l7.m3.1.1.1.cmml" xref="alg5.l7.m3.1.1.1"></times><ci id="alg5.l7.m3.1.1.2.cmml" xref="alg5.l7.m3.1.1.2">𝐸</ci><ci id="alg5.l7.m3.1.1.3.cmml" xref="alg5.l7.m3.1.1.3">𝑚</ci><ci id="alg5.l7.m3.1.1.4.cmml" xref="alg5.l7.m3.1.1.4">𝑏</ci><ci id="alg5.l7.m3.1.1.5.cmml" xref="alg5.l7.m3.1.1.5">𝑒</ci><ci id="alg5.l7.m3.1.1.6.cmml" xref="alg5.l7.m3.1.1.6">𝑑</ci><ci id="alg5.l7.m3.1.1.7.cmml" xref="alg5.l7.m3.1.1.7">𝑀</ci><ci id="alg5.l7.m3.1.1.8.cmml" xref="alg5.l7.m3.1.1.8">𝑜</ci><ci id="alg5.l7.m3.1.1.9.cmml" xref="alg5.l7.m3.1.1.9">𝑑</ci><ci id="alg5.l7.m3.1.1.10.cmml" xref="alg5.l7.m3.1.1.10">𝑒</ci><ci id="alg5.l7.m3.1.1.11.cmml" xref="alg5.l7.m3.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m3.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m3.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>, <math alttext="Agentprompt" class="ltx_Math" display="inline" id="alg5.l7.m4.1"><semantics id="alg5.l7.m4.1a"><mrow id="alg5.l7.m4.1.1" xref="alg5.l7.m4.1.1.cmml"><mi id="alg5.l7.m4.1.1.2" xref="alg5.l7.m4.1.1.2.cmml">A</mi><mo id="alg5.l7.m4.1.1.1" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.3" xref="alg5.l7.m4.1.1.3.cmml">g</mi><mo id="alg5.l7.m4.1.1.1a" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.4" xref="alg5.l7.m4.1.1.4.cmml">e</mi><mo id="alg5.l7.m4.1.1.1b" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.5" xref="alg5.l7.m4.1.1.5.cmml">n</mi><mo id="alg5.l7.m4.1.1.1c" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.6" xref="alg5.l7.m4.1.1.6.cmml">t</mi><mo id="alg5.l7.m4.1.1.1d" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.7" xref="alg5.l7.m4.1.1.7.cmml">p</mi><mo id="alg5.l7.m4.1.1.1e" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.8" xref="alg5.l7.m4.1.1.8.cmml">r</mi><mo id="alg5.l7.m4.1.1.1f" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.9" xref="alg5.l7.m4.1.1.9.cmml">o</mi><mo id="alg5.l7.m4.1.1.1g" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.10" xref="alg5.l7.m4.1.1.10.cmml">m</mi><mo id="alg5.l7.m4.1.1.1h" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.11" xref="alg5.l7.m4.1.1.11.cmml">p</mi><mo id="alg5.l7.m4.1.1.1i" xref="alg5.l7.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m4.1.1.12" xref="alg5.l7.m4.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m4.1b"><apply id="alg5.l7.m4.1.1.cmml" xref="alg5.l7.m4.1.1"><times id="alg5.l7.m4.1.1.1.cmml" xref="alg5.l7.m4.1.1.1"></times><ci id="alg5.l7.m4.1.1.2.cmml" xref="alg5.l7.m4.1.1.2">𝐴</ci><ci id="alg5.l7.m4.1.1.3.cmml" xref="alg5.l7.m4.1.1.3">𝑔</ci><ci id="alg5.l7.m4.1.1.4.cmml" xref="alg5.l7.m4.1.1.4">𝑒</ci><ci id="alg5.l7.m4.1.1.5.cmml" xref="alg5.l7.m4.1.1.5">𝑛</ci><ci id="alg5.l7.m4.1.1.6.cmml" xref="alg5.l7.m4.1.1.6">𝑡</ci><ci id="alg5.l7.m4.1.1.7.cmml" xref="alg5.l7.m4.1.1.7">𝑝</ci><ci id="alg5.l7.m4.1.1.8.cmml" xref="alg5.l7.m4.1.1.8">𝑟</ci><ci id="alg5.l7.m4.1.1.9.cmml" xref="alg5.l7.m4.1.1.9">𝑜</ci><ci id="alg5.l7.m4.1.1.10.cmml" xref="alg5.l7.m4.1.1.10">𝑚</ci><ci id="alg5.l7.m4.1.1.11.cmml" xref="alg5.l7.m4.1.1.11">𝑝</ci><ci id="alg5.l7.m4.1.1.12.cmml" xref="alg5.l7.m4.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m4.1c">Agentprompt</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m4.1d">italic_A italic_g italic_e italic_n italic_t italic_p italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math>=<math alttext="RI" class="ltx_Math" display="inline" id="alg5.l7.m5.1"><semantics id="alg5.l7.m5.1a"><mrow id="alg5.l7.m5.1.1" xref="alg5.l7.m5.1.1.cmml"><mi id="alg5.l7.m5.1.1.2" xref="alg5.l7.m5.1.1.2.cmml">R</mi><mo id="alg5.l7.m5.1.1.1" xref="alg5.l7.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l7.m5.1.1.3" xref="alg5.l7.m5.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l7.m5.1b"><apply id="alg5.l7.m5.1.1.cmml" xref="alg5.l7.m5.1.1"><times id="alg5.l7.m5.1.1.1.cmml" xref="alg5.l7.m5.1.1.1"></times><ci id="alg5.l7.m5.1.1.2.cmml" xref="alg5.l7.m5.1.1.2">𝑅</ci><ci id="alg5.l7.m5.1.1.3.cmml" xref="alg5.l7.m5.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m5.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m5.1d">italic_R italic_I</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg5.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l8.1.1.1" style="font-size:80%;">8:</span></span>     <math alttext="SimilarityScores" class="ltx_Math" display="inline" id="alg5.l8.m1.1"><semantics id="alg5.l8.m1.1a"><mrow id="alg5.l8.m1.1.1" xref="alg5.l8.m1.1.1.cmml"><mi id="alg5.l8.m1.1.1.2" xref="alg5.l8.m1.1.1.2.cmml">S</mi><mo id="alg5.l8.m1.1.1.1" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.3" xref="alg5.l8.m1.1.1.3.cmml">i</mi><mo id="alg5.l8.m1.1.1.1a" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.4" xref="alg5.l8.m1.1.1.4.cmml">m</mi><mo id="alg5.l8.m1.1.1.1b" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.5" xref="alg5.l8.m1.1.1.5.cmml">i</mi><mo id="alg5.l8.m1.1.1.1c" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.6" xref="alg5.l8.m1.1.1.6.cmml">l</mi><mo id="alg5.l8.m1.1.1.1d" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.7" xref="alg5.l8.m1.1.1.7.cmml">a</mi><mo id="alg5.l8.m1.1.1.1e" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.8" xref="alg5.l8.m1.1.1.8.cmml">r</mi><mo id="alg5.l8.m1.1.1.1f" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.9" xref="alg5.l8.m1.1.1.9.cmml">i</mi><mo id="alg5.l8.m1.1.1.1g" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.10" xref="alg5.l8.m1.1.1.10.cmml">t</mi><mo id="alg5.l8.m1.1.1.1h" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.11" xref="alg5.l8.m1.1.1.11.cmml">y</mi><mo id="alg5.l8.m1.1.1.1i" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.12" xref="alg5.l8.m1.1.1.12.cmml">S</mi><mo id="alg5.l8.m1.1.1.1j" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.13" xref="alg5.l8.m1.1.1.13.cmml">c</mi><mo id="alg5.l8.m1.1.1.1k" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.14" xref="alg5.l8.m1.1.1.14.cmml">o</mi><mo id="alg5.l8.m1.1.1.1l" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.15" xref="alg5.l8.m1.1.1.15.cmml">r</mi><mo id="alg5.l8.m1.1.1.1m" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.16" xref="alg5.l8.m1.1.1.16.cmml">e</mi><mo id="alg5.l8.m1.1.1.1n" xref="alg5.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m1.1.1.17" xref="alg5.l8.m1.1.1.17.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l8.m1.1b"><apply id="alg5.l8.m1.1.1.cmml" xref="alg5.l8.m1.1.1"><times id="alg5.l8.m1.1.1.1.cmml" xref="alg5.l8.m1.1.1.1"></times><ci id="alg5.l8.m1.1.1.2.cmml" xref="alg5.l8.m1.1.1.2">𝑆</ci><ci id="alg5.l8.m1.1.1.3.cmml" xref="alg5.l8.m1.1.1.3">𝑖</ci><ci id="alg5.l8.m1.1.1.4.cmml" xref="alg5.l8.m1.1.1.4">𝑚</ci><ci id="alg5.l8.m1.1.1.5.cmml" xref="alg5.l8.m1.1.1.5">𝑖</ci><ci id="alg5.l8.m1.1.1.6.cmml" xref="alg5.l8.m1.1.1.6">𝑙</ci><ci id="alg5.l8.m1.1.1.7.cmml" xref="alg5.l8.m1.1.1.7">𝑎</ci><ci id="alg5.l8.m1.1.1.8.cmml" xref="alg5.l8.m1.1.1.8">𝑟</ci><ci id="alg5.l8.m1.1.1.9.cmml" xref="alg5.l8.m1.1.1.9">𝑖</ci><ci id="alg5.l8.m1.1.1.10.cmml" xref="alg5.l8.m1.1.1.10">𝑡</ci><ci id="alg5.l8.m1.1.1.11.cmml" xref="alg5.l8.m1.1.1.11">𝑦</ci><ci id="alg5.l8.m1.1.1.12.cmml" xref="alg5.l8.m1.1.1.12">𝑆</ci><ci id="alg5.l8.m1.1.1.13.cmml" xref="alg5.l8.m1.1.1.13">𝑐</ci><ci id="alg5.l8.m1.1.1.14.cmml" xref="alg5.l8.m1.1.1.14">𝑜</ci><ci id="alg5.l8.m1.1.1.15.cmml" xref="alg5.l8.m1.1.1.15">𝑟</ci><ci id="alg5.l8.m1.1.1.16.cmml" xref="alg5.l8.m1.1.1.16">𝑒</ci><ci id="alg5.l8.m1.1.1.17.cmml" xref="alg5.l8.m1.1.1.17">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l8.m1.1c">SimilarityScores</annotation><annotation encoding="application/x-llamapun" id="alg5.l8.m1.1d">italic_S italic_i italic_m italic_i italic_l italic_a italic_r italic_i italic_t italic_y italic_S italic_c italic_o italic_r italic_e italic_s</annotation></semantics></math> = cosine_similarity(<math alttext="VRI" class="ltx_Math" display="inline" id="alg5.l8.m2.1"><semantics id="alg5.l8.m2.1a"><mrow id="alg5.l8.m2.1.1" xref="alg5.l8.m2.1.1.cmml"><mi id="alg5.l8.m2.1.1.2" xref="alg5.l8.m2.1.1.2.cmml">V</mi><mo id="alg5.l8.m2.1.1.1" xref="alg5.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m2.1.1.3" xref="alg5.l8.m2.1.1.3.cmml">R</mi><mo id="alg5.l8.m2.1.1.1a" xref="alg5.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m2.1.1.4" xref="alg5.l8.m2.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l8.m2.1b"><apply id="alg5.l8.m2.1.1.cmml" xref="alg5.l8.m2.1.1"><times id="alg5.l8.m2.1.1.1.cmml" xref="alg5.l8.m2.1.1.1"></times><ci id="alg5.l8.m2.1.1.2.cmml" xref="alg5.l8.m2.1.1.2">𝑉</ci><ci id="alg5.l8.m2.1.1.3.cmml" xref="alg5.l8.m2.1.1.3">𝑅</ci><ci id="alg5.l8.m2.1.1.4.cmml" xref="alg5.l8.m2.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l8.m2.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="alg5.l8.m2.1d">italic_V italic_R italic_I</annotation></semantics></math>, <math alttext="ED" class="ltx_Math" display="inline" id="alg5.l8.m3.1"><semantics id="alg5.l8.m3.1a"><mrow id="alg5.l8.m3.1.1" xref="alg5.l8.m3.1.1.cmml"><mi id="alg5.l8.m3.1.1.2" xref="alg5.l8.m3.1.1.2.cmml">E</mi><mo id="alg5.l8.m3.1.1.1" xref="alg5.l8.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l8.m3.1.1.3" xref="alg5.l8.m3.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l8.m3.1b"><apply id="alg5.l8.m3.1.1.cmml" xref="alg5.l8.m3.1.1"><times id="alg5.l8.m3.1.1.1.cmml" xref="alg5.l8.m3.1.1.1"></times><ci id="alg5.l8.m3.1.1.2.cmml" xref="alg5.l8.m3.1.1.2">𝐸</ci><ci id="alg5.l8.m3.1.1.3.cmml" xref="alg5.l8.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l8.m3.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg5.l8.m3.1d">italic_E italic_D</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg5.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l9.1.1.1" style="font-size:80%;">9:</span></span>     <math alttext="topk" class="ltx_Math" display="inline" id="alg5.l9.m1.1"><semantics id="alg5.l9.m1.1a"><mrow id="alg5.l9.m1.1.1" xref="alg5.l9.m1.1.1.cmml"><mi id="alg5.l9.m1.1.1.2" xref="alg5.l9.m1.1.1.2.cmml">t</mi><mo id="alg5.l9.m1.1.1.1" xref="alg5.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m1.1.1.3" xref="alg5.l9.m1.1.1.3.cmml">o</mi><mo id="alg5.l9.m1.1.1.1a" xref="alg5.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m1.1.1.4" xref="alg5.l9.m1.1.1.4.cmml">p</mi><mo id="alg5.l9.m1.1.1.1b" xref="alg5.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m1.1.1.5" xref="alg5.l9.m1.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m1.1b"><apply id="alg5.l9.m1.1.1.cmml" xref="alg5.l9.m1.1.1"><times id="alg5.l9.m1.1.1.1.cmml" xref="alg5.l9.m1.1.1.1"></times><ci id="alg5.l9.m1.1.1.2.cmml" xref="alg5.l9.m1.1.1.2">𝑡</ci><ci id="alg5.l9.m1.1.1.3.cmml" xref="alg5.l9.m1.1.1.3">𝑜</ci><ci id="alg5.l9.m1.1.1.4.cmml" xref="alg5.l9.m1.1.1.4">𝑝</ci><ci id="alg5.l9.m1.1.1.5.cmml" xref="alg5.l9.m1.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m1.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg5.l9.m1.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> = <math alttext="min" class="ltx_Math" display="inline" id="alg5.l9.m2.1"><semantics id="alg5.l9.m2.1a"><mrow id="alg5.l9.m2.1.1" xref="alg5.l9.m2.1.1.cmml"><mi id="alg5.l9.m2.1.1.2" xref="alg5.l9.m2.1.1.2.cmml">m</mi><mo id="alg5.l9.m2.1.1.1" xref="alg5.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m2.1.1.3" xref="alg5.l9.m2.1.1.3.cmml">i</mi><mo id="alg5.l9.m2.1.1.1a" xref="alg5.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m2.1.1.4" xref="alg5.l9.m2.1.1.4.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m2.1b"><apply id="alg5.l9.m2.1.1.cmml" xref="alg5.l9.m2.1.1"><times id="alg5.l9.m2.1.1.1.cmml" xref="alg5.l9.m2.1.1.1"></times><ci id="alg5.l9.m2.1.1.2.cmml" xref="alg5.l9.m2.1.1.2">𝑚</ci><ci id="alg5.l9.m2.1.1.3.cmml" xref="alg5.l9.m2.1.1.3">𝑖</ci><ci id="alg5.l9.m2.1.1.4.cmml" xref="alg5.l9.m2.1.1.4">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m2.1c">min</annotation><annotation encoding="application/x-llamapun" id="alg5.l9.m2.1d">italic_m italic_i italic_n</annotation></semantics></math>(<math alttext="topk" class="ltx_Math" display="inline" id="alg5.l9.m3.1"><semantics id="alg5.l9.m3.1a"><mrow id="alg5.l9.m3.1.1" xref="alg5.l9.m3.1.1.cmml"><mi id="alg5.l9.m3.1.1.2" xref="alg5.l9.m3.1.1.2.cmml">t</mi><mo id="alg5.l9.m3.1.1.1" xref="alg5.l9.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m3.1.1.3" xref="alg5.l9.m3.1.1.3.cmml">o</mi><mo id="alg5.l9.m3.1.1.1a" xref="alg5.l9.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m3.1.1.4" xref="alg5.l9.m3.1.1.4.cmml">p</mi><mo id="alg5.l9.m3.1.1.1b" xref="alg5.l9.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m3.1.1.5" xref="alg5.l9.m3.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m3.1b"><apply id="alg5.l9.m3.1.1.cmml" xref="alg5.l9.m3.1.1"><times id="alg5.l9.m3.1.1.1.cmml" xref="alg5.l9.m3.1.1.1"></times><ci id="alg5.l9.m3.1.1.2.cmml" xref="alg5.l9.m3.1.1.2">𝑡</ci><ci id="alg5.l9.m3.1.1.3.cmml" xref="alg5.l9.m3.1.1.3">𝑜</ci><ci id="alg5.l9.m3.1.1.4.cmml" xref="alg5.l9.m3.1.1.4">𝑝</ci><ci id="alg5.l9.m3.1.1.5.cmml" xref="alg5.l9.m3.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m3.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg5.l9.m3.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>, <math alttext="Len" class="ltx_Math" display="inline" id="alg5.l9.m4.1"><semantics id="alg5.l9.m4.1a"><mrow id="alg5.l9.m4.1.1" xref="alg5.l9.m4.1.1.cmml"><mi id="alg5.l9.m4.1.1.2" xref="alg5.l9.m4.1.1.2.cmml">L</mi><mo id="alg5.l9.m4.1.1.1" xref="alg5.l9.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m4.1.1.3" xref="alg5.l9.m4.1.1.3.cmml">e</mi><mo id="alg5.l9.m4.1.1.1a" xref="alg5.l9.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m4.1.1.4" xref="alg5.l9.m4.1.1.4.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m4.1b"><apply id="alg5.l9.m4.1.1.cmml" xref="alg5.l9.m4.1.1"><times id="alg5.l9.m4.1.1.1.cmml" xref="alg5.l9.m4.1.1.1"></times><ci id="alg5.l9.m4.1.1.2.cmml" xref="alg5.l9.m4.1.1.2">𝐿</ci><ci id="alg5.l9.m4.1.1.3.cmml" xref="alg5.l9.m4.1.1.3">𝑒</ci><ci id="alg5.l9.m4.1.1.4.cmml" xref="alg5.l9.m4.1.1.4">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m4.1c">Len</annotation><annotation encoding="application/x-llamapun" id="alg5.l9.m4.1d">italic_L italic_e italic_n</annotation></semantics></math>(<math alttext="SimilarityScores" class="ltx_Math" display="inline" id="alg5.l9.m5.1"><semantics id="alg5.l9.m5.1a"><mrow id="alg5.l9.m5.1.1" xref="alg5.l9.m5.1.1.cmml"><mi id="alg5.l9.m5.1.1.2" xref="alg5.l9.m5.1.1.2.cmml">S</mi><mo id="alg5.l9.m5.1.1.1" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.3" xref="alg5.l9.m5.1.1.3.cmml">i</mi><mo id="alg5.l9.m5.1.1.1a" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.4" xref="alg5.l9.m5.1.1.4.cmml">m</mi><mo id="alg5.l9.m5.1.1.1b" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.5" xref="alg5.l9.m5.1.1.5.cmml">i</mi><mo id="alg5.l9.m5.1.1.1c" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.6" xref="alg5.l9.m5.1.1.6.cmml">l</mi><mo id="alg5.l9.m5.1.1.1d" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.7" xref="alg5.l9.m5.1.1.7.cmml">a</mi><mo id="alg5.l9.m5.1.1.1e" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.8" xref="alg5.l9.m5.1.1.8.cmml">r</mi><mo id="alg5.l9.m5.1.1.1f" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.9" xref="alg5.l9.m5.1.1.9.cmml">i</mi><mo id="alg5.l9.m5.1.1.1g" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.10" xref="alg5.l9.m5.1.1.10.cmml">t</mi><mo id="alg5.l9.m5.1.1.1h" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.11" xref="alg5.l9.m5.1.1.11.cmml">y</mi><mo id="alg5.l9.m5.1.1.1i" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.12" xref="alg5.l9.m5.1.1.12.cmml">S</mi><mo id="alg5.l9.m5.1.1.1j" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.13" xref="alg5.l9.m5.1.1.13.cmml">c</mi><mo id="alg5.l9.m5.1.1.1k" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.14" xref="alg5.l9.m5.1.1.14.cmml">o</mi><mo id="alg5.l9.m5.1.1.1l" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.15" xref="alg5.l9.m5.1.1.15.cmml">r</mi><mo id="alg5.l9.m5.1.1.1m" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.16" xref="alg5.l9.m5.1.1.16.cmml">e</mi><mo id="alg5.l9.m5.1.1.1n" xref="alg5.l9.m5.1.1.1.cmml">⁢</mo><mi id="alg5.l9.m5.1.1.17" xref="alg5.l9.m5.1.1.17.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l9.m5.1b"><apply id="alg5.l9.m5.1.1.cmml" xref="alg5.l9.m5.1.1"><times id="alg5.l9.m5.1.1.1.cmml" xref="alg5.l9.m5.1.1.1"></times><ci id="alg5.l9.m5.1.1.2.cmml" xref="alg5.l9.m5.1.1.2">𝑆</ci><ci id="alg5.l9.m5.1.1.3.cmml" xref="alg5.l9.m5.1.1.3">𝑖</ci><ci id="alg5.l9.m5.1.1.4.cmml" xref="alg5.l9.m5.1.1.4">𝑚</ci><ci id="alg5.l9.m5.1.1.5.cmml" xref="alg5.l9.m5.1.1.5">𝑖</ci><ci id="alg5.l9.m5.1.1.6.cmml" xref="alg5.l9.m5.1.1.6">𝑙</ci><ci id="alg5.l9.m5.1.1.7.cmml" xref="alg5.l9.m5.1.1.7">𝑎</ci><ci id="alg5.l9.m5.1.1.8.cmml" xref="alg5.l9.m5.1.1.8">𝑟</ci><ci id="alg5.l9.m5.1.1.9.cmml" xref="alg5.l9.m5.1.1.9">𝑖</ci><ci id="alg5.l9.m5.1.1.10.cmml" xref="alg5.l9.m5.1.1.10">𝑡</ci><ci id="alg5.l9.m5.1.1.11.cmml" xref="alg5.l9.m5.1.1.11">𝑦</ci><ci id="alg5.l9.m5.1.1.12.cmml" xref="alg5.l9.m5.1.1.12">𝑆</ci><ci id="alg5.l9.m5.1.1.13.cmml" xref="alg5.l9.m5.1.1.13">𝑐</ci><ci id="alg5.l9.m5.1.1.14.cmml" xref="alg5.l9.m5.1.1.14">𝑜</ci><ci id="alg5.l9.m5.1.1.15.cmml" xref="alg5.l9.m5.1.1.15">𝑟</ci><ci id="alg5.l9.m5.1.1.16.cmml" xref="alg5.l9.m5.1.1.16">𝑒</ci><ci id="alg5.l9.m5.1.1.17.cmml" xref="alg5.l9.m5.1.1.17">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l9.m5.1c">SimilarityScores</annotation><annotation encoding="application/x-llamapun" id="alg5.l9.m5.1d">italic_S italic_i italic_m italic_i italic_l italic_a italic_r italic_i italic_t italic_y italic_S italic_c italic_o italic_r italic_e italic_s</annotation></semantics></math>))

</div>
<div class="ltx_listingline" id="alg5.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l10.1.1.1" style="font-size:80%;">10:</span></span>     <math alttext="TopIndices" class="ltx_Math" display="inline" id="alg5.l10.m1.1"><semantics id="alg5.l10.m1.1a"><mrow id="alg5.l10.m1.1.1" xref="alg5.l10.m1.1.1.cmml"><mi id="alg5.l10.m1.1.1.2" xref="alg5.l10.m1.1.1.2.cmml">T</mi><mo id="alg5.l10.m1.1.1.1" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.3" xref="alg5.l10.m1.1.1.3.cmml">o</mi><mo id="alg5.l10.m1.1.1.1a" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.4" xref="alg5.l10.m1.1.1.4.cmml">p</mi><mo id="alg5.l10.m1.1.1.1b" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.5" xref="alg5.l10.m1.1.1.5.cmml">I</mi><mo id="alg5.l10.m1.1.1.1c" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.6" xref="alg5.l10.m1.1.1.6.cmml">n</mi><mo id="alg5.l10.m1.1.1.1d" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.7" xref="alg5.l10.m1.1.1.7.cmml">d</mi><mo id="alg5.l10.m1.1.1.1e" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.8" xref="alg5.l10.m1.1.1.8.cmml">i</mi><mo id="alg5.l10.m1.1.1.1f" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.9" xref="alg5.l10.m1.1.1.9.cmml">c</mi><mo id="alg5.l10.m1.1.1.1g" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.10" xref="alg5.l10.m1.1.1.10.cmml">e</mi><mo id="alg5.l10.m1.1.1.1h" xref="alg5.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m1.1.1.11" xref="alg5.l10.m1.1.1.11.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l10.m1.1b"><apply id="alg5.l10.m1.1.1.cmml" xref="alg5.l10.m1.1.1"><times id="alg5.l10.m1.1.1.1.cmml" xref="alg5.l10.m1.1.1.1"></times><ci id="alg5.l10.m1.1.1.2.cmml" xref="alg5.l10.m1.1.1.2">𝑇</ci><ci id="alg5.l10.m1.1.1.3.cmml" xref="alg5.l10.m1.1.1.3">𝑜</ci><ci id="alg5.l10.m1.1.1.4.cmml" xref="alg5.l10.m1.1.1.4">𝑝</ci><ci id="alg5.l10.m1.1.1.5.cmml" xref="alg5.l10.m1.1.1.5">𝐼</ci><ci id="alg5.l10.m1.1.1.6.cmml" xref="alg5.l10.m1.1.1.6">𝑛</ci><ci id="alg5.l10.m1.1.1.7.cmml" xref="alg5.l10.m1.1.1.7">𝑑</ci><ci id="alg5.l10.m1.1.1.8.cmml" xref="alg5.l10.m1.1.1.8">𝑖</ci><ci id="alg5.l10.m1.1.1.9.cmml" xref="alg5.l10.m1.1.1.9">𝑐</ci><ci id="alg5.l10.m1.1.1.10.cmml" xref="alg5.l10.m1.1.1.10">𝑒</ci><ci id="alg5.l10.m1.1.1.11.cmml" xref="alg5.l10.m1.1.1.11">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l10.m1.1c">TopIndices</annotation><annotation encoding="application/x-llamapun" id="alg5.l10.m1.1d">italic_T italic_o italic_p italic_I italic_n italic_d italic_i italic_c italic_e italic_s</annotation></semantics></math> = <math alttext="getTopKIndice" class="ltx_Math" display="inline" id="alg5.l10.m2.1"><semantics id="alg5.l10.m2.1a"><mrow id="alg5.l10.m2.1.1" xref="alg5.l10.m2.1.1.cmml"><mi id="alg5.l10.m2.1.1.2" xref="alg5.l10.m2.1.1.2.cmml">g</mi><mo id="alg5.l10.m2.1.1.1" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.3" xref="alg5.l10.m2.1.1.3.cmml">e</mi><mo id="alg5.l10.m2.1.1.1a" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.4" xref="alg5.l10.m2.1.1.4.cmml">t</mi><mo id="alg5.l10.m2.1.1.1b" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.5" xref="alg5.l10.m2.1.1.5.cmml">T</mi><mo id="alg5.l10.m2.1.1.1c" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.6" xref="alg5.l10.m2.1.1.6.cmml">o</mi><mo id="alg5.l10.m2.1.1.1d" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.7" xref="alg5.l10.m2.1.1.7.cmml">p</mi><mo id="alg5.l10.m2.1.1.1e" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.8" xref="alg5.l10.m2.1.1.8.cmml">K</mi><mo id="alg5.l10.m2.1.1.1f" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.9" xref="alg5.l10.m2.1.1.9.cmml">I</mi><mo id="alg5.l10.m2.1.1.1g" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.10" xref="alg5.l10.m2.1.1.10.cmml">n</mi><mo id="alg5.l10.m2.1.1.1h" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.11" xref="alg5.l10.m2.1.1.11.cmml">d</mi><mo id="alg5.l10.m2.1.1.1i" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.12" xref="alg5.l10.m2.1.1.12.cmml">i</mi><mo id="alg5.l10.m2.1.1.1j" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.13" xref="alg5.l10.m2.1.1.13.cmml">c</mi><mo id="alg5.l10.m2.1.1.1k" xref="alg5.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m2.1.1.14" xref="alg5.l10.m2.1.1.14.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l10.m2.1b"><apply id="alg5.l10.m2.1.1.cmml" xref="alg5.l10.m2.1.1"><times id="alg5.l10.m2.1.1.1.cmml" xref="alg5.l10.m2.1.1.1"></times><ci id="alg5.l10.m2.1.1.2.cmml" xref="alg5.l10.m2.1.1.2">𝑔</ci><ci id="alg5.l10.m2.1.1.3.cmml" xref="alg5.l10.m2.1.1.3">𝑒</ci><ci id="alg5.l10.m2.1.1.4.cmml" xref="alg5.l10.m2.1.1.4">𝑡</ci><ci id="alg5.l10.m2.1.1.5.cmml" xref="alg5.l10.m2.1.1.5">𝑇</ci><ci id="alg5.l10.m2.1.1.6.cmml" xref="alg5.l10.m2.1.1.6">𝑜</ci><ci id="alg5.l10.m2.1.1.7.cmml" xref="alg5.l10.m2.1.1.7">𝑝</ci><ci id="alg5.l10.m2.1.1.8.cmml" xref="alg5.l10.m2.1.1.8">𝐾</ci><ci id="alg5.l10.m2.1.1.9.cmml" xref="alg5.l10.m2.1.1.9">𝐼</ci><ci id="alg5.l10.m2.1.1.10.cmml" xref="alg5.l10.m2.1.1.10">𝑛</ci><ci id="alg5.l10.m2.1.1.11.cmml" xref="alg5.l10.m2.1.1.11">𝑑</ci><ci id="alg5.l10.m2.1.1.12.cmml" xref="alg5.l10.m2.1.1.12">𝑖</ci><ci id="alg5.l10.m2.1.1.13.cmml" xref="alg5.l10.m2.1.1.13">𝑐</ci><ci id="alg5.l10.m2.1.1.14.cmml" xref="alg5.l10.m2.1.1.14">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l10.m2.1c">getTopKIndice</annotation><annotation encoding="application/x-llamapun" id="alg5.l10.m2.1d">italic_g italic_e italic_t italic_T italic_o italic_p italic_K italic_I italic_n italic_d italic_i italic_c italic_e</annotation></semantics></math>(<math alttext="SimilarityScores" class="ltx_Math" display="inline" id="alg5.l10.m3.1"><semantics id="alg5.l10.m3.1a"><mrow id="alg5.l10.m3.1.1" xref="alg5.l10.m3.1.1.cmml"><mi id="alg5.l10.m3.1.1.2" xref="alg5.l10.m3.1.1.2.cmml">S</mi><mo id="alg5.l10.m3.1.1.1" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.3" xref="alg5.l10.m3.1.1.3.cmml">i</mi><mo id="alg5.l10.m3.1.1.1a" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.4" xref="alg5.l10.m3.1.1.4.cmml">m</mi><mo id="alg5.l10.m3.1.1.1b" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.5" xref="alg5.l10.m3.1.1.5.cmml">i</mi><mo id="alg5.l10.m3.1.1.1c" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.6" xref="alg5.l10.m3.1.1.6.cmml">l</mi><mo id="alg5.l10.m3.1.1.1d" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.7" xref="alg5.l10.m3.1.1.7.cmml">a</mi><mo id="alg5.l10.m3.1.1.1e" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.8" xref="alg5.l10.m3.1.1.8.cmml">r</mi><mo id="alg5.l10.m3.1.1.1f" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.9" xref="alg5.l10.m3.1.1.9.cmml">i</mi><mo id="alg5.l10.m3.1.1.1g" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.10" xref="alg5.l10.m3.1.1.10.cmml">t</mi><mo id="alg5.l10.m3.1.1.1h" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.11" xref="alg5.l10.m3.1.1.11.cmml">y</mi><mo id="alg5.l10.m3.1.1.1i" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.12" xref="alg5.l10.m3.1.1.12.cmml">S</mi><mo id="alg5.l10.m3.1.1.1j" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.13" xref="alg5.l10.m3.1.1.13.cmml">c</mi><mo id="alg5.l10.m3.1.1.1k" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.14" xref="alg5.l10.m3.1.1.14.cmml">o</mi><mo id="alg5.l10.m3.1.1.1l" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.15" xref="alg5.l10.m3.1.1.15.cmml">r</mi><mo id="alg5.l10.m3.1.1.1m" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.16" xref="alg5.l10.m3.1.1.16.cmml">e</mi><mo id="alg5.l10.m3.1.1.1n" xref="alg5.l10.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m3.1.1.17" xref="alg5.l10.m3.1.1.17.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l10.m3.1b"><apply id="alg5.l10.m3.1.1.cmml" xref="alg5.l10.m3.1.1"><times id="alg5.l10.m3.1.1.1.cmml" xref="alg5.l10.m3.1.1.1"></times><ci id="alg5.l10.m3.1.1.2.cmml" xref="alg5.l10.m3.1.1.2">𝑆</ci><ci id="alg5.l10.m3.1.1.3.cmml" xref="alg5.l10.m3.1.1.3">𝑖</ci><ci id="alg5.l10.m3.1.1.4.cmml" xref="alg5.l10.m3.1.1.4">𝑚</ci><ci id="alg5.l10.m3.1.1.5.cmml" xref="alg5.l10.m3.1.1.5">𝑖</ci><ci id="alg5.l10.m3.1.1.6.cmml" xref="alg5.l10.m3.1.1.6">𝑙</ci><ci id="alg5.l10.m3.1.1.7.cmml" xref="alg5.l10.m3.1.1.7">𝑎</ci><ci id="alg5.l10.m3.1.1.8.cmml" xref="alg5.l10.m3.1.1.8">𝑟</ci><ci id="alg5.l10.m3.1.1.9.cmml" xref="alg5.l10.m3.1.1.9">𝑖</ci><ci id="alg5.l10.m3.1.1.10.cmml" xref="alg5.l10.m3.1.1.10">𝑡</ci><ci id="alg5.l10.m3.1.1.11.cmml" xref="alg5.l10.m3.1.1.11">𝑦</ci><ci id="alg5.l10.m3.1.1.12.cmml" xref="alg5.l10.m3.1.1.12">𝑆</ci><ci id="alg5.l10.m3.1.1.13.cmml" xref="alg5.l10.m3.1.1.13">𝑐</ci><ci id="alg5.l10.m3.1.1.14.cmml" xref="alg5.l10.m3.1.1.14">𝑜</ci><ci id="alg5.l10.m3.1.1.15.cmml" xref="alg5.l10.m3.1.1.15">𝑟</ci><ci id="alg5.l10.m3.1.1.16.cmml" xref="alg5.l10.m3.1.1.16">𝑒</ci><ci id="alg5.l10.m3.1.1.17.cmml" xref="alg5.l10.m3.1.1.17">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l10.m3.1c">SimilarityScores</annotation><annotation encoding="application/x-llamapun" id="alg5.l10.m3.1d">italic_S italic_i italic_m italic_i italic_l italic_a italic_r italic_i italic_t italic_y italic_S italic_c italic_o italic_r italic_e italic_s</annotation></semantics></math>, <math alttext="topk" class="ltx_Math" display="inline" id="alg5.l10.m4.1"><semantics id="alg5.l10.m4.1a"><mrow id="alg5.l10.m4.1.1" xref="alg5.l10.m4.1.1.cmml"><mi id="alg5.l10.m4.1.1.2" xref="alg5.l10.m4.1.1.2.cmml">t</mi><mo id="alg5.l10.m4.1.1.1" xref="alg5.l10.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m4.1.1.3" xref="alg5.l10.m4.1.1.3.cmml">o</mi><mo id="alg5.l10.m4.1.1.1a" xref="alg5.l10.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m4.1.1.4" xref="alg5.l10.m4.1.1.4.cmml">p</mi><mo id="alg5.l10.m4.1.1.1b" xref="alg5.l10.m4.1.1.1.cmml">⁢</mo><mi id="alg5.l10.m4.1.1.5" xref="alg5.l10.m4.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l10.m4.1b"><apply id="alg5.l10.m4.1.1.cmml" xref="alg5.l10.m4.1.1"><times id="alg5.l10.m4.1.1.1.cmml" xref="alg5.l10.m4.1.1.1"></times><ci id="alg5.l10.m4.1.1.2.cmml" xref="alg5.l10.m4.1.1.2">𝑡</ci><ci id="alg5.l10.m4.1.1.3.cmml" xref="alg5.l10.m4.1.1.3">𝑜</ci><ci id="alg5.l10.m4.1.1.4.cmml" xref="alg5.l10.m4.1.1.4">𝑝</ci><ci id="alg5.l10.m4.1.1.5.cmml" xref="alg5.l10.m4.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l10.m4.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg5.l10.m4.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg5.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l11.1.1.1" style="font-size:80%;">11:</span></span>     <span class="ltx_text ltx_font_bold" id="alg5.l11.2">for</span>  <math alttext="indice" class="ltx_Math" display="inline" id="alg5.l11.m1.1"><semantics id="alg5.l11.m1.1a"><mrow id="alg5.l11.m1.1.1" xref="alg5.l11.m1.1.1.cmml"><mi id="alg5.l11.m1.1.1.2" xref="alg5.l11.m1.1.1.2.cmml">i</mi><mo id="alg5.l11.m1.1.1.1" xref="alg5.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m1.1.1.3" xref="alg5.l11.m1.1.1.3.cmml">n</mi><mo id="alg5.l11.m1.1.1.1a" xref="alg5.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m1.1.1.4" xref="alg5.l11.m1.1.1.4.cmml">d</mi><mo id="alg5.l11.m1.1.1.1b" xref="alg5.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m1.1.1.5" xref="alg5.l11.m1.1.1.5.cmml">i</mi><mo id="alg5.l11.m1.1.1.1c" xref="alg5.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m1.1.1.6" xref="alg5.l11.m1.1.1.6.cmml">c</mi><mo id="alg5.l11.m1.1.1.1d" xref="alg5.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m1.1.1.7" xref="alg5.l11.m1.1.1.7.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l11.m1.1b"><apply id="alg5.l11.m1.1.1.cmml" xref="alg5.l11.m1.1.1"><times id="alg5.l11.m1.1.1.1.cmml" xref="alg5.l11.m1.1.1.1"></times><ci id="alg5.l11.m1.1.1.2.cmml" xref="alg5.l11.m1.1.1.2">𝑖</ci><ci id="alg5.l11.m1.1.1.3.cmml" xref="alg5.l11.m1.1.1.3">𝑛</ci><ci id="alg5.l11.m1.1.1.4.cmml" xref="alg5.l11.m1.1.1.4">𝑑</ci><ci id="alg5.l11.m1.1.1.5.cmml" xref="alg5.l11.m1.1.1.5">𝑖</ci><ci id="alg5.l11.m1.1.1.6.cmml" xref="alg5.l11.m1.1.1.6">𝑐</ci><ci id="alg5.l11.m1.1.1.7.cmml" xref="alg5.l11.m1.1.1.7">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l11.m1.1c">indice</annotation><annotation encoding="application/x-llamapun" id="alg5.l11.m1.1d">italic_i italic_n italic_d italic_i italic_c italic_e</annotation></semantics></math> in <math alttext="TopIndices" class="ltx_Math" display="inline" id="alg5.l11.m2.1"><semantics id="alg5.l11.m2.1a"><mrow id="alg5.l11.m2.1.1" xref="alg5.l11.m2.1.1.cmml"><mi id="alg5.l11.m2.1.1.2" xref="alg5.l11.m2.1.1.2.cmml">T</mi><mo id="alg5.l11.m2.1.1.1" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.3" xref="alg5.l11.m2.1.1.3.cmml">o</mi><mo id="alg5.l11.m2.1.1.1a" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.4" xref="alg5.l11.m2.1.1.4.cmml">p</mi><mo id="alg5.l11.m2.1.1.1b" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.5" xref="alg5.l11.m2.1.1.5.cmml">I</mi><mo id="alg5.l11.m2.1.1.1c" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.6" xref="alg5.l11.m2.1.1.6.cmml">n</mi><mo id="alg5.l11.m2.1.1.1d" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.7" xref="alg5.l11.m2.1.1.7.cmml">d</mi><mo id="alg5.l11.m2.1.1.1e" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.8" xref="alg5.l11.m2.1.1.8.cmml">i</mi><mo id="alg5.l11.m2.1.1.1f" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.9" xref="alg5.l11.m2.1.1.9.cmml">c</mi><mo id="alg5.l11.m2.1.1.1g" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.10" xref="alg5.l11.m2.1.1.10.cmml">e</mi><mo id="alg5.l11.m2.1.1.1h" xref="alg5.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l11.m2.1.1.11" xref="alg5.l11.m2.1.1.11.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l11.m2.1b"><apply id="alg5.l11.m2.1.1.cmml" xref="alg5.l11.m2.1.1"><times id="alg5.l11.m2.1.1.1.cmml" xref="alg5.l11.m2.1.1.1"></times><ci id="alg5.l11.m2.1.1.2.cmml" xref="alg5.l11.m2.1.1.2">𝑇</ci><ci id="alg5.l11.m2.1.1.3.cmml" xref="alg5.l11.m2.1.1.3">𝑜</ci><ci id="alg5.l11.m2.1.1.4.cmml" xref="alg5.l11.m2.1.1.4">𝑝</ci><ci id="alg5.l11.m2.1.1.5.cmml" xref="alg5.l11.m2.1.1.5">𝐼</ci><ci id="alg5.l11.m2.1.1.6.cmml" xref="alg5.l11.m2.1.1.6">𝑛</ci><ci id="alg5.l11.m2.1.1.7.cmml" xref="alg5.l11.m2.1.1.7">𝑑</ci><ci id="alg5.l11.m2.1.1.8.cmml" xref="alg5.l11.m2.1.1.8">𝑖</ci><ci id="alg5.l11.m2.1.1.9.cmml" xref="alg5.l11.m2.1.1.9">𝑐</ci><ci id="alg5.l11.m2.1.1.10.cmml" xref="alg5.l11.m2.1.1.10">𝑒</ci><ci id="alg5.l11.m2.1.1.11.cmml" xref="alg5.l11.m2.1.1.11">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l11.m2.1c">TopIndices</annotation><annotation encoding="application/x-llamapun" id="alg5.l11.m2.1d">italic_T italic_o italic_p italic_I italic_n italic_d italic_i italic_c italic_e italic_s</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg5.l11.3">do</span>
</div>
<div class="ltx_listingline" id="alg5.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l12.1.1.1" style="font-size:80%;">12:</span></span>         <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg5.l12.m1.1"><semantics id="alg5.l12.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg5.l12.m1.1.1" xref="alg5.l12.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg5.l12.m1.1b"><ci id="alg5.l12.m1.1.1.cmml" xref="alg5.l12.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l12.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg5.l12.m1.1d">caligraphic_I</annotation></semantics></math>.append(<math alttext="PT" class="ltx_Math" display="inline" id="alg5.l12.m2.1"><semantics id="alg5.l12.m2.1a"><mrow id="alg5.l12.m2.1.1" xref="alg5.l12.m2.1.1.cmml"><mi id="alg5.l12.m2.1.1.2" xref="alg5.l12.m2.1.1.2.cmml">P</mi><mo id="alg5.l12.m2.1.1.1" xref="alg5.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m2.1.1.3" xref="alg5.l12.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l12.m2.1b"><apply id="alg5.l12.m2.1.1.cmml" xref="alg5.l12.m2.1.1"><times id="alg5.l12.m2.1.1.1.cmml" xref="alg5.l12.m2.1.1.1"></times><ci id="alg5.l12.m2.1.1.2.cmml" xref="alg5.l12.m2.1.1.2">𝑃</ci><ci id="alg5.l12.m2.1.1.3.cmml" xref="alg5.l12.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l12.m2.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg5.l12.m2.1d">italic_P italic_T</annotation></semantics></math>[<math alttext="indice" class="ltx_Math" display="inline" id="alg5.l12.m3.1"><semantics id="alg5.l12.m3.1a"><mrow id="alg5.l12.m3.1.1" xref="alg5.l12.m3.1.1.cmml"><mi id="alg5.l12.m3.1.1.2" xref="alg5.l12.m3.1.1.2.cmml">i</mi><mo id="alg5.l12.m3.1.1.1" xref="alg5.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m3.1.1.3" xref="alg5.l12.m3.1.1.3.cmml">n</mi><mo id="alg5.l12.m3.1.1.1a" xref="alg5.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m3.1.1.4" xref="alg5.l12.m3.1.1.4.cmml">d</mi><mo id="alg5.l12.m3.1.1.1b" xref="alg5.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m3.1.1.5" xref="alg5.l12.m3.1.1.5.cmml">i</mi><mo id="alg5.l12.m3.1.1.1c" xref="alg5.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m3.1.1.6" xref="alg5.l12.m3.1.1.6.cmml">c</mi><mo id="alg5.l12.m3.1.1.1d" xref="alg5.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg5.l12.m3.1.1.7" xref="alg5.l12.m3.1.1.7.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg5.l12.m3.1b"><apply id="alg5.l12.m3.1.1.cmml" xref="alg5.l12.m3.1.1"><times id="alg5.l12.m3.1.1.1.cmml" xref="alg5.l12.m3.1.1.1"></times><ci id="alg5.l12.m3.1.1.2.cmml" xref="alg5.l12.m3.1.1.2">𝑖</ci><ci id="alg5.l12.m3.1.1.3.cmml" xref="alg5.l12.m3.1.1.3">𝑛</ci><ci id="alg5.l12.m3.1.1.4.cmml" xref="alg5.l12.m3.1.1.4">𝑑</ci><ci id="alg5.l12.m3.1.1.5.cmml" xref="alg5.l12.m3.1.1.5">𝑖</ci><ci id="alg5.l12.m3.1.1.6.cmml" xref="alg5.l12.m3.1.1.6">𝑐</ci><ci id="alg5.l12.m3.1.1.7.cmml" xref="alg5.l12.m3.1.1.7">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l12.m3.1c">indice</annotation><annotation encoding="application/x-llamapun" id="alg5.l12.m3.1d">italic_i italic_n italic_d italic_i italic_c italic_e</annotation></semantics></math>])

</div>
<div class="ltx_listingline" id="alg5.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l13.1.1.1" style="font-size:80%;">13:</span></span>     <span class="ltx_text ltx_font_bold" id="alg5.l13.2">end</span> <span class="ltx_text ltx_font_bold" id="alg5.l13.3">for</span>
</div>
<div class="ltx_listingline" id="alg5.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l14.1.1.1" style="font-size:80%;">14:</span></span>     <span class="ltx_text ltx_font_bold" id="alg5.l14.2">return</span> <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg5.l14.m1.1"><semantics id="alg5.l14.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg5.l14.m1.1.1" xref="alg5.l14.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg5.l14.m1.1b"><ci id="alg5.l14.m1.1.1.cmml" xref="alg5.l14.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l14.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg5.l14.m1.1d">caligraphic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg5.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text ltx_font_bold" id="alg5.l15.2">end</span> <span class="ltx_text ltx_font_bold" id="alg5.l15.3">function</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS6.5.1.1">IV-F</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS6.6.2">LLMs for an efficient Timeline Analysis (TA)</span>
</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.2">In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg6" title="Algorithm 6 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, after successfully generating a new query <math alttext="RI" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">R</mi><mo id="S4.SS6.p1.1.m1.1.1.1" xref="S4.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><times id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1.1"></times><ci id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">𝑅</ci><ci id="S4.SS6.p1.1.m1.1.1.3.cmml" xref="S4.SS6.p1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">RI</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">italic_R italic_I</annotation></semantics></math> and retrieving the context-based information <math alttext="I" class="ltx_Math" display="inline" id="S4.SS6.p1.2.m2.1"><semantics id="S4.SS6.p1.2.m2.1a"><mi id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><ci id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">italic_I</annotation></semantics></math>, the agent sends this information to the LLM. GenDFIR functions as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F9" title="Figure 9 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>:</p>
</div>
<figure class="ltx_figure" id="S4.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="492" id="S4.F9.g1" src="extracted/5878186/img/gendfir.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>GenDFIR Framework.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS6.p2">
<ul class="ltx_itemize" id="S4.I11">
<li class="ltx_item" id="S4.I11.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i1.p1">
<p class="ltx_p" id="S4.I11.i1.p1.1">The first step is to ensure all data are preprocessed. Since GendFIR focuses on only two modalities—text in Case 1 and images in Case 2, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F9" title="Figure 9 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>—raw incident images in Case 2 are processed by the Llava-Llama3 MLLM to provide a forensic description of their content. This description is then combined with additional textual information related to the incident. A description alone is not enough, as the framework is responsible for timeline analysis (TA). Therefore, extra data, such as metadata extracted from the images (shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F9" title="Figure 9 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>) and actions related to the event (e.g., sending, deleting, or altering the image) are included. An initial digital forensics (DF) report containing the raw incident events is created and then filtered using the R-BAI algorithm to minimize and reduce the number of artefacts and data collected based on the defined rules.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i2.p1">
<p class="ltx_p" id="S4.I11.i2.p1.4">The document produced, denoted as <math alttext="D" class="ltx_Math" display="inline" id="S4.I11.i2.p1.1.m1.1"><semantics id="S4.I11.i2.p1.1.m1.1a"><mi id="S4.I11.i2.p1.1.m1.1.1" xref="S4.I11.i2.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.I11.i2.p1.1.m1.1b"><ci id="S4.I11.i2.p1.1.m1.1.1.cmml" xref="S4.I11.i2.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i2.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i2.p1.1.m1.1d">italic_D</annotation></semantics></math>, is considered the External Knowledge Base <math alttext="K" class="ltx_Math" display="inline" id="S4.I11.i2.p1.2.m2.1"><semantics id="S4.I11.i2.p1.2.m2.1a"><mi id="S4.I11.i2.p1.2.m2.1.1" xref="S4.I11.i2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I11.i2.p1.2.m2.1b"><ci id="S4.I11.i2.p1.2.m2.1.1.cmml" xref="S4.I11.i2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i2.p1.2.m2.1d">italic_K</annotation></semantics></math>, which includes all filtered anomalous events <math alttext="A" class="ltx_Math" display="inline" id="S4.I11.i2.p1.3.m3.1"><semantics id="S4.I11.i2.p1.3.m3.1a"><mi id="S4.I11.i2.p1.3.m3.1.1" xref="S4.I11.i2.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.I11.i2.p1.3.m3.1b"><ci id="S4.I11.i2.p1.3.m3.1.1.cmml" xref="S4.I11.i2.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i2.p1.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i2.p1.3.m3.1d">italic_A</annotation></semantics></math> from the incident that is deemed potential evidence, whether in text or PDF format. This External Knowledge Base <math alttext="K" class="ltx_Math" display="inline" id="S4.I11.i2.p1.4.m4.1"><semantics id="S4.I11.i2.p1.4.m4.1a"><mi id="S4.I11.i2.p1.4.m4.1.1" xref="S4.I11.i2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I11.i2.p1.4.m4.1b"><ci id="S4.I11.i2.p1.4.m4.1.1.cmml" xref="S4.I11.i2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i2.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i2.p1.4.m4.1d">italic_K</annotation></semantics></math> is uploaded to the AI system to be indexed as external memory for the single-modal LLM Llama-3.1.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i3.p1">
<p class="ltx_p" id="S4.I11.i3.p1.1">A DFIR analyst or expert conducting the TA through GenDFIR can either provide inputs to the system (Forensic Questions) or instruct the framework to perform a forensic TA.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i4.p1">
<p class="ltx_p" id="S4.I11.i4.p1.2">GenDFIR processes the input in accordance with the system message (<math alttext="SysMSG" class="ltx_Math" display="inline" id="S4.I11.i4.p1.1.m1.1"><semantics id="S4.I11.i4.p1.1.m1.1a"><mrow id="S4.I11.i4.p1.1.m1.1.1" xref="S4.I11.i4.p1.1.m1.1.1.cmml"><mi id="S4.I11.i4.p1.1.m1.1.1.2" xref="S4.I11.i4.p1.1.m1.1.1.2.cmml">S</mi><mo id="S4.I11.i4.p1.1.m1.1.1.1" xref="S4.I11.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.1.m1.1.1.3" xref="S4.I11.i4.p1.1.m1.1.1.3.cmml">y</mi><mo id="S4.I11.i4.p1.1.m1.1.1.1a" xref="S4.I11.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.1.m1.1.1.4" xref="S4.I11.i4.p1.1.m1.1.1.4.cmml">s</mi><mo id="S4.I11.i4.p1.1.m1.1.1.1b" xref="S4.I11.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.1.m1.1.1.5" xref="S4.I11.i4.p1.1.m1.1.1.5.cmml">M</mi><mo id="S4.I11.i4.p1.1.m1.1.1.1c" xref="S4.I11.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.1.m1.1.1.6" xref="S4.I11.i4.p1.1.m1.1.1.6.cmml">S</mi><mo id="S4.I11.i4.p1.1.m1.1.1.1d" xref="S4.I11.i4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.1.m1.1.1.7" xref="S4.I11.i4.p1.1.m1.1.1.7.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I11.i4.p1.1.m1.1b"><apply id="S4.I11.i4.p1.1.m1.1.1.cmml" xref="S4.I11.i4.p1.1.m1.1.1"><times id="S4.I11.i4.p1.1.m1.1.1.1.cmml" xref="S4.I11.i4.p1.1.m1.1.1.1"></times><ci id="S4.I11.i4.p1.1.m1.1.1.2.cmml" xref="S4.I11.i4.p1.1.m1.1.1.2">𝑆</ci><ci id="S4.I11.i4.p1.1.m1.1.1.3.cmml" xref="S4.I11.i4.p1.1.m1.1.1.3">𝑦</ci><ci id="S4.I11.i4.p1.1.m1.1.1.4.cmml" xref="S4.I11.i4.p1.1.m1.1.1.4">𝑠</ci><ci id="S4.I11.i4.p1.1.m1.1.1.5.cmml" xref="S4.I11.i4.p1.1.m1.1.1.5">𝑀</ci><ci id="S4.I11.i4.p1.1.m1.1.1.6.cmml" xref="S4.I11.i4.p1.1.m1.1.1.6">𝑆</ci><ci id="S4.I11.i4.p1.1.m1.1.1.7.cmml" xref="S4.I11.i4.p1.1.m1.1.1.7">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i4.p1.1.m1.1c">SysMSG</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i4.p1.1.m1.1d">italic_S italic_y italic_s italic_M italic_S italic_G</annotation></semantics></math> in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#alg6" title="Algorithm 6 ‣ IV-F LLMs for an efficient Timeline Analysis (TA) ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>). If the DFIR analyst’s input is incorrect or inadequately prompted, the agent prompt (<math alttext="AgentPrompt" class="ltx_Math" display="inline" id="S4.I11.i4.p1.2.m2.1"><semantics id="S4.I11.i4.p1.2.m2.1a"><mrow id="S4.I11.i4.p1.2.m2.1.1" xref="S4.I11.i4.p1.2.m2.1.1.cmml"><mi id="S4.I11.i4.p1.2.m2.1.1.2" xref="S4.I11.i4.p1.2.m2.1.1.2.cmml">A</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.3" xref="S4.I11.i4.p1.2.m2.1.1.3.cmml">g</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1a" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.4" xref="S4.I11.i4.p1.2.m2.1.1.4.cmml">e</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1b" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.5" xref="S4.I11.i4.p1.2.m2.1.1.5.cmml">n</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1c" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.6" xref="S4.I11.i4.p1.2.m2.1.1.6.cmml">t</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1d" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.7" xref="S4.I11.i4.p1.2.m2.1.1.7.cmml">P</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1e" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.8" xref="S4.I11.i4.p1.2.m2.1.1.8.cmml">r</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1f" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.9" xref="S4.I11.i4.p1.2.m2.1.1.9.cmml">o</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1g" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.10" xref="S4.I11.i4.p1.2.m2.1.1.10.cmml">m</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1h" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.11" xref="S4.I11.i4.p1.2.m2.1.1.11.cmml">p</mi><mo id="S4.I11.i4.p1.2.m2.1.1.1i" xref="S4.I11.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.I11.i4.p1.2.m2.1.1.12" xref="S4.I11.i4.p1.2.m2.1.1.12.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I11.i4.p1.2.m2.1b"><apply id="S4.I11.i4.p1.2.m2.1.1.cmml" xref="S4.I11.i4.p1.2.m2.1.1"><times id="S4.I11.i4.p1.2.m2.1.1.1.cmml" xref="S4.I11.i4.p1.2.m2.1.1.1"></times><ci id="S4.I11.i4.p1.2.m2.1.1.2.cmml" xref="S4.I11.i4.p1.2.m2.1.1.2">𝐴</ci><ci id="S4.I11.i4.p1.2.m2.1.1.3.cmml" xref="S4.I11.i4.p1.2.m2.1.1.3">𝑔</ci><ci id="S4.I11.i4.p1.2.m2.1.1.4.cmml" xref="S4.I11.i4.p1.2.m2.1.1.4">𝑒</ci><ci id="S4.I11.i4.p1.2.m2.1.1.5.cmml" xref="S4.I11.i4.p1.2.m2.1.1.5">𝑛</ci><ci id="S4.I11.i4.p1.2.m2.1.1.6.cmml" xref="S4.I11.i4.p1.2.m2.1.1.6">𝑡</ci><ci id="S4.I11.i4.p1.2.m2.1.1.7.cmml" xref="S4.I11.i4.p1.2.m2.1.1.7">𝑃</ci><ci id="S4.I11.i4.p1.2.m2.1.1.8.cmml" xref="S4.I11.i4.p1.2.m2.1.1.8">𝑟</ci><ci id="S4.I11.i4.p1.2.m2.1.1.9.cmml" xref="S4.I11.i4.p1.2.m2.1.1.9">𝑜</ci><ci id="S4.I11.i4.p1.2.m2.1.1.10.cmml" xref="S4.I11.i4.p1.2.m2.1.1.10">𝑚</ci><ci id="S4.I11.i4.p1.2.m2.1.1.11.cmml" xref="S4.I11.i4.p1.2.m2.1.1.11">𝑝</ci><ci id="S4.I11.i4.p1.2.m2.1.1.12.cmml" xref="S4.I11.i4.p1.2.m2.1.1.12">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i4.p1.2.m2.1c">AgentPrompt</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i4.p1.2.m2.1d">italic_A italic_g italic_e italic_n italic_t italic_P italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math> in Algorithm 4) will adjust the query based on its content. In either case, GenDFIR generates a new query based on the indexed knowledge base.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i5.p1">
<p class="ltx_p" id="S4.I11.i5.p1.1">During inference, all data, including user input and data, undergoes an embedding process using the mxbai model, transforming them into high-dimensional vectors.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i6.p1">
<p class="ltx_p" id="S4.I11.i6.p1.1">After processing, the RAG agent performs a retrieval using the cosine similarity function to measure and calculate the similarity score from the knowledge base and identify features from the event that match the DFIR analyst’s input. In other words, the agent searches for evidence (relevant information <math alttext="I" class="ltx_Math" display="inline" id="S4.I11.i6.p1.1.m1.1"><semantics id="S4.I11.i6.p1.1.m1.1a"><mi id="S4.I11.i6.p1.1.m1.1.1" xref="S4.I11.i6.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.I11.i6.p1.1.m1.1b"><ci id="S4.I11.i6.p1.1.m1.1.1.cmml" xref="S4.I11.i6.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I11.i6.p1.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.I11.i6.p1.1.m1.1d">italic_I</annotation></semantics></math>) of the incident within the knowledge base to retrieve it. The retrieved information is then sent to the LLM for further semantic understanding, as it is initially presented in numerical format. The cosine similarity function, mathematically operates on the vectors of the user input and the knowledge base, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4.F6" title="Figure 6 ‣ IV-E DFIR Retrieval-Augmented Generation (RAG) Agent ‣ IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I11.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I11.i7.p1">
<p class="ltx_p" id="S4.I11.i7.p1.1">The LLM receives the evidence (retrieved information), processes it according to the agent prompt, system message, and user input, and generates an augmented answer. This answer includes not only the retrieved evidence but also additional information such as the analysis of the artifacts, event correlations, and mitigation solutions. The LLM then presents the answer to the DFIR analyst in the form of a forensic TA report.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg6.2.1.1">Algorithm 6</span> </span> GenDFIR</figcaption>
<div class="ltx_listing ltx_listing" id="alg6.3">
<div class="ltx_listingline" id="alg6.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l1.1.1.1" style="font-size:80%;">1:</span></span>User Query or Input for the main <math alttext="UI" class="ltx_Math" display="inline" id="alg6.l1.m1.1"><semantics id="alg6.l1.m1.1a"><mrow id="alg6.l1.m1.1.1" xref="alg6.l1.m1.1.1.cmml"><mi id="alg6.l1.m1.1.1.2" xref="alg6.l1.m1.1.1.2.cmml">U</mi><mo id="alg6.l1.m1.1.1.1" xref="alg6.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l1.m1.1.1.3" xref="alg6.l1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l1.m1.1b"><apply id="alg6.l1.m1.1.1.cmml" xref="alg6.l1.m1.1.1"><times id="alg6.l1.m1.1.1.1.cmml" xref="alg6.l1.m1.1.1.1"></times><ci id="alg6.l1.m1.1.1.2.cmml" xref="alg6.l1.m1.1.1.2">𝑈</ci><ci id="alg6.l1.m1.1.1.3.cmml" xref="alg6.l1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l1.m1.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg6.l1.m1.1d">italic_U italic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l2.1.1.1" style="font-size:80%;">2:</span></span>LLM accurate answer and relevant to the context (Timeline Analysis, Event timeline reconstruction and correlation) <math alttext="answer" class="ltx_Math" display="inline" id="alg6.l2.m1.1"><semantics id="alg6.l2.m1.1a"><mrow id="alg6.l2.m1.1.1" xref="alg6.l2.m1.1.1.cmml"><mi id="alg6.l2.m1.1.1.2" xref="alg6.l2.m1.1.1.2.cmml">a</mi><mo id="alg6.l2.m1.1.1.1" xref="alg6.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l2.m1.1.1.3" xref="alg6.l2.m1.1.1.3.cmml">n</mi><mo id="alg6.l2.m1.1.1.1a" xref="alg6.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l2.m1.1.1.4" xref="alg6.l2.m1.1.1.4.cmml">s</mi><mo id="alg6.l2.m1.1.1.1b" xref="alg6.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l2.m1.1.1.5" xref="alg6.l2.m1.1.1.5.cmml">w</mi><mo id="alg6.l2.m1.1.1.1c" xref="alg6.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l2.m1.1.1.6" xref="alg6.l2.m1.1.1.6.cmml">e</mi><mo id="alg6.l2.m1.1.1.1d" xref="alg6.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l2.m1.1.1.7" xref="alg6.l2.m1.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l2.m1.1b"><apply id="alg6.l2.m1.1.1.cmml" xref="alg6.l2.m1.1.1"><times id="alg6.l2.m1.1.1.1.cmml" xref="alg6.l2.m1.1.1.1"></times><ci id="alg6.l2.m1.1.1.2.cmml" xref="alg6.l2.m1.1.1.2">𝑎</ci><ci id="alg6.l2.m1.1.1.3.cmml" xref="alg6.l2.m1.1.1.3">𝑛</ci><ci id="alg6.l2.m1.1.1.4.cmml" xref="alg6.l2.m1.1.1.4">𝑠</ci><ci id="alg6.l2.m1.1.1.5.cmml" xref="alg6.l2.m1.1.1.5">𝑤</ci><ci id="alg6.l2.m1.1.1.6.cmml" xref="alg6.l2.m1.1.1.6">𝑒</ci><ci id="alg6.l2.m1.1.1.7.cmml" xref="alg6.l2.m1.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l2.m1.1c">answer</annotation><annotation encoding="application/x-llamapun" id="alg6.l2.m1.1d">italic_a italic_n italic_s italic_w italic_e italic_r</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l3.1.1.1" style="font-size:80%;">3:</span></span>Load Text <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="alg6.l3.m1.1"><semantics id="alg6.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg6.l3.m1.1.1" xref="alg6.l3.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg6.l3.m1.1b"><ci id="alg6.l3.m1.1.1.cmml" xref="alg6.l3.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l3.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="alg6.l3.m1.1d">caligraphic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l4.1.1.1" style="font-size:80%;">4:</span></span>Set a message for the AI agent to stay on context <math alttext="SysMsg" class="ltx_Math" display="inline" id="alg6.l4.m1.1"><semantics id="alg6.l4.m1.1a"><mrow id="alg6.l4.m1.1.1" xref="alg6.l4.m1.1.1.cmml"><mi id="alg6.l4.m1.1.1.2" xref="alg6.l4.m1.1.1.2.cmml">S</mi><mo id="alg6.l4.m1.1.1.1" xref="alg6.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l4.m1.1.1.3" xref="alg6.l4.m1.1.1.3.cmml">y</mi><mo id="alg6.l4.m1.1.1.1a" xref="alg6.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l4.m1.1.1.4" xref="alg6.l4.m1.1.1.4.cmml">s</mi><mo id="alg6.l4.m1.1.1.1b" xref="alg6.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l4.m1.1.1.5" xref="alg6.l4.m1.1.1.5.cmml">M</mi><mo id="alg6.l4.m1.1.1.1c" xref="alg6.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l4.m1.1.1.6" xref="alg6.l4.m1.1.1.6.cmml">s</mi><mo id="alg6.l4.m1.1.1.1d" xref="alg6.l4.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l4.m1.1.1.7" xref="alg6.l4.m1.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l4.m1.1b"><apply id="alg6.l4.m1.1.1.cmml" xref="alg6.l4.m1.1.1"><times id="alg6.l4.m1.1.1.1.cmml" xref="alg6.l4.m1.1.1.1"></times><ci id="alg6.l4.m1.1.1.2.cmml" xref="alg6.l4.m1.1.1.2">𝑆</ci><ci id="alg6.l4.m1.1.1.3.cmml" xref="alg6.l4.m1.1.1.3">𝑦</ci><ci id="alg6.l4.m1.1.1.4.cmml" xref="alg6.l4.m1.1.1.4">𝑠</ci><ci id="alg6.l4.m1.1.1.5.cmml" xref="alg6.l4.m1.1.1.5">𝑀</ci><ci id="alg6.l4.m1.1.1.6.cmml" xref="alg6.l4.m1.1.1.6">𝑠</ci><ci id="alg6.l4.m1.1.1.7.cmml" xref="alg6.l4.m1.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l4.m1.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg6.l4.m1.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l5.1.1.1" style="font-size:80%;">5:</span></span>Load LLM Model Llama-3.1 <math alttext="llama-3.1" class="ltx_Math" display="inline" id="alg6.l5.m1.1"><semantics id="alg6.l5.m1.1a"><mrow id="alg6.l5.m1.1.1" xref="alg6.l5.m1.1.1.cmml"><mrow id="alg6.l5.m1.1.1.2" xref="alg6.l5.m1.1.1.2.cmml"><mi id="alg6.l5.m1.1.1.2.2" xref="alg6.l5.m1.1.1.2.2.cmml">l</mi><mo id="alg6.l5.m1.1.1.2.1" xref="alg6.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l5.m1.1.1.2.3" xref="alg6.l5.m1.1.1.2.3.cmml">l</mi><mo id="alg6.l5.m1.1.1.2.1a" xref="alg6.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l5.m1.1.1.2.4" xref="alg6.l5.m1.1.1.2.4.cmml">a</mi><mo id="alg6.l5.m1.1.1.2.1b" xref="alg6.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l5.m1.1.1.2.5" xref="alg6.l5.m1.1.1.2.5.cmml">m</mi><mo id="alg6.l5.m1.1.1.2.1c" xref="alg6.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l5.m1.1.1.2.6" xref="alg6.l5.m1.1.1.2.6.cmml">a</mi></mrow><mo id="alg6.l5.m1.1.1.1" xref="alg6.l5.m1.1.1.1.cmml">−</mo><mn id="alg6.l5.m1.1.1.3" xref="alg6.l5.m1.1.1.3.cmml">3.1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg6.l5.m1.1b"><apply id="alg6.l5.m1.1.1.cmml" xref="alg6.l5.m1.1.1"><minus id="alg6.l5.m1.1.1.1.cmml" xref="alg6.l5.m1.1.1.1"></minus><apply id="alg6.l5.m1.1.1.2.cmml" xref="alg6.l5.m1.1.1.2"><times id="alg6.l5.m1.1.1.2.1.cmml" xref="alg6.l5.m1.1.1.2.1"></times><ci id="alg6.l5.m1.1.1.2.2.cmml" xref="alg6.l5.m1.1.1.2.2">𝑙</ci><ci id="alg6.l5.m1.1.1.2.3.cmml" xref="alg6.l5.m1.1.1.2.3">𝑙</ci><ci id="alg6.l5.m1.1.1.2.4.cmml" xref="alg6.l5.m1.1.1.2.4">𝑎</ci><ci id="alg6.l5.m1.1.1.2.5.cmml" xref="alg6.l5.m1.1.1.2.5">𝑚</ci><ci id="alg6.l5.m1.1.1.2.6.cmml" xref="alg6.l5.m1.1.1.2.6">𝑎</ci></apply><cn id="alg6.l5.m1.1.1.3.cmml" type="float" xref="alg6.l5.m1.1.1.3">3.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l5.m1.1c">llama-3.1</annotation><annotation encoding="application/x-llamapun" id="alg6.l5.m1.1d">italic_l italic_l italic_a italic_m italic_a - 3.1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l6.1.1.1" style="font-size:80%;">6:</span></span>Load LLM Embedding Model ’mxbai-embed-large’

</div>
<div class="ltx_listingline" id="alg6.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l7.1.1.1" style="font-size:80%;">7:</span></span><math alttext="SysMsg" class="ltx_Math" display="inline" id="alg6.l7.m1.1"><semantics id="alg6.l7.m1.1a"><mrow id="alg6.l7.m1.1.1" xref="alg6.l7.m1.1.1.cmml"><mi id="alg6.l7.m1.1.1.2" xref="alg6.l7.m1.1.1.2.cmml">S</mi><mo id="alg6.l7.m1.1.1.1" xref="alg6.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l7.m1.1.1.3" xref="alg6.l7.m1.1.1.3.cmml">y</mi><mo id="alg6.l7.m1.1.1.1a" xref="alg6.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l7.m1.1.1.4" xref="alg6.l7.m1.1.1.4.cmml">s</mi><mo id="alg6.l7.m1.1.1.1b" xref="alg6.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l7.m1.1.1.5" xref="alg6.l7.m1.1.1.5.cmml">M</mi><mo id="alg6.l7.m1.1.1.1c" xref="alg6.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l7.m1.1.1.6" xref="alg6.l7.m1.1.1.6.cmml">s</mi><mo id="alg6.l7.m1.1.1.1d" xref="alg6.l7.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l7.m1.1.1.7" xref="alg6.l7.m1.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l7.m1.1b"><apply id="alg6.l7.m1.1.1.cmml" xref="alg6.l7.m1.1.1"><times id="alg6.l7.m1.1.1.1.cmml" xref="alg6.l7.m1.1.1.1"></times><ci id="alg6.l7.m1.1.1.2.cmml" xref="alg6.l7.m1.1.1.2">𝑆</ci><ci id="alg6.l7.m1.1.1.3.cmml" xref="alg6.l7.m1.1.1.3">𝑦</ci><ci id="alg6.l7.m1.1.1.4.cmml" xref="alg6.l7.m1.1.1.4">𝑠</ci><ci id="alg6.l7.m1.1.1.5.cmml" xref="alg6.l7.m1.1.1.5">𝑀</ci><ci id="alg6.l7.m1.1.1.6.cmml" xref="alg6.l7.m1.1.1.6">𝑠</ci><ci id="alg6.l7.m1.1.1.7.cmml" xref="alg6.l7.m1.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l7.m1.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg6.l7.m1.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math> = "You are an expert Cybersecurity and Digital Forensics assistant, specialising in timeline analysis. You perform timeline analysis by analysing digital artefacts and temporal artefacts, reconstructing timelines, and correlating events"

</div>
<div class="ltx_listingline" id="alg6.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l8.1.1.1" style="font-size:80%;">8:</span></span><math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg6.l8.m1.1"><semantics id="alg6.l8.m1.1a"><mrow id="alg6.l8.m1.1.1" xref="alg6.l8.m1.1.1.cmml"><mi id="alg6.l8.m1.1.1.2" xref="alg6.l8.m1.1.1.2.cmml">E</mi><mo id="alg6.l8.m1.1.1.1" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.3" xref="alg6.l8.m1.1.1.3.cmml">m</mi><mo id="alg6.l8.m1.1.1.1a" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.4" xref="alg6.l8.m1.1.1.4.cmml">b</mi><mo id="alg6.l8.m1.1.1.1b" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.5" xref="alg6.l8.m1.1.1.5.cmml">e</mi><mo id="alg6.l8.m1.1.1.1c" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.6" xref="alg6.l8.m1.1.1.6.cmml">d</mi><mo id="alg6.l8.m1.1.1.1d" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.7" xref="alg6.l8.m1.1.1.7.cmml">M</mi><mo id="alg6.l8.m1.1.1.1e" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.8" xref="alg6.l8.m1.1.1.8.cmml">o</mi><mo id="alg6.l8.m1.1.1.1f" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.9" xref="alg6.l8.m1.1.1.9.cmml">d</mi><mo id="alg6.l8.m1.1.1.1g" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.10" xref="alg6.l8.m1.1.1.10.cmml">e</mi><mo id="alg6.l8.m1.1.1.1h" xref="alg6.l8.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l8.m1.1.1.11" xref="alg6.l8.m1.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l8.m1.1b"><apply id="alg6.l8.m1.1.1.cmml" xref="alg6.l8.m1.1.1"><times id="alg6.l8.m1.1.1.1.cmml" xref="alg6.l8.m1.1.1.1"></times><ci id="alg6.l8.m1.1.1.2.cmml" xref="alg6.l8.m1.1.1.2">𝐸</ci><ci id="alg6.l8.m1.1.1.3.cmml" xref="alg6.l8.m1.1.1.3">𝑚</ci><ci id="alg6.l8.m1.1.1.4.cmml" xref="alg6.l8.m1.1.1.4">𝑏</ci><ci id="alg6.l8.m1.1.1.5.cmml" xref="alg6.l8.m1.1.1.5">𝑒</ci><ci id="alg6.l8.m1.1.1.6.cmml" xref="alg6.l8.m1.1.1.6">𝑑</ci><ci id="alg6.l8.m1.1.1.7.cmml" xref="alg6.l8.m1.1.1.7">𝑀</ci><ci id="alg6.l8.m1.1.1.8.cmml" xref="alg6.l8.m1.1.1.8">𝑜</ci><ci id="alg6.l8.m1.1.1.9.cmml" xref="alg6.l8.m1.1.1.9">𝑑</ci><ci id="alg6.l8.m1.1.1.10.cmml" xref="alg6.l8.m1.1.1.10">𝑒</ci><ci id="alg6.l8.m1.1.1.11.cmml" xref="alg6.l8.m1.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l8.m1.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg6.l8.m1.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math> = ’mxbai-embed-large’

</div>
<div class="ltx_listingline" id="alg6.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l9.1.1.1" style="font-size:80%;">9:</span></span><math alttext="LLMModel" class="ltx_Math" display="inline" id="alg6.l9.m1.1"><semantics id="alg6.l9.m1.1a"><mrow id="alg6.l9.m1.1.1" xref="alg6.l9.m1.1.1.cmml"><mi id="alg6.l9.m1.1.1.2" xref="alg6.l9.m1.1.1.2.cmml">L</mi><mo id="alg6.l9.m1.1.1.1" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.3" xref="alg6.l9.m1.1.1.3.cmml">L</mi><mo id="alg6.l9.m1.1.1.1a" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.4" xref="alg6.l9.m1.1.1.4.cmml">M</mi><mo id="alg6.l9.m1.1.1.1b" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.5" xref="alg6.l9.m1.1.1.5.cmml">M</mi><mo id="alg6.l9.m1.1.1.1c" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.6" xref="alg6.l9.m1.1.1.6.cmml">o</mi><mo id="alg6.l9.m1.1.1.1d" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.7" xref="alg6.l9.m1.1.1.7.cmml">d</mi><mo id="alg6.l9.m1.1.1.1e" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.8" xref="alg6.l9.m1.1.1.8.cmml">e</mi><mo id="alg6.l9.m1.1.1.1f" xref="alg6.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l9.m1.1.1.9" xref="alg6.l9.m1.1.1.9.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l9.m1.1b"><apply id="alg6.l9.m1.1.1.cmml" xref="alg6.l9.m1.1.1"><times id="alg6.l9.m1.1.1.1.cmml" xref="alg6.l9.m1.1.1.1"></times><ci id="alg6.l9.m1.1.1.2.cmml" xref="alg6.l9.m1.1.1.2">𝐿</ci><ci id="alg6.l9.m1.1.1.3.cmml" xref="alg6.l9.m1.1.1.3">𝐿</ci><ci id="alg6.l9.m1.1.1.4.cmml" xref="alg6.l9.m1.1.1.4">𝑀</ci><ci id="alg6.l9.m1.1.1.5.cmml" xref="alg6.l9.m1.1.1.5">𝑀</ci><ci id="alg6.l9.m1.1.1.6.cmml" xref="alg6.l9.m1.1.1.6">𝑜</ci><ci id="alg6.l9.m1.1.1.7.cmml" xref="alg6.l9.m1.1.1.7">𝑑</ci><ci id="alg6.l9.m1.1.1.8.cmml" xref="alg6.l9.m1.1.1.8">𝑒</ci><ci id="alg6.l9.m1.1.1.9.cmml" xref="alg6.l9.m1.1.1.9">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l9.m1.1c">LLMModel</annotation><annotation encoding="application/x-llamapun" id="alg6.l9.m1.1d">italic_L italic_L italic_M italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math> = <math alttext="llama-3.1" class="ltx_Math" display="inline" id="alg6.l9.m2.1"><semantics id="alg6.l9.m2.1a"><mrow id="alg6.l9.m2.1.1" xref="alg6.l9.m2.1.1.cmml"><mrow id="alg6.l9.m2.1.1.2" xref="alg6.l9.m2.1.1.2.cmml"><mi id="alg6.l9.m2.1.1.2.2" xref="alg6.l9.m2.1.1.2.2.cmml">l</mi><mo id="alg6.l9.m2.1.1.2.1" xref="alg6.l9.m2.1.1.2.1.cmml">⁢</mo><mi id="alg6.l9.m2.1.1.2.3" xref="alg6.l9.m2.1.1.2.3.cmml">l</mi><mo id="alg6.l9.m2.1.1.2.1a" xref="alg6.l9.m2.1.1.2.1.cmml">⁢</mo><mi id="alg6.l9.m2.1.1.2.4" xref="alg6.l9.m2.1.1.2.4.cmml">a</mi><mo id="alg6.l9.m2.1.1.2.1b" xref="alg6.l9.m2.1.1.2.1.cmml">⁢</mo><mi id="alg6.l9.m2.1.1.2.5" xref="alg6.l9.m2.1.1.2.5.cmml">m</mi><mo id="alg6.l9.m2.1.1.2.1c" xref="alg6.l9.m2.1.1.2.1.cmml">⁢</mo><mi id="alg6.l9.m2.1.1.2.6" xref="alg6.l9.m2.1.1.2.6.cmml">a</mi></mrow><mo id="alg6.l9.m2.1.1.1" xref="alg6.l9.m2.1.1.1.cmml">−</mo><mn id="alg6.l9.m2.1.1.3" xref="alg6.l9.m2.1.1.3.cmml">3.1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg6.l9.m2.1b"><apply id="alg6.l9.m2.1.1.cmml" xref="alg6.l9.m2.1.1"><minus id="alg6.l9.m2.1.1.1.cmml" xref="alg6.l9.m2.1.1.1"></minus><apply id="alg6.l9.m2.1.1.2.cmml" xref="alg6.l9.m2.1.1.2"><times id="alg6.l9.m2.1.1.2.1.cmml" xref="alg6.l9.m2.1.1.2.1"></times><ci id="alg6.l9.m2.1.1.2.2.cmml" xref="alg6.l9.m2.1.1.2.2">𝑙</ci><ci id="alg6.l9.m2.1.1.2.3.cmml" xref="alg6.l9.m2.1.1.2.3">𝑙</ci><ci id="alg6.l9.m2.1.1.2.4.cmml" xref="alg6.l9.m2.1.1.2.4">𝑎</ci><ci id="alg6.l9.m2.1.1.2.5.cmml" xref="alg6.l9.m2.1.1.2.5">𝑚</ci><ci id="alg6.l9.m2.1.1.2.6.cmml" xref="alg6.l9.m2.1.1.2.6">𝑎</ci></apply><cn id="alg6.l9.m2.1.1.3.cmml" type="float" xref="alg6.l9.m2.1.1.3">3.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l9.m2.1c">llama-3.1</annotation><annotation encoding="application/x-llamapun" id="alg6.l9.m2.1d">italic_l italic_l italic_a italic_m italic_a - 3.1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg6.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l10.1.1.1" style="font-size:80%;">10:</span></span><math alttext="PT" class="ltx_Math" display="inline" id="alg6.l10.m1.1"><semantics id="alg6.l10.m1.1a"><mrow id="alg6.l10.m1.1.1" xref="alg6.l10.m1.1.1.cmml"><mi id="alg6.l10.m1.1.1.2" xref="alg6.l10.m1.1.1.2.cmml">P</mi><mo id="alg6.l10.m1.1.1.1" xref="alg6.l10.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m1.1.1.3" xref="alg6.l10.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l10.m1.1b"><apply id="alg6.l10.m1.1.1.cmml" xref="alg6.l10.m1.1.1"><times id="alg6.l10.m1.1.1.1.cmml" xref="alg6.l10.m1.1.1.1"></times><ci id="alg6.l10.m1.1.1.2.cmml" xref="alg6.l10.m1.1.1.2">𝑃</ci><ci id="alg6.l10.m1.1.1.3.cmml" xref="alg6.l10.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l10.m1.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg6.l10.m1.1d">italic_P italic_T</annotation></semantics></math>[ ] = <math alttext="Process" class="ltx_Math" display="inline" id="alg6.l10.m2.1"><semantics id="alg6.l10.m2.1a"><mrow id="alg6.l10.m2.1.1" xref="alg6.l10.m2.1.1.cmml"><mi id="alg6.l10.m2.1.1.2" xref="alg6.l10.m2.1.1.2.cmml">P</mi><mo id="alg6.l10.m2.1.1.1" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.3" xref="alg6.l10.m2.1.1.3.cmml">r</mi><mo id="alg6.l10.m2.1.1.1a" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.4" xref="alg6.l10.m2.1.1.4.cmml">o</mi><mo id="alg6.l10.m2.1.1.1b" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.5" xref="alg6.l10.m2.1.1.5.cmml">c</mi><mo id="alg6.l10.m2.1.1.1c" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.6" xref="alg6.l10.m2.1.1.6.cmml">e</mi><mo id="alg6.l10.m2.1.1.1d" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.7" xref="alg6.l10.m2.1.1.7.cmml">s</mi><mo id="alg6.l10.m2.1.1.1e" xref="alg6.l10.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m2.1.1.8" xref="alg6.l10.m2.1.1.8.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l10.m2.1b"><apply id="alg6.l10.m2.1.1.cmml" xref="alg6.l10.m2.1.1"><times id="alg6.l10.m2.1.1.1.cmml" xref="alg6.l10.m2.1.1.1"></times><ci id="alg6.l10.m2.1.1.2.cmml" xref="alg6.l10.m2.1.1.2">𝑃</ci><ci id="alg6.l10.m2.1.1.3.cmml" xref="alg6.l10.m2.1.1.3">𝑟</ci><ci id="alg6.l10.m2.1.1.4.cmml" xref="alg6.l10.m2.1.1.4">𝑜</ci><ci id="alg6.l10.m2.1.1.5.cmml" xref="alg6.l10.m2.1.1.5">𝑐</ci><ci id="alg6.l10.m2.1.1.6.cmml" xref="alg6.l10.m2.1.1.6">𝑒</ci><ci id="alg6.l10.m2.1.1.7.cmml" xref="alg6.l10.m2.1.1.7">𝑠</ci><ci id="alg6.l10.m2.1.1.8.cmml" xref="alg6.l10.m2.1.1.8">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l10.m2.1c">Process</annotation><annotation encoding="application/x-llamapun" id="alg6.l10.m2.1d">italic_P italic_r italic_o italic_c italic_e italic_s italic_s</annotation></semantics></math> (<math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="alg6.l10.m3.1"><semantics id="alg6.l10.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg6.l10.m3.1.1" xref="alg6.l10.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="alg6.l10.m3.1b"><ci id="alg6.l10.m3.1.1.cmml" xref="alg6.l10.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l10.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="alg6.l10.m3.1d">caligraphic_T</annotation></semantics></math>, <math alttext="Max" class="ltx_Math" display="inline" id="alg6.l10.m4.1"><semantics id="alg6.l10.m4.1a"><mrow id="alg6.l10.m4.1.1" xref="alg6.l10.m4.1.1.cmml"><mi id="alg6.l10.m4.1.1.2" xref="alg6.l10.m4.1.1.2.cmml">M</mi><mo id="alg6.l10.m4.1.1.1" xref="alg6.l10.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m4.1.1.3" xref="alg6.l10.m4.1.1.3.cmml">a</mi><mo id="alg6.l10.m4.1.1.1a" xref="alg6.l10.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l10.m4.1.1.4" xref="alg6.l10.m4.1.1.4.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l10.m4.1b"><apply id="alg6.l10.m4.1.1.cmml" xref="alg6.l10.m4.1.1"><times id="alg6.l10.m4.1.1.1.cmml" xref="alg6.l10.m4.1.1.1"></times><ci id="alg6.l10.m4.1.1.2.cmml" xref="alg6.l10.m4.1.1.2">𝑀</ci><ci id="alg6.l10.m4.1.1.3.cmml" xref="alg6.l10.m4.1.1.3">𝑎</ci><ci id="alg6.l10.m4.1.1.4.cmml" xref="alg6.l10.m4.1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l10.m4.1c">Max</annotation><annotation encoding="application/x-llamapun" id="alg6.l10.m4.1d">italic_M italic_a italic_x</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg6.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l11.1.1.1" style="font-size:80%;">11:</span></span><math alttext="ED" class="ltx_Math" display="inline" id="alg6.l11.m1.1"><semantics id="alg6.l11.m1.1a"><mrow id="alg6.l11.m1.1.1" xref="alg6.l11.m1.1.1.cmml"><mi id="alg6.l11.m1.1.1.2" xref="alg6.l11.m1.1.1.2.cmml">E</mi><mo id="alg6.l11.m1.1.1.1" xref="alg6.l11.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m1.1.1.3" xref="alg6.l11.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l11.m1.1b"><apply id="alg6.l11.m1.1.1.cmml" xref="alg6.l11.m1.1.1"><times id="alg6.l11.m1.1.1.1.cmml" xref="alg6.l11.m1.1.1.1"></times><ci id="alg6.l11.m1.1.1.2.cmml" xref="alg6.l11.m1.1.1.2">𝐸</ci><ci id="alg6.l11.m1.1.1.3.cmml" xref="alg6.l11.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l11.m1.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg6.l11.m1.1d">italic_E italic_D</annotation></semantics></math>[ ]=Embed(<math alttext="PT" class="ltx_Math" display="inline" id="alg6.l11.m2.1"><semantics id="alg6.l11.m2.1a"><mrow id="alg6.l11.m2.1.1" xref="alg6.l11.m2.1.1.cmml"><mi id="alg6.l11.m2.1.1.2" xref="alg6.l11.m2.1.1.2.cmml">P</mi><mo id="alg6.l11.m2.1.1.1" xref="alg6.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m2.1.1.3" xref="alg6.l11.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l11.m2.1b"><apply id="alg6.l11.m2.1.1.cmml" xref="alg6.l11.m2.1.1"><times id="alg6.l11.m2.1.1.1.cmml" xref="alg6.l11.m2.1.1.1"></times><ci id="alg6.l11.m2.1.1.2.cmml" xref="alg6.l11.m2.1.1.2">𝑃</ci><ci id="alg6.l11.m2.1.1.3.cmml" xref="alg6.l11.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l11.m2.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg6.l11.m2.1d">italic_P italic_T</annotation></semantics></math>, <math alttext="EmbedModel" class="ltx_Math" display="inline" id="alg6.l11.m3.1"><semantics id="alg6.l11.m3.1a"><mrow id="alg6.l11.m3.1.1" xref="alg6.l11.m3.1.1.cmml"><mi id="alg6.l11.m3.1.1.2" xref="alg6.l11.m3.1.1.2.cmml">E</mi><mo id="alg6.l11.m3.1.1.1" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.3" xref="alg6.l11.m3.1.1.3.cmml">m</mi><mo id="alg6.l11.m3.1.1.1a" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.4" xref="alg6.l11.m3.1.1.4.cmml">b</mi><mo id="alg6.l11.m3.1.1.1b" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.5" xref="alg6.l11.m3.1.1.5.cmml">e</mi><mo id="alg6.l11.m3.1.1.1c" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.6" xref="alg6.l11.m3.1.1.6.cmml">d</mi><mo id="alg6.l11.m3.1.1.1d" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.7" xref="alg6.l11.m3.1.1.7.cmml">M</mi><mo id="alg6.l11.m3.1.1.1e" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.8" xref="alg6.l11.m3.1.1.8.cmml">o</mi><mo id="alg6.l11.m3.1.1.1f" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.9" xref="alg6.l11.m3.1.1.9.cmml">d</mi><mo id="alg6.l11.m3.1.1.1g" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.10" xref="alg6.l11.m3.1.1.10.cmml">e</mi><mo id="alg6.l11.m3.1.1.1h" xref="alg6.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l11.m3.1.1.11" xref="alg6.l11.m3.1.1.11.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l11.m3.1b"><apply id="alg6.l11.m3.1.1.cmml" xref="alg6.l11.m3.1.1"><times id="alg6.l11.m3.1.1.1.cmml" xref="alg6.l11.m3.1.1.1"></times><ci id="alg6.l11.m3.1.1.2.cmml" xref="alg6.l11.m3.1.1.2">𝐸</ci><ci id="alg6.l11.m3.1.1.3.cmml" xref="alg6.l11.m3.1.1.3">𝑚</ci><ci id="alg6.l11.m3.1.1.4.cmml" xref="alg6.l11.m3.1.1.4">𝑏</ci><ci id="alg6.l11.m3.1.1.5.cmml" xref="alg6.l11.m3.1.1.5">𝑒</ci><ci id="alg6.l11.m3.1.1.6.cmml" xref="alg6.l11.m3.1.1.6">𝑑</ci><ci id="alg6.l11.m3.1.1.7.cmml" xref="alg6.l11.m3.1.1.7">𝑀</ci><ci id="alg6.l11.m3.1.1.8.cmml" xref="alg6.l11.m3.1.1.8">𝑜</ci><ci id="alg6.l11.m3.1.1.9.cmml" xref="alg6.l11.m3.1.1.9">𝑑</ci><ci id="alg6.l11.m3.1.1.10.cmml" xref="alg6.l11.m3.1.1.10">𝑒</ci><ci id="alg6.l11.m3.1.1.11.cmml" xref="alg6.l11.m3.1.1.11">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l11.m3.1c">EmbedModel</annotation><annotation encoding="application/x-llamapun" id="alg6.l11.m3.1d">italic_E italic_m italic_b italic_e italic_d italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg6.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l12.1.1.1" style="font-size:80%;">12:</span></span><math alttext="I" class="ltx_Math" display="inline" id="alg6.l12.m1.1"><semantics id="alg6.l12.m1.1a"><mi id="alg6.l12.m1.1.1" xref="alg6.l12.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg6.l12.m1.1b"><ci id="alg6.l12.m1.1.1.cmml" xref="alg6.l12.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m1.1d">italic_I</annotation></semantics></math>[ ] = <math alttext="Retrieve" class="ltx_Math" display="inline" id="alg6.l12.m2.1"><semantics id="alg6.l12.m2.1a"><mrow id="alg6.l12.m2.1.1" xref="alg6.l12.m2.1.1.cmml"><mi id="alg6.l12.m2.1.1.2" xref="alg6.l12.m2.1.1.2.cmml">R</mi><mo id="alg6.l12.m2.1.1.1" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.3" xref="alg6.l12.m2.1.1.3.cmml">e</mi><mo id="alg6.l12.m2.1.1.1a" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.4" xref="alg6.l12.m2.1.1.4.cmml">t</mi><mo id="alg6.l12.m2.1.1.1b" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.5" xref="alg6.l12.m2.1.1.5.cmml">r</mi><mo id="alg6.l12.m2.1.1.1c" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.6" xref="alg6.l12.m2.1.1.6.cmml">i</mi><mo id="alg6.l12.m2.1.1.1d" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.7" xref="alg6.l12.m2.1.1.7.cmml">e</mi><mo id="alg6.l12.m2.1.1.1e" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.8" xref="alg6.l12.m2.1.1.8.cmml">v</mi><mo id="alg6.l12.m2.1.1.1f" xref="alg6.l12.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m2.1.1.9" xref="alg6.l12.m2.1.1.9.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l12.m2.1b"><apply id="alg6.l12.m2.1.1.cmml" xref="alg6.l12.m2.1.1"><times id="alg6.l12.m2.1.1.1.cmml" xref="alg6.l12.m2.1.1.1"></times><ci id="alg6.l12.m2.1.1.2.cmml" xref="alg6.l12.m2.1.1.2">𝑅</ci><ci id="alg6.l12.m2.1.1.3.cmml" xref="alg6.l12.m2.1.1.3">𝑒</ci><ci id="alg6.l12.m2.1.1.4.cmml" xref="alg6.l12.m2.1.1.4">𝑡</ci><ci id="alg6.l12.m2.1.1.5.cmml" xref="alg6.l12.m2.1.1.5">𝑟</ci><ci id="alg6.l12.m2.1.1.6.cmml" xref="alg6.l12.m2.1.1.6">𝑖</ci><ci id="alg6.l12.m2.1.1.7.cmml" xref="alg6.l12.m2.1.1.7">𝑒</ci><ci id="alg6.l12.m2.1.1.8.cmml" xref="alg6.l12.m2.1.1.8">𝑣</ci><ci id="alg6.l12.m2.1.1.9.cmml" xref="alg6.l12.m2.1.1.9">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m2.1c">Retrieve</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m2.1d">italic_R italic_e italic_t italic_r italic_i italic_e italic_v italic_e</annotation></semantics></math>(<math alttext="RI" class="ltx_Math" display="inline" id="alg6.l12.m3.1"><semantics id="alg6.l12.m3.1a"><mrow id="alg6.l12.m3.1.1" xref="alg6.l12.m3.1.1.cmml"><mi id="alg6.l12.m3.1.1.2" xref="alg6.l12.m3.1.1.2.cmml">R</mi><mo id="alg6.l12.m3.1.1.1" xref="alg6.l12.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m3.1.1.3" xref="alg6.l12.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l12.m3.1b"><apply id="alg6.l12.m3.1.1.cmml" xref="alg6.l12.m3.1.1"><times id="alg6.l12.m3.1.1.1.cmml" xref="alg6.l12.m3.1.1.1"></times><ci id="alg6.l12.m3.1.1.2.cmml" xref="alg6.l12.m3.1.1.2">𝑅</ci><ci id="alg6.l12.m3.1.1.3.cmml" xref="alg6.l12.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m3.1c">RI</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m3.1d">italic_R italic_I</annotation></semantics></math>, <math alttext="PT" class="ltx_Math" display="inline" id="alg6.l12.m4.1"><semantics id="alg6.l12.m4.1a"><mrow id="alg6.l12.m4.1.1" xref="alg6.l12.m4.1.1.cmml"><mi id="alg6.l12.m4.1.1.2" xref="alg6.l12.m4.1.1.2.cmml">P</mi><mo id="alg6.l12.m4.1.1.1" xref="alg6.l12.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m4.1.1.3" xref="alg6.l12.m4.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l12.m4.1b"><apply id="alg6.l12.m4.1.1.cmml" xref="alg6.l12.m4.1.1"><times id="alg6.l12.m4.1.1.1.cmml" xref="alg6.l12.m4.1.1.1"></times><ci id="alg6.l12.m4.1.1.2.cmml" xref="alg6.l12.m4.1.1.2">𝑃</ci><ci id="alg6.l12.m4.1.1.3.cmml" xref="alg6.l12.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m4.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m4.1d">italic_P italic_T</annotation></semantics></math>, <math alttext="topk" class="ltx_Math" display="inline" id="alg6.l12.m5.1"><semantics id="alg6.l12.m5.1a"><mrow id="alg6.l12.m5.1.1" xref="alg6.l12.m5.1.1.cmml"><mi id="alg6.l12.m5.1.1.2" xref="alg6.l12.m5.1.1.2.cmml">t</mi><mo id="alg6.l12.m5.1.1.1" xref="alg6.l12.m5.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m5.1.1.3" xref="alg6.l12.m5.1.1.3.cmml">o</mi><mo id="alg6.l12.m5.1.1.1a" xref="alg6.l12.m5.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m5.1.1.4" xref="alg6.l12.m5.1.1.4.cmml">p</mi><mo id="alg6.l12.m5.1.1.1b" xref="alg6.l12.m5.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m5.1.1.5" xref="alg6.l12.m5.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l12.m5.1b"><apply id="alg6.l12.m5.1.1.cmml" xref="alg6.l12.m5.1.1"><times id="alg6.l12.m5.1.1.1.cmml" xref="alg6.l12.m5.1.1.1"></times><ci id="alg6.l12.m5.1.1.2.cmml" xref="alg6.l12.m5.1.1.2">𝑡</ci><ci id="alg6.l12.m5.1.1.3.cmml" xref="alg6.l12.m5.1.1.3">𝑜</ci><ci id="alg6.l12.m5.1.1.4.cmml" xref="alg6.l12.m5.1.1.4">𝑝</ci><ci id="alg6.l12.m5.1.1.5.cmml" xref="alg6.l12.m5.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m5.1c">topk</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m5.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math>, <math alttext="ED" class="ltx_Math" display="inline" id="alg6.l12.m6.1"><semantics id="alg6.l12.m6.1a"><mrow id="alg6.l12.m6.1.1" xref="alg6.l12.m6.1.1.cmml"><mi id="alg6.l12.m6.1.1.2" xref="alg6.l12.m6.1.1.2.cmml">E</mi><mo id="alg6.l12.m6.1.1.1" xref="alg6.l12.m6.1.1.1.cmml">⁢</mo><mi id="alg6.l12.m6.1.1.3" xref="alg6.l12.m6.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l12.m6.1b"><apply id="alg6.l12.m6.1.1.cmml" xref="alg6.l12.m6.1.1"><times id="alg6.l12.m6.1.1.1.cmml" xref="alg6.l12.m6.1.1.1"></times><ci id="alg6.l12.m6.1.1.2.cmml" xref="alg6.l12.m6.1.1.2">𝐸</ci><ci id="alg6.l12.m6.1.1.3.cmml" xref="alg6.l12.m6.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l12.m6.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg6.l12.m6.1d">italic_E italic_D</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg6.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l13.1.1.1" style="font-size:80%;">13:</span></span>load(<math alttext="llama-3.1" class="ltx_Math" display="inline" id="alg6.l13.m1.1"><semantics id="alg6.l13.m1.1a"><mrow id="alg6.l13.m1.1.1" xref="alg6.l13.m1.1.1.cmml"><mrow id="alg6.l13.m1.1.1.2" xref="alg6.l13.m1.1.1.2.cmml"><mi id="alg6.l13.m1.1.1.2.2" xref="alg6.l13.m1.1.1.2.2.cmml">l</mi><mo id="alg6.l13.m1.1.1.2.1" xref="alg6.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l13.m1.1.1.2.3" xref="alg6.l13.m1.1.1.2.3.cmml">l</mi><mo id="alg6.l13.m1.1.1.2.1a" xref="alg6.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l13.m1.1.1.2.4" xref="alg6.l13.m1.1.1.2.4.cmml">a</mi><mo id="alg6.l13.m1.1.1.2.1b" xref="alg6.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l13.m1.1.1.2.5" xref="alg6.l13.m1.1.1.2.5.cmml">m</mi><mo id="alg6.l13.m1.1.1.2.1c" xref="alg6.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="alg6.l13.m1.1.1.2.6" xref="alg6.l13.m1.1.1.2.6.cmml">a</mi></mrow><mo id="alg6.l13.m1.1.1.1" xref="alg6.l13.m1.1.1.1.cmml">−</mo><mn id="alg6.l13.m1.1.1.3" xref="alg6.l13.m1.1.1.3.cmml">3.1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg6.l13.m1.1b"><apply id="alg6.l13.m1.1.1.cmml" xref="alg6.l13.m1.1.1"><minus id="alg6.l13.m1.1.1.1.cmml" xref="alg6.l13.m1.1.1.1"></minus><apply id="alg6.l13.m1.1.1.2.cmml" xref="alg6.l13.m1.1.1.2"><times id="alg6.l13.m1.1.1.2.1.cmml" xref="alg6.l13.m1.1.1.2.1"></times><ci id="alg6.l13.m1.1.1.2.2.cmml" xref="alg6.l13.m1.1.1.2.2">𝑙</ci><ci id="alg6.l13.m1.1.1.2.3.cmml" xref="alg6.l13.m1.1.1.2.3">𝑙</ci><ci id="alg6.l13.m1.1.1.2.4.cmml" xref="alg6.l13.m1.1.1.2.4">𝑎</ci><ci id="alg6.l13.m1.1.1.2.5.cmml" xref="alg6.l13.m1.1.1.2.5">𝑚</ci><ci id="alg6.l13.m1.1.1.2.6.cmml" xref="alg6.l13.m1.1.1.2.6">𝑎</ci></apply><cn id="alg6.l13.m1.1.1.3.cmml" type="float" xref="alg6.l13.m1.1.1.3">3.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l13.m1.1c">llama-3.1</annotation><annotation encoding="application/x-llamapun" id="alg6.l13.m1.1d">italic_l italic_l italic_a italic_m italic_a - 3.1</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg6.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l14.1.1.1" style="font-size:80%;">14:</span></span><math alttext="UI" class="ltx_Math" display="inline" id="alg6.l14.m1.1"><semantics id="alg6.l14.m1.1a"><mrow id="alg6.l14.m1.1.1" xref="alg6.l14.m1.1.1.cmml"><mi id="alg6.l14.m1.1.1.2" xref="alg6.l14.m1.1.1.2.cmml">U</mi><mo id="alg6.l14.m1.1.1.1" xref="alg6.l14.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l14.m1.1.1.3" xref="alg6.l14.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l14.m1.1b"><apply id="alg6.l14.m1.1.1.cmml" xref="alg6.l14.m1.1.1"><times id="alg6.l14.m1.1.1.1.cmml" xref="alg6.l14.m1.1.1.1"></times><ci id="alg6.l14.m1.1.1.2.cmml" xref="alg6.l14.m1.1.1.2">𝑈</ci><ci id="alg6.l14.m1.1.1.3.cmml" xref="alg6.l14.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l14.m1.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg6.l14.m1.1d">italic_U italic_I</annotation></semantics></math> = <math alttext="input" class="ltx_Math" display="inline" id="alg6.l14.m2.1"><semantics id="alg6.l14.m2.1a"><mrow id="alg6.l14.m2.1.1" xref="alg6.l14.m2.1.1.cmml"><mi id="alg6.l14.m2.1.1.2" xref="alg6.l14.m2.1.1.2.cmml">i</mi><mo id="alg6.l14.m2.1.1.1" xref="alg6.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l14.m2.1.1.3" xref="alg6.l14.m2.1.1.3.cmml">n</mi><mo id="alg6.l14.m2.1.1.1a" xref="alg6.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l14.m2.1.1.4" xref="alg6.l14.m2.1.1.4.cmml">p</mi><mo id="alg6.l14.m2.1.1.1b" xref="alg6.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l14.m2.1.1.5" xref="alg6.l14.m2.1.1.5.cmml">u</mi><mo id="alg6.l14.m2.1.1.1c" xref="alg6.l14.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l14.m2.1.1.6" xref="alg6.l14.m2.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l14.m2.1b"><apply id="alg6.l14.m2.1.1.cmml" xref="alg6.l14.m2.1.1"><times id="alg6.l14.m2.1.1.1.cmml" xref="alg6.l14.m2.1.1.1"></times><ci id="alg6.l14.m2.1.1.2.cmml" xref="alg6.l14.m2.1.1.2">𝑖</ci><ci id="alg6.l14.m2.1.1.3.cmml" xref="alg6.l14.m2.1.1.3">𝑛</ci><ci id="alg6.l14.m2.1.1.4.cmml" xref="alg6.l14.m2.1.1.4">𝑝</ci><ci id="alg6.l14.m2.1.1.5.cmml" xref="alg6.l14.m2.1.1.5">𝑢</ci><ci id="alg6.l14.m2.1.1.6.cmml" xref="alg6.l14.m2.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l14.m2.1c">input</annotation><annotation encoding="application/x-llamapun" id="alg6.l14.m2.1d">italic_i italic_n italic_p italic_u italic_t</annotation></semantics></math>("Welcome to GenDFIR, your advanced AI-powered Timeline Analysis assistant. How can I assist you today?")

</div>
<div class="ltx_listingline" id="alg6.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l15.1.1.1" style="font-size:80%;">15:</span></span><math alttext="answer" class="ltx_Math" display="inline" id="alg6.l15.m1.1"><semantics id="alg6.l15.m1.1a"><mrow id="alg6.l15.m1.1.1" xref="alg6.l15.m1.1.1.cmml"><mi id="alg6.l15.m1.1.1.2" xref="alg6.l15.m1.1.1.2.cmml">a</mi><mo id="alg6.l15.m1.1.1.1" xref="alg6.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m1.1.1.3" xref="alg6.l15.m1.1.1.3.cmml">n</mi><mo id="alg6.l15.m1.1.1.1a" xref="alg6.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m1.1.1.4" xref="alg6.l15.m1.1.1.4.cmml">s</mi><mo id="alg6.l15.m1.1.1.1b" xref="alg6.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m1.1.1.5" xref="alg6.l15.m1.1.1.5.cmml">w</mi><mo id="alg6.l15.m1.1.1.1c" xref="alg6.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m1.1.1.6" xref="alg6.l15.m1.1.1.6.cmml">e</mi><mo id="alg6.l15.m1.1.1.1d" xref="alg6.l15.m1.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m1.1.1.7" xref="alg6.l15.m1.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m1.1b"><apply id="alg6.l15.m1.1.1.cmml" xref="alg6.l15.m1.1.1"><times id="alg6.l15.m1.1.1.1.cmml" xref="alg6.l15.m1.1.1.1"></times><ci id="alg6.l15.m1.1.1.2.cmml" xref="alg6.l15.m1.1.1.2">𝑎</ci><ci id="alg6.l15.m1.1.1.3.cmml" xref="alg6.l15.m1.1.1.3">𝑛</ci><ci id="alg6.l15.m1.1.1.4.cmml" xref="alg6.l15.m1.1.1.4">𝑠</ci><ci id="alg6.l15.m1.1.1.5.cmml" xref="alg6.l15.m1.1.1.5">𝑤</ci><ci id="alg6.l15.m1.1.1.6.cmml" xref="alg6.l15.m1.1.1.6">𝑒</ci><ci id="alg6.l15.m1.1.1.7.cmml" xref="alg6.l15.m1.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m1.1c">answer</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m1.1d">italic_a italic_n italic_s italic_w italic_e italic_r</annotation></semantics></math> = <math alttext="LLMChat" class="ltx_Math" display="inline" id="alg6.l15.m2.1"><semantics id="alg6.l15.m2.1a"><mrow id="alg6.l15.m2.1.1" xref="alg6.l15.m2.1.1.cmml"><mi id="alg6.l15.m2.1.1.2" xref="alg6.l15.m2.1.1.2.cmml">L</mi><mo id="alg6.l15.m2.1.1.1" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.3" xref="alg6.l15.m2.1.1.3.cmml">L</mi><mo id="alg6.l15.m2.1.1.1a" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.4" xref="alg6.l15.m2.1.1.4.cmml">M</mi><mo id="alg6.l15.m2.1.1.1b" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.5" xref="alg6.l15.m2.1.1.5.cmml">C</mi><mo id="alg6.l15.m2.1.1.1c" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.6" xref="alg6.l15.m2.1.1.6.cmml">h</mi><mo id="alg6.l15.m2.1.1.1d" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.7" xref="alg6.l15.m2.1.1.7.cmml">a</mi><mo id="alg6.l15.m2.1.1.1e" xref="alg6.l15.m2.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m2.1.1.8" xref="alg6.l15.m2.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m2.1b"><apply id="alg6.l15.m2.1.1.cmml" xref="alg6.l15.m2.1.1"><times id="alg6.l15.m2.1.1.1.cmml" xref="alg6.l15.m2.1.1.1"></times><ci id="alg6.l15.m2.1.1.2.cmml" xref="alg6.l15.m2.1.1.2">𝐿</ci><ci id="alg6.l15.m2.1.1.3.cmml" xref="alg6.l15.m2.1.1.3">𝐿</ci><ci id="alg6.l15.m2.1.1.4.cmml" xref="alg6.l15.m2.1.1.4">𝑀</ci><ci id="alg6.l15.m2.1.1.5.cmml" xref="alg6.l15.m2.1.1.5">𝐶</ci><ci id="alg6.l15.m2.1.1.6.cmml" xref="alg6.l15.m2.1.1.6">ℎ</ci><ci id="alg6.l15.m2.1.1.7.cmml" xref="alg6.l15.m2.1.1.7">𝑎</ci><ci id="alg6.l15.m2.1.1.8.cmml" xref="alg6.l15.m2.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m2.1c">LLMChat</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m2.1d">italic_L italic_L italic_M italic_C italic_h italic_a italic_t</annotation></semantics></math>(<math alttext="UI" class="ltx_Math" display="inline" id="alg6.l15.m3.1"><semantics id="alg6.l15.m3.1a"><mrow id="alg6.l15.m3.1.1" xref="alg6.l15.m3.1.1.cmml"><mi id="alg6.l15.m3.1.1.2" xref="alg6.l15.m3.1.1.2.cmml">U</mi><mo id="alg6.l15.m3.1.1.1" xref="alg6.l15.m3.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m3.1.1.3" xref="alg6.l15.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m3.1b"><apply id="alg6.l15.m3.1.1.cmml" xref="alg6.l15.m3.1.1"><times id="alg6.l15.m3.1.1.1.cmml" xref="alg6.l15.m3.1.1.1"></times><ci id="alg6.l15.m3.1.1.2.cmml" xref="alg6.l15.m3.1.1.2">𝑈</ci><ci id="alg6.l15.m3.1.1.3.cmml" xref="alg6.l15.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m3.1c">UI</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m3.1d">italic_U italic_I</annotation></semantics></math>, <math alttext="SysMsg" class="ltx_Math" display="inline" id="alg6.l15.m4.1"><semantics id="alg6.l15.m4.1a"><mrow id="alg6.l15.m4.1.1" xref="alg6.l15.m4.1.1.cmml"><mi id="alg6.l15.m4.1.1.2" xref="alg6.l15.m4.1.1.2.cmml">S</mi><mo id="alg6.l15.m4.1.1.1" xref="alg6.l15.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m4.1.1.3" xref="alg6.l15.m4.1.1.3.cmml">y</mi><mo id="alg6.l15.m4.1.1.1a" xref="alg6.l15.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m4.1.1.4" xref="alg6.l15.m4.1.1.4.cmml">s</mi><mo id="alg6.l15.m4.1.1.1b" xref="alg6.l15.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m4.1.1.5" xref="alg6.l15.m4.1.1.5.cmml">M</mi><mo id="alg6.l15.m4.1.1.1c" xref="alg6.l15.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m4.1.1.6" xref="alg6.l15.m4.1.1.6.cmml">s</mi><mo id="alg6.l15.m4.1.1.1d" xref="alg6.l15.m4.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m4.1.1.7" xref="alg6.l15.m4.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m4.1b"><apply id="alg6.l15.m4.1.1.cmml" xref="alg6.l15.m4.1.1"><times id="alg6.l15.m4.1.1.1.cmml" xref="alg6.l15.m4.1.1.1"></times><ci id="alg6.l15.m4.1.1.2.cmml" xref="alg6.l15.m4.1.1.2">𝑆</ci><ci id="alg6.l15.m4.1.1.3.cmml" xref="alg6.l15.m4.1.1.3">𝑦</ci><ci id="alg6.l15.m4.1.1.4.cmml" xref="alg6.l15.m4.1.1.4">𝑠</ci><ci id="alg6.l15.m4.1.1.5.cmml" xref="alg6.l15.m4.1.1.5">𝑀</ci><ci id="alg6.l15.m4.1.1.6.cmml" xref="alg6.l15.m4.1.1.6">𝑠</ci><ci id="alg6.l15.m4.1.1.7.cmml" xref="alg6.l15.m4.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m4.1c">SysMsg</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m4.1d">italic_S italic_y italic_s italic_M italic_s italic_g</annotation></semantics></math>, <math alttext="ED" class="ltx_Math" display="inline" id="alg6.l15.m5.1"><semantics id="alg6.l15.m5.1a"><mrow id="alg6.l15.m5.1.1" xref="alg6.l15.m5.1.1.cmml"><mi id="alg6.l15.m5.1.1.2" xref="alg6.l15.m5.1.1.2.cmml">E</mi><mo id="alg6.l15.m5.1.1.1" xref="alg6.l15.m5.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m5.1.1.3" xref="alg6.l15.m5.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m5.1b"><apply id="alg6.l15.m5.1.1.cmml" xref="alg6.l15.m5.1.1"><times id="alg6.l15.m5.1.1.1.cmml" xref="alg6.l15.m5.1.1.1"></times><ci id="alg6.l15.m5.1.1.2.cmml" xref="alg6.l15.m5.1.1.2">𝐸</ci><ci id="alg6.l15.m5.1.1.3.cmml" xref="alg6.l15.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m5.1c">ED</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m5.1d">italic_E italic_D</annotation></semantics></math>, <math alttext="PT" class="ltx_Math" display="inline" id="alg6.l15.m6.1"><semantics id="alg6.l15.m6.1a"><mrow id="alg6.l15.m6.1.1" xref="alg6.l15.m6.1.1.cmml"><mi id="alg6.l15.m6.1.1.2" xref="alg6.l15.m6.1.1.2.cmml">P</mi><mo id="alg6.l15.m6.1.1.1" xref="alg6.l15.m6.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m6.1.1.3" xref="alg6.l15.m6.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m6.1b"><apply id="alg6.l15.m6.1.1.cmml" xref="alg6.l15.m6.1.1"><times id="alg6.l15.m6.1.1.1.cmml" xref="alg6.l15.m6.1.1.1"></times><ci id="alg6.l15.m6.1.1.2.cmml" xref="alg6.l15.m6.1.1.2">𝑃</ci><ci id="alg6.l15.m6.1.1.3.cmml" xref="alg6.l15.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m6.1c">PT</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m6.1d">italic_P italic_T</annotation></semantics></math>, <math alttext="I" class="ltx_Math" display="inline" id="alg6.l15.m7.1"><semantics id="alg6.l15.m7.1a"><mi id="alg6.l15.m7.1.1" xref="alg6.l15.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg6.l15.m7.1b"><ci id="alg6.l15.m7.1.1.cmml" xref="alg6.l15.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m7.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m7.1d">italic_I</annotation></semantics></math>, <math alttext="LLMModel" class="ltx_Math" display="inline" id="alg6.l15.m8.1"><semantics id="alg6.l15.m8.1a"><mrow id="alg6.l15.m8.1.1" xref="alg6.l15.m8.1.1.cmml"><mi id="alg6.l15.m8.1.1.2" xref="alg6.l15.m8.1.1.2.cmml">L</mi><mo id="alg6.l15.m8.1.1.1" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.3" xref="alg6.l15.m8.1.1.3.cmml">L</mi><mo id="alg6.l15.m8.1.1.1a" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.4" xref="alg6.l15.m8.1.1.4.cmml">M</mi><mo id="alg6.l15.m8.1.1.1b" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.5" xref="alg6.l15.m8.1.1.5.cmml">M</mi><mo id="alg6.l15.m8.1.1.1c" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.6" xref="alg6.l15.m8.1.1.6.cmml">o</mi><mo id="alg6.l15.m8.1.1.1d" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.7" xref="alg6.l15.m8.1.1.7.cmml">d</mi><mo id="alg6.l15.m8.1.1.1e" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.8" xref="alg6.l15.m8.1.1.8.cmml">e</mi><mo id="alg6.l15.m8.1.1.1f" xref="alg6.l15.m8.1.1.1.cmml">⁢</mo><mi id="alg6.l15.m8.1.1.9" xref="alg6.l15.m8.1.1.9.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg6.l15.m8.1b"><apply id="alg6.l15.m8.1.1.cmml" xref="alg6.l15.m8.1.1"><times id="alg6.l15.m8.1.1.1.cmml" xref="alg6.l15.m8.1.1.1"></times><ci id="alg6.l15.m8.1.1.2.cmml" xref="alg6.l15.m8.1.1.2">𝐿</ci><ci id="alg6.l15.m8.1.1.3.cmml" xref="alg6.l15.m8.1.1.3">𝐿</ci><ci id="alg6.l15.m8.1.1.4.cmml" xref="alg6.l15.m8.1.1.4">𝑀</ci><ci id="alg6.l15.m8.1.1.5.cmml" xref="alg6.l15.m8.1.1.5">𝑀</ci><ci id="alg6.l15.m8.1.1.6.cmml" xref="alg6.l15.m8.1.1.6">𝑜</ci><ci id="alg6.l15.m8.1.1.7.cmml" xref="alg6.l15.m8.1.1.7">𝑑</ci><ci id="alg6.l15.m8.1.1.8.cmml" xref="alg6.l15.m8.1.1.8">𝑒</ci><ci id="alg6.l15.m8.1.1.9.cmml" xref="alg6.l15.m8.1.1.9">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg6.l15.m8.1c">LLMModel</annotation><annotation encoding="application/x-llamapun" id="alg6.l15.m8.1d">italic_L italic_L italic_M italic_M italic_o italic_d italic_e italic_l</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg6.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg6.l16.1.1.1" style="font-size:80%;">16:</span></span>print(<math alttext="answer)" class="ltx_math_unparsed" display="inline" id="alg6.l16.m1.1"><semantics id="alg6.l16.m1.1a"><mrow id="alg6.l16.m1.1b"><mi id="alg6.l16.m1.1.1">a</mi><mi id="alg6.l16.m1.1.2">n</mi><mi id="alg6.l16.m1.1.3">s</mi><mi id="alg6.l16.m1.1.4">w</mi><mi id="alg6.l16.m1.1.5">e</mi><mi id="alg6.l16.m1.1.6">r</mi><mo id="alg6.l16.m1.1.7" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="alg6.l16.m1.1c">answer)</annotation><annotation encoding="application/x-llamapun" id="alg6.l16.m1.1d">italic_a italic_n italic_s italic_w italic_e italic_r )</annotation></semantics></math>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">GenDFIR Implementation</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To properly assess and implement the proposed GenDFIR framework, it is important to establish clear distinctions about its intended purpose and scope. The GenDFIR framework is not designed to serve as a conventional forensic tool that adheres strictly to legal evidentiary standards, nor is it intended for direct application in professional forensic cases that require strict compliance with legal and regulatory frameworks. Rather, this framework seeks to explore and demonstrate the potential use of GenAI, specifically LLMs, within the context of DFIR scenarios.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Variability in DFIR Practices and GenDFIR</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">It is important to recognize the diversity of methodologies and procedures in the DFIR industry. Each organization or entity may employ different investigative workflows and reporting formats depending on the specific nature of the investigation. Generally, DFIR processes can be segmented into two major domains: DF, which focuses on the preservation, collection, and analysis of digital evidence, and IR, which emphasizes the containment, eradication, and recovery from cyber incidents (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S2.F3" title="Figure 3 ‣ II Background ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Organizations vary in how they approach TA during investigations, as enterprise-focused IR differs from legal forensics in terms of the depth of analysis, objectives, and reporting. In enterprise environments, TA often emphasizes speed and operational impact, prioritizing swift identification of critical events and resolution steps, sometimes with less focus on maintaining a formal chain of custody. In contrast, legal forensic investigations place greater emphasis on the preservation and reconstruction of timelines, ensuring that all digital events are accurately sequenced and documented to meet evidentiary standards for potential court proceedings.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">The reporting mechanisms for TA also differ: IR reports typically focus on delivering actionable insights—such as the timing of compromise, propagation, and remediation steps—often to guide immediate decision-making. These reports prioritize clarity and immediacy over legal formalities. On the other hand, Forensic TA: reports must adhere to strict standards of documentation, ensuring that every event is precisely tracked and presented in a manner that maintains the integrity of the investigation for legal scrutiny. This involves rigorous validation of timestamps, metadata, and cross-referencing of multiple data sources to reconstruct a legally defensible timeline of events.</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">This variability underscores the fact that the GenDFIR framework is not a one-size-fits-all solution. Rather, it should be viewed as a template, benchmark, or research initiative aimed at investigating the integration of GenAI models into DFIR workflows. The goal is to enhance the speed and efficiency of processes like log analysis, and anomaly detection, and provide incident insights.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Large Language Models in GenDFIR</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The practical application of LLMs within DFIR tasks is still in its infancy. Recent advancements in the use of LLMs across various fields have sparked interest, but they are far from being fully reliable tools for DFIR investigations. Several challenges must be acknowledged, including issues of hallucination (where models generate incorrect or nonsensical outputs), precision (difficulty in generating highly accurate domain-specific information), and limitations related to input/output token lengths, which can constrain the model’s ability to process large datasets typical in DFIR cases.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">LLMs are powerful tools for automating some aspects of data analysis, summarization, and even generating incident reports, but they are not yet capable of performing highly specialized forensic tasks without human oversight. The LLMs used in GenDFIR operate in zero-shot mode, meaning they generate general-purpose responses based on their pre-existing training data but cannot directly process or recognize incident-specific data in real-time. In DFIR, where each incident involves unique and sensitive information, this limitation presents a significant challenge. To address this issue effectively, as outlined in the approach section, we incorporate RAG and a knowledge base. During inference, the knowledge base acts as the framework’s dynamic repository, storing cyber incident data. The framework retrieves relevant context from the indexed knowledge base, enabling the LLMs to provide responses tailored to the specifics of each incident.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS3.5.1.1">V-C</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS3.6.2">Multimodal Approach in GenDFIR</span>
</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To address some of these limitations, the GenDFIR framework proposes the use of two LLMs to integrate a multimodal approach, specifically incorporating images into the analysis process. This allows for greater versatility in processing data formats commonly found in DFIR. However, the incorporation of multimodal data introduces new challenges. For instance, training an LLM to analyze DFIR-specific image data requires secure access to highly sensitive and potentially confidential data. In many jurisdictions, this is restricted by national data protection laws such as the GDPR in Europe, or other regional frameworks. These laws prohibit the sharing of personal information or data breaches unless strict confidentiality and privacy measures are in place.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS4.5.1.1">V-D</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS4.6.2">Data in GenDFIR</span>
</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Due to the sensitive nature of the data handled in DFIR investigations—ranging from personal information to proprietary company data—there are significant privacy and legal concerns around the use of LLMs. Training an LLM on actual incident data would require a highly controlled environment to ensure compliance with data protection laws and organizational consent.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">For instance, using LLMs trained on real-world incidents containing confidential information must occur within a secure environment and under the governance of an organization’s internal policies or relevant legal frameworks. This raises the challenge of securely curating datasets for LLM training, as well as safeguarding sensitive information during model inference.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1">Furthermore, it is crucial to understand that LLMs, as they currently stand, are not equipped to recognize new or evolving threats outside of their training data. This means that deploying LLMs in DFIR without continuous updates and retraining on fresh, legally and ethically sourced datasets is likely to yield suboptimal results.</p>
</div>
<div class="ltx_para" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.1">Thus, the implementation of GenDFIR should be regarded as a template, benchmark, or primarily a research initiative focused on the integration of GenAI LLMs into the field of DFIR.</p>
</div>
<div class="ltx_para" id="S5.SS4.p5">
<p class="ltx_p" id="S5.SS4.p5.1">To clarify and rationalize this implementation, an experiment was conducted within a validated, controlled, and simulated virtual environment. This setup allows for thorough observation and precise management of scenarios, which, while oversimplified and without employing any anti-forensic techniques, serve as representative models of real-world DFIR cases. This approach facilitates a secure and ethical exploration of LLMs’ potential within DFIR while addressing the unique challenges and limitations present in investigations.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS5.5.1.1">V-E</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS5.6.2">Experiment Environment</span>
</h3>
<div class="ltx_para" id="S5.SS5.p1">
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Python Libraries:</span> Our code was written in Python. The primary libraries used are <span class="ltx_text ltx_font_typewriter" id="S5.I1.i1.p1.1.2">PyTorch</span> for tensor operations, <span class="ltx_text ltx_font_typewriter" id="S5.I1.i1.p1.1.3">NumPy</span> for numerical computations such as cosine similarity, and <span class="ltx_text ltx_font_typewriter" id="S5.I1.i1.p1.1.4">pandas</span> for data manipulation and handling embeddings.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">LLM Response Temperature:</span> The temperature of the core LLM (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i2.p1.1.2">llama3.1:8b</span>) is set to a very low value (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i2.p1.1.3">temperature = 0.1</span>) to control prediction variability and reduce additional data generated by the LLM, making it easier for the framework to focus on the data retrieved from the knowledge base.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Max Output Tokens:</span> is set to (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i3.p1.1.2">maxtokens=2000</span>) to work conveniently with the embedding model (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i3.p1.1.3">mxbai-embed-large:335m</span>) and the LLM (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i3.p1.1.4">llama3.1:8b</span>) specifications (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T4" title="TABLE IV ‣ III-A Timeline Analysis ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">IV</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S3.T5" title="TABLE V ‣ III-B Large Language Models for Cybersecurity and Digital Forensics tasks ‣ III Literature Review and Related Works ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">V</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">Number of Completions:</span> is set to a low value (<span class="ltx_text ltx_font_typewriter" id="S5.I1.i4.p1.1.2">n=1</span>) to make the LLM’s generation more deterministic and to select the optimal word predictions.</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST2">
<div class="ltx_listing ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="LST2.1" style="background-color:#F2F2EB;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,YW5zd2VyID0gY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKAogICAgbW9kZWw9TGxtTW9kZWwsCiAgICBtZXNzYWdlcz1beyJyb2xlIjogInN5c3RlbSIsICJjb250ZW50IjogcHJvbXB0fV0sCiAgICBtYXh0b2tlbnM9MjAwMCwKICAgIHRlbXBlcmF0dXJlPTAuMSwKICAgIG49MSwKKQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.1" style="font-size:80%;">answer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.2" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.3" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.4" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.5" style="font-size:80%;">client</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.6" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.7" style="font-size:80%;">chat</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.8" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.9" style="font-size:80%;">completions</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.10" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.11" style="font-size:80%;">create</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.12" style="font-size:80%;">(</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.2" style="font-size:80%;">model</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.3" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.4" style="font-size:80%;">LlmModel</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.5" style="font-size:80%;">,</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.2" style="font-size:80%;">messages</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.3" style="font-size:80%;">=[{"</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.4" style="font-size:80%;">role</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.5" style="font-size:80%;">":</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.6" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.7" style="font-size:80%;">"</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.8" style="font-size:80%;">system</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.9" style="font-size:80%;">",</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.10" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.11" style="font-size:80%;">"</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.12" style="font-size:80%;">content</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.13" style="font-size:80%;">":</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.14" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.15" style="font-size:80%;">prompt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.16" style="font-size:80%;">}],</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2" style="font-size:80%;">maxtokens</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.3" style="font-size:80%;">=2000,</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.2" style="font-size:80%;">temperature</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.3" style="font-size:80%;">=0.1,</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.2" style="font-size:80%;">n</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.3" style="font-size:80%;">=1,</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.1" style="font-size:80%;">)</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#F2F2EB;"><span class="ltx_tag ltx_tag_float">Listing 2: </span>GenDFIR code snippet Visualization</figcaption>
</figure>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.1">Parallel Computing:</span> For optimized tensor computation, CUDA is used to run the tensors on the GPU.</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST3">
<div class="ltx_listing ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="LST3.1" style="background-color:#F2F2EB;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,R1BVIE1vZGVsOiBOVklESUEgR2VGb3JjZSBSVFggNDA2MApDVURBIFZlcnNpb246IDEyLjYKVG90YWwgVlJBTTogOEdC">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.1" style="font-size:80%;">GPU</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.2" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.3" style="font-size:80%;">Model</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.4" style="font-size:80%;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.6" style="font-size:80%;">NVIDIA</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.8" style="font-size:80%;">GeForce</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.10" style="font-size:80%;">RTX</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.11" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.12" style="font-size:80%;">4060</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.1" style="font-size:80%;">CUDA</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.2" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.3" style="font-size:80%;">Version</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.4" style="font-size:80%;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.6" style="font-size:80%;">12.6</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.1" style="font-size:80%;">Total</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.2" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.3" style="font-size:80%;">VRAM</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.4" style="font-size:80%;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.6" style="font-size:80%;">8</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.7" style="font-size:80%;">GB</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#F2F2EB;"><span class="ltx_tag ltx_tag_float">Listing 3: </span>CUDA and GPU</figcaption>
</figure>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS6.5.1.1">V-F</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS6.6.2">Case Study</span>
</h3>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.1">The case studies for our experiments are based on synthetic scenarios designed to replicate real-world cyber incidents while ensuring privacy, consent, and confidentiality. Each scenario is tailored to fit the experimental environment, meaning it has been specifically designed to meet the setup’s specifications and criteria.</p>
</div>
<div class="ltx_para" id="S5.SS6.p2">
<p class="ltx_p" id="S5.SS6.p2.1">Additionally, each case study represents a cyber security incident within a fictional company. To illustrate the role of R-BAI, fictional rules have been incorporated into the scenario to filter anomalous events (artefacts) according to these predefined rules. Each cyber incident has its own knowledge base, which serves as a repository of previously identified anomalous events.</p>
</div>
<div class="ltx_para" id="S5.SS6.p3">
<p class="ltx_p" id="S5.SS6.p3.1">To align with our proposed chunking method and the constraints of our experimental setup (set to (<span class="ltx_text ltx_font_typewriter" id="S5.SS6.p3.1.1">maxtokens=2000</span>) and (<span class="ltx_text ltx_font_typewriter" id="S5.SS6.p3.1.2">llama-3.1:8b</span>) running locally), the number of events has been reduced so that each chunk can be fully embedded and correctly processed during LLM inference.</p>
</div>
<div class="ltx_para" id="S5.SS6.p4">
<p class="ltx_p" id="S5.SS6.p4.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.T6" title="TABLE VI ‣ V-F Case Study ‣ V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VI</span></a> presents the case studies before they were filtered according to the R-BAI algorithms:</p>
</div>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Case Studies Before R-BAI (Filtering)</figcaption>
<p class="ltx_p ltx_align_center" id="S5.T6.1"><span class="ltx_text" id="S5.T6.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1.1.1" style="width:154.4pt;height:151.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S5.T6.1.1.1.1"><span class="ltx_text" id="S5.T6.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T6.1.1.1.1.1.1">
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.1.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.1.1.1.1" style="width:56.9pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.1.1.1.1.1.1.1.1.1">Scenario</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.1.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.1.2.1.1" style="width:71.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.1.1.1.1.1.2.1.1.1">Number of Events</span></span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.2.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.2.1.1.1" style="width:56.9pt;">SYN Flood</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.2.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.2.2.1.1" style="width:71.1pt;">30</span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.3.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.3.1.1.1" style="width:56.9pt;">Rhino Hunt (Inspired from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib52" title="">52</a>]</cite>)</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.3.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.3.2.1.1" style="width:71.1pt;">23</span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.4">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.4.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.4.1.1.1" style="width:56.9pt;">Phishing Email - 1</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.4.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.4.2.1.1" style="width:71.1pt;">13</span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.5">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.5.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.5.1.1.1" style="width:56.9pt;">Phishing Email - 2</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.5.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.5.2.1.1" style="width:71.1pt;">30</span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.6">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.6.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.6.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.6.1.1.1" style="width:56.9pt;">DNS Spoof</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.6.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.6.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.6.2.1.1" style="width:71.1pt;">34</span>
</span></span></span>
<span class="ltx_tr" id="S5.T6.1.1.1.1.1.1.7">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.7.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.7.1.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.7.1.1.1" style="width:56.9pt;">Unauthorized Access</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1.1.7.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T6.1.1.1.1.1.1.7.2.1">
<span class="ltx_p" id="S5.T6.1.1.1.1.1.1.7.2.1.1" style="width:71.1pt;">47</span>
</span></span></span>
</span></span></span>
</span></span></span><span class="ltx_text" id="S5.T6.1.2" style="font-size:70%;"></span></p>
</figure>
<div class="ltx_para" id="S5.SS6.p5">
<p class="ltx_p" id="S5.SS6.p5.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.T7" title="TABLE VII ‣ V-F Case Study ‣ V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VII</span></a> provides the specifications for each scenario after filtering, including the number of chunks (events) and the maximum chunk length (in characters) for each event:</p>
</div>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Case Studies after R-BAI (Filtering)</figcaption>
<p class="ltx_p ltx_align_center" id="S5.T7.1"><span class="ltx_text" id="S5.T7.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1.1.1" style="width:200.5pt;height:175pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S5.T7.1.1.1.1"><span class="ltx_text" id="S5.T7.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T7.1.1.1.1.1.1">
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.1.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.1.1.1.1" style="width:42.7pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.1.1.1.1.1.1.1.1.1">Scenario</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.1.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.1.2.1.1" style="width:56.9pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.1.1.1.1.1.2.1.1.1">Number of Events (Chunks)</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.1.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.1.3.1.1" style="width:62.6pt;"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.1.1.1.1.1.3.1.1.1">Max Chunk Length (Characters)</span></span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.2.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.2.1.1.1" style="width:42.7pt;">SYN Flood</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.2.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.2.2.1.1" style="width:56.9pt;">30</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.2.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.2.3.1.1" style="width:62.6pt;">210</span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.3.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.3.1.1.1" style="width:42.7pt;">Rhino Hunt (Inspired from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib52" title="">52</a>]</cite>)</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.3.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.3.2.1.1" style="width:56.9pt;">8</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.3.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.3.3.1.1" style="width:62.6pt;">500</span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.4">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.4.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.4.1.1.1" style="width:42.7pt;">Phishing Email - 1</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.4.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.4.2.1.1" style="width:56.9pt;">15</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.4.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.4.3.1.1" style="width:62.6pt;">725</span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.5">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.5.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.5.1.1.1" style="width:42.7pt;">Phishing Email - 2</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.5.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.5.2.1.1" style="width:56.9pt;">20</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.5.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.5.3.1.1" style="width:62.6pt;">500</span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.6">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.6.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.6.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.6.1.1.1" style="width:42.7pt;">DNS Spoof</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.6.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.6.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.6.2.1.1" style="width:56.9pt;">23</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.6.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.6.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.6.3.1.1" style="width:62.6pt;">200</span>
</span></span></span>
<span class="ltx_tr" id="S5.T7.1.1.1.1.1.1.7">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.7.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.7.1.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.7.1.1.1" style="width:42.7pt;">Unauthorized Access</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.7.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.7.2.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.7.2.1.1" style="width:56.9pt;">25</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1.1.7.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T7.1.1.1.1.1.1.7.3.1">
<span class="ltx_p" id="S5.T7.1.1.1.1.1.1.7.3.1.1" style="width:62.6pt;">208</span>
</span></span></span>
</span></span></span>
</span></span></span><span class="ltx_text" id="S5.T7.1.2" style="font-size:70%;"></span></p>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Results Evaluation and Discussion</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The evaluation of the framework mainly focuses on the LLM outputs, as the R-BAI results were accurately and previously presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.T6" title="TABLE VI ‣ V-F Case Study ‣ V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VI</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5.T7" title="TABLE VII ‣ V-F Case Study ‣ V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VII</span></a>. LLMs typically adhere to established benchmarks. Metrics such as F1-score, precision, recall, accuracy, BLEU, and ROUGE are widely recognized for specific tasks. For example, the F1-score is commonly applied in classification tasks as it balances precision and recall, offering an overall performance measure. BLEU is used to assess the quality of the generated text, primarily in translation tasks, while ROUGE is employed in evaluating the accuracy of machine-generated summaries <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib54" title="">54</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">In context-specific applications such as GenDFIR, LLMs are employed in a zero-shot setting, having undergone extensive benchmarking and rigorous testing. GenDFIR is specifically designed to generate reports for forensic TA, a process that typically produces context-dependent outputs. Therefore, the evaluation of GenDFIR focuses not only on the accuracy of event retrieval from the knowledge base in response to forensic user prompts, but also on how effectively these events are correlated, how anomalies are detected, and how the events are transformed into a comprehensible report.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Given that the cyber incidents employed are relatively straightforward and that Llama-3.1 has been benchmarked using the CYBERSECEVAL suite, the LLM is expected to efficiently identify anomalies, detect evidence, and provide comprehensive insights. Detailed results of our experiment can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib56" title="">56</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">The evaluation of GenDFIR extends beyond traditional metrics. To evaluate performance, relevance, accuracy, and reliability, we developed specific metrics and crafted 240 tailored forensic prompts in the form of questions. These prompts were designed to test key aspects and patterns of evidence and anomalies within the knowledge bases and to assess how the LLM interprets and processes them. Each evaluation prompt underwent thorough analysis, refinement, and validation before use. All prompts are found in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib56" title="">56</a>]</cite>, where each metric is addressed by 20 dedicated forensics prompts.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p5">
<p class="ltx_p" id="S6.p5.1">The results of the metrics evaluation are detailed below:</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS1.5.1.1">VI-A</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS1.6.2">Accuracy</span>
</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">Calculating accuracy in GenDFIR involves analyzing the generated TA reports to identify and verify the facts they contain. This process checks the correctness and relevance of these facts against the knowledge base and ensures they are logically and reasonably interpreted, without any inaccuracies. These reports are divided into two parts. The first part includes Artifact Analysis, Timeline Analysis, Event Correlation, and Timeline Reconstruction, all based on facts from our knowledge base. The second part provides additional information, such as mitigation solutions, which are generated by the LLM. Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.T8" title="TABLE VIII ‣ VI-A Accuracy ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">VIII</span></a> details the exact number of facts in each generated TA report for every cyber incident.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S6.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Accuracy}=\frac{\displaystyle\text{Overall Correct Facts}}{\displaystyle%
\text{Overall (}\text{ Correct Facts}+\displaystyle\text{Incorrect Facts}\text%
{)}}" class="ltx_Math" display="block" id="S6.E12.m1.1"><semantics id="S6.E12.m1.1a"><mrow id="S6.E12.m1.1.1" xref="S6.E12.m1.1.1.cmml"><mtext id="S6.E12.m1.1.1.2" xref="S6.E12.m1.1.1.2a.cmml">Accuracy</mtext><mo id="S6.E12.m1.1.1.1" xref="S6.E12.m1.1.1.1.cmml">=</mo><mfrac id="S6.E12.m1.1.1.3" xref="S6.E12.m1.1.1.3.cmml"><mtext id="S6.E12.m1.1.1.3.2" xref="S6.E12.m1.1.1.3.2a.cmml">Overall Correct Facts</mtext><mrow id="S6.E12.m1.1.1.3.3" xref="S6.E12.m1.1.1.3.3.cmml"><mrow id="S6.E12.m1.1.1.3.3.2" xref="S6.E12.m1.1.1.3.3.2c.cmml"><mtext id="S6.E12.m1.1.1.3.3.2a" xref="S6.E12.m1.1.1.3.3.2c.cmml">Overall (</mtext><mtext id="S6.E12.m1.1.1.3.3.2b" xref="S6.E12.m1.1.1.3.3.2c.cmml"> Correct Facts</mtext></mrow><mo id="S6.E12.m1.1.1.3.3.1" xref="S6.E12.m1.1.1.3.3.1.cmml">+</mo><mrow id="S6.E12.m1.1.1.3.3.3" xref="S6.E12.m1.1.1.3.3.3c.cmml"><mtext id="S6.E12.m1.1.1.3.3.3a" xref="S6.E12.m1.1.1.3.3.3c.cmml">Incorrect Facts</mtext><mtext id="S6.E12.m1.1.1.3.3.3b" xref="S6.E12.m1.1.1.3.3.3c.cmml">)</mtext></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S6.E12.m1.1b"><apply id="S6.E12.m1.1.1.cmml" xref="S6.E12.m1.1.1"><eq id="S6.E12.m1.1.1.1.cmml" xref="S6.E12.m1.1.1.1"></eq><ci id="S6.E12.m1.1.1.2a.cmml" xref="S6.E12.m1.1.1.2"><mtext id="S6.E12.m1.1.1.2.cmml" xref="S6.E12.m1.1.1.2">Accuracy</mtext></ci><apply id="S6.E12.m1.1.1.3.cmml" xref="S6.E12.m1.1.1.3"><divide id="S6.E12.m1.1.1.3.1.cmml" xref="S6.E12.m1.1.1.3"></divide><ci id="S6.E12.m1.1.1.3.2a.cmml" xref="S6.E12.m1.1.1.3.2"><mtext id="S6.E12.m1.1.1.3.2.cmml" xref="S6.E12.m1.1.1.3.2">Overall Correct Facts</mtext></ci><apply id="S6.E12.m1.1.1.3.3.cmml" xref="S6.E12.m1.1.1.3.3"><plus id="S6.E12.m1.1.1.3.3.1.cmml" xref="S6.E12.m1.1.1.3.3.1"></plus><ci id="S6.E12.m1.1.1.3.3.2c.cmml" xref="S6.E12.m1.1.1.3.3.2"><mrow id="S6.E12.m1.1.1.3.3.2.cmml" xref="S6.E12.m1.1.1.3.3.2"><mtext id="S6.E12.m1.1.1.3.3.2a.cmml" xref="S6.E12.m1.1.1.3.3.2">Overall (</mtext><mtext id="S6.E12.m1.1.1.3.3.2b.cmml" xref="S6.E12.m1.1.1.3.3.2"> Correct Facts</mtext></mrow></ci><ci id="S6.E12.m1.1.1.3.3.3c.cmml" xref="S6.E12.m1.1.1.3.3.3"><mrow id="S6.E12.m1.1.1.3.3.3.cmml" xref="S6.E12.m1.1.1.3.3.3"><mtext id="S6.E12.m1.1.1.3.3.3a.cmml" xref="S6.E12.m1.1.1.3.3.3">Incorrect Facts</mtext><mtext id="S6.E12.m1.1.1.3.3.3b.cmml" xref="S6.E12.m1.1.1.3.3.3">)</mtext></mrow></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E12.m1.1c">\text{Accuracy}=\frac{\displaystyle\text{Overall Correct Facts}}{\displaystyle%
\text{Overall (}\text{ Correct Facts}+\displaystyle\text{Incorrect Facts}\text%
{)}}</annotation><annotation encoding="application/x-llamapun" id="S6.E12.m1.1d">Accuracy = divide start_ARG Overall Correct Facts end_ARG start_ARG Overall ( Correct Facts + Incorrect Facts ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table" id="S6.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span>Timeline Analysis Report Facts</figcaption>
<p class="ltx_p ltx_align_center" id="S6.T8.1"><span class="ltx_text" id="S6.T8.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T8.1.1.1" style="width:252.3pt;height:294.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S6.T8.1.1.1.1"><span class="ltx_text" id="S6.T8.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.1.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.1.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.1.1.1.1.1">Scenarios</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.1.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.1.2.1.1" style="width:54.1pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.1.2.1.1.1">Overall Report Facts</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.1.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.1.3.1.1" style="width:54.1pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.1.3.1.1.1">Knowledge Base</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.1.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.1.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.1.4.1.1" style="width:54.1pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.1.4.1.1.1">LLM Facts (All correct)</span></span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.2.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.2.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.2.1.1.1.1">SYN Flood</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.2.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.2.2.1.1" style="width:54.1pt;">20</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.2.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.2.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.2.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.2.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.2.3.1.1.1.1.1">- Correct: 17</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.2.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.2.3.1.1.1.2.1">- Incorrect: 0</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.2.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.2.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.2.4.1.1" style="width:54.1pt;">03</span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.3.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.3.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.3.1.1.1.1">Rhino Hunt</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.3.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.3.2.1.1" style="width:54.1pt;">16</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.3.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.3.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.3.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.3.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.3.3.1.1.1.1.1">- Correct: 08</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.3.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.3.3.1.1.1.2.1">- Incorrect: 0</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.3.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.3.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.3.4.1.1" style="width:54.1pt;">08</span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.4">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.4.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.4.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.4.1.1.1.1">Phishing Email - 1</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.4.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.4.2.1.1" style="width:54.1pt;">13</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.4.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.4.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.4.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.4.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.4.3.1.1.1.1.1">- Correct: 09</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.4.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.4.3.1.1.1.2.1">- Incorrect: 1</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.4.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.4.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.4.4.1.1" style="width:54.1pt;">03</span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.5">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.5.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.5.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.5.1.1.1.1">Phishing Email - 2</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.5.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.5.2.1.1" style="width:54.1pt;">22</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.5.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.5.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.5.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.5.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.5.3.1.1.1.1.1">- Correct: 13</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.5.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.5.3.1.1.1.2.1">- Incorrect: 03</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.5.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.5.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.5.4.1.1" style="width:54.1pt;">06</span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.6">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.6.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.6.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.6.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.6.1.1.1.1">DNS Spoof</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.6.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.6.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.6.2.1.1" style="width:54.1pt;">19</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.6.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.6.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.6.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.6.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.6.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.6.3.1.1.1.1.1">- Correct 14</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.6.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.6.3.1.1.1.2.1">- Incorrect: 0</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.6.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.6.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.6.4.1.1" style="width:54.1pt;">05</span>
</span></span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.7">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.7.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.7.1.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.7.1.1.1" style="width:39.8pt;"><span class="ltx_text ltx_font_bold" id="S6.T8.1.1.1.1.1.1.7.1.1.1.1">Unauthorized Access</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.7.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.7.2.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.7.2.1.1" style="width:54.1pt;">22</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.7.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.7.3.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.7.3.1.1" style="width:54.1pt;">
<span class="ltx_tabular ltx_align_middle" id="S6.T8.1.1.1.1.1.1.7.3.1.1.1">
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.7.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.7.3.1.1.1.1.1">- Correct: 14</span></span>
<span class="ltx_tr" id="S6.T8.1.1.1.1.1.1.7.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S6.T8.1.1.1.1.1.1.7.3.1.1.1.2.1">- Incorrect: 01</span></span>
</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S6.T8.1.1.1.1.1.1.7.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T8.1.1.1.1.1.1.7.4.1">
<span class="ltx_p" id="S6.T8.1.1.1.1.1.1.7.4.1.1" style="width:54.1pt;">07</span>
</span></span></span>
</span></span></span>
</span></span></span><span class="ltx_text" id="S6.T8.1.2" style="font-size:70%;"></span></p>
</figure>
<figure class="ltx_figure" id="S6.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S6.F10.g1" src="extracted/5878186/img/accuracy.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Overall Accuracy of the TA report for different Cyber Incident Scenarios.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS2.5.1.1">VI-B</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS2.6.2">Relevance</span>
</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Prompts dedicated to the relevance metric are characterized by their focus on various aspects, including sentiment (e.g., <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.1">What is the overall sentiment of the image described in Event 2 (Image b)?</span>), intention (e.g., <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.2">What specific action is requested by GlobalBank in the initial email?</span>), deep analysis (e.g., <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.3">Analyze the severity levels associated with the events involving SYN flood attacks. List the events and their corresponding severity levels.</span>), as well as retrieval, prediction, and insights. The graph in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F11" title="Figure 11 ‣ VI-B Relevance ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">11</span></a> clearly shows that some scenarios have failed in certain prompts. For instance, in the SYN Flood scenario, GenDFIR failed on Prompt 4; in the Rhino Hunt scenario, Prompt 13 was answered partially correctly (50%); and in the Phishing Email 1 scenario, GenDFIR failed on both Prompts 11 and 12.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">The overall relevance output rate for each incident is visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F12" title="Figure 12 ‣ VI-B Relevance ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">12</span></a>.</p>
</div>
<figure class="ltx_figure" id="S6.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="S6.F11.g1" src="extracted/5878186/img/relevance.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Prompts Relevance of the TA report for different Cyber Incident Scenarios.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="184" id="S6.F12.g1" src="extracted/5878186/img/ovrelevance.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Overall Relevance for Different Cyber Incident Scenarios.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS3.5.1.1">VI-C</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS3.6.2">Exact Match (EM)</span>
</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">EM in GenDFIR involves testing and evaluating various aspects of the framework by posing forensic questions that address specific tasks, such as retrieving precise timestamps (e.g., <span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.1">What was the exact time when Michael Davis responded to the first email from the GlobalBank Security Team?</span>) and obtaining detailed descriptions (e.g., <span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.2">In Event 5, what was the description of the alligator?</span>), along with other relevant queries.</p>
</div>
<figure class="ltx_table" id="S6.T9">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T9.1" style="width:433.6pt;height:117.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-49.0pt,13.3pt) scale(0.815712983314633,0.815712983314633) ;">
<table class="ltx_tabular ltx_align_middle" id="S6.T9.1.1">
<tr class="ltx_tr" id="S6.T9.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S6.T9.1.1.1.1.1">Scenario</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="20" id="S6.T9.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T9.1.1.1.2.1">Prompt Number</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.1">1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.2">2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.3">3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.4">4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.5">5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.6">6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.7">7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.8">8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.9">9</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.10">10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.11">11</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.12">12</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.13">13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.14">14</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.15">15</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.16">16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.17">17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.18">18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.19">19</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.2.20">20</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.3.1">SYN Flood</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.3.21">✓</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.4.1">Rhino Hunt</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.4.21">✓</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.5.1">Phishing Email 1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.5.21">✓</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.6.1">Phishing Email 2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.6.21">✓</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.7.1">DNS Spoof</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T9.1.1.7.21">✓</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.1.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T9.1.1.8.1">Unauthorized Access</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.7">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.8">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.9">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.10">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.11">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.12">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.13">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.14">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.15">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.16">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.17">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.18">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.19">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.20">✓</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T9.1.1.8.21">✓</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IX: </span>EM Evaluation Prompt Checks</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.T9" title="TABLE IX ‣ VI-C Exact Match (EM) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">IX</span></a> presents the checks performed, showing that they align perfectly with the ground truth. The table demonstrates that GenDFIR successfully passed all checks without any errors.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS4.5.1.1">VI-D</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS4.6.2">Evidence (Top K)</span>
</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.2">DFIR primarily focuses on identifying evidence through the analysis of digital artifacts. As detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S4" title="IV GenDFIR Methodology ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">IV</span></a>, our approach employs algorithms that utilize cosine similarity to identify relevant evidence within the knowledge base. To facilitate real-time visualization of this process during inference, we developed a script, illustrated in Listing <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#LST4" title="Listing 4 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, which uses the UMAP library. This script enables the visualization of how features from the vectorized user input (<math alttext="VRI" class="ltx_Math" display="inline" id="S6.SS4.p1.1.m1.1"><semantics id="S6.SS4.p1.1.m1.1a"><mrow id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml"><mi id="S6.SS4.p1.1.m1.1.1.2" xref="S6.SS4.p1.1.m1.1.1.2.cmml">V</mi><mo id="S6.SS4.p1.1.m1.1.1.1" xref="S6.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS4.p1.1.m1.1.1.3" xref="S6.SS4.p1.1.m1.1.1.3.cmml">R</mi><mo id="S6.SS4.p1.1.m1.1.1.1a" xref="S6.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS4.p1.1.m1.1.1.4" xref="S6.SS4.p1.1.m1.1.1.4.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><apply id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1"><times id="S6.SS4.p1.1.m1.1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1.1"></times><ci id="S6.SS4.p1.1.m1.1.1.2.cmml" xref="S6.SS4.p1.1.m1.1.1.2">𝑉</ci><ci id="S6.SS4.p1.1.m1.1.1.3.cmml" xref="S6.SS4.p1.1.m1.1.1.3">𝑅</ci><ci id="S6.SS4.p1.1.m1.1.1.4.cmml" xref="S6.SS4.p1.1.m1.1.1.4">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">VRI</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.1.m1.1d">italic_V italic_R italic_I</annotation></semantics></math>) correspond with features in the embedded knowledge base (<math alttext="ED" class="ltx_Math" display="inline" id="S6.SS4.p1.2.m2.1"><semantics id="S6.SS4.p1.2.m2.1a"><mrow id="S6.SS4.p1.2.m2.1.1" xref="S6.SS4.p1.2.m2.1.1.cmml"><mi id="S6.SS4.p1.2.m2.1.1.2" xref="S6.SS4.p1.2.m2.1.1.2.cmml">E</mi><mo id="S6.SS4.p1.2.m2.1.1.1" xref="S6.SS4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S6.SS4.p1.2.m2.1.1.3" xref="S6.SS4.p1.2.m2.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.2.m2.1b"><apply id="S6.SS4.p1.2.m2.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1"><times id="S6.SS4.p1.2.m2.1.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1.1"></times><ci id="S6.SS4.p1.2.m2.1.1.2.cmml" xref="S6.SS4.p1.2.m2.1.1.2">𝐸</ci><ci id="S6.SS4.p1.2.m2.1.1.3.cmml" xref="S6.SS4.p1.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.2.m2.1c">ED</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.2.m2.1d">italic_E italic_D</annotation></semantics></math>). It is important to remember that evidence identification is contingent upon the input provided by the user, who determines which events or attributes within those events should be considered as evidence.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">According to the heat parameter and the cosine similarity equation, a score closer to 1 indicates stronger evidence (Top K).</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST4">
<div class="ltx_listing ltx_lst_numbers_left ltx_lstlisting ltx_listing" id="LST4.1" style="background-color:#F2F2EB;">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ICBkZWYgY2FsY3VsYXRlX2Nvc2luZV9zaW1pbGFyaXR5KFZSSSwgRUQpOgogICAgIiIiCiAgICBDYWxjdWxhdGUgY29zaW5lIHNpbWlsYXJpdHkgYmV0d2VlbiB0aGUgaW5wdXQgYW5kIEtub3dsZWRnZSBCYXNlIGVtYmVkZGluZ3MuCiAgICBBcmdzOgogICAgLSBWUkkgKGxpc3Qgb3IgbnAuYXJyYXkpOiBFbWJlZGRpbmcgb2YgdGhlIGlucHV0IHF1ZXJ5LgogICAgLSBFRCAobGlzdCBvciBucC5hcnJheSk6IEVtYmVkZGluZ3Mgb2YgdGhlIEtub3dsZWRnZSBCYXNlIGNvbnRlbnQuCiAgICBSZXR1cm5zOgogICAgLSB0b3JjaC5UZW5zb3I6IENvc2luZSBzaW1pbGFyaXR5IHNjb3JlcyBiZXR3ZWVuIGlucHV0IGFuZCBLbm93bGVkZ2UgQmFzZSBlbWJlZGRpbmdzLgogICAgIiIiCiAgICBjb3Nfc2NvcmVzID0gdG9yY2guY29zaW5lX3NpbWlsYXJpdHkodG9yY2gudGVuc29yKFZSSSkudW5zcXVlZXplKDApLCBFRCkKICAgIHJldHVybiBjb3Nfc2NvcmVzCiAgZGVmIHZpc3VhbGl6ZV9jb3NpbmVfc2ltaWxhcml0eShjb3Nfc2NvcmVzKToKICAgICMgQ29udmVydCBjb3NpbmUgc2ltaWxhcml0eSBzY29yZXMgdG8gMkQKICAgIHNjb3Jlc18yZCA9IG5wLmFycmF5KGNvc19zY29yZXMpLnJlc2hhcGUoLTEsIDEpCiAgICAjIEFwcGx5IFVNQVAgZm9yIGRpbWVuc2lvbmFsaXR5IHJlZHVjdGlvbgogICAgZW1iZWRkaW5nID0gdW1hcC5VTUFQKG5fbmVpZ2hib3JzPTUsIG1pbl9kaXN0PTAuMSwgcmFuZG9tX3N0YXRlPTQyKS5maXRfdHJhbnNmb3JtKHNjb3Jlc18yZCkKICAgICMgQ3JlYXRlIGEgc2NhdHRlciBwbG90IHVzaW5nIE1hdHBsb3RsaWIKICAgIHNjYXR0ZXIgPSBwbHQuc2NhdHRlcihlbWJlZGRpbmdbOiwgMF0sIGVtYmVkZGluZ1s6LCAxXSwgYz1zY29yZXNfMmQuZmxhdHRlbigpLCBjbWFwPSd2aXJpZGlzJykKICAgIHBsdC5zaG93KCkKICAgY29zX3Njb3JlcyA9IGNhbGN1bGF0ZV9jb3NpbmVfc2ltaWxhcml0eShWUkksIEVEKQogICAjIFZpc3VhbGl6ZSB0aGUgY29zaW5lIHNpbWlsYXJpdHkgc2NvcmVzCiAgIHZpc3VhbGl6ZV9jb3NpbmVfc2ltaWxhcml0eShjb3Nfc2NvcmVzKQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.2" style="font-size:80%;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.4" style="font-size:80%;">calculate_cosine_similarity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.5" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.6" style="font-size:80%;">VRI</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.7" style="font-size:80%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.8" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.9" style="font-size:80%;">ED</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.10" style="font-size:80%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.2" style="font-size:80%;">"""</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.2" style="font-size:80%;">Calculate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.4" style="font-size:80%;">cosine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.6" style="font-size:80%;">similarity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.8" style="font-size:80%;">between</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.10" style="font-size:80%;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.11" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.12" style="font-size:80%;">input</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.13" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.14" style="font-size:80%;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.15" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.16" style="font-size:80%;">Knowledge</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.17" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.18" style="font-size:80%;">Base</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx26.19" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx26.20" style="font-size:80%;">embeddings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx26.21" style="font-size:80%;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx27.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.2" style="font-size:80%;">Args</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.3" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.2" style="font-size:80%;">-</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.4" style="font-size:80%;">VRI</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.6" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.7" style="font-size:80%;">list</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.8" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.9" style="font-size:80%;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.11" style="font-size:80%;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.12" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.13" style="font-size:80%;">array</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.14" style="font-size:80%;">):</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.15" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.16" style="font-size:80%;">Embedding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.17" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.18" style="font-size:80%;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.19" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.20" style="font-size:80%;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.21" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.22" style="font-size:80%;">input</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx28.23" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.24" style="font-size:80%;">query</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.25" style="font-size:80%;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.2" style="font-size:80%;">-</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.4" style="font-size:80%;">ED</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.6" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.7" style="font-size:80%;">list</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.8" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.9" style="font-size:80%;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.11" style="font-size:80%;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.12" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.13" style="font-size:80%;">array</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.14" style="font-size:80%;">):</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.15" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.16" style="font-size:80%;">Embeddings</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.17" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.18" style="font-size:80%;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.19" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.20" style="font-size:80%;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.21" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.22" style="font-size:80%;">Knowledge</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.23" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.24" style="font-size:80%;">Base</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.25" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.26" style="font-size:80%;">content</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.27" style="font-size:80%;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.2" style="font-size:80%;">Returns</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.3" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.2" style="font-size:80%;">-</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.4" style="font-size:80%;">torch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.5" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.6" style="font-size:80%;">Tensor</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.7" style="font-size:80%;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.8" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.9" style="font-size:80%;">Cosine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.11" style="font-size:80%;">similarity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.12" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.13" style="font-size:80%;">scores</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.14" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.15" style="font-size:80%;">between</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.16" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.17" style="font-size:80%;">input</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.18" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.19" style="font-size:80%;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.20" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.21" style="font-size:80%;">Knowledge</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.22" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.23" style="font-size:80%;">Base</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.24" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.25" style="font-size:80%;">embeddings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.26" style="font-size:80%;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.2" style="font-size:80%;">"""</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.2" style="font-size:80%;">cos_scores</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.6" style="font-size:80%;">torch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.8" style="font-size:80%;">cosine_similarity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.10" style="font-size:80%;">torch</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.11" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.12" style="font-size:80%;">tensor</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.13" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.14" style="font-size:80%;">VRI</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.15" style="font-size:80%;">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.16" style="font-size:80%;">unsqueeze</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.17" style="font-size:80%;">(0),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.18" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.19" style="font-size:80%;">ED</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.20" style="font-size:80%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.2" style="font-size:80%;">return</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.4" style="font-size:80%;">cos_scores</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.2" style="font-size:80%;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.4" style="font-size:80%;">visualize_cosine_similarity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.5" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.6" style="font-size:80%;">cos_scores</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.7" style="font-size:80%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.2" style="font-size:80%;">#</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.4" style="font-size:80%;">Convert</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.6" style="font-size:80%;">cosine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.8" style="font-size:80%;">similarity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.10" style="font-size:80%;">scores</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.11" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.12" style="font-size:80%;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.13" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.14" style="font-size:80%;">2</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.15" style="font-size:80%;">D</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.2" style="font-size:80%;">scores_2d</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.6" style="font-size:80%;">np</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.8" style="font-size:80%;">array</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.10" style="font-size:80%;">cos_scores</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.11" style="font-size:80%;">).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.12" style="font-size:80%;">reshape</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.13" style="font-size:80%;">(-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.14" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.15" style="font-size:80%;">1)</span>
</div>
<div class="ltx_listingline" id="lstnumberx38">
<span class="ltx_tag ltx_tag_listingline">15</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx38.2" style="font-size:80%;">#</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.4" style="font-size:80%;">Apply</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.6" style="font-size:80%;">UMAP</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.8" style="font-size:80%;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.10" style="font-size:80%;">dimensionality</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx38.11" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx38.12" style="font-size:80%;">reduction</span>
</div>
<div class="ltx_listingline" id="lstnumberx39">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.2" style="font-size:80%;">embedding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.6" style="font-size:80%;">umap</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.8" style="font-size:80%;">UMAP</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.10" style="font-size:80%;">n_neighbors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.11" style="font-size:80%;">=5,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.12" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.13" style="font-size:80%;">min_dist</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.14" style="font-size:80%;">=0.1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.15" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.16" style="font-size:80%;">random_state</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.17" style="font-size:80%;">=42).</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.18" style="font-size:80%;">fit_transform</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.19" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.20" style="font-size:80%;">scores_2d</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.21" style="font-size:80%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx40">
<span class="ltx_tag ltx_tag_listingline">17</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.2" style="font-size:80%;">#</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.4" style="font-size:80%;">Create</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.6" style="font-size:80%;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.8" style="font-size:80%;">scatter</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.10" style="font-size:80%;">plot</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.11" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.12" style="font-size:80%;">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.13" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.14" style="font-size:80%;">Matplotlib</span>
</div>
<div class="ltx_listingline" id="lstnumberx41">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.2" style="font-size:80%;">scatter</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.6" style="font-size:80%;">plt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.7" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.8" style="font-size:80%;">scatter</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.9" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.10" style="font-size:80%;">embedding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.11" style="font-size:80%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.12" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.13" style="font-size:80%;">0],</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.14" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.15" style="font-size:80%;">embedding</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.16" style="font-size:80%;">[:,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.17" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.18" style="font-size:80%;">1],</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.19" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.20" style="font-size:80%;">c</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.21" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.22" style="font-size:80%;">scores_2d</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.23" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.24" style="font-size:80%;">flatten</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.25" style="font-size:80%;">(),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.26" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.27" style="font-size:80%;">cmap</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.28" style="font-size:80%;">=’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.29" style="font-size:80%;">viridis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.30" style="font-size:80%;">’)</span>
</div>
<div class="ltx_listingline" id="lstnumberx42">
<span class="ltx_tag ltx_tag_listingline">19</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.2" style="font-size:80%;">plt</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.3" style="font-size:80%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.4" style="font-size:80%;">show</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.5" style="font-size:80%;">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx43">
<span class="ltx_tag ltx_tag_listingline">20</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.2" style="font-size:80%;">cos_scores</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.3" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.4" style="font-size:80%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.6" style="font-size:80%;">calculate_cosine_similarity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.7" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.8" style="font-size:80%;">VRI</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.9" style="font-size:80%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.10" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.11" style="font-size:80%;">ED</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.12" style="font-size:80%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.1" style="font-size:80%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.2" style="font-size:80%;">#</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.3" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.4" style="font-size:80%;">Visualize</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.5" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.6" style="font-size:80%;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.7" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.8" style="font-size:80%;">cosine</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.9" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.10" style="font-size:80%;">similarity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.11" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.12" style="font-size:80%;">scores</span>
</div>
<div class="ltx_listingline" id="lstnumberx45">
<span class="ltx_tag ltx_tag_listingline">22</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.1" style="font-size:80%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.2" style="font-size:80%;">visualize_cosine_similarity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.3" style="font-size:80%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.4" style="font-size:80%;">cos_scores</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.5" style="font-size:80%;">)</span>
</div>
</div>
<figcaption class="ltx_caption" style="background-color:#F2F2EB;"><span class="ltx_tag ltx_tag_float">Listing 4: </span>Code snippet for Calculating and Visualizing Cosine Similarity</figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p3">
<p class="ltx_p" id="S6.SS4.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.T10" title="TABLE X ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">X</span></a> contains ground truth evidence (Top K) for each cyber incident, as determined by the user.</p>
</div>
<figure class="ltx_table" id="S6.T10">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE X: </span>Top K Evidence within the Knowledge Base (Events)</figcaption>
<p class="ltx_p ltx_align_center" id="S6.T10.1"><span class="ltx_text" id="S6.T10.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T10.1.1.1" style="width:200.5pt;height:175.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="S6.T10.1.1.1.1"><span class="ltx_text" id="S6.T10.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T10.1.1.1.1.1.1">
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.1.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.1.1.1.1" style="width:42.7pt;"><span class="ltx_text ltx_font_bold" id="S6.T10.1.1.1.1.1.1.1.1.1.1.1">Cyber Incident</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.1.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.1.2.1.1" style="width:56.9pt;"><span class="ltx_text ltx_font_bold" id="S6.T10.1.1.1.1.1.1.1.2.1.1.1">Evidence</span></span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.1.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.1.3.1.1" style="width:62.6pt;"><span class="ltx_text ltx_font_bold" id="S6.T10.1.1.1.1.1.1.1.3.1.1.1">Actual number of Evidence</span></span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.2.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.2.1.1.1" style="width:42.7pt;">SYN Flood</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.2.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.2.2.1.1" style="width:56.9pt;">Level: Critical.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.2.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.2.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.2.3.1.1" style="width:62.6pt;">05</span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.3.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.3.1.1.1" style="width:42.7pt;">Rhino Hunt (Inspired from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib52" title="">52</a>]</cite>)</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.3.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.3.2.1.1" style="width:56.9pt;">Rhino.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.3.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.3.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.3.3.1.1" style="width:62.6pt;">04</span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.4">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.4.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.4.1.1.1" style="width:42.7pt;">Phishing Email - 1</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.4.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.4.2.1.1" style="width:56.9pt;">Events that appear to be phishing.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.4.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.4.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.4.3.1.1" style="width:62.6pt;">06</span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.5">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.5.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.5.1.1.1" style="width:42.7pt;">Phishing Email - 2</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.5.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.5.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.5.2.1.1" style="width:56.9pt;">Events that appear to be phishing.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.5.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.5.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.5.3.1.1" style="width:62.6pt;">07</span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.6">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.6.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.6.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.6.1.1.1" style="width:42.7pt;">Unauthorized Access</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.6.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.6.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.6.2.1.1" style="width:56.9pt;">Level: Warning.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.6.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.6.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.6.3.1.1" style="width:62.6pt;">25</span>
</span></span></span>
<span class="ltx_tr" id="S6.T10.1.1.1.1.1.1.7">
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.7.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.7.1.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.7.1.1.1" style="width:42.7pt;">DNS Spoof</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.7.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.7.2.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.7.2.1.1" style="width:56.9pt;">Level: Error.</span>
</span></span>
<span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="S6.T10.1.1.1.1.1.1.7.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T10.1.1.1.1.1.1.7.3.1">
<span class="ltx_p" id="S6.T10.1.1.1.1.1.1.7.3.1.1" style="width:62.6pt;">06</span>
</span></span></span>
</span></span></span>
</span></span></span><span class="ltx_text" id="S6.T10.1.2" style="font-size:70%;"></span></p>
</figure>
<div class="ltx_para" id="S6.SS4.p4">
<p class="ltx_p" id="S6.SS4.p4.1">Figures <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F13" title="Figure 13 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F14" title="Figure 14 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">14</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F15" title="Figure 15 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">15</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F16" title="Figure 16 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F17" title="Figure 17 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">17</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F18" title="Figure 18 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">18</span></a> illustrate the outputs of UMAP evidence visualizations.</p>
</div>
<figure class="ltx_figure" id="S6.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="205" id="S6.F13.g1" src="extracted/5878186/img/synflood.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>SYN Flood - Evidence (Top K=5)</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="205" id="S6.F14.g1" src="extracted/5878186/img/rhinohunt.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Rhino Hunt - Evidence (Top K=4)</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="209" id="S6.F15.g1" src="extracted/5878186/img/phishing1.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Phishing Email 1 - Evidence (Top K=6)</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="S6.F16.g1" src="extracted/5878186/img/phishing2.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Phishing Email 2 - Evidence (Top K=7) </figcaption>
</figure>
<figure class="ltx_figure" id="S6.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="205" id="S6.F17.g1" src="extracted/5878186/img/unauth.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Unauthorized Access - Evidence (Top K=20)</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F18"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="205" id="S6.F18.g1" src="extracted/5878186/img/dns.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>DNS Spoof - Evidence (Top K=6)</figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p5">
<p class="ltx_p" id="S6.SS4.p5.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F17" title="Figure 17 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">17</span></a> provides an example where all events are considered as evidence. The ground truth data in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.T10" title="TABLE X ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">X</span></a> specifies a total of 25 pieces of evidence, based on the user’s input: <span class="ltx_text ltx_font_italic" id="S6.SS4.p5.1.1">"Identify all events where the Level is ’Warning’ and extract their corresponding evidence"</span>. However, the Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S6.F17" title="Figure 17 ‣ VI-D Evidence (Top K) ‣ VI Results Evaluation and Discussion ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">17</span></a> generated using UMAP displays only the Top K=20 pieces of evidence, which are those with a cosine similarity score greater than 0.50. This discrepancy indicates an inaccuracy in the cosine similarity-based extraction.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS5.5.1.1">VI-E</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS5.6.2">Overall Performance</span>
</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">The overall performance of GenDFIR is assessed by calculating the aggregate accuracy across each metric as follows:</p>
</div>
<figure class="ltx_table" id="S6.T11">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T11.1">
<tr class="ltx_tr" id="S6.T11.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T11.1.1.1.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T11.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T11.1.1.2.1">Rate</span></td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.2.1">Accuracy</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T11.1.2.2">95.52%.</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.3.1">Relevance</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T11.1.3.2">94.51%</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.4.1">EM</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T11.1.4.2">100%</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.5.1">Top K</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T11.1.5.2">83.33%</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.6">
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T11.1.6.1"><span class="ltx_text ltx_font_bold" id="S6.T11.1.6.1.1">Overall</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S6.T11.1.6.2">93.34%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE XI: </span>Overall Accuracy</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS6.5.1.1">VI-F</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS6.6.2">Discussion</span>
</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">As discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#S5" title="V GenDFIR Implementation ‣ Advancing Cyber Incident Timeline Analysis Through Rule-Based AI and Large Language Models"><span class="ltx_text ltx_ref_tag">V</span></a>, GenDFIR should not be viewed as a universal solution for all DFIR tasks. Instead, it is designed as a foundational framework to address specific challenges faced by DFIR analysts, particularly in the analysis of artifacts.</p>
</div>
<div class="ltx_para" id="S6.SS6.p2">
<p class="ltx_p" id="S6.SS6.p2.1">The evaluation results, as illustrated in the previous graphs, show a success rate ranging from 80% to 100%, depending on the metrics used. It is important to emphasize that these results are based on simplified experimental scenarios and minimal configuration settings.</p>
</div>
<div class="ltx_para" id="S6.SS6.p3">
<p class="ltx_p" id="S6.SS6.p3.1">Moreover, the primary purpose of the generated TA reports is to interpret DF aspects using LLMs and expedite the process. When comparing casual and accurate DF practices, it is essential to consider that TA reports are critical in documenting the sequence of events in an incident. These reports typically focus on:</p>
</div>
<div class="ltx_para" id="S6.SS6.p4">
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i1.p1.1.1">Event Chronology:</span> A detailed timeline of events, presenting a chronological order of activities related to the incident.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i2.p1.1.1">Evidence Correlation:</span> Analysis of how various pieces of evidence relate to the timeline.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i3.p1.1.1">Incident Overview:</span> A summary of the incident, including key findings and impacts.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.SS6.p5">
<p class="ltx_p" id="S6.SS6.p5.1">Timeline reports are often tailored to different audiences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib55" title="">55</a>]</cite>:</p>
</div>
<div class="ltx_para" id="S6.SS6.p6">
<ul class="ltx_itemize" id="S6.I2">
<li class="ltx_item" id="S6.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i1.p1">
<p class="ltx_p" id="S6.I2.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S6.I2.i1.p1.1.1">Technical Stakeholders:</span> Forensics experts and IT professionals require detailed, technical reports with precise timestamps, technical analysis, and evidence correlation. For example, a technical report may include granular timestamps of system log entries and detailed forensic data.</p>
</div>
</li>
<li class="ltx_item" id="S6.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i2.p1">
<p class="ltx_p" id="S6.I2.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S6.I2.i2.p1.1.1">Non-Technical Stakeholders:</span> Reports for non-technical audiences, such as senior management or legal teams, present a streamlined timeline with key events highlighted. These reports focus on the overall sequence of events and impacts, formatted to be accessible and understandable to non-experts. An example is an Executive Summary followed by a simplified timeline of events.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.SS6.p7">
<p class="ltx_p" id="S6.SS6.p7.1">In the case of GenDFIR, the report templates were generated by the LLM, guided by human prompts and system messages. The reports also included mitigation solutions. Due to token limits of the single-modal LLM, the reports were automatically condensed.</p>
</div>
<div class="ltx_para" id="S6.SS6.p8">
<p class="ltx_p" id="S6.SS6.p8.1">A crucial aspect of GenDFIR is the identification of evidence from the knowledge base. Cosine similarity demonstrated high performance and efficiency in detecting anomalies and extracting relevant evidence, despite one identified error (Unauthorized Access incident). It is important to note that evidence identification must be guided by user input.</p>
</div>
<div class="ltx_para" id="S6.SS6.p9">
<p class="ltx_p" id="S6.SS6.p9.1">Additionally, the R-BAI algorithms played a crucial role in filtering and reducing the volume of artifacts processed by the LLMs, avoiding a significant increase in the number of artifacts. However, these results and observations were consistently monitored by human assistance. Without this oversight, detecting inaccuracies would be challenging. Although R-BAI and LLMs reduced the time required for Forensic TA, this was offset by the time needed for monitoring and verification.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span class="ltx_text ltx_font_smallcaps" id="S7.1.1">Limitations and Ethical Issues</span>
</h2>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S7.SS1.5.1.1">VII-A</span> </span><span class="ltx_text ltx_font_italic" id="S7.SS1.6.2">GenDFIR Limitations</span>
</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">Despite the success of bringing the proposed framework to life and successfully generating TA reports, this research encountered several limitations:</p>
</div>
<div class="ltx_para" id="S7.SS1.p2">
<ul class="ltx_itemize" id="S7.I1">
<li class="ltx_item" id="S7.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i1.p1">
<p class="ltx_p" id="S7.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I1.i1.p1.1.1">Novelty of Approach:</span> Our method of applying LLMs to real-world tasks, particularly in DFIR and TA, is relatively new. The limited amount of existing research in these areas means there are few established guidelines or benchmarks to follow.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i2.p1">
<p class="ltx_p" id="S7.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I1.i2.p1.1.1">Lack of Research on Automated TA:</span> As previously mentioned, there has been minimal research into automating TA. This gap in prior work has restricted our ability to develop and refine automated solutions.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i3.p1">
<p class="ltx_p" id="S7.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I1.i3.p1.1.1">Data Volume and Variety:</span> The large volume and diversity of data in cyber incident scenarios present significant challenges for data management and processing.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i4.p1">
<p class="ltx_p" id="S7.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I1.i4.p1.1.1">Privacy and Data Security:</span> Dealing with DFIR cases often involves sensitive personal data. To address privacy concerns, we have considered using synthetic data as an alternative to avoid exposing real personal information.</p>
</div>
</li>
<li class="ltx_item" id="S7.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I1.i5.p1">
<p class="ltx_p" id="S7.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I1.i5.p1.1.1">Evaluation Methods:</span> Evaluating the effectiveness and performance of our framework remains a challenge. Current research is still developing automated methods for assessing LLMs and AI systems. Most existing approaches rely on manual, context-specific evaluations. In our case, this involved crafting our own forensic context-based evaluation prompts.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S7.SS2.5.1.1">VII-B</span> </span><span class="ltx_text ltx_font_italic" id="S7.SS2.6.2">Ethical Issues</span>
</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">In the field of DFIR, combined with GenAI, ethical issues are critically important and require meticulous consideration due to the sensitive and private nature of data, practices, and activities involved <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.02572v3#bib.bib13" title="">13</a>]</cite>. However, it is important to note that once data is processed and interpreted, it becomes information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.SS2.p2">
<p class="ltx_p" id="S7.SS2.p2.1">The following are the most relevant and common concerns:</p>
<ul class="ltx_itemize" id="S7.I2">
<li class="ltx_item" id="S7.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i1.p1">
<p class="ltx_p" id="S7.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I2.i1.p1.1.1">Privacy and Confidentiality:</span>The integration of R-BAI and LLMs to advance cyber incident TA can lead to severe privacy breaches. These technologies often require access to and are fed with massive amounts of sensitive data (personal , digital , financial data, health data, and other types) which increases the risk of exposing personal and confidential information without proper safeguards.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i2.p1">
<p class="ltx_p" id="S7.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I2.i2.p1.1.1">Accuracy and Efficiency:</span> Ensuring the accuracy and reliability of automated analyses and reports resulting from R-BAI and LLMs is crucial. If inaccurate, it could lead to flawed and irrelevant conclusions in cyber incident investigations, potentially obstructing legal proceedings and justice.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i3.p1">
<p class="ltx_p" id="S7.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I2.i3.p1.1.1">Consent:</span>
Obtaining proper consent from individuals whose data is used for automatic processing by R-BAI and LLMs without explicit consent directly violates their privacy rights.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i4.p1">
<p class="ltx_p" id="S7.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I2.i4.p1.1.1">Bias and Fairness:</span> One major concern with AI models is their tendency to introduce or perpetuate biases, potentially leading to unfair outcomes in cyber incident analysis. Bias in training datasets or algorithms can compromise results, impacting the impartiality of investigations.</p>
</div>
</li>
<li class="ltx_item" id="S7.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S7.I2.i5.p1">
<p class="ltx_p" id="S7.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S7.I2.i5.p1.1.1">Integrity of Evidence:</span> AI systems could compromise the authenticity and reliability of evidence. Improper handling or processing of digital evidence during analysis could compromise its integrity. Therefore, R-BAI and LLMs outputs must be consistently monitored.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VIII </span><span class="ltx_text ltx_font_smallcaps" id="S8.1.1">Conclusion and Future Works</span>
</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">In this work, we present a novel AI-based framework designed to fully automate Forensic TA for cyber incidents. The framework integrates R-BAI, LLMs, and the RAG agent to not only perform TA but also to provide valuable insights, including mitigation strategies and responses to various forensic queries.</p>
</div>
<div class="ltx_para" id="S8.p2">
<p class="ltx_p" id="S8.p2.1">The research began with a comprehensive exploration of forensic TA, examining its characteristics, aspects that necessitate automation, and its informational traits. We then proposed a development approach for the framework, addressing technical requirements such as hardware and system configurations.</p>
</div>
<div class="ltx_para" id="S8.p3">
<p class="ltx_p" id="S8.p3.1">The framework was subsequently tested on simulated DFIR incidents inspired by real-world scenarios, constrained by privacy and consent limitations.</p>
</div>
<div class="ltx_para" id="S8.p4">
<p class="ltx_p" id="S8.p4.1">The evaluation of results underscored the significant potential of the framework’s core approach. However, substantial limitations were encountered during this phase. Standard metrics for evaluating machine learning (ML) and AI systems, such as the F1-score, recall, and precision, were not applicable to the GenDFIR framework. The framework produced contextual reports rather than numerical data suitable for classification, highlighting the need for bespoke calculations and metrics tailored specifically to GenDFIR.</p>
</div>
<div class="ltx_para" id="S8.p5">
<p class="ltx_p" id="S8.p5.1">While the current implementation demonstrates reliability, future work should focus on refining the framework by fine-tuning the LLM with context-specific data rather than relying on a zero-shot approach. Additionally, employing multiple specialized autonomous agents to handle distinct tasks—such as TA, evidence identification, root cause analysis, and predicting potential future threats—could further enhance the system’s efficiency and effectiveness. Exploring the use of larger models in optimized environments may also support more complex tasks and generate more detailed and accurate results.</p>
</div>
<div class="ltx_para" id="S8.p6">
<p class="ltx_p" id="S8.p6.1">In the preceding sections, we have comprehensively explored the research questions and their implications. In this final section, we discuss the relationship between LLMs and Forensic Timeline Analysis. At this stage, the readiness of forensic TA for LLM integration is interdependent with the advancement of LLM technology. The progress in LLMs directly influences the effectiveness of TA, as improvements in one are closely tied to advancements in the other. Although current LLMs exhibit significant capabilities, they have not yet achieved full accuracy. Therefore, while LLMs are valuable tools, their full potential for TA will only be realized with continued technological development.</p>
</div>
<div class="ltx_para" id="S8.p7">
<p class="ltx_p" id="S8.p7.1">In conclusion, the proposed framework represents a significant advancement in applying generative AI to digital forensics and incident response, aiming to improve digital security in a landscape where cyber threats are continually evolving.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Footnotes</h2>
<section class="ltx_subsection" id="Sx1.SSx1">
<h3 class="ltx_title ltx_font_italic ltx_title_subsection">Ethical Approval</h3>
<div class="ltx_para" id="Sx1.SSx1.p1">
<p class="ltx_p" id="Sx1.SSx1.p1.1">This research was deemed as not requiring the University’s Ethical Committee Approval as it doesn’t fall under any of the cases requiring ethical approval.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx2">
<h3 class="ltx_title ltx_font_italic ltx_title_subsection">Funding</h3>
<div class="ltx_para" id="Sx1.SSx2.p1">
<p class="ltx_p" id="Sx1.SSx2.p1.1">The APC and Open Access fees for this publication are funded by the University of Liverpool.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx3">
<h3 class="ltx_title ltx_font_italic ltx_title_subsection">Acknowledgement</h3>
<div class="ltx_para" id="Sx1.SSx3.p1">
<p class="ltx_p" id="Sx1.SSx3.p1.1">We acknowledge that all data used to simulate the cyber incidents in this case study are synthetic and were designed to model and visualize cyber incident scenarios while strictly adhering to privacy, confidentiality, consent, and copyright regulations. All scenarios, descriptions, data, generated Timeline Analysis Reports, results, and ground truth information are available in the GitHub repository linked below:</p>
</div>
<div class="ltx_para" id="Sx1.SSx3.p2">
<p class="ltx_p" id="Sx1.SSx3.p2.1"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/GenDFIR" title="">https://github.com/GenDFIR</a></p>
</div>
<div class="ltx_para ltx_noindent" id="Sx1.SSx3.p3">
<p class="ltx_p" id="Sx1.SSx3.p3.1">The repository includes a portion of the code used in this study, with the AI (LLM module) code available upon request.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx4">
<h3 class="ltx_title ltx_font_italic ltx_title_subsection">Competing Interests</h3>
<div class="ltx_para" id="Sx1.SSx4.p1">
<p class="ltx_p" id="Sx1.SSx4.p1.1">The authors declare that they have no known competing interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">Hamouda, D., Ferrag, M., Benhamida, N., Seridi, H. &amp; Ghanem, M. Revolutionizing intrusion detection in industrial IoT with distributed learning and deep generative techniques. <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Internet Of Things</span>. <span class="ltx_text ltx_font_bold" id="bib.bib1.2.2">26</span> pp. 101149 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">Dimitriadis, A., Ivezic, N., Kulvatunyou, B. &amp; Ioannis Mavridis D4I - Digital forensics framework for reviewing and investigating cyber attacks . <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Array </span>. <span class="ltx_text ltx_font_bold" id="bib.bib2.2.2">5</span> (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">Johansen, G. Digital Forensics and Incident Response: Incident response techniques and procedures to respond to modern cyber threats. (Packt,2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">Yoan Chabot, C. &amp; M-Tahar Kechadi A complete formalized knowledge representation model for advanced digital forensics timeline analysis. <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Digital Investigation </span>. <span class="ltx_text ltx_font_bold" id="bib.bib4.2.2">11</span> pp. 95-105 (2014)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">Dunsin, D., Ghanem, M., Ouazzane, K. &amp; Vassilev, V. A comprehensive analysis of the role of artificial intelligence and machine learning in modern digital forensics and incident response . <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Forensic Science International: Digital Investigation </span>. <span class="ltx_text ltx_font_bold" id="bib.bib5.2.2">48</span> (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">Dunsin, D., Ghanem, M. &amp; Ouazzane, K. The Use of Artificial Intelligence in Digital Forensics and Incident Response (DFIR) in a Constrained Environment. <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">International Journal Of Information And Communication Technology </span>. <span class="ltx_text ltx_font_bold" id="bib.bib6.2.2">280-285 </span> (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">Dunsin, D., Ghanem, M., Ouazzane, K. &amp; Vassilev, V. Reinforcement Learning for an Efficient and Effective Malware Investigation during Cyber Incident Response. <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">ArXiv Preprint ArXiv:2408.01999</span>. (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">Chang, Y., Wang, X., Wang, J., Wu, Y., Yang, L., Zhu, K., Chen, H., Yi, X., Wang, C., Wang, Y., Ye, W., Zhang, Y., Chang, Y., Yu, P., Yang, Q. &amp; Xing Xie A Survey on Evaluation of Large Language Models. <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">ACM Transactions On Intelligent Systems And Technology </span>. <span class="ltx_text ltx_font_bold" id="bib.bib8.2.2">15</span> (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">Bai, T., Liang, H., Wan, B., Xu, Y., Li, X., Li, S., Yang, L., Li, B., Wang, Y., Cui, B., Huang, P., Shan, J., He, C., Yuan, B. &amp; Wentao Zhang A Survey of Multimodal Large Language Model from A Data-centric Perspective. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Zhang, Z., Bo, X., Ma, C., Li, R., Chen, X., Dai, Q., Zhu, J., Dong, Z. &amp; Ji-Rong Wen A Survey on the Memory Mechanism of Large Language Model based Agents. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Gao, Y., Xiong, Y., Gao, X., Jia, K., Pan, J., Bi, Y., Dai, Y., Sun, J., Wang, M. &amp; Haofen Wang Retrieval-Augmented Generation for Large Language Models: A Survey . (2023), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">Alty, J. &amp; G. Guida The Use of Rule-based System Technology for the Design of Man-Machine Systems. <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">IFAC Proceedings Volumes</span>. <span class="ltx_text ltx_font_bold" id="bib.bib12.2.2">18</span> (1985)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">Tynan, P. Closing remarks on “The integration and implications of artificial intelligence in forensic science”. <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Forensic Science, Medicine And Pathology</span>. pp. 101-111 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">Brian Carrier, E. An Event-Based Digital Forensic Investigation Framework. <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">The Digital Forensic Research Conference DFRWS 2004 USA</span>. (2004)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">Ghanem, M., Chen, T., Ferrag, M. &amp; Kettouche, M. ESASCF: expertise extraction, generalization and reply framework for optimized automation of network security compliance. <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">IEEE Access</span>. (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">Naveed, H., Khan, A., Qiu, S., Saqib, M., Anwar, S., Usman, M., Akhtar, N., Barnes, N. &amp; Ajmal Mian A Comprehensive Overview of Large Language Models . (2023), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">Standards, N. &amp; Technology Incident Response. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://csrc.nist.gov/Projects/incident-response" title="">https://csrc.nist.gov/Projects/incident-response</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">FTK, E. FTK Forensic Toolkit. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.exterro.com/digital-forensics-software/forensic-toolkit" title="">https://www.exterro.com/digital-forensics-software/forensic-toolkit</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">Autopsy Autopsy Digital Forensics. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.autopsy.com/" title="">https://www.autopsy.com/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">EnCase EnCase Forensic Suite. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://e-forensic.ca/products/encase-forensic-suite/" title="">https://e-forensic.ca/products/encase-forensic-suite/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">Magnet Magnet Forensics. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.magnetforensics.com/resources/introduction-magnet-axiom/" title="">https://www.magnetforensics.com/resources/introduction-magnet-axiom/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">Argreaves Christopher, P. An automated timeline reconstruction approach for digital forensic investigations. <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Digital Investigation</span>. <span class="ltx_text ltx_font_bold" id="bib.bib22.2.2">9</span> (2012)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">Hudan Studiawan, B. &amp; Baskoro A Pratomo Forensic Timeline Analysis of iOS Devices . <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">2022 International Conference On Engineering And Emerging Technologies (ICEET)</span>. (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">Yoan Chabot, C. &amp; Tahar Kechadi Automatic Timeline Construction and Analysis for Computer Forensics Purposes. <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Joint Intelligence And Security Informatics</span>. pp. 139-144 (2014)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">Sandeepak Bhandari , V. The Phases Based Approach for Regeneration of Timeline in Digital Forensics . <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">INnovations In Intelligent SysTems And Applications (INISTA) </span>. (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"> Ferrag,A., F., Battah, A., Cherif, B., Mechri, A. &amp; Tihanyi, N. Generative AI and Large Language Models for Cyber Security: All Insights You Need. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">Akila Wickramasekara, F. SoK: Exploring the Potential of Large Language Models for Improving Digital Forensic Investigation Efficiency. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">Scanlon, M., Breitinger, F., Hargreaves, C., Hilgert, J. &amp; Sheppard, J. ChatGPT for digital forensic investigation: The good, the bad, and the unknown . <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Forensic Science International: Digital Investigation </span>. <span class="ltx_text ltx_font_bold" id="bib.bib28.2.2">46</span> (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">Sreya E K , R. &amp; Wadhwa, M. Enhancing Digital Investigation: Leveraging ChatGPT for Evidence Identification and Analysis in Digital Forensics. <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">International Conference On Computing, Communication, And Intelligent Systems (ICCCIS)</span>. pp. 733-738 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">Norbert Tihanyi, M. &amp; Ridhi Jain , M. CyberMetric: A Benchmark Dataset based on Retrieval-Augmented Generation for Evaluating LLMs in Cybersecurity Knowledge . (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">Jakub Lála, O., Shtedritski, A., Cox, S., Rodriques, S. &amp; Andrew D. White PaperQA: Retrieval-Augmented Generative Agent for Scientific Research. (2023), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">Yu, Y., Ping, W., Liu, Z., Wang, B., You, J., Zhang, C., Shoeybi, M., Wang, B., Wang, Z., Gao, X., Zhang, F., Wu, Y., Xu, Z., Shi, T., Wang, Z., Shizheng Li, Qian, Q., Yin, R., Lv, C., Zheng, X. &amp; Xuanjing Huang Searching for Best Practices in Retrieval-Augmented Generation. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">Yu, Y., Wei Ping, Liu, Z., Wang, B., You, J., Zhang, C., Shoeybi, M. &amp; Catanzaro, B. RankRAG: Unifying Context Ranking with Retrieval-Augmented Generation in LLMs . (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">OpenAI ChatGPT. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://chatgpt.com/" title="">https://chatgpt.com/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">Anthropic Claude. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.anthropic.com/claude" title="">https://www.anthropic.com/claude</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">Meta Llama Models. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://llama.meta.com/docs/model-cards-and-prompt-formats" title="">https://llama.meta.com/docs/model-cards-and-prompt-formats</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">Meta Llama. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://llama.meta.com/" title="">https://llama.meta.com/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">Meta Meta. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://about.meta.com/uk/" title="">https://about.meta.com/uk/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">OpenAI GPT. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/gpt-4/" title="">https://openai.com/index/gpt-4/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">OpenAI OpenAI. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/" title="">https://openai.com/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">Anthropic Anthropic. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.anthropic.com/" title="">https://www.anthropic.com/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A., Kaiser, Ł. &amp; Polosukhin, I. . <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">31st Conference On Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA.</span>. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., Küttler, H., Lewis, M., Wen-Yih, Rocktäschel, T., Riedel, S. &amp; Kiela, D. Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks . (2021), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">Christopher Toukmaji, A. Retrieval-Augmented Generation and LLM Agents for Biomimicry Design Solutions. <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Proceedings Of The AAAI Symposium Series</span>. <span class="ltx_text ltx_font_bold" id="bib.bib44.2.2">3</span> (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">Muflikhah, L. &amp; Baharudin, B. Document Clustering Using Concept Space and Cosine Similarity Measurement. <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">2009 International Conference On Computer Technology And Development</span>. <span class="ltx_text ltx_font_bold" id="bib.bib45.2.2">1</span> pp. 58-62 (2009)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">Soni, S. &amp; Roberts, K. An evaluation of two commercial deep learning-based information retrieval systems for COVID-19 literature. <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Journal Of The American Medical Informatics Association</span>. <span class="ltx_text ltx_font_bold" id="bib.bib46.2.2">28</span>, 132-137 (2021,1)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">NVIDIA Building RAG Agents with LLMs. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://resources.nvidia.com/en-us-ai-large-language-models/building-rag-agents-with-llms-dli-course" title="">https://resources.nvidia.com/en-us-ai-large-language-models/building-rag-agents-with-llms-dli-course</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">Finardi, P., Avila, L., Castaldoni, R., Gengo, P., Larcher, C., Piau, M., Costa, P. &amp; Caridá, V. THE CHRONICLES OF RAG: THE RETRIEVER, THE CHUNK AND THE GENERATOR. (2024), arXiv

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">Wan, S., Nikolaidis, C., Song, D., Molnar, D., Crnkovich, J., Grace, J., Bhatt, M., Chennabasappa, S., Whitman, S., Ding, S., Ionescu, V., Li, Y. &amp; Joshua Saxe CYBERSECEVAL 3: Advancing the Evaluation of Cybersecurity Risks and Capabilities in Large Language Models. (Meta ,2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">Liu, H., Li, C., Wu, Q. &amp; Lee, Y. LLaVA: Large Language and Vision Assistant. (2023), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://llava-vl.github.io/" title="">https://llava-vl.github.io/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">Mixedbread Mixedbread Embedding Models. (2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.mixedbread.ai/docs/embeddings/models" title="">https://www.mixedbread.ai/docs/embeddings/models</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
NIST CFReDS, "Rhino Hunt," Department of Computer Science, National Institute of Standards and Technology, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cfreds-archive.nist.gov/dfrws/Rhino_Hunt.html" title="">https://cfreds-archive.nist.gov/dfrws/Rhino_Hunt.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">Research, C. Evaluating Chunking Strategies for Retrieval. (Chroma Research,2024), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://research.trychroma.com/evaluating-chunking" title="">https://research.trychroma.com/evaluating-chunking</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">T. Hu and X.-H. Zhou, "Unveiling LLM Evaluation Focused on Metrics: Challenges and Solutions," arXiv preprint arXiv:2404.09135, Apr. 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2404.09135" title="">https://doi.org/10.48550/arXiv.2404.09135</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">Jiménez, M., Fernández, D., Eduardo Rivadeneira, J. &amp; Flores-Moyano, R. A Filtering Model for Evidence Gathering in an SDN-Oriented Digital Forensic and Incident Response Context. <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">IEEE Access</span>. <span class="ltx_text ltx_font_bold" id="bib.bib55.2.2">12</span> pp. 75792-75808 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
GenDFIR, GitHub repository, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/GenDFIR" title="">https://github.com/GenDFIR</a>
</span>
</li>
</ul>
</section>
<figure class="ltx_float biography" id="id1">
<table class="ltx_tabular" id="id1.1">
<tr class="ltx_tr" id="id1.1.1">
<td class="ltx_td" id="id1.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="99" id="id1.1.1.1.g1" src="extracted/5878186/loumachi.jpg" width="100"/></td>
<td class="ltx_td" id="id1.1.1.2">
<span class="ltx_inline-block" id="id1.1.1.2.1">
<span class="ltx_p" id="id1.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id1.1.1.2.1.1.1">Fatma Yasmine Loumachi</span>  is a Research Fellow within the Cyber Security Research Centre at London Metropolitan University. She holds a Bachelor’s Degree in Information System and Software Engineering, an MSc in Networks and Embedded Systems, as well as a second MSc in Computer Networking and Cybersecurity. She has collaborated with various professionals from the industry on different projects, including Banking Systems, Robotic Autonomous Driving, and the digitalization of Government Information Systems. Additionally, she worked as a Cybersecurity Engineer in CyberASAP, funded by Innovate UK. Her interests span multiple disciplines, including Cybersecurity, Digital Forensics, Generative AI, Embedded Systems, Networks, IoT, and Robotics.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure class="ltx_float biography" id="id2">
<table class="ltx_tabular" id="id2.1">
<tr class="ltx_tr" id="id2.1.1">
<td class="ltx_td" id="id2.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="100" id="id2.1.1.1.g1" src="extracted/5878186/mcghanem.jpg" width="100"/></td>
<td class="ltx_td" id="id2.1.1.2">
<span class="ltx_inline-block" id="id2.1.1.2.1">
<span class="ltx_p" id="id2.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="id2.1.1.2.1.1.1">Dr Mohamed Chahine Ghanem</span>  is an Associate Professor and Director of the Cyber Security Research Centre, he is also Senior Academic within the Department of Computer Science at the University of Liverpool. Dr Ghanem holds an Engineering Degree in Computer Sciences, an MSc in Digital Forensics with Distinction and a PhD in Cyber Security from City, University of London. He is a Senior Fellow of HEA and holds a PGDip in Security Studies.
Dr Ghanem is an IEEE member and a professional member of the British Computer Society achieved many certificates, such as GCFE, CISSP, ACE, XRY and CPCI with over 15 years of experience in the field of cybersecurity, digital forensics and incident investigation at the law-enforcement and corporate level. His research focuses on applying AI to solve real-world cybersecurity and digital forensics problems and published numerous research papers in the world’s top cybersecurity journals. He delivered several keynote talks at different prestigious venues. Dr Ghanem is the Academic Editor of ACM Digital Threats: Research Practice journal and Senior Advisor at KROLL LLC.</span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 25 06:51:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
